* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    83* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    84* 051314  CR2014042900001  PEMA  ADD ACCT 1107201 TO FPB
    85* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    86* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
    87******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   4
* ECS010.cbl
    89 ENVIRONMENT DIVISION.
    90 CONFIGURATION SECTION.
    91 SPECIAL-NAMES.
    92     C02 IS LCP-CH2
    93     C03 IS LCP-CH3
    94     C04 IS LCP-CH4
    95     C05 IS LCP-CH5
    96     C06 IS LCP-CH6
    97     C07 IS LCP-CH7
    98     C08 IS LCP-CH8
    99     C09 IS LCP-CH9
   100     C10 IS LCP-CH10
   101     C11 IS LCP-CH11
   102     C12 IS LCP-CH12
   103     S01 IS LCP-P01
   104     S02 IS LCP-P02.
   105
   106 INPUT-OUTPUT SECTION.
   107 FILE-CONTROL.
   108
   109     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   110
   111     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   112
   113     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   114                             ACCESS IS SEQUENTIAL
   115                             ORGANIZATION IS INDEXED
   116                             FILE STATUS IS ERACCTT-FILE-STATUS
   117                             RECORD KEY IS AM-CONTROL-PRIMARY.
   118
   119     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   120                             ACCESS IS DYNAMIC
   121                             ORGANIZATION IS INDEXED
   122                             FILE STATUS IS ERRTBL-FILE-STATUS
   123                             RECORD KEY IS RE-CONTROL-PRIMARY.
   124
   125     SELECT ERCTBL           ASSIGN TO ERCTBLT
   126                             ACCESS IS DYNAMIC
   127                             ORGANIZATION IS INDEXED
   128                             FILE STATUS IS ERCTBL-FILE-STATUS
   129                             RECORD KEY IS CT-CONTROL-PRIMARY.
   130
   131     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   132                             ORGANIZATION INDEXED
   133                             ACCESS DYNAMIC
   134                             RECORD KEY ME-CONTROL-PRIMARY
   135                             FILE STATUS ERMEBL-FILE-STATUS.
   136
   137     SELECT ERRESC-IN        ASSIGN TO ERRESC
   138                             ORGANIZATION IS INDEXED
   139                             ACCESS IS DYNAMIC
   140                             RECORD KEY IS ERRESC-RECORD-KEY
   141                             FILE STATUS IS ERRESC-FILE-STATUS.
   142
   143     SELECT ELCRTT           ASSIGN TO ELCRTT
   144                             ACCESS IS DYNAMIC
   145                             ORGANIZATION IS INDEXED
   146                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   5
* ECS010.cbl
   147                             RECORD KEY IS CS-CONTROL-PRIMARY.
   148
   149     SELECT ERAGTC           ASSIGN TO ERAGTC
   150                             ACCESS IS DYNAMIC
   151                             ORGANIZATION IS INDEXED
   152                             FILE STATUS IS ERAGTC-FILE-STATUS
   153                             RECORD KEY IS AG-CONTROL-PRIMARY.
   154
   155     SELECT ERPDEF           ASSIGN TO ERPDEF
   156                             ACCESS IS DYNAMIC
   157                             ORGANIZATION IS INDEXED
   158                             FILE STATUS IS ERPDEF-FILE-STATUS
   159                             RECORD KEY IS PD-CONTROL-PRIMARY.
   160
   161     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   162
   163     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   164
   165     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   166
   167     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   168
   169
   170     SELECT ME-ECS010-BALANCE
   171                             ASSIGN TO SYS012
   172                             ORGANIZATION IS LINE SEQUENTIAL.
   173
   174     SELECT ME50-ECS010-BALANCE
   175                             ASSIGN TO SYS013
   176                             ORGANIZATION IS LINE SEQUENTIAL.
   177
   178     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   179
   180     SELECT DISK-DATE        ASSIGN TO SYS019.
   181
   182     SELECT PRINT-COPY       ASSIGN TO SYS008.
   183
   184     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   185
   186     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   6
* ECS010.cbl
   188 DATA DIVISION.
   189 FILE SECTION.
   190
   191 FD  PENDING-EXTRACT
   192     BLOCK CONTAINS 0 RECORDS
   193     RECORDING MODE F.
   194
*  195                             COPY ERCEXTD.
   196******************************************************************04/29/98
   197*                                                                *ERCEXTD
   198*                                                                *ERCEXTD
   199*                            ERCEXTD                             *   LV002
   200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   201*                            VMOD=2.002                          *   CL**2
   202*                                                                *ERCEXTD
   203*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   204*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   205*                                                                *ERCEXTD
   206*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   207*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   208*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   209*                                                                *ERCEXTD
   210*         RECORD                                                 *ERCEXTD
   211*          TYPE          PROGRAM USING                           *ERCEXTD
   212*        --------        --------------------------------        *ERCEXTD
   213*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   214*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   215*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   216*                                                                *ERCEXTD
   217* -------------------------------------------------------------- *ERCEXTD
   218*                                                                *ERCEXTD
   219*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   220*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   221*                                                                *ERCEXTD
   222*   FILENAME = EREXTD                                            *ERCEXTD
   223*                                                                *ERCEXTD
   224******************************************************************ERCEXTD
   225                                                                  ERCEXTD
   226 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   227     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   228         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   229                                                                  ERCEXTD
   230     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   231         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   232         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   233         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   234                                                                  ERCEXTD
   235     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   236                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   7
* ECS010.cbl
   238 FD  CERT-MASTER-IN
*  239                             COPY ECSCRIFD.
   240******************************************************************07/10/97
   241*                                                                *ECSCRIFD
   242*                            ECSCRIFD                            *   LV001
   243*                            VMOD 2.005                          *ECSCRIFD
   244*                                                                *ECSCRIFD
   245*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   246*                                                                *ECSCRIFD
   247******************************************************************ECSCRIFD
   248     BLOCK CONTAINS 0 RECORDS
   249     RECORDING MODE F.                                            ECSCRIFD
   250                                                                  ECSCRIFD
   251 01  CERT-IN-RECORD.                                              ECSCRIFD
   252                                                                  ECSCRIFD
   253     12  FILLER                            PIC XXX.               ECSCRIFD
   254     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   255     12  FILLER                            PIC X(66).             ECSCRIFD
   256     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   257     12  FILLER                            PIC X(20).             ECSCRIFD
   258     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   259     12  FILLER                            PIC X(14).             ECSCRIFD
   260     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   261     12  FILLER                            PIC X(39).             ECSCRIFD
   262     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   263     12  FILLER                            PIC X(45).             ECSCRIFD
   264     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   265     12  FILLER                            PIC X(35).             ECSCRIFD
   266     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   267     12  FILLER                            PIC X(41).             ECSCRIFD
   268     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   269     12  FILLER                            PIC X(48).             ECSCRIFD
   270     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   271     12  FILLER                            PIC X(9).              ECSCRIFD
   272     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   273     12  FILLER                            PIC X(120).            ECSCRIFD
   274     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   275     12  FILLER                            PIC X(73).             ECSCRIFD
   276     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   277     12  FILLER                            PIC X(464).            ECSCRIFD
   278                                                                  ECSCRIFD
   279******************************************************************ECSCRIFD
   280
   281 01  CI-RECORD.
   282     12  FILLER          PIC  X(03).
   283     12  CI-ACCOUNT-CONTROL.
   284         16  CI-CARRIER      PIC  X(01).
   285         16  CI-GROUPING     PIC  X(06).
   286         16  CI-STATE        PIC  X(02).
   287         16  CI-ACCOUNT      PIC  X(10).
   288     12  FILLER          PIC  X(06).
   289     12  CI-CERT-NO.
   290         16  CI-CERT     PIC X(10).
   291         16  CI-CERT-SFX PIC X.
   292     12  FILLER          PIC  X(1017).
   293
   294******************************************************
   295*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   8
* ECS010.cbl
   296*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   297*   COMMERCIAL FEDERAL BANK
   298******************************************************
   299 01  CF-RECORD.
   300     12  FILLER          PIC X(759).
   301     12  CF-THIRD-AGENT  PIC X(10).
   302     12  FILLER          PIC X(7).
   303     12  CF-FOURTH-AGENT PIC X(10).
   304     12  FILLER          PIC X(270).
   305
   306******************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page   9
* ECS010.cbl
   308 FD  ERACCTT-IN.
   309
*  310                             COPY ERCACCT.
   311******************************************************************04/19/98
   312*                                                                *ERCACCT
   313*                                                                *ERCACCT
   314*                            ERCACCT                             *   LV031
   315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   316*                            VMOD=2.031                          *ERCACCT
   317*                                                                *ERCACCT
   318*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   319*                                                                *ERCACCT
   320*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   321*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   322*                                                                *ERCACCT
   323*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   324*                                                                *ERCACCT
   325*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   326*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   327*                                                                *ERCACCT
   328*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   329*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   330*                                                                *ERCACCT
   331*   LOG = NO                                                     *ERCACCT
   332*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   333*                                                                *ERCACCT
   334*                                                                *ERCACCT
   335******************************************************************ERCACCT
   336*                   C H A N G E   L O G
   337*
   338* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   339*-----------------------------------------------------------------
   340*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   341* EFFECTIVE    NUMBER
   342*-----------------------------------------------------------------
   343* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   344* 092705    2005050300006  PEMA  ADD SPP LEASES
   345* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   346* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   347* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   348* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   349* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   350******************************************************************
   351                                                                  ERCACCT
   352 01  ACCOUNT-MASTER.                                              ERCACCT
   353     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   354         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   355                                                                  ERCACCT
   356     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   357         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   358         16  AM-MSTR-CNTRL.                                       ERCACCT
   359             20  AM-CONTROL-A.                                    ERCACCT
   360                 24  AM-CARRIER            PIC X.                 ERCACCT
   361                 24  AM-GROUPING.                                 ERCACCT
   362                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   363                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   364                 24  AM-STATE              PIC XX.                ERCACCT
   365                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   366                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   367                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   368             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   369                                           PIC X(19).             ERCACCT
   370             20  AM-CNTRL-B.                                      ERCACCT
   371                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   372                 24  FILLER                PIC X(4).              ERCACCT
   373             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   374                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   375                                                                  ERCACCT
   376     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   377         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   378         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   379         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   380         16  AM-VG-STATE                   PIC XX.                ERCACCT
   381         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   382         16  AM-VG-DATE.                                          ERCACCT
   383             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   384             20  FILLER                    PIC X(4).              ERCACCT
   385         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   386                                           PIC 9(11)      COMP-3. ERCACCT
   387     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   388         16  FILLER                        PIC X(10).
   389         16  AM-VG-KEY3.
   390             20  AM-VG3-ACCOUNT            PIC X(10).
   391             20  AM-VG3-EXP-DT             PIC XX.
   392         16  FILLER                        PIC X(4).
   393     12  AM-MAINT-INFORMATION.                                    ERCACCT
   394         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   395         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   396         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   397         16  FILLER                        PIC XX.                ERCACCT
   398                                                                  ERCACCT
   399     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   400     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   401                                                                  ERCACCT
   402     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   403         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   404         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   405                                                                  ERCACCT
   406     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   407     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   408                                                                  ERCACCT
   409     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   410     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   411                                                                  ERCACCT
   412     12  AM-NAME                           PIC X(30).             ERCACCT
   413     12  AM-PERSON                         PIC X(30).             ERCACCT
   414     12  AM-ADDRS                          PIC X(30).             ERCACCT
   415     12  AM-CITY.
   416         16  AM-ADDR-CITY                  PIC X(28).
   417         16  AM-ADDR-STATE                 PIC XX.
   418     12  AM-ZIP.                                                  ERCACCT
   419         16  AM-ZIP-PRIME.                                        ERCACCT
   420             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   421                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   422             20  FILLER                    PIC X(4).              ERCACCT
   423         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   424     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   425         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   426         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   427         16  FILLER                        PIC XXX.               ERCACCT
   428     12  AM-TEL-NO.                                               ERCACCT
   429         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   430         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   431         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   432     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   433         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   434         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   435                                                                  ERCACCT
   436     12  AM-COMM-STRUCTURE.                                       ERCACCT
   437         16  AM-DEFN-1.                                           ERCACCT
   438             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   439                 24  AM-AGT.                                      ERCACCT
   440                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   441                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   442                 24  AM-COM-TYP            PIC X.                 ERCACCT
   443                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   444                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   445                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   446                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   447                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   448                 24  AM-GL-CODES           PIC X.                 ERCACCT
   449                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   450                 24  FILLER                PIC X(01).             ERCACCT
   451         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   452             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   453                 24  FILLER                PIC X(11).             ERCACCT
   454                 24  AM-L-COMA             PIC XXX.               ERCACCT
   455                 24  AM-J-COMA             PIC XXX.               ERCACCT
   456                 24  AM-A-COMA             PIC XXX.               ERCACCT
   457                 24  FILLER                PIC X(6).              ERCACCT
   458                                                                  ERCACCT
   459     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   460         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   461                                                                  ERCACCT
   462     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   463                                                                  ERCACCT
   464     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   465         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   466         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   467     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   468         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   469         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   470     12  AM-GPCD                           PIC 99.                ERCACCT
   471     12  AM-IG                             PIC X.                 ERCACCT
   472         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   473         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   474     12  AM-STATUS                         PIC X.                 ERCACCT
   475         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   476         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   477         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   478         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   479         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   480         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   481     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   482     12  AM-ID-NO                          PIC X(11).             ERCACCT
   483                                                                  ERCACCT
   484     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   485     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   486     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   487     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   488     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   489     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   490     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   491     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   492     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   493                                                                  ERCACCT
   494     12  AM-USER-FIELDS.                                          ERCACCT
   495         16  AM-FLD-1                      PIC XX.                ERCACCT
   496         16  AM-FLD-2                      PIC XX.                ERCACCT
   497         16  AM-FLD-3                      PIC XX.                ERCACCT
   498         16  AM-FLD-4                      PIC XX.                ERCACCT
   499         16  AM-FLD-5                      PIC XX.                ERCACCT
   500                                                                  ERCACCT
   501     12  AM-1ST-PROD-DATE.                                        ERCACCT
   502         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   503         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   504         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   505     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   506     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   507         16  AM-PUR-YR                     PIC XX.                ERCACCT
   508         16  AM-PUR-MO                     PIC XX.                ERCACCT
   509         16  AM-PUR-DA                     PIC XX.                ERCACCT
   510     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   511     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   512     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   513     12  AM-INACTIVE-DATE.                                        ERCACCT
   514         16  AM-INA-MO                     PIC 99.                ERCACCT
   515         16  AM-INA-DA                     PIC 99.                ERCACCT
   516         16  AM-INA-YR                     PIC 99.                ERCACCT
   517     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   518                                                                  ERCACCT
   519     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   520     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   521                                                                  ERCACCT
   522     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   523         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   524         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   525         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   526         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   527                                                                  ERCACCT
   528     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   529         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   530         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   531                                                                  ERCACCT
   532     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   533                                                                  ERCACCT
   534     12  AM-OVER-SHORT.                                           ERCACCT
   535         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   536         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   537                                                                  ERCACCT
   538     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   539     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   540                                                                  ERCACCT
   541     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   542     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   543                                                                  ERCACCT
   544     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   545     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   546     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   547     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   548     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   549     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   550     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   551     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   552     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   553     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   554     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   555     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   556     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   557     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   558     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   559     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   560                                                                  ERCACCT
   561     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   562                                                                  ERCACCT
   563     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   564     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   565                                                                  ERCACCT
   566     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   567     12  AM-EARN-METHODS.                                         ERCACCT
   568         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   569             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   570             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   571             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   572             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   573         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   574             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   575             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   576             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   577             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   578         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   579             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   580             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   581             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   582             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   583             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   584             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   585                                                                  ERCACCT
   586     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   587     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   588     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   589                                                                  ERCACCT
   590     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   591     12  AM-RET-P-E                        PIC X.                 ERCACCT
   592     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   593     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   594     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   595     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   596         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   597         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   598     12  AM-RETRO-EARNINGS.                                       ERCACCT
   599         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   600         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   601         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   602     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   603         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   604         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   605     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   606         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   607         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   608         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   609     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   610     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   611                                                                  ERCACCT
   612     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   613         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   614         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   615         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   616         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   617         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   618                                                                  ERCACCT
   619     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   620                                                                  ERCACCT
   621     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   622                                                                  ERCACCT
   623     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   624         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   625                                                                  ERCACCT
   626     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   627         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   628         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   629                                                                  ERCACCT
   630     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   631         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   632                                                                  ERCACCT
   633     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   634         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   635         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   636                                                                  ERCACCT
   637     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   638                                                                  ERCACCT
   639     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   640     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   641     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   642     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   643     12  AM-DCC-UEF-STATE                  PIC XX.
   644     12  FILLER                            PIC XXX.
   645     12  AM-REPORT-CODE-3                  PIC X(10).
   646*    12  FILLER                            PIC X(22).             ERCACCT
   647                                                                  ERCACCT
   648     12  AM-RESERVE-DATE.                                         ERCACCT
   649         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   650         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   651         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   652                                                                  ERCACCT
   653     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   654     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   655         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   656         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   657         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   658         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   659                                                                  ERCACCT
   660     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   661         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   662         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   663         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   664         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   665                                                                  ERCACCT
   666     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   667         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   668             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   669             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   670             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   671             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   672             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   673             20  FILLER                    PIC XX.                ERCACCT
   674         16  FILLER                        PIC X(80).             ERCACCT
   675                                                                  ERCACCT
   676     12  AM-TRANSFER-DATA.                                        ERCACCT
   677         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   678             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   679             20  AM-TRNFROM-GROUPING.                             ERCACCT
   680                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   681                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   682             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   683             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   684                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   685                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   686             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   687         16  AM-TRANSFERRED-TO.                                   ERCACCT
   688             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   689             20  AM-TRNTO-GROUPING.                               ERCACCT
   690                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   691                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   692             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   693             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   694                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   695                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   696             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   697         16  FILLER                        PIC X(10).             ERCACCT
   698                                                                  ERCACCT
   699     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   700                                                                  ERCACCT
   701     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   702         16  AM-DEFN-1-SAVED.                                     ERCACCT
   703             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   704                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   705                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   706                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   707                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   708                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   709                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   710                 24  FILLER                PIC X.                 ERCACCT
   711                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   712                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   713                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   714         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   715             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   716                 24  FILLER                PIC X(11).             ERCACCT
   717                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   718                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   719                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   720                 24  FILLER                PIC X(6).              ERCACCT
   721                                                                  ERCACCT
   722     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   723         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   724            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   725            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   726            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   727                                                                  ERCACCT
   728     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   729     12  FILLER                            PIC X(120).            ERCACCT
   730                                                                  ERCACCT
   731     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   732         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   733         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   734             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   735             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   736                                                          COMP-3. ERCACCT
   737             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   738                                                          COMP-3. ERCACCT
   739         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   740             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   741             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   742                                                          COMP-3. ERCACCT
   743             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   744                                                          COMP-3. ERCACCT
   745                                                                  ERCACCT
   746     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   747         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   748         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   749         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   750         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   751             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   752                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   753                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   754             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   755                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   756                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   757             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   758                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   759                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   760         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   761             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   762                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   763                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   764                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   765             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   766                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   767                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   768             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   769                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   770                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   771                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   772     12  AM-COMMENTS.                                             ERCACCT
   773         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   774                                                                  ERCACCT
   775     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   776         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   777         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   778         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   779         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   780         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   781             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   782             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   783             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   784             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   785         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   786             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   787             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   788             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   789         16  FILLER                        PIC X(102).            ERCACCT
   790                                                                  ERCACCT
   791     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   792         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   793             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   794             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   795             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   796             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   797             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   798         16  FILLER                          PIC X(10).           ERCACCT
   799******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  18
* ECS010.cbl
   801 FD  ERRTBL-IN.
   802
*  803                             COPY ERCREIN.
   804******************************************************************07/27/93
   805*                                                                *ERCREIN
   806*                            ERCREIN                             *   LV009
   807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   808*                            VMOD=2.010                          *   CL**9
   809*                                                                *ERCREIN
   810*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   811*                                                                *ERCREIN
   812*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   813*                                                                *ERCREIN
   814*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   815*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   816*                                                                *ERCREIN
   817*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   818*       ALTERNATE PATH = NONE                                    *ERCREIN
   819*                                                                *ERCREIN
   820*   LOG = NO                                                     *ERCREIN
   821*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   822*                                                                *ERCREIN
   823******************************************************************ERCREIN
   824*                   C H A N G E   L O G
   825*
   826* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   827*-----------------------------------------------------------------
   828*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   829* EFFECTIVE    NUMBER
   830*-----------------------------------------------------------------
   831* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   832* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   833******************************************************************
   834 01  REINSURANCE-RECORD.                                          ERCREIN
   835     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   836         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   837                                                                  ERCREIN
   838     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   839         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   840         16  RE-KEY.                                              ERCREIN
   841             20  RE-CODE                   PIC X.                 ERCREIN
   842                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   843                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   844             20  RE-TABLE                  PIC XXX.               ERCREIN
   845             20  FILLER                    PIC XXX.               ERCREIN
   846         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   847             20  FILLER                    PIC X.                 ERCREIN
   848             20  RE-COMPANY.                                      ERCREIN
   849                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   850                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   851                                                                  ERCREIN
   852     12  RE-MAINT-INFORMATION.                                    ERCREIN
   853         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   854         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   855         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   856         16  FILLER                        PIC X(10).             ERCREIN
   857                                                                  ERCREIN
   858     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   859         16  RE-100-COMP                   PIC 99.                ERCREIN
   860                                                                  ERCREIN
   861         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   862             20  RE-REI-COMP-NO.                                  ERCREIN
   863                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   864                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   865             20  RE-LF-QC                  PIC X.                 ERCREIN
   866             20  RE-AH-QC                  PIC X.                 ERCREIN
   867             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   868             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   869             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   870             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   871             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   872             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   873             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   874             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   875             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   876             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   877             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   878             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   879             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   880             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   881             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   882             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   883             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   884             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   886             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   887             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   888             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   889             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   890             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   891             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   892             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   893             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   894             20  RE-REMAINING              PIC X.                 ERCREIN
   895             20  RE-LF-RUNOFF-SW           PIC X.                      000
   896             20  RE-AH-RUNOFF-SW           PIC X.                      000
   897             20  FILLER                    PIC X(19).                  000
   898                                                                  ERCREIN
   899         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   900         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   901         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   902         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   903             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   904                                                                  ERCREIN
   905         16  FILLER                        PIC X(27).             ERCREIN
   906                                                                  ERCREIN
   907     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   908         16  RE-NAME                       PIC X(30).             ERCREIN
   909         16  RE-LF-PE                      PIC X.                 ERCREIN
   910         16  RE-AH-PE                      PIC X.                 ERCREIN
   911         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   912         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   913         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   914         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   915         16  RE-PRT-ST                     PIC X.                 ERCREIN
   916         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   917         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   918         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   919         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   920         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   921         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   922         16  RE-LF-COMM                    PIC X.                 ERCREIN
   923         16  RE-AH-COMM                    PIC X.                 ERCREIN
   924         16  RE-LF-TAX                     PIC X.                 ERCREIN
   925         16  RE-AH-TAX                     PIC X.                 ERCREIN
   926         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   927         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   928         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   929                                                                  ERCREIN
   930         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   931             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   932                                                                  ERCREIN
   933         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   934             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   935                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   936                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   937                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   938                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   939             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   940                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   941                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   942                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   943                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   944                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   945                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   946                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   947                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   948             20  FILLER                    PIC XXX.               ERCREIN
   949             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   950                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   951                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   952                                                                  ERCREIN
   953         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   954             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   955                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   956                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   957                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   958                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   959             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   960                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   961                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   962                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   963                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   964                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   965                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   966                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   967                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   968             20  FILLER                    PIC XXX.               ERCREIN
   969             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   970                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   971                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   972                                                                  ERCREIN
   973         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   974                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   975         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   976                                                                  ERCREIN
   977         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   978         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   979         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   980         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   981         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   982         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   983         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   984         16  RE-MORT-SW                    PIC X.                 ERCREIN
   985         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   986             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   987             88  RE-CEDED                          VALUE 'C'.        CL**2
   988             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   989             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   990                                                                  ERCREIN
   991         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   992             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   993         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   994             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   995         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   996             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   997         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   998             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   999         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  1000             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  1001                                                                     CL**3
  1002         16  RE-PRT-CRSV                   PIC X.                    CL**5
  1003                                                                     CL**5
  1004         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1005                                                                     CL**8
  1006         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1007                                                                     CL**8
  1008         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1009                                                                     CL**9
  1010         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1011             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1012             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1013
  1014         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1015             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1016                                                                     CL**9
  1017         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1018         16  FILLER                        PIC X(2281).              CL**9
  1019                                                                  ERCREIN
  1020         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1021                                                                  ERCREIN
  1022******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  22
* ECS010.cbl
  1024 FD  ERCTBL.
  1025
* 1026                             COPY ERCCTBL.
  1027******************************************************************04/29/98
  1028*                                                                *ERCCTBL
  1029*                                                                *ERCCTBL
  1030*                            ERCCTBL                             *   LV002
  1031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1032*                            VMOD=2.003                              CL**2
  1033*                                                                *ERCCTBL
  1034*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1035*                                                                *ERCCTBL
  1036*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1037*                                                                *ERCCTBL
  1038*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1039*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1040*                                                                *ERCCTBL
  1041*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1042*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1043*                                                                *ERCCTBL
  1044*   LOG = NO                                                     *ERCCTBL
  1045*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1046*                                                                *ERCCTBL
  1047*                                                                *ERCCTBL
  1048******************************************************************ERCCTBL
  1049                                                                  ERCCTBL
  1050 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1051     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1052         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1053                                                                  ERCCTBL
  1054     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1055         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1056         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1057         16  CT-CNTRL-2.                                          ERCCTBL
  1058             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1059             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1060                                                                  ERCCTBL
  1061     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1062         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1063         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1064         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1065         16  FILLER                        PIC X(31).             ERCCTBL
  1066                                                                  ERCCTBL
  1067     12  CT-LIMITS.                                               ERCCTBL
  1068         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1069                                                                  ERCCTBL
  1070         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1071                                                                  ERCCTBL
  1072         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1073                                                                  ERCCTBL
  1074     12  CT-RATES.                                                ERCCTBL
  1075         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1076             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1077             20  CT-RT-R   REDEFINES                              ERCCTBL
  1078                 CT-RT                     PIC XXX.               ERCCTBL
  1079                                                                  ERCCTBL
  1080     12  FILLER                            PIC  X(42).            ERCCTBL
  1081                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  23
* ECS010.cbl
  1082******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  24
* ECS010.cbl
  1084 FD  ERMEBL-INOUT.
  1085
* 1086                             COPY ERCMEBL.
  1087******************************************************************04/29/98
  1088*                                                                 ERCMEBL
  1089*                                                                 ERCMEBL
  1090*                            ERCMEBL                             *   LV004
  1091*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1092*                            VMOD 2.004                          *   CL**2
  1093*                                                                *ERCMEBL
  1094*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1095*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1096*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1097*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1098*                                                                *ERCMEBL
  1099*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1100*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1101*                                                                *ERCMEBL
  1102*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1103*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1104*                                                                *ERCMEBL
  1105******************************************************************ERCMEBL
  1106                                                                  ERCMEBL
  1107 01  MONTH-END-BALANCES.                                          ERCMEBL
  1108     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1109     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1110         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1111         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1112     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1113     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1117     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1118     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1119     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1120     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1121     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1122     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1123     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1124     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1125     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1126     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1127     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1128     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1129     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1130     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1131     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1132     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1133     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1134     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1135     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1136     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1137     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1138     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1139     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1140     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1141     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1142     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1143     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1144     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1145     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1146     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1147     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1148     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1149     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1150     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1151     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1152     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1153     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1154     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1155     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1156     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1157     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1158     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1159     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1160     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1161     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1162     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1163     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1164     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1165     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1166     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1167     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1168     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1169     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1170     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1171     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1172     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1173     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1174     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1175     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1176     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1177     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1178     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1179     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1180     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1181     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1182     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1183     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1184     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1185     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1186     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1187     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1188     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1189     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1190     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1191     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1192     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1193     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1194     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1195     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1196     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1197     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1198     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1199     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1200     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1201     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1202     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1203     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1204     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1205     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1206     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1207     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1208     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1209     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1210     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1211     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1212     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1213     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1214     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1215     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1216     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1217     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1218     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1219     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1220     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1221     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1222     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1223     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1224     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1225     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1226     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1227     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1235     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1236     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1237     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1238     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1239     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1240     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1241     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1242     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1243     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1244     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1245     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1246     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1247     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1248     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1249     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1250     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1251     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1252     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1253     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1254     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1255     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1256     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1257     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1258     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1259     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1260     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1261     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1262     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1263     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1264     12  FILLER                  PIC  X(88).                         CL**2
  1265******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  28
* ECS010.cbl
  1267 FD  CERT-MASTER-OUT
* 1268                             COPY ECSCROFD.
  1269******************************************************************07/10/97
  1270*                                                                *ECSCROFD
  1271*                            ECSCROFD                            *   LV001
  1272*                            VMOD=2.002                          *ECSCROFD
  1273*                                                                *ECSCROFD
  1274*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1275*                                                                *ECSCROFD
  1276******************************************************************ECSCROFD
  1277     RECORDING MODE F                                             ECSCROFD
  1278     LABEL RECORDS STANDARD                                       ECSCROFD
  1279     BLOCK CONTAINS 0 RECORDS
  1280     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1281 01  CERT-OUT-RECORD.                                             ECSCROFD
  1282     12  FILLER                            PIC  XXX.              ECSCROFD
  1283     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1284     12  FILLER                            PIC  X(1017).          ECSCROFD
  1285                                                                  ECSCROFD
  1286******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  29
* ECS010.cbl
  1288 FD  DETAIL-EXTR
  1289     BLOCK CONTAINS 0 RECORDS
  1290     RECORDING MODE F.
  1291
* 1292                             COPY ECSEXT01.
  1293******************************************************************04/29/98
  1294*                                                                *ECSEXT01
  1295*                            ECSEXT01                            *   LV015
  1296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1297*                            VMOD=2.015                          *ECSEXT01
  1298*                                                                *ECSEXT01
  1299*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1300*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1301*                                                                *ECSEXT01
  1302*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1303*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1304*                                                                *ECSEXT01
  1305*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1306*                                                                *ECSEXT01
  1307******************************************************************ECSEXT01
  1308******************************************************************
  1309*                   C H A N G E   L O G
  1310*
  1311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1312*-----------------------------------------------------------------
  1313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1314* EFFECTIVE    NUMBER
  1315*-----------------------------------------------------------------
  1316* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1317* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1318* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1319* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1320* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1321* 032612  CR2011110200001  PEMA  AHL CHANGES
  1322******************************************************************
  1323                                                                  ECSEXT01
  1324 01  DETAIL-EXTRACT.                                              ECSEXT01
  1325     02 DETAIL-FILE.                                              ECSEXT01
  1326     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1327         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1328                                                                  ECSEXT01
  1329     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1330                                                                  ECSEXT01
  1331     12  DE-REIN                           PIC X.                 ECSEXT01
  1332                                                                  ECSEXT01
  1333     12  DE-CONTROL.                                              ECSEXT01
  1334         16  DE-CNTRL1.                                           ECSEXT01
  1335             20  DE-CARRIER                PIC X.                 ECSEXT01
  1336             20  DE-GROUPING.                                     ECSEXT01
  1337                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1338                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1339             20  DE-STATE                  PIC XX.                ECSEXT01
  1340             20  DE-ACCOUNT.                                      ECSEXT01
  1341                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1342                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1343         16  DE-CNTRL2.                                           ECSEXT01
  1344             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1345             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1346                 24 DE-CERT-NO.                                   ECSEXT01
  1347                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1348                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1349                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1350                                                                  ECSEXT01
  1351     12  DE-TRANS                          PIC X.                 ECSEXT01
  1352         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1353         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1354         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1355         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1356         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1357         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1358         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1359         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1360         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1361         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1362                                                                  ECSEXT01
  1363     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1364     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1365                                                                  ECSEXT01
  1366     12  DE-NAME.                                                 ECSEXT01
  1367         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1368         16  DE-FNAME.                                            ECSEXT01
  1369             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1370             20  FILLER                    PIC X(9).              ECSEXT01
  1371         16  DE-INIT                       PIC X.                 ECSEXT01
  1372     12  DE-AGE                            PIC 99.                ECSEXT01
  1373     12  DE-SEX                            PIC X.                 ECSEXT01
  1374     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1375                                                                  ECSEXT01
  1376     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1377     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1378     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1379     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1380     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1381     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1382     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1383     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1384     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1385                                                                  ECSEXT01
  1386     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1387     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1388     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1389     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1390                                                                  ECSEXT01
  1391     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1392     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1393     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1394     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1395     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1396                                                                  ECSEXT01
  1397     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1398     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1399     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1400     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1401                                                                  ECSEXT01
  1402     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1403     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1404                                           PIC S9(5)V99   COMP-3.
  1405     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1406     12  FILLER REDEFINES DE-NUM-BILLED.
  1407         16  DE-CLP-STATE                  PIC XX.
  1408         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1409     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1410     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1411                                                                  ECSEXT01
  1412     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1413     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1414     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1415     12  DE-IG                             PIC X.                 ECSEXT01
  1416     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1417*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1418     12  DE-MEMBER-NO.                                            ECSEXT01
  1419         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1420         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1421         16  FILLER                        PIC X(03).             ECSEXT01
  1422     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1423                                                                  ECSEXT01
  1424     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1425         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1426                                                                  ECSEXT01
  1427     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1428     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1429                                                                  ECSEXT01
  1430     12  DE-REI-AREA.                                             ECSEXT01
  1431         16  DE-REI-COMP.                                         ECSEXT01
  1432             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1433             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1434         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1435         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1436         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1437         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1438         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1439         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1440         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1441                                                                  ECSEXT01
  1442     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1443     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1444         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1445         16  F                             PIC X.
  1446*    12  FILLER                            PIC X(5).              ECSEXT01
  1447                                                                  ECSEXT01
  1448     12  DE-BILLED-AREA.                                          ECSEXT01
  1449         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1450             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1451                                                                  ECSEXT01
  1452         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1453             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1454             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1455             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1456             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1457             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1458             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1459                                                                  ECSEXT01
  1460         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1461             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1462                                                                  ECSEXT01
  1463         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1464         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1465         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1466         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1467                                                                  ECSEXT01
  1468         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1469*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1470*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1471                                                                  ECSEXT01
  1472     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1473         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1474         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1475         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1476                                                                  ECSEXT01
  1477     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1478         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1479         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1480     12  DE-CANCEL-REASON                  PIC X.
  1481                                                                  ECSEXT01
  1482     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1483     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1484                                                                  ECSEXT01
  1485     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1486         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1487             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1488         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1489             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1490                                                                  ECSEXT01
  1491     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1492         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1493                                                                  ECSEXT01
  1494     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1495     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1496         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1497         16  FILLER                        PIC X.
  1498                                                                  ECSEXT01
  1499****************************************************************  ECSEXT01
  1500**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1501****************************************************************  ECSEXT01
  1502     12  DE-COMM-LEVELS.                                          ECSEXT01
  1503         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1504             20  DE-AGT.                                          ECSEXT01
  1505                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1506                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1507             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1508             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1509             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1510                                                                  ECSEXT01
  1511     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1512****************************************************************  ECSEXT01
  1513*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1514****************************************************************  ECSEXT01
  1515     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1516     12  FILLER                            PIC X(334).            ECSEXT01
  1517     12  DE-TYPE                           PIC X.                 ECSEXT01
  1518         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1519         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1520         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1521         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1522         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1523         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1524                                                                  ECSEXT01
  1525     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1526     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1527                                                                  ECSEXT01
  1528     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1529     12  DE-REPORTED.                                             ECSEXT01
  1530         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1531         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1532         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1533     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1534     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1535                                                                  ECSEXT01
  1536     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1537     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1538     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1539     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1540     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1541     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1542         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1543         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1544         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1545         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1546         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1547         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1548         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1549                                                                  ECSEXT01
  1550     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1551                                                                  ECSEXT01
  1552     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1553     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1554     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1555     12  FILLER                            PIC XX.                ECSEXT01
  1556     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1557                                                                  ECSEXT01
  1558     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1559     12  DE-BENEFICIARY                    PIC X(10).
  1560     12  filler redefines de-beneficiary.
  1561         16  de-birth-date                 pic 9(11)  comp-3.
  1562         16  f                             pic x(4).
  1563     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1564     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1565     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1566     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1567     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1568     12  DE-CLM-CLASS                      PIC XX.
  1569     12  DE-CLM-DEV                        PIC XXX.
  1570     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1571     12  de-xycor-cert-seq                 pic x(3).
  1572     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1573     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1574     12  DE-XYCOR-STATUS                   PIC X.
  1575     12  FILLER                            PIC X(4).              ECSEXT01
  1576                                                                  ECSEXT01
  1577     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1578                                                                  ECSEXT01
  1579****************************************************************  ECSEXT01
  1580*******               RESERVE EXTRACT                      *****  ECSEXT01
  1581****************************************************************  ECSEXT01
  1582     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1583     12  FILLER                            PIC X(334).            ECSEXT01
  1584                                                                  ECSEXT01
  1585     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1586         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1587         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1588                                                                  ECSEXT01
  1589     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1590     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1591     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1592                                                                  ECSEXT01
  1593     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1594                                                                  ECSEXT01
  1595     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1596     12  DE-RSV-REPORTED.                                         ECSEXT01
  1597         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1598         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1599         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1600     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1601                                                                  ECSEXT01
  1602     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1603     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1604     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1605                                                                  ECSEXT01
  1606     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1607     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1608     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1609                                                                  ECSEXT01
  1610     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1611                                                                  ECSEXT01
  1612     12  DE-RATE-CLASS                     PIC XX.
  1613     12  DE-DEV-CODE                       PIC XXX.
  1614     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1615     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1616     12  FILLER                            PIC X(58).             ECSEXT01
  1617                                                                  ECSEXT01
  1618     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1619******************************************************************ECSEXT01
  1620
  1621 FD  NEW-DETAIL-EXTR
  1622     BLOCK CONTAINS 0 RECORDS
  1623     RECORDING MODE F.
  1624
* 1625                                 COPY ECSEXX01.
  1626******************************************************************
  1627*                                                                *
  1628*                            ECSEXX01                            *
  1629*                            VMOD=2.015                          *
  1630*                                                                *
  1631*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1632*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1633*                                                                *
  1634*   FILE TYPE = SEQUENTIAL                                       *
  1635*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1636*                                                                *
  1637*   KEY DATA =                                   START=5, LEN=36 *
  1638*                                                                *
  1639******************************************************************
  1640******************************************************************
  1641*                   C H A N G E   L O G
  1642*
  1643* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1644*-----------------------------------------------------------------
  1645*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1646* EFFECTIVE    NUMBER
  1647*-----------------------------------------------------------------
  1648*                                    TEMPORARY
  1649******************************************************************
  1650
  1651 01  NEW-DETAIL-EXTRACT.
  1652     02 NEW-DETAIL-FILE.
  1653     12  DX-RECORD-ID                      PIC XX.
  1654         88  VALID-DX-ID                      VALUE 'DX'.
  1655
  1656     12  DX-COMPANY-CD                     PIC X.
  1657
  1658     12  DX-REIN                           PIC X.
  1659
  1660     12  DX-CONTROL.
  1661         16  DX-CNTRL1.
  1662             20  DX-CARRIER                PIC X.
  1663             20  DX-GROUPING.
  1664                 24  DX-GROUP-PREFIX       PIC XXX.
  1665                 24  DX-GROUP-PRIME        PIC XXX.
  1666             20  DX-STATE                  PIC XX.
  1667             20  DX-ACCOUNT.
  1668                 24  DX-ACCT-PREFIX        PIC X(4).
  1669                 24  DX-ACCT-PRIME         PIC X(6).
  1670         16  DX-CNTRL2.
  1671             20  DX-EFF                    PIC 9(11)  COMP-3.
  1672             20  DX-CERT.
  1673                 24 DX-CERT-NO.
  1674                     28  DX-CRT-PREFIX     PIC XXX.
  1675                     28  DX-CRT-PRIME      PIC X(7).
  1676                 24  DX-CRT-SUF            PIC X.
  1677
  1678     12  DX-TRANS                          PIC X.
  1679         88  DX-ISSUE                         VALUE 'I'.
  1680         88  DX-RC-ISSUE                      VALUE '8'.
  1681         88  DX-CANCEL                        VALUE 'C'.
  1682         88  DX-RC-CANCEL                     VALUE '7'.
  1683         88  DX-CLAIM                         VALUE 'X'.
  1684         88  DX-RESTORE                       VALUE 'R'.
  1685         88  DX-RESERVE                       VALUE 'Y'.
  1686         88  DX-RR-RC-ISS                     VALUE 'J'.
  1687         88  DX-RR-RC-CNC                     VALUE 'K'.
  1688         88  DX-RR-RC-CLM                     VALUE 'L'.
  1689
  1690     12  DX-REPORT-CODX-1                  PIC X(10).
  1691     12  DX-REPORT-CODX-2                  PIC X(10).
  1692
  1693     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1694         16  DX-LNAME                      PIC X(15).
  1695         16  DX-FNAME.
  1696             20  DX-1ST-INIT-FNAME         PIC X.
  1697             20  FILLER                    PIC X(9).
  1698         16  DX-INIT                       PIC X.
  1699     12  DX-AGE                            PIC 99.
  1700     12  DX-SEX                            PIC X.
  1701     12  DX-SOC-SEC-NO                     PIC X(11).
  1702
  1703     12  DX-LF-TYPE                        PIC XX.
  1704     12  DX-LF-TERM                        PIC 999        COMP-3.
  1705     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1706     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1707     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1708     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1709     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1710     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1711     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1712
  1713     12  DX-LF-STAT-CDE                    PIC X.
  1714     12  DX-LF-PREV-STAT                   PIC X.
  1715     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1716     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1717
  1718     12  DX-AH-TYPE                        PIC XX.
  1719     12  DX-AH-TERM                        PIC 999        COMP-3.
  1720     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1721     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1722     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1723
  1724     12  DX-AH-STAT-CDE                    PIC X.
  1725     12  DX-AH-PREV-STAT                   PIC X.
  1726     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1727     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1728
  1729     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1730     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1731                                           PIC S9(5)V99   COMP-3.
  1732     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1733     12  FILLER REDEFINES DX-NUM-BILLED.
  1734         16  DX-CLP-STATE                  PIC XX.
  1735         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1736     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1737     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1738
  1739     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1740     12  DX-PMT-FREQ                       PIC 99.
  1741     12  DX-ACC-GPCD                       PIC XX.
  1742     12  DX-IG                             PIC X.
  1743     12  DX-REMIT-TO                       PIC XX.
  1744*    12  DX-MEMBER-NO                      PIC X(12).
  1745     12  DX-MEMBER-NO.
  1746         16  DX-MASTER-POLICY              PIC X(06).
  1747         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1748         16  FILLER                        PIC X(03).
  1749     12  DX-LN-OFFICER                     PIC XXX.
  1750
  1751     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1752         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1753
  1754     12  DX-ENTRY-STATUS                   PIC X.
  1755     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1756
  1757     12  DX-REI-AREA.
  1758         16  DX-REI-COMP.
  1759             20  DX-REINCO                 PIC XXX.
  1760             20  DX-REINCO-SUB             PIC XXX.
  1761         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1762         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1763         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1764         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1765         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1766         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1767         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1768
  1769     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1770     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1771         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1772         16  F                             PIC X.
  1773*    12  FILLER                            PIC X(5).
  1774
  1775     12  DX-BILLED-AREA.
  1776         16  DX-GL-INTERFACE-CODES.
  1777             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1778
  1779         16  DX-BILL-SW                    PIC X.
  1780             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1781             88  DX-RECORD-RETURNED           VALUE 'R'.
  1782             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1783             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1784             88  DX-OVERRIDX-AH               VALUE 'A'.
  1785             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1786
  1787         16  DX-REFUND-SW                  PIC X.
  1788             88  DX-REFUND-CREATED            VALUE 'Y'.
  1789
  1790         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1791         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1792         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1793         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1794
  1795         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1796*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1797*            88  DX-BILLED-GA                 VALUE 'B'.
  1798
  1799     12  DX-BILL-STATUS                    PIC X.
  1800         88  DX-NO-PRE-BILL                   VALUE ' '.
  1801         88  DX-BILLED                        VALUE 'B'.
  1802         88  DX-REVERSE                       VALUE 'R'.
  1803
  1804     12  DX-REVERSE-REASONS.
  1805         16  DX-REVERSE-REASON-1           PIC X.
  1806         16  DX-REVERSE-REASON-2           PIC X.
  1807     12  DX-CANCEL-REASON                  PIC X.
  1808
  1809     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1810     12  DX-RECALC-TYPE                    PIC X.
  1811
  1812     12  DX-CHARGEBACK-CODES.
  1813         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1814             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1815         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1816             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1817
  1818     12  DX-UNDERWRITING-CODE              PIC X.
  1819         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1820
  1821     12  DX-NCL-POOL-CODE                  PIC XXX.
  1822     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1823         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1824         16  FILLER                        PIC X.
  1825
  1826****************************************************************
  1827**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1828****************************************************************
  1829     12  DX-COMM-LEVELS.
  1830         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1831             20  DX-AGT.
  1832                 24  DX-AGT-PREFIX         PIC X(4).
  1833                 24  DX-AGT-PRIME          PIC X(6).
  1834             20  DX-AGT-TYPE               PIC X.
  1835             20  DX-L-PC                   PIC S999V99    COMP-3.
  1836             20  DX-A-PC                   PIC S999V99    COMP-3.
  1837
  1838     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1839****************************************************************
  1840*******                 CLAIM EXTRACT                      *****
  1841****************************************************************
  1842     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1843     12  FILLER                            PIC X(334).
  1844     12  DX-TYPE                           PIC X.
  1845         88  DX-DTH                           VALUE '1'.
  1846         88  DX-AH                            VALUE '2'.
  1847         88  DX-OB-DTH                        VALUE '3'.
  1848         88  DX-OB-AH                         VALUE '4'.
  1849         88  DX-DEATH                         VALUES '1' '3'.
  1850         88  DX-DISABILITY                    VALUES '2' '4'.
  1851
  1852     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1853     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1854
  1855     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1856     12  DX-REPORTED.
  1857         16  DX-RPT-YR                     PIC 99.
  1858         16  DX-RPT-MO                     PIC 99.
  1859         16  DX-RPT-DA                     PIC 99.
  1860     12  DX-PAY                            PIC 9(11)      COMP-3.
  1861     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1862
  1863     12  DX-CNUM                           PIC X(7).
  1864     12  DX-CHECK                          PIC X(7).
  1865     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1866     12  DX-DAYS-DISAB                     PIC 999.
  1867     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1868     12  DX-PAY-CODE                       PIC X.
  1869         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1870         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1871         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1872         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1873         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1874         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1875         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1876
  1877     12  DX-CLM-ERR                        PIC XX.
  1878
  1879     12  DX-ACC-NAME                       PIC X(30).
  1880     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1881     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1882     12  FILLER                            PIC XX.
  1883     12  DX-LOAN-OFFICER                   PIC XXX.
  1884
  1885     12  DX-LOAN-TYPE                      PIC X(02).
  1886     12  DX-BENEFICIARY                    PIC X(10).
  1887     12  filler redefines DX-beneficiary.
  1888         16  DX-birth-date                 pic 9(11)  comp-3.
  1889         16  f                             pic x(4).
  1890     12  DX-LOAN-CLASS                     PIC X(02).
  1891     12  DX-LOSS-CODE                      PIC X(06).
  1892     12  DX-ASSOCIATES                     PIC X(01).
  1893     12  DX-LEGAL-STATE                    PIC X(02).
  1894     12  DX-CLM-CAUSE                      PIC X(6).
  1895     12  DX-CLM-CLASS                      PIC XX.
  1896     12  DX-CLM-DEV                        PIC XXX.
  1897     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1898     12  DX-xycor-cert-seq                 pic x(3).
  1899     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1900     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1901     12  DX-XYCOR-STATUS                   PIC X.
  1902     12  FILLER                            PIC X(4).
  1903
  1904     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1905
  1906****************************************************************
  1907*******               RESERVE EXTRACT                      *****
  1908****************************************************************
  1909     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1910     12  FILLER                            PIC X(334).
  1911
  1912     12  DX-RESERVE-TYPE                   PIC X.
  1913         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1914         88  DX-AH-RSV                        VALUE '2' '4'.
  1915
  1916     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1917     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1918     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1919
  1920     12  DX-CLMNO                          PIC X(7).
  1921
  1922     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1923     12  DX-RSV-REPORTED.
  1924         16  DX-RSV-RPT-YR                 PIC 99.
  1925         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1926         16  DX-RSV-RPT-DA                 PIC 99.
  1927     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1928
  1929     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1930     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1931     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1932
  1933     12  DX-RSV-ACC-NAME                   PIC X(30).
  1934     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1935     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1936
  1937     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1938
  1939     12  DX-RATE-CLASS                     PIC XX.
  1940     12  DX-DEV-CODE                       PIC XXX.
  1941     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1942     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1943     12  FILLER                            PIC X(58).
  1944
  1945     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1946******************************************************************
  1947
  1948 FD  SUMMARY-EXTR
  1949     BLOCK CONTAINS 0 RECORDS
  1950     RECORDING MODE F.
  1951
* 1952                             COPY ECSEPC01.
  1953******************************************************************
  1954*                                                                *
  1955*                            ECSEPC01                            *
  1956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1957*                            VMOD=2.008                          *
  1958*                                                                *
  1959*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1960*                                                                *
  1961*   FILE TYPE = SEQUENTIAL                                       *
  1962*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1963*                                                                *
  1964*   KEY DATA =                                  START=5, LEN=31  *
  1965*                                                                *
  1966*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1967*                                                                *
  1968******************************************************************
  1969
  1970 01  EP-RECORD.
  1971     02 EP-FILE.
  1972     12  EP-RECORD-ID                      PIC XX.
  1973         88  VALID-EP-ID                      VALUE 'EP'.
  1974
  1975     12  EP-COMPANY-CD                     PIC X.
  1976
  1977     12  EP-REIN                           PIC X.
  1978         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1979
  1980     12  EP-CONTROL.
  1981         16  EP-CNTRL-1.
  1982             20  EP-COMPANY.
  1983                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  41
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1984                 24  EP-GROUPING.
  1985                     28  EP-GROUP-PREFIX   PIC XXX.
  1986                     28  EP-GROUP-PRIME    PIC XXX.
  1987             20  EP-STATE                  PIC XX.
  1988             20  EP-ACCOUNT.
  1989                 24  EP-ACCT-PREFIX        PIC X(4).
  1990                 24  EP-ACCT-PRIME         PIC X(6).
  1991         16  EP-CNTRL-2.
  1992             20  EP-DATES.
  1993                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1994                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1995
  1996     12  EP-REI-CO.
  1997         16  EP-REINCO                     PIC XXX.
  1998         16  EP-REINCO-SUB                 PIC XXX.
  1999
  2000     12  EP-RCD-TYPE                       PIC X.
  2001         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  2002         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  2003         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  2004         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2005         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2006         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2007     12  EP-BEN-CODE                       PIC XX.
  2008     12  FILLER                            PIC X.
  2009
  2010     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2011     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2012     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2013
  2014     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2015     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2016     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2017
  2018     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2019     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2020     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2021     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2022
  2023     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2024     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2025     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2026
  2027     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2028     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2029     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2030
  2031     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2032     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2033     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2034     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2035     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2036
  2037     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2038     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2039     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2040
  2041     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  42
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2042     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2043     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2044
  2045     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2046         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2047         16  EP-NEW-DATA-IND               PIC X(01).
  2048             88  EP-NEW-DATA                   VALUE 'Y'.
  2049         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2050         16  FILLER                        PIC X(19).
  2051
  2052     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2053     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2054     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2055
  2056     12  FILLER                            PIC XXX.
  2057
  2058     12  EP-UNDERWRITING-CODE              PIC X.
  2059         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2060
  2061     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
  2062
  2063     12  FILLER                            PIC X(30).
  2064*    12  FILLER                            PIC X(34).
  2065
  2066     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2067     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2068     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2069     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2070     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2071     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2072
  2073     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2074
  2075     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2076     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2077
  2078     12  EP-PURGE                          PIC X.
  2079         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2080
  2081     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2082
  2083     02 EC-RECORD     REDEFINES     EP-FILE.
  2084     12  EC-RECORD-ID                      PIC XX.
  2085         88  VALID-EC-ID                      VALUE 'EC'.
  2086
  2087     12  EC-COMPANY-CD                     PIC X.
  2088
  2089     12  EC-REIN                           PIC X.
  2090         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2091
  2092     12  EC-CONTROL.
  2093         16  EC-CARRIER                    PIC X.
  2094         16  EC-GROUPING.
  2095             20  EC-GROUP-PREFIX           PIC XXX.
  2096             20  EC-GROUP-PRIME            PIC XXX.
  2097         16  EC-STATE                      PIC XX.
  2098         16  EC-ACCOUNT.
  2099             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  43
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2100             20  EC-ACCT-PRIME             PIC X(6).
  2101         16  EC-DATES.
  2102             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2103             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2104
  2105     12  EC-REI-CO.
  2106         16  EC-REINCO                     PIC XXX.
  2107         16  EC-REINCO-SUB                 PIC XXX.
  2108
  2109     12  EC-RCD-TYPE                       PIC X.
  2110         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2111         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2112         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2113         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2114         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2115     12  EC-BEN-CODE                       PIC XX.
  2116     12  EC-SEQ-NBR                        PIC X.
  2117         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2118         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2119
  2120     12  EC-AGENTS-DATA.
  2121         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2122             20  EC-AGT-NO.
  2123                 24  EC-AGT-PREFIX         PIC X(4).
  2124                 24  EC-AGT-PRIME          PIC X(6).
  2125             20  EC-AGT-TYPE               PIC X.
  2126             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2127             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2128             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2129             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2130             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2131
  2132     12  EC-UNDERWRITING-CODE              PIC X.
  2133         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2134
  2135     12  EC-AGENTS-DATA-II.
  2136         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2137             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2138             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2139
  2140     12  FILLER                            PIC X(7).
  2141
  2142     12  EC-PURGE                          PIC X.
  2143         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2144
  2145     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2146
  2147******************************************************************
  2148
  2149 FD  ERRESC-IN.
* 2150                             COPY ERCRESC.
  2151******************************************************************04/29/98
  2152*                                                                *ERCRESC
  2153*                            ERCRESC                             *   LV002
  2154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2155*                            VMOD=2.003                          *   CL**2
  2156*                                                                *ERCRESC
  2157*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2158*                                                                *ERCRESC
  2159*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2160*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2161*                                                                *ERCRESC
  2162*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2163*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2164*                                                                *ERCRESC
  2165*   LOG = NO                                                     *ERCRESC
  2166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2167*                                                                *ERCRESC
  2168******************************************************************ERCRESC
  2169                                                                  ERCRESC
  2170 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2171                                                                  ERCRESC
  2172     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2173         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2174         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2175         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2176         15  RESC-STATE                PIC   XX.                  ERCRESC
  2177         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2178         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2179         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2180         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2181*                                           YYYYMMDD              ERCRESC
  2182     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2183                                                                  ERCRESC
  2184     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2185         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2186             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2187             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2188             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2189                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2190                                                                  ERCRESC
  2191     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2192     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2193     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2194*                                          YYYYMMDD               ERCRESC
  2195 FD  ELCRTT.
  2196
* 2197                             COPY ELCCRTT.
  2198******************************************************************
  2199*                                                                *ELCCRTT
  2200*                            ELCCRTT.                            *
  2201*                                                                *ELCCRTT
  2202*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2203*                                                                *ELCCRTT
  2204*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2205*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2206*                                                                *ELCCRTT
  2207*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2208*                                                                *ELCCRTT
  2209*   LOG = YES                                                    *ELCCRTT
  2210*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2211******************************************************************
  2212*                   C H A N G E   L O G
  2213*
  2214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2215*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  45
* ECS010.cbl (/apps/test/cid1s/copy/ELCCRTT)
  2216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2217* EFFECTIVE    NUMBER
  2218*-----------------------------------------------------------------
  2219* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2220* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2221* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2222* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2223* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2224* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2225******************************************************************
  2226                                                                  ELCCRTT
  2227 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2228     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2229         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2230                                                                  ELCCRTT
  2231     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2232         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2233         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2234         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2235         16  CS-STATE                      PIC XX.                ELCCRTT
  2236         16  CS-ACCOUNT                    PIC X(10).
  2237         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2238         16  CS-CERT-NO.                                          ELCCRTT
  2239             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2240             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2241         16  CS-TRAILER-TYPE               PIC X.
  2242             88  COMM-TRLR           VALUE 'A'.
  2243             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2244             88  CERT-DATA-TRLR      VALUE 'C'.
  2245                                                                  ELCCRTT
  2246     12  CS-DATA-AREA                      PIC X(516).
  2247
  2248     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2249         16  CS-BANK-COMMISSION-AREA.
  2250             20  CS-BANK-COMMS       OCCURS 10.
  2251                 24  CS-AGT                PIC X(10).
  2252                 24  CS-COM-TYP            PIC X.
  2253                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2254                 24  CS-RECALC-LV-INDIC    PIC X.
  2255                 24  FILLER                PIC X(10).
  2256
  2257         16  FILLER                        PIC X(256).
  2258
  2259     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2260****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2261
  2262         16  CS-MB-CLAIM-DATA OCCURS 24.
  2263             20  CS-CLAIM-NO               PIC X(7).
  2264             20  CS-CLAIM-TYPE             PIC X.
  2265                 88  CS-AH-CLM               VALUE 'A'.
  2266                 88  CS-IU-CLM               VALUE 'I'.
  2267                 88  CS-GP-CLM               VALUE 'G'.
  2268                 88  CS-LF-CLM               VALUE 'L'.
  2269                 88  CS-PR-CLM               VALUE 'P'.
  2270             20  CS-INSURED-TYPE           PIC X.
  2271                 88  CS-PRIM-INSURED          VALUE 'P'.
  2272                 88  CS-CO-BORROWER           VALUE 'C'.
  2273             20  CS-BENEFIT-PERIOD         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  46
* ECS010.cbl (/apps/test/cid1s/copy/ELCCRTT)
  2274             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2275             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2276             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2277         16  FILLER                        PIC X(12).
  2278
  2279     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2280         16  CS-VIN-NUMBER                 PIC X(17).
  2281         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2282         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2283         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2284         16  FILLER                        PIC X(496).
  2285
  2286 FD  ERAGTC.
  2287
* 2288                             COPY ERCAGTC.
  2289******************************************************************
  2290*                                                                *
  2291*                                                                *
  2292*                            ERCAGTC                             *
  2293*                            VMOD=2.001                          *
  2294*                                                                *
  2295*   ONLINE CREDIT SYSTEM                                         *
  2296*                                                                *
  2297*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2298*                                                                *
  2299*   FILE TYPE = VSAM,KSDS                                        *
  2300*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2301*                                                                *
  2302*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2303*       ALTERNATE PATH = NONE                                    *
  2304*                                                                *
  2305*   LOG = NO                                                     *
  2306*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2307*                                                                *
  2308******************************************************************
  2309*                   C H A N G E   L O G
  2310*
  2311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2312*-----------------------------------------------------------------
  2313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2314* EFFECTIVE    NUMBER
  2315*-----------------------------------------------------------------
  2316* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2317* 111004                         NEW FILE AND COPYBOOK
  2318* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2319******************************************************************
  2320
  2321 01  AGENT-COMMISSIONS.
  2322     12  AG-RECORD-ID                          PIC XX.
  2323         88  VALID-CO-ID                          VALUE 'AG'.
  2324
  2325     12  AG-CONTROL-PRIMARY.
  2326         16  AG-COMPANY-CD                     PIC X.
  2327         16  AG-CONTROL.
  2328             20  AG-CTL-1.
  2329                 24  AG-CARR-GROUP.
  2330                     28  AG-CARRIER            PIC X.
  2331                     28  AG-GROUPING           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2332                 24  AG-BANK                   PIC X(10).
  2333             20  AG-CTL-2.
  2334                 24  AG-EXP-DT                 PIC XX.
  2335         16  AG-TYPE                           PIC X.
  2336             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2337             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2338
  2339     12  AG-MAINT-INFORMATION.
  2340         16  AG-LAST-MAINT-DT                  PIC XX.
  2341         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2342         16  AG-LAST-MAINT-USER                PIC X(4).
  2343         16  FILLER                            PIC X(10).
  2344
  2345     12  AG-EFF-DT                             PIC XX.
  2346     12  AG-COMM-STRUCTURE.
  2347         16  AG-AGT-COMMS OCCURS 10.
  2348             20  AG-AGT                PIC X(10).
  2349             20  AG-COM-TYP            PIC X.
  2350             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2351             20  AG-RECALC-LV-INDIC    PIC X.
  2352             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2353             20  AG-LRCALC-LV-INDIC    PIC X.
  2354             20  FILLER                PIC X(05).
  2355
  2356     12  FILLER                  PIC X(145).
  2357******************************************************************
  2358
  2359 FD  ERPDEF.
  2360
* 2361                             COPY ERCPDEF.
  2362******************************************************************
  2363*                                                                *
  2364*                                                                *
  2365*                            ERCPDEF.                            *
  2366*                                                                *
  2367*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2368*                                                                *
  2369*    FILE TYPE = VSAM,KSDS                                       *
  2370*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2371*                                                                *
  2372*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2373*                                                                *
  2374*    LOG = YES                                                   *
  2375*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2376******************************************************************
  2377*                   C H A N G E   L O G
  2378*
  2379* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2380*-----------------------------------------------------------------
  2381*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2382* EFFECTIVE    NUMBER
  2383*-----------------------------------------------------------------
  2384* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2385******************************************************************
  2386 01  PRODUCT-MASTER.
  2387    12  PD-RECORD-ID                 PIC X(02).
  2388        88  VALID-PD-ID                  VALUE 'PD'.
  2389
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  48
* ECS010.cbl (/apps/test/cid1s/copy/ERCPDEF)
  2390    12  PD-CONTROL-PRIMARY.
  2391        16  PD-COMPANY-CD            PIC X.
  2392        16  PD-STATE                 PIC XX.
  2393        16  PD-PRODUCT-CD            PIC XXX.
  2394        16  PD-FILLER                PIC X(7).
  2395        16  PD-BEN-TYPE              PIC X.
  2396        16  PD-BEN-CODE              PIC XX.
  2397        16  PD-PROD-EXP-DT           PIC XX.
  2398
  2399    12  FILLER                       PIC X(50).
  2400
  2401    12  PD-PRODUCT-DATA OCCURS 8.
  2402        16  PD-PROD-CODE             PIC X.
  2403            88  PD-PROD-LIFE           VALUE 'L'.
  2404            88  PD-PROD-PROP           VALUE 'P'.
  2405            88  PD-PROD-AH             VALUE 'A'.
  2406            88  PD-PROD-IU             VALUE 'I'.
  2407            88  PD-PROD-GAP            VALUE 'G'.
  2408            88  PD-PROD-FMLA           VALUE 'F'.
  2409        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2410        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2411        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2412        16  PD-MAX-TERM              PIC S999        COMP-3.
  2413        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2414        16  FILLER                   PIC X.
  2415        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2416        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2417        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2418        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2419        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2420        16  PD-REC-CRIT-PERIOD       PIC 99.
  2421        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2422            20  PD-RECURRING-YN      PIC X.
  2423            20  FILLER               PIC X.
  2424        16  PD-RTW-MOS               PIC 99.
  2425        16  PD-MAX-EXTENSION         PIC 99.
  2426        16  FILLER                   PIC XX.
  2427
  2428    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2429
  2430    12  PD-TERM-LIMITS OCCURS 15.
  2431        16  PD-LOW-TERM              PIC S999        COMP-3.
  2432        16  PD-HI-TERM               PIC S999        COMP-3.
  2433
  2434*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2435    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2436        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2437        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2438
  2439    12  PD-EARN-FACTORS.
  2440        16  FILLER OCCURS 15.
  2441            20  FILLER OCCURS 15.
  2442                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2443
  2444    12  PD-PRODUCT-DESC              PIC X(80).
  2445    12  PD-TRUNCATED                 PIC X.
  2446    12  FILLER                       PIC X(59).
  2447
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  49
* ECS010.cbl (/apps/test/cid1s/copy/ERCPDEF)
  2448    12  PD-MAINT-INFORMATION.
  2449        16  PD-LAST-MAINT-DT         PIC X(02).
  2450        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2451        16  PD-LAST-MAINT-BY         PIC X(04).
  2452
  2453 FD  ME-ECS010-BALANCE
  2454     RECORDING MODE IS F
  2455     BLOCK CONTAINS 0 RECORDS.
  2456 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2457
  2458 FD  ME50-ECS010-BALANCE
  2459     RECORDING MODE IS F
  2460     BLOCK CONTAINS 0 RECORDS.
  2461 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2462
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  50
* ECS010.cbl
  2464 FD  DISK-DATE
* 2465                             COPY ELCDTEFD.
  2466******************************************************************04/15/98
  2467*                                                                *ELCDTEFD
  2468*                                                                *ELCDTEFD
  2469*                            ELCDTEFD.                           *   LV002
  2470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2471*                            VMOD=2.007                          *   CL**2
  2472*                                                                *ELCDTEFD
  2473******************************************************************ELCDTEFD
  2474     BLOCK CONTAINS 0 RECORDS
  2475     RECORDING MODE F.                                            ELCDTEFD
  2476                                                                  ELCDTEFD
  2477 01  DATE-DISK.                                                   ELCDTEFD
  2478     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2479     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2480     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2481     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2482     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2483     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2484     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2485                                                                  ELCDTEFD
  2486 01  DATE-DISK-R.                                                 ELCDTEFD
  2487     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2488     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2489                                     PIC  X(32).                  ELCDTEFD
  2490                                                                  ELCDTEFD
  2491 01  DATE-DISK-T.                                                 ELCDTEFD
  2492     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2493     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2494                                     PIC  X(48).                  ELCDTEFD
  2495                                                                  ELCDTEFD
  2496 01  DATE-DISK-M.                                                 ELCDTEFD
  2497     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2498     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2499                                     PIC  X(48).                  ELCDTEFD
  2500                                                                  ELCDTEFD
  2501 01  DATE-DISK-P.                                                 ELCDTEFD
  2502     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2503     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2504     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2505     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2506         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2507                                     PIC  X.                      ELCDTEFD
  2508         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2509     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2510         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2511             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2512             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2513             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2514             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2515         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2516                                                                  ELCDTEFD
  2517 01  DATE-DISK-E.                                                 ELCDTEFD
  2518     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2519     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2520                                     PIC  X(4).                   ELCDTEFD
  2521                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  51
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2522 01  DATE-DISK-C.                                                 ELCDTEFD
  2523     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2524     12  DD-CARR1-SECPAY-SW          PIC  X.
  2525     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2526     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2527     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2528     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2529     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2530     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2531     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2532     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2533     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2534     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2535     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2536     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2537     12  DD-CARR2-SECPAY-SW          PIC  X.
  2538     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2539                                                                  ELCDTEFD
  2540 01  DATE-DISK-OPT.                                               ELCDTEFD
  2541     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2542     12  DD-TLR-DATA.                                             ELCDTEFD
  2543         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2544                                     PIC  X(03).                  ELCDTEFD
  2545     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2546         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2547                                     PIC  X(06).                  ELCDTEFD
  2548     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2549         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2550                                     PIC  X(07).                  ELCDTEFD
  2551         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2552     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2553                                     PIC  X(96).                  ELCDTEFD
  2554******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  52
* ECS010.cbl
  2556 FD  PRINT-COPY
* 2557                             COPY ELCPRTFD.
  2558******************************************************************04/15/98
  2559*                                                                *ELCPRTFD
  2560*                                                                *ELCPRTFD
  2561*                            ELCPRTFD.                           *   LV003
  2562*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2563*                            VMOD=2.006                          *ELCPRTFD
  2564******************************************************************ELCPRTFD
  2565     RECORDING MODE F                                             ELCPRTFD
  2566     LABEL RECORDS OMITTED                                        ELCPRTFD
  2567     BLOCK CONTAINS 0 RECORDS
  2568     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2569 01  PRT.                                                         ELCPRTFD
  2570     12  P-CTL               PIC  X.                                 CL**2
  2571     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2572******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  53
* ECS010.cbl
  2574 FD  MISMATCH-REPORT
  2575     RECORDING MODE F.
  2576
  2577 01  MISMATCH-RPT.
  2578     12  MR-CTL              PIC X.
  2579     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  54
* ECS010.cbl
  2581 FD  FICH
* 2582                             COPY ELCFCHFD.
  2583******************************************************************04/15/98
  2584*                                                                *ELCFCHFD
  2585*                            ELCFCHFD.                           *   LV003
  2586*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2587*                            VMOD=2.004                          *   CL**3
  2588*                                                                *ELCFCHFD
  2589******************************************************************ELCFCHFD
  2590     BLOCK CONTAINS 0 RECORDS
  2591     RECORDING MODE F.                                            ELCFCHFD
  2592                                                                  ELCFCHFD
  2593 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2594******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  55
* ECS010.cbl
  2596 FD  DISPLAY-PRT
  2597     RECORDING MODE IS F
  2598     LABEL RECORDS ARE STANDARD
  2599     BLOCK CONTAINS 0 RECORDS
  2600     RECORD CONTAINS 133 CHARACTERS.
  2601
  2602 01  DISPLAY-REC.
  2603     05  DISPLAY-CC           PIC X.
  2604     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  56
* ECS010.cbl
  2606 WORKING-STORAGE SECTION.
  2607 77  LCP-ASA                       PIC X.
  2608 77  FILLER  PIC X(32)  VALUE '********************************'.
  2609 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2610 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2611
  2612 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2613 77  ws-dcc-cnc-flag         pic x  value ' '.
  2614 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2615 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2616 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2617 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2618 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2619 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2620 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2621 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2622 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2623 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2624 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2625 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2626 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2627 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2628 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2629 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2630 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2631 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2632 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2633 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2634 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2635 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2636 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2637 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2638 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2639 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2640 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2641 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2642 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2643 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2644 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2645 77  X                       PIC X.
  2646 77  DD-FLG                  PIC X               VALUE SPACE.
  2647 77  AGT-SW                  PIC X               VALUE SPACE.
  2648 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2649 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2650 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2651 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2652 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2653 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2654 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2655 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2656 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2657 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2658 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2659 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2660 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2661 77  SV-TRD-CERT             PIC X(11).
  2662 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2663 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  57
* ECS010.cbl
  2664 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2665*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2666*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2667 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2668 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2669 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2670 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2671 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2672 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2673 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2674 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2675 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2676 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2677 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2678 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2679 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2680 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2681 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2682 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2683 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2684 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2685 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2686 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2687 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2688 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2689 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2690 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2691 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2692 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2693 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2694 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2695 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2696 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2697 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2698 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2699 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2700 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2701 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2702 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2703 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2704 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2705 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2706 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2707 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2708 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2709 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2710 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2711 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2712 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2713 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2714 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2715 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2716 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2717 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2718 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2719 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2720 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2721 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  58
* ECS010.cbl
  2722 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2723 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2724 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2725 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2726 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2727 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2728 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2729 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2730 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2731 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2732 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2733 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2734 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2735 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2736 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2737 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2738 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2739 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2740 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2741 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2742 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2743 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2744 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2745 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2746 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2747 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2748 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  2749 77  P1                      PIC S999 COMP-3 VALUE +0.
  2750 77  P2                      PIC S999 COMP-3 VALUE +0.
  2751 77  DD-IU-SW                    PIC X   VALUE ' '.
  2752     88  DD-IU-PRESENT                 VALUE 'Y'.
  2753 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2754 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2755 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2756 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2757 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2758 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2759 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2760 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2761 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2762 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2763 77  ws-dd-ben-type          pic x  value spaces.
  2764 77  ws-dd-ben-code          pic xx value spaces.
  2765
  2766 01  MONTH-END-DATA.
  2767     12  ME-START-DATE.
  2768         16  ME-START-MO         PIC 99.
  2769         16  FILLER              PIC X.
  2770         16  ME-START-DA         PIC 99.
  2771         16  FILLER              PIC X.
  2772         16  ME-START-YR         PIC 99.
  2773     12  ME-CNDS-DATE            PIC 9(6).
  2774     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2775         16  ME-CNDS-MO          PIC 99.
  2776         16  ME-CNDS-DA          PIC 99.
  2777         16  ME-CNDS-YR          PIC 99.
  2778     12  ME-START-TIME           PIC 9(6).
  2779     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  59
* ECS010.cbl
  2780         88  ME-DO-UPDATE        VALUE 'Y'.
  2781         88  ME-NO-UPDATE        VALUE 'N'.
  2782     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2783
  2784 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2785 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2786     'Life Claims Paid'.
  2787
  2788 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2789     'A&H Claims Paid'.
  2790
  2791 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2792     'Output Certificate Master Records Prior Month'.
  2793
  2794 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2795     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2796
  2797 01  WS-ME-BALANCE-REC.
  2798     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2799     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2800     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2801     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2802     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2803     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2804     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2805
  2806 01  WS-ME50-BALANCE-REC.
  2807     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2808     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2809     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2810     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2811     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2812     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2813     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2814     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2815     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2816
  2817 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2818 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2819 01  WS-BANK-COMMISSIONS.
  2820     12  WS-BANK-COMMS           OCCURS 10.
  2821         16  WS-BNK-AGT          PIC X(10).
  2822         16  WS-BNK-TYPE         PIC X.
  2823         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2824         16  WS-BNK-RECALC       PIC X.
  2825         16  FILLER              PIC X(10).
  2826
  2827 01  PENDING-MATCH-CONTROL.
  2828     12  PENDING-ACCOUNT-CONTROL.
  2829         16  PEND-MATCH-CARRIER    PIC X.
  2830         16  PEND-MATCH-GROUPING   PIC X(6).
  2831         16  PEND-MATCH-STATE      PIC XX.
  2832         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2833     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2834     12  PEND-MATCH-CERT-NO.
  2835         16  PEND-MATCH-CERT       PIC X(10).
  2836         16  PEND-MATCH-CERT-SFX   PIC X.
  2837 01  PENDING-RECORD-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  60
* ECS010.cbl
  2838     88  ISSUE-TRANSACTION            VALUE '1'.
  2839     88  CANCEL-TRANSACTION           VALUE '2'.
  2840     88  CLAIM-TRANSACTION            VALUE '3'.
  2841     88  RESERVE-TRANSACTION          VALUE '4'.
  2842     88  UPDATE-TRANSACTION           VALUE '5'.
  2843
  2844 01  CLM-INCUR-REIN-DATE.
  2845     12  CIRD-CCYY.
  2846         16  CIRD-CC         PIC 99.
  2847         16  CIRD-YR         PIC 99.
  2848     12  CIRD-MO             PIC 99.
  2849
  2850 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2851
  2852 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2853
  2854 01  REIN-BILLING-TABLE.
  2855     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2856         16  RB-COMPANY      PIC X(6).
  2857         16  RB-COUNT        PIC S9(5)   COMP-3.
  2858
  2859 01  B-SUB                   PIC S9(4)   COMP.
  2860
  2861 01  BINARY-COUNTERS     COMP      SYNC.
  2862     12  IA                  PIC S999            VALUE +0.
  2863     12  IB                  PIC S999            VALUE +0.
  2864     12  SUB                 PIC S999            VALUE +0.
  2865     12  SUBM                PIC S999            VALUE +0.
  2866     12  SUB3                PIC S999            VALUE +0.
  2867     12  SUB4                PIC S999            VALUE +0.
  2868     12  SUB5                PIC S999            VALUE +0.
  2869     12  SUB6                PIC S999            VALUE +0.
  2870     12  SUB7                PIC S999            VALUE +0.
  2871     12  SUB8                PIC S999            VALUE +0.
  2872     12  SUB9                PIC S999            VALUE +0.
  2873     12  SUB10               PIC S999            VALUE +0.
  2874     12  SUB11               PIC S999            VALUE +0.
  2875     12  SUB12               PIC S999            VALUE +0.
  2876     12  SUB13               PIC S999            VALUE +0.
  2877     12  SUB14               PIC S999            VALUE +0.
  2878     12  SUB15               PIC S999            VALUE +0.
  2879     12  SUB16               PIC S999            VALUE +0.
  2880     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2881 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2882
  2883 01  WS.
  2884     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2885     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2886     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2887     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2888
  2889     12  WS-ABEND-CODE         PIC 9(4).
  2890     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2891         16  ABEND-CODE-1    PIC XX.
  2892         16  ABEND-CODE-2.
  2893             20  AC2-ONE     PIC X.
  2894             20  AC2-TWO     PIC X.
  2895
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  61
* ECS010.cbl
  2896     12  CTBL-SEARCH.
  2897         16  CTBL-COMP-CD    PIC X.
  2898         16  CTBL-TABLE-CD   PIC XXX.
  2899         16  CTBL-BEN-TYPE   PIC X.
  2900         16  CTBL-BEN-CODE   PIC XX.
  2901     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2902     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2903     12  WS-COMM-TERM        PIC S999            COMP-3.
  2904     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2905         88  CTBL-ERROR         VALUE '*'.
  2906
  2907     12  REIN-SPEC.
  2908         16  REIN-SPEC-A     PIC X.
  2909         16  REIN-SPEC-B     PIC X.
  2910         16  REIN-SPEC-C     PIC X.
  2911
  2912     12  WS-CHECK-NUMBER.
  2913         16  WS-CHECK-NO     PIC X(4).
  2914         16  FILLER          PIC XXX.
  2915
  2916     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2917         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2918         88  AH-EARN-NET                         VALUE 'N'.
  2919
  2920     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2921     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2922
  2923 01  max-pdef                    pic s9(5) comp-3 value +5000.
  2924 01  DCC-DDF-WORK-AREA.
  2925     05  F OCCURS 5000.
  2926         10  DD-STATE                 PIC XX.
  2927         10  DD-PRODUCT-CD            PIC XXX.
  2928         10  DD-FILLER                PIC X(7).
  2929         10  DD-BEN-TYPE              PIC X.
  2930         10  DD-BEN-CODE              PIC XX.
  2931         10  DD-PROD-EXP-DT           PIC XX.
  2932         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2933         10  DD-PROD-DATA OCCURS 8.
  2934             15  DD-PROD-CODE         PIC X.
  2935             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2936         10  DD-EARN-FACTORS.
  2937             15  F OCCURS 15.
  2938                 20  F OCCURS 15.
  2939                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2940         10  DD-TRUNCATED        PIC X.
  2941
  2942 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2943 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2944 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2945 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2946 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2947 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2948 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2949 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2950
  2951 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2952 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2953 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  62
* ECS010.cbl
  2954 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2955
  2956 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2957     12  WS-LF-CHARGEBACK-LEVELS.
  2958         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2959     12  WS-AH-CHARGEBACK-LEVELS.
  2960         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2961 01  WS-DCC-DDF-CB.
  2962     12  WS-DCC-DDF-CB-LEVELS.
  2963         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2964*****************************************************************
  2965*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2966*****************************************************************
  2967*RESIDENT STATE TAXES MASTER(ERRESC)
  2968*
  2969 01  WORK-AREAS.
  2970     12  WS-ERRESC-KEY.
  2971         16 WS-ERRESC-SEARCH-KEY.
  2972             20  WS-ERRESC-COMPANY-CD PIC  X.
  2973             20  WS-ERRESC-CARRIER    PIC  X.
  2974             20  WS-ERRESC-GROUP      PIC X(6).
  2975             20  WS-ERRESC-STATE      PIC XX.
  2976             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2977         16 WS-ERRESC-RESIDUAL-KEY.
  2978             20  WS-ERRESC-AGENT      PIC X(10).
  2979             20  WS-ERRESC-RES-STATE  PIC XX.
  2980             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2981*                                          YYYYMMDD
  2982     12  WS-YYYYMMDD-DT               PIC 9(8).
  2983     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2984     12  WS-SUB                       PIC    99  COMP-3.
  2985     12  WS-SUB1                      PIC    99  COMP-3.
  2986*****************************************************************
  2987*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2988*****************************************************************
  2989
  2990 01  COMM-WORK-AREAS.
  2991     12  FILLER              PIC  X(17)
  2992         VALUE 'COMMON WORK AREAS'.
  2993     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2994     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2995     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2996     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2997     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2998     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2999     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3000     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3001     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3002     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3003     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3004     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3005     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3006     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3007     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  3008     12  W-CERT-COUNT        PIC S9(08)  COMP.
  3009     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  3010     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  3011     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  63
* ECS010.cbl
  3012
  3013     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  3014                                         COMP-3 VALUE ZEROS.
  3015     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  3016                                         COMP-3 VALUE ZEROS.
  3017     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  3018                                         COMP-3 VALUE ZEROS.
  3019     12  W-EDIT-FIELD        PIC ----------9.
  3020     12  W-EDIT-FIELD2       PIC ----------9.99.
  3021     12  W-EDIT-7            PIC Z(06)9.
  3022     12  W-FACTOR            PIC S9(09)V9(08)
  3023                                         COMP-3 VALUE ZEROS.
  3024     12  W-IBNR-1            PIC S9(07)V9(02)
  3025                                         COMP-3 VALUE ZEROS.
  3026     12  W-IBNR-2            PIC S9(07)V9(02)
  3027                                         COMP-3 VALUE ZEROS.
  3028     12  W-ISS-BEN           PIC S9(11)V9(02)
  3029                                         COMP-3 VALUE ZEROS.
  3030     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  3031                                         COMP-3 VALUE ZEROS.
  3032     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3033     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  3034     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3035     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3036     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3037     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3038     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3039     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  3040     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3041     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3042     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3043     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3044     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3045     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3046     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3047     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3048                                         COMP-3 VALUE ZEROS.
  3049     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3050     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3051     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3052     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3053     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3054     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3055     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3056     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3057     12  W-POLICY-INACTIVE-CTR
  3058                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3059     12  W-POLICY-REISSUE-CTR
  3060                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3061     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3062     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3063     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3064                                         COMP-3 VALUE ZEROS.
  3065     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3066     12  W-WK-IBNR           PIC S9(07)V9(02)
  3067                                         COMP-3 VALUE ZEROS.
  3068
  3069     12  W-CLAIM-TYPE        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  64
* ECS010.cbl
  3070         88  W-A-H                              VALUE 'A'.
  3071         88  W-LIFE                             VALUE 'L'.
  3072     12  W-CUTOFF-DATE       PIC  9(08).
  3073     12  W-DIS-DT            PIC  XX.
  3074     12  W-DIS-PTO-DT        PIC  XX.
  3075     12  WK-LEVEL.
  3076         16  WK-AGT          PIC X(10).
  3077         16  WK-A-TYPE       PIC X.
  3078         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3079         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3080         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3081         16  FILLER          PIC X(6).
  3082     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3083         16  FILLER          PIC X(11).
  3084         16  WK-L-RTX        PIC X(3).
  3085         16  WK-J-RTX        PIC X(3).
  3086         16  WK-A-RTX        PIC X(3).
  3087         16  FILLER          PIC X(6).
  3088     12  WK-NEW-RATES.
  3089         16  WK-N-R      OCCURS 10.
  3090             20  WK-N-AGT    PIC X(10).
  3091             20  WK-N-TYPE   PIC X.
  3092             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3093             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3094     12  W-LIFE-YEARS-ZERO.
  3095         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3096         16  FILLER          PIC  X(01)         VALUE SPACES.
  3097         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3098         16  FILLER          PIC  X(01)         VALUE SPACES.
  3099         16  FILLER          PIC  X(01)         VALUE SPACES.
  3100         16  FILLER          PIC  X(01)         VALUE SPACES.
  3101         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3102         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3103         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3104         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3105         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3106         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3107         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3108         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3109         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3110         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3111         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3112         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3113         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3114         16  FILLER          PIC S9(09)V9(02) COMP-3
  3115                                                VALUE ZEROS.
  3116         16  FILLER          PIC S9(09)V9(02) COMP-3
  3117                                                VALUE ZEROS.
  3118         16  FILLER          PIC S9(09)V9(02) COMP-3
  3119                                                VALUE ZEROS.
  3120         16  FILLER          PIC S9(09)V9(02) COMP-3
  3121                                                VALUE ZEROS.
  3122         16  FILLER          PIC S9(11)V9(02) COMP-3
  3123                                                VALUE ZEROS.
  3124
  3125     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3126         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3127     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  65
* ECS010.cbl
  3128         88  W-REIN-PROCESS                     VALUE 'Y'.
  3129         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  3130     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  3131         88  W-SELECTION-ON                     VALUE 'Y'.
  3132         88  W-SELECTION-OFF                    VALUE SPACES.
  3133     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3134         88  W-RTRM-0                           VALUE 'Y'.
  3135         88  W-RTRM-NOT-0                       VALUE SPACES.
  3136     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3137     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3138         88  W-TABLE-USED                       VALUE 'Y'.
  3139         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3140     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3141         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3142
  3143     12  W-VAL-ERRORS.
  3144         16  FILLER          PIC  X(40)
  3145             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3146         16  FILLER          PIC  X(40)
  3147             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3148         16  FILLER          PIC  X(40)
  3149             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3150         16  FILLER          PIC  X(40)
  3151             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3152         16  FILLER          PIC  X(40)
  3153             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3154         16  FILLER          PIC  X(40)
  3155             VALUE 'RUN DATE EPEC - A&H - '.
  3156         16  FILLER          PIC  X(40)
  3157             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3158         16  FILLER          PIC  X(40)
  3159             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3160         16  FILLER          PIC  X(40)
  3161             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3162     12  FILLER REDEFINES W-VAL-ERRORS.
  3163         16  W-VAL-ERROR OCCURS 9 TIMES
  3164                             PIC  X(40).
  3165
  3166     12  W-WORK-DATE         PIC  X(02).
  3167     12  SAVE-WK-NEW-RATES.
  3168         16  FILLER          PIC X(170).
  3169
  3170***   The following data area is for NCL only
  3171*    12  W-WORK-OB-DATA OCCURS 300.
  3172*    12  W-WORK-OB-DATA OCCURS 220.
  3173     12  W-WORK-OB-DATA OCCURS 900.
  3174         16  WS-OB-REIN-CO       PIC X(06).
  3175         16  WS-OB-LF-AH         PIC X.
  3176         16  WS-OB-BENEFIT-CODE  PIC XX.
  3177         16  WS-OB-EARNED OCCURS 3.
  3178             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3179
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  66
* ECS010.cbl
  3181 01  EPEC-WORK-AREAS.
  3182     12  WE-REIN-CO          PIC X(6).
  3183     12  WE-LF-AH            PIC X.
  3184     12  WE-BEN-TYPE         PIC XX.
  3185     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3186     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3187     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3188     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3189     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3190     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3191     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3192     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3193     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3194     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3195     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3196     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3197     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3198     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3199     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3200     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3201     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3202     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3203     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3204     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3205     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3206     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3207     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3208     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3209     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3210     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3211     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3212     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3213     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3214     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3215     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3216     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3217     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3218     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3219     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3220     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3221     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3222     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3223     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3224     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3225     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3226     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3227     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3228     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3229     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3230     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3231     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3232     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3233     12  WX-SETTLEMENT-EXIT-DATE
  3234                             PIC  9(11)      COMP-3.
  3235     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3236     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3237     12  WX-STATUS-AT-SETTLEMENT
  3238                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  67
* ECS010.cbl
  3239     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3240
  3241 01  EPEC-WORK.
  3242     12  EW-REIN-CO          PIC X(6).
  3243     12  EW-SUB-KEY.
  3244         16  EW-LF-AH        PIC X.
  3245         16  EW-BEN-TYPE     PIC XX.
  3246     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3247     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3248     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3249     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3250     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3251     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3252     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3253     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3254     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3255     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3256     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3257     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3258     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3259     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3260     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3261     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3262     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3263     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3264     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3265     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3266     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3267     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3268     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3269     12  EW-AGENTS       OCCURS 10.
  3270         16  EW-AGT-NO       PIC X(10).
  3271         16  EW-AGT-TYPE     PIC X.
  3272         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3273         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3274         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3275         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3276         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3277         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3278         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3279     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3280     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3281     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3282     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3283     12  EW-AGE              PIC S9(9)       COMP-3.
  3284     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3285     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3286     12  EW-LEVEL-USED       PIC X.
  3287
  3288 01  EPEC-TOTALS.
  3289     12  EPEC-LEVELS     OCCURS 900.
  3290*    12  EPEC-LEVELS     OCCURS 220.
  3291*    12  EPEC-LEVELS     OCCURS 300.
  3292         16  EPEC-REIN-CO          PIC X(6).
  3293         16  EPEC-SUB-KEY.
  3294             24  EPEC-LF-AH        PIC X.
  3295             24  EPEC-BEN-TYPE     PIC XX.
  3296*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  68
* ECS010.cbl
  3297         16  FILLER                PIC X(699).
  3298     12  EPEC-LEVELS-END           PIC X(6).
  3299
  3300 01  EPEC-UNDERWRITTEN-TOTALS.
  3301     12  EPEC-LEVELS-II  OCCURS 900.
  3302*    12  EPEC-LEVELS-II  OCCURS 220.
  3303*    12  EPEC-LEVELS-II  OCCURS 300.
  3304         16  EPEC-REIN-CO-II       PIC X(6).
  3305         16  EPEC-SUB-KEY-II.
  3306             24  EPEC-LF-AH-II     PIC X.
  3307             24  EPEC-BEN-TYPE-II  PIC XX.
  3308*        16  FILLER                PIC X(694).
  3309         16  FILLER                PIC X(699).
  3310     12  EPEC-LEVELS-END-II        PIC X(6).
  3311
  3312
  3313 01  FILLER                      PIC  X(11)
  3314                                 VALUE 'OPT RSV TBL'.
  3315*
  3316* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3317*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3318*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3319*      EPEC-OPT-GRP  (108)
  3320*
  3321*      300 X 108 = 32400.
  3322*
  3323 01  EPEC-OPT-DATA-TABLE.
  3324*    12  FILLER                  PIC X(32400).
  3325*    12  FILLER                  PIC X(23760).
  3326     12  FILLER                  PIC X(97200).
  3327
  3328 01  FILLER                      PIC  X(16)
  3329                                 VALUE 'OPT RSV TBL UNDW'.
  3330 01  EPEC-UNDW-OPT-DATA-TABLE.
  3331*    12  FILLER                  PIC X(32400).
  3332*    12  FILLER                  PIC X(23760).
  3333     12  FILLER                  PIC X(97200).
  3334
  3335 01  FILLER                      PIC  X(16)
  3336                                 VALUE 'OPT RSV TBL WORK'.
  3337 01  EPEC-OPT-WORK-TABLE.
  3338*    12  EPEC-OPT-GRP        OCCURS 300.
  3339*    12  EPEC-OPT-GRP        OCCURS 220.
  3340     12  EPEC-OPT-GRP        OCCURS 900.
  3341         16  EPEC-REIN-CO-OPT
  3342                             PIC  X(06).
  3343         16  EPEC-SUB-KEY-OPT.
  3344             24  EPEC-LF-AH-OPT
  3345                             PIC  X(01).
  3346             24  EPEC-BEN-TYPE-OPT
  3347                             PIC  X(02).
  3348         16  EPEC-OPT-DATA.
  3349             20  EPEC-REIN-ONLY-IND
  3350                             PIC  X(01).
  3351                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3352             20  EPEC-LINE-NOT-USED-IND
  3353                             PIC  X(01).
  3354                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  69
* ECS010.cbl
  3355             20  EPEC-LIFE-CTR-USED-IND
  3356                             PIC  X(01).
  3357                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3358                 88  EPEC-LIFE-CTR-NOT-USED
  3359                                           VALUE ' '.
  3360             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3361                             PIC S9(09)       COMP-3.
  3362             20  EPEC-EARNED-PREMIUM-AH
  3363                             PIC S9(09)V9(02) COMP-3.
  3364             20  EPEC-CLAIMS-MADE-PAID
  3365                             PIC S9(09)V9(02) COMP-3.
  3366             20  EPEC-CLM-EXP
  3367                             PIC S9(09)V9(02) COMP-3.
  3368             20  EPEC-LIFE-IBNR
  3369                             PIC S9(09)V9(02) COMP-3.
  3370             20  EPEC-REIN-ISS-BEN
  3371                             PIC S9(11)V9(02) COMP-3.
  3372
  3373 01  FILLER                  PIC X(09)
  3374                                 VALUE 'EOM TABLE'.
  3375
  3376 01  EOM-DATE-TABLE.
  3377     12  EOM-DATE            OCCURS 13
  3378                             PIC 9(08).
  3379
  3380 01  EPEC-SUBS.
  3381     12  EPEC-SUB-LEVELS OCCURS 31.
  3382         16  EPEC-SUB-REIN   PIC X(6).
  3383         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3384         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3385     12  EPEC-SUBS-END       PIC X(6).
  3386
  3387 01  SAVE-REIN-WORK.
  3388     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3389     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3390     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3391     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3392     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3393
  3394 01  SAVE-REIN-TABLE.
  3395     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3396         16  SR-TIME         PIC 9(6).
  3397         16  SR-ENTRY.
  3398             20  FILLER      PIC XX.
  3399             20  SR-CONTROL  PIC X(8).
  3400             20  FILLER      PIC X(3990).
  3401
  3402
* 3403                             COPY ECSRITAB.
  3404******************************************************************04/29/98
  3405*                                                                *ECSRITAB
  3406*                            ECSRITAB                            *   LV015
  3407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3408*                            VMOD=2.015                          *ECSRITAB
  3409*                                                                *ECSRITAB
  3410*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3411*                                                                *ECSRITAB
  3412******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3413 01  REIN-WORK-AREAS.                                             ECSRITAB
  3414     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3415     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3416     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3417     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3418     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3419     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3420     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3421     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3422     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3423     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3424     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3425         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3426             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3427             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3428             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3429     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3430     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3431     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3432     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3433     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3434     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3435     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3436     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3437     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3438     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3439     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3440     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3441     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3442     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3443     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3444     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3445     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3446     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3447     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3448     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3449     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3450     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3451     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3452                                                                  ECSRITAB
  3453 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3454     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3455         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3456         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3457             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3458             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3459         16  REIN-WORK-FLDS.                                      ECSRITAB
  3460             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3461             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3462             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3463             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3464             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3465             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3466             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3467             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3468             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3469             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3470             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3471             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3472             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3473             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3474             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3475             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3476             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3477             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3478             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3479             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3480             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3481             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3482             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3483             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3484             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3485             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3486             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3487             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3488     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3489                                                                  ECSRITAB
  3490     12  RWF-FIELDS.                                              ECSRITAB
  3491         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3492         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3493         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3494         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3495         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3496         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3497         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3498         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3499         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3500         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3501         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3502         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3503         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3504         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3505         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3506         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3507         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3508         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3509         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3510         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3511         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3512         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3513         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3514         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3515         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3516         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3517         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3518         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3519                                                                  ECSRITAB
  3520     12  WT-COMP-INFO.                                            ECSRITAB
  3521         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3522         16  WT-LF-QC                PIC X.                       ECSRITAB
  3523         16  WT-AH-QC                PIC X.                       ECSRITAB
  3524         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3525         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3526         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3527         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3528         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3529         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3530         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3531         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3532         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3533         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3534         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3535         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3536         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3537         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3538         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3539         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3540         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3541         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3542         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3543         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3544         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3545         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3546         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3547         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3548         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3549         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3550         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3551         16  WT-REMAINING            PIC X.                       ECSRITAB
  3552         16  FILLER                  PIC X(21).                   ECSRITAB
  3553                                                                  ECSRITAB
  3554 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3555     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3556     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3557     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3558     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3559     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3560     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3561     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3562     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3563     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3564     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3565     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3566     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3567     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3568     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3569     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3570     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3571     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3572     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3573     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3574     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3575     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3576     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3577     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3578     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3579                                                                  ECSRITAB
  3580     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3581         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3582     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3583         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3584     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3585         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3586     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3587         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3588     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3589         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3590     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3591         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3592                                                                  ECSRITAB
  3593     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3594         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3595         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3596         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3597         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3598         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3599         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3600         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3601         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3602         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3603         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3604         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3605         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3606         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3607         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3608         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3609         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3610         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3611         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3612         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3613         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3614         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3615         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3616         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3617     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3618     12  REIN-SEARCH.                                             ECSRITAB
  3619         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3620         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3621         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3622         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3623     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3624     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3625     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3626     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3627     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3628     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3629     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3630     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3631     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3632     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3633     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3634     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3635     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3636     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3637     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3638     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3639     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3640     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3641     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3642     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3643     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3644     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3645     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3646     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3647     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3648                                                                  ECSRITAB
  3649 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3650* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3651     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3652         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3653         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3654         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3655         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3656         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3657         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3658         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3659         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3660         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3661                                                                  ECSRITAB
  3662 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3663     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3664         16  RC2-REIN-CO.                                         ECSRITAB
  3665             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3666             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3667         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3668         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3669         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3670         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3671         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3672         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3673                                                                  ECSRITAB
  3674 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3675     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3676         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3677         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3678     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3679                                                                  ECSRITAB
  3680 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3681     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3682         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3683         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3684         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3685 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3686     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3687         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3688                                                                  ECSRITAB
  3689 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3690******************************************************************ECSRITAB
  3691
* 3692                             COPY ELCPSEVR.
  3693******************************************************************04/16/98
  3694*                                                                *ELCPSEVR
  3695*                                                                *ELCPSEVR
  3696*                            ELCPSEVR                            *   LV003
  3697*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3698*                            VMOD=2.001                          *ELCPSEVR
  3699*                                                                *ELCPSEVR
  3700*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3701*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3702*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3703******************************************************************ELCPSEVR
  3704                                                                  ELCPSEVR
  3705 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3706     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3707         10  FILLER               PIC 999.                        ELCPSEVR
  3708         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3709         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3710             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3711             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3712         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3713         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3714     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3715            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3716     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3717         10  FILLER              PIC 999.                         ELCPSEVR
  3718         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3719         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3720             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3721             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3722         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3723         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3724     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3725            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3726 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3727     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3728                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3729         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3730             15  FILLER              PIC 999.                     ELCPSEVR
  3731             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3732             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3733                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3734                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3735             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3736             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3737         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3738                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3739         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3740             15  FILLER              PIC 999.                     ELCPSEVR
  3741             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3742             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3743                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3744                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3745             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3746             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3747         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3748                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3749         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3750             15  FILLER              PIC 999.                     ELCPSEVR
  3751             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3752             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3753                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3754                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3755             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3756             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3757         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3758                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3759     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3760         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3761         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3762         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3763             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3764             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3765         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3766         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3767     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3768            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3769
* 3770                             COPY ELCEPCVR.
  3771******************************************************************05/15/98
  3772*                                                                *ELCEPCVR
  3773*                                                                *ELCEPCVR
  3774*                            ELCEPCVR                            *   LV003
  3775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3776*                            VMOD=2.001                          *ELCEPCVR
  3777*                                                                *ELCEPCVR
  3778*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3779*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3780*                                                                *ELCEPCVR
  3781******************************************************************ELCEPCVR
  3782 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3783     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3784         10  FILLER            PIC 999.                           ELCEPCVR
  3785         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3786         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3787             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3788             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3789         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3790         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3791     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3792            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3793     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3794         10  FILLER            PIC 999.                              CL**5
  3795         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3796         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3797             15  EC-EXP-CC     PIC 99.                               CL**5
  3798             15  EC-EXP-YR     PIC 99.                               CL**5
  3799         10  EC-EXP-MO         PIC 99.                               CL**5
  3800         10  EC-EXP-DA         PIC 99.                               CL**5
  3801     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3802            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3803     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3804         10  FILLER            PIC 999.                           ELCEPCVR
  3805         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3806         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3807             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3808             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3809         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3810         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3811     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3812            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3813     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3814         10  FILLER            PIC 999.                              CL**5
  3815         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3816         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3817             15  EC-EFF-CC     PIC 99.                               CL**5
  3818             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3819         10  EC-EFF-MO         PIC 99.                               CL**5
  3820         10  EC-EFF-DA         PIC 99.                               CL**5
  3821     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3822            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3823     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3824         10  FILLER            PIC 999.                           ELCEPCVR
  3825         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3826         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3827             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3828             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3829         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3830         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3831     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3832            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3833     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3834         10  FILLER            PIC 999.                           ELCEPCVR
  3835         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3836         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3837             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3838             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3839         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3840         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3841     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3842            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3843     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3844         10  FILLER            PIC 999.                           ELCEPCVR
  3845         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3846         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3847             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3848             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3849         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3850         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3851     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3852            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3853     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3854         10  FILLER            PIC 999.                           ELCEPCVR
  3855         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3856         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3857             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3858             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3859         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3860         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3861     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3862            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3863     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3864         10  FILLER            PIC 999.                           ELCEPCVR
  3865         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3866         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3867             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3868             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3869         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3870         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3871     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3872            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3873
* 3874                             COPY ELCREINV.
  3875******************************************************************04/18/98
  3876*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3877*                                                                *ELCREINV
  3878*                            ELCREINV                            *   LV003
  3879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3880*                            VMOD=2.001                          *ELCREINV
  3881*                                                                *ELCREINV
  3882*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3883*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3884*                                                                *ELCREINV
  3885******************************************************************ELCREINV
  3886                                                                  ELCREINV
  3887 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3888     05  WS-RE-LO-DATE.                                              CL**3
  3889         10 FILLER                     PIC 999.                      CL**3
  3890         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3891         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3892            15 RE-LO-CC                PIC 99.                       CL**3
  3893            15 RE-LO-YR                PIC 99.                       CL**3
  3894         10 RE-LO-MO                   PIC 99.                       CL**3
  3895         10 RE-LO-DA                   PIC 99.                       CL**3
  3896     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3897            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3898     05  WS-RE-HI-DATE.                                              CL**3
  3899         10 FILLER                     PIC 999.                      CL**3
  3900         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3901         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3902            15 RE-HI-CC                PIC 99.                       CL**3
  3903            15 RE-HI-YR                PIC 99.                       CL**3
  3904         10 RE-HI-MO                   PIC 99.                       CL**3
  3905         10 RE-HI-DA                   PIC 99.                       CL**3
  3906     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3907            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3908     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3909         10 FILLER                     PIC 999.                   ELCREINV
  3910         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3911         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3912            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3913            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3914         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3915         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3916     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3917            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3918     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3919         10  FILLER                    PIC 999.                   ELCREINV
  3920         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3921         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3922             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3923             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3924         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3925         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3926     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3927            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3928     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3929         10  FILLER                    PIC 999.                   ELCREINV
  3930         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3931         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3932             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3933             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3934         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  79
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3935         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3936     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3937            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3938
  3939 01  RC-REIN-HOLD-AREAS.
  3940     12  RC-REIN-LEVELS  OCCURS 30.
  3941         16  RC-REIN-COMP    PIC X(6).
  3942         16  RC-OLD-ISS      PIC X.
  3943         16  RC-NEW-ISS      PIC X.
  3944         16  RC-OLD-CNC      PIC X.
  3945         16  RC-NEW-CNC      PIC X.
  3946         16  RC-OLD-LF-CLM   PIC X.
  3947         16  RC-OLD-AH-CLM   PIC X.
  3948         16  RC-NEW-LF-CLM   PIC X.
  3949         16  RC-NEW-AH-CLM   PIC X.
  3950         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3951         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3952         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3953         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3954         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3955         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3956         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3957         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3958         16  RC-REIN-REM-SW  PIC X.
  3959     12  RC-REIN-LEVELS-END  PIC X(6).
  3960
  3961 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3962     12  TPC-COUNTERS    OCCURS 6.
  3963         16  TPL-ISS-PRM     PIC S9(9)V99.
  3964         16  TPA-ISS-PRM     PIC S9(9)V99.
  3965         16  TPL-CNC-PRM     PIC S9(9)V99.
  3966         16  TPA-CNC-PRM     PIC S9(9)V99.
  3967         16  TPL-ACCT-COM    PIC S9(9)V99.
  3968         16  TPA-ACCT-COM    PIC S9(9)V99.
  3969         16  TPL-CLAIMS      PIC S9(9)V99.
  3970         16  TPA-CLAIMS      PIC S9(9)V99.
  3971
  3972 01  HLD-DTS SYNC.
  3973     12  EOM-RUN-DATE        PIC 9(08).
  3974     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3975         16  EOM-CCYY.
  3976             20  EOM-CC      PIC 99.
  3977             20  EOM-YR      PIC 99.
  3978         16  EOM-MO          PIC 99.
  3979         16  EOM-DA          PIC 99.
  3980
  3981****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3982****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3983     12  OB-RUN-DATES OCCURS 2.
  3984         16  OB-CCYY         PIC 9(4).
  3985         16  OB-MO           PIC 99.
  3986         16  OB-DA           PIC 99.
  3987
  3988     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3989         88  OB-DATE-1-USED     VALUE '*'.
  3990     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3991         88  OB-DATE-2-USED     VALUE '*'.
  3992     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  80
* ECS010.cbl
  3993         88  OB-DATE-3-USED     VALUE '*'.
  3994     12  EARNING-START-DATE  PIC 9(08).
  3995     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3996         16  E-ERN-START-CC  PIC 99.
  3997         16  E-ERN-START-YR  PIC 99.
  3998         16  E-ERN-START-MO  PIC 99.
  3999         16  E-ERN-START-DA  PIC 99.
  4000     12  EARNING-STOP-DATE   PIC 9(08).
  4001     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  4002         16  E-ERN-STOP-CC   PIC 99.
  4003         16  E-ERN-STOP-YR   PIC 99.
  4004         16  E-ERN-STOP-MO   PIC 99.
  4005         16  E-ERN-STOP-DA   PIC 99.
  4006     12  STOP-LF-DATE        PIC 9(08).
  4007     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  4008         16  STOP-LF-CC      PIC 99.
  4009         16  STOP-LF-YR      PIC 99.
  4010         16  STOP-LF-MO      PIC 99.
  4011         16  STOP-LF-DA      PIC 99.
  4012     12  STOP-AH-DATE        PIC 9(08).
  4013     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  4014         16  STOP-AH-CC      PIC 99.
  4015         16  STOP-AH-YR      PIC 99.
  4016         16  STOP-AH-MO      PIC 99.
  4017         16  STOP-AH-DA      PIC 99.
  4018     12  BIN-VALUATION-DT    PIC XX.
  4019     12  BIN-EOM-RUN-DATE    PIC XX.
  4020     12  LAST-YRS-DATE       PIC 9(08).
  4021     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  4022         16  LYD-CCYY        PIC 9(04).
  4023         16  LYD-CCYR REDEFINES LYD-CCYY.
  4024             20  LYD-CC      PIC 99.
  4025             20  LYD-YR      PIC 99.
  4026         16  LYD-MO          PIC 99.
  4027         16  LYD-DA          PIC 99.
  4028     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  4029     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  4030         16  VAL-CC          PIC 99.
  4031         16  VAL-YR          PIC 99.
  4032         16  VAL-MO          PIC 99.
  4033         16  VAL-DA          PIC 99.
  4034     12  INCURRED-DATE       PIC 9(08).
  4035     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  4036         16  DTO-CC          PIC 99.
  4037         16  DTO-YR          PIC 99.
  4038         16  DTO-MO          PIC 99.
  4039         16  DTO-DA          PIC 99.
  4040     12  REPORTED-DATE.
  4041         16  RPT-YR          PIC 99.
  4042         16  RPT-MO          PIC 99.
  4043         16  RPT-DA          PIC 99.
  4044     12  PAYMENT-DATE        PIC 9(08).
  4045     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4046         16  PAY-CC          PIC 99.
  4047         16  PAY-YR          PIC 99.
  4048         16  PAY-MO          PIC 99.
  4049         16  PAY-DA          PIC 99.
  4050     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  81
* ECS010.cbl
  4051     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4052         16  PAYTO-CC        PIC 99.
  4053         16  PAYTO-YR        PIC 99.
  4054         16  PAYTO-MO        PIC 99.
  4055         16  PAYTO-DA        PIC 99.
  4056
  4057 01  AH-RES-STATE-TABLE.
  4058     12  FILLER              PIC X(42)       VALUE
  4059             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4060     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4061
  4062 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4063     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4064
  4065 01  BILLING-COUNTERS    COMP-3.
  4066     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4067     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4068     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4069     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4070     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4071     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4072     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4073     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4074     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4075     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4076     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4077     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4078     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4079     12  BC-COMM             PIC S9(5)           VALUE +0.
  4080     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4081     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4082     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4083     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4084     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4085     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4086     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4087     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4088     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4089     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4090
  4091 01  FLAGS SYNC.
  4092     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4093         88  CHECK-BILLED                        VALUE 'Y'.
  4094     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4095         88  EOF-ON-TRANS                        VALUE '*'.
  4096     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4097         88  EOF-ON-CERT                         VALUE '*'.
  4098     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4099         88  PROCESSING-COMPLETED                VALUE '*'.
  4100     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4101         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4102     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4103         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4104     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4105         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4106     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4107         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4108     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  82
* ECS010.cbl
  4109         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4110     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4111         88  A-H-FULLY-EARNED                    VALUE '*'.
  4112     12  CNCL-FLG            PIC X               VALUE SPACE.
  4113     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4114         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4115         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4116     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4117         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4118     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4119         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4120     12  EP-FLG              PIC X               VALUE SPACE.
  4121     12  END-FLG             PIC X               VALUE SPACE.
  4122     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4123     12  PRIOR-CERT-IN-CNTRL.
  4124         16  PCIC-FIRST      PIC x(19)  value low-values.
  4125         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4126         16  pcic-cert-no    pic x(11)  value low-values.
  4127     12  ACCT-FLG            PIC X               VALUE SPACE.
  4128     12  STATE-FLG           PIC X               VALUE SPACE.
  4129     12  COMP-FLG            PIC X               VALUE SPACE.
  4130     12  CARR-FLG            PIC X               VALUE SPACE.
  4131     12  FINAL-FLG           PIC X               VALUE SPACE.
  4132     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4133     12  REIN-FLG            PIC X               VALUE SPACE.
  4134     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4135     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4136
  4137 01  TEXAS-REG-WORK-AREAS   SYNC.
  4138     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4139     12  TEX-FACT-2          PIC S999        COMP-3.
  4140     12  TEX-FACT-3          PIC S999        COMP-3.
  4141     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4142     12  TEX-FACT-5          PIC S999        COMP-3.
  4143     12  TEX-FACT-6          PIC S999        COMP-3.
  4144     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4145     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4146     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4147
  4148 01  NET-PAY-INTERFACE.
  4149     12  NP-APR              PIC S999V9(4)   COMP-3.
  4150     12  NP-ORIG             PIC S999        COMP-3.
  4151     12  NP-REM              PIC S999        COMP-3.
  4152     12  NP-OPT              PIC X.
  4153     12  NP-CAP              PIC S999        COMP-3.
  4154     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4155     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4156     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4157     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4158     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4159     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4160     12  NP-ACCOUNT          PIC X(10).
  4161
  4162 01  HOLDERS SYNC.
  4163     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4164     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4165     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4166     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  83
* ECS010.cbl
  4167     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4168     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4169     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4170     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4171     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4172     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4173     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4174     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4175     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4176     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4177     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4178     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4179     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4180     12  REM-TRM1            PIC S999V99  COMP-3.
  4181     12  REM-TRM2            PIC S999V99  COMP-3.
  4182     12  REM-TRM3            PIC S999V99  COMP-3.
  4183     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4184     12  TEM-TRM1            PIC S999V99  COMP-3.
  4185     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4186     12  ORIG-TERM           PIC S999V99  COMP-3.
  4187     12  HLD-CONTROL.
  4188         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4189         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4190         16  HLD-STATE       PIC XX              VALUE SPACES.
  4191         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4192     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4193
  4194 01  DISPLAY-IBNR-LINE.
  4195     05  FILLER                  PIC X       VALUE SPACES.
  4196     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4197     05  FILLER                  PIC XX      VALUE SPACES.
  4198     05  DIL-TYPE                PIC X       VALUE SPACES.
  4199     05  FILLER                  PIC X       VALUE SPACES.
  4200     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4201     05  FILLER                  PIC XXX     VALUE SPACES.
  4202     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4203
  4204 01  DISPLAY-HD-1.
  4205     05  FILLER      PIC X       VALUE SPACES.
  4206     05  FILLER      PIC X(50)   VALUE SPACES.
  4207     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4208     05  FILLER      PIC X(51)   VALUE SPACES.
  4209     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4210
  4211 01  DISPLAY-HD-2.
  4212     05  FILLER                 PIC X       VALUE SPACE.
  4213     05  FILLER                 PIC X(57)   VALUE SPACES.
  4214     05  DIS-DATE               PIC X(8).
  4215     05  FILLER                 PIC X(66)   VALUE SPACES.
  4216
  4217 01  DISPLAY-LINE.
  4218     05  DL-FULL.
  4219         10  FILLER           PIC X       VALUE SPACE.
  4220         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4221         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4222
  4223 01  PRT-HDNGS SYNC.
  4224     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  84
* ECS010.cbl
  4225         16  FILLER      PIC X       VALUE '1'.
  4226         16  FILLER      PIC X(53)   VALUE SPACES.
  4227         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4228         16  FILLER      PIC X(48)   VALUE SPACES.
  4229         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4230     12  TR-HD-2.
  4231         16  FILLER      PIC X       VALUE SPACE.
  4232         16  FILLER      PIC X(47)   VALUE SPACES.
  4233         16  TRHDNM      PIC X(30).
  4234         16  FILLER      PIC X(42)   VALUE SPACES.
  4235         16  TR-RN-DT    PIC X(8).
  4236     12  TR-HD-3.
  4237         16  FILLER      PIC X       VALUE SPACE.
  4238         16  FILLER      PIC X(53)   VALUE SPACES.
  4239         16  TR-MODAYR   PIC X(18).
  4240         16  FILLER      PIC X       VALUE SPACE.
  4241         16  TR-YRASK    PIC X       VALUE SPACE.
  4242         16  FILLER      PIC X(46)   VALUE SPACES.
  4243         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4244         16  TR-PG       PIC ZZ,ZZ9.
  4245     12  TR-HD-4.
  4246         16  FILLER      PIC X       VALUE SPACE.
  4247         16  TR-AGCY     PIC X(30).
  4248     12  TR-HD-5.
  4249         16  FILLER      PIC X       VALUE SPACE.
  4250         16  TR-CARR     PIC X.
  4251         16  FILLER      PIC X       VALUE '-'.
  4252         16  TR-GROUP    PIC X(6).
  4253         16  FILLER      PIC X       VALUE '-'.
  4254         16  TR-ST-NO    PIC X(2).
  4255         16  FILLER      PIC X       VALUE '-'.
  4256         16  TR-AG-NO    PIC X(10).
  4257         16  FILLER      PIC X(23)   VALUE SPACES.
  4258         16  TR5-RP-TYP.
  4259             20  FILLER  PIC X(20)   VALUE
  4260                     '* * * * TRANSACTION '.
  4261             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4262     12  TR-HD-6.
  4263         16  FILLER      PIC X       VALUE SPACE.
  4264         16  TR-CE-MO    PIC XX.
  4265         16  FILLER      PIC X       VALUE '-'.
  4266         16  TR-CE-DA    PIC XX.
  4267         16  FILLER      PIC X       VALUE '-'.
  4268         16  TR-CE-YR    PIC XX.
  4269         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4270         16  TR-CX.
  4271             20  TR-CX-MO PIC XX.
  4272             20  HSHR1    PIC X.
  4273             20  TR-CX-DA PIC XX.
  4274             20  HSHR2    PIC X.
  4275             20  TR-CX-YR PIC XX.
  4276     12  TR-HD-7.
  4277         16  FILLER  PIC X      VALUE '0'.
  4278         16  FILLER  PIC X(24)  VALUE SPACES.
  4279         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4280         16  TR-7-LF PIC X(6).
  4281         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4282         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  85
* ECS010.cbl
  4283         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4284         16  TR-7-AH PIC X(6).
  4285         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4286         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4287     12  TR-HD-8.
  4288         16  FILLER  PIC X      VALUE SPACE.
  4289         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4290         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4291         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4292         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4293         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4294     12  TR-HD-9.
  4295         16  FILLER  PIC X      VALUE SPACE.
  4296         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4297         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4298         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4299         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4300         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4301         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4302     12  TR-TTL-HD.
  4303         16  FILLER      PIC X       VALUE '0'.
  4304         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4305         16  FILLER      PIC XX      VALUE SPACES.
  4306         16  TTL-HD-DS   PIC X(60)   VALUE
  4307             'ECS010 CONTROL TOTALS'.
  4308
  4309 01  TR-DTL.
  4310     12  FILLER                  PIC X           VALUE SPACE.
  4311     12  TR-DTL1.
  4312         16  TRD-CERT            PIC X(11).
  4313         16  TRD-ISDT.
  4314             20  FILLER          PIC X           VALUE SPACE.
  4315             20  TRD-ISMO        PIC XX.
  4316             20  TRD-IS-S1       PIC X           VALUE '/'.
  4317             20  TRD-ISDA        PIC XX.
  4318             20  TRD-IS-S2       PIC X           VALUE '/'.
  4319             20  TRD-ISYR        PIC XX.
  4320             20  FILLER          PIC X           VALUE SPACE.
  4321         16  TRD-AGE             PIC XX.
  4322     12  TR-DTL2.
  4323         16  FILLER              PIC X           VALUE SPACE.
  4324         16  TRD-LFTYP           PIC XXX.
  4325         16  FILLER              PIC X           VALUE SPACE.
  4326         16  TRD-LFTRM           PIC ZZ9.
  4327         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4328         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4329         16  TRD-LFACTDT.
  4330             20  FILLER          PIC X           VALUE SPACE.
  4331             20  TRD-LFACTMO     PIC XX.
  4332             20  TRD-LF-S1       PIC X           VALUE '/'.
  4333             20  TRD-LFACTDA     PIC XX.
  4334             20  TRD-LF-S2       PIC X           VALUE '/'.
  4335             20  TRD-LFACTYR     PIC XX.
  4336             20  FILLER          PIC X           VALUE SPACE.
  4337         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4338         16  FILLER              PIC X           VALUE SPACE.
  4339         16  TRD-LF-STATUS       PIC X.
  4340         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  86
* ECS010.cbl
  4341         16  TRD-AHTYP           PIC XXX.
  4342         16  FILLER              PIC X           VALUE SPACE.
  4343         16  TRD-AHTRM           PIC ZZ9.
  4344         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4345         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4346         16  TRD-AHACTDT.
  4347             20  FILLER          PIC X           VALUE SPACE.
  4348             20  TRD-AHACTMO     PIC XX.
  4349             20  TRD-AH-S1       PIC X           VALUE '/'.
  4350             20  TRD-AHACTDA     PIC XX.
  4351             20  TRD-AH-S2       PIC X           VALUE '/'.
  4352             20  TRD-AHACTYR     PIC XX.
  4353             20  FILLER          PIC X           VALUE SPACE.
  4354         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4355         16  FILLER              PIC X           VALUE SPACE.
  4356         16  TRD-AH-STATUS       PIC X.
  4357     12  TR-DTL3 REDEFINES TR-DTL2.
  4358         16  FILLER              PIC X(20).
  4359         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4360         16  FILLER              PIC X.
  4361         16  TRD-IBNRX           PIC X(4).
  4362         16  FILLER              PIC X(2).
  4363         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4364         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4365                                 PIC X(11).
  4366         16  FILLER              PIC X.
  4367         16  TRD-PAYCURX         PIC X(8).
  4368         16  FILLER              PIC X(2).
  4369         16  TRD-FUTRSV-DATA.
  4370             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4371             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4372                                 PIC X(11).
  4373             20  FILLER          PIC X.
  4374             20  TRD-FUTRSVX     PIC X(6).
  4375         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4376             20  TRD-BENEFIT-X   PIC X(10).
  4377             20  TRD-BENEFIT-CODE
  4378                                 PIC X(02).
  4379             20  FILLER          PIC X(06).
  4380         16  FILLER              PIC X(4).
  4381         16  TRD-RSV-DESC        PIC X(6).
  4382         16  TRD-RSV-ACTION      PIC X(21).
  4383
  4384 01  DET-PR-UREC.
  4385     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4386     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4387     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4388     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4389     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4390     12  DET-SEX             PIC X.
  4391     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4392     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4393     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4394     12  DET-PR-MEM          PIC X(12).
  4395     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4396     12  DET-PR-SS           PIC X(11).
  4397     12  FILLER              PIC XXX      VALUE SPACES.
  4398     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  87
* ECS010.cbl
  4399
  4400 01  DET-PR-UREC-2.
  4401     12  FILLER              PIC X        VALUE SPACE.
  4402     12  DET-LF-DESC         PIC XX.
  4403     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4404     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4405     12  FILLER              PIC X(4)     VALUE ' TO '.
  4406     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4407     12  FILLER              PIC X        VALUE SPACE.
  4408     12  DET-AH-DESC         PIC XX.
  4409     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4410     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4411     12  FILLER              PIC X(4)     VALUE ' TO '.
  4412     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4413     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4414     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4415     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4416     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4417     12  FILLER              PIC X(5)     VALUE SPACES.
  4418     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4419
  4420 01  DET-PR-UREC-3.
  4421     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4422     12  DET-IND-GRP         PIC X.
  4423     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4424     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4425     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4426     12  DET-POL-FORM        PIC X(12).
  4427     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4428     12  DET-LOAN-OFFICER    PIC XXX.
  4429     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4430     12  DET-USER-CODE       PIC X.
  4431     12  FILLER              PIC X(8)     VALUE SPACES.
  4432     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4433
  4434 01  DET-PR-UREC-4.
  4435     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4436     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4437     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4438     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4439     12  FILLER              PIC X(37)    VALUE SPACES.
  4440     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4441
  4442 01  DET-PR-UREC-5.
  4443     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4444     12  DET-LF-BEN-CD       PIC XX.
  4445     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4446     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4447     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4448     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4449     12  FILLER              PIC X(30)    VALUE SPACES.
  4450     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4451
  4452 01  DET-PR-UREC-6.
  4453     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4454     12  DET-AH-BEN-CD       PIC XX.
  4455     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4456     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  88
* ECS010.cbl
  4457     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4458     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4459     12  FILLER              PIC X(30)    VALUE SPACES.
  4460     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4461
  4462 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4463     88  WS-CHANGE-REC              VALUE 'Y'.
  4464
  4465 01  TOTAL-PAGE-HD1.
  4466     12  FILLER              PIC X               VALUE SPACE.
  4467     12  TPH1-TYPE           PIC X(8).
  4468     12  TPH1-DESC.
  4469         16  TPH1-ST-CODE    PIC XX.
  4470         16  FILLER          PIC XXX.
  4471         16  TPH1-ST-DESC    PIC X(20).
  4472
  4473 01  TOTAL-PAGE-HD2.
  4474     12  FILLER              PIC X           VALUE SPACE.
  4475     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4476     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4477     12  FILLER              PIC X(9)        VALUE SPACES.
  4478     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4479     12  FILLER              PIC X(11)       VALUE SPACES.
  4480     12  FILLER              PIC X(3)        VALUE 'NET'.
  4481     12  FILLER              PIC X(11)       VALUE SPACES.
  4482     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4483     12  FILLER              PIC X(10)       VALUE SPACES.
  4484     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4485
  4486 01  TOTAL-PAGE-HD3.
  4487     12  FILLER              PIC X           VALUE SPACE.
  4488     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4489     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4490     12  FILLER              PIC X(10)       VALUE SPACES.
  4491     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4492     12  FILLER              PIC X(10)       VALUE SPACES.
  4493     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4494     12  FILLER              PIC X(7)        VALUE SPACES.
  4495     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4496     12  FILLER              PIC X(08)       VALUE SPACES.
  4497     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4498     12  FILLER              PIC X(11)       VALUE SPACES.
  4499     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4500
  4501 01  TOTAL-PAGE-DETAIL.
  4502     12  FILLER              PIC X(5).
  4503     12  TPD-DESC            PIC X(6).
  4504     12  FILLER              PIC X(3).
  4505     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4506     12  FILLER              PIC X(2).
  4507     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4508     12  FILLER              PIC X(2).
  4509     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4510     12  FILLER              PIC X(2).
  4511     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4512     12  FILLER              PIC X(2).
  4513     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4514     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  89
* ECS010.cbl
  4515     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4516     12  FILLER              PIC X(4).
  4517     12  TPD-LO-CERT         PIC X(6).
  4518     12  FILLER              PIC X(2).
  4519     12  TPD-HI-CERT         PIC X(6).
  4520*    12  FILLER              PIC X.
  4521*    12  TPD-LO-CERT         PIC X(8).
  4522*    12  FILLER              PIC X.
  4523*    12  TPD-HI-CERT         PIC X(8).
  4524
  4525 01  DUPE-CERT-TABLE.
  4526     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4527         16  DUPE-ENTRY      PIC X(36).
  4528         16  DUPE-STATUS     PIC X(01).
  4529         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4530         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4531
  4532 01  MISMATCH-HEADING-1.
  4533     12  FILLER              PIC X           VALUE '1'.
  4534     12  FILLER              PIC X(45)       VALUE SPACES.
  4535     12  FILLER              PIC X(42)       VALUE
  4536             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4537     12  FILLER              PIC X(35)       VALUE SPACES.
  4538     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4539
  4540 01  MISMATCH-HEADING-2.
  4541     12  FILLER              PIC X           VALUE '0'.
  4542     12  FILLER              PIC X(44)       VALUE
  4543             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4544     12  FILLER              PIC X(44)       VALUE
  4545             'YPE      CERT IN CONTROL                    '.
  4546     12  FILLER              PIC X(44)       VALUE
  4547             '        CERT OUT CONTROL           STATUS   '.
  4548
  4549 01  MISMATCH-DETAIL.
  4550     12  FILLER              PIC X           VALUE '0'.
  4551     12  FILLER              PIC X           VALUE SPACES.
  4552     12  DTL-MATCH-CONTROL   PIC X(36).
  4553     12  FILLER              PIC X(3)        VALUE SPACES.
  4554     12  DTL-REC-TYPE        PIC X.
  4555     12  FILLER              PIC X(2)        VALUE SPACES.
  4556     12  DTL-REC-TYPE-DESC   PIC X(3).
  4557     12  FILLER              PIC X(3)        VALUE SPACES.
  4558     12  DTL-CERT-IN-CONTROL
  4559                             PIC X(36).
  4560     12  FILLER              PIC X           VALUE SPACES.
  4561     12  DTL-CERT-OUT-CONTROL
  4562                             PIC X(36).
  4563     12  FILLER              PIC X           VALUE SPACES.
  4564     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4565     12  FILLER              PIC X(2)        VALUE SPACES.
  4566
  4567 01  MISMATCH-DETAIL-2.
  4568     12  FILLER              PIC X           VALUE ' '.
  4569     12  FILLER              PIC X           VALUE SPACES.
  4570     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4571             ' LIFE PREMIUM = '.
  4572     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  90
* ECS010.cbl
  4573     12  FILLER              PIC X           VALUE SPACES.
  4574     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4575             'LIFE ALT PREM = '.
  4576     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4577     12  FILLER              PIC XX          VALUE SPACES.
  4578     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4579             'A/H PREMIUM = '.
  4580     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4581     12  FILLER              PIC X(39)       VALUE SPACES.
  4582
  4583 01  MISMATCH-DETAIL-3.
  4584     12  FILLER              PIC X           VALUE ' '.
  4585     12  FILLER              PIC X           VALUE SPACES.
  4586     12  FILLER              PIC X(16)       VALUE
  4587             ' LIFE  REFUND = '.
  4588     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4589     12  FILLER              PIC X           VALUE SPACES.
  4590     12  FILLER              PIC X(16)       VALUE
  4591             'A & H  REFUND = '.
  4592     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4593     12  FILLER              PIC X(72)       VALUE SPACES.
  4594
  4595 01  MISMATCH-DETAIL-4.
  4596     12  FILLER              PIC X           VALUE ' '.
  4597     12  FILLER              PIC X           VALUE SPACES.
  4598     12  FILLER              PIC X(16)       VALUE
  4599             ' LIFE  CLAIM  = '.
  4600     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4601     12  FILLER              PIC X           VALUE SPACES.
  4602     12  FILLER              PIC X(16)       VALUE
  4603             'A & H  CLAIM  = '.
  4604     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4605     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  91
* ECS010.cbl
  4607*
  4608*
  4609* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  92
* ECS010.cbl
  4611 01  PB-STARTS-HERE              PIC X(48)
  4612       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4613
* 4614                             COPY ERCPNDB.
  4615******************************************************************
  4616*                                                                *
  4617*                                                                *
  4618*                            ERCPNDB.                            *
  4619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4620*                            VMOD=2.025                          *
  4621*                                                                *
  4622*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4623*                                                                *
  4624******************************************************************
  4625*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4626*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4627******************************************************************
  4628*                                                                *
  4629*                                                                *
  4630*   FILE TYPE = VSAM,KSDS                                        *
  4631*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4632*                                                                *
  4633*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4634*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4635*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4636*                                                 RKP=13,LEN=36  *
  4637*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4638*                                      AND CHG-SEQ.)             *
  4639*                                                RKP=49,LEN=11   *
  4640*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4641*                                      AND CHG-SEQ.)             *
  4642*                                                RKP=60,LEN=15   *
  4643*                                                                *
  4644*   LOG = NO                                                     *
  4645*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4646******************************************************************
  4647******************************************************************
  4648*                   C H A N G E   L O G
  4649*
  4650* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4651*-----------------------------------------------------------------
  4652*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4653* EFFECTIVE    NUMBER
  4654*-----------------------------------------------------------------
  4655* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4656* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4657* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4658* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4659* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4660* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4661* 032306                   PEMA  ADD BOW LOAN NUMBER
  4662* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4663* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4664* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4665* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4666* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4667* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4668* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4669* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4670******************************************************************
  4671
  4672 01  PENDING-BUSINESS.
  4673     12  PB-RECORD-ID                     PIC XX.
  4674         88  VALID-PB-ID                        VALUE 'PB'.
  4675
  4676     12  PB-CONTROL-PRIMARY.
  4677         16  PB-COMPANY-CD                PIC X.
  4678         16  PB-ENTRY-BATCH               PIC X(6).
  4679         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4680         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4681
  4682     12  PB-CONTROL-BY-ACCOUNT.
  4683         16  PB-COMPANY-CD-A1             PIC X.
  4684         16  PB-CARRIER                   PIC X.
  4685         16  PB-GROUPING.
  4686             20  PB-GROUPING-PREFIX       PIC XXX.
  4687             20  PB-GROUPING-PRIME        PIC XXX.
  4688         16  PB-STATE                     PIC XX.
  4689         16  PB-ACCOUNT.
  4690             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4691             20  PB-ACCOUNT-PRIME         PIC X(6).
  4692         16  PB-CERT-EFF-DT               PIC XX.
  4693         16  PB-CERT-NO.
  4694             20  PB-CERT-PRIME            PIC X(10).
  4695             20  PB-CERT-SFX              PIC X.
  4696         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4697
  4698         16  PB-RECORD-TYPE               PIC X.
  4699             88  PB-MAILING-DATA                VALUE '0'.
  4700             88  PB-ISSUE                       VALUE '1'.
  4701             88  PB-CANCELLATION                VALUE '2'.
  4702             88  PB-BATCH-TRAILER               VALUE '9'.
  4703
  4704     12  PB-CONTROL-BY-ORIG-BATCH.
  4705         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4706         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4707         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4708         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4709
  4710     12  PB-CONTROL-BY-CSR.
  4711         16  PB-CSR-COMPANY-CD            PIC X.
  4712         16  PB-CSR-ID                    PIC X(4).
  4713         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4714         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4715         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4716******************************************************************
  4717*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4718******************************************************************
  4719
  4720     12  PB-LAST-MAINT-DT                 PIC XX.
  4721     12  PB-LAST-MAINT-BY                 PIC X(4).
  4722     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4723
  4724     12  PB-RECORD-BODY                   PIC X(375).
  4725
  4726     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4727         16  PB-CERT-ORIGIN               PIC X.
  4728             88  CLASIC-CREATED-CERT         VALUE '1'.
  4729         16  PB-I-NAME.
  4730             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4731             20  PB-I-INSURED-FIRST-NAME.
  4732                 24  PB-I-INSURED-1ST-INIT PIC X.
  4733                 24  FILLER                PIC X(9).
  4734             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4735         16  PB-I-AGE                     PIC S99   COMP-3.
  4736         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4737         16  PB-I-BIRTHDAY                PIC XX.
  4738         16  PB-I-INSURED-SEX             PIC X.
  4739             88  PB-SEX-MALE     VALUE 'M'.
  4740             88  PB-SEX-FEMALE   VALUE 'F'.
  4741
  4742         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4743         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4744         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4745         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4746         16  PB-I-SKIP-CODE               PIC X.
  4747             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4748             88  PB-SKIP-JULY              VALUE '1'.
  4749             88  PB-SKIP-AUGUST            VALUE '2'.
  4750             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4751             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4752             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4753             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4754             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4755             88  PB-SKIP-JUNE              VALUE '8'.
  4756             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4757             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4758             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4759         16  PB-I-TERM-TYPE               PIC X.
  4760             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4761             88  PB-PAID-WEEKLY            VALUE 'W'.
  4762             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4763             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4764             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4765         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4766         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4767         16  PB-I-DATA-ENTRY-SW           PIC X.
  4768             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4769             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4770             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4771             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4772         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4773         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4774*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4775         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4776         16  FILLER                       PIC X.
  4777
  4778         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4779             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4780             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4781                                                   '90' THRU '99'.
  4782         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4783                                          PIC XX.
  4784         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4785         16  PB-I-AMOUNT-FINANCED REDEFINES
  4786                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4787         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4788         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4789                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4790         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4791         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4792         16  PB-I-CLP-AMOUNT REDEFINES
  4793                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4794         16  PB-I-LF-CALC-FLAG            PIC X.
  4795             88 PB-COMP-LF-PREM               VALUE '?'.
  4796         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4797         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4798         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4799         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4800         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4801         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4802         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4803         16  PB-I-LF-ABBR                 PIC XXX.
  4804         16  PB-I-LF-INPUT-CD             PIC XX.
  4805
  4806         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4807             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4808             88  PB-INVALID-AH               VALUE '  ' '00'
  4809                                                   '90' THRU '99'.
  4810         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4811         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4812         16  PB-I-AH-CALC-FLAG            PIC X.
  4813             88 PB-COMP-AH-PREM                  VALUE '?'.
  4814         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4815         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4816         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4817         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4818         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4819         16  PB-I-AH-ABBR                 PIC XXX.
  4820         16  PB-I-AH-INPUT-CD             PIC XXX.
  4821
  4822         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4823         16  PB-I-REIN-TABLE              PIC XXX.
  4824         16  PB-I-BUSINESS-TYPE           PIC 99.
  4825         16  PB-I-INDV-GRP-CD             PIC X.
  4826         16  PB-I-MORT-CODE.
  4827             20  PB-I-TABLE               PIC X.
  4828             20  PB-I-INTEREST            PIC XX.
  4829             20  PB-I-MORT-TYP            PIC X.
  4830         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4831         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4832         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4833         16  PB-I-INDV-GRP-OVRD           PIC X.
  4834         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4835         16  PB-I-SIG-SW                  PIC X.
  4836             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4837         16  PB-I-RATE-CLASS              PIC XX.
  4838         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4839         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4840         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4841         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4842         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4843         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4844         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4845         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4846         16  PB-I-OB-FLAG                 PIC X.
  4847             88  PB-I-OB                      VALUE 'B'.
  4848             88  PB-I-SUMMARY                 VALUE 'Z'.
  4849         16  PB-I-ENTRY-STATUS            PIC X.
  4850             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4851                                              'M' '5' '9' '2'.
  4852             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4853             88  PB-I-POLICY-PENDING          VALUE '2'.
  4854             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4855             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4856             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4857             88  PB-I-REIN-ONLY               VALUE '9'.
  4858             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4859             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4860             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4861             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4862         16  PB-I-INT-CODE                PIC X.
  4863             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4864             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4865         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4866         16  PB-I-SOC-SEC-NO              PIC X(11).
  4867         16  PB-I-MEMBER-NO               PIC X(12).
  4868         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4869*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4870         16  PB-I-OLD-LOF                 PIC XXX.
  4871         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4872         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4873         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4874         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4875         16  PB-I-LIFE-INDICATOR          PIC X.
  4876             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4877         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4878         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4879                                          PIC S9(5)V99    COMP-3.
  4880         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4881             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4882             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4883         16  PB-I-1ST-PMT-DT              PIC XX.
  4884         16  PB-I-JOINT-INSURED.
  4885             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4886             20 PB-I-JOINT-FIRST-NAME.
  4887                24  PB-I-JOINT-FIRST-INIT PIC X.
  4888                24  FILLER                PIC X(9).
  4889             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4890*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4891         16  PB-I-BENEFICIARY-NAME.
  4892             20  PB-I-BANK-NUMBER         PIC X(10).
  4893             20  FILLER                   PIC X(15).
  4894         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4895         16  PB-I-REFERENCE               PIC X(12).
  4896         16  FILLER REDEFINES PB-I-REFERENCE.
  4897             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4898             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4899             20  PB-I-CLP-STATE           PIC XX.
  4900         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4901             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4902             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4903             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4904         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4905         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4906         16  PB-I-RESIDENT-STATE          PIC XX.
  4907         16  PB-I-RATE-CODE               PIC X(4).
  4908         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4909         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4910         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4911         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4912         16  PB-I-BANK-NOCHRGB            PIC 99.
  4913         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4914         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4915
  4916     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4917         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4918             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4919         16  PB-C-CANCEL-ORIGIN           PIC X.
  4920             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4921         16  PB-C-LF-CANCEL-DT            PIC XX.
  4922         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4923         16  PB-C-LF-CALC-REQ             PIC X.
  4924             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4925         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4926         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4927         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4928             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4929         16  PB-C-AH-CANCEL-DT            PIC XX.
  4930         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4931         16  PB-C-AH-CALC-REQ             PIC X.
  4932             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4933         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4934         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4935         16  PB-C-LAST-NAME               PIC X(15).
  4936         16  PB-C-REFUND-SW               PIC X.
  4937             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4938             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4939         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4940         16  PB-C-PAYEE-CODE              PIC X(6).
  4941         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4942         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4943         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4944         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4945         16  PB-C-REFERENCE               PIC X(12).
  4946         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4947         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4948         16  PB-C-POST-CARD-IND           PIC X.
  4949         16  PB-C-CANCEL-REASON           PIC X.
  4950         16  PB-C-REF-INTERFACE-SW        PIC X.
  4951         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4952         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4953         16  FILLER                       PIC X(01).
  4954*        16  FILLER                       PIC X(18).
  4955         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4956*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4957         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4958         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4959             20  PB-CI-INSURED-NAME.
  4960                 24  PB-CI-LAST-NAME      PIC X(15).
  4961                 24  PB-CI-INITIALS       PIC XX.
  4962             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4963             20  PB-CI-INSURED-SEX        PIC X.
  4964             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4965             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4966             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4967             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4968             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4969             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4970             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4971             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4972             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4973             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4974             20  PB-CI-RATE-CLASS         PIC XX.
  4975             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4976             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4977             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4978             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4979             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4980             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4981             20  PB-CI-LF-ABBR            PIC X(3).
  4982             20  PB-CI-AH-ABBR            PIC X(3).
  4983             20  PB-CI-OB-FLAG            PIC X.
  4984                 88  PB-CI-OB                VALUE 'B'.
  4985             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4986                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4987                                           'M' '4' '5' '9' '2'.
  4988                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4989                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4990                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4991                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4992                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4993                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4994                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4995                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4996                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4997                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4998                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4999                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5000             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5001                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5002                                           'M' '4' '5' '9' '2'.
  5003                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5004                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5005                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5006                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5007                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5008                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5009                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5010                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5011                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5012                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5013                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5014                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5015             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5016             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5017             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5018             20  PB-CI-MEMBER-NO          PIC X(12).
  5019             20  PB-CI-INT-CODE           PIC X.
  5020                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5021                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5022             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5023             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5024             20  PB-CI-COMP-EXCP-SW       PIC X.
  5025                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5026                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5027             20  PB-CI-ENTRY-STATUS       PIC X.
  5028             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5029             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5030             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5031             20  PB-CI-DEATH-DT           PIC XX.
  5032             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5033             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5034             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5035             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5036             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5037             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5038             20  PB-CI-ENTRY-DT              PIC XX.
  5039             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5040             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5041             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5042             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5043             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5044             20  PB-CI-OLD-LOF               PIC XXX.
  5045*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5046             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5047             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5048             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5049             20  PB-CI-INDV-GRP-CD           PIC X.
  5050             20  PB-CI-BENEFICIARY-NAME.
  5051                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5052                 24  FILLER                  PIC X(15).
  5053             20  PB-CI-NOTE-SW               PIC X.
  5054             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5055             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5056             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5057             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5058             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5059             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5060             20  PB-CI-FIRST-NAME            PIC X(10).
  5061             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5062
  5063         16  FILLER                       PIC X(13).
  5064*032306  16  FILLER                       PIC X(27).
  5065*        16  FILLER                       PIC X(46).
  5066
  5067     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5068         16  FILLER                       PIC X(10).
  5069         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5070         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5071         16  PB-M-INSURED-MID-INIT        PIC X.
  5072         16  PB-M-INSURED-AGE             PIC 99.
  5073         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5074         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5075         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5076         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5077         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5078         16  PB-M-INSURED-CITY-STATE.
  5079             20  PB-M-INSURED-CITY        PIC X(28).
  5080             20  PB-M-INSURED-STATE       PIC XX.
  5081         16  PB-M-INSURED-ZIP-CODE.
  5082             20  PB-M-INSURED-ZIP-PRIME.
  5083                 24  PB-M-INSURED-ZIP-1   PIC X.
  5084                     88  PB-M-CANADIAN-POST-CODE
  5085                                             VALUE 'A' THRU 'Z'.
  5086                 24  FILLER               PIC X(4).
  5087             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5088         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5089                                        PB-M-INSURED-ZIP-CODE.
  5090             20  PM-M-INS-CAN-POST1       PIC XXX.
  5091             20  PM-M-INS-CAN-POST2       PIC XXX.
  5092             20  FILLER                   PIC XXX.
  5093         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5094         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5095         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5096         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5097         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5098         16  PB-M-CRED-BENE-CITYST.
  5099             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5100             20  PB-M-CRED-BENE-STATE     PIC XX.
  5101
  5102         16  FILLER                       PIC X(92).
  5103
  5104     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5105         16  FILLER                       PIC X(10).
  5106         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5107         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5108         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5109         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5110         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5111         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5112         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5113         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5114         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5115         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5116         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5117         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5118         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5119         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5120         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5121         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5122         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5123         16  PB-ACCOUNT-NAME              PIC X(30).
  5124         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5125         16  PB-REFERENCE                 PIC X(12).
  5126         16  PB-B-RECEIVED-DT             PIC XX.
  5127         16  FILLER                       PIC X(234).
  5128
  5129     12  PB-RECORD-STATUS.
  5130         16  PB-CREDIT-SELECT-DT          PIC XX.
  5131         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5132         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5133         16  PB-BILLING-STATUS            PIC X.
  5134             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5135             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5136             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5137         16  PB-RECORD-BILL               PIC X.
  5138             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5139             88  PB-RECORD-RETURNED           VALUE 'R'.
  5140             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5141             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5142             88  PB-OVERRIDE-AH               VALUE 'A'.
  5143             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5144         16  PB-BATCH-ENTRY               PIC X.
  5145             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5146             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5147             88  PB-REISSUED-CERT             VALUE 'E'.
  5148             88  PB-MONTHLY-CERT              VALUE 'M'.
  5149             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5150             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5151             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5152         16  PB-FORCE-CODE                PIC X.
  5153             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5154             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5155             88  PB-CANCEL-FORCE              VALUE '8'.
  5156             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5157             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5158             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5159             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5160             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5161             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5162             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5163         16  PB-FATAL-FLAG                PIC X.
  5164             88  PB-FATAL-ERRORS              VALUE 'X'.
  5165         16  PB-FORCE-ER-CD               PIC X.
  5166             88  PB-FORCE-ERRORS              VALUE 'F'.
  5167             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5168         16  PB-WARN-ER-CD                PIC X.
  5169             88  PB-WARNING-ERRORS            VALUE 'W'.
  5170         16  FILLER                       PIC X.
  5171         16  PB-OUT-BAL-CD                PIC X.
  5172             88  PB-OUT-OF-BAL                VALUE 'O'.
  5173         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5174         16  PB-AH-OVERRIDE-L1            PIC X.
  5175         16  PB-INPUT-DT                  PIC XX.
  5176         16  PB-INPUT-BY                  PIC X(4).
  5177         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5178         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5179         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5180         16  PB-LF-EARNING-METHOD         PIC X.
  5181         16  PB-AH-EARNING-METHOD         PIC X.
  5182         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5183         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5184         16  PB-REIN-CD                   PIC XXX.
  5185         16  PB-LF-REFUND-TYPE            PIC X.
  5186         16  PB-AH-REFUND-TYPE            PIC X.
  5187         16  PB-ACCT-EFF-DT               PIC XX.
  5188         16  PB-ACCT-EXP-DT               PIC XX.
  5189         16  PB-COMPANY-ID                PIC X(3).
  5190         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 102
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5191         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5192         16  PB-SV-CARRIER                PIC X.
  5193         16  PB-SV-GROUPING               PIC X(6).
  5194         16  PB-SV-STATE                  PIC XX.
  5195         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5196         16  PB-GA-BILLING-INFO.
  5197             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5198                                          PIC XX.
  5199         16  PB-SV-REMIT-TO  REDEFINES
  5200             PB-GA-BILLING-INFO           PIC X(10).
  5201         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5202         16  PB-I-LOAN-OFFICER            PIC X(5).
  5203         16  PB-I-VIN                     PIC X(17).
  5204
  5205         16  FILLER                       PIC X(04).
  5206         16  IMNET-BYPASS-SW              PIC X.
  5207
  5208******************************************************************
  5209*                COMMON EDIT ERRORS                              *
  5210******************************************************************
  5211
  5212     12  PB-COMMON-ERRORS.
  5213         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5214                                           PIC S9(4)     COMP.
  5215
  5216******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 103
* ECS010.cbl
  5218 01  PC-STARTS-HERE              PIC X(48)
  5219       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5220
* 5221                             COPY ERCPNDC.
  5222******************************************************************04/29/98
  5223*                                                                *ERCPNDC
  5224*                                                                *ERCPNDC
  5225*                            ERCPNDC                             *   LV003
  5226*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5227*                            VMOD=2.004                          *   CL**2
  5228*                                                                *ERCPNDC
  5229*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5230*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5231*                                                                *ERCPNDC
  5232*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5233*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5234*                                                                *ERCPNDC
  5235*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5236*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5237*                                                                *ERCPNDC
  5238*   LOG = YES                                                    *ERCPNDC
  5239*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5240******************************************************************ERCPNDC
  5241                                                                  ERCPNDC
  5242 01  PENDING-CLAIMS.                                              ERCPNDC
  5243     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5244         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5245                                                                  ERCPNDC
  5246     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5247         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5248         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5249         16  PC-GROUPING.                                         ERCPNDC
  5250             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5251             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5252         16  PC-STATE                     PIC XX.                 ERCPNDC
  5253         16  PC-ACCOUNT.                                          ERCPNDC
  5254             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5255             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5256         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5257         16  PC-CERT-NO.                                          ERCPNDC
  5258             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5259             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5260         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5261         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5262                                                                  ERCPNDC
  5263         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5264             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5265             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5266         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5267                                                                  ERCPNDC
  5268     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5269     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5270     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5271                                                                  ERCPNDC
  5272     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5273         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5274             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5275             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5276             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5277             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5278         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5279         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5280         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5281         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5282         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5283         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5284         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5285         16  FILLER                       PIC XX.                 ERCPNDC
  5286         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5287             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5288             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5289             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5290             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5291             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5292             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5293             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5294                                                                  ERCPNDC
  5295         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5296         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5297         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5298         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5299                                                                  ERCPNDC
  5300         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5301         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5302         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5303                                                                  ERCPNDC
  5304         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5305             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5306                                                                  ERCPNDC
  5307         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5308         16  FILLER                       PIC X(48).              ERCPNDC
  5309                                                                  ERCPNDC
  5310         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5311             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5312                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5313                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5314             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5315             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5316             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5317             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5318             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5319             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5320             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5321             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5322             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5323             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5324             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5325             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5326             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5327                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5328             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5329                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5330                                               '4' '5' '9' '2'.   ERCPNDC
  5331                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5332                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5333                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5334                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5335                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5336                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5337                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5338                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5339                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5340             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5341                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5342                                               '4' '5' '9' '2'.   ERCPNDC
  5343                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5344                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5345                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5346                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5347                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5348                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5349                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5350                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5351                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5352             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5353             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5354             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5355             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5356             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5357                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5358                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5359             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5360             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5361             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5362             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5363             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5364             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5365             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5366             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5367         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5368         16  PC-CC-CLP-STATE              PIC XX.
  5369         16  FILLER                       PIC X(14).              ERCPNDC
  5370         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5371         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5372         16  FILLER                       PIC X(34).              ERCPNDC
  5373                                                                  ERCPNDC
  5374     12  PC-RECORD-STATUS.                                        ERCPNDC
  5375         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5376         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5377         16  FILLER                       PIC XX.                 ERCPNDC
  5378         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5379             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5380         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5381             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5382             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5383                                                     '8'.         ERCPNDC
  5384         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5385             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5386             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5387         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5388             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5389         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5390         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5391         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 106
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5392         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5393             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5394         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5395         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5396                                                                  ERCPNDC
  5397     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5398         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5399             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5400         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5401             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5402                                                                  ERCPNDC
  5403     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5404         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5405                                                                  ERCPNDC
  5406     12  FILLER                           PIC X(25).              ERCPNDC
  5407                                                                  ERCPNDC
  5408******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 107
* ECS010.cbl
  5410 01  CC-STARTS-HERE              PIC X(48)
  5411       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5412
* 5413                             COPY ERCCRTC.
  5414******************************************************************04/29/98
  5415*                                                                *ERCCRTC
  5416*                                                                *ERCCRTC
  5417*                            ERCCRTC                             *   LV003
  5418*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5419*                            VMOD=2.005                          *   CL**3
  5420*                                                                *ERCCRTC
  5421*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5422*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5423*                       ISSUES AND CANCELS)                      *ERCCRTC
  5424*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5425*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5426*                                                                *ERCCRTC
  5427*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5428*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5429*                                                                *ERCCRTC
  5430*   LOG = YES                                                    *ERCCRTC
  5431*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5432******************************************************************ERCCRTC
  5433*                   C H A N G E   L O G
  5434*
  5435* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5436*-----------------------------------------------------------------
  5437*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5438* EFFECTIVE    NUMBER
  5439*-----------------------------------------------------------------
  5440* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5441******************************************************************
  5442 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5443     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5444         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5445                                                                  ERCCRTC
  5446     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5447         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5448         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5449         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5450         16  CC-STATE                     PIC XX.                 ERCCRTC
  5451         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5452         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5453         16  CC-CERT-NO.                                          ERCCRTC
  5454             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5455             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5456                                                                  ERCCRTC
  5457         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5458                                                                  ERCCRTC
  5459     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5460     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5461     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5462                                                                  ERCCRTC
  5463     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5464                                                                  ERCCRTC
  5465     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5466         16  FILLER                       PIC X(10).              ERCCRTC
  5467         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5468             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5469             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5470                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5471                 24  FILLER               PIC X(9).               ERCCRTC
  5472             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5473         16  CC-AGE                       PIC S99.                ERCCRTC
  5474         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5475         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5476         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5477             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5478             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5479         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5480             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5481             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5482                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5483                 24  FILLER               PIC X(9).               ERCCRTC
  5484             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5485         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5486         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5487         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5488         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5489         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5490         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5491         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5492         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5493         16  CC-OLD-LOF                   PIC XXX.
  5494*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5495         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5496         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5497         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5498         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5499         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5500         16  FILLER                       PIC X(3).               ERCCRTC
  5501         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5502         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5503         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5504         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5505         16  CC-LOAN-OFFICER              PIC X(5).
  5506         16  FILLER                       PIC XXX.                ERCCRTC
  5507     12  CC-RECORD-STATUS.                                        ERCCRTC
  5508         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5509         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5510     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5511         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5512         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5513         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5514         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5515     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5516     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5517         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5518             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5519         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5520             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5521     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5522         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5523         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5524         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5525         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 109
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5526                                                                  ERCCRTC
  5527     12  FILLER                           PIC X(05).              ERCCRTC
  5528******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 110
* ECS010.cbl
  5530 01  CR-STARTS-HERE              PIC X(48)
  5531       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5532
* 5533                             COPY ECSCRT01.
  5534******************************************************************
  5535*                                                                *
  5536*                            ECSCRT01                            *
  5537*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5538*                            VMOD=2.016                          *
  5539*                                                                *
  5540*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5541*                                                                *
  5542*   FILE TYPE = SEQUENTIAL
  5543*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5544*                                                                *
  5545*   KEY DATA =                         START=4, LEN=36           *
  5546*                                                                *
  5547*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5548*                                                                *
  5549******************************************************************
  5550******************************************************************
  5551*                   C H A N G E   L O G
  5552*
  5553* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5554*-----------------------------------------------------------------
  5555*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5556* EFFECTIVE    NUMBER
  5557*-----------------------------------------------------------------
  5558* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5559* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5560* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5561* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5562* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5563* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5564* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5565* 032612  CR2011110200001  PEMA  AHL CHANGES
  5566******************************************************************
  5567
  5568 01  CERTIFICATE-RECORD.
  5569     12  CR-RECORD-ID                      PIC XX.
  5570         88  VALID-CR-ID                      VALUE 'CR'.
  5571
  5572     12  CR-COMPANY-CD                     PIC X.
  5573
  5574     12  CR-FULL-CONTROL.
  5575         16  CR-CONTROL-1.
  5576             20  CR-ACCT-CONTROL.
  5577                 24  CR-CARRIER            PIC X.
  5578                 24  CR-GROUPING.
  5579                     28  CR-GROUP-PREFIX   PIC XXX.
  5580                     28  CR-GROUP-PRIME    PIC XXX.
  5581                 24  CR-STATE              PIC XX.
  5582                 24  CR-ACCOUNT.
  5583                     28  CR-ACCT-PREFIX    PIC X(4).
  5584                     28  CR-ACCT-PRIME     PIC X(6).
  5585             20  CR-DT                     PIC 9(11)  COMP-3.
  5586         16  CR-CERT-NO.
  5587             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5588                 24  CR-CERT-PREFIX        PIC X(3).
  5589                 24  CR-CERT-PRIME         PIC X(7).
  5590             20  CR-CERT-SFX               PIC X.
  5591
  5592     12  CR-INSUREDS-PROFILE.
  5593         16  CR-NAME.
  5594             20  CR-LNAME                  PIC X(15).
  5595             20  CR-FNAME.
  5596                 24  CR-1ST-INITIAL        PIC X.
  5597                 24  FILLER                PIC X(9).
  5598             20  CR-INIT                   PIC X.
  5599         16  CR-AGE                        PIC 99.
  5600         16  CR-SEX                        PIC X.
  5601             88  CR-SEX-MALE                  VALUE 'M'.
  5602             88  CR-SEX-FEMALE                VALUE 'F'.
  5603         16  CR-SOC-SEC                    PIC X(11).
  5604         16  CR-JOINT-NAME.
  5605             20  CR-JT-LNAME               PIC X(15).
  5606             20  CR-JT-FNAME.
  5607                 24  CR-JT-1ST-INIT        PIC X.
  5608                 24  FILLER                PIC X(9).
  5609             20  CR-JT-INIT                PIC X.
  5610         16  CR-JOINT-AGE                  PIC 99.
  5611
  5612         16  cr-ahl-ah-claim-no            pic x(9).
  5613         16  cr-ahl-ah-cert-seq            pic x(3).
  5614         16  cr-hst-proc-lf                pic x.
  5615         16  f                             pic x(7).
  5616
  5617     12  CR-LF-COVERAGE-DATA.
  5618         16  CR-LFTYP                      PIC XX.
  5619         16  CR-LF-TERM                    PIC S999       COMP-3.
  5620         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5621         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5622         16  CR-LF-DEV-CODE                PIC XXX.
  5623         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5624
  5625         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5626         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5627         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5628         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5629
  5630         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5631         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5632         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5633         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5634
  5635         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5636         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5637
  5638         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5639         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5640
  5641         16  CR-LF-REFUND-TYPE             PIC X.
  5642         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5643
  5644         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5645             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5646
  5647         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5648
  5649         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5650         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5651         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5652
  5653         16  cr-ahl-lf-claim-no            pic x(9).
  5654         16  cr-ahl-lf-cert-seq            pic x(3).
  5655         16  FILLER                        PIC XX.
  5656
  5657     12  CR-AH-COVERAGE-DATA.
  5658         16  CR-AHTYP                      PIC XX.
  5659         16  CR-AH-TERM                    PIC S999       COMP-3.
  5660         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5661         16  CR-AH-DEV-CODE                PIC XXX.
  5662         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5663
  5664         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5665         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5666         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5667         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5668
  5669         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5670         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5671
  5672         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5673         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5674
  5675         16  CR-AH-REFUND-TYPE             PIC X.
  5676         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5677
  5678         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5679             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5680
  5681         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5682
  5683         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5684         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5685         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5686
  5687         16  FILLER                        PIC XX.
  5688*        16  FILLER                        PIC X(8).
  5689
  5690     12  CR-LOAN-DATA.
  5691         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5692         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5693                                           PIC S9(5)V99   COMP-3.
  5694         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5695         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5696         16  CR-PMT-FREQ                   PIC 99.
  5697         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5698         16  CR-RATING-CLASS               PIC XX.
  5699         16  CR-POLICY-FORM-NO             PIC X(12).
  5700         16  CR-GRPTYP                     PIC XX.
  5701         16  CR-IND-GRP                    PIC X.
  5702             88  CR-INDIVIDUAL                VALUE '1'.
  5703             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5704         16  CR-SKIP                       PIC 99.
  5705             88  NO-MONTHS-SKIPPED            VALUE 00.
  5706             88  SKIP-JULY                    VALUE 01.
  5707             88  SKIP-AUGUST                  VALUE 02.
  5708             88  SKIP-SEPTEMBER               VALUE 03.
  5709             88  SKIP-JULY-AUG                VALUE 04.
  5710             88  SKIP-AUG-SEPT                VALUE 05.
  5711             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5712             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5713             88  SKIP-JUNE                    VALUE 08.
  5714             88  SKIP-JUNE-JULY               VALUE 09.
  5715             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5716             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5717         16  CR-RESIDENT-STATE             PIC XX.
  5718         16  CR-RATE-CODE.
  5719             20  CR-LF-CLASS-CD            PIC XX.
  5720             20  CR-AH-CLASS-CD            PIC XX.
  5721         16  CR-MORT.
  5722             20  CR-TAB                    PIC X.
  5723             20  CR-INT                    PIC 99.
  5724             20  CR-GRP                    PIC X.
  5725         16  CR-MEMBER-NO                  PIC X(12).
  5726         16  CR-OLD-LOF                    PIC XXX.
  5727*        16  CR-LOAN-OFFICER               PIC XXX.
  5728         16  CR-REIN-TABLE                 PIC XXX.
  5729         16  CR-REIN-SPEC                  PIC X.
  5730         16  CR-LOAN-1ST-PMT-DT.
  5731             20  CR-1ST-PMT-YR             PIC 99.
  5732             20  CR-1ST-PMT-MO             PIC 99.
  5733             20  CR-1ST-PMT-DA             PIC 99.
  5734         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5735         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5736         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5737         16  CR-LAST-ADD-ON-DT             PIC XX.
  5738
  5739         16  CR-UNDERWRITING-CODE          PIC X.
  5740             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5741
  5742         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5743         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5744         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5745         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5746
  5747     12  CR-STATUS-INFORMATION.
  5748         16  CR-ENTRY-STATUS               PIC X.
  5749             88  CR-NORMAL-ENTRY              VALUE '1'.
  5750             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5751             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5752             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5753             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5754             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5755             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5756             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5757             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5758             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5759                                                    '5' '9' 'P'.
  5760         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5761
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5762         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5763         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5764         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5765
  5766         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5767         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5768
  5769         16  CR-LF-CURRENT-STATUS          PIC X.
  5770             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5771             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5772             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5773             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5774             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5775             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5776             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5777             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5778             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5779             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5780             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5781             88  CR-LF-IS-VOID                VALUE 'V'.
  5782             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5783                                                    '4' '5' '9'.
  5784
  5785         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5786
  5787         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5788         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5789
  5790         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5791         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5792
  5793         16  CR-AH-CURRENT-STATUS          PIC X.
  5794             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5795             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5796             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5797             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5798             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5799             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5800             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5801             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5802             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5803             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5804             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5805             88  CR-AH-IS-VOID                VALUE 'V'.
  5806             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5807                                                    '4' '5' '9'.
  5808         16  CR-LOAN-OFFICER               PIC X(5).
  5809         16  CR-CANCEL-REASON              PIC X.
  5810         16  cr-xycor-lf-cov-code          pic x(4).
  5811         16  cr-xycor-ah-cov-code          pic x(4).
  5812         16  FILLER                        PIC X(6).
  5813
  5814     12  CR-DEATH-CLAIM-DATA.
  5815         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5816
  5817         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5818         16  CR-DTH-RPT-DT.
  5819             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5820             20  CR-DTH-RPT-MO             PIC 99.
  5821             20  CR-DTH-RPT-DA             PIC 99.
  5822         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5823
  5824         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5825         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5826         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5827         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5828         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5829
  5830         16  CR-DTH-AGE                    PIC 99.
  5831         16  CR-DTH-PAY-CD                 PIC X.
  5832         16  CR-DEATH-CAUSE                PIC X(6).
  5833
  5834         16  FILLER                        PIC X(16).
  5835
  5836     12  CR-DISAB-CLAIM-DATA.
  5837         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5838
  5839         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5840         16  CR-DIS-RPT-DT.
  5841             20  CR-DIS-RPT-YR             PIC 99.
  5842             20  CR-DIS-RPT-MO             PIC 99.
  5843             20  CR-DIS-RPT-DA             PIC 99.
  5844         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5845         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5846
  5847         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5848         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5849         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5850         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5851         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5852
  5853         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5854         16  CR-DIS-PAY-CD                 PIC X.
  5855         16  FILLER                        PIC XX.
  5856
  5857         16  CR-DISAB-INCURRED-DETAIL.
  5858             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5859**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5860                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5861                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5862                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5863
  5864         16  CR-DISAB-CAUSE                PIC X(6).
  5865         16  FILLER                        PIC X(14).
  5866
  5867     12  CR-REMIT-TO                       PIC 99.
  5868
  5869     12  CR-COMPENSATION-LEVELS.
  5870         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5871             20  CR-COM-AGT.
  5872                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5873                 24  CR-COM-AGT-PRIME      PIC X(6).
  5874             20  CR-AGT-TYPE               PIC X.
  5875             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5876             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5877
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5878     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5879     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5880     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5881     12  CR-CLP-STATE                      PIC XX.
  5882     12  CR-POST-CARD-IND                  PIC X.
  5883     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5884     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5885     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5886     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5887     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5888     12  FILLER                            PIC X(07).
  5889
  5890     12  CR-CSR-CODE                       PIC XXX.
  5891
  5892     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5893     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5894
  5895     12  CR-MICROFILM-NUMBERS.
  5896*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5897         16  FILLER                        PIC X(5).
  5898     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5899
  5900     12  CR-USER-CODE                      PIC X.
  5901     12  CR-USER-FUTURE                    PIC X(9).
  5902
  5903     12  CR-BENEFICIARY.
  5904         16  CR-BANK-NO                    PIC X(10).
  5905         16  FILLER                        PIC X(15).
  5906
  5907     12  CR-ENTRY-BATCH                    PIC X(6).
  5908     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5909     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5910
  5911     12  CR-NOTE-SW                        PIC X.
  5912
  5913     12  CR-ORIGIN-INDICATOR               PIC X.
  5914         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5915         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5916
  5917     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5918     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5919     12  FILLER                            PIC X(33).
  5920
  5921******************************************************************
* 5922                             COPY ELCCRTVR.
  5923***************************************************************** 04/24/98
  5924*                                                                *ELCCRTVR
  5925*                                                                *ELCCRTVR
  5926*                            ELCCRTVR                            *   LV003
  5927*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5928*                            VMOD=2.001                          *ELCCRTVR
  5929*                                                                *ELCCRTVR
  5930*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5931*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5932*                                                                *ELCCRTVR
  5933******************************************************************ELCCRTVR
  5934                                                                  ELCCRTVR
  5935 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5936     05  WS-CR-DT.                                                ELCCRTVR
  5937         10  FILLER                PIC 999.                       ELCCRTVR
  5938         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5939         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5940             15  CR-CC             PIC 99.                        ELCCRTVR
  5941             15  CR-YR             PIC 99.                        ELCCRTVR
  5942         10  CR-MO                 PIC 99.                        ELCCRTVR
  5943         10  CR-DA                 PIC 99.                        ELCCRTVR
  5944     05  WS-CR-DT-N REDEFINES                                        CL**2
  5945            WS-CR-DT               PIC 9(11).                        CL**2
  5946     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5947         10  FILLER                    PIC 999.                   ELCCRTVR
  5948         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5949         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5950             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5951             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5952         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5953         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5954     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5955            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5956     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5957         10  FILLER                    PIC 999.                   ELCCRTVR
  5958         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5959         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5960             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5961             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5962         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5963         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5964     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5965            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5966     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5967         10  FILLER                    PIC 999.                   ELCCRTVR
  5968         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5969         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5970             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5971             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5972         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5973         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5974     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5975            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5976     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5977         10  FILLER                    PIC 999.                   ELCCRTVR
  5978         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5979         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5980             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5981             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5982         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5983         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5984     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5985            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5986     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5987         10  FILLER                    PIC 999.                   ELCCRTVR
  5988         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5989         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5990             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5991             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5992         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5993         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5994     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5995            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5996     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5997         10  FILLER                    PIC 999.                   ELCCRTVR
  5998         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5999         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  6000             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  6001             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  6002         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  6003         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  6004     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  6005            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  6006     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  6007         10  FILLER                    PIC 999.                   ELCCRTVR
  6008         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  6009         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  6010             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  6011             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  6012         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  6013         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  6014     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  6015            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  6016     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  6017         10  FILLER                    PIC 999.                   ELCCRTVR
  6018         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  6019         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  6020             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  6021             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  6022         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  6023         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  6024     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6025            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6026     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  6027         10  FILLER                    PIC 999.                   ELCCRTVR
  6028         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6029         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  6030             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  6031             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  6032         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  6033         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  6034     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  6035          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  6036     05  WS-CR-DTH-DT.                                            ELCCRTVR
  6037         10  FILLER                    PIC 999.                   ELCCRTVR
  6038         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  6039         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  6040             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  6041             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  6042         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  6043         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  6044     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6045            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6046     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6047         10  FILLER                    PIC 999.                   ELCCRTVR
  6048         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6049         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6050             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6051             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 119
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6052         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6053         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6054     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6055            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6056     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6057         10  FILLER                    PIC 999.                   ELCCRTVR
  6058         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6059         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6060             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6061             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6062         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6063         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6064     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6065            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6066     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6067         10  FILLER                    PIC 999.                   ELCCRTVR
  6068         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6069         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6070             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6071             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6072         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6073         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6074     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6075            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6076     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6077         10  FILLER                    PIC 999.                   ELCCRTVR
  6078         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6079         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6080             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6081             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6082         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6083         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6084     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6085            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6086     05  COPY-NDX                      PIC 9.                        CL**6
  6087     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6088         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6089             15  FILLER                PIC 999.                   ELCCRTVR
  6090             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6091             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6092                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6093                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6094             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6095             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6096         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6097                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6098
  6099 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 120
* ECS010.cbl
* 6101                             COPY ELCDATE.
  6102******************************************************************06/11/98
  6103*                                                                *ELCDATE
  6104*                                                                *ELCDATE
  6105*                            ELCDATE.                            *   LV023
  6106*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6107*                            VMOD=2.003                           ELCDATE
  6108*                                                                *ELCDATE
  6109*                                                                *ELCDATE
  6110*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6111*                 LENGTH = 200                                   *   CL*19
  6112******************************************************************ELCDATE
  6113                                                                  ELCDATE
  6114 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6115     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6116     12  DC-OPTION-CODE                PIC X.                        CL*15
  6117         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6118         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6119         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6120         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6121         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6122         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6123         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6124         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6125         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6126         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6127         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6128         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6129         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6130         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6131         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6132         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6133         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6134         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6135         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6136         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6137         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6138         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6139         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6140         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6141         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6142         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6143         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6144         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6145         88  THREE-CHARACTER-BIN                                  ELCDATE
  6146                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6147         88  GREGORIAN-TO-BIN                                        CL**2
  6148                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6149         88  BIN-TO-GREGORIAN                                        CL**2
  6150                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6151         88  JULIAN-TO-BINARY                                        CL**2
  6152                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6153     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6154         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6155         88  DATE-CONVERSION-ERROR                                ELCDATE
  6156                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6157         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6158         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6159         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6160         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6161         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6162         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6163         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6164         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6165         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6166         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6167     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6168         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6169     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6170         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6171         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6172         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6173     12  FILLER                        PIC X.                        CL*15
  6174     12  DC-CONVERSION-DATES.                                        CL*15
  6175         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6176         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6177         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6178         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6179                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6180             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6181             20  SLASH1-1              PIC X.                        CL*15
  6182             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6183             20  SLASH1-2              PIC X.                        CL*15
  6184             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6185         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6186         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6187                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6188             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6189             20  SLASH2-1              PIC X.                        CL*15
  6190             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6191             20  SLASH2-2              PIC X.                        CL*15
  6192             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6193         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6194         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6195                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6196             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6197             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6198             20  DC-YMD-DAY            PIC 99.                       CL*15
  6199         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6200         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6201                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6202             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6203             20  DC-MDY-DAY            PIC 99.                       CL*15
  6204             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6205         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6206             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6207             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6208             20  FILLER                PIC XX.                       CL*15
  6209             20  DC-ALPHA-CENTURY.                                   CL*15
  6210                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6211             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6212         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6213         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6214         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6215         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6216         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6217                                       PIC 9(05).                    CL*20
  6218         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6219             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6220             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6221         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6222         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6223         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6224     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6225         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6226         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6227             20  FILLER                PIC 9(3).                     CL*15
  6228             20  HOLD-CEN-1-CCYY.                                    CL*15
  6229                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6230                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6231             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6232             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6233         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6234             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6235             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6236             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6237                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6238                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6239             20  FILLER                PIC 9(3).                     CL*15
  6240         16  HOLD-CENTURY-1-X.                                       CL*15
  6241             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6242             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6243                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6244                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6245             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6246             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6247         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6248             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6249             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6250             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6251                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6252                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6253             20  FILLER                PIC XXX.                      CL*23
  6254         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6255         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6256         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6257         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6258             20  DC-JULIAN-1-CCYY.                                   CL*15
  6259                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6260                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6261             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6262         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6263         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6264             20  DC-JULIAN-2-CCYY.                                   CL*15
  6265                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6266                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6267             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6268         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6269             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6270             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6271             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6272             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6273             20  DC-EDITA-CCYY.                                      CL*15
  6274                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 123
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6275                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6276         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6277             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6278             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6279             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6280             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6281             20  DC-EDITB-CCYY.                                      CL*15
  6282                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6283                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6284         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6285         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6286                              DC-GREG-DATE-CYMD.                  ELCDATE
  6287             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6288             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6289             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6290             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6291         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6292         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6293                              DC-GREG-DATE-MDCY.                  ELCDATE
  6294             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6295             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6296             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6297             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6298    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6299        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6300    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6301    12  FILLER                         PIC X(28).                    CL*26
* 6302                             COPY ELCFUNDT.
  6303***************************************************************** 12/03/98
  6304*                                                               * ELCFUNDT
  6305*                            ELCFUNDT.                          *    LV004
  6306*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6307*                            VMOD=2.001                         * ELCFUNDT
  6308*                                                               * ELCFUNDT
  6309*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6310*                                                               * ELCFUNDT
  6311***************************************************************** ELCFUNDT
  6312                                                                  ELCFUNDT
  6313                                                                  ELCFUNDT
  6314 01  FUNCTION-DATE.                                                  CL**2
  6315     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6316     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6317         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6318         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6319             15  WS-FN-CC          PIC 99.                           CL**3
  6320             15  WS-FN-YR          PIC 99.                           CL**3
  6321         10  WS-FN-MO              PIC 99.                           CL**3
  6322         10  WS-FN-DA              PIC 99.                           CL**3
  6323     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6324     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6325     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6326     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6327     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6328         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6329         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6330         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6331     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6332     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 124
* ECS010.cbl
  6333
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 125
* ECS010.cbl
  6335 01  CPA-STARTS-HERE             PIC X(48)
  6336       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6337                             COPY ELCCALC.
  6338******************************************************************04/15/98
  6339*                                                                *ELCCALC
  6340*                           ELCCALC.                            *    LV003
  6341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6342*                            VMOD=2.025                          *   CL**3
  6343*                                                                *   CL**2
  6344*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6345*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6346*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6347*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6348*                                                                *   CL**2
  6349*  PASSED TO ELRTRM                                              *   CL**2
  6350*  -----------------                                             *   CL**2
  6351*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6352*  ORIGINAL TERM                                                 *   CL**2
  6353*  BEGINNING DATE                                                *   CL**2
  6354*  ENDING DATE                                                   *   CL**2
  6355*  COMPANY I.D.                                                  *   CL**2
  6356*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6357*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6358*  FREE LOOK DAYS                                                *   CL**2
  6359*                                                                *   CL**2
  6360*  RETURNED FROM ELRTRM                                          *   CL**2
  6361*  ---------------------                                         *   CL**2
  6362*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6363*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6364*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6365*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6366*----------------------------------------------------------------*   CL**2
  6367*  PASSED TO ELRAMT                                              *   CL**2
  6368*  ----------------                                              *   CL**2
  6369*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6370*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6371*  ORIGINAL AMOUNT                                               *   CL**2
  6372*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6373*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6374*  METHOD                                                            CL**2
  6375*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6376*  COMPANY I.D.                                                  *   CL**2
  6377*  BENEFIT TYPE                                                  *   CL**2
  6378*                                                                *   CL**2
  6379*  RETURNED FROM ELRAMT                                          *   CL**2
  6380*  --------------------                                          *   CL**2
  6381*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6382*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6383*  REMAINING AMOUNT FACTOR                                           CL**2
  6384*----------------------------------------------------------------*   CL**2
  6385*  PASSED TO ELRESV                                              *   CL**2
  6386*  -----------------                                             *   CL**2
  6387*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6388*  VALUATION DATE                                                *   CL**2
  6389*  PAID THRU DATE                                                *   CL**2
  6390*  BENEFIT                                                       *   CL**2
  6391*  INCURRED DATE                                                 *   CL**2
  6392*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6393*  ISSUE AGE                                                     *   CL**2
  6394*  TERM                                                          *   CL**2
  6395*  CDT PERCENT                                                   *   CL**2
  6396*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6397* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6398* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6399* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6400*                                                                *   CL**2
  6401*  RETURNED FROM ELRESV                                          *   CL**2
  6402*  --------------------                                          *   CL**2
  6403*  CDT TABLE USED                                                *   CL**2
  6404*  CDT FACTOR USED                                               *   CL**2
  6405*  PAY TO CURRENT RESERVE                                        *   CL**2
  6406*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6407*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6408*----------------------------------------------------------------*   CL**2
  6409*  PASSED TO ELRATE                                              *   CL**2
  6410*  ----------------                                              *   CL**2
  6411*  CERT ISSUE DATE                                               *   CL**2
  6412*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6413*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6414*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6415*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6416*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6417*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6418*  DEVIATION CODE                                                *   CL**2
  6419*  ISSUE AGE                                                     *   CL**2
  6420*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6421*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6422*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6423*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6424*  A.P.R.                                                        *   CL**2
  6425*  METHOD                                                            CL**2
  6426*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6427*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6428*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6429*  BENEFIT CODE                                                  *   CL**2
  6430*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6431*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6432*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6433*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6434*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6435*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6436*                                                                *   CL**2
  6437*  RETURNED FROM ELRATE                                          *   CL**2
  6438*  --------------------                                          *   CL**2
  6439*  CALCULATED PREMIUM                                            *   CL**2
  6440*  PREMIUM RATE                                                  *   CL**2
  6441*  MORTALITY CODE                                                *   CL**2
  6442*  MAX ATTAINED AGE                                              *   CL**2
  6443*  MAX AGE                                                       *   CL**2
  6444*  MAX TERM                                                      *   CL**2
  6445*  MAX MONTHLY BENEFIT                                           *   CL**2
  6446*  MAX TOTAL BENIFIT                                             *   CL**2
  6447*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6448*----------------------------------------------------------------*   CL**2
  6449*  PASSED TO ELRFND                                              *   CL**2
  6450*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6451*  CERT ISSUE DATE                                               *   CL**2
  6452*  REFUND DATE                                                   *   CL**2
  6453*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6454*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6455*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6456*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6457*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6458*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6459*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6460*  DEVIATION CODE                                                *   CL**2
  6461*  ISSUE AGE                                                     *   CL**2
  6462*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6463*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6464*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6465*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6466*  A.P.R.                                                        *   CL**2
  6467*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6468*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6469*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6470*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6471*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6472*  BENEFIT CODE                                                  *   CL**2
  6473*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6474*                                                                *   CL**2
  6475*  RETURNED FROM ELRFND                                          *   CL**2
  6476*  --------------------                                          *   CL**2
  6477*  CALCULATED REFUND                                             *   CL**2
  6478*----------------------------------------------------------------*   CL**2
  6479*  PASSED TO ELEARN                                              *   CL**2
  6480*  ----------------                                              *   CL**2
  6481*  CERT ISSUE DATE                                               *   CL**2
  6482*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6483*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6484*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6485*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6486*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6487*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6488*  DEVIATION CODE                                                *   CL**2
  6489*  ISSUE AGE                                                     *   CL**2
  6490*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6491*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6492*  A.P.R.                                                        *   CL**2
  6493*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6494*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6495*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6496*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6497*  BENEFIT CODE                                                  *   CL**2
  6498*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6499*                                                                *   CL**2
  6500*  RETURNED FROM ELEARN                                          *   CL**2
  6501*  --------------------                                          *   CL**2
  6502*  INDICATED  EARNINGS                                           *   CL**2
  6503*----------------------------------------------------------------*   CL**2
  6504*                 LENGTH = 450                                   *   CL**2
  6505*                                                                *   CL**2
  6506******************************************************************   CL**2
  6507******************************************************************
  6508*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6509*
  6510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6511*-----------------------------------------------------------------
  6512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6513* EFFECTIVE    NUMBER
  6514*-----------------------------------------------------------------
  6515* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6516* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6517* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6518* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6519* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6520* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6521* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6522* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6523* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6524******************************************************************
  6525                                                                     CL**2
  6526 01  CALCULATION-PASS-AREA.                                          CL**2
  6527     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6528                                     COMP.                           CL**2
  6529                                                                     CL**2
  6530     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6531       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6532       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6533                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6534       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6535       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6536       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6537       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6538       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6539       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6540       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6541       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6542       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6543       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6544       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6545       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6546       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6547       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6548       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6549       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6550       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6551                                                                     CL**2
  6552     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6553       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6554***********************  INPUT AREAS ****************************    CL**2
  6555                                                                     CL**2
  6556     12  CP-CALCULATION-AREA.                                        CL**2
  6557         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6558         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6559         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6560         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6561         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6562           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6563                                                   'I' 'U'.          CL**2
  6564           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6565           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6566         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6567         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6568         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6569         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6570         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6571                                     COMP-3.                         CL**2
  6572         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6573                                     COMP-3.                         CL**2
  6574         16  CP-CDT-METHOD         PIC X.                            CL**2
  6575           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6576           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6577           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6578         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6579           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6580           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6581         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6582                                     COMP-3.                         CL**2
  6583         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6584                                     COMP-3.                         CL**2
  6585         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6586                                     COMP-3.                         CL**2
  6587         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6588                                     COMP-3.                         CL**2
  6589         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6590                                     COMP-3.                         CL**2
  6591         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6592                                     COMP-3.                         CL**2
  6593         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6594                                     COMP-3.                         CL**2
  6595         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6596           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6597           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6598           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6599           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6600           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6601           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6602           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6603         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6604           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6605           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6606           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6607           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6608           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6609           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6610           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6611           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6612           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6613           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6614           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6615           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6616           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6617           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6618         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6619           88  CP-CLAIM                            VALUE '1'.        CL**2
  6620           88  CP-CANCEL                           VALUE '2'.        CL**2
  6621           88  CP-ISSUE                            VALUE '3'.        CL**2
  6622         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6623           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6624           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6625           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6626           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6627           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6628           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6629           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6630           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6631           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6632           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6633           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6634           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6635           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6636           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6637           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6638           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6639           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6640           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6641                                                     'W' 'X'.        CL**2
  6642           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6643           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6644           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6645           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6646           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6647           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6648           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6649           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6650           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6651           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6652           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6653           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6654           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6655                                                                     CL**2
  6656         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6657                                     COMP-3.                         CL**2
  6658         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6659         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6660         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6661         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6662         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6663           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6664               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6665         16  CP-R78-OPTION         PIC X.                            CL**2
  6666           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6667           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6668                                                                     CL**2
  6669         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6670         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6671         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6672         16  CP-RATE-FILE          PIC X.                            CL**2
  6673         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6674                                     COMP-3.                         CL**2
  6675                                                                     CL**2
  6676         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6677         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6678                                                                     CL**2
  6679         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6680                                     COMP-3.
  6681         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6682                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6683         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6684                                     COMP-3.                         CL**2
  6685         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6686                                     COMP-3.                         CL**2
  6687         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6688                                     COMP-3.
  6689         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6690                                  PIC S9(7)V99 COMP-3.
  6691                                                                     CL**2
  6692         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6693         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6694         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6695           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6696           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6697           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6698           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6699         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6700         16  CP-CARRIER            PIC X.                            CL**2
  6701         16  CP-REIN-FLAG          PIC X.                            CL**2
  6702         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6703           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6704                      '2' '3' '4' '5'.                               CL**2
  6705           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6706           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6707           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6708           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6709           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6710           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6711           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6712           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6713         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6714         16  CP-RATING-METHOD      PIC X.                            CL**2
  6715           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6716           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6717           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6718           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6719           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6720           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6721           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6722           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6723           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6724         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6725                                     COMP-3.                         CL**2
  6726         16  CP-BEN-CATEGORY       PIC X.
  6727         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6728         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6729                                   PIC S99V9(5) COMP-3.
  6730         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6731         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6732                                   PIC S99V9(5) COMP-3.
  6733         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6734         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6735         16  CP-EXPIRE-DT          PIC XX.
  6736         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6737         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6738         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6739         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6740         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6741             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6742             88  CP-CALC-CLP              VALUE 'C'.
  6743         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6744         16  CP-CANCEL-REASON      PIC X.
  6745         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6746         16  CP-PMT-MODE           PIC X.
  6747         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6748         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6749         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6750         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6751         16  FILLER                PIC X.
  6752                                                                     CL**2
  6753***************    OUTPUT FROM ELRESV   ************************     CL**2
  6754                                                                     CL**2
  6755         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6756                                                                     CL**2
  6757         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6758                                     COMP-3.                         CL**2
  6759         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6760                                     COMP-3.                         CL**2
  6761         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6762                                     COMP-3.                         CL**2
  6763         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6764                                     COMP-3.                         CL**2
  6765         16  FILLER                PIC X(09).                        CL**2
  6766***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6767                                                                     CL**2
  6768         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6769                                     COMP-3.                         CL**2
  6770         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6771                                     COMP-3.                         CL**2
  6772         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6773                                     COMP-3.                         CL**2
  6774         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6775                                     COMP-3.                         CL**2
  6776         16  FILLER                PIC X(12).                        CL**2
  6777                                                                     CL**2
  6778***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6779                                                                     CL**2
  6780         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6781                                     COMP-3.                         CL**2
  6782         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6783                                     COMP-3.                         CL**2
  6784         16  FILLER                PIC X(12).                        CL**2
  6785                                                                     CL**2
  6786***************    OUTPUT FROM ELRATE   *************************    CL**2
  6787                                                                     CL**2
  6788         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6789                                     COMP-3.                         CL**2
  6790         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6791                                     COMP-3.                         CL**2
  6792         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6793         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6794             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6795         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6796                                     COMP-3.                         CL**2
  6797         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6798         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6799         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6800                                   PIC S9(7)V99 COMP-3.
  6801         16  FILLER                PIC X(07).                        CL**2
  6802                                                                     CL**2
  6803***************    OUTPUT FROM ELRFND   *************************    CL**2
  6804                                                                     CL**2
  6805         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6806                                     COMP-3.                         CL**2
  6807         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6808           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6809           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6810           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6811           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6812           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6813           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6814           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6815           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6816           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6817           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6818           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6819           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6820           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6821           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6822         16  FILLER                PIC X(12).                        CL**2
  6823                                                                     CL**2
  6824***************    OUTPUT FROM ELEARN   *************************    CL**2
  6825                                                                     CL**2
  6826         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6827                                     COMP-3.                         CL**2
  6828         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6829                                     COMP-3.                         CL**2
  6830         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6831                                     COMP-3.                         CL**2
  6832         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6833                                     COMP-3.                         CL**2
  6834         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6835                                     COMP-3.                         CL**2
  6836         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6837                                     COMP-3.                         CL**2
  6838         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6839           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6840           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6841           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6842           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6843           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6844           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6845           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6846           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6847           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6848         16  FILLER                PIC X(12).                        CL**2
  6849                                                                     CL**2
  6850***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6851                                                                     CL**2
  6852         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6853                                     COMP-3.                         CL**2
  6854         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6855                                     COMP-3.                         CL**2
  6856         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 134
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6857                                                                     CL**2
  6858***************   MISC WORK AREAS    *****************************   CL**2
  6859         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6860                                     COMP-3.                         CL**2
  6861         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6862                                     COMP-3.                         CL**2
  6863         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6864                                     COMP-3.                         CL**2
  6865         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6866                                     COMP-3.                         CL**2
  6867         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6868                                     COMP-3.                         CL**2
  6869         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6870                                     COMP-3.                         CL**2
  6871         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6872             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6873             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6874             88  IO-ERROR                         VALUE 'E'.         CL**2
  6875                                                                     CL**2
  6876         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6877                                                                     CL**2
  6878         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6879                                                                     CL**2
  6880         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6881                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6882                                     COMP-3.                         CL**2
  6883                                                                     CL**2
  6884         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6885                                                                     CL**2
  6886         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6887                                     COMP-3.                         CL**2
  6888                                                                     CL**2
  6889         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6890                                     COMP-3.                         CL**2
  6891                                                                     CL**2
  6892         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6893                                     COMP-3.                         CL**2
  6894                                                                     CL**2
  6895         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6896                                     COMP-3.                         CL**2
  6897                                                                     CL**2
  6898         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6899                                     COMP-3.                         CL**2
  6900                                                                     CL**2
  6901         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6902                                     COMP-3.                         CL**2
  6903                                                                     CL**2
  6904         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6905                                     COMP-3.                         CL**2
  6906                                                                     CL**2
  6907         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6908             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6909                                                                     CL**2
  6910         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6911                                     COMP-3.                         CL**2
  6912         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6913                                     COMP-3.
  6914         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 135
* ECS010.cbl
  6915         16  FILLER                PIC X(15).                        CL**2
  6916******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 136
* ECS010.cbl
* 6918                             COPY ELCDTECX.
  6919******************************************************************06/05/98
  6920*                                                                *ELCDTECX
  6921*                            ELCDTECX.                           *   LV005
  6922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6923*                            VMOD=2.015                          *ELCDTECX
  6924*                                                                *ELCDTECX
  6925*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6926*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6927*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6928*                                                                *ELCDTECX
  6929******************************************************************ELCDTECX
  6930******************************************************************
  6931*                   C H A N G E   L O G
  6932*
  6933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6934*-----------------------------------------------------------------
  6935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6936* EFFECTIVE    NUMBER
  6937*-----------------------------------------------------------------
  6938* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6939*                                  BENEFIT CODES FROM 300 TO 900
  6940* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6941* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6942******************************************************************
  6943 01  DATE-CARD.                                                   ELCDTECX
  6944     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6945     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6946     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6947     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6948     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6949     12  EP-SW                       PIC  X.                      ELCDTECX
  6950         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6951     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6952         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6953     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6954     12  RUN-CENTURY.                                             ELCDTECX
  6955         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6956     12  FILLER                      PIC  X.                         CL**4
  6957     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6958     12  FILLER                      PIC  XXX.                    ELCDTECX
  6959     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6960                                                                  ELCDTECX
  6961 01  FILLER                          PIC  X(7)                       CL**6
  6962                                          VALUE 'OPTIONS'.        ELCDTECX
  6963 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6964     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6965     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6966     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6967         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6968         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6969     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6970     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6971     12  FILLER                      PIC  X.                      ELCDTECX
  6972     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6973     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6974     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  6975     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 137
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6976     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6977     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6978     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6979     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6980     12  FILLER                      PIC  X.                      ELCDTECX
  6981     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6982     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6983     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6984     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6985     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6986     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6987     12  FILLER                      PIC  X.                      ELCDTECX
  6988     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6989     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6990     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6991     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6992     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6993     12  DTE-R78                     PIC  X.                      ELCDTECX
  6994     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6995     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6996     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6997     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6998     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6999     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  7000     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  7001                                     PIC  X.                      ELCDTECX
  7002         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  7003                                                 ' '.             ELCDTECX
  7004         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  7005         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  7006     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  7007         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  7008         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  7009     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  7010     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  7011                                     PIC  9.                         CL**4
  7012     12  DTE-SYSTEM.                                              ELCDTECX
  7013         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  7014         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  7015         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  7016         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  7017         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  7018         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  7019         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  7020         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  7021         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  7022         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  7023         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  7024         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  7025         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  7026         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  7027         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  7028         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  7029         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  7030         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  7031         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  7032         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  7033         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7034         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  7035         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  7036         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  7037         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  7038         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  7039     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  7040         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  7041                                     PIC  X.                      ELCDTECX
  7042     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  7043                                                                  ELCDTECX
  7044 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7045     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7046     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7047     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7048*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7049     12  FILLER                      PIC  X.                      ELCDTECX
  7050     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7051     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7052     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7053     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7054     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7055     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7056     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7057                                                                  ELCDTECX
  7058     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7059     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7060     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7061     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7062                                                                  ELCDTECX
  7063     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7064     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7065     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7066     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7067                                                                  ELCDTECX
  7068     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7069     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7070                                                                  ELCDTECX
  7071     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7072     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7073                                                                  ELCDTECX
  7074     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7075                                                                  ELCDTECX
  7076 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7077     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7078     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7079     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7080     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7081     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7082     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7083     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7084                                                                  ELCDTECX
  7085 01  FILLER                          PIC  X(12)                   ELCDTECX
  7086                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7087 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7088     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7089         16  CNT-ID                  PIC  X.                      ELCDTECX
  7090         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  7091                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7092 01  FILLER                          PIC  X(11)                   ELCDTECX
  7093                                          VALUE 'STATE NAMES'.    ELCDTECX
  7094 01  STATE-NAMES.                                                 ELCDTECX
  7095     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7096         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7097         16  STATE-PIC1.                                          ELCDTECX
  7098             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7099             20  FILLER              PIC  XXX.                    ELCDTECX
  7100             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7101             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7102             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7103             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7104                                                                  ELCDTECX
  7105 01  FILLER                          PIC  X(13)                   ELCDTECX
  7106                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7107 01  CARRIER-NAMES.                                               ELCDTECX
  7108     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7109         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7110         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7111         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7112         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7113         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7114         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7115*        16  FILLER                  PIC  X.                      ELCDTECX
  7116         16  CARRIER-SEC-PAY         PIC  X.
  7117             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7118                                                                  ELCDTECX
  7119 01  FILLER                          PIC  X(9)                       CL**6
  7120                                          VALUE 'INS TYPES'.      ELCDTECX
  7121 01  CLAS-INS-TYPES.                                              ELCDTECX
  7122*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7123     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7124         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7125         16  CLAS-I-AB3.                                          ELCDTECX
  7126             20  FILLER              PIC  X.                      ELCDTECX
  7127             20  CLAS-I-AB2.                                      ELCDTECX
  7128                 24  FILLER          PIC  X.                      ELCDTECX
  7129                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7130         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7131             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7132             20  FILLER              PIC  X.                         CL**4
  7133         16  CLAS-I-AB10.                                         ELCDTECX
  7134             20  FILLER              PIC  X(9).                   ELCDTECX
  7135             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7136         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7137         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7138         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7139         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7140             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7141         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7142         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7143         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7144         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7145         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  7146         16  FILLER                  PIC  X(05).
  7147                                                                  ELCDTECX
  7148 01  FILLER                          PIC  X(16)                   ELCDTECX
  7149                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7150 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7151     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7152                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7153         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7154         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7155         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7156         16  CLAS-MORT-DESC.                                      ELCDTECX
  7157             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7158             20  FILLER              PIC  XX.                        CL**5
  7159             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7160             20  FILLER              PIC  X.                         CL**5
  7161             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7162             20  FILLER              PIC  X.                         CL**5
  7163             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7164             20  FILLER              PIC  X.                         CL**5
  7165             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7166             20  FILLER              PIC  X(5).                      CL**6
  7167                                                                  ELCDTECX
  7168 01  FILLER                          PIC  X(15)                   ELCDTECX
  7169                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7170 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7171     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7172         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7173         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7174         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7175         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7176         16  FILLER                  PIC  X(4).                      CL**6
  7177                                                                  ELCDTECX
  7178 01  FILLER                          PIC  X(7)                       CL**6
  7179                                     VALUE 'INDEXES'.             ELCDTECX
  7180 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7181     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7182     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7183     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7184     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7185     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7186     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7187     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7188     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7189     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7190     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7191     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7192     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7193     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7194     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7195     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7196     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7197     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7198                                                                  ELCDTECX
  7199 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7200     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7201     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7202     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7203     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7204     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7205     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  7206     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7207     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7208     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7209     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7210     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7211                                                                  ELCDTECX
  7212 01  FILLER                          PIC  X(13)                   ELCDTECX
  7213                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7214 01  CLAS-MISC.                                                   ELCDTECX
  7215     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7216         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7217         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7218         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7219     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7220     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7221     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7222     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7223     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7224     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7225     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7226     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7227     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7228     12  STATE-L                     PIC  XX.                     ELCDTECX
  7229     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7230     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7231     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7232         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7233         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7234     12  DTE-ABEND-WORK.                                          ELCDTECX
  7235         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7236         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7237                                                                  ELCDTECX
  7238 01  FILLER                          PIC  X(12)                   ELCDTECX
  7239                                     VALUE 'WORKING DATE'.        ELCDTECX
  7240 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7241     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7242         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7243         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7244         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7245     12  WS-CURRENT-DATE.                                         ELCDTECX
  7246         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7247         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7248         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7249         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7250         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7251     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7252         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7253         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7254                                                                  ELCDTECX
  7255 01  FILLER                          PIC  X(12)                   ELCDTECX
  7256                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7257 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7258     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7259         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7260         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7261         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7262                                                                  ELCDTECX
  7263 01  FILLER                          PIC  X(10)                   ELCDTECX
  7264                                     VALUE 'STATE TLRS'.          ELCDTECX
  7265 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 142
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7266     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7267         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7268         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7269                                                                  ELCDTECX
  7270 01  FILLER                          PIC  X(13)                   ELCDTECX
  7271                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7272 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7273     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7274         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7275                                                                  ELCDTECX
  7276 01  FILLER                          PIC  X(13)                   ELCDTECX
  7277                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7278 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7279     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7280     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7281     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7282                                     PIC  X.                         CL**5
  7283     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7284     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7285     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7286     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7287     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7288     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7289     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7290     12  FILLER                      PIC  X(75).                  ELCDTECX
  7291******************************************************************ELCDTECX
  7292*01  MISC-CARR-PCT-DATA.                                          00001521
  7293*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7294*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7295*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7296*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7297*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7298*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7299******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 143
* ECS010.cbl
* 7301                             COPY ELCDTEVR.
  7302***************************************************************** 04/15/98
  7303*                                                                *ELCDTEVR
  7304*                                                                *ELCDTEVR
  7305*                            ELCDTEVR.                           *   LV003
  7306*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7307*                            VMOD=2.001                          *   CL**2
  7308*                                                                *ELCDTEVR
  7309*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7310*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7311*                                                                *ELCDTEVR
  7312******************************************************************ELCDTEVR
  7313 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7314     05  WS-RUN-DATE.                                             ELCDTEVR
  7315         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7316         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7317         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7318             15  RUN-CC              PIC  99.                     ELCDTEVR
  7319             15  RUN-YR              PIC  99.                     ELCDTEVR
  7320         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7321         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7322     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7323            WS-RUN-DATE              PIC 9(11).                      CL**2
  7324     05  WS-EP-DT.                                                ELCDTEVR
  7325         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7326         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7327         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7328             15  EP-CC               PIC  99.                     ELCDTEVR
  7329             15  EP-YR               PIC  99.                     ELCDTEVR
  7330         10  EP-MO                   PIC  99.                     ELCDTEVR
  7331         10  EP-DA                   PIC  99.                     ELCDTEVR
  7332     05  WS-EP-DT-N REDEFINES                                        CL**2
  7333            WS-EP-DT                 PIC 9(11).                      CL**2
  7334     05  WS-DTE-CONV-DT.                                             CL**4
  7335         10  FILLER                  PIC  9(03).                     CL**4
  7336         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7337         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7338             15  DTE-CONV-CC         PIC  99.                        CL**4
  7339             15  DTE-CONV-YR         PIC  99.                        CL**4
  7340         10  DTE-CONV-MO             PIC  99.                        CL**4
  7341         10  DTE-CONV-DA             PIC  99.                        CL**4
  7342     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7343            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7344 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7345     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7346         10  FILLER                            PIC 999.           ELCDTEVR
  7347         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7348         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7349             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7350             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7351         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7352         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7353     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7354            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7355     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7356         10  FILLER                            PIC 999.           ELCDTEVR
  7357         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7358         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 144
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7359         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7360         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7361     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7362            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7363 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7364     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7365         10  FILLER                            PIC 999.           ELCDTEVR
  7366         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7367         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7368             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7369             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7370         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7371         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7372     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7373            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7374     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7375         10  FILLER                            PIC 999.           ELCDTEVR
  7376         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7377         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7378             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7379             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7380         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7381         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7382     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7383            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7384     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7385         10  FILLER                            PIC 999.           ELCDTEVR
  7386         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7387         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7388             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7389             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7390         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7391         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7392     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7393            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7394 01  WS-RATE-RECORD.                                              ELCDTEVR
  7395         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7396             10  FILLER                        PIC 999.           ELCDTEVR
  7397             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7398             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7399                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7400                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7401             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7402             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7403         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7404                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 145
* ECS010.cbl
* 7406                             COPY ELCACCTV.
  7407******************************************************************04/14/98
  7408*                                                                *ELCACCTV
  7409*                            ELCACCTV                            *   LV002
  7410*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7411*                            VMOD=2.001                          *ELCACCTV
  7412*                                                                *ELCACCTV
  7413*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7414*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7415*                                                                *ELCACCTV
  7416*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7417*                                                                *ELCACCTV
  7418******************************************************************ELCACCTV
  7419                                                                  ELCACCTV
  7420 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7421                                                                  ELCACCTV
  7422     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7423         10  FILLER            PIC 999.                           ELCACCTV
  7424         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7425         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7426             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7427             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7428         10  AM-EXP-MO         PIC 99.                               CL**5
  7429         10  AM-EXP-DA         PIC 99.                               CL**5
  7430     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7431            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7432     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7433         10  FILLER                    PIC 999.                   ELCACCTV
  7434         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7435         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7436             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7437             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7438         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7439         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7440     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7441            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7442     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7443         10  FILLER                    PIC 999.                   ELCACCTV
  7444         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7445         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7446             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7447             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7448         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7449         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7450     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7451            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7452     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7453         10 FILLER                     PIC 999.                   ELCACCTV
  7454         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7455         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7456            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7457            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7458         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7459         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7460     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7461            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7462     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7463         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 146
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7464         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7465         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7466            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7467            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7468         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7469         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7470     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7471            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7472     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7473         10  FILLER                    PIC 999.                   ELCACCTV
  7474         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7475         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7476             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7477             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7478         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7479         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7480     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7481            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7482     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7483         10  FILLER                    PIC 999.                   ELCACCTV
  7484         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7485         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7486             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7487             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7488         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7489         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7490     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7491            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7492     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7493         10  FILLER                    PIC 999.                   ELCACCTV
  7494         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7495         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7496             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7497             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7498         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7499         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7500     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7501            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7502     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7503         10  FILLER                    PIC 999.                   ELCACCTV
  7504         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7505         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7506             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7507             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7508         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7509         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7510     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7511            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 147
* ECS010.cbl
* 7513                             COPY ELCEXTVR.
  7514******************************************************************04/15/98
  7515*                                                                *ELCEXTVR
  7516*                                                                *ELCEXTVR
  7517*                             ELCEXTVR                           *   LV002
  7518*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7519*                            VMOD=2.001                          *ELCEXTVR
  7520*                                                                *ELCEXTVR
  7521*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7522*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7523*                                                                *ELCEXTVR
  7524******************************************************************ELCEXTVR
  7525 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7526     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7527         10  FILLER              PIC 999.                         ELCEXTVR
  7528         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7529         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7530             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7531             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7532         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7533         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7534     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7535            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7536 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7537     05  WS-DE-EFF.                                               ELCEXTVR
  7538         10  FILLER              PIC 999.                         ELCEXTVR
  7539         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7540         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7541             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7542             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7543         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7544         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7545     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7546            WS-DE-EFF            PIC 9(11).                          CL**2
  7547     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7548         10  FILLER              PIC 999.                         ELCEXTVR
  7549         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7550         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7551             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7552             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7553         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7554         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7555     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7556            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7557     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7558         10  FILLER                 PIC 999.                      ELCEXTVR
  7559         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7560         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7561             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7562             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7563         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7564         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7565     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7566            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7567     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7568         10  FILLER                 PIC 999.                      ELCEXTVR
  7569         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7570         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7571             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7572             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7573         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7574         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7575     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7576            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7577     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7578         10  FILLER                 PIC 999.                      ELCEXTVR
  7579         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7580         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7581             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7582             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7583         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7584         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7585     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7586            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7587     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7588         10  FILLER                 PIC 999.                      ELCEXTVR
  7589         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7590         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7591             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7592             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7593         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7594         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7595     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7596            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7597     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7598         10  FILLER                 PIC 999.                      ELCEXTVR
  7599         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7600         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7601             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7602             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7603         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7604         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7605     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7606            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7607     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7608         10  FILLER                 PIC 999.                         CL**5
  7609         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7610         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7611             15  DE-CP-CC           PIC 99.                          CL**5
  7612             15  DE-CP-YR           PIC 99.                          CL**5
  7613         10  DE-CP-MO               PIC 99.                          CL**5
  7614         10  DE-CP-DA               PIC 99.                          CL**5
  7615     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7616            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7617     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7618         10  FILLER                 PIC 999.                         CL**5
  7619         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7620         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7621             15  DE-RP-CC           PIC 99.                          CL**5
  7622             15  DE-RP-YR           PIC 99.                          CL**5
  7623         10  DE-RP-MO                      PIC 99.                   CL**5
  7624         10  DE-RP-DA                      PIC 99.                   CL**5
  7625     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7626            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7627     05  WS-DE-INCUR.                                             ELCEXTVR
  7628         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7629         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7630         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7631             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7632             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7633         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7634         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7635     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7636            WS-DE-INCUR             PIC 9(11).                       CL**2
  7637     05  WS-DE-PAY.                                               ELCEXTVR
  7638         10  FILLER                 PIC 999.                      ELCEXTVR
  7639         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7640         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7641             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7642             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7643         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7644         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7645     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7646            WS-DE-PAY               PIC 9(11).                       CL**2
  7647     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7648         10  FILLER                 PIC 999.                      ELCEXTVR
  7649         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7650         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7651             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7652             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7653         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7654         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7655     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7656            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7657     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7658         10 FILLER                  PIC 999.                      ELCEXTVR
  7659         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7660         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7661            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7662            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7663         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7664         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7665     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7666            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7667     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7668         10 FILLER                  PIC 999.                      ELCEXTVR
  7669         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7670         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7671            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7672            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7673         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7674         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7675     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7676            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7677     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7678         10  FILLER                 PIC 999.                      ELCEXTVR
  7679         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7680         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7681             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7682             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7683         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7684         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7685     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7686            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 150
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7687     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7688         10  FILLER                 PIC 999.                      ELCEXTVR
  7689         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7690         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7691             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7692             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7693         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7694         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7695     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7696            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7697     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7698         10  FILLER                        PIC 999.               ELCEXTVR
  7699         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7700         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7701                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7702             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7703             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7704         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7705         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7706     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7707            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7708     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7709         10  FILLER                        PIC 999.               ELCEXTVR
  7710         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7711         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7712                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7713             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7714             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7715         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7716         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7717     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7718            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7719                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 151
* ECS010.cbl
  7721 PROCEDURE DIVISION.
  7722
  7723 0000-START.
  7724
  7725******************************************************************
  7726***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7727******************************************************************
  7728
  7729*0003-LOAD-DATE-CARD.
* 7730                             COPY ELCDTERX.
  7731******************************************************************04/15/98
  7732*                                                                *ELCDTERX
  7733*                                                                *ELCDTERX
  7734*                            ELCDTERX.                           *   LV002
  7735*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7736*                            VMOD=2.007                          *ELCDTERX
  7737*                                                                *ELCDTERX
  7738*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7739*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7740*      = ELCDTEFD)                                               *ELCDTERX
  7741*                                                                *ELCDTERX
  7742******************************************************************ELCDTERX
  7743                                                                  ELCDTERX
  7744     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7745                                                                  ELCDTERX
  7746     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7747     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7748     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7749                                                                  ELCDTERX
  7750     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7751                                                                  ELCDTERX
  7752******************************************************************ELCDTERX
  7753*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7754*          WARNING MESSAGES.                                      ELCDTERX
  7755******************************************************************ELCDTERX
  7756     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7757         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7758                                                                  ELCDTERX
  7759     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7760                                                                  ELCDTERX
  7761     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7762                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7763                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7764                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7765                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7766                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7767                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7768                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7769                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7770                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7771                                                                  ELCDTERX
  7772     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7773                                                                  ELCDTERX
  7774     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7775                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7776                                                                  ELCDTERX
  7777     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7778     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7779     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7780     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7781                                                                  ELCDTERX
  7782     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7783         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7784     ELSE                                                         ELCDTERX
  7785         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7786                                                                  ELCDTERX
  7787     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7788         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7789     ELSE                                                         ELCDTERX
  7790         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7791                                                                  ELCDTERX
  7792 0005-READ--CARD.                                                 ELCDTERX
  7793     READ DISK-DATE                                               ELCDTERX
  7794         AT END CLOSE DISK-DATE                                   ELCDTERX
  7795             GO TO 0060-READ--TEST.                               ELCDTERX
  7796                                                                  ELCDTERX
  7797     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7798                                                                  ELCDTERX
  7799     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7800         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7801         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7802         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7803         GO TO 0005-READ--CARD.                                   ELCDTERX
  7804                                                                  ELCDTERX
  7805     IF DD-ID = 'CLAD'                                            ELCDTERX
  7806         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7807         GO TO 0005-READ--CARD.                                   ELCDTERX
  7808                                                                  ELCDTERX
  7809     IF DD-ID = 'CLAX'                                            ELCDTERX
  7810         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7811         GO TO 0005-READ--CARD.                                   ELCDTERX
  7812                                                                  ELCDTERX
  7813     IF DD-ID = 'CLAF'                                            ELCDTERX
  7814         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7815         GO TO 0005-READ--CARD.                                   ELCDTERX
  7816                                                                  ELCDTERX
  7817     IF DD-ID = 'CLAC'                                            ELCDTERX
  7818         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7819                                                                  ELCDTERX
  7820     IF DD-ID = 'CARR'                                            ELCDTERX
  7821         GO TO 0015-READ--CARR.                                   ELCDTERX
  7822                                                                  ELCDTERX
  7823     IF DD-ID = 'STAT'                                            ELCDTERX
  7824         GO TO 0020-READ--STAT.                                   ELCDTERX
  7825                                                                  ELCDTERX
  7826     IF DD-ID = 'BUSC'                                            ELCDTERX
  7827         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7828                                                                  ELCDTERX
  7829     IF DD-ID = 'MORT'                                            ELCDTERX
  7830         GO TO 0030-READ--MORT.                                   ELCDTERX
  7831                                                                  ELCDTERX
  7832     IF DD-ID = 'CLAI'                                            ELCDTERX
  7833         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7834                                                                  ELCDTERX
  7835     IF DD-ID = 'COLC'                                            ELCDTERX
  7836         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7837                                                                  ELCDTERX
  7838     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7839        DD-IDA = 'CL'                                             ELCDTERX
  7840         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7841                                                                  ELCDTERX
  7842     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7843        DD-IDA = 'PO'                                             ELCDTERX
  7844         GO TO 0050-READ--POXX.                                   ELCDTERX
  7845                                                                  ELCDTERX
  7846     IF DD-ID = 'OPCA'                                            ELCDTERX
  7847         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7848                                                                  ELCDTERX
  7849     IF DD-ID = 'OPST'                                            ELCDTERX
  7850         GO TO 0072-READ--OPST.                                   ELCDTERX
  7851                                                                  ELCDTERX
  7852     IF DD-ID = 'OPBS'                                            ELCDTERX
  7853         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7854                                                                  ELCDTERX
  7855     IF DD-ID = 'OPMS'                                            ELCDTERX
  7856         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7857                                                                  ELCDTERX
  7858     GO TO 0005-READ--CARD.                                       ELCDTERX
  7859                                                                  ELCDTERX
  7860 0010-READ--CLAC.                                                 ELCDTERX
  7861     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7862     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7863     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7864     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7865     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7866     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7867     GO TO 0005-READ--CARD.                                       ELCDTERX
  7868                                                                  ELCDTERX
  7869 0015-READ--CARR.                                                 ELCDTERX
  7870     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7871     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7872        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7873        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7874        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7875        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7876        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7877        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7878        MOVE DD-CARR1-SECPAY-SW
  7879                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7880     END-IF
  7881                                                                  ELCDTERX
  7882     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7883     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7884        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7885        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7886        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7887        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7888        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7889        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7890        MOVE DD-CARR2-SECPAY-SW
  7891                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7892     END-IF
  7893                                                                  ELCDTERX
  7894                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7895     GO TO 0005-READ--CARD.                                       ELCDTERX
  7896                                                                  ELCDTERX
  7897 0020-READ--STAT.                                                 ELCDTERX
  7898     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7899     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7900        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7901         GO TO 0005-READ--CARD.                                   ELCDTERX
  7902                                                                  ELCDTERX
  7903     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7904     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7905     GO TO 0020-READ--STAT.                                       ELCDTERX
  7906                                                                  ELCDTERX
  7907 0025-READ--BUSC.                                                 ELCDTERX
  7908     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7909     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7910        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7911         GO TO 0005-READ--CARD.                                   ELCDTERX
  7912                                                                  ELCDTERX
  7913     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7914     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7915     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7916                                                                  ELCDTERX
  7917 0030-READ--MORT.                                                 ELCDTERX
  7918     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7919     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7920        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7921         GO TO 0005-READ--CARD.                                   ELCDTERX
  7922                                                                  ELCDTERX
  7923     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7924     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7925     GO TO 0030-READ--MORT.                                       ELCDTERX
  7926                                                                  ELCDTERX
  7927 0035-READ--CLXX.                                                 ELCDTERX
  7928     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7929          GO TO 0005-READ--CARD.                                  ELCDTERX
  7930                                                                  ELCDTERX
  7931     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7932         DISPLAY '***********************************************'ELCDTERX
  7933         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7934         DISPLAY '***********************************************'ELCDTERX
  7935         GO TO 0055-READ--STOP.                                   ELCDTERX
  7936                                                                  ELCDTERX
  7937     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7938        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7939         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7940                                                                  ELCDTERX
  7941     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7942        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7943         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7944                                                                  ELCDTERX
  7945*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7946     GO TO 0005-READ--CARD.                                       ELCDTERX
  7947                                                                  ELCDTERX
  7948 0040-READ--CLAI.                                                 ELCDTERX
  7949     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7950     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7951        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7952         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7953                                                                  ELCDTERX
  7954     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7955     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7956     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7957                                                                  ELCDTERX
  7958 0045-READ--DUMP.                                                 ELCDTERX
  7959     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7960     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7961                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7962     PERFORM ABEND-PGM.                                           ELCDTERX
  7963                                                                  ELCDTERX
  7964 0050-READ--POXX.                                                 ELCDTERX
  7965     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7966         GO TO 0005-READ--CARD.                                   ELCDTERX
  7967                                                                  ELCDTERX
  7968     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7969         DISPLAY '***********************************************'ELCDTERX
  7970         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7971         DISPLAY '***********************************************'ELCDTERX
  7972         GO TO 0055-READ--STOP.                                   ELCDTERX
  7973                                                                  ELCDTERX
  7974     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7975     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7976     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7977     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7978                                                                  ELCDTERX
  7979     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7980         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7981     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7982         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7983                                                                  ELCDTERX
  7984     GO TO 0005-READ--CARD.                                       ELCDTERX
  7985                                                                  ELCDTERX
  7986 0055-READ--STOP.                                                 ELCDTERX
  7987     GOBACK.                                                      ELCDTERX
  7988                                                                  ELCDTERX
  7989 0060-READ--TEST.                                                 ELCDTERX
  7990     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7991        CLAX-ID         = SPACE  OR                               ELCDTERX
  7992        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7993         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7994                                                                  ELCDTERX
  7995     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7996     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7997                                                                  ELCDTERX
  7998 0065-READ--COLC.                                                 ELCDTERX
  7999     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8000     GO TO 0005-READ--CARD.                                       ELCDTERX
  8001                                                                  ELCDTERX
  8002 0070-READ--OPCA.                                                 ELCDTERX
  8003                                                                  ELCDTERX
  8004     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8005                                                                  ELCDTERX
  8006     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8007             OR                                                   ELCDTERX
  8008         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8009         GO TO 0005-READ--CARD.                                   ELCDTERX
  8010                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 156
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8011     ADD 1                       TO INDEXCA.                      ELCDTERX
  8012     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  8013                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  8014     GO TO 0070-READ--OPCA.                                       ELCDTERX
  8015                                                                  ELCDTERX
  8016 0072-READ--OPST.                                                 ELCDTERX
  8017                                                                  ELCDTERX
  8018     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8019                                                                  ELCDTERX
  8020     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8021             OR                                                   ELCDTERX
  8022         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8023         GO TO 0005-READ--CARD.                                   ELCDTERX
  8024                                                                  ELCDTERX
  8025     ADD 1                       TO INDEXST.                      ELCDTERX
  8026     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8027                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8028     GO TO 0072-READ--OPST.                                       ELCDTERX
  8029                                                                  ELCDTERX
  8030 0074-READ--OPBS.                                                 ELCDTERX
  8031                                                                  ELCDTERX
  8032     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8033                                                                  ELCDTERX
  8034     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8035             OR                                                   ELCDTERX
  8036         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8037         GO TO 0005-READ--CARD.                                   ELCDTERX
  8038                                                                  ELCDTERX
  8039     ADD 1                       TO INDEXBS.                      ELCDTERX
  8040     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8041     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8042                                                                  ELCDTERX
  8043 0079-READ--EXIT.                                                 ELCDTERX
  8044*    EXIT.                                                        ELCDTERX
  8045******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 157
* ECS010.cbl
  8047******************************************************************
  8048***           O P E N   F I L E S   R O U T I N E              ***
  8049******************************************************************
  8050
  8051     DISPLAY ' '.
  8052     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8053         'ECS010 ******'
  8054     DISPLAY ' '.
  8055
  8056     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8057     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8058     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8059     .
  8060 0080-OPEN-FILES.
  8061*    IF DTE-PGM-OPT = '1'
  8062*       open output detail-extr
  8063*    end-if
  8064     OPEN INPUT  PENDING-EXTRACT
  8065                 CERT-MASTER-IN
  8066                 ERACCTT-IN
  8067                 ERAGTC
  8068
  8069          I-O    ERMEBL-INOUT
  8070                 ELCRTT
  8071
  8072          OUTPUT SUMMARY-EXTR
  8073                 ME-ECS010-BALANCE
  8074                 ME50-ECS010-BALANCE
  8075                 DISPLAY-PRT
  8076                 MISMATCH-REPORT
  8077                 PRINT-COPY.
  8078     IF DTE-CLIENT = 'DCC'
  8079        OPEN INPUT ERPDEF
  8080     END-IF
  8081
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 158
* ECS010.cbl
  8083*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8084     IF DTE-CLIENT NOT = 'DMD'
  8085         NEXT SENTENCE
  8086     ELSE
  8087         OPEN INPUT ERRESC-IN
  8088            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8089                NEXT SENTENCE
  8090            ELSE
  8091                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8092                MOVE 'ERROR OPENING ERRESC FILE'
  8093                                        TO WS-ABEND-MESSAGE
  8094                GO TO ABEND-PGM.
  8095*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8096
  8097     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8098         NEXT SENTENCE
  8099       ELSE
  8100         MOVE '11'                    TO ABEND-CODE-1
  8101         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8102         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8103         GO TO ABEND-PGM.
  8104
  8105     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8106        CONTINUE
  8107     ELSE
  8108        DISPLAY ' OPEN ERROR ELCRTT '
  8109        MOVE '31'                TO ABEND-CODE-1
  8110        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8111        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8112        GO TO ABEND-PGM
  8113     END-IF
  8114
  8115     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8116        CONTINUE
  8117     ELSE
  8118        DISPLAY ' OPEN ERROR ERAGTC '
  8119        MOVE '41'                TO ABEND-CODE-1
  8120        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8121        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8122        GO TO ABEND-PGM
  8123     END-IF
  8124
  8125     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8126        CONTINUE
  8127     ELSE
  8128        DISPLAY ' OPEN ERROR ERPDEF '
  8129        MOVE '61'                TO ABEND-CODE-1
  8130        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8131        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8132        GO TO ABEND-PGM
  8133     END-IF
  8134
  8135     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8136         NEXT SENTENCE
  8137       ELSE
  8138         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8139
  8140           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 159
* ECS010.cbl
  8141              and (dte-pgm-opt = '1')
  8142              open output new-detail-extr
  8143           end-if
  8144
  8145     IF DTE-PGM-OPT = '1'
  8146         OPEN OUTPUT  CERT-MASTER-OUT
  8147                      DETAIL-EXTR
  8148     ELSE
  8149         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8150         MOVE '*'                     TO TRANS-EOF-FLAG.
  8151
  8152     MOVE 'R'                         TO CP-RATE-FILE.
  8153     MOVE 'O'                         TO CP-IO-FUNCTION.
  8154     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8155     IF IO-ERROR
  8156         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8157                                      TO WS-ABEND-MESSAGE
  8158         MOVE 0302                    TO WS-RETURN-CODE
  8159         GO TO ABEND-PGM.
  8160
  8161******************************************************************
  8162***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8163******************************************************************
  8164
  8165 0090-INITIALIZATION-ROUTINE.
  8166
  8167     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8168     MOVE WS-TIME                     TO ME-START-TIME.
  8169     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8170                                         TR-RN-DT.
  8171     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8172     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8173     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8174     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8175     MOVE COMPANY-NAME                TO TRHDNM.
  8176     MOVE ALPH-DATE                   TO TR-MODAYR.
  8177     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8178     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8179
  8180     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8181     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8182     COMPUTE LYD-MO = LYD-MO - 1.
  8183     IF LYD-MO = ZERO
  8184         MOVE 12                      TO LYD-MO
  8185         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8186
  8187     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8188
  8189
  8190     IF DTE-CLIENT = 'CID'
  8191         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8192         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8193     ELSE
  8194       IF DTE-CLIENT = 'AHL'
  8195         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8196         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8197       ELSE
  8198         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 160
* ECS010.cbl
  8199         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8200       END-IF
  8201     END-IF.
  8202
  8203     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8204         GO TO 0090-CONTINUE.
  8205
  8206     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8207     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8208     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8209     MOVE '6'                    TO DC-OPTION-CODE.
  8210     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8211
  8212     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8213         MOVE '**** WORK DATE CALC ERROR ****'
  8214                                 TO WS-ABEND-MESSAGE
  8215         MOVE '90'               TO ABEND-CODE-1
  8216         MOVE '0'                TO AC2-ONE
  8217         MOVE DC-ERROR-CODE      TO AC2-TWO
  8218         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8219         GO TO ABEND-PGM.
  8220
  8221     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8222
  8223     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8224     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8225
  8226     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8227             VARYING
  8228         SUBM FROM +2 BY +1
  8229             UNTIL
  8230         SUBM GREATER THAN +12.
  8231
  8232     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8233
  8234     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8235             VARYING
  8236         SUBM FROM +1 BY +1
  8237             UNTIL
  8238         SUBM GREATER THAN +13.
  8239
  8240     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8241*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8242     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8243                                    DC-ELAPSED-MONTHS.
  8244     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8245     MOVE 1                      TO DC-END-OF-MONTH.
  8246     MOVE '6'                    TO DC-OPTION-CODE.
  8247     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8248
  8249     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8250         MOVE '**** CUT OFF DATE ERROR ****'
  8251                                 TO WS-ABEND-MESSAGE
  8252         MOVE '90'               TO ABEND-CODE-1
  8253         MOVE '0'                TO AC2-ONE
  8254         MOVE DC-ERROR-CODE      TO AC2-TWO
  8255         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8256         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 161
* ECS010.cbl
  8257
  8258     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8259     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8260
  8261 0090-CONTINUE.
  8262
  8263     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8264     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8265     MOVE +0                     TO DC-ELAPSED-DAYS.
  8266     MOVE '6'                    TO DC-OPTION-CODE.
  8267     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8268
  8269     IF NO-CONVERSION-ERROR
  8270        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8271
  8272     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8273     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8274     MOVE +0                     TO DC-ELAPSED-DAYS.
  8275     MOVE '6'                    TO DC-OPTION-CODE.
  8276     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8277
  8278     IF NO-CONVERSION-ERROR
  8279        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8280
  8281     MOVE +0                     TO DC-ELAPSED-MONTHS
  8282                                    DC-ELAPSED-DAYS.
  8283
  8284     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8285     MOVE 'CR'                   TO CR-RECORD-ID.
  8286     MOVE ZEROS                  TO
  8287               CR-AGE                  CR-JOINT-AGE
  8288               CR-LFTYP                CR-AHTYP
  8289               CR-LF-TERM              CR-AH-TERM
  8290               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8291               CR-LF-TERM-IN-DAYS
  8292               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8293               CR-LFAMT                CR-AHAMT
  8294               CR-LFPRM                CR-AHPRM
  8295               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8296               CR-LFPRM-CALC           CR-AHPRM-CALC
  8297               CR-LFPRM-RATE           CR-AHPRM-RATE
  8298               CR-LFAMT-ALT
  8299               CR-LFPRM-ALT
  8300               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8301               CR-LFPRM-RATE-ALT
  8302               CR-LFRFND               CR-AHRFND
  8303               CR-LFRFND-CALC          CR-AHRFND-CALC
  8304               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8305               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8306               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8307               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8308               CR-LIVES                CR-APR
  8309               CR-BILLED
  8310               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8311               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8312               CR-PMT-FREQ             CR-LOAN-TERM
  8313               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8314               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 162
* ECS010.cbl
  8315               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8316               CR-LF-CANC-DT           CR-AH-CANC-DT
  8317               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8318               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8319               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8320               CR-DTH-DT               CR-DIS-DT
  8321               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8322               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8323                                       CR-DIS-PTO-DT
  8324               CR-DTHAMT               CR-DISAMT
  8325               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8326               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8327               CR-DTHEXP               CR-DISEXP
  8328               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8329               CR-DTH-AGE              CR-DAYS-DISAB
  8330               CR-DIS-INCUR-DT (1)
  8331***            CR-CLAIM-DEDUCT-WITHHELD
  8332               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8333               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8334               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8335               CR-MOB-NET-TOT-FEES
  8336               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8337               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8338
  8339     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8340                                       CR-DISAB-DETAIL-DATA (3)
  8341                                       CR-DISAB-DETAIL-DATA (4)
  8342                                       CR-DISAB-DETAIL-DATA (5).
  8343
  8344     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8345
  8346     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8347     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8348        IA > +10
  8349        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8350     END-PERFORM
  8351     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8352
  8353     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8354
  8355     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8356                          EPEC-TOTALS      EPEC-SUBS
  8357                          EPEC-UNDERWRITTEN-TOTALS.
  8358
  8359     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8360                          EPEC-LEVELS-END-II.
  8361     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8362                          DUPE-CERT-TABLE.
  8363
  8364     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8365     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8366     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8367                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8368     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8369                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8370
  8371     IF RUN-DATE NOT = EP-DT
  8372         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 163
* ECS010.cbl
  8373     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8374     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8375     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8376     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8377
  8378     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8379         MOVE +1000                   TO DUP-MAX.
  8380
  8381     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8382     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8383     IF ME-DO-UPDATE
  8384         READ ERMEBL-INOUT INVALID KEY
  8385                       CLOSE ERMEBL-INOUT
  8386                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8387
  8388     IF DTE-CLIENT = 'DCC'
  8389        MOVE 0 TO B-SUB
  8390        MOVE DTE-CLASIC-COMPANY-CD
  8391                                 TO PD-CONTROL-PRIMARY
  8392        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8393        IF ERPDEF-FILE-STATUS = '00'
  8394           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8395              READ ERPDEF NEXT RECORD
  8396              IF ERPDEF-FILE-STATUS = '00'
  8397                 ADD 1 TO B-SUB
  8398                 IF B-SUB > max-pdef
  8399                    DISPLAY ' DDF UEP TABLE BLEW ' b-sub
  8400                    GO TO ABEND-PGM
  8401                 END-IF
  8402                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8403                 MOVE PD-PRODUCT-CD
  8404                                 TO DD-PRODUCT-CD (B-SUB)
  8405                 MOVE PD-BEN-TYPE
  8406                                 TO DD-BEN-TYPE (B-SUB)
  8407                 MOVE PD-BEN-CODE
  8408                                 TO DD-BEN-CODE (B-SUB)
  8409                 MOVE PD-PROD-EXP-DT
  8410                                 TO DD-PROD-EXP-DT (B-SUB)
  8411                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8412                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8413                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8414                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8415                    P2 > +8
  8416                    MOVE PD-PROD-CODE (P2)
  8417                                 TO DD-PROD-CODE (B-SUB P2)
  8418                    MOVE PD-MAX-AMT (P2)
  8419                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8420                 END-PERFORM
  8421                 MOVE PD-EARN-FACTORS
  8422                                 TO DD-EARN-FACTORS (B-SUB)
  8423              END-IF
  8424           END-PERFORM
  8425           display ' pdef table entries ' b-sub
  8426        END-IF
  8427        CLOSE ERPDEF
  8428     END-IF
  8429
  8430     GO TO 0150-READ-ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 164
* ECS010.cbl
  8431
  8432 0090-EXIT.
  8433     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 165
* ECS010.cbl
  8435 0095-GET-EOM-DATES.
  8436
  8437     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8438     MOVE '6'                    TO DC-OPTION-CODE.
  8439     MOVE 1                      TO DC-ELAPSED-MONTHS
  8440                                    DC-END-OF-MONTH.
  8441     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8442     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8443
  8444     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8445         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8446                                 TO WS-ABEND-MESSAGE
  8447         MOVE '90'               TO ABEND-CODE-1
  8448         MOVE '0'                TO AC2-ONE
  8449         MOVE DC-ERROR-CODE      TO AC2-TWO
  8450         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8451         GO TO ABEND-PGM.
  8452
  8453     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8454                                     DC-BIN-DATE-1.
  8455     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8456     MOVE ' '                    TO  DC-OPTION-CODE.
  8457     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8458
  8459     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8460         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8461                                 TO WS-ABEND-MESSAGE
  8462         MOVE '90'               TO ABEND-CODE-1
  8463         MOVE '0'                TO AC2-ONE
  8464         MOVE DC-ERROR-CODE      TO AC2-TWO
  8465         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8466         GO TO ABEND-PGM.
  8467
  8468     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8469
  8470 0095-EXIT.
  8471     EXIT.
  8472
  8473 0096-DISPLAY-EOM-DATES.
  8474
  8475     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8476
  8477 0096-EXIT.
  8478     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 166
* ECS010.cbl
  8480******************************************************************
  8481***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8482******************************************************************
  8483
  8484 0100-ACCT-MASTER-READ-ROUTINE.
  8485
  8486     IF EP-FLG = '1'
  8487        ADD +1                   TO BC-ACT-ACCTS
  8488        IF DTE-OPT-RESERVE-METHOD-AUTH
  8489           PERFORM 4700-CALC-OPT-IBNR
  8490                                 THRU 4700-EXIT
  8491        END-IF
  8492        PERFORM 4500-BUILD-EPEC-EXTRACT
  8493                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8494     END-IF
  8495
  8496     IF TRANSACTION-WAS-PROCESSED
  8497         MOVE '1'                     TO ACCT-FLG
  8498                                         STATE-FLG
  8499                                         COMP-FLG
  8500                                         CARR-FLG
  8501                                         FINAL-FLG.
  8502
  8503 0150-READ-ACCOUNT-MASTER.
  8504
  8505     READ ERACCTT-IN AT END
  8506         GO TO 9930-EOJ-3.
  8507
  8508     ADD +1                            TO ERACCTT-READS.
  8509
* 8510     COPY ELCACCTI.
  8511******************************************************************04/14/98
  8512*                                                                *ELCACCTI
  8513*                            ELCACCTI                            *   LV003
  8514*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8515*                            VMOD=2.001                          *ELCACCTI
  8516*                                                                *ELCACCTI
  8517*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8518*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8519*                                                                *ELCACCTI
  8520*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8521*                                                                *ELCACCTI
  8522******************************************************************ELCACCTI
  8523     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8524     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8525     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8526     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8527     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8528     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8529     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8530     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8531     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8532
  8533     IF FIRST-ACCOUNT EQUAL +1
  8534        MOVE +0                  TO FIRST-ACCOUNT
  8535        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8536
  8537     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 167
* ECS010.cbl
  8538         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8539     ELSE
  8540     IF AM-GROUPING NOT = HLD-GROUPING
  8541         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8542     ELSE
  8543     IF AM-STATE NOT = HLD-STATE
  8544         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8545     ELSE
  8546     IF AM-ACCOUNT NOT = HLD-ACCT
  8547         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8548     ELSE
  8549     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8550
  8551     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8552        (AM-GROUPING NOT = HLD-GROUPING)
  8553         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8554
  8555 0190-PROCESS-NEW-ACCOUNT.
  8556
  8557     IF AM-CARRIER NOT = HLD-CARRIER
  8558         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8559
  8560     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8561     MOVE AM-CARRIER            TO TR-CARR.
  8562     MOVE AM-GROUPING           TO TR-GROUP.
  8563     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8564     MOVE AM-NAME               TO TR-AGCY.
  8565     MOVE AM-EFF-MO             TO TR-CE-MO.
  8566     MOVE AM-EFF-DA             TO TR-CE-DA.
  8567     MOVE AM-EFF-YR             TO TR-CE-YR.
  8568     MOVE AM-STATE              TO TR-ST-NO.
  8569     IF AM-EXPIRE-DT =  99999999999
  8570         MOVE 'CURRENT '        TO TR-CX
  8571     ELSE
  8572         MOVE AM-EXP-MO         TO TR-CX-MO
  8573         MOVE AM-EXP-DA         TO TR-CX-DA
  8574         MOVE AM-EXP-YR         TO TR-CX-YR
  8575         MOVE '-'               TO HSHR1  HSHR2.
  8576
  8577     ADD +1 TO BC-ACCTS.
  8578
  8579     IF AM-RECORD-ID = '**'
  8580         ADD +1 TO BC-NEW-ACCTS.
  8581     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8582         ADD +1 TO BC-ER-ACCTS.
  8583
  8584     MOVE ZEROS                 TO SV-LO-CERT
  8585                                   SV-HI-CERT.
  8586     MOVE SPACE                 TO TRANSACTION-FLAG
  8587                                   LST-TRD-CERT
  8588                                   LST-TRD-ISDT
  8589                                   OB-DATE-1-SWITCH
  8590                                   OB-DATE-2-SWITCH
  8591                                   OB-DATE-3-SWITCH.
  8592     MOVE +81                   TO LN-CNT.
  8593
  8594     IF DTE-CLIENT = 'DCC'
  8595        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 168
* ECS010.cbl
  8596        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8597           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8598              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8599           END-IF
  8600           IF AM-COMM-CHARGEBACK (SUB) = 99
  8601              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8602           END-IF
  8603        END-PERFORM
  8604     END-IF
  8605     .
  8606 0199-READ-ACCOUNT-X.
  8607     EXIT.
  8608
  8609 0199A-CARRIER-TABLE-LOOKUP.
  8610
  8611     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8612            VARYING CLAS-INDEXCN FROM 1 BY 1
  8613         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8614               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8615
  8616     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8617         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8618         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8619                                 TO WS-ABEND-MESSAGE
  8620         MOVE 4004               TO WS-ABEND-CODE
  8621         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8622         GO TO ABEND-PGM.
  8623
  8624 0199A-LOOKUP-XIT.
  8625     EXIT.
  8626 0199B-SEARCH-CARRIER-TABLE.
  8627     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 169
* ECS010.cbl
  8629******************************************************************
  8630***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8631******************************************************************
  8632
  8633 0200-CERT-MASTER-READ-ROUTINE.
  8634
  8635     IF EOF-ON-CERT
  8636         GO TO 0299-READ-CERT-X.
  8637
  8638     IF FIRST-CERT EQUAL +1
  8639        MOVE +0                  TO FIRST-CERT
  8640        GO TO 0250-READ-CERT-MASTER.
  8641
  8642     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8643
  8644     PERFORM CERT-DATE-LOAD.
  8645
  8646     IF CR-IND-GRP = 'I'  OR  '1'
  8647         MOVE '1'                    TO CR-IND-GRP
  8648     ELSE
  8649         MOVE '2'                    TO CR-IND-GRP.
  8650
  8651     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8652         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8653     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8654         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8655
  8656************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8657     IF DTE-CLIENT NOT = 'NSL'
  8658         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8659                                      CR-AH-REI-RISK-PRM.
  8660******************************************************************
  8661
  8662**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8663****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8664     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8665         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8666
  8667     MOVE CR-STATE                   TO STATE-L.
  8668     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8669
  8670     IF CR-LFTYP NOT = ZERO
  8671         MOVE CR-LFTYP               TO CLAS-LOOK
  8672         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8673
  8674     IF CR-AHTYP NOT = ZERO
  8675         MOVE CR-AHTYP               TO CLAS-LOOK
  8676         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8677
  8678     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8679     MOVE 'L'                    TO DC-OPTION-CODE
  8680     MOVE +0                     TO DC-ELAPSED-MONTHS
  8681                                    DC-ELAPSED-DAYS
  8682     PERFORM 8000-DATE-CONVERT-ROUTINE
  8683                                 THRU 8099-DATE-CONVERT-X
  8684     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8685
  8686     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 170
* ECS010.cbl
  8687        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8688        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8689        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8690        PERFORM 0395-GET-CERT-TRLRS
  8691                                 THRU 0395-EXIT
  8692     END-IF
  8693
  8694     IF RUN-MO NOT = 01
  8695         GO TO 0250-READ-CERT-MASTER.
  8696
  8697     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8698                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8699
  8700     IF ((CR-LFTYP NOT = ZERO)  AND
  8701         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8702        ((CR-AHTYP NOT = ZERO)  AND
  8703         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8704           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8705
  8706     .
  8707 0250-READ-CERT-MASTER.
  8708
  8709     READ CERT-MASTER-IN
  8710               AT END GO TO 9920-EOJ-2.
  8711
  8712     ADD +1 TO CMIN-CNT.
  8713
  8714*     DISPLAY ' READ CERT ' CIR-CONTROL
  8715     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8716         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8717         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8718         DISPLAY 'SECOND - '  CIR-CONTROL
  8719         MOVE 0612                    TO WS-ABEND-CODE
  8720         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8721         GO TO ABEND-PGM.
  8722
  8723     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8724         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8725            pcic-dt ' ' pcic-cert-no
  8726         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8727            GO TO 0250-READ-CERT-MASTER
  8728         ELSE
  8729            MOVE 'DUPLICATE CERT ON FILE'
  8730                                      TO WS-ABEND-MESSAGE
  8731            MOVE 0302                 TO WS-ABEND-CODE
  8732            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8733            GO TO ABEND-PGM.
  8734
  8735******************************************************
  8736*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8737*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8738*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8739******************************************************
  8740     IF DTE-CLIENT = 'CID'
  8741        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8742           IF (CF-THIRD-AGENT  = '0000713100') OR
  8743              (CF-FOURTH-AGENT = '0000713100')
  8744              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 171
* ECS010.cbl
  8745           ELSE
  8746              GO TO 0250-READ-CERT-MASTER
  8747           END-IF
  8748        ELSE
  8749           IF COMPANY-NAME = '        PEOPLES TRUST'
  8750              IF CI-ACCOUNT = '0000845800'
  8751                 CONTINUE
  8752              ELSE
  8753                 GO TO 0250-READ-CERT-MASTER
  8754              END-IF
  8755           ELSE
  8756              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8757                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8758                    (CF-FOURTH-AGENT = '0000681700')
  8759                    CONTINUE
  8760                 ELSE
  8761                    GO TO 0250-READ-CERT-MASTER
  8762                 END-IF
  8763              ELSE
  8764                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8765                    IF CI-ACCOUNT = '0001107200' or '0001107201'
  8766                       CONTINUE
  8767                    ELSE
  8768                       GO TO 0250-READ-CERT-MASTER
  8769                    END-IF
  8770                 END-IF
  8771              END-IF
  8772           END-IF
  8773        END-IF
  8774     END-IF
  8775
  8776******************************************************
  8777     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8778
  8779 0299-READ-CERT-X.
  8780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 172
* ECS010.cbl
  8782******************************************************************
  8783***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8784******************************************************************
  8785
  8786 0300-READ-PENDING-TRANSACTIONS.
  8787
  8788     READ PENDING-EXTRACT
  8789                   AT END GO TO 9910-EOJ-1.
  8790
  8791     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8792
  8793     IF NOT ED-PENDING-BUSINESS  AND
  8794        NOT ED-PENDING-CLAIMS  AND
  8795        NOT ED-CERT-CHANGES
  8796           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8797                                               ED-RECORD-TYPE
  8798           MOVE 0301                        TO WS-ABEND-CODE
  8799           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8800           GO TO ABEND-PGM.
  8801
  8802     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8803
  8804     IF DTE-CLIENT = 'NCL'
  8805         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8806             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8807                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8808             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8809
  8810     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8811         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8812         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8813         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8814         MOVE 0603                    TO WS-ABEND-CODE
  8815         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8816         GO TO ABEND-PGM.
  8817
  8818     ADD +1 TO TR-CNT.
  8819
  8820     IF ISSUE-TRANSACTION   OR
  8821        CANCEL-TRANSACTION  OR
  8822        CLAIM-TRANSACTION   OR
  8823        RESERVE-TRANSACTION OR
  8824        UPDATE-TRANSACTION
  8825         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8826         GO TO 0330-MATCH-PENDING-TO-CERT.
  8827
  8828     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8829
  8830     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8831     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8832             PENDING-RECORD-TYPE ')'.
  8833
  8834     MOVE 0301                   TO WS-ABEND-CODE.
  8835     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8836     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 173
* ECS010.cbl
  8838 0310-SET-UP-MATCHING-KEY.
  8839
  8840     IF ED-PENDING-BUSINESS
  8841         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8842         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8843         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8844         MOVE PB-STATE           TO PEND-MATCH-STATE
  8845         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8846         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8847         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8848         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8849
  8850     IF ED-PENDING-CLAIMS
  8851         ADD +1                  TO W-PENDING-CLMS
  8852         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8853         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8854         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8855         MOVE PC-STATE           TO PEND-MATCH-STATE
  8856         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8857         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8858         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8859         IF PC-CLAIMS
  8860             MOVE '3'            TO PENDING-RECORD-TYPE
  8861         ELSE
  8862             IF PC-RESERVES
  8863                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8864
  8865     IF ED-CERT-CHANGES
  8866         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8867         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8868         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8869         MOVE CC-STATE           TO PEND-MATCH-STATE
  8870         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8871         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8872         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8873         MOVE '5'                TO PENDING-RECORD-TYPE.
  8874
  8875     MOVE ' '                    TO DC-OPTION-CODE.
  8876     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8877     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8878
  8879 0310-EXIT.
  8880     EXIT.
  8881
  8882******************************************************************
  8883***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8884******************************************************************
  8885
  8886 0330-MATCH-PENDING-TO-CERT.
  8887
  8888     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8889         GO TO 0390-CERT-MISMATCH-ERROR.
  8890
  8891     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8892*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8893       IF CLAIM-TRANSACTION
  8894*         DISPLAY ' CLAIM '
  8895         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 174
* ECS010.cbl
  8896            NOT PC-NON-CHARGEBLE-EXPENSE
  8897             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8898                                      OR
  8899                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8900                  GO TO 0390-CERT-MISMATCH-ERROR.
  8901
  8902     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8903       IF RESERVE-TRANSACTION
  8904*         DISPLAY ' RESV '
  8905         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8906                                  OR
  8907            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8908              GO TO 0390-CERT-MISMATCH-ERROR.
  8909
  8910     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8911         IF ISSUE-TRANSACTION
  8912*           DISPLAY ' ISSUE '
  8913             GO TO 0380-DUPLICATE-CERT-ERROR
  8914         ELSE
  8915             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8916
  8917     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8918         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8919         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8920                                               0299-READ-CERT-X
  8921         GO TO 0330-MATCH-PENDING-TO-CERT.
  8922
  8923     IF ISSUE-TRANSACTION
  8924         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8925     ELSE
  8926         GO TO 0390-CERT-MISMATCH-ERROR.
  8927
  8928 0350-MATCH-PENDING-TO-ACCOUNT.
  8929
  8930     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8931       ADD +1  TO ERROR-COUNT
  8932         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8933           TO  DL-FULL
  8934             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8935         MOVE    ' PENDING CONTROL = '
  8936           TO  DIS-LINE-REASON
  8937         MOVE  PENDING-MATCH-CONTROL
  8938           TO  DIS-LINE-REC
  8939             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8940         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8941           TO  DIS-LINE-REASON
  8942         MOVE  PENDING-MATCH-CONTROL
  8943           TO  DIS-LINE-REC
  8944             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8945         MOVE  SPACES
  8946           TO  DISPLAY-LINE
  8947             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8949         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8950         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8951         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8952         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8953         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8954         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 175
* ECS010.cbl
  8955         AM-MSTR-CNTRL AM-EFFECT-DT
  8956         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8957            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8958            GO TO 0300-READ-PENDING-TRANSACTIONS
  8959         ELSE
  8960            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8961                                      TO WS-ABEND-MESSAGE
  8962            MOVE 0302 TO WS-ABEND-CODE
  8963            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8964            GO TO ABEND-PGM.
  8965
  8966     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8967         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8968                                              0199-READ-ACCOUNT-X
  8969         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8970
  8971     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8972        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8973         GO TO 0500-APPLY-PENDING-BUSINESS.
  8974
  8975     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8976                                       0199-READ-ACCOUNT-X.
  8977     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8978
  8979
  8980 0370-ACCOUNT-MISMATCH-ERROR.
  8981
  8982     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8983     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8984     MOVE 'MISMATCH ACCOUNT ERROR'
  8985                               TO WS-ABEND-MESSAGE.
  8986     MOVE 0302 TO WS-ABEND-CODE.
  8987         DISPLAY '******************************'
  8988         DISPLAY '***** ERROR LOCATION 009 *****'
  8989         DISPLAY '******************************'
  8990     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8991     GO TO ABEND-PGM.
  8992
  8993
  8994 0380-DUPLICATE-CERT-ERROR.
  8995
  8996     IF PB-I-OB  OR  PB-I-SUMMARY
  8997         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8998
  8999     ADD +1 TO DUP-CNT.
  9000
  9001     IF DUP-CNT NOT GREATER THAN DUP-MAX
  9002         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  9003         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  9004                                         PB-I-LF-ALT-PREMIUM-AMT
  9005         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  9006         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  9007         GO TO 0300-READ-PENDING-TRANSACTIONS.
  9008
  9009     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  9010     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9011
  9012*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 176
* ECS010.cbl
  9013*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9014*    GO TO ABEND-PGM.
  9015
  9016
  9017 0390-CERT-MISMATCH-ERROR.
  9018
  9019     IF ISSUE-TRANSACTION  OR
  9020        CANCEL-TRANSACTION  OR
  9021        CLAIM-TRANSACTION
  9022         ADD +1                  TO  MISMATCH-COUNT.
  9023
  9024     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  9025       ADD  +1  TO  ERROR-COUNT
  9026         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  9027           TO  DL-FULL
  9028             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9029         MOVE    ' TRANS CONTROL = '
  9030           TO  DIS-LINE-REASON
  9031         MOVE  PENDING-MATCH-CONTROL
  9032           TO  DIS-LINE-REC
  9033             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9034         MOVE    ' TRANS TYPE    = '
  9035           TO  DIS-LINE-REASON
  9036         MOVE  PENDING-RECORD-TYPE
  9037           TO  DIS-LINE-REC
  9038             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9039         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9040           TO  DL-FULL
  9041             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9042         MOVE    ' CERT IN CTL   = '
  9043           TO  DIS-LINE-REASON
  9044         MOVE  CIR-CONTROL
  9045           TO  DIS-LINE-REC
  9046             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9047         MOVE    ' BYPASSED TRANS  = '
  9048           TO  DIS-LINE-REASON
  9049         MOVE  PENDING-MATCH-CONTROL
  9050           TO  DIS-LINE-REC
  9051             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9052         MOVE  SPACES
  9053           TO  DISPLAY-LINE
  9054             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9055         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9056
  9057     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9058     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9059
  9060     IF ISSUE-TRANSACTION
  9061         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9062     ELSE
  9063         IF CANCEL-TRANSACTION
  9064             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9065         ELSE
  9066             IF CLAIM-TRANSACTION
  9067                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9068             ELSE
  9069                 IF RESERVE-TRANSACTION
  9070                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 177
* ECS010.cbl
  9071                 ELSE
  9072                     IF UPDATE-TRANSACTION
  9073                         MOVE 'CHG'
  9074                                 TO  DTL-REC-TYPE-DESC.
  9075
  9076     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9077     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9078     MOVE 'DROPPED'              TO  DTL-STATUS.
  9079
  9080     IF ISSUE-TRANSACTION
  9081         MOVE PB-I-LF-PREMIUM-AMT
  9082                                 TO  MD2-LF-PREM
  9083         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9084                                 TO  MD2-LF-ALT-PREM
  9085         MOVE PB-I-AH-PREMIUM-AMT
  9086                                 TO  MD2-AH-PREM
  9087         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9088         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9089         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9090     ELSE
  9091         IF CANCEL-TRANSACTION
  9092             MOVE PB-C-LF-CANCEL-AMT
  9093                                 TO  MD3-LF-REFUND
  9094             MOVE PB-C-AH-CANCEL-AMT
  9095                                 TO  MD3-AH-REFUND
  9096             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9097             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9098         ELSE
  9099             IF CLAIM-TRANSACTION
  9100                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9101                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9102                     MOVE ZEROS             TO MD4-AH-CLAIM
  9103                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9104                 ELSE
  9105                     MOVE ZEROS             TO MD4-LF-CLAIM
  9106                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9107                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9108
  9109     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9110         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9111         MOVE MISMATCH-PAGE-NUMBER
  9112                                 TO  TR-PG
  9113         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9114         MOVE MR-CTL             TO  X
  9115         MOVE X TO LCP-ASA
  9116         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9117             THRU LCP-WRITE-END-MISMATCH-RPT
  9118         MOVE TR-HD-2            TO  MISMATCH-RPT
  9119         MOVE MR-CTL             TO  X
  9120         MOVE X TO LCP-ASA
  9121         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9122             THRU LCP-WRITE-END-MISMATCH-RPT
  9123         MOVE TR-HD-3            TO  MISMATCH-RPT
  9124         MOVE MR-CTL             TO  X
  9125         MOVE X TO LCP-ASA
  9126         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9127             THRU LCP-WRITE-END-MISMATCH-RPT
  9128         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 178
* ECS010.cbl
  9129         MOVE MR-CTL             TO  X
  9130         MOVE X TO LCP-ASA
  9131         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9132             THRU LCP-WRITE-END-MISMATCH-RPT
  9133         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9134
  9135     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9136     MOVE MR-CTL                 TO  X.
  9137     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9138
  9139     MOVE X TO LCP-ASA
  9140     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9141         THRU LCP-WRITE-END-MISMATCH-RPT.
  9142
  9143     IF ISSUE-TRANSACTION
  9144         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9145         MOVE MR-CTL             TO  X
  9146         ADD +1                  TO  MISMATCH-LINE-COUNT
  9147         MOVE X TO LCP-ASA
  9148         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9149             THRU LCP-WRITE-END-MISMATCH-RPT.
  9150
  9151     IF CANCEL-TRANSACTION
  9152         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9153         MOVE MR-CTL             TO  X
  9154         ADD +1                  TO  MISMATCH-LINE-COUNT
  9155         MOVE X TO LCP-ASA
  9156         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9157             THRU LCP-WRITE-END-MISMATCH-RPT.
  9158
  9159     IF CLAIM-TRANSACTION
  9160         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9161         MOVE MR-CTL             TO  X
  9162         ADD +1                  TO  MISMATCH-LINE-COUNT
  9163         MOVE X TO LCP-ASA
  9164         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9165             THRU LCP-WRITE-END-MISMATCH-RPT.
  9166
  9167     MOVE SPACES                 TO  MISMATCH-RPT.
  9168
  9169     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9170
  9171 0395-GET-CERT-TRLRS.
  9172
  9173     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9174     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9175     MOVE CR-CARRIER             TO CS-CARRIER
  9176     MOVE CR-GROUPING            TO CS-GROUPING
  9177     MOVE CR-STATE               TO CS-STATE
  9178     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9179     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9180     MOVE CR-CERT-NO             TO CS-CERT-NO
  9181     MOVE 'A'                    TO CS-TRAILER-TYPE
  9182
  9183     READ ELCRTT
  9184
  9185     IF ELCRTT-FILE-STATUS = '00'
  9186        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 179
* ECS010.cbl
  9187                                 TO WS-BANK-COMMISSIONS
  9188     ELSE
  9189        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9190           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9191           PERFORM ABEND-PGM
  9192        END-IF
  9193     END-IF
  9194
  9195     .
  9196 0395-EXIT.
  9197     EXIT.
  9198
  9199******************************************************************
  9200***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9201******************************************************************
  9202
  9203 0400-WRITE-CERT-RECORD.
  9204*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9205
  9206     IF CERTIFICATE-RECORD = LOW-VALUES
  9207         GO TO 0499-WRITE-CERT-X.
  9208
  9209     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9210         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9211         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9212            ' ' cr-dt ' ' cr-cert-no
  9213         ADD  +1  TO  ERROR-COUNT
  9214         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9215           TO  DL-FULL
  9216             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9217         MOVE    ' CERT. CONTROL = '
  9218           TO  DIS-LINE-REASON
  9219         MOVE  CR-FULL-CONTROL
  9220           TO  DIS-LINE-REC
  9221             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9222         MOVE  SPACES
  9223           TO  DISPLAY-LINE
  9224             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9225            if dte-pgm-opt = '1'
  9226               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9227               ADD +1 TO CMOT-CNT
  9228            end-if
  9229            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9230                                 thru 0299-READ-CERT-X
  9231               GO TO 0400-WRITE-CERT-RECORD.
  9232
  9233*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9234
  9235     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9236         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9237                                              0199-READ-ACCOUNT-X
  9238         GO TO 0400-WRITE-CERT-RECORD.
  9239
  9240     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9241        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9242         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9243                                              0199-READ-ACCOUNT-X
  9244         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 180
* ECS010.cbl
  9245
  9246*     DISPLAY ' BEFORE REIN '
  9247     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9248*     DISPLAY ' AFTER REIN '
  9249
  9250     IF CR-LFTYP = ZEROS  AND
  9251        CR-DTHEXP NOT = ZEROS
  9252         ADD +1                     TO W-LFTYP-99
  9253         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9254         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9255
  9256     IF CR-AHTYP = ZEROS  AND
  9257        CR-DISEXP NOT = ZEROS
  9258         ADD +1                     TO W-AHTYP-99
  9259         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9260         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9261
  9262*     DISPLAY ' BEFORE EP BUMP'
  9263     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9264*     DISPLAY ' AFTER EP BUMP'
  9265
  9266      if (dte-client = 'DCC')
  9267         and (ws-dcc-cnc-flag = 'Y')
  9268         write new-detail-extract
  9269      end-if
  9270
  9271     IF CR-LFTYP = '99'
  9272         MOVE '00'                  TO CR-LFTYP.
  9273     IF CR-AHTYP = '99'
  9274         MOVE '00'                  TO CR-AHTYP.
  9275
  9276*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9277*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9278
  9279     IF CR-NH-INT-ON-REF NOT NUMERIC
  9280         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9281     END-IF
  9282
  9283     IF  CR-POLICY-IS-ACTIVE
  9284         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9285         IF  CR-POLICY-IS-REISSUE
  9286             OR CR-POLICY-IS-MONTHLY
  9287             ADD +1              TO W-POLICY-REISSUE-CTR
  9288         ELSE
  9289             IF  CR-POLICY-IS-REIN-ONLY
  9290                 ADD +1          TO W-POLICY-REIN-CTR
  9291             ELSE
  9292                 NEXT SENTENCE
  9293     ELSE
  9294         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9295
  9296     IF DTE-PGM-OPT = '1'
  9297       IF REIN-IS-RISK-PREMIUM  AND
  9298          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9299         IF NOT CR-POLICY-IS-REISSUE  AND
  9300            NOT CR-POLICY-IS-DECLINED  AND
  9301            NOT CR-POLICY-IS-VOID
  9302            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 181
* ECS010.cbl
  9303             MOVE '*'            TO RISK-PREM-FLAG
  9304             PERFORM 3100-REINSURE-ISSUE THRU
  9305                     3199-REINSURE-ISSUE-X.
  9306
* 9307     COPY ELCCRTM2.
  9308******************************************************************04/16/98
  9309*                                                                *ELCCRTM2
  9310*                                                                *ELCCRTM2
  9311*                            ELCCRTM2                            *   LV004
  9312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9313*                            VMOD=2.001                          *ELCCRTM2
  9314*                                                                *ELCCRTM2
  9315*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9316*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9317*                                                                *ELCCRTM2
  9318******************************************************************ELCCRTM2
  9319     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9320     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9321     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9322     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9323     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9324     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9325                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9326     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9327     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9328     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9329     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9330                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9331     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9332     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9333     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9334     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9335     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9336                                                                     CL**4
  9337     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9338                UNTIL COPY-NDX > 5                                   CL**4
  9339           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9340                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9341     END-PERFORM.                                                 ELCCRTM2
  9342                                                                  ELCCRTM2
  9343
  9344     IF DTE-PGM-OPT = '1'
  9345         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9346         ADD +1 TO CMOT-CNT.
  9347
  9348     move zeros                  to ueclp-clp-fact
  9349     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9350                                    RISK-REIN-FLAG
  9351                                    RISK-PREM-FLAG
  9352                                    RC-COMM-FLG.
  9353
  9354 0499-WRITE-CERT-X.
  9355     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 182
* ECS010.cbl
  9357******************************************************************
  9358***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9359******************************************************************
  9360
  9361 0500-APPLY-PENDING-BUSINESS.
  9362
  9363     IF CANCEL-TRANSACTION
  9364*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9365         GO TO 0600-PROCESS-CANCELLATIONS.
  9366
  9367     IF CLAIM-TRANSACTION
  9368*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9369         GO TO 0700-PROCESS-CLAIMS.
  9370
  9371     IF RESERVE-TRANSACTION
  9372*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9373         GO TO 0800-PROCESS-RESERVES.
  9374
  9375     IF UPDATE-TRANSACTION
  9376*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9377         GO TO 0900-PROCESS-CERT-CHANGES.
  9378
  9379******************************************************************
  9380***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9381******************************************************************
  9382
  9383 0505-PROCESS-ISSUES.
  9384
  9385     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9386     PERFORM CERT-DATE-LOAD.
  9387
  9388     ADD +1                      TO  W-POL-ISSUES.
  9389
  9390     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9391     MOVE PB-CARRIER             TO  CR-CARRIER.
  9392     MOVE PB-GROUPING            TO  CR-GROUPING.
  9393     MOVE PB-STATE               TO  CR-STATE.
  9394     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9395     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9396                                     WS-CR-BIN-DATE
  9397     MOVE ' '                    TO  DC-OPTION-CODE.
  9398     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9399     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9400                                     WS-CR-DT-N.
  9401     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9402
  9403*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9404     MOVE PB-I-NAME              TO  CR-NAME.
  9405     MOVE PB-I-AGE               TO  CR-AGE.
  9406     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9407     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9408
  9409     IF PB-I-JOINT-COVERAGE
  9410         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9411         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9412     ELSE
  9413        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9414           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 183
* ECS010.cbl
  9415             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9416
  9417     IF PB-I-SUMMARY  OR
  9418        DTE-CLIENT = 'DMD'
  9419         MOVE PB-I-LIVES         TO  CR-LIVES.
  9420
  9421     IF PB-I-NUM-BILLED NOT NUMERIC
  9422        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9423
  9424     IF PB-I-STATE-TAX NOT NUMERIC
  9425        MOVE ZEROS               TO PB-I-STATE-TAX.
  9426
  9427     IF PB-I-MUNI-TAX NOT NUMERIC
  9428        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9429     IF PB-I-TOT-FEES NOT NUMERIC
  9430        MOVE ZEROS               TO PB-I-TOT-FEES
  9431     END-IF
  9432     IF PB-I-ADDL-CLP NOT NUMERIC
  9433        MOVE ZEROS               TO PB-I-ADDL-CLP
  9434     END-IF
  9435
  9436     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9437     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9438     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9439     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9440     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9441     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9442     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9443     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9444     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9445     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9446     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9447     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9448     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9449
  9450     IF PB-I-RATE-CLASS-OVRD = SPACES
  9451         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9452     ELSE
  9453         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9454
  9455     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9456     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9457
  9458     IF PB-I-INDV-GRP-OVRD = SPACES
  9459         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9460     ELSE
  9461         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9462
  9463     IF CR-IND-GRP = 'I'  OR  '1'
  9464         MOVE '1'                TO  CR-IND-GRP
  9465     ELSE
  9466         MOVE '2'                TO  CR-IND-GRP.
  9467
  9468     IF PB-I-SKIP-CODE = '1'
  9469         MOVE 01                 TO  CR-SKIP.
  9470     IF PB-I-SKIP-CODE = '2'
  9471         MOVE 02                 TO  CR-SKIP.
  9472     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 184
* ECS010.cbl
  9473         MOVE 03                 TO  CR-SKIP.
  9474     IF PB-I-SKIP-CODE = '4'
  9475         MOVE 04                 TO  CR-SKIP.
  9476     IF PB-I-SKIP-CODE = '5'
  9477         MOVE 05                 TO  CR-SKIP.
  9478     IF PB-I-SKIP-CODE = '6'
  9479         MOVE 06                 TO  CR-SKIP.
  9480     IF PB-I-SKIP-CODE = '7'
  9481         MOVE 07                 TO  CR-SKIP.
  9482     IF PB-I-SKIP-CODE = '8'
  9483         MOVE 08                 TO  CR-SKIP.
  9484     IF PB-I-SKIP-CODE = '9'
  9485         MOVE 09                 TO  CR-SKIP.
  9486     IF PB-I-SKIP-CODE = 'A'
  9487         MOVE 10                 TO  CR-SKIP.
  9488     IF PB-I-SKIP-CODE = 'X'
  9489         MOVE 11                 TO  CR-SKIP.
  9490
  9491     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9492     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9493     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9494
  9495     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9496         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9497                                        REIN-SPEC-A
  9498                                        REIN-SPEC-B
  9499                                        REIN-SPEC-C
  9500         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9501     ELSE
  9502         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9503
  9504     IF DTE-CLIENT = 'DCC'
  9505        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9506        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9507           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9508        END-IF
  9509     END-IF
  9510
  9511     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9512     MOVE ' '                    TO  DC-OPTION-CODE.
  9513     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9514     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9515
  9516     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9517
  9518     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9519         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9520     ELSE
  9521         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9522
  9523     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9524         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9525
  9526     IF PB-BATCH-ENTRY = SPACE  OR
  9527        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9528         MOVE '1'                TO  CR-ENTRY-STATUS
  9529     ELSE
  9530         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 185
* ECS010.cbl
  9531
  9532     IF PB-POLICY-IS-DECLINED
  9533         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9534
  9535     IF PB-POLICY-IS-VOIDED
  9536         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9537
  9538***  IF DTE-CLIENT NOT = 'CRI'
  9539***      IF PB-I-PREM-ACCTNG-ONLY
  9540***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9541
  9542     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9543                                     WS-CR-ENTRY-DATE-N.
  9544
  9545*    IF PB-I-MICROFILM-NO NUMERIC
  9546*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9547
  9548     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9549        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9550        OR 'AHL'
  9551         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9552     END-IF
  9553
  9554*************************************************
  9555***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9556***  WAS CONVERTED TO 1056 BYTES.             ***
  9557*************************************************
  9558     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9559     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9560
  9561     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9562
  9563     MOVE CR-STATE               TO STATE-L.
  9564
  9565     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9566
  9567     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9568
  9569***************************************************
  9570***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9571***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9572***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9573***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9574***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9575***************************************************
  9576     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9577         IF CR-LF-POLICY-IS-RESTORE
  9578             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9579             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9580         ELSE
  9581         IF CR-LF-POLICY-IS-REISSUE
  9582             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9583             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9584         ELSE
  9585         IF CR-LF-IS-REIN-ONLY
  9586             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9587             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9588         ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 186
* ECS010.cbl
  9589         IF CR-LF-IS-DECLINED
  9590             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9591             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9592         ELSE
  9593         IF CR-LF-IS-VOID
  9594             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9595             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9596         ELSE
  9597         IF CR-LF-POLICY-IS-MONTHLY
  9598            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9599            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9600
  9601
  9602 0510-PROCESS-LIFE-ISSUE.
  9603
  9604     IF PB-INVALID-LIFE
  9605         GO TO 0520-PROCESS-A-H-ISSUE.
  9606
  9607     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9608     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9609     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9610
  9611     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9612     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9613     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9614     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9615     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9616     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9617
  9618     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9619     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9620     IF PB-I-LF-POLICY-FEE  NUMERIC
  9621         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9622     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9623     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9624
  9625     IF PB-I-LF-PREM-TAX NUMERIC
  9626        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9627     END-IF
  9628
  9629
  9630     IF PB-I-LF-REI-RATE NOT = ZEROS
  9631        IF DTE-CLIENT = 'DCC'
  9632           CONTINUE
  9633*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9634        ELSE
  9635           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9636           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9637                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9638        END-IF
  9639     END-IF
  9640
  9641     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9642         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9643         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9644         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9645         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9646         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 187
* ECS010.cbl
  9647             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9648                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9649
  9650     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9651     MOVE ' '                    TO  DC-OPTION-CODE.
  9652     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9653     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9654                                     WS-CR-LF-EXPIRE-DATE-N.
  9655
  9656     IF CR-ENTRY-STATUS = 'P'
  9657         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9658     ELSE
  9659         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9660
  9661     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9662     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9663     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9664     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9665     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9666
  9667     IF CR-LF-POLICY-IS-RESTORE
  9668         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9669     IF CR-LF-POLICY-IS-REISSUE
  9670         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9671     IF CR-LF-IS-REIN-ONLY
  9672         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9673
  9674     IF CR-LF-IS-DECLINED
  9675         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9676
  9677     IF CR-LF-IS-VOID
  9678         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9679     IF CR-LF-POLICY-IS-MONTHLY
  9680         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9681
  9682     ADD +1                      TO  W-LF-ISSUES.
  9683
  9684 0520-PROCESS-A-H-ISSUE.
  9685
  9686     IF PB-INVALID-AH
  9687         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9688
  9689     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9690     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9691     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9692
  9693     IF (NOT PB-I-JOINT-COVERAGE)
  9694        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9695        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9696        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9697     END-IF
  9698
  9699     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9700     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9701     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9702     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9703     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9704
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 188
* ECS010.cbl
  9705     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9706     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9707     IF PB-I-AH-POLICY-FEE  NUMERIC
  9708         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9709     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9710     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9711
  9712     IF PB-I-AH-PREM-TAX NUMERIC
  9713        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9714     END-IF
  9715
  9716     IF PB-I-AH-REI-RATE NOT = ZEROS
  9717        IF DTE-CLIENT = 'DCC'
  9718           CONTINUE
  9719        ELSE
  9720           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9721           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9722             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9723        END-IF
  9724     END-IF
  9725
  9726     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9727        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9728           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9729           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9730        END-IF
  9731        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9732     END-IF
  9733     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9734     MOVE ' '                    TO  DC-OPTION-CODE.
  9735     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9736     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9737                                     WS-CR-AH-EXPIRE-DATE-N.
  9738
  9739     IF CR-ENTRY-STATUS = 'P'
  9740         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9741     ELSE
  9742         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9743
  9744     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9745     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9746     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9747     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9748     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9749
  9750     IF CR-AH-POLICY-IS-RESTORE
  9751         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9752     IF CR-AH-POLICY-IS-REISSUE
  9753         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9754     IF CR-AH-IS-REIN-ONLY
  9755         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9756
  9757     IF CR-AH-IS-DECLINED
  9758         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9759
  9760     IF CR-AH-IS-VOID
  9761         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9762     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 189
* ECS010.cbl
  9763         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9764
  9765     ADD +1                      TO  W-AH-ISSUES.
  9766
  9767 0530-PROCESS-ISSUE-CONTINUED.
  9768
  9769     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9770     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9771     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9772     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9773
  9774     IF (DTE-CLIENT = 'DCC')
  9775        AND (CR-AHTYP NOT = '00' AND '  ')
  9776        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9777        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9778           PERFORM 0920-GET-BANK-FEES
  9779                                 THRU 0920-EXIT
  9780           PERFORM 0930-BUILD-CERT-TRLR
  9781                                 THRU 0930-EXIT
  9782           PERFORM 0395-GET-CERT-TRLRS
  9783                                 THRU 0395-EXIT
  9784     END-IF
  9785
  9786     IF DTE-CLIENT = 'DCC'
  9787        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9788           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9789        END-IF
  9790        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9791           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9792              (CR-LFPRM + CR-LFPRM-ALT) -
  9793              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9794        END-IF
  9795     END-IF
  9796
  9797     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9798        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9799        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9800     ELSE
  9801        IF DTE-CLIENT = 'DCC'
  9802           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9803              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9804              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9805           END-IF
  9806           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9807              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9808              (CR-AHPRM * CR-LCOM-AH (1))
  9809           END-IF
  9810        END-IF
  9811     END-IF
  9812
  9813     IF DTE-CLIENT = 'DCC'
  9814         IF PB-I-VIN > SPACES
  9815             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9816         END-IF
  9817     END-IF.
  9818
  9819     IF CR-ENTRY-STATUS = 'P'
  9820         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 190
* ECS010.cbl
  9821
  9822     IF CR-POLICY-IS-REISSUE  OR
  9823        CR-POLICY-IS-REIN-ONLY OR
  9824        CR-POLICY-IS-DECLINED OR
  9825        CR-POLICY-IS-VOID
  9826        OR CR-POLICY-IS-MONTHLY
  9827         GO TO 0590-END-ISSUE-PROCESSING.
  9828
  9829     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9830     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9831        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9832     END-IF
  9833     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9834
  9835     IF NOT PB-INVALID-LIFE
  9836         COMPUTE H-LFCM ROUNDED =
  9837                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9838         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9839         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9840
  9841     IF NOT PB-INVALID-AH
  9842        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9843           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9844              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9845              + CR-ADDL-CLP)
  9846           ELSE
  9847              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9848              - CR-ADDL-CLP
  9849           END-IF
  9850        ELSE
  9851           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9852        END-IF
  9853        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9854        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9855     END-IF
  9856
  9857     ADD +1 TO BC-G-ISS.
  9858     ADD +1 TO BC-COMM.
  9859     ADD CR-LFPRM TO BC-NET-WRIT.
  9860     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9861        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9862     END-IF
  9863     ADD CR-AHPRM TO BC-NET-WRIT.
  9864
  9865     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9866        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9867        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9868     ELSE
  9869        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9870        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9871           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9872        END-IF
  9873     END-IF
  9874
  9875     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9876         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9877     ELSE
  9878         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 191
* ECS010.cbl
  9879
  9880 0590-END-ISSUE-PROCESSING.
  9881
  9882     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9883
  9884     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9885
  9886     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9887        NOT CR-POLICY-IS-DECLINED  AND
  9888        NOT CR-POLICY-IS-VOID
  9889         MOVE 'Y' TO BILLED-SWITCH
  9890         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9891         IF DTE-CLIENT = 'DCC'
  9892            move detail-extract  to new-detail-extract
  9893            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9894               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9895                  cr-addl-clp
  9896            end-if
  9897            write new-detail-extract
  9898         end-if
  9899
  9900     IF NOT CR-POLICY-IS-REISSUE  AND
  9901        NOT CR-POLICY-IS-DECLINED  AND
  9902        NOT CR-POLICY-IS-VOID
  9903        AND NOT CR-POLICY-IS-MONTHLY
  9904         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9905
  9906     MOVE '*'                   TO TRANSACTION-FLAG.
  9907     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 192
* ECS010.cbl
  9909******************************************************************
  9910***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9911******************************************************************
  9912
  9913 0600-PROCESS-CANCELLATIONS.
  9914
  9915*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9916     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9917
  9918     IF AM-RECALC-COMM = ('Y' OR '1')
  9919        PERFORM 1600-RECALC-COMM-EXTR
  9920                                 THRU 1899-RECALC-COMM-EXTR-X
  9921        MOVE ' '                 TO RECALC-TYPE
  9922     END-IF
  9923
  9924     MOVE CR-LFRFND               TO LIFE-REFUND.
  9925     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9926     MOVE CR-AHRFND               TO A-H-REFUND.
  9927     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9928     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9929
  9930     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9931     IF CR-LFRFND NOT = ZEROS
  9932        IF CR-LFRFND-CALC = ZEROS
  9933           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9934                                    LIFE-REFUND-CALC
  9935        ELSE
  9936           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9937        END-IF
  9938     END-IF
  9939
  9940     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9941
  9942     IF CR-AHRFND-CALC = ZEROS
  9943        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9944                                    A-H-REFUND-CALC
  9945     ELSE
  9946        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9947     END-IF
  9948
  9949     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9950        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9951     ELSE
  9952        MOVE SPACES              TO CR-POST-CARD-IND
  9953     END-IF
  9954
  9955*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9956*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9957*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9958*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9959
  9960     IF PB-C-NH-INT-ON-REFS NUMERIC
  9961        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9962        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9963     END-IF
  9964     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9965
  9966     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 193
* ECS010.cbl
  9967        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9968
  9969     IF PB-CI-MUNI-TAX NOT NUMERIC
  9970        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9971
  9972     IF CR-CANCEL-STATE-TAX NUMERIC
  9973         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9974       ELSE
  9975         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9976
  9977     IF CR-CANCEL-MUNI-TAX NUMERIC
  9978         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9979       ELSE
  9980         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9981
  9982     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9983                                    MONTHS-DIFF-AH.
  9984
  9985     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9986
  9987 0630-PROCESS-LIFE-CANCEL.
  9988
  9989     IF CR-LFTYP = ZERO  OR
  9990        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9991         MOVE ZEROS               TO H-LFCM
  9992         GO TO 0650-PROCESS-A-H-CANCEL.
  9993
  9994     IF CR-LFRFND = +0
  9995        AND CR-DTHAMT > ZEROS
  9996        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
  9997        MOVE ZEROS               TO H-LFCM
  9998        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
  9999        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
 10000        GO TO 0650-PROCESS-A-H-CANCEL
 10001     END-IF
 10002
 10003     IF DTE-CLIENT = 'DCC'
 10004        IF PB-C-LF-RFND-CLP NUMERIC
 10005           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
 10006        END-IF
 10007     END-IF
 10008
 10009     IF PB-C-LF-PREM-TAX NUMERIC
 10010        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
 10011     END-IF
 10012     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
 10013     MOVE ' '                     TO  DC-OPTION-CODE.
 10014     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10015     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
 10016                                      WS-CR-LF-CANC-DT-N.
 10017
 10018
 10019     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10020     MOVE ' '                    TO DC-OPTION-CODE
 10021     PERFORM 8000-DATE-CONVERT-ROUTINE
 10022                                 THRU 8099-DATE-CONVERT-X
 10023     IF CR-LF-CNC-ENT-DT NOT NUMERIC
 10024        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 194
* ECS010.cbl
 10025     END-IF
 10026     IF NO-CONVERSION-ERROR
 10027        IF CR-LF-CNC-ENT-DT = ZEROS
 10028           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
 10029        END-IF
 10030     END-IF
 10031
 10032     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10033     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
 10034     MOVE '1'                     TO  DC-OPTION-CODE.
 10035     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10036     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10037                                      DC-ODD-DAYS-OVER
 10038                                      DC-ELAPSED-DAYS.
 10039     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10040     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 10041
 10042     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 10043         ADD  +1                  TO  MONTHS-DIFF-LF.
 10044
 10045     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10046
 10047     MOVE  ZEROS                  TO  SUB.
 10048
 10049 0635-LIFE-CHARGEBACK-LOOP.
 10050
 10051     ADD    +1                    TO  SUB.
 10052
 10053     IF  SUB  GREATER THAN  +10
 10054         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10055
 10056*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10057*** WE FULLY EARN THE FEE
 10058     IF CR-CANCEL-REASON = 'R'
 10059        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10060           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10061           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10062           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10063        END-IF
 10064     END-IF
 10065
 10066     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10067         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10068         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10069
 10070     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10071         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10072
 10073     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10074         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10075
 10076     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10077
 10078
 10079 0640-CONTINUE-LIFE-CANCEL.
 10080
 10081     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10082        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 195
* ECS010.cbl
 10083
 10084     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10085
 10086     IF DTE-CLIENT = 'GIC'
 10087         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10088             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10089                                     LIFE-REFUND-CALC.
 10090
 10091*    IF DTE-CLIENT = 'TMS'
 10092     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10093
 10094     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10095         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10096     ELSE
 10097         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10098             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10099             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10100             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10101             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10102                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10103         ELSE
 10104             IF CR-LF-CURRENT-STATUS = '6'
 10105                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10106                 MOVE PB-C-LF-COMM-CHARGEBACK
 10107                                       TO CR-LF-COMM-CHARGEBACK
 10108                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10109                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10110
 10111*************************************************
 10112***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10113***  WAS CONVERTED TO 1056 BYTES.             ***
 10114*************************************************
 10115     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10116
 10117     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10118     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10119     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10120
 10121     COMPUTE H-LFCM ROUNDED =
 10122                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10123     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10124
 10125     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10126     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10127     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10128     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10129
 10130     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10131     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10132
 10133 0650-PROCESS-A-H-CANCEL.
 10134
 10135     IF CR-AHTYP = ZERO  OR
 10136        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10137         MOVE ZEROS               TO H-AHCM
 10138         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10139
 10140*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 196
* ECS010.cbl
 10141*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10142*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10143*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10144
 10145     IF DTE-CLIENT = 'DCC'
 10146        IF PB-C-AH-RFND-CLP NUMERIC
 10147           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10148        END-IF
 10149     END-IF
 10150
 10151     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10152     MOVE ' '                     TO  DC-OPTION-CODE.
 10153     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10154     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10155                                      WS-CR-AH-CANC-DT-N.
 10156
 10157     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10158     MOVE ' '                    TO DC-OPTION-CODE
 10159     PERFORM 8000-DATE-CONVERT-ROUTINE
 10160                                 THRU 8099-DATE-CONVERT-X
 10161     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10162        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10163     END-IF
 10164     IF NO-CONVERSION-ERROR
 10165        IF CR-AH-CNC-ENT-DT = ZEROS
 10166           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10167        END-IF
 10168     END-IF
 10169
 10170     IF PB-C-AH-PREM-TAX NUMERIC
 10171        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10172     END-IF
 10173     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10174     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10175     MOVE '1'                     TO  DC-OPTION-CODE.
 10176     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10177     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10178                                      DC-ODD-DAYS-OVER
 10179                                      DC-ELAPSED-DAYS.
 10180     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10181     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10182
 10183     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10184          ADD  +1                 TO  MONTHS-DIFF-AH.
 10185
 10186     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10187                                      WS-DCC-DDF-CB-LEVELS
 10188     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10189        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10190     END-IF
 10191*    IF DTE-CLIENT = 'DCC'
 10192*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10193*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10194*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10195*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10196*             OR (SUB > +10)
 10197*          END-PERFORM
 10198*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 197
* ECS010.cbl
 10199*             MOVE CR-BANK-NOCHRGB-MONTHS
 10200*                                TO AM-COMM-CHARGEBACK (SUB)
 10201*          END-IF
 10202*       END-IF
 10203*    END-IF
 10204
 10205
 10206     MOVE 'Y'                     TO WS-FIRST-K
 10207     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10208     MOVE  ZEROS                  TO  SUB.
 10209
 10210 0653-A-H-CHARGEBACK-LOOP.
 10211
 10212     ADD    +1                    TO  SUB.
 10213
 10214     IF  SUB  GREATER THAN  +10
 10215         GO TO  0655-CONTINUE-A-H-CANCEL.
 10216
 10217     IF CR-CANCEL-REASON = 'R'
 10218        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10219           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10220              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10221              GO TO  0653-A-H-CHARGEBACK-LOOP
 10222           END-IF
 10223           IF AM-COM-TYP (SUB) = 'J'
 10224              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10225              GO TO  0653-A-H-CHARGEBACK-LOOP
 10226           END-IF
 10227        END-IF
 10228     END-IF
 10229
 10230     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10231         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10232         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10233
 10234     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10235         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10236
 10237     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10238         OR ((DTE-CLIENT = 'DCC')
 10239             AND (CR-AHRFND = ZEROS))
 10240         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10241
 10242     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10243
 10244
 10245 0655-CONTINUE-A-H-CANCEL.
 10246
 10247     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10248        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10249
 10250     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10251
 10252     IF DTE-CLIENT = 'GIC'
 10253         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10254             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10255                                     A-H-REFUND-CALC.
 10256
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 198
* ECS010.cbl
 10257*    IF DTE-CLIENT = 'TMS'
 10258     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10259*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10260
 10261
 10262     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10263         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10264     ELSE
 10265         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10266             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10267             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10268             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10269             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10270                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10271         ELSE
 10272             IF CR-AH-CURRENT-STATUS = '7'
 10273                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10274                 MOVE PB-C-AH-COMM-CHARGEBACK
 10275                                       TO CR-AH-COMM-CHARGEBACK
 10276                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10277                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10278
 10279*************************************************
 10280***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10281***  WAS CONVERTED TO 1056 BYTES.             ***
 10282*************************************************
 10283     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10284
 10285     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10286     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10287     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10288
 10289     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10290        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10291        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10292           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10293           MOVE CNC-FACT TO UECLP-CLP-FACT
 10294        END-IF
 10295        IF CR-CANCEL-REASON = 'R'
 10296           MOVE +1               TO CNC-FACT
 10297        END-IF
 10298        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10299           (CR-AHPRM - (CR-LFPRM-ALT
 10300           + CR-ADDL-CLP)) * -1
 10301     ELSE
 10302        COMPUTE H-AHCM ROUNDED =
 10303          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10304     END-IF
 10305
 10306     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10307
 10308     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10309     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10310     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10311     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10312
 10313     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10314     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 199
* ECS010.cbl
 10315
 10316 0660-PROCESS-CANCEL-CONTINUE.
 10317
 10318     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10319
 10320     IF CR-POLICY-IS-REIN-ONLY
 10321        GO TO 0660-CONT.
 10322
 10323     MOVE 'Y'                    TO BILLED-SWITCH.
 10324     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10325
 10326     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10327     if dte-client = 'DCC'
 10328        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10329     end-if
 10330
 10331     IF CR-POLICY-IS-MONTHLY
 10332        GO TO 0660-CONT
 10333     END-IF
 10334
 10335     ADD +1                      TO BC-G-CNC.
 10336     ADD +1                      TO BC-COMM.
 10337     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10338     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10339     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10340     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10341     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10342     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10343
 10344     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10345         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10346     ELSE
 10347         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10348
 10349     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10350         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10351     ELSE
 10352         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10353
 10354
 10355 0660-CONT.
 10356
 10357     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10358     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10359
 10360     IF CR-LFRFND NEGATIVE
 10361       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10362           MOVE '*'                 TO REIN-VOID-LF-SW.
 10363     IF CR-AHRFND NEGATIVE
 10364       IF CR-AHRFND + A-H-REFUND = ZEROS
 10365           MOVE '*'                 TO REIN-VOID-AH-SW.
 10366
 10367     IF CR-LFRFND NOT = ZEROS
 10368       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10369           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10370     IF CR-AHRFND NOT = ZEROS
 10371       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10372           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 200
* ECS010.cbl
 10373
 10374     IF CR-DT = CR-LF-CANC-DT
 10375       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10376     IF CR-DT = CR-AH-CANC-DT
 10377       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10378
 10379     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10380
 10381     MOVE SPACES                    TO REIN-VOID-LF-SW
 10382                                       REIN-VOID-AH-SW
 10383                                       REIN-ADDL-LF-SW
 10384                                       REIN-ADDL-AH-SW.
 10385
 10386     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10387     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10388
 10389     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10390     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10391
 10392     IF (CR-LFTYP NOT = ZERO  AND
 10393        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10394        (CR-AHTYP NOT = ZERO  AND
 10395        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10396         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10397         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10398
 10399 0670-LIFE-CANCEL-VOID.
 10400
 10401     IF CR-LFTYP NOT = ZERO  AND
 10402        CR-LFRFND = ZERO  AND
 10403        PB-C-LF-CANCEL-AMT NEGATIVE
 10404         NEXT SENTENCE
 10405     ELSE
 10406         GO TO 0680-A-H-CANCEL-VOID.
 10407
 10408     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10409                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10410                                          CR-LF-CANC-DT
 10411                                          WS-CR-LF-CANC-DT-N
 10412                                          CR-LFRFND-CALC.
 10413
 10414     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10415
 10416     IF CR-LF-CANCEL-APPLIED
 10417         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10418         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10419     ELSE
 10420         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10421         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10422
 10423     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10424
 10425     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10426     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10427
 10428     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10429
 10430 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 201
* ECS010.cbl
 10431
 10432     IF CR-AHTYP NOT = ZERO  AND
 10433        CR-AHRFND = ZERO  AND
 10434        PB-C-AH-CANCEL-AMT NEGATIVE
 10435         NEXT SENTENCE
 10436     ELSE
 10437         GO TO 0690-END-CANCEL-PROCESSING.
 10438
 10439     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10440                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10441                                        CR-AH-CANC-DT
 10442                                        WS-CR-AH-CANC-DT-N
 10443                                        CR-AHRFND-CALC.
 10444
 10445     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10446
 10447     IF CR-AH-CANCEL-APPLIED
 10448         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10449         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10450     ELSE
 10451         MOVE CR-AH-STATUS-AT-CANCEL
 10452                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10453         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10454
 10455     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10456
 10457     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10458     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10459
 10460     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10461
 10462 0690-END-CANCEL-PROCESSING.
 10463
 10464     IF CR-LF-CANC-DT = ZEROS  AND
 10465        CR-AH-CANC-DT = ZEROS
 10466         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10467     END-IF
 10468
 10469     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10470         NEXT SENTENCE
 10471     ELSE
 10472         MOVE 'X'               TO REIN-RT-SW
 10473         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10474         MOVE ' '               TO REIN-RT-SW.
 10475
 10476     MOVE '*'                   TO TRANSACTION-FLAG.
 10477     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10478
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 202
* ECS010.cbl
 10480******************************************************************
 10481***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10482******************************************************************
 10483
 10484 0700-PROCESS-CLAIMS.
 10485
 10486     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10487        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10488         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10489             PENDING-MATCH-CONTROL
 10490         MOVE 0301 TO WS-ABEND-CODE
 10491         DISPLAY '******************************'
 10492         DISPLAY '***** ERROR LOCATION 011 *****'
 10493         DISPLAY '******************************'
 10494         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10495         GO TO ABEND-PGM.
 10496
 10497     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10498
 10499     ADD +1                       TO  W-LF-CLAIMS.
 10500
 10501     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10502     MOVE ' '                     TO  DC-OPTION-CODE.
 10503     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10504     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10505
 10506     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10507     MOVE ' '                     TO  DC-OPTION-CODE.
 10508     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10509     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10510
 10511     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10512     MOVE ' '                     TO  DC-OPTION-CODE.
 10513     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10514     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10515
 10516     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10517     MOVE ' '                     TO  DC-OPTION-CODE.
 10518     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10519     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10520
 10521     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10522
 10523**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10524****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10525****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10526****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10527****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10528****     ELSE
 10529****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10530
 10531     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10532         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10533
 10534******************************************************************
 10535***           P R O C E S S   D E A T H   C L A I M            ***
 10536******************************************************************
 10537
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 203
* ECS010.cbl
 10538     IF REIN-IS-RISK-PREMIUM
 10539       IF CR-DTH-DT = ZEROS
 10540           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10541           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10542           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10543
 10544     MOVE INCURRED-DATE            TO CR-DTH-DT
 10545                                      WS-CR-DTH-DT-N.
 10546
 10547     IF PC-CHARGEBLE-EXPENSE  OR
 10548        PC-NON-CHARGEBLE-EXPENSE
 10549         IF CR-LFTYP = '00'
 10550             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10551             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10552                     8399-LIFE-LOOKUP-X.
 10553
 10554     IF PC-CHARGEBLE-EXPENSE  OR
 10555        PC-NON-CHARGEBLE-EXPENSE
 10556         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10557         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10558         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10559         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10560         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10561         GO TO 0780-END-CLAIMS-PROCESSING.
 10562
 10563     ADD +1                       TO  CR-NUM-DTH-CLM.
 10564     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10565     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10566                                      WS-CR-DTH-PAY-DT-N.
 10567
 10568     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10569     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10570     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10571     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10572     IF CR-DTH-PAY-CD NOT = 'F'
 10573         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10574     INSPECT CR-DTH-PAY-CD
 10575         CONVERTING '12349' TO 'PFSXV'.
 10576     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10577
 10578     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10579         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10580       AND
 10581       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10582       OR
 10583        DTE-CLIENT = 'ACC' OR 'FDL')
 10584        NEXT SENTENCE
 10585     ELSE
 10586     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10587         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10588             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10589             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10590             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10591                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10592
 10593     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10594     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10595     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 204
* ECS010.cbl
 10596     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10597         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10598     ELSE
 10599         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10600     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10601
 10602     IF NOT CR-POLICY-IS-REIN-ONLY
 10603         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10604
 10605 0720-CANCEL-AH-COVERAGE.
 10606
 10607     IF CR-AHTYP = ZEROS  OR
 10608        NOT CR-AH-POLICY-IS-ACTIVE
 10609         GO TO 0740-DEATH-CLAIM-VOID.
 10610
 10611     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10612     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10613     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10614                                           WS-CR-AH-CANC-DT-N.
 10615     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10616                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10617
 10618     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10619     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10620     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10621     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10622     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10623     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10624     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10625     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10626
 10627 0740-DEATH-CLAIM-VOID.
 10628
 10629     IF CR-DTHAMT = ZERO  AND
 10630        PC-CLAIM-PAYMENT NEGATIVE
 10631         NEXT SENTENCE
 10632     ELSE
 10633         GO TO 0780-END-CLAIMS-PROCESSING.
 10634
 10635     MOVE '*'                           TO DEATH-VOID-FLAG.
 10636
 10637     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10638                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10639                                           CR-NUM-DTH-CLM
 10640                                           CR-DTH-RPT-DT
 10641                                           CR-DTH-PAY-DT
 10642                                           WS-CR-DTH-PAY-DT-N
 10643*                                          CR-DTHAMT-YTD
 10644*                                          CR-DTHAMT-LAST
 10645                                           CR-DTH-AGE.
 10646     MOVE ' '                           TO CR-DTH-PAY-CD.
 10647
 10648     IF CR-LF-DEATH-CLAIM-APPLIED
 10649         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10650         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10651     ELSE
 10652         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10653         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 205
* ECS010.cbl
 10654
 10655     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10656     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10657
 10658     IF CR-AH-DEATH-CLAIM-APPLIED
 10659         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10660         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10661         MOVE ZEROS                     TO CR-AH-CANC-DT
 10662                                           WS-CR-AH-CANC-DT-N
 10663                                           CR-AH-CANCEL-EXIT-DATE
 10664                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10665         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10666         MOVE CR-AH-TERM                TO TRD-AHTRM
 10667         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10668         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10669
 10670     GO TO 0780-END-CLAIMS-PROCESSING.
 10671
 10672******************************************************************
 10673***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10674******************************************************************
 10675
 10676 0750-PROCESS-DISABILITY-CLAIM.
 10677
 10678     ADD +1                       TO W-AH-CLAIMS.
 10679
 10680     MOVE INCURRED-DATE           TO CR-DIS-DT
 10681                                     WS-CR-DIS-DT-N.
 10682
 10683     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10684
 10685     IF REIN-AH-CLM-MONTHS = +1
 10686         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10687     ELSE
 10688       IF REIN-AH-CLM-MONTHS = +2
 10689           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10690       ELSE
 10691         IF REIN-AH-CLM-MONTHS = +3
 10692             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10693         ELSE
 10694           IF REIN-AH-CLM-MONTHS = +4
 10695               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10696           ELSE
 10697               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10698
 10699     IF PC-CHARGEBLE-EXPENSE  OR
 10700        PC-NON-CHARGEBLE-EXPENSE
 10701         IF CR-AHTYP = '00'
 10702             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10703             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10704                     8499-A-H-LOOKUP-X.
 10705
 10706     IF PC-CHARGEBLE-EXPENSE  OR
 10707        PC-NON-CHARGEBLE-EXPENSE
 10708         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10709         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10710         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10711         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 206
* ECS010.cbl
 10712         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10713         GO TO 0780-END-CLAIMS-PROCESSING.
 10714
 10715     ADD +1                       TO CR-NUM-DIS-CLM.
 10716
 10717     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10718     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10719                                      WS-CR-DIS-PAY-DT-N.
 10720     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10721                                      WS-CR-DIS-PTO-DT-N.
 10722
 10723     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10724     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10725     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10726
 10727     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10728     IF CR-DIS-PAY-CD NOT = 'S'
 10729         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10730     INSPECT CR-DIS-PAY-CD
 10731         CONVERTING '12349' TO 'PFSXV'.
 10732     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10733
 10734     IF PC-LUMP-SUM-PAYMENT
 10735         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10736           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10737           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10738           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10739                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10740
 10741     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10742     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10743     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10744     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10745     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10746
 10747     IF NOT CR-POLICY-IS-REIN-ONLY
 10748         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10749
 10750     IF NOT PC-LUMP-SUM-PAYMENT
 10751         GO TO 0780-END-CLAIMS-PROCESSING.
 10752
 10753 0770-CANCEL-LF-COVERAGE.
 10754
 10755     IF CR-LFTYP = ZEROS  OR
 10756        NOT CR-LF-POLICY-IS-ACTIVE
 10757         GO TO 0780-END-CLAIMS-PROCESSING.
 10758
 10759     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10760     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10761     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10762                                           WS-CR-LF-CANC-DT-N.
 10763     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10764                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10765
 10766     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10767     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10768     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10769     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 207
* ECS010.cbl
 10770     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10771     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10772     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10773     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10774
 10775 0780-END-CLAIMS-PROCESSING.
 10776
 10777     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10778         MOVE DTO-MO               TO TRD-LFACTMO
 10779         MOVE DTO-DA               TO TRD-LFACTDA
 10780         MOVE DTO-YR               TO TRD-LFACTYR
 10781         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10782     ELSE
 10783         MOVE PAY-MO               TO TRD-AHACTMO
 10784         MOVE PAY-DA               TO TRD-AHACTDA
 10785         MOVE PAY-YR               TO TRD-AHACTYR
 10786         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10787
 10788     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10789
 10790     IF NOT CR-POLICY-IS-REIN-ONLY
 10791         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10792         ADD +1                    TO BC-G-CLM.
 10793
 10794     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10795
 10796     IF DEATH-CLAIM-VOIDED
 10797         MOVE ZEROS                TO CR-DTH-DT
 10798                                      WS-CR-DTH-DT-N.
 10799     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10800
 10801     MOVE '*'                      TO TRANSACTION-FLAG.
 10802     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10803
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 208
* ECS010.cbl
 10805 0790-TABLE-DISAB-PERIODS.
 10806
 10807     MOVE +1                       TO SUB14.
 10808     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10809
 10810     MOVE +1                       TO SUB14.
 10811
 10812**************************************************************
 10813**                                                          **
 10814**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10815**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10816**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10817**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10818**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10819**                                                          **
 10820**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10821**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10822**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10823**                                                          **
 10824**************************************************************
 10825
 10826 0791-TABLE-AH-AMOUNT.
 10827
 10828     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10829         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10830
 10831     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10832         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10833                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10834         IF REIN-IS-RISK-PREMIUM
 10835             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10836             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10837             IF SUB14 = +1
 10838               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10839             ELSE
 10840             IF SUB14 = +2
 10841               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10842             ELSE
 10843             IF SUB14 = +3
 10844               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10845             ELSE
 10846             IF SUB14 = +4
 10847               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10848             ELSE
 10849               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10850
 10851
 10852     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10853         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10854         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10855                                        +  CR-INCUR-DISEXP (SUB14)
 10856         IF PC-CHARGEBLE-EXPENSE  OR
 10857            PC-NON-CHARGEBLE-EXPENSE
 10858             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10859             GO TO 0791-TABLE-AH-EXIT
 10860         ELSE
 10861             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10862             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 209
* ECS010.cbl
 10863
 10864     ADD +1                       TO SUB14.
 10865
 10866     GO TO 0791-TABLE-AH-AMOUNT.
 10867
 10868 0791-TABLE-AH-EXIT.
 10869     EXIT.
 10870
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 210
* ECS010.cbl
 10872**************************************************************
 10873**                                                          **
 10874** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10875** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10876**                                                          **
 10877** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10878** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10879** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10880** OCCURRENCE.                                              **
 10881**************************************************************
 10882 0792-MOVE-TABLE.
 10883
 10884     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10885                                  WS-CR-DIS-INCUR-DT-N (1).
 10886     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10887     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10888
 10889     MOVE +2                   TO SUB14.
 10890     MOVE +3                   TO SUB15.
 10891     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10892
 10893     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10894
 10895     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10896                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10897
 10898 0792-MOVE-TABLE-EXIT.
 10899     EXIT.
 10900
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 211
* ECS010.cbl
 10902**************************************************************
 10903**                                                          **
 10904**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10905** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10906** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10907** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10908** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10909**************************************************************
 10910
 10911 0794-REVIEW-TABLE.
 10912
 10913     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10914         GO TO 0794-REVIEW-TABLE-EXIT.
 10915
 10916     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10917         GO TO 0794-REVIEW-TABLE-EXIT.
 10918
 10919     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10920        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10921         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10922         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10923                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10924         MOVE SUB14            TO SUB15
 10925         ADD +1                TO SUB15
 10926         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10927         MOVE +1               TO SUB14
 10928         GO TO 0794-REVIEW-TABLE.
 10929
 10930     ADD +1                    TO SUB14.
 10931
 10932     GO TO 0794-REVIEW-TABLE.
 10933
 10934 0794-REVIEW-TABLE-EXIT.
 10935     EXIT.
 10936
 10937 0794A-BUMP-TBL.
 10938
 10939     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10940         GO TO 0794A-BUMP-TBL-EXIT.
 10941
 10942     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10943                             CR-DISAB-DETAIL-DATA (SUB14).
 10944     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 10945                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 10946
 10947     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10948                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10949                                  CR-INCUR-DISAMT (SUB15)
 10950                                  CR-INCUR-DISEXP (SUB15).
 10951
 10952     ADD +1                    TO SUB14
 10953                                  SUB15.
 10954     GO TO 0794A-BUMP-TBL.
 10955
 10956 0794A-BUMP-TBL-EXIT.
 10957     EXIT.
 10958
 10959 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 212
* ECS010.cbl
 10960
 10961     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 10962     MOVE 'L'                        TO DC-OPTION-CODE.
 10963     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10964     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10965     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10966     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10967     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10968     MOVE CR-APR                     TO CP-LOAN-APR.
 10969     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10970     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10971     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10972     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10973
 10974     MOVE '3'                        TO CP-PROCESS-TYPE.
 10975     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10976     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10977
 10978     IF CR-LFTYP = ZERO
 10979         GO TO 0795-EXIT
 10980     END-IF
 10981
 10982     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10983         GO TO 0795-EXIT
 10984     END-IF
 10985     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10986     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10987     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10988     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10989                                        CP-RATING-BENEFIT-AMT.
 10990     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10991     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10992     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10993     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10994     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10995     MOVE CR-STATE                   TO CP-STATE.
 10996     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10997
 10998     IF CP-STATE-STD-ABBRV = 'OR'
 10999         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 11000
 11001     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 11002
 11003     IF CP-ERROR-RATE-NOT-FOUND  OR
 11004        CP-ERROR-RATE-IS-ZERO
 11005         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 11006                                     TO WS-ABEND-MESSAGE
 11007         MOVE 0302                   TO WS-ABEND-CODE
 11008         DISPLAY '******************************'
 11009         DISPLAY '***** ERROR LOCATION 018 *****'
 11010         DISPLAY '******************************'
 11011         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11012         GO TO ABEND-PGM.
 11013
 11014     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 11015
 11016*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 11017*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 213
* ECS010.cbl
 11018
 11019     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 11020                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 11021
 11022     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 11023
 11024 0795-exit.
 11025     exit.
 11026
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 214
* ECS010.cbl
 11028******************************************************************
 11029***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 11030******************************************************************
 11031
 11032 0800-PROCESS-RESERVES.
 11033
 11034     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 11035       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 11036           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 11037
 11038     if (dte-client = 'AHL')
 11039        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 11040        and (cr-ahtyp (1:1) = 'M')
 11041        and ((pc-future-reserve-amt > zeros)
 11042            or (pc-ptc-reserve-amt > zeros))
 11043        compute pc-ibnr-reserve-amt =
 11044           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 11045        display ' using 205 of ptc and future ' cr-cert-no
 11046     end-if
 11047
 11048     if (dte-client = 'AHL')
 11049        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11050        and (cr-lftyp (1:1) = 'M')
 11051        and (pc-ptc-reserve-amt > zeros)
 11052        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11053        display ' using 217 of ptc ' cr-cert-no
 11054     end-if
 11055
 11056     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11057
 11058     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11059     MOVE ' '                     TO  DC-OPTION-CODE.
 11060     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11061     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11062
 11063     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11064     MOVE ' '                     TO  DC-OPTION-CODE.
 11065     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11066     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11067
 11068     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11069     MOVE ' '                     TO  DC-OPTION-CODE.
 11070     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11071     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11072
 11073     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11074
 11075     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11076         ADD +1                     TO W-LF-RESERVES
 11077         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11078         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11079         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11080         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11081         MOVE INCURRED-DATE         TO CR-DTH-DT
 11082                                       WS-CR-DTH-DT-N
 11083         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11084
 11085     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 215
* ECS010.cbl
 11086         ADD +1                     TO W-AH-RESERVES
 11087         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11088         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11089         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11090         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11091         MOVE INCURRED-DATE         TO CR-DIS-DT
 11092                                       WS-CR-DIS-DT-N
 11093         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11094
 11095     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11096     MOVE 'IBNR'                    TO TRD-IBNRX.
 11097     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11098     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11099     COMPUTE TRD-FUTRSV EQUAL
 11100            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11101     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11102     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11103
 11104 0820-END-RESERVE-PROCESSING.
 11105
 11106     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11107
 11108     IF NOT CR-POLICY-IS-REIN-ONLY
 11109         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11110                                            2499-BLD-RESERVE-X
 11111         ADD +1 TO BC-G-CRS.
 11112
 11113     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11114
 11115     MOVE '*'                    TO TRANSACTION-FLAG.
 11116     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11117
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 216
* ECS010.cbl
 11119******************************************************************
 11120***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11121******************************************************************
 11122
 11123 0900-PROCESS-CERT-CHANGES.
 11124
 11125     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11126
 11127     IF CC-AGE NOT NUMERIC  OR
 11128        CC-AGE = CR-AGE
 11129         MOVE ZEROS TO CC-AGE.
 11130
 11131     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11132        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11133         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11134
 11135     IF CC-INSURED-SEX NOT = 'M'  AND
 11136        CC-INSURED-SEX NOT = 'F'
 11137         MOVE SPACES TO CC-INSURED-SEX.
 11138
 11139     IF CC-LOAN-APR NOT NUMERIC  OR
 11140        CC-LOAN-APR = CR-APR
 11141         MOVE ZEROS TO CC-LOAN-APR.
 11142
 11143     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11144        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11145         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11146
 11147     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11148        CC-IND-GRP-TYPE NOT = '2'
 11149         MOVE SPACES TO CC-IND-GRP-TYPE.
 11150
 11151     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11152****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11153         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11154
 11155     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11156        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11157         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11158
 11159     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11160        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11161        CR-LFTYP = ZEROS
 11162         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11163
 11164     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11165        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11166        CR-AHTYP = ZEROS
 11167         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11168
 11169     IF CR-BILLED NOT NUMERIC
 11170         MOVE ZEROS TO CR-BILLED.
 11171
 11172     IF CR-LIVES NOT NUMERIC
 11173         MOVE ZEROS TO CR-LIVES.
 11174
 11175     IF CC-LIVES NOT NUMERIC  OR
 11176        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 217
* ECS010.cbl
 11177         MOVE ZEROS TO CC-LIVES.
 11178
 11179     IF CC-BILLED NOT NUMERIC  OR
 11180        CC-BILLED = CR-BILLED
 11181         MOVE ZEROS TO CC-BILLED.
 11182
 11183     IF CC-INSURED-LAST-NAME NOT = SPACES
 11184         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11185     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11186         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11187     IF CC-INSURED-INITIAL2 NOT = SPACES
 11188         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11189     IF CC-JT-LAST-NAME NOT = SPACES
 11190         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11191     IF CC-JT-FIRST-NAME NOT = SPACES
 11192         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11193     IF CC-JT-INITIAL NOT = SPACES
 11194         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11195
 11196     IF CC-AGE NOT = ZEROS
 11197         MOVE CC-AGE                 TO CR-AGE
 11198                                        DET-AGE
 11199     ELSE
 11200         MOVE ZEROS                  TO DET-AGE.
 11201
 11202     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11203         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11204                                        DET-JT-AGE
 11205     ELSE
 11206         MOVE ZEROS                  TO DET-JT-AGE.
 11207
 11208     IF CC-INSURED-SEX NOT = SPACES
 11209         MOVE CC-INSURED-SEX         TO CR-SEX
 11210                                        DET-SEX
 11211     ELSE
 11212         MOVE SPACE                  TO DET-SEX.
 11213
 11214     IF CC-MEMBER-NO NOT = SPACES
 11215         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11216                                        DET-PR-MEM
 11217     ELSE
 11218         MOVE SPACES                 TO DET-PR-MEM.
 11219
 11220     IF CC-SOC-SEC-NO NOT = SPACES
 11221         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11222                                        DET-PR-SS
 11223     ELSE
 11224         MOVE SPACES                 TO DET-PR-SS.
 11225
 11226     IF CC-LOAN-APR NOT = ZEROS
 11227         MOVE CC-LOAN-APR            TO CR-APR
 11228                                        DET-PR-APR
 11229     ELSE
 11230         MOVE ZEROS                  TO DET-PR-APR.
 11231
 11232     IF CC-AGE NOT = ZERO  OR
 11233        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11234        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 218
* ECS010.cbl
 11235        CC-MEMBER-NO NOT = SPACES  OR
 11236        CC-SOC-SEC-NO NOT = SPACES  OR
 11237        CC-LOAN-APR NOT = ZERO
 11238         MOVE DET-PR-UREC            TO TR-DTL2
 11239         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11240         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11241
 11242     IF CC-LF-ORIG-TERM NOT = ZEROS
 11243         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11244         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11245                                        DET-N-LF-TERM
 11246     ELSE
 11247         MOVE ZEROS                  TO DET-O-LF-TERM
 11248                                        DET-N-LF-TERM.
 11249
 11250     IF CC-AH-ORIG-TERM NOT = ZEROS
 11251         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11252         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11253                                        DET-N-AH-TERM
 11254     ELSE
 11255         MOVE ZEROS                  TO DET-O-AH-TERM
 11256                                        DET-N-AH-TERM.
 11257
 11258     IF CC-LIVES NOT = ZEROS
 11259         MOVE CR-LIVES               TO DET-O-LIVES
 11260         MOVE CC-LIVES               TO CR-LIVES
 11261                                        DET-N-LIVES
 11262     ELSE
 11263         MOVE ZEROS                  TO DET-O-LIVES
 11264                                        DET-N-LIVES.
 11265
 11266     IF CC-BILLED NOT  = ZEROES
 11267         MOVE CC-BILLED              TO CR-BILLED.
 11268
 11269     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11270        CC-AH-ORIG-TERM NOT = ZERO  OR
 11271        CC-LIVES NOT = ZERO
 11272         MOVE DET-PR-UREC-2          TO TR-DTL2
 11273         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11274         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11275
 11276     IF CC-IND-GRP-TYPE NOT = SPACES
 11277         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11278                                        DET-IND-GRP
 11279     ELSE
 11280         MOVE SPACE                  TO DET-IND-GRP.
 11281
 11282     IF CC-PAY-FREQUENCY NOT = ZEROS
 11283         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11284                                        DET-PMT-FREQ
 11285     ELSE
 11286         MOVE ZEROS                  TO DET-PMT-FREQ.
 11287
 11288     IF CC-POLICY-FORM-NO NOT = SPACES
 11289         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11290                                        DET-POL-FORM
 11291     ELSE
 11292         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 219
* ECS010.cbl
 11293
 11294     IF CC-LOAN-OFFICER NOT = SPACES
 11295         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11296                                        DET-LOAN-OFFICER
 11297     ELSE
 11298         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11299
 11300     IF CC-USER-FIELD NOT = SPACES
 11301         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11302                                        DET-USER-CODE
 11303     ELSE
 11304         MOVE SPACE                  TO DET-USER-CODE.
 11305
 11306     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11307        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11308        CC-POLICY-FORM-NO NOT = SPACES  OR
 11309        CC-LOAN-OFFICER NOT = SPACES  OR
 11310        CC-USER-FIELD NOT = SPACES
 11311         MOVE DET-PR-UREC-3          TO TR-DTL2
 11312         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11313         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11314
 11315**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11316****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11317****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11318****                                    DET-CLM-DEDUCT
 11319**** ELSE
 11320****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11321
 11322     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11323         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11324                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11325                                        DET-CAN-DEDUCT
 11326     ELSE
 11327         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11328
 11329**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11330     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11331         MOVE DET-PR-UREC-4          TO TR-DTL2
 11332         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11333         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11334
 11335     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11336         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11337
 11338     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11339         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11340
 11341     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11342         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11343
 11344     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11345         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11346
 11347     IF CC-LF-BENEFIT-CD NOT = SPACES
 11348         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11349                                     DET-LF-BEN-CD
 11350     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 220
* ECS010.cbl
 11351         MOVE SPACES             TO DET-LF-BEN-CD.
 11352
 11353     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11354         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11355                                     DET-LF-PREM
 11356     ELSE
 11357         MOVE ZEROS              TO DET-LF-PREM.
 11358
 11359     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11360         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11361                                     DET-LF-BEN
 11362     ELSE
 11363         MOVE ZEROS              TO DET-LF-BEN.
 11364
 11365     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11366        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11367        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11368         MOVE DET-PR-UREC-5          TO TR-DTL2
 11369         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11370         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11371
 11372     IF CC-AH-BENEFIT-CD NOT = SPACES
 11373         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11374                                     DET-AH-BEN-CD
 11375     ELSE
 11376         MOVE SPACES             TO DET-AH-BEN-CD.
 11377
 11378     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11379         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11380                                     DET-AH-PREM
 11381     ELSE
 11382         MOVE ZEROS              TO DET-AH-PREM.
 11383
 11384     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11385         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11386                                     DET-AH-BEN
 11387     ELSE
 11388         MOVE ZEROS              TO DET-AH-BEN.
 11389
 11390     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11391        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11392        CC-AH-BENEFIT-AMT NOT = ZEROS
 11393         MOVE DET-PR-UREC-6          TO TR-DTL2
 11394         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11395         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11396
 11397 0910-END-CHANGE-PROCESSING.
 11398
 11399     IF CR-LNAME = ALL '*'
 11400         MOVE SPACES                 TO CR-LNAME.
 11401     IF CR-FNAME = ALL '*'
 11402         MOVE SPACES                 TO CR-FNAME.
 11403     IF CR-INIT = '*'
 11404         MOVE SPACES                 TO CR-INIT.
 11405     IF CR-SOC-SEC = ALL '*'
 11406         MOVE SPACES                 TO CR-SOC-SEC.
 11407     IF CR-JT-LNAME = ALL '*'
 11408         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 221
* ECS010.cbl
 11409     IF CR-JT-FNAME = ALL '*'
 11410         MOVE SPACES                 TO CR-JT-FNAME.
 11411     IF CR-JT-INIT = '*'
 11412         MOVE SPACES                 TO CR-JT-INIT.
 11413     IF CR-POLICY-FORM-NO = ALL '*'
 11414         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11415     IF CR-MEMBER-NO = ALL '*'
 11416         MOVE SPACES                 TO CR-MEMBER-NO.
 11417     IF CR-LOAN-OFFICER = ALL '*'
 11418         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11419     IF CR-USER-CODE = ALL '*'
 11420         MOVE SPACES                 TO CR-USER-CODE.
 11421
 11422     ADD +1 TO BC-G-CTN.
 11423     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 222
* ECS010.cbl
 11425 0920-GET-BANK-FEES.
 11426
 11427     IF CR-CERT-NO = '0008771354 '
 11428        DISPLAY ' MADE IT TO 0920 '
 11429     END-IF
 11430
 11431     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11432     MOVE CR-CARRIER             TO AG-CARRIER
 11433     MOVE CR-GROUPING            TO AG-GROUPING
 11434     MOVE CR-BANK-NO             TO AG-BANK
 11435     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11436     MOVE 'B'                    TO AG-TYPE
 11437
 11438*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11439*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11440*                                THRU 0925-EXIT
 11441*       GO TO 0920-EXIT
 11442*    END-IF
 11443
 11444     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11445
 11446     IF CR-CERT-NO = '0008771354 '
 11447        DISPLAY ' MADE IT AFTER START '
 11448     END-IF
 11449
 11450     .
 11451 0920-READ-ERAGTC.
 11452
 11453     IF ERAGTC-FILE-STATUS = '00'
 11454        READ ERAGTC NEXT RECORD
 11455     IF CR-CERT-NO = '0008771354 '
 11456        DISPLAY ' MADE ONE READ '
 11457     END-IF
 11458
 11459        IF ERAGTC-FILE-STATUS = '00'
 11460           IF (CR-CARRIER         = AG-CARRIER)
 11461              AND (CR-GROUPING    = AG-GROUPING)
 11462              AND (CR-BANK-NO     = AG-BANK)
 11463              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11464                 GO TO 0920-READ-ERAGTC
 11465              ELSE
 11466                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11467                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11468                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11469                                 THRU 0925-EXIT
 11470                    MOVE AG-CONTROL-PRIMARY
 11471                                 TO WS-PREV-BANK-COMM-KEY
 11472                    GO TO 0920-EXIT
 11473                 END-IF
 11474              END-IF
 11475           END-IF
 11476        END-IF
 11477     END-IF
 11478
 11479     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11480*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11481
 11482     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 223
* ECS010.cbl
 11483        AND (PB-I-BANK-FEE NOT = ZEROS)
 11484        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11485        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11486        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11487        MOVE ' '                 TO WS-BNK-RECALC (1)
 11488        MOVE +2                  TO IB
 11489     END-IF
 11490
 11491     .
 11492 0920-EXIT.
 11493     EXIT.
 11494
 11495 0925-BUILD-WORK-BNK-COMM.
 11496
 11497     IF CR-CERT-NO = '0008771354 '
 11498        DISPLAY ' MADE IT TO 0925 '
 11499     END-IF
 11500
 11501     MOVE +1                     TO IA IB
 11502
 11503*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11504*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11505*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11506*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11507*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11508*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11509*       ADD +1                   TO IB
 11510*    END-IF
 11511*    .
 11512*0925-BUILD-CONTINUE.
 11513
 11514     IF CR-CERT-NO = '00087735841'
 11515        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11516        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11517        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11518     END-IF
 11519
 11520*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11521     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11522        (IA > +10)
 11523        OR (IB > +10)
 11524        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11525           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11526           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11527*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11528           IF AG-SPP-FEES (IA) NOT NUMERIC
 11529              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11530           END-IF
 11531           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11532           MOVE AG-RECALC-LV-INDIC (IA)
 11533                                 TO WS-BNK-RECALC (IB)
 11534        ELSE
 11535           MOVE SPACES           TO WS-BNK-AGT (IB)
 11536                                    WS-BNK-TYPE (IB)
 11537                                    WS-BNK-RECALC (IB)
 11538           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11539        END-IF
 11540        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 224
* ECS010.cbl
 11541     END-PERFORM
 11542
 11543     .
 11544 0925-EXIT.
 11545     EXIT.
 11546
 11547 0930-BUILD-CERT-TRLR.
 11548
 11549     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11550     MOVE 'CS'                   TO CS-RECORD-ID
 11551     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11552     MOVE CR-CARRIER             TO CS-CARRIER
 11553     MOVE CR-GROUPING            TO CS-GROUPING
 11554     MOVE CR-STATE               TO CS-STATE
 11555     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11556     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11557     MOVE CR-CERT-NO             TO CS-CERT-NO
 11558     MOVE 'A'                    TO CS-TRAILER-TYPE
 11559
 11560     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11561
 11562     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11563        WRITE CERTIFICATE-TRAILERS
 11564        IF ELCRTT-FILE-STATUS = '00'
 11565           CONTINUE
 11566        ELSE
 11567           IF ELCRTT-FILE-STATUS = '22'
 11568              READ ELCRTT
 11569              IF ELCRTT-FILE-STATUS = '00'
 11570                 MOVE WS-BANK-COMMISSIONS
 11571                                 TO CS-BANK-COMMISSION-AREA
 11572                 REWRITE CERTIFICATE-TRAILERS
 11573                 IF ELCRTT-FILE-STATUS NOT = '00'
 11574                    DISPLAY ' BAD REWRITE ELCRTT '
 11575                                 ELCRTT-FILE-STATUS
 11576                    PERFORM ABEND-PGM
 11577                 END-IF
 11578              ELSE
 11579                 DISPLAY ' BAD READ    ELCRTT '
 11580                                  ELCRTT-FILE-STATUS
 11581                 PERFORM ABEND-PGM
 11582              END-IF
 11583           ELSE
 11584              DISPLAY ' BAD WRITE ELCRTT '
 11585                                 ELCRTT-FILE-STATUS
 11586              PERFORM ABEND-PGM
 11587           END-IF
 11588        END-IF
 11589     END-IF
 11590
 11591     .
 11592 0930-EXIT.
 11593     EXIT.
 11594
 11595 0950-BUILD-CERT-C-TRLR.
 11596
 11597     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11598     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 225
* ECS010.cbl
 11599     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11600     MOVE CR-CARRIER             TO CS-CARRIER.
 11601     MOVE CR-GROUPING            TO CS-GROUPING.
 11602     MOVE CR-STATE               TO CS-STATE.
 11603     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11604     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11605     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11606     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11607
 11608     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11609
 11610     WRITE CERTIFICATE-TRAILERS.
 11611     IF ELCRTT-FILE-STATUS = '00'
 11612        CONTINUE
 11613     ELSE
 11614        IF ELCRTT-FILE-STATUS = '22'
 11615           READ ELCRTT
 11616           IF ELCRTT-FILE-STATUS = '00'
 11617              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11618              REWRITE CERTIFICATE-TRAILERS
 11619              IF ELCRTT-FILE-STATUS NOT = '00'
 11620                 DISPLAY ' BAD REWRITE ELCRTT '
 11621                              ELCRTT-FILE-STATUS
 11622                 PERFORM ABEND-PGM
 11623              END-IF
 11624           ELSE
 11625              DISPLAY ' BAD READ    ELCRTT '
 11626                               ELCRTT-FILE-STATUS
 11627              PERFORM ABEND-PGM
 11628           END-IF
 11629        ELSE
 11630           DISPLAY ' BAD WRITE ELCRTT '
 11631                              ELCRTT-FILE-STATUS
 11632           PERFORM ABEND-PGM
 11633        END-IF
 11634     END-IF.
 11635
 11636     .
 11637 0950-EXIT.
 11638     EXIT.
 11639
 11640
 11641******************************************************************
 11642***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11643******************************************************************
 11644
 11645 1000-SET-COMMISSION-STRUCTURE.
 11646
 11647     MOVE +1                     TO IA
 11648                                    IB.
 11649
 11650 1100-GET-COMMISSION-LEVEL.
 11651
 11652     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11653
 11654     IF WK-AGT = '0000000000' OR SPACES
 11655         MOVE +0                 TO WK-L-RT
 11656                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 226
* ECS010.cbl
 11657                                    WK-A-RT
 11658         GO TO 1200-SET-COMMISSION-LEVEL.
 11659
 11660 1110-LIFE-COMMISSION.
 11661
 11662     IF CR-LFTYP = ZERO  OR
 11663       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11664         MOVE +0 TO WK-L-RT
 11665                    WK-J-RT
 11666         GO TO 1130-A-H-COMMISSION.
 11667
 11668     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11669         GO TO 1120-JOINT-LIFE-COMMISSION.
 11670
 11671     IF WK-L-RT NUMERIC
 11672        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11673         MOVE WK-L-RT                TO WS-COMMISSION
 11674         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11675         MOVE WS-COMMISSION          TO WK-L-RT
 11676         GO TO 1130-A-H-COMMISSION.
 11677
 11678     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11679     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11680     MOVE ZEROS                      TO WS-SUB1.
 11681     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11682
 11683     IF WS-SUB1 = ZEROS
 11684         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11685     ELSE
 11686         MOVE WK-RATE                TO WK-L-RT
 11687         GO TO 1130-A-H-COMMISSION.
 11688
 11689     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11690
 11691     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11692     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11693     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11694     MOVE WK-RATE                    TO WK-L-RT.
 11695
 11696     GO TO 1130-A-H-COMMISSION.
 11697
 11698 1120-JOINT-LIFE-COMMISSION.
 11699
 11700     IF WK-J-RT NUMERIC
 11701        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11702         MOVE WK-J-RT                TO WS-COMMISSION
 11703         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11704         MOVE WS-COMMISSION          TO WK-J-RT
 11705         GO TO 1130-A-H-COMMISSION.
 11706
 11707     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11708     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11709     MOVE ZEROS                      TO WS-SUB1.
 11710     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11711
 11712     IF WS-SUB1 = ZEROS
 11713         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11714     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 227
* ECS010.cbl
 11715         MOVE WK-RATE                TO WK-J-RT
 11716         GO TO 1130-A-H-COMMISSION.
 11717
 11718     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11719
 11720     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11721     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11722     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11723     MOVE WK-RATE                    TO WK-J-RT.
 11724
 11725 1130-A-H-COMMISSION.
 11726
 11727     IF CR-AHTYP = ZERO  OR
 11728       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11729         MOVE +0 TO WK-A-RT
 11730         GO TO 1200-SET-COMMISSION-LEVEL.
 11731
 11732     IF WK-A-RT NUMERIC
 11733        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11734         MOVE WK-A-RT                TO WS-COMMISSION
 11735         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11736         MOVE WS-COMMISSION          TO WK-A-RT
 11737         GO TO 1200-SET-COMMISSION-LEVEL.
 11738
 11739     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11740     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11741     MOVE ZEROS                      TO WS-SUB1.
 11742     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11743
 11744     IF WS-SUB1 = ZEROS
 11745         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11746     ELSE
 11747         MOVE WK-RATE                TO WK-A-RT
 11748         GO TO 1200-SET-COMMISSION-LEVEL.
 11749
 11750     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11751
 11752     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11753     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11754     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11755     MOVE WK-RATE                    TO WK-A-RT.
 11756
 11757 1200-SET-COMMISSION-LEVEL.
 11758
 11759     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11760     IF WK-AGT = '0000000000' OR SPACES
 11761         MOVE SPACE                   TO WK-N-TYPE (IA)
 11762     ELSE
 11763         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11764
 11765     IF CR-LFTYP = ZERO
 11766         MOVE +0                      TO WK-L-RT1  (IA)
 11767     ELSE
 11768         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11769             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11770         ELSE
 11771             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11772
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 228
* ECS010.cbl
 11773     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11774
 11775     IF RC-COMM-FLG = 'X'
 11776        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11777*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11778*             AND (IA = +5))
 11779            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11780            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11781            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11782            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11783
 11784     IF IA LESS THAN +10
 11785         ADD +1 TO IA
 11786         GO TO 1100-GET-COMMISSION-LEVEL.
 11787
 11788     GO TO 1499-SET-COMM-X.
 11789
 11790 1300-READ-ERCTBL-FILE.
 11791
 11792     IF CTBL-SEARCH = LAST-CTBL
 11793         GO TO 1399-READ-ERCTBL-X.
 11794
 11795     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11796
 11797     IF COMM-OPEN-SW = ' '
 11798         MOVE 'X'                        TO COMM-OPEN-SW
 11799         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11800         OPEN INPUT ERCTBL
 11801         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11802             NEXT SENTENCE
 11803            ELSE
 11804             MOVE '41'                   TO ABEND-CODE-1
 11805             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11806             DISPLAY '******************************'
 11807             DISPLAY '***** ERROR LOCATION 012 *****'
 11808             DISPLAY '******************************'
 11809             DISPLAY '******************************'
 11810             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11811             GO TO ABEND-PGM.
 11812
 11813     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11814                                            LAST-CTBL.
 11815     READ ERCTBL.
 11816
 11817     IF ERCTBL-FILE-STATUS = '23'
 11818         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11819                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11820                 ' CTBL: ' CTBL-SEARCH
 11821         MOVE '*'                TO CTBL-ERROR-SWITCH
 11822         MOVE '44'               TO ABEND-CODE-1
 11823         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11824         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11825         DISPLAY '******************************'
 11826         DISPLAY '***** ERROR LOCATION 013 *****'
 11827         DISPLAY '******************************'
 11828         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11829*        IF DTE-CLIENT NOT = 'NCL'
 11830         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 229
* ECS010.cbl
 11831           AND 'AHL'
 11832             GO TO ABEND-PGM
 11833         ELSE
 11834             NEXT SENTENCE
 11835     ELSE
 11836         IF ERCTBL-FILE-STATUS NOT = '00'
 11837             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11838             MOVE '44'               TO ABEND-CODE-1
 11839             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11840             DISPLAY '******************************'
 11841             DISPLAY '***** ERROR LOCATION 014 *****'
 11842             DISPLAY '******************************'
 11843             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11844             GO TO ABEND-PGM.
 11845
 11846     ADD +1                            TO ERCTBL-READS.
 11847
 11848 1399-READ-ERCTBL-X.
 11849     EXIT.
 11850
 11851 1400-GET-COMM-PERCENT.
 11852
 11853     IF CTBL-ERROR
 11854         MOVE ZEROS                      TO WK-RATE
 11855         GO TO 1489-GET-PERCENT-X.
 11856
 11857     MOVE +1 TO IB.
 11858     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11859        (CT-TBF (1) NOT EQUAL +9999999.99)
 11860         ADD +9 TO IB
 11861         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11862            (CT-TBF (2) NOT EQUAL +9999999.99)
 11863             ADD +9 TO IB.
 11864
 11865     IF CR-AGE GREATER CT-AGE (1)
 11866         ADD +3 TO IB
 11867         IF CR-AGE GREATER CT-AGE (2)
 11868             ADD +3 TO IB.
 11869
 11870     IF WS-COMM-TERM GREATER CT-TRM (1)
 11871         ADD +1 TO IB
 11872         IF WS-COMM-TERM GREATER CT-TRM (2)
 11873             ADD +1 TO IB.
 11874
 11875     IF CT-RT (IB) NOT NUMERIC
 11876         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11877         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11878         GO TO 1300-READ-ERCTBL-FILE.
 11879
 11880     MOVE CT-RT (IB) TO WK-RATE.
 11881
 11882 1489-GET-PERCENT-X.
 11883     EXIT.
 11884
 11885 1499-SET-COMM-X.
 11886     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 230
* ECS010.cbl
 11888******************************************************************
 11889***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11890******************************************************************
 11891
 11892 1500-GET-ACCT-LEVEL-LF-COMM.
 11893
 11894     MOVE ZEROS                      TO ACCT-COMM-LF
 11895                                        ACCT-COMM-AH.
 11896
 11897     MOVE +1                         TO IA.
 11898
 11899 1510-ACCT-LEVEL-LOOP.
 11900
 11901     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11902         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11903             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11904             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11905         ELSE
 11906             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11907                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11908
 11909     IF IA LESS THAN +10
 11910         ADD +1 TO IA
 11911         GO TO 1510-ACCT-LEVEL-LOOP.
 11912
 11913 1519-ACCT-LF-COMM-X.
 11914     EXIT.
 11915
 11916
 11917 1550-GET-ACCT-LEVEL-AH-COMM.
 11918
 11919     MOVE ZEROS                      TO ACCT-COMM-AH.
 11920
 11921     MOVE +1                         TO IA.
 11922
 11923 1555-ACCT-LEVEL-LOOP.
 11924
 11925     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11926         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11927             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11928
 11929     IF IA LESS THAN +10
 11930         ADD +1 TO IA
 11931         GO TO 1555-ACCT-LEVEL-LOOP.
 11932
 11933 1599-ACCT-AH-COMM-X.
 11934     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 231
* ECS010.cbl
 11936******************************************************************
 11937***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11938******************************************************************
 11939
 11940 1600-RECALC-COMM-EXTR.
 11941
 11942     IF RC-COMM-FLG = 'X'  OR
 11943        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11944        CR-POLICY-IS-DECLINED  OR
 11945        CR-POLICY-IS-VOID
 11946         GO TO 1899-RECALC-COMM-EXTR-X.
 11947
 11948     MOVE 'X'                           TO RC-COMM-FLG.
 11949
 11950     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11951         GO TO 1899-RECALC-COMM-EXTR-X.
 11952
 11953     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11954
 11955     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11956         GO TO 1899-RECALC-COMM-EXTR-X.
 11957
 11958     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11959
 11960     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11961         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11962             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11963
 11964     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11965         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11966                                           WK-NEW-RATES
 11967         GO TO 1899-RECALC-COMM-EXTR-X.
 11968
 11969     MOVE +1                            TO SUB8.
 11970     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11971
 11972 1610-CK-DUPLICATE-ENTRIES.
 11973     PERFORM 1620-CK-DUPL-ENTR-NEW
 11974         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11975             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11976
 11977 1619-CK-DUPLICATE-ENTRIES-XIT.
 11978     EXIT.
 11979
 11980 1620-CK-DUPL-ENTR-NEW.
 11981     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11982         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11983         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11984         MOVE +0                        TO CR-LCOM-L (SUB11)
 11985                                           CR-LCOM-AH (SUB11)
 11986         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11987         MOVE 11                        TO SUB12.
 11988
 11989 1629-CK-DUPL-ENTR-NEW-XIT.
 11990     EXIT.
 11991
 11992 1700-REVERSE-OLD-COMM-LOOP.
 11993     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 232
* ECS010.cbl
 11994     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11995
 11996     IF SUB8 LESS THAN +10
 11997         ADD +1 TO SUB8
 11998         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11999
 12000     MOVE 'O' TO RECALC-TYPE.
 12001
 12002     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12003
 12004     GO TO 1800-MOVE-NEW-COMM-RATES.
 12005
 12006 1710-DO-R-C-EXTRACTS.
 12007
 12008     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12009
 12010     PERFORM 1720-CHECK-COMM-LEVELS
 12011         THRU 1729-CHECK-COMM-LEVELS-EXIT
 12012             VARYING SUB13 FROM +1 BY +1
 12013                 UNTIL SUB13 GREATER THAN 10.
 12014
 12015     MOVE '8'                           TO DE-TRANS.
 12016     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 12017*****PERFORM EXTRACT-DATE-RELOAD.
 12018     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12019     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12020     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 12021     PERFORM EXTRACT-DATE-LOAD.
 12022     MOVE 'R'                           TO DE-REIN.
 12023     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12024     MOVE +1                            TO SUB1.
 12025     PERFORM 3110-REINSURE-ISSUE-LOOP
 12026         THRU 3119-REINSURE-ISSUE-LOOP-END.
 12027
 12028     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 12029         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 12030                                       2259-END-CANCEL-BUILD
 12031         PERFORM 1720-CHECK-COMM-LEVELS
 12032             THRU 1729-CHECK-COMM-LEVELS-EXIT
 12033                 VARYING SUB13 FROM +1 BY +1
 12034                     UNTIL SUB13 GREATER THAN 10
 12035         MOVE '7'                       TO DE-TRANS
 12036         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 12037*********PERFORM EXTRACT-DATE-RELOAD
 12038         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12039         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 12040         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 12041         PERFORM EXTRACT-DATE-LOAD
 12042         MOVE 'R'                       TO DE-REIN
 12043         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12044         MOVE +1                        TO SUB1
 12045         PERFORM 3210-REINSURE-CANCEL-LOOP
 12046             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12047
 12048 1719-DO-R-C-EXTRACTS-X.
 12049     EXIT.
 12050
 12051 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 233
* ECS010.cbl
 12052
 12053     IF  DE-AGT (SUB13)       =  SPACES  AND
 12054         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12055         DE-L-PC (SUB13)      =  ZEROS   AND
 12056         DE-A-PC (SUB13)      =  ZEROS
 12057         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12058
 12059 1729-CHECK-COMM-LEVELS-EXIT.
 12060     EXIT.
 12061
 12062 1800-MOVE-NEW-COMM-RATES.
 12063     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12064     MOVE 'N'                           TO RECALC-TYPE.
 12065     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12066     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12067                                           CR-COMPENSATION-LEVELS.
 12068     IF DTE-CLIENT = 'DCC'
 12069        IF CR-LF-NSP-PRM NOT = ZEROS
 12070           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12071              (CR-LFPRM + CR-LFPRM-ALT) -
 12072              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12073        END-IF
 12074        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12075           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12076                                        NOT = 'G' AND 'L')
 12077           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12078           CR-AHPRM -
 12079           (CR-AHPRM * CR-LCOM-AH (1))
 12080        END-IF
 12081     END-IF
 12082     .
 12083
 12084 1899-RECALC-COMM-EXTR-X.
 12085     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 234
* ECS010.cbl
 12087******************************************************************
 12088***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12089******************************************************************
 12090
 12091 2000-INITIALIZE-DETAIL-EXTRACT.
 12092
 12093     MOVE SPACES                   TO DETAIL-EXTRACT.
 12094
 12095     MOVE 'DE'                     TO DE-RECORD-ID.
 12096     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12097     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12098
 12099     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12100     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12101
 12102     MOVE CR-NAME                  TO DE-NAME.
 12103     MOVE CR-AGE                   TO DE-AGE.
 12104     MOVE CR-SEX                   TO DE-SEX.
 12105     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12106
 12107     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12108     MOVE CR-LF-TERM               TO DE-LF-TERM
 12109     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12110     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12111     MOVE ZEROS                    TO DE-LF-CNBEN.
 12112     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12113     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12114     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12115     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12116     MOVE ZEROS                    TO DE-LF-RFND.
 12117
 12118     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12119     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12120                                      DE-LF-CANC-EXIT-DT.
 12121
 12122     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12123     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12124     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12125     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12126     MOVE ZEROS                    TO DE-AH-RFND.
 12127
 12128     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12129     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12130                                      DE-AH-CANC-EXIT-DT.
 12131     IF DTE-CLIENT = 'DCC'
 12132        IF CR-ENTRY-STATUS = 'M'
 12133           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12134        ELSE
 12135           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12136              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12137           END-IF
 12138        END-IF
 12139     END-IF
 12140
 12141     IF DTE-CLIENT = 'DCC'
 12142        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12143        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12144     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 235
* ECS010.cbl
 12145        IF (CR-LFTYP NOT = ZERO   AND
 12146           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12147           (CR-AHTYP NOT = ZERO  AND
 12148           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12149           MOVE CR-LIVES           TO DE-LIVES
 12150           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12151                                      DE-CANCEL-CNT-YTD
 12152        END-IF
 12153     END-IF
 12154
 12155     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12156     IF AM-ZIP-PRIME NUMERIC
 12157        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12158      ELSE
 12159        MOVE ZEROS                 TO DE-ZIP.
 12160     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12161
 12162     MOVE CR-APR                   TO DE-APR.
 12163     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12164     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12165     MOVE CR-IND-GRP               TO DE-IG.
 12166     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12167     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12168
 12169     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12170     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12171     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12172
 12173     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12174*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12175
 12176     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12177                                      DE-REI-AHAMT  DE-REI-AHPRM
 12178                                      DE-REI-LFRFND DE-REI-AHRFND
 12179                                      DE-REI-CNAMT.
 12180
 12181     MOVE +1                       TO SUB1.
 12182
 12183* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12184* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12185* CALC IT IN ECS017.
 12186     IF DTE-CLIENT = 'DCC'
 12187        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12188           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12189           IF CR-ACCOUNT = '05500500DD'
 12190              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12191                ' ' DE-REI-LFRFND
 12192           END-IF
 12193        END-IF
 12194        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12195                      OR
 12196           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12197            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12198           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12199           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12200        END-IF
 12201     END-IF
 12202
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 236
* ECS010.cbl
 12203
 12204     PERFORM EXTRACT-DATE-LOAD.
 12205
 12206     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12207                                      WS-DE-INCUR-N
 12208                                      WS-DE-PAY-N
 12209                                      WS-DE-PAID-TO-N
 12210                                      WS-DE-ACC-EXP-DTE-N
 12211                                      WS-DE-ACC-EFF-DTE-N
 12212                                      WS-DE-RSV-INCUR-N
 12213                                      WS-DE-RSV-PAYTO-N
 12214                                      WS-DE-ACC-EXP-DTE-RSV-N
 12215                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12216
 12217 2090-GL-CODE-LOOP.
 12218
 12219     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12220
 12221     IF SUB1 LESS THAN +10
 12222         ADD +1 TO SUB1
 12223         GO TO 2090-GL-CODE-LOOP.
 12224
 12225     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12226
 12227     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12228
 12229     IF (DTE-CLIENT = 'DCC')
 12230        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12231        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12232        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12233        AND (RECALC-TYPE = SPACES)
 12234        MOVE +1                  TO IA
 12235*       IF CR-ACCOUNT = '05500500DD'
 12236**      IF CR-CERT-NO = '0008773536 '
 12237*          DISPLAY ' MADE IT TO 2000 '
 12238*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12239*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12240*             (IB > +10)
 12241*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12242*                MOVE IB TO DIL-BEN-CODE
 12243*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12244*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12245*                DISPLAY DISPLAY-IBNR-LINE
 12246*             END-IF
 12247*          END-PERFORM
 12248*          DISPLAY ' TRLR AREA  '
 12249*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12250*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12251*             (IB > +10)
 12252*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12253*                MOVE IB TO DIL-BEN-CODE
 12254*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12255*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12256*                DISPLAY DISPLAY-IBNR-LINE
 12257*             END-IF
 12258*          END-PERFORM
 12259*       END-IF
 12260        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 237
* ECS010.cbl
 12261           IB > +10
 12262           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12263              CONTINUE
 12264           ELSE
 12265              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12266                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12267                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12268                 COMPUTE DE-A-PC (IB) =
 12269                        WS-BNK-SPP-FEES (IA) / +1000
 12270                 MOVE +0              TO DE-L-PC (IB)
 12271                 ADD +1               TO IA
 12272              END-IF
 12273*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12274*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12275*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12276*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12277*                MOVE +0              TO DE-L-PC (IB)
 12278*                ADD +1               TO IA
 12279*             END-IF
 12280           END-IF
 12281        END-PERFORM
 12282     END-IF
 12283
 12284
 12285
 12286     .
 12287 2099-INIT-DTL-X.
 12288     EXIT.
 12289
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 238
* ECS010.cbl
 12291******************************************************************
 12292***            B U I L D   I S S U E   E X T R A C T           ***
 12293******************************************************************
 12294
 12295 2100-BUILD-ISSUE-EXTRACT.
 12296
 12297     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12298
 12299     MOVE 'I'                      TO DE-TRANS.
 12300
 12301     IF CHECK-BILLED
 12302         MOVE 'N' TO BILLED-SWITCH
 12303     ELSE
 12304         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12305
 12306     MOVE +1                        TO SUB1.
 12307 2150-GA-BILL-LOOP.
 12308
 12309     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12310         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12311
 12312     IF SUB1 LESS THAN +5
 12313         ADD +1 TO SUB1
 12314         GO TO 2150-GA-BILL-LOOP.
 12315
 12316     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12317     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12318                                       DE-BILLED-LFRFND
 12319                                       DE-BILLED-AHPRM
 12320                                       DE-BILLED-AHRFND.
 12321
 12322     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12323         IF PB-LF-BILLED-AMTS = ZERO  AND
 12324            PB-AH-BILLED-AMTS = ZERO
 12325             MOVE ' '                    TO DE-BILL-STATUS
 12326         ELSE
 12327             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12328                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12329                 MOVE 'B'                TO DE-BILL-STATUS
 12330             ELSE
 12331                 MOVE 'R'                TO DE-BILL-STATUS
 12332                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12333                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12334     ELSE
 12335         MOVE 'B'                        TO DE-BILL-STATUS.
 12336
 12337 2190-WRITE-ISSUE-EXTRACT.
 12338
 12339     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12340
 12341 2199-BLD-ISSUE-X.
 12342     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 239
* ECS010.cbl
 12344******************************************************************
 12345***           B U I L D   C A N C E L   E X T R A C T          ***
 12346******************************************************************
 12347
 12348 2200-BUILD-CANCEL-EXTRACT.
 12349
 12350     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12351
 12352     MOVE 'C'                           TO DE-TRANS.
 12353
 12354     IF CR-LFTYP = ZERO
 12355         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12356
 12357     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12358         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12359             CR-LFRFND = +0
 12360              MOVE +0                   TO TEMP-5
 12361              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12362
 12363     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12364          IF CR-LFRFND = +0
 12365              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12366
 12367     MOVE +1 TO TEMP-5.
 12368     MOVE CR-LF-TERM             TO ORIG-TERM.
 12369     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12370     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12371     MOVE '1'                    TO W-VAL-SOURCE.
 12372     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12373
 12374     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12375         MOVE CR-LFAMT TO DE-LF-CNBEN
 12376         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12377
 12378     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12379         GO TO 2220-BLD-DE-CANCEL-SUM.
 12380
 12381     IF REM-TRM3 = CR-LF-TERM
 12382         MOVE CR-LFAMT TO DE-LF-CNBEN
 12383         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12384
 12385     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12386         GO TO 2210-BLD-DE-CANCEL-TEX.
 12387
 12388     IF DTE-CLIENT = 'NCL'
 12389         IF CR-DT LESS THAN 19910101
 12390             GO TO 2205-BLD-DE-CANCEL-BEN.
 12391
 12392     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12393         GO TO 2230-BLD-DE-CANCEL-NP.
 12394
 12395     IF DTE-CLIENT = 'FUL'
 12396         GO TO 2240-BLD-DE-CANCEL-FUL.
 12397
 12398*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12399     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12400        (CR-RATING-CLASS NOT = 'L ')
 12401         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 240
* ECS010.cbl
 12402            (CR-LF-TERM GREATER THAN 060)  AND
 12403            (CR-DT GREATER THAN 19831031)
 12404              GO TO 2230-BLD-DE-CANCEL-NP.
 12405
 12406     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12407         IF (CR-APR GREATER THAN ZERO)  AND
 12408            (CR-LF-TERM GREATER THAN 061)  AND
 12409            (CR-DT GREATER THAN 19830318)
 12410              GO TO 2230-BLD-DE-CANCEL-NP.
 12411
 12412     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12413         IF (CR-APR GREATER THAN ZERO)  AND
 12414            (CR-LF-TERM GREATER THAN 062)  AND
 12415            (CR-DT GREATER THAN 19810831)  AND
 12416            (CR-DT LESS THAN 19830901)
 12417              GO TO 2230-BLD-DE-CANCEL-NP.
 12418
 12419     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12420         IF (CR-APR GREATER THAN ZERO)  AND
 12421            (CR-LF-TERM GREATER THAN 060)  AND
 12422            (CR-DT GREATER THAN 19831231)
 12423              GO TO 2230-BLD-DE-CANCEL-NP.
 12424
 12425 2205-BLD-DE-CANCEL-BEN.
 12426
 12427     IF CR-LF-TERM EQUAL +0
 12428         MOVE +0          TO TEMP-5
 12429     ELSE
 12430         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12431
 12432     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12433
 12434     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12435
 12436 2210-BLD-DE-CANCEL-TEX.
 12437
 12438     DIVIDE CR-LFAMT BY CR-LF-TERM
 12439         GIVING TEX-FACT-1.
 12440     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12441         GIVING TEX-FACT-2
 12442             REMAINDER TEX-FACT-3.
 12443     IF TEX-FACT-3 NOT = ZERO
 12444         ADD +1 TO TEX-FACT-2.
 12445     COMPUTE DE-LF-CNBEN =
 12446         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12447
 12448     IF CR-LFAMT EQUAL +0
 12449         MOVE +0                  TO TEMP-5
 12450     ELSE
 12451         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12452
 12453     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12454
 12455 2220-BLD-DE-CANCEL-SUM.
 12456
 12457     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12458     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12459
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 241
* ECS010.cbl
 12460     IF CR-LFRFND NOT LESS CR-LFPRM
 12461         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12462          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12463
 12464     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12465     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12466     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12467         MOVE TEMP-7             TO DE-LF-CNBEN
 12468       ELSE
 12469         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12470         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12471
 12472     IF CR-LFAMT EQUAL +0
 12473         MOVE +0                  TO TEMP-5
 12474     ELSE
 12475         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12476
 12477     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12478         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12479
 12480 2230-BLD-DE-CANCEL-NP.
 12481
 12482     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12483     MOVE 'L'                        TO  DC-OPTION-CODE.
 12484     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12485     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12486
 12487     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12488       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12489       MOVE '3'                      TO  DC-OPTION-CODE
 12490       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12491       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12492     ELSE
 12493       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12494       MOVE '6'                      TO  DC-OPTION-CODE
 12495       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12496       MOVE +0                       TO  DC-ELAPSED-DAYS
 12497       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12498       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12499
 12500     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12501     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12502     MOVE CR-APR                     TO  CP-LOAN-APR.
 12503     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12504     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12505     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12506     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12507     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12508     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12509
 12510     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12511     IF (DTE-CLIENT = 'DCC')
 12512        AND (AM-DCC-PRODUCT-CODE <> spaces)
 12513        if cr-clp-state = spaces
 12514           move cr-state         to cr-clp-state
 12515        end-if
 12516        if cr-lftyp not = '00' and '  ' and 'DD'
 12517           move 'L'              to ws-dd-ben-type
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 242
* ECS010.cbl
 12518           move cr-lftyp         to ws-dd-ben-code
 12519        else
 12520           move 'A'              to ws-dd-ben-type
 12521           move cr-ahtyp         to ws-dd-ben-code
 12522        end-if
 12523        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12524           ((CR-clp-STATE = DD-STATE (D1))
 12525           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12526           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 12527           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 12528           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12529                           OR
 12530           D1 > max-pdef
 12531        END-PERFORM
 12532        IF D1 <= max-pdef
 12533           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12534              (P1 > +8)
 12535              OR (DD-PROD-CODE (D1 P1) = 'L')
 12536           END-PERFORM
 12537           IF P1 < +9
 12538              MOVE DD-MAX-BEN-AMT (D1 P1)
 12539                                 TO CP-R-MAX-TOT-BEN
 12540           END-IF
 12541        END-IF
 12542     END-IF
 12543
 12544     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12545
 12546     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12547         COMPUTE DE-LF-CNBEN =
 12548                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12549      ELSE
 12550          COMPUTE DE-LF-CNBEN ROUNDED =
 12551                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12552
 12553     IF CR-LFAMT EQUAL +0
 12554         MOVE +0                  TO TEMP-5
 12555     ELSE
 12556         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12557
 12558     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12559
 12560 2240-BLD-DE-CANCEL-FUL.
 12561
 12562     MOVE CR-APR                  TO NP-APR.
 12563     MOVE CR-LF-TERM              TO NP-ORIG.
 12564     MOVE REM-TRM3                TO NP-REM.
 12565     MOVE '2'                     TO NP-OPT.
 12566     MOVE CR-AHPRM                TO NP-AHPRM.
 12567     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12568     MOVE CR-LFAMT                TO NP-BENEFIT.
 12569
 12570*    CALL 'FULNETRM'
 12571*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12572*              NP-ACCOUNT NP-REMAINING.
 12573
 12574     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12575
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 243
* ECS010.cbl
 12576     IF CR-LFAMT EQUAL +0
 12577         MOVE +0                  TO TEMP-5
 12578     ELSE
 12579         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12580
 12581 2250-CONTINUE-CANCEL-BUILD.
 12582
 12583     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12584     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12585     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 12586                                         WS-DE-LF-CANC-DTE-N.
 12587     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12588                                         WS-DE-LF-CANC-EXIT-DT-N.
 12589     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12590
 12591
 12592     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12593     IF (DTE-CLIENT = 'DCC')
 12594        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12595        AND (CR-AHTYP NOT = '00' AND '  ')
 12596        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12597        MOVE CR-AH-TERM          TO ORIG-TERM
 12598        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12599        MOVE '1'                 TO W-VAL-SOURCE
 12600        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12601        PERFORM 8500-REMAINING-TERM-ROUTINE
 12602                                 THRU 8599-REM-TERM-X
 12603        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12604        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12605     END-IF
 12606
 12607     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12608
 12609     IF DTE-CLIENT = 'DCC'
 12610        IF DE-AH-RFND = ZEROS
 12611           MOVE ZEROS                 TO DE-ADDL-CLP
 12612        END-IF
 12613     END-IF
 12614
 12615     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12616     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12617                                         WS-DE-AH-CANC-DTE-N.
 12618     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12619                                         WS-DE-AH-CANC-EXIT-DT-N.
 12620     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12621
 12622     IF PB-LAST-MAINT-BY = 'E570'
 12623         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12624
 12625     IF CHECK-BILLED
 12626         MOVE 'N' TO BILLED-SWITCH
 12627     ELSE
 12628         GO TO 2259-END-CANCEL-BUILD.
 12629
 12630     MOVE +1                        TO SUB1.
 12631 2255-GA-BILL-LOOP.
 12632
 12633     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 244
* ECS010.cbl
 12634         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12635
 12636     IF SUB1 LESS THAN +5
 12637         ADD +1 TO SUB1
 12638         GO TO 2255-GA-BILL-LOOP.
 12639
 12640     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12641     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12642     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12643                                       DE-BILLED-LFRFND
 12644                                       DE-BILLED-AHPRM
 12645                                       DE-BILLED-AHRFND.
 12646
 12647     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12648         IF PB-LF-BILLED-AMTS = ZERO  AND
 12649            PB-AH-BILLED-AMTS = ZERO
 12650             MOVE ' '                    TO DE-BILL-STATUS
 12651         ELSE
 12652             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12653                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12654                 MOVE 'B'                TO DE-BILL-STATUS
 12655             ELSE
 12656                 MOVE 'R'                TO DE-BILL-STATUS
 12657                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12658                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12659     ELSE
 12660         MOVE 'B'                        TO DE-BILL-STATUS.
 12661
 12662 2259-END-CANCEL-BUILD.
 12663     EXIT.
 12664
 12665 2290-WRITE-CANCEL-EXTRACT.
 12666
 12667     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12668
 12669 2299-BLD-CANCEL-X.
 12670     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 245
* ECS010.cbl
 12672******************************************************************
 12673***            B U I L D   C L A I M   E X T R A C T           ***
 12674******************************************************************
 12675
 12676 2300-BUILD-CLAIM-EXTRACT.
 12677
 12678     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12679
 12680     MOVE 'X'                       TO DE-TRANS.
 12681
 12682     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12683
 12684     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12685     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12686
 12687     MOVE INCURRED-DATE             TO DE-INCUR
 12688                                       WS-DE-INCUR-N.
 12689     MOVE REPORTED-DATE             TO DE-REPORTED.
 12690     MOVE PAYMENT-DATE              TO DE-PAY
 12691                                       WS-DE-PAY-N.
 12692     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12693                                       WS-DE-PAID-TO-N.
 12694
 12695     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12696     MOVE PC-CHECK-NO               TO DE-CHECK.
 12697     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12698     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12699     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12700     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12701     INSPECT DE-PAY-CODE
 12702         CONVERTING '1234569' TO 'PFSXEEV'.
 12703
 12704     MOVE AM-NAME                   TO DE-ACC-NAME.
 12705     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12706                                       WS-DE-ACC-EXP-DTE-N.
 12707     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12708                                       WS-DE-ACC-EFF-DTE-N.
 12709     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12710     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12711
 12712     IF DE-DTH  OR  DE-OB-DTH
 12713         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12714     ELSE
 12715         IF CR-AH-LUMP-SUM-DISAB
 12716             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12717                                    TO DE-AH-PREV-STAT.
 12718
 12719     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12720         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12721
 12722 2390-WRITE-CLAIM-EXTRACT.
 12723
 12724     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12725
 12726 2399-BLD-CLAIM-X.
 12727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 246
* ECS010.cbl
 12729******************************************************************
 12730***          B U I L D   R E S E R V E   E X T R A C T         ***
 12731******************************************************************
 12732
 12733 2400-BUILD-RESERVE-EXTRACT.
 12734
 12735     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12736
 12737     MOVE 'Y'                         TO DE-TRANS.
 12738     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12739
 12740     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12741     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12742     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12743     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12744     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12745     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12746
 12747     IF DTE-CLIENT  =  'NCL'
 12748        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12749            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12750
 12751     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12752
 12753     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12754                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12755
 12756     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12757                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12758
 12759     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12760                                         WS-DE-RSV-INCUR-N.
 12761     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12762     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12763                                         WS-DE-RSV-PAYTO-N.
 12764
 12765     MOVE ZEROS                       TO DE-REI-IBNR
 12766                                         DE-REI-PAYCUR
 12767                                         DE-REI-FUTRSV.
 12768
 12769     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12770
 12771     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12772         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12773
 12774 2490-WRITE-RESERVE-EXTRACT.
 12775
 12776     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12777
 12778 2499-BLD-RESERVE-X.
 12779     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 247
* ECS010.cbl
 12781******************************************************************
 12782***          W R I T E   D E T A I L   E X T R A C T S         ***
 12783******************************************************************
 12784
 12785 2500-WRITE-DETAIL-EXTRACTS.
 12786
 12787
 12788     MOVE  ZEROS            TO  SUB.
 12789
 12790     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12791         GO TO 2520-WRITE-CONTINUE.
 12792
 12793 2510-ZERO-CHARGEBACK-LOOP.
 12794
 12795     ADD  +1                TO  SUB.
 12796
 12797     IF  SUB    GREATER  THAN     +10
 12798         GO TO  2520-WRITE-CONTINUE.
 12799
 12800*    DISPLAY ' CERT NO ' CR-CERT-NO
 12801*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12802*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12803
 12804
 12805     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12806         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12807
 12808     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12809         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12810         OR (WS-DDF-AH-CB (SUB) = 'N')
 12811         MOVE  ZEROS             TO DE-A-PC (SUB)
 12812     END-IF
 12813
 12814     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12815
 12816 2520-WRITE-CONTINUE.
 12817
 12818     IF DTE-CLIENT NOT = 'HER'
 12819         GO TO 2590-WRITE-EXTRACTS.
 12820
 12821     IF DE-REINCO NOT = 'LNL'
 12822         GO TO 2590-WRITE-EXTRACTS.
 12823
 12824     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12825         GO TO 2590-WRITE-EXTRACTS.
 12826
 12827     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12828     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12829     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12830     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12831     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12832     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12833     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12834     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12835     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12836     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12837
 12838     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 248
* ECS010.cbl
 12839     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12840     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12841     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12842     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12843     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12844     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12845     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12846     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12847     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12848
 12849
 12850 2590-WRITE-EXTRACTS.
 12851
 12852     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12853                                     WS-DE-PROC-DT-N.
 12854
 12855     IF DTE-PGM-OPT = '1'
 12856         ADD +1                   TO DE-CNT
 12857*********PERFORM EXTRACT-DATE-RELOAD
 12858         WRITE DETAIL-EXTRACT.
 12859
 12860
 12861 2599-WRT-DETAIL-X.
 12862     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 249
* ECS010.cbl
 12864******************************************************************
 12865***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12866******************************************************************
 12867
 12868 3000-REINSURE-ROUTINE.
 12869
 12870     IF (CR-POLICY-IS-DECLINED) OR
 12871        (CR-POLICY-IS-VOID)
 12872        GO TO 3099-REINSURE-ROUTINE-X.
 12873
 12874     IF REIN-FLG = 'X'
 12875         GO TO 3099-REINSURE-ROUTINE-X.
 12876
 12877     MOVE 'X' TO REIN-FLG.
 12878
 12879     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12880
 12881     IF CR-REIN-TABLE = SPACES OR ZEROS
 12882         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12883
 12884******************************************************************
 12885***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12886******************************************************************
 12887
 12888 3010-RR-READ-REIN.
 12889
 12890     IF REIN-OPEN-SW = ' '
 12891         MOVE 'X'                       TO REIN-OPEN-SW
 12892         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12893         MOVE 'A'                       TO REIN-SRCH-CODE
 12894         OPEN INPUT ERRTBL-IN
 12895         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12896             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12897          ELSE
 12898             MOVE '21'                  TO ABEND-CODE-1
 12899             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12900             DISPLAY '******************************'
 12901             DISPLAY '***** ERROR LOCATION 015 *****'
 12902             DISPLAY '******************************'
 12903             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12904             GO TO ABEND-PGM.
 12905
 12906     IF CR-REIN-TABLE = REIN-SRCH
 12907         GO TO 3019-RR-READ-REIN-X.
 12908
 12909     MOVE +0                            TO REIN-SUB-1.
 12910     MOVE 999999                        TO REIN-LOW-TIME.
 12911     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12912
 12913 3011-RR-CHECK-REIN-SAVE-TABLE.
 12914
 12915     ADD +1                             TO REIN-SUB-1.
 12916     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12917        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12918         GO TO 3015-RR-READ-ERRTBL.
 12919
 12920     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12921         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 250
* ECS010.cbl
 12922         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12923         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12924         GO TO 3019-RR-READ-REIN-X.
 12925
 12926     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12927         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12928         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12929
 12930     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12931
 12932 3015-RR-READ-ERRTBL.
 12933
 12934     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12935
 12936     READ ERRTBL-IN.
 12937
 12938     IF ERRTBL-FILE-STATUS  = '23'
 12939         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12940                                           ' ' CR-FULL-CONTROL
 12941         MOVE '24'                      TO ABEND-CODE-1
 12942         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12943         DISPLAY '******************************'
 12944         DISPLAY '***** ERROR LOCATION 016 *****'
 12945         DISPLAY '******************************'
 12946         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12947         GO TO ABEND-PGM.
 12948
 12949     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12950         NEXT SENTENCE
 12951       ELSE
 12952         MOVE '24'                      TO ABEND-CODE-1
 12953         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12954         DISPLAY '******************************'
 12955         DISPLAY '***** ERROR LOCATION 017 *****'
 12956         DISPLAY '******************************'
 12957         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12958         GO TO ABEND-PGM.
 12959
 12960     ADD +1                            TO ERRTBL-READS.
 12961
 12962     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12963         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12964         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12965         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12966     ELSE
 12967         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12968         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12969         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12970         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12971
 12972 3019-RR-READ-REIN-X.
 12973     EXIT.
 12974
 12975 3020-CALCULATE-REINSURANCE.
 12976
 12977*    IF DTE-CLIENT = '???'  AND
 12978*       (CR-REIN-TABLE = 'SE1')
 12979*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 251
* ECS010.cbl
 12980*        IF CR-STATE NOT = STATE-L
 12981*            MOVE CR-STATE             TO STATE-L
 12982*            PERFORM 8200-STATE-CODE-LOOKUP
 12983*                         THRU 8299-STATE-LOOKUP-X.
 12984
 12985
 12986*    IF DTE-CLIENT = 'DCC'
 12987*       IF CR-LF-NSP-PRM NOT = ZEROS
 12988*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12989*             (CR-LFPRM + CR-LFPRM-ALT) -
 12990*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12991*       END-IF
 12992*       IF CR-AH-NSP-PRM NOT = ZEROS
 12993*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12994*          CR-AHPRM -
 12995*          (CR-AHPRM * CR-LCOM-AH (1))
 12996*       END-IF
 12997*    END-IF
 12998
 12999
 13000     IF RE-REMAINING (1) = 'I'
 13001         MOVE '*'                      TO RISK-REIN-FLAG
 13002     ELSE
 13003         GO TO 3029-CONTINUE-REIN-CALC.
 13004
 13005     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 13006                                          REIN-CANCEL-AH-SW.
 13007     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 13008                                          REIN-LCNC-EARN-TERM
 13009                                          REIN-LF-CLM-MONTHS
 13010                                          REIN-EARN-AH-TERM
 13011                                          REIN-ACNC-EARN-TERM
 13012                                          REIN-AH-PRIOR-CLMS-PAID
 13013                                          REIN-AH-CLM-MONTHS
 13014                                          REIN-AH-CLM-MTH-1
 13015                                          REIN-AH-CLM-MTH-2
 13016                                          REIN-AH-CLM-MTH-3
 13017                                          REIN-AH-CLM-MTH-4
 13018                                          REIN-AH-CLM-MTH-5.
 13019
 13020*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 13021*    MOVE 'L'                          TO DC-OPTION-CODE.
 13022*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13023*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 13024
 13025     IF CR-LFTYP = ZEROS  OR  SPACES
 13026         GO TO 3023-CONTINUE.
 13027
 13028     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13029
 13030     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 13031       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13032           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 13033
 13034     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 13035       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 13036           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 13037
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 252
* ECS010.cbl
 13038     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13039     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13040
 13041     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 13042         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 13043     ELSE
 13044         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 13045
 13046     IF CR-LF-CANC-DT NOT = ZEROS
 13047         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 13048         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13049         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 13050         IF CR-DT = CR-LF-CANC-DT
 13051             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 13052
 13053     IF CR-DTH-DT NOT = ZEROS
 13054         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 13055         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13056         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13057
 13058     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13059
 13060
 13061 3023-CONTINUE.
 13062
 13063     IF CR-AHTYP = ZEROS  OR  SPACES
 13064        GO TO 3029-CONTINUE-REIN-CALC.
 13065
 13066     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13067
 13068     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13069       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13070           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13071
 13072     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13073       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13074           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13075
 13076     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13077     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13078
 13079     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13080         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13081     ELSE
 13082         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13083
 13084     IF CR-AH-CANC-DT NOT = ZEROS
 13085         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13086         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13087         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13088         IF CR-DT = CR-AH-CANC-DT
 13089             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13090
 13091     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13092         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13093         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13094         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13095
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 253
* ECS010.cbl
 13096     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13097         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13098         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13099         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13100
 13101     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13102         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13103         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13104         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13105
 13106     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13107         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13108         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13109         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13110
 13111     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13112         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13113         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13114         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13115
 13116     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13117
 13118
 13119     GO TO 3029-CONTINUE-REIN-CALC.
 13120
 13121
 13122 3025-CALC-ELAPSED-MONTHS.
 13123
 13124     MOVE 'L'                          TO DC-OPTION-CODE.
 13125     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13126     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13127     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13128     MOVE '1'                          TO DC-OPTION-CODE.
 13129     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13130     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13131                                          DC-ODD-DAYS-OVER
 13132                                          DC-ELAPSED-DAYS.
 13133     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13134
 13135 3026-CALC-EXIT.
 13136     EXIT.
 13137
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 254
* ECS010.cbl
 13139 3029-CONTINUE-REIN-CALC.
 13140
*13141                             COPY ECSRTPFM.
 13142******************************************************************07/10/97
 13143*                                                                *ECSRTPFM
 13144*                            ECSRTPFM                            *   LV001
 13145*                            VMOD=2.002                          *ECSRTPFM
 13146*                                                                *ECSRTPFM
 13147******************************************************************ECSRTPFM
 13148                                                                  ECSRTPFM
 13149     IF    CR-LFAMT  NUMERIC                                      00000072
 13150           NEXT SENTENCE                                          00000073
 13151        ELSE                                                      00000074
 13152           MOVE ZEROS TO CR-LFAMT.                                00000075
 13153                                                                  00000076
 13154     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13155           NEXT SENTENCE                                          00000078
 13156        ELSE                                                      00000079
 13157           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13158                                                                  00000081
 13159                                                                  00000082
 13160     IF    CR-LFPRM  NUMERIC                                      00000083
 13161           NEXT SENTENCE                                          00000084
 13162        ELSE                                                      00000085
 13163           MOVE ZEROS TO CR-LFPRM.                                00000086
 13164                                                                  00000087
 13165     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13166           NEXT SENTENCE                                          00000089
 13167        ELSE                                                      00000090
 13168           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13169                                                                  00000092
 13170                                                                  00000093
 13171     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13172           NEXT SENTENCE                                          00000095
 13173        ELSE                                                      00000096
 13174           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13175                                                                  00000098
 13176     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13177           NEXT SENTENCE                                          00000100
 13178        ELSE                                                      00000101
 13179           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13180                                                                  00000103
 13181     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13182           NEXT SENTENCE                                          00000105
 13183        ELSE                                                      00000106
 13184           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13185                                                                  00000108
 13186     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13187     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13188     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13189         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13190     ELSE                                                         ECSRTPFM
 13191         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13192     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13193                                                                  ECSRTPFM
 13194     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13195     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13196     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 255
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13197         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13198     ELSE                                                         ECSRTPFM
 13199         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13200     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13201                                                                  ECSRTPFM
 13202     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13203         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13204             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13205                                                                  ECSRTPFM
 13206
 13207     MOVE 'X'                  TO REIN-RT-SW.
 13208     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13209     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13210     MOVE ' '                  TO REIN-RT-SW.
 13211
 13212 3030-RE-CALCULATE-REINSURANCE.
 13213
 13214     IF AM-RECALC-REIN = 'Y'
 13215         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13216            CR-REIN-SPEC = SPACE  AND
 13217            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13218             PERFORM 3600-RC-REINSURANCE
 13219                 THRU 3799-RC-REINSURANCE-X.
 13220
 13221     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13222         VARYING SUB1 FROM 1 BY 1
 13223             UNTIL REIN-COMP (SUB1) = SPACES.
 13224
 13225     GO TO 3099-REINSURE-ROUTINE-X.
 13226
 13227 3040-REIN-REC-CNT.
 13228
 13229     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13230         GO TO 3049-RRC-XIT.
 13231
 13232     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13233         VARYING B-SUB FROM 1 BY 1
 13234             UNTIL B-SUB GREATER THAN 50.
 13235
 13236 3049-RRC-XIT.
 13237     EXIT.
 13238
 13239 3050-REIN-COMP-ADD.
 13240
 13241     IF RB-COMPANY (B-SUB) = SPACES
 13242         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13243     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13244         MOVE 1   TO RB-COUNT (B-SUB)
 13245         MOVE +50 TO B-SUB.
 13246
 13247 3059-RCA-XIT.
 13248     EXIT.
 13249
 13250 3099-REINSURE-ROUTINE-X.
 13251     EXIT.
 13252
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 256
* ECS010.cbl
 13254******************************************************************
 13255***                R E I N S U R E   I S S U E S               ***
 13256******************************************************************
 13257
 13258 3100-REINSURE-ISSUE.
 13259
 13260     IF  REIN-COMP (1) = SPACES
 13261         GO TO 3199-REINSURE-ISSUE-X.
 13262
 13263     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13264     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13265     MOVE 'I'      TO DE-TRANS.
 13266     MOVE 'R'      TO DE-REIN.
 13267*****PERFORM EXTRACT-DATE-RELOAD.
 13268     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13269     MOVE +1       TO SUB1.
 13270
 13271 3110-REINSURE-ISSUE-LOOP.
 13272
 13273     IF REIN-COMP (SUB1) = SPACES
 13274         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13275
 13276     IF UPDATING-RISK-PREMIUMS
 13277       IF REIN-REM-SW (SUB1) NOT = 'I'
 13278         ADD +1 TO SUB1
 13279         GO TO 3110-REINSURE-ISSUE-LOOP.
 13280
 13281     IF REIN-REM-SW (SUB1) = 'Z'
 13282         ADD +1 TO SUB1
 13283         GO TO 3110-REINSURE-ISSUE-LOOP.
 13284
 13285     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13286     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13287     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13288     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13289     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13290     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13291
 13292     IF REIN-REM-SW (SUB1) NOT = 'I'
 13293         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13294
 13295     IF RWF-LFPRM = ZEROS  AND
 13296        RWF-AHPRM = ZEROS
 13297         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13298
 13299     IF RWF-LFPRM NOT = ZEROS
 13300         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13301         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13302
 13303     IF RWF-AHPRM NOT = ZEROS
 13304         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13305         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13306
 13307 3115-CONTINUE-ISSUE-LOOP.
 13308
 13309     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13310     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13311
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 257
* ECS010.cbl
 13312     IF DE-REI-LFAMT NOT = ZERO
 13313        OR DE-REI-LFPRM NOT = ZERO
 13314        OR DE-REI-AHAMT NOT = ZERO
 13315        OR DE-REI-AHPRM NOT = ZERO
 13316         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13317                 2599-WRT-DETAIL-X
 13318         ADD +1 TO BC-R-ISS.
 13319
 13320     ADD +1 TO SUB1.
 13321     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13322     PERFORM EXTRACT-DATE-LOAD.
 13323
 13324     GO TO 3110-REINSURE-ISSUE-LOOP.
 13325
 13326 3119-REINSURE-ISSUE-LOOP-END.
 13327     EXIT.
 13328
 13329 3190-REINSURE-ISSUE-PRINT.
 13330
 13331     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13332     IF RW-ACCUM-LF NOT = ZERO
 13333         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13334         MOVE CR-LF-TERM               TO TRD-LFTRM
 13335         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13336         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13337     IF RW-ACCUM-AH NOT = ZERO
 13338         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13339         MOVE CR-AH-TERM               TO TRD-AHTRM
 13340         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13341         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13342     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13343         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13344
 13345 3199-REINSURE-ISSUE-X.
 13346     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 258
* ECS010.cbl
 13348******************************************************************
 13349***               R E I N S U R E   C A N C E L S              ***
 13350******************************************************************
 13351
 13352 3200-REINSURE-CANCEL.
 13353
 13354     IF REIN-COMP (1) = SPACES
 13355         GO TO 3299-REINSURE-CANCEL-X.
 13356
 13357     IF CR-LFRFND = ZERO
 13358        AND CR-AHRFND = ZERO
 13359         GO TO 3299-REINSURE-CANCEL-X.
 13360
 13361     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13362             VARYING SUB1 FROM +1 BY +1 UNTIL
 13363                       REIN-COMP (SUB1) = SPACES.
 13364
 13365     IF REIN-RT-SW = 'X'
 13366         GO TO 3299-REINSURE-CANCEL-X.
 13367
 13368     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13369     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13370     MOVE 'R'      TO DE-REIN.
 13371*****PERFORM EXTRACT-DATE-RELOAD.
 13372     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13373     MOVE +1       TO SUB1.
 13374
 13375 3210-REINSURE-CANCEL-LOOP.
 13376
 13377     IF REIN-COMP (SUB1) = SPACES
 13378         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13379
 13380     IF REIN-REM-SW (SUB1) = 'Z'
 13381         ADD +1        TO SUB1
 13382         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13383         PERFORM EXTRACT-DATE-LOAD
 13384         GO TO 3210-REINSURE-CANCEL-LOOP.
 13385
 13386     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13387     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13388
 13389     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13390     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13391     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13392     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13393     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13394     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13395     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13396     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13397     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13398
 13399     IF REIN-REM-SW (SUB1) NOT = 'I'
 13400         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13401
 13402     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13403        VOIDING-LF-CANCEL
 13404         NEXT SENTENCE
 13405     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 259
* ECS010.cbl
 13406         MOVE ZEROS             TO DE-REI-LFRFND.
 13407
 13408     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13409        VOIDING-AH-CANCEL
 13410         NEXT SENTENCE
 13411     ELSE
 13412         MOVE ZEROS             TO DE-REI-AHRFND.
 13413
 13414 3215-CONTINUE-CANCEL-LOOP.
 13415
 13416     IF RWF-LF-RUNOFF-SW = 'N'
 13417         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13418             MOVE ZEROS         TO DE-LF-TYPE
 13419                                   DE-REI-LFAMT
 13420                                   DE-REI-LFPRM
 13421                                   DE-REI-LFRFND
 13422                                   DE-REI-CNAMT.
 13423
 13424     IF RWF-AH-RUNOFF-SW = 'N'
 13425         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13426             MOVE ZEROS         TO DE-AH-TYPE
 13427                                   DE-REI-AHAMT
 13428                                   DE-REI-AHPRM
 13429                                   DE-REI-AHRFND.
 13430
 13431     IF DE-REI-LFAMT NOT = ZERO
 13432        OR DE-REI-LFPRM NOT = ZERO
 13433        OR DE-REI-AHAMT NOT = ZERO
 13434        OR DE-REI-AHPRM NOT = ZERO
 13435        OR DE-REI-LFRFND NOT = ZERO
 13436        OR DE-REI-AHRFND NOT = ZERO
 13437        OR DE-REI-CNAMT NOT = ZERO
 13438         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13439                                            2599-WRT-DETAIL-X
 13440         ADD +1 TO BC-R-CNC.
 13441
 13442     ADD +1 TO SUB1.
 13443     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13444     PERFORM EXTRACT-DATE-LOAD.
 13445     GO TO 3210-REINSURE-CANCEL-LOOP.
 13446
 13447 3219-REINSURE-CANCEL-LOOP-END.
 13448     EXIT.
 13449
 13450 3290-REINSURE-CANCEL-PRINT.
 13451
 13452     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13453     IF RW-ACCUM-LF NOT = ZERO
 13454         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13455         MOVE CR-LF-TERM               TO TRD-LFTRM
 13456         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13457         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13458     IF RW-ACCUM-AH NOT = ZERO
 13459         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13460         MOVE CR-AH-TERM               TO TRD-AHTRM
 13461         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13462         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13463     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 260
* ECS010.cbl
 13464         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13465
 13466 3299-REINSURE-CANCEL-X.
 13467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 261
* ECS010.cbl
 13469******************************************************************
 13470***                R E I N S U R E   C L A I M S               ***
 13471******************************************************************
 13472
 13473 3300-REINSURE-CLAIM.
 13474
 13475*    IF DTE-CLIENT = '???'
 13476*       IF (REIN-RT-SW NOT = 'X')  AND
 13477*          (PC-PAYMENT-TYPE = '5' OR '6')
 13478*        GO TO 3399-REINSURE-CLAIM-X.
 13479
 13480     IF REIN-COMP (1) = SPACES
 13481         GO TO 3399-REINSURE-CLAIM-X.
 13482
 13483     IF REIN-RT-SW = 'X'
 13484         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13485         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13486         MOVE CR-DISAMT   TO RW-AHCLMWK
 13487         ADD  CR-DISEXP   TO RW-AHCLMWK
 13488     ELSE
 13489         IF PC-CLAIM-TYPE  = 1 OR 3
 13490             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13491             MOVE +0                  TO RW-AHCLMWK
 13492         ELSE
 13493             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13494             MOVE +0                  TO RW-LFCLMWK.
 13495
 13496     MOVE +0                          TO RW-LFCLM
 13497                                         RW-AHCLM.
 13498     IF RW-LFCLMWK = ZERO
 13499        AND RW-AHCLMWK = ZERO
 13500         GO TO 3399-REINSURE-CLAIM-X.
 13501
 13502     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13503         VARYING SUB1 FROM +1 BY +1
 13504             UNTIL REIN-COMP (SUB1) = SPACES.
 13505
 13506     IF REIN-RT-SW = 'X'
 13507         GO TO 3399-REINSURE-CLAIM-X.
 13508
 13509     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13510     MOVE ZEROS                TO RW-ACCUM-CLM.
 13511     MOVE 'R'                  TO DE-REIN.
 13512*****PERFORM EXTRACT-DATE-RELOAD.
 13513     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13514     MOVE +1                   TO SUB1.
 13515
 13516 3310-REINSURE-CLAIM-LOOP.
 13517
 13518     IF REIN-COMP (SUB1) = SPACES
 13519         GO TO 3390-REINSURE-CLAIM-PRINT.
 13520
 13521     IF REIN-REM-SW (SUB1) = 'Z'
 13522         ADD +1        TO SUB1
 13523         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13524         PERFORM EXTRACT-DATE-LOAD
 13525         GO TO 3310-REINSURE-CLAIM-LOOP.
 13526
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 262
* ECS010.cbl
 13527     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13528     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13529
 13530     IF PC-CLAIM-TYPE  = 1 OR 3
 13531         IF RWF-LF-RUNOFF-SW = 'N'
 13532           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13533               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13534
 13535     IF PC-CLAIM-TYPE  = 2 OR 4
 13536         IF RWF-AH-RUNOFF-SW = 'N'
 13537           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13538               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13539
 13540     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13541     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13542     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13543     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13544
 13545     IF PC-CLAIM-TYPE  = 1 OR 3
 13546         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13547         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13548     ELSE
 13549         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13550         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13551
 13552     IF PC-CLAIM-TYPE = 1 OR 3
 13553         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13554            AND DE-REI-CLAIM-AMT
 13555             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13556         ELSE
 13557             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13558     ELSE
 13559         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13560            AND DE-REI-CLAIM-AMT
 13561             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13562         ELSE
 13563             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13564
 13565 3320-REINSURE-CLAIM-LOOP-GO.
 13566
 13567     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13568     ADD +1                     TO BC-R-CLM.
 13569
 13570 3330-REINSURE-CLAIM-LOOP-ADD.
 13571
 13572     ADD +1                     TO SUB1.
 13573     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13574     PERFORM EXTRACT-DATE-LOAD.
 13575     GO TO 3310-REINSURE-CLAIM-LOOP.
 13576
 13577 3390-REINSURE-CLAIM-PRINT.
 13578
 13579     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13580     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13581         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13582         MOVE CR-LF-TERM               TO TRD-LFTRM
 13583         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13584         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 263
* ECS010.cbl
 13585     ELSE
 13586         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13587         MOVE CR-AH-TERM               TO TRD-AHTRM
 13588         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13589         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13590         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13591         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13592         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13593         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13594     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13595
 13596 3399-REINSURE-CLAIM-X.
 13597     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 264
* ECS010.cbl
 13599******************************************************************
 13600***              R E I N S U R E   R E S E R V E S             ***
 13601******************************************************************
 13602
 13603 3400-REINSURE-RESERVE.
 13604
 13605     IF REIN-COMP (1) = SPACES
 13606         GO TO 3499-REINSURE-RESERVE-X.
 13607
 13608     IF PC-CLAIM-TYPE = '1' OR '3'
 13609         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13610         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13611         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13612         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13613         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13614     ELSE
 13615         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13616         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13617         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13618         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13619         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13620
 13621     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13622                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13623     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13624         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13625          GO TO 3499-REINSURE-RESERVE-X.
 13626
 13627     IF DTE-CLIENT NOT = 'MIC'
 13628         GO TO 3405-REINSURE-RESERVE-CONT.
 13629
 13630     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13631         GO TO 3405-REINSURE-RESERVE-CONT.
 13632
 13633     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13634     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13635     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13636     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13637                                        CP-CLAIM-TYPE.
 13638     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13639     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13640     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13641     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13642     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13643     MOVE '3'                        TO CP-CDT-METHOD.
 13644     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13645     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13646                                        CP-RATING-BENEFIT-AMT.
 13647     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13648     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13649
 13650 3405-REINSURE-RESERVE-CONT.
 13651
 13652     PERFORM 3500-REINSURE-CALC-RESERVE
 13653         THRU 3599-REINSURE-CALC-RESERVE-X
 13654             VARYING SUB1 FROM +1 BY +1
 13655                 UNTIL REIN-COMP (SUB1) = SPACES.
 13656
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 265
* ECS010.cbl
 13657     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13658     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13659     MOVE 'R'            TO DE-REIN.
 13660*****PERFORM EXTRACT-DATE-RELOAD.
 13661     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13662     MOVE +1             TO SUB1.
 13663
 13664 3410-REINSURE-RESERVE-LOOP.
 13665
 13666     IF REIN-COMP (SUB1) = SPACES
 13667         GO TO 3490-REINSURE-RESERVE-PRINT.
 13668
 13669     IF REIN-REM-SW (SUB1) = 'Z'
 13670         ADD +1 TO SUB1
 13671         GO TO 3410-REINSURE-RESERVE-LOOP.
 13672
 13673     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13674     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13675
 13676     IF PC-CLAIM-TYPE  = 1 OR 3
 13677         IF RWF-LF-RUNOFF-SW = 'N'
 13678           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13679               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13680
 13681     IF PC-CLAIM-TYPE  = 2 OR 4
 13682         IF RWF-AH-RUNOFF-SW = 'N'
 13683           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13684               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13685
 13686     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13687     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13688     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13689     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13690
 13691     IF PC-CLAIM-TYPE = 1 OR 3
 13692         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13693         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13694         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13695     ELSE
 13696         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13697         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13698         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13699
 13700     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13701     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13702     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13703
 13704     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13705        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13706        OR DE-REI-FUTRSV
 13707         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13708                                            2599-WRT-DETAIL-X
 13709         ADD +1 TO BC-R-CRS.
 13710
 13711 3415-REINSURE-RESERVE-LOOP-ADD.
 13712
 13713     ADD +1 TO SUB1.
 13714     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 266
* ECS010.cbl
 13715     PERFORM EXTRACT-DATE-LOAD.
 13716     GO TO 3410-REINSURE-RESERVE-LOOP.
 13717
 13718 3490-REINSURE-RESERVE-PRINT.
 13719
 13720     IF RW-ACCUM-IBNR   = ZERO  AND
 13721        RW-ACCUM-PAYCUR = ZERO  AND
 13722        RW-ACCUM-FUTRSV = ZERO
 13723         GO TO 3499-REINSURE-RESERVE-X.
 13724
 13725     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13726     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13727     MOVE 'IBNR'                    TO TRD-IBNRX.
 13728     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13729     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13730     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13731     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13732
 13733     IF PC-CLAIM-TYPE = 1
 13734         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13735     ELSE
 13736         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13737     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13738
 13739     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13740
 13741 3499-REINSURE-RESERVE-X.
 13742     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 267
* ECS010.cbl
 13744******************************************************************
 13745***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13746******************************************************************
 13747
 13748 3500-REINSURE-CALC-RESERVE.
 13749
 13750     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13751     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13752                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13753
 13754     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13755        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13756          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13757       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13758
 13759     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13760        MOVE ZERO TO CO-SUB.
 13761
 13762     IF CO-SUB NOT = ZERO
 13763        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13764           IF PC-CLAIM-TYPE = '1' OR '3'
 13765             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13766                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13767
 13768     IF PC-CLAIM-TYPE  = 1 OR 3
 13769         IF RWF-LF-RUNOFF-SW = 'N'
 13770           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13771               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13772
 13773     IF CO-SUB NOT = ZERO
 13774        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13775           IF PC-CLAIM-TYPE = '2' OR '4'
 13776             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13777                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13778
 13779     IF PC-CLAIM-TYPE  = 2 OR 4
 13780         IF RWF-AH-RUNOFF-SW = 'N'
 13781           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13782               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13783
 13784     IF DTE-CLIENT NOT = 'MIC'
 13785         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13786
 13787     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13788         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13789
 13790     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13791
 13792     IF CR-AHTYP = ZERO  OR
 13793        CO-SUB = ZERO
 13794         GO TO 3505-REIN-CALC-RESERVE-CONT
 13795     ELSE
 13796         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13797             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13798
 13799     COMPUTE MAX-REM-TERM ROUNDED =
 13800                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13801
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 268
* ECS010.cbl
 13802     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13803         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13804
 13805     COMPUTE CP-ORIGINAL-TERM =
 13806                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13807
 13808     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13809
 13810     IF  CP-RETURN-CODE = ZERO
 13811         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13812
 13813 3505-REIN-CALC-RESERVE-CONT.
 13814
 13815     IF SUB1 = RE-100-COMP
 13816         GO TO 3520-REIN-REMAINDER-RSRV.
 13817
 13818     IF CR-LFAMT NOT = ZERO  AND
 13819        RWF-LFAMT NOT = ZERO
 13820         IF DTE-CLIENT NOT = 'MIC'
 13821             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13822                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13823             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13824                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13825             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13826                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13827         ELSE
 13828             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13829             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13830             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13831
 13832     IF CR-AHAMT NOT = ZERO  AND
 13833        RWF-AHAMT NOT = ZERO
 13834         IF DTE-CLIENT NOT = 'MIC'
 13835             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13836                         RWF-AHAMT) / CR-AHAMT
 13837             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13838                         RWF-AHAMT) / CR-AHAMT
 13839             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13840                         RWF-AHAMT) / CR-AHAMT
 13841         ELSE
 13842             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13843             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13844             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13845
 13846 3510-REINSURE-CALC-RESERVE-ADD.
 13847
 13848     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13849     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13850     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13851     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13852     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13853     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13854
 13855     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13856         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13857
 13858     IF CO-SUB = ZERO
 13859         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 269
* ECS010.cbl
 13860
 13861 3513-REIN-CHK-LF-RSRV-LIMIT.
 13862     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13863         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13864
 13865     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13866         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13867
 13868     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13869                                      (RWF-LFCLM +
 13870                                       RWF-DTH-PAYCUR +
 13871                                       RWF-DTH-FUTRSV).
 13872
 13873     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13874         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13875
 13876     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13877
 13878     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13879         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13880         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13881     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13882         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13883
 13884     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13885
 13886     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13887         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13888         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13889     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13890         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13891
 13892 3515-REIN-CHK-AH-RSRV-LIMIT.
 13893     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13894         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13895
 13896     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13897         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13898
 13899     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13900                                      (RWF-AHCLM +
 13901                                       RWF-DIS-PAYCUR +
 13902                                       RWF-DIS-FUTRSV).
 13903
 13904     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13905         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13906
 13907     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13908
 13909     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13910         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13911         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13912     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13913         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13914
 13915     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13916
 13917     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 270
* ECS010.cbl
 13918         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13919         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13920     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13921         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13922
 13923 3519-REINSURE-CALC-RESERVE-END.
 13924
 13925     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13926        OR RWF-DTH-FUTRSV
 13927         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13928
 13929     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13930        OR RWF-DIS-FUTRSV
 13931         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13932
 13933     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13934
 13935 3520-REIN-REMAINDER-RSRV.
 13936
 13937     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13938     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13939     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13940     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13941     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13942     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13943
 13944     PERFORM 3530-REIN-SUB-RSRV
 13945         THRU 3539-REIN-SUB-RSRV-X
 13946             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13947
 13948     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13949
 13950 3530-REIN-SUB-RSRV.
 13951
 13952     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13953     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13954     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13955     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13956     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13957     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13958
 13959 3539-REIN-SUB-RSRV-X.
 13960     EXIT.
 13961
 13962 3540-CONT-REIN-CALC-RESERVE.
 13963
 13964     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13965         MOVE 'X' TO REIN-BUS-FLAG.
 13966     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13967
 13968 3599-REINSURE-CALC-RESERVE-X.
 13969     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 271
* ECS010.cbl
 13971******************************************************************
 13972***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13973******************************************************************
 13974
 13975*REINSURANCE-CALCULATIONS.
*13976                             COPY ECSRIRTN.
 13977******************************************************************04/30/98
 13978*                                                                *ECSRIRTN
 13979*                            ECSRIRTN                            *   LV012
 13980*                            VMOD=2.025.                         *ECSRIRTN
 13981*                                                                *ECSRIRTN
 13982******************************************************************ECSRIRTN
 13983******************************************************************
 13984*                   C H A N G E   L O G
 13985*
 13986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13987*-----------------------------------------------------------------
 13988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13989* EFFECTIVE    NUMBER
 13990*-----------------------------------------------------------------
 13991* 062703                   PEMA  ADD DCC CLIENT ID TO
 13992*                                SPECIAL CEDED CLAIM CALC
 13993* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13994* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 13995                                                                  ECSRIRTN
 13996 REINSURE-CALC.                                                   ECSRIRTN
 13997                                                                  ECSRIRTN
 13998     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13999     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14000     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 14001     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 14002                                   REIN-REM-SW (SUB1).            ECSRIRTN
 14003                                                                  ECSRIRTN
 14004     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 14005                                   WS-RWF-EP-STOP-DATE-N             CL*12
 14006                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 14007                                                                  ECSRIRTN
 14008     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14009                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 14010                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 14011                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14012                                                                  ECSRIRTN
 14013     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14014        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14015          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14016          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14017          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14018                                                                  ECSRIRTN
 14019     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14020        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14021         GO TO CALC-CONTINUED.                                    ECSRIRTN
 14022                                                                  ECSRIRTN
 14023     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 14024                                          WS-RWF-EP-STOP-DATE-N      CL*12
 14025                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 14026                                                                  ECSRIRTN
 14027     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 14028         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 272
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14029                                                                  ECSRIRTN
 14030     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 14031         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14032                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 14033                                                                  ECSRIRTN
 14034     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 14035         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 14036                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14037                                                                  ECSRIRTN
 14038 CALC-CONTINUED.                                                  ECSRIRTN
 14039                                                                  ECSRIRTN
 14040     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 14041     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 14042                                                                  ECSRIRTN
 14043     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 14044         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 14045     ELSE                                                         ECSRIRTN
 14046         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 14047     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 14048                                                                  ECSRIRTN
 14049     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 14050     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 14051     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 14052         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 14053     ELSE                                                         ECSRIRTN
 14054         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 14055     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 14056                                                                  ECSRIRTN
 14057     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14058         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14059         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14060         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14061         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14062         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14063         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14064                                                                  ECSRIRTN
 14065     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14066         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14067                                                                  ECSRIRTN
 14068     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14069         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14070                                                                  ECSRIRTN
 14071     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14072         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14073                                                                  ECSRIRTN
 14074     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14075     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14076                                                                  ECSRIRTN
 14077     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14078         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14079                                                                  ECSRIRTN
 14080     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14081       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14082        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14083        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14084           NEXT SENTENCE                                          ECSRIRTN
 14085       ELSE                                                       ECSRIRTN
 14086           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 273
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14087                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 14088                                                                  ECSRIRTN
 14089     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14090         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14091            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14092             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14093                                                                  ECSRIRTN
 14094     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14095         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14096            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14097             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14098                                                                  ECSRIRTN
 14099     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14100         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14101             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14102                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14103             ELSE                                                 ECSRIRTN
 14104                 NEXT SENTENCE                                    ECSRIRTN
 14105         ELSE                                                     ECSRIRTN
 14106             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14107                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14108                                                                  ECSRIRTN
 14109     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14110         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14111             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14112                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14113             ELSE                                                 ECSRIRTN
 14114                 NEXT SENTENCE                                    ECSRIRTN
 14115         ELSE                                                     ECSRIRTN
 14116             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14117                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14118                                                                  ECSRIRTN
 14119     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14120         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14121                                                                  ECSRIRTN
 14122     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14123         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14124         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14125                                                                  ECSRIRTN
 14126     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14127         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14128                                                                  ECSRIRTN
 14129     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14130         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14131         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14132                                                                  ECSRIRTN
 14133     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14134         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14135                                                                  ECSRIRTN
 14136     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14137         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14138                                                                  ECSRIRTN
 14139     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14140                                                                  ECSRIRTN
 14141 REINSURE-CK-LIFE.                                                ECSRIRTN
 14142                                                                  ECSRIRTN
 14143     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14144         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 274
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14145                                                                  ECSRIRTN
 14146     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14147         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14148                                                                  ECSRIRTN
 14149     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14150         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14151             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14152                                                                  ECSRIRTN
 14153     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14154                                                                  ECSRIRTN
 14155     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14156         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14157             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14158         ELSE                                                     ECSRIRTN
 14159             NEXT SENTENCE                                        ECSRIRTN
 14160     ELSE                                                         ECSRIRTN
 14161         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14162             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14163                                                                  ECSRIRTN
 14164     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14165         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14166             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14167         ELSE                                                     ECSRIRTN
 14168             NEXT SENTENCE                                        ECSRIRTN
 14169     ELSE                                                         ECSRIRTN
 14170         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14171             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14172                                                                  ECSRIRTN
 14173     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14174         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14175             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14176                                                                  ECSRIRTN
 14177     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14178         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14179            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14180                                                                  ECSRIRTN
 14181     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14182         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14183             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14184                                                                  ECSRIRTN
 14185     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14186         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14187            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14188                                                                  ECSRIRTN
 14189     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14190         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14191             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14192                                                                  ECSRIRTN
 14193     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14194         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14195            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14196            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14197             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14198                                                                  ECSRIRTN
 14199     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14200         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14201            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14202             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 275
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14203                                                                  ECSRIRTN
 14204     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14205         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14206             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14207                                                                  ECSRIRTN
 14208     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14209         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14210             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14211                                                                  ECSRIRTN
 14212     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14213        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14214           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14215            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14216                                                                  ECSRIRTN
 14217     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14218         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14219            CR-IND-GRP = '1'                                      ECSRIRTN
 14220             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14221                                                                  ECSRIRTN
 14222     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14223         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14224            CR-IND-GRP = '1'                                      ECSRIRTN
 14225             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14226                                                                  ECSRIRTN
 14227     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14228         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14229            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14230            CR-IND-GRP = '1'                                      ECSRIRTN
 14231             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14232                                                                  ECSRIRTN
 14233     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14234         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14235            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14236            CR-IND-GRP = '1'                                      ECSRIRTN
 14237             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14238                                                                  ECSRIRTN
 14239     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14240         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14241            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14242                                                                  ECSRIRTN
 14243     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14244        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14245                                                                  ECSRIRTN
 14246     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14247         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14248                                                                  ECSRIRTN
 14249     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14250         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14251                                                                  ECSRIRTN
 14252     IF CR-LF-TERM  NUMERIC                                       00002331
 14253        NEXT SENTENCE                                             00002332
 14254     ELSE                                                         00002333
 14255        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14256     END-IF
 14257                                                                  00002335
 14258     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14259         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14260                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 276
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14261     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 14262         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14263                                                                  ECSRIRTN
 14264     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14265                                                                  ECSRIRTN
 14266     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14267         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14268                                                                  ECSRIRTN
 14269     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14270         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14271                                                                  ECSRIRTN
 14272     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14273                                                                  ECSRIRTN
 14274 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14275     EXIT.                                                        ECSRIRTN
 14276                                                                  ECSRIRTN
 14277 REINSURE-CK-AH.                                                  ECSRIRTN
 14278                                                                  ECSRIRTN
 14279     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14280         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14281                                                                  ECSRIRTN
 14282     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14283         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14284                                                                  ECSRIRTN
 14285     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14286         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14287             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14288                                                                  ECSRIRTN
 14289     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14290                                                                  ECSRIRTN
 14291     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14292         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14293             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14294         ELSE                                                     ECSRIRTN
 14295             NEXT SENTENCE                                        ECSRIRTN
 14296     ELSE                                                         ECSRIRTN
 14297         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14298             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14299                                                                  ECSRIRTN
 14300     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14301         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14302             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14303                                                                  ECSRIRTN
 14304     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14305         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14306             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14307                                                                  ECSRIRTN
 14308     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14309         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14310             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14311                                                                  ECSRIRTN
 14312     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14313         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14314             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14315                                                                  ECSRIRTN
 14316     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14317         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14318            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 277
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14319             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14320                                                                  ECSRIRTN
 14321     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14322         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14323             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14324                                                                  ECSRIRTN
 14325     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14326         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14327            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14328                                                                  ECSRIRTN
 14329     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14330         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14331            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14332                                                                  ECSRIRTN
 14333     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14334         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14335             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14336                                                                  ECSRIRTN
 14337     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14338        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14339                                                                  ECSRIRTN
 14340     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14341         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14342                                                                  ECSRIRTN
 14343     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14344         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14345                                                                  ECSRIRTN
 14346     IF CR-AH-TERM  NUMERIC                                       00002331
 14347        NEXT SENTENCE                                             00002332
 14348     ELSE                                                         00002333
 14349        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14350     END-IF
 14351                                                                  00002335
 14352     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14353         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14354                                                                  ECSRIRTN
 14355     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14356         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14357                                                                  ECSRIRTN
 14358     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14359                                                                  ECSRIRTN
 14360     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14361         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14362             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14363                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14364                                                                  ECSRIRTN
 14365     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14366         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14367             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14368                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14369                                                                  ECSRIRTN
 14370     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14371     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14372                                                                  ECSRIRTN
 14373     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14374         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14375                                                                  ECSRIRTN
 14376     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 278
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14377         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 14378                                                                  ECSRIRTN
 14379     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14380                                                                  ECSRIRTN
 14381     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14382                                                                  ECSRIRTN
 14383     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14384         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14385                                                                  ECSRIRTN
 14386     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14387         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14388                                                                  ECSRIRTN
 14389     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14390                                                                  ECSRIRTN
 14391 REINSURE-CK-AH-X.                                                ECSRIRTN
 14392     EXIT.                                                        ECSRIRTN
 14393                                                                  ECSRIRTN
 14394 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14395                                                                  ECSRIRTN
 14396     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14397        RS-AH-BEN = ZERO                                          ECSRIRTN
 14398         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14399                                                                  ECSRIRTN
 14400     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14401        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14402         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14403                                                                  ECSRIRTN
 14404     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14405                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14406                                                                  ECSRIRTN
 14407     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14408         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14409             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14410                                     WT-AHBEN-HI.                 ECSRIRTN
 14411     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14412         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14413             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14414                                     WT-AHMOA-HI.                 ECSRIRTN
 14415                                                                  ECSRIRTN
 14416     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14417     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14418                                                                  ECSRIRTN
 14419     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14420         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14421                                                                  ECSRIRTN
 14422     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14423         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14424                                                                  ECSRIRTN
 14425     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14426                                                                  ECSRIRTN
 14427     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14428         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14429                                                                  ECSRIRTN
 14430     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14431         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14432                                       / RW-AHWRK                 ECSRIRTN
 14433       ELSE                                                       ECSRIRTN
 14434         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 279
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14435                                                                  ECSRIRTN
 14436     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14437         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14438                                       / RS-LIFE-BEN              ECSRIRTN
 14439       ELSE                                                       ECSRIRTN
 14440         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14441                                                                  ECSRIRTN
 14442     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14443        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14444          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14445          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14446                                      / CR-AH-TERM.               ECSRIRTN
 14447                                                                  ECSRIRTN
 14448     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14449        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14450          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14451          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14452               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14453            ELSE                                                  ECSRIRTN
 14454                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14455                                                                  ECSRIRTN
 14456     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14457        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14458        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14459          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14460          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14461                                      / CR-AH-TERM                ECSRIRTN
 14462         ELSE                                                     ECSRIRTN
 14463          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14464          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14465               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14466            ELSE                                                  ECSRIRTN
 14467                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14468                                                                  ECSRIRTN
 14469 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14470     EXIT.                                                        ECSRIRTN
 14471                                                                  ECSRIRTN
 14472                                                                  ECSRIRTN
 14473 REIN-CALC-LIFE.                                                  ECSRIRTN
 14474                                                                  ECSRIRTN
 14475     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14476         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14477     ELSE                                                         ECSRIRTN
 14478         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14479                                                                  ECSRIRTN
 14480     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14481         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14482     ELSE                                                         ECSRIRTN
 14483         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14484           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14485               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14486           ELSE                                                   ECSRIRTN
 14487               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14488                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14489                                                                  ECSRIRTN
 14490 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14491                                                                  ECSRIRTN
 14492     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 280
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14493                                                                  ECSRIRTN
 14494     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14495         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14496                                                                  ECSRIRTN
 14497     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14498         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14499         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14500                                                                  ECSRIRTN
 14501     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14502         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14503                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14504         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14505                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14506     ELSE                                                         ECSRIRTN
 14507         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14508             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14509             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14510                                                                  ECSRIRTN
 14511     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14512         (WT-LF-QC = '2' AND                                         CL**8
 14513          PGM-SUB = +50  AND                                         CL**8
 14514          DTE-CLIENT = 'LAP'))                                       CL**8
 14515          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14516     ELSE                                                         ECSRIRTN
 14517         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14518                                                                  ECSRIRTN
 14519     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14520         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14521         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14522         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14523                                                                  ECSRIRTN
 14524     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14525                                                                  ECSRIRTN
 14526 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14527                                                                  ECSRIRTN
 14528     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14529         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14530         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14531                                                                  ECSRIRTN
 14532     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14533     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14534     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14535                                       RW-LFPRM.                  ECSRIRTN
 14536                                                                  ECSRIRTN
 14537 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14538                                                                  ECSRIRTN
 14539     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14540                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14541                                                                  ECSRIRTN
 14542     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14543        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14544                                                                  ECSRIRTN
 14545     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14546        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14547         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14548     ELSE                                                         ECSRIRTN
 14549         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14550         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 281
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14551                                                                  ECSRIRTN
 14552                                                                  ECSRIRTN
 14553 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14554     EXIT.                                                        ECSRIRTN
 14555                                                                  ECSRIRTN
 14556 REIN-CALC-AH.                                                    ECSRIRTN
 14557                                                                  ECSRIRTN
 14558     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14559         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14560             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14561                                 WT-AHBEN-HI.                     ECSRIRTN
 14562                                                                  ECSRIRTN
 14563     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14564         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14565             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14566                                 WT-AHMOA-HI.                     ECSRIRTN
 14567                                                                  ECSRIRTN
 14568     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14569     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14570                                                                  ECSRIRTN
 14571     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14572         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14573                                                                  ECSRIRTN
 14574     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14575         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14576                                                                  ECSRIRTN
 14577     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14578         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14579                                                                  ECSRIRTN
 14580     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14581         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14582     ELSE                                                         ECSRIRTN
 14583         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14584             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14585         ELSE                                                     ECSRIRTN
 14586             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14587             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14588                                                                  ECSRIRTN
 14589 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14590                                                                  ECSRIRTN
 14591     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14592         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14593                                                                  ECSRIRTN
 14594     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14595         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14596         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14597                                                                  ECSRIRTN
 14598     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14599         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14600                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14601         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14602                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14603     ELSE                                                         ECSRIRTN
 14604         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14605             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14606             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14607                                                                  ECSRIRTN
 14608     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 282
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14609         (WT-AH-QC = '2' AND                                         CL**8
 14610          PGM-SUB = +50  AND                                         CL**8
 14611          DTE-CLIENT = 'LAP'))                                       CL**8
 14612         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14613     ELSE                                                         ECSRIRTN
 14614         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14615                                                                  ECSRIRTN
 14616     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14617         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14618            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14619                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14620                                                                  ECSRIRTN
 14621     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14622         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14623         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14624         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14625                                                                  ECSRIRTN
 14626     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14627                                                                  ECSRIRTN
 14628 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14629                                                                  ECSRIRTN
 14630     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14631         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14632         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14633                                                                  ECSRIRTN
 14634     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14635     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14636     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14637                                    RW-AHPRM.                     ECSRIRTN
 14638                                                                  ECSRIRTN
 14639 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14640                                                                  ECSRIRTN
 14641     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14642                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14643                                                                  ECSRIRTN
 14644     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14645                                                                  ECSRIRTN
 14646     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14647        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14648         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14649     ELSE                                                         ECSRIRTN
 14650         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14651         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14652                                                                  ECSRIRTN
 14653                                                                  ECSRIRTN
 14654 REIN-CALC-AH-X.                                                  ECSRIRTN
 14655     EXIT.                                                        ECSRIRTN
 14656                                                                  ECSRIRTN
 14657 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14658                                                                  ECSRIRTN
 14659     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14660     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14661     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14662     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14663                                                                  ECSRIRTN
 14664     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14665         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14666                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 283
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14667     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 14668        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14669           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14670                                                                  ECSRIRTN
 14671     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14672        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14673           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14674                                                                  ECSRIRTN
 14675 REINSURE-CALC-X.                                                 ECSRIRTN
 14676                                                                  ECSRIRTN
 14677     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14678         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14679                                                                  ECSRIRTN
 14680     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14681                                                                  ECSRIRTN
 14682 REINSURE-SUBTRACT.                                               ECSRIRTN
 14683                                                                  ECSRIRTN
 14684     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14685     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14686     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14687     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14688                                                                  ECSRIRTN
 14689 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14690     EXIT.                                                        ECSRIRTN
 14691                                                                  ECSRIRTN
 14692 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14693                                                                  ECSRIRTN
 14694     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14695     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14696                                                                  ECSRIRTN
 14697     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14698         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14699                                                                  ECSRIRTN
 14700     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14701         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14702                                                                  ECSRIRTN
 14703     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14704         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14705             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14706                                                                  ECSRIRTN
 14707     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14708         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14709                                                                  ECSRIRTN
 14710     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14711         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14712         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14713                                                                  ECSRIRTN
 14714     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14715        MOVE ZERO                TO REIN-FACTOR
 14716     ELSE                                                         ECSRIRTN
 14717        IF DTE-CLIENT = 'GIC'  AND
 14718           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14719           MOVE +1.0             TO REIN-FACTOR
 14720        ELSE
 14721           IF DTE-CLIENT = 'DCC'
 14722              COMPUTE REIN-FACTOR = CR-LFRFND /
 14723                 (CR-LFPRM + CR-LFPRM-ALT)
 14724           ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 284
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14725              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 14726                 (CR-LFPRM + CR-LFPRM-ALT)
 14727            END-IF
 14728         END-IF
 14729     END-IF
 14730                                                                  ECSRIRTN
 14731     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14732         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14733             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14734                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14735                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14736             ELSE                                                 ECSRIRTN
 14737                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14738                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14739                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14740                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14741         ELSE                                                     ECSRIRTN
 14742             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14743                 compute rein-factor rounded =
 14744                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14745                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 14746                    rein-factor
 14747             ELSE                                                 ECSRIRTN
 14748*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14749*                   * REIN-CALCED-LIFE *
 14750*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14751                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14752                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14753                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14754                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14755                                                                  ECSRIRTN
 14756     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14757         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14758             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14759                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14760                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14761             ELSE                                                 ECSRIRTN
 14762                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14763                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14764                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14765                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14766                                                                  ECSRIRTN
 14767     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14768                                                                  ECSRIRTN
 14769                                                                  ECSRIRTN
 14770 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14771                                                                  ECSRIRTN
 14772     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14773       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14774         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14775         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14776                                                                  ECSRIRTN
 14777     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14778       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14779           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14780           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14781       ELSE                                                       ECSRIRTN
 14782           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 285
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14783               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14784                                                                  ECSRIRTN
 14785     IF FLAT-CANCEL-LF                                            ECSRIRTN
 14786         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14787         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14788                                                                  ECSRIRTN
 14789     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14790         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14791         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14792                                                                  ECSRIRTN
 14793     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14794     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14795     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14796                                         RW-LFRFND.               ECSRIRTN
 14797                                                                  ECSRIRTN
 14798 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14799                                                                  ECSRIRTN
 14800     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14801                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14802                                                                  ECSRIRTN
 14803     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14804        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14805                                                                  ECSRIRTN
 14806     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14807        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14808         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14809     ELSE                                                         ECSRIRTN
 14810         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14811         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14812                                                                  ECSRIRTN
 14813                                                                  ECSRIRTN
 14814 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14815                                                                  ECSRIRTN
 14816     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14817         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14818                                                                  ECSRIRTN
 14819     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14820         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14821             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14822                                                                  ECSRIRTN
 14823     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14824         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14825         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14826             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14827                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14828         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14829                                                                  ECSRIRTN
 14830     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14831         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14832                                                                  ECSRIRTN
 14833     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14834         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14835         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14836                                                                  ECSRIRTN
 14837     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14838        MOVE ZERO                TO REIN-FACTOR
 14839     ELSE
 14840        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 286
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14841           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14842            MOVE +1.0            TO REIN-FACTOR
 14843        ELSE
 14844           IF DTE-CLIENT = 'DCC'
 14845              COMPUTE REIN-FACTOR =
 14846                 CR-AHRFND / CR-AHPRM
 14847           ELSE
 14848              COMPUTE REIN-FACTOR ROUNDED =
 14849                                CR-AHRFND-CALC / CR-AHPRM
 14850           END-IF
 14851        END-IF
 14852     END-IF
 14853
 14854     IF CR-AHAMT NOT = ZERO
 14855        IF (DTE-CLIENT = 'DCC')
 14856           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14857           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14858        ELSE
 14859           IF WT-AH-QC = ('1' OR '4')
 14860              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14861              compute rwf-ahrfnd rounded =
 14862                 cr-ahrfnd * rein-factor
 14863           ELSE
 14864              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14865              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14866                       RWF-AHAMT) / CR-AHAMT
 14867           END-IF
 14868        END-IF
 14869     ELSE
 14870        IF RWF-AH-LIMIT = ZERO
 14871           IF WT-AH-QC = ('1' OR '4')
 14872              COMPUTE RWF-AHRFND ROUNDED =
 14873                       CR-AHRFND * WT-AH-PCT
 14874           ELSE
 14875              COMPUTE RWF-AHRFND =
 14876                            REIN-FACTOR * REIN-CALCED-AH
 14877              COMPUTE RWF-AHRFND ROUNDED =
 14878                       RWF-AHRFND * WT-AH-PCT
 14879           END-IF
 14880        END-IF
 14881     END-IF
 14882
 14883     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14884                                                                  ECSRIRTN
 14885                                                                  ECSRIRTN
 14886 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14887                                                                  ECSRIRTN
 14888     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14889       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14890         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14891         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14892                                                                  ECSRIRTN
 14893     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14894       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14895           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14896           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14897       ELSE                                                       ECSRIRTN
 14898           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 287
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14899               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14900                                                                  ECSRIRTN
 14901     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14902         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 14903         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14904                                                                  ECSRIRTN
 14905     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14906         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14907         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14908                                                                  ECSRIRTN
 14909     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14910     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14911     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14912                                    RW-AHRFND.                    ECSRIRTN
 14913                                                                  ECSRIRTN
 14914 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14915                                                                  ECSRIRTN
 14916     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14917                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14918                                                                  ECSRIRTN
 14919     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14920                                                                  ECSRIRTN
 14921     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14922        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14923         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14924     ELSE                                                         ECSRIRTN
 14925         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14926         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14927                                                                  ECSRIRTN
 14928                                                                  ECSRIRTN
 14929 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14930                                                                  ECSRIRTN
 14931     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14932         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14933                                                                  ECSRIRTN
 14934     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14935         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14936                                                                  ECSRIRTN
 14937     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14938                                                                  ECSRIRTN
 14939 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14940                                                                  ECSRIRTN
 14941     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14942     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14943                                                                  ECSRIRTN
 14944     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14945         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14946             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14947                                                                  ECSRIRTN
 14948     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14949         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14950                                                                  ECSRIRTN
 14951     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14952         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14953                                                                  ECSRIRTN
 14954 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14955                                                                  ECSRIRTN
 14956     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 288
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14957         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14958                                                                  ECSRIRTN
 14959     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14960                                                                  ECSRIRTN
 14961 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14962                                                                  ECSRIRTN
 14963     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14964     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14965                                                                  ECSRIRTN
 14966 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14967     EXIT.                                                        ECSRIRTN
 14968                                                                  ECSRIRTN
 14969 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14970                                                                  ECSRIRTN
 14971     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14972         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14973                                                                  ECSRIRTN
 14974 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14975     EXIT.                                                        ECSRIRTN
 14976                                                                  ECSRIRTN
 14977 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14978                                                                  ECSRIRTN
 14979     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14980     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14981                                                                  ECSRIRTN
 14982     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14983         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14984                                                                  ECSRIRTN
 14985     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14986        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14987          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14988          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14989          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14990                                                                  ECSRIRTN
 14991     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14992        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14993          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14994                                                                  ECSRIRTN
 14995     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14996                                  RWF-AHCLML.                     ECSRIRTN
 14997                                                                  ECSRIRTN
 14998     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14999         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15000                                                                  ECSRIRTN
 15001     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 15002         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15003                                                                  ECSRIRTN
 15004     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15005         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15006             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 15007                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15008                                                                  ECSRIRTN
 15009     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 15010         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15011                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15012                                                                  ECSRIRTN
 15013     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15014         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 289
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15015                                                                  ECSRIRTN
 15016     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15017         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15018             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 15019                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15020             ELSE                                                 ECSRIRTN
 15021                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 15022         ELSE                                                     ECSRIRTN
 15023             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 15024                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 15025                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15026             ELSE                                                 ECSRIRTN
 15027                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 15028                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 15029                                                                  ECSRIRTN
 15030     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15031         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15032                                                                  ECSRIRTN
 15033     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 15034         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 15035            OR 'DCC'
 15036             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 15037                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 15038         ELSE                                                     ECSRIRTN
 15039             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 15040                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 15041                                                                  ECSRIRTN
 15042     IF CR-LFAMT = ZERO                                           ECSRIRTN
 15043         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 15044             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15045                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 15046                                                                  ECSRIRTN
 15047     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15048         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15049             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15050                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 15051                                                                  ECSRIRTN
 15052     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15053         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15054             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15055               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 15056                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15057                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15058                  ELSE                                            ECSRIRTN
 15059                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15060                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15061              ELSE                                                ECSRIRTN
 15062                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15063                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15064                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15065                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15066                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15067                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15068                                                                  ECSRIRTN
 15069     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15070                                                                  ECSRIRTN
 15071     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15072                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 290
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15073                                                                  ECSRIRTN
 15074 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15075                                                                  ECSRIRTN
 15076     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 15077         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15078                                                                  ECSRIRTN
 15079     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15080         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15081     ELSE                                                         ECSRIRTN
 15082         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15083                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15084                                                                  ECSRIRTN
 15085     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15086         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15087                                                                  ECSRIRTN
 15088     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15089         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15090             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15091         ELSE                                                     ECSRIRTN
 15092             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15093     ELSE                                                         ECSRIRTN
 15094         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15095             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15096             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15097         ELSE                                                     ECSRIRTN
 15098             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15099             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15100                                                                  ECSRIRTN
 15101                                                                  ECSRIRTN
 15102 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15103                                                                  ECSRIRTN
 15104     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15105         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15106                                                                  ECSRIRTN
 15107     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15108         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15109                                                                  ECSRIRTN
 15110     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15111         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15112                                                                  ECSRIRTN
 15113     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15114     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15115                                                                  ECSRIRTN
 15116     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15117             VARYING                                              ECSRIRTN
 15118         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15119             UNTIL                                                ECSRIRTN
 15120         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15121                                                                  ECSRIRTN
 15122     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15123         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15124     ELSE                                                         ECSRIRTN
 15125         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15126                                                                  ECSRIRTN
 15127 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15128                                                                  ECSRIRTN
 15129     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15130         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 291
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15131                                                                  ECSRIRTN
 15132     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15133       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15134           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 15135                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15136               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15137                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15138               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15139                                                                  ECSRIRTN
 15140     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15141       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15142           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15143                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15144           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15145                                                                  ECSRIRTN
 15146     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15147         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15148                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15149                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15150         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15151                                                                  ECSRIRTN
 15152     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15153         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15154                                                                  ECSRIRTN
 15155     IF INC-SUB = +1                                              ECSRIRTN
 15156         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15157     IF INC-SUB = +2                                              ECSRIRTN
 15158         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15159     IF INC-SUB = +3                                              ECSRIRTN
 15160         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15161     IF INC-SUB = +4                                              ECSRIRTN
 15162         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15163     IF INC-SUB = +5                                              ECSRIRTN
 15164         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15165                                                                  ECSRIRTN
 15166     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15167                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15168                                                                  ECSRIRTN
 15169     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15170         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15171                                                                  ECSRIRTN
 15172     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15173              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15174         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15175     ELSE                                                         ECSRIRTN
 15176         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15177                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15178                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15179                                                                  ECSRIRTN
 15180 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15181      EXIT.                                                       ECSRIRTN
 15182                                                                  ECSRIRTN
 15183 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15184                                                                  ECSRIRTN
 15185     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15186         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15187                                                                  ECSRIRTN
 15188     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 292
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15189         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15190             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15191                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15192                                                                  ECSRIRTN
 15193     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15194         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15195             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15196                                                                  ECSRIRTN
 15197 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15198                                                                  ECSRIRTN
 15199     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15200         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15201         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15202             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15203                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15204         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15205         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15206                                                                  ECSRIRTN
 15207     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15208         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15209                                                                  ECSRIRTN
 15210     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15211         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15212             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15213                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15214             ELSE                                                 ECSRIRTN
 15215                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15216         ELSE                                                     ECSRIRTN
 15217             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15218                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15219                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15220             ELSE                                                 ECSRIRTN
 15221                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15222                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15223                                                                  ECSRIRTN
 15224     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15225         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15226                                                                  ECSRIRTN
 15227     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15228         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15229                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15230     ELSE                                                         ECSRIRTN
 15231         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15232             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15233                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15234                                                                  ECSRIRTN
 15235     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15236         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15237             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15238                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15239                                                                  ECSRIRTN
 15240     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15241         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15242             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15243               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15244                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15245                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15246                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 293
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15247                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15248                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15249              ELSE                                                ECSRIRTN
 15250                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 15251                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15252                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15253                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15254                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15255                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15256                                                                  ECSRIRTN
 15257                                                                  ECSRIRTN
 15258     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15259        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15260                               '220000' OR '230000')              ECSRIRTN
 15261           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15262               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15263                                                                  ECSRIRTN
 15264     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15265                                                                  ECSRIRTN
 15266     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15267                                                                  ECSRIRTN
 15268                                                                  ECSRIRTN
 15269 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15270                                                                  ECSRIRTN
 15271     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15272         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15273                                                                  ECSRIRTN
 15274     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15275         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15276         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15277                                                                  ECSRIRTN
 15278     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15279                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15280                                                                  ECSRIRTN
 15281     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15282         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15283                                                                  ECSRIRTN
 15284     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15285         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15286                                                                  ECSRIRTN
 15287     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15288                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15289         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15290                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15291         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15292     ELSE                                                         ECSRIRTN
 15293         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15294         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15295                                                                  ECSRIRTN
 15296                                                                  ECSRIRTN
 15297 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15298                                                                  ECSRIRTN
 15299     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15300         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15301                                                                  ECSRIRTN
 15302     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15303         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15304                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 294
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15305     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15306                                                                  ECSRIRTN
 15307 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15308                                                                  ECSRIRTN
 15309     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15310     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15311                                                                  ECSRIRTN
 15312     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15313         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15314             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15315                                                                  ECSRIRTN
 15316     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15317     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15318                                                                  ECSRIRTN
 15319     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15320         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15321                                                                  ECSRIRTN
 15322     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15323         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15324                                                                  ECSRIRTN
 15325 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15326                                                                  ECSRIRTN
 15327     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15328         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15329                                                                  ECSRIRTN
 15330     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15331                                                                  ECSRIRTN
 15332 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15333                                                                  ECSRIRTN
 15334     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15335     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15336                                                                  ECSRIRTN
 15337 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15338     EXIT.                                                        ECSRIRTN
 15339                                                                  ECSRIRTN
 15340 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15341                                                                  ECSRIRTN
 15342     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15343         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15344                                                                  ECSRIRTN
 15345 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15346     EXIT.                                                        ECSRIRTN
 15347                                                                  ECSRIRTN
 15348                                                                  ECSRIRTN
 15349 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15350                                                                  ECSRIRTN
 15351     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15352     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15353     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15354     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15355                                                                  ECSRIRTN
 15356     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15357         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15358         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15359         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15360         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15361         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15362         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 295
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15363         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15364         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15365         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15366                                                                  ECSRIRTN
 15367     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15368         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15369                                                                  ECSRIRTN
 15370     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15371                                                                  ECSRIRTN
 15372 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15373                                                                  ECSRIRTN
 15374     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15375                                                                  ECSRIRTN
 15376 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15377     EXIT.                                                        ECSRIRTN
 15378                                                                  ECSRIRTN
 15379 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15380                                                                  ECSRIRTN
 15381     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15382                                                                  ECSRIRTN
 15383     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15384         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15385                                                                  ECSRIRTN
 15386     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15387         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15388             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15389                                                                  ECSRIRTN
 15390     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15391         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15392         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15393         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15394     ELSE                                                         ECSRIRTN
 15395         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15396         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15397         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15398                                                                  ECSRIRTN
 15399     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15400                                                                  ECSRIRTN
 15401     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15402        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15403         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15404                                                                  ECSRIRTN
 15405     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15406         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15407                                                                  ECSRIRTN
 15408 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15409     EXIT.                                                        ECSRIRTN
 15410                                                                  ECSRIRTN
 15411 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15412                                                                  ECSRIRTN
 15413     CONTINUE.                                                    ECSRIRTN
 15414*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15415 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15416     EXIT.                                                        ECSRIRTN
 15417                                                                  ECSRIRTN
 15418 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15419                                                                  ECSRIRTN
 15420     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 296
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15421         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15422                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15423                                                                  ECSRIRTN
 15424     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 15425         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15426                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15427                                                                  ECSRIRTN
 15428     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15429                                                                  ECSRIRTN
 15430     START ERRTBL-IN                                              ECSRIRTN
 15431           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15432             INVALID KEY                                          ECSRIRTN
 15433               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15434                                                                  ECSRIRTN
 15435     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15436     MOVE 0 TO SUB1.                                              ECSRIRTN
 15437 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15438                                                                  ECSRIRTN
 15439     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15440                                                                  ECSRIRTN
 15441     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15442        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15443                                                                  ECSRIRTN
 15444     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15445        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15446        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15447                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15448        GO TO ABEND-PGM.                                          ECSRIRTN
 15449                                                                  ECSRIRTN
 15450     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15451        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15452                                                                  ECSRIRTN
 15453     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15454        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15455                                                                  ECSRIRTN
 15456     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15457        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15458                                                                  ECSRIRTN
 15459     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15460        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15461                                                                  ECSRIRTN
 15462     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15463        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15464                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15465        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 296)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15466                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15467        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 296)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15468                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15469     END-PERFORM.                                                 ECSRIRTN
 15470     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15471                                                                  ECSRIRTN
 15472     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 297
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15473        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15474                                                                  ECSRIRTN
 15475     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15476        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 15477                                                                  ECSRIRTN
 15478     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15479        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15480                                                                  ECSRIRTN
 15481     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15482        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15483                                                                  ECSRIRTN
 15484     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15485        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15486        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15487        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15488        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15489        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15490        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15491          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15492                                                                  ECSRIRTN
 15493     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15494                                                                  ECSRIRTN
 15495     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15496        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15497        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15498        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15499        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15500                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15501        GO TO ABEND-PGM.                                          ECSRIRTN
 15502                                                                  ECSRIRTN
 15503     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15504                                                                  ECSRIRTN
 15505     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15506                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15507     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15508                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15509     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15510                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15511                                                                  ECSRIRTN
 15512     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15513         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15514     ELSE                                                         ECSRIRTN
 15515         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15516                                                                  ECSRIRTN
 15517     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15518     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15519     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15520     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15521                                                                  ECSRIRTN
 15522 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15523                                                                  ECSRIRTN
 15524     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15525        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15526                                                                  ECSRIRTN
 15527     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15528        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15529                                                                  ECSRIRTN
 15530     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 298
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15531        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15532                                                                  ECSRIRTN
 15533     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15534        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 15535                                                                  ECSRIRTN
 15536     ADD +1 TO SUB1.                                              ECSRIRTN
 15537                                                                  ECSRIRTN
 15538     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15539        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15540        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15541                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15542        GO TO ABEND-PGM.                                          ECSRIRTN
 15543                                                                  ECSRIRTN
 15544     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15545     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15546     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15547     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15548     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15549     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15550     if re-state-exhibit-opt-f = 'Y'
 15551        move 'Y'         to rc2-ecs152-rpt (sub1)
 15552     else
 15553        move 'N'         to rc2-ecs152-rpt (sub1)
 15554     end-if
 15555                                                                  ECSRIRTN
 15556     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15557                                                                  ECSRIRTN
 15558 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15559     EXIT.                                                        ECSRIRTN
 15560                                                                  ECSRIRTN
 15561 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15562                                                                  ECSRIRTN
 15563     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15564                                                                  ECSRIRTN
 15565     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15566                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15567                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15568                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15569                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15570                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15571                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15572                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15573                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15574                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15575                                                                  ECSRIRTN
 15576 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15577     EXIT.                                                        ECSRIRTN
 15578                                                                  ECSRIRTN
 15579 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15580                                                                  ECSRIRTN
 15581     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15582                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15583     move spaces      to rc2-ecs152-rpt (co-sub)
 15584                                                                  ECSRIRTN
 15585     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15586                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15587                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15588                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 299
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15589                                                                  ECSRIRTN
 15590 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15591     EXIT.                                                        ECSRIRTN
 15592******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 300
* ECS010.cbl
 15594******************************************************************
 15595***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15596******************************************************************
 15597
 15598 3600-RC-REINSURANCE.
 15599
 15600     IF DTE-PGM-OPT NOT = '1'
 15601         GO TO 3799-RC-REINSURANCE-X.
 15602
 15603     IF DTE-CLIENT = 'WSL'
 15604         IF CR-REIN-TABLE = '00A'
 15605             GO TO 3799-RC-REINSURANCE-X.
 15606
 15607     IF CR-REIN-TABLE = SPACES OR ZEROS
 15608         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15609
 15610 3610-CLEAR-RC-REIN.
 15611
 15612     MOVE SPACES TO RC-REIN-LEVELS (1).
 15613     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15614                    RC-REIN-LFPRM (1)
 15615                    RC-REIN-AHAMT (1)
 15616                    RC-REIN-AHPRM (1)
 15617                    RC-REIN-LFRFND (1)
 15618                    RC-REIN-AHRFND (1)
 15619                    RC-REIN-LFCLM (1)
 15620                    RC-REIN-AHCLM (1).
 15621
 15622     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15623         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15624
 15625     MOVE +1 TO SUB1.
 15626     MOVE +0 TO SUB2.
 15627
 15628     GO TO 3630-RC-REIN-LOOP-1.
 15629
 15630 3620-CLEAR-RC-LEVELS.
 15631
 15632     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15633
 15634
 15635 3630-RC-REIN-LOOP-1.
 15636
 15637     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15638         ADD +1 TO SUB2
 15639         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15640         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15641         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15642         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15643         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15644         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15645         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15646         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15647         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15648         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15649
 15650     ADD +1 TO SUB1.
 15651     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 301
* ECS010.cbl
 15652         GO TO 3630-RC-REIN-LOOP-1.
 15653
 15654     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15655
 15656     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15657     IF CR-REIN-TABLE = SPACES OR ZEROS
 15658         MOVE +1                     TO SUB1
 15659         GO TO 3710-RC-REIN-LOOP-2.
 15660
 15661     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15662
 15663 3640-NSP-REIN-RATING-ROUTINE.
 15664
 15665     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15666     MOVE 'L'                        TO DC-OPTION-CODE.
 15667     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15668     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15669     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15670     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15671     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15672     MOVE CR-APR                     TO CP-LOAN-APR.
 15673     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15674     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15675     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15676     MOVE ZEROS                      TO CP-CLASS-CODE.
 15677
 15678     IF DTE-CLIENT = 'TIC'
 15679        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15680            MOVE ZERO                TO CP-CLASS-CODE
 15681        ELSE
 15682            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15683
 15684     MOVE '3'                        TO CP-PROCESS-TYPE.
 15685     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15686     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15687
 15688 3650-NSP-REIN-LIFE.
 15689
 15690     IF CR-LFTYP = ZERO
 15691         GO TO 3660-NSP-REIN-AH.
 15692     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15693        OR (DTE-CLIENT = 'DCC')
 15694         GO TO 3660-NSP-REIN-AH.
 15695     IF DTE-CLIENT NOT = 'LBL'
 15696         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15697             GO TO 3660-NSP-REIN-AH.
 15698
 15699     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15700         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15701         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15702
 15703     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15704     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15705     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15706                                        CP-RATING-BENEFIT-AMT.
 15707     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15708     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15709     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 302
* ECS010.cbl
 15710     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15711     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15712     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15713     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15714
 15715     IF CP-STATE-STD-ABBRV = 'OR'
 15716         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15717
 15718     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15719
 15720     IF CP-ERROR-RATE-NOT-FOUND  OR
 15721        CP-ERROR-RATE-IS-ZERO
 15722         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15723                                     TO WS-ABEND-MESSAGE
 15724         MOVE 0302                   TO WS-ABEND-CODE
 15725         DISPLAY '******************************'
 15726         DISPLAY '***** ERROR LOCATION 018 *****'
 15727         DISPLAY '******************************'
 15728         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15729         GO TO ABEND-PGM.
 15730
 15731     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15732
 15733*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15734*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15735
 15736     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15737                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15738
 15739     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15740
 15741 3660-NSP-REIN-AH.
 15742
 15743     IF CR-AHTYP = ZERO
 15744         GO TO 3669-NSP-REIN-X.
 15745     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15746        OR (DTE-CLIENT = 'DCC')
 15747         GO TO 3669-NSP-REIN-X.
 15748     IF DTE-CLIENT NOT = 'LBL'
 15749         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15750             GO TO 3669-NSP-REIN-X.
 15751
 15752     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15753         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15754         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15755
 15756     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15757     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15758     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15759                                        CP-RATING-BENEFIT-AMT.
 15760     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15761     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15762     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15763     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15764     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15765     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15766     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15767
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 303
* ECS010.cbl
 15768     IF CP-STATE-STD-ABBRV = 'OR'
 15769         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15770
 15771     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15772
 15773     IF CP-ERROR-RATE-NOT-FOUND  OR
 15774        CP-ERROR-RATE-IS-ZERO
 15775         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15776                                     TO WS-ABEND-MESSAGE
 15777         MOVE 0302                   TO WS-ABEND-CODE
 15778         DISPLAY '******************************'
 15779         DISPLAY '***** ERROR LOCATION 019 *****'
 15780         DISPLAY '******************************'
 15781         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15782         GO TO ABEND-PGM.
 15783
 15784     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15785             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15786
 15787     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15788
 15789 3669-NSP-REIN-X.
 15790     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 304
* ECS010.cbl
 15792******************************************************************
 15793***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15794******************************************************************
 15795
 15796 3700-RC-REIN-PERF-CALC.
 15797
*15798                             COPY ECSRTPFM.
 15799******************************************************************07/10/97
 15800*                                                                *ECSRTPFM
 15801*                            ECSRTPFM                            *   LV001
 15802*                            VMOD=2.002                          *ECSRTPFM
 15803*                                                                *ECSRTPFM
 15804******************************************************************ECSRTPFM
 15805                                                                  ECSRTPFM
 15806     IF    CR-LFAMT  NUMERIC                                      00000072
 15807           NEXT SENTENCE                                          00000073
 15808        ELSE                                                      00000074
 15809           MOVE ZEROS TO CR-LFAMT.                                00000075
 15810                                                                  00000076
 15811     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15812           NEXT SENTENCE                                          00000078
 15813        ELSE                                                      00000079
 15814           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15815                                                                  00000081
 15816                                                                  00000082
 15817     IF    CR-LFPRM  NUMERIC                                      00000083
 15818           NEXT SENTENCE                                          00000084
 15819        ELSE                                                      00000085
 15820           MOVE ZEROS TO CR-LFPRM.                                00000086
 15821                                                                  00000087
 15822     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15823           NEXT SENTENCE                                          00000089
 15824        ELSE                                                      00000090
 15825           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15826                                                                  00000092
 15827                                                                  00000093
 15828     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15829           NEXT SENTENCE                                          00000095
 15830        ELSE                                                      00000096
 15831           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15832                                                                  00000098
 15833     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15834           NEXT SENTENCE                                          00000100
 15835        ELSE                                                      00000101
 15836           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15837                                                                  00000103
 15838     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15839           NEXT SENTENCE                                          00000105
 15840        ELSE                                                      00000106
 15841           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15842                                                                  00000108
 15843     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15844     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15845     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15846         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15847     ELSE                                                         ECSRTPFM
 15848         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15849     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 305
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15850                                                                  ECSRTPFM
 15851     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15852     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15853     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15854         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15855     ELSE                                                         ECSRTPFM
 15856         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15857     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15858                                                                  ECSRTPFM
 15859     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15860         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15861             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15862                                                                  ECSRTPFM
 15863
 15864     IF CR-STATE NOT = STATE-L
 15865         MOVE CR-STATE               TO STATE-L
 15866         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15867
 15868     MOVE 'X'                     TO REIN-RT-SW.
 15869     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15870     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15871     MOVE ' '                     TO REIN-RT-SW.
 15872
 15873 3710-RC-REIN-LOOP-2.
 15874
 15875     IF REIN-COMP (SUB1) = SPACES
 15876         GO TO 3730-RC-REIN-EXTRACTS.
 15877
 15878     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15879        ADD +1 TO SUB1
 15880         GO TO 3710-RC-REIN-LOOP-2.
 15881
 15882     MOVE +1 TO SUB2.
 15883
 15884 3720-RC-REIN-LOOP-3.
 15885
 15886     IF RC-REIN-COMP (SUB2) = SPACES
 15887         ADD +1 TO SUB1
 15888         GO TO 3710-RC-REIN-LOOP-2.
 15889
 15890     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15891         ADD +1 TO SUB2
 15892         GO TO 3720-RC-REIN-LOOP-3.
 15893
 15894     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15895        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15896        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15897        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15898         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15899         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15900
 15901     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15902        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15903         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15904         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15905
 15906     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15907         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 306
* ECS010.cbl
 15908         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15909
 15910     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15911         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15912         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15913
 15914     ADD +1 TO SUB2.
 15915     GO TO 3720-RC-REIN-LOOP-3.
 15916
 15917 3730-RC-REIN-EXTRACTS.
 15918
 15919     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15920     MOVE 'R' TO DE-REIN.
 15921     MOVE 'J' TO DE-TRANS.
 15922*****PERFORM EXTRACT-DATE-RELOAD.
 15923     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15924     MOVE +1 TO SUB1.
 15925
 15926 3740-RC-REIN-OLD-ISSUE.
 15927
 15928     IF RC-REIN-COMP (SUB1) = SPACES
 15929         MOVE +1 TO SUB1
 15930         GO TO 3745-RC-REIN-NEW-ISSUE.
 15931
 15932     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15933         ADD +1 TO SUB1
 15934         GO TO 3740-RC-REIN-OLD-ISSUE.
 15935
 15936     IF RC-OLD-ISS (SUB1) = 'X'
 15937         ADD +1 TO SUB1
 15938         GO TO 3740-RC-REIN-OLD-ISSUE.
 15939
 15940     IF RC-REIN-LFAMT (SUB1) = ZERO
 15941        AND RC-REIN-LFPRM (SUB1) = ZERO
 15942        AND RC-REIN-AHAMT (SUB1) = ZERO
 15943        AND RC-REIN-AHPRM (SUB1) = ZERO
 15944         ADD +1 TO SUB1
 15945         GO TO 3740-RC-REIN-OLD-ISSUE.
 15946
 15947     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15948     PERFORM EXTRACT-DATE-LOAD.
 15949     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15950     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15951     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15952     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15953     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15954     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15955
 15956     ADD +1 TO BC-R-ISS.
 15957     ADD +1 TO SUB1.
 15958     GO TO 3740-RC-REIN-OLD-ISSUE.
 15959
 15960 3745-RC-REIN-NEW-ISSUE.
 15961
 15962     IF REIN-COMP (SUB1) = SPACES
 15963         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15964                                         2259-END-CANCEL-BUILD
 15965         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 307
* ECS010.cbl
 15966         MOVE 'K'      TO DE-TRANS
 15967*********PERFORM EXTRACT-DATE-RELOAD
 15968         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15969         MOVE +1       TO SUB1
 15970         GO TO 3750-RC-REIN-OLD-CANCEL.
 15971
 15972     IF REIN-REM-SW (SUB1) = 'Z'
 15973         ADD +1 TO SUB1
 15974         GO TO 3745-RC-REIN-NEW-ISSUE.
 15975
 15976     IF RC-NEW-ISS (SUB1) = 'X'
 15977         ADD +1 TO SUB1
 15978         GO TO 3745-RC-REIN-NEW-ISSUE.
 15979
 15980     IF REIN-LFAMT (SUB1) = ZERO
 15981        AND REIN-LFPRM (SUB1) = ZERO
 15982        AND REIN-AHAMT (SUB1) = ZERO
 15983        AND REIN-AHPRM (SUB1) = ZERO
 15984         ADD +1 TO SUB1
 15985         GO TO 3745-RC-REIN-NEW-ISSUE.
 15986
 15987     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15988     PERFORM EXTRACT-DATE-LOAD.
 15989     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15990     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15991     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15992     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15993     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15994     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15995
 15996     ADD +1 TO BC-R-ISS.
 15997     ADD +1 TO SUB1.
 15998     GO TO 3745-RC-REIN-NEW-ISSUE.
 15999
 16000 3750-RC-REIN-OLD-CANCEL.
 16001
 16002     IF RC-REIN-COMP (SUB1) = SPACES
 16003         MOVE +1 TO SUB1
 16004         GO TO 3755-RC-REIN-NEW-CANCEL.
 16005
 16006     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16007         ADD +1 TO SUB1
 16008         GO TO 3750-RC-REIN-OLD-CANCEL.
 16009
 16010     IF RC-OLD-CNC (SUB1) = 'X'
 16011         ADD +1 TO SUB1
 16012         GO TO 3750-RC-REIN-OLD-CANCEL.
 16013
 16014     IF RC-REIN-LFRFND (SUB1) = ZERO
 16015        AND RC-REIN-AHRFND (SUB1) = ZERO
 16016         ADD +1 TO SUB1
 16017         GO TO 3750-RC-REIN-OLD-CANCEL.
 16018
 16019     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 16020     PERFORM EXTRACT-DATE-LOAD.
 16021     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 16022     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 16023     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 308
* ECS010.cbl
 16024     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16025
 16026     ADD +1 TO BC-R-CNC.
 16027     ADD +1 TO SUB1.
 16028     GO TO 3750-RC-REIN-OLD-CANCEL.
 16029
 16030 3755-RC-REIN-NEW-CANCEL.
 16031
 16032     IF REIN-COMP (SUB1) = SPACES
 16033         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 16034         MOVE 'R' TO DE-REIN
 16035         MOVE 'L' TO DE-TRANS
 16036*********PERFORM EXTRACT-DATE-RELOAD
 16037         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16038         MOVE +1 TO SUB1
 16039         GO TO 3760-RC-REIN-OLD-CLAIM.
 16040
 16041     IF REIN-REM-SW (SUB1) = 'Z'
 16042         ADD +1 TO SUB1
 16043         GO TO 3755-RC-REIN-NEW-CANCEL.
 16044
 16045     IF RC-NEW-CNC (SUB1) = 'X'
 16046         ADD +1 TO SUB1
 16047         GO TO 3755-RC-REIN-NEW-CANCEL.
 16048
 16049     IF REIN-LFRFND (SUB1) = ZERO
 16050        AND REIN-AHRFND (SUB1) = ZERO
 16051         ADD +1 TO SUB1
 16052         GO TO 3755-RC-REIN-NEW-CANCEL.
 16053
 16054     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 16055     PERFORM EXTRACT-DATE-LOAD.
 16056     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 16057     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 16058     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 16059     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16060
 16061     ADD +1 TO BC-R-CNC.
 16062     ADD +1 TO SUB1.
 16063     GO TO 3755-RC-REIN-NEW-CANCEL.
 16064
 16065 3760-RC-REIN-OLD-CLAIM.
 16066
 16067     IF RC-REIN-COMP (SUB1) = SPACES
 16068         MOVE +1 TO SUB1
 16069         GO TO 3780-RC-REIN-NEW-CLAIM.
 16070
 16071     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16072         ADD +1 TO SUB1
 16073         GO TO 3760-RC-REIN-OLD-CLAIM.
 16074
 16075     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16076         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16077
 16078     IF RC-REIN-LFCLM (SUB1) = ZERO
 16079         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16080
 16081     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 309
* ECS010.cbl
 16082     PERFORM EXTRACT-DATE-LOAD.
 16083     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16084     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16085     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16086     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16087     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16088     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16089     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16090     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16091     MOVE CR-DTH-PAY-DT TO DE-PAY
 16092                           WS-DE-PAY-N.
 16093
 16094     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16095         MOVE '3' TO DE-TYPE
 16096     ELSE
 16097         MOVE '1' TO DE-TYPE.
 16098
 16099     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16100
 16101     ADD +1 TO BC-R-CLM.
 16102
 16103 3770-RC-REIN-OLD-AH-CLM.
 16104
 16105     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16106         ADD +1 TO SUB1
 16107         GO TO 3760-RC-REIN-OLD-CLAIM.
 16108
 16109     IF RC-REIN-AHCLM (SUB1) = ZERO
 16110         ADD +1 TO SUB1
 16111         GO TO 3760-RC-REIN-OLD-CLAIM.
 16112
 16113     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16114     PERFORM EXTRACT-DATE-LOAD.
 16115     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16116     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16117     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16118     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16119     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16120     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16121     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16122     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16123     MOVE CR-DIS-PAY-DT TO DE-PAY
 16124                           WS-DE-PAY-N.
 16125
 16126     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16127         MOVE '4' TO DE-TYPE
 16128     ELSE
 16129         MOVE '2' TO DE-TYPE.
 16130
 16131     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16132
 16133     ADD +1 TO BC-R-CLM.
 16134     ADD +1 TO SUB1.
 16135
 16136     GO TO 3760-RC-REIN-OLD-CLAIM.
 16137
 16138 3780-RC-REIN-NEW-CLAIM.
 16139
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 310
* ECS010.cbl
 16140     IF REIN-COMP (SUB1) = SPACES
 16141         GO TO 3799-RC-REINSURANCE-X.
 16142
 16143     IF REIN-REM-SW (SUB1) = 'Z'
 16144         ADD +1 TO SUB1
 16145         GO TO 3780-RC-REIN-NEW-CLAIM.
 16146
 16147     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16148         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16149
 16150     IF REIN-LFCLM (SUB1) = ZERO
 16151         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16152
 16153     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16154     PERFORM EXTRACT-DATE-LOAD.
 16155     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16156     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16157     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16158     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16159     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16160     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16161     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16162     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16163     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16164                               WS-DE-PAY-N.
 16165
 16166     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16167         MOVE '3' TO DE-TYPE
 16168     ELSE
 16169         MOVE '1' TO DE-TYPE.
 16170
 16171     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16172
 16173     ADD +1 TO BC-R-CLM.
 16174
 16175 3790-RC-REIN-NEW-AH-CLM.
 16176
 16177     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16178         ADD +1 TO SUB1
 16179         GO TO 3780-RC-REIN-NEW-CLAIM.
 16180
 16181     IF REIN-AHCLM (SUB1) = ZERO
 16182         ADD +1 TO SUB1
 16183         GO TO 3780-RC-REIN-NEW-CLAIM.
 16184
 16185     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16186     PERFORM EXTRACT-DATE-LOAD.
 16187     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16188     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16189     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16190     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16191     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16192     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16193     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16194     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16195     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16196                               WS-DE-PAY-N.
 16197
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 311
* ECS010.cbl
 16198     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16199         MOVE '4' TO DE-TYPE
 16200     ELSE
 16201         MOVE '2' TO DE-TYPE.
 16202
 16203     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16204
 16205     ADD +1 TO BC-R-CLM.
 16206     ADD +1 TO SUB1.
 16207
 16208     GO TO 3780-RC-REIN-NEW-CLAIM.
 16209
 16210 3799-RC-REINSURANCE-X.
 16211     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 312
* ECS010.cbl
 16213******************************************************************
 16214***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16215******************************************************************
 16216
 16217 4000-EP-BUMP-RTN.
 16218
 16219     IF AM-RECALC-COMM = ('Y' OR '1')
 16220        PERFORM 1600-RECALC-COMM-EXTR
 16221                                 THRU 1899-RECALC-COMM-EXTR-X
 16222        MOVE ' '                 TO RECALC-TYPE
 16223     END-IF
 16224
 16225     MOVE '1'    TO EP-FLG.
 16226     ADD +1      TO BC-G-CERTS.
 16227
 16228     MOVE CR-DT               TO HIGH-CERT.
 16229     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16230         MOVE CR-DT           TO LOW-CERT
 16231         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16232
 16233     IF CR-POLICY-IS-REIN-ONLY
 16234         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16235                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16236                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16237                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16238                              DTH-IBNR           DIS-IBNR
 16239                              DTH-PAYCUR         DIS-PAYCUR
 16240                              DTH-FUTRSV         DIS-FUTRSV
 16241         GO TO 4050-EP-DO-REINSURE.
 16242
 16243     MOVE CR-LFAMT       TO WE-LFAMT.
 16244     MOVE CR-LFPRM       TO WE-LFPRM.
 16245     IF CR-LFTYP NOT = ZEROS
 16246         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16247             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16248             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16249         ELSE
 16250             MOVE ZEROS               TO WE-LFAMT-ALT
 16251                                         WE-LFPRM-ALT.
 16252
 16253     MOVE SPACES         TO REIN-EP-FLG
 16254                            WE-REIN-CO.
 16255     MOVE CR-LFRFND      TO WE-LFRFND.
 16256     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16257     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16258     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16259     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16260     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16261     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16262     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16263
 16264     MOVE CR-AHPRM       TO WE-AHPRM.
 16265     MOVE CR-AHAMT       TO WE-AHAMT.
 16266     MOVE CR-AHRFND      TO WE-AHRFND.
 16267     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16268     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16269     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16270     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 313
* ECS010.cbl
 16271     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16272     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16273     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16274
 16275     IF CR-POLICY-IS-RESTORE  OR
 16276        CR-POLICY-IS-REISSUE
 16277        OR CR-POLICY-IS-MONTHLY
 16278         MOVE ZEROS      TO WE-LFPRM
 16279                            WE-LFPRM-ALT
 16280                            WE-AHPRM.
 16281
 16282     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16283                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16284                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16285                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16286                              DTH-IBNR           DIS-IBNR
 16287                              DTH-PAYCUR         DIS-PAYCUR
 16288                              DTH-FUTRSV         DIS-FUTRSV.
 16289
 16290*     DISPLAY ' B4 4100 '
 16291     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16292*     DISPLAY ' AFTER 4100 '
 16293
 16294     IF CR-POLICY-IS-DECLINED  OR
 16295        CR-POLICY-IS-VOID
 16296         GO TO 4099-EP-BUMP-RTN-X.
 16297
 16298 4050-EP-DO-REINSURE.
 16299
 16300     MOVE 'R' TO REIN-EP-FLG.
 16301     MOVE +1  TO SUB5.
 16302
 16303 4090-EP-DO-REINSURE-LOOP.
 16304
 16305*     DISPLAY ' 4090 '
 16306     IF REIN-COMP (SUB5) = SPACES
 16307         MOVE SPACE TO REIN-EP-FLG
 16308         GO TO 4099-EP-BUMP-RTN-X.
 16309
 16310     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16311        REIN-LF-AH-FLGS (SUB5) = SPACES
 16312         ADD +1 TO SUB5
 16313         GO TO 4090-EP-DO-REINSURE-LOOP.
 16314
 16315     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16316        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16317          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16318          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16319          (RCT-REIN-CO (CO-SUB) = SPACES).
 16320
 16321     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16322        (RCT-REIN-CO (CO-SUB) = SPACES)
 16323        MOVE ZERO TO CO-SUB.
 16324
 16325*     DISPLAY ' 4090 A '
 16326*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16327     ADD +1 TO BC-R-CERTS.
 16328     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 314
* ECS010.cbl
 16329     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16330     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16331
 16332     IF (DTE-CLIENT = 'DCC')
 16333        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16334*        DISPLAY ' B4 CEDE FACT '
 16335*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16336*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16337*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16338        COMPUTE WS-CEDE-FACT =
 16339           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16340*        DISPLAY ' AFTER CEDE FACT '
 16341        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16342           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16343                                     NOT = 'G' AND 'L')
 16344           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16345*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16346*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16347           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16348           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16349        END-IF
 16350     END-IF
 16351
 16352     MOVE RWF-LFPRM      TO WE-LFPRM.
 16353     MOVE RWF-LFAMT      TO WE-LFAMT.
 16354     MOVE RWF-LFRFND     TO WE-LFRFND.
 16355     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16356     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16357     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16358     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16359     MOVE +0             TO WE-LFAMT-ALT
 16360                            WE-LFPRM-ALT
 16361                            WE-DTHEXP
 16362                            WE-NUM-DTH-CLM.
 16363
 16364*     DISPLAY ' 4090 B '
 16365     IF (DTE-CLIENT EQUAL 'NSL') AND
 16366        (CR-REIN-TABLE EQUAL 'NAR')
 16367        CONTINUE
 16368     ELSE
 16369      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16370       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16371        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16372            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16373        COMPUTE WE-LFAMT ROUNDED EQUAL
 16374                           CR-LFAMT * WS-CEDE-FACT
 16375        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16376                           CR-LFAMT-ALT * WS-CEDE-FACT
 16377        IF (DTE-CLIENT = 'CID')
 16378           AND (CR-LF-NSP-PRM > +0)
 16379           AND (CR-ENTRY-DATE > 20031130)
 16380           AND (WT-LF-QC NOT = '1' AND '3')
 16381           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16382              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16383           MOVE +0            TO WE-LFPRM-ALT
 16384        ELSE
 16385          IF (DTE-CLIENT = 'CID')
 16386             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 315
* ECS010.cbl
 16387             AND (CR-ENTRY-DATE > 20030430)
 16388             AND (WT-LF-QC NOT = '1' AND '3')
 16389             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16390             MOVE +0            TO WE-LFPRM-ALT
 16391          ELSE
 16392             COMPUTE WE-LFPRM ROUNDED EQUAL
 16393                           CR-LFPRM * WS-CEDE-FACT
 16394             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16395                           CR-LFPRM-ALT * WS-CEDE-FACT
 16396          END-IF
 16397        END-IF
 16398        IF (DTE-CLIENT = 'CID')
 16399           AND (CR-LF-NSP-PRM > +0)
 16400           AND (CR-LFRFND-CALC > +0)
 16401           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16402           AND (WT-LF-QC NOT = '1' AND '4')
 16403           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16404              (CR-LFPRM + CR-LFPRM-ALT)
 16405           COMPUTE WE-LFRFND =
 16406              REIN-FACTOR * REIN-CALCED-LIFE
 16407           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16408              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16409*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16410*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16411*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16412        ELSE
 16413
 16414          IF (DTE-CLIENT = 'CID')
 16415           AND (CR-LF-NSP-PRM > +0)
 16416           AND (CR-LFRFND-CALC > +0)
 16417           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16418           AND (WT-LF-QC NOT = '1' AND '4')
 16419           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16420           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16421              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16422
 16423          END-IF
 16424        END-IF
 16425       ELSE
 16426         MOVE +0 TO WS-CEDE-FACT
 16427       END-IF
 16428      END-IF
 16429     END-IF
 16430
 16431*     DISPLAY ' 4090 C '
 16432     IF DTE-CLIENT = 'DCC'
 16433        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16434           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16435                                   NOT = 'G' AND 'L')
 16436           AND (CR-AHAMT NOT = ZEROS)
 16437*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16438           COMPUTE WS-CEDE-FACT =
 16439               RWF-AHAMT / CR-AHAMT
 16440           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16441*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16442*          / CR-AHPRM * CR-AHRFND
 16443           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16444           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 316
* ECS010.cbl
 16445        END-IF
 16446     END-IF
 16447
 16448     MOVE RWF-AHPRM      TO WE-AHPRM.
 16449
 16450     MOVE RWF-AHAMT      TO WE-AHAMT
 16451     MOVE RWF-AHRFND     TO WE-AHRFND.
 16452     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16453     MOVE +0             TO WE-DSPY-EXP
 16454                            WE-NUM-DIS-CLM.
 16455     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16456     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16457     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16458
 16459     IF  RWF-LF-RUNOFF-SW = 'N'
 16460             OR
 16461         RWF-AH-RUNOFF-SW = 'N'
 16462         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16463
 16464     IF  RWF-LF-RUNOFF-SW = 'N'
 16465         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16466     ELSE
 16467         MOVE 99999999             TO STOP-LF-DATE.
 16468
 16469     IF  RWF-AH-RUNOFF-SW = 'N'
 16470         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16471     ELSE
 16472         MOVE 99999999             TO STOP-AH-DATE.
 16473
 16474     IF CR-POLICY-IS-RESTORE  OR
 16475        CR-POLICY-IS-REISSUE
 16476        OR CR-POLICY-IS-MONTHLY
 16477         MOVE ZEROS      TO WE-LFPRM
 16478                            WE-LFPRM-ALT
 16479                            WE-AHPRM.
 16480
 16481*     DISPLAY ' B4 4100-EP-DO-LF '
 16482     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16483*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16484
 16485     IF CO-SUB NOT = ZERO
 16486       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16487         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16488             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16489
 16490     ADD +1 TO SUB5.
 16491     GO TO 4090-EP-DO-REINSURE-LOOP.
 16492
 16493 4099-EP-BUMP-RTN-X.
 16494     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 317
* ECS010.cbl
 16496******************************************************************
 16497***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16498******************************************************************
 16499
 16500 4100-EP-DO-LF.
 16501
 16502     MOVE +0                         TO ISS-BEN  EPR-R78
 16503                                        CNC-BEN  EPR-PRO
 16504                                        ISS-PRM  EPR-ST
 16505                                        ISS-PRMTAX
 16506                                        CNC-PRM  ACTIVE-COUNT.
 16507     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16508
 16509     IF CR-LFTYP = ZERO
 16510         GO TO 4200-EP-DO-AH.
 16511
 16512     IF REIN-EP-FLG = 'R'
 16513         IF REIN-LF-FLG (SUB5) = SPACE
 16514             GO TO 4200-EP-DO-AH.
 16515
 16516     IF CR-APR NOT NUMERIC
 16517         MOVE ZERO TO CR-APR.
 16518
 16519     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16520     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16521     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16522
 16523     IF CR-POLICY-IS-DECLINED  OR
 16524        CR-POLICY-IS-VOID
 16525         GO TO 4191-CONTINUE.
 16526
 16527     MOVE CR-LF-TERM             TO ORIG-TERM.
 16528     MOVE CLAS-INDEXL            TO W-NDX.
 16529
 16530     IF CR-DT GREATER EW-COV-DTE
 16531         MOVE CR-DT              TO EW-COV-DTE.
 16532
 16533     IF (NOT CR-POLICY-IS-RESTORE) AND
 16534        (NOT CR-POLICY-IS-REISSUE)
 16535        AND (NOT CR-POLICY-IS-MONTHLY)
 16536         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16537         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16538             ADD CR-LIVES TO EW-ISS-CNT
 16539             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16540                                    (ORIG-TERM * CR-LIVES)
 16541             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16542             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16543             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16544                                   (ORIG-TERM * ISS-BEN)
 16545         ELSE
 16546             IF (DTE-CLIENT = 'DCC')
 16547                AND (CR-LFTYP = 'DD')
 16548                CONTINUE
 16549             ELSE
 16550                ADD +1 TO EW-ISS-CNT
 16551             END-IF
 16552             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16553             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 318
* ECS010.cbl
 16554             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16555             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16556                                   (ORIG-TERM * ISS-BEN).
 16557
 16558     MOVE RUN-DATE        TO VALUATION-DT.
 16559     MOVE '2'             TO W-VAL-SOURCE.
 16560
 16561     IF REIN-EP-FLG = 'R'
 16562         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16563            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16564             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16565             MOVE '10'              TO W-VAL-SOURCE.
 16566
 16567     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16568
 16569     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16570        (REM-TRM3 GREATER ZERO)
 16571        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16572            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16573                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16574            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16575                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16576          ELSE
 16577            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16578            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16579
 16580     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16581
 16582     IF DTE-CLIENT = 'GIC'
 16583         IF REIN-EP-FLG NOT = 'R'  AND
 16584            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16585            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16586            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16587
 16588     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16589         GO TO 4105-EP-DO-LF-REIN-CHK.
 16590
 16591     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16592             AND
 16593         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16594             AND
 16595         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16596                 OR
 16597             CR-LF-CANC-DT EQUAL ZEROS)
 16598             AND
 16599         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16600                 OR
 16601             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16602         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16603         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16604                 VARYING
 16605             SUBM FROM +1 BY +1
 16606                 UNTIL
 16607             SUBM GREATER THAN +13.
 16608
 16609     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16610     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16611
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 319
* ECS010.cbl
 16612 4105-EP-DO-LF-REIN-CHK.
 16613
 16614     IF REIN-EP-FLG = 'R'  AND
 16615        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16616         NEXT SENTENCE
 16617     ELSE
 16618         GO TO 4110-EP-DO-LF-CLM.
 16619
 16620     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16621         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16622             GO TO 4130-EP-DO-LF-EP.
 16623
 16624     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16625         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16626             GO TO 4130-EP-DO-LF-EP.
 16627
 16628 4110-EP-DO-LF-CLM.
 16629
 16630     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16631         NEXT  SENTENCE
 16632       ELSE
 16633         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16634
 16635     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16636     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16637
 16638     IF CR-LF-STATUS-AT-DEATH = ' '
 16639         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16640             GO TO 4115-EP-DO-LF-CLM-EPR.
 16641
 16642     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16643     ADD +1             TO EW-CLM-CRT.
 16644
 16645 4115-EP-DO-LF-CLM-EPR.
 16646
 16647     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16648         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16649         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16650     END-IF
 16651     .
 16652 4120-EP-DO-LF-CNCL.
 16653
 16654     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16655        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16656         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16657             GO TO 4190-EP-DO-LF-COMM
 16658         ELSE
 16659             GO TO 4130-EP-DO-LF-EP.
 16660
 16661     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16662         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16663         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16664
 16665     IF CR-LFTYP NOT = 'DD'
 16666        ADD +1                    TO EW-CNC-CNT
 16667     END-IF
 16668
 16669     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 320
* ECS010.cbl
 16670
 16671     IF DTE-CLIENT = 'GIC'
 16672         IF REIN-EP-FLG NOT = 'R'  AND
 16673            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16674             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16675
 16676*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16677*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16678*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16679*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16680
 16681     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16682     MOVE 'L'                   TO  DC-OPTION-CODE.
 16683     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16684     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16685
 16686     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16687     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16688     MOVE '1'                     TO  DC-OPTION-CODE.
 16689     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16690     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16691     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16692                                      DC-ODD-DAYS-OVER
 16693                                      DC-ELAPSED-DAYS.
 16694     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16695     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16696
 16697     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16698         ADD  +1                  TO  MONTHS-DIFF-LF.
 16699
 16700     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16701
 16702     if (dte-client = 'AHL')
 16703        and (cr-lf-cancel-exit-date < 20120401)
 16704        go to 4120-continue-life-cancel
 16705     end-if
 16706
 16707     IF DTE-CLIENT = 'ACE'
 16708         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16709
 16710     MOVE  ZEROS                  TO  SUB.
 16711
 16712 4120-LIFE-CHARGEBACK-LOOP.
 16713
 16714     ADD    +1                    TO  SUB.
 16715
 16716     IF  SUB  GREATER THAN  +10
 16717         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16718
 16719     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16720         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16721         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16722
 16723     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16724         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16725
 16726     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16727         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 321
* ECS010.cbl
 16728
 16729     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16730
 16731
 16732 4120-CONTINUE-LIFE-CANCEL.
 16733
 16734     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16735     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16736
 16737     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16738         GO TO 4190-EP-DO-LF-COMM.
 16739
 16740     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16741         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16742         GO TO 4190-EP-DO-LF-COMM.
 16743
 16744     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16745     MOVE '3'           TO W-VAL-SOURCE.
 16746     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16747
 16748     IF REM-TRM3 = CR-LF-TERM
 16749         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16750         GO TO 4190-EP-DO-LF-COMM.
 16751
 16752     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16753         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16754
 16755     IF DTE-CLIENT = 'NCL'
 16756         IF CR-DT LESS THAN 19910101
 16757             GO TO 4121-EP-DO-LF-CNC-BEN.
 16758
 16759     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16760         GO TO 4126-EP-DO-LF-CNCL-NP.
 16761
 16762     IF DTE-CLIENT = 'FUL'
 16763         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16764
 16765*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16766     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16767        (CR-RATING-CLASS NOT = 'L ')
 16768         IF (CR-APR GREATER THAN ZERO)  AND
 16769            (CR-LF-TERM GREATER THAN 060)  AND
 16770            (CR-DT GREATER THAN 19831031)
 16771              GO TO 4126-EP-DO-LF-CNCL-NP.
 16772
 16773     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16774         IF (CR-APR GREATER THAN ZERO)  AND
 16775            (CR-LF-TERM GREATER THAN 061)  AND
 16776            (CR-DT GREATER THAN 19830318)
 16777              GO TO 4126-EP-DO-LF-CNCL-NP.
 16778
 16779     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16780         IF (CR-APR GREATER THAN ZERO)  AND
 16781            (CR-LF-TERM GREATER THAN 062)  AND
 16782            (CR-DT GREATER THAN 19810831)  AND
 16783            (CR-DT LESS THAN 19830901)
 16784              GO TO 4126-EP-DO-LF-CNCL-NP.
 16785
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 322
* ECS010.cbl
 16786     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16787         IF (CR-APR GREATER THAN ZERO)  AND
 16788            (CR-LF-TERM GREATER THAN 060)  AND
 16789            (CR-DT GREATER THAN 19831231)
 16790              GO TO 4126-EP-DO-LF-CNCL-NP.
 16791
 16792 4121-EP-DO-LF-CNC-BEN.
 16793
 16794     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16795
 16796     COMPUTE TEMP-3 ROUNDED EQUAL
 16797         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16798
 16799     MOVE TEMP-3                 TO CNC-BEN.
 16800
 16801     GO TO 4190-EP-DO-LF-COMM.
 16802
 16803 4122-EP-DO-LF-CNCL-TEX.
 16804
 16805     DIVIDE WE-LFAMT BY CR-LF-TERM
 16806         GIVING TEX-FACT-1.
 16807     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16808         GIVING TEX-FACT-2
 16809             REMAINDER TEX-FACT-3.
 16810     IF TEX-FACT-3 NOT = ZERO
 16811         ADD +1 TO TEX-FACT-2.
 16812
 16813     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16814
 16815     GO TO 4190-EP-DO-LF-COMM.
 16816
 16817 4124-EP-DO-LF-CNCL-SUM.
 16818
 16819     IF WE-LFRFND = ZERO
 16820         GO TO 4130-EP-DO-LF-EP.
 16821
 16822     MOVE WE-LFRFND TO CNC-PRM.
 16823
 16824     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16825
 16826     IF WE-LFRFND NOT LESS WE-LFPRM
 16827         MOVE WE-LFAMT TO CNC-BEN
 16828          GO TO 4130-EP-DO-LF-EP.
 16829
 16830
 16831     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16832
 16833     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16834         MOVE TEMP-7 TO CNC-BEN
 16835          GO TO 4130-EP-DO-LF-EP.
 16836
 16837     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16838     MOVE '4'           TO W-VAL-SOURCE.
 16839     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16840
 16841     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16842         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16843         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 323
* ECS010.cbl
 16844
 16845 4126-EP-DO-LF-CNCL-NP.
 16846
 16847     IF WE-LFAMT = ZERO
 16848        GO TO 4190-EP-DO-LF-COMM.
 16849
 16850     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16851     MOVE 'L'                        TO  DC-OPTION-CODE.
 16852     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16853     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16854
 16855     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16856       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16857       MOVE '3'                      TO  DC-OPTION-CODE
 16858       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16859       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16860     ELSE
 16861       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16862       MOVE '6'                      TO  DC-OPTION-CODE
 16863       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16864       MOVE +0                       TO  DC-ELAPSED-DAYS
 16865       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16866       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16867
 16868     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16869     MOVE CR-APR                     TO  CP-LOAN-APR.
 16870     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16871     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16872     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16873     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16874     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16875     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16876
 16877
 16878     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16879     IF (DTE-CLIENT = 'DCC')
 16880        AND (AM-DCC-PRODUCT-CODE <> spaces)
 16881        if cr-clp-state = spaces
 16882           move cr-state         to cr-clp-state
 16883        end-if
 16884        if cr-lftyp not = '00' and '  ' and 'DD'
 16885           move 'L'              to ws-dd-ben-type
 16886           move cr-lftyp         to ws-dd-ben-code
 16887        else
 16888           move 'A'              to ws-dd-ben-type
 16889           move cr-ahtyp         to ws-dd-ben-code
 16890        end-if
 16891        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16892           ((CR-clp-STATE = DD-STATE (D1))
 16893           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16894           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 16895           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 16896           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16897                           OR
 16898           D1 > max-pdef
 16899        END-PERFORM
 16900        IF D1 <= max-pdef
 16901           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 324
* ECS010.cbl
 16902              (P1 > +8)
 16903              OR (DD-PROD-CODE (D1 P1) = 'L')
 16904           END-PERFORM
 16905           IF P1 < +9
 16906              MOVE DD-MAX-BEN-AMT (D1 P1)
 16907                                 TO CP-R-MAX-TOT-BEN
 16908           END-IF
 16909        END-IF
 16910     END-IF
 16911
 16912     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16913
 16914     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16915       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16916       GO TO 4130-EP-DO-LF-EP
 16917     ELSE
 16918       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16919
 16920     GO TO 4190-EP-DO-LF-COMM.
 16921
 16922 4128-EP-DO-LF-CNCL-FUL.
 16923
 16924     IF WE-LFAMT = ZERO
 16925        GO TO 4190-EP-DO-LF-COMM.
 16926
 16927     MOVE CR-APR              TO NP-APR.
 16928     MOVE CR-LF-TERM          TO NP-ORIG.
 16929     MOVE REM-TRM3            TO NP-REM.
 16930     MOVE '2'                 TO NP-OPT.
 16931     MOVE CR-AHPRM            TO NP-AHPRM.
 16932     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16933     MOVE CR-LFAMT            TO NP-BENEFIT.
 16934
 16935*    CALL 'FULNETRM'
 16936*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16937*              NP-ACCOUNT NP-REMAINING.
 16938
 16939     MOVE NP-REMAINING TO CNC-BEN.
 16940
 16941     GO TO 4190-EP-DO-LF-COMM.
 16942
 16943 4130-EP-DO-LF-EP.
 16944
 16945     MOVE SPACE                  TO STATUTORY-SWITCH.
 16946
 16947     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16948     MOVE '5'           TO W-VAL-SOURCE.
 16949
 16950     IF REIN-EP-FLG = 'R'
 16951       IF REIN-REM-SW (SUB5) = 'I'
 16952           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16953           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16954           GO TO 4190-EP-DO-LF-COMM.
 16955
 16956     IF REIN-EP-FLG = 'R'
 16957         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16958            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16959             MOVE '*'               TO LIFE-EARNED-SWITCH
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 325
* ECS010.cbl
 16960             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16961             MOVE '10'              TO W-VAL-SOURCE.
 16962
 16963     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16964
 16965     IF REM-TRM2 GREATER CR-LF-TERM
 16966         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16967         GO TO 4190-EP-DO-LF-COMM.
 16968
 16969     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16970         GO TO 4180-EP-DO-LF-EP-SUM.
 16971
 16972     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16973         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16974             IF REM-TRM2 NOT GREATER THAN +0
 16975                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16976                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16977                 GO TO 4190-EP-DO-LF-COMM
 16978             ELSE
 16979                 NEXT SENTENCE
 16980         ELSE
 16981             IF W-BAL-REMTRM NOT GREATER +0
 16982                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16983                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16984                 GO TO 4190-EP-DO-LF-COMM
 16985             ELSE
 16986                 NEXT SENTENCE
 16987     ELSE
 16988        IF DTE-CLIENT = 'NCL'  AND
 16989           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16990            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16991        ELSE
 16992         IF REM-TRM2 NOT GREATER +0  OR
 16993            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16994             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16995             GO TO 4190-EP-DO-LF-COMM.
 16996
 16997     MOVE +1 TO ACTIVE-COUNT.
 16998
 16999     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17000         GO TO 4140-EP-DO-LF-EP-TEX.
 17001
 17002     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17003         GO TO 4150-EP-DO-LF-EP-NP.
 17004
 17005*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17006     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17007        (CR-RATING-CLASS NOT = 'L ')
 17008         IF (CR-APR GREATER THAN ZERO)  AND
 17009            (CR-LF-TERM GREATER THAN 060)  AND
 17010            (CR-DT GREATER THAN 19831031)
 17011             MOVE '*'             TO STATUTORY-SWITCH
 17012              GO TO 4150-EP-DO-LF-EP-NP.
 17013
 17014     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17015         IF (CR-APR GREATER THAN ZERO)  AND
 17016            (CR-LF-TERM GREATER THAN 061)  AND
 17017            (CR-DT GREATER THAN 19830318)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 326
* ECS010.cbl
 17018             MOVE '*'             TO STATUTORY-SWITCH
 17019              GO TO 4150-EP-DO-LF-EP-NP.
 17020
 17021     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17022         IF (CR-APR GREATER THAN ZERO)  AND
 17023            (CR-LF-TERM GREATER THAN 062)  AND
 17024            (CR-DT GREATER THAN 19810831)  AND
 17025            (CR-DT LESS THAN 19830901)
 17026             MOVE '*'             TO STATUTORY-SWITCH
 17027              GO TO 4150-EP-DO-LF-EP-NP.
 17028
 17029     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17030         IF (CR-APR GREATER THAN ZERO)  AND
 17031            (CR-LF-TERM GREATER THAN 060)  AND
 17032            (CR-DT GREATER THAN 19831231)
 17033             MOVE '*'             TO STATUTORY-SWITCH
 17034              GO TO 4150-EP-DO-LF-EP-NP.
 17035
 17036     GO TO 4160-EP-DO-LF-EP-R78.
 17037
 17038 4140-EP-DO-LF-EP-TEX.
 17039
 17040     IF CR-PMT-FREQ = 0
 17041       DISPLAY '*************************************'
 17042       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 17043       DISPLAY '*************************************'
 17044       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 17045       DISPLAY '*************************************'
 17046       COMPUTE TEX-FACT-4 =
 17047          (CR-LF-TERM * CR-LF-TERM) +
 17048                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 17049     ELSE
 17050        COMPUTE TEX-FACT-4 =
 17051         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17052
 17053     IF CR-PMT-FREQ = 0
 17054       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 17055           GIVING TEX-FACT-5
 17056               REMAINDER TEX-FACT-6
 17057     ELSE
 17058        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17059            GIVING TEX-FACT-5
 17060                REMAINDER TEX-FACT-6.
 17061
 17062     IF CR-PMT-FREQ > 0
 17063        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 17064
 17065     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17066     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17067         (TEX-FACT-5 * CR-PMT-FREQ) +
 17068         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17069     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17070
 17071     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17072
 17073     GO TO 4170-EP-DO-LF-EP-PRO.
 17074
 17075 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 327
* ECS010.cbl
 17076
 17077     IF WE-LFPRM = ZERO
 17078         GO TO 4160-EP-DO-LF-EP-R78.
 17079
 17080     if cr-apr = zeros
 17081        display ' found 0 apr cert ' cr-cert-no
 17082        go to 4160-ep-do-lf-ep-r78
 17083     end-if
 17084     IF DTE-CLIENT = 'CRI'
 17085       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17086             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17087           GO TO 4160-EP-DO-LF-EP-R78.
 17088
 17089     IF DTE-CLIENT = 'AHL'
 17090        GO TO 4160-EP-DO-LF-EP-R78
 17091     END-IF
 17092
 17093     IF DTE-CLIENT = 'NCL'
 17094       IF CR-DT LESS THAN 19910101
 17095           GO TO 4160-EP-DO-LF-EP-R78.
 17096
 17097     IF REM-TRM1 = CR-LF-TERM
 17098         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17099         GO TO 4190-EP-DO-LF-COMM.
 17100
 17101     MOVE CR-APR TO NP-APR.
 17102     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17103     MOVE REM-TRM1 TO NP-REM.
 17104     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17105     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17106         MOVE CR-LOAN-TERM TO NP-ORIG.
 17107
 17108     MOVE 'R' TO NP-OPT.
 17109     CALL 'ECSNETRM'
 17110         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17111
 17112     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17113
 17114     IF STATUTORY-REQUIREMENT
 17115         MOVE EPR-R78                TO EPR-ST.
 17116
 17117 4160-EP-DO-LF-EP-R78.
 17118
 17119     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17120        (DTE-CLIENT EQUAL 'NCL')
 17121        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17122           (CR-MO EQUAL EOM-MO)
 17123           MOVE '*'            TO OB-DATE-1-SWITCH
 17124           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17125           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17126           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17127           COMPUTE WS-EPR-R78 (SUB3 1) =
 17128                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17129           GO TO 4190-EP-DO-LF-COMM
 17130        ELSE
 17131        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17132           (CR-MO EQUAL OB-MO (1))
 17133           MOVE '*'            TO OB-DATE-2-SWITCH
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 328
* ECS010.cbl
 17134           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17135           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17136           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17137           COMPUTE WS-EPR-R78 (SUB3 2) =
 17138                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17139           GO TO 4190-EP-DO-LF-COMM
 17140        ELSE
 17141        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17142           (CR-MO EQUAL OB-MO (2))
 17143           MOVE '*'            TO OB-DATE-3-SWITCH
 17144           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17145           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17146           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17147           COMPUTE WS-EPR-R78 (SUB3 3) =
 17148                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17149           GO TO 4190-EP-DO-LF-COMM
 17150        ELSE
 17151           GO TO 4190-EP-DO-LF-COMM.
 17152
 17153     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17154
 17155     IF DTE-R78 = '1'
 17156         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17157     ELSE
 17158         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17159
 17160     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17161
 17162     IF REM-TRM1 GREATER THAN +0
 17163         COMPUTE TEMP-7 ROUNDED EQUAL
 17164             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17165     ELSE
 17166         MOVE WE-LFPRM                TO TEMP-7.
 17167
 17168     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17169         MOVE TEMP-7                 TO EPR-ST.
 17170
 17171     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17172         MOVE ZEROS                  TO TEMP-8
 17173         GO TO 4165-END-LF-EP-R78.
 17174
 17175     IF EPR-ST = ZEROS
 17176         MOVE TEMP-7                 TO EPR-ST.
 17177
 17178     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17179         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17180         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17181         IF DTE-R78 = '1'
 17182             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17183
 17184     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17185
 17186     COMPUTE TEMP-8 ROUNDED =
 17187               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17188
 17189 4165-END-LF-EP-R78.
 17190
 17191     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 329
* ECS010.cbl
 17192         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17193     ELSE
 17194         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17195
 17196 4170-EP-DO-LF-EP-PRO.
 17197
 17198     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17199         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17200     ELSE
 17201         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17202
 17203     IF REM-TRM1 GREATER THAN +0
 17204         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17205     ELSE
 17206         MOVE WE-LFPRM                  TO TEMP-7.
 17207
 17208     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17209         MOVE ZEROS                     TO TEMP-8
 17210         GO TO 4175-END-LF-EP-PRO.
 17211
 17212     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17213         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17214             COMPUTE TEMP-5 ROUNDED =
 17215                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17216         ELSE
 17217             COMPUTE TEMP-5 ROUNDED =
 17218                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17219
 17220     COMPUTE TEMP-8 ROUNDED =
 17221                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17222
 17223     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17224
 17225 4175-END-LF-EP-PRO.
 17226
 17227     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17228
 17229     GO TO 4185-EP-DO-LF-STATUTORY.
 17230
 17231 4180-EP-DO-LF-EP-SUM.
 17232
 17233     IF REM-TRM1 NOT GREATER +0
 17234         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17235         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17236         GO TO 4190-EP-DO-LF-COMM.
 17237
 17238     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17239
 17240     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17241         MOVE ZEROS                 TO TEMP-7
 17242     ELSE
 17243         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17244                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17245
 17246     IF TEMP-7 NOT GREATER ZERO
 17247         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17248             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17249             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 330
* ECS010.cbl
 17250         ELSE
 17251             MOVE ZEROS             TO TEMP-7.
 17252
 17253     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17254     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17255     IF DTE-R78 = '1'
 17256         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17257
 17258     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17259     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17260
 17261     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17262
 17263     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17264
 17265     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17266         GO TO 4185-EP-DO-LF-STATUTORY.
 17267
 17268     MOVE EPR-R78                  TO EPR-ST.
 17269
 17270     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17271         MOVE ZEROS                 TO TEMP-8
 17272     ELSE
 17273         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17274                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17275
 17276     IF TEMP-8 NOT GREATER ZERO
 17277         GO TO 4185-EP-DO-LF-STATUTORY.
 17278
 17279     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17280                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17281
 17282     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17283                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17284
 17285     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17286                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17287
 17288 4185-EP-DO-LF-STATUTORY.
 17289
 17290*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17291*07636          MOVE EPR-R78                TO EPR-ST.
 17292     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17293         MOVE EPR-PRO                TO EPR-ST.
 17294
 17295     IF DTE-CLIENT = 'AHL'
 17296        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17297           MOVE EPR-R78          TO EPR-ST
 17298        ELSE
 17299           MOVE EPR-PRO          TO EPR-ST
 17300        END-IF
 17301     END-IF
 17302
 17303     IF (DTE-CLIENT = 'CID')
 17304        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17305                   OR
 17306            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17307            AND (CR-DT > 20091231)))
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 331
* ECS010.cbl
 17308        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17309        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17310           GO TO 4187-EP-DO-LF-STAT-ROA
 17311     END-IF.
 17312
 17313     IF EPR-ST NOT = ZEROS
 17314         GO TO 4190-EP-DO-LF-COMM.
 17315
 17316     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17317         MOVE EPR-R78                TO EPR-ST
 17318     ELSE
 17319         MOVE EPR-PRO                TO EPR-ST.
 17320
 17321     GO TO 4190-EP-DO-LF-COMM.
 17322
 17323 4187-EP-DO-LF-STAT-ROA.
 17324     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17325     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17326     MOVE 'L'                        TO DC-OPTION-CODE.
 17327     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17328     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17329     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17330        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17331        MOVE '3'                     TO  DC-OPTION-CODE
 17332        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17333                              8099-DATE-CONVERT-X
 17334        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17335     ELSE
 17336        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17337        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17338        MOVE +0                      TO  DC-ELAPSED-DAYS
 17339        MOVE '6'                     TO  DC-OPTION-CODE
 17340        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17341                              8099-DATE-CONVERT-X
 17342        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17343     END-IF.
 17344     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17345     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17346     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17347     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17348     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17349     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17350     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17351     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17352     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17353     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17354                                        CP-LOAN-TERM.
 17355     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17356                                        CP-RATING-BENEFIT-AMT.
 17357     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17358     MOVE CR-APR                     TO CP-LOAN-APR.
 17359     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17360     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17361     MOVE '6'                        TO CP-EARNING-METHOD.
 17362     MOVE '3'                        TO CP-PROCESS-TYPE.
 17363     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17364     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17365         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 332
* ECS010.cbl
 17366     ELSE
 17367         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17368     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17369     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17370     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17371     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17372     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17373     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17374
 17375     IF CP-STATE-STD-ABBRV = 'OR'
 17376        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17377     END-IF
 17378
 17379     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 17380        COMPUTE CP-ORIGINAL-BENEFIT =
 17381         (CR-LFAMT - CR-LFPRM)
 17382     END-IF
 17383
 17384     IF CP-TRUNCATED-LIFE
 17385        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17386     END-IF
 17387
 17388     IF CP-TERM-IS-DAYS
 17389        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17390     ELSE
 17391        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17392     END-IF
 17393
 17394     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17395
 17396     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17397
 17398 4190-EP-DO-LF-COMM.
 17399
 17400     MOVE +0 TO SUB1.
 17401     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17402         10 TIMES.
 17403
 17404     IF REIN-EP-FLG NOT = 'R'  OR
 17405        CR-POLICY-IS-REIN-ONLY
 17406         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17407         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17408         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17409         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17410
 17411     ADD ISS-BEN TO EW-ISS-BEN.
 17412     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17413     ADD CNC-BEN TO EW-CNC-BEN.
 17414     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17415     ADD ISS-PRM TO EW-ISS-PRM.
 17416     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17417     ADD CNC-PRM TO EW-CNC-PRM.
 17418     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17419
 17420     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17421     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17422     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17423
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 333
* ECS010.cbl
 17424     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17425        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17426     END-IF
 17427     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17428        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17429     END-IF
 17430
 17431     COMPUTE ISS-PRMTAX rounded =
 17432        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17433        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17434
 17435     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17436
 17437     IF LIFE-FULLY-EARNED
 17438         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17439                                            (ISS-PRM - EPR-R78)
 17440         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17441                                            (ISS-PRM - EPR-PRO)
 17442         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17443                                            (ISS-PRM - EPR-ST).
 17444
 17445     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17446         IF  REIN-EP-FLG NOT = 'R'
 17447                 OR
 17448             CR-POLICY-IS-REIN-ONLY
 17449             MOVE 'L'      TO W-CLAIM-TYPE
 17450             MOVE EPR-R78  TO W-OPT-R78
 17451             MOVE EPR-PRO  TO W-OPT-PRO
 17452             MOVE EPR-ST   TO W-OPT-ST
 17453             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17454             MOVE ZEROS    TO EW-CLM-IBNR
 17455         ELSE
 17456             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17457                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17458                 MOVE ZEROS      TO EW-CLM-IBNR
 17459             ELSE
 17460                 MOVE ZEROS      TO EW-CLM-IBNR
 17461     ELSE
 17462         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17463             ADD WE-DTH-IBNR
 17464                       TO EW-CLM-IBNR
 17465         ELSE
 17466             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17467                     AND
 17468                 CR-DT GREATER THAN LAST-YRS-DATE
 17469                 COMPUTE  EW-CLM-IBNR
 17470                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17471
 17472     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17473     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17474
 17475 4191-CONTINUE.
 17476
 17477     MOVE 'Y'          TO EW-LEVEL-USED.
 17478
 17479     IF CR-POLICY-UNDERWRITTEN
 17480         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17481         MOVE EPEC-OPT-WORK-TABLE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 334
* ECS010.cbl
 17482                              TO EPEC-UNDW-OPT-DATA-TABLE
 17483     ELSE
 17484         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17485         MOVE EPEC-OPT-WORK-TABLE
 17486                              TO EPEC-OPT-DATA-TABLE.
 17487
 17488     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 335
* ECS010.cbl
 17490 4194-SLOT-INTO-EFFECTED-MONTHS.
 17491
 17492     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17493             AND
 17494         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17495             AND
 17496         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17497                 OR
 17498          CR-LF-CANC-DT EQUAL ZEROS)
 17499             AND
 17500         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17501                 OR
 17502          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17503         MOVE 'Y'                 TO W-TABLE-USED-SW
 17504         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17505             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17506                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17507                 + CR-LIVES
 17508         ELSE
 17509             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17510                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17511
 17512 4194-EXIT.
 17513     EXIT.
 17514
 17515 4196-CALC-REM-AMT.
 17516
 17517     IF CR-LFTYP = 'QD'
 17518        MOVE +15.0               TO CR-APR
 17519     END-IF
 17520
 17521     MOVE +0                     TO WS-REM-AMT
 17522     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17523        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17524           COMPUTE WS-REM-AMT =
 17525             CR-LFAMT + CR-LFAMT-ALT
 17526        ELSE
 17527           MOVE CR-LFAMT         TO WS-REM-AMT
 17528        END-IF
 17529        GO TO 4199-EXIT
 17530     END-IF
 17531
 17532     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17533
 17534     IF REM-TRM1 = CR-LF-TERM
 17535        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17536           COMPUTE WS-REM-AMT =
 17537             CR-LFAMT + CR-LFAMT-ALT
 17538        ELSE
 17539           MOVE CR-LFAMT         TO WS-REM-AMT
 17540        END-IF
 17541        GO TO 4199-EXIT
 17542     END-IF
 17543
 17544     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17545        GO TO 4198-ORDINARY-REM
 17546     END-IF
 17547
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 336
* ECS010.cbl
 17548     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17549        GO TO 4198-CALC-TEXAS-REM
 17550     END-IF
 17551
 17552     IF CR-LFTYP = 'QD'
 17553        MOVE +15.0               TO CR-APR
 17554        MOVE 'N'                 TO
 17555                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17556        GO TO 4198-CALC-NET-PAY-REM
 17557     END-IF
 17558
 17559     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17560        GO TO 4198-CALC-NET-PAY-REM
 17561     END-IF
 17562
 17563     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17564        (CR-RATING-CLASS NOT = 'L ')
 17565         IF (CR-LF-TERM GREATER THAN +60) AND
 17566            (CR-DT GREATER THAN 19831031) AND
 17567            (CR-APR GREATER THAN ZERO)
 17568             GO TO 4198-CALC-NET-PAY-REM
 17569        END-IF
 17570     END-IF
 17571
 17572     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17573         IF (CR-LF-TERM GREATER THAN +61) AND
 17574            (CR-DT  GREATER THAN 19830318) AND
 17575            (CR-APR GREATER THAN ZERO)
 17576             GO TO 4198-CALC-NET-PAY-REM
 17577        END-IF
 17578     END-IF
 17579
 17580     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17581         IF (CR-LF-TERM GREATER THAN +62) AND
 17582            (CR-DT  GREATER THAN 19810831) AND
 17583            (CR-DT  LESS THAN 19830901) AND
 17584            (CR-APR GREATER THAN ZERO)
 17585             GO TO 4198-CALC-NET-PAY-REM
 17586        END-IF
 17587     END-IF
 17588
 17589     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17590         IF (CR-LF-TERM GREATER THAN +60) AND
 17591            (CR-DT  GREATER THAN 19831231) AND
 17592            (CR-APR GREATER THAN ZERO)
 17593             GO TO 4198-CALC-NET-PAY-REM
 17594        END-IF
 17595     END-IF
 17596
 17597     .
 17598 4198-ORDINARY-REM.
 17599
 17600     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17601         COMPUTE WS-REM-AMT ROUNDED =
 17602                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17603     ELSE
 17604         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17605     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 337
* ECS010.cbl
 17606
 17607     GO TO 4199-EXIT
 17608
 17609     .
 17610 4198-CALC-TEXAS-REM.
 17611
 17612     DIVIDE CR-LFAMT BY CR-LF-TERM
 17613         GIVING TEX-FACT-1.
 17614     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17615         GIVING TEX-FACT-2
 17616         REMAINDER TEX-FACT-3.
 17617
 17618     IF TEX-FACT-3 NOT = ZERO
 17619         ADD +1                  TO TEX-FACT-2
 17620     END-IF
 17621
 17622     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17623         MOVE CR-LFAMT           TO WS-REM-AMT
 17624     ELSE
 17625         COMPUTE WS-REM-AMT ROUNDED =
 17626             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17627     END-IF
 17628
 17629     GO TO 4199-EXIT
 17630
 17631     .
 17632 4198-CALC-NET-PAY-REM.
 17633
 17634     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17635     MOVE 'L'                        TO DC-OPTION-CODE.
 17636     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17637     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17638
 17639     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17640        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17641        MOVE '3'                 TO  DC-OPTION-CODE
 17642        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17643                                  8099-DATE-CONVERT-X
 17644        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17645     ELSE
 17646        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17647        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17648        MOVE +0                  TO  DC-ELAPSED-DAYS
 17649        MOVE '6'                 TO  DC-OPTION-CODE
 17650        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17651                                  8099-DATE-CONVERT-X
 17652        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17653     END-IF
 17654
 17655     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17656        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17657     ELSE
 17658        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17659     END-IF
 17660     MOVE CR-APR                 TO  CP-LOAN-APR
 17661     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17662     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17663     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 338
* ECS010.cbl
 17664     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17665                                 TO CP-SPECIAL-CALC-CD
 17666     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17667                                 TO  CP-BENEFIT-TYPE
 17668     MOVE CLAS-I-EP (CLAS-INDEXL)
 17669                                 TO  CP-EARNING-METHOD
 17670
 17671     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17672     IF (DTE-CLIENT = 'DCC')
 17673        AND (AM-DCC-PRODUCT-CODE <> spaces)
 17674        if cr-clp-state = spaces
 17675           move cr-state         to cr-clp-state
 17676        end-if
 17677        if cr-lftyp not = '00' and '  ' and 'DD'
 17678           move 'L'              to ws-dd-ben-type
 17679           move cr-lftyp         to ws-dd-ben-code
 17680        else
 17681           move 'A'              to ws-dd-ben-type
 17682           move cr-ahtyp         to ws-dd-ben-code
 17683        end-if
 17684        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17685           ((CR-clp-STATE = DD-STATE (D1))
 17686           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17687           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 17688           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 17689           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17690                           OR
 17691           D1 > max-pdef
 17692        END-PERFORM
 17693        IF D1 <= max-pdef
 17694           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17695              (P1 > +8)
 17696              OR (DD-PROD-CODE (D1 P1) = 'L')
 17697           END-PERFORM
 17698           IF P1 < +9
 17699              MOVE DD-MAX-BEN-AMT (D1 P1)
 17700                                 TO CP-R-MAX-TOT-BEN
 17701           END-IF
 17702        END-IF
 17703     END-IF
 17704
 17705     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17706
 17707     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17708
 17709     .
 17710 4199-EXIT.
 17711     EXIT.
 17712
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 339
* ECS010.cbl
 17714******************************************************************
 17715***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17716******************************************************************
 17717
 17718 4200-EP-DO-AH.
 17719
 17720     MOVE +0                         TO ISS-BEN  EPR-R78
 17721                                        CNC-BEN  EPR-PRO
 17722                                        ISS-PRM  EPR-ST
 17723                                        CNC-PRM
 17724                                        WX-CLM-AMT
 17725                                        WX-CLM-EXP
 17726                                        WX-CLM-CNT
 17727                                        WX-CLM-CRT
 17728                                        WX-ACTIVE-COUNT
 17729                                        ISS-PRMTAX
 17730                                        WX-CNC-CNT.
 17731     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17732
 17733     IF CR-AHTYP = ZERO
 17734         GO TO 4295-EP-DO-COUNT.
 17735
 17736     IF REIN-EP-FLG = 'R'
 17737         IF REIN-AH-FLG (SUB5) = SPACE
 17738             GO TO 4295-EP-DO-COUNT.
 17739
 17740     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17741     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17742     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17743
 17744     IF CR-POLICY-IS-DECLINED  OR
 17745        CR-POLICY-IS-VOID
 17746         GO TO 4290-CONTINUE.
 17747
 17748     MOVE CR-AH-TERM           TO ORIG-TERM.
 17749
 17750     IF CR-DT GREATER EW-COV-DTE
 17751         MOVE CR-DT            TO EW-COV-DTE.
 17752
 17753     IF NOT CR-POLICY-IS-RESTORE  AND
 17754        NOT CR-POLICY-IS-REISSUE
 17755        AND NOT CR-POLICY-IS-MONTHLY
 17756         MOVE WE-AHAMT         TO ISS-BEN
 17757         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17758         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17759         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17760         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17761                                   (ORIG-TERM * ISS-BEN).
 17762
 17763     MOVE CLAS-INDEXA     TO W-NDX.
 17764     MOVE RUN-DATE        TO VALUATION-DT
 17765     MOVE '6'             TO W-VAL-SOURCE.
 17766
 17767     IF REIN-EP-FLG = 'R'
 17768         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17769            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17770             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17771             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 340
* ECS010.cbl
 17772
 17773     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17774
 17775     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17776        (REM-TRM3 GREATER ZERO)
 17777        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17778            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17779                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17780            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17781                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17782          ELSE
 17783            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17784            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17785
 17786     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17787         GO TO 4210-BY-OPT-LOGIC.
 17788
 17789     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17790             AND
 17791         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17792             AND
 17793         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17794                 OR
 17795          CR-AH-CANC-DT EQUAL ZEROS)
 17796         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17797         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17798                 VARYING
 17799             SUBM FROM +1 BY +1
 17800                 UNTIL
 17801             SUBM GREATER THAN +13.
 17802
 17803     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17804     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17805
 17806 4210-BY-OPT-LOGIC.
 17807
 17808     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17809         ADD CR-LIVES TO EW-ISS-CNT
 17810         MOVE WE-AHPRM TO ISS-PRM
 17811         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17812                                (ORIG-TERM * CR-LIVES)
 17813         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17814         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17815         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17816                                   (ORIG-TERM * ISS-BEN)
 17817         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17818         GO TO 4225-CONTINUE.
 17819
 17820     IF (NOT CR-POLICY-IS-RESTORE) AND
 17821        (NOT CR-POLICY-IS-REISSUE)
 17822        AND (NOT CR-POLICY-IS-MONTHLY)
 17823        ADD +1 TO EW-ISS-CNT.
 17824
 17825     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17826
 17827     .
 17828 4225-CONTINUE.
 17829
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 341
* ECS010.cbl
 17830     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17831         NEXT  SENTENCE
 17832       ELSE
 17833         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17834
 17835     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17836     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17837     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17838     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17839     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17840     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17841
 17842     MOVE +0           TO SUB1.
 17843
 17844     IF DTE-CLIENT = 'DCC'
 17845        IF CR-AH-CANC-DT NOT = ZEROS
 17846           MOVE CR-AH-TERM       TO ORIG-TERM
 17847           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17848           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17849           MOVE '1'              TO W-VAL-SOURCE
 17850           PERFORM 8500-REMAINING-TERM-ROUTINE
 17851                                 THRU 8599-REM-TERM-X
 17852           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17853        END-IF
 17854     END-IF
 17855
 17856     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17857         10 TIMES.
 17858     MOVE +0                     TO SUB16
 17859     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17860        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17861
 17862     IF REIN-EP-FLG NOT = 'R'  OR
 17863        CR-POLICY-IS-REIN-ONLY
 17864         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17865         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17866         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17867         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17868
 17869     ADD ISS-BEN TO EW-ISS-BEN.
 17870     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17871     ADD CNC-BEN TO EW-CNC-BEN.
 17872     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17873     ADD ISS-PRM TO EW-ISS-PRM.
 17874     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17875     ADD CNC-PRM TO EW-CNC-PRM.
 17876     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17877
 17878     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17879     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17880     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17881
 17882     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17883        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17884     END-IF
 17885     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17886        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17887     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 342
* ECS010.cbl
 17888     COMPUTE ISS-PRMTAX rounded =
 17889        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17890        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17891     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17892
 17893     IF A-H-FULLY-EARNED
 17894         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17895                                            (ISS-PRM - EPR-R78)
 17896         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17897                                            (ISS-PRM - EPR-PRO)
 17898         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17899                                            (ISS-PRM - EPR-ST).
 17900
 17901     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17902         IF  REIN-EP-FLG NOT = 'R'
 17903                 OR
 17904             CR-POLICY-IS-REIN-ONLY
 17905             MOVE 'A'      TO W-CLAIM-TYPE
 17906             MOVE EPR-R78  TO W-OPT-R78
 17907             MOVE EPR-PRO  TO W-OPT-PRO
 17908             MOVE EPR-ST   TO W-OPT-ST
 17909             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17910             MOVE ZEROS    TO EW-CLM-IBNR
 17911         ELSE
 17912             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17913                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17914                 MOVE ZEROS TO EW-CLM-IBNR
 17915             ELSE
 17916                 MOVE ZEROS TO EW-CLM-IBNR
 17917     ELSE
 17918         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17919             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17920         ELSE
 17921             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17922                 IF  CR-AH-POLICY-IS-ACTIVE
 17923                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17924                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17925                 ELSE
 17926                     NEXT SENTENCE
 17927             ELSE
 17928                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17929                     COMPUTE  EW-CLM-IBNR
 17930                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17931
 17932     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17933     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17934
 17935 4290-CONTINUE.
 17936*     DISPLAY ' 4290 '
 17937
 17938     MOVE 'Y'          TO EW-LEVEL-USED.
 17939
 17940     IF CR-POLICY-UNDERWRITTEN
 17941         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17942         MOVE EPEC-OPT-WORK-TABLE
 17943                              TO EPEC-UNDW-OPT-DATA-TABLE
 17944     ELSE
 17945         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 343
* ECS010.cbl
 17946         MOVE EPEC-OPT-WORK-TABLE
 17947                              TO EPEC-OPT-DATA-TABLE.
 17948
 17949
 17950 4295-EP-DO-COUNT.
 17951
 17952     IF REIN-EP-FLG = 'R'
 17953         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17954     ELSE
 17955         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17956
 17957     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 344
* ECS010.cbl
 17959 4296-SLOT-INTO-EFFECTED-MONTHS.
 17960
 17961     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17962             AND
 17963         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17964             AND
 17965         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17966                 OR
 17967          CR-AH-CANC-DT EQUAL ZEROS)
 17968         MOVE 'Y'                 TO W-TABLE-USED-SW
 17969         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17970             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17971                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17972                 + CR-LIVES
 17973         ELSE
 17974             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17975                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17976
 17977 4296-EXIT.
 17978     EXIT.
 17979
 17980 4299-EPBX.
 17981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 345
* ECS010.cbl
 17983******************************************************************
 17984***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17985******************************************************************
 17986
 17987 4300-EP-COMM-LOOP.
 17988
 17989     IF DTE-CLIENT = 'DMD'
 17990         GO TO 4350-EP-COMM-LOOP-X.
 17991
 17992     ADD +1                         TO SUB1.
 17993     MOVE ZEROS                     TO SUB16.
 17994
 17995     IF CR-ADDL-CLP NOT NUMERIC
 17996        MOVE ZEROS               TO CR-ADDL-CLP
 17997     END-IF
 17998     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17999         GO TO 4350-EP-COMM-LOOP-X.
 18000
 18001 4300-AGENT-LOOP.
 18002
 18003     ADD +1                         TO SUB16.
 18004
 18005     IF SUB16 GREATER THAN WS-LOOP-MAX
 18006         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18007         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18008         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18009                                     TO WS-ABEND-MESSAGE
 18010         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18011         MOVE 4001                   TO WS-ABEND-CODE
 18012         GO TO ABEND-PGM.
 18013
 18014     IF EW-AGT-NO (SUB16) = SPACES
 18015         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 18016         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 18017     ELSE
 18018         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 18019            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 18020             NEXT SENTENCE
 18021         ELSE
 18022             GO TO 4300-AGENT-LOOP.
 18023
 18024     IF EW-LF-AH = AH-OVERRIDE-L1
 18025         GO TO 4350-EP-COMM-LOOP-A.
 18026
 18027     IF (DTE-CLIENT = 'DCC')
 18028        AND (REIN-EP-FLG = 'R')
 18029        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18030        AND (WE-LFPRM NOT = ZEROS)
 18031        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18032           COMPUTE ISS-WK ROUNDED =
 18033              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 18034        ELSE
 18035           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 18036               (CR-LFAMT + CR-LFAMT-ALT)
 18037           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 18038              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 18039        END-IF
 18040     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 346
* ECS010.cbl
 18041        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18042                             OR 'J' OR 'N'
 18043           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 18044        ELSE
 18045           IF CR-AGT-TYPE (SUB1) = 'A'
 18046              COMPUTE ISS-WK ROUNDED =
 18047                   CR-LF-CLP * CR-LCOM-L (SUB1)
 18048           ELSE
 18049              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18050                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 18051                 COMPUTE ISS-WK ROUNDED =
 18052                      CR-LF-CLP * CR-LCOM-L (SUB1)
 18053              ELSE
 18054                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 18055                    * CR-LCOM-L (SUB1)
 18056              END-IF
 18057           END-IF
 18058        END-IF
 18059     END-IF
 18060
 18061     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18062
 18063     MOVE ZEROS                  TO CNC-WK
 18064                                    CNC-FACT
 18065     IF DTE-CLIENT EQUAL 'XXX'
 18066         IF NOT CR-NO-LF-CHARGEBACK
 18067            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 18068            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 18069                                + CNC-WK
 18070            GO TO 4300-CONTINUE-LOOP.
 18071
 18072     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18073        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18074
 18075      IF (DTE-CLIENT = 'DCC')
 18076         AND (REIN-EP-FLG = 'R')
 18077         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18078         AND (WE-LFRFND NOT = ZEROS)
 18079         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18080            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18081            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18082               CR-LCOM-L (SUB1)
 18083            IF CR-ACCOUNT = '05500500DD'
 18084               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18085            END-IF
 18086         ELSE
 18087            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18088            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18089               * CR-LCOM-L (SUB1)
 18090         END-IF
 18091      ELSE
 18092        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18093                              OR 'L' OR 'J' OR 'K')
 18094           AND (CNC-PRM > +0)
 18095           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18096           IF CR-CANCEL-REASON = 'R'
 18097              MOVE 1             TO CNC-FACT
 18098           END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 347
* ECS010.cbl
 18099           COMPUTE CNC-WK = CNC-FACT *
 18100              (CR-LCOM-L (SUB1) * +1000)
 18101*       ELSE
 18102*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18103*          AND (CNC-PRM > +0)
 18104*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18105*                                THRU 4380-EXIT
 18106*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18107*          COMPUTE CNC-WK = CNC-FACT *
 18108*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18109*       ELSE
 18110*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18111*              AND (CR-AHTYP NOT = '00' AND '  ')
 18112*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18113*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18114*             COMPUTE CNC-WK = CNC-FACT *
 18115*                (CR-AHPRM - (CR-LFPRM-ALT
 18116*                + CR-ADDL-CLP))
 18117         ELSE
 18118            IF (CR-AGT-TYPE (SUB1) = 'A')
 18119                      OR
 18120              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18121                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18122              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18123              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18124                CR-LCOM-L (SUB1)
 18125            ELSE
 18126               COMPUTE CNC-WK  ROUNDED =
 18127                 CNC-PRM * CR-LCOM-L (SUB1)
 18128            END-IF
 18129         END-IF
 18130*       END-IF
 18131      END-IF
 18132        COMPUTE EW-CNC-COM (SUB16) =
 18133                                  EW-CNC-COM (SUB16) + CNC-WK
 18134     END-IF
 18135
 18136     if (ws-dcc-cnc-flag = 'Y')
 18137        and (rein-ep-flg not = 'R')
 18138        move cnc-wk              to dx-l-pc (sub1)
 18139     end-if
 18140
 18141     .
 18142 4300-CONTINUE-LOOP.
 18143
 18144*     DISPLAY ' 4300 CONTINUE '
 18145     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18146               OR
 18147        ((ISS-WK - CNC-WK) = ZEROS)
 18148        MOVE ZEROS              TO COMM-WK
 18149     ELSE
 18150        COMPUTE EC-FACT ROUNDED =
 18151           EPR-R78 / (ISS-PRM - CNC-PRM)
 18152        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18153     END-IF
 18154
 18155     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18156
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 348
* ECS010.cbl
 18157     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18158               OR
 18159        ((ISS-WK - CNC-WK) = ZEROS)
 18160        MOVE ZEROS              TO COMM-WK
 18161     ELSE
 18162        COMPUTE EC-FACT ROUNDED =
 18163           EPR-PRO / (ISS-PRM - CNC-PRM)
 18164        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18165     END-IF
 18166     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18167
 18168     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18169               OR
 18170        ((ISS-WK - CNC-WK) = ZEROS)
 18171        MOVE ZEROS              TO COMM-WK
 18172     ELSE
 18173        COMPUTE EC-FACT ROUNDED =
 18174           EPR-ST / (ISS-PRM - CNC-PRM)
 18175        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18176     END-IF
 18177
 18178     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18179
 18180     IF LIFE-FULLY-EARNED
 18181         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18182                                                CR-LCOM-L (SUB1)
 18183         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18184                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18185         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18186                                                CR-LCOM-L (SUB1)
 18187         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18188                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18189
 18190     GO TO 4350-EP-COMM-LOOP-X.
 18191
 18192 4350-EP-COMM-LOOP-A.
 18193
 18194     IF (DTE-CLIENT = 'DCC')
 18195        AND (REIN-EP-FLG = 'R')
 18196        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18197        AND (WE-AHPRM NOT = ZEROS)
 18198
 18199        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18200           COMPUTE ISS-WK ROUNDED =
 18201              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18202        ELSE
 18203           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18204           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18205              * CR-LCOM-AH (SUB1)
 18206        END-IF
 18207     ELSE
 18208        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18209                                    OR 'J' OR 'N'
 18210           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18211        ELSE
 18212           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18213             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18214              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 349
* ECS010.cbl
 18215              + CR-ADDL-CLP)
 18216           ELSE
 18217              IF (CR-AGT-TYPE (SUB1) = 'M')
 18218                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18219                              = 'G' OR 'L')
 18220                 COMPUTE ISS-WK ROUNDED =
 18221                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18222              ELSE
 18223                 IF CR-AGT-TYPE (SUB1) = 'A'
 18224                    COMPUTE ISS-WK ROUNDED =
 18225                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18226                 ELSE
 18227                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18228                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18229                                     'D')
 18230                       COMPUTE ISS-WK ROUNDED =
 18231                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18232                    ELSE
 18233                       COMPUTE ISS-WK  ROUNDED =
 18234                         ISS-PRM * CR-LCOM-AH (SUB1)
 18235                    END-IF
 18236                 END-IF
 18237              END-IF
 18238           END-IF
 18239        END-IF
 18240     END-IF
 18241
 18242     COMPUTE EW-ISS-COM (SUB16) =
 18243             EW-ISS-COM (SUB16) + ISS-WK.
 18244
 18245     MOVE ZEROS                  TO CNC-WK
 18246     IF DTE-CLIENT EQUAL 'XXX'
 18247         IF NOT CR-NO-LF-CHARGEBACK
 18248           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18249           COMPUTE EW-CNC-COM (SUB16) =
 18250                   EW-CNC-COM (SUB16) + CNC-WK
 18251           GO TO 4300-CONTINUE-LOOP-AH.
 18252
 18253     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18254        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18255        EVALUATE TRUE
 18256           WHEN DTE-CLIENT = 'DCC'
 18257             AND (REIN-EP-FLG = 'R')
 18258             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18259             AND (WE-AHRFND NOT = ZEROS)
 18260             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18261                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18262                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18263                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18264             ELSE
 18265                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18266                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18267                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18268             END-IF
 18269           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18270             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18271             AND (CNC-PRM > +0)
 18272             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 350
* ECS010.cbl
 18273           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18274             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18275             AND (CNC-PRM > +0)
 18276             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18277           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18278                              OR 'L' OR 'J' OR 'K')
 18279             AND (CNC-PRM > +0)
 18280             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18281             IF CR-CANCEL-REASON = 'R'
 18282                MOVE 1             TO CNC-FACT
 18283             END-IF
 18284             COMPUTE CNC-WK = CNC-FACT *
 18285                (CR-LCOM-AH (SUB1) * +1000)
 18286
 18287           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18288             AND (CNC-PRM > +0)
 18289             AND (CNC-PRM = ISS-PRM)
 18290             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18291
 18292           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18293             AND (CNC-PRM > +0)
 18294             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18295           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18296              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18297                              = 'G' OR 'L')
 18298              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18299              COMPUTE CNC-WK = CNC-FACT *
 18300                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18301           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18302              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18303              IF (CR-CANCEL-REASON = 'R')
 18304                 AND (CNC-PRM > +0)
 18305                 MOVE +1      TO CNC-FACT
 18306              END-IF
 18307              COMPUTE CNC-WK = CNC-FACT *
 18308              (CR-AHPRM - (CR-LFPRM-ALT
 18309                 + CR-ADDL-CLP))
 18310           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18311                      OR
 18312              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18313               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18314               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18315               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18316                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18317            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18318                      CNC-PRM * CR-LCOM-AH (SUB1)
 18319        END-EVALUATE
 18320        COMPUTE EW-CNC-COM (SUB16) =
 18321           EW-CNC-COM (SUB16) + CNC-WK
 18322     END-IF
 18323
 18324     if (ws-dcc-cnc-flag = 'Y')
 18325        and (rein-ep-flg not = 'R')
 18326        move cnc-wk              to dx-a-pc (sub1)
 18327     end-if
 18328
 18329*      IF (DTE-CLIENT = 'DCC')
 18330*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 351
* ECS010.cbl
 18331*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18332*         AND (WE-AHRFND NOT = ZEROS)
 18333*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18334*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18335*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18336*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18337*         ELSE
 18338*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18339*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18340*            * CR-LCOM-AH (SUB1)
 18341*         END-IF
 18342*      ELSE
 18343*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18344*                              OR 'L' OR 'J' OR 'K')
 18345*           AND (CNC-PRM > +0)
 18346*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18347*           IF CR-CANCEL-REASON = 'R'
 18348*              MOVE 1             TO CNC-FACT
 18349*           END-IF
 18350*           COMPUTE CNC-WK = CNC-FACT *
 18351*              (CR-LCOM-AH (SUB1) * +1000)
 18352*        ELSE
 18353*          IF CR-AGT-TYPE (SUB1) = 'N'
 18354*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18355*                                 THRU 4380-EXIT
 18356**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18357**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18358**            IF CNC-PRM NOT = ISS-PRM
 18359**               COMPUTE CNC-WK = CNC-FACT *
 18360**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18361**            ELSE
 18362**               COMPUTE CNC-WK = CNC-FACT *
 18363**               (CR-LCOM-AH (SUB1) * +1000)
 18364**            END-IF
 18365*          ELSE
 18366*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18367*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18368*                              = 'G' OR 'L')
 18369*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18370*              COMPUTE CNC-WK = CNC-FACT *
 18371*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18372*           ELSE
 18373*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18374*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18375*                 IF CR-CANCEL-REASON = 'R'
 18376*                    MOVE +1      TO CNC-FACT
 18377*                 END-IF
 18378*                 COMPUTE CNC-WK = CNC-FACT *
 18379*                 (CR-AHPRM - (CR-LFPRM-ALT
 18380*                    + CR-ADDL-CLP))
 18381*              ELSE
 18382*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18383*                           OR
 18384*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18385*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18386*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18387*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18388*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 352
* ECS010.cbl
 18389*                 ELSE
 18390*                    COMPUTE CNC-WK  ROUNDED =
 18391*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18392*                 END-IF
 18393*              END-IF
 18394*           END-IF
 18395*          END-IF
 18396*        END-IF
 18397**       END-IF
 18398*      END-IF
 18399*        COMPUTE EW-CNC-COM (SUB16) =
 18400*           EW-CNC-COM (SUB16) + CNC-WK
 18401*     END-IF
 18402
 18403     .
 18404 4300-CONTINUE-LOOP-AH.
 18405
 18406     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18407        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18408        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18409        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18410        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18411           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18412        END-IF
 18413     END-IF
 18414
 18415*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18416     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18417                OR
 18418        ((ISS-WK - CNC-WK) = ZEROS)
 18419        MOVE ZEROS          TO COMM-WK
 18420     ELSE
 18421        COMPUTE EC-FACT ROUNDED =
 18422           EPR-R78 / (ISS-PRM - CNC-PRM)
 18423        IF WS-DDF-AH-CB (SUB1) = 'N'
 18424           MOVE ISS-WK           TO COMM-WK
 18425        ELSE
 18426           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18427        END-IF
 18428     END-IF
 18429
 18430     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18431
 18432     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18433                OR
 18434        ((ISS-WK - CNC-WK) = ZEROS)
 18435        MOVE ZEROS          TO COMM-WK
 18436     ELSE
 18437        COMPUTE EC-FACT ROUNDED =
 18438           EPR-PRO / (ISS-PRM - CNC-PRM)
 18439        IF WS-DDF-AH-CB (SUB1) = 'N'
 18440           MOVE ISS-WK           TO COMM-WK
 18441        ELSE
 18442           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18443        END-IF
 18444     END-IF
 18445
 18446     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 353
* ECS010.cbl
 18447
 18448     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18449                OR
 18450        ((ISS-WK - CNC-WK) = ZEROS)
 18451        MOVE ZEROS          TO COMM-WK
 18452     ELSE
 18453        EVALUATE TRUE
 18454           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18455              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18456                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18457                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18458           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18459             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18460              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18461           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18462              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18463              MOVE ISS-WK TO COMM-WK
 18464           WHEN OTHER
 18465              COMPUTE EC-FACT ROUNDED =
 18466                EPR-ST / (ISS-PRM - CNC-PRM)
 18467              COMPUTE COMM-WK ROUNDED = EC-FACT
 18468                 * (ISS-WK - CNC-WK)
 18469        END-EVALUATE
 18470     END-IF
 18471
 18472     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18473
 18474     IF A-H-FULLY-EARNED
 18475         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18476                                                CR-LCOM-AH (SUB1)
 18477         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18478                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18479         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18480                                                CR-LCOM-AH (SUB1)
 18481         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18482                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18483
 18484 4350-EP-COMM-LOOP-X.
 18485     EXIT.
 18486
 18487******************************************************************
 18488***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18489******************************************************************
 18490
 18491 4375-EP-BANK-COMM.
 18492*     DISPLAY ' 4375 '
 18493
 18494     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18495        GO TO 4375-EXIT
 18496     END-IF
 18497     .
 18498 4375-BANK-LOOP.
 18499
 18500     ADD +1                      TO SUB16
 18501
 18502     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18503        GO TO 4375-EXIT
 18504     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 354
* ECS010.cbl
 18505
 18506     IF SUB16 GREATER THAN WS-LOOP-MAX
 18507         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18508         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18509         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18510                                     TO WS-ABEND-MESSAGE
 18511         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18512         MOVE 4001                   TO WS-ABEND-CODE
 18513         PERFORM ABEND-PGM
 18514     END-IF
 18515
 18516     IF EW-AGT-NO (SUB16) = SPACES
 18517        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18518        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18519     ELSE
 18520        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18521           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18522           CONTINUE
 18523        ELSE
 18524           GO TO 4375-BANK-LOOP
 18525        END-IF
 18526     END-IF
 18527
 18528     IF CS-COM-TYP  (SUB1) = 'B'
 18529        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18530     END-IF
 18531
 18532     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18533
 18534     MOVE ZEROS                  TO CNC-WK
 18535                                    CNC-FACT
 18536
 18537     IF (CS-COM-TYP (SUB1) = 'B')
 18538        AND (CNC-PRM > +0)
 18539        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18540        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18541     END-IF
 18542
 18543     COMPUTE EW-CNC-COM (SUB16) =
 18544                  EW-CNC-COM (SUB16) + CNC-WK
 18545
 18546     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18547                OR
 18548        ((ISS-WK - CNC-WK) = ZEROS)
 18549        MOVE ZEROS          TO COMM-WK
 18550     ELSE
 18551        COMPUTE EC-FACT ROUNDED =
 18552           EPR-R78 / (ISS-PRM - CNC-PRM)
 18553        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18554     END-IF
 18555
 18556     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18557
 18558     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18559                OR
 18560        ((ISS-WK - CNC-WK) = ZEROS)
 18561        MOVE ZEROS          TO COMM-WK
 18562     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 355
* ECS010.cbl
 18563        COMPUTE EC-FACT ROUNDED =
 18564           EPR-PRO / (ISS-PRM - CNC-PRM)
 18565        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18566     END-IF
 18567
 18568     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18569
 18570     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18571                OR
 18572        ((ISS-WK - CNC-WK) = ZEROS)
 18573        MOVE ZEROS          TO COMM-WK
 18574     ELSE
 18575        COMPUTE EC-FACT ROUNDED =
 18576           EPR-ST / (ISS-PRM - CNC-PRM)
 18577        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18578     END-IF
 18579
 18580     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18581
 18582     IF A-H-FULLY-EARNED
 18583        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18584        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18585                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18586        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18587                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18588     END-IF
 18589
 18590     .
 18591 4375-EXIT.
 18592     EXIT.
 18593
 18594
 18595 4376-DCC-DDF-SPEC.
 18596
 18597     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18598                                 THRU 4910-EXIT
 18599
 18600     display ' acct - cert ' cr-account ' ' cr-cert-no
 18601     display ' orig term rem term ' orig-term ' ' rem-trm1
 18602     display ' agt type ' cr-agt-type (sub1)
 18603     COMPUTE CP-MONTH =
 18604        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18605     IF CP-MONTH = 0
 18606        MOVE 12 TO CP-MONTH
 18607     END-IF
 18608
 18609     EVALUATE TRUE
 18610        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18611           PERFORM 4380-REF-CSO-ADMIN-FEE
 18612                                 THRU 4380-EXIT
 18613        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18614           AND (CR-CANCEL-REASON = 'R')
 18615              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18616        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18617           EVALUATE TRUE
 18618              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18619                 OR (NOT DD-IU-PRESENT)
 18620                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 356
* ECS010.cbl
 18621                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18622                       / CR-AH-CLP
 18623                 end-if
 18624                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18625                    (CR-LCOM-AH (SUB1) * +1000)
 18626               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18627                  AND (DD-IU-PRESENT)
 18628                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18629                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18630                     WS-LO-UEF) * 3/12
 18631                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18632                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18633                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18634                    (CR-LCOM-AH (SUB1) * +1000)
 18635                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18636                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18637                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18638                     * (CP-MONTH - 3) / 9
 18639              WHEN (ORIG-TERM - REM-TRM1) > 12
 18640                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18641                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18642                    CP-MONTH / 12)
 18643           END-EVALUATE
 18644        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18645           EVALUATE TRUE
 18646              WHEN CR-CANCEL-REASON = 'R'
 18647                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18648                    + CR-ADDL-CLP))
 18649              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18650                 OR (NOT DD-IU-PRESENT)
 18651                   if ueclp-clp-fact = zeros
 18652                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18653                       / CR-AH-CLP
 18654                   end-if
 18655                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18656                       (CR-AHPRM - (CR-AH-CLP
 18657                       + CR-ADDL-CLP))
 18658              WHEN (ORIG-TERM - REM-TRM1) < 13
 18659                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18660                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18661                     WS-LO-UEF) * 3/12
 18662                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18663                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18664                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18665                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18666                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18667                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18668                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18669                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18670              WHEN (ORIG-TERM - REM-TRM1) > 12
 18671                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18672                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18673                    WS-LO-UEF) * CP-MONTH / 12)
 18674           END-EVALUATE
 18675     END-EVALUATE
 18676
 18677     .
 18678 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 357
* ECS010.cbl
 18679     EXIT.
 18680
 18681
 18682
 18683 4380-REF-CSO-ADMIN-FEE.
 18684
 18685*    IF CR-AH-CANC-DT NOT = ZEROS
 18686*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18687*       MOVE CR-AH-TERM          TO ORIG-TERM
 18688*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18689*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18690*       MOVE '1'                 TO W-VAL-SOURCE
 18691*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18692*                                THRU 8599-REM-TERM-X
 18693*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18694*    END-IF
 18695
 18696     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18697                                 THRU 4910-EXIT
 18698
 18699     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18700        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18701
 18702     MOVE ZEROS                  TO CNC-WK
 18703
 18704     EVALUATE TRUE
 18705        WHEN (REM-TRM1 = 0)
 18706           OR (CR-CANCEL-REASON = 'R')
 18707           DISPLAY ' REM TERM = 0 OR REPO'
 18708           MOVE 0                TO CNC-WK
 18709
 18710        WHEN REM-TRM1 = ORIG-TERM
 18711           DISPLAY ' REM TERM  = ORIG TERM '
 18712           MOVE ISS-WK           TO CNC-WK
 18713
 18714        WHEN (ORIG-TERM - REM-TRM1) < 4
 18715           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18716           COMPUTE CP-MONTH =
 18717              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18718           IF CP-MONTH = 0
 18719              MOVE 12 TO CP-MONTH
 18720           END-IF
 18721           DISPLAY ' CP MONTH ' CP-MONTH
 18722           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18723              (DD-1ST-YR-ALLOW (D1)
 18724              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18725              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18726           COMPUTE CNC-WK = W-FACTOR * 1
 18727
 18728**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18729
 18730        WHEN (ORIG-TERM - REM-TRM1) < 13
 18731           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18732           COMPUTE CP-MONTH =
 18733              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18734           IF CP-MONTH = 0
 18735              MOVE 12 TO CP-MONTH
 18736           END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 358
* ECS010.cbl
 18737           DISPLAY ' CP MONTH ' CP-MONTH
 18738           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18739              DD-1ST-YR-ALLOW (D1))
 18740              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18741              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18742           COMPUTE CNC-WK = W-FACTOR * 1
 18743
 18744****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18745
 18746        WHEN OTHER
 18747           DISPLAY ' OTHER '
 18748           COMPUTE CP-MONTH =
 18749              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18750           IF CP-MONTH = 0
 18751              MOVE 12 TO CP-MONTH
 18752           END-IF
 18753           DISPLAY ' CP MONTH ' CP-MONTH
 18754           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18755              DD-1ST-YR-ALLOW (D1))
 18756              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18757              * CP-MONTH / 12)
 18758           COMPUTE CNC-WK = W-FACTOR * 1
 18759     END-EVALUATE
 18760
 18761     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18762        ' ' CNC-WK
 18763
 18764     .
 18765 4380-EXIT.
 18766     EXIT.
 18767
 18768******************************************************************
 18769******************************************************************
 18770******************************************************************
 18771******************************************************************
 18772******************************************************************
 18773******************************************************************
 18774******************************************************************
 18775******************************************************************
 18776******************************************************************
 18777******************************************************************
 18778***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18779******************************************************************
 18780
 18781 S-4100-EP-DO-LF.
 18782
 18783     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18784                                        EPR-PRO
 18785                                        EPR-ST.
 18786
 18787     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18788     MOVE 'L'                    TO DC-OPTION-CODE.
 18789     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18790
 18791     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18792     MOVE -1                     TO DC-ELAPSED-DAYS.
 18793     MOVE '6'                    TO DC-OPTION-CODE.
 18794     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 359
* ECS010.cbl
 18795
 18796     MOVE +0                     TO DC-ELAPSED-MONTHS
 18797                                    DC-ELAPSED-DAYS.
 18798
 18799     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18800     MOVE ' '                    TO DC-OPTION-CODE.
 18801     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18802
 18803     IF NO-CONVERSION-ERROR
 18804        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18805     ELSE
 18806         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18807                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18808                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18809         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18810                                     TO WS-ABEND-MESSAGE
 18811         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18812         MOVE 4001                   TO WS-ABEND-CODE
 18813         GO TO ABEND-PGM.
 18814
 18815     IF CR-LFTYP = ZERO
 18816         GO TO S-4200-EP-DO-AH.
 18817
 18818     IF REIN-LF-FLG (SUB5) = SPACE
 18819         GO TO S-4200-EP-DO-AH.
 18820
 18821     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18822     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18823     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18824
 18825     MOVE CR-LF-TERM             TO ORIG-TERM.
 18826     MOVE CLAS-INDEXL            TO W-NDX.
 18827
 18828 S-4120-EP-DO-LF-CNCL.
 18829
 18830     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18831        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18832         GO TO S-4130-EP-DO-LF-EP.
 18833
 18834     COMPUTE EARNED-BY-CANCEL =
 18835                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18836
 18837 S-4130-EP-DO-LF-EP.
 18838
 18839     MOVE SPACE                  TO STATUTORY-SWITCH.
 18840
 18841     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18842     MOVE '9'                    TO W-VAL-SOURCE.
 18843     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18844
 18845     IF REM-TRM2 GREATER CR-LF-TERM
 18846         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18847         GO TO S-4190-EP-DO-LF-COMM.
 18848
 18849     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18850         GO TO S-4180-EP-DO-LF-EP-SUM.
 18851
 18852     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 360
* ECS010.cbl
 18853         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18854             IF REM-TRM2 NOT GREATER THAN +0
 18855                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18856                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18857                 GO TO S-4190-EP-DO-LF-COMM
 18858             ELSE
 18859                 NEXT SENTENCE
 18860         ELSE
 18861             IF W-BAL-REMTRM NOT GREATER +0
 18862                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18863                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18864                 GO TO S-4190-EP-DO-LF-COMM
 18865             ELSE
 18866                 NEXT SENTENCE
 18867     ELSE
 18868        IF (DTE-CLIENT EQUAL 'NCL') AND
 18869           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18870             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18871        ELSE
 18872         IF REM-TRM2 NOT GREATER +0  OR
 18873            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18874             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18875             GO TO S-4190-EP-DO-LF-COMM.
 18876
 18877     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18878         GO TO S-4140-EP-DO-LF-EP-TEX.
 18879
 18880     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18881         GO TO S-4150-EP-DO-LF-EP-NP.
 18882
 18883*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18884     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18885        (CR-RATING-CLASS NOT = 'L ')
 18886         IF (CR-APR GREATER THAN ZERO)  AND
 18887            (CR-LF-TERM GREATER THAN 060)  AND
 18888            (CR-DT GREATER THAN 19831031)
 18889             MOVE '*'             TO STATUTORY-SWITCH
 18890              GO TO S-4150-EP-DO-LF-EP-NP.
 18891
 18892     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18893         IF (CR-APR GREATER THAN ZERO)  AND
 18894            (CR-LF-TERM GREATER THAN 061)  AND
 18895            (CR-DT GREATER THAN 19830318)
 18896             MOVE '*'             TO STATUTORY-SWITCH
 18897              GO TO S-4150-EP-DO-LF-EP-NP.
 18898
 18899     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18900         IF (CR-APR GREATER THAN ZERO)  AND
 18901            (CR-LF-TERM GREATER THAN 062)  AND
 18902            (CR-DT GREATER THAN 19810831)  AND
 18903            (CR-DT LESS THAN 19830901)
 18904             MOVE '*'             TO STATUTORY-SWITCH
 18905              GO TO S-4150-EP-DO-LF-EP-NP.
 18906
 18907     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18908         IF (CR-APR GREATER THAN ZERO)  AND
 18909            (CR-LF-TERM GREATER THAN 060)  AND
 18910            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 361
* ECS010.cbl
 18911             MOVE '*'             TO STATUTORY-SWITCH
 18912              GO TO S-4150-EP-DO-LF-EP-NP.
 18913
 18914     GO TO S-4160-EP-DO-LF-EP-R78.
 18915
 18916 S-4140-EP-DO-LF-EP-TEX.
 18917
 18918     COMPUTE TEX-FACT-4 =
 18919         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18920     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18921         GIVING TEX-FACT-5
 18922             REMAINDER TEX-FACT-6.
 18923     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18924     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18925         (TEX-FACT-5 * CR-PMT-FREQ) +
 18926         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18927     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18928
 18929     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18930
 18931     GO TO S-4170-EP-DO-LF-EP-PRO.
 18932
 18933 S-4150-EP-DO-LF-EP-NP.
 18934
 18935     IF WE-LFPRM = ZERO
 18936         GO TO S-4160-EP-DO-LF-EP-R78.
 18937
 18938     IF DTE-CLIENT = 'CRI'
 18939       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18940             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18941           GO TO S-4160-EP-DO-LF-EP-R78.
 18942
 18943     IF DTE-CLIENT = 'NCL'
 18944       IF CR-DT LESS THAN 19910101
 18945           GO TO S-4160-EP-DO-LF-EP-R78.
 18946
 18947     IF REM-TRM1 = CR-LF-TERM
 18948         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18949         GO TO S-4190-EP-DO-LF-COMM.
 18950
 18951     MOVE CR-APR TO NP-APR.
 18952     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18953     MOVE REM-TRM1 TO NP-REM.
 18954     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18955     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18956         MOVE CR-LOAN-TERM TO NP-ORIG.
 18957     MOVE 'R' TO NP-OPT.
 18958     CALL 'ECSNETRM'
 18959         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18960
 18961     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18962
 18963     IF STATUTORY-REQUIREMENT
 18964         MOVE EPR-R78                TO EPR-ST.
 18965
 18966 S-4160-EP-DO-LF-EP-R78.
 18967
 18968     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 362
* ECS010.cbl
 18969        (DTE-CLIENT EQUAL 'NCL')
 18970        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18971           (CR-MO EQUAL EOM-MO)
 18972           MOVE '*'            TO OB-DATE-1-SWITCH
 18973           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18974           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18975           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18976           COMPUTE WS-EPR-R78 (SUB3 1) =
 18977                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18978           GO TO S-4190-EP-DO-LF-COMM
 18979        ELSE
 18980        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18981           (CR-MO EQUAL OB-MO (1))
 18982           MOVE '*'            TO OB-DATE-2-SWITCH
 18983           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18984           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18985           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18986           COMPUTE WS-EPR-R78 (SUB3 2) =
 18987                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 18988           GO TO S-4190-EP-DO-LF-COMM
 18989        ELSE
 18990        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18991           (CR-MO EQUAL OB-MO (2))
 18992           MOVE '*'            TO OB-DATE-3-SWITCH
 18993           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18994           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18995           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18996           COMPUTE WS-EPR-R78 (SUB3 3) =
 18997                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 18998           GO TO S-4190-EP-DO-LF-COMM
 18999        ELSE
 19000           GO TO S-4190-EP-DO-LF-COMM.
 19001
 19002     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19003
 19004     IF DTE-R78 = '1'
 19005         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 19006     ELSE
 19007         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19008
 19009     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19010
 19011     IF REM-TRM1 GREATER THAN +0
 19012         COMPUTE TEMP-7 ROUNDED EQUAL
 19013             WE-LFPRM - (WE-LFPRM * TEMP-4)
 19014     ELSE
 19015         MOVE WE-LFPRM                TO TEMP-7.
 19016
 19017     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19018         MOVE TEMP-7                 TO EPR-ST.
 19019
 19020     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19021         MOVE ZEROS                  TO TEMP-8
 19022         GO TO S-4165-END-LF-EP-R78.
 19023
 19024     IF EPR-ST NOT = ZEROS
 19025         MOVE TEMP-7                 TO EPR-ST.
 19026
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 363
* ECS010.cbl
 19027     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19028         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 19029         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 19030         IF DTE-R78 = '1'
 19031             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 19032
 19033     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19034
 19035     COMPUTE TEMP-8 ROUNDED =
 19036               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 19037
 19038 S-4165-END-LF-EP-R78.
 19039
 19040     IF EPR-R78 = ZEROS
 19041         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 19042     ELSE
 19043         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 19044
 19045 S-4170-EP-DO-LF-EP-PRO.
 19046
 19047     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19048         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 19049     ELSE
 19050         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19051
 19052     IF REM-TRM1 GREATER THAN +0
 19053         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 19054     ELSE
 19055         MOVE WE-LFPRM                  TO TEMP-7.
 19056
 19057     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19058         MOVE ZEROS                     TO TEMP-8
 19059         GO TO S-4175-END-LF-EP-PRO.
 19060
 19061     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19062         IF DTE-CLIENT = 'MIC' OR 'MCC'
 19063             COMPUTE TEMP-5 ROUNDED =
 19064                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 19065         ELSE
 19066             COMPUTE TEMP-5 ROUNDED =
 19067                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 19068
 19069     COMPUTE TEMP-8 ROUNDED =
 19070                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 19071
 19072     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 19073
 19074 S-4175-END-LF-EP-PRO.
 19075
 19076     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 19077
 19078     GO TO S-4185-EP-DO-LF-STATUTORY.
 19079
 19080 S-4180-EP-DO-LF-EP-SUM.
 19081
 19082     IF REM-TRM1 NOT GREATER +0
 19083         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19084         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 364
* ECS010.cbl
 19085         GO TO S-4190-EP-DO-LF-COMM.
 19086
 19087     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19088         MOVE ZEROS                 TO TEMP-7
 19089     ELSE
 19090         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19091                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19092
 19093     IF TEMP-7 NOT GREATER ZERO
 19094         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19095             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19096             GO TO S-4190-EP-DO-LF-COMM
 19097         ELSE
 19098             MOVE ZEROS             TO TEMP-7.
 19099
 19100     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19101     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19102     IF DTE-R78 = '1'
 19103         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19104
 19105     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19106     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19107
 19108     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19109
 19110     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19111
 19112     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19113         GO TO S-4185-EP-DO-LF-STATUTORY.
 19114
 19115     MOVE EPR-R78                  TO EPR-ST.
 19116
 19117     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19118         MOVE ZEROS                 TO TEMP-8
 19119     ELSE
 19120         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19121                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19122
 19123     IF TEMP-8 NOT GREATER ZERO
 19124         GO TO S-4185-EP-DO-LF-STATUTORY.
 19125
 19126     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19127                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19128
 19129     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19130                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19131
 19132     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19133                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19134
 19135 S-4185-EP-DO-LF-STATUTORY.
 19136
 19137*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19138*08473          MOVE EPR-R78                TO EPR-ST.
 19139
 19140     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19141         MOVE EPR-PRO                TO EPR-ST.
 19142
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 365
* ECS010.cbl
 19143     IF (DTE-CLIENT = 'CID') AND
 19144        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19145        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19146        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19147           GO TO S-4187-EP-DO-LF-STAT-ROA
 19148     END-IF.
 19149
 19150     IF EPR-ST NOT = ZEROS
 19151         GO TO S-4190-EP-DO-LF-COMM.
 19152
 19153     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19154         MOVE EPR-R78                TO EPR-ST
 19155     ELSE
 19156         MOVE EPR-PRO                TO EPR-ST.
 19157
 19158     GO TO S-4190-EP-DO-LF-COMM.
 19159
 19160 S-4187-EP-DO-LF-STAT-ROA.
 19161     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19162     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19163     MOVE 'L'                        TO DC-OPTION-CODE.
 19164     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19165     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19166     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19167        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19168        MOVE '3'                 TO  DC-OPTION-CODE
 19169        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19170                              8099-DATE-CONVERT-X
 19171        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19172     ELSE
 19173        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19174        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19175        MOVE +0                  TO  DC-ELAPSED-DAYS
 19176        MOVE '6'                 TO  DC-OPTION-CODE
 19177        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19178                              8099-DATE-CONVERT-X
 19179        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19180     END-IF
 19181     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19182     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19183     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19184     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19185     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19186     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19187     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19188     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19189     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19190     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19191                                        CP-LOAN-TERM.
 19192     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19193                                        CP-RATING-BENEFIT-AMT.
 19194     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19195         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19196     ELSE
 19197         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19198     END-IF.
 19199     MOVE CR-APR                     TO CP-LOAN-APR.
 19200     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 366
* ECS010.cbl
 19201     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19202     MOVE '6'                        TO CP-EARNING-METHOD.
 19203     MOVE '3'                        TO CP-PROCESS-TYPE.
 19204     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19205     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19206         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19207     ELSE
 19208         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19209     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19210     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19211     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19212     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19213     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19214     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19215
 19216
 19217     IF CP-STATE-STD-ABBRV = 'OR'
 19218        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19219     END-IF
 19220
 19221     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19222        COMPUTE CP-ORIGINAL-BENEFIT =
 19223         (CR-LFAMT - CR-LFPRM)
 19224     END-IF
 19225
 19226     IF CP-TRUNCATED-LIFE
 19227        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19228     END-IF
 19229
 19230     IF CP-TERM-IS-DAYS
 19231        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19232     ELSE
 19233        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19234     END-IF
 19235
 19236     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19237
 19238     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19239
 19240 S-4190-EP-DO-LF-COMM.
 19241
 19242     IF EARNED-BY-CANCEL = ZEROS
 19243         GO TO S-4195-LF-COMM-CONTINUE.
 19244
 19245     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19246         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19247
 19248     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19249         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19250
 19251     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19252         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19253
 19254 S-4195-LF-COMM-CONTINUE.
 19255
 19256     MOVE +0 TO SUB1.
 19257     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19258         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 367
* ECS010.cbl
 19259
 19260     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19261     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19262     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19263
 19264     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19265     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19266     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19267
 19268     MOVE 'Y'          TO EW-LEVEL-USED.
 19269
 19270     IF CR-POLICY-UNDERWRITTEN
 19271         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19272
 19273     ELSE
 19274         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19275
 19276     GO TO S-4200-EP-DO-AH.
 19277
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 368
* ECS010.cbl
 19279******************************************************************
 19280***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19281******************************************************************
 19282
 19283 S-4200-EP-DO-AH.
 19284
 19285     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19286                                        EPR-PRO
 19287                                        EPR-ST.
 19288
 19289     IF CR-AHTYP = ZERO
 19290         GO TO S-4299-EPBX.
 19291
 19292     IF REIN-AH-FLG (SUB5) = SPACE
 19293         GO TO S-4299-EPBX.
 19294
 19295     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19296     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19297     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19298
 19299     MOVE CR-AH-TERM           TO ORIG-TERM.
 19300     MOVE CLAS-INDEXA          TO W-NDX.
 19301
 19302     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19303     MOVE '9'                    TO W-VAL-SOURCE.
 19304     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19305
 19306 S-4220-EP-DO-AH-CNCL.
 19307
 19308     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19309         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19310
 19311 S-4230-EP-DO-AH-EP.
 19312
 19313     IF REM-TRM2 GREATER CR-AH-TERM
 19314         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19315         GO TO S-4290-EP-DO-AH-COMM.
 19316
 19317     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19318         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19319
 19320 S-4235-CHECK-OB-AH-NCL.
 19321
 19322     IF (DTE-CLIENT EQUAL 'NCL') AND
 19323        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19324           MOVE WE-AHPRM         TO EPR-R78
 19325                                    EPR-PRO
 19326                                    EPR-ST
 19327        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19328           (CR-MO EQUAL EOM-MO)
 19329           MOVE '*'            TO OB-DATE-1-SWITCH
 19330           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19331           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19332           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19333           COMPUTE WS-EPR-R78 (SUB3 1) =
 19334                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19335            GO TO S-4290-EP-DO-AH-COMM
 19336        ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 369
* ECS010.cbl
 19337        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19338           (CR-MO EQUAL OB-MO (1))
 19339           MOVE '*'            TO OB-DATE-2-SWITCH
 19340           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19341           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19342           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19343           COMPUTE WS-EPR-R78 (SUB3 2) =
 19344                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19345            GO TO S-4290-EP-DO-AH-COMM
 19346        ELSE
 19347        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19348           (CR-MO EQUAL OB-MO (2))
 19349           MOVE '*'            TO OB-DATE-3-SWITCH
 19350           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19351           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19352           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19353           COMPUTE WS-EPR-R78 (SUB3 3) =
 19354                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19355            GO TO S-4290-EP-DO-AH-COMM
 19356        ELSE
 19357            GO TO S-4290-EP-DO-AH-COMM.
 19358
 19359     IF REM-TRM2 NOT GREATER +0
 19360         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19361         GO TO S-4290-EP-DO-AH-COMM.
 19362
 19363     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19364         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19365         GO TO S-4290-EP-DO-AH-COMM.
 19366
 19367     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19368     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19369     IF DTE-R78 = '1'
 19370         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19371     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19372
 19373     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19374         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19375     ELSE
 19376         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19377
 19378     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19379     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19380
 19381     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19382     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19383
 19384     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19385
 19386*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19387*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19388
 19389     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19390
 19391     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19392        (CR-DT GREATER THAN  19921231)
 19393         IF CR-AH-TERM GREATER THAN  +61
 19394             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 370
* ECS010.cbl
 19395             MOVE '*' TO STATUTORY-SWITCH-AH
 19396             GO TO S-4245-EP-DO-AH-EP-AN
 19397         ELSE
 19398             GO TO S-4250-EP-DO-AH-STATUTORY.
 19399
 19400     IF AH-EARN-METHOD EQUAL 'N'
 19401         GO TO S-4240-EP-DO-AH-EP-NP.
 19402
 19403     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19404         MOVE 'A' TO AH-EARN-METHOD
 19405         GO TO S-4245-EP-DO-AH-EP-AN.
 19406
 19407     GO TO S-4250-EP-DO-AH-STATUTORY.
 19408
 19409 S-4240-EP-DO-AH-EP-NP.
 19410
 19411     IF WE-AHPRM = ZERO
 19412         GO TO S-4250-EP-DO-AH-STATUTORY.
 19413
 19414     IF CR-APR GREATER THAN +0
 19415         NEXT SENTENCE
 19416     ELSE
 19417         GO TO S-4250-EP-DO-AH-STATUTORY.
 19418
 19419     IF DTE-CLIENT = 'NCL'
 19420       IF CR-DT LESS THAN 19910101
 19421           GO TO S-4250-EP-DO-AH-STATUTORY.
 19422
 19423     IF REM-TRM1 = CR-AH-TERM
 19424         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19425         GO TO S-4290-EP-DO-AH-COMM.
 19426
 19427     MOVE CR-APR TO NP-APR.
 19428     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19429     MOVE REM-TRM1 TO NP-REM.
 19430     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19431     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19432         MOVE CR-LOAN-TERM TO NP-ORIG.
 19433     MOVE 'R' TO NP-OPT.
 19434     CALL 'ECSNETRM'
 19435         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19436
 19437     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19438
 19439     GO TO S-4250-EP-DO-AH-STATUTORY.
 19440
 19441 S-4245-EP-DO-AH-EP-AN.
 19442     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19443     MOVE 'L'                        TO DC-OPTION-CODE.
 19444     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19445     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19446     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19447     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19448     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19449     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19450     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19451     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19452     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 371
* ECS010.cbl
 19453     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19454                                        CP-RATING-BENEFIT-AMT.
 19455     IF CP-STATE-STD-ABBRV = 'OR'
 19456         COMPUTE CP-RATING-BENEFIT-AMT =
 19457                                  CR-AHAMT * REM-TRM1.
 19458     MOVE CR-APR                     TO CP-LOAN-APR.
 19459     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19460     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19461     MOVE '3'                        TO CP-PROCESS-TYPE.
 19462     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19463     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19464
 19465     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19466         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19467     ELSE
 19468         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19469
 19470     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19471     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19472     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19473     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19474     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19475     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19476
 19477     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19478
 19479     IF CP-ERROR-RATE-NOT-FOUND  OR
 19480        CP-ERROR-RATE-IS-ZERO  OR
 19481        CP-ERROR-IN-DATES
 19482         GO TO S-4250-EP-DO-AH-STATUTORY.
 19483
 19484     COMPUTE EPR-R78 ROUNDED =
 19485             (REM-TRM1 * WE-AHAMT / +100 *
 19486               CP-PREMIUM-RATE)
 19487              / CR-AHPRM-CALC * CR-AHPRM
 19488
 19489     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19490
 19491     IF STATUTORY-REQUIREMENT-AH
 19492         MOVE EPR-R78                TO EPR-ST
 19493         GO TO S-4290-EP-DO-AH-COMM.
 19494
 19495 S-4250-EP-DO-AH-STATUTORY.
 19496     IF (DTE-CLIENT EQUAL 'CID') AND
 19497        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19498         GO TO S-4267-EP-DO-AH-STAT-ROA
 19499     END-IF.
 19500
 19501 S-4250-EP-DO-AH-STATUTORY-VA.
 19502
 19503     MOVE EPR-R78                    TO EPR-ST.
 19504
 19505     MOVE +0                         TO SUB1.
 19506
 19507 S-4255-EP-AH-STAT-LOOP.
 19508     ADD +1 TO SUB1.
 19509
 19510     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 372
* ECS010.cbl
 19511         MOVE EPR-PRO                TO EPR-ST
 19512     ELSE
 19513         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19514             GO TO S-4255-EP-AH-STAT-LOOP.
 19515
 19516     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19517         CR-DT GREATER THAN 19831031)
 19518                    OR
 19519        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19520         CR-DT GREATER THAN 19820629)
 19521                    OR
 19522        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19523         CR-DT GREATER THAN 19830831)
 19524             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19525
 19526     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19527       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19528         IF CR-DT LESS THAN 19970101
 19529             MOVE EPR-R78            TO EPR-ST
 19530         ELSE
 19531             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19532
 19533     GO TO S-4290-EP-DO-AH-COMM.
 19534
 19535 S-4267-EP-DO-AH-STAT-ROA.
 19536     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19537     MOVE 'L'                        TO DC-OPTION-CODE.
 19538     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19539     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19540     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19541     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19542     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19543     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19544     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19545     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19546     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19547     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19548                                        CP-RATING-BENEFIT-AMT.
 19549     IF CP-STATE-STD-ABBRV = 'OR'
 19550         COMPUTE CP-RATING-BENEFIT-AMT =
 19551                                  CR-AHAMT * REM-TRM1.
 19552     MOVE CR-APR                     TO CP-LOAN-APR.
 19553     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19554     MOVE 'A'                        TO CP-EARNING-METHOD.
 19555     MOVE '3'                        TO CP-PROCESS-TYPE.
 19556     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19557     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19558     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19559         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19560     ELSE
 19561         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19562     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19563     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19564     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19565     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19566     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19567     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19568
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 373
* ECS010.cbl
 19569     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19570
 19571     IF CP-ERROR-RATE-NOT-FOUND  OR
 19572        CP-ERROR-RATE-IS-ZERO  OR
 19573        CP-ERROR-IN-DATES
 19574         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19575
 19576     COMPUTE EPR-ST ROUNDED =
 19577             (REM-TRM1 * WE-AHAMT / +100 *
 19578               CP-PREMIUM-RATE)
 19579              / CR-AHPRM-CALC * CR-AHPRM
 19580
 19581     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19582
 19583     GO TO S-4290-EP-DO-AH-COMM.
 19584
 19585 S-4290-EP-DO-AH-COMM.
 19586
 19587     IF EARNED-BY-CANCEL = ZEROS
 19588         GO TO S-4295-AH-COMM-CONTINUE.
 19589
 19590     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19591         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19592
 19593     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19594         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19595
 19596     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19597         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19598
 19599 S-4295-AH-COMM-CONTINUE.
 19600
 19601     MOVE +0           TO SUB1.
 19602     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19603         10 TIMES.
 19604
 19605     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19606     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19607     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19608
 19609     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19610     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19611     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19612
 19613     MOVE 'Y'          TO EW-LEVEL-USED.
 19614
 19615     IF CR-POLICY-UNDERWRITTEN
 19616         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19617     ELSE
 19618         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19619
 19620
 19621 S-4299-EPBX.
 19622     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 374
* ECS010.cbl
 19624******************************************************************
 19625***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19626******************************************************************
 19627
 19628 S-4300-EP-COMM-LOOP.
 19629
 19630     ADD +1 TO SUB1.
 19631     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19632         GO TO S-4399-EP-COMM-LOOP-X.
 19633
 19634     IF EW-LF-AH = AH-OVERRIDE-L1
 19635         GO TO S-4350-EP-COMM-LOOP-A.
 19636
 19637*    IF CR-AGT-TYPE (SUB1) = 'K'
 19638*       COMPUTE COMM-WK =
 19639     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19640     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19641     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19642                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19643
 19644     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19645     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19646     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19647                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19648
 19649     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19650     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19651
 19652     GO TO S-4399-EP-COMM-LOOP-X.
 19653
 19654 S-4350-EP-COMM-LOOP-A.
 19655
 19656     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19657     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19658     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19659                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19660
 19661     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19662     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19663     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19664                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19665
 19666     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19667     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19668
 19669 S-4399-EP-COMM-LOOP-X.
 19670     EXIT.
 19671
 19672******************************************************************
 19673******************************************************************
 19674******************************************************************
 19675******************************************************************
 19676******************************************************************
 19677******************************************************************
 19678******************************************************************
 19679******************************************************************
 19680******************************************************************
 19681******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 375
* ECS010.cbl
 19683******************************************************************
 19684***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19685******************************************************************
 19686
 19687 4400-EP-FIND-TAB-ENT.
 19688
 19689     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19690         GO TO 4490-EP-FIND-TAB-SUB.
 19691     MOVE +1 TO SUB9.
 19692
 19693 4450-EP-FIND-TAB-LOOP.
 19694
 19695     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19696         GO TO 4490-EP-FIND-TAB-SUB.
 19697     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19698         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19699         GO TO 4490-EP-FIND-TAB-SUB.
 19700
 19701     ADD +1 TO SUB9.
 19702     IF SUB9 GREATER THAN +31
 19703         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19704         MOVE 0201 TO WS-ABEND-CODE
 19705         DISPLAY '******************************'
 19706         DISPLAY '***** ERROR LOCATION 020 *****'
 19707         DISPLAY '******************************'
 19708         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19709         GO TO ABEND-PGM.
 19710
 19711     GO TO 4450-EP-FIND-TAB-LOOP.
 19712
 19713 4490-EP-FIND-TAB-SUB.
 19714
 19715     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19716         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19717             ADD +1 TO SUB10
 19718             MOVE SUB10 TO SUB3
 19719             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19720         ELSE
 19721             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19722
 19723     IF WE-LF-AH = AH-OVERRIDE-L1
 19724         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19725             ADD +1 TO SUB10
 19726             MOVE SUB10 TO SUB3
 19727             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19728         ELSE
 19729             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19730
 19731*    IF SUB3 GREATER THAN +220
 19732*    IF SUB3 GREATER THAN +300
 19733     IF SUB3 GREATER THAN +900
 19734         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19735         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19736         MOVE 0202 TO WS-ABEND-CODE
 19737         DISPLAY '******************************'
 19738         DISPLAY '***** ERROR LOCATION 021 *****'
 19739         DISPLAY '******************************'
 19740         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 376
* ECS010.cbl
 19741         GO TO ABEND-PGM.
 19742
 19743     IF CR-POLICY-UNDERWRITTEN
 19744         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19745         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19746                                     TO EPEC-OPT-WORK-TABLE
 19747     ELSE
 19748         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19749         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19750
 19751     MOVE WE-REIN-CO         TO EW-REIN-CO
 19752                                EPEC-REIN-CO (SUB3)
 19753                                EPEC-REIN-CO-II (SUB3).
 19754     MOVE WE-LF-AH           TO EW-LF-AH
 19755                                EPEC-LF-AH (SUB3)
 19756                                EPEC-LF-AH-II (SUB3).
 19757     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19758                                EPEC-BEN-TYPE (SUB3)
 19759                                EPEC-BEN-TYPE-II (SUB3).
 19760
 19761 4499-EP-FIND-TAB-ENT-X.
 19762     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 377
* ECS010.cbl
 19764******************************************************************
 19765***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19766******************************************************************
 19767
 19768 4500-BUILD-EPEC-EXTRACT.
 19769
 19770     IF (DTE-CLIENT = 'DCC')
 19771*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19772        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19773     END-IF
 19774
 19775     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19776         VARYING SUB2 FROM +1 BY +1
 19777             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19778
 19779     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19780
 19781     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19782
 19783
 19784 4510-BUILD-EPEC-EXT.
 19785
 19786     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19787     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19788     IF EW-LEVEL-USED = 'Y'
 19789         MOVE SPACE                     TO W-UNDERWRITING-SW
 19790         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19791                 4518-BUILD-EPEC-RCD-X.
 19792
 19793     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19794     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19795     IF EW-LEVEL-USED = 'Y'
 19796         MOVE '*'                       TO W-UNDERWRITING-SW
 19797         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19798                 4518-BUILD-EPEC-RCD-X.
 19799
 19800     GO TO 4519-BUILD-EPEC-EXT-X.
 19801
 19802 4511-BUILD-EPEC-RECORD.
 19803
 19804     MOVE SPACES                        TO EP-RECORD.
 19805     MOVE 'EP'                          TO EP-RECORD-ID.
 19806     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19807     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19808     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19809     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19810                                           WS-EP-EFF-DTE-N.
 19811     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19812     IF EP-REI-CO NOT = SPACES
 19813         MOVE 'R'                       TO EP-REIN.
 19814     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19815     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19816
 19817     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19818     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19819     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19820
 19821     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 378
* ECS010.cbl
 19822     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19823     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19824
 19825     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19826     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19827     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19828     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19829
 19830     IF DTE-CLIENT NOT = 'NCL'
 19831         GO TO 4512-BUILD-EPEC-CONTINUE.
 19832
 19833     IF W-UNDERWRITTEN-DATA
 19834         GO TO 4512-BUILD-EPEC-CONTINUE.
 19835
 19836     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19837         GO TO 4512-BUILD-EPEC-CONTINUE.
 19838
 19839     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19840        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19841        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19842         NEXT SENTENCE
 19843     ELSE
 19844         GO TO 4512-BUILD-EPEC-CONTINUE.
 19845
 19846     IF OB-DATE-1-USED  OR
 19847        OB-DATE-2-USED  OR
 19848        OB-DATE-3-USED
 19849         NEXT SENTENCE
 19850     ELSE
 19851         GO TO 4512-BUILD-EPEC-CONTINUE.
 19852
 19853     IF OB-DATE-1-USED
 19854         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19855             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19856                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19857             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19858                                   EW-EPR-ST
 19859             GO TO 4512-BUILD-EPEC-CONTINUE
 19860         ELSE
 19861             GO TO 4512-BUILD-EPEC-CONTINUE.
 19862
 19863     IF OB-DATE-2-USED
 19864         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19865             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19866                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19867             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19868                                   EW-EPR-ST
 19869             GO TO 4512-BUILD-EPEC-CONTINUE
 19870         ELSE
 19871             GO TO 4512-BUILD-EPEC-CONTINUE.
 19872
 19873     IF OB-DATE-3-USED
 19874         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19875             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19876                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19877             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19878                                   EW-EPR-ST
 19879             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 379
* ECS010.cbl
 19880         ELSE
 19881             GO TO 4512-BUILD-EPEC-CONTINUE.
 19882
 19883 4512-BUILD-EPEC-CONTINUE.
 19884
 19885     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19886     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19887     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19888
 19889     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19890     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19891     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19892
 19893     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19894
 19895     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19896     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19897     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19898
 19899     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19900     MOVE ZEROS                         TO EP-CLM-PV.
 19901
 19902     if (dte-client = 'AHL')
 19903        and (ep-rcd-type = 'A')
 19904        and (ep-ben-code (1:1) = 'M')
 19905*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19906        continue
 19907     else
 19908        IF EP-RCD-TYPE = 'A' OR 'U'
 19909           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19910              PERFORM 4599A-CALC-IBNR
 19911                                 THRU 4599A-CALC-EXIT
 19912           end-if
 19913        end-if
 19914     end-if
 19915
 19916     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19917
 19918     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19919     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19920
 19921     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19922
 19923     IF EW-ISS-CNT = ZERO
 19924         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19925                                           EP-AVG-AGE
 19926       ELSE
 19927         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19928                                EW-ORIG-TERM / EW-ISS-CNT
 19929         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19930
 19931     IF EW-INFORCE-CNT = ZERO
 19932         MOVE ZERO                      TO EP-AVG-REM-TERM
 19933       ELSE
 19934         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19935                             EW-REM-TERM / EW-INFORCE-CNT.
 19936
 19937     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 380
* ECS010.cbl
 19938         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19939                                           EP-WEIGHTED-AGE
 19940       ELSE
 19941         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19942                                  EW-TERM-BEN / EW-ISS-BEN
 19943         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19944                                   EW-AGE-BEN / EW-ISS-BEN.
 19945
 19946     MOVE ZEROS                         TO
 19947         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19948         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19949
 19950     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19951                                           WS-EP-HI-COV-DT-N.
 19952     MOVE HIGH-CERT                     TO EP-HI-CERT
 19953                                           WS-EP-HI-CERT-N.
 19954     MOVE LOW-CERT                      TO EP-LO-CERT
 19955                                           WS-EP-LO-CERT-N.
 19956     IF DTE-PGM-OPT = '3'
 19957         MOVE 'P'                       TO EP-PURGE.
 19958
 19959     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19960         GO TO 4514-CONTINUE.
 19961
 19962     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19963
 19964     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19965         MOVE +1                 TO EP-LIFE-YEARS
 19966     ELSE
 19967         MOVE ZEROS              TO W-LIFE-YEARS
 19968         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19969                 VARYING
 19970             SUBM FROM +1 BY +1
 19971                 UNTIL
 19972             SUBM GREATER THAN +13
 19973         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19974             = W-LIFE-YEARS / 12
 19975             - (EPEC-LIFE-CTR (SUB2 1)
 19976             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19977         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19978         IF  EP-LIFE-YEARS LESS THAN +1
 19979             MOVE +1             TO EP-LIFE-YEARS.
 19980
 19981 4514-CONTINUE.
 19982
 19983     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 19984
 19985     MOVE SPACES                        TO EC-RECORD.
 19986     MOVE '1'                           TO WS-SEQ-NBR.
 19987     MOVE +0                            TO SUB3.
 19988     MOVE +0                            TO SUB4.
 19989     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 19990         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 19991         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 19992
 19993     GO TO 4518-BUILD-EPEC-RCD-X.
 19994
 19995 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 381
* ECS010.cbl
 19996
 19997     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 19998
 19999 4515-EXIT.
 20000     EXIT.
 20001
 20002 4518-BUILD-EPEC-RCD-X.
 20003     EXIT.
 20004
 20005 4519-BUILD-EPEC-EXT-X.
 20006     EXIT.
 20007
 20008 4520-BUILD-EPEC-LOAD-COMM.
 20009
 20010     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 20011
 20012     ADD +1 TO SUB3  SUB4.
 20013     MOVE ZEROS                  TO LEVELS-BUILT.
 20014
 20015 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20016
 20017     IF SUB4 GREATER THAN WS-LOOP-MAX
 20018         IF AGT-SW = 'X'
 20019             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20020                 THRU 4900-WRT-SUMMARY-X
 20021             MOVE ' '            TO AGT-SW
 20022             MOVE WS-LOOP-MAX    TO  SUB4
 20023             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20024         ELSE
 20025             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 20026
 20027     IF LEVELS-BUILT EQUAL +5
 20028         IF AGT-SW = 'X'
 20029             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20030                 THRU 4900-WRT-SUMMARY-X
 20031             MOVE ' '            TO AGT-SW
 20032             MOVE ZEROS          TO LEVELS-BUILT
 20033             ADD 1 TO WS-SEQ-NBR
 20034             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 20035             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 20036                     4540-BUILD-CLEAR-X
 20037                 VARYING SUB3 FROM +1 BY +1
 20038                 UNTIL SUB3 GREATER THAN +5
 20039             MOVE +1             TO SUB3
 20040             GO TO 4531-BUILD-EPEC-LOAD-COMM
 20041         ELSE
 20042             MOVE +1             TO SUB3
 20043             MOVE ZEROS          TO LEVELS-BUILT
 20044             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 20045
 20046     IF SUB4 GREATER THAN WS-LOOP-MAX
 20047         IF AGT-SW = 'X'
 20048             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20049                 THRU 4900-WRT-SUMMARY-X
 20050             MOVE ' '                   TO AGT-SW
 20051             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20052         ELSE
 20053             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 382
* ECS010.cbl
 20054
 20055 4531-BUILD-EPEC-LOAD-COMM.
 20056
 20057     IF (EW-AGT-NO (SUB4) = SPACES)
 20058                  OR
 20059        ((EW-ISS-COM (SUB4) = ZEROS) AND
 20060         (EW-CNC-COM (SUB4) = ZEROS) AND
 20061         (EW-ECR-R78 (SUB4) = ZEROS) AND
 20062         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 20063         (EW-ECR-PRO (SUB4) = ZEROS) AND
 20064         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 20065         (EW-ECR-ST (SUB4) = ZEROS))
 20066         PERFORM 4540-BUILD-EPEC-CLEAR
 20067             THRU 4540-BUILD-CLEAR-X
 20068         ADD +1 TO SUB4
 20069         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20070
 20071     MOVE 'X'                           TO AGT-SW.
 20072     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 20073     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 20074     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 20075     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 20076     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 20077     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 20078     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 20079     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 20080     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 20081
 20082     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 20083
 20084     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20085
 20086 4539-BUILD-EPEC-LOAD-COMM-X.
 20087     EXIT.
 20088
 20089 4540-BUILD-EPEC-CLEAR.
 20090
 20091     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20092     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20093     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20094                                           EC-CNC-COMM (SUB3)
 20095                                           EC-COMM-78 (SUB3)
 20096                                           EC-COMM-PR (SUB3)
 20097                                           EC-COMM-ST (SUB3)
 20098                                           EC-COMM-78-ADJ (SUB3)
 20099                                           EC-COMM-PR-ADJ (SUB3).
 20100
 20101 4540-BUILD-CLEAR-X.
 20102     EXIT.
 20103
 20104 4541-CALC-IBNR.
 20105
 20106     MOVE +0                    TO TOT-AH-IBNR
 20107                                   TOT-AH-PRM
 20108                                   TOT-AH-PD-CLMS
 20109                                   TOT-AH-CLMRSV
 20110                                   TOT-LF-IBNR
 20111                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 383
* ECS010.cbl
 20112                                   TOT-LF-PD-CLMS
 20113                                   TOT-LF-CLMRSV
 20114
 20115     MOVE +0                    TO RTOT-AH-IBNR
 20116                                   RTOT-AH-PRM
 20117                                   RTOT-AH-PRMB
 20118                                   RTOT-AH-PD-CLMS
 20119                                   RTOT-AH-CLMRSV
 20120                                   RTOT-LF-IBNR
 20121                                   RTOT-LF-PRM
 20122                                   RTOT-LF-PD-CLMS
 20123                                   RTOT-LF-CLMRSV
 20124
 20125     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20126        (SUB2 > +900)
 20127        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20128*       IF W-UNDERWRITTEN-DATA
 20129*          MOVE EPEC-LEVELS-II (SUB2)
 20130*                                TO EPEC-WORK
 20131*       ELSE
 20132           MOVE EPEC-LEVELS (SUB2)
 20133                                 TO EPEC-WORK
 20134*       END-IF
 20135*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20136           IF EW-REIN-CO = SPACES
 20137              CONTINUE
 20138*             IF EW-LF-AH = 'L'
 20139*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20140*                   + EW-EPR-ST
 20141*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20142*                   + EW-CLM-AMT
 20143*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20144*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20145*             ELSE
 20146*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20147*                   + EW-EPR-ST
 20148*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20149*                   + EW-CLM-AMT
 20150*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20151*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20152           ELSE
 20153              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20154                 EW-LF-AH ' ' EW-BEN-TYPE
 20155              IF EW-LF-AH = 'L'
 20156                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20157                    + EW-EPR-ST
 20158                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20159                    + EW-CLM-AMT
 20160                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20161                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20162              ELSE
 20163                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20164                    + EW-EPR-ST
 20165                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20166                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20167                       + EW-EPR-ST
 20168                 END-IF
 20169                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 384
* ECS010.cbl
 20170                    + EW-CLM-AMT
 20171                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20172                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20173              END-IF
 20174           END-IF
 20175*       END-IF
 20176     END-PERFORM
 20177
 20178*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20179*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20180*    IF TOT-AH-IBNR < ZEROS
 20181*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20182*    END-IF
 20183*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20184*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20185*    IF TOT-LF-IBNR < ZEROS
 20186*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20187*    END-IF
 20188
 20189     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20190        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20191     IF RTOT-AH-IBNR < ZEROS
 20192        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20193     END-IF
 20194     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20195        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20196     IF RTOT-LF-IBNR < ZEROS
 20197        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20198     END-IF
 20199
 20200     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20201        (SUB2 > +900)
 20202        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20203*       IF W-UNDERWRITTEN-DATA
 20204*          MOVE EPEC-LEVELS-II (SUB2)
 20205*                                TO EPEC-WORK
 20206*       ELSE
 20207           MOVE EPEC-LEVELS (SUB2)
 20208                                 TO EPEC-WORK
 20209*       END-IF
 20210*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20211           IF EW-REIN-CO = SPACES
 20212              CONTINUE
 20213*             IF EW-LF-AH = 'L'
 20214*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20215*                   / TOT-LF-PRM
 20216*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20217*                   * RTOT-LF-IBNR
 20218**                  * TOT-LF-IBNR
 20219*             ELSE
 20220*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20221*                   / TOT-AH-PRM
 20222*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20223*                   * RTOT-AH-IBNR
 20224**                  * TOT-AH-IBNR
 20225*             END-IF
 20226           ELSE
 20227              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 385
* ECS010.cbl
 20228                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20229                    EW-EPR-ST ' ' RTOT-AH-PRM
 20230              IF EW-LF-AH = 'L'
 20231                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20232                    / RTOT-LF-PRM
 20233                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20234                    * RTOT-LF-IBNR
 20235              ELSE
 20236                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20237                    / RTOT-AH-PRMB
 20238                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20239                    * RTOT-AH-IBNR
 20240              END-IF
 20241              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20242                 move zeros to ew-clm-ibnr
 20243              end-if
 20244           END-IF
 20245*       END-IF
 20246*       IF W-UNDERWRITTEN-DATA
 20247*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20248*       ELSE
 20249           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20250*       END-IF
 20251     END-PERFORM
 20252
 20253     .
 20254 4541-EXIT.
 20255     EXIT.
 20256
 20257 4545-BUILD-BASE.
 20258
 20259     MOVE 'EC'                   TO EC-RECORD-ID.
 20260     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20261     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20262     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20263     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20264                                    WS-EC-EFF-DTE.
 20265     MOVE EW-REIN-CO             TO EC-REI-CO.
 20266     IF EC-REI-CO NOT = SPACES
 20267         MOVE 'R'                TO EC-REIN.
 20268     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20269     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20270     IF DTE-PGM-OPT = '3'
 20271         MOVE 'P'                TO EC-PURGE.
 20272     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20273
 20274 4545-BUILD-BASE-X.
 20275     EXIT.
 20276
 20277******************************************************************
 20278***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20279******************************************************************
 20280
 20281 4550-CLEAR-EPEC-TOTALS.
 20282
 20283     MOVE LOW-CERT             TO SV-LO-CERT.
 20284     MOVE HIGH-CERT            TO SV-HI-CERT.
 20285     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 386
* ECS010.cbl
 20286     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20287
 20288     MOVE +1                   TO SUB9.
 20289     MOVE +0                   TO SUB10.
 20290     MOVE ZERO                 TO EW-REIN-CO
 20291                                  EW-BEN-TYPE.
 20292     MOVE SPACE                TO EP-FLG
 20293                                  EW-LF-AH
 20294                                  EW-LEVEL-USED
 20295                                  W-TABLE-USED-SW.
 20296
 20297     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20298                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20299                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20300                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20301                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20302                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20303                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20304                                  EW-CLM-AMT     EW-COV-DTE
 20305                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20306                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20307                                  EW-CLM-CRT     EW-ISS-CNT
 20308                                  EW-CNC-CNT     EW-AGE
 20309                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20310                                  EW-AGE-BEN     EW-TERM-BEN
 20311                                  EW-ISS-PRM-TAX
 20312                                  EW-REM-TERM.
 20313
 20314     MOVE +1 TO SUB1.
 20315     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20316     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20317         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20318     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20319                                    EPEC-UNDW-OPT-DATA-TABLE.
 20320     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20321         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20322
 20323     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20324         VARYING SUB3 FROM +1 BY +1
 20325*        UNTIL SUB3 GREATER THAN +300.
 20326*        UNTIL SUB3 GREATER THAN +220.
 20327         UNTIL SUB3 GREATER THAN +900.
 20328
 20329     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20330
 20331 4555-CLEAR-EPEC-COMM.
 20332
 20333     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20334                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20335                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20336                EW-ECR-ST  (SUB1).
 20337     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20338                                    EW-AGT-TYPE (SUB1).
 20339
 20340     ADD +1 TO SUB1.
 20341
 20342 4560-CLEAR-EPEC-ALL.
 20343
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 387
* ECS010.cbl
 20344     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20345                                    EPEC-LEVELS-II (SUB1).
 20346     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20347
 20348 4570-CLEAR-EPEC-SUB-A.
 20349
 20350     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20351     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20352*        UNTIL SUB2 GREATER +300.
 20353         UNTIL SUB2 GREATER +900.
 20354
 20355 4580-CLEAR-EPEC-SUB-B.
 20356
 20357     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20358     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20359
 20360 4589-CLEAR-EPEC-TOTALS-X.
 20361     EXIT.
 20362
 20363 4590-INIT-OB.
 20364
 20365     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20366     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20367     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20368
 20369 4590-EXIT.
 20370     EXIT.
 20371
 20372 4599-BUILD-EPEC-EXTRACT-X.
 20373     EXIT.
 20374
 20375*********************************************************
 20376*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20377*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20378*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20379*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20380*  IN THE DATE CARD.                                    *
 20381*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20382*********************************************************
 20383
 20384 4599A-CALC-IBNR.
 20385
 20386     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20387        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20388                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20389         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20390                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20391                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20392
 20393     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20394         MOVE ZEROS                 TO EW-CLM-IBNR
 20395         GO TO 4599A-CALC-EXIT.
 20396
 20397     IF EP-REIN = 'R'
 20398         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20399
 20400     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20401
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 388
* ECS010.cbl
 20402 4599A-CALC-EXIT.
 20403      EXIT.
 20404 4599B-SEARCH.
 20405      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 389
* ECS010.cbl
 20407******************************************************************
 20408***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20409******************************************************************
 20410
 20411 4600-GET-OPT-IBNR.
 20412
 20413     IF  CR-POLICY-IS-ACTIVE
 20414         IF  CR-POLICY-IS-REISSUE
 20415             OR CR-POLICY-IS-MONTHLY
 20416             IF  W-LIFE
 20417                 GO TO 4600-EXIT
 20418             ELSE
 20419                 NEXT SENTENCE
 20420         ELSE
 20421             NEXT SENTENCE
 20422     ELSE
 20423         IF  W-LIFE
 20424             GO TO 4600-EXIT.
 20425
 20426     IF  W-LIFE
 20427         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20428     ELSE
 20429         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20430
 20431 4600-EXIT.
 20432     EXIT.
 20433
 20434 4620-DETERMINE-LIFE-IBNR.
 20435
 20436     IF  CR-LF-POLICY-IS-ACTIVE
 20437         ADD +1                  TO W-LF-ACTIVE
 20438         IF  CR-LF-POLICY-IS-REISSUE
 20439             OR CR-LF-POLICY-IS-MONTHLY
 20440             MOVE ZEROS          TO W-WK-IBNR
 20441             ADD +1              TO W-LF-REISSUE
 20442             GO TO 4620-EXIT
 20443         ELSE
 20444             NEXT SENTENCE
 20445     ELSE
 20446         ADD +1                  TO W-LF-INACTIVE
 20447         MOVE ZEROS              TO W-WK-IBNR
 20448         GO TO 4620-EXIT.
 20449
 20450     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20451         MOVE ZEROS              TO W-WK-IBNR
 20452         ADD +1                  TO W-LF-CALC-B
 20453         GO TO 4620-EXIT.
 20454
 20455     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20456                 AND
 20457             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20458                 AND
 20459             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20460             OR
 20461         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20462                 AND
 20463             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20464                 AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 390
* ECS010.cbl
 20465             REM-TRM2 NOT GREATER THAN ZERO)
 20466         MOVE ZEROS              TO W-WK-IBNR
 20467         ADD +1                  TO W-LF-BALLOON
 20468         GO TO 4620-EXIT
 20469     ELSE
 20470         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20471                 AND
 20472             REM-TRM2 NOT GREATER THAN ZERO)
 20473             ADD +1              TO W-LF-REMTERM-0
 20474             MOVE ZEROS          TO W-WK-IBNR
 20475             GO TO 4620-EXIT.
 20476
 20477     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20478
 20479     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20480         ADD +1                  TO W-LF-REMAMT-0
 20481         MOVE ZEROS              TO W-WK-IBNR
 20482         GO TO 4620-EXIT.
 20483
 20484     IF  AM-LIFE-IBNR-PCT NUMERIC
 20485             AND
 20486         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20487         COMPUTE W-WK-IBNR ROUNDED
 20488             = CP-REMAINING-AMT
 20489             / 1000
 20490             * AM-LIFE-IBNR-PCT
 20491     ELSE
 20492         COMPUTE W-WK-IBNR ROUNDED
 20493             = CP-REMAINING-AMT
 20494             / 1000
 20495             * COMPANY-IBNR-LIFE-FACTOR.
 20496
 20497     IF  CR-LF-IS-REIN-ONLY
 20498         ADD +1                  TO W-LF-REIN
 20499     ELSE
 20500         ADD +1                  TO W-LF-DATA-USED
 20501         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20502         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20503         IF  CR-LFTYP = '01'
 20504             ADD CP-REMAINING-AMT
 20505                                 TO W-01-REMAMT
 20506             ADD +1              TO W-01-DATA-USED
 20507         ELSE
 20508         IF  CR-LFTYP = '02'
 20509             ADD CP-REMAINING-AMT
 20510                                 TO W-02-REMAMT
 20511             ADD +1              TO W-02-DATA-USED
 20512         ELSE
 20513         IF  CR-LFTYP = '03'
 20514             ADD CP-REMAINING-AMT
 20515                                 TO W-03-REMAMT
 20516             ADD +1              TO W-03-DATA-USED
 20517         ELSE
 20518         IF  CR-LFTYP = '04'
 20519             ADD CP-REMAINING-AMT
 20520                                 TO W-04-REMAMT
 20521             ADD +1              TO W-04-DATA-USED
 20522         ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 391
* ECS010.cbl
 20523         IF  CR-LFTYP = '05'
 20524             ADD CP-REMAINING-AMT
 20525                                 TO W-05-REMAMT
 20526             ADD +1              TO W-05-DATA-USED
 20527         ELSE
 20528         IF  CR-LFTYP = '06'
 20529             ADD CP-REMAINING-AMT
 20530                                 TO W-06-REMAMT
 20531             ADD +1              TO W-06-DATA-USED
 20532         ELSE
 20533         IF  CR-LFTYP = '30'
 20534             ADD CP-REMAINING-AMT
 20535                                 TO W-30-REMAMT
 20536             ADD +1              TO W-30-DATA-USED
 20537         ELSE
 20538         IF  CR-LFTYP = '31'
 20539             ADD CP-REMAINING-AMT
 20540                                 TO W-31-REMAMT
 20541             ADD +1              TO W-31-DATA-USED
 20542         ELSE
 20543             ADD CP-REMAINING-AMT
 20544                                 TO W-XX-REMAMT
 20545             ADD +1              TO W-XX-DATA-USED.
 20546
 20547     IF  CR-POLICY-IS-REIN-ONLY
 20548             OR
 20549         CR-LF-IS-REIN-ONLY
 20550         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20551         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20552         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20553     ELSE
 20554         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20555
 20556 4620-EXIT.
 20557     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 392
* ECS010.cbl
 20559 4640-GET-A-H-EARNED-PREMIUM.
 20560
 20561     IF  CR-AH-POLICY-IS-ACTIVE
 20562         ADD +1                  TO W-AH-ACTIVE
 20563         IF  CR-AH-POLICY-IS-REISSUE
 20564             OR CR-AH-POLICY-IS-MONTHLY
 20565             ADD +1              TO W-AH-REISSUE
 20566         ELSE
 20567             NEXT SENTENCE
 20568     ELSE
 20569         ADD +1                  TO W-AH-INACTIVE.
 20570
 20571     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20572         ADD +1                  TO W-AH-CALC-B
 20573         GO TO 4640-EXIT.
 20574
 20575     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20576         MOVE 'Y'                TO W-RTRM-0-SW
 20577     ELSE
 20578         MOVE SPACES             TO W-RTRM-0-SW.
 20579
 20580     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20581
 20582****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20583******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20584******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20585******        THAT CLAIM.
 20586
 20587     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20588
 20589     IF  CR-POLICY-IS-REIN-ONLY
 20590              OR
 20591         CR-AH-IS-REIN-ONLY
 20592         ADD +1                  TO W-AH-REIN
 20593         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20594         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20595         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20596         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20597         GO TO 4640-EXIT.
 20598
 20599     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20600                                    W-EPEC-EP-IN.
 20601     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20602                                    W-CLAIMS-MADE-PAID-IN.
 20603     ADD +1                      TO W-AH-DATA-USED.
 20604     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20605     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20606
 20607     IF  W-CLMAMT GREATER THAN ZEROS
 20608         ADD +1                  TO W-AH-CLAIM-CTR
 20609         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20610
 20611     IF  W-RTRM-0
 20612             AND
 20613         NOT CR-POLICY-IS-REIN-ONLY
 20614             AND
 20615         NOT CR-AH-IS-REIN-ONLY
 20616         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 393
* ECS010.cbl
 20617         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20618         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20619         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20620         ADD +1                  TO W-AH-REMTERM-0.
 20621
 20622 4640-EXIT.
 20623     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 394
* ECS010.cbl
 20625 4650-DETERMINE-CLM-AMT-AH.
 20626
 20627     MOVE ZEROS                  TO W-CLMAMT.
 20628
 20629     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20630             OR
 20631         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20632         GO TO 4650-EXIT.
 20633
 20634     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20635             AND
 20636         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20637         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20638         MOVE 'L'                    TO DC-OPTION-CODE
 20639         PERFORM 8000-DATE-CONVERT-ROUTINE
 20640             THRU 8099-DATE-CONVERT-X
 20641         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20642         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20643         MOVE 'L'                    TO DC-OPTION-CODE
 20644         PERFORM 8000-DATE-CONVERT-ROUTINE
 20645             THRU 8099-DATE-CONVERT-X
 20646         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20647         IF  DATE-CONVERSION-ERROR
 20648             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20649             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20650             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20651             MOVE 0303               TO WS-ABEND-CODE
 20652             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20653             GO TO ABEND-PGM
 20654         ELSE
 20655             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20656             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20657             MOVE '1'                TO DC-OPTION-CODE
 20658             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20659                                        DC-ELAPSED-DAYS
 20660             PERFORM 8000-DATE-CONVERT-ROUTINE
 20661                 THRU 8099-DATE-CONVERT-X
 20662             IF  DATE-CONVERSION-ERROR
 20663                 DISPLAY 'DIS TO PTO DATE ERROR '
 20664                     CR-FULL-CONTROL
 20665                 MOVE 'DIS TO PTO DATE ERROR '
 20666                                     TO WS-ABEND-MESSAGE
 20667                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20668                 MOVE 0303           TO WS-ABEND-CODE
 20669                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20670                 GO TO ABEND-PGM
 20671             ELSE
 20672                 COMPUTE W-CLMAMT ROUNDED
 20673                     = CR-AHAMT
 20674                     * (DC-ELAPSED-DAYS / 30)
 20675                 GO TO 4650-EXIT.
 20676
 20677     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20678             OR
 20679         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20680         GO TO 4650-EXIT.
 20681
 20682     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 395
* ECS010.cbl
 20683         = CR-AHAMT * 3.
 20684
 20685     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20686         MOVE CR-DISAMT          TO W-CLMAMT
 20687     ELSE
 20688         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20689
 20690     IF  NOT CR-POLICY-IS-REIN-ONLY
 20691              AND
 20692         NOT CR-AH-IS-REIN-ONLY
 20693         ADD +1          TO W-CLM-EXCEPT-CNT
 20694         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20695
 20696 4650-EXIT.
 20697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 396
* ECS010.cbl
 20699 4660-DETERMINE-EARNED-PREMIUM.
 20700
 20701     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20702
 20703     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20704
 20705     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20706
 20707     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20708         MOVE ZEROS              TO W-EARNED-PREMIUM
 20709         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20710         MOVE '7'                TO W-VAL-SOURCE
 20711         PERFORM 8500-REMAINING-TERM-ROUTINE
 20712             THRU 8599-REM-TERM-X
 20713         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20714         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20715         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20716         MOVE EPR-R78            TO W-OPT-R78
 20717         MOVE EPR-PRO            TO W-OPT-PRO
 20718         MOVE EPR-ST             TO W-OPT-ST
 20719         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20720         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20721     ELSE
 20722         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20723
 20724     COMPUTE W-EARNED-PREMIUM ROUNDED
 20725         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20726
 20727     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20728         ADD +1                  TO W-EP-LESS-THAN-0
 20729         MOVE ZERO               TO W-EARNED-PREMIUM.
 20730
 20731 4660-EXIT.
 20732     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 397
* ECS010.cbl
 20734 4666-SAVE-AHCR-DATA.
 20735
 20736     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20737                                    WX-STATUS-AT-SETTLEMENT.
 20738
 20739     MOVE ZEROS                  TO WX-CANC-DT
 20740                                    WX-EOM-RUN-DATE
 20741                                    WX-SETTLEMENT-EXIT-DATE.
 20742
 20743     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20744         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20745         MOVE CR-AH-STATUS-AT-CANCEL
 20746                                 TO WX-STATUS-AT-CANCEL
 20747         MOVE ZEROS              TO CR-AH-CANC-DT
 20748                                    WS-CR-AH-CANC-DT-N
 20749         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20750
 20751     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20752         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20753                                 TO WX-SETTLEMENT-EXIT-DATE
 20754         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20755                                 TO WX-STATUS-AT-SETTLEMENT
 20756         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20757                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20758         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20759
 20760     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20761     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20762
 20763 4666-EXIT.
 20764     EXIT.
 20765
 20766 4668-RESTORE-AHCR-DATA.
 20767
 20768     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20769         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20770                                    WS-CR-AH-CANC-DT-N
 20771         MOVE WX-STATUS-AT-CANCEL
 20772                                 TO CR-AH-STATUS-AT-CANCEL.
 20773
 20774     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20775         MOVE WX-SETTLEMENT-EXIT-DATE
 20776                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20777                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20778         MOVE WX-STATUS-AT-SETTLEMENT
 20779                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20780
 20781     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20782
 20783 4668-EXIT.
 20784     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 398
* ECS010.cbl
 20786 4670-CALC-EP.
 20787
 20788     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20789         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20790         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20791         GO TO 4670-EXIT.
 20792
 20793     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20794         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20795         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20796         GO TO 4670-EXIT.
 20797
 20798***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20799
 20800     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20801         COMPUTE W-EARNED-PREMIUM
 20802             = (W-OPT-PRO + W-OPT-R78) / +2
 20803         ADD W-EARNED-PREMIUM    TO W-M-EP
 20804     ELSE
 20805         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20806             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20807             ADD W-EARNED-PREMIUM
 20808                                 TO W-R-EP
 20809         ELSE
 20810             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20811                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20812                 ADD W-EARNED-PREMIUM
 20813                                 TO W-P-EP
 20814             ELSE
 20815                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20816                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20817                         = (W-OPT-PRO * +.6667)
 20818                         + (W-OPT-R78 * +.3333)
 20819                     ADD W-EARNED-PREMIUM
 20820                                 TO W-1-EP
 20821                 ELSE
 20822                     ADD +1      TO W-OTHERS-COUNT
 20823                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20824
 20825 4670-EXIT.
 20826     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 399
* ECS010.cbl
 20828 4680-CALC-REMAINING-AMT-LF.
 20829
 20830     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20831     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20832     MOVE CR-APR                 TO CP-LOAN-APR.
 20833     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20834
 20835     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20836         MOVE +1                 TO CR-PMT-FREQ.
 20837
 20838     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20839
 20840     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20841     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20842                                    CP-RATING-BENEFIT-AMT.
 20843     IF CP-STATE-STD-ABBRV = 'OR'
 20844         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20845     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20846     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20847     MOVE ZEROS                  TO CP-REMAINING-AMT
 20848                                    CP-REMAINING-AMT-PRV
 20849                                    CP-RETURN-CODE
 20850                                    CP-RETURN-CODE-2.
 20851
 20852     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20853     IF (DTE-CLIENT = 'DCC')
 20854        AND (AM-DCC-PRODUCT-CODE <> spaces)
 20855        if cr-clp-state = spaces
 20856           move cr-state         to cr-clp-state
 20857        end-if
 20858        if cr-lftyp not = '00' and '  ' and 'DD'
 20859           move 'L'              to ws-dd-ben-type
 20860           move cr-lftyp         to ws-dd-ben-code
 20861        else
 20862           move 'A'              to ws-dd-ben-type
 20863           move cr-ahtyp         to ws-dd-ben-code
 20864        end-if
 20865        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20866           ((CR-clp-STATE = DD-STATE (D1))
 20867           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20868           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 20869           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 20870           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20871                           OR
 20872           D1 > max-pdef
 20873        END-PERFORM
 20874        IF D1 <= max-pdef
 20875           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20876              (P1 > +8)
 20877              OR (DD-PROD-CODE (D1 P1) = 'L')
 20878           END-PERFORM
 20879           IF P1 < +9
 20880              MOVE DD-MAX-BEN-AMT (D1 P1)
 20881                                 TO CP-R-MAX-TOT-BEN
 20882           END-IF
 20883        END-IF
 20884     END-IF
 20885
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 400
* ECS010.cbl
 20886     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20887
 20888     IF  CP-RETURN-CODE NOT = ZERO
 20889         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20890                             TO WS-ABEND-MESSAGE
 20891         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20892         MOVE 2001           TO WS-ABEND-CODE
 20893         GO TO ABEND-PGM.
 20894
 20895 4680-EXIT.
 20896     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 401
* ECS010.cbl
 20898******************************************************************
 20899***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20900******************************************************************
 20901
 20902 4700-CALC-OPT-IBNR.
 20903
 20904     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20905     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20906
 20907     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20908             VARYING
 20909         SUB2 FROM +1 BY +1
 20910             UNTIL
 20911*        SUB2 GREATER THAN 300.
 20912*        SUB2 GREATER THAN 220.
 20913         SUB2 GREATER THAN 900.
 20914
 20915     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20916                                 TO EPEC-OPT-WORK-TABLE.
 20917     MOVE '*'                    TO W-UNDERWRITING-SW.
 20918
 20919     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20920             VARYING
 20921         SUB2 FROM +1 BY +1
 20922             UNTIL
 20923*        SUB2 GREATER THAN 300.
 20924*        SUB2 GREATER THAN 220.
 20925         SUB2 GREATER THAN 900.
 20926
 20927 4700-EXIT.
 20928     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 402
* ECS010.cbl
 20930 4710-PROCESS-THRU-EPEC-TABLE.
 20931
 20932     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20933         GO TO 4710-EXIT.
 20934
 20935     IF  W-UNDERWRITTEN-DATA
 20936         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20937     ELSE
 20938         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20939
 20940     IF EW-LEVEL-USED NOT = 'Y'
 20941         GO TO 4710-EXIT.
 20942
 20943     IF  EW-REIN-CO GREATER THAN SPACES
 20944         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20945         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20946             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20947             IF  W-WK-IBNR GREATER THAN ZEROS
 20948                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20949                 GO TO 4710-EXIT
 20950             ELSE
 20951                 GO TO 4710-EXIT
 20952         ELSE
 20953             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20954                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20955                 GO TO 4710-EXIT
 20956             ELSE
 20957                 GO TO 4710-EXIT.
 20958
 20959     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20960
 20961     IF  EW-LF-AH EQUAL 'L'
 20962         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20963             GO TO 4710-EXIT
 20964         ELSE
 20965             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20966             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20967     ELSE
 20968         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20969                 GREATER THAN ZEROS
 20970             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20971             ADD W-WK-IBNR       TO W-AH-IBNR
 20972         ELSE
 20973             GO TO 4710-EXIT.
 20974
 20975     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20976     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20977     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20978
 20979     IF  W-UNDERWRITTEN-DATA
 20980         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 20981     ELSE
 20982         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 20983
 20984
 20985     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20986     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 20987
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 403
* ECS010.cbl
 20988 4710-EXIT.
 20989     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 404
* ECS010.cbl
 20991 4720-PROCESS-LIFE.
 20992
 20993     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 20994
 20995 4720-EXIT.
 20996     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 405
* ECS010.cbl
 20998 4730-PROCESS-A-H.
 20999
 21000     IF  AM-TARGET-LOSS-RATIO NUMERIC
 21001             AND
 21002         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 21003         MOVE AM-TARGET-LOSS-RATIO
 21004                                 TO W-TARGET-LOSS-RATIO
 21005     ELSE
 21006         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 21007             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 21008                                 TO W-TARGET-LOSS-RATIO
 21009             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 21010
 21011     IF  W-NOT-REIN-PROCESS
 21012         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 21013         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 21014
 21015     COMPUTE W-IBNR-1 ROUNDED
 21016         = EPEC-EARNED-PREMIUM-AH (SUB2)
 21017         * COMPANY-IBNR-AH-FACTOR
 21018         * W-TARGET-LOSS-RATIO.
 21019
 21020     COMPUTE W-IBNR-2 ROUNDED
 21021         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 21022         * W-TARGET-LOSS-RATIO)
 21023         - EPEC-CLAIMS-MADE-PAID (SUB2).
 21024
 21025     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 21026         MOVE W-IBNR-1           TO W-WK-IBNR
 21027         IF  W-NOT-REIN-PROCESS
 21028             ADD +1              TO W-AH-IBNR-1-CNT
 21029             ADD W-IBNR-1        TO W-AH-IBNR-1
 21030         ELSE
 21031             NEXT SENTENCE
 21032     ELSE
 21033         MOVE W-IBNR-2           TO W-WK-IBNR
 21034         IF  W-NOT-REIN-PROCESS
 21035             ADD +1              TO W-AH-IBNR-2-CNT
 21036             ADD W-IBNR-2        TO W-AH-IBNR-2.
 21037
 21038 4730-EXIT.
 21039     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 406
* ECS010.cbl
 21041 4735-GET-BUSINESS-ADJUSTMENT.
 21042
 21043     IF  CR-GRPTYP NOT NUMERIC
 21044         MOVE '99'               TO INDEXBS
 21045     ELSE
 21046         MOVE CR-GRPTYP          TO INDEXBS.
 21047
 21048     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 21049             AND
 21050         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21051             NOT EQUAL ZEROS
 21052             AND
 21053         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21054             NOT EQUAL +1.0000
 21055         MOVE INDEXBS           TO W-EDIT-7
 21056         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 21057             = W-TARGET-LOSS-RATIO
 21058             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 21059
 21060 4735-EXIT.
 21061     EXIT.
 21062
 21063 4740-CREATE-DETAIL-EXTR.
 21064
 21065     IF DTE-PGM-OPT NOT = '1'
 21066         GO TO 4740-EXIT.
 21067
 21068     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 21069         GO TO 4740-EXIT.
 21070
 21071     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 21072     MOVE ZEROS                  TO REPORTED-DATE
 21073                                    PAY-TO-DATE.
 21074
 21075     MOVE SPACES                 TO TR-DTL2.
 21076     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 21077
 21078     MOVE EOM-YR                 TO TRD-ISYR.
 21079     MOVE EOM-MO                 TO TRD-ISMO.
 21080     MOVE EOM-DA                 TO TRD-ISDA.
 21081     MOVE ZERO                   TO TRD-AGE.
 21082
 21083     IF  EW-LF-AH EQUAL 'L'
 21084         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 21085     ELSE
 21086         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 21087
 21088     MOVE SPACES                 TO TRD-PAYCURX
 21089                                    TRD-PAYCUR-SPACE
 21090                                    TRD-FUTRSV-SPACE
 21091                                    TRD-FUTRSVX.
 21092
 21093     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21094     MOVE 'IBNR'                 TO TRD-IBNRX.
 21095     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21096     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21097
 21098     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 407
* ECS010.cbl
 21099         IF  W-REIN-IN-PROCESS
 21100             MOVE ' ACCT/BEN REIN RSV UW'
 21101                                 TO TRD-RSV-ACTION
 21102         ELSE
 21103             MOVE ' ACCT/BEN RESERVES UW'
 21104                                 TO TRD-RSV-ACTION
 21105     ELSE
 21106         IF  W-REIN-IN-PROCESS
 21107             MOVE ' ACCT/BEN REIN RSV'
 21108                                 TO TRD-RSV-ACTION
 21109         ELSE
 21110             MOVE ' ACCT/BEN RESERVES'
 21111                                 TO TRD-RSV-ACTION.
 21112
 21113     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21114
 21115     MOVE SPACES                 TO DETAIL-EXTRACT.
 21116
 21117     IF  W-REIN-IN-PROCESS
 21118         MOVE EW-REIN-CO         TO DE-REI-COMP
 21119         MOVE 'R'                TO DE-REIN
 21120         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21121         MOVE ZEROS              TO DE-IBNR
 21122     ELSE
 21123         MOVE EW-CLM-IBNR        TO DE-IBNR
 21124         MOVE ZEROS              TO DE-REI-IBNR.
 21125
 21126     MOVE 'DE'                   TO DE-RECORD-ID.
 21127     MOVE 'Y'                    TO DE-TRANS.
 21128     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21129     MOVE '1'                    TO DE-ENTRY-STATUS.
 21130     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21131
 21132     MOVE EOM-RUN-DATE           TO DE-EFF
 21133                                    WS-DE-EFF-N
 21134                                    DE-ENTRY-DTE
 21135                                    WS-DE-ENTRY-DTE-N.
 21136     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21137                                    WS-DE-RSV-INCUR-N.
 21138
 21139     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21140     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21141     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21142                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21143     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21144                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21145
 21146     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21147     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21148     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21149     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21150     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21151*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21152     MOVE AM-IG                  TO DE-IG.
 21153
 21154     IF W-UNDERWRITTEN-DATA
 21155         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21156     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 408
* ECS010.cbl
 21157         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21158
 21159     IF  EW-LF-AH EQUAL 'L'
 21160         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21161         MOVE '1'                TO DE-RESERVE-TYPE
 21162         MOVE ZEROS              TO DE-AH-TYPE
 21163     ELSE
 21164         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21165         MOVE '2'                TO DE-RESERVE-TYPE
 21166         MOVE ZEROS              TO DE-LF-TYPE.
 21167
 21168     MOVE SPACES                 TO DE-NAME
 21169                                    DE-ACC-GPCD
 21170                                    DE-AH-STAT-CDE
 21171                                    DE-LF-STAT-CDE
 21172                                    DE-MEMBER-NO
 21173                                    DE-NAME
 21174                                    DE-SEX.
 21175     MOVE ZEROS                  TO DE-AGE
 21176                                    DE-AH-BEN
 21177                                    DE-AH-CANC-DTE
 21178                                    WS-DE-AH-CANC-DTE-N
 21179                                    DE-AH-CANC-EXIT-DT
 21180                                    WS-DE-AH-CANC-EXIT-DT-N
 21181                                    DE-AH-PRM
 21182                                    DE-AH-RFND
 21183                                    DE-AH-TERM
 21184                                    DE-APR
 21185                                    DE-CANCEL-CNT-ITD
 21186                                    DE-CANCEL-CNT-YTD
 21187                                    DE-FUTRSV
 21188                                    DE-LF-BEN
 21189                                    DE-LF-BEN-ALT
 21190                                    DE-LF-CANC-DTE
 21191                                    WS-DE-LF-CANC-DTE-N
 21192                                    DE-LF-CANC-EXIT-DT
 21193                                    WS-DE-LF-CANC-EXIT-DT-N
 21194                                    DE-LF-CNBEN
 21195                                    DE-LF-CNBEN-ALT
 21196                                    DE-LF-PRM
 21197                                    DE-LF-PRM-ALT
 21198                                    DE-LF-RFND
 21199                                    DE-LF-TERM
 21200                                    DE-LOAN-TERM
 21201                                    DE-LIVES
 21202                                    DE-PAYCUR
 21203                                    DE-PMT-FREQ
 21204                                    DE-REI-AHAMT
 21205                                    DE-REI-AHPRM
 21206                                    DE-REI-AHRFND
 21207                                    DE-REI-CNAMT
 21208                                    DE-REI-FUTRSV
 21209                                    DE-REI-LFAMT
 21210                                    DE-REI-LFPRM
 21211                                    DE-REI-LFRFND
 21212                                    DE-REI-PAYCUR
 21213                                    DE-RSV-REPORTED
 21214                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 409
* ECS010.cbl
 21215                                    WS-DE-RSV-PAYTO-N
 21216                                    DE-MOB-NET-TOT-FEES
 21217                                    DE-SOC-SEC-NO.
 21218
 21219     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21220
 21221     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21222         THRU 2599-WRT-DETAIL-X.
 21223     ADD +1                      TO BC-G-CRS.
 21224
 21225 4740-EXIT.
 21226     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 410
* ECS010.cbl
 21228 4750-UPDATE-REIN.
 21229
 21230     COMPUTE SUB3 = SUB2 + 1.
 21231
 21232     IF  W-UNDERWRITTEN-DATA
 21233         MOVE EPEC-SUB-KEY-II (SUB2)
 21234                                 TO W-SUB-KEY
 21235     ELSE
 21236         MOVE EPEC-SUB-KEY (SUB2)
 21237                                 TO W-SUB-KEY.
 21238
 21239     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21240             VARYING
 21241         SUB3 FROM SUB3 BY +1
 21242             UNTIL
 21243         SUB3 GREATER THAN +900
 21244*        SUB3 GREATER THAN +220
 21245*        SUB3 GREATER THAN +300
 21246             OR
 21247         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21248
 21249 4750-EXIT.
 21250     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 411
* ECS010.cbl
 21252 4755-MATCH-REIN-EPEC.
 21253
 21254     IF  W-UNDERWRITTEN-DATA
 21255         MOVE EPEC-LEVELS-II (SUB3)
 21256                                 TO EPEC-WORK
 21257     ELSE
 21258         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21259
 21260     IF  EPEC-LINE-NOT-USED (SUB3)
 21261         GO TO 4755-EXIT.
 21262
 21263     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21264             OR
 21265         EW-REIN-CO EQUAL SPACES
 21266         GO TO 4755-EXIT.
 21267
 21268     IF  W-ISS-BEN GREATER THAN ZEROS
 21269         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21270             COMPUTE W-FACTOR ROUNDED
 21271                 = (EW-ISS-BEN
 21272                 - EPEC-REIN-ISS-BEN (SUB3))
 21273                 / W-ISS-BEN
 21274         ELSE
 21275             COMPUTE W-FACTOR ROUNDED
 21276                 = EW-ISS-BEN
 21277                 / W-ISS-BEN.
 21278
 21279     COMPUTE EW-CLM-IBNR ROUNDED
 21280         = EW-CLM-IBNR
 21281         + (W-WK-IBNR * W-FACTOR).
 21282
 21283     IF  W-UNDERWRITTEN-DATA
 21284         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21285     ELSE
 21286         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21287
 21288 4755-EXIT.
 21289     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 412
* ECS010.cbl
 21291 4760-PROCESS-REIN-ONLY.
 21292
 21293     MOVE ZEROS                  TO W-WK-IBNR.
 21294
 21295     IF  EPEC-LINE-NOT-USED (SUB2)
 21296         GO TO 4760-EXIT.
 21297
 21298     IF  EW-LF-AH EQUAL 'L'
 21299         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21300             GO TO 4760-EXIT
 21301         ELSE
 21302             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21303             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21304     ELSE
 21305         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21306             GO TO 4760-EXIT
 21307         ELSE
 21308             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21309             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21310
 21311 4760-EXIT.
 21312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 413
* ECS010.cbl
 21314 4770-CREATE-REIN-DETAIL.
 21315
 21316     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21317     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21318
 21319 4770-EXIT.
 21320     EXIT.
 21321
 21322 4799-EXIT.
 21323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 414
* ECS010.cbl
 21325 4800-CALC-EARNED-PREMIUM-AH.
 21326
 21327     MOVE +0                         TO CNC-BEN  EPR-R78
 21328                                        ISS-PRM  EPR-PRO
 21329                                        CNC-PRM  EPR-ST
 21330                                        WX-CLM-AMT
 21331                                        WX-CLM-EXP
 21332                                        WX-CLM-CNT
 21333                                        WX-CLM-CRT
 21334                                        WX-CNC-CNT
 21335                                        ISS-PRMTAX
 21336                                        WX-ACTIVE-COUNT.
 21337     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21338
 21339     MOVE WE-AHPRM TO ISS-PRM.
 21340
 21341     IF DTE-CLIENT = 'GIC'
 21342         IF REIN-EP-FLG NOT = 'R'  AND
 21343            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21344            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21345            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21346
 21347     IF REIN-EP-FLG = 'R'  AND
 21348        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21349         NEXT SENTENCE
 21350     ELSE
 21351         GO TO 4810-EP-DO-AH-CLM.
 21352
 21353     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21354         IF WE-DSPY-AMT NOT = +0
 21355             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21356             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21357             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21358             ADD +1             TO WX-CLM-CNT.
 21359
 21360     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21361         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21362             GO TO 4830-EP-DO-AH-EP.
 21363
 21364     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21365         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21366             GO TO 4830-EP-DO-AH-EP.
 21367
 21368     GO TO 4815-EP-DO-AH-CLM-EPR.
 21369
 21370 4810-EP-DO-AH-CLM.
 21371
 21372     IF WE-DSPY-AMT NOT = +0
 21373         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21374         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21375         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21376         ADD +1             TO WX-CLM-CNT.
 21377
 21378 4815-EP-DO-AH-CLM-EPR.
 21379
 21380     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21381         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21382
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 415
* ECS010.cbl
 21383 4820-EP-DO-AH-CNCL.
 21384
 21385     IF CR-AH-STATUS-AT-CANCEL = ' '
 21386         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21387            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21388             GO TO 4899-EXIT
 21389         ELSE
 21390             GO TO 4830-EP-DO-AH-EP.
 21391
 21392     IF (DTE-CLIENT = 'DCC')
 21393        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21394        IF CR-AHRFND NOT = ZEROS
 21395           ADD +1                TO WX-CNC-CNT
 21396        END-IF
 21397     ELSE
 21398        ADD +1                   TO WX-CNC-CNT
 21399     END-IF
 21400
 21401     MOVE WE-AHRFND TO CNC-PRM.
 21402
 21403*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21404*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21405*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21406*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21407
 21408     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21409     MOVE 'L'                   TO  DC-OPTION-CODE.
 21410     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21411     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21412
 21413     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21414     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21415     MOVE '1'                     TO  DC-OPTION-CODE.
 21416     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21417     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21418                                      DC-ODD-DAYS-OVER
 21419                                      DC-ELAPSED-DAYS.
 21420     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21421     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21422
 21423     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21424         ADD  +1                  TO  MONTHS-DIFF-AH.
 21425
 21426     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21427                                      WS-DCC-DDF-CB-LEVELS
 21428
 21429     if (dte-client = 'AHL')
 21430        and (cr-ah-cancel-exit-date < 20120401)
 21431        go to 4820-continue-ah-cancel
 21432     end-if
 21433
 21434     IF DTE-CLIENT = 'ACE'
 21435         GO TO 4820-CONTINUE-AH-CANCEL.
 21436
 21437     MOVE  ZEROS                  TO  SUB.
 21438
 21439 4820-AH-CHARGEBACK-LOOP.
 21440
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 416
* ECS010.cbl
 21441     ADD    +1                    TO  SUB.
 21442
 21443     IF  SUB  GREATER THAN  +10
 21444         GO TO  4820-CONTINUE-AH-CANCEL.
 21445
 21446     IF CR-CANCEL-REASON = 'R'
 21447        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21448           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21449              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21450              GO TO  4820-AH-CHARGEBACK-LOOP
 21451           END-IF
 21452           IF AM-COM-TYP (SUB) = 'J'
 21453              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21454              GO TO  4820-AH-CHARGEBACK-LOOP
 21455           END-IF
 21456        END-IF
 21457     END-IF
 21458
 21459     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21460         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21461         GO TO  4820-AH-CHARGEBACK-LOOP.
 21462
 21463     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21464         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21465
 21466     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21467         OR (CR-AHRFND = ZEROS)
 21468         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21469     END-IF
 21470
 21471     GO TO  4820-AH-CHARGEBACK-LOOP.
 21472
 21473
 21474 4820-CONTINUE-AH-CANCEL.
 21475
 21476     IF DTE-CLIENT = 'GIC'
 21477         IF REIN-EP-FLG NOT = 'R'  AND
 21478            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21479            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21480
 21481     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21482     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21483
 21484     IF CR-AH-LUMP-SUM-DISAB
 21485         GO TO 4899-EXIT.
 21486
 21487     MOVE WE-AHAMT TO CNC-BEN.
 21488
 21489     GO TO 4899-EXIT.
 21490
 21491 4825-EP-DO-AH-CNCL-SUM.
 21492
 21493     IF WE-DSPY-AMT NOT = +0
 21494         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21495         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21496         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21497         ADD +1             TO WX-CLM-CNT.
 21498
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 417
* ECS010.cbl
 21499     IF WE-AHRFND = ZERO
 21500        GO TO 4830-EP-DO-AH-EP.
 21501
 21502     MOVE WE-AHRFND TO CNC-PRM.
 21503
 21504     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21505
 21506     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21507                                      WS-DCC-DDF-CB-LEVELS
 21508
 21509     IF WE-AHRFND NOT LESS WE-AHPRM
 21510         MOVE WE-AHAMT TO CNC-BEN
 21511          GO TO 4830-EP-DO-AH-EP.
 21512
 21513     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21514     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21515     MOVE TEMP-7 TO CNC-BEN.
 21516
 21517 4830-EP-DO-AH-EP.
 21518
 21519     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21520     MOVE '8'           TO W-VAL-SOURCE.
 21521
 21522     IF REIN-EP-FLG = 'R'
 21523       IF REIN-REM-SW (SUB5) = 'I'
 21524           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21525           GO TO 4899-EXIT.
 21526
 21527     IF REIN-EP-FLG = 'R'
 21528         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21529            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21530             MOVE '*'               TO A-H-EARNED-SWITCH
 21531             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21532             MOVE '10'              TO W-VAL-SOURCE.
 21533
 21534     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21535
 21536     IF REM-TRM2 GREATER CR-AH-TERM
 21537         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21538         GO TO 4899-EXIT.
 21539
 21540     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21541         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21542*
 21543 4835-CHECK-OB-AH-NCL.
 21544
 21545     IF (DTE-CLIENT EQUAL 'NCL') AND
 21546        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21547           MOVE WE-AHPRM         TO EPR-R78
 21548                                    EPR-PRO
 21549                                    EPR-ST
 21550        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21551           (CR-MO EQUAL EOM-MO)
 21552           MOVE '*'            TO OB-DATE-1-SWITCH
 21553           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21554           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21555           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21556           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 418
* ECS010.cbl
 21557                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21558           GO TO 4899-EXIT
 21559        ELSE
 21560        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21561           (CR-MO EQUAL OB-MO (1))
 21562           MOVE '*'            TO OB-DATE-2-SWITCH
 21563           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21564           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21565           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21566           COMPUTE WS-EPR-R78 (SUB3 2) =
 21567                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21568           GO TO 4899-EXIT
 21569        ELSE
 21570        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21571           (CR-MO EQUAL OB-MO (2))
 21572           MOVE '*'            TO OB-DATE-3-SWITCH
 21573           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21574           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21575           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21576           COMPUTE WS-EPR-R78 (SUB3 3) =
 21577                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21578           GO TO 4899-EXIT
 21579        ELSE
 21580           GO TO 4899-EXIT.
 21581
 21582     IF REM-TRM2 NOT GREATER +0
 21583         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21584         GO TO 4899-EXIT.
 21585
 21586     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21587         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21588         GO TO 4899-EXIT.
 21589
 21590     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21591         MOVE +1 TO WX-ACTIVE-COUNT
 21592     ELSE
 21593         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21594
 21595     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21596     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21597     IF DTE-R78 = '1'
 21598         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21599     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21600
 21601     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21602         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21603     ELSE
 21604         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21605
 21606     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21607     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21608
 21609     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21610     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21611
 21612     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21613
 21614*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 419
* ECS010.cbl
 21615*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21616
 21617     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21618
 21619     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21620        (CR-DT GREATER THAN  19921231)
 21621        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21622         IF CR-AH-TERM GREATER THAN  +61
 21623             MOVE 'A' TO AH-EARN-METHOD
 21624             MOVE '*' TO STATUTORY-SWITCH-AH
 21625             GO TO 4845-EP-DO-AH-EP-AN
 21626         ELSE
 21627             GO TO 4860-EP-DO-AH-STATUTORY.
 21628
 21629     IF (AH-EARN-METHOD EQUAL 'N')
 21630                  OR
 21631        ((DTE-CLIENT = 'DCC')
 21632         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21633         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21634                                    NOT = 'G' AND 'D'))
 21635         GO TO 4840-EP-DO-AH-EP-NP
 21636     END-IF
 21637
 21638     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21639         MOVE 'A' TO AH-EARN-METHOD
 21640         GO TO 4845-EP-DO-AH-EP-AN.
 21641
 21642     GO TO 4860-EP-DO-AH-STATUTORY.
 21643
 21644 4840-EP-DO-AH-EP-NP.
 21645
 21646     IF WE-AHPRM = ZERO
 21647         GO TO 4860-EP-DO-AH-STATUTORY.
 21648
 21649     IF CR-APR GREATER THAN +0
 21650         NEXT SENTENCE
 21651     ELSE
 21652         GO TO 4860-EP-DO-AH-STATUTORY.
 21653
 21654     IF DTE-CLIENT = 'NCL'
 21655       IF CR-DT LESS THAN 19910101
 21656           GO TO 4860-EP-DO-AH-STATUTORY.
 21657
 21658     IF REM-TRM1 = CR-AH-TERM
 21659         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21660         GO TO 4899-EXIT.
 21661
 21662     MOVE CR-APR TO NP-APR.
 21663     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21664     MOVE REM-TRM1 TO NP-REM.
 21665     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21666     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21667         MOVE CR-LOAN-TERM TO NP-ORIG.
 21668
 21669     IF (DTE-CLIENT = 'DCC')
 21670        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21671        MOVE 'S'                 TO NP-OPT
 21672     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 420
* ECS010.cbl
 21673        MOVE 'R'                 TO NP-OPT
 21674     END-IF
 21675
 21676
 21677*    MOVE 'R' TO NP-OPT.
 21678     CALL 'ECSNETRM'
 21679         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21680
 21681     IF (DTE-CLIENT = 'DCC')
 21682        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21683        COMPUTE EPR-ST ROUNDED =
 21684           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21685        GO TO 4899-EXIT
 21686     ELSE
 21687        COMPUTE EPR-R78 ROUNDED =
 21688           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21689     END-IF
 21690
 21691     GO TO 4860-EP-DO-AH-STATUTORY.
 21692
 21693 4845-EP-DO-AH-EP-AN.
 21694     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21695     MOVE 'L'                        TO DC-OPTION-CODE.
 21696     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21697     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21698     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21699     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21700     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21701     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21702     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21703     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21704     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21705     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21706                                        CP-RATING-BENEFIT-AMT.
 21707     IF CP-STATE-STD-ABBRV = 'OR'
 21708         COMPUTE CP-RATING-BENEFIT-AMT =
 21709                                  CR-AHAMT * REM-TRM1.
 21710     MOVE CR-APR                     TO CP-LOAN-APR.
 21711     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21712     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21713     MOVE '3'                        TO CP-PROCESS-TYPE.
 21714     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21715     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21716     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21717         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21718     ELSE
 21719         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21720     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21721     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21722     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21723     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21724     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21725     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21726
 21727     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21728
 21729     IF CP-ERROR-RATE-NOT-FOUND  OR
 21730        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 421
* ECS010.cbl
 21731        CP-ERROR-IN-DATES
 21732         GO TO 4860-EP-DO-AH-STATUTORY.
 21733
 21734     COMPUTE EPR-R78 ROUNDED =
 21735             (REM-TRM1 * WE-AHAMT / +100 *
 21736               CP-PREMIUM-RATE)
 21737              / CR-AHPRM-CALC * CR-AHPRM
 21738
 21739     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21740
 21741     IF STATUTORY-REQUIREMENT-AH
 21742         MOVE EPR-R78                TO EPR-ST
 21743         GO TO 4899-EXIT.
 21744
 21745 4860-EP-DO-AH-STATUTORY.
 21746     IF (DTE-CLIENT EQUAL 'CID') AND
 21747        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21748         GO TO 4867-EP-DO-AH-STAT-ROA
 21749     END-IF.
 21750
 21751 4860-EP-DO-AH-STATUTORY-VA.
 21752
 21753     IF (DTE-CLIENT = 'DCC')
 21754        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21755        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21756        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21757        MOVE EPR-R78             TO EPR-ST
 21758        GO TO 4899-EXIT
 21759     END-IF
 21760
 21761     IF (DTE-CLIENT = 'DCC')
 21762        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21763        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21764        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21765        MOVE +1.0000                TO TEMP-6
 21766        IF REM-TRM1 < +9
 21767           COMPUTE TEMP-6 =
 21768              ((9 - (9 - REM-TRM1)) - 1)
 21769              * +.125
 21770        END-IF
 21771        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21772        MOVE EPR-ST              TO EPR-R78
 21773                                    EPR-PRO
 21774        GO TO 4899-EXIT
 21775     END-IF
 21776
 21777     MOVE EPR-R78                    TO EPR-ST.
 21778
 21779***  WE WANT R78 IN AH STAT FOR AHL
 21780
 21781     IF DTE-CLIENT = 'AHL'
 21782        GO TO 4899-EXIT
 21783     END-IF
 21784
 21785     MOVE +0                         TO SUB1.
 21786
 21787 4865-EP-AH-STAT-LOOP.
 21788     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 422
* ECS010.cbl
 21789
 21790     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21791         MOVE EPR-PRO                TO EPR-ST
 21792     ELSE
 21793         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21794             GO TO 4865-EP-AH-STAT-LOOP.
 21795
 21796     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21797         CR-DT GREATER THAN 19831031)  OR
 21798
 21799        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21800         CR-DT GREATER THAN 19820629)  OR
 21801
 21802        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21803         CR-DT GREATER THAN 19830831)  OR
 21804
 21805        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21806         CR-DT GREATER THAN 20091231)
 21807
 21808         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21809
 21810     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21811       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21812         IF CR-DT LESS THAN 19970101
 21813             MOVE EPR-R78            TO EPR-ST
 21814         ELSE
 21815             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21816
 21817     IF DTE-CLIENT = 'DCC'
 21818        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21819           MOVE EPR-PRO          TO EPR-ST
 21820        ELSE
 21821           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21822        END-IF
 21823     END-IF
 21824
 21825     IF (DTE-CLIENT = 'DCC')
 21826        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21827        CONTINUE
 21828     ELSE
 21829        GO TO 4899-EXIT
 21830     END-IF
 21831
 21832*    MOVE ' '                    TO DD-IU-SW
 21833
 21834     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21835                                    WS-DDF-CSO-ADMIN-FEE
 21836                                    WS-DDF-1ST-YR-TOT-EXP
 21837                                    WS-COMM-AND-MFEE
 21838
 21839     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21840        D1 > +10
 21841        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21842           AND (CR-LCOM-AH (D1) NUMERIC)
 21843           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21844              + (CR-LCOM-AH (D1) * +1000)
 21845        END-IF
 21846        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 423
* ECS010.cbl
 21847           AND (CR-LCOM-AH (D1) NUMERIC)
 21848           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21849              + (CR-LCOM-AH (D1) * +1000)
 21850        END-IF
 21851        IF (CR-AGT-TYPE (D1) = 'I' )
 21852           AND (CR-LCOM-AH (D1) NUMERIC)
 21853           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21854              + (CR-LCOM-AH (D1) * +1000)
 21855        END-IF
 21856        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21857           AND (CR-LCOM-AH (D1) NUMERIC)
 21858           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21859              + (CR-LCOM-AH (D1) * +1000)
 21860        END-IF
 21861     END-PERFORM
 21862
 21863     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21864     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21865
 21866     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21867                                 THRU 4910-EXIT
 21868
 21869     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21870        + WS-DDF-1ST-YR-TOT-EXP
 21871
 21872     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21873        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21874     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21875     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21876
 21877     MOVE 'D'                    TO CP-EARNING-METHOD
 21878     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21879     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21880     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21881     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21882     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21883
 21884     IF REIN-EP-FLG = 'R'
 21885        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21886        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21887        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21888     END-IF
 21889
 21890     IF DD-IU-PRESENT
 21891        MOVE 'I'              TO CP-EARNING-METHOD
 21892     END-IF
 21893
 21894     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21895                                 CP-CLP-RATE-UP
 21896
 21897
 21898     display ' cert no ' cr-cert-no
 21899     display ' rate up ' cp-iu-rate-up
 21900     display ' addl clp ' cr-addl-clp
 21901     display ' ah clp  ' cr-ah-clp
 21902     display ' orig prem ' cp-original-premium
 21903
 21904     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 424
* ECS010.cbl
 21905        AND (CP-IU-RATE-UP NOT = ZEROS)
 21906        COMPUTE CP-IU-RATE-UP =
 21907           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21908           / CP-ORIGINAL-PREMIUM))
 21909     END-IF
 21910
 21911     display ' here 4 '
 21912     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21913     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21914
 21915     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21916        + WS-DDF-1ST-YR-TOT-EXP
 21917
 21918     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21919
 21920     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21921
 21922     IF CP-DDF-SPEC-CALC = 'C'
 21923        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21924     ELSE
 21925        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21926        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21927        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21928        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21929        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21930        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21931     END-IF
 21932
 21933     display ' here 6 '
 21934     GO TO 4899-EXIT
 21935
 21936     .
 21937 4867-EP-DO-AH-STAT-ROA.
 21938     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21939     MOVE 'L'                        TO DC-OPTION-CODE.
 21940     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21941     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21942     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21943     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21944     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21945     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21946     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21947     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21948     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21949     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21950                                        CP-RATING-BENEFIT-AMT.
 21951     IF CP-STATE-STD-ABBRV = 'OR'
 21952         COMPUTE CP-RATING-BENEFIT-AMT =
 21953                                  CR-AHAMT * REM-TRM1.
 21954     MOVE CR-APR                     TO CP-LOAN-APR.
 21955     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21956     MOVE 'A'                        TO CP-EARNING-METHOD.
 21957     MOVE '3'                        TO CP-PROCESS-TYPE.
 21958     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21959     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21960     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21961         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21962     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 425
* ECS010.cbl
 21963         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21964     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21965     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21966     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21967     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21968     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21969     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21970
 21971     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21972
 21973     IF CP-ERROR-RATE-NOT-FOUND  OR
 21974        CP-ERROR-RATE-IS-ZERO  OR
 21975        CP-ERROR-IN-DATES
 21976         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21977
 21978     COMPUTE EPR-ST ROUNDED =
 21979             (REM-TRM1 * WE-AHAMT / +100 *
 21980               CP-PREMIUM-RATE)
 21981              / CR-AHPRM-CALC * CR-AHPRM
 21982
 21983     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 21984
 21985     GO TO 4899-EXIT.
 21986
 21987 4899-EXIT.
 21988     EXIT.
 21989******************************************************************
 21990***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 21991******************************************************************
 21992
 21993 4900-WRITE-SUMMARY-EXTRACTS.
 21994
 21995     IF DTE-CLIENT = 'HER'
 21996         IF EP-RECORD-ID = 'EC'  AND
 21997            EP-REINCO = 'LNL'
 21998             GO TO 4900-WRT-SUMMARY-X.
 21999
 22000     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 22001                                     WS-EP-RUN-DTE-N.
 22002
 22003     IF W-UNDERWRITTEN-DATA
 22004         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 22005     ELSE
 22006         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 22007
 22008     IF  DTE-OPT-RESERVE-METHOD-AUTH
 22009         IF VALID-EP-ID
 22010             MOVE 'Y'             TO EP-NEW-DATA-IND.
 22011
 22012     WRITE EP-RECORD.
 22013
 22014     ADD +1                       TO EP-CNT.
 22015
 22016 4900-WRT-SUMMARY-X.
 22017     EXIT.
 22018
 22019 4910-DCC-DFF-FACT-LOOKUP.
 22020
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 426
* ECS010.cbl
 22021     IF CR-CERT-NO = WS-FACT-CERT
 22022        go to 4910-exit
 22023     end-if
 22024
 22025     if cr-clp-state = spaces
 22026        move cr-state            to cr-clp-state
 22027     end-if
 22028     MOVE ' ' TO DD-IU-SW
 22029     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 22030        ((CR-clp-STATE = DD-STATE (D1))
 22031        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 22032        AND ('A'           = DD-BEN-TYPE   (D1))
 22033        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 22034        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 22035                        OR
 22036        D1 > max-pdef
 22037     END-PERFORM
 22038     IF D1 > max-pdef
 22039        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 22040           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 22041        GO TO 4910-EXIT
 22042     END-IF
 22043
 22044     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 22045        (P1 > +8)
 22046        OR (DD-PROD-CODE (D1 P1) = 'I')
 22047     END-PERFORM
 22048     IF P1 < +9
 22049        display ' setting iu present to true '
 22050        SET DD-IU-PRESENT        TO TRUE
 22051     END-IF
 22052
 22053     MOVE CR-AH-TERM             TO WS-DDF-TERM
 22054     IF (CR-LOAN-TERM > WS-DDF-TERM)
 22055        AND (DD-TRUNCATED (D1) = 'Y')
 22056        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 22057        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 22058     END-IF
 22059
 22060     EVALUATE TRUE
 22061        WHEN WS-DDF-TERM > +168
 22062           MOVE 15               TO P1
 22063        WHEN WS-DDF-TERM > +156
 22064           MOVE 14               TO P1
 22065        WHEN WS-DDF-TERM > +144
 22066           MOVE 13               TO P1
 22067        WHEN WS-DDF-TERM > +132
 22068           MOVE 12               TO P1
 22069        WHEN WS-DDF-TERM > +120
 22070           MOVE 11               TO P1
 22071        WHEN WS-DDF-TERM > +108
 22072           MOVE 10               TO P1
 22073        WHEN WS-DDF-TERM > +96
 22074           MOVE 9                TO P1
 22075        WHEN WS-DDF-TERM > +84
 22076           MOVE 8                TO P1
 22077        WHEN WS-DDF-TERM > +72
 22078           MOVE 7                TO P1
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 427
* ECS010.cbl
 22079        WHEN WS-DDF-TERM > +60
 22080           MOVE 6                TO P1
 22081        WHEN WS-DDF-TERM > +48
 22082           MOVE 5                TO P1
 22083        WHEN WS-DDF-TERM > +36
 22084           MOVE 4                TO P1
 22085        WHEN WS-DDF-TERM > +24
 22086           MOVE 3                TO P1
 22087        WHEN WS-DDF-TERM > +12
 22088           MOVE 2                TO P1
 22089        WHEN OTHER
 22090           MOVE 1                TO P1
 22091     END-EVALUATE
 22092
 22093     EVALUATE TRUE
 22094*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 22095*          AND (DD-IU-PRESENT)
 22096*          MOVE 2                TO P2
 22097*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22098*          MOVE 1                TO P2
 22099        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22100           MOVE 2                TO P2
 22101        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22102           MOVE 3                TO P2
 22103        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22104           MOVE 4                TO P2
 22105        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22106           MOVE 5                TO P2
 22107        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22108           MOVE 6                TO P2
 22109        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22110           MOVE 7                TO P2
 22111        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22112           MOVE 8                TO P2
 22113        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22114           MOVE 9                TO P2
 22115        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22116           MOVE 10               TO P2
 22117        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22118           MOVE 11               TO P2
 22119        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22120           MOVE 12               TO P2
 22121        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22122           MOVE 13               TO P2
 22123        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22124           MOVE 14               TO P2
 22125        WHEN OTHER
 22126           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22127           MOVE 15               TO P2
 22128     END-EVALUATE
 22129
 22130     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22131     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22132                                 TO WS-LO-UEF
 22133     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22134                                 TO WS-HI-UEF
 22135
 22136     .
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 428
* ECS010.cbl
 22137 4910-EXIT.
 22138     EXIT.
 22139
 22140******************************************************************
 22141***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22142******************************************************************
 22143
 22144 5000-DATE-RANGE-BREAK.
 22145
 22146     IF NO-TRANSACTION-WAS-PROCESSED
 22147         GO TO 5099-DATE-RANGE-BREAK-X.
 22148
 22149     ADD +1  TO RANGE-CNT.
 22150     MOVE +1 TO SUB6.
 22151     MOVE +2 TO SUB7.
 22152     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22153     IF LN-CNT GREATER +50
 22154         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22155                 8750-PRT-RANGE-HEADING.
 22156
 22157     MOVE SPACES                     TO PRT.
 22158     PERFORM 8800-PRINT-ROUTINE.
 22159     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22160     MOVE '  TOTALS'                 TO TPH3-DESC.
 22161     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22162     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22163     PERFORM 5900-CLEAR-TOTAL-PAGES
 22164         THRU 5999-CLEAR-TOTAL-PAGES-X
 22165             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22166
 22167 5099-DATE-RANGE-BREAK-X.
 22168     EXIT.
 22169
 22170 5100-ACCOUNT-BREAK.
 22171
 22172     IF RANGE-CNT NOT = +0
 22173         PERFORM 5000-DATE-RANGE-BREAK
 22174             THRU 5099-DATE-RANGE-BREAK-X
 22175     ELSE
 22176         MOVE +1 TO SUB6
 22177         MOVE +2 TO SUB7
 22178         PERFORM 5800-ADD-PAGES-LEVELS
 22179             THRU 5899-ADD-PAGES-LEVELS-X
 22180         PERFORM 5900-CLEAR-TOTAL-PAGES
 22181             THRU 5999-CLEAR-TOTAL-PAGES-X
 22182                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22183
 22184     MOVE +0 TO RANGE-CNT.
 22185     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22186         VARYING B-SUB FROM 1 BY 1
 22187             UNTIL B-SUB GREATER THAN 50  OR
 22188                   RB-COMPANY (B-SUB) = SPACES.
 22189     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22190         VARYING B-SUB FROM 1 BY 1
 22191             UNTIL B-SUB GREATER THAN 50.
 22192
 22193     IF ACCT-FLG = SPACE
 22194         GO TO 5199-ACCOUNT-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 429
* ECS010.cbl
 22195
 22196     MOVE SPACE TO ACCT-FLG.
 22197     MOVE +2 TO SUB6.
 22198     MOVE +3 TO SUB7.
 22199     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22200     IF LN-CNT GREATER +50
 22201         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22202                 8725-PRT-ACCT-HEADING.
 22203
 22204     MOVE SPACES                     TO PRT.
 22205     PERFORM 8800-PRINT-ROUTINE.
 22206     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22207     MOVE ' TOTALS'                  TO TPH3-DESC.
 22208     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22209     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22210     PERFORM 5900-CLEAR-TOTAL-PAGES
 22211         THRU 5999-CLEAR-TOTAL-PAGES-X
 22212             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22213
 22214 5199-ACCOUNT-BREAK-X.
 22215     EXIT.
 22216
 22217 5200-STATE-BREAK.
 22218
 22219     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22220     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22221     MOVE +3 TO SUB6.
 22222     MOVE +4 TO SUB7.
 22223     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22224
 22225     IF STATE-FLG = SPACE
 22226         GO TO 5299-STATE-BREAK-X.
 22227
 22228     MOVE SPACE         TO STATE-FLG.
 22229     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22230     MOVE 'STATE'       TO TPH1-TYPE.
 22231     MOVE HLD-STATE     TO STATE-L.
 22232
 22233     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22234
 22235     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22236         MOVE SPACES          TO TPH1-DESC
 22237         MOVE HLD-STATE       TO TPH1-ST-CODE
 22238         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22239     ELSE
 22240         MOVE SPACES TO TPH1-DESC
 22241         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22242         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22243
 22244     MOVE 'STATE'  TO TPH2-DESC.
 22245     MOVE 'TOTALS' TO TPH3-DESC.
 22246     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22247     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22248     PERFORM 5900-CLEAR-TOTAL-PAGES
 22249         THRU 5999-CLEAR-TOTAL-PAGES-X
 22250             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22251
 22252 5299-STATE-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 430
* ECS010.cbl
 22253     EXIT.
 22254
 22255 5300-COMP-BREAK.
 22256
 22257     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22258     MOVE +4 TO SUB6.
 22259     MOVE +5 TO SUB7.
 22260     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22261
 22262     IF COMP-FLG = SPACE
 22263         GO TO 5399-COMP-BREAK-X.
 22264
 22265     MOVE ' ' TO COMP-FLG.
 22266     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22267     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22268     MOVE HLD-GROUPING                TO TPH1-DESC.
 22269     MOVE 'COMPANY'                   TO TPH2-DESC.
 22270     MOVE ' TOTALS'                   TO TPH3-DESC.
 22271     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22272     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22273     PERFORM 5900-CLEAR-TOTAL-PAGES
 22274         THRU 5999-CLEAR-TOTAL-PAGES-X
 22275             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22276
 22277 5399-COMP-BREAK-X.
 22278     EXIT.
 22279
 22280 5400-CARR-BREAK.
 22281
 22282     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22283     MOVE +5 TO SUB6.
 22284     MOVE +6 TO SUB7.
 22285     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22286
 22287     IF CARR-FLG = SPACE
 22288         GO TO 5499-CARR-BREAK-X.
 22289
 22290     MOVE ' ' TO CARR-FLG.
 22291     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22292     MOVE 'CARRIER'               TO TPH1-TYPE.
 22293     MOVE HLD-CARRIER             TO TPH1-DESC.
 22294     MOVE 'CARRIER'               TO TPH2-DESC.
 22295     MOVE ' TOTALS'               TO TPH3-DESC.
 22296     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22297     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22298     PERFORM 5900-CLEAR-TOTAL-PAGES
 22299         THRU 5999-CLEAR-TOTAL-PAGES-X
 22300             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22301
 22302 5499-CARR-BREAK-X.
 22303     EXIT.
 22304
 22305 5500-FINAL-BREAK.
 22306
 22307     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22308
 22309     IF FINAL-FLG = SPACE
 22310         GO TO 5599-FINAL-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 431
* ECS010.cbl
 22311
 22312     IF DTE-FICH = '1'
 22313         MOVE '2'  TO  DTE-FICH.
 22314     MOVE +6 TO SUB6.
 22315     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22316     MOVE SPACES   TO TPH1-TYPE.
 22317     MOVE SPACES   TO TPH1-DESC.
 22318     MOVE 'FINAL'  TO TPH2-DESC.
 22319     MOVE 'TOTALS' TO TPH3-DESC.
 22320     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22321     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22322
 22323 5599-FINAL-BREAK-X.
 22324     EXIT.
 22325
 22326 5800-ADD-PAGES-LEVELS.
 22327
 22328     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22329     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22330     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22331     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22332     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22333     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22334     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22335     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22336
 22337 5899-ADD-PAGES-LEVELS-X.
 22338     EXIT.
 22339
 22340 5900-CLEAR-TOTAL-PAGES.
 22341
 22342     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22343             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22344             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22345             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22346
 22347 5999-CLEAR-TOTAL-PAGES-X.
 22348     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 432
* ECS010.cbl
 22350******************************************************************
 22351***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22352******************************************************************
 22353
 22354 6000-TOTAL-PAGE-HEADINGS.
 22355
 22356     MOVE TOTAL-PAGE-HD1 TO PRT.
 22357     PERFORM 8800-PRINT-ROUTINE.
 22358
 22359 6100-ACCT-TOTAL-HEADINGS.
 22360
 22361     MOVE TOTAL-PAGE-HD2 TO PRT.
 22362     MOVE '0' TO P-CTL.
 22363     PERFORM 8800-PRINT-ROUTINE.
 22364     MOVE TOTAL-PAGE-HD3 TO PRT.
 22365     MOVE ' ' TO P-CTL.
 22366     PERFORM 8800-PRINT-ROUTINE.
 22367     PERFORM 8800-PRINT-ROUTINE.
 22368     MOVE +81 TO LN-CNT.
 22369
 22370 6199-PAGE-HEADINGS-X.
 22371     EXIT.
 22372
 22373 6500-PRINT-TOTAL-PAGE.
 22374
 22375     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22376     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22377     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22378
 22379     IF SUB6 = 6 AND ME-DO-UPDATE
 22380         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22381
 22382     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22383
 22384     IF SUB6 = 6 AND ME-DO-UPDATE
 22385         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22386
 22387     COMPUTE TPD-NET-PRM =
 22388         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22389
 22390     IF SUB6 = 6 AND ME-DO-UPDATE
 22391         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22392         GIVING ME-010-NET-L.
 22393
 22394     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22395
 22396     IF SUB6 = 6 AND ME-DO-UPDATE
 22397         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22398
 22399     COMPUTE TPD-PREM-COMP =
 22400         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22401                            - TPL-ACCT-COM (SUB6).
 22402     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22403
 22404     IF SUB6 = 6 AND ME-DO-UPDATE
 22405         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22406
 22407     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 433
* ECS010.cbl
 22408         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22409         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22410         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22411     END-IF.
 22412
 22413     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22414     PERFORM 8800-PRINT-ROUTINE.
 22415     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22416     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22417     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22418     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22419
 22420     IF SUB6 = 6 AND ME-DO-UPDATE
 22421         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22422         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22423
 22424     COMPUTE TPD-NET-PRM =
 22425         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22426
 22427     IF SUB6 = 6 AND ME-DO-UPDATE
 22428         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22429         GIVING ME-010-NET-AH.
 22430
 22431     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22432
 22433     IF SUB6 = 6 AND ME-DO-UPDATE
 22434         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22435
 22436     COMPUTE TPD-PREM-COMP =
 22437         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22438                            - TPA-ACCT-COM (SUB6).
 22439     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22440
 22441     IF SUB6 = 6 AND ME-DO-UPDATE
 22442         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22443
 22444     IF SUB6 = 6
 22445         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22446         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22447         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22448     END-IF.
 22449
 22450     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22451     PERFORM 8800-PRINT-ROUTINE.
 22452
 22453     MOVE 'TOTAL' TO TPD-DESC.
 22454
 22455     COMPUTE TPD-ISS-PRM =
 22456         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22457
 22458     COMPUTE TPD-CNC-PRM =
 22459         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22460
 22461     COMPUTE TPD-NET-PRM =
 22462         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22463         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22464
 22465     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 434
* ECS010.cbl
 22466         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22467
 22468     COMPUTE TPD-PREM-COMP =
 22469         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22470         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22471         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22472
 22473     COMPUTE TPD-CLAIMS =
 22474         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22475
 22476     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22477         NEXT SENTENCE
 22478     ELSE
 22479         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22480         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22481         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22482*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22483*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22484*        MOVE ZEROS               TO SV-LO-CERT
 22485*                                    SV-HI-CERT.
 22486
 22487     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22488     MOVE '0'                     TO P-CTL.
 22489     PERFORM 8800-PRINT-ROUTINE.
 22490     PERFORM 8800-PRINT-ROUTINE.
 22491
 22492 6599-TOTAL-PAGE-PRINT-X.
 22493     EXIT.
 22494*
 22495*
 22496*
 22497**START***********************************************************
 22498*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22499*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22500******************************************************************
 22501*
 22502 6650-GET-RES-STATE-COMM.
 22503*6650-BROWSE-FORWARD.
 22504
 22505     IF DTE-CLIENT NOT = 'DMD'
 22506         GO TO 6700-COMM-EXIT.
 22507
 22508     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22509     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22510     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22511     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22512     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22513     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22514     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22515     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22516
 22517     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22518
 22519*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22520*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22521*VALUE OF PB-CERT-EFF-DT
 22522*
 22523     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 435
* ECS010.cbl
 22524
 22525     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22526
 22527     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22528         GO TO 6700-COMM-EXIT.
 22529
 22530*GET RECORD WHERE POSITIONED
 22531
 22532 6650-READ-ERRESC-NEXT.
 22533     READ ERRESC-IN NEXT RECORD.
 22534
 22535     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22536         GO TO 6700-COMM-EXIT.
 22537
 22538*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22539
 22540     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22541        NEXT SENTENCE
 22542     ELSE
 22543         GO TO 6700-COMM-EXIT.
 22544
 22545     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22546         NEXT SENTENCE
 22547     ELSE
 22548         GO TO 6650-READ-ERRESC-NEXT.
 22549
 22550*  CR-DT  = WS-YYYYMMDD-DT
 22551*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22552*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22553
 22554     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22555         GO TO 6700-COMM-EXIT.
 22556
 22557* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22558
 22559     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22560
 22561     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22562
 22563     IF WS-SUB1 IS GREATER THAN ZERO
 22564         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22565             PERFORM 6680-SET-TABLE-CODE
 22566         ELSE
 22567             PERFORM 6680-SET-COMMISSION.
 22568
 22569     GO TO 6700-COMM-EXIT.
 22570
 22571 6680-SET-TABLE-CODE.
 22572     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22573        MOVE ZEROS             TO WS-SUB1
 22574     ELSE
 22575* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22576* TO COMPUTE AH COMMISSION.
 22577        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22578        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22579        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22580        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22581                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 436
* ECS010.cbl
 22582        PERFORM 6680-READ-CTBL-TABLE
 22583        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22584           MOVE ZEROS          TO WS-SUB1.
 22585
 22586 6680-READ-CTBL-TABLE.
 22587*
 22588* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22589* TO COMPUTE LIFE COMMISSION
 22590
 22591     IF CR-AHTYP = ZERO
 22592        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22593        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22594        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22595
 22596     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22597
 22598     IF ERCTBL-FILE-STATUS EQUAL '00'
 22599* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22600        IF CR-AHTYP NOT = ZERO
 22601             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22602             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22603             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22604             MOVE WK-RATE           TO WS-COMMISSION
 22605                                       PB-I-AH-COMMISSION
 22606        ELSE
 22607* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22608             MOVE CR-LFAMT    TO COMM-CK-AMT
 22609             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22610             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22611             MOVE WK-RATE     TO WS-COMMISSION
 22612                                 PB-I-LIFE-COMMISSION.
 22613
 22614 6680-SET-COMMISSION.
 22615     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22616           MOVE ZEROS         TO WS-SUB1
 22617       ELSE
 22618           MOVE RESC-COMMISSION-PER (WS-SUB)
 22619                              TO WS-COMMISSION WK-RATE
 22620           IF CR-AHTYP NOT = ZERO
 22621                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22622           ELSE
 22623                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22624
 22625 6680-SEARCH-CATEGORY.
 22626     ADD +1 TO WS-SUB.
 22627
 22628     IF WS-SUB IS GREATER THAN +12
 22629         GO TO 6680-EXIT.
 22630
 22631     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22632          MOVE WS-SUB         TO WS-SUB1
 22633          GO TO 6680-EXIT.
 22634
 22635     GO TO 6680-SEARCH-CATEGORY.
 22636
 22637 6680-EXIT.
 22638     EXIT.
 22639
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 437
* ECS010.cbl
 22640 6700-COMM-EXIT.
 22641     EXIT.
 22642*
 22643*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22644
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 438
* ECS010.cbl
 22646******************************************************************
 22647***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22648******************************************************************
 22649
 22650 7000-CLIENT-BILLING-ROUTINE.
 22651*
 22652*
 22653* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22654
 22655     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22656                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22657                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22658                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22659                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22660                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22661                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22662
 22663 7099-BILL-X.
 22664     EXIT.
 22665
 22666
 22667 7500-ADD-UP-REIN-CO.
 22668
 22669     IF RB-COMPANY (B-SUB) NOT = SPACES
 22670         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22671
 22672 7599-ADD-UP-REIN-X.
 22673     EXIT.
 22674
 22675 7900-CLEAR-BILLING-TABLE.
 22676
 22677     MOVE SPACES TO RB-COMPANY (B-SUB).
 22678     MOVE 0      TO RB-COUNT (B-SUB).
 22679
 22680 7999-CLEAR-BILLING-X.
 22681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 439
* ECS010.cbl
 22683******************************************************************
 22684***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22685******************************************************************
 22686
 22687 8000-DATE-CONVERT-ROUTINE.
 22688
 22689     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22690
 22691 8099-DATE-CONVERT-X.
 22692     EXIT.
 22693
 22694 8000R-CONVERT-STOP-DATE.
 22695
 22696     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22697     MOVE 'L'                     TO DC-OPTION-CODE.
 22698     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22699     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22700     MOVE -1                      TO DC-ELAPSED-DAYS.
 22701     MOVE '6'                     TO DC-OPTION-CODE.
 22702     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22703     MOVE +0                      TO DC-ELAPSED-MONTHS
 22704                                     DC-ELAPSED-DAYS.
 22705     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22706     MOVE ' '                     TO DC-OPTION-CODE.
 22707     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22708
 22709     IF NO-CONVERSION-ERROR
 22710         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22711     ELSE
 22712         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22713                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22714                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22715         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22716                                  TO WS-ABEND-MESSAGE
 22717         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22718         MOVE 4002                TO WS-ABEND-CODE
 22719         GO TO ABEND-PGM.
 22720
 22721 8099R-STOP-DATE-X.
 22722     EXIT.
 22723
 22724
 22725 8100-GET-RATE.
 22726
 22727     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22728
 22729 8199-GET-RATE-X.
 22730     EXIT.
 22731
 22732
 22733 8200-STATE-CODE-LOOKUP.
 22734
 22735     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22736        CLAS-INDEXS NOT = ZERO
 22737         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22738             GO TO 8299-STATE-LOOKUP-X.
 22739
 22740     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 440
* ECS010.cbl
 22741
 22742 8250-STATE-LOOKUP-LOOP.
 22743
 22744     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22745         MOVE 0302 TO WS-ABEND-CODE
 22746         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22747         DISPLAY '******************************'
 22748         DISPLAY '***** ERROR LOCATION 022 *****'
 22749         DISPLAY '******************************'
 22750         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22751         GO TO ABEND-PGM.
 22752
 22753     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22754         ADD +1 TO CLAS-INDEXS
 22755         GO TO 8250-STATE-LOOKUP-LOOP.
 22756
 22757 8299-STATE-LOOKUP-X.
 22758     EXIT.
 22759
 22760
 22761 8300-LIFE-TYPE-LOOKUP.
 22762
 22763     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22764        CLAS-INDEXL NOT = ZERO
 22765         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22766             GO TO 8399-LIFE-LOOKUP-X.
 22767
 22768     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22769
 22770 8350-LIFE-LOOKUP-LOOP.
 22771
 22772     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22773         MOVE 0401 TO WS-ABEND-CODE
 22774         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22775         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22776         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22777         DISPLAY '******************************'
 22778         DISPLAY '***** ERROR LOCATION 023 *****'
 22779         DISPLAY '******************************'
 22780         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22781         IF DTE-CLIENT = 'NCL'
 22782                      OR 'CID' OR 'AHL'
 22783             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22784             MOVE '05'             TO CLAS-LOOK
 22785             GO TO 8350-LIFE-LOOKUP-LOOP
 22786         ELSE
 22787             GO TO ABEND-PGM.
 22788
 22789     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22790         ADD +1 TO CLAS-INDEXL
 22791         GO TO 8350-LIFE-LOOKUP-LOOP.
 22792
 22793     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22794         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22795
 22796 8399-LIFE-LOOKUP-X.
 22797     EXIT.
 22798
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 441
* ECS010.cbl
 22799
 22800 8400-A-H-TYPE-LOOKUP.
 22801
 22802     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22803        CLAS-INDEXA NOT = ZERO
 22804         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22805             GO TO 8499-A-H-LOOKUP-X.
 22806
 22807     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22808
 22809 8450-A-H-LOOKUP-LOOP.
 22810
 22811     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22812         MOVE 0402 TO WS-ABEND-CODE
 22813         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22814         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22815         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22816         DISPLAY '******************************'
 22817         DISPLAY '***** ERROR LOCATION 024 *****'
 22818         DISPLAY '******************************'
 22819         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22820         IF DTE-CLIENT = 'NCL'
 22821             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22822             MOVE '05'             TO CLAS-LOOK
 22823             GO TO 8450-A-H-LOOKUP-LOOP
 22824         ELSE
 22825             GO TO ABEND-PGM.
 22826
 22827     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22828         ADD +1 TO CLAS-INDEXA
 22829         GO TO 8450-A-H-LOOKUP-LOOP.
 22830
 22831 8499-A-H-LOOKUP-X.
 22832     EXIT.
 22833
 22834 8500-REMAINING-TERM-ROUTINE.
 22835
 22836     MOVE ZEROS                      TO CP-REMAINING-TERM
 22837                                        CP-REMAINING-TERM-1
 22838                                        CP-REMAINING-TERM-2
 22839                                        CP-REMAINING-TERM-3
 22840                                        CP-RETURN-CODE
 22841                                        CP-RETURN-CODE-2
 22842                                        REM-TRM1
 22843                                        REM-TRM2
 22844                                        REM-TRM3
 22845                                        TEM-TRM1.
 22846     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22847
 22848     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22849     MOVE 'L'                        TO DC-OPTION-CODE.
 22850     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22851
 22852     IF  NO-CONVERSION-ERROR
 22853         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22854     ELSE
 22855         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22856                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 442
* ECS010.cbl
 22857         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22858         MOVE 3001                   TO WS-ABEND-CODE
 22859         GO TO ABEND-PGM.
 22860
 22861     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22862
 22863     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22864         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22865
 22866     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22867         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22868         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22869                                        DC-ELAPSED-DAYS
 22870         MOVE '3'                    TO DC-OPTION-CODE
 22871         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22872                 8099-DATE-CONVERT-X
 22873         IF  NO-CONVERSION-ERROR
 22874             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22875         ELSE
 22876             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22877
 22878     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22879         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22880
 22881     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22882         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22883         MOVE +1                     TO DC-ELAPSED-MONTHS
 22884         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22885         MOVE '6'                    TO DC-OPTION-CODE
 22886         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22887                 8099-DATE-CONVERT-X
 22888         IF  NO-CONVERSION-ERROR
 22889             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22890             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22891         ELSE
 22892             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22893                                     TO WS-ABEND-MESSAGE
 22894             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22895             MOVE 3002               TO WS-ABEND-CODE
 22896             GO TO ABEND-PGM.
 22897
 22898     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22899     MOVE 'L'                        TO DC-OPTION-CODE.
 22900     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22901
 22902     IF  NO-CONVERSION-ERROR
 22903         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22904     ELSE
 22905         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22906             W-VAL-ERROR (W-VAL-SOURCE)
 22907         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22908             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22909             DC-ERROR-CODE
 22910         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22911         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22912             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22913             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22914             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 443
* ECS010.cbl
 22915*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22916*                                    TO WS-ABEND-MESSAGE
 22917*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22918*        MOVE 3003                   TO WS-ABEND-CODE
 22919*        GO TO ABEND-PGM.
 22920
 22921     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22922     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22923     MOVE '3'                        TO CP-PROCESS-TYPE.
 22924     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22925     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22926     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22927
 22928*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22929*                                    TO CP-REM-TERM-METHOD.
 22930
 22931     IF  DTE-CLIENT = 'FIM'
 22932         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22933
 22934     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22935         IF WE-LF-AH = AH-OVERRIDE-L1
 22936             MOVE '2'                TO CP-REM-TERM-METHOD
 22937         ELSE
 22938             IF CR-LFTYP = '01' OR '03'
 22939                 MOVE '4'            TO CP-REM-TERM-METHOD
 22940             ELSE
 22941                 IF CR-LFTYP = '02' OR '04'
 22942                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22943
 22944     IF  DTE-CLIENT = 'CSL'
 22945         IF  CR-CARRIER = '2'
 22946             IF  CR-LFTYP = '07' OR  '08'
 22947                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22948
 22949     IF  DTE-CLIENT = 'POS'
 22950         IF  CR-CARRIER = '1'
 22951             MOVE '1'                TO CP-REM-TERM-METHOD
 22952         ELSE
 22953             MOVE '2'                TO CP-REM-TERM-METHOD.
 22954
 22955     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22956         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22957
 22958     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22959         GO TO 8540-CALC-REM-TERM-AH.
 22960
 22961 8520-CALC-REM-TERM-LIFE.
 22962
 22963     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22964     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22965     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22966*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22967     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22968                                        CP-LOAN-TERM.
 22969
 22970     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22971             AND
 22972         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 444
* ECS010.cbl
 22973         ADD +1                      TO CP-ORIGINAL-TERM
 22974                                        CP-LOAN-TERM.
 22975
 22976     IF  CP-TERM-IS-DAYS
 22977         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22978     ELSE
 22979         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 22980
 22981     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22982
 22983     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22984         ADD +1                      TO W-ORGTRM-0-LF
 22985         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 22986             CR-FULL-CONTROL
 22987         GO TO 8599-REM-TERM-X.
 22988
 22989     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22990
 22991     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22992         ADD +1                      TO W-RET-CODE-LF
 22993         GO TO 8599-REM-TERM-X.
 22994*
 22995*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 22996*                                    TO WS-ABEND-MESSAGE
 22997*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22998*        MOVE 2002                   TO WS-ABEND-CODE
 22999*        GO TO ABEND-PGM.
 23000
 23001     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 23002             AND
 23003         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 23004         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 23005         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 23006         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 23007
 23008     IF  CP-REMAINING-TERM-1 NEGATIVE
 23009         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 23010
 23011     IF  CP-REMAINING-TERM-2 NEGATIVE
 23012         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 23013
 23014     IF DTE-CLIENT = 'NCL'
 23015         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23016                                        CP-REMAINING-TERM-3.
 23017
 23018     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23019     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23020     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23021     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23022
 23023     GO TO 8599-REM-TERM-X.
 23024
 23025 8520-EXIT.
 23026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 445
* ECS010.cbl
 23028 8540-CALC-REM-TERM-AH.
 23029
 23030     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 23031     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 23032     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 23033     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 23034                                        CP-LOAN-TERM.
 23035     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 23036
 23037     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 23038
 23039     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 23040         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 23041             CR-FULL-CONTROL
 23042         ADD +1                      TO W-ORGTRM-0-AH
 23043         GO TO 8599-REM-TERM-X.
 23044
 23045     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 23046
 23047     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 23048         ADD +1                      TO W-RET-CODE-AH
 23049         GO TO 8599-REM-TERM-X.
 23050*
 23051*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 23052*                                    TO WS-ABEND-MESSAGE
 23053*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 23054*        MOVE 2001                   TO WS-ABEND-CODE
 23055*        GO TO ABEND-PGM.
 23056
 23057     IF DTE-CLIENT = 'NCL'
 23058         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23059                                        CP-REMAINING-TERM-3.
 23060
 23061     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23062     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23063     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23064     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23065
 23066 8599-REM-TERM-X.
 23067     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 446
* ECS010.cbl
 23069
 23070******************************************************************
 23071***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 23072******************************************************************
 23073
 23074 8600-DISPLAY-PRT.
 23075
 23076     IF  DIS-LINE-CNT GREATER THAN 59
 23077         PERFORM 8600-DISPLAY-HD THRU
 23078             8600-HD-EXIT.
 23079
 23080     ADD  1  TO DIS-LINE-CNT.
 23081     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 23082     MOVE  SPACES TO DISPLAY-REC
 23083                     DISPLAY-LINE.
 23084
 23085 8600-DISPLAY-EXIT.
 23086     EXIT.
 23087
 23088
 23089 8600-DISPLAY-HD.
 23090
 23091     MOVE '1'  TO  DISPLAY-CC.
 23092     MOVE ZEROS TO DIS-LINE-CNT.
 23093     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 23094     ADD +1 TO DIS-LINE-CNT.
 23095     MOVE ' '  TO  DISPLAY-CC.
 23096     MOVE SPACES TO DISPLAY-REC.
 23097     WRITE DISPLAY-REC.
 23098     ADD +1 TO DIS-LINE-CNT.
 23099     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23100     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23101     ADD +1 TO DIS-LINE-CNT.
 23102     MOVE SPACES TO DISPLAY-REC.
 23103     ADD +1 TO DIS-LINE-CNT.
 23104     WRITE DISPLAY-REC.
 23105
 23106 8600-HD-EXIT.
 23107     EXIT.
 23108
 23109******************************************************************
 23110***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23111******************************************************************
 23112
 23113 8600-SETUP-DETAIL-LINE.
 23114
 23115     MOVE SPACES                TO TR-DTL2.
 23116
 23117     MOVE CR-CERT-NO            TO TRD-CERT.
 23118     MOVE CR-YR                 TO TRD-ISYR.
 23119     MOVE CR-MO                 TO TRD-ISMO.
 23120     MOVE CR-DA                 TO TRD-ISDA.
 23121     MOVE CR-AGE                TO TRD-AGE.
 23122
 23123 8689-SETUP-DETAIL-X.
 23124     EXIT.
 23125
 23126 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 447
* ECS010.cbl
 23127
 23128     IF LN-CNT GREATER THAN LN-MX
 23129         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23130                 8799-PRT-HEADINGS-X.
 23131     MOVE TRD-CERT TO SV-TRD-CERT.
 23132     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23133
 23134     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23135         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23136
 23137     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23138     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23139     MOVE TR-DTL TO PRT.
 23140
 23141     IF NOT WS-CHANGE-REC
 23142         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23143     ELSE
 23144         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23145
 23146     PERFORM 8800-PRINT-ROUTINE.
 23147
 23148 8699-PRT-DETAIL-X.
 23149     EXIT.
 23150
 23151 8700-PRINT-REPORT-HEADINGS.
 23152     ADD +1 TO PG-CNT.
 23153     MOVE PG-CNT TO TR-PG.
 23154     MOVE +0 TO LN-CNT.
 23155     MOVE TR-HD-1 TO PRT.
 23156     PERFORM 8800-PRINT-ROUTINE.
 23157     MOVE TR-HD-2 TO PRT.
 23158     PERFORM 8800-PRINT-ROUTINE.
 23159     MOVE TR-HD-3 TO PRT.
 23160     PERFORM 8800-PRINT-ROUTINE.
 23161     ADD +1 TO LN-CNT.
 23162
 23163 8725-PRT-ACCT-HEADING.
 23164     MOVE TR-HD-4 TO PRT.
 23165     PERFORM 8800-PRINT-ROUTINE.
 23166     MOVE TR-HD-5 TO PRT.
 23167     PERFORM 8800-PRINT-ROUTINE.
 23168
 23169 8750-PRT-RANGE-HEADING.
 23170     MOVE TR-HD-6 TO PRT.
 23171     PERFORM 8800-PRINT-ROUTINE.
 23172
 23173 8775-PRT-COLUMN-HEADINGS.
 23174     MOVE TR-HD-7 TO PRT.
 23175     PERFORM 8800-PRINT-ROUTINE.
 23176     MOVE TR-HD-8 TO PRT.
 23177     PERFORM 8800-PRINT-ROUTINE.
 23178     MOVE TR-HD-9 TO PRT.
 23179     PERFORM 8800-PRINT-ROUTINE.
 23180     PERFORM 8800-PRINT-ROUTINE.
 23181
 23182 8799-PRT-HEADINGS-X.
 23183     EXIT.
 23184
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 448
* ECS010.cbl
 23185 8800-PRINT-ROUTINE.
 23186     MOVE P-CTL TO X.
 23187     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23188     ADD +1 TO LN-CNT.
 23189     MOVE SPACES TO PRT.
 23190
 23191 8900-PRINT-A-LINE.
*23192                             COPY ELCPRT2.
 23193******************************************************************04/15/98
 23194*                                                                *ELCPRT2
 23195*                                                                *ELCPRT2
 23196*                            ELCPRT2                             *   LV005
 23197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23198*                            VMOD=2.002                          *   CL**5
 23199*                                                                *   CL**4
 23200******************************************************************   CL**4
 23201                                                                     CL**4
 23202     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23203        FICH-OPEN    = SPACE                                         CL**4
 23204         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23205         OPEN OUTPUT FICH.                                           CL**4
 23206                                                                     CL**4
 23207     IF DTE-FICH NOT = SPACE                                         CL**4
 23208         MOVE X                  TO  P-CTL                           CL**4
 23209         WRITE FICH-REC FROM PRT.                                    CL**4
 23210                                                                     CL**4
 23211     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23212       MOVE X                    TO  P-CTL                           CL**4
 23213       IF P-CTL = ' '                                                CL**4
 23214         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23215       ELSE                                                          CL**4
 23216         IF P-CTL = '0'                                              CL**4
 23217           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23218         ELSE                                                        CL**4
 23219           IF P-CTL = '-'                                            CL**4
 23220             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23221           ELSE                                                      CL**4
 23222             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23223                                                                     CL**4
 23224******************************************************************   CL**4
 23225
 23226 8999-PRT-LINE-X.
 23227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 449
* ECS010.cbl
 23229******************************************************************
 23230***          E N D   O F   J O B   P R O C E S S I N G         ***
 23231******************************************************************
 23232
 23233 9910-EOJ-1.
 23234     IF TR-CNT = ZERO
 23235         IF (DTE-PGM-OPT = '2' OR '3') OR
 23236            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23237                          'ITY' OR 'DAC' OR 'FLC')
 23238             NEXT SENTENCE
 23239         ELSE
 23240             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23241             MOVE 0703                    TO WS-ABEND-CODE
 23242             DISPLAY '******************************'
 23243             DISPLAY '***** ERROR LOCATION 025 *****'
 23244             DISPLAY '******************************'
 23245             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23246             GO TO ABEND-PGM.
 23247
 23248     MOVE '*'         TO TRANS-EOF-FLAG.
 23249     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23250
 23251     IF EOF-ON-CERT
 23252         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23253         GO TO 9940-EOJ-FIN.
 23254
 23255     GO TO 0330-MATCH-PENDING-TO-CERT.
 23256
 23257 9920-EOJ-2.
 23258     MOVE '*'         TO CERT-EOF-FLAG.
 23259     MOVE HIGH-VALUES TO CIR-CONTROL.
 23260
 23261     IF EOF-ON-TRANS
 23262         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23263         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23264         GO TO 9940-EOJ-FIN.
 23265
 23266     GO TO 0299-READ-CERT-X.
 23267
 23268 9930-EOJ-3.
 23269     IF PROCESSING-COMPLETED
 23270         GO TO 9950-EOJ-FIN-GO.
 23271
 23272     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23273     MOVE 'MISSING ACCOUNT MASTER'
 23274                               TO WS-ABEND-MESSAGE.
 23275     MOVE 0302                 TO WS-ABEND-CODE.
 23276     DISPLAY '******************************'
 23277     DISPLAY '***** ERROR LOCATION 026 *****'
 23278     DISPLAY '******************************'
 23279     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23280     GO TO ABEND-PGM.
 23281
 23282 9940-EOJ-FIN.
 23283     MOVE '*'        TO PROCESSING-FLAG.
 23284     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23285
 23286     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 450
* ECS010.cbl
 23287             0199-READ-ACCOUNT-X.
 23288     GO TO 9940-EOJ-FIN.
 23289
 23290 9950-EOJ-FIN-GO.
 23291     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23292     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23293*
 23294*
 23295* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23296     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23297
 23298 9960-NO-TOTS.
 23299
 23300     MOVE +15                    TO LN-CNT.
 23301     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23302     IF ME-DO-UPDATE
 23303         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23304
 23305     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23306     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23307     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23308
 23309
 23310     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23311     MOVE TR-TTL-HD              TO PRT.
 23312     PERFORM 8800-PRINT-ROUTINE.
 23313     ADD +1 TO LN-CNT.
 23314     MOVE TR-CNT                TO TTL-PT-CNT.
 23315     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23316     MOVE TR-TTL-HD             TO PRT.
 23317     PERFORM 8800-PRINT-ROUTINE.
 23318     ADD +1 TO LN-CNT.
 23319
 23320     IF DUP-CNT = ZERO
 23321         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23322
 23323     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23324
 23325     IF ME-DO-UPDATE
 23326         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23327
 23328     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23329     MOVE TR-TTL-HD               TO PRT.
 23330     PERFORM 8800-PRINT-ROUTINE.
 23331     PERFORM 8800-PRINT-ROUTINE.
 23332     ADD +1 TO LN-CNT.
 23333
 23334     MOVE '1'                           TO  DTL-REC-TYPE.
 23335     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23336     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23337     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23338                                        TO  DTL-CERT-OUT-CONTROL.
 23339     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23340     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23341     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23342
 23343     MOVE +1 TO SUB3.
 23344 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 451
* ECS010.cbl
 23345
 23346     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23347         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23348         MOVE MISMATCH-PAGE-NUMBER
 23349                                 TO  TR-PG
 23350         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23351         MOVE MR-CTL             TO  X
 23352         MOVE X TO LCP-ASA
 23353         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23354             THRU LCP-WRITE-END-MISMATCH-RPT
 23355         MOVE TR-HD-2            TO  MISMATCH-RPT
 23356         MOVE MR-CTL             TO  X
 23357         MOVE X TO LCP-ASA
 23358         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23359             THRU LCP-WRITE-END-MISMATCH-RPT
 23360         MOVE TR-HD-3            TO  MISMATCH-RPT
 23361         MOVE MR-CTL             TO  X
 23362         MOVE X TO LCP-ASA
 23363         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23364             THRU LCP-WRITE-END-MISMATCH-RPT
 23365         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23366         MOVE MR-CTL             TO  X
 23367         MOVE X TO LCP-ASA
 23368         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23369             THRU LCP-WRITE-END-MISMATCH-RPT
 23370         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23371
 23372     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23373
 23374     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23375     MOVE MR-CTL                        TO  X.
 23376     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23377
 23378     MOVE X TO LCP-ASA
 23379     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23380         THRU LCP-WRITE-END-MISMATCH-RPT.
 23381
 23382     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23383     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23384
 23385     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23386     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23387
 23388     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23389     IF  DUPE-STATUS (SUB3)  =  '2'
 23390         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23391     IF  DUPE-STATUS (SUB3)  =  '5'
 23392         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23393     IF  DUPE-STATUS (SUB3)  =  'M'
 23394         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23395     IF  DUPE-STATUS (SUB3)  =  '9'
 23396         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23397     IF  DUPE-STATUS (SUB3)  =  'D'
 23398         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23399     IF  DUPE-STATUS (SUB3)  =  'V'
 23400         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23401     IF  DUPE-STATUS (SUB3)  =  'P'
 23402         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 452
* ECS010.cbl
 23403
 23404     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23405     MOVE MR-CTL                        TO  X.
 23406     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23407
 23408     MOVE X TO LCP-ASA
 23409     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23410         THRU LCP-WRITE-END-MISMATCH-RPT.
 23411
 23412     IF SUB3 LESS THAN DUP-CNT
 23413         ADD +1 TO SUB3
 23414         GO TO 9965-PRT-DUPES.
 23415
 23416 9969-CHECK-MISMATCHED-TOTS.
 23417
 23418     IF W-MM-LF-PRM = ZEROS  AND
 23419        W-MM-AH-PRM = ZEROS  AND
 23420        W-MM-LF-RFD = ZEROS  AND
 23421        W-MM-AH-RFD = ZEROS  AND
 23422        W-MM-LF-CLM = ZEROS  AND
 23423        W-MM-AH-CLM = ZEROS
 23424         GO TO 9970-FIN-TOTS.
 23425
 23426     MOVE SPACES                        TO  MISMATCH-RPT.
 23427     MOVE '0'                           TO  MR-CTL  X.
 23428     MOVE X TO LCP-ASA
 23429     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23430         THRU LCP-WRITE-END-MISMATCH-RPT.
 23431
 23432     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23433     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23434     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23435
 23436     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23437     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23438     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23439
 23440     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23441     MOVE '0'                           TO  MR-CTL  X.
 23442     MOVE X TO LCP-ASA
 23443     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23444         THRU LCP-WRITE-END-MISMATCH-RPT.
 23445
 23446     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23447     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23448     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23449
 23450     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23451     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23452     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23453
 23454     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23455     MOVE '0'                           TO  MR-CTL  X.
 23456     MOVE X TO LCP-ASA
 23457     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23458         THRU LCP-WRITE-END-MISMATCH-RPT.
 23459
 23460     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 453
* ECS010.cbl
 23461     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23462     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23463
 23464     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23465     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23466     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23467
 23468     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23469     MOVE '0'                           TO  MR-CTL  X.
 23470     MOVE X TO LCP-ASA
 23471     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23472         THRU LCP-WRITE-END-MISMATCH-RPT.
 23473
 23474 9970-FIN-TOTS.
 23475
 23476     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23477
 23478     IF ME-DO-UPDATE
 23479         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23480
 23481     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23482     MOVE TR-TTL-HD               TO PRT.
 23483     PERFORM 8800-PRINT-ROUTINE.
 23484
 23485     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23486     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23487     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23488     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23489
 23490     MOVE DE-CNT                  TO TTL-PT-CNT.
 23491     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23492     MOVE TR-TTL-HD               TO PRT.
 23493     PERFORM 8800-PRINT-ROUTINE.
 23494
 23495     MOVE EP-CNT                  TO TTL-PT-CNT.
 23496     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23497     MOVE TR-TTL-HD               TO PRT.
 23498     PERFORM 8800-PRINT-ROUTINE.
 23499     PERFORM 8800-PRINT-ROUTINE.
 23500
 23501     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23502     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23503     MOVE TR-TTL-HD               TO PRT.
 23504     PERFORM 8800-PRINT-ROUTINE.
 23505
 23506     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23507     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23508     MOVE TR-TTL-HD               TO PRT.
 23509     PERFORM 8800-PRINT-ROUTINE.
 23510
 23511     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23512     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23513     MOVE TR-TTL-HD               TO PRT.
 23514     PERFORM 8800-PRINT-ROUTINE.
 23515
 23516     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23517         GO TO 9990-FINAL-CLOSE.
 23518
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 454
* ECS010.cbl
 23519**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23520**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23521**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23522**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23523
 23524     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23525     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23526     MOVE TR-TTL-HD               TO PRT.
 23527     PERFORM 8800-PRINT-ROUTINE.
 23528
 23529     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23530     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23531     MOVE TR-TTL-HD               TO PRT.
 23532     PERFORM 8800-PRINT-ROUTINE.
 23533
 23534     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23535     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23536     MOVE TR-TTL-HD               TO PRT.
 23537     PERFORM 8800-PRINT-ROUTINE.
 23538
 23539     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23540     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23541     MOVE TR-TTL-HD               TO PRT.
 23542     PERFORM 8800-PRINT-ROUTINE.
 23543
 23544     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23545     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23546     MOVE TR-TTL-HD               TO PRT.
 23547     PERFORM 8800-PRINT-ROUTINE.
 23548
 23549     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23550     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23551     MOVE TR-TTL-HD               TO PRT.
 23552     PERFORM 8800-PRINT-ROUTINE.
 23553
 23554     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23555     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23556     MOVE TR-TTL-HD               TO PRT.
 23557     PERFORM 8800-PRINT-ROUTINE.
 23558
 23559     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23560     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23561     MOVE TR-TTL-HD               TO PRT.
 23562     PERFORM 8800-PRINT-ROUTINE.
 23563
 23564     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23565     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23566     MOVE TR-TTL-HD               TO PRT.
 23567     PERFORM 8800-PRINT-ROUTINE.
 23568
 23569     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23570     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23571     MOVE TR-TTL-HD               TO PRT.
 23572     PERFORM 8800-PRINT-ROUTINE.
 23573
 23574     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23575     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23576     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 455
* ECS010.cbl
 23577     PERFORM 8800-PRINT-ROUTINE.
 23578
 23579     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23580     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23581     MOVE TR-TTL-HD               TO PRT.
 23582     PERFORM 8800-PRINT-ROUTINE.
 23583
 23584     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23585     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23586     MOVE TR-TTL-HD               TO PRT.
 23587     PERFORM 8800-PRINT-ROUTINE.
 23588
 23589     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23590     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23591     MOVE TR-TTL-HD               TO PRT.
 23592     PERFORM 8800-PRINT-ROUTINE.
 23593
 23594     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23595     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23596     MOVE TR-TTL-HD               TO PRT.
 23597     PERFORM 8800-PRINT-ROUTINE.
 23598
 23599     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23600     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23601     MOVE TR-TTL-HD               TO PRT.
 23602     PERFORM 8800-PRINT-ROUTINE.
 23603
 23604     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23605     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23606     MOVE TR-TTL-HD               TO PRT.
 23607     PERFORM 8800-PRINT-ROUTINE.
 23608
 23609     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23610     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23611     MOVE TR-TTL-HD               TO PRT.
 23612     PERFORM 8800-PRINT-ROUTINE.
 23613
 23614     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23615     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23616     MOVE TR-TTL-HD               TO PRT.
 23617     PERFORM 8800-PRINT-ROUTINE.
 23618
 23619     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23620     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23621     MOVE TR-TTL-HD               TO PRT.
 23622     PERFORM 8800-PRINT-ROUTINE.
 23623
 23624     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23625     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23626     MOVE TR-TTL-HD               TO PRT.
 23627     PERFORM 8800-PRINT-ROUTINE.
 23628
 23629     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23630     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23631     MOVE TR-TTL-HD               TO PRT.
 23632     PERFORM 8800-PRINT-ROUTINE.
 23633
 23634     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 456
* ECS010.cbl
 23635     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23636     MOVE TR-TTL-HD               TO PRT.
 23637     PERFORM 8800-PRINT-ROUTINE.
 23638
 23639     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23640     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23641     MOVE TR-TTL-HD               TO PRT.
 23642     PERFORM 8800-PRINT-ROUTINE.
 23643
 23644     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23645     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23646     MOVE TR-TTL-HD               TO PRT.
 23647     PERFORM 8800-PRINT-ROUTINE.
 23648
 23649     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23650     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23651     MOVE TR-TTL-HD               TO PRT.
 23652     PERFORM 8800-PRINT-ROUTINE.
 23653
 23654     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23655     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23656     MOVE TR-TTL-HD               TO PRT.
 23657     PERFORM 8800-PRINT-ROUTINE.
 23658
 23659     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23660     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23661     MOVE TR-TTL-HD               TO PRT.
 23662     PERFORM 8800-PRINT-ROUTINE.
 23663
 23664     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23665     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23666     MOVE TR-TTL-HD               TO PRT.
 23667     PERFORM 8800-PRINT-ROUTINE.
 23668
 23669     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23670     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23671     MOVE TR-TTL-HD               TO PRT.
 23672     PERFORM 8800-PRINT-ROUTINE.
 23673
 23674     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23675     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23676     MOVE TR-TTL-HD               TO PRT.
 23677     PERFORM 8800-PRINT-ROUTINE.
 23678
 23679     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23680     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23681     MOVE TR-TTL-HD               TO PRT.
 23682     PERFORM 8800-PRINT-ROUTINE.
 23683
 23684     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23685     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23686     MOVE TR-TTL-HD               TO PRT.
 23687     PERFORM 8800-PRINT-ROUTINE.
 23688
 23689     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23690     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23691     MOVE TR-TTL-HD               TO PRT.
 23692     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 457
* ECS010.cbl
 23693
 23694     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23695     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23696     MOVE TR-TTL-HD               TO PRT.
 23697     PERFORM 8800-PRINT-ROUTINE.
 23698
 23699     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23700     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23701     MOVE TR-TTL-HD               TO PRT.
 23702     PERFORM 8800-PRINT-ROUTINE.
 23703
 23704     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23705     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23706     MOVE TR-TTL-HD               TO PRT.
 23707     PERFORM 8800-PRINT-ROUTINE.
 23708
 23709     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23710     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23711     MOVE TR-TTL-HD               TO PRT.
 23712     PERFORM 8800-PRINT-ROUTINE.
 23713
 23714     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23715     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23716     MOVE TR-TTL-HD               TO PRT.
 23717     PERFORM 8800-PRINT-ROUTINE.
 23718
 23719     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23720     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23721                                  TO TTL-HD-DS.
 23722     MOVE TR-TTL-HD               TO PRT.
 23723     PERFORM 8800-PRINT-ROUTINE.
 23724
 23725     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23726     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23727                                  TO TTL-HD-DS.
 23728     MOVE TR-TTL-HD               TO PRT.
 23729     PERFORM 8800-PRINT-ROUTINE.
 23730
 23731     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23732     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23733                                  TO TTL-HD-DS.
 23734     MOVE TR-TTL-HD               TO PRT.
 23735     PERFORM 8800-PRINT-ROUTINE.
 23736
 23737     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23738     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23739                                  TO TTL-HD-DS.
 23740     MOVE TR-TTL-HD               TO PRT.
 23741     PERFORM 8800-PRINT-ROUTINE.
 23742
 23743     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23744     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23745                                  TO TTL-HD-DS.
 23746     MOVE TR-TTL-HD               TO PRT.
 23747     PERFORM 8800-PRINT-ROUTINE.
 23748
 23749     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23750     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 458
* ECS010.cbl
 23751                                  TO TTL-HD-DS.
 23752     MOVE TR-TTL-HD               TO PRT.
 23753     PERFORM 8800-PRINT-ROUTINE.
 23754
 23755     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23756     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23757     MOVE TR-TTL-HD               TO PRT.
 23758     PERFORM 8800-PRINT-ROUTINE.
 23759
 23760     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23761     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23762     MOVE TR-TTL-HD               TO PRT.
 23763     PERFORM 8800-PRINT-ROUTINE.
 23764
 23765     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23766     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23767     MOVE TR-TTL-HD               TO PRT.
 23768     PERFORM 8800-PRINT-ROUTINE.
 23769
 23770     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23771     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23772     MOVE TR-TTL-HD               TO PRT.
 23773     PERFORM 8800-PRINT-ROUTINE.
 23774
 23775     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23776     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23777     MOVE TR-TTL-HD               TO PRT.
 23778     PERFORM 8800-PRINT-ROUTINE.
 23779
 23780     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23781     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23782     MOVE TR-TTL-HD               TO PRT.
 23783     PERFORM 8800-PRINT-ROUTINE.
 23784
 23785     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23786     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23787     MOVE TR-TTL-HD               TO PRT.
 23788     PERFORM 8800-PRINT-ROUTINE.
 23789
 23790     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23791     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23792     MOVE TR-TTL-HD               TO PRT.
 23793     PERFORM 8800-PRINT-ROUTINE.
 23794
 23795     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23796     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23797     MOVE TR-TTL-HD               TO PRT.
 23798     PERFORM 8800-PRINT-ROUTINE.
 23799
 23800     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23801     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23802     MOVE TR-TTL-HD               TO PRT.
 23803     PERFORM 8800-PRINT-ROUTINE.
 23804
 23805     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23806     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23807     MOVE TR-TTL-HD               TO PRT.
 23808     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 459
* ECS010.cbl
 23809
 23810     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23811     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23812     MOVE TR-TTL-HD               TO PRT.
 23813     PERFORM 8800-PRINT-ROUTINE.
 23814
 23815     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23816     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23817     MOVE TR-TTL-HD               TO PRT.
 23818     PERFORM 8800-PRINT-ROUTINE.
 23819
 23820     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23821     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23822     MOVE TR-TTL-HD               TO PRT.
 23823     PERFORM 8800-PRINT-ROUTINE.
 23824
 23825     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23826     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23827     MOVE TR-TTL-HD               TO PRT.
 23828     PERFORM 8800-PRINT-ROUTINE.
 23829
 23830     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23831     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23832     MOVE TR-TTL-HD               TO PRT.
 23833     PERFORM 8800-PRINT-ROUTINE.
 23834
 23835     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23836     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23837     MOVE TR-TTL-HD               TO PRT.
 23838     PERFORM 8800-PRINT-ROUTINE.
 23839
 23840     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23841     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23842     MOVE TR-TTL-HD               TO PRT.
 23843     PERFORM 8800-PRINT-ROUTINE.
 23844
 23845     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23846     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23847     MOVE TR-TTL-HD               TO PRT.
 23848     PERFORM 8800-PRINT-ROUTINE.
 23849
 23850     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23851     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23852     MOVE TR-TTL-HD               TO PRT.
 23853     PERFORM 8800-PRINT-ROUTINE.
 23854
 23855     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23856     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23857     MOVE TR-TTL-HD               TO PRT.
 23858     PERFORM 8800-PRINT-ROUTINE.
 23859
 23860     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23861     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23862     MOVE TR-TTL-HD               TO PRT.
 23863     PERFORM 8800-PRINT-ROUTINE.
 23864
 23865     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23866     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 460
* ECS010.cbl
 23867     MOVE TR-TTL-HD               TO PRT.
 23868     PERFORM 8800-PRINT-ROUTINE.
 23869
 23870     MOVE W-1-EP                  TO TTL-PT-CNT.
 23871     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23872     MOVE TR-TTL-HD               TO PRT.
 23873     PERFORM 8800-PRINT-ROUTINE.
 23874
 23875     MOVE W-P-EP                  TO TTL-PT-CNT.
 23876     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23877     MOVE TR-TTL-HD               TO PRT.
 23878     PERFORM 8800-PRINT-ROUTINE.
 23879
 23880     MOVE W-M-EP                  TO TTL-PT-CNT.
 23881     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23882     MOVE TR-TTL-HD               TO PRT.
 23883     PERFORM 8800-PRINT-ROUTINE.
 23884
 23885     MOVE W-R-EP                  TO TTL-PT-CNT.
 23886     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23887     MOVE TR-TTL-HD               TO PRT.
 23888     PERFORM 8800-PRINT-ROUTINE.
 23889
 23890     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23891     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23892     MOVE TR-TTL-HD               TO PRT.
 23893     PERFORM 8800-PRINT-ROUTINE.
 23894
 23895     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23896     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23897     MOVE TR-TTL-HD               TO PRT.
 23898     PERFORM 8800-PRINT-ROUTINE.
 23899
 23900     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23901     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23902     MOVE TR-TTL-HD               TO PRT.
 23903     PERFORM 8800-PRINT-ROUTINE.
 23904
 23905     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23906     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23907     MOVE TR-TTL-HD               TO PRT.
 23908     PERFORM 8800-PRINT-ROUTINE.
 23909
 23910     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23911     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23912     MOVE TR-TTL-HD               TO PRT.
 23913     PERFORM 8800-PRINT-ROUTINE.
 23914
 23915     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23916     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23917     MOVE TR-TTL-HD               TO PRT.
 23918     PERFORM 8800-PRINT-ROUTINE.
 23919
 23920     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23921     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23922     MOVE TR-TTL-HD               TO PRT.
 23923     PERFORM 8800-PRINT-ROUTINE.
 23924
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 461
* ECS010.cbl
 23925     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23926     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23927     MOVE TR-TTL-HD               TO PRT.
 23928     PERFORM 8800-PRINT-ROUTINE.
 23929
 23930     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23931     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23932     MOVE TR-TTL-HD               TO PRT.
 23933     PERFORM 8800-PRINT-ROUTINE.
 23934
 23935     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23936     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23937     MOVE TR-TTL-HD               TO PRT.
 23938     PERFORM 8800-PRINT-ROUTINE.
 23939
 23940     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23941     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23942     MOVE TR-TTL-HD               TO PRT.
 23943     PERFORM 8800-PRINT-ROUTINE.
 23944
 23945 9990-FINAL-CLOSE.
*23946                             COPY ELCPRTC.
 23947******************************************************************04/15/98
 23948*                                                                *ELCPRTC
 23949*                                                                *ELCPRTC
 23950*                            ELCPRTC.                            *   LV003
 23951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23952*                            VMOD=2.002                          *   CL**2
 23953*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23954*                                                                *ELCPRTC
 23955* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23956******************************************************************ELCPRTC
 23957                                                                  ELCPRTC
 23958      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23959          CLOSE FICH.                                             ELCPRTC
 23960                                                                  ELCPRTC
 23961******************************************************************ELCPRTC
 23962
 23963     IF DTE-CLIENT = 'DMD'
 23964         CLOSE ERRESC-IN.
 23965
 23966     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23967
 23968     DISPLAY ' '.
 23969     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23970     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23971     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23972     DISPLAY ' '.
 23973
 23974     MOVE    ' DISPLAY ERROR COUNT = '
 23975       TO  DIS-LINE-REASON.
 23976     MOVE  ERROR-COUNT
 23977       TO  DIS-LINE-REC.
 23978         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23979
 23980     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 23981           DISPLAY-PRT
 23982           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 462
* ECS010.cbl
 23983           ME50-ECS010-BALANCE
 23984           PENDING-EXTRACT  SUMMARY-EXTR.
 23985
 23986     if (dte-client = 'DCC')
 23987        and (dte-pgm-opt = '1')
 23988        close new-detail-extr
 23989     end-if
 23990
 23991     IF DTE-PGM-OPT = '1'
 23992         CLOSE CERT-MASTER-OUT
 23993               DETAIL-EXTR
 23994     end-if
 23995
 23996     IF ERACCTT-FILE-STATUS NOT = '00'
 23997         MOVE '12'                TO ABEND-CODE-1
 23998         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 23999         DISPLAY '******************************'
 24000         DISPLAY '***** ERROR LOCATION 027 *****'
 24001         DISPLAY '******************************'
 24002         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24003           GO TO ABEND-PGM.
 24004
 24005     IF COMM-OPEN-SW = 'X'
 24006         CLOSE ERCTBL
 24007         IF ERCTBL-FILE-STATUS NOT = '00'
 24008             MOVE '42'               TO ABEND-CODE-1
 24009             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 24010             DISPLAY '******************************'
 24011             DISPLAY '***** ERROR LOCATION 028 *****'
 24012             DISPLAY '******************************'
 24013             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24014             GO TO ABEND-PGM.
 24015
 24016     IF REIN-OPEN-SW = 'X'
 24017         CLOSE ERRTBL-IN
 24018         IF ERRTBL-FILE-STATUS NOT = '00'
 24019             MOVE '22'               TO ABEND-CODE-1
 24020             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 24021             DISPLAY '******************************'
 24022             DISPLAY '***** ERROR LOCATION 029 *****'
 24023             DISPLAY '******************************'
 24024             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24025             GO TO ABEND-PGM.
 24026
 24027     MOVE 'C'                         TO CP-IO-FUNCTION.
 24028     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 24029     IF IO-ERROR
 24030         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 24031                                      TO WS-ABEND-MESSAGE
 24032         MOVE 0302                    TO WS-RETURN-CODE
 24033         DISPLAY '******************************'
 24034         DISPLAY '***** ERROR LOCATION 030 *****'
 24035         DISPLAY '******************************'
 24036         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24037         GO TO ABEND-PGM.
 24038
 24039     IF ME-DO-UPDATE
 24040           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 463
* ECS010.cbl
 24041           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 24042           ACCEPT WS-TIME-OF-DAY   FROM TIME
 24043           MOVE WS-TIME              TO ME-010-END
 24044           ADD 1 TO ME-010-RUN-CT
 24045           REWRITE MONTH-END-BALANCES
 24046           DISPLAY 'MONTH-END BALANCES POSTED'
 24047           CLOSE ERMEBL-INOUT
 24048     ELSE
 24049         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 24050
 24051     GO TO 9999-END-THE-JOB.
 24052
 24053 CERT-DATE-LOAD.
*24054     COPY ELCCRTM1.
 24055******************************************************************04/15/98
 24056*                                                                *ELCCRTM1
 24057*                                                                *ELCCRTM1
 24058*                            ELCCRTM1                            *   LV003
 24059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24060*                            VMOD=2.001                          *ELCCRTM1
 24061*                                                                *ELCCRTM1
 24062*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 24063*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 24064*                                                                *ELCCRTM1
 24065******************************************************************ELCCRTM1
 24066     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 24067     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 24068     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 24069     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 24070     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 24071     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 24072     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 24073     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 24074     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 24075                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 24076     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 24077                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 24078     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 24079     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 24080     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 24081     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 24082     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 24083     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 24084           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 24085                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 24086     END-PERFORM.                                                 ELCCRTM1
 24087                                                                  ELCCRTM1
 24088
 24089 EXTRACT-DATE-LOAD.
*24090     COPY ELCEXTM1.
 24091******************************************************************04/15/98
 24092*                                                                *ELCEXTM1
 24093*                                                                *ELCEXTM1
 24094*                            ELCEXTM1                            *   LV010
 24095*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 24096*                            VMOD=2.001                          *ELCEXTM1
 24097*                                                                *ELCEXTM1
 24098*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 464
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24099*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24100*                                                                *ELCEXTM1
 24101******************************************************************ELCEXTM1
 24102                                                                  ELCEXTM1
 24103     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24104     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24105     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24106     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24107     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24108     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24109                                                                     CL**9
 24110     EVALUATE TRUE                                                   CL**5
 24111        WHEN DE-ISSUE      OR                                        CL**8
 24112             DE-RC-ISSUE   OR                                        CL**8
 24113             DE-RR-RC-ISS  OR                                        CL**8
 24114             DE-CANCEL     OR                                        CL**8
 24115             DE-RC-CANCEL  OR                                        CL**8
 24116             DE-RR-RC-CNC                                            CL**8
 24117           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24118                                                                     CL**9
 24119        WHEN DE-CLAIM      OR                                        CL**8
 24120             DE-RR-RC-CLM                                            CL**6
 24121           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24122           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24123           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24124           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24125           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24126           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24127                                                                     CL**9
 24128        WHEN DE-RESERVE                                              CL**9
 24129           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24130           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24131           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24132                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24133           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24134                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24135           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24136     END-EVALUATE.                                                   CL**9
 24137                                                                     CL**9
 24138
 24139 EXTRACT-DATE-RELOAD.
*24140     COPY ELCEXTM2.
 24141******************************************************************04/15/98
 24142*                                                                *ELCEXTM2
 24143*                                                                *ELCEXTM2
 24144*                            ELCEXTM2                            *   LV011
 24145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24146*                            VMOD=2.001                          *ELCEXTM2
 24147*                                                                *ELCEXTM2
 24148*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24149*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24150*                                                                *   CL**9
 24151******************************************************************ELCEXTM2
 24152                                                                  ELCEXTM2
 24153     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24154     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24155     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24156     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 465
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24157     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24158     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24159                                                                     CL*10
 24160     EVALUATE TRUE                                                   CL*10
 24161        WHEN DE-ISSUE      OR                                        CL*10
 24162             DE-RC-ISSUE   OR                                        CL*10
 24163             DE-RR-RC-ISS  OR                                        CL*10
 24164             DE-CANCEL     OR                                        CL*10
 24165             DE-RC-CANCEL  OR                                        CL*10
 24166             DE-RR-RC-CNC                                            CL*10
 24167           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24168                                                                     CL*10
 24169        WHEN DE-CLAIM      OR                                        CL*10
 24170             DE-RR-RC-CLM                                            CL**7
 24171           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24172           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24173           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24174           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24175           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24176           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24177                                                                     CL*10
 24178        WHEN DE-RESERVE                                              CL**7
 24179            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24180            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24181            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24182                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24183            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24184                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24185            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24186     END-EVALUATE.                                                   CL**5
 24187                                                                  ELCEXTM2
 24188
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 466
* ECS010.cbl
 24190 ABEND-PGM.
 24191     DISPLAY '******************************'
 24192     DISPLAY '***** ABEND PGM **************'
 24193     DISPLAY '******************************'
*24194                             COPY ELCABEND.
 24195***************************************************************** 04/14/98
 24196*                                                               * ELCABEND
 24197*                            ELCABEND.                          *    LV003
 24198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24199*                            VMOD 2.002                              CL**2
 24200*                                                               * ELCABEND
 24201*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24202*            AND THEN ABENDS.                                   * ELCABEND
 24203*                                                               * ELCABEND
 24204*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24205*                                                               * ELCABEND
 24206***************************************************************** ELCABEND
 24207*APS-010.                                                         ELCABEND
 24208     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24209     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24210                                                                  ELCABEND
 24211     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24212         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24213         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24214                                 UPON CONSOLE.                    ELCABEND
 24215                                                                  ELCABEND
 24216     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24217         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24218         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24219                                 UPON CONSOLE.                    ELCABEND
 24220                                                                  ELCABEND
 24221     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24222     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24223                                 UPON CONSOLE.                    ELCABEND
 24224                                                                  ELCABEND
 24225     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24226     CALL 'ABORTME'.
 24227                                                                  ELCABEND
 24228 APS-EXIT.                                                        ELCABEND
 24229     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 467
* ECS010.cbl
 24231 9999-END-THE-JOB.
 24232
 24233     DISPLAY ' '.
 24234     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24235         'ECS010 ******'
 24236     DISPLAY ' '.
 24237     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 468
* ECS010.cbl
 24238/
 24239 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24240     IF LCP-ASA = '+'
 24241         WRITE MISMATCH-RPT AFTER 0 LINE
 24242     ELSE
 24243     IF LCP-ASA = ' '
 24244         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24245     ELSE
 24246     IF LCP-ASA = '0'
 24247         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24248     ELSE
 24249     IF LCP-ASA = '-'
 24250         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24251     ELSE
 24252     IF LCP-ASA = '1'
 24253         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24254     ELSE
 24255     IF LCP-ASA = '2'
 24256         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24257     ELSE
 24258     IF LCP-ASA = '3'
 24259         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24260     ELSE
 24261     IF LCP-ASA = '4'
 24262         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24263     ELSE
 24264     IF LCP-ASA = '5'
 24265         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24266     ELSE
 24267     IF LCP-ASA = '6'
 24268         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24269     ELSE
 24270     IF LCP-ASA = '7'
 24271         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24272     ELSE
 24273     IF LCP-ASA = '8'
 24274         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24275     ELSE
 24276     IF LCP-ASA = '9'
 24277         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24278     ELSE
 24279     IF LCP-ASA = 'A'
 24280         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24281     ELSE
 24282     IF LCP-ASA = 'B'
 24283         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24284     ELSE
 24285     IF LCP-ASA = 'C'
 24286         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24287     ELSE
 24288     IF LCP-ASA = 'V'
 24289         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24290     ELSE
 24291     IF LCP-ASA = 'W'
 24292         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24293     ELSE
 24294     DISPLAY 'ASA CODE ERROR'.
 24295 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 10:21 Page 469
* ECS010.cbl
 24296     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  296
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     5860356     Code:      138941
