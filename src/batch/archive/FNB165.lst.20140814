* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* FNB165.cbl
* Options: int("FNB165.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB165.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB165.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB165.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*TITLE 'CID PAYMENTS AND ADJUSTMENTS INTERFACE'                   00010031
     2                                                                  00020030
     3 IDENTIFICATION DIVISION.                                         00030030
     4 PROGRAM-ID.    FNB165.                                           00040030
     5*AUTHOR         DAN DRYDEN.                                       00050030
     6*DATE-WRITTEN   MAY, 1998.                                        00060030
     7                                                                  00070030
     8***************************************************************** 00080030
     9*                         H I S T O R Y                         * 00090030
    10***************************************************************** 00100030
    11* NAME  DATE      DESCRIPTION                                   * 00110030
    12* ----  --------  --------------------------------------------- * 00120030
    13* DANA  01/01/99  CR#199801150013 - FREEDOM SYSTEM INSTALL      * 00130030
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* FNB165.cbl
    14* DANA  02/24/99  COMPILED FOR LOGIC Y2K COPYBOOK               * 00131038
    15* DANA  09/01/99  CR#1999072000004 - NEW FORMAT FOR SYS020      * 00132039
    16* DANA  02/16/01  CR#2001011600002 - REMOVE LOGIC ACCT MASTER   * 00133041
    17* DANA  06/22/01  CR#1999061000004 - REMOVE MSA CONVERSION FILE * 00134043
    18* SMVA  03/07/02  CR#2002021300008  ELIMINATE PLAN CODE TABLE
    19*                                 DEPENDENCIES
    20* PEMA 10/30/2002                  ADD PROCESSING FOR DCC
    21* PEMA 01/08/2003                  SEPARATE DCC FROM CID
    22* SMVA 06/05/2003 IR 2003060500003 CHECK FOR NULLS IN GL-ACCOUNT;
    23*                                  SKEWED REC LNGTH IN INTFCE FILE
    24* 122205    2005033100001  PEMA  ADD PROCESSING FOR CSI
    25* 101708    2008050500001  AJRA  ADD PROCESSING FOR CCC
    26* 022812    2011110200001  AJRA  ADD PROCESSING FOR AHL
    27***************************************************************** 00150030
    28                                                                  00160000
    29 ENVIRONMENT DIVISION.                                            00170000
    30 INPUT-OUTPUT SECTION.                                            00180000
    31 FILE-CONTROL.                                                    00190000
    32                                                                  00200000
    33     SELECT CID-PAYMENTS                                          00210000
    34         ASSIGN TO SYS010                                         00220000
    35         ORGANIZATION IS INDEXED                                  00230002
    36         ACCESS IS SEQUENTIAL                                     00240002
    37         RECORD KEY IS PY-CONTROL-PRIMARY                         00250002
    38         FILE STATUS IS SYS010-STATUS.                            00260000
    39                                                                  00270000
    40     SELECT WORK-FILE                                             00280000
    41         ASSIGN TO SYS011
    42         organization is line sequential.
    43
    44     SELECT CSI-WORK-FILE
    45         ASSIGN TO SYS012
    46         organization is line sequential.
    47
    48     SELECT CCC-WORK-FILE
    49         ASSIGN TO SYS013
    50         ORGANIZATION IS LINE SEQUENTIAL.
    51
    52     SELECT DISK-DATE        ASSIGN TO SYS019.
    53                                                                  00450000
    54 DATA DIVISION.                                                   00460000
    55 FILE SECTION.                                                    00470000
    56                                                                  00480000
    57 FD  CID-PAYMENTS.                                                00490017
*   58     COPY ERCPYAJ.                                                00500010
    59******************************************************************04/29/98
    60*                                                                *ERCPYAJ
    61*                            ERCPYAJ                             *   LV003
    62*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    63*                            VMOD=2.015                          *   CL**2
    64*                                                                *ERCPYAJ
    65*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *ERCPYAJ
    66*                                                                *ERCPYAJ
    67*                                                                *ERCPYAJ
    68*   FILE TYPE = VSAM,KSDS                                        *ERCPYAJ
    69*   RECORD SIZE = 200  RECFORM = FIXED                           *ERCPYAJ
    70*                                                                *ERCPYAJ
    71*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* FNB165.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
    72*       ALTERNATE PATHS = NONE                                   *ERCPYAJ
    73*                                                                *ERCPYAJ
    74*   LOG = YES                                                    *ERCPYAJ
    75*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPYAJ
    76******************************************************************ERCPYAJ
    77******************************************************************
    78*                   C H A N G E   L O G
    79*
    80* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    81*-----------------------------------------------------------------
    82*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    83* EFFECTIVE    NUMBER
    84*-----------------------------------------------------------------
    85* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    86* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    87******************************************************************
    88                                                                  ERCPYAJ
    89 01  PENDING-PAY-ADJ.                                             ERCPYAJ
    90     12  PY-RECORD-ID                     PIC XX.                 ERCPYAJ
    91         88  VALID-PY-ID                        VALUE 'PY'.       ERCPYAJ
    92                                                                  ERCPYAJ
    93     12  PY-CONTROL-PRIMARY.                                      ERCPYAJ
    94         16  PY-COMPANY-CD                PIC X.                  ERCPYAJ
    95         16  PY-CARRIER                   PIC X.                  ERCPYAJ
    96         16  PY-GROUPING                  PIC X(6).               ERCPYAJ
    97         16  PY-FIN-RESP                  PIC X(10).              ERCPYAJ
    98         16  PY-ACCOUNT                   PIC X(10).              ERCPYAJ
    99         16  PY-PRODUCER REDEFINES PY-ACCOUNT                     ERCPYAJ
   100                                          PIC X(10).              ERCPYAJ
   101         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCPYAJ
   102         16  PY-RECORD-TYPE               PIC X.                  ERCPYAJ
   103             88  PY-REMIT-RECEIVED            VALUE 'R'.          ERCPYAJ
   104             88  PY-DEPOSIT                   VALUE 'D'.          ERCPYAJ
   105             88  PY-CHARGE-TO-AGENT           VALUE 'C'.          ERCPYAJ
   106             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.          ERCPYAJ
   107             88  PY-ADJ-DEPOSIT               VALUE 'T'.          ERCPYAJ
   108             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.          ERCPYAJ
   109             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.          ERCPYAJ
   110             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.          ERCPYAJ
   111             88  PY-ADD-TO-BALANCE            VALUE 'Z'.          ERCPYAJ
   112             88  PY-FICA-ENTRY                VALUE 'F'.          ERCPYAJ
   113             88  PY-REMIT-IND-GROUPING        VALUE 'G'.          ERCPYAJ
   114             88  PY-POLICY-FEE                VALUE 'W'.          ERCPYAJ
   115             88  PY-DUE-PREM-ADJ              VALUE 'P'.
   116                                                                  ERCPYAJ
   117     12  PY-PYMT-TYPE                     PIC X.                  ERCPYAJ
   118             88  PY-NEW-BUS-PYMT              VALUE 'B'.          ERCPYAJ
   119             88  PY-REINS-PYMT                VALUE 'R'.          ERCPYAJ
   120             88  PY-EXP-PYMT                  VALUE 'E'.          ERCPYAJ
   121                                                                  ERCPYAJ
   122     12  PY-BIL-INV                       PIC X(6).               ERCPYAJ
   123     12  PY-REF-NO                        PIC X(12).              ERCPYAJ
   124                                                                  ERCPYAJ
   125     12  PY-LAST-MAINT-DT                 PIC XX.                 ERCPYAJ
   126     12  PY-LAST-MAINT-BY                 PIC X(4).               ERCPYAJ
   127     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPYAJ
   128                                                                  ERCPYAJ
   129     12  PY-PYADJ-RECORD.                                         ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* FNB165.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   130         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.   ERCPYAJ
   131         16  PY-ENTRY-COMMENT             PIC X(30).              ERCPYAJ
   132         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.               000
   133             20  PY-GL-ACCOUNT            PIC X(10).                   000
   134             20  PY-GL-STATE              PIC X(02).                   000
   135             20  PY-GL-CANC-SW            PIC X(01).                   000
   136                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.                   000
   137                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.                   000
   138             20  PY-GL-COMMENT            PIC X(10).                   000
   139             20  FILLER      REDEFINES PY-GL-COMMENT.                  000
   140                 24  PY-GL-CHECK-NO       PIC 9(06).                   000
   141                 24  FILLER               PIC X(04).                   000
   142             20  FILLER                   PIC X(07).                   ERC
   143         16  PY-SAVE-ACCOUNT              PIC X(10).              ERCPYAJ
   144         16  PY-SAVE-TYPE                 PIC X(01).              ERCPYAJ
   145                                                                  ERCPYAJ
   146         16  PY-LETTERS.                                          ERCPYAJ
   147             20  PY-LETTER OCCURS 3 TIMES                         ERCPYAJ
   148                           INDEXED BY PY-LET-NDX                  ERCPYAJ
   149                                          PIC X(04).              ERCPYAJ
   150                                                                  ERCPYAJ
   151         16  PY-ERCOMP-TYPE               PIC X.
   152             88  PY-ACCOUNT-TYPE              VALUE 'A'.
   153             88  PY-GA-TYPE                   VALUE 'G'.
   154             88  PY-BANK-TYPE                 VALUE 'B'.
   155         16  FILLER                       PIC X(05).
   156                                                                  ERCPYAJ
   157     12  PY-RECORD-STATUS.                                        ERCPYAJ
   158         16  PY-CREDIT-SELECT-DT          PIC XX.                 ERCPYAJ
   159         16  PY-CREDIT-ACCEPT-DT          PIC XX.                 ERCPYAJ
   160         16  PY-BILLED-DATE               PIC XX.                 ERCPYAJ
   161         16  PY-REPORTED-DT               PIC XX.                 ERCPYAJ
   162         16  PY-PMT-APPLIED               PIC X.                  ERCPYAJ
   163             88  PY-ACCOUNT-PMT               VALUE 'A'.          ERCPYAJ
   164             88  PY-GA-PMT                    VALUE 'G'.          ERCPYAJ
   165             88  PY-OVWRITE-PMT               VALUE 'O'.          ERCPYAJ
   166             88  PY-NON-AR-PMT                VALUE 'N'.          ERCPYAJ
   167         16  FILLER                       PIC X(5).               ERCPYAJ
   168         16  PY-INPUT-DT                  PIC XX.                 ERCPYAJ
   169         16  PY-CHECK-NUMBER              PIC X(6).               ERCPYAJ
   170         16  PY-VOID-SW                   PIC X.                  ERCPYAJ
   171             88  PY-CHECK-VOIDED              VALUE 'V'.          ERCPYAJ
   172         16  PY-CHECK-ORIGIN-SW           PIC X.                  ERCPYAJ
   173             88  PY-BILLING-CHECK             VALUE 'B'.          ERCPYAJ
   174             88  PY-REFUND-CHECK              VALUE 'R'.          ERCPYAJ
   175             88  PY-GA-CHECK                  VALUE 'G'.          ERCPYAJ
   176             88  PY-CHECK-WRITTEN             VALUE 'W'.          ERCPYAJ
   177             88  PY-CHECK-REVERSAL            VALUE 'V'.          ERCPYAJ
   178         16  PY-CHECK-WRITTEN-DT          PIC XX.                 ERCPYAJ
   179         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.         ERCPYAJ
   180         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.         ERCPYAJ
   181         16  PY-BILL-FLAG                 PIC X.                  ERCPYAJ
   182             88  PY-BILLED                    VALUE 'B'.          ERCPYAJ
   183         16  PY-AR-FLAG                   PIC X.                  ERCPYAJ
   184             88  PY-AR-CYCLE                  VALUE 'C'.          ERCPYAJ
   185             88  PY-AR-MONTH-END              VALUE 'M'.          ERCPYAJ
   186         16  PY-AR-DATE                   PIC XX.                 ERCPYAJ
   187                                                                  ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* FNB165.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   188     12  PY-GL-CODES.                                             ERCPYAJ
   189         16  PY-GL-DB                     PIC X(14).              ERCPYAJ
   190         16  PY-GL-CR                     PIC X(14).              ERCPYAJ
   191         16  PY-GL-FLAG                   PIC X.                  ERCPYAJ
   192         16  PY-GL-DATE                   PIC XX.                 ERCPYAJ
   193                                                                  ERCPYAJ
   194     12  PY-CANCEL-FEE-FLAG               PIC X(2).               ERCPYAJ
   195     12  FILLER                           PIC X(3).               ERCPYAJ
   196******************************************************************ERCPYAJ
   197
   198                                                                  00510000
   199 FD  WORK-FILE
   200     LABEL RECORDS ARE STANDARD
   201     RECORDING MODE IS F
   202     BLOCK CONTAINS 0 RECORDS.
   203 01  WORK-RECORD.
*  204     COPY FNC022.
   205     05  FX-COMMON-SECTION.                                       00010001
   206         10  FX-SYSTEM             PIC X(10).                     00020001
   207         10  FX-SOURCE-CODE        PIC X(6).                      00030001
   208         10  FX-DIVISION           PIC X(2).                      00040001
   209         10  FX-TRAN-TYPE          PIC X(2).                      00050001
   210         10  FX-SUB-TYPE           PIC X(2).                      00060001
   211         10  FX-CLM-RES            PIC X(2).                      00070001
   212         10  FX-ANN-STMT           PIC X(3).                      00080001
   213         10  FX-PLAN-CODE          PIC X(6).                      00090001
   214         10  FX-FORM               PIC X(3).                      00091001
   215         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
   216         10  FX-POSTING-DATE       PIC X(8).                      00093001
   217         10  FX-POLICY-NO          PIC X(10).                     00094001
   218         10  FX-CITY               PIC X(30).                     00095002
   219         10  FX-STATE              PIC X(2).                      00095102
   220         10  FX-ZIP-CODE           PIC X(9).                      00096001
   221         10  FX-LOC-CODE           PIC X.                         00096102
   222         10  FX-FY-REN             PIC X.                         00097001
   223         10  FX-AGENT-01           PIC X(9).                      00098001
   224         10  FX-AGENT-50           PIC X(9).                      00099001
   225         10  FX-COST-CENTER        PIC X(4).                      00100001
   226         10  FX-TAXABLE            PIC X.                         00110004
   227         10  FX-DISTR              PIC X(2).                      00120001
   228         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
   229         10  FX-DESCRIPTION        PIC X(30).                     00140001
   230         10  FX-REFERENCE          PIC X(10).                     00150001
   231         10  FX-SUSPENSE           PIC X(15).                     00151002
   232         10  FX-AMOUNT             PIC S9(10)V99                  00160001
   233                                   SIGN IS TRAILING SEPARATE.     00170001
   234                                                                  00180001
   235     05  FX-CLAIM-SECTION.                                        00190001
   236         10  FX-CLAIM-NO           PIC X(10).                     00200001
   237         10  FX-CLAIM-TYPE         PIC X.                         00210001
   238         10  FX-DRAFT-NO           PIC X(10).                     00220001
   239         10  FX-DRAFT-STATUS       PIC X.                         00230001
   240         10  FX-TAX-ID             PIC X(10).                     00240001
   241         10  FILLER                PIC X(10).                     00250003
   242                                                                  00290001
   243
   244
   245 FD  CSI-WORK-FILE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* FNB165.cbl
   246     LABEL RECORDS ARE STANDARD
   247     RECORDING MODE IS F
   248     BLOCK CONTAINS 0 RECORDS.
   249 01  CSI-WORK-RECORD             PIC X(250).
   250
   251 FD  CCC-WORK-FILE
   252     LABEL RECORDS ARE STANDARD
   253     RECORDING MODE IS F
   254     BLOCK CONTAINS 0 RECORDS.
   255 01  CCC-WORK-RECORD             PIC X(250).
   256
   257 FD  DISK-DATE
*  258     COPY ELCDTEFD.
   259******************************************************************04/15/98
   260*                                                                *ELCDTEFD
   261*                                                                *ELCDTEFD
   262*                            ELCDTEFD.                           *   LV002
   263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   264*                            VMOD=2.007                          *   CL**2
   265*                                                                *ELCDTEFD
   266******************************************************************ELCDTEFD
   267     BLOCK CONTAINS 0 RECORDS
   268     RECORDING MODE F.                                            ELCDTEFD
   269                                                                  ELCDTEFD
   270 01  DATE-DISK.                                                   ELCDTEFD
   271     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   272     12  FILLER                      PIC  X(14).                  ELCDTEFD
   273     12  DD-CR1                      PIC  9.                      ELCDTEFD
   274     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   275     12  DD-CR2                      PIC  9.                      ELCDTEFD
   276     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   277     12  FILLER                      PIC  X(20).                  ELCDTEFD
   278                                                                  ELCDTEFD
   279 01  DATE-DISK-R.                                                 ELCDTEFD
   280     12  FILLER                      PIC  X(4).                   ELCDTEFD
   281     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   282                                     PIC  X(32).                  ELCDTEFD
   283                                                                  ELCDTEFD
   284 01  DATE-DISK-T.                                                 ELCDTEFD
   285     12  FILLER                      PIC  X(4).                   ELCDTEFD
   286     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   287                                     PIC  X(48).                  ELCDTEFD
   288                                                                  ELCDTEFD
   289 01  DATE-DISK-M.                                                 ELCDTEFD
   290     12  FILLER                      PIC  X(4).                   ELCDTEFD
   291     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   292                                     PIC  X(48).                  ELCDTEFD
   293                                                                  ELCDTEFD
   294 01  DATE-DISK-P.                                                 ELCDTEFD
   295     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   296     12  DD-IDX                      PIC  99.                     ELCDTEFD
   297     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   298     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   299         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   300                                     PIC  X.                      ELCDTEFD
   301         16  FILLER                  PIC  X(46).                  ELCDTEFD
   302     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   303         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   304             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   305             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   306             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   307             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   308         16  FILLER                  PIC  X(16).                  ELCDTEFD
   309                                                                  ELCDTEFD
   310 01  DATE-DISK-E.                                                 ELCDTEFD
   311     12  FILLER                      PIC  X(4).                   ELCDTEFD
   312     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   313                                     PIC  X(4).                   ELCDTEFD
   314                                                                  ELCDTEFD
   315 01  DATE-DISK-C.                                                 ELCDTEFD
   316     12  FILLER                      PIC  X(7).                   ELCDTEFD
   317     12  DD-CARR1-SECPAY-SW          PIC  X.
   318     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   319     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   320     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   321     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   322     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   323     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   324     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   325     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   326     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   327     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   328     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   329     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   330     12  DD-CARR2-SECPAY-SW          PIC  X.
   331     12  FILLER                      PIC  X(7).                   ELCDTEFD
   332                                                                  ELCDTEFD
   333 01  DATE-DISK-OPT.                                               ELCDTEFD
   334     12  FILLER                      PIC  X(04).                  ELCDTEFD
   335     12  DD-TLR-DATA.                                             ELCDTEFD
   336         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   337                                     PIC  X(03).                  ELCDTEFD
   338     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   339         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   340                                     PIC  X(06).                  ELCDTEFD
   341     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   342         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   343                                     PIC  X(07).                  ELCDTEFD
   344         16  FILLER                  PIC  X(05).                  ELCDTEFD
   345     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   346                                     PIC  X(96).                  ELCDTEFD
   347******************************************************************ELCDTEFD
   348
   349                                                                  00700000
   350 WORKING-STORAGE SECTION.                                         00710000
   351                                                                  00720000
   352 01  FILLER.                                                      00730000
   353     05  WS-ZERO                 PIC S9(3)  COMP-3  VALUE +0.
   354     05  WS-ABEND-MESSAGE        PIC X(80)  VALUE SPACES.
   355     05  PGM-SUB                 PIC S9(4) COMP VALUE +310.
   356     05  WS-RETURN-CODE          PIC S999  COMP-3 VALUE +0.
   357     05  DUMP                PIC X         VALUE ' '.             00740000
   358     05  FORCE-DUMP REDEFINES DUMP PIC S9 COMP-3.                 00750000
   359     05  SYS010-STATUS       PIC XX        VALUE '00'.            00780029
   360         88  EOF                           VALUE '10'.            00790000
   361     05  WS-PREV-DATE        PIC XX.                              00800010
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* FNB165.cbl
   362     05  WS-CURR-DATE        PIC XX.                              00810010
   363     05  WS-SUSPENSE.                                             00820026
   364         10  WS-FIN-RESP     PIC X(7).                            00830027
   365         10  WS-CID-ACCT     PIC X(8).                            00840027
   366                                                                  00850026
*  367 COPY ELCDATE.
   368******************************************************************06/11/98
   369*                                                                *ELCDATE
   370*                                                                *ELCDATE
   371*                            ELCDATE.                            *   LV023
   372*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   373*                            VMOD=2.003                           ELCDATE
   374*                                                                *ELCDATE
   375*                                                                *ELCDATE
   376*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   377*                 LENGTH = 200                                   *   CL*19
   378******************************************************************ELCDATE
   379                                                                  ELCDATE
   380 01  DATE-CONVERSION-DATA.                                        ELCDATE
   381     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   382     12  DC-OPTION-CODE                PIC X.                        CL*15
   383         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   384         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   385         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   386         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   387         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   388         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   389         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   390         88  FIND-CENTURY               VALUE '7'.                   CL*22
   391         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   392         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   393         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   394         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   395         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   396         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   397         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   398         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   399         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   400         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   401         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   402         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   403         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   404         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   405         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   406         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   407         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   408         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   409         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   410         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   411         88  THREE-CHARACTER-BIN                                  ELCDATE
   412                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   413         88  GREGORIAN-TO-BIN                                        CL**2
   414                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   415         88  BIN-TO-GREGORIAN                                        CL**2
   416                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   417         88  JULIAN-TO-BINARY                                        CL**2
   418                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   419     12  DC-ERROR-CODE                 PIC X.                        CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDATE)
   420         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   421         88  DATE-CONVERSION-ERROR                                ELCDATE
   422                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   423         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   424         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   425         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   426         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   427         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   428         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   429         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   430         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   431         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   432         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   433     12  DC-END-OF-MONTH               PIC X.                        CL*15
   434         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   435     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   436         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   437         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   438         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   439     12  FILLER                        PIC X.                        CL*15
   440     12  DC-CONVERSION-DATES.                                        CL*15
   441         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   442         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   443         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   444         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   445                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   446             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   447             20  SLASH1-1              PIC X.                        CL*15
   448             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   449             20  SLASH1-2              PIC X.                        CL*15
   450             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   451         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   452         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   453                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   454             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   455             20  SLASH2-1              PIC X.                        CL*15
   456             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   457             20  SLASH2-2              PIC X.                        CL*15
   458             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   459         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   460         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   461                     DC-GREG-DATE-1-YMD.                          ELCDATE
   462             20  DC-YMD-YEAR           PIC 99.                       CL*15
   463             20  DC-YMD-MONTH          PIC 99.                       CL*15
   464             20  DC-YMD-DAY            PIC 99.                       CL*15
   465         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   466         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   467                      DC-GREG-DATE-1-MDY.                         ELCDATE
   468             20  DC-MDY-MONTH          PIC 99.                       CL*15
   469             20  DC-MDY-DAY            PIC 99.                       CL*15
   470             20  DC-MDY-YEAR           PIC 99.                       CL*15
   471         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   472             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   473             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   474             20  FILLER                PIC XX.                       CL*15
   475             20  DC-ALPHA-CENTURY.                                   CL*15
   476                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   477             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDATE)
   478         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   479         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   480         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   481         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   482         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   483                                       PIC 9(05).                    CL*20
   484         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   485             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   486             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   487         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   488         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   489         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   490     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   491         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   492         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   493             20  FILLER                PIC 9(3).                     CL*15
   494             20  HOLD-CEN-1-CCYY.                                    CL*15
   495                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   496                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   497             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   498             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   499         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   500             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   501             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   502             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   503                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   504                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   505             20  FILLER                PIC 9(3).                     CL*15
   506         16  HOLD-CENTURY-1-X.                                       CL*15
   507             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   508             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   509                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   510                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   511             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   512             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   513         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   514             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   515             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   516             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   517                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   518                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   519             20  FILLER                PIC XXX.                      CL*23
   520         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   521         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   522         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   523         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   524             20  DC-JULIAN-1-CCYY.                                   CL*15
   525                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   526                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   527             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   528         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   529         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   530             20  DC-JULIAN-2-CCYY.                                   CL*15
   531                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   532                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   533             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   534         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   535             20  DC-EDITA-MONTH        PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDATE)
   536             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   537             20  DC-EDITA-DAY          PIC 99.                       CL*15
   538             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   539             20  DC-EDITA-CCYY.                                      CL*15
   540                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   541                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   542         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   543             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   544             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   545             20  DC-EDITB-DAY          PIC 99.                       CL*15
   546             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   547             20  DC-EDITB-CCYY.                                      CL*15
   548                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   549                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   550         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   551         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   552                              DC-GREG-DATE-CYMD.                  ELCDATE
   553             20  DC-CYMD-CEN           PIC 99.                       CL*15
   554             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   555             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   556             20  DC-CYMD-DAY           PIC 99.                       CL*15
   557         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   558         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   559                              DC-GREG-DATE-MDCY.                  ELCDATE
   560             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   561             20  DC-MDCY-DAY           PIC 99.                       CL*15
   562             20  DC-MDCY-CEN           PIC 99.                       CL*15
   563             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   564    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   565        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   566    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   567    12  FILLER                         PIC X(28).                    CL*26
   568
   569
   570 01  SYSTEM-DATE.
   571     05  SYS-MO         PIC 9(2).
   572     05  SYS-DA         PIC 9(2).
   573     05  SYS-CCYY       PIC 9(4).
   574
   575
   576* FUNCTION-DATE COPYBOOK
*  577                                      COPY ELCFUNDT.
   578***************************************************************** 12/03/98
   579*                                                               * ELCFUNDT
   580*                            ELCFUNDT.                          *    LV004
   581*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
   582*                            VMOD=2.001                         * ELCFUNDT
   583*                                                               * ELCFUNDT
   584*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
   585*                                                               * ELCFUNDT
   586***************************************************************** ELCFUNDT
   587                                                                  ELCFUNDT
   588                                                                  ELCFUNDT
   589 01  FUNCTION-DATE.                                                  CL**2
   590     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
   591     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
   592         10  WS-FN-CCYR            PIC 9(4).                         CL**3
   593         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* FNB165.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
   594             15  WS-FN-CC          PIC 99.                           CL**3
   595             15  WS-FN-YR          PIC 99.                           CL**3
   596         10  WS-FN-MO              PIC 99.                           CL**3
   597         10  WS-FN-DA              PIC 99.                           CL**3
   598     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
   599     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
   600     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
   601     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
   602     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
   603         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
   604         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
   605         88  WS-NO-GMT                         VALUE ZERO.           CL**2
   606     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
   607     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
   608
   609
   610* STATE EDIT TABLE
*  611 COPY FNC018.
   612***************************************************************** 00020002
   613*                                                               * 00030002
   614*                     STATE CODE TABLE                          * 00040002
   615*                                                               * 00050002
   616*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
   617*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
   618*                                                               * 00080002
   619***************************************************************** 00090002
   620*                                                                 00100002
   621 01  STATE-VALUES.                                                00110002
   622     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
   623     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
   624     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
   625     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
   626     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
   627     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
   628     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
   629     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
   630     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
   631     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
   632     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
   633     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
   634     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
   635     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
   636     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
   637     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
   638     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
   639     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
   640     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
   641     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
   642     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
   643     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
   644     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
   645     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
   646     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
   647     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
   648     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
   649     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
   650     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
   651     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* FNB165.cbl (/apps/prod/cid1p/copy/FNC018)
   652     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
   653     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
   654     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
   655     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
   656     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
   657     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
   658     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
   659     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
   660     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
   661     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
   662     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
   663     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
   664     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
   665     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
   666     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
   667     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
   668     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
   669     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
   670     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
   671     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
   672     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
   673     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
   674     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
   675     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
   676     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
   677     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
   678     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
   679     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
   680     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
   681     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
   682                                                                  00720002
   683 01  FILLER REDEFINES STATE-VALUES.                               00730002
   684     05  STATE-TABLE                                              00740002
   685             OCCURS 60 TIMES                                      00750002
   686             ASCENDING KEY IS ST-STATE                            00760002
   687             INDEXED BY ST-INDEX.                                 00770002
   688         10  ST-STATE          PIC XX.                            00780002
   689         10  ST-ALT-STATE      PIC XX.                            00790002
   690         10  ST-NAME           PIC X(20).                         00800002
   691                                                                  00810002
   693
*  694     COPY ELCDTECX.
   695******************************************************************06/05/98
   696*                                                                *ELCDTECX
   697*                            ELCDTECX.                           *   LV005
   698*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   699*                            VMOD=2.015                          *ELCDTECX
   700*                                                                *ELCDTECX
   701*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   702*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   703*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   704*                                                                *ELCDTECX
   705******************************************************************ELCDTECX
   706******************************************************************
   707*                   C H A N G E   L O G
   708*
   709* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   710*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   711*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   712* EFFECTIVE    NUMBER
   713*-----------------------------------------------------------------
   714* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   715*                                  BENEFIT CODES FROM 300 TO 900
   716* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   717* 051304    2003080800002  SMVA  ADD REFUND METHOD
   718******************************************************************
   719 01  DATE-CARD.                                                   ELCDTECX
   720     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   721     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   722     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   723     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   724     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   725     12  EP-SW                       PIC  X.                      ELCDTECX
   726         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   727     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   728         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   729     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   730     12  RUN-CENTURY.                                             ELCDTECX
   731         16 RUN-CENTURY-N            PIC  99.                        CL**4
   732     12  FILLER                      PIC  X.                         CL**4
   733     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   734     12  FILLER                      PIC  XXX.                    ELCDTECX
   735     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   736                                                                  ELCDTECX
   737 01  FILLER                          PIC  X(7)                       CL**6
   738                                          VALUE 'OPTIONS'.        ELCDTECX
   739 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   740     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   741     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   742     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   743         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   744         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   745     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   746     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   747     12  FILLER                      PIC  X.                      ELCDTECX
   748     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   749     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   750     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   751     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   752     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   753     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   754     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   755     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   756     12  FILLER                      PIC  X.                      ELCDTECX
   757     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   758     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   759     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   760     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   761     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   762     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   763     12  FILLER                      PIC  X.                      ELCDTECX
   764     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   765     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   766     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   767     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   768     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   769     12  DTE-R78                     PIC  X.                      ELCDTECX
   770     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   771     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   772     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   773     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   774     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   775     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   776     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   777                                     PIC  X.                      ELCDTECX
   778         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   779                                                 ' '.             ELCDTECX
   780         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   781         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   782     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   783         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   784         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   785     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   786     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   787                                     PIC  9.                         CL**4
   788     12  DTE-SYSTEM.                                              ELCDTECX
   789         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   790         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   791         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   792         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   793         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   794         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   795         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   796         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   797         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   798         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   799         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   800         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   801         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   802         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   803         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   804         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   805         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   806         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   807         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   808         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   809         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   810         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   811         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   812         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   813         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   814         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   815     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   816         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   817                                     PIC  X.                      ELCDTECX
   818     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   819                                                                  ELCDTECX
   820 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   821     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   822     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   823     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   824*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   825     12  FILLER                      PIC  X.                      ELCDTECX
   826     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   827     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   828     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   829     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   830     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   831     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   832     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   833                                                                  ELCDTECX
   834     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   835     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   836     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   837     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   838                                                                  ELCDTECX
   839     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   840     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   841     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   842     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   843                                                                  ELCDTECX
   844     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   845     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   846                                                                  ELCDTECX
   847     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   848     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   849                                                                  ELCDTECX
   850     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   851                                                                  ELCDTECX
   852 01  DATE-CARD-FACTORS.                                           ELCDTECX
   853     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   854     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   855     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   856     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   857     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   858     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   859     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   860                                                                  ELCDTECX
   861 01  FILLER                          PIC  X(12)                   ELCDTECX
   862                                          VALUE 'COMPANY NAME'.   ELCDTECX
   863 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   864     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   865         16  CNT-ID                  PIC  X.                      ELCDTECX
   866         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   867                                                                  ELCDTECX
   868 01  FILLER                          PIC  X(11)                   ELCDTECX
   869                                          VALUE 'STATE NAMES'.    ELCDTECX
   870 01  STATE-NAMES.                                                 ELCDTECX
   871     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   872         16  STATE-SUB               PIC  XX.                     ELCDTECX
   873         16  STATE-PIC1.                                          ELCDTECX
   874             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   875             20  FILLER              PIC  XXX.                    ELCDTECX
   876             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   877             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   878             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   879             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   880                                                                  ELCDTECX
   881 01  FILLER                          PIC  X(13)                   ELCDTECX
   882                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   883 01  CARRIER-NAMES.                                               ELCDTECX
   884     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   885         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   886         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   887         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   888         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   889         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   890         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   891*        16  FILLER                  PIC  X.                      ELCDTECX
   892         16  CARRIER-SEC-PAY         PIC  X.
   893             88  SEC-PAY-CARRIER          VALUE 'Y'.
   894                                                                  ELCDTECX
   895 01  FILLER                          PIC  X(9)                       CL**6
   896                                          VALUE 'INS TYPES'.      ELCDTECX
   897 01  CLAS-INS-TYPES.                                              ELCDTECX
   898*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   899     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   900         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   901         16  CLAS-I-AB3.                                          ELCDTECX
   902             20  FILLER              PIC  X.                      ELCDTECX
   903             20  CLAS-I-AB2.                                      ELCDTECX
   904                 24  FILLER          PIC  X.                      ELCDTECX
   905                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   906         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   907             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   908             20  FILLER              PIC  X.                         CL**4
   909         16  CLAS-I-AB10.                                         ELCDTECX
   910             20  FILLER              PIC  X(9).                   ELCDTECX
   911             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   912         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   913         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   914         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   915         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   916             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   917         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   918         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   919         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   920         16  CLAS-I-BEN-CATEGORY     PIC  X.
   921         16  CLAS-I-REFUND-METHOD    PIC  X(01).
   922         16  FILLER                  PIC  X(05).
   923                                                                  ELCDTECX
   924 01  FILLER                          PIC  X(16)                   ELCDTECX
   925                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   926 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   927     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   928                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   929         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   930         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   931         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   932         16  CLAS-MORT-DESC.                                      ELCDTECX
   933             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   934             20  FILLER              PIC  XX.                        CL**5
   935             20  CLAS-YEAR           PIC  X(4).                      CL**6
   936             20  FILLER              PIC  X.                         CL**5
   937             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   938             20  FILLER              PIC  X.                         CL**5
   939             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   940             20  FILLER              PIC  X.                         CL**5
   941             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   942             20  FILLER              PIC  X(5).                      CL**6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   943                                                                  ELCDTECX
   944 01  FILLER                          PIC  X(15)                   ELCDTECX
   945                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   946 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   947     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   948         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   949         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   950         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   951         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   952         16  FILLER                  PIC  X(4).                      CL**6
   953                                                                  ELCDTECX
   954 01  FILLER                          PIC  X(7)                       CL**6
   955                                     VALUE 'INDEXES'.             ELCDTECX
   956 01  CLAS-INDEX-TBL.                                              ELCDTECX
   957     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   958     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   959     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   960     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   961     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   962     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   963     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   964     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   965     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   966     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   967     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   968     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   969     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   970     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   971     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   972     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   973     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   974                                                                  ELCDTECX
   975 01  CLAS-TYPE-MISC.                                              ELCDTECX
   976     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   977     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   978     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   979     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   980     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   981     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   982     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   983     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   984     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   985     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   986     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   987                                                                  ELCDTECX
   988 01  FILLER                          PIC  X(13)                   ELCDTECX
   989                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   990 01  CLAS-MISC.                                                   ELCDTECX
   991     12  DTE-FICH                    PIC  X.                      ELCDTECX
   992         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   993         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   994         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   995     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   996     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   997     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   998     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   999     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1000     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1001     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1002     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1003     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1004     12  STATE-L                     PIC  XX.                     ELCDTECX
  1005     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1006     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1007     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1008         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1009         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1010     12  DTE-ABEND-WORK.                                          ELCDTECX
  1011         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1012         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1013                                                                  ELCDTECX
  1014 01  FILLER                          PIC  X(12)                   ELCDTECX
  1015                                     VALUE 'WORKING DATE'.        ELCDTECX
  1016 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1017     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1018         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1019         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1020         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1021     12  WS-CURRENT-DATE.                                         ELCDTECX
  1022         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1023         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1024         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1025         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1026         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1027     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1028         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1029         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1030                                                                  ELCDTECX
  1031 01  FILLER                          PIC  X(12)                   ELCDTECX
  1032                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1033 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1034     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1035         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1036         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1037         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1038                                                                  ELCDTECX
  1039 01  FILLER                          PIC  X(10)                   ELCDTECX
  1040                                     VALUE 'STATE TLRS'.          ELCDTECX
  1041 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1042     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1043         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1044         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1045                                                                  ELCDTECX
  1046 01  FILLER                          PIC  X(13)                   ELCDTECX
  1047                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1048 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1049     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1050         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1051                                                                  ELCDTECX
  1052 01  FILLER                          PIC  X(13)                   ELCDTECX
  1053                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1054 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1055     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1056     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1057     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1058                                     PIC  X.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1059     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1060     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1061     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1062     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1063     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1064     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1065     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1066     12  FILLER                      PIC  X(75).                  ELCDTECX
  1067******************************************************************ELCDTECX
  1068*01  MISC-CARR-PCT-DATA.                                          00001521
  1069*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1070*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1071*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1072*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1073*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1074*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1075******************************************************************ELCDTECX
* 1076     COPY ELCDTEVR.
  1077***************************************************************** 04/15/98
  1078*                                                                *ELCDTEVR
  1079*                                                                *ELCDTEVR
  1080*                            ELCDTEVR.                           *   LV003
  1081*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1082*                            VMOD=2.001                          *   CL**2
  1083*                                                                *ELCDTEVR
  1084*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1085*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1086*                                                                *ELCDTEVR
  1087******************************************************************ELCDTEVR
  1088 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1089     05  WS-RUN-DATE.                                             ELCDTEVR
  1090         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1091         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1092         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1093             15  RUN-CC              PIC  99.                     ELCDTEVR
  1094             15  RUN-YR              PIC  99.                     ELCDTEVR
  1095         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1096         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1097     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1098            WS-RUN-DATE              PIC 9(11).                      CL**2
  1099     05  WS-EP-DT.                                                ELCDTEVR
  1100         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1101         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1102         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1103             15  EP-CC               PIC  99.                     ELCDTEVR
  1104             15  EP-YR               PIC  99.                     ELCDTEVR
  1105         10  EP-MO                   PIC  99.                     ELCDTEVR
  1106         10  EP-DA                   PIC  99.                     ELCDTEVR
  1107     05  WS-EP-DT-N REDEFINES                                        CL**2
  1108            WS-EP-DT                 PIC 9(11).                      CL**2
  1109     05  WS-DTE-CONV-DT.                                             CL**4
  1110         10  FILLER                  PIC  9(03).                     CL**4
  1111         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1112         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1113             15  DTE-CONV-CC         PIC  99.                        CL**4
  1114             15  DTE-CONV-YR         PIC  99.                        CL**4
  1115         10  DTE-CONV-MO             PIC  99.                        CL**4
  1116         10  DTE-CONV-DA             PIC  99.                        CL**4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1117     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1118            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1119 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1120     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1121         10  FILLER                            PIC 999.           ELCDTEVR
  1122         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1123         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1124             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1125             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1126         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1127         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1128     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1129            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1130     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1131         10  FILLER                            PIC 999.           ELCDTEVR
  1132         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1133         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1134         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1135         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1136     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1137            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1138 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1139     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1140         10  FILLER                            PIC 999.           ELCDTEVR
  1141         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1142         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1143             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1144             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1145         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1146         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1147     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1148            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1149     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1150         10  FILLER                            PIC 999.           ELCDTEVR
  1151         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1152         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1153             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1154             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1155         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1156         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1157     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1158            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1159     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1160         10  FILLER                            PIC 999.           ELCDTEVR
  1161         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1162         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1163             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1164             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1165         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1166         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1167     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1168            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1169 01  WS-RATE-RECORD.                                              ELCDTEVR
  1170         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1171             10  FILLER                        PIC 999.           ELCDTEVR
  1172             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1173             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1174                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1175                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1176             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1177             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1178         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1179                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1180
  1181 LINKAGE SECTION.                                                 00950032
  1182                                                                  00960032
  1183 01  PARM.                                                        00970032
  1184     05  PARM-LENGTH      PIC S9(4)  COMP.                        00980032
  1185     05  PARM-PREV-DATE   PIC X(8).                               00990032
  1186     05  FILLER           PIC X.                                  01000032
  1187     05  PARM-CURR-DATE   PIC X(8).                               01010032
  1188                                                                  01020032
  1189                                                                  01030032
  1190                                                                  01040032
  1191*                                                                 01070032
  1192 PROCEDURE DIVISION USING PARM.                                   01080032
  1193*                                                                 01090000
  1194*************************************************************
* 1195                                 COPY ELCDTERX.
  1196******************************************************************04/15/98
  1197*                                                                *ELCDTERX
  1198*                                                                *ELCDTERX
  1199*                            ELCDTERX.                           *   LV002
  1200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1201*                            VMOD=2.007                          *ELCDTERX
  1202*                                                                *ELCDTERX
  1203*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1204*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1205*      = ELCDTEFD)                                               *ELCDTERX
  1206*                                                                *ELCDTERX
  1207******************************************************************ELCDTERX
  1208                                                                  ELCDTERX
  1209     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1210                                                                  ELCDTERX
  1211     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1212     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1213     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1214                                                                  ELCDTERX
  1215     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1216                                                                  ELCDTERX
  1217******************************************************************ELCDTERX
  1218*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1219*          WARNING MESSAGES.                                      ELCDTERX
  1220******************************************************************ELCDTERX
  1221     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1222         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1223                                                                  ELCDTERX
  1224     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1225                                                                  ELCDTERX
  1226     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1227                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1228                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1229                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1230                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1231                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1232                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1233                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1234                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1235                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1236                                                                  ELCDTERX
  1237     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1238                                                                  ELCDTERX
  1239     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1240                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1241                                                                  ELCDTERX
  1242     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1243     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1244     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1245     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1246                                                                  ELCDTERX
  1247     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1248         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1249     ELSE                                                         ELCDTERX
  1250         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1251                                                                  ELCDTERX
  1252     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1253         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1254     ELSE                                                         ELCDTERX
  1255         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1256                                                                  ELCDTERX
  1257 0005-READ--CARD.                                                 ELCDTERX
  1258     READ DISK-DATE                                               ELCDTERX
  1259         AT END CLOSE DISK-DATE                                   ELCDTERX
  1260             GO TO 0060-READ--TEST.                               ELCDTERX
  1261                                                                  ELCDTERX
  1262     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1263                                                                  ELCDTERX
  1264     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1265         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1266         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1267         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1268         GO TO 0005-READ--CARD.                                   ELCDTERX
  1269                                                                  ELCDTERX
  1270     IF DD-ID = 'CLAD'                                            ELCDTERX
  1271         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1272         GO TO 0005-READ--CARD.                                   ELCDTERX
  1273                                                                  ELCDTERX
  1274     IF DD-ID = 'CLAX'                                            ELCDTERX
  1275         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1276         GO TO 0005-READ--CARD.                                   ELCDTERX
  1277                                                                  ELCDTERX
  1278     IF DD-ID = 'CLAF'                                            ELCDTERX
  1279         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1280         GO TO 0005-READ--CARD.                                   ELCDTERX
  1281                                                                  ELCDTERX
  1282     IF DD-ID = 'CLAC'                                            ELCDTERX
  1283         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1284                                                                  ELCDTERX
  1285     IF DD-ID = 'CARR'                                            ELCDTERX
  1286         GO TO 0015-READ--CARR.                                   ELCDTERX
  1287                                                                  ELCDTERX
  1288     IF DD-ID = 'STAT'                                            ELCDTERX
  1289         GO TO 0020-READ--STAT.                                   ELCDTERX
  1290                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1291     IF DD-ID = 'BUSC'                                            ELCDTERX
  1292         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1293                                                                  ELCDTERX
  1294     IF DD-ID = 'MORT'                                            ELCDTERX
  1295         GO TO 0030-READ--MORT.                                   ELCDTERX
  1296                                                                  ELCDTERX
  1297     IF DD-ID = 'CLAI'                                            ELCDTERX
  1298         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1299                                                                  ELCDTERX
  1300     IF DD-ID = 'COLC'                                            ELCDTERX
  1301         GO TO 0065-READ--COLC.                                   ELCDTERX
  1302                                                                  ELCDTERX
  1303     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1304        DD-IDA = 'CL'                                             ELCDTERX
  1305         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1306                                                                  ELCDTERX
  1307     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1308        DD-IDA = 'PO'                                             ELCDTERX
  1309         GO TO 0050-READ--POXX.                                   ELCDTERX
  1310                                                                  ELCDTERX
  1311     IF DD-ID = 'OPCA'                                            ELCDTERX
  1312         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1313                                                                  ELCDTERX
  1314     IF DD-ID = 'OPST'                                            ELCDTERX
  1315         GO TO 0072-READ--OPST.                                   ELCDTERX
  1316                                                                  ELCDTERX
  1317     IF DD-ID = 'OPBS'                                            ELCDTERX
  1318         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1319                                                                  ELCDTERX
  1320     IF DD-ID = 'OPMS'                                            ELCDTERX
  1321         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1322                                                                  ELCDTERX
  1323     GO TO 0005-READ--CARD.                                       ELCDTERX
  1324                                                                  ELCDTERX
  1325 0010-READ--CLAC.                                                 ELCDTERX
  1326     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1327     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1328     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1329     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1330     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1331     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1332     GO TO 0005-READ--CARD.                                       ELCDTERX
  1333                                                                  ELCDTERX
  1334 0015-READ--CARR.                                                 ELCDTERX
  1335     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1336     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1337        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1338        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1339        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1340        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1341        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1342        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1343        MOVE DD-CARR1-SECPAY-SW
  1344                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1345     END-IF
  1346                                                                  ELCDTERX
  1347     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1348     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1349        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1350        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1351        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1352        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1353        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1354        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1355        MOVE DD-CARR2-SECPAY-SW
  1356                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1357     END-IF
  1358                                                                  ELCDTERX
  1359                                                                  ELCDTERX
  1360     GO TO 0005-READ--CARD.                                       ELCDTERX
  1361                                                                  ELCDTERX
  1362 0020-READ--STAT.                                                 ELCDTERX
  1363     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1364     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1365        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1366         GO TO 0005-READ--CARD.                                   ELCDTERX
  1367                                                                  ELCDTERX
  1368     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1369     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1370     GO TO 0020-READ--STAT.                                       ELCDTERX
  1371                                                                  ELCDTERX
  1372 0025-READ--BUSC.                                                 ELCDTERX
  1373     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1374     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1375        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1376         GO TO 0005-READ--CARD.                                   ELCDTERX
  1377                                                                  ELCDTERX
  1378     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1379     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1380     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1381                                                                  ELCDTERX
  1382 0030-READ--MORT.                                                 ELCDTERX
  1383     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1384     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1385        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1386         GO TO 0005-READ--CARD.                                   ELCDTERX
  1387                                                                  ELCDTERX
  1388     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1389     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1390     GO TO 0030-READ--MORT.                                       ELCDTERX
  1391                                                                  ELCDTERX
  1392 0035-READ--CLXX.                                                 ELCDTERX
  1393     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1394          GO TO 0005-READ--CARD.                                  ELCDTERX
  1395                                                                  ELCDTERX
  1396     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1397         DISPLAY '***********************************************'ELCDTERX
  1398         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1399         DISPLAY '***********************************************'ELCDTERX
  1400         GO TO 0055-READ--STOP.                                   ELCDTERX
  1401                                                                  ELCDTERX
  1402     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1403        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1404         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1405                                                                  ELCDTERX
  1406     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1407        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1408         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1409                                                                  ELCDTERX
  1410*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1411     GO TO 0005-READ--CARD.                                       ELCDTERX
  1412                                                                  ELCDTERX
  1413 0040-READ--CLAI.                                                 ELCDTERX
  1414     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1415     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1416        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1417         GO TO 0005-READ--CARD.                                   ELCDTERX
  1418                                                                  ELCDTERX
  1419     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1420     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1421     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1422                                                                  ELCDTERX
  1423 0045-READ--DUMP.                                                 ELCDTERX
  1424     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1425     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1426                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1427     PERFORM ABEND-PGM.                                           ELCDTERX
  1428                                                                  ELCDTERX
  1429 0050-READ--POXX.                                                 ELCDTERX
  1430     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1431         GO TO 0005-READ--CARD.                                   ELCDTERX
  1432                                                                  ELCDTERX
  1433     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1434         DISPLAY '***********************************************'ELCDTERX
  1435         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1436         DISPLAY '***********************************************'ELCDTERX
  1437         GO TO 0055-READ--STOP.                                   ELCDTERX
  1438                                                                  ELCDTERX
  1439     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1440     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1441     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1442     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1443                                                                  ELCDTERX
  1444     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1445         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1446     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1447         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1448                                                                  ELCDTERX
  1449     GO TO 0005-READ--CARD.                                       ELCDTERX
  1450                                                                  ELCDTERX
  1451 0055-READ--STOP.                                                 ELCDTERX
  1452     GOBACK.                                                      ELCDTERX
  1453                                                                  ELCDTERX
  1454 0060-READ--TEST.                                                 ELCDTERX
  1455     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1456        CLAX-ID         = SPACE  OR                               ELCDTERX
  1457        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1458         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1459                                                                  ELCDTERX
  1460     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1461     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1462                                                                  ELCDTERX
  1463 0065-READ--COLC.                                                 ELCDTERX
  1464     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1465     GO TO 0005-READ--CARD.                                       ELCDTERX
  1466                                                                  ELCDTERX
  1467 0070-READ--OPCA.                                                 ELCDTERX
  1468                                                                  ELCDTERX
  1469     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1470                                                                  ELCDTERX
  1471     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1472             OR                                                   ELCDTERX
  1473         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1474         GO TO 0005-READ--CARD.                                   ELCDTERX
  1475                                                                  ELCDTERX
  1476     ADD 1                       TO INDEXCA.                      ELCDTERX
  1477     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1478                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1479     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1480                                                                  ELCDTERX
  1481 0072-READ--OPST.                                                 ELCDTERX
  1482                                                                  ELCDTERX
  1483     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1484                                                                  ELCDTERX
  1485     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1486             OR                                                   ELCDTERX
  1487         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1488         GO TO 0005-READ--CARD.                                   ELCDTERX
  1489                                                                  ELCDTERX
  1490     ADD 1                       TO INDEXST.                      ELCDTERX
  1491     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1492                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1493     GO TO 0072-READ--OPST.                                       ELCDTERX
  1494                                                                  ELCDTERX
  1495 0074-READ--OPBS.                                                 ELCDTERX
  1496                                                                  ELCDTERX
  1497     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1498                                                                  ELCDTERX
  1499     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1500             OR                                                   ELCDTERX
  1501         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1502         GO TO 0005-READ--CARD.                                   ELCDTERX
  1503                                                                  ELCDTERX
  1504     ADD 1                       TO INDEXBS.                      ELCDTERX
  1505     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1506     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1507                                                                  ELCDTERX
  1508 0079-READ--EXIT.                                                 ELCDTERX
  1509*    EXIT.                                                        ELCDTERX
  1510******************************************************************ELCDTERX
  1511*************************************************************
  1512     PERFORM 0000-HOUSEKEEPING THRU 0000-EXIT                     01100000
  1513                                                                  01110000
  1514     PERFORM 1000-PROCESS      THRU 1000-EXIT
  1515         UNTIL EOF.                                               01120000
  1516                                                                  01130000
  1517     CLOSE WORK-FILE CID-PAYMENTS
  1518
  1519     IF DTE-CLIENT = 'DCC'
  1520        CLOSE CSI-WORK-FILE
  1521              CCC-WORK-FILE
  1522     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* FNB165.cbl
  1523
  1524     GOBACK.                                                      01140000
  1525                                                                  01150000
  1526                                                                  01160000
  1527 1000-PROCESS.                                                    01190000
  1528*                                                                 01200000
  1529     READ CID-PAYMENTS                                            01210000
  1530         AT END GO TO 1000-EXIT.                                  01220000
  1531
  1532     IF PY-COMPANY-CD < DTE-CLASIC-COMPANY-CD
  1533        GO TO 1000-EXIT
  1534     ELSE
  1535        IF PY-COMPANY-CD > DTE-CLASIC-COMPANY-CD
  1536           SET EOF               TO TRUE
  1537           GO TO 1000-EXIT
  1538        END-IF
  1539     END-IF
  1540
  1541     IF (PY-RECORD-ID = 'PY')          AND                        01240010
  1542*       (PY-CARRIER = '6' OR '9')      AND                        01250010
  1543        (PY-RECORD-TYPE = 'R' OR 'C')                             01260010
  1544          CONTINUE                                                01270010
  1545     ELSE                                                         01280010
  1546          GO TO 1000-EXIT.                                        01290010
  1547                                                                  01300010
  1548     IF (PY-INPUT-DT > WS-PREV-DATE)                              01310011
  1549       AND (PY-INPUT-DT NOT > WS-CURR-DATE)                       01320011
  1550         CONTINUE                                                 01330002
  1551     ELSE                                                         01340002
  1552         GO TO 1000-EXIT.                                         01350002
  1553                                                                  01360002
  1554*    DISPLAY ' PY CARRIER = ' PY-CARRIER
  1555*    MOVE '3'                    TO PY-CARRIER
  1556
  1557     MOVE SPACES      TO WORK-RECORD                              01370015
  1558                                                                  01380011
  1559     MOVE '10'                   TO FX-TRAN-TYPE
  1560     MOVE '98'                   TO FX-SUB-TYPE
  1561
  1562
  1563     EVALUATE TRUE
  1564        WHEN DTE-CLIENT = 'AHL'
  1565           MOVE 'AHL PYADJ'      TO FX-SYSTEM
  1566           MOVE 'CRLOGC'         TO FX-SOURCE-CODE
  1567           MOVE '02'             TO FX-DIVISION
  1568        WHEN DTE-CLIENT = 'CID'
  1569           MOVE 'CID PYADJ'      TO FX-SYSTEM
  1570           MOVE 'CRLOGC'         TO FX-SOURCE-CODE
  1571           MOVE '02'             TO FX-DIVISION
  1572        WHEN (DTE-CLIENT = 'DCC')
  1573             AND (PY-CARRIER = '3' OR '4')
  1574           MOVE 'CSIDCCPYAJ'     TO FX-SYSTEM
  1575           MOVE 'LOGIC '         TO FX-SOURCE-CODE
  1576           MOVE '11'             TO FX-DIVISION
  1577        WHEN (DTE-CLIENT = 'DCC') AND
  1578             (PY-CARRIER = '5' OR '6')
  1579           MOVE 'CCCDCCPYAJ'     TO FX-SYSTEM
  1580           MOVE 'LOGIC '         TO FX-SOURCE-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* FNB165.cbl
  1581           MOVE '50'             TO FX-DIVISION
  1582        WHEN DTE-CLIENT = 'DCC'
  1583           MOVE 'LPAC PYADJ'     TO FX-SYSTEM
  1584           MOVE 'LOGIC '         TO FX-SOURCE-CODE
  1585           MOVE '11'             TO FX-DIVISION
  1586     END-EVALUATE
  1587
  1588
  1589
  1590
  1591
  1592*    IF DTE-CLIENT = 'CID'
  1593*       MOVE 'CID PYADJ'         TO FX-SYSTEM
  1594*       MOVE 'CRLOGC'            TO FX-SOURCE-CODE
  1595*       MOVE '02'                TO FX-DIVISION
  1596*    ELSE
  1597*       IF DTE-CLIENT = 'DCC'
  1598*          MOVE 'LPAC PYADJ'     TO FX-SYSTEM
  1599*          MOVE 'LOGIC '         TO FX-SOURCE-CODE
  1600*          MOVE '11'             TO FX-DIVISION
  1601*       END-IF
  1602*    END-IF
  1603
  1604     IF PY-RECORD-TYPE = 'C'                                      01440025
  1605        MULTIPLY PY-ENTRY-AMT BY -1 GIVING FX-AMOUNT              01450025
  1606     ELSE                                                         01460025
  1607        MOVE PY-ENTRY-AMT TO FX-AMOUNT                            01470025
  1608     END-IF                                                       01480025
  1609                                                                  01490018
  1610     MOVE ' '              TO FX-CLM-RES                          01500025
  1611     MOVE ' '              TO FX-ANN-STMT                         01510025
  1612     MOVE ' '              TO FX-PLAN-CODE                        01520025
  1613     MOVE PARM-CURR-DATE   TO FX-POSTING-DATE                     01530032
  1614     MOVE ' '              TO FX-POLICY-NO                        01540025
  1615                                                                  01550029
  1616     MOVE ' '              TO FX-STATE                            01580025
  1617     MOVE 'Y'              TO FX-LOC-CODE                         01590030
  1618     MOVE ' '              TO FX-ZIP-CODE                         01600025
  1619
  1620     IF DTE-CLIENT = 'CID' OR 'AHL'
  1621        MOVE 'S'                 TO FX-FY-REN
  1622     ELSE
  1623        MOVE ' '                 TO FX-FY-REN
  1624     END-IF
  1625
  1626     MOVE ' '               TO FX-AGENT-01
  1627     MOVE ' '               TO FX-DISTR
  1628                                                                  01640016
  1629     IF PY-GL-ACCOUNT = LOW-VALUES
  1630         MOVE SPACES        TO FX-SOURCE-ACCT
  1631     ELSE
  1632         MOVE PY-GL-ACCOUNT TO FX-SOURCE-ACCT
  1633     END-IF
  1634     MOVE PY-CARRIER        TO FX-DESCRIPTION(27:1)
  1635     MOVE PY-GROUPING(4:3)  TO FX-DESCRIPTION(28:3)
  1636     MOVE ' '               TO FX-REFERENCE
  1637     MOVE PY-FIN-RESP(4:7)  TO WS-FIN-RESP
  1638
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* FNB165.cbl
  1639     MOVE PY-ACCOUNT(3:8)   TO WS-CID-ACCT
  1640     IF WS-CID-ACCT = LOW-VALUE
  1641        MOVE SPACES         TO WS-CID-ACCT
  1642     END-IF
  1643
  1644     MOVE WS-SUSPENSE       TO FX-SUSPENSE
  1645     MOVE PY-FIN-RESP       TO FX-SUSPENSE
  1646     IF PY-ACCOUNT = LOW-VALUES
  1647        MOVE SPACES         TO FX-REFERENCE
  1648     ELSE
  1649        MOVE PY-ACCOUNT     TO FX-REFERENCE
  1650     END-IF
  1651
  1652**** THE PLAN CODE TABLE IS NO LONGER ACCESSED WITHIN THE CID
  1653**** LOGIC SYSTEM; THEREFORE THE FOLLOWING CALL IS NOT REQUIRED
  1654**** THIS CALL NEVER CAME BACK WITH ANYTHING - NO PLAN CODE KEY   01800026
  1655*    CALL 'FNB160' USING WORK-RECORD
  1656
  1657**** SEARCH PULLED FROM FNB160
  1658     IF FX-STATE NOT= SPACES
  1659         SEARCH ALL STATE-TABLE
  1660             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  1661             WHEN ST-STATE (ST-INDEX) = FX-STATE
  1662             MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  1663         END-SEARCH
  1664     END-IF
  1665
  1666     MOVE SYSTEM-DATE              TO FX-JOURNAL-DATE
  1667
  1668**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  1669**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  1670     MOVE '*'                      TO WORK-RECORD(250:1)
  1671
  1672     IF (DTE-CLIENT = 'DCC')
  1673        AND (PY-CARRIER = '3' OR '4')
  1674        WRITE CSI-WORK-RECORD    FROM WORK-RECORD
  1675     ELSE
  1676       IF (DTE-CLIENT = 'DCC') AND
  1677          (PY-CARRIER = '5' OR '6')
  1678            WRITE CCC-WORK-RECORD FROM WORK-RECORD
  1679       ELSE
  1680        WRITE WORK-RECORD
  1681       END-IF
  1682     END-IF
  1683
  1684     .
  1685 1000-EXIT.                                                       01840000
  1686     EXIT.                                                        01850000
  1687                                                                  01860029
  1688                                                                  01870029
  1689 0000-HOUSEKEEPING.                                               02260008
  1690                                                                  02270008
  1691     MOVE PARM-PREV-DATE(1:2) TO DC-GREG-DATE-1-MDY(1:2)          02280032
  1692     MOVE PARM-PREV-DATE(3:2) TO DC-GREG-DATE-1-MDY(3:2)          02290032
  1693     MOVE PARM-PREV-DATE(7:2) TO DC-GREG-DATE-1-MDY(5:2)          02300032
  1694     MOVE '4' TO DC-OPTION-CODE                                   02310032
  1695     CALL 'ELDATCX' USING DATE-CONVERSION-DATA                    02320012
  1696     IF DC-ERROR-CODE = ' '                                       02330010
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* FNB165.cbl
  1697         MOVE DC-BIN-DATE-1 TO WS-PREV-DATE                       02340010
  1698     ELSE                                                         02350010
  1699         DISPLAY 'PARAMETER PREVIOUS DATE IS INVALID: '           02360033
  1700                  PARM-PREV-DATE                                  02370033
  1701         ADD +1 TO FORCE-DUMP.                                    02380010
  1702                                                                  02390010
  1703     MOVE PARM-CURR-DATE(1:2) TO DC-GREG-DATE-1-MDY(1:2)          02400032
  1704     MOVE PARM-CURR-DATE(3:2) TO DC-GREG-DATE-1-MDY(3:2)          02410032
  1705     MOVE PARM-CURR-DATE(7:2) TO DC-GREG-DATE-1-MDY(5:2)          02420032
  1706     MOVE '4' TO DC-OPTION-CODE                                   02430032
  1707     CALL 'ELDATCX' USING DATE-CONVERSION-DATA                    02440032
  1708     IF DC-ERROR-CODE = ' '                                       02450032
  1709         MOVE DC-BIN-DATE-1 TO WS-CURR-DATE                       02460032
  1710     ELSE                                                         02470032
  1711         DISPLAY 'PARAMETER CURRENT DATE IS INVALID: '            02480033
  1712                  PARM-CURR-DATE                                  02490033
  1713         ADD +1 TO FORCE-DUMP.                                    02500032
  1714                                                                  02510032
  1715     IF WS-PREV-DATE > WS-CURR-DATE                               02520010
  1716         DISPLAY 'INVALID PARAMETER: PREVIOUS DATE > CURRENT DATE'02530033
  1717         DISPLAY 'PREVIOUS DATE = ' PARM-PREV-DATE                02540033
  1718         DISPLAY ' CURRENT DATE = ' PARM-CURR-DATE                02550033
  1719         ADD +1 TO FORCE-DUMP.                                    02560010
  1720                                                                  02570015
  1721     MOVE FUNCTION CURRENT-DATE
  1722                                 TO FUNCTION-DATE
  1723     MOVE WS-FN-MO               TO SYS-MO
  1724     MOVE WS-FN-DA               TO SYS-DA
  1725     MOVE WS-FN-CCYR             TO SYS-CCYY
  1726
  1727     OPEN  INPUT CID-PAYMENTS                                     02720016
  1728          OUTPUT WORK-FILE.                                       02730016
  1729                                                                  02740010
  1730     IF DTE-CLIENT = 'DCC'
  1731        OPEN OUTPUT CSI-WORK-FILE
  1732                    CCC-WORK-FILE
  1733     END-IF
  1734
  1735     .
  1736 0000-EXIT.                                                       02750010
  1737     EXIT.                                                        02760010
  1738 ABEND-PGM SECTION.                                               00026280
  1739     DISPLAY 'REACHED ABEND PGM '
  1740     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    00026290
  1741 ABEND-EXIT.                                                      00026300
  1742                                                                  02770009
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       50268     Code:        4909
