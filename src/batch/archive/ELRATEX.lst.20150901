* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   1
* ELRATEX.cbl
* Options: int("ELRATEX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK VERBOSE
*          directives(cobopt.bth) endp list("ELRATEX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATEX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATEX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ELRATEX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/11/95 14:39:14.
     7*                           VMOD=2.009
     8*
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   2
* ELRATEX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *    (BATCH VERSION OF ELRATE)                      *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    28*            *    AND RATES.                                     *
    29*            *****************************************************
    30
    31
    32******************************************************************
    33*                                                                *
    34*              INPUT FIELDS USED                                 *
    35*                                                                *
    36******************************************************************
    37*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    38*  CLASS CODE       - CP-CLASS-CODE                              *
    39*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    40*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    41*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    42*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    43*  STATE CODE (NUM) - CP-STATE                                   *
    44*  STATE CODE       - CP-STATE-STD-ABBV                          *
    45*  COMPANY I.D.     - CP-COMPANY-ID                              *
    46*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    47*  INSURED AGE      - CP-ISSUE-AGE                               *
    48*  RATING METHOD    - CP-EARNING-METHOD                          *
    49*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    50*  A.P.R.           - CP-LOAN-APR                                *
    51*  A/H RATING TERM  - CP-CAPPED-TERM  (ONLY FOR SKIP CODE A/H)   *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 INPUT-OUTPUT SECTION.
    58 FILE-CONTROL.
    59
    60     SELECT ERRATEF ASSIGN TO SYS001-FBA1-ERRATE
    61             ORGANIZATION IS INDEXED
    62             ACCESS IS SEQUENTIAL
    63             RECORD KEY IS ER-RATE-KEY
    64             FILE STATUS IS ER-STATUS.
    65
    66     SELECT OERATEF ASSIGN TO SYS001-FBA1-OERATE
    67             ORGANIZATION IS INDEXED
    68             ACCESS IS SEQUENTIAL
    69             RECORD KEY IS OE-RATE-KEY
    70             FILE STATUS IS ER-STATUS.
    71
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   3
* ELRATEX.cbl
    72 DATA DIVISION.
    73 FILE SECTION.
    74 FD  ERRATEF.
    75 01  ER-RATE-REC.
    76     03  FILLER       PIC XX.
    77     03  ER-RATE-KEY  PIC X(28).
    78     03  FILLER       PIC X(1735).
    79
    80 FD  OERATEF.
    81 01  OE-RATE-REC.
    82     03  FILLER       PIC XX.
    83     03  OE-RATE-KEY  PIC X(28).
    84     03  FILLER       PIC X(1735).
    85
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   4
* ELRATEX.cbl
    87 WORKING-STORAGE SECTION.
    88 77  FILLER   PIC X(32) VALUE '********************************'.
    89 77  FILLER   PIC X(32) VALUE '**  ELRATEX  WORKING STORAGE  **'.
    90 77  FILLER   PIC X(32) VALUE '***********VMOD 2.009 **********'.
    91
*   92                             COPY ELCRATWS.
    93******************************************************************04/15/98
    94*                                                                *ELCRATWS
    95*                                                                *ELCRATWS
    96*                            ELCRATWS.                           *   LV006
    97*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
    98*                            VMOD=2.010                          *   CL**6
    99*                                                                *ELCRATWS
   100******************************************************************ELCRATWS
   101                                                                  ELCRATWS
   102 01  STANDARD-AREAS.                                              ELCRATWS
   103     12  ER-STATUS               PIC XX.                          ELCRATWS
   104     12  WS-BROWSE-SW            PIC X       VALUE SPACE.         ELCRATWS
   105         88 WS-BROWSE-STARTED                VALUE 'Y'.           ELCRATWS
   106     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.  ELCRATWS
   107     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.  ELCRATWS
   108     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.      ELCRATWS
   109     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.      ELCRATWS
   110     12  ERRATE-KEY.                                              ELCRATWS
   111         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.        ELCRATWS
   112         16  RATE-STATE-CODE.                                     ELCRATWS
   113             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.       ELCRATWS
   114             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.       ELCRATWS
   115             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.       ELCRATWS
   116         16  RATE-L-AH-CODE.                                      ELCRATWS
   117             20  RATE-L-AH       PIC  X       VALUE SPACE.        ELCRATWS
   118             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.        ELCRATWS
   119         16  RATE-LIMITS.                                         ELCRATWS
   120             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.        ELCRATWS
   121             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.        ELCRATWS
   122             20  RATE-FUTURE     PIC  XX      VALUE SPACES.       ELCRATWS
   123             20  RATE-SEX        PIC  X       VALUE '9'.          ELCRATWS
   124         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.                CL**3
   125                                                                  ELCRATWS
   126     12  SAVE-ERRATE-KEY.                                         ELCRATWS
   127         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.        ELCRATWS
   128         16  SVRT-STATE-CODE.                                     ELCRATWS
   129             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.       ELCRATWS
   130             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.       ELCRATWS
   131             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.       ELCRATWS
   132         16  SVRT-L-AH-CODE.                                      ELCRATWS
   133             20  SVRT-L-AH       PIC  X       VALUE SPACE.        ELCRATWS
   134             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.        ELCRATWS
   135         16  SVRT-LIMITS.                                         ELCRATWS
   136             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.        ELCRATWS
   137             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.        ELCRATWS
   138             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.       ELCRATWS
   139             20  SVRT-SEX        PIC  X       VALUE '9'.          ELCRATWS
   140         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.                CL**2
   141                                                                  ELCRATWS
   142     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.          ELCRATWS
   143     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.    ELCRATWS
   144                                                                  ELCRATWS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   5
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATWS)
   145 01  CSL-WORK-AREAS          COMP-3.                              ELCRATWS
   146     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.      ELCRATWS
   147     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.      ELCRATWS
   148     12  WK-J                PIC S999           VALUE ZEROS.      ELCRATWS
   149     12  WK-K                PIC S999           VALUE ZEROS.      ELCRATWS
   150     12  WK-L                PIC S99V9(9)       VALUE ZEROS.      ELCRATWS
   151     12  WK-S                PIC S999V9(4)      VALUE ZEROS.      ELCRATWS
   152     12  WK-T                PIC S999           VALUE ZEROS.      ELCRATWS
   153     12  WK-T1               PIC S999           VALUE ZEROS.      ELCRATWS
   154     12  WK-U                PIC S99V9(9)       VALUE ZEROS.      ELCRATWS
   155     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.      ELCRATWS
   156     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   157     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   158     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   159     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   160     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   161     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   162     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   163     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   164     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   165     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.      ELCRATWS
   166     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.      ELCRATWS
   167                                                                  ELCRATWS
   168 01  TEXAS-REG-WORK-AREAS.                                        ELCRATWS
   169     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.              ELCRATWS
   170     12  TEX-FACT-2          PIC S9(3)       COMP-3.              ELCRATWS
   171     12  TEX-FACT-3          PIC S9(3)       COMP-3.              ELCRATWS
   172     12  TEX-FACT-4          PIC S9(7)       COMP-3.              ELCRATWS
   173     12  TEX-FACT-5          PIC S9(3)       COMP-3.              ELCRATWS
   174     12  TEX-FACT-6          PIC S9(3)       COMP-3.              ELCRATWS
   175     12  TEX-FACT-7          PIC S9(7)       COMP-3.              ELCRATWS
   176     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.              ELCRATWS
   177     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.              ELCRATWS
   178                                                                  ELCRATWS
   179 01  NET-PAY-INTERFACE.                                           ELCRATWS
   180     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.              ELCRATWS
   181     12  N-P-ORIG            PIC S9(3)       COMP-3.              ELCRATWS
   182     12  N-P-REM             PIC S9(3)       COMP-3.              ELCRATWS
   183     12  N-P-OPT             PIC X.                               ELCRATWS
   184     12  N-P-LOAN            PIC S9(3)       COMP-3.              ELCRATWS
   185     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.              ELCRATWS
   186                                                                  ELCRATWS
   187
*  188                             COPY ERCNETWS.
   189***************************************************************** 04/29/98
   190*                                                               * ERCNETWS
   191*                                                               * ERCNETWS
   192*                            ERCNETWS                           *    LV004
   193*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   194*                            VMOD=2.014                         *    CL**3
   195*                                                               * ERCNETWS
   196*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   197*                                                               * ERCNETWS
   198*****************************************************************.ERCNETWS
   199*                   C H A N G E   L O G
   200*
   201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   202*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   6
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   204* EFFECTIVE    NUMBER
   205*-----------------------------------------------------------------
   206* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   207* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   208* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   209* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   210* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   211******************************************************************
   212                                                                  ERCNETWS
   213 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   214     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   215        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   216        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   217        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   218        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   219        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   220        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   221        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   222        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   223        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   224        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   225        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   226        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   227        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   228        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   229                                                                  ERCNETWS
   230     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   231        88  NET-STD             VALUE 'N'.                        ERCNETWS
   232        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   233                                                                  ERCNETWS
   234     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   235        88  NP-RATING           VALUE '1'.                        ERCNETWS
   236        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   237        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   238                                                                  ERCNETWS
   239     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   240         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   241         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   242         16  J               PIC SV9(9)        VALUE +0.
   243         16  K               PIC SV9(9)        VALUE +0.
   244         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   245         16  D               PIC S9(5)         VALUE +.0.
   246         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   247         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   248         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   249         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   250         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   251         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
   252         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   253         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   254         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   255         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   256         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   257         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   258         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   259         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   260         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   7
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   261         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   262         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   263         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   264         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   265         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   266         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   267         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   268         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   269         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   270         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   271         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   272         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   273         16  K1              PIC S999          VALUE +1.          ERCNETWS
   274         16  K12             PIC S999          VALUE +12.         ERCNETWS
   275         16  K100            PIC S999          VALUE +100.        ERCNETWS
   276         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   277         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   278         16  Y REDEFINES NC-LR
   279                             PIC S99V9(5).
   280         16  TI              PIC S999V9(5)     VALUE +0.
   281         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   282         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   283         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   284         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   285         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   286         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   287         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   288         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   289                                                                  ERCNETWS
   290         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   291         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   292         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   293         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   294         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   295         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   296         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   297         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   298         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   299         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   300         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
   301         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   302         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   303                                                                  ERCNETWS
   304         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
   305                                                                  ERCNETWS
   306         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   307         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
   308                             PIC S999.                            ERCNETWS
   309                                                                  ERCNETWS
   310         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   311         16  R              REDEFINES REMAINING-TERM              ERCNETWS
   312                             PIC S999.                            ERCNETWS
   313                                                                  ERCNETWS
   314         16  LOAN-TERM       PIC S999.                            ERCNETWS
   315         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   316                             PIC S999.                            ERCNETWS
   317                                                                  ERCNETWS
   318         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   8
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   319         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
   320                             PIC S999.                            ERCNETWS
   321                                                                  ERCNETWS
   322         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   323                             PIC S9(7)V9(8).                      ERCNETWS
   324         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   325                             PIC S9(7)V9(8).                      ERCNETWS
   326                                                                  ERCNETWS
   327         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   328         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   329         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   330         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   331         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   332         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   333         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   334         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   335         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   336                                                                  ERCNETWS
   337     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   338         16  X1              PIC S999        VALUE +0.            ERCNETWS
   339         16  X2              PIC S999        VALUE +0.            ERCNETWS
   340         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   341         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   342         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   343         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   344                                                                  ERCNETWS
   345     12  CSO-RATE-WORK-AREAS.
   346         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   347         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   348         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   349
   350     12  WS-WORK-MISC.                                            ERCNETWS
   351         16  ws-extra-pmts       pic s999         comp-3.
   352         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   353         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   354*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   355         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   356         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   357         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   358         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
   359         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   360         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   361         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   362         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   363         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   364         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   365         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
   366         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   367******************************************************************ERCNETWS
   368
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   9
* ELRATEX.cbl
*  370                             COPY ELCDATE.
   371******************************************************************06/11/98
   372*                                                                *ELCDATE
   373*                                                                *ELCDATE
   374*                            ELCDATE.                            *   LV023
   375*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   376*                            VMOD=2.003                           ELCDATE
   377*                                                                *ELCDATE
   378*                                                                *ELCDATE
   379*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   380*                 LENGTH = 200                                   *   CL*19
   381******************************************************************ELCDATE
   382                                                                  ELCDATE
   383 01  DATE-CONVERSION-DATA.                                        ELCDATE
   384     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   385     12  DC-OPTION-CODE                PIC X.                        CL*15
   386         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   387         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   388         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   389         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   390         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   391         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   392         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   393         88  FIND-CENTURY               VALUE '7'.                   CL*22
   394         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   395         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   396         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   397         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   398         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   399         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   400         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   401         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   402         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   403         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   404         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   405         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   406         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   407         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   408         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   409         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   410         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   411         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   412         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   413         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   414         88  THREE-CHARACTER-BIN                                  ELCDATE
   415                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   416         88  GREGORIAN-TO-BIN                                        CL**2
   417                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   418         88  BIN-TO-GREGORIAN                                        CL**2
   419                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   420         88  JULIAN-TO-BINARY                                        CL**2
   421                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   422     12  DC-ERROR-CODE                 PIC X.                        CL*15
   423         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   424         88  DATE-CONVERSION-ERROR                                ELCDATE
   425                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   426         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   427         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  10
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   428         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   429         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   430         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   431         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   432         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   433         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   434         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   435         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   436     12  DC-END-OF-MONTH               PIC X.                        CL*15
   437         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   438     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   439         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   440         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   441         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   442     12  FILLER                        PIC X.                        CL*15
   443     12  DC-CONVERSION-DATES.                                        CL*15
   444         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   445         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   446         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   447         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   448                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   449             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   450             20  SLASH1-1              PIC X.                        CL*15
   451             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   452             20  SLASH1-2              PIC X.                        CL*15
   453             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   454         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   455         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   456                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   457             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   458             20  SLASH2-1              PIC X.                        CL*15
   459             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   460             20  SLASH2-2              PIC X.                        CL*15
   461             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   462         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   463         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   464                     DC-GREG-DATE-1-YMD.                          ELCDATE
   465             20  DC-YMD-YEAR           PIC 99.                       CL*15
   466             20  DC-YMD-MONTH          PIC 99.                       CL*15
   467             20  DC-YMD-DAY            PIC 99.                       CL*15
   468         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   469         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   470                      DC-GREG-DATE-1-MDY.                         ELCDATE
   471             20  DC-MDY-MONTH          PIC 99.                       CL*15
   472             20  DC-MDY-DAY            PIC 99.                       CL*15
   473             20  DC-MDY-YEAR           PIC 99.                       CL*15
   474         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   475             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   476             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   477             20  FILLER                PIC XX.                       CL*15
   478             20  DC-ALPHA-CENTURY.                                   CL*15
   479                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   480             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   481         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   482         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   483         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   484         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   485         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  11
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   486                                       PIC 9(05).                    CL*20
   487         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   488             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   489             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   490         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   491         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   492         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   493     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   494         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   495         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   496             20  FILLER                PIC 9(3).                     CL*15
   497             20  HOLD-CEN-1-CCYY.                                    CL*15
   498                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   499                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   500             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   501             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   502         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   503             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   504             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   505             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   506                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   507                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   508             20  FILLER                PIC 9(3).                     CL*15
   509         16  HOLD-CENTURY-1-X.                                       CL*15
   510             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   511             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   512                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   513                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   514             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   515             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   516         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   517             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   518             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   519             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   520                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   521                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   522             20  FILLER                PIC XXX.                      CL*23
   523         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   524         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   525         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   526         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   527             20  DC-JULIAN-1-CCYY.                                   CL*15
   528                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   529                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   530             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   531         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   532         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   533             20  DC-JULIAN-2-CCYY.                                   CL*15
   534                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   535                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   536             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   537         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   538             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   539             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   540             20  DC-EDITA-DAY          PIC 99.                       CL*15
   541             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   542             20  DC-EDITA-CCYY.                                      CL*15
   543                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  12
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   544                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   545         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   546             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   547             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   548             20  DC-EDITB-DAY          PIC 99.                       CL*15
   549             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   550             20  DC-EDITB-CCYY.                                      CL*15
   551                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   552                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   553         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   554         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   555                              DC-GREG-DATE-CYMD.                  ELCDATE
   556             20  DC-CYMD-CEN           PIC 99.                       CL*15
   557             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   558             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   559             20  DC-CYMD-DAY           PIC 99.                       CL*15
   560         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   561         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   562                              DC-GREG-DATE-MDCY.                  ELCDATE
   563             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   564             20  DC-MDCY-DAY           PIC 99.                       CL*15
   565             20  DC-MDCY-CEN           PIC 99.                       CL*15
   566             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   567    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   568        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   569    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   570    12  FILLER                         PIC X(28).                    CL*26
   571
*  572                             COPY ERCRATE.
   573******************************************************************01/20/90
   574*                                                                *ERCRATE
   575*                                                                *ERCRATE
   576*                            ERCRATE                             *   LV007
   577*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   578*                            VMOD=2.008                          *   CL**7
   579*                                                                *ERCRATE
   580*   ONLINE CREDIT SYSTEM                                         *ERCRATE
   581*                                                                *ERCRATE
   582*   FILE DESCRIPTION = RATES MASTER FILE                         *ERCRATE
   583*                                                                *ERCRATE
   584*   FILE TYPE = VSAM,KSDS                                        *ERCRATE
   585*   RECORD SIZE = 1765  RECFORM = FIXED                          *ERCRATE
   586*                                                                *ERCRATE
   587*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *ERCRATE
   588*       ALTERNATE PATH = NONE                                    *ERCRATE
   589*                                                                *ERCRATE
   590*   LOG = NO                                                     *ERCRATE
   591*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRATE
   592*                                                                *ERCRATE
   593******************************************************************ERCRATE
   594                                                                  ERCRATE
   595 01  RATE-RECORD.                                                 ERCRATE
   596     12  RT-RECORD-ID                      PIC XX.                ERCRATE
   597         88  VALID-RT-ID                      VALUE 'RT'.         ERCRATE
   598                                                                  ERCRATE
   599     12  RT-CONTROL-PRIMARY.                                      ERCRATE
   600         16  RT-COMPANY-CD                 PIC X.                 ERCRATE
   601         16  RT-STATE-CODE.                                       ERCRATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  13
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCRATE)
   602             20  RT-ST-CODE                PIC XX.                ERCRATE
   603             20  RT-ST-CLASS               PIC XX.                ERCRATE
   604             20  RT-ST-DEV                 PIC XXX.               ERCRATE
   605         16  RT-L-AH-CODE.                                        ERCRATE
   606             20  RT-L-AH                   PIC X.                 ERCRATE
   607             20  RT-LAH-NUM                PIC XX.                   CL**3
   608         16  RT-LIMITS.                                           ERCRATE
   609             20  RT-HIGH-AGE               PIC 99.                ERCRATE
   610             20  RT-HIGH-AMT               PIC 9(6).              ERCRATE
   611             20  RT-FUTURE                 PIC XX.                ERCRATE
   612             20  RT-SEX                    PIC X.                 ERCRATE
   613         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.     ERCRATE
   614                                                                  ERCRATE
   615     12  RT-MAINT-INFORMATION.                                    ERCRATE
   616         16  RT-LAST-MAINT-DT              PIC XX.                ERCRATE
   617         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCRATE
   618         16  RT-LAST-MAINT-USER            PIC X(4).              ERCRATE
   619         16  FILLER                        PIC X(10).             ERCRATE
   620                                                                  ERCRATE
   621     12  RT-STRUCTURE-COMMENT              PIC X(50).             ERCRATE
   622     12  RT-RATE-COMMENT                   PIC X(50).             ERCRATE
   623                                                                  ERCRATE
   624     12  CSL-RESERVED                      PIC X(10).                CL**7
   625     12  FILLER                            PIC X(12).                CL**7
   626                                                                  ERCRATE
   627     12  RT-MAX-AGE                        PIC 99.                ERCRATE
   628                                                                  ERCRATE
   629     12  RT-LIFE-LIMS-FLDS.                                       ERCRATE
   630         16  RT-LIFE-MORT-CODE             PIC X(4).              ERCRATE
   631         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.                 ERCRATE
   632             20  RT-L-EX-AGE               PIC 99.                ERCRATE
   633             20  RT-L-EX-TERM              PIC S999       COMP-3. ERCRATE
   634             20  RT-L-EX-FACE              PIC S9(7)      COMP-3. ERCRATE
   635         16  FILLER                        PIC X(20).             ERCRATE
   636                                                                  ERCRATE
   637     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.         ERCRATE
   638         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.                   ERCRATE
   639             20  RT-AH-AGE                 PIC 99.                ERCRATE
   640             20  RT-AH-TERM                PIC S999       COMP-3. ERCRATE
   641             20  RT-AH-BEN-M               PIC S9(5)      COMP-3. ERCRATE
   642             20  RT-AH-BEN-F               PIC S9(7)      COMP-3. ERCRATE
   643                                                                  ERCRATE
   644     12  RT-LIFE-RATES.                                           ERCRATE
   645         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3. ERCRATE
   646                                                                  ERCRATE
   647     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.                 ERCRATE
   648         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3. ERCRATE
   649                                                                  ERCRATE
   650     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.    CL**2
   651                                                                     CL**2
   652     12  RT-DISCOUNT-OPTION                PIC X.                    CL**5
   653         88  RT-DO-NOT-USE                     VALUE ' '.            CL**5
   654         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.            CL**5
   655         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.            CL**5
   656                                                                     CL**5
   657     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.    CL**5
   658     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.    CL**5
   659                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  14
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCRATE)
   660     12  RT-COMPOSITE-OPTION               PIC X.                    CL**6
   661         88  RT-NO-COMPOSITE                   VALUE ' '.            CL**6
   662         88  RT-USE-COMPOSITE-RATE             VALUE '1'.            CL**6
   663                                                                     CL**6
   664     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.    CL**6
   665                                                                     CL**6
   666     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.    CL**7
   667     12  FILLER                            PIC X(13).                CL**7
   668                                                                     CL**4
   669     12  RT-TYPE-RATE                      PIC X.                    CL**4
   670         88  RT-IS-STND                        VALUE ' ' 'S'.        CL**4
   671         88  RT-IS-OB                          VALUE 'O'.            CL**4
   672                                                                  ERCRATE
   673     12  RT-SRT-ALPHA                      PIC X.                 ERCRATE
   674                                                                  ERCRATE
   675     12  RT-CONTROL-2.                                            ERCRATE
   676         16  RTC-1                         PIC X(7).              ERCRATE
   677         16  RTC-3                         PIC X(11).             ERCRATE
   678         16  RTC-4                         PIC 9(11) COMP-3.      ERCRATE
   679         16  RTC-2                         PIC X(3).              ERCRATE
   680******************************************************************ERCRATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  15
* ELRATEX.cbl
   682 LINKAGE SECTION.
   683
*  684                             COPY ELCCALC.
   685******************************************************************04/15/98
   686*                                                                *ELCCALC
   687*                           ELCCALC.                            *    LV003
   688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   689*                            VMOD=2.025                          *   CL**3
   690*                                                                *   CL**2
   691*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   692*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   693*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   694*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   695*                                                                *   CL**2
   696*  PASSED TO ELRTRM                                              *   CL**2
   697*  -----------------                                             *   CL**2
   698*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   699*  ORIGINAL TERM                                                 *   CL**2
   700*  BEGINNING DATE                                                *   CL**2
   701*  ENDING DATE                                                   *   CL**2
   702*  COMPANY I.D.                                                  *   CL**2
   703*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   704*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   705*  FREE LOOK DAYS                                                *   CL**2
   706*                                                                *   CL**2
   707*  RETURNED FROM ELRTRM                                          *   CL**2
   708*  ---------------------                                         *   CL**2
   709*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   710*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   711*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   712*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   713*----------------------------------------------------------------*   CL**2
   714*  PASSED TO ELRAMT                                              *   CL**2
   715*  ----------------                                              *   CL**2
   716*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   717*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   718*  ORIGINAL AMOUNT                                               *   CL**2
   719*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   720*  A.P.R. - NET PAY ONLY                                         *   CL**2
   721*  METHOD                                                            CL**2
   722*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   723*  COMPANY I.D.                                                  *   CL**2
   724*  BENEFIT TYPE                                                  *   CL**2
   725*                                                                *   CL**2
   726*  RETURNED FROM ELRAMT                                          *   CL**2
   727*  --------------------                                          *   CL**2
   728*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   729*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   730*  REMAINING AMOUNT FACTOR                                           CL**2
   731*----------------------------------------------------------------*   CL**2
   732*  PASSED TO ELRESV                                              *   CL**2
   733*  -----------------                                             *   CL**2
   734*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   735*  VALUATION DATE                                                *   CL**2
   736*  PAID THRU DATE                                                *   CL**2
   737*  BENEFIT                                                       *   CL**2
   738*  INCURRED DATE                                                 *   CL**2
   739*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  16
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   740*  ISSUE AGE                                                     *   CL**2
   741*  TERM                                                          *   CL**2
   742*  CDT PERCENT                                                   *   CL**2
   743*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   744* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   745* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   746* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   747*                                                                *   CL**2
   748*  RETURNED FROM ELRESV                                          *   CL**2
   749*  --------------------                                          *   CL**2
   750*  CDT TABLE USED                                                *   CL**2
   751*  CDT FACTOR USED                                               *   CL**2
   752*  PAY TO CURRENT RESERVE                                        *   CL**2
   753*  I.B.N.R. - A/H ONLY                                           *   CL**2
   754*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   755*----------------------------------------------------------------*   CL**2
   756*  PASSED TO ELRATE                                              *   CL**2
   757*  ----------------                                              *   CL**2
   758*  CERT ISSUE DATE                                               *   CL**2
   759*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   760*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   761*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   762*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   763*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   764*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   765*  DEVIATION CODE                                                *   CL**2
   766*  ISSUE AGE                                                     *   CL**2
   767*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   768*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   769*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   770*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   771*  A.P.R.                                                        *   CL**2
   772*  METHOD                                                            CL**2
   773*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   774*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   775*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   776*  BENEFIT CODE                                                  *   CL**2
   777*  BENEFIT OVERRIDE CODE                                         *   CL**2
   778*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   779*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   780*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   781*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   782*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   783*                                                                *   CL**2
   784*  RETURNED FROM ELRATE                                          *   CL**2
   785*  --------------------                                          *   CL**2
   786*  CALCULATED PREMIUM                                            *   CL**2
   787*  PREMIUM RATE                                                  *   CL**2
   788*  MORTALITY CODE                                                *   CL**2
   789*  MAX ATTAINED AGE                                              *   CL**2
   790*  MAX AGE                                                       *   CL**2
   791*  MAX TERM                                                      *   CL**2
   792*  MAX MONTHLY BENEFIT                                           *   CL**2
   793*  MAX TOTAL BENIFIT                                             *   CL**2
   794*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   795*----------------------------------------------------------------*   CL**2
   796*  PASSED TO ELRFND                                              *   CL**2
   797*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  17
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   798*  CERT ISSUE DATE                                               *   CL**2
   799*  REFUND DATE                                                   *   CL**2
   800*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   801*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   802*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   803*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   804*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   805*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   806*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   807*  DEVIATION CODE                                                *   CL**2
   808*  ISSUE AGE                                                     *   CL**2
   809*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   810*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   811*  PROCESS TYPE (CANCEL)                                         *   CL**2
   812*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   813*  A.P.R.                                                        *   CL**2
   814*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   815*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   816*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   817*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   818*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   819*  BENEFIT CODE                                                  *   CL**2
   820*  BENEFIT OVERRIDE CODE                                         *   CL**2
   821*                                                                *   CL**2
   822*  RETURNED FROM ELRFND                                          *   CL**2
   823*  --------------------                                          *   CL**2
   824*  CALCULATED REFUND                                             *   CL**2
   825*----------------------------------------------------------------*   CL**2
   826*  PASSED TO ELEARN                                              *   CL**2
   827*  ----------------                                              *   CL**2
   828*  CERT ISSUE DATE                                               *   CL**2
   829*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   830*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   831*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   832*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   833*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   834*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   835*  DEVIATION CODE                                                *   CL**2
   836*  ISSUE AGE                                                     *   CL**2
   837*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   838*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   839*  A.P.R.                                                        *   CL**2
   840*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   841*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   842*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   843*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   844*  BENEFIT CODE                                                  *   CL**2
   845*  BENEFIT OVERRIDE CODE                                         *   CL**2
   846*                                                                *   CL**2
   847*  RETURNED FROM ELEARN                                          *   CL**2
   848*  --------------------                                          *   CL**2
   849*  INDICATED  EARNINGS                                           *   CL**2
   850*----------------------------------------------------------------*   CL**2
   851*                 LENGTH = 450                                   *   CL**2
   852*                                                                *   CL**2
   853******************************************************************   CL**2
   854******************************************************************
   855*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  18
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   856*
   857* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   858*-----------------------------------------------------------------
   859*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   860* EFFECTIVE    NUMBER
   861*-----------------------------------------------------------------
   862* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   863* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   864* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   865* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   866* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   867* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   868* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   869* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   870* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   871******************************************************************
   872                                                                     CL**2
   873 01  CALCULATION-PASS-AREA.                                          CL**2
   874     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   875                                     COMP.                           CL**2
   876                                                                     CL**2
   877     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   878       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   879       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   880                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   881       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   882       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   883       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   884       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   885       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   886       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   887       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   888       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   889       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   890       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   891       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   892       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   893       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   894       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   895       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   896       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   897       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   898                                                                     CL**2
   899     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   900       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   901***********************  INPUT AREAS ****************************    CL**2
   902                                                                     CL**2
   903     12  CP-CALCULATION-AREA.                                        CL**2
   904         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   905         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   906         16  CP-VALUATION-DT       PIC XX.                           CL**2
   907         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   908         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   909           88  CP-AH                               VALUE 'A' 'D'     CL**2
   910                                                   'I' 'U'.          CL**2
   911           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   912           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   913         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  19
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   914         16  CP-REPORTED-DT        PIC XX.                           CL**2
   915         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   916         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   917         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   918                                     COMP-3.                         CL**2
   919         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   920                                     COMP-3.                         CL**2
   921         16  CP-CDT-METHOD         PIC X.                            CL**2
   922           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   923           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   924           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   925         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   926           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   927           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   928         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   929                                     COMP-3.                         CL**2
   930         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   931                                     COMP-3.                         CL**2
   932         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   933                                     COMP-3.                         CL**2
   934         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   935                                     COMP-3.                         CL**2
   936         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   937                                     COMP-3.                         CL**2
   938         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   939                                     COMP-3.                         CL**2
   940         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   941                                     COMP-3.                         CL**2
   942         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   943           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   944           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   945           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   946           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   947           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   948           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   949           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   950         16  CP-EARNING-METHOD     PIC X.                            CL**2
   951           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   952           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   953           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   954           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   955           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   956           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   957           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   958           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   959           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   960           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   961           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   962           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   963           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   964           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   965         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   966           88  CP-CLAIM                            VALUE '1'.        CL**2
   967           88  CP-CANCEL                           VALUE '2'.        CL**2
   968           88  CP-ISSUE                            VALUE '3'.        CL**2
   969         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   970           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   971           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  20
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   972           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   973           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   974           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   975           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   976           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   977           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   978           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   979           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   980           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   981           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   982           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   983           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   984           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   985           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   986           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   987           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   988                                                     'W' 'X'.        CL**2
   989           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   990           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   991           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   992           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   993           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   994           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   995           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   996           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   997           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   998           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   999           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1000           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1001           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1002                                                                     CL**2
  1003         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1004                                     COMP-3.                         CL**2
  1005         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1006         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1007         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1008         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1009         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1010           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1011               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1012         16  CP-R78-OPTION         PIC X.                            CL**2
  1013           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1014           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1015                                                                     CL**2
  1016         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1017         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1018         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1019         16  CP-RATE-FILE          PIC X.                            CL**2
  1020         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1021                                     COMP-3.                         CL**2
  1022                                                                     CL**2
  1023         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1024         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1025                                                                     CL**2
  1026         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1027                                     COMP-3.
  1028         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1029                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  21
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1030         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  1031                                     COMP-3.                         CL**2
  1032         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1033                                     COMP-3.                         CL**2
  1034         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1035                                     COMP-3.
  1036         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1037                                  PIC S9(7)V99 COMP-3.
  1038                                                                     CL**2
  1039         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1040         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1041         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1042           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1043           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1044           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1045           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1046         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1047         16  CP-CARRIER            PIC X.                            CL**2
  1048         16  CP-REIN-FLAG          PIC X.                            CL**2
  1049         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1050           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1051                      '2' '3' '4' '5'.                               CL**2
  1052           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1053           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1054           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1055           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1056           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1057           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1058           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1059           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1060         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1061         16  CP-RATING-METHOD      PIC X.                            CL**2
  1062           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1063           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1064           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1065           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1066           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1067           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1068           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1069           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1070           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1071         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1072                                     COMP-3.                         CL**2
  1073         16  CP-BEN-CATEGORY       PIC X.
  1074         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1075         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1076                                   PIC S99V9(5) COMP-3.
  1077         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1078         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1079                                   PIC S99V9(5) COMP-3.
  1080         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1081         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1082         16  CP-EXPIRE-DT          PIC XX.
  1083         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1084         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1085         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1086         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1087         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  22
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1088             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1089             88  CP-CALC-CLP              VALUE 'C'.
  1090         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1091         16  CP-CANCEL-REASON      PIC X.
  1092         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1093         16  CP-PMT-MODE           PIC X.
  1094         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1095         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1096         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1097         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1098         16  FILLER                PIC X.
  1099                                                                     CL**2
  1100***************    OUTPUT FROM ELRESV   ************************     CL**2
  1101                                                                     CL**2
  1102         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1103                                                                     CL**2
  1104         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1105                                     COMP-3.                         CL**2
  1106         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1107                                     COMP-3.                         CL**2
  1108         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1109                                     COMP-3.                         CL**2
  1110         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1111                                     COMP-3.                         CL**2
  1112         16  FILLER                PIC X(09).                        CL**2
  1113***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1114                                                                     CL**2
  1115         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1116                                     COMP-3.                         CL**2
  1117         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1118                                     COMP-3.                         CL**2
  1119         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1120                                     COMP-3.                         CL**2
  1121         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1122                                     COMP-3.                         CL**2
  1123         16  FILLER                PIC X(12).                        CL**2
  1124                                                                     CL**2
  1125***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1126                                                                     CL**2
  1127         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1128                                     COMP-3.                         CL**2
  1129         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1130                                     COMP-3.                         CL**2
  1131         16  FILLER                PIC X(12).                        CL**2
  1132                                                                     CL**2
  1133***************    OUTPUT FROM ELRATE   *************************    CL**2
  1134                                                                     CL**2
  1135         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1136                                     COMP-3.                         CL**2
  1137         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1138                                     COMP-3.                         CL**2
  1139         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1140         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1141             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1142         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1143                                     COMP-3.                         CL**2
  1144         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1145         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  23
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1146         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1147                                   PIC S9(7)V99 COMP-3.
  1148         16  FILLER                PIC X(07).                        CL**2
  1149                                                                     CL**2
  1150***************    OUTPUT FROM ELRFND   *************************    CL**2
  1151                                                                     CL**2
  1152         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1153                                     COMP-3.                         CL**2
  1154         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1155           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1156           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1157           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1158           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1159           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1160           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1161           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1162           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1163           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1164           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1165           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1166           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1167           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1168           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1169         16  FILLER                PIC X(12).                        CL**2
  1170                                                                     CL**2
  1171***************    OUTPUT FROM ELEARN   *************************    CL**2
  1172                                                                     CL**2
  1173         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1174                                     COMP-3.                         CL**2
  1175         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1176                                     COMP-3.                         CL**2
  1177         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1178                                     COMP-3.                         CL**2
  1179         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1180                                     COMP-3.                         CL**2
  1181         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1182                                     COMP-3.                         CL**2
  1183         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1184                                     COMP-3.                         CL**2
  1185         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1186           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1187           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1188           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1189           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1190           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1191           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1192           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1193           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1194           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1195         16  FILLER                PIC X(12).                        CL**2
  1196                                                                     CL**2
  1197***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1198                                                                     CL**2
  1199         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1200                                     COMP-3.                         CL**2
  1201         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1202                                     COMP-3.                         CL**2
  1203         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  24
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1204                                                                     CL**2
  1205***************   MISC WORK AREAS    *****************************   CL**2
  1206         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1207                                     COMP-3.                         CL**2
  1208         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1209                                     COMP-3.                         CL**2
  1210         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1211                                     COMP-3.                         CL**2
  1212         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1213                                     COMP-3.                         CL**2
  1214         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1215                                     COMP-3.                         CL**2
  1216         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1217                                     COMP-3.                         CL**2
  1218         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1219             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1220             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1221             88  IO-ERROR                         VALUE 'E'.         CL**2
  1222                                                                     CL**2
  1223         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1224                                                                     CL**2
  1225         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1226                                                                     CL**2
  1227         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1228                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1229                                     COMP-3.                         CL**2
  1230                                                                     CL**2
  1231         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1232                                                                     CL**2
  1233         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1234                                     COMP-3.                         CL**2
  1235                                                                     CL**2
  1236         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1237                                     COMP-3.                         CL**2
  1238                                                                     CL**2
  1239         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1240                                     COMP-3.                         CL**2
  1241                                                                     CL**2
  1242         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1243                                     COMP-3.                         CL**2
  1244                                                                     CL**2
  1245         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1246                                     COMP-3.                         CL**2
  1247                                                                     CL**2
  1248         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1249                                     COMP-3.                         CL**2
  1250                                                                     CL**2
  1251         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1252                                     COMP-3.                         CL**2
  1253                                                                     CL**2
  1254         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1255             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1256                                                                     CL**2
  1257         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1258                                     COMP-3.                         CL**2
  1259         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1260                                     COMP-3.
  1261         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  25
* ELRATEX.cbl
  1262         16  FILLER                PIC X(15).                        CL**2
  1263******************************************************************   CL**2
  1264
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  26
* ELRATEX.cbl
  1266 PROCEDURE DIVISION USING CALCULATION-PASS-AREA.
  1267
  1268 000-START-PREMIUM-CALC.
  1269
  1270*    IF CP-RATE-FILE = 'O'
  1271*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1272
  1273     IF  OPEN-RATE-FILE
  1274         GO TO 9999-OPEN-RATE-FILE.
  1275
  1276     IF  CLOSE-RATE-FILE
  1277         GO TO 9999-CLOSE-RATE-FILE.
  1278
  1279     MOVE ZERO                   TO CP-RETURN-CODE
  1280                                    CP-CALC-PREMIUM
  1281                                    CP-PREMIUM-RATE
  1282                                    CP-POLICY-FEE.
  1283
  1284     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1285     MOVE ALL '9'                TO ERRATE-KEY.
  1286
  1287     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1288     MOVE CP-STATE               TO RATE-ST-CODE.
  1289     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1290     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1291     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1292
  1293     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1294        CP-RATING-BENEFIT-AMT = ZEROS
  1295         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1296     ELSE
  1297         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1298
  1299     IF CP-AH
  1300         MOVE CP-AH-OVERRIDE-CODE    TO RATE-L-AH
  1301     ELSE
  1302         MOVE CP-LIFE-OVERRIDE-CODE  TO RATE-L-AH.
  1303
  1304     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1305     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1306     MOVE SPACE                  TO DC-OPTION-CODE.
  1307
  1308     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1309     IF NO-CONVERSION-ERROR
  1310         MOVE DC-GREG-DATE-CYMD  TO RATE-EXPIRY-DATE
  1311         MOVE  ERRATE-KEY        TO SAVE-ERRATE-KEY
  1312     ELSE
  1313         MOVE '2'                TO CP-RETURN-CODE
  1314         GO TO 9999-CALC-RATE-PREM-X.
  1315
  1316 0050-RATE-START-BROWSE.
  1317     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1318         MOVE ERRATE-KEY TO OE-RATE-KEY
  1319         START OERATEF KEY NOT LESS THAN OE-RATE-KEY
  1320     ELSE
  1321         MOVE ERRATE-KEY TO ER-RATE-KEY
  1322         START ERRATEF KEY NOT LESS THAN ER-RATE-KEY.
  1323
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  27
* ELRATEX.cbl
  1324     IF  ER-STATUS NOT = '00'
  1325         GO TO 9999-RATE-NOTFND.
  1326
  1327 0100-READ-RATE-LOOP.
  1328     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1329         READ OERATEF NEXT RECORD
  1330     ELSE
  1331         READ ERRATEF NEXT RECORD.
  1332
  1333     IF  ER-STATUS NOT = '00'
  1334         GO TO 9999-RATE-NOTFND.
  1335
  1336     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1337         MOVE OE-RATE-REC TO RATE-RECORD
  1338     ELSE
  1339         MOVE ER-RATE-REC TO RATE-RECORD.
  1340
  1341 0110-CHECK-KEYS.
* 1342                      COPY ELCRATPD.
  1343******************************************************************
  1344*                                                                *
  1345*                                                                *
  1346*                            ELCRATPD                            *
  1347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1348*                            VMOD=2.061                          *
  1349*                                                                *
  1350******************************************************************
  1351******************************************************************
  1352*                   C H A N G E   L O G
  1353*
  1354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1355*-----------------------------------------------------------------
  1356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1357* EFFECTIVE    NUMBER
  1358*-----------------------------------------------------------------
  1359* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1360* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1361* 032603                   PEMA  ADD SPECIAL AZ CALC
  1362* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1363* 120403                   PEMA  ADD SPECIAL TX CALC
  1364* 092205                   PEMA  FIX CRIT PER FOR DCC
  1365* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1366* 021207                   PEMA  ADD PA NP
  1367* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1368* 032807                   PEMA  ADD VT NP PLUS 2
  1369* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1370* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1371* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1372* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1373* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1374* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1375* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1376* 071211    2010012700001  PEMA  ADD SPPDD
  1377* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1378* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1379* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1380* 032612  CR2011110200001  PEMA  AHL CHANGES
  1381* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  28
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1382* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1383* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1384******************************************************************
  1385
  1386 0110-CHECK-KEY.
  1387     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1388        SVRT-ST-CODE    = RT-ST-CODE     AND
  1389        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1390        SVRT-ST-DEV     = RT-ST-DEV      AND
  1391        SVRT-L-AH       = RT-L-AH        AND
  1392        SVRT-LAH-NUM    = RT-LAH-NUM
  1393         NEXT SENTENCE
  1394     ELSE
  1395         GO TO 9999-RATE-NOTFND.
  1396
  1397     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1398         GO TO 9999-RATE-NOTFND.
  1399
  1400     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1401        GO TO 0100-READ-RATE-LOOP.
  1402
  1403     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1404         GO TO 0100-READ-RATE-LOOP.
  1405
  1406     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1407         GO TO 0100-READ-RATE-LOOP.
  1408
  1409     IF RT-MAX-AGE = ZEROS
  1410         NEXT SENTENCE
  1411     ELSE
  1412         COMPUTE WS-AGE =
  1413             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1414         IF WS-AGE >= RT-MAX-AGE
  1415             MOVE 'B'               TO CP-RETURN-CODE.
  1416
  1417     IF CP-LOAN-TERM NOT NUMERIC
  1418         MOVE +0                    TO CP-LOAN-TERM.
  1419
  1420     IF CP-LOAN-TERM = ZERO
  1421         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1422
  1423     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1424         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1425
  1426     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1427     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1428
  1429     IF CP-AH
  1430         GO TO 2000-TYPE-IS-AH.
  1431
  1432     evaluate true
  1433        when (rt-is-ob)
  1434           and (cp-company-id not = 'CID')
  1435              move cp-loan-term  to ws-rate-term
  1436        when (cp-company-id = 'DCC')
  1437           and (cp-benefit-cd (1:1) = 'P')
  1438           move cp-loan-term     to ws-rate-term
  1439        when other
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  29
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1440           move cp-original-term to ws-rate-term
  1441     end-evaluate
  1442
  1443*    IF ((RT-IS-OB)
  1444*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1445*                     OR
  1446*       ((CP-COMPANY-ID = 'DCC')
  1447*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1448*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1449*    ELSE
  1450*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1451*    END-IF
  1452
  1453     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1454     MOVE SPACE                     TO DC-OPTION-CODE.
  1455
  1456     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1457
  1458 1000-TYPE-IS-LIFE.
  1459     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1460
  1461     MOVE ZERO                      TO CP-R-MAX-AGE
  1462                                       CP-R-MAX-TERM
  1463                                       CP-R-MAX-MON-BEN
  1464                                       CP-R-MAX-TOT-BEN.
  1465
  1466     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1467
  1468     IF RT-POLICY-FEE NUMERIC
  1469        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1470
  1471     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1472
  1473     IF (RT-DISCOUNT-OPTION EQUAL
  1474                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1475        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1476        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1477         NEXT SENTENCE
  1478     ELSE
  1479         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1480            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1481             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1482                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1483                 GO TO 1050-REGULAR-RATES
  1484             ELSE
  1485                 GO TO 1050-REGULAR-RATES
  1486         ELSE
  1487             GO TO 1050-REGULAR-RATES.
  1488
  1489*    display ' discount option ' rt-discount-option
  1490     IF RT-DISCOUNT-RATE NOT NUMERIC
  1491        MOVE +0                  TO RT-DISCOUNT-RATE.
  1492
  1493     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1494        NEXT SENTENCE
  1495     ELSE
  1496        MOVE +0                  TO CP-PREMIUM-RATE
  1497                                    CP-COMPOSITE-RATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  30
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1498                                    CP-CALC-PREMIUM
  1499         MOVE '4'                TO CP-RETURN-CODE
  1500         GO TO 9999-CALC-RATE-PREM-X.
  1501
  1502     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1503        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1504     ELSE
  1505        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1506
  1507*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1508*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1509*       GO TO 1075-BYPASS-REGULAR-RATE.
  1510
  1511     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1512        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1513        COMPUTE WS-WORK-DIS-RATE EQUAL
  1514                WS-WORK-DIS-RATE / +100
  1515        GO TO 1075-BYPASS-REGULAR-RATE.
  1516
  1517     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1518        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1519        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1520        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1521        GO TO 1075-BYPASS-REGULAR-RATE.
  1522
  1523     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1524        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1525        (CP-TRUNCATED-LIFE)
  1526        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1527        GO TO 1075-BYPASS-REGULAR-RATE.
  1528
  1529     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1530        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1531        (CP-EARN-AS-NET-PAY)
  1532*       (CP-TRUNCATED-LIFE)
  1533        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1534        GO TO 1075-BYPASS-REGULAR-RATE.
  1535
  1536     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1537        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1538                   AND
  1539        ((CP-EARN-AS-NET-PAY)
  1540               OR
  1541        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1542        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1543        GO TO 1075-BYPASS-REGULAR-RATE.
  1544
  1545     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1546        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1547        (CP-EARN-AS-NET-PAY) AND
  1548        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1549        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1550        GO TO 1075-BYPASS-REGULAR-RATE.
  1551
  1552     IF (CP-COMPANY-ID = 'CID')
  1553        AND (CP-STATE-STD-ABBRV = 'MN')
  1554        AND (RT-DISCOUNT-OPTION = '1')
  1555        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  31
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1556                     OR
  1557            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1558            AND (CP-CERT-EFF-DT > X'A4FF'))
  1559        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1560        GO TO 1075-BYPASS-REGULAR-RATE
  1561     END-IF
  1562
  1563     IF (CP-COMPANY-ID EQUAL 'CID')
  1564        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1565                      OR
  1566            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1567        AND (CP-EARN-AS-NET-PAY)
  1568        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1569        GO TO 1075-BYPASS-REGULAR-RATE
  1570     END-IF
  1571
  1572     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1573        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1574        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1575         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1576         GO TO 1075-BYPASS-REGULAR-RATE.
  1577
  1578     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1579        CONTINUE
  1580     ELSE
  1581        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1582           (CP-EARN-AS-NET-PAY ) AND
  1583           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1584            GO TO 1075-BYPASS-REGULAR-RATE
  1585        END-IF
  1586     END-IF
  1587
  1588     IF (CP-COMPANY-ID = 'CID') AND
  1589        (CP-EARN-AS-NET-PAY) AND
  1590        (CP-LEVEL-LIFE) AND
  1591        (CP-STATE-STD-ABBRV = 'CA') AND
  1592        (CP-STATE-STD-ABBRV = CP-STATE)
  1593        COMPUTE WS-WORK-DIS-RATE =
  1594             RT-DISCOUNT-RATE / +100
  1595        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1596        GO TO 1075-BYPASS-REGULAR-RATE
  1597     END-IF
  1598
  1599     IF (CP-COMPANY-ID = 'CID')
  1600        AND (CP-EARN-AS-NET-PAY)
  1601        AND (CP-STATE-STD-ABBRV = 'ME')
  1602        COMPUTE WS-WORK-DIS-RATE =
  1603             RT-DISCOUNT-RATE / +100
  1604        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1605        GO TO 1075-BYPASS-REGULAR-RATE
  1606     END-IF
  1607
  1608     IF (CP-COMPANY-ID = 'CID')
  1609        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1610           OR 'IN' OR 'AZ' OR 'WA')
  1611        AND (CP-FARM-PLAN)
  1612        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1613        GO TO 1075-BYPASS-REGULAR-RATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  32
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1614     END-IF
  1615
  1616     IF (CP-COMPANY-ID = 'DCC')
  1617        AND (CP-BEN-CATEGORY = 'D')
  1618        AND (CP-EARN-AS-NET-PAY)
  1619        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1620        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1621           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1622*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1623*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1624*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1625*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1626        GO TO 1075-BYPASS-REGULAR-RATE
  1627     END-IF
  1628
  1629     IF (CP-COMPANY-ID = 'CID') AND
  1630        (CP-EARN-AS-NET-PAY) AND
  1631        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1632                            OR 'VT')
  1633                   OR
  1634        ((CP-STATE-STD-ABBRV = 'IN') AND
  1635        (CP-CERT-EFF-DT > X'9A7F'))
  1636                   OR
  1637        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1638        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1639        (CP-STATE-STD-ABBRV = CP-STATE)
  1640        COMPUTE WS-WORK-DIS-RATE =
  1641             RT-DISCOUNT-RATE / +100
  1642        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1643        GO TO 1075-BYPASS-REGULAR-RATE
  1644     END-IF
  1645
  1646     IF (CP-COMPANY-ID = 'CID') AND
  1647        (CP-EARN-AS-NET-PAY) AND
  1648        (CP-STATE-STD-ABBRV = 'TX') AND
  1649        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1650        (WS-DISCOUNT-OPTION NOT = ' ')
  1651        COMPUTE WS-WORK-DIS-RATE =
  1652             RT-DISCOUNT-RATE / +100
  1653        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1654        GO TO 1075-BYPASS-REGULAR-RATE
  1655     END-IF
  1656
  1657     IF (CP-COMPANY-ID = 'CID') AND
  1658        (CP-EARN-AS-NET-PAY) AND
  1659        (CP-TRUNCATED-LIFE) AND
  1660        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1661        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1662        (WS-DISCOUNT-OPTION NOT = ' ')
  1663        COMPUTE WS-WORK-DIS-RATE =
  1664             RT-DISCOUNT-RATE / +100
  1665        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1666        GO TO 1075-BYPASS-REGULAR-RATE
  1667     END-IF
  1668
  1669     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1670        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1671           COMPUTE WS-WORK-DIS-RATE EQUAL
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  33
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1672                   WS-WORK-DIS-RATE / +100.
  1673
  1674     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1675        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1676           IF CP-MONTHLY-PAYMENT EQUAL +0
  1677            IF CP-LOAN-APR GREATER THAN +2
  1678              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1679              CP-ORIGINAL-BENEFIT /
  1680               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1681               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1682            ELSE
  1683             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1684               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1685
  1686     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1687        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1688          IF WS-WORK-DIS-RATE GREATER THAN +0
  1689           COMPUTE WK1 ROUNDED EQUAL
  1690           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1691                              (WS-RATE-TERM - +1)) /
  1692                        (WS-WORK-DIS-RATE / +12)
  1693           COMPUTE WK2 ROUNDED EQUAL
  1694           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1695                              (WS-RATE-TERM)) /
  1696                        (WS-WORK-DIS-RATE / +12)
  1697           COMPUTE WK3 EQUAL
  1698                RT-DISCOUNT-OB-RATE *
  1699                (1 + WS-WORK-DIS-RATE / +12)
  1700                MOVE WK3 TO CP-PREMIUM-RATE
  1701                COMPUTE WK5 EQUAL WK3 / +1000
  1702           GO TO 1075-BYPASS-REGULAR-RATE.
  1703*               (RT-DISCOUNT-OB-RATE / +1000) *
  1704*               (1 + WS-WORK-DIS-RATE / +12)
  1705*          GO TO 1075-BYPASS-REGULAR-RATE.
  1706
  1707     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1708        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1709           COMPUTE WK3 EQUAL
  1710           RT-DISCOUNT-OB-RATE *
  1711           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1712           MOVE WK3 TO CP-PREMIUM-RATE
  1713           COMPUTE WK5 EQUAL WK3 / +1000
  1714           GO TO 1075-BYPASS-REGULAR-RATE.
  1715
  1716     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1717        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1718        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1719        GO TO 1075-BYPASS-REGULAR-RATE.
  1720
  1721     COMPUTE WS-SIN-PREM-RATE =
  1722             (RT-DISCOUNT-OB-RATE / +1000) *
  1723             ((WS-RATE-TERM + +1) / +2).
  1724
  1725     COMPUTE CP-PREMIUM-RATE =
  1726             WS-SIN-PREM-RATE /
  1727             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1728             WS-RATE-TERM) / +24)).
  1729
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  34
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1730     IF CP-PREMIUM-RATE NOT = +0
  1731        MULTIPLY +100 BY CP-PREMIUM-RATE
  1732        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1733        GO TO 1075-BYPASS-REGULAR-RATE.
  1734
  1735 1050-REGULAR-RATES.
  1736
  1737     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1738        COMPUTE WK5 EQUAL
  1739        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1740        (6 * (WS-RATE-TERM + 1))
  1741        MOVE WK5 TO CP-PREMIUM-RATE
  1742        GO TO 1075-BYPASS-REGULAR-RATE.
  1743
  1744     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1745        (CP-CSL-VALID-NP-BENEFIT-CD)
  1746        IF CP-JOINT-INDICATOR EQUAL 'J'
  1747           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1748           GO TO 1075-BYPASS-REGULAR-RATE
  1749        ELSE
  1750           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1751           GO TO 1075-BYPASS-REGULAR-RATE.
  1752
  1753     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1754        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1755        (CP-EARN-AS-NET-PAY )
  1756        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1757        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1758        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1759        MOVE '1'                 TO DC-OPTION-CODE
  1760        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1761        IF DATE-CONVERSION-ERROR
  1762            MOVE '2'                TO CP-RETURN-CODE
  1763            GO TO 9999-CALC-RATE-PREM-X
  1764        ELSE
  1765            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1766                                         DC-ODD-DAYS-OVER
  1767            GO TO 1075-BYPASS-REGULAR-RATE.
  1768
  1769     IF RT-COMPOSITE-RATE NOT NUMERIC
  1770         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1771
  1772*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1773     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1774         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1775                                              WS-PREMIUM-RATE
  1776         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1777     ELSE
  1778         MOVE +0                           TO CP-PREMIUM-RATE
  1779                                              CP-COMPOSITE-RATE
  1780                                              CP-CALC-PREMIUM
  1781         GO TO 9999-CALC-RATE-PREM-X.
  1782
  1783     IF (CP-COMPANY-ID EQUAL 'CID')
  1784        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1785        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1786        AND (CP-EARN-AS-NET-PAY)
  1787        GO TO 1075-BYPASS-REGULAR-RATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  35
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1788     END-IF
  1789
  1790******************************************************
  1791*    IF CP-COMPANY-ID NOT = 'LBL'
  1792     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1793         GO TO 1075-BYPASS-REGULAR-RATE.
  1794
  1795     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1796     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1797     MOVE '1'                    TO DC-OPTION-CODE.
  1798     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1799     IF DATE-CONVERSION-ERROR
  1800         MOVE '2'                TO CP-RETURN-CODE
  1801         GO TO 9999-CALC-RATE-PREM-X
  1802       ELSE
  1803         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1804         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1805
  1806     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1807        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1808        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1809
  1810     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1811        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1812           NEXT SENTENCE
  1813         ELSE
  1814           GO TO 1075-BYPASS-REGULAR-RATE
  1815       ELSE
  1816        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1817           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1818           NEXT SENTENCE
  1819         ELSE
  1820           GO TO 1075-BYPASS-REGULAR-RATE.
  1821
  1822     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1823        COMPUTE CP-PREMIUM-RATE =
  1824        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1825         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1826         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1827
  1828     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1829        COMPUTE CP-PREMIUM-RATE =
  1830        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1831        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1832        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1833        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1834         * (CP-ORIGINAL-TERM - 1)).
  1835******************************************************
  1836
  1837 1075-BYPASS-REGULAR-RATE.
  1838
  1839     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1840
  1841     MOVE +1 TO LINDX.
  1842
  1843     IF CP-COMPANY-ID EQUAL 'CRI'
  1844        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1845           MOVE +5               TO LINDX
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  36
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1846           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1847              MOVE 'F'           TO CP-RETURN-CODE
  1848              GO TO 1200-CALCULATE-PREMIUMS.
  1849
  1850     IF RT-L-EX-AGE (LINDX) = ZERO
  1851          GO TO 1200-CALCULATE-PREMIUMS.
  1852
  1853 1100-SEARCH-LIFE-LIMITS.
  1854
  1855     IF CP-COMPANY-ID EQUAL 'CRI'
  1856        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1857           IF LINDX GREATER THAN +4
  1858              MOVE 'A'           TO CP-RETURN-CODE
  1859              GO TO 1200-CALCULATE-PREMIUMS.
  1860
  1861     IF LINDX GREATER +8
  1862         MOVE 'A'                TO CP-RETURN-CODE
  1863         GO TO 1200-CALCULATE-PREMIUMS.
  1864
  1865     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1866         IF RT-L-EX-AGE (LINDX) = ZEROS
  1867             ADD +1              TO LINDX
  1868             GO TO 1100-SEARCH-LIFE-LIMITS
  1869         ELSE
  1870             MOVE RT-L-EX-AGE (LINDX)
  1871                                 TO CP-R-MAX-AGE
  1872             MOVE RT-L-EX-TERM (LINDX)
  1873                                 TO CP-R-MAX-TERM
  1874             MOVE RT-L-EX-FACE (LINDX)
  1875                                 TO CP-R-MAX-TOT-BEN
  1876             ADD +1              TO LINDX
  1877             GO TO 1100-SEARCH-LIFE-LIMITS
  1878     ELSE
  1879         MOVE RT-L-EX-AGE (LINDX)
  1880                                 TO CP-R-MAX-AGE
  1881         MOVE RT-L-EX-TERM (LINDX)
  1882                                 TO CP-R-MAX-TERM
  1883         MOVE RT-L-EX-FACE (LINDX)
  1884                                 TO CP-R-MAX-TOT-BEN.
  1885
  1886     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1887         MOVE '9'                TO CP-RETURN-CODE.
  1888
  1889     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1890         MOVE '8'                TO CP-RETURN-CODE.
  1891
  1892 1200-CALCULATE-PREMIUMS.
  1893
  1894     IF CP-COMPANY-ID = 'CSL'
  1895        IF CP-CSL-VALID-NP-BENEFIT-CD
  1896           GO TO 1240-NET-PAY-CONT
  1897        ELSE
  1898           GO TO 1250-CSL-CALC.
  1899
  1900     IF CP-COMPANY-ID = 'WDS'
  1901        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  1902           IF CP-EARN-AS-REG-BALLOON
  1903              GO TO 1240-NET-PAY-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  37
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1904
  1905     IF (CP-COMPANY-ID = 'CID')
  1906        AND (CP-STATE-STD-ABBRV = 'MN')
  1907        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  1908        AND (CP-CERT-EFF-DT > X'A4FF')
  1909        GO TO 1240-NET-PAY-CONT
  1910     END-IF
  1911
  1912     IF (CP-COMPANY-ID = 'CID')
  1913        AND (CP-STATE-STD-ABBRV = 'WA')
  1914        AND (CP-FARM-PLAN)
  1915        GO TO 1240-NET-PAY-CONT
  1916     END-IF
  1917
  1918     IF (CP-COMPANY-ID = 'CID')
  1919        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1920           OR 'IN' OR 'AZ')
  1921        AND (CP-FARM-PLAN)
  1922***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  1923***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  1924        MOVE +1.0                TO CP-LOAN-APR
  1925        GO TO 1240-NET-PAY-CONT
  1926     END-IF
  1927
  1928     IF CP-RATE-AS-STANDARD
  1929         GO TO 1210-REGULAR-RATE.
  1930
  1931     IF CP-CRITICAL-PERIOD
  1932         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  1933
  1934     IF CP-EARN-AS-TEXAS
  1935         GO TO 1230-TEXAS-CONT.
  1936
  1937     IF CP-EARN-AS-NET-PAY
  1938        IF CP-STATE-STD-ABBRV = 'MD'
  1939          IF CP-COMPANY-ID = 'MON'
  1940            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  1941                               '14' OR '26' OR '47'
  1942              GO TO 1210-REGULAR-RATE.
  1943
  1944     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1945        IF CP-MONTHLY-PAYMENT EQUAL +0
  1946           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1947                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1948
  1949     IF CP-COMPANY-ID EQUAL 'GTL'
  1950        NEXT SENTENCE
  1951     ELSE
  1952     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1953        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  1954           COMPUTE WK3 ROUNDED EQUAL
  1955           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  1956           CP-MONTHLY-PAYMENT
  1957           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  1958           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  1959           CP-ALTERNATE-BENEFIT)
  1960           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  1961           WK3 * WK5
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  38
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1962           GO TO 9999-CALC-RATE-PREM-X
  1963        ELSE
  1964           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  1965           (CP-ORIGINAL-TERM - 1 - WK1)) /
  1966           (WS-WORK-DIS-RATE / +12)
  1967           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  1968           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  1969                               WK5
  1970           GO TO 9999-CALC-RATE-PREM-X.
  1971
  1972     IF CP-COMPANY-ID EQUAL 'GTL' AND
  1973        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  1974        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  1975        CP-ORIGINAL-TERM LESS THAN +61
  1976        COMPUTE CP-CALC-PREMIUM EQUAL
  1977                        (CP-ORIGINAL-BENEFIT *
  1978           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  1979           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  1980        COMPUTE CP-CALC-PREMIUM EQUAL
  1981                CP-CALC-PREMIUM +
  1982              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  1983        (CP-ORIGINAL-TERM + 1)) /
  1984        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  1985        GO TO 9999-CALC-RATE-PREM-X.
  1986
  1987     IF CP-COMPANY-ID = 'GTL'     AND
  1988        CP-STATE-STD-ABBRV = 'PA' AND
  1989        CP-SPECIAL-CALC-CD = 'H'
  1990         GO TO 1260-GTL-PA-LEASE.
  1991
  1992     IF (CP-EARN-AS-NET-PAY)
  1993*       AND (CP-LOAN-APR > ZEROS)
  1994        GO TO 1240-NET-PAY-CONT
  1995     END-IF
  1996
  1997     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1998         GO TO 1210-REGULAR-RATE.
  1999
  2000**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2001**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2002****
  2003     IF CP-DEVIATION-CODE = 'LEV' AND
  2004        CP-LOAN-APR = ZEROS
  2005         GO TO 1210-REGULAR-RATE.
  2006
  2007     IF (CP-STATE-STD-ABBRV = 'OH')
  2008        AND (CP-CLASS-CODE NOT = 'L ')
  2009        AND (CP-ORIGINAL-TERM > 60)
  2010        AND (DC-GREG-DATE-CYMD > 19831031)
  2011        AND (CP-LOAN-APR > ZEROS)
  2012        GO TO 1240-NET-PAY-CONT
  2013     END-IF
  2014
  2015     IF (CP-STATE-STD-ABBRV = 'UT')
  2016        AND (CP-ORIGINAL-TERM > 62)
  2017        AND (DC-GREG-DATE-CYMD > 19810831)
  2018        AND (DC-GREG-DATE-CYMD < 19830901)
  2019        AND (CP-LOAN-APR > ZEROS)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  39
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2020        GO TO 1240-NET-PAY-CONT
  2021     END-IF
  2022
  2023     IF (CP-STATE-STD-ABBRV = 'RI')
  2024        AND (CP-ORIGINAL-TERM > 60)
  2025        AND (DC-GREG-DATE-CYMD > 19831231)
  2026        AND (CP-LOAN-APR > ZEROS)
  2027        GO TO 1240-NET-PAY-CONT
  2028     END-IF
  2029
  2030     .
  2031 1210-REGULAR-RATE.
  2032
  2033     IF (CP-COMPANY-ID = 'CID')
  2034        AND (CP-EARN-AS-NET-PAY)
  2035        AND (CP-LOAN-APR = 0)
  2036        IF RT-L-RATE (WS-RATE-TERM) = 0
  2037           COMPUTE WS-SIN-PREM-RATE =
  2038              (RT-DISCOUNT-OB-RATE / +1000) *
  2039              ((WS-RATE-TERM + +1) / +2)
  2040           COMPUTE CP-PREMIUM-RATE =
  2041              WS-SIN-PREM-RATE /
  2042              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2043              WS-RATE-TERM) / +24))
  2044        ELSE
  2045           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2046        END-IF
  2047     END-IF
  2048
  2049*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2050*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2051*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2052*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2053*
  2054*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2055*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2056*          COMPUTE WK3 ROUNDED EQUAL
  2057*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2058*          CP-MONTHLY-PAYMENT
  2059*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2060*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2061*          CP-ALTERNATE-BENEFIT)
  2062*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2063*          WK3 * WK5
  2064*          GO TO 9999-CALC-RATE-PREM-X
  2065*       ELSE
  2066*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2067*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2068*          (WS-WORK-DIS-RATE / +12)
  2069*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2070*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2071*                              WK5
  2072*          GO TO 9999-CALC-RATE-PREM-X.
  2073
  2074     IF CP-TERM-IS-DAYS
  2075         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2076             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2077         COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  40
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2078             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2079                          * CP-TERM-OR-EXT-DAYS
  2080           GO TO 9999-CALC-RATE-PREM-X.
  2081
  2082     if (cp-company-id = 'AHL')
  2083        and (cp-loan-term > cp-original-term)
  2084        continue
  2085     else
  2086        IF NOT CP-TRUNCATED-LIFE
  2087           GO TO 1212-GROSS-NOT-TRUNCATED
  2088        end-if
  2089     end-if
  2090
  2091****  GROSS TRUNCATED CALCULATION
  2092
  2093     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2094         MOVE 'H'                TO  CP-RETURN-CODE
  2095         GO TO 9999-CALC-RATE-PREM-X.
  2096
  2097     if cp-company-id = 'AHL'
  2098        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2099           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2100           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2101           cp-original-term) * (cp-loan-term - cp-original-term
  2102            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2103            cp-premium-rate / 100 * cp-original-term /
  2104            cp-loan-term * cp-original-benefit
  2105        else
  2106           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2107           cp-original-term) * (cp-loan-term - cp-original-term
  2108            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2109            cp-premium-rate * cp-original-benefit / 100
  2110        end-if
  2111        go to 9999-calc-rate-prem-x
  2112     end-if
  2113
  2114
  2115     IF CP-COMPANY-ID = 'NCL'
  2116         COMPUTE WK-MONTHLY-RATE =
  2117               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2118                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2119                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2120                                 /
  2121                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2122                                 *
  2123                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2124         COMPUTE CP-CALC-PREMIUM =
  2125                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2126     ELSE
  2127         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2128                                 CP-ORIGINAL-TERM
  2129         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2130                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2131                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2132                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2133     END-IF
  2134
  2135     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  41
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2136        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2137           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2138           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2139     END-IF
  2140
  2141     GO TO 9999-CALC-RATE-PREM-X
  2142
  2143     .
  2144 1212-GROSS-NOT-TRUNCATED.
  2145*    DISPLAY ' ELCRATPD '
  2146*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2147*    display ' premium rate ' cp-premium-rate
  2148
  2149     IF (CP-COMPANY-ID = 'CID')
  2150        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2151           OR 'IN')
  2152        AND (CP-BENEFIT-CD = '55' OR '56')
  2153        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2154          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2155          (CP-ORIGINAL-TERM) *
  2156          ((CP-ORIGINAL-TERM) / 12) *
  2157          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2158          GO TO 9999-CALC-RATE-PREM-X
  2159     END-IF
  2160
  2161     IF (CP-COMPANY-ID = 'CID')
  2162        AND (CP-STATE-STD-ABBRV = 'GA')
  2163        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2164        COMPUTE WK3 ROUNDED =
  2165          CP-ORIGINAL-BENEFIT *
  2166          ((CP-ORIGINAL-TERM + 1) / 2) *
  2167          (RT-DISCOUNT-OB-RATE / 1000)
  2168          MOVE WK3 TO CP-CALC-PREMIUM
  2169          GO TO 9999-CALC-RATE-PREM-X
  2170     END-IF
  2171
  2172     IF (CP-COMPANY-ID EQUAL 'CID')
  2173        AND (CP-STATE-STD-ABBRV = 'MN')
  2174        AND (CP-LEVEL-LIFE)
  2175        AND (CP-CERT-EFF-DT > X'A4FF')
  2176        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2177        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2178        MOVE '1'                 TO DC-OPTION-CODE
  2179        PERFORM 9100-CONVERT-DATE
  2180                                 THRU 9100-EXIT
  2181        IF DATE-CONVERSION-ERROR
  2182           MOVE '2'              TO CP-RETURN-CODE
  2183           MOVE ZEROS            TO FACTOR
  2184                                 CP-CALC-PREMIUM
  2185           GO TO 9999-CALC-RATE-PREM-X
  2186        END-IF
  2187        MOVE DC-ELAPSED-DAYS     TO D
  2188        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2189           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2190           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2191        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2192           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2193        GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  42
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2194     END-IF
  2195
  2196     IF (CP-COMPANY-ID = 'CID')
  2197        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2198        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2199           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2200     ELSE
  2201        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2202                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2203     END-IF
  2204*    display ' calc premium ' cp-calc-premium
  2205
  2206*    IF CP-COMPANY-ID = 'LBL'
  2207     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2208        AND (NOT CP-EARN-AS-NET-PAY)
  2209        GO TO 9999-CALC-RATE-PREM-X
  2210     END-IF
  2211
  2212*    display ' fell through to ext days '
  2213     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2214         GO TO 9999-CALC-RATE-PREM-X.
  2215
  2216     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2217         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2218            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2219               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2220
  2221     GO TO 9999-CALC-RATE-PREM-X.
  2222
  2223 1220-CRITICAL-PERIOD-LF-CONT.
  2224     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2225               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2226
  2227     GO TO 9999-CALC-RATE-PREM-X.
  2228
  2229 1230-TEXAS-CONT.
  2230     IF CP-FARM-PLAN
  2231         GO TO 1235-TEXAS-FARM-CONT.
  2232
  2233     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2234               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2235
  2236     COMPUTE TEX-FACT-9 =
  2237                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2238                 (CP-ORIGINAL-TERM + 1).
  2239
  2240     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2241                 CP-CALC-PREMIUM * TEX-FACT-9.
  2242
  2243     GO TO 9999-CALC-RATE-PREM-X.
  2244
  2245 1235-TEXAS-FARM-CONT.
  2246     COMPUTE WS-FARM-TERM =
  2247               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2248
  2249     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2250     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2251
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  43
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2252
  2253     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2254              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2255
  2256     GO TO 9999-CALC-RATE-PREM-X.
  2257
  2258 1240-NET-PAY-CONT.
  2259
  2260     MOVE CP-LOAN-APR             TO N-P-APR.
  2261     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2262                                     N-P-REM
  2263                                     N-P-LOAN.
  2264
  2265     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2266
  2267     IF CP-TRUNCATED-LIFE
  2268         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2269
  2270     IF CP-COMPANY-ID EQUAL 'NCL'
  2271        NEXT SENTENCE
  2272     ELSE
  2273        GO TO 1241-NET-PAY-CONT.
  2274
  2275     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2276     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2277     MOVE '1'                    TO DC-OPTION-CODE
  2278     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2279     IF DATE-CONVERSION-ERROR
  2280         MOVE '2'                TO CP-RETURN-CODE
  2281         GO TO 9999-CALC-RATE-PREM-X
  2282     ELSE
  2283        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2284        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2285
  2286     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2287        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2288        NEXT SENTENCE
  2289     ELSE
  2290        MOVE +1                  TO ODF
  2291        GO TO 1241-NET-PAY-CONT.
  2292
  2293     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2294        COMPUTE CP-PREMIUM-RATE EQUAL
  2295        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2296        CP-PREMIUM-RATE) *
  2297        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2298
  2299     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2300        COMPUTE CP-PREMIUM-RATE EQUAL
  2301        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2302        N-P-LOAN * (N-P-LOAN - 1))) *
  2303        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2304        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2305
  2306     COMPUTE ODF EQUAL
  2307     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2308     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2309
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  44
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2310 1241-NET-PAY-CONT.
  2311
  2312     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2313
  2314*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2315     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2316        NEXT SENTENCE
  2317     ELSE
  2318        GO TO 9999-CALC-RATE-PREM-X.
  2319
  2320     IF RT-DISCOUNT-OPTION EQUAL '6'
  2321         GO TO 9999-CALC-RATE-PREM-X.
  2322
  2323     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2324        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2325        GO TO 9999-CALC-RATE-PREM-X.
  2326
  2327     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2328
  2329     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2330        GO TO 9999-CALC-RATE-PREM-X.
  2331
  2332     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2333        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2334        (CP-TRUNCATED-LIFE)
  2335        GO TO 9999-CALC-RATE-PREM-X.
  2336
  2337     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2338        (CP-CSL-VALID-NP-BENEFIT-CD)
  2339        GO TO 9999-CALC-RATE-PREM-X.
  2340
  2341     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2342        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2343        (CP-EARN-AS-NET-PAY)
  2344        GO TO 9999-CALC-RATE-PREM-X.
  2345
  2346*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2347*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2348*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2349*       GO TO 9999-CALC-RATE-PREM-X.
  2350
  2351     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2352        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2353        (CP-EARN-AS-NET-PAY)
  2354        GO TO 9999-CALC-RATE-PREM-X.
  2355
  2356     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2357        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2358        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2359        GO TO 9999-CALC-RATE-PREM-X.
  2360
  2361     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2362        (CP-EARN-AS-NET-PAY)
  2363        GO TO 9999-CALC-RATE-PREM-X.
  2364
  2365     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2366        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2367        (CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  45
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2368        GO TO 9999-CALC-RATE-PREM-X.
  2369
  2370     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2371        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2372        (CP-EARN-AS-NET-PAY)
  2373*       (CP-TRUNCATED-LIFE)
  2374        GO TO 9999-CALC-RATE-PREM-X.
  2375
  2376     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2377        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2378                   AND
  2379        ((CP-EARN-AS-NET-PAY)
  2380               OR
  2381        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2382        GO TO 9999-CALC-RATE-PREM-X.
  2383
  2384     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2385        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2386        (CP-EARN-AS-NET-PAY) AND
  2387        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2388        GO TO 9999-CALC-RATE-PREM-X.
  2389
  2390     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2391        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2392        (CP-EARN-AS-NET-PAY)
  2393        GO TO 9999-CALC-RATE-PREM-X.
  2394
  2395     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2396        CONTINUE
  2397     ELSE
  2398        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2399           (CP-EARN-AS-NET-PAY) AND
  2400           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2401           GO TO 9999-CALC-RATE-PREM-X
  2402        END-IF
  2403     END-IF
  2404
  2405     IF (CP-COMPANY-ID = 'CID')
  2406        AND (CP-EARN-AS-NET-PAY)
  2407        AND (CP-STATE-STD-ABBRV = 'ME')
  2408        GO TO 9999-CALC-RATE-PREM-X
  2409     END-IF
  2410
  2411     IF (CP-COMPANY-ID = 'DCC')
  2412        AND (CP-BEN-CATEGORY = 'D')
  2413        AND (CP-EARN-AS-NET-PAY)
  2414        GO TO 9999-CALC-RATE-PREM-X
  2415     END-IF
  2416
  2417     IF (CP-COMPANY-ID = 'CID')
  2418        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2419           OR 'IN' OR 'AZ' OR 'WA')
  2420        AND (CP-FARM-PLAN)
  2421        GO TO 9999-CALC-RATE-PREM-X
  2422     END-IF
  2423
  2424     IF (CP-COMPANY-ID = 'CID') AND
  2425        (CP-EARN-AS-NET-PAY) AND
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  46
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2426        (CP-LEVEL-LIFE) AND
  2427        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2428        (CP-STATE-STD-ABBRV = CP-STATE)
  2429        GO TO 9999-CALC-RATE-PREM-X
  2430     END-IF
  2431
  2432     IF (CP-COMPANY-ID = 'CID') AND
  2433        (CP-EARN-AS-NET-PAY) AND
  2434        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2435                            OR 'VT')
  2436                   OR
  2437        ((CP-STATE-STD-ABBRV = 'IN') AND
  2438        (CP-CERT-EFF-DT > X'9A7F'))
  2439                   OR
  2440        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2441        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2442        (CP-STATE-STD-ABBRV = CP-STATE)
  2443        GO TO 9999-CALC-RATE-PREM-X
  2444     END-IF
  2445
  2446     IF (CP-COMPANY-ID = 'CID') AND
  2447        (CP-EARN-AS-NET-PAY) AND
  2448        (CP-STATE-STD-ABBRV = 'TX') AND
  2449        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2450        (WS-DISCOUNT-OPTION NOT = ' ')
  2451        GO TO 9999-CALC-RATE-PREM-X
  2452     END-IF
  2453
  2454     IF (CP-COMPANY-ID = 'CID')
  2455        AND (CP-STATE-STD-ABBRV = 'MN')
  2456        AND (RT-DISCOUNT-OPTION = '1')
  2457        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2458           CP-EARN-AS-FARM-PLAN)
  2459        GO TO 9999-CALC-RATE-PREM-X
  2460     END-IF
  2461
  2462     IF (CP-COMPANY-ID = 'CID')
  2463        AND (CP-EARN-AS-NET-PAY)
  2464        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2465                      OR
  2466            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2467        GO TO 9999-CALC-RATE-PREM-X
  2468     END-IF
  2469
  2470     IF (CP-COMPANY-ID = 'CID')
  2471        AND (CP-EARN-AS-NET-PAY)
  2472        AND (CP-STATE-STD-ABBRV = 'SC')
  2473        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2474        GO TO 9999-CALC-RATE-PREM-X
  2475     END-IF
  2476
  2477     IF (CP-COMPANY-ID = 'CID') AND
  2478        (CP-EARN-AS-NET-PAY) AND
  2479        (CP-TRUNCATED-LIFE) AND
  2480        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2481        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2482        (WS-DISCOUNT-OPTION NOT = ' ')
  2483        GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  47
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2484     END-IF
  2485
  2486     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2487        (CP-EARN-AS-NET-PAY)
  2488        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2489        GO TO 9999-CALC-RATE-PREM-X
  2490     END-IF
  2491
  2492     IF (CP-COMPANY-ID EQUAL 'CID')
  2493        AND (CP-EARN-AS-NET-PAY)
  2494        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2495        GO TO 9999-CALC-RATE-PREM-X
  2496     END-IF
  2497
  2498     IF (RT-IS-OB) AND
  2499        (CP-COMPANY-ID NOT EQUAL 'CID')
  2500        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2501               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2502      ELSE
  2503         IF (CP-COMPANY-ID = 'DCC')
  2504            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2505            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2506*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2507             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2508               CP-ORIGINAL-TERM
  2509             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2510             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2511        ELSE
  2512           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2513               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2514        END-IF
  2515     END-IF
  2516
  2517     IF CP-ROA-PREM-AT-REFUND
  2518         COMPUTE NET-BEN ROUNDED =
  2519             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2520     ELSE
  2521         COMPUTE NET-BEN ROUNDED =
  2522              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2523
  2524     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2525        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2526          COMPUTE NET-BEN ROUNDED =
  2527              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2528                         (CP-TERM-OR-EXT-DAYS / 30)).
  2529
  2530     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2531*       OR 'DCC'
  2532*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2533     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2534       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2535       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2536                        * CP-ORIGINAL-TERM / 1200))
  2537     ELSE
  2538     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2539       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2540       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2541
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  48
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2542****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2543****** INTEREST IS CHARGED ON PREMIUM.
  2544
  2545*    IF CP-STATE-STD-ABBRV = 'MI'
  2546*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2547*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2548
  2549     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2550
  2551     GO TO 9999-CALC-RATE-PREM-X.
  2552
  2553******
  2554****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2555******
  2556
  2557 1250-CSL-CALC.
  2558     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2559     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2560     MOVE '1' TO DC-OPTION-CODE.
  2561     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2562
  2563     IF DATE-CONVERSION-ERROR
  2564         MOVE '2' TO CP-RETURN-CODE
  2565         GO TO 9999-CALC-RATE-PREM-X.
  2566
  2567     IF CP-JOINT-INDICATOR = 'J'
  2568         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2569     ELSE
  2570         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2571
  2572     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2573     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2574
  2575     IF CP-PAY-FREQUENCY = 12
  2576         MOVE 01               TO WS-PAY-SCH.
  2577     IF CP-PAY-FREQUENCY = 04
  2578         MOVE 03               TO WS-PAY-SCH.
  2579     IF CP-PAY-FREQUENCY = 02
  2580         MOVE 06               TO WS-PAY-SCH.
  2581     IF CP-PAY-FREQUENCY = 01
  2582         MOVE 12               TO WS-PAY-SCH.
  2583
  2584     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2585     IF CP-PAY-FREQUENCY NOT = 12
  2586         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2587                                WS-NUM-PAYMTS.
  2588
  2589     IF CP-STATE = 'SC'  AND
  2590       (CP-BENEFIT-CD = '07'  OR  '08')
  2591         GO TO 1250-CSL-CALC-LIFE-6.
  2592
  2593     IF CP-CSL-METH-1
  2594         GO TO 1250-CSL-CALC-LIFE-1.
  2595
  2596     IF CP-CSL-METH-2
  2597         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2598                          WS-MAX-TOT-BEN
  2599             GO TO 1250-CSL-CALC-LIFE-2
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  49
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2600         ELSE
  2601             GO TO 1250-CSL-CALC-LIFE-1.
  2602
  2603     IF CP-CSL-METH-3
  2604         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2605             GO TO 1250-CSL-CALC-LIFE-2
  2606         ELSE
  2607             GO TO 1250-CSL-CALC-LIFE-3.
  2608
  2609     IF CP-CSL-METH-4
  2610         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2611                          WS-MAX-TOT-BEN
  2612             GO TO 1250-CSL-CALC-LIFE-5
  2613         ELSE
  2614             GO TO 1250-CSL-CALC-LIFE-4.
  2615
  2616 1250-CSL-CALC-LIFE-1.
  2617     IF CP-JOINT-INDICATOR = 'J'
  2618         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2619     ELSE
  2620         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2621
  2622     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2623                    365) - 1) * 365 / 12.
  2624     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2625                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2626                    4380.
  2627     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2628                    WS-NUM-PAYMTS * WK-S.
  2629
  2630     GO TO 9999-CALC-RATE-PREM-X.
  2631
  2632 1250-CSL-CALC-LIFE-2.
  2633     IF CP-JOINT-INDICATOR = 'J'
  2634         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2635     ELSE
  2636         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2637
  2638     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2639     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2640     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2641                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2642                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2643     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2644                    WK-S) + WK-D.
  2645
  2646     GO TO 9999-CALC-RATE-PREM-X.
  2647
  2648 1250-CSL-CALC-LIFE-3.
  2649     IF CP-JOINT-INDICATOR = 'J'
  2650         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2651     ELSE
  2652         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2653
  2654     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2655     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2656     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2657                    - 1) + WS-NUM-PAYMTS - WK-K) *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  50
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2658                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2659     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2660                    WK-S) + WK-D.
  2661
  2662     GO TO 9999-CALC-RATE-PREM-X.
  2663
  2664 1250-CSL-CALC-LIFE-4.
  2665     IF CP-JOINT-INDICATOR = 'J'
  2666         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2667     ELSE
  2668         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2669
  2670     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2671     COMPUTE WK-S ROUNDED =
  2672                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2673                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2674                    CP-PAY-FREQUENCY.
  2675     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2676                    WS-NUM-PAYMTS * WK-S.
  2677
  2678     GO TO 9999-CALC-RATE-PREM-X.
  2679
  2680 1250-CSL-CALC-LIFE-5.
  2681     IF CP-JOINT-INDICATOR = 'J'
  2682         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2683     ELSE
  2684         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2685
  2686     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2687     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2688                    CP-PAY-FREQUENCY.
  2689     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2690                    - 1) + WS-NUM-PAYMTS) * 12) /
  2691                    CP-PAY-FREQUENCY.
  2692     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2693     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2694                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2695
  2696     GO TO 9999-CALC-RATE-PREM-X.
  2697
  2698 1250-CSL-CALC-LIFE-6.
  2699
  2700     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2701                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2702
  2703     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2704                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2705
  2706     GO TO 9999-CALC-RATE-PREM-X.
  2707
  2708******
  2709****** END OF PREMIUM CALCULATIONS FOR CSL
  2710******
  2711
  2712 1260-GTL-PA-LEASE.
  2713
  2714     IF CP-REDUCING-LIFE
  2715         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  51
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2716                                 TO  CP-PREMIUM-RATE
  2717         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2718                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2719     ELSE
  2720         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2721                                 TO  CP-PREMIUM-RATE
  2722         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2723                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2724                 (+1 + CP-SALES-TAX) / +100.
  2725
  2726     GO TO 9999-CALC-RATE-PREM-X.
  2727
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  52
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2729******************************************************************
  2730 2000-TYPE-IS-AH.
  2731     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2732
  2733     MOVE ZERO                      TO CP-R-MAX-AGE
  2734                                       CP-R-MAX-TERM
  2735                                       CP-R-MAX-MON-BEN
  2736                                       CP-R-MAX-TOT-BEN.
  2737
  2738     IF RT-POLICY-FEE NUMERIC
  2739        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2740
  2741     IF RT-COMPOSITE-RATE NOT NUMERIC
  2742        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2743
  2744
  2745     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2746        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2747                                 TO CP-PREMIUM-RATE
  2748                                    WS-PREMIUM-RATE
  2749        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2750     ELSE
  2751         MOVE +0                 TO CP-PREMIUM-RATE
  2752                                    CP-CALC-PREMIUM
  2753         GO TO 9999-CALC-RATE-PREM-X
  2754     END-IF
  2755
  2756     IF (CP-COMPANY-ID = 'DCC')
  2757        AND (CP-DDF-SPEC-CALC = 'T')
  2758        AND (CP-LOAN-TERM > ZERO AND < 361)
  2759        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2760                                 TO CP-PREMIUM-RATE
  2761                                    WS-PREMIUM-RATE
  2762     END-IF
  2763
  2764*    IF (CP-COMPANY-ID = 'DCC')
  2765*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2766*       OR (CP-DDF-SPEC-CALC = 'T'))
  2767*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2768*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2769*                                TO CP-PREMIUM-RATE
  2770*                                   WS-PREMIUM-RATE
  2771*    END-IF
  2772
  2773     MOVE +1 TO AHNDX.
  2774
  2775     IF CP-COMPANY-ID EQUAL 'CRI'
  2776        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2777           MOVE +5               TO AHNDX
  2778           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2779              MOVE 'F'           TO CP-RETURN-CODE
  2780              GO TO 2200-CALCULATE-PREMIUMS.
  2781
  2782     IF RT-AH-AGE (AHNDX) = ZERO
  2783          GO TO 2200-CALCULATE-PREMIUMS.
  2784
  2785 2100-SEARCH-AH-LIMITS.
  2786
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  53
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2787     IF CP-COMPANY-ID EQUAL 'CRI'
  2788        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2789           IF AHNDX GREATER THAN +4
  2790              MOVE 'A'             TO CP-RETURN-CODE
  2791              GO TO 2200-CALCULATE-PREMIUMS.
  2792
  2793     IF AHNDX GREATER +8
  2794         MOVE 'A'                TO CP-RETURN-CODE
  2795         GO TO 2200-CALCULATE-PREMIUMS.
  2796
  2797     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2798         IF RT-AH-AGE (AHNDX) = ZEROS
  2799             ADD +1               TO AHNDX
  2800             GO TO 2100-SEARCH-AH-LIMITS
  2801         ELSE
  2802             MOVE RT-AH-AGE (AHNDX)
  2803                                 TO CP-R-MAX-AGE
  2804             MOVE RT-AH-TERM (AHNDX)
  2805                                 TO CP-R-MAX-TERM
  2806             MOVE RT-AH-BEN-M (AHNDX)
  2807                                 TO CP-R-MAX-MON-BEN
  2808             ADD +1               TO AHNDX
  2809             GO TO 2100-SEARCH-AH-LIMITS
  2810     ELSE
  2811         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2812         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2813         MOVE RT-AH-BEN-M (AHNDX)
  2814                                 TO CP-R-MAX-MON-BEN.
  2815
  2816     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2817         MOVE '9'                 TO CP-RETURN-CODE.
  2818
  2819     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2820         MOVE '8'                 TO CP-RETURN-CODE.
  2821
  2822     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2823         GIVING WS-AH-FACE-BENEFIT.
  2824
  2825     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2826         MOVE 'C'                 TO CP-RETURN-CODE.
  2827
  2828 2200-CALCULATE-PREMIUMS.
  2829
  2830     IF CP-COMPANY-ID = 'CSL'
  2831         GO TO 2250-CSL-CALC.
  2832
  2833*    IF CP-CRITICAL-PERIOD
  2834*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2835
  2836     IF CP-CRITICAL-PERIOD
  2837        IF (CP-COMPANY-ID = 'DCC')
  2838           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2839               OR 'S' OR 'P')
  2840                          OR
  2841                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2842           CONTINUE
  2843        ELSE
  2844           GO TO 2200-CRITICAL-PERIOD-AH-CONT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  54
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2845        END-IF
  2846     END-IF
  2847
  2848     IF (CP-COMPANY-ID = 'DCC')
  2849        AND (CP-BEN-CATEGORY = 'D')
  2850        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2851           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2852     END-IF
  2853
  2854     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2855        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  2856        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2857                                     CP-PREMIUM-RATE
  2858        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2859        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2860        CP-PREMIUM-RATE) / +100
  2861     ELSE
  2862        IF (CP-COMPANY-ID = 'DCC')
  2863           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2864           MOVE CP-PREMIUM-RATE  TO WK-S
  2865*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2866           IF CP-RATE-DEV-PCT NOT = ZEROS
  2867              COMPUTE WK-S ROUNDED =
  2868                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2869           END-IF
  2870           IF CP-BENEFIT-CD (1:1) = 'M'
  2871              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2872              CP-ORIGINAL-BENEFIT * WK-S / 100
  2873           ELSE
  2874              IF CP-BENEFIT-CD (1:1) = 'H'
  2875                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2876                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2877                    WK-S) / 1000
  2878              ELSE
  2879                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2880                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2881                 ELSE
  2882                    IF CP-BEN-CATEGORY = 'D'
  2883                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2884                        CP-ORIGINAL-BENEFIT *
  2885                        CP-ORIGINAL-TERM * WK-S / 100
  2886                    ELSE
  2887                      IF CP-BENEFIT-CD (1:1) = 'P'
  2888                         GO TO 2300-CALC-DCC-BEN-P-AH
  2889                      ELSE
  2890                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2891                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2892                        WK-S) / 100
  2893                      END-IF
  2894                    END-IF
  2895                 END-IF
  2896              END-IF
  2897           END-IF
  2898           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2899        ELSE
  2900           IF CP-BENEFIT-CD (1:1) = 'M'
  2901              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2902                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  55
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2903           ELSE
  2904              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2905                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2906                    (CP-NET-BENEFIT-AMT *
  2907                    CP-PREMIUM-RATE) / 1000
  2908              ELSE
  2909                 IF CP-AH-BALLOON-SW = 'Y'
  2910                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  2911                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  2912                      CP-PREMIUM-RATE) / 100
  2913                 ELSE
  2914                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  2915                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  2916                    CP-PREMIUM-RATE) / 100
  2917                 END-IF
  2918              END-IF
  2919           END-IF
  2920        END-IF
  2921     END-IF
  2922
  2923     IF (CP-COMPANY-ID = 'DCC')
  2924        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  2925        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  2926     END-IF
  2927
  2928     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2929         GO TO 9999-CALC-RATE-PREM-X.
  2930
  2931     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  2932         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2933             CP-CALC-PREMIUM +
  2934                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  2935                                       * CP-TERM-OR-EXT-DAYS).
  2936
  2937     GO TO 9999-CALC-RATE-PREM-X.
  2938
  2939 2200-CRITICAL-PERIOD-AH-CONT.
  2940
  2941     IF CP-COMPANY-ID = 'WDS'
  2942         IF CP-ORIGINAL-TERM GREATER THAN 60
  2943             MOVE 60              TO CP-LOAN-TERM.
  2944
  2945     IF CP-COMPANY-ID EQUAL 'CVL'
  2946         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2947           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  2948                                       * CP-PREMIUM-RATE
  2949         GO TO 9999-CALC-RATE-PREM-X.
  2950
  2951     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2952           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  2953                                       * CP-PREMIUM-RATE.
  2954
  2955     GO TO 9999-CALC-RATE-PREM-X.
  2956
  2957 2250-CSL-CALC.
  2958
  2959     IF RT-DAILY-RATE NOT NUMERIC OR
  2960        RT-DAILY-RATE = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  56
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2961            MOVE ZEROS TO CP-CALC-PREMIUM
  2962            MOVE '7' TO CP-RETURN-CODE
  2963            GO TO 9999-CALC-RATE-PREM-X.
  2964
  2965     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  2966     COMPUTE WK-MONTHLY-RATE =
  2967          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  2968
  2969     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2970     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2971     MOVE '1' TO DC-OPTION-CODE.
  2972     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2973     IF DATE-CONVERSION-ERROR
  2974         MOVE '2' TO CP-RETURN-CODE
  2975         GO TO 9999-CALC-RATE-PREM-X.
  2976
  2977     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2978     IF CP-CSL-METH-1
  2979         GO TO 2250-CSL-CALC-AH-1.
  2980     IF CP-CSL-METH-2
  2981         GO TO 2250-CSL-CALC-AH-2.
  2982     IF CP-CSL-METH-3
  2983         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2984             GO TO 2250-CSL-CALC-AH-4
  2985         ELSE
  2986             GO TO 2250-CSL-CALC-AH-3.
  2987
  2988 2250-CSL-CALC-AH-1.
  2989
  2990     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  2991     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  2992                    + WK-MONTHLY-RATE.
  2993     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  2994                    CP-ORIGINAL-TERM * WK-D.
  2995
  2996     GO TO 9999-CALC-RATE-PREM-X.
  2997
  2998
  2999 2250-CSL-CALC-AH-2.
  3000     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3001     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3002                    + WK-MONTHLY-RATE.
  3003     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3004                    CP-ORIGINAL-TERM * WK-D.
  3005
  3006     GO TO 9999-CALC-RATE-PREM-X.
  3007
  3008 2250-CSL-CALC-AH-3.
  3009
  3010     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3011     COMPUTE WK-T = WK-K + 1.
  3012     COMPUTE WK-MONTHLY-RATE-T =
  3013          RT-AH-RATE (WK-T) / 100.
  3014     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3015
  3016     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3017     IF WK-T1 EQUAL ZEROS
  3018         MOVE ZEROS TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  57
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3019         MOVE 'G' TO CP-RETURN-CODE
  3020         GO TO 9999-CALC-RATE-PREM-X.
  3021
  3022     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3023                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3024                    - WK-T)).
  3025     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3026     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3027                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3028                       WS-MAX-TOT-BEN).
  3029     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3030                    WK-MONTHLY-RATE-T) + WK-PREM.
  3031
  3032     GO TO 9999-CALC-RATE-PREM-X.
  3033
  3034 2250-CSL-CALC-AH-4.
  3035     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3036     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3037     COMPUTE WK-MONTHLY-RATE-J =
  3038          RT-AH-RATE (WK-J) / 100.
  3039     COMPUTE WK-T = WK-J + 1.
  3040     COMPUTE WK-MONTHLY-RATE-T =
  3041          RT-AH-RATE (WK-T) / 100.
  3042     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3043     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3044                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3045                    (CP-ORIGINAL-TERM - WK-T)).
  3046     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3047     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3048                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3049                       WS-MAX-TOT-BEN).
  3050     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3051                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3052
  3053     GO TO 9999-CALC-RATE-PREM-X.
  3054
  3055
  3056 2300-CALC-DCC-BEN-P-AH.
  3057
  3058     IF CP-NO-OF-PMTS NOT NUMERIC
  3059        MOVE +0                  TO CP-NO-OF-PMTS
  3060     END-IF
  3061     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3062        AND ' ' AND 'M'
  3063        MOVE ' '                 TO CP-PMT-MODE
  3064     END-IF
  3065
  3066******************************************************************
  3067***   Default is monthly, use loan term for rate and amort     ***
  3068******************************************************************
  3069     move cp-loan-term         to c-tot-pmts
  3070     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3071     MOVE +12                  TO C-PMTS-PER-YEAR
  3072******************************************************************
  3073
  3074     evaluate true
  3075        when cp-pmt-mode = 'W'
  3076           MOVE +52              TO C-PMTS-PER-YEAR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  58
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3077           compute c-tot-pmts = cp-loan-term /
  3078              12 * c-pmts-per-year
  3079           MOVE +7               TO C-DAYS-IN-PMT-PER
  3080        when cp-pmt-mode = 'B'
  3081           MOVE +26              TO C-PMTS-PER-YEAR
  3082           compute c-tot-pmts = cp-loan-term /
  3083              12 * c-pmts-per-year
  3084           MOVE +14              TO C-DAYS-IN-PMT-PER
  3085     end-evaluate
  3086
  3087     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3088
  3089     if i = zeros
  3090        move .0000000001         to i
  3091     end-if
  3092
  3093     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3094        C-DAYS-IN-PMT-PER)) / (1 + I)
  3095
  3096     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3097     COMPUTE ANGLEN-1 = ANGLEN / Y
  3098     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3099        / ANGLEN-1
  3100
  3101     if cp-net-benefit-amt = zeros
  3102        compute wk3 = cp-original-benefit - cp-original-premium
  3103     end-if
  3104     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3105
  3106     GO TO 9999-CALC-RATE-PREM-X
  3107
  3108     .
  3109 2300-CALC-DCC-MOB-NET-AH.
  3110
  3111     IF CP-ALTERNATE-BENEFIT = ZEROS
  3112        CONTINUE
  3113     ELSE
  3114        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3115     END-IF
  3116
  3117     MOVE CP-ORIGINAL-TERM       TO M
  3118     MOVE CP-LOAN-TERM           TO N
  3119     IF N = ZEROS
  3120        MOVE M                   TO N
  3121     END-IF
  3122     COMPUTE I = CP-LOAN-APR / +1200
  3123
  3124     if i = zeros
  3125        move .0000000001         to i
  3126     end-if
  3127     IF CP-BENEFIT-CD (1:1) = 'S'
  3128        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3129        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3130        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3131          (WK-S / 1000)
  3132          * 1
  3133        MOVE WK3                 TO CP-CALC-PREMIUM
  3134        GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  59
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3135     END-IF
  3136
  3137     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3138        / (1 + I)
  3139     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3140          ** ((N - M) * -1))) / I)
  3141     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3142     COMPUTE J = I + (WK-S / +1000)
  3143     COMPUTE WK2 = (1 + J) ** (M * -1)
  3144     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3145
  3146
  3147     COMPUTE ANGLEM = ((1 - ((1 + J)
  3148          ** (M * -1))) / J) / OD
  3149     IF CP-NET-BENEFIT-AMT = ZEROS
  3150        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3151           * ANGLEM
  3152     END-IF
  3153     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3154
  3155     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3156          ** ((N - M) * -1))) / I)
  3157
  3158     MOVE +0                     TO WK3
  3159     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3160        (WS-COUNTER > M)
  3161        COMPUTE ANGLEM = (1 - ((1 + J)
  3162          ** ((M - WS-COUNTER + 1) * -1))) / J
  3163        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3164        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3165        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3166     END-PERFORM
  3167
  3168     MOVE WK3                    TO CP-CALC-PREMIUM
  3169
  3170     GO TO 9999-CALC-RATE-PREM-X
  3171     .
  3172
  3173 2300-CALC-DCC-MOB-BAL-AH.
  3174
  3175     IF CP-BENEFIT-CD (1:1) = 'S'
  3176        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3177     END-IF
  3178     MOVE CP-ORIGINAL-TERM       TO M
  3179     MOVE CP-LOAN-TERM           TO N
  3180     IF N = ZEROS
  3181        MOVE M                   TO N
  3182     END-IF
  3183     COMPUTE I = CP-LOAN-APR / +1200
  3184     if i = zeros
  3185        move .0000000001         to i
  3186     end-if
  3187     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3188        / (1 + I)
  3189     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3190     COMPUTE J = I + (WK-S / +1000)
  3191     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3192     MOVE I TO K
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  60
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3193     COMPUTE WK2 = (1 + J) ** (M * -1)
  3194     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3195
  3196     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3197          ** ((M - 1) * -1))) / J)
  3198
  3199     COMPUTE ANGLEM = ((1 - ((1 + J)
  3200          ** (M * -1))) / J) / OD
  3201
  3202     IF CP-NET-BENEFIT-AMT = ZEROS
  3203        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3204           * ANGLEM
  3205     END-IF
  3206     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3207        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3208        / ANGLEM-1
  3209
  3210     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3211          ** ((N - M) * -1))) / I)
  3212
  3213     MOVE +0                     TO WK3
  3214     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3215        (WS-COUNTER > M)
  3216        COMPUTE ANGLEM = (1 - ((1 + J)
  3217          ** ((M - WS-COUNTER) * -1))) / J
  3218        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3219        COMPUTE WK5-CSL = (RA * ANGLEM)
  3220        + (CP-ALTERNATE-BENEFIT * WK2)
  3221        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3222          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3223          (WK-S / 1000)
  3224     END-PERFORM
  3225
  3226     MOVE WK3                    TO CP-CALC-PREMIUM
  3227     GO TO 9999-CALC-RATE-PREM-X
  3228     .
  3229 2300-CALC-DCC-MOB-BAL-AHSUM.
  3230
  3231     MOVE CP-ORIGINAL-TERM       TO M
  3232
  3233     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3234        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3235        * WK-S / 1000
  3236
  3237*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3238*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3239*       * WK-S / 1000
  3240
  3241
  3242
  3243     MOVE WK3                    TO CP-CALC-PREMIUM
  3244
  3245
  3246     GO TO 9999-CALC-RATE-PREM-X
  3247     .
  3248 9999-RATE-NOTFND.
  3249     MOVE '6'                    TO CP-RETURN-CODE.
  3250     GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  61
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3251
  3252 9999-RATE-NOTOPEN.
  3253     MOVE 'D'                    TO CP-RETURN-CODE.
  3254     GO TO 9999-CALC-RATE-PREM-X.
  3255
  3256 9999-CALC-RATE-PREM-X.
  3257     IF (CP-COMPANY-ID = 'DCC')
  3258        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3259        CONTINUE
  3260     ELSE
  3261        IF CP-RATE-DEV-PCT NOT = ZERO
  3262           COMPUTE CP-CALC-PREMIUM =
  3263              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3264
  3265
  3266     GOBACK.
  3267
  3268 9100-CONVERT-DATE.
  3269     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  3270
  3271 9100-EXIT.
  3272     EXIT.
  3273
  3274 9999-OPEN-RATE-FILE.
  3275     MOVE SPACE TO CP-RETURN-CODE
  3276                   CP-IO-FUNCTION.
  3277
  3278     IF  ERRATE-FILE-ID = OERATE-FILE-ID
  3279         OPEN INPUT OERATEF
  3280        ELSE
  3281         OPEN INPUT ERRATEF.
  3282
  3283     IF  ER-STATUS NOT = '00' AND '97'
  3284         MOVE 'E'                 TO CP-IO-FUNCTION.
  3285
  3286     GOBACK.
  3287
  3288 9999-CLOSE-RATE-FILE.
  3289     MOVE SPACE TO CP-RETURN-CODE
  3290                   CP-IO-FUNCTION.
  3291
  3292     IF  ERRATE-FILE-ID = OERATE-FILE-ID
  3293         CLOSE OERATEF
  3294        ELSE
  3295         CLOSE ERRATEF.
  3296
  3297     IF  ER-STATUS NOT = '00'
  3298         MOVE 'E'                 TO CP-IO-FUNCTION.
  3299
  3300     GOBACK.
  3301
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  62
* ELRATEX.cbl
  3303 10000-NET-TERM SECTION.
* 3304                          COPY ERCNETP.
  3305***************************************************************** 04/29/98
  3306*                                                               * ERCNETP
  3307*                            ERCNETP                            *    LV006
  3308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  3309*                            VMOD=2.029                         *    CL**3
  3310*                                                               * ERCNETP
  3311*****************************************************************.ERCNETP
  3312*                                                                 ERCNETP
  3313*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  3314*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  3315*                                   ORIGINAL TERM (S999)          ERCNETP
  3316*                                   REMAINING TERM (S999)         ERCNETP
  3317*                                   NET PAY OPTION (X)            ERCNETP
  3318*                                   LOAN TERM (S999)              ERCNETP
  3319*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  3320*                                                                 ERCNETP
  3321*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  3322*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  3323*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  3324*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  3325*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  3326*    CHARGED.                                                     ERCNETP
  3327*                                                                 ERCNETP
  3328*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  3329*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  3330*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  3331*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  3332*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  3333*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  3334*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  3335*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  3336*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  3337*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  3338*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  3339*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  3340******************************************************************
  3341*                   C H A N G E   L O G
  3342*
  3343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3344*-----------------------------------------------------------------
  3345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3346* EFFECTIVE    NUMBER
  3347*-----------------------------------------------------------------
  3348* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3349* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3350* 120403                   PEMA  ADD SPECIAL TX CALC
  3351* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3352* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3353* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3354* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3355* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3356* 021207                   PEMA  ADD PA NP
  3357* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3358* 032807                   PEMA  ADD VT NP PLUS 2
  3359* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3360* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  63
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3361* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3362* 110207      TO 'AL' NET PAY CALC
  3363* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3364* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3365* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3366* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3367* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3368* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3369* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3370* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3371* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3372* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3373* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3374* 032612  CR2011110200001  PEMA  AHL CHANGES
  3375* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3376* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3377* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3378* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3379******************************************************************
  3380                                                                  ERCNETP
  3381     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  3382     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  3383     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  3384     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  3385     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  3386                                                                  ERCNETP
  3387     MOVE +0 TO FACTOR.                                           ERCNETP
  3388
  3389     if cp-company-id = 'CID'
  3390        if annual-int-rate = +99.9999
  3391           go to 99000-error
  3392        end-if
  3393     else
  3394        if annual-int-rate = zero
  3395           go to 99000-error
  3396        end-if
  3397     end-if
  3398
  3399     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  3400         GO TO 99999-RETURN.                                      ERCNETP
  3401     IF REMAINING-TERM = ZERO                                     ERCNETP
  3402         GO TO 99999-RETURN.                                      ERCNETP
  3403     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  3404         GO TO 99000-ERROR.                                       ERCNETP
  3405     IF LOAN-TERM = ZERO                                          ERCNETP
  3406         GO TO 99999-RETURN.                                      ERCNETP
  3407     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  3408         GO TO 99000-ERROR.                                       ERCNETP
  3409                                                                  ERCNETP
  3410*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3411*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3412*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3413*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3414*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3415*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3416                                                                  ERCNETP
  3417     IF NPO-REFUND                                                ERCNETP
  3418         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  64
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3419       ELSE                                                       ERCNETP
  3420         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  3421            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  3422           ELSE                                                   ERCNETP
  3423            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  3424                                                                  ERCNETP
  3425     IF NPO-SIMPLE                                                ERCNETP
  3426         MOVE 'S' TO TYPE-SW                                      ERCNETP
  3427     ELSE                                                         ERCNETP
  3428         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  3429                                                                  ERCNETP
  3430     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
  3431     if i = zeros
  3432        move .0000000001         to i
  3433     end-if
  3434                                                                  ERCNETP
  3435     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  3436                                                                  ERCNETP
  3437     MOVE V     TO VX                                             ERCNETP
  3438                   SV.                                            ERCNETP
  3439                                                                  ERCNETP
  3440     MOVE +1    TO X1                                             ERCNETP
  3441                   SX.                                            ERCNETP
  3442                                                                  ERCNETP
  3443     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  3444                                                                  ERCNETP
  3445     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  3446                                                                  ERCNETP
  3447     IF MAX-X = +1                                                ERCNETP
  3448        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  3449                                                                  ERCNETP
  3450     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  3451                                                                  ERCNETP
  3452     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  3453         OR 'DCC'        OR 'NCL') AND                            ERCNETP
  3454        (NOT NP-REFUND)                                           ERCNETP
  3455        NEXT SENTENCE                                             ERCNETP
  3456     ELSE                                                         ERCNETP
  3457     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  3458        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  3459                                                                  ERCNETP
  3460     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  3461                                                                  ERCNETP
  3462 10500-VX-LOOP.                                                   ERCNETP
  3463                                                                  ERCNETP
  3464***  VX = AMORT. LOAN TERM.                                       ERCNETP
  3465***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  3466***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  3467***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  3468***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  3469                                                                  ERCNETP
  3470     IF X2 = 1
  3471        MOVE V         TO SX
  3472     END-IF
  3473     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  3474                                                                  ERCNETP
  3475     ADD B1 TO X1.                                                ERCNETP
  3476                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  65
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3477     IF X1 = REMAINING-TERM                                       ERCNETP
  3478          MOVE VX    TO SV.                                       ERCNETP
  3479                                                                  ERCNETP
  3480     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  3481        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  3482                                                                  ERCNETP
  3483     IF X1 = X2                                                   ERCNETP
  3484          MOVE VX    TO SX.                                       ERCNETP
  3485                                                                  ERCNETP
  3486     IF X1 NOT = MAX-X                                            ERCNETP
  3487          GO TO 10500-VX-LOOP.                                    ERCNETP
  3488                                                                  ERCNETP
  3489 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  3490*****  WK1 = LOAN TERM AMORT
  3491     COMPUTE WK1 = K1 - VX.                                       ERCNETP
  3492*****  WK2 = INS TERM AMORT
  3493     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  3494*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3495     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  3496*****  WK6 = INS TERM - 1
  3497     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  3498                                                                  ERCNETP
  3499     IF NP-RATING                                                 ERCNETP
  3500         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  3501                                                                  ERCNETP
  3502     IF NP-REFUND                                                 ERCNETP
  3503         GO TO 11000-REFUND-CALC.                                 ERCNETP
  3504                                                                  ERCNETP
  3505     IF NET-STD                                                   ERCNETP
  3506         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  3507                                                                  ERCNETP
  3508     IF NET-SMP                                                   ERCNETP
  3509         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  3510         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  3511         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  3512         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  3513                                                                  ERCNETP
  3514     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  3515         MOVE +0 TO WK3.                                          ERCNETP
  3516                                                                  ERCNETP
  3517     MOVE WK3 TO FACTOR.                                          ERCNETP
  3518                                                                  ERCNETP
  3519     GO TO 99999-RETURN.                                          ERCNETP
  3520                                                                  ERCNETP
  3521 11000-REFUND-CALC.                                               ERCNETP
  3522     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  3523        MOVE +1 TO FACTOR                                         ERCNETP
  3524        GO TO 99999-RETURN.                                       ERCNETP
  3525                                                                  ERCNETP
  3526     IF REMAINING-TERM LESS +1                                    ERCNETP
  3527        MOVE 0 TO FACTOR                                          ERCNETP
  3528        GO TO 99999-RETURN.                                       ERCNETP
  3529                                                                  ERCNETP
  3530     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  3531     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  3532     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  3533                                                                  ERCNETP
  3534     IF (CP-COMPANY-ID EQUAL 'CID')
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  66
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3535        AND (CP-STATE-STD-ABBRV = 'MN')
  3536        AND (CP-CERT-EFF-DT > X'A4FF')
  3537        AND (CP-RATE-AS-REG-BALLOON)
  3538        AND (CP-EARN-AS-NET-PAY)
  3539        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3540        CONTINUE
  3541     ELSE
  3542        GO TO 11000-CHECK-MN-LEV-BALLOON
  3543     END-IF
  3544
  3545     COMPUTE R = M - E
  3546     COMPUTE FACTOR = (R - WK2 + WK5) /
  3547        (M - WK1 + WK5)
  3548
  3549     GO TO 99999-RETURN
  3550
  3551      .
  3552 11000-CHECK-MN-LEV-BALLOON.
  3553
  3554     IF (CP-COMPANY-ID EQUAL 'CID')
  3555        AND (CP-STATE-STD-ABBRV = 'MN')
  3556        AND (CP-CERT-EFF-DT > X'A4FF')
  3557        AND (CP-RATE-AS-REG-BALLOON)
  3558        AND (CP-EARN-AS-NET-PAY)
  3559        AND (CP-DEVIATION-CODE = 'LEV')
  3560        CONTINUE
  3561     ELSE
  3562        GO TO 11000-CONTINUE-REFUND
  3563     END-IF
  3564
  3565     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3566     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3567        ** (M - E)) / I
  3568
  3569     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3570
  3571     GO TO 99999-RETURN
  3572
  3573     .
  3574 11000-CONTINUE-REFUND.
  3575
  3576*    IF CP-GAP-ACTUARIAL
  3577*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3578*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3579*       COMPUTE WK3 = WK2 / ANGLEN
  3580*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3581
  3582     IF CP-GAP-ACTUARIAL
  3583        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3584           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3585        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3586     ELSE
  3587        COMPUTE WK3 ROUNDED =
  3588          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3589     END-IF
  3590                                                                  ERCNETP
  3591     MOVE WK3  TO FACTOR.                                         ERCNETP
  3592                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  67
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3593     GO TO 99999-RETURN.                                          ERCNETP
  3594                                                                  ERCNETP
  3595 12000-PREMIUM-RATE.                                              ERCNETP
  3596*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  3597*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  3598*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  3599*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  3600*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  3601*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  3602                                                                  ERCNETP
  3603     COMPUTE K-I = K1 + I.                                        ERCNETP
  3604     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  3605                                                                  ERCNETP
  3606     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  3607         MOVE K1 TO K-I.                                          ERCNETP
  3608                                                                  ERCNETP
  3609     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  3610         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  3611                                                                  ERCNETP
  3612     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  3613         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  3614                                                                  ERCNETP
  3615     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  3616         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  3617                                                                  ERCNETP
  3618     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  3619             ((X2 * (X2 + 1)) /                                   ERCNETP
  3620              (N *  (N  + 1))).                                   ERCNETP
  3621                                                                  ERCNETP
  3622     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  3623        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  3624        NEXT SENTENCE                                             ERCNETP
  3625     ELSE                                                         ERCNETP
  3626        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  3627                                                                  ERCNETP
  3628     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  3629     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  3630     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3631                                                                  ERCNETP
  3632     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3633        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3634        MOVE ZEROS               TO FACTOR                        ERCNETP
  3635                                    CP-CALC-PREMIUM               ERCNETP
  3636         GO TO 99999-RETURN.                                      ERCNETP
  3637                                                                  ERCNETP
  3638     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  3639     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  3640     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  3641     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3642                                                                  ERCNETP
  3643     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3644        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3645        MOVE ZEROS               TO FACTOR                        ERCNETP
  3646                                    CP-CALC-PREMIUM               ERCNETP
  3647         GO TO 99999-RETURN.                                      ERCNETP
  3648                                                                  ERCNETP
  3649     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
  3650                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  68
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3651     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
  3652                                                                  ERCNETP
  3653     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  3654        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  3655        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  3656     ELSE                                                         ERCNETP
  3657        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  3658        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  3659                                                                  ERCNETP
  3660     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  3661     13).                                                         ERCNETP
  3662                                                                  ERCNETP
  3663     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  3664     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  3665                                                                  ERCNETP
  3666     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  3667                                                                  ERCNETP
  3668     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  3669       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  3670                                                                  ERCNETP
  3671     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  3672       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  3673       WS-CALC-FREQ-RATE).                                        ERCNETP
  3674                                                                  ERCNETP
  3675     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  3676       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  3677                                                                  ERCNETP
  3678     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  3679       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  3680                                                                  ERCNETP
  3681     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  3682       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  3683       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  3684                                                                  ERCNETP
  3685     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  3686                                                                  ERCNETP
  3687     GO TO 99999-RETURN.                                          ERCNETP
  3688                                                                  ERCNETP
  3689 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  3690                                                                  ERCNETP
  3691     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  3692        NEXT SENTENCE                                             ERCNETP
  3693     ELSE                                                         ERCNETP
  3694        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  3695                                                                  ERCNETP
  3696      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3697                                                                  ERCNETP
  3698      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  3699                                                                  ERCNETP
  3700      COMPUTE WK3 EQUAL                                           ERCNETP
  3701        (12 *                                                     ERCNETP
  3702        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  3703        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
  3704        APR100.                                                   ERCNETP
  3705                                                                  ERCNETP
  3706     COMPUTE WK3 EQUAL                                            ERCNETP
  3707        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
  3708                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  69
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3709     COMPUTE WK3 EQUAL                                            ERCNETP
  3710        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  3711                                                                  ERCNETP
  3712      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3713                                                                  ERCNETP
  3714     GO TO 99999-RETURN.                                          ERCNETP
  3715                                                                  ERCNETP
  3716 12000-CHECK-CLIENT.                                              ERCNETP
  3717                                                                  ERCNETP
  3718     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  3719        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3720        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3721        NEXT SENTENCE                                             ERCNETP
  3722     ELSE                                                         ERCNETP
  3723        GO TO 12000-CHECK-NEXT.                                   ERCNETP
  3724                                                                  ERCNETP
  3725     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3726                                                                  ERCNETP
  3727     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3728     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  3729                                                                  ERCNETP
  3730     COMPUTE FM EQUAL                                             ERCNETP
  3731                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  3732                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  3733                    - 1.                                          ERCNETP
  3734                                                                  ERCNETP
  3735     COMPUTE FN EQUAL                                             ERCNETP
  3736                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  3737                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  3738                    - 1.                                          ERCNETP
  3739                                                                  ERCNETP
  3740     COMPUTE FNM EQUAL                                            ERCNETP
  3741                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  3742                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  3743                    - 1.                                          ERCNETP
  3744                                                                  ERCNETP
  3745     COMPUTE GR EQUAL                                             ERCNETP
  3746                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  3747                    (M - ANGLEM).                                 ERCNETP
  3748                                                                  ERCNETP
  3749     COMPUTE ODF EQUAL                                            ERCNETP
  3750                     (1 +                                         ERCNETP
  3751                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  3752                     360)) /                                      ERCNETP
  3753                     ONE-PLUS-I.                                  ERCNETP
  3754                                                                  ERCNETP
  3755     COMPUTE OD EQUAL                                             ERCNETP
  3756                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  3757                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  3758                                                                  ERCNETP
  3759     COMPUTE WK3 EQUAL                                            ERCNETP
  3760*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  3761                    ((1 + FN) * ODF *                             ERCNETP
  3762                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  3763                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  3764                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  3765                                                                  ERCNETP
  3766     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  70
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3767     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
  3768                                                                  ERCNETP
  3769     COMPUTE WK3 EQUAL                                            ERCNETP
  3770                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  3771*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  3772                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  3773                                                                  ERCNETP
  3774      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3775                                                                  ERCNETP
  3776     GO TO 99999-RETURN.                                          ERCNETP
  3777                                                                  ERCNETP
  3778 12000-CHECK-NEXT.                                                ERCNETP
  3779                                                                  ERCNETP
  3780     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  3781        NEXT SENTENCE                                             ERCNETP
  3782     ELSE                                                         ERCNETP
  3783        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  3784                                                                  ERCNETP
  3785      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  3786         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  3787         MOVE ZEROS              TO FACTOR                        ERCNETP
  3788                                    CP-CALC-PREMIUM               ERCNETP
  3789         GO TO 99999-RETURN.                                      ERCNETP
  3790                                                                  ERCNETP
  3791      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3792                                                                  ERCNETP
  3793      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  3794                                                                  ERCNETP
  3795      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  3796         ADD .00001 TO APR100.                                    ERCNETP
  3797                                                                  ERCNETP
  3798      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  3799      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  3800                                                                  ERCNETP
  3801
  3802
  3803     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3804        / (1 + I)
  3805     COMPUTE ANGLEN-1 = ANGLEN / Y
  3806
  3807      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  3808         COMPUTE WK3 EQUAL                                        ERCNETP
  3809                                                                  ERCNETP
  3810          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  3811          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  3812                                                                  ERCNETP
  3813          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  3814                                                                  ERCNETP
  3815          ((WK8 ** N) /                                           ERCNETP
  3816          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  3817                                                                  ERCNETP
  3818          ((WK9 ** N) /                                           ERCNETP
  3819          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
  3820                                                                  ERCNETP
  3821      ELSE                                                        ERCNETP
  3822         COMPUTE WK3 EQUAL                                        ERCNETP
  3823                                                                  ERCNETP
  3824          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  71
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3825          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
  3826                                                                  ERCNETP
  3827          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  3828                                                                  ERCNETP
  3829          ((WK8 ** N) /                                           ERCNETP
  3830          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  3831                                                                  ERCNETP
  3832          ((WK9 ** N) /                                           ERCNETP
  3833          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  3834                                                                  ERCNETP
  3835      COMPUTE WK3 EQUAL                                           ERCNETP
  3836          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  3837                                                                  ERCNETP
  3838      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3839                                                                  ERCNETP
  3840     GO TO 99999-RETURN.                                          ERCNETP
  3841                                                                  ERCNETP
  3842 12000-CHECK-PA-TRUNC.                                            ERCNETP
  3843                                                                  ERCNETP
  3844     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3845        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  3846        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3847        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3848        NEXT SENTENCE                                             ERCNETP
  3849     ELSE                                                         ERCNETP
  3850        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  3851                                                                  ERCNETP
  3852     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3853                                                                  ERCNETP
  3854     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3855     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3856                                                                  ERCNETP
  3857     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  3858                                                                  ERCNETP
  3859     COMPUTE WK3 EQUAL                                            ERCNETP
  3860        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  3861        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  3862                                                                  ERCNETP
  3863     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3864                                                                  ERCNETP
  3865     GO TO 99999-RETURN.                                          ERCNETP
  3866                                                                  ERCNETP
  3867 12000-CHECK-MD-TRUNC.                                            ERCNETP
  3868                                                                  ERCNETP
  3869     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3870        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3871        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3872        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3873        NEXT SENTENCE                                             ERCNETP
  3874     ELSE                                                         ERCNETP
  3875        GO TO 12000-CHECK-MD.                                     ERCNETP
  3876                                                                  ERCNETP
  3877     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3878                                                                  ERCNETP
  3879     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3880     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  3881     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3882                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  72
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3883     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  3884                                                                  ERCNETP
  3885     COMPUTE WK3 EQUAL                                            ERCNETP
  3886        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  3887        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  3888        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  3889                                                                  ERCNETP
  3890     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3891                                                                  ERCNETP
  3892     GO TO 99999-RETURN.                                          ERCNETP
  3893                                                                  ERCNETP
  3894 12000-CHECK-MD.                                                  ERCNETP
  3895                                                                  ERCNETP
  3896     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3897        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3898        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3899        NEXT SENTENCE                                             ERCNETP
  3900     ELSE                                                         ERCNETP
  3901        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  3902                                                                  ERCNETP
  3903     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3904                                                                  ERCNETP
  3905     COMPUTE WK3 EQUAL                                            ERCNETP
  3906        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  3907                                                                  ERCNETP
  3908     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3909                                                                  ERCNETP
  3910     GO TO 99999-RETURN.                                          ERCNETP
  3911                                                                  ERCNETP
  3912 12000-CHECK-ME-TRUNC.                                            ERCNETP
  3913                                                                  ERCNETP
  3914     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3915        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3916        AND (CP-EARN-AS-NET-PAY)
  3917        AND (CP-TRUNCATED-LIFE)
  3918        CONTINUE
  3919     ELSE
  3920        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3921     END-IF
  3922                                                                  ERCNETP
  3923     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3924
  3925     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3926
  3927     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3928
  3929     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3930
  3931     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3932     COMPUTE ANGLEN-1 = ANGLEN / Y
  3933
  3934     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3935
  3936     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3937
  3938     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3939
  3940     COMPUTE WK3
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  73
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3941        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3942        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3943            * (1 / (1.0635 ** (M / 12))))
  3944
  3945*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  3946*    COMPUTE WK9 EQUAL                                            ERCNETP
  3947*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  3948*    COMPUTE WK7 EQUAL                                            ERCNETP
  3949*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  3950*    COMPUTE WK3 EQUAL                                            ERCNETP
  3951*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  3952*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  3953*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  3954*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  3955*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
  3956*                                                                 ERCNETP
  3957     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3958                                                                  ERCNETP
  3959     GO TO 99999-RETURN
  3960
  3961      .
  3962 12000-CHECK-CID-WA-FARMPLAN.
  3963
  3964     IF (CP-COMPANY-ID EQUAL 'CID')
  3965        AND (CP-STATE-STD-ABBRV = 'WA')
  3966        AND (CP-FARM-PLAN)
  3967        CONTINUE
  3968     ELSE
  3969        GO TO 12000-CHECK-CID-FARMPLAN
  3970     END-IF
  3971
  3972     move cp-original-term       to n
  3973     move cp-no-of-pmts          TO C-TOT-PMTS
  3974     compute c-pmts-per-year = 12 / cp-pay-frequency
  3975     move cp-pay-frequency       to m
  3976     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3977     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3978     if i = zeros
  3979        move .0000000001         to i
  3980     end-if
  3981     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3982
  3983     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3984        (m * 30))) / (1 + I)
  3985     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3986        ** CP-PAY-FREQUENCY) - 1
  3987     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3988     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3989        ** TI) / WS-WORK-DIS-RATE
  3990     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  3991     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  3992     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3993        ** m) / WS-WORK-DIS-RATE
  3994     COMPUTE WK2 = WK2 * (1 + J)
  3995     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3996     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3997     COMPUTE WK3 = WK3 * (1 + J)
  3998     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  74
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3999        ** (c-tot-pmts - 1))) / J
  4000     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4001        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4002        (CP-PREMIUM-RATE / 1000)
  4003     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4004     COMPUTE WK6 = (WK7 * GR)
  4005
  4006     MOVE WK6 TO CP-CALC-PREMIUM
  4007
  4008     GO TO 99999-RETURN
  4009
  4010     .
  4011 12000-CHECK-CID-FARMPLAN.
  4012
  4013     IF (CP-COMPANY-ID EQUAL 'CID')
  4014        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4015           OR 'IN' OR 'AZ')
  4016        AND (CP-FARM-PLAN)
  4017        CONTINUE
  4018     ELSE
  4019        GO TO 12000-CHECK-SC-CID
  4020     END-IF
  4021
  4022     COMPUTE N = M / CP-PAY-FREQUENCY
  4023     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4024     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4025        ** CP-PAY-FREQUENCY) - 1
  4026     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4027     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4028        ** TI) / WS-WORK-DIS-RATE
  4029     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4030     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4031     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4032        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4033     COMPUTE WK2 = WK2 * (1 + J)
  4034     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4035     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4036     COMPUTE WK3 = WK3 * (1 + J)
  4037     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4038        ** (N - 1))) / J
  4039     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4040        ((N * WK2) - WK5)) + (N * WK1)) *
  4041        (CP-PREMIUM-RATE / 1000)
  4042     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4043     COMPUTE WK6 = (WK7 * GR)
  4044
  4045     MOVE WK6 TO CP-CALC-PREMIUM
  4046
  4047     GO TO 99999-RETURN
  4048
  4049     .
  4050 12000-CHECK-SC-CID.
  4051
  4052     IF (CP-COMPANY-ID = 'CID')
  4053        AND (CP-STATE-STD-ABBRV = 'SC')
  4054        AND (CP-EARN-AS-NET-PAY)
  4055        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4056        move 6                   to ws-extra-pmts
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  75
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4057     ELSE
  4058        GO TO 12000-CHECK-AL-CID
  4059     END-IF
  4060
  4061     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4062     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4063     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4064        / 12)) / ((M + 1) / 2)
  4065
  4066     if i = .0000000001
  4067        compute wk4 = cp-original-benefit / n
  4068        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4069            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4070        display ' hit sc wo apr - wk2 ' wk2
  4071     else
  4072        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4073        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4074        COMPUTE ANGLEN-1 = ANGLEN / Y
  4075        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4076        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4077           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4078     end-if
  4079
  4080*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4081*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4082*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4083*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4084*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4085*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4086*       / 12)) / ((M + 1) / 2)
  4087*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4088*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4089*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4090
  4091     MOVE WK3 TO CP-CALC-PREMIUM
  4092
  4093     GO TO 99999-RETURN
  4094
  4095     .
  4096 12000-CHECK-AL-CID.
  4097
  4098     IF (CP-COMPANY-ID EQUAL 'CID')
  4099        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4100        AND (CP-EARN-AS-NET-PAY)
  4101        CONTINUE
  4102     ELSE
  4103        GO TO 12000-CHECK-NH-CID
  4104     END-IF
  4105
  4106     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4107     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4108     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4109
  4110     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4111                   / (1 + I)
  4112
  4113     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4114
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  76
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4115     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4116
  4117     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4118        (CP-PREMIUM-RATE / 1000)
  4119
  4120     MOVE WK3 TO CP-CALC-PREMIUM
  4121
  4122     GO TO 99999-RETURN
  4123
  4124     .
  4125 12000-CHECK-NH-CID.
  4126
  4127     IF (CP-COMPANY-ID EQUAL 'CID')
  4128        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4129        AND (CP-EARN-AS-NET-PAY)
  4130        CONTINUE
  4131     ELSE
  4132        GO TO 12000-CHECK-PA-CID
  4133     END-IF
  4134
  4135     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4136     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4137
  4138     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4139                   / (1 + I)
  4140
  4141     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4142
  4143     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4144
  4145     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4146        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4147
  4148     MOVE WK3 TO CP-CALC-PREMIUM
  4149
  4150     GO TO 99999-RETURN
  4151
  4152     .
  4153 12000-CHECK-PA-CID.
  4154
  4155     IF (CP-COMPANY-ID EQUAL 'CID')
  4156        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4157        AND (CP-EARN-AS-NET-PAY)
  4158        CONTINUE
  4159     ELSE
  4160        GO TO 12000-CHECK-ME-CID
  4161     END-IF
  4162
  4163
  4164     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4165     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4166     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4167     COMPUTE ANGLEN-1 = ANGLEN / Y
  4168     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4169     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4170     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4171     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4172        * WK5
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  77
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4173
  4174     MOVE WK3 TO CP-CALC-PREMIUM
  4175
  4176     GO TO 99999-RETURN
  4177
  4178     .
  4179 12000-CHECK-ME-CID.
  4180
  4181     IF (CP-COMPANY-ID EQUAL 'CID')
  4182        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4183        AND (CP-EARN-AS-NET-PAY)
  4184        CONTINUE
  4185     ELSE
  4186        GO TO 12000-CHECK-VT-TRUNC
  4187     END-IF
  4188
  4189     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4190
  4191     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4192
  4193     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4194     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4195     COMPUTE ANGLEN-1 = ANGLEN / Y
  4196
  4197     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4198
  4199     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4200
  4201     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4202        * WK5
  4203
  4204     MOVE WK3 TO CP-CALC-PREMIUM
  4205
  4206     GO TO 99999-RETURN
  4207
  4208     .
  4209 12000-CHECK-VT-TRUNC.                                            ERCNETP
  4210                                                                  ERCNETP
  4211     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4212        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  4213        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4214        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4215        NEXT SENTENCE                                             ERCNETP
  4216     ELSE                                                         ERCNETP
  4217        GO TO 12000-CHECK-VT.                                     ERCNETP
  4218                                                                  ERCNETP
  4219      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  4220                                                                  ERCNETP
  4221      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4222                                                                  ERCNETP
  4223      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4224                                                                  ERCNETP
  4225      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  4226      COMPUTE WK9 EQUAL                                           ERCNETP
  4227        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  4228        ((.0054 - I) / (1 + I)).                                  ERCNETP
  4229      COMPUTE WK7 EQUAL                                           ERCNETP
  4230        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  78
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4231      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
  4232        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  4233                                                                  ERCNETP
  4234      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4235                                                                  ERCNETP
  4236     GO TO 99999-RETURN.                                          ERCNETP
  4237                                                                  ERCNETP
  4238 12000-CHECK-VT.                                                  ERCNETP
  4239                                                                  ERCNETP
  4240     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4241        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  4242        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4243        NEXT SENTENCE                                             ERCNETP
  4244     ELSE                                                         ERCNETP
  4245        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  4246                                                                  ERCNETP
  4247      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  4248                                                                  ERCNETP
  4249      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4250                                                                  ERCNETP
  4251      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4252                                                                  ERCNETP
  4253      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
  4254                        (ANGLEN-1 * I)) *                         ERCNETP
  4255                                                                  ERCNETP
  4256                        (((1.0054 ** N - 1) /                     ERCNETP
  4257                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  4258                                                                  ERCNETP
  4259                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  4260                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  4261                                                                  ERCNETP
  4262      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4263                                                                  ERCNETP
  4264     GO TO 99999-RETURN.                                          ERCNETP
  4265                                                                  ERCNETP
  4266 12000-CHECK-MINN-WDS.                                            ERCNETP
  4267                                                                  ERCNETP
  4268     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4269        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4270        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4271        NEXT SENTENCE                                             ERCNETP
  4272     ELSE                                                         ERCNETP
  4273        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  4274                                                                  ERCNETP
  4275     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4276     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  4277              (N / +12) * (2 / (N + 1)).                          ERCNETP
  4278     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  4279         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  4280                                                                  ERCNETP
  4281      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4282                                                                  ERCNETP
  4283     GO TO 99999-RETURN.                                          ERCNETP
  4284                                                                  ERCNETP
  4285 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  4286                                                                  ERCNETP
  4287     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4288        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  79
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4289        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  4290        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4291        NEXT SENTENCE                                             ERCNETP
  4292     ELSE                                                         ERCNETP
  4293        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  4294                                                                  ERCNETP
  4295     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4296                                                                  ERCNETP
  4297     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  4298                                                                  ERCNETP
  4299     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  4300        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  4301                                                                  ERCNETP
  4302     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4303                                                                  ERCNETP
  4304     GO TO 99999-RETURN.                                          ERCNETP
  4305                                                                  ERCNETP
  4306 12000-CHECK-MINN-BALL.                                           ERCNETP
  4307                                                                  ERCNETP
  4308     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4309        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4310        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4311        NEXT SENTENCE                                             ERCNETP
  4312     ELSE                                                         ERCNETP
  4313        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  4314                                                                  ERCNETP
  4315     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4316     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  4317                                                                  ERCNETP
  4318     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  4319     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  4320     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  4321                                                                  ERCNETP
  4322      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4323                                                                  ERCNETP
  4324     GO TO 99999-RETURN.                                          ERCNETP
  4325                                                                  ERCNETP
  4326 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  4327                                                                  ERCNETP
  4328     IF (CP-COMPANY-ID EQUAL 'CID')
  4329        AND (CP-STATE-STD-ABBRV = 'MN')
  4330        AND (CP-CERT-EFF-DT > X'A4FF')
  4331        AND (CP-EARN-AS-REG-BALLOON)
  4332        CONTINUE
  4333     ELSE
  4334        GO TO 12000-CHECK-CID-MN-FARM
  4335     END-IF
  4336                                                                  ERCNETP
  4337     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4338     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4339     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4340     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4341     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4342     COMPUTE V = 1 / (1 + I)
  4343     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4344     COMPUTE Y = (1 + (D * I) / +30)
  4345        / (1 + I)
  4346
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  80
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4347
  4348     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4349        * CP-PREMIUM-RATE / 1000
  4350
  4351*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4352*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4353*    ELSE
  4354*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4355*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4356*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4357*       DISPLAY ' BALLOON TOP ' WK6
  4358*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4359*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4360*          / 100
  4361*       DISPLAY ' BALLOON BOTTOM ' WK7
  4362*       COMPUTE GR = WK6 / WK7
  4363*       DISPLAY ' BALLOON PAYMENT ' GR
  4364*    END-IF
  4365
  4366     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4367     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4368        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4369     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4370
  4371     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4372        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4373           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4374           * CP-PREMIUM-RATE / 1000
  4375
  4376     MOVE WK3                    TO CP-CALC-PREMIUM
  4377                                                                  ERCNETP
  4378     GO TO 99999-RETURN.                                          ERCNETP
  4379
  4380     .
  4381 12000-CHECK-CID-MN-FARM.
  4382
  4383     IF (CP-COMPANY-ID EQUAL 'CID')
  4384        AND (CP-STATE-STD-ABBRV = 'MN')
  4385        AND (CP-CERT-EFF-DT > X'A4FF')
  4386        AND (CP-EARN-AS-FARM-PLAN)
  4387        CONTINUE
  4388     ELSE
  4389        GO TO 12000-CHECK-NC-WDS
  4390     END-IF
  4391
  4392     EVALUATE CP-PMT-MODE
  4393        WHEN 'B'
  4394           MOVE +14              TO C-DAYS-IN-PMT-PER
  4395           MOVE +26              TO C-PMTS-PER-YEAR
  4396           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4397        WHEN 'S'
  4398           MOVE +15              TO C-DAYS-IN-PMT-PER
  4399           MOVE +24              TO C-PMTS-PER-YEAR
  4400           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4401        WHEN 'T'
  4402           MOVE +360             TO C-DAYS-IN-PMT-PER
  4403           MOVE +1               TO C-PMTS-PER-YEAR
  4404           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  81
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4405        WHEN 'W'
  4406           MOVE +7               TO C-DAYS-IN-PMT-PER
  4407           MOVE +52              TO C-PMTS-PER-YEAR
  4408           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4409        WHEN 'B'
  4410           MOVE +14              TO C-DAYS-IN-PMT-PER
  4411           MOVE +26              TO C-PMTS-PER-YEAR
  4412           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4413        WHEN OTHER
  4414           move cp-no-of-pmts    to c-tot-pmts
  4415           if cp-pay-frequency > zeros
  4416              compute c-pmts-per-year =
  4417                 12 / cp-pay-frequency
  4418              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4419           else
  4420              MOVE +30           TO C-DAYS-IN-PMT-PER
  4421              MOVE +12           TO C-PMTS-PER-YEAR
  4422              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4423           end-if
  4424     END-EVALUATE
  4425
  4426     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4427     if i = zeros
  4428        move .0000000001         to i
  4429     end-if
  4430
  4431     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4432        C-DAYS-IN-PMT-PER)) / (1 + I)
  4433
  4434     compute cp-premium-rate =
  4435        cp-premium-rate * 12 / c-pmts-per-year / 10
  4436     move c-tot-pmts to n m
  4437     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4438     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4439     COMPUTE ANGLEN-1 = ANGLEN / Y
  4440     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4441
  4442     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4443        (cp-premium-rate / 100)
  4444
  4445
  4446     MOVE WK3                    TO CP-CALC-PREMIUM
  4447
  4448     GO TO 99999-RETURN.
  4449
  4450     .
  4451 12000-CHECK-NC-WDS.                                              ERCNETP
  4452                                                                  ERCNETP
  4453     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4454        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4455        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4456        NEXT SENTENCE                                             ERCNETP
  4457     ELSE                                                         ERCNETP
  4458        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  4459                                                                  ERCNETP
  4460     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  4461     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4462     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  82
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4463              CP-PREMIUM-RATE / +100 *                            ERCNETP
  4464              N / +12 * 2 / (N + 1) *                             ERCNETP
  4465              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  4466                                                                  ERCNETP
  4467      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4468                                                                  ERCNETP
  4469     GO TO 99999-RETURN.                                          ERCNETP
  4470                                                                  ERCNETP
  4471 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  4472                                                                  ERCNETP
  4473     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4474        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4475        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  4476        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4477        NEXT SENTENCE                                             ERCNETP
  4478     ELSE                                                         ERCNETP
  4479        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  4480                                                                  ERCNETP
  4481     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4482                                                                  ERCNETP
  4483**** VX = 1 / (1 + I)**N.                                         ERCNETP
  4484                                                                  ERCNETP
  4485     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  4486        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
  4487                                                                  ERCNETP
  4488     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4489                                                                  ERCNETP
  4490     GO TO 99999-RETURN.                                          ERCNETP
  4491                                                                  ERCNETP
  4492 12000-CHECK-NC-BALL.                                             ERCNETP
  4493                                                                  ERCNETP
  4494     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4495        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4496        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4497        NEXT SENTENCE                                             ERCNETP
  4498     ELSE                                                         ERCNETP
  4499        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
  4500                                                                  ERCNETP
  4501     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  4502     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4503     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  4504**** VX = 1 / (1 + I)**N.                                         ERCNETP
  4505                                                                  ERCNETP
  4506     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  4507     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  4508     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  4509                                                                  ERCNETP
  4510      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4511                                                                  ERCNETP
  4512     GO TO 99999-RETURN.                                          ERCNETP
  4513                                                                  ERCNETP
  4514 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  4515                                                                  ERCNETP
  4516     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4517        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4518        (M GREATER THAN +63) AND                                  ERCNETP
  4519        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4520        (CP-TRUNCATED-LIFE)                                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  83
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4521        NEXT SENTENCE                                             ERCNETP
  4522     ELSE                                                         ERCNETP
  4523        GO TO 12000-CHECK-MINN.                                   ERCNETP
  4524                                                                  ERCNETP
  4525      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4526      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4527                                                                  ERCNETP
  4528      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4529                                                                  ERCNETP
  4530      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4531       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4532       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  4533                                                                  ERCNETP
  4534      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4535                                                                  ERCNETP
  4536     GO TO 99999-RETURN.                                          ERCNETP
  4537                                                                  ERCNETP
  4538 12000-CHECK-MINN.                                                ERCNETP
  4539                                                                  ERCNETP
  4540     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4541        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4542        (M GREATER THAN +63) AND                                  ERCNETP
  4543        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4544        NEXT SENTENCE                                             ERCNETP
  4545     ELSE                                                         ERCNETP
  4546        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  4547                                                                  ERCNETP
  4548      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4549                                                                  ERCNETP
  4550      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4551                                                                  ERCNETP
  4552      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4553       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4554       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  4555                                                                  ERCNETP
  4556      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4557                                                                  ERCNETP
  4558     GO TO 99999-RETURN.                                          ERCNETP
  4559                                                                  ERCNETP
  4560 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  4561                                                                  ERCNETP
  4562     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4563        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  4564        (M GREATER THAN +63) AND                                  ERCNETP
  4565        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4566        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4567        NEXT SENTENCE                                             ERCNETP
  4568     ELSE                                                         ERCNETP
  4569        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  4570                                                                  ERCNETP
  4571      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4572      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4573                                                                  ERCNETP
  4574      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4575                                                                  ERCNETP
  4576      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  4577      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4578       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  84
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4579                                                                  ERCNETP
  4580      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4581                                                                  ERCNETP
  4582     GO TO 99999-RETURN.                                          ERCNETP
  4583                                                                  ERCNETP
  4584 12000-CHECK-MONTANA.                                             ERCNETP
  4585                                                                  ERCNETP
  4586     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4587        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  4588        (M GREATER THAN +63) AND                                  ERCNETP
  4589        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4590        NEXT SENTENCE                                             ERCNETP
  4591     ELSE                                                         ERCNETP
  4592        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  4593                                                                  ERCNETP
  4594      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4595                                                                  ERCNETP
  4596      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4597                                                                  ERCNETP
  4598      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4599       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4600       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  4601                                                                  ERCNETP
  4602      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4603                                                                  ERCNETP
  4604     GO TO 99999-RETURN.                                          ERCNETP
  4605                                                                  ERCNETP
  4606 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  4607                                                                  ERCNETP
  4608     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4609        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4610        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4611        NEXT SENTENCE                                             ERCNETP
  4612     ELSE                                                         ERCNETP
  4613        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
  4614                                                                  ERCNETP
  4615      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4616      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4617                                                                  ERCNETP
  4618      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4619                                                                  ERCNETP
  4620      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  4621      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  4622      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  4623                                                                  ERCNETP
  4624      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4625                                                                  ERCNETP
  4626     GO TO 99999-RETURN.                                          ERCNETP
  4627                                                                  ERCNETP
  4628 12001-CONTINUE-NCL.                                              ERCNETP
  4629                                                                  ERCNETP
  4630     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4631        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4632        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4633        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  4634                                                                  ERCNETP
  4635     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4636        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  85
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4637        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4638        GO TO 12001-CHECK-CA.                                     ERCNETP
  4639                                                                  ERCNETP
  4640     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4641        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4642        NEXT SENTENCE                                             ERCNETP
  4643     ELSE                                                         ERCNETP
  4644        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  4645                                                                  ERCNETP
  4646      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4647      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  4648                                                                  ERCNETP
  4649      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4650                                                                  ERCNETP
  4651      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4652       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4653       ((N - ANGLEN) / I).                                        ERCNETP
  4654                                                                  ERCNETP
  4655      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4656                                                                  ERCNETP
  4657     GO TO 99999-RETURN.                                          ERCNETP
  4658                                                                  ERCNETP
  4659 12000-CONTINUE-NET.                                              ERCNETP
  4660                                                                  ERCNETP
  4661     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  4662        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  4663        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4664        NEXT SENTENCE                                             ERCNETP
  4665     ELSE                                                         ERCNETP
  4666        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  4667                                                                  ERCNETP
  4668      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  4669      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  4670                                                                  ERCNETP
  4671      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
  4672      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  4673      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
  4674       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  4675                                                                  ERCNETP
  4676      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  4677         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  4678                                                                  ERCNETP
  4679      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  4680                                                                  ERCNETP
  4681      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  4682         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  4683         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  4684                                                                  ERCNETP
  4685      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4686                                                                  ERCNETP
  4687     GO TO 99999-RETURN.                                          ERCNETP
  4688                                                                  ERCNETP
  4689 12001-CONTINUE-MINN.                                             ERCNETP
  4690                                                                  ERCNETP
  4691     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4692        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  4693        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4694        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  86
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4695     ELSE                                                         ERCNETP
  4696        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  4697                                                                  ERCNETP
  4698      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4699      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  4700                                                                  ERCNETP
  4701      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  4702       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  4703       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  4704                                                                  ERCNETP
  4705      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  4706       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  4707                                                                  ERCNETP
  4708     GO TO 99999-RETURN.                                          ERCNETP
  4709                                                                  ERCNETP
  4710 12001-CHECK-RI-GTL.                                              ERCNETP
  4711                                                                  ERCNETP
  4712     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4713        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  4714        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4715        NEXT SENTENCE                                             ERCNETP
  4716     ELSE                                                         ERCNETP
  4717        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  4718                                                                  ERCNETP
  4719      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4720*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  4721                                                                  ERCNETP
  4722      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  4723               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  4724      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  4725         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  4726                                                                  ERCNETP
  4727                                                                  ERCNETP
  4728     GO TO 99999-RETURN.                                          ERCNETP
  4729                                                                  ERCNETP
  4730 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  4731                                                                  ERCNETP
  4732     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4733        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  4734        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  4735        NEXT SENTENCE                                             ERCNETP
  4736     ELSE                                                         ERCNETP
  4737        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  4738                                                                  ERCNETP
  4739     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4740                                                                  ERCNETP
  4741     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  4742        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  4743                        /                                         ERCNETP
  4744        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  4745     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  4746       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  4747                            /                                     ERCNETP
  4748       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  4749                                                                  ERCNETP
  4750     GO TO 99999-RETURN.                                          ERCNETP
  4751                                                                  ERCNETP
  4752 12001-CHECK-OR-GTL.                                              ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  87
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4753                                                                  ERCNETP
  4754     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4755        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  4756        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4757        NEXT SENTENCE                                             ERCNETP
  4758     ELSE                                                         ERCNETP
  4759        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  4760                                                                  ERCNETP
  4761     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4762     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4763                                                                  ERCNETP
  4764     IF M LESS THAN +64                                           ERCNETP
  4765        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4766         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  4767                   /                                              ERCNETP
  4768         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  4769        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  4770     ELSE                                                         ERCNETP
  4771        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4772        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  4773                  /                                               ERCNETP
  4774        (+1000 * I * ANGLEN)                                      ERCNETP
  4775        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  4776*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4777     GO TO 99999-RETURN.                                          ERCNETP
  4778                                                                  ERCNETP
  4779 12001-CHECK-GA-GTL.                                              ERCNETP
  4780                                                                  ERCNETP
  4781     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4782        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  4783        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4784*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  4785        NEXT SENTENCE                                             ERCNETP
  4786     ELSE                                                         ERCNETP
  4787        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
  4788                                                                  ERCNETP
  4789     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4790     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4791                                                                  ERCNETP
  4792     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  4793     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  4794      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  4795     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4796                                                                  ERCNETP
  4797     GO TO 99999-RETURN.                                          ERCNETP
  4798                                                                  ERCNETP
  4799 12001-CHECK-MA-GTL.                                              ERCNETP
  4800                                                                  ERCNETP
  4801     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4802        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  4803        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4804        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  4805        NEXT SENTENCE                                             ERCNETP
  4806     ELSE                                                         ERCNETP
  4807        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  4808                                                                  ERCNETP
  4809     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4810                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  88
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4811     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
  4812      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  4813                                                                  ERCNETP
  4814     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  4815     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  4816                                                                  ERCNETP
  4817     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  4818     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  4819     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4820                                                                  ERCNETP
  4821     GO TO 99999-RETURN.                                          ERCNETP
  4822                                                                  ERCNETP
  4823 12001-CHECK-NV-NET.                                              ERCNETP
  4824
  4825     IF (CP-COMPANY-ID EQUAL 'CID')
  4826        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4827        AND (CP-EARN-AS-NET-PAY)
  4828        CONTINUE
  4829     ELSE
  4830        GO TO 12001-CHECK-MN-NET
  4831     END-IF
  4832
  4833     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4834     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4835
  4836     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4837                   / (1 + I)
  4838
  4839     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4840
  4841     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4842
  4843     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4844        (CP-PREMIUM-RATE * K-I / 1000)
  4845
  4846     MOVE WK3                    TO CP-CALC-PREMIUM
  4847
  4848     GO TO 99999-RETURN
  4849
  4850      .
  4851 12001-CHECK-MN-NET.
  4852
  4853     IF (CP-COMPANY-ID EQUAL 'CID')
  4854        AND (CP-STATE-STD-ABBRV = 'MN')
  4855        AND (CP-EARN-AS-NET-PAY)
  4856        AND (NOT CP-LEVEL-LIFE)
  4857        AND (WS-DISCOUNT-OPTION = '1')
  4858        CONTINUE
  4859     ELSE
  4860        GO TO 12001-CHECK-NC-NET
  4861     END-IF
  4862
  4863     if i = .0000000001
  4864        compute wk4 = cp-original-benefit / n
  4865        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  4866           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  4867        move wk3 to cp-calc-premium
  4868        go to 99999-return
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  89
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4869     end-if
  4870
  4871     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4872     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4873
  4874     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4875                   / (1 + I)
  4876
  4877     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4878
  4879     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4880
  4881     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4882        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4883
  4884     MOVE WK3                    TO CP-CALC-PREMIUM
  4885
  4886     GO TO 99999-RETURN
  4887
  4888      .
  4889 12001-CHECK-NC-NET.                                              ERCNETP
  4890                                                                  ERCNETP
  4891     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  4892        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4893        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4894        NEXT SENTENCE                                             ERCNETP
  4895     ELSE                                                         ERCNETP
  4896        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  4897                                                                  ERCNETP
  4898      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4899      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4900                                                                  ERCNETP
  4901      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  4902          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  4903          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  4904          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  4905                                                                  ERCNETP
  4906      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  4907          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  4908                                                                  ERCNETP
  4909      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  4910          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  4911          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
  4912          (ANGLEN * 2))                                           ERCNETP
  4913                                                                  ERCNETP
  4914      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  4915                                                                  ERCNETP
  4916      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  4917          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  4918              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  4919          COMPUTE WK3 ROUNDED =                                   ERCNETP
  4920              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  4921                                                                  ERCNETP
  4922     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4923                                                                  ERCNETP
  4924     GO TO 99999-RETURN.                                          ERCNETP
  4925                                                                  ERCNETP
  4926 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  90
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4927                                                                  ERCNETP
  4928     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND                          ERCNE
  4929        (CP-EARN-AS-NET-PAY) AND                                     ERCNE
  4930        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  4931        NEXT SENTENCE                                                ERCNE
  4932     ELSE                                                            ERCNE
  4933        GO TO 12001-CHECK-CA.                                        ERCNE
  4934                                                                  ERCNETP
  4935     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  4936     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  4937     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  4938                                                                  ERCNETP
  4939     IF DATE-CONVERSION-ERROR                                     ERCNETP
  4940        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  4941        MOVE ZEROS               TO FACTOR                        ERCNETP
  4942                                    CP-CALC-PREMIUM               ERCNETP
  4943         GO TO 99999-RETURN.                                      ERCNETP
  4944                                                                  ERCNETP
  4945     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  4946        NEXT SENTENCE                                             ERCNETP
  4947     ELSE                                                         ERCNETP
  4948        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  4949                                                                  ERCNETP
  4950     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4951     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4952                                                                  ERCNETP
  4953     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  4954                                                                  ERCNETP
  4955     COMPUTE NC-R = 20 *                                          ERCNETP
  4956                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  4957                          / (ORIGINAL-TERM + 1).                  ERCNETP
  4958                                                                  ERCNETP
  4959     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  4960                                                                  ERCNETP
  4961     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  4962                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  4963                                                                  ERCNETP
  4964     IF CP-EXT-CHG-LF                                             ERCNETP
  4965         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  4966     ELSE                                                         ERCNETP
  4967         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  4968                                                                  ERCNETP
  4969     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
  4970             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  4971                                                                  ERCNETP
  4972     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  4973             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  4974                                                                  ERCNETP
  4975     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  4976                                                                  ERCNETP
  4977     GO TO 99999-RETURN.                                          ERCNETP
  4978                                                                  ERCNETP
  4979 12001-CHECK-CA.                                                  ERCNETP
  4980                                                                  ERCNETP
  4981     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4982        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  4983        NEXT SENTENCE                                             ERCNETP
  4984     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  91
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4985        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
  4986                                                                  ERCNETP
  4987     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  4988     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4989     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  4990     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  4991     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  4992     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  4993     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4994         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  4995         ((1 + CA-J) / I) *                                       ERCNETP
  4996         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  4997         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  4998         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  4999                                                                  ERCNETP
  5000     GO TO 99999-RETURN.                                          ERCNETP
  5001                                                                  ERCNETP
  5002 12001-CHECK-GTL-IA.                                              ERCNETP
  5003                                                                  ERCNETP
  5004     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  5005        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  5006        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5007        NEXT SENTENCE                                             ERCNETP
  5008     ELSE                                                         ERCNETP
  5009        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  5010                                                                  ERCNETP
  5011***************************************************************   ERCNETP
  5012                                                                  ERCNETP
  5013     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  5014                                                                  ERCNETP
  5015     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  5016         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  5017     ELSE                                                         ERCNETP
  5018         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  5019             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  5020         ELSE                                                     ERCNETP
  5021             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
  5022                                                                  ERCNETP
  5023     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  5024     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  5025                                                                  ERCNETP
  5026     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  5027                          GTL-IA-SGN.                             ERCNETP
  5028                                                                  ERCNETP
  5029     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5030     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  5031                                                                  ERCNETP
  5032     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  5033         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  5034         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  5035                                                                  ERCNETP
  5036     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  5037           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  5038                             (ANGLEN - ANGLEN-M))) *                 CL**3
  5039           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  5040                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  5041                                                                     CL**3
  5042     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  92
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5043      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
  5044                                                                     CL**3
  5045     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  5046                                                                     CL**3
  5047     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  5048                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  5049     GO TO 99999-RETURN.                                          ERCNETP
  5050                                                                  ERCNETP
  5051                                                                  ERCNETP
  5052 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  5053                                                                  ERCNETP
  5054     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5055        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  5056        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5057        (CP-TRUNCATED-LIFE) AND
  5058        (CP-STATE-STD-ABBRV = CP-STATE)
  5059        CONTINUE                                                  ERCNETP
  5060     ELSE                                                         ERCNETP
  5061        GO TO 12001-CHECK-CID-TX
  5062     END-IF
  5063
  5064     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5065     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5066     IF WS-WORK-DIS-RATE = ZEROS
  5067        CONTINUE
  5068     ELSE
  5069        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5070        COMPUTE WK7 = (1 / I) *
  5071              (((WK4 ** M - 1) / (WK4 - 1)) -
  5072              ((WK4 ** M * SX - VX) /
  5073              (WK4 * (1 + I) - 1))) *
  5074              (CP-PREMIUM-RATE / 1000)
  5075        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5076        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5077        COMPUTE CP-CALC-PREMIUM =
  5078           WK8 *  ((WK4 * ANGLEN) / 100)
  5079     END-IF
  5080
  5081     GO TO 99999-RETURN                                           ERCNETP
  5082
  5083     .                                                            ERCNETP
  5084                                                                  ERCNETP
  5085 12001-CHECK-CID-TX.
  5086
  5087     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5088        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5089        (CP-EARN-AS-NET-PAY) AND
  5090        (WS-WORK-DIS-RATE > ZEROS) AND
  5091        (CP-STATE-STD-ABBRV = CP-STATE)
  5092        CONTINUE
  5093     ELSE
  5094        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5095     END-IF
  5096* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5097     COMPUTE K-I = 1 + (1 * I)
  5098     COMPUTE ANGLEN EQUAL WK1 / I
  5099     COMPUTE ANGLEM EQUAL WK2 / I
  5100     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  93
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5101     IF WS-WORK-DIS-RATE = ZEROS
  5102        CONTINUE
  5103     ELSE
  5104        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5105        COMPUTE WK7 = (K-I / I) *
  5106              (((WK4 ** M - 1) / (WK4 - 1)) -
  5107*             ((WK4 ** M * SX - VX) /
  5108              ((WK4 ** M * SX) - VX) /
  5109*             (WK4 * (1 + I) - 1))) *
  5110              (WK4 * (1 + I) - 1)) *
  5111              (CP-PREMIUM-RATE / 1000)
  5112        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5113        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5114        COMPUTE CP-CALC-PREMIUM =
  5115           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5116     END-IF
  5117
  5118     GO TO 99999-RETURN
  5119
  5120     .
  5121 12001-CHECK-CID-LEV-MN-NEW.
  5122
  5123*    IF (CP-COMPANY-ID EQUAL 'CID')
  5124*       AND (CP-STATE-STD-ABBRV = 'MN')
  5125*       AND (CP-EARN-AS-NET-PAY)
  5126*       AND (CP-LEVEL-LIFE)
  5127*       AND (CP-CERT-EFF-DT > X'A4FF')
  5128*       CONTINUE
  5129*    ELSE
  5130*       GO TO 12001-CHECK-CID-LEV-MN
  5131*    END-IF
  5132*
  5133*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5134*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5135*    MOVE '1'                    TO DC-OPTION-CODE
  5136*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5137*
  5138*    IF DATE-CONVERSION-ERROR
  5139*       MOVE '2'                 TO CP-RETURN-CODE
  5140*       MOVE ZEROS               TO FACTOR
  5141*                                   CP-CALC-PREMIUM
  5142*       GO TO 99999-RETURN
  5143*    END-IF
  5144*
  5145*    COMPUTE I = CP-LOAN-APR / 100
  5146*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5147*
  5148*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5149*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5150*      * 12 / 360 * D)
  5151*
  5152*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5153*       * 12 / 360 * D
  5154*
  5155*    GO TO 99999-RETURN
  5156
  5157      .
  5158 12001-CHECK-CID-LEV-MN.                                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  94
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5159                                                                  ERCNETP
  5160     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5161        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  5162        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5163        (CP-LEVEL-LIFE) AND
  5164        (CP-STATE-STD-ABBRV = CP-STATE)
  5165        CONTINUE                                                  ERCNETP
  5166     ELSE                                                         ERCNETP
  5167        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  5168     END-IF
  5169
  5170     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5171         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5172         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5173
  5174     GO TO 99999-RETURN                                           ERCNETP
  5175
  5176      .
  5177 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  5178                                                                  ERCNETP
  5179     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5180        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5181        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5182        (CP-LEVEL-LIFE) AND
  5183        (CP-STATE-STD-ABBRV = CP-STATE)
  5184        CONTINUE                                                  ERCNETP
  5185     ELSE                                                         ERCNETP
  5186        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  5187     END-IF
  5188
  5189     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5190     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5191     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5192     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5193     COMPUTE CP-CALC-PREMIUM =
  5194          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5195          (CP-PREMIUM-RATE / 1000)) /
  5196          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5197
  5198     GO TO 99999-RETURN                                           ERCNETP
  5199
  5200      .
  5201 12001-CHECK-CID-TRN-CA.                                          ERCNETP
  5202                                                                  ERCNETP
  5203     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5204        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5205        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5206        (CP-TRUNCATED-LIFE) AND
  5207        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5208        (WS-DISCOUNT-OPTION NOT = ' ')
  5209        CONTINUE                                                  ERCNETP
  5210     ELSE                                                         ERCNETP
  5211        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  5212     END-IF
  5213
  5214     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5215     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5216     IF WS-WORK-DIS-RATE = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  95
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5217        CONTINUE
  5218     ELSE
  5219        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5220        COMPUTE WK7 = (1 / I) *
  5221              (((WK4 ** M - 1) / (WK4 - 1)) -
  5222              ((WK4 ** M * SX - VX) /
  5223              (WK4 * (1 + I) - 1))) *
  5224              (CP-PREMIUM-RATE / 1000)
  5225        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5226        COMPUTE CP-CALC-PREMIUM =
  5227           WK4 *  WK7
  5228     END-IF
  5229
  5230     GO TO 99999-RETURN                                           ERCNETP
  5231
  5232      .
  5233 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  5234                                                                  ERCNETP
  5235     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5236        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5237                   OR
  5238        ((CP-STATE-STD-ABBRV = 'IN') AND
  5239        (CP-CERT-EFF-DT > X'9A7F'))
  5240                   OR
  5241        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5242        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5243        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5244        (CP-TRUNCATED-LIFE) AND
  5245        (CP-STATE-STD-ABBRV = CP-STATE)
  5246        CONTINUE                                                  ERCNETP
  5247     ELSE                                                         ERCNETP
  5248        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  5249     END-IF
  5250
  5251* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5252     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5253        MOVE 0                   TO K-I
  5254     ELSE
  5255        MOVE 2                   TO K-I
  5256     END-IF
  5257     COMPUTE CP-TERM-OR-EXT-DAYS =
  5258           CP-TERM-OR-EXT-DAYS + 30
  5259
  5260     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5261     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5262     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5263                   / (1 + I)
  5264     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5265     IF WS-WORK-DIS-RATE = ZEROS
  5266        CONTINUE
  5267     ELSE
  5268        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5269*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5270        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5271              (((WK4 ** M - 1) / (WK4 - 1)) -
  5272              ((WK4 ** M * SX - VX) /
  5273              (WK4 * (1 + I) - 1))) *
  5274              (CP-PREMIUM-RATE / 1000)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  96
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5275        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5276*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5277        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5278        COMPUTE CP-CALC-PREMIUM =
  5279           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5280*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5281     END-IF
  5282
  5283     GO TO 99999-RETURN                                           ERCNETP
  5284
  5285     .                                                            ERCNETP
  5286 12001-CHECK-CID-MT.                                              ERCNETP
  5287                                                                  ERCNETP
  5288     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5289        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5290                                OR 'VT')
  5291                   OR
  5292        ((CP-STATE-STD-ABBRV = 'IN') AND
  5293        (CP-CERT-EFF-DT > X'9A7F'))
  5294                   OR
  5295        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5296        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5297        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5298        (CP-STATE-STD-ABBRV = CP-STATE)
  5299        CONTINUE                                                  ERCNETP
  5300     ELSE                                                         ERCNETP
  5301        GO TO 12001-CHECK-DCC-DD
  5302     END-IF
  5303
  5304     COMPUTE CP-TERM-OR-EXT-DAYS =
  5305           CP-TERM-OR-EXT-DAYS + 30
  5306
  5307* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5308     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5309        MOVE 0                   TO K-I
  5310     ELSE
  5311        IF CP-STATE-STD-ABBRV = 'NJ'
  5312           MOVE 1                TO K-I
  5313        ELSE
  5314           MOVE 2                TO K-I
  5315        END-IF
  5316     END-IF
  5317     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5318     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5319     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5320                   / (1 + I)
  5321     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5322     IF WS-WORK-DIS-RATE = ZEROS
  5323        CONTINUE
  5324     ELSE
  5325        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5326*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5327        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5328              (((WK4 ** N - 1) / (WK4 - 1)) -
  5329              ((WK4 ** N - SV) /
  5330              (WK4 * (1 + I) - 1))) *
  5331              (CP-PREMIUM-RATE / 1000)
  5332        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  97
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5333*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5334        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5335        COMPUTE CP-CALC-PREMIUM =
  5336           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5337*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5338     END-IF
  5339
  5340     GO TO 99999-RETURN                                           ERCNETP
  5341
  5342     .                                                            ERCNETP
  5343
  5344 12001-CHECK-DCC-DD.
  5345
  5346     IF (CP-COMPANY-ID EQUAL 'DCC')
  5347        AND (CP-EARN-AS-NET-PAY)
  5348        AND (CP-BEN-CATEGORY = 'D')
  5349        CONTINUE
  5350     ELSE
  5351        GO TO 12001-CHECK-DCC-NET
  5352     END-IF
  5353
  5354     COMPUTE CP-TERM-OR-EXT-DAYS =
  5355           CP-TERM-OR-EXT-DAYS + 30
  5356
  5357     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5358     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5359     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5360                                                                  ERCNETP
  5361     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5362           / (1 + I)
  5363
  5364     COMPUTE GR     = ANGLEN / ODF
  5365*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5366*      CP-RATE-DEV-PCT
  5367
  5368     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5369
  5370     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5371       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5372     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5373     MOVE WK3                    TO CP-CALC-PREMIUM
  5374
  5375     GO TO 99999-RETURN                                           ERCNETP
  5376
  5377     .                                                            ERCNETP
  5378
  5379 12001-CHECK-DCC-NET.                                             ERCNETP
  5380                                                                  ERCNETP
  5381     IF (CP-COMPANY-ID EQUAL 'DCC')
  5382        AND (CP-EARN-AS-NET-PAY)
  5383        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5384             AND 'H' AND 'S' AND 'P')
  5385        CONTINUE                                                  ERCNETP
  5386     ELSE                                                         ERCNETP
  5387        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  5388     END-IF
  5389
  5390     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  98
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5391           CP-TERM-OR-EXT-DAYS + 30
  5392
  5393     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5394     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5395     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5396                                                                  ERCNETP
  5397     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5398           / (1 + I)
  5399
  5400     COMPUTE GR     = ANGLEN / ODF
  5401     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5402     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5403       CP-RATE-DEV-PCT
  5404     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5405*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5406
  5407     COMPUTE WK8 = CP-PREMIUM-RATE *
  5408        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5409     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5410     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5411     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5412       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5413     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5414     MOVE WK3                    TO CP-CALC-PREMIUM
  5415
  5416     GO TO 99999-RETURN                                           ERCNETP
  5417
  5418     .                                                            ERCNETP
  5419 12001-CHECK-DCC-PNET.                                            ERCNETP
  5420
  5421     IF (CP-COMPANY-ID EQUAL 'DCC')
  5422        AND (CP-EARN-AS-NET-PAY)
  5423        AND (CP-BENEFIT-CD (1:1) = 'P')
  5424        CONTINUE                                                  ERCNETP
  5425     ELSE                                                         ERCNETP
  5426        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  5427     END-IF
  5428
  5429     IF CP-NO-OF-PMTS NOT NUMERIC
  5430        MOVE +0                  TO CP-NO-OF-PMTS
  5431     END-IF
  5432     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5433        AND ' ' AND 'M'
  5434        MOVE ' '                 TO CP-PMT-MODE
  5435     END-IF
  5436
  5437******************************************************************
  5438***   Default is monthly, use loan term for rate and amort     ***
  5439******************************************************************
  5440     move cp-loan-term         to c-tot-pmts
  5441     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5442     MOVE +12                  TO C-PMTS-PER-YEAR
  5443******************************************************************
  5444
  5445     evaluate true
  5446        when cp-pmt-mode = 'W'
  5447           MOVE +52              TO C-PMTS-PER-YEAR
  5448           compute c-tot-pmts = cp-loan-term /
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  99
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5449              12 * c-pmts-per-year
  5450           MOVE +7               TO C-DAYS-IN-PMT-PER
  5451        when cp-pmt-mode = 'B'
  5452           MOVE +26              TO C-PMTS-PER-YEAR
  5453           compute c-tot-pmts = cp-loan-term /
  5454              12 * c-pmts-per-year
  5455           MOVE +14              TO C-DAYS-IN-PMT-PER
  5456     end-evaluate
  5457
  5458     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5459
  5460     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5461        C-DAYS-IN-PMT-PER)) / (1 + I)
  5462
  5463     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5464*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5465     COMPUTE ANGLEN-1 = ANGLEN / Y
  5466
  5467     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5468
  5469     IF CP-RATE-DEV-PCT NOT = ZEROS
  5470        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5471           CP-PREMIUM-RATE
  5472     END-IF
  5473
  5474     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5475
  5476     GO TO 99999-RETURN
  5477
  5478     .                                                            ERCNETP
  5479 12001-CHECK-DCC-MNET.                                            ERCNETP
  5480                                                                  ERCNETP
  5481     IF (CP-COMPANY-ID EQUAL 'DCC')
  5482        AND (CP-EARN-AS-NET-PAY)
  5483        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5484        CONTINUE                                                  ERCNETP
  5485     ELSE                                                         ERCNETP
  5486        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5487     END-IF
  5488
  5489*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5490*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5491*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5492                                                                  ERCNETP
  5493     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5494     MOVE WK3                    TO CP-CALC-PREMIUM
  5495
  5496     GO TO 99999-RETURN                                           ERCNETP
  5497
  5498     .                                                            ERCNETP
  5499 12001-CHECK-DCC-MNET-LF-BAL.
  5500                                                                  ERCNETP
  5501     IF (CP-COMPANY-ID EQUAL 'DCC')
  5502        AND (CP-EARN-AS-NET-PAY)
  5503        AND (CP-BENEFIT-CD (1:1) = 'N')
  5504        AND (CP-BEN-CATEGORY NOT = 'N')
  5505        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5506        CONTINUE                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 100
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5507     ELSE                                                         ERCNETP
  5508        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5509     END-IF
  5510
  5511     IF CP-RATE-DEV-PCT NOT = ZEROS
  5512        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5513           CP-PREMIUM-RATE
  5514     END-IF
  5515
  5516*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5517     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5518        / (1 + I)
  5519     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5520     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5521     COMPUTE WK2 = (1 + J) ** (M * -1)
  5522     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5523
  5524     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5525          ** ((M - 1) * -1))) / J)
  5526
  5527     COMPUTE ANGLEM = ((1 - ((1 + J)
  5528          ** (M * -1))) / J) / OD
  5529
  5530     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5531        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5532        / ANGLEM-1
  5533
  5534     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5535          ** ((N - M) * -1))) / I)
  5536
  5537     MOVE +0                     TO WK3
  5538     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5539        (WS-COUNTER > M)
  5540        COMPUTE ANGLEM = (1 - ((1 + J)
  5541          ** ((M - WS-COUNTER) * -1))) / J
  5542        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5543        COMPUTE WK5-CSL = (RA * ANGLEM)
  5544        + (CP-ALTERNATE-BENEFIT * WK2)
  5545        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5546     END-PERFORM
  5547
  5548     MOVE WK3                    TO CP-CALC-PREMIUM
  5549
  5550     GO TO 99999-RETURN                                           ERCNETP
  5551
  5552     .                                                            ERCNETP
  5553 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5554                                                                  ERCNETP
  5555     IF (CP-COMPANY-ID EQUAL 'DCC')
  5556        AND (CP-EARN-AS-NET-PAY)
  5557        AND (CP-BENEFIT-CD (1:1) = 'S')
  5558        AND (CP-BEN-CATEGORY NOT = 'N')
  5559        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5560        CONTINUE                                                  ERCNETP
  5561     ELSE                                                         ERCNETP
  5562        GO TO 12001-CHECK-DCC-MNET-LF
  5563     END-IF
  5564
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 101
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5565     IF CP-RATE-DEV-PCT NOT = ZEROS
  5566        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5567           CP-PREMIUM-RATE
  5568     END-IF
  5569
  5570     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5571
  5572     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5573          ** ((M - 1) * -1))) / K)
  5574
  5575     COMPUTE ANGLEM = ((1 - ((1 + K)
  5576          ** (M * -1))) / K)
  5577
  5578     MOVE CP-MONTHLY-PAYMENT     TO RA
  5579
  5580     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5581        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5582        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5583        CP-PREMIUM-RATE / 1000
  5584
  5585     MOVE WK3                    TO CP-CALC-PREMIUM
  5586
  5587
  5588     GO TO 99999-RETURN                                           ERCNETP
  5589
  5590     .                                                            ERCNETP
  5591 12001-CHECK-DCC-MNET-LF.
  5592                                                                  ERCNETP
  5593     IF (CP-COMPANY-ID EQUAL 'DCC')
  5594        AND (CP-EARN-AS-NET-PAY)
  5595        AND (CP-BENEFIT-CD (1:1) = 'N')
  5596        AND (CP-BEN-CATEGORY NOT = 'N')
  5597        CONTINUE                                                  ERCNETP
  5598     ELSE                                                         ERCNETP
  5599        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5600     END-IF
  5601
  5602     IF CP-RATE-DEV-PCT NOT = ZEROS
  5603        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5604           CP-PREMIUM-RATE
  5605     END-IF
  5606
  5607*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5608     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5609        / (1 + I)
  5610     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5611     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5612     COMPUTE WK2 = (1 + J) ** (M * -1)
  5613     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5614
  5615
  5616     COMPUTE ANGLEM = ((1 - ((1 + J)
  5617          ** (M * -1))) / J) / OD
  5618     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5619
  5620     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5621          ** ((N - M) * -1))) / I)
  5622
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 102
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5623     MOVE +0                     TO WK3
  5624     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5625        (WS-COUNTER > M)
  5626        COMPUTE ANGLEM = (1 - ((1 + J)
  5627          ** ((M - WS-COUNTER + 1) * -1))) / J
  5628        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5629        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5630        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5631     END-PERFORM
  5632
  5633     MOVE WK3                    TO CP-CALC-PREMIUM
  5634
  5635     GO TO 99999-RETURN                                           ERCNETP
  5636
  5637     .                                                            ERCNETP
  5638 12001-CHECK-DCC-MNET-SUMLF.
  5639                                                                  ERCNETP
  5640     IF (CP-COMPANY-ID EQUAL 'DCC')
  5641        AND (CP-EARN-AS-NET-PAY)
  5642        AND (CP-BENEFIT-CD (1:1) = 'S')
  5643        AND (CP-BEN-CATEGORY NOT = 'N')
  5644        CONTINUE                                                  ERCNETP
  5645     ELSE                                                         ERCNETP
  5646        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5647     END-IF
  5648
  5649     IF CP-RATE-DEV-PCT NOT = ZEROS
  5650        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5651           CP-PREMIUM-RATE
  5652     END-IF
  5653
  5654     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5655     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5656        / (1 + K)
  5657
  5658     COMPUTE ANGLEN-M = (WK5 / I)
  5659     COMPUTE WK2 = (1 + K) ** (M * -1)
  5660     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5661     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5662
  5663
  5664     COMPUTE ANGLEM = ((1 - ((1 + K)
  5665          ** (M * -1))) / K) / Y
  5666     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5667
  5668     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5669        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5670        - 1)) / K) * RA
  5671     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5672        + (CP-DAYS-TO-1ST-PMT - +30)
  5673        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5674        +0 / 1000 * 12 / 12)
  5675     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5676        * (12 / 12)
  5677
  5678
  5679     MOVE WK3                    TO CP-CALC-PREMIUM
  5680
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 103
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5681     GO TO 99999-RETURN                                           ERCNETP
  5682
  5683     .                                                            ERCNETP
  5684 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5685                                                                  ERCNETP
  5686     IF (CP-COMPANY-ID EQUAL 'DCC')
  5687        AND (CP-EARN-AS-NET-PAY)
  5688        AND (CP-BENEFIT-CD (1:1) = 'N')
  5689        AND (CP-BEN-CATEGORY = 'N')
  5690        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5691        CONTINUE                                                  ERCNETP
  5692     ELSE                                                         ERCNETP
  5693        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5694     END-IF
  5695
  5696*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5697     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5698        / (1 + I)
  5699     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5700     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5701     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5702     COMPUTE WK2 = (1 + J) ** (M * -1)
  5703     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5704
  5705     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5706          ** ((M - 1) * -1))) / J)
  5707
  5708     COMPUTE ANGLEM = ((1 - ((1 + J)
  5709          ** (M * -1))) / J) / OD
  5710
  5711     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5712        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5713        / ANGLEM-1
  5714
  5715     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5716          ** ((N - M) * -1))) / I)
  5717
  5718     MOVE +0                     TO WK3
  5719     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5720        (WS-COUNTER > M)
  5721        COMPUTE ANGLEM = (1 - ((1 + J)
  5722          ** ((M - WS-COUNTER) * -1))) / J
  5723        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5724        COMPUTE WK5-CSL = (RA * ANGLEM)
  5725        + (CP-ALTERNATE-BENEFIT * WK2)
  5726        COMPUTE WK3 = WK3 +
  5727         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5728        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5729          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5730          (CP-DCC-AH-RATE / 1000)
  5731     END-PERFORM
  5732
  5733     MOVE WK3                    TO CP-CALC-PREMIUM
  5734
  5735     GO TO 99999-RETURN                                           ERCNETP
  5736
  5737     .                                                            ERCNETP
  5738 12001-CHECK-DCC-MNET-TOT-BAL-S.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 104
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5739                                                                  ERCNETP
  5740     IF (CP-COMPANY-ID EQUAL 'DCC')
  5741        AND (CP-EARN-AS-NET-PAY)
  5742        AND (CP-BENEFIT-CD (1:1) = 'S')
  5743        AND (CP-BEN-CATEGORY = 'N')
  5744        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5745        CONTINUE                                                  ERCNETP
  5746     ELSE                                                         ERCNETP
  5747        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5748     END-IF
  5749
  5750
  5751     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5752
  5753     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5754          ** ((M - 1) * -1))) / K)
  5755
  5756     COMPUTE ANGLEM = ((1 - ((1 + K)
  5757          ** (M * -1))) / K)
  5758
  5759     MOVE CP-MONTHLY-PAYMENT     TO RA
  5760
  5761     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5762        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5763        * CP-DCC-AH-RATE / 1000))
  5764        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5765        CP-DCC-LF-RATE / 1000
  5766
  5767     MOVE WK3                    TO CP-LF-PREM
  5768
  5769     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5770        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5771        * CP-DCC-AH-RATE / 1000
  5772
  5773     COMPUTE WK3 = WK3 + WK5-CSL
  5774
  5775
  5776     MOVE WK3                    TO CP-CALC-PREMIUM
  5777
  5778     GO TO 99999-RETURN                                           ERCNETP
  5779
  5780      .
  5781 12001-CHECK-DCC-MNET-TOT-N.
  5782                                                                  ERCNETP
  5783     IF (CP-COMPANY-ID EQUAL 'DCC')
  5784        AND (CP-EARN-AS-NET-PAY)
  5785        AND (CP-BENEFIT-CD (1:1) = 'N')
  5786        AND (CP-BEN-CATEGORY = 'N')
  5787        CONTINUE                                                  ERCNETP
  5788     ELSE                                                         ERCNETP
  5789        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5790     END-IF
  5791
  5792*    I = APR/1200
  5793*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5794*    RA = PAYMENT AMOUNT
  5795*    WK5-CSL = THE BALANCE (PAY OFF )
  5796*    WK3 = THE ACCUMULATED PREMIUM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 105
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5797*    WK2 = (1 + I) ^ (m * -1)
  5798*    OD  = GAMMA
  5799*
  5800*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5801     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5802        / (1 + I)
  5803     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5804     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5805        (CP-DCC-AH-RATE / +1000)
  5806     COMPUTE WK2 = (1 + J) ** (M * -1)
  5807     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5808
  5809
  5810     COMPUTE ANGLEM = ((1 - ((1 + J)
  5811          ** (M * -1))) / J) / OD
  5812     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5813
  5814     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5815          ** ((N - M) * -1))) / I)
  5816
  5817     MOVE +0                     TO WK3
  5818     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5819        (WS-COUNTER > M)
  5820        COMPUTE ANGLEM = (1 - ((1 + J)
  5821          ** ((M - WS-COUNTER + 1) * -1))) / J
  5822        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5823        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5824        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5825           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5826     END-PERFORM
  5827
  5828     MOVE WK3                    TO CP-CALC-PREMIUM
  5829
  5830     GO TO 99999-RETURN                                           ERCNETP
  5831
  5832     .                                                            ERCNETP
  5833 12001-CHECK-DCC-MNET-TOT-S.
  5834                                                                  ERCNETP
  5835     IF (CP-COMPANY-ID EQUAL 'DCC')
  5836        AND (CP-EARN-AS-NET-PAY)
  5837        AND (CP-BENEFIT-CD (1:1) = 'S')
  5838        AND (CP-BEN-CATEGORY = 'N')
  5839        CONTINUE                                                  ERCNETP
  5840     ELSE                                                         ERCNETP
  5841        GO TO 12001-CONTINUE-NET
  5842     END-IF
  5843
  5844*    I = APR/1200
  5845*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5846*    RA = PAYMENT AMOUNT
  5847*    WK5-CSL = THE BALANCE (PAY OFF )
  5848*    WK3 = THE ACCUMULATED PREMIUM
  5849*    WK2 = (1 + I) ^ (m * -1)
  5850*    OD  = GAMMA
  5851*
  5852     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5853
  5854     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 106
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5855        / (1 + J)
  5856
  5857     COMPUTE ANGLEM = ((1 - ((1 + J)
  5858          ** (M * -1))) / J) / OD
  5859
  5860     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5861          ** ((N - M) * -1))) / I)
  5862          * (1 + J) ** (-1 * M)
  5863
  5864     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5865
  5866     MOVE CP-MONTHLY-PAYMENT     TO RA
  5867
  5868     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5869        / +30)
  5870     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5871        ** (WK1) - 1)) / J) * RA
  5872
  5873     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5874        + (CP-DAYS-TO-1ST-PMT - +30)
  5875        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5876        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5877
  5878     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5879        (12 / 12)
  5880
  5881     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5882        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5883        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5884
  5885     COMPUTE WK3 = WK3 + WK5-CSL
  5886     MOVE WK3                    TO CP-CALC-PREMIUM
  5887
  5888     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5889     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5890        / (1 + K)
  5891
  5892     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5893          ** ((N - M) * -1))) / I)
  5894     COMPUTE WK2 = (1 + K) ** (M * -1)
  5895     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5896     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5897
  5898
  5899     COMPUTE ANGLEM = ((1 - ((1 + K)
  5900          ** (M * -1))) / K) / Y
  5901
  5902*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5903
  5904     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5905        ((1 + K) ** (M + 1 / Y
  5906        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5907        - 1)) / K) * RA
  5908     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5909        + (CP-DAYS-TO-1ST-PMT - +30)
  5910        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5911        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5912     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 107
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5913        * (12 / 12)
  5914
  5915
  5916     MOVE WK3                    TO CP-LF-PREM
  5917
  5918
  5919
  5920     GO TO 99999-RETURN                                           ERCNETP
  5921
  5922     .                                                            ERCNETP
  5923 12001-CONTINUE-NET.                                              ERCNETP
  5924                                                                  ERCNETP
  5925     IF NET-STD                                                   ERCNETP
  5926        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  5927*          OR 'DCC'
  5928         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5929         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5930         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5931         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5932                               * ((1 + N) / (1 + M))
  5933         if (i = .0000000001)
  5934            and (wk3 = zeros)
  5935            move 1               to wk3
  5936         end-if
  5937        ELSE                                                      ERCNETP
  5938         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  5939         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  5940         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  5941         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  5942                                                                  ERCNETP
  5943     IF NET-SMP                                                   ERCNETP
  5944         COMPUTE N2 = N * N                                       ERCNETP
  5945         COMPUTE N3 = N2 * N                                      ERCNETP
  5946         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  5947         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  5948         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  5949         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
  5950         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  5951                                                                  ERCNETP
  5952     IF NPO-PRUDENTIAL                                            ERCNETP
  5953       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  5954           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  5955               UNTIL WS-COUNTER = N                               ERCNETP
  5956       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  5957       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  5958                                                                  ERCNETP
  5959     MOVE WK3 TO FACTOR.                                          ERCNETP
  5960
  5961                                                                  ERCNETP
  5962     GO TO 99999-RETURN.                                          ERCNETP
  5963                                                                  ERCNETP
  5964 12100-PRU-CALC.                                                  ERCNETP
  5965     IF WS-COUNTER = 1                                            ERCNETP
  5966         COMPUTE PWK = (I + 1)                                    ERCNETP
  5967     ELSE                                                         ERCNETP
  5968         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  5969                                                                  ERCNETP
  5970 12199-EXIT.                                                      ERCNETP
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 108
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5971      EXIT.                                                       ERCNETP
  5972                                                                  ERCNETP
  5973 99000-ERROR.                                                     ERCNETP
  5974     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  5975     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  5976                                                                  ERCNETP
  5977     GO TO 99999-EXIT.                                            ERCNETP
  5978                                                                  ERCNETP
  5979 99999-RETURN.                                                    ERCNETP
  5980     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  5981                                                                  ERCNETP
  5982 99999-EXIT.                                                      ERCNETP
  5983      EXIT.                                                       ERCNETP
  5984
  5985 99999-DUMMY-STOP-RUN.
  5986     GOBACK.
  5987
*
* Program-Id : ELRATEX
* Line   Data Name                       Address    Size      Attributes
* 000075 ER-RATE-REC . . . . . . . . . . 0000001248 00001765  FD G    AlphNum
* 000076 Filler. . . . . . . . . . . . . 0000001248 00000002  FD E    AlphNum
* 000077 ER-RATE-KEY . . . . . . . . . . 0000001250 00000028  FD E    AlphNum
* 000078 Filler. . . . . . . . . . . . . 0000001278 00001735  FD E    AlphNum
* 000081 OE-RATE-REC . . . . . . . . . . 0000003024 00001765  FD G    AlphNum
* 000082 Filler. . . . . . . . . . . . . 0000003024 00000002  FD E    AlphNum
* 000083 OE-RATE-KEY . . . . . . . . . . 0000003026 00000028  FD E    AlphNum
* 000084 Filler. . . . . . . . . . . . . 0000003054 00001735  FD E    AlphNum
* 000088 Filler. . . . . . . . . . . . . 0000004800 00000032  WS E    AlphNum
* 000089 Filler. . . . . . . . . . . . . 0000004832 00000032  WS E    AlphNum
* 000090 Filler. . . . . . . . . . . . . 0000004864 00000032  WS E    AlphNum
* 000102 STANDARD-AREAS. . . . . . . . . 0000004896 00000093  WS G    AlphNum
* 000103 ER-STATUS . . . . . . . . . . . 0000004896 00000002  WS E    AlphNum
* 000104 WS-BROWSE-SW. . . . . . . . . . 0000004898 00000001  WS E    AlphNum
* 000106 WS-PREMIUM-RATE . . . . . . . . 0000004899 00000004  WS E    Comp-3
* 000107 WS-FARM-TERM. . . . . . . . . . 0000004903 00000002  WS E    Comp-3
* 000108 OERATE-FILE-ID. . . . . . . . . 0000004905 00000008  WS E    AlphNum
* 000109 ERRATE-FILE-ID. . . . . . . . . 0000004913 00000008  WS E    AlphNum
* 000110 ERRATE-KEY. . . . . . . . . . . 0000004921 00000028  WS G    AlphNum
* 000111 RATE-COMPANY-CD . . . . . . . . 0000004921 00000001  WS E    AlphNum
* 000112 RATE-STATE-CODE . . . . . . . . 0000004922 00000007  WS G    AlphNum
* 000113 RATE-ST-CODE. . . . . . . . . . 0000004922 00000002  WS E    AlphNum
* 000114 RATE-ST-CLASS . . . . . . . . . 0000004924 00000002  WS E    AlphNum
* 000115 RATE-ST-DEV . . . . . . . . . . 0000004926 00000003  WS E    AlphNum
* 000116 RATE-L-AH-CODE. . . . . . . . . 0000004929 00000003  WS G    AlphNum
* 000117 RATE-L-AH . . . . . . . . . . . 0000004929 00000001  WS E    AlphNum
* 000118 RATE-LAH-NUM. . . . . . . . . . 0000004930 00000002  WS E    AlphNum
* 000119 RATE-LIMITS . . . . . . . . . . 0000004932 00000011  WS G    AlphNum
* 000120 RATE-HIGH-AGE . . . . . . . . . 0000004932 00000002  WS E    Display
* 000121 RATE-HIGH-AMT . . . . . . . . . 0000004934 00000006  WS E    Display
* 000122 RATE-FUTURE . . . . . . . . . . 0000004940 00000002  WS E    AlphNum
* 000123 RATE-SEX. . . . . . . . . . . . 0000004942 00000001  WS E    AlphNum
* 000124 RATE-EXPIRY-DATE. . . . . . . . 0000004943 00000006  WS E    Comp-3
* 000126 SAVE-ERRATE-KEY . . . . . . . . 0000004949 00000028  WS G    AlphNum
* 000127 SVRT-COMPANY-CD . . . . . . . . 0000004949 00000001  WS E    AlphNum
* 000128 SVRT-STATE-CODE . . . . . . . . 0000004950 00000007  WS G    AlphNum
* 000129 SVRT-ST-CODE. . . . . . . . . . 0000004950 00000002  WS E    AlphNum
* 000130 SVRT-ST-CLASS . . . . . . . . . 0000004952 00000002  WS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 109
* ELRATEX.cbl
* 000131 SVRT-ST-DEV . . . . . . . . . . 0000004954 00000003  WS E    AlphNum
* 000132 SVRT-L-AH-CODE. . . . . . . . . 0000004957 00000003  WS G    AlphNum
* 000133 SVRT-L-AH . . . . . . . . . . . 0000004957 00000001  WS E    AlphNum
* 000134 SVRT-LAH-NUM. . . . . . . . . . 0000004958 00000002  WS E    AlphNum
* 000135 SVRT-LIMITS . . . . . . . . . . 0000004960 00000011  WS G    AlphNum
* 000136 SVRT-HIGH-AGE . . . . . . . . . 0000004960 00000002  WS E    Display
* 000137 SVRT-HIGH-AMT . . . . . . . . . 0000004962 00000006  WS E    Display
* 000138 SVRT-FUTURE . . . . . . . . . . 0000004968 00000002  WS E    AlphNum
* 000139 SVRT-SEX. . . . . . . . . . . . 0000004970 00000001  WS E    AlphNum
* 000140 SVRT-EXPIRY-DATE. . . . . . . . 0000004971 00000006  WS E    Comp-3
* 000142 WS-SIN-PREM-RATE. . . . . . . . 0000004977 00000009  WS E    Display
* 000143 WS-TERM-MINUS-ONE . . . . . . . 0000004986 00000003  WS E    Comp-3
* 000145 CSL-WORK-AREAS. . . . . . . . . 0000004992 00000093  WS G    AlphNum
* 000146 WK-C. . . . . . . . . . . . . . 0000004992 00000007  WS E    Comp-3
* 000147 WK-D. . . . . . . . . . . . . . 0000004999 00000007  WS E    Comp-3
* 000148 WK-J. . . . . . . . . . . . . . 0000005006 00000002  WS E    Comp-3
* 000149 WK-K. . . . . . . . . . . . . . 0000005008 00000002  WS E    Comp-3
* 000150 WK-L. . . . . . . . . . . . . . 0000005010 00000006  WS E    Comp-3
* 000151 WK-S. . . . . . . . . . . . . . 0000005016 00000004  WS E    Comp-3
* 000152 WK-T. . . . . . . . . . . . . . 0000005020 00000002  WS E    Comp-3
* 000153 WK-T1 . . . . . . . . . . . . . 0000005022 00000002  WS E    Comp-3
* 000154 WK-U. . . . . . . . . . . . . . 0000005024 00000006  WS E    Comp-3
* 000155 WK-PREM . . . . . . . . . . . . 0000005030 00000005  WS E    Comp-3
* 000156 WK-PAY-AMT. . . . . . . . . . . 0000005035 00000005  WS E    Comp-3
* 000157 WK-LEV-RATE . . . . . . . . . . 0000005040 00000005  WS E    Comp-3
* 000158 WK-RED-RATE . . . . . . . . . . 0000005045 00000005  WS E    Comp-3
* 000159 WK-DAILY-RATE . . . . . . . . . 0000005050 00000005  WS E    Comp-3
* 000160 WK-MONTHLY-RATE . . . . . . . . 0000005055 00000005  WS E    Comp-3
* 000161 WK-MONTHLY-RATE-T . . . . . . . 0000005060 00000005  WS E    Comp-3
* 000162 WK-MONTHLY-RATE-J . . . . . . . 0000005065 00000005  WS E    Comp-3
* 000163 WS-MAX-TOT-BEN. . . . . . . . . 0000005070 00000005  WS E    Comp-3
* 000164 WS-MAX-MON-BEN. . . . . . . . . 0000005075 00000005  WS E    Comp-3
* 000165 WS-NUM-PAYMTS . . . . . . . . . 0000005080 00000003  WS E    Comp-3
* 000166 WS-PAY-SCH. . . . . . . . . . . 0000005083 00000002  WS E    Comp-3
* 000168 TEXAS-REG-WORK-AREAS. . . . . . 0000005088 00000033  WS G    AlphNum
* 000169 TEX-FACT-1. . . . . . . . . . . 0000005088 00000005  WS E    Comp-3
* 000170 TEX-FACT-2. . . . . . . . . . . 0000005093 00000002  WS E    Comp-3
* 000171 TEX-FACT-3. . . . . . . . . . . 0000005095 00000002  WS E    Comp-3
* 000172 TEX-FACT-4. . . . . . . . . . . 0000005097 00000004  WS E    Comp-3
* 000173 TEX-FACT-5. . . . . . . . . . . 0000005101 00000002  WS E    Comp-3
* 000174 TEX-FACT-6. . . . . . . . . . . 0000005103 00000002  WS E    Comp-3
* 000175 TEX-FACT-7. . . . . . . . . . . 0000005105 00000004  WS E    Comp-3
* 000176 TEX-FACT-8. . . . . . . . . . . 0000005109 00000004  WS E    Comp-3
* 000177 TEX-FACT-9. . . . . . . . . . . 0000005113 00000008  WS E    Comp-3
* 000179 NET-PAY-INTERFACE . . . . . . . 0000005128 00000018  WS G    AlphNum
* 000180 N-P-APR . . . . . . . . . . . . 0000005128 00000004  WS E    Comp-3
* 000181 N-P-ORIG. . . . . . . . . . . . 0000005132 00000002  WS E    Comp-3
* 000182 N-P-REM . . . . . . . . . . . . 0000005134 00000002  WS E    Comp-3
* 000183 N-P-OPT . . . . . . . . . . . . 0000005136 00000001  WS E    AlphNum
* 000184 N-P-LOAN. . . . . . . . . . . . 0000005137 00000002  WS E    Comp-3
* 000185 N-P-FACTOR. . . . . . . . . . . 0000005139 00000007  WS E    Comp-3
* 000213 NET-PAY-WORK-AREA . . . . . . . 0000005152 00000574  WS G    AlphNum
* 000214 OPTION-SW . . . . . . . . . . . 0000005152 00000001  WS E    AlphNum
* 000230 TYPE-SW . . . . . . . . . . . . 0000005153 00000001  WS E    AlphNum
* 000234 NP-PROCESS-SW . . . . . . . . . 0000005154 00000001  WS E    AlphNum
* 000239 COMP-3-WORK-AREA. . . . . . . . 0000005155 00000467  WS G    AlphNum
* 000240 WS-WORK-DIS-RATE. . . . . . . . 0000005155 00000005  WS E    Comp-3
* 000241 V . . . . . . . . . . . . . . . 0000005160 00000007  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 110
* ELRATEX.cbl
* 000242 J . . . . . . . . . . . . . . . 0000005167 00000005  WS E    Comp-3
* 000243 K . . . . . . . . . . . . . . . 0000005172 00000005  WS E    Comp-3
* 000244 I . . . . . . . . . . . . . . . 0000005177 00000006  WS E    Comp-3
* 000245 D . . . . . . . . . . . . . . . 0000005183 00000003  WS E    Comp-3
* 000246 APR100. . . . . . . . . . . . . 0000005186 00000005  WS E    Comp-3
* 000247 RA. . . . . . . . . . . . . . . 0000005191 00000008  WS E    Comp-3
* 000248 WK1 . . . . . . . . . . . . . . 0000005199 00000009  WS E    Comp-3
* 000249 WK2 . . . . . . . . . . . . . . 0000005208 00000009  WS E    Comp-3
* 000250 WK3 . . . . . . . . . . . . . . 0000005217 00000009  WS E    Comp-3
* 000251 WK4 . . . . . . . . . . . . . . 0000005226 00000008  WS E    Comp-3
* 000252 WK5 . . . . . . . . . . . . . . 0000005234 00000010  WS E    Comp-3
* 000253 WK5-CSL . . . . . . . . . . . . 0000005244 00000008  WS E    Comp-3
* 000254 WK6 . . . . . . . . . . . . . . 0000005252 00000009  WS E    Comp-3
* 000255 WK7 . . . . . . . . . . . . . . 0000005261 00000009  WS E    Comp-3
* 000256 WK8 . . . . . . . . . . . . . . 0000005270 00000007  WS E    Comp-3
* 000257 WK9 . . . . . . . . . . . . . . 0000005277 00000007  WS E    Comp-3
* 000258 GR. . . . . . . . . . . . . . . 0000005284 00000009  WS E    Comp-3
* 000259 ONE-PLUS-I. . . . . . . . . . . 0000005293 00000007  WS E    Comp-3
* 000260 ODF . . . . . . . . . . . . . . 0000005300 00000007  WS E    Comp-3
* 000261 OD. . . . . . . . . . . . . . . 0000005307 00000007  WS E    Comp-3
* 000262 FM. . . . . . . . . . . . . . . 0000005314 00000007  WS E    Comp-3
* 000263 FN. . . . . . . . . . . . . . . 0000005321 00000007  WS E    Comp-3
* 000264 FNM . . . . . . . . . . . . . . 0000005328 00000007  WS E    Comp-3
* 000265 ANGLEM. . . . . . . . . . . . . 0000005335 00000010  WS E    Comp-3
* 000266 ANGLEMP1. . . . . . . . . . . . 0000005345 00000010  WS E    Comp-3
* 000267 ANGLEN. . . . . . . . . . . . . 0000005355 00000010  WS E    Comp-3
* 000268 ANGLEN-M. . . . . . . . . . . . 0000005365 00000010  WS E    Comp-3
* 000269 ANGLEN-1. . . . . . . . . . . . 0000005375 00000009  WS E    Comp-3
* 000270 ANGLEM-1. . . . . . . . . . . . 0000005384 00000009  WS E    Comp-3
* 000271 ANGLEM-T. . . . . . . . . . . . 0000005393 00000010  WS E    Comp-3
* 000272 TRUNC-PMT . . . . . . . . . . . 0000005403 00000005  WS E    Comp-3
* 000273 K1. . . . . . . . . . . . . . . 0000005408 00000002  WS E    Comp-3
* 000274 K12 . . . . . . . . . . . . . . 0000005410 00000002  WS E    Comp-3
* 000275 K100. . . . . . . . . . . . . . 0000005412 00000002  WS E    Comp-3
* 000276 K1000 . . . . . . . . . . . . . 0000005414 00000004  WS E    Comp-3
* 000277 NC-LR . . . . . . . . . . . . . 0000005418 00000004  WS E    Comp-3
* 000278 Y . . . . . . . . . . . . . . . 0000005418 00000004  WS E    Comp-3     R
* 000280 TI. . . . . . . . . . . . . . . 0000005422 00000005  WS E    Comp-3
* 000281 NC-R. . . . . . . . . . . . . . 0000005427 00000009  WS E    Comp-3
* 000282 NC-OB . . . . . . . . . . . . . 0000005436 00000009  WS E    Comp-3
* 000283 NC-P. . . . . . . . . . . . . . 0000005445 00000009  WS E    Comp-3
* 000284 NC-D. . . . . . . . . . . . . . 0000005454 00000009  WS E    Comp-3
* 000285 NC-BIG-D. . . . . . . . . . . . 0000005463 00000002  WS E    Comp-3
* 000286 NC-LITTLE-D . . . . . . . . . . 0000005465 00000005  WS E    Comp-3
* 000287 NC-MP . . . . . . . . . . . . . 0000005470 00000004  WS E    Comp-3
* 000288 NC-LP . . . . . . . . . . . . . 0000005474 00000004  WS E    Comp-3
* 000290 CA-MP . . . . . . . . . . . . . 0000005478 00000004  WS E    Comp-3
* 000291 CA-API. . . . . . . . . . . . . 0000005482 00000006  WS E    Comp-3
* 000292 CA-APJ. . . . . . . . . . . . . 0000005488 00000006  WS E    Comp-3
* 000293 CA-VI . . . . . . . . . . . . . 0000005494 00000006  WS E    Comp-3
* 000294 CA-J. . . . . . . . . . . . . . 0000005500 00000006  WS E    Comp-3
* 000295 CA-DISCOUNT . . . . . . . . . . 0000005506 00000006  WS E    Comp-3
* 000296 GTL-IA-DIVIDEND . . . . . . . . 0000005512 00000007  WS E    Comp-3
* 000297 GTL-IA-DIVISOR. . . . . . . . . 0000005519 00000007  WS E    Comp-3
* 000298 GTL-IA-FACTOR . . . . . . . . . 0000005526 00000007  WS E    Comp-3
* 000299 GTL-IA-ODF. . . . . . . . . . . 0000005533 00000007  WS E    Comp-3
* 000300 GTL-IA-ODD-DAYS . . . . . . . . 0000005540 00000002  WS E    Comp-3
* 000301 GTL-IA-SGN. . . . . . . . . . . 0000005542 00000001  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 111
* ELRATEX.cbl
* 000302 GTL-IA-ABS. . . . . . . . . . . 0000005543 00000002  WS E    Comp-3
* 000304 ANNUAL-INT-RATE . . . . . . . . 0000005545 00000004  WS E    Comp-3
* 000306 ORIGINAL-TERM . . . . . . . . . 0000005549 00000002  WS E    Comp-3
* 000307 M . . . . . . . . . . . . . . . 0000005549 00000002  WS E    Comp-3     R
* 000310 REMAINING-TERM. . . . . . . . . 0000005551 00000002  WS E    Comp-3
* 000311 R . . . . . . . . . . . . . . . 0000005551 00000002  WS E    Comp-3     R
* 000314 LOAN-TERM . . . . . . . . . . . 0000005553 00000002  WS E    Comp-3
* 000315 N . . . . . . . . . . . . . . . 0000005553 00000002  WS E    Comp-3     R
* 000318 EXPIRED-TERM. . . . . . . . . . 0000005555 00000002  WS E    Comp-3
* 000319 E . . . . . . . . . . . . . . . 0000005555 00000002  WS E    Comp-3     R
* 000322 PRUDENTIAL-WORK-AMT . . . . . . 0000005557 00000008  WS E    Comp-3
* 000324 PWK . . . . . . . . . . . . . . 0000005557 00000008  WS E    Comp-3     R
* 000327 FACTOR. . . . . . . . . . . . . 0000005565 00000007  WS E    Comp-3
* 000328 VX. . . . . . . . . . . . . . . 0000005572 00000008  WS E    Comp-3
* 000329 SV. . . . . . . . . . . . . . . 0000005580 00000008  WS E    Comp-3
* 000330 SV-MINUS-ONE. . . . . . . . . . 0000005588 00000007  WS E    Comp-3
* 000331 SX. . . . . . . . . . . . . . . 0000005595 00000008  WS E    Comp-3
* 000332 SE. . . . . . . . . . . . . . . 0000005603 00000006  WS E    Comp-3
* 000333 N2. . . . . . . . . . . . . . . 0000005609 00000004  WS E    Comp-3
* 000334 N3. . . . . . . . . . . . . . . 0000005613 00000004  WS E    Comp-3
* 000335 K-I . . . . . . . . . . . . . . 0000005617 00000005  WS E    Comp-3
* 000337 BINARY-WORK-AREA. . . . . . . . 0000005622 00000016  WS G    AlphNum
* 000338 X1. . . . . . . . . . . . . . . 0000005622 00000002  WS E    Comp
* 000339 X2. . . . . . . . . . . . . . . 0000005624 00000002  WS E    Comp
* 000340 MAX-X . . . . . . . . . . . . . 0000005626 00000004  WS E    Comp
* 000341 B1. . . . . . . . . . . . . . . 0000005630 00000004  WS E    Comp
* 000342 LINDX . . . . . . . . . . . . . 0000005634 00000002  WS E    Comp
* 000343 AHNDX . . . . . . . . . . . . . 0000005636 00000002  WS E    Comp
* 000345 CSO-RATE-WORK-AREAS . . . . . . 0000005638 00000006  WS G    AlphNum
* 000346 C-PMTS-PER-YEAR . . . . . . . . 0000005638 00000002  WS E    Comp-3
* 000347 C-DAYS-IN-PMT-PER . . . . . . . 0000005640 00000002  WS E    Comp-3
* 000348 C-TOT-PMTS. . . . . . . . . . . 0000005642 00000002  WS E    Comp-3
* 000350 WS-WORK-MISC. . . . . . . . . . 0000005644 00000082  WS G    AlphNum
* 000351 WS-EXTRA-PMTS . . . . . . . . . 0000005644 00000002  WS E    Comp-3
* 000352 NET-BEN . . . . . . . . . . . . 0000005646 00000007  WS E    Comp-3
* 000353 WS-RATE-TERM. . . . . . . . . . 0000005653 00000002  WS E    Comp-3
* 000355 WS-AGE. . . . . . . . . . . . . 0000005655 00000003  WS E    Comp-3
* 000356 WS-AH-FACE-BENEFIT. . . . . . . 0000005658 00000004  WS E    Comp-3
* 000357 WS-COUNTER. . . . . . . . . . . 0000005662 00000002  WS E    Comp-3
* 000358 WS-WORK-RATE. . . . . . . . . . 0000005664 00000006  WS E    Comp-3
* 000359 WS-DISCOUNT-OPTION. . . . . . . 0000005670 00000001  WS E    AlphNum
* 000360 WS-DUE-DATE . . . . . . . . . . 0000005671 00000004  WS E    Comp-3
* 000361 WS-INT-BEGIN-DATE . . . . . . . 0000005675 00000004  WS E    Comp-3
* 000362 WS-X-Y-FACTOR . . . . . . . . . 0000005679 00000010  WS E    Comp-3
* 000363 WS-Y-X-FACTOR . . . . . . . . . 0000005689 00000010  WS E    Comp-3
* 000364 WS-ODD-DAY-UNITS. . . . . . . . 0000005699 00000010  WS E    Comp-3
* 000365 WS-CALC-FREQ-RATE . . . . . . . 0000005709 00000009  WS E    Comp-3
* 000366 WS-NP-FACTOR. . . . . . . . . . 0000005718 00000008  WS E    Comp-3
* 000383 DATE-CONVERSION-DATA. . . . . . 0000005728 00000200  WS G    AlphNum
* 000384 DC-COMM-LENGTH. . . . . . . . . 0000005728 00000002  WS E    Comp
* 000385 DC-OPTION-CODE. . . . . . . . . 0000005730 00000001  WS E    AlphNum
* 000422 DC-ERROR-CODE . . . . . . . . . 0000005731 00000001  WS E    AlphNum
* 000436 DC-END-OF-MONTH . . . . . . . . 0000005732 00000001  WS E    AlphNum
* 000438 DC-CENTURY-ADJUSTMENT . . . . . 0000005733 00000001  WS E    AlphNum
* 000442 Filler. . . . . . . . . . . . . 0000005734 00000001  WS E    AlphNum
* 000443 DC-CONVERSION-DATES . . . . . . 0000005735 00000065  WS G    AlphNum
* 000444 DC-BIN-DATE-1 . . . . . . . . . 0000005735 00000002  WS E    AlphNum
* 000445 DC-BIN-DATE-2 . . . . . . . . . 0000005737 00000002  WS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 112
* ELRATEX.cbl
* 000446 DC-GREG-DATE-1-EDIT . . . . . . 0000005739 00000008  WS E    AlphNum
* 000447 DC-GREG-DATE-1-EDIT-R . . . . . 0000005739 00000008  WS G    AlphNum    R
* 000449 DC-EDIT1-MONTH. . . . . . . . . 0000005739 00000002  WS E    Display
* 000450 SLASH1-1. . . . . . . . . . . . 0000005741 00000001  WS E    AlphNum
* 000451 DC-EDIT1-DAY. . . . . . . . . . 0000005742 00000002  WS E    Display
* 000452 SLASH1-2. . . . . . . . . . . . 0000005744 00000001  WS E    AlphNum
* 000453 DC-EDIT1-YEAR . . . . . . . . . 0000005745 00000002  WS E    Display
* 000454 DC-GREG-DATE-2-EDIT . . . . . . 0000005747 00000008  WS E    AlphNum
* 000455 DC-GREG-DATE-2-EDIT-R . . . . . 0000005747 00000008  WS G    AlphNum    R
* 000457 DC-EDIT2-MONTH. . . . . . . . . 0000005747 00000002  WS E    Display
* 000458 SLASH2-1. . . . . . . . . . . . 0000005749 00000001  WS E    AlphNum
* 000459 DC-EDIT2-DAY. . . . . . . . . . 0000005750 00000002  WS E    Display
* 000460 SLASH2-2. . . . . . . . . . . . 0000005752 00000001  WS E    AlphNum
* 000461 DC-EDIT2-YEAR . . . . . . . . . 0000005753 00000002  WS E    Display
* 000462 DC-GREG-DATE-1-YMD. . . . . . . 0000005755 00000006  WS E    Display
* 000463 DC-GREG-DATE-1-YMD-R. . . . . . 0000005755 00000006  WS G    AlphNum    R
* 000465 DC-YMD-YEAR . . . . . . . . . . 0000005755 00000002  WS E    Display
* 000466 DC-YMD-MONTH. . . . . . . . . . 0000005757 00000002  WS E    Display
* 000467 DC-YMD-DAY. . . . . . . . . . . 0000005759 00000002  WS E    Display
* 000468 DC-GREG-DATE-1-MDY. . . . . . . 0000005761 00000006  WS E    Display
* 000469 DC-GREG-DATE-1-MDY-R. . . . . . 0000005761 00000006  WS G    AlphNum    R
* 000471 DC-MDY-MONTH. . . . . . . . . . 0000005761 00000002  WS E    Display
* 000472 DC-MDY-DAY. . . . . . . . . . . 0000005763 00000002  WS E    Display
* 000473 DC-MDY-YEAR . . . . . . . . . . 0000005765 00000002  WS E    Display
* 000474 DC-GREG-DATE-1-ALPHA. . . . . . 0000005767 00000018  WS G    AlphNum
* 000475 DC-ALPHA-MONTH. . . . . . . . . 0000005767 00000010  WS E    AlphNum
* 000476 DC-ALPHA-DAY. . . . . . . . . . 0000005777 00000002  WS E    Display
* 000477 Filler. . . . . . . . . . . . . 0000005779 00000002  WS E    AlphNum
* 000478 DC-ALPHA-CENTURY. . . . . . . . 0000005781 00000002  WS G    AlphNum
* 000479 DC-ALPHA-CEN-N. . . . . . . . . 0000005781 00000002  WS E    Display
* 000480 DC-ALPHA-YEAR . . . . . . . . . 0000005783 00000002  WS E    Display
* 000481 DC-ELAPSED-MONTHS . . . . . . . 0000005785 00000002  WS E    Comp
* 000482 DC-ODD-DAYS-OVER. . . . . . . . 0000005787 00000002  WS E    Comp
* 000483 DC-ELAPSED-DAYS . . . . . . . . 0000005789 00000002  WS E    Comp
* 000484 DC-JULIAN-DATE. . . . . . . . . 0000005791 00000005  WS E    Display
* 000485 DC-JULIAN-YYDDD . . . . . . . . 0000005791 00000005  WS E    Display    R
* 000487 DC-JULIAN-DT. . . . . . . . . . 0000005791 00000005  WS G    AlphNum    R
* 000488 DC-JULIAN-YEAR. . . . . . . . . 0000005791 00000002  WS E    Display
* 000489 DC-JULIAN-DAYS. . . . . . . . . 0000005793 00000003  WS E    Display
* 000490 DC-DAYS-IN-MONTH. . . . . . . . 0000005796 00000002  WS E    Comp-3
* 000491 DC-DAY-OF-WEEK. . . . . . . . . 0000005798 00000001  WS E    Comp-3
* 000492 DC-DAY-OF-WEEK2 . . . . . . . . 0000005799 00000001  WS E    Comp-3
* 000493 DATE-CONVERSION-VARIBLES. . . . 0000005800 00000078  WS G    AlphNum
* 000494 HOLD-CENTURY-1. . . . . . . . . 0000005800 00000011  WS E    Display
* 000495 HOLD-CENTURY-1-SPLIT. . . . . . 0000005800 00000011  WS G    AlphNum    R
* 000496 Filler. . . . . . . . . . . . . 0000005800 00000003  WS E    Display
* 000497 HOLD-CEN-1-CCYY . . . . . . . . 0000005803 00000004  WS G    AlphNum
* 000498 HOLD-CEN-1-CC . . . . . . . . . 0000005803 00000002  WS E    Display
* 000499 HOLD-CEN-1-YY . . . . . . . . . 0000005805 00000002  WS E    Display
* 000500 HOLD-CEN-1-MO . . . . . . . . . 0000005807 00000002  WS E    Display
* 000501 HOLD-CEN-1-DA . . . . . . . . . 0000005809 00000002  WS E    Display
* 000502 HOLD-CENTURY-1-R. . . . . . . . 0000005800 00000011  WS G    AlphNum    R
* 000503 HOLD-CEN-1-R-MO . . . . . . . . 0000005800 00000002  WS E    Display
* 000504 HOLD-CEN-1-R-DA . . . . . . . . 0000005802 00000002  WS E    Display
* 000505 HOLD-CEN-1-R-CCYY . . . . . . . 0000005804 00000004  WS G    AlphNum
* 000506 HOLD-CEN-1-R-CC . . . . . . . . 0000005804 00000002  WS E    Display
* 000507 HOLD-CEN-1-R-YY . . . . . . . . 0000005806 00000002  WS E    Display
* 000508 Filler. . . . . . . . . . . . . 0000005808 00000003  WS E    Display
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 113
* ELRATEX.cbl
* 000509 HOLD-CENTURY-1-X. . . . . . . . 0000005811 00000011  WS G    AlphNum
* 000510 Filler. . . . . . . . . . . . . 0000005811 00000003  WS E    AlphNum
* 000511 HOLD-CEN-1-X-CCYY . . . . . . . 0000005814 00000004  WS G    AlphNum
* 000512 HOLD-CEN-1-X-CC . . . . . . . . 0000005814 00000002  WS E    AlphNum
* 000513 HOLD-CEN-1-X-YY . . . . . . . . 0000005816 00000002  WS E    AlphNum
* 000514 HOLD-CEN-1-X-MO . . . . . . . . 0000005818 00000002  WS E    AlphNum
* 000515 HOLD-CEN-1-X-DA . . . . . . . . 0000005820 00000002  WS E    AlphNum
* 000516 HOLD-CENTURY-1-R-X. . . . . . . 0000005811 00000011  WS G    AlphNum    R
* 000517 HOLD-CEN-1-R-X-MO . . . . . . . 0000005811 00000002  WS E    AlphNum
* 000518 HOLD-CEN-1-R-X-DA . . . . . . . 0000005813 00000002  WS E    AlphNum
* 000519 HOLD-CEN-1-R-X-CCYY . . . . . . 0000005815 00000004  WS G    AlphNum
* 000520 HOLD-CEN-1-R-X-CC . . . . . . . 0000005815 00000002  WS E    AlphNum
* 000521 HOLD-CEN-1-R-X-YY . . . . . . . 0000005817 00000002  WS E    AlphNum
* 000522 Filler. . . . . . . . . . . . . 0000005819 00000003  WS E    AlphNum
* 000523 DC-BIN-DATE-EXPAND-1. . . . . . 0000005822 00000003  WS E    AlphNum
* 000524 DC-BIN-DATE-EXPAND-2. . . . . . 0000005825 00000003  WS E    AlphNum
* 000525 DC-JULIAN-DATE-1. . . . . . . . 0000005828 00000007  WS E    Display
* 000526 DC-JULIAN-DATE-1-R. . . . . . . 0000005828 00000007  WS G    AlphNum    R
* 000527 DC-JULIAN-1-CCYY. . . . . . . . 0000005828 00000004  WS G    AlphNum
* 000528 DC-JULIAN-1-CC. . . . . . . . . 0000005828 00000002  WS E    Display
* 000529 DC-JULIAN-1-YR. . . . . . . . . 0000005830 00000002  WS E    Display
* 000530 DC-JULIAN-DA-1. . . . . . . . . 0000005832 00000003  WS E    Display
* 000531 DC-JULIAN-DATE-2. . . . . . . . 0000005835 00000007  WS E    Display
* 000532 DC-JULIAN-DATE-2-R. . . . . . . 0000005835 00000007  WS G    AlphNum    R
* 000533 DC-JULIAN-2-CCYY. . . . . . . . 0000005835 00000004  WS G    AlphNum
* 000534 DC-JULIAN-2-CC. . . . . . . . . 0000005835 00000002  WS E    Display
* 000535 DC-JULIAN-2-YR. . . . . . . . . 0000005837 00000002  WS E    Display
* 000536 DC-JULIAN-DA-2. . . . . . . . . 0000005839 00000003  WS E    Display
* 000537 DC-GREG-DATE-A-EDIT . . . . . . 0000005842 00000010  WS G    AlphNum
* 000538 DC-EDITA-MONTH. . . . . . . . . 0000005842 00000002  WS E    Display
* 000539 SLASHA-1. . . . . . . . . . . . 0000005844 00000001  WS E    AlphNum
* 000540 DC-EDITA-DAY. . . . . . . . . . 0000005845 00000002  WS E    Display
* 000541 SLASHA-2. . . . . . . . . . . . 0000005847 00000001  WS E    AlphNum
* 000542 DC-EDITA-CCYY . . . . . . . . . 0000005848 00000004  WS G    AlphNum
* 000543 DC-EDITA-CENT . . . . . . . . . 0000005848 00000002  WS E    Display
* 000544 DC-EDITA-YEAR . . . . . . . . . 0000005850 00000002  WS E    Display
* 000545 DC-GREG-DATE-B-EDIT . . . . . . 0000005852 00000010  WS G    AlphNum
* 000546 DC-EDITB-MONTH. . . . . . . . . 0000005852 00000002  WS E    Display
* 000547 SLASHB-1. . . . . . . . . . . . 0000005854 00000001  WS E    AlphNum
* 000548 DC-EDITB-DAY. . . . . . . . . . 0000005855 00000002  WS E    Display
* 000549 SLASHB-2. . . . . . . . . . . . 0000005857 00000001  WS E    AlphNum
* 000550 DC-EDITB-CCYY . . . . . . . . . 0000005858 00000004  WS G    AlphNum
* 000551 DC-EDITB-CENT . . . . . . . . . 0000005858 00000002  WS E    Display
* 000552 DC-EDITB-YEAR . . . . . . . . . 0000005860 00000002  WS E    Display
* 000553 DC-GREG-DATE-CYMD . . . . . . . 0000005862 00000008  WS E    Display
* 000554 DC-GREG-DATE-CYMD-R . . . . . . 0000005862 00000008  WS G    AlphNum    R
* 000556 DC-CYMD-CEN . . . . . . . . . . 0000005862 00000002  WS E    Display
* 000557 DC-CYMD-YEAR. . . . . . . . . . 0000005864 00000002  WS E    Display
* 000558 DC-CYMD-MONTH . . . . . . . . . 0000005866 00000002  WS E    Display
* 000559 DC-CYMD-DAY . . . . . . . . . . 0000005868 00000002  WS E    Display
* 000560 DC-GREG-DATE-MDCY . . . . . . . 0000005870 00000008  WS E    Display
* 000561 DC-GREG-DATE-MDCY-R . . . . . . 0000005870 00000008  WS G    AlphNum    R
* 000563 DC-MDCY-MONTH . . . . . . . . . 0000005870 00000002  WS E    Display
* 000564 DC-MDCY-DAY . . . . . . . . . . 0000005872 00000002  WS E    Display
* 000565 DC-MDCY-CEN . . . . . . . . . . 0000005874 00000002  WS E    Display
* 000566 DC-MDCY-YEAR. . . . . . . . . . 0000005876 00000002  WS E    Display
* 000567 DC-FORCE-EL310-DATE-SW. . . . . 0000005878 00000001  WS E    AlphNum
* 000569 DC-EL310-DATE . . . . . . . . . 0000005879 00000021  WS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 114
* ELRATEX.cbl
* 000570 Filler. . . . . . . . . . . . . 0000005900 00000028  WS E    AlphNum
* 000595 RATE-RECORD . . . . . . . . . . 0000005928 00001765  WS G    AlphNum
* 000596 RT-RECORD-ID. . . . . . . . . . 0000005928 00000002  WS E    AlphNum
* 000599 RT-CONTROL-PRIMARY. . . . . . . 0000005930 00000028  WS G    AlphNum
* 000600 RT-COMPANY-CD . . . . . . . . . 0000005930 00000001  WS E    AlphNum
* 000601 RT-STATE-CODE . . . . . . . . . 0000005931 00000007  WS G    AlphNum
* 000602 RT-ST-CODE. . . . . . . . . . . 0000005931 00000002  WS E    AlphNum
* 000603 RT-ST-CLASS . . . . . . . . . . 0000005933 00000002  WS E    AlphNum
* 000604 RT-ST-DEV . . . . . . . . . . . 0000005935 00000003  WS E    AlphNum
* 000605 RT-L-AH-CODE. . . . . . . . . . 0000005938 00000003  WS G    AlphNum
* 000606 RT-L-AH . . . . . . . . . . . . 0000005938 00000001  WS E    AlphNum
* 000607 RT-LAH-NUM. . . . . . . . . . . 0000005939 00000002  WS E    AlphNum
* 000608 RT-LIMITS . . . . . . . . . . . 0000005941 00000011  WS G    AlphNum
* 000609 RT-HIGH-AGE . . . . . . . . . . 0000005941 00000002  WS E    Display
* 000610 RT-HIGH-AMT . . . . . . . . . . 0000005943 00000006  WS E    Display
* 000611 RT-FUTURE . . . . . . . . . . . 0000005949 00000002  WS E    AlphNum
* 000612 RT-SEX. . . . . . . . . . . . . 0000005951 00000001  WS E    AlphNum
* 000613 RT-EXPIRY-DATE. . . . . . . . . 0000005952 00000006  WS E    Comp-3
* 000615 RT-MAINT-INFORMATION. . . . . . 0000005958 00000020  WS G    AlphNum
* 000616 RT-LAST-MAINT-DT. . . . . . . . 0000005958 00000002  WS E    AlphNum
* 000617 RT-LAST-MAINT-HHMMSS. . . . . . 0000005960 00000004  WS E    Comp-3
* 000618 RT-LAST-MAINT-USER. . . . . . . 0000005964 00000004  WS E    AlphNum
* 000619 Filler. . . . . . . . . . . . . 0000005968 00000010  WS E    AlphNum
* 000621 RT-STRUCTURE-COMMENT. . . . . . 0000005978 00000050  WS E    AlphNum
* 000622 RT-RATE-COMMENT . . . . . . . . 0000006028 00000050  WS E    AlphNum
* 000624 CSL-RESERVED. . . . . . . . . . 0000006078 00000010  WS E    AlphNum
* 000625 Filler. . . . . . . . . . . . . 0000006088 00000012  WS E    AlphNum
* 000627 RT-MAX-AGE. . . . . . . . . . . 0000006100 00000002  WS E    Display
* 000629 RT-LIFE-LIMS-FLDS . . . . . . . 0000006102 00000088  WS G    AlphNum
* 000630 RT-LIFE-MORT-CODE . . . . . . . 0000006102 00000004  WS E    AlphNum
* 000631 RT-LIFE-EXCEPTIONS. . . . . . . 0000006106 00000008  WS GO   AlphNum
* 000632 RT-L-EX-AGE . . . . . . . . . . 0000006106 00000002  WS ESO  Display
* 000633 RT-L-EX-TERM. . . . . . . . . . 0000006108 00000002  WS ESO  Comp-3
* 000634 RT-L-EX-FACE. . . . . . . . . . 0000006110 00000004  WS ESO  Comp-3
* 000635 Filler. . . . . . . . . . . . . 0000006170 00000020  WS E    AlphNum
* 000637 RT-AH-LIMS-FLDS . . . . . . . . 0000006102 00000088  WS G    AlphNum    R
* 000638 RT-AH-EXCEPTIONS. . . . . . . . 0000006102 00000011  WS GO   AlphNum
* 000639 RT-AH-AGE . . . . . . . . . . . 0000006102 00000002  WS ESO  Display
* 000640 RT-AH-TERM. . . . . . . . . . . 0000006104 00000002  WS ESO  Comp-3
* 000641 RT-AH-BEN-M . . . . . . . . . . 0000006106 00000003  WS ESO  Comp-3
* 000642 RT-AH-BEN-F . . . . . . . . . . 0000006109 00000004  WS ESO  Comp-3
* 000644 RT-LIFE-RATES . . . . . . . . . 0000006190 00001440  WS G    AlphNum
* 000645 RT-L-RATE . . . . . . . . . . . 0000006190 00000004  WS EO   Comp-3
* 000647 RT-AH-RATES . . . . . . . . . . 0000006190 00001440  WS G    AlphNum    R
* 000648 RT-AH-RATE. . . . . . . . . . . 0000006190 00000004  WS EO   Comp-3
* 000650 RT-DAILY-RATE . . . . . . . . . 0000007630 00000004  WS E    Comp-3
* 000652 RT-DISCOUNT-OPTION. . . . . . . 0000007634 00000001  WS E    AlphNum
* 000657 RT-DISCOUNT-RATE. . . . . . . . 0000007635 00000004  WS E    Comp-3
* 000658 RT-DISCOUNT-OB-RATE . . . . . . 0000007639 00000004  WS E    Comp-3
* 000660 RT-COMPOSITE-OPTION . . . . . . 0000007643 00000001  WS E    AlphNum
* 000664 RT-COMPOSITE-RATE . . . . . . . 0000007644 00000004  WS E    Comp-3
* 000666 RT-POLICY-FEE . . . . . . . . . 0000007648 00000003  WS E    Comp-3
* 000667 Filler. . . . . . . . . . . . . 0000007651 00000013  WS E    AlphNum
* 000669 RT-TYPE-RATE. . . . . . . . . . 0000007664 00000001  WS E    AlphNum
* 000673 RT-SRT-ALPHA. . . . . . . . . . 0000007665 00000001  WS E    AlphNum
* 000675 RT-CONTROL-2. . . . . . . . . . 0000007666 00000027  WS G    AlphNum
* 000676 RTC-1 . . . . . . . . . . . . . 0000007666 00000007  WS E    AlphNum
* 000677 RTC-3 . . . . . . . . . . . . . 0000007673 00000011  WS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 115
* ELRATEX.cbl
* 000678 RTC-4 . . . . . . . . . . . . . 0000007684 00000006  WS E    Comp-3
* 000679 RTC-2 . . . . . . . . . . . . . 0000007690 00000003  WS E    AlphNum
* 000873 CALCULATION-PASS-AREA . . . . . 0000000000 00000450  LS G    AlphNum
* 000874 CP-COMM-LENGTH. . . . . . . . . 0000000000 00000002  LS E    Comp
* 000877 CP-RETURN-CODE. . . . . . . . . 0000000002 00000001  LS E    AlphNum
* 000899 CP-RETURN-CODE-2. . . . . . . . 0000000003 00000001  LS E    AlphNum
* 000903 CP-CALCULATION-AREA . . . . . . 0000000004 00000446  LS G    AlphNum
* 000904 CP-ACCOUNT-NUMBER . . . . . . . 0000000004 00000010  LS E    AlphNum
* 000905 CP-CERT-EFF-DT. . . . . . . . . 0000000014 00000002  LS E    AlphNum
* 000906 CP-VALUATION-DT . . . . . . . . 0000000016 00000002  LS E    AlphNum
* 000907 CP-PAID-THRU-DT . . . . . . . . 0000000018 00000002  LS E    AlphNum
* 000908 CP-BENEFIT-TYPE . . . . . . . . 0000000020 00000001  LS E    AlphNum
* 000913 CP-INCURRED-DT. . . . . . . . . 0000000021 00000002  LS E    AlphNum
* 000914 CP-REPORTED-DT. . . . . . . . . 0000000023 00000002  LS E    AlphNum
* 000915 CP-ACCT-FLD-5 . . . . . . . . . 0000000025 00000002  LS E    AlphNum
* 000916 CP-COMPANY-ID . . . . . . . . . 0000000027 00000003  LS E    AlphNum
* 000917 CP-ISSUE-AGE. . . . . . . . . . 0000000030 00000002  LS E    Comp-3
* 000919 CP-CDT-PERCENT. . . . . . . . . 0000000032 00000003  LS E    Comp-3
* 000921 CP-CDT-METHOD . . . . . . . . . 0000000035 00000001  LS E    AlphNum
* 000925 CP-CLAIM-TYPE . . . . . . . . . 0000000036 00000001  LS E    AlphNum
* 000928 CP-ORIGINAL-TERM. . . . . . . . 0000000037 00000002  LS E    Comp-3
* 000930 CP-ORIGINAL-BENEFIT . . . . . . 0000000039 00000006  LS E    Comp-3
* 000932 CP-ORIGINAL-PREMIUM . . . . . . 0000000045 00000005  LS E    Comp-3
* 000934 CP-REMAINING-TERM . . . . . . . 0000000050 00000003  LS E    Comp-3
* 000936 CP-REMAINING-BENEFIT. . . . . . 0000000053 00000006  LS E    Comp-3
* 000938 CP-LOAN-APR . . . . . . . . . . 0000000059 00000004  LS E    Comp-3
* 000940 CP-PAY-FREQUENCY. . . . . . . . 0000000063 00000002  LS E    Comp-3
* 000942 CP-REM-TERM-METHOD. . . . . . . 0000000065 00000001  LS E    AlphNum
* 000950 CP-EARNING-METHOD . . . . . . . 0000000066 00000001  LS E    AlphNum
* 000965 CP-PROCESS-TYPE . . . . . . . . 0000000067 00000001  LS E    AlphNum
* 000969 CP-SPECIAL-CALC-CD. . . . . . . 0000000068 00000001  LS E    AlphNum
* 001003 CP-LOAN-TERM. . . . . . . . . . 0000000069 00000002  LS E    Comp-3
* 001005 CP-CLASS-CODE . . . . . . . . . 0000000071 00000002  LS E    AlphNum
* 001006 CP-DEVIATION-CODE . . . . . . . 0000000073 00000003  LS E    AlphNum
* 001007 CP-STATE. . . . . . . . . . . . 0000000076 00000002  LS E    AlphNum
* 001008 CP-STATE-STD-ABBRV. . . . . . . 0000000078 00000002  LS E    AlphNum
* 001009 CP-BENEFIT-CD . . . . . . . . . 0000000080 00000002  LS E    AlphNum
* 001012 CP-R78-OPTION . . . . . . . . . 0000000082 00000001  LS E    AlphNum
* 001016 CP-COMPANY-CD . . . . . . . . . 0000000083 00000001  LS E    AlphNum
* 001017 CP-IBNR-RESERVE-SW. . . . . . . 0000000084 00000001  LS E    AlphNum
* 001018 CP-CLAIM-STATUS . . . . . . . . 0000000085 00000001  LS E    AlphNum
* 001019 CP-RATE-FILE. . . . . . . . . . 0000000086 00000001  LS E    AlphNum
* 001020 CP-TERM-OR-EXT-DAYS . . . . . . 0000000087 00000003  LS E    Comp-3
* 001023 CP-LIFE-OVERRIDE-CODE . . . . . 0000000090 00000001  LS E    AlphNum
* 001024 CP-AH-OVERRIDE-CODE . . . . . . 0000000091 00000001  LS E    AlphNum
* 001026 CP-RATE-DEV-PCT . . . . . . . . 0000000092 00000004  LS E    Comp-3
* 001028 CP-CLP-RATE-UP. . . . . . . . . 0000000092 00000004  LS E    Comp-3     R
* 001030 CP-CRITICAL-MONTHS. . . . . . . 0000000096 00000002  LS E    Comp-3
* 001032 CP-ALTERNATE-BENEFIT. . . . . . 0000000098 00000006  LS E    Comp-3
* 001034 CP-ALTERNATE-PREMIUM. . . . . . 0000000104 00000005  LS E    Comp-3
* 001036 CP-DDF-CSO-ADMIN-FEE. . . . . . 0000000104 00000005  LS E    Comp-3     R
* 001039 CP-PAID-FROM-DATE . . . . . . . 0000000109 00000002  LS E    AlphNum
* 001040 CP-CLAIM-CALC-METHOD. . . . . . 0000000111 00000001  LS E    AlphNum
* 001041 CP-EXT-DAYS-CALC. . . . . . . . 0000000112 00000001  LS E    AlphNum
* 001046 CP-DOMICILE-STATE . . . . . . . 0000000113 00000002  LS E    AlphNum
* 001047 CP-CARRIER. . . . . . . . . . . 0000000115 00000001  LS E    AlphNum
* 001048 CP-REIN-FLAG. . . . . . . . . . 0000000116 00000001  LS E    AlphNum
* 001049 CP-REM-TRM-CALC-OPTION. . . . . 0000000117 00000001  LS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 116
* ELRATEX.cbl
* 001060 CP-SIG-SWITCH . . . . . . . . . 0000000118 00000001  LS E    AlphNum
* 001061 CP-RATING-METHOD. . . . . . . . 0000000119 00000001  LS E    AlphNum
* 001071 CP-SALES-TAX. . . . . . . . . . 0000000120 00000003  LS E    Comp-3
* 001073 CP-BEN-CATEGORY . . . . . . . . 0000000123 00000001  LS E    AlphNum
* 001074 CP-DCC-LF-RATE. . . . . . . . . 0000000124 00000004  LS E    Comp-3
* 001075 CP-DCC-ACT-COMM . . . . . . . . 0000000124 00000004  LS E    Comp-3     R
* 001077 CP-DCC-AH-RATE. . . . . . . . . 0000000128 00000004  LS E    Comp-3
* 001078 CP-DCC-PMF-COMM . . . . . . . . 0000000128 00000004  LS E    Comp-3     R
* 001080 CP-DAYS-TO-1ST-PMT. . . . . . . 0000000132 00000002  LS E    Comp-3
* 001081 CP-AH-BALLOON-SW. . . . . . . . 0000000134 00000001  LS E    AlphNum
* 001082 CP-EXPIRE-DT. . . . . . . . . . 0000000135 00000002  LS E    AlphNum
* 001083 CP-LF-CLAIM-CALC-SW . . . . . . 0000000137 00000001  LS E    AlphNum
* 001084 CP-DDF-HI-FACT. . . . . . . . . 0000000138 00000003  LS E    Comp-3
* 001085 CP-DDF-LO-FACT. . . . . . . . . 0000000141 00000003  LS E    Comp-3
* 001086 CP-DDF-CLP. . . . . . . . . . . 0000000144 00000004  LS E    Comp-3
* 001087 CP-DDF-SPEC-CALC. . . . . . . . 0000000148 00000001  LS E    AlphNum
* 001090 CP-IU-RATE-UP . . . . . . . . . 0000000149 00000004  LS E    Comp-3
* 001091 CP-CANCEL-REASON. . . . . . . . 0000000153 00000001  LS E    AlphNum
* 001092 CP-DDF-ADMIN-FEES . . . . . . . 0000000154 00000004  LS E    Comp-3
* 001093 CP-PMT-MODE . . . . . . . . . . 0000000158 00000001  LS E    AlphNum
* 001094 CP-NO-OF-PMTS . . . . . . . . . 0000000159 00000002  LS E    Comp-3
* 001095 CP-1ST-YR-ALLOW . . . . . . . . 0000000161 00000003  LS E    Comp-3
* 001096 CP-DDF-COMM-AND-MFEE. . . . . . 0000000164 00000004  LS E    Comp-3
* 001097 CP-DDF-YR1AF. . . . . . . . . . 0000000168 00000004  LS E    Comp-3
* 001098 Filler. . . . . . . . . . . . . 0000000172 00000001  LS E    AlphNum
* 001102 CP-CDT-TABLE. . . . . . . . . . 0000000173 00000001  LS E    Display
* 001104 CP-CDT-FACTOR . . . . . . . . . 0000000174 00000006  LS E    Comp-3
* 001106 CP-PTC-RESERVE. . . . . . . . . 0000000180 00000005  LS E    Comp-3
* 001108 CP-IBNR-RESERVE . . . . . . . . 0000000185 00000005  LS E    Comp-3
* 001110 CP-FUTURE-RESERVE . . . . . . . 0000000190 00000005  LS E    Comp-3
* 001112 Filler. . . . . . . . . . . . . 0000000195 00000009  LS E    AlphNum
* 001115 CP-REMAINING-TERM-1 . . . . . . 0000000204 00000003  LS E    Comp-3
* 001117 CP-REMAINING-TERM-2 . . . . . . 0000000207 00000003  LS E    Comp-3
* 001119 CP-REMAINING-TERM-3 . . . . . . 0000000210 00000003  LS E    Comp-3
* 001121 CP-ODD-DAYS . . . . . . . . . . 0000000213 00000002  LS E    Comp-3
* 001123 Filler. . . . . . . . . . . . . 0000000215 00000012  LS E    AlphNum
* 001127 CP-REMAINING-AMT. . . . . . . . 0000000227 00000006  LS E    Comp-3
* 001129 CP-REMAINING-AMT-PRV. . . . . . 0000000233 00000006  LS E    Comp-3
* 001131 Filler. . . . . . . . . . . . . 0000000239 00000012  LS E    AlphNum
* 001135 CP-CALC-PREMIUM . . . . . . . . 0000000251 00000005  LS E    Comp-3
* 001137 CP-PREMIUM-RATE . . . . . . . . 0000000256 00000004  LS E    Comp-3
* 001139 CP-MORTALITY-CODE . . . . . . . 0000000260 00000004  LS E    AlphNum
* 001140 CP-RATE-EDIT-FLAG . . . . . . . 0000000264 00000001  LS E    AlphNum
* 001142 CP-COMPOSITE-RATE . . . . . . . 0000000265 00000003  LS E    Comp-3
* 001144 CP-POLICY-FEE . . . . . . . . . 0000000268 00000003  LS E    Comp-3
* 001145 CP-LF-PREM. . . . . . . . . . . 0000000271 00000005  LS E    Comp-3
* 001146 CP-LF-BALLOON-PREM. . . . . . . 0000000271 00000005  LS E    Comp-3     R
* 001148 Filler. . . . . . . . . . . . . 0000000276 00000007  LS E    AlphNum
* 001152 CP-CALC-REFUND. . . . . . . . . 0000000283 00000005  LS E    Comp-3
* 001154 CP-REFUND-TYPE-USED . . . . . . 0000000288 00000001  LS E    AlphNum
* 001169 Filler. . . . . . . . . . . . . 0000000289 00000012  LS E    AlphNum
* 001173 CP-R78-U-PRM. . . . . . . . . . 0000000301 00000005  LS E    Comp-3
* 001175 CP-R78-U-PRM-ALT. . . . . . . . 0000000306 00000005  LS E    Comp-3
* 001177 CP-PRORATA-U-PRM. . . . . . . . 0000000311 00000005  LS E    Comp-3
* 001179 CP-PRORATA-U-PRM-ALT. . . . . . 0000000316 00000005  LS E    Comp-3
* 001181 CP-STATE-U-PRM. . . . . . . . . 0000000321 00000005  LS E    Comp-3
* 001183 CP-DOMICILE-U-PRM . . . . . . . 0000000326 00000005  LS E    Comp-3
* 001185 CP-EARNING-TYPE-USED. . . . . . 0000000331 00000001  LS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 117
* ELRATEX.cbl
* 001195 Filler. . . . . . . . . . . . . 0000000332 00000012  LS E    AlphNum
* 001199 CP-ACTUAL-DAYS. . . . . . . . . 0000000344 00000003  LS E    Comp-3
* 001201 CP-CLAIM-PAYMENT. . . . . . . . 0000000347 00000005  LS E    Comp-3
* 001203 Filler. . . . . . . . . . . . . 0000000352 00000012  LS E    AlphNum
* 001206 CP-TOTAL-PAID . . . . . . . . . 0000000364 00000005  LS E    Comp-3
* 001208 CP-R-MAX-ATT-AGE. . . . . . . . 0000000369 00000002  LS E    Comp-3
* 001210 CP-R-MAX-AGE. . . . . . . . . . 0000000371 00000002  LS E    Comp-3
* 001212 CP-R-MAX-TERM . . . . . . . . . 0000000373 00000003  LS E    Comp-3
* 001214 CP-R-MAX-TOT-BEN. . . . . . . . 0000000376 00000005  LS E    Comp-3
* 001216 CP-R-MAX-MON-BEN. . . . . . . . 0000000381 00000005  LS E    Comp-3
* 001218 CP-IO-FUNCTION. . . . . . . . . 0000000386 00000001  LS E    AlphNum
* 001223 CP-FIRST-PAY-DATE . . . . . . . 0000000387 00000002  LS E    AlphNum
* 001225 CP-JOINT-INDICATOR. . . . . . . 0000000389 00000001  LS E    AlphNum
* 001227 CP-RESERVE-REMAINING-TERM . . . 0000000390 00000003  LS E    Comp-3
* 001231 CP-INSURED-BIRTH-DT . . . . . . 0000000393 00000002  LS E    AlphNum
* 001233 CP-INCURRED-AGE . . . . . . . . 0000000395 00000002  LS E    Comp-3
* 001236 CP-MONTHLY-PAYMENT. . . . . . . 0000000397 00000004  LS E    Comp-3
* 001239 CP-RATING-BENEFIT-AMT . . . . . 0000000401 00000006  LS E    Comp-3
* 001242 CP-ODD-DAYS-TO-PMT. . . . . . . 0000000407 00000002  LS E    Comp-3
* 001245 CP-MNTHS-TO-FIRST-PMT . . . . . 0000000409 00000002  LS E    Comp-3
* 001248 CP-REMAMT-FACTOR. . . . . . . . 0000000411 00000007  LS E    Comp-3
* 001251 CP-FREE-LOOK. . . . . . . . . . 0000000418 00000002  LS E    Comp-3
* 001254 CP-ROA-REFUND . . . . . . . . . 0000000420 00000001  LS E    AlphNum
* 001257 CP-NET-BENEFIT-AMT. . . . . . . 0000000421 00000006  LS E    Comp-3
* 001259 CP-SCNP-6MO-AMT . . . . . . . . 0000000427 00000006  LS E    Comp-3
* 001261 CP-MONTH. . . . . . . . . . . . 0000000433 00000002  LS E    Comp-3
* 001262 Filler. . . . . . . . . . . . . 0000000435 00000015  LS E    AlphNum
* 000000 XML-TEXT. . . . . . . . . . . . 0000000000 00000001  LS E    AlphNum      G
* 000000 XML-NTEXT . . . . . . . . . . . 0000000000 00000002  LS E    AlphNum      G
* 000000 XML-CODE. . . . . . . . . . . . 0000007704 00000004  PG E    Comp         G
* 000000 XML-EVENT . . . . . . . . . . . 0000007708 00000030  PG E    AlphNum      G
* 000000 RETURN-CODE . . . . . . . . . . 0000007740 00000004  PG E    Comp         G
* 000000 SORT-RETURN . . . . . . . . . . 0000007744 00000002  PG E    Comp         G
* 000000 TALLY . . . . . . . . . . . . . 0000007748 00000004  PG E    Comp         G
* 000000 SORT-MESSAGE. . . . . . . . . . 0000007752 00000008  PG E    AlphNum      G
* 000000 SORT-FILE-SIZE. . . . . . . . . 0000007760 00000004  PG E    Comp         G
* 000000 SORT-MODE-SIZE. . . . . . . . . 0000007764 00000004  PG E    Comp         G
* 000000 SORT-CORE-SIZE. . . . . . . . . 0000007768 00000004  PG E    Comp         G
* 000000 SORT-CONTROL. . . . . . . . . . 0000007772 00000008  PG E    AlphNum      G
* 000000 SHIFT-OUT . . . . . . . . . . . 0000007780 00000001  PG E    AlphNum      G
* 000000 SHIFT-IN. . . . . . . . . . . . 0000007784 00000001  PG E    AlphNum      G
*
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7916     Code:       52039
