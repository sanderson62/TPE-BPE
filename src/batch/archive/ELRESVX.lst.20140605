* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ELRESVX.cbl
* Options: int("ELRESVX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELRESVX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRESVX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRESVX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         04/18/98
     2                                                                  ELRESVX
     3 PROGRAM-ID.                 ELRESVX.                                LV005
     4*              PROGRAM CONVERTED BY                               ELRESVX
     5*              COBOL CONVERSION AID PO 5785-ABJ                   ELRESVX
     6*              CONVERSION DATE 12/20/95 09:15:46.                 ELRESVX
     7*                            VMOD=2.008                           ELRESVX
     8*                                                                 ELRESVX
     9*AUTHOR.       LOGIC, INC.                                        ELRESVX
    10*              DALLAS, TEXAS.                                     ELRESVX
    11                                                                  ELRESVX
    12*DATE-COMPILED.                                                   ELRESVX
    13                                                                  ELRESVX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ELRESVX.cbl
    14*SECURITY.   *****************************************************ELRESVX
    15*            *                                                   *ELRESVX
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ELRESVX
    17*            *                                                   *ELRESVX
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ELRESVX
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ELRESVX
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *ELRESVX
    21*            *                                                   *ELRESVX
    22*            *****************************************************ELRESVX
    23                                                                  ELRESVX
    24*REMARKS.                                                         ELRESVX
    25                                                                  ELRESVX
    26*        THIS SUBROUTINE IS USED TO CALCULATE FUTURE (ACCRUED),   ELRESVX
    27*    PAY-TO-CURRENT, AND I.B.N.R. LOSS RESERVES FOR BOTH LIFE AND ELRESVX
    28*    A/H.                                                         ELRESVX
    29                                                                  ELRESVX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ELRESVX.cbl
    31 ENVIRONMENT DIVISION.                                            ELRESVX
    32                                                                  ELRESVX
    33 DATA DIVISION.                                                   ELRESVX
    34                                                                  ELRESVX
    35 WORKING-STORAGE SECTION.                                         ELRESVX
    36 77  FILLER   PIC X(32) VALUE '********************************'. ELRESVX
    37 77  FILLER   PIC X(32) VALUE '**  ELRESVX WORKING STORAGE   **'. ELRESVX
    38 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.008 *********'. ELRESVX
    39                                                                  ELRESVX
*   40                            COPY ELCRESW1.                        ELRESVX
    41******************************************************************04/16/98
    42*                                                                *ELCRESW1
    43*                                                                *ELCRESW1
    44*                            ELCRESW1.                           *   LV003
    45*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    46*                            VMOD=2.005                          *ELCRESW1
    47*                                                                *ELCRESW1
    48*   DESCRIPTION:  WORKING STORAGE AREA FOR RESERVE CALCULATION   *ELCRESW1
    49*                 ROUTINE                                        *ELCRESW1
    50******************************************************************ELCRESW1
    51                                                                  ELCRESW1
    52 01  WS-WORK-AREAS                   COMP-3.                      ELCRESW1
    53     12  WS-MONTHS-DISABLED          PIC S9(5)   VALUE ZERO.      ELCRESW1
    54     12  WS-DISABILITY-TABLE         PIC S9      VALUE ZERO.      ELCRESW1
    55     12  WS-DISABLED-AGE             PIC S9(3)   VALUE ZERO.      ELCRESW1
    56     12  WS-EXPIRE-AGE               PIC S9(3)   VALUE ZERO.      ELCRESW1
    57     12  WS-REMAINING-TERM           PIC S9(3)   VALUE ZERO.      ELCRESW1
    58                                                                  ELCRESW1
    59     12  WS-ELAPSED-MONTHS           PIC S9(5)   VALUE ZERO.      ELCRESW1
    60     12  WS-ODD-DAYS-OVER            PIC S9(3)   VALUE ZERO.      ELCRESW1
    61     12  WS-DAYS-IN-MONTH            PIC S9(3)   VALUE ZERO.      ELCRESW1
    62                                                                  ELCRESW1
    63     12  WS-VALUATION-DAY            PIC S9(3)   VALUE ZERO.      ELCRESW1
    64     12  WS-PAID-THRU-DAY            PIC S9(3)   VALUE ZERO.      ELCRESW1
    65                                                                  ELCRESW1
    66     12  AGE-INDEX               PIC S9(3)V9(4)  VALUE ZERO.      ELCRESW1
    67     12  AGE-INDEX2              PIC S9(3)       VALUE ZERO.      ELCRESW1
    68     12  AGE-INDEX-LOW           PIC S9(3)       VALUE ZERO.      ELCRESW1
    69     12  AGE-INDEX-HIGH          PIC S9(3)       VALUE ZERO.      ELCRESW1
    70     12  AGE-INDEX-DIFF          PIC SV9(5)      VALUE ZERO.      ELCRESW1
    71     12  MONTH-INDEX             PIC S9(3)V9(4)  VALUE ZERO.      ELCRESW1
    72     12  YEAR-INDEX              REDEFINES                        ELCRESW1
    73         MONTH-INDEX             PIC S9(3)V9(4).                  ELCRESW1
    74     12  TERM-INDEX              REDEFINES                        ELCRESW1
    75         MONTH-INDEX             PIC S9(3)V9(4).                  ELCRESW1
    76     12  TERM-INDEX2             PIC S9(3)       VALUE ZERO.      ELCRESW1
    77     12  TERM-INDEX-LOW          PIC S9(3)       VALUE ZERO.      ELCRESW1
    78     12  TERM-INDEX-HIGH         PIC S9(3)       VALUE ZERO.      ELCRESW1
    79     12  TERM-INDEX-DIFF         PIC SV9(5)      VALUE ZERO.      ELCRESW1
    80                                                                  ELCRESW1
    81     12  FACTOR-A                PIC S9(5)V9(6)  VALUE ZERO.      ELCRESW1
    82     12  FACTOR-B                PIC S9(5)V9(6)  VALUE ZERO.      ELCRESW1
    83     12  FACTOR-V                PIC S9(5)V9(5)  VALUE ZERO.      ELCRESW1
    84     12  RESERVE-FACTOR          PIC S9(5)V9(6)  VALUE ZERO.      ELCRESW1
    85     12  FACTOR-INDEX            PIC S9(3)       VALUE ZERO.      ELCRESW1
    86                                                                  ELCRESW1
    87 01  WS-INITIAL-WORK-AREAS       PIC X(100) VALUE LOW-VALUES.     ELCRESW1
    88                                                                  ELCRESW1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESW1)
    89 01  FILLER.                                                      ELCRESW1
    90     12  LCP-ONCTR-01            PIC S9(8) COMP-3 VALUE ZERO.     ELCRESW1
    91     12  WS-VALUATION-DATE-2     PIC XX  VALUE LOW-VALUES.        ELCRESW1
    92     12  WS-VALUATION-DATE-3     PIC XX  VALUE LOW-VALUES.        ELCRESW1
    93     12  WS-EXPIRE-DATE          PIC XX  VALUE LOW-VALUES.        ELCRESW1
    94                                                                  ELCRESW1
    95     12  WS-DATE-CONVERSION-PROGRAM  PIC X(8) VALUE 'ELDATCV'.    ELCRESW1
    96                                                                  ELCRESW1
    97     12  WS-DATE-WORK.                                            ELCRESW1
    98         16  WS-DW-MONTH             PIC 99.                      ELCRESW1
    99         16  FILLER                  PIC X.                       ELCRESW1
   100         16  WS-DW-DAY               PIC 99.                      ELCRESW1
   101         16  FILLER                  PIC X.                       ELCRESW1
   102         16  WS-DW-CCYR              PIC 9(4).                       CL**2
   103                                                                  ELCRESW1
   104     12  WS-WORK-CYMD.                                               CL**2
   105         16  WS-WK-CCYR              PIC 9(4).                       CL**2
   106         16  WS-WK-MONTH             PIC 99.                      ELCRESW1
   107         16  WS-WK-DAY               PIC 99.                      ELCRESW1
   108                                                                  ELCRESW1
   109     12  POS-RESERVE-FACTORS.                                     ELCRESW1
   110         16  FILLER                  PIC X(30)                    ELCRESW1
   111                       VALUE '966669455339273230194170150137'.    ELCRESW1
   112         16  FILLER                  PIC X(30)                    ELCRESW1
   113                       VALUE '127115105098092088082076073068'.    ELCRESW1
   114         16  FILLER                  PIC X(30)                    ELCRESW1
   115                       VALUE '061056052047043037035031028023'.    ELCRESW1
   116         16  FILLER                  PIC X(30)                    ELCRESW1
   117                       VALUE '023020018016016015013012012011'.    ELCRESW1
   118                                                                  ELCRESW1
   119     12  POS-RESERVE-FACTOR-TABLE REDEFINES POS-RESERVE-FACTORS.  ELCRESW1
   120         16  POS-FACTOR-TABLE-ENTRIES  OCCURS 40 TIMES.           ELCRESW1
   121             20  POS-FACTOR          PIC SV999.                   ELCRESW1
   122                                                                  ELCRESW1
   123     12  TABLE-WORK-AREA             COMP-3.                      ELCRESW1
   124       16  TWA-MONTHS   OCCURS 42 TIMES  INDEXED BY TWA-INDEX1.   ELCRESW1
   125         20  TWA-AGE  OCCURS 11 TIMES  INDEXED BY TWA-INDEX2.     ELCRESW1
   126             24  TWA-FACTOR          PIC S9(5).                   ELCRESW1
   127                                                                  ELCRESW1
   128                                                                  ELRESVX
*  129                            COPY ELC64CDT  SUPPRESS.              ELRESVX
  3447                                                                  ELRESVX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ELRESVX.cbl
* 3449                            COPY ELCDATE.                            CL**5
  3450******************************************************************06/11/98
  3451*                                                                *ELCDATE
  3452*                                                                *ELCDATE
  3453*                            ELCDATE.                            *   LV023
  3454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  3455*                            VMOD=2.003                           ELCDATE
  3456*                                                                *ELCDATE
  3457*                                                                *ELCDATE
  3458*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  3459*                 LENGTH = 200                                   *   CL*19
  3460******************************************************************ELCDATE
  3461                                                                  ELCDATE
  3462 01  DATE-CONVERSION-DATA.                                        ELCDATE
  3463     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  3464     12  DC-OPTION-CODE                PIC X.                        CL*15
  3465         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  3466         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  3467         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  3468         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  3469         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  3470         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  3471         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  3472         88  FIND-CENTURY               VALUE '7'.                   CL*22
  3473         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  3474         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  3475         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  3476         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  3477         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  3478         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  3479         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  3480         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  3481         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  3482         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  3483         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  3484         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  3485         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  3486         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  3487         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  3488         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  3489         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  3490         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  3491         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  3492         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  3493         88  THREE-CHARACTER-BIN                                  ELCDATE
  3494                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  3495         88  GREGORIAN-TO-BIN                                        CL**2
  3496                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  3497         88  BIN-TO-GREGORIAN                                        CL**2
  3498                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  3499         88  JULIAN-TO-BINARY                                        CL**2
  3500                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  3501     12  DC-ERROR-CODE                 PIC X.                        CL*15
  3502         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  3503         88  DATE-CONVERSION-ERROR                                ELCDATE
  3504                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  3505         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  3506         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3507         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  3508         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  3509         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  3510         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  3511         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  3512         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  3513         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  3514         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  3515     12  DC-END-OF-MONTH               PIC X.                        CL*15
  3516         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  3517     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  3518         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  3519         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  3520         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  3521     12  FILLER                        PIC X.                        CL*15
  3522     12  DC-CONVERSION-DATES.                                        CL*15
  3523         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  3524         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  3525         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  3526         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  3527                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  3528             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  3529             20  SLASH1-1              PIC X.                        CL*15
  3530             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  3531             20  SLASH1-2              PIC X.                        CL*15
  3532             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  3533         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  3534         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  3535                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  3536             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  3537             20  SLASH2-1              PIC X.                        CL*15
  3538             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  3539             20  SLASH2-2              PIC X.                        CL*15
  3540             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  3541         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  3542         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  3543                     DC-GREG-DATE-1-YMD.                          ELCDATE
  3544             20  DC-YMD-YEAR           PIC 99.                       CL*15
  3545             20  DC-YMD-MONTH          PIC 99.                       CL*15
  3546             20  DC-YMD-DAY            PIC 99.                       CL*15
  3547         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  3548         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  3549                      DC-GREG-DATE-1-MDY.                         ELCDATE
  3550             20  DC-MDY-MONTH          PIC 99.                       CL*15
  3551             20  DC-MDY-DAY            PIC 99.                       CL*15
  3552             20  DC-MDY-YEAR           PIC 99.                       CL*15
  3553         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  3554             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  3555             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  3556             20  FILLER                PIC XX.                       CL*15
  3557             20  DC-ALPHA-CENTURY.                                   CL*15
  3558                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  3559             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  3560         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  3561         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  3562         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  3563         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  3564         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3565                                       PIC 9(05).                    CL*20
  3566         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  3567             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  3568             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  3569         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  3570         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  3571         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  3572     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  3573         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  3574         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  3575             20  FILLER                PIC 9(3).                     CL*15
  3576             20  HOLD-CEN-1-CCYY.                                    CL*15
  3577                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  3578                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  3579             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  3580             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  3581         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  3582             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  3583             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  3584             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  3585                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  3586                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  3587             20  FILLER                PIC 9(3).                     CL*15
  3588         16  HOLD-CENTURY-1-X.                                       CL*15
  3589             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  3590             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  3591                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  3592                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  3593             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  3594             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  3595         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  3596             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  3597             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  3598             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  3599                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  3600                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  3601             20  FILLER                PIC XXX.                      CL*23
  3602         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  3603         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  3604         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  3605         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  3606             20  DC-JULIAN-1-CCYY.                                   CL*15
  3607                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  3608                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  3609             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  3610         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  3611         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  3612             20  DC-JULIAN-2-CCYY.                                   CL*15
  3613                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  3614                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  3615             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  3616         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  3617             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  3618             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  3619             20  DC-EDITA-DAY          PIC 99.                       CL*15
  3620             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  3621             20  DC-EDITA-CCYY.                                      CL*15
  3622                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3623                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  3624         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  3625             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  3626             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  3627             20  DC-EDITB-DAY          PIC 99.                       CL*15
  3628             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  3629             20  DC-EDITB-CCYY.                                      CL*15
  3630                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  3631                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  3632         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  3633         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  3634                              DC-GREG-DATE-CYMD.                  ELCDATE
  3635             20  DC-CYMD-CEN           PIC 99.                       CL*15
  3636             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  3637             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  3638             20  DC-CYMD-DAY           PIC 99.                       CL*15
  3639         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  3640         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  3641                              DC-GREG-DATE-MDCY.                  ELCDATE
  3642             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  3643             20  DC-MDCY-DAY           PIC 99.                       CL*15
  3644             20  DC-MDCY-CEN           PIC 99.                       CL*15
  3645             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  3646    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  3647        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  3648    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  3649    12  FILLER                         PIC X(28).                    CL*26
  3650                                                                  ELRESVX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ELRESVX.cbl
  3652 LINKAGE SECTION.                                                 ELRESVX
* 3653                            COPY ELCCALC.                         ELRESVX
  3654******************************************************************04/15/98
  3655*                                                                *ELCCALC
  3656*                           ELCCALC.                            *    LV003
  3657*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3658*                            VMOD=2.025                          *   CL**3
  3659*                                                                *   CL**2
  3660*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  3661*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  3662*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  3663*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  3664*                                                                *   CL**2
  3665*  PASSED TO ELRTRM                                              *   CL**2
  3666*  -----------------                                             *   CL**2
  3667*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  3668*  ORIGINAL TERM                                                 *   CL**2
  3669*  BEGINNING DATE                                                *   CL**2
  3670*  ENDING DATE                                                   *   CL**2
  3671*  COMPANY I.D.                                                  *   CL**2
  3672*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  3673*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  3674*  FREE LOOK DAYS                                                *   CL**2
  3675*                                                                *   CL**2
  3676*  RETURNED FROM ELRTRM                                          *   CL**2
  3677*  ---------------------                                         *   CL**2
  3678*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  3679*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  3680*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  3681*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  3682*----------------------------------------------------------------*   CL**2
  3683*  PASSED TO ELRAMT                                              *   CL**2
  3684*  ----------------                                              *   CL**2
  3685*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  3686*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  3687*  ORIGINAL AMOUNT                                               *   CL**2
  3688*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  3689*  A.P.R. - NET PAY ONLY                                         *   CL**2
  3690*  METHOD                                                            CL**2
  3691*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  3692*  COMPANY I.D.                                                  *   CL**2
  3693*  BENEFIT TYPE                                                  *   CL**2
  3694*                                                                *   CL**2
  3695*  RETURNED FROM ELRAMT                                          *   CL**2
  3696*  --------------------                                          *   CL**2
  3697*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  3698*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  3699*  REMAINING AMOUNT FACTOR                                           CL**2
  3700*----------------------------------------------------------------*   CL**2
  3701*  PASSED TO ELRESV                                              *   CL**2
  3702*  -----------------                                             *   CL**2
  3703*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  3704*  VALUATION DATE                                                *   CL**2
  3705*  PAID THRU DATE                                                *   CL**2
  3706*  BENEFIT                                                       *   CL**2
  3707*  INCURRED DATE                                                 *   CL**2
  3708*  REPORTED DATE                                                 *   CL**2
  3709*  ISSUE AGE                                                     *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3710*  TERM                                                          *   CL**2
  3711*  CDT PERCENT                                                   *   CL**2
  3712*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  3713* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  3714* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  3715* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  3716*                                                                *   CL**2
  3717*  RETURNED FROM ELRESV                                          *   CL**2
  3718*  --------------------                                          *   CL**2
  3719*  CDT TABLE USED                                                *   CL**2
  3720*  CDT FACTOR USED                                               *   CL**2
  3721*  PAY TO CURRENT RESERVE                                        *   CL**2
  3722*  I.B.N.R. - A/H ONLY                                           *   CL**2
  3723*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  3724*----------------------------------------------------------------*   CL**2
  3725*  PASSED TO ELRATE                                              *   CL**2
  3726*  ----------------                                              *   CL**2
  3727*  CERT ISSUE DATE                                               *   CL**2
  3728*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  3729*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  3730*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  3731*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  3732*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  3733*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  3734*  DEVIATION CODE                                                *   CL**2
  3735*  ISSUE AGE                                                     *   CL**2
  3736*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  3737*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  3738*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  3739*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  3740*  A.P.R.                                                        *   CL**2
  3741*  METHOD                                                            CL**2
  3742*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  3743*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  3744*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  3745*  BENEFIT CODE                                                  *   CL**2
  3746*  BENEFIT OVERRIDE CODE                                         *   CL**2
  3747*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  3748*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  3749*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  3750*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  3751*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  3752*                                                                *   CL**2
  3753*  RETURNED FROM ELRATE                                          *   CL**2
  3754*  --------------------                                          *   CL**2
  3755*  CALCULATED PREMIUM                                            *   CL**2
  3756*  PREMIUM RATE                                                  *   CL**2
  3757*  MORTALITY CODE                                                *   CL**2
  3758*  MAX ATTAINED AGE                                              *   CL**2
  3759*  MAX AGE                                                       *   CL**2
  3760*  MAX TERM                                                      *   CL**2
  3761*  MAX MONTHLY BENEFIT                                           *   CL**2
  3762*  MAX TOTAL BENIFIT                                             *   CL**2
  3763*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  3764*----------------------------------------------------------------*   CL**2
  3765*  PASSED TO ELRFND                                              *   CL**2
  3766*  ----------------                                              *   CL**2
  3767*  CERT ISSUE DATE                                               *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3768*  REFUND DATE                                                   *   CL**2
  3769*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  3770*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  3771*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  3772*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  3773*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  3774*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  3775*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  3776*  DEVIATION CODE                                                *   CL**2
  3777*  ISSUE AGE                                                     *   CL**2
  3778*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  3779*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  3780*  PROCESS TYPE (CANCEL)                                         *   CL**2
  3781*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  3782*  A.P.R.                                                        *   CL**2
  3783*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  3784*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  3785*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  3786*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  3787*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  3788*  BENEFIT CODE                                                  *   CL**2
  3789*  BENEFIT OVERRIDE CODE                                         *   CL**2
  3790*                                                                *   CL**2
  3791*  RETURNED FROM ELRFND                                          *   CL**2
  3792*  --------------------                                          *   CL**2
  3793*  CALCULATED REFUND                                             *   CL**2
  3794*----------------------------------------------------------------*   CL**2
  3795*  PASSED TO ELEARN                                              *   CL**2
  3796*  ----------------                                              *   CL**2
  3797*  CERT ISSUE DATE                                               *   CL**2
  3798*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  3799*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  3800*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  3801*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  3802*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  3803*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  3804*  DEVIATION CODE                                                *   CL**2
  3805*  ISSUE AGE                                                     *   CL**2
  3806*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  3807*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  3808*  A.P.R.                                                        *   CL**2
  3809*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  3810*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  3811*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  3812*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  3813*  BENEFIT CODE                                                  *   CL**2
  3814*  BENEFIT OVERRIDE CODE                                         *   CL**2
  3815*                                                                *   CL**2
  3816*  RETURNED FROM ELEARN                                          *   CL**2
  3817*  --------------------                                          *   CL**2
  3818*  INDICATED  EARNINGS                                           *   CL**2
  3819*----------------------------------------------------------------*   CL**2
  3820*                 LENGTH = 450                                   *   CL**2
  3821*                                                                *   CL**2
  3822******************************************************************   CL**2
  3823******************************************************************
  3824*                   C H A N G E   L O G
  3825*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3826* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3827*-----------------------------------------------------------------
  3828*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3829* EFFECTIVE    NUMBER
  3830*-----------------------------------------------------------------
  3831* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3832* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3833* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3834* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3835* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3836* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3837* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3838* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3839* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3840******************************************************************
  3841                                                                     CL**2
  3842 01  CALCULATION-PASS-AREA.                                          CL**2
  3843     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  3844                                     COMP.                           CL**2
  3845                                                                     CL**2
  3846     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  3847       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  3848       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  3849                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  3850       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  3851       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  3852       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  3853       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  3854       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  3855       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  3856       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  3857       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  3858       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  3859       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  3860       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  3861       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  3862       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  3863       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  3864       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  3865       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  3866       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  3867                                                                     CL**2
  3868     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  3869       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  3870***********************  INPUT AREAS ****************************    CL**2
  3871                                                                     CL**2
  3872     12  CP-CALCULATION-AREA.                                        CL**2
  3873         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  3874         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  3875         16  CP-VALUATION-DT       PIC XX.                           CL**2
  3876         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  3877         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  3878           88  CP-AH                               VALUE 'A' 'D'     CL**2
  3879                                                   'I' 'U'.          CL**2
  3880           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  3881           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  3882         16  CP-INCURRED-DT        PIC XX.                           CL**2
  3883         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3884         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  3885         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  3886         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  3887                                     COMP-3.                         CL**2
  3888         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  3889                                     COMP-3.                         CL**2
  3890         16  CP-CDT-METHOD         PIC X.                            CL**2
  3891           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  3892           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  3893           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  3894         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  3895           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  3896           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  3897         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  3898                                     COMP-3.                         CL**2
  3899         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  3900                                     COMP-3.                         CL**2
  3901         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  3902                                     COMP-3.                         CL**2
  3903         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  3904                                     COMP-3.                         CL**2
  3905         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  3906                                     COMP-3.                         CL**2
  3907         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  3908                                     COMP-3.                         CL**2
  3909         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  3910                                     COMP-3.                         CL**2
  3911         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  3912           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  3913           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  3914           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  3915           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  3916           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  3917           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  3918           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  3919         16  CP-EARNING-METHOD     PIC X.                            CL**2
  3920           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  3921           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  3922           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  3923           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  3924           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  3925           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  3926           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  3927           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  3928           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  3929           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  3930           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3931           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3932           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3933           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3934         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  3935           88  CP-CLAIM                            VALUE '1'.        CL**2
  3936           88  CP-CANCEL                           VALUE '2'.        CL**2
  3937           88  CP-ISSUE                            VALUE '3'.        CL**2
  3938         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  3939           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  3940           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  3941           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3942           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  3943           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  3944           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  3945           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  3946           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  3947           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  3948           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  3949           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  3950           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  3951           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  3952           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  3953           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  3954           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  3955           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  3956           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  3957                                                     'W' 'X'.        CL**2
  3958           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  3959           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  3960           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  3961           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  3962           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  3963           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  3964           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  3965           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  3966           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  3967           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  3968           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  3969           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  3970           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  3971                                                                     CL**2
  3972         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  3973                                     COMP-3.                         CL**2
  3974         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  3975         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  3976         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  3977         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  3978         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  3979           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  3980               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  3981         16  CP-R78-OPTION         PIC X.                            CL**2
  3982           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  3983           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  3984                                                                     CL**2
  3985         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  3986         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  3987         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  3988         16  CP-RATE-FILE          PIC X.                            CL**2
  3989         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  3990                                     COMP-3.                         CL**2
  3991                                                                     CL**2
  3992         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  3993         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  3994                                                                     CL**2
  3995         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  3996                                     COMP-3.
  3997         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3998                                   PIC S9(5)V99 COMP-3.
  3999         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  4000                                     COMP-3.                         CL**2
  4001         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  4002                                     COMP-3.                         CL**2
  4003         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  4004                                     COMP-3.
  4005         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  4006                                  PIC S9(7)V99 COMP-3.
  4007                                                                     CL**2
  4008         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  4009         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  4010         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  4011           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  4012           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  4013           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  4014           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  4015         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  4016         16  CP-CARRIER            PIC X.                            CL**2
  4017         16  CP-REIN-FLAG          PIC X.                            CL**2
  4018         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  4019           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  4020                      '2' '3' '4' '5'.                               CL**2
  4021           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  4022           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  4023           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  4024           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  4025           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  4026           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  4027           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  4028           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  4029         16  CP-SIG-SWITCH         PIC X.                            CL**2
  4030         16  CP-RATING-METHOD      PIC X.                            CL**2
  4031           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  4032           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  4033           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  4034           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  4035           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  4036           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  4037           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  4038           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  4039           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  4040         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  4041                                     COMP-3.                         CL**2
  4042         16  CP-BEN-CATEGORY       PIC X.
  4043         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  4044         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  4045                                   PIC S99V9(5) COMP-3.
  4046         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  4047         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  4048                                   PIC S99V9(5) COMP-3.
  4049         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  4050         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  4051         16  CP-EXPIRE-DT          PIC XX.
  4052         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  4053         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  4054         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  4055         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  4056         16  CP-DDF-SPEC-CALC      PIC X.
  4057             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  4058             88  CP-CALC-CLP              VALUE 'C'.
  4059         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  4060         16  CP-CANCEL-REASON      PIC X.
  4061         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  4062         16  CP-PMT-MODE           PIC X.
  4063         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  4064         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  4065         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  4066         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  4067         16  FILLER                PIC X.
  4068                                                                     CL**2
  4069***************    OUTPUT FROM ELRESV   ************************     CL**2
  4070                                                                     CL**2
  4071         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  4072                                                                     CL**2
  4073         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  4074                                     COMP-3.                         CL**2
  4075         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  4076                                     COMP-3.                         CL**2
  4077         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  4078                                     COMP-3.                         CL**2
  4079         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  4080                                     COMP-3.                         CL**2
  4081         16  FILLER                PIC X(09).                        CL**2
  4082***************    OUTPUT FROM ELRTRM   *************************    CL**2
  4083                                                                     CL**2
  4084         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  4085                                     COMP-3.                         CL**2
  4086         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  4087                                     COMP-3.                         CL**2
  4088         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  4089                                     COMP-3.                         CL**2
  4090         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  4091                                     COMP-3.                         CL**2
  4092         16  FILLER                PIC X(12).                        CL**2
  4093                                                                     CL**2
  4094***************    OUTPUT FROM ELRAMT   *************************    CL**2
  4095                                                                     CL**2
  4096         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  4097                                     COMP-3.                         CL**2
  4098         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  4099                                     COMP-3.                         CL**2
  4100         16  FILLER                PIC X(12).                        CL**2
  4101                                                                     CL**2
  4102***************    OUTPUT FROM ELRATE   *************************    CL**2
  4103                                                                     CL**2
  4104         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  4105                                     COMP-3.                         CL**2
  4106         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  4107                                     COMP-3.                         CL**2
  4108         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  4109         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  4110             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  4111         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  4112                                     COMP-3.                         CL**2
  4113         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  4114         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4115         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  4116                                   PIC S9(7)V99 COMP-3.
  4117         16  FILLER                PIC X(07).                        CL**2
  4118                                                                     CL**2
  4119***************    OUTPUT FROM ELRFND   *************************    CL**2
  4120                                                                     CL**2
  4121         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  4122                                     COMP-3.                         CL**2
  4123         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  4124           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  4125           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  4126           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  4127           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  4128           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  4129           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  4130           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  4131           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  4132           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  4133           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4134           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4135           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4136           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4137           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4138         16  FILLER                PIC X(12).                        CL**2
  4139                                                                     CL**2
  4140***************    OUTPUT FROM ELEARN   *************************    CL**2
  4141                                                                     CL**2
  4142         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  4143                                     COMP-3.                         CL**2
  4144         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  4145                                     COMP-3.                         CL**2
  4146         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  4147                                     COMP-3.                         CL**2
  4148         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  4149                                     COMP-3.                         CL**2
  4150         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  4151                                     COMP-3.                         CL**2
  4152         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  4153                                     COMP-3.                         CL**2
  4154         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  4155           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  4156           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  4157           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  4158           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  4159           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  4160           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  4161           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  4162           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  4163           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  4164         16  FILLER                PIC X(12).                        CL**2
  4165                                                                     CL**2
  4166***************    OUTPUT FROM ELPMNT   *************************    CL**2
  4167                                                                     CL**2
  4168         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  4169                                     COMP-3.                         CL**2
  4170         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  4171                                     COMP-3.                         CL**2
  4172         16  FILLER                PIC X(12).                        CL**2
  4173                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  4174***************   MISC WORK AREAS    *****************************   CL**2
  4175         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  4176                                     COMP-3.                         CL**2
  4177         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  4178                                     COMP-3.                         CL**2
  4179         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  4180                                     COMP-3.                         CL**2
  4181         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  4182                                     COMP-3.                         CL**2
  4183         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  4184                                     COMP-3.                         CL**2
  4185         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  4186                                     COMP-3.                         CL**2
  4187         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  4188             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  4189             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  4190             88  IO-ERROR                         VALUE 'E'.         CL**2
  4191                                                                     CL**2
  4192         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  4193                                                                     CL**2
  4194         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  4195                                                                     CL**2
  4196         16  CP-RESERVE-REMAINING-TERM                               CL**2
  4197                                   PIC S9(4)V9    VALUE ZERO         CL**2
  4198                                     COMP-3.                         CL**2
  4199                                                                     CL**2
  4200         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  4201                                                                     CL**2
  4202         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  4203                                     COMP-3.                         CL**2
  4204                                                                     CL**2
  4205         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  4206                                     COMP-3.                         CL**2
  4207                                                                     CL**2
  4208         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  4209                                     COMP-3.                         CL**2
  4210                                                                     CL**2
  4211         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  4212                                     COMP-3.                         CL**2
  4213                                                                     CL**2
  4214         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  4215                                     COMP-3.                         CL**2
  4216                                                                     CL**2
  4217         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  4218                                     COMP-3.                         CL**2
  4219                                                                     CL**2
  4220         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  4221                                     COMP-3.                         CL**2
  4222                                                                     CL**2
  4223         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  4224             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  4225                                                                     CL**2
  4226         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  4227                                     COMP-3.                         CL**2
  4228         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4229                                     COMP-3.
  4230         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4231         16  FILLER                PIC X(15).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ELRESVX.cbl
  4232******************************************************************   CL**2
  4233                                                                  ELRESVX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ELRESVX.cbl
  4235 PROCEDURE DIVISION USING CALCULATION-PASS-AREA.                  ELRESVX
  4236                                                                  ELRESVX
  4237 0000-CALCULATE-RESERVES SECTION.
*                                       COPY ELCRESP1.                  ELRESVX
  4238***************************************************************** 04/16/98
  4239*                                                               * ELCRESP1
  4240*                                                               * ELCRESP1
  4241*                            ELCRESP1.                          *    LV003
  4242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4243*                            VMOD=2.015                         * ELCRESP1
  4244*                                                               * ELCRESP1
  4245*                PROCEDURE DIVISION USED TO CALCULATE THE       * ELCRESP1
  4246*            FUTURE, I.B.N.R., AND PAY TO CURRENT RESERVES.     * ELCRESP1
  4247*                                                               * ELCRESP1
  4248***************************************************************** ELCRESP1
  4249******************************************************************
  4250*                   C H A N G E   L O G
  4251*
  4252* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4253*-----------------------------------------------------------------
  4254*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4255* EFFECTIVE    NUMBER
  4256*-----------------------------------------------------------------
  4257* 032612  CR2011110200001  PEMA  AHL CHANGES
  4258******************************************************************
  4259                                                                  ELCRESP1
  4260     MOVE ZERO                   TO  CP-CDT-TABLE                 ELCRESP1
  4261                                     CP-CDT-FACTOR                ELCRESP1
  4262                                     CP-PTC-RESERVE               ELCRESP1
  4263                                     CP-IBNR-RESERVE              ELCRESP1
  4264                                     CP-FUTURE-RESERVE.           ELCRESP1
  4265                                                                  ELCRESP1
  4266     IF LCP-ONCTR-01 =  0                                         ELCRESP1
  4267         ADD 1 TO LCP-ONCTR-01                                    ELCRESP1
  4268         MOVE WS-WORK-AREAS          TO  WS-INITIAL-WORK-AREAS    ELCRESP1
  4269       ELSE                                                       ELCRESP1
  4270         MOVE WS-INITIAL-WORK-AREAS  TO  WS-WORK-AREAS.           ELCRESP1
  4271                                                                  ELCRESP1
  4272     IF CP-LIFE-CLAIM                                             ELCRESP1
  4273         MOVE CP-REMAINING-AMT   TO CP-PTC-RESERVE                ELCRESP1
  4274         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4275                                                                  ELCRESP1
  4276     IF CP-R-MAX-MON-BEN NOT = ZEROS
  4277        MOVE CP-R-MAX-MON-BEN    TO CP-ORIGINAL-BENEFIT
  4278     END-IF
  4279
  4280     IF CP-CLAIM-STATUS = 'C'                                     ELCRESP1
  4281         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4282                                                                  ELCRESP1
  4283*    NOTE ******************************************************* ELCRESP1
  4284*         *                                                     * ELCRESP1
  4285*         *      CALCULATE THE NUMBER OF MONTHS DISABLED TO     * ELCRESP1
  4286*         *  DETERMINE WHICH DISABILITY TABLE TO USE.           * ELCRESP1
  4287*         *                                                     * ELCRESP1
  4288*         *******************************************************.ELCRESP1
  4289                                                                  ELCRESP1
  4290     IF CP-COMPANY-ID = 'CVL'  OR  'CNL'                          ELCRESP1
  4291        IF CP-PAID-THRU-DT EQUAL LOW-VALUES                       ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4292           MOVE CP-INCURRED-DT   TO  DC-BIN-DATE-2                ELCRESP1
  4293        ELSE                                                      ELCRESP1
  4294           MOVE CP-PAID-THRU-DT  TO  DC-BIN-DATE-2                ELCRESP1
  4295     ELSE                                                         ELCRESP1
  4296        MOVE CP-VALUATION-DT     TO  DC-BIN-DATE-2.               ELCRESP1
  4297                                                                  ELCRESP1
  4298     MOVE CP-INCURRED-DT         TO  DC-BIN-DATE-1.               ELCRESP1
  4299     MOVE '1'                    TO  DC-OPTION-CODE.              ELCRESP1
  4300     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4301                                                                  ELCRESP1
  4302     IF DC-ERROR-CODE NOT = SPACES                                ELCRESP1
  4303         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4304         GO TO 0999-EXIT.                                         ELCRESP1
  4305                                                                  ELCRESP1
  4306     MOVE DC-ELAPSED-MONTHS      TO  WS-MONTHS-DISABLED.          ELCRESP1
  4307                                                                  ELCRESP1
  4308     IF WS-MONTHS-DISABLED LESS +1                                ELCRESP1
  4309         MOVE TAB-01-VALUES      TO  TABLE-WORK-AREA              ELCRESP1
  4310         MOVE +1                 TO  WS-DISABILITY-TABLE          ELCRESP1
  4311         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4312                                                                  ELCRESP1
  4313     IF WS-MONTHS-DISABLED LESS +2                                ELCRESP1
  4314         MOVE TAB-02-VALUES      TO  TABLE-WORK-AREA              ELCRESP1
  4315         MOVE +2                 TO  WS-DISABILITY-TABLE          ELCRESP1
  4316         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4317                                                                  ELCRESP1
  4318     IF WS-MONTHS-DISABLED LESS +6                                ELCRESP1
  4319         MOVE TAB-03-VALUES      TO  TABLE-WORK-AREA              ELCRESP1
  4320         MOVE +3                 TO  WS-DISABILITY-TABLE          ELCRESP1
  4321         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4322                                                                  ELCRESP1
  4323     IF WS-MONTHS-DISABLED LESS +12                               ELCRESP1
  4324         MOVE TAB-04-VALUES      TO  TABLE-WORK-AREA              ELCRESP1
  4325         MOVE +4                 TO  WS-DISABILITY-TABLE          ELCRESP1
  4326         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4327                                                                  ELCRESP1
  4328     IF WS-MONTHS-DISABLED LESS +24                               ELCRESP1
  4329         MOVE TAB-05-VALUES      TO  TABLE-WORK-AREA              ELCRESP1
  4330         MOVE +5                 TO  WS-DISABILITY-TABLE          ELCRESP1
  4331         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4332                                                                  ELCRESP1
  4333     IF WS-MONTHS-DISABLED LESS +36                               ELCRESP1
  4334         MOVE TAB-06-VALUES      TO  TABLE-WORK-AREA              ELCRESP1
  4335         MOVE +6                 TO  WS-DISABILITY-TABLE          ELCRESP1
  4336         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4337                                                                  ELCRESP1
  4338     IF WS-MONTHS-DISABLED LESS +48                               ELCRESP1
  4339         MOVE TAB-07-VALUES      TO  TABLE-WORK-AREA              ELCRESP1
  4340         MOVE +7                 TO  WS-DISABILITY-TABLE          ELCRESP1
  4341         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4342                                                                  ELCRESP1
  4343     IF WS-MONTHS-DISABLED LESS +60                               ELCRESP1
  4344         MOVE TAB-08-VALUES      TO  TABLE-WORK-AREA              ELCRESP1
  4345         MOVE +8                 TO  WS-DISABILITY-TABLE          ELCRESP1
  4346         GO TO 0100-CALCULATE-AGE.                                ELCRESP1
  4347                                                                  ELCRESP1
  4348     MOVE TAB-09-VALUES          TO  TABLE-WORK-AREA.             ELCRESP1
  4349     MOVE +9                     TO  WS-DISABILITY-TABLE.         ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4350                                                                  ELCRESP1
  4351 0100-CALCULATE-AGE.                                              ELCRESP1
  4352*    NOTE ******************************************************* ELCRESP1
  4353*         *                                                     * ELCRESP1
  4354*         *      CALCULATE THE AGE AT THE TIME OF DISABLEMENT.  * ELCRESP1
  4355*         *                                                     * ELCRESP1
  4356*         *******************************************************.ELCRESP1
  4357                                                                  ELCRESP1
  4358     MOVE +0                     TO CP-INCURRED-AGE.              ELCRESP1
  4359                                                                  ELCRESP1
  4360     IF (CP-COMPANY-ID = 'MON' or 'AHL')
  4361        AND (CP-INSURED-BIRTH-DT NOT = LOW-VALUES)
  4362        CONTINUE
  4363     ELSE                                                         ELCRESP1
  4364        GO TO 0110-CONTINUE-CALC-AGE
  4365     END-IF
  4366                                                                  ELCRESP1
  4367     MOVE CP-INSURED-BIRTH-DT    TO DC-BIN-DATE-1                 ELCRESP1
  4368     MOVE CP-INCURRED-DT         TO DC-BIN-DATE-2                 ELCRESP1
  4369     MOVE '1'                    TO DC-OPTION-CODE                ELCRESP1
  4370     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4371                                                                  ELCRESP1
  4372     IF DATE-CONVERSION-ERROR                                     ELCRESP1
  4373        GO TO 0110-CONTINUE-CALC-AGE.                             ELCRESP1
  4374                                                                  ELCRESP1
  4375     COMPUTE WS-DISABLED-AGE =                                    ELCRESP1
  4376                 (DC-ELAPSED-MONTHS / +12).                       ELCRESP1
  4377                                                                  ELCRESP1
  4378     MOVE WS-DISABLED-AGE    TO CP-INCURRED-AGE.                  ELCRESP1
  4379                                                                  ELCRESP1
  4380     GO TO 0120-CONTINUE-CALC-AGE.                                ELCRESP1
  4381                                                                  ELCRESP1
  4382 0110-CONTINUE-CALC-AGE.                                          ELCRESP1
  4383                                                                  ELCRESP1
  4384     MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1.               ELCRESP1
  4385     MOVE CP-INCURRED-DT         TO  DC-BIN-DATE-2.               ELCRESP1
  4386     MOVE '1'                    TO  DC-OPTION-CODE.              ELCRESP1
  4387     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4388                                                                  ELCRESP1
  4389     IF DC-ERROR-CODE NOT = SPACE                                 ELCRESP1
  4390         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4391         GO TO 0999-EXIT.                                         ELCRESP1
  4392                                                                  ELCRESP1
  4393     IF CP-ISSUE-AGE NOT GREATER ZERO                             ELCRESP1
  4394         MOVE +40                TO  CP-ISSUE-AGE.                ELCRESP1
  4395                                                                  ELCRESP1
  4396     COMPUTE WS-DISABLED-AGE =                                    ELCRESP1
  4397                 (DC-ELAPSED-MONTHS / +12) + CP-ISSUE-AGE.        ELCRESP1
  4398                                                                  ELCRESP1
  4399     MOVE WS-DISABLED-AGE    TO CP-INCURRED-AGE.                  ELCRESP1
  4400                                                                  ELCRESP1
  4401 0120-CONTINUE-CALC-AGE.                                          ELCRESP1
  4402                                                                  ELCRESP1
  4403     IF CP-LIFE-CLAIM                                             ELCRESP1
  4404         GO TO 0999-EXIT.                                         ELCRESP1
  4405                                                                  ELCRESP1
  4406     IF CP-CLAIM-STATUS = 'C'                                     ELCRESP1
  4407         GO TO 0405-CALCULATE-IBNR-RESERVES.                      ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4408                                                                  ELCRESP1
  4409     MOVE WS-DISABLED-AGE        TO  AGE-INDEX.                   ELCRESP1
  4410                                                                  ELCRESP1
  4411     IF AGE-INDEX LESS +22                                        ELCRESP1
  4412         MOVE +22                TO  AGE-INDEX.                   ELCRESP1
  4413                                                                  ELCRESP1
  4414     IF AGE-INDEX GREATER +72                                     ELCRESP1
  4415         MOVE +72                TO  AGE-INDEX.                   ELCRESP1
  4416                                                                  ELCRESP1
  4417     SUBTRACT +17 FROM AGE-INDEX.                                 ELCRESP1
  4418     DIVIDE +5 INTO AGE-INDEX.                                    ELCRESP1
  4419                                                                  ELCRESP1
  4420*    NOTE ******************************************************* ELCRESP1
  4421*         *                                                     * ELCRESP1
  4422*         *          CALCULATE COVERAGE EXPIRE DATE             * ELCRESP1
  4423*         *                                                     * ELCRESP1
  4424*         *******************************************************.ELCRESP1
  4425                                                                  ELCRESP1
  4426     MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1.               ELCRESP1
  4427     MOVE CP-ORIGINAL-TERM       TO  DC-ELAPSED-MONTHS.           ELCRESP1
  4428     MOVE ZERO                   TO  DC-ELAPSED-DAYS.             ELCRESP1
  4429     MOVE '6'                    TO  DC-OPTION-CODE.              ELCRESP1
  4430     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4431                                                                  ELCRESP1
  4432     IF DC-ERROR-CODE NOT = SPACES                                ELCRESP1
  4433         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4434         GO TO 0999-EXIT.                                         ELCRESP1
  4435                                                                  ELCRESP1
  4436     MOVE DC-BIN-DATE-2          TO  WS-EXPIRE-DATE.              ELCRESP1
  4437     if cp-company-id = 'AHL'
  4438        if cp-expire-dt not = low-values and spaces
  4439           move cp-expire-dt     to ws-expire-date
  4440        end-if
  4441     end-if
  4442*    NOTE ******************************************************* ELCRESP1
  4443*         *                                                     * ELCRESP1
  4444*         *      CALCULATE NUMBER OF MONTHS FROM VALUATION      * ELCRESP1
  4445*         *  DATE TO EXPIRY DATE (IE. REMAINING TERM).          * ELCRESP1
  4446*         *                                                     * ELCRESP1
  4447*         *      IF THE EXPIRE DATE HAS PAST BYPASS THE FUTURE  * ELCRESP1
  4448*         *  RESERVE CALCULATIONS AND ONLY CALCULATE THE PTC    * ELCRESP1
  4449*         *  RESERVE.                                           * ELCRESP1
  4450*         *                                                     * ELCRESP1
  4451*         ******************************************************* ELCRESP1
  4452                                                                  ELCRESP1
  4453     IF CP-COMPANY-ID = 'CVL'  OR  'CNL'                          ELCRESP1
  4454        IF CP-PAID-THRU-DT EQUAL LOW-VALUES                       ELCRESP1
  4455           MOVE CP-INCURRED-DT   TO  DC-BIN-DATE-1                ELCRESP1
  4456        ELSE                                                      ELCRESP1
  4457           MOVE CP-PAID-THRU-DT  TO  DC-BIN-DATE-1                ELCRESP1
  4458     ELSE                                                         ELCRESP1
  4459        MOVE CP-VALUATION-DT     TO  DC-BIN-DATE-1.               ELCRESP1
  4460                                                                  ELCRESP1
  4461*    IF CP-COMPANY-ID = 'FIM'                                     ELCRESP1
  4462*        IF CP-PAID-THRU-DT = LOW-VALUES                          ELCRESP1
  4463*            MOVE CP-INCURRED-DT     TO  DC-BIN-DATE-1            ELCRESP1
  4464*        ELSE                                                     ELCRESP1
  4465*            MOVE CP-PAID-THRU-DT    TO  DC-BIN-DATE-1.           ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4466*                                                                 ELCRESP1
  4467     IF DC-BIN-DATE-1 NOT LESS WS-EXPIRE-DATE                     ELCRESP1
  4468         GO TO 0405-CALCULATE-IBNR-RESERVES.                      ELCRESP1
  4469                                                                  ELCRESP1
  4470     MOVE WS-EXPIRE-DATE         TO  DC-BIN-DATE-2.               ELCRESP1
  4471     MOVE '1'                    TO  DC-OPTION-CODE.              ELCRESP1
  4472     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4473                                                                  ELCRESP1
  4474     IF DC-ERROR-CODE NOT = SPACES                                ELCRESP1
  4475         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4476         GO TO 0999-EXIT.                                         ELCRESP1
  4477                                                                  ELCRESP1
  4478     MOVE DC-ELAPSED-MONTHS      TO  MONTH-INDEX                  ELCRESP1
  4479                                     WS-REMAINING-TERM.           ELCRESP1
  4480                                                                  ELCRESP1
  4481     IF (CP-CRITICAL-PERIOD)
  4482        AND (CP-CRITICAL-MONTHS > +0)
  4483        AND (WS-REMAINING-TERM > (CP-CRITICAL-MONTHS -
  4484             WS-MONTHS-DISABLED))
  4485        COMPUTE WS-REMAINING-TERM =
  4486        (CP-CRITICAL-MONTHS - WS-MONTHS-DISABLED)                 ELCRESP1
  4487        MOVE WS-REMAINING-TERM TO MONTH-INDEX.                    ELCRESP1
  4488                                                                  ELCRESP1
  4489                                                                  ELCRESP1
  4490*    NOTE ******************************************************* ELCRESP1
  4491*         *                                                     * ELCRESP1
  4492*         *      IF THE INSURED HAS BEEN DISABLED MORE THAN     * ELCRESP1
  4493*         *  TWELVE (12) MONTHS THE CALCULATION IS DONE IN      * ELCRESP1
  4494*         *  YEARS.                                             * ELCRESP1
  4495*         *                                                     * ELCRESP1
  4496*         *******************************************************.ELCRESP1
  4497                                                                  ELCRESP1
  4498     IF WS-DISABILITY-TABLE GREATER +4                            ELCRESP1
  4499         GO TO 0200-CALCULATE-YEARS.                              ELCRESP1
  4500                                                                  ELCRESP1
  4501     DIVIDE DC-ODD-DAYS-OVER BY DC-DAYS-IN-MONTH                  ELCRESP1
  4502                                 GIVING TERM-INDEX-DIFF.          ELCRESP1
  4503                                                                  ELCRESP1
  4504     MOVE DC-ODD-DAYS-OVER       TO  WS-ODD-DAYS-OVER.            ELCRESP1
  4505     MOVE DC-DAYS-IN-MONTH       TO  WS-DAYS-IN-MONTH.            ELCRESP1
  4506                                                                  ELCRESP1
  4507     COMPUTE WS-EXPIRE-AGE =                                      ELCRESP1
  4508                           CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12) ELCRESP1
  4509                                                                  ELCRESP1
  4510     IF MONTH-INDEX LESS +24                                      ELCRESP1
  4511         GO TO 0300-CALCULATE-RESERVES.                           ELCRESP1
  4512                                                                  ELCRESP1
  4513     IF MONTH-INDEX NOT GREATER +180                              ELCRESP1
  4514         COMPUTE MONTH-INDEX = ((MONTH-INDEX - 24) / 12) + 24     ELCRESP1
  4515         MOVE MONTH-INDEX        TO  TERM-INDEX-DIFF              ELCRESP1
  4516         GO TO 0305-CALCULATE-RESERVES.                           ELCRESP1
  4517                                                                  ELCRESP1
  4518     IF WS-EXPIRE-AGE GREATER +65                                 ELCRESP1
  4519         MOVE +42                TO  MONTH-INDEX                  ELCRESP1
  4520         MOVE ZERO               TO  TERM-INDEX-DIFF              ELCRESP1
  4521         GO TO 0300-CALCULATE-RESERVES.                           ELCRESP1
  4522                                                                  ELCRESP1
  4523     IF WS-EXPIRE-AGE GREATER +60                                 ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4524         MOVE +41                TO  MONTH-INDEX                  ELCRESP1
  4525         COMPUTE TERM-INDEX-DIFF = (WS-EXPIRE-AGE - +60) / +5     ELCRESP1
  4526         IF AGE-INDEX GREATER +6                                  ELCRESP1
  4527             MOVE +6             TO  AGE-INDEX                    ELCRESP1
  4528             GO TO 0300-CALCULATE-RESERVES                        ELCRESP1
  4529           ELSE                                                   ELCRESP1
  4530             GO TO 0300-CALCULATE-RESERVES.                       ELCRESP1
  4531                                                                  ELCRESP1
  4532     IF WS-EXPIRE-AGE GREATER +55                                 ELCRESP1
  4533         MOVE +40                TO  MONTH-INDEX                  ELCRESP1
  4534         COMPUTE TERM-INDEX-DIFF = (WS-EXPIRE-AGE - +55) / +5     ELCRESP1
  4535         IF AGE-INDEX GREATER +5                                  ELCRESP1
  4536             MOVE +5             TO  AGE-INDEX                    ELCRESP1
  4537             GO TO 0300-CALCULATE-RESERVES                        ELCRESP1
  4538           ELSE                                                   ELCRESP1
  4539             GO TO 0300-CALCULATE-RESERVES.                       ELCRESP1
  4540                                                                  ELCRESP1
  4541     IF WS-EXPIRE-AGE GREATER +50                                 ELCRESP1
  4542         MOVE +39                TO  MONTH-INDEX                  ELCRESP1
  4543         COMPUTE TERM-INDEX-DIFF = (WS-EXPIRE-AGE - +50) / +5     ELCRESP1
  4544         IF AGE-INDEX GREATER +4                                  ELCRESP1
  4545             MOVE +4             TO  AGE-INDEX                    ELCRESP1
  4546             GO TO 0300-CALCULATE-RESERVES                        ELCRESP1
  4547           ELSE                                                   ELCRESP1
  4548             GO TO 0300-CALCULATE-RESERVES.                       ELCRESP1
  4549                                                                  ELCRESP1
  4550     MOVE +38                    TO  MONTH-INDEX.                 ELCRESP1
  4551     MOVE ZERO                   TO  TERM-INDEX-DIFF.             ELCRESP1
  4552                                                                  ELCRESP1
  4553     IF AGE-INDEX GREATER +3                                      ELCRESP1
  4554         MOVE +3                 TO  AGE-INDEX.                   ELCRESP1
  4555                                                                  ELCRESP1
  4556     GO TO 0300-CALCULATE-RESERVES.                               ELCRESP1
  4557                                                                  ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4559 0200-CALCULATE-YEARS.                                            ELCRESP1
  4560     DIVIDE +12 INTO MONTH-INDEX.                                 ELCRESP1
  4561                                                                  ELCRESP1
  4562     MOVE MONTH-INDEX            TO  TERM-INDEX-DIFF.             ELCRESP1
  4563                                                                  ELCRESP1
  4564     IF YEAR-INDEX LESS +1  AND                                   ELCRESP1
  4565        NOT CP-CDT-INTERPOLATED                                   ELCRESP1
  4566         MOVE +1                 TO  YEAR-INDEX.                  ELCRESP1
  4567                                                                  ELCRESP1
  4568     IF (WS-DISABILITY-TABLE = +5 AND                             ELCRESP1
  4569         YEAR-INDEX LESS +15)                                     ELCRESP1
  4570       OR                                                         ELCRESP1
  4571        (WS-DISABILITY-TABLE = +6 AND                             ELCRESP1
  4572         YEAR-INDEX LESS +14)                                     ELCRESP1
  4573       OR                                                         ELCRESP1
  4574        (WS-DISABILITY-TABLE = +7 AND                             ELCRESP1
  4575         YEAR-INDEX LESS +13)                                     ELCRESP1
  4576       OR                                                         ELCRESP1
  4577        (WS-DISABILITY-TABLE = +8 AND                             ELCRESP1
  4578         YEAR-INDEX LESS +12)                                     ELCRESP1
  4579       OR                                                         ELCRESP1
  4580        (WS-DISABILITY-TABLE = +9 AND                             ELCRESP1
  4581         YEAR-INDEX LESS +13)                                     ELCRESP1
  4582             GO TO 0305-CALCULATE-RESERVES.                       ELCRESP1
  4583                                                                  ELCRESP1
  4584     COMPUTE WS-EXPIRE-AGE =                                      ELCRESP1
  4585                           CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12).ELCRESP1
  4586                                                                  ELCRESP1
  4587     COMPUTE YEAR-INDEX = (WS-DISABILITY-TABLE * -1) + 5.         ELCRESP1
  4588                                                                  ELCRESP1
  4589     IF WS-EXPIRE-AGE GREATER +65                                 ELCRESP1
  4590         ADD +19                 TO  YEAR-INDEX                   ELCRESP1
  4591         MOVE ZERO               TO  TERM-INDEX-DIFF              ELCRESP1
  4592         GO TO 0300-CALCULATE-RESERVES.                           ELCRESP1
  4593                                                                  ELCRESP1
  4594     IF WS-EXPIRE-AGE GREATER +60                                 ELCRESP1
  4595         ADD +18  TO  YEAR-INDEX                                  ELCRESP1
  4596         COMPUTE TERM-INDEX-DIFF = (WS-EXPIRE-AGE - +60) / +5     ELCRESP1
  4597         IF AGE-INDEX GREATER +6                                  ELCRESP1
  4598             MOVE +6             TO  AGE-INDEX                    ELCRESP1
  4599             GO TO 0300-CALCULATE-RESERVES                        ELCRESP1
  4600           ELSE                                                   ELCRESP1
  4601             GO TO 0300-CALCULATE-RESERVES.                       ELCRESP1
  4602                                                                  ELCRESP1
  4603     IF WS-EXPIRE-AGE GREATER +55                                 ELCRESP1
  4604         ADD +17  TO  YEAR-INDEX                                  ELCRESP1
  4605         COMPUTE TERM-INDEX-DIFF = (WS-EXPIRE-AGE - +55) / +5     ELCRESP1
  4606         IF AGE-INDEX GREATER +5                                  ELCRESP1
  4607             MOVE +5             TO  AGE-INDEX                    ELCRESP1
  4608             GO TO 0300-CALCULATE-RESERVES                        ELCRESP1
  4609           ELSE                                                   ELCRESP1
  4610             GO TO 0300-CALCULATE-RESERVES.                       ELCRESP1
  4611                                                                  ELCRESP1
  4612     IF WS-EXPIRE-AGE GREATER +50                                 ELCRESP1
  4613         ADD +16  TO  YEAR-INDEX                                  ELCRESP1
  4614         COMPUTE TERM-INDEX-DIFF = (WS-EXPIRE-AGE - +50) / +5     ELCRESP1
  4615         IF AGE-INDEX GREATER +4                                  ELCRESP1
  4616             MOVE +4             TO  AGE-INDEX                    ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4617             GO TO 0300-CALCULATE-RESERVES                        ELCRESP1
  4618           ELSE                                                   ELCRESP1
  4619             GO TO 0300-CALCULATE-RESERVES.                       ELCRESP1
  4620                                                                  ELCRESP1
  4621     ADD +15  TO  YEAR-INDEX.                                     ELCRESP1
  4622     MOVE ZERO                   TO  TERM-INDEX-DIFF.             ELCRESP1
  4623                                                                  ELCRESP1
  4624     IF AGE-INDEX GREATER +3                                      ELCRESP1
  4625         MOVE +3             TO  AGE-INDEX.                       ELCRESP1
  4626                                                                  ELCRESP1
  4627     GO TO 0300-CALCULATE-RESERVES.                               ELCRESP1
  4628                                                                  ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4630 0300-CALCULATE-RESERVES.                                         ELCRESP1
  4631                                                                  ELCRESP1
  4632     ADD TERM-INDEX-DIFF  TO  TERM-INDEX.                         ELCRESP1
  4633                                                                  ELCRESP1
  4634 0305-CALCULATE-RESERVES.                                         ELCRESP1
  4635                                                                  ELCRESP1
  4636     IF CP-CDT-METHOD EQUAL '4'                                   ELCRESP1
  4637         ADD +0.5  AGE-INDEX  GIVING  AGE-INDEX2                  ELCRESP1
  4638         ADD +0.9167   TERM-INDEX GIVING  TERM-INDEX2             ELCRESP1
  4639     ELSE                                                         ELCRESP1
  4640     IF CP-CDT-INTERPOLATED                                       ELCRESP1
  4641         GO TO 0310-CALCULATE-RESERVES                            ELCRESP1
  4642     ELSE                                                         ELCRESP1
  4643     IF CP-CDT-ROUND-NEAR                                         ELCRESP1
  4644         ADD +0.5  AGE-INDEX  GIVING  AGE-INDEX2                  ELCRESP1
  4645         ADD +0.5  TERM-INDEX GIVING  TERM-INDEX2                 ELCRESP1
  4646     ELSE                                                         ELCRESP1
  4647     IF CP-CDT-ROUND-HIGH                                         ELCRESP1
  4648         ADD +0.9167   AGE-INDEX  GIVING  AGE-INDEX2              ELCRESP1
  4649         ADD +0.9167   TERM-INDEX GIVING  TERM-INDEX2.            ELCRESP1
  4650                                                                  ELCRESP1
  4651     IF CP-COMPANY-ID = 'UFL' OR 'UFR' OR 'WFL' OR 'WSL' OR 'CSL' ELCRESP1
  4652         ADD +0.5  AGE-INDEX  GIVING  AGE-INDEX2                  ELCRESP1
  4653         ADD +0.9167   TERM-INDEX GIVING  TERM-INDEX2.            ELCRESP1
  4654                                                                  ELCRESP1
  4655     SET TWA-INDEX1  TO  TERM-INDEX2.                             ELCRESP1
  4656     SET TWA-INDEX2  TO  AGE-INDEX2.                              ELCRESP1
  4657                                                                  ELCRESP1
  4658     IF TWA-INDEX1 LESS +1                                        ELCRESP1
  4659         MOVE ZERO               TO  RESERVE-FACTOR               ELCRESP1
  4660       ELSE                                                       ELCRESP1
  4661         MOVE TWA-FACTOR (TWA-INDEX1, TWA-INDEX2)                 ELCRESP1
  4662                                 TO  RESERVE-FACTOR.              ELCRESP1
  4663                                                                  ELCRESP1
  4664     GO TO 0400-CALCULATE-FUTURE-RESERVES.                        ELCRESP1
  4665                                                                  ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4667 0310-CALCULATE-RESERVES.                                         ELCRESP1
  4668     MOVE AGE-INDEX              TO  AGE-INDEX-LOW                ELCRESP1
  4669                                     AGE-INDEX-HIGH               ELCRESP1
  4670                                     AGE-INDEX-DIFF.              ELCRESP1
  4671                                                                  ELCRESP1
  4672     IF WS-DISABLED-AGE LESS +22                                  ELCRESP1
  4673         MOVE ZERO               TO  AGE-INDEX-LOW  AGE-INDEX-HIGHELCRESP1
  4674         DIVIDE WS-DISABLED-AGE BY +22                            ELCRESP1
  4675                                 GIVING AGE-INDEX-DIFF ROUNDED.   ELCRESP1
  4676                                                                  ELCRESP1
  4677     MOVE TERM-INDEX             TO  TERM-INDEX-LOW               ELCRESP1
  4678                                     TERM-INDEX-HIGH.             ELCRESP1
  4679                                                                  ELCRESP1
  4680     IF AGE-INDEX-DIFF GREATER ZERO                               ELCRESP1
  4681         ADD +1 TO AGE-INDEX-HIGH.                                ELCRESP1
  4682                                                                  ELCRESP1
  4683     IF TERM-INDEX-DIFF GREATER ZERO                              ELCRESP1
  4684         ADD +1 TO TERM-INDEX-HIGH.                               ELCRESP1
  4685                                                                  ELCRESP1
  4686     IF TERM-INDEX-LOW LESS +1                                    ELCRESP1
  4687         MOVE ZERO               TO  FACTOR-A                     ELCRESP1
  4688       ELSE                                                       ELCRESP1
  4689     IF AGE-INDEX-LOW LESS +1                                     ELCRESP1
  4690         COMPUTE FACTOR-A =                                       ELCRESP1
  4691             TWA-FACTOR (TERM-INDEX-LOW, AGE-INDEX-HIGH) *        ELCRESP1
  4692                                 AGE-INDEX-DIFF                   ELCRESP1
  4693       ELSE                                                       ELCRESP1
  4694         COMPUTE FACTOR-A =                                       ELCRESP1
  4695             ((TWA-FACTOR (TERM-INDEX-LOW, AGE-INDEX-HIGH) -      ELCRESP1
  4696               TWA-FACTOR (TERM-INDEX-LOW, AGE-INDEX-LOW)) *      ELCRESP1
  4697                                                AGE-INDEX-DIFF) + ELCRESP1
  4698               TWA-FACTOR (TERM-INDEX-LOW, AGE-INDEX-LOW).        ELCRESP1
  4699                                                                  ELCRESP1
  4700     IF TERM-INDEX-HIGH LESS +1                                   ELCRESP1
  4701         MOVE ZERO               TO  FACTOR-B                     ELCRESP1
  4702       ELSE                                                       ELCRESP1
  4703     IF AGE-INDEX-LOW LESS +1                                     ELCRESP1
  4704         COMPUTE FACTOR-B =                                       ELCRESP1
  4705             TWA-FACTOR (TERM-INDEX-HIGH, AGE-INDEX-HIGH) *       ELCRESP1
  4706                                 AGE-INDEX-DIFF                   ELCRESP1
  4707       ELSE                                                       ELCRESP1
  4708         COMPUTE FACTOR-B =                                       ELCRESP1
  4709             ((TWA-FACTOR (TERM-INDEX-HIGH, AGE-INDEX-HIGH) -     ELCRESP1
  4710               TWA-FACTOR (TERM-INDEX-HIGH, AGE-INDEX-LOW)) *     ELCRESP1
  4711                                                AGE-INDEX-DIFF) + ELCRESP1
  4712               TWA-FACTOR (TERM-INDEX-HIGH, AGE-INDEX-LOW).       ELCRESP1
  4713                                                                  ELCRESP1
  4714     COMPUTE RESERVE-FACTOR = ((FACTOR-B - FACTOR-A) *            ELCRESP1
  4715                               TERM-INDEX-DIFF) + FACTOR-A.       ELCRESP1
  4716                                                                  ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4718 0400-CALCULATE-FUTURE-RESERVES.                                  ELCRESP1
  4719                                                                  ELCRESP1
  4720*    NOTE ******************************************************* ELCRESP1
  4721*         *                                                     * ELCRESP1
  4722*         *          CALCULATE THE FUTURE RESERVE.              * ELCRESP1
  4723*         *******************************************************.ELCRESP1
  4724                                                                  ELCRESP1
  4725     COMPUTE CP-FUTURE-RESERVE =                                  ELCRESP1
  4726                     (CP-ORIGINAL-BENEFIT / 100) * RESERVE-FACTOR.ELCRESP1
  4727                                                                  ELCRESP1
  4728     IF CP-CDT-PERCENT NOT = ZERO                                 ELCRESP1
  4729         COMPUTE CP-FUTURE-RESERVE =                              ELCRESP1
  4730                 CP-FUTURE-RESERVE * (CP-CDT-PERCENT / +100).     ELCRESP1
  4731                                                                  ELCRESP1
  4732     MOVE WS-DISABILITY-TABLE    TO  CP-CDT-TABLE.                ELCRESP1
  4733     MOVE RESERVE-FACTOR         TO  CP-CDT-FACTOR.               ELCRESP1
  4734                                                                  ELCRESP1
  4735     IF CP-COMPANY-ID = 'POS'  AND                                ELCRESP1
  4736        CP-CARRIER = ('3'  OR  '5')                               ELCRESP1
  4737         NEXT SENTENCE                                            ELCRESP1
  4738     ELSE                                                         ELCRESP1
  4739         GO TO 0405-CALCULATE-IBNR-RESERVES.                      ELCRESP1
  4740                                                                  ELCRESP1
  4741     MOVE WS-MONTHS-DISABLED     TO FACTOR-INDEX.                 ELCRESP1
  4742     MOVE ZEROS                  TO RESERVE-FACTOR.               ELCRESP1
  4743     MOVE +0.99585               TO FACTOR-V.                     ELCRESP1
  4744     PERFORM 0403-CALC-POS-RESERVE-FACTOR THRU 0403-POS-EXIT      ELCRESP1
  4745                       WS-REMAINING-TERM TIMES.                   ELCRESP1
  4746                                                                  ELCRESP1
  4747     IF WS-MONTHS-DISABLED = ZEROS                                ELCRESP1
  4748         MOVE +1.000             TO FACTOR-A                      ELCRESP1
  4749     ELSE                                                         ELCRESP1
  4750         IF WS-MONTHS-DISABLED GREATER THAN +40                   ELCRESP1
  4751             MOVE +0.011         TO FACTOR-A                      ELCRESP1
  4752         ELSE                                                     ELCRESP1
  4753             MOVE POS-FACTOR (WS-MONTHS-DISABLED)  TO FACTOR-A.   ELCRESP1
  4754                                                                  ELCRESP1
  4755     COMPUTE CP-FUTURE-RESERVE = ((CP-ORIGINAL-BENEFIT * 2.50) +  ELCRESP1
  4756            ((RESERVE-FACTOR / FACTOR-A) * CP-ORIGINAL-BENEFIT))  ELCRESP1
  4757                                                       * 1.10.    ELCRESP1
  4758                                                                  ELCRESP1
  4759     MOVE ZEROS                  TO CP-CDT-TABLE.                 ELCRESP1
  4760     COMPUTE CP-CDT-FACTOR = RESERVE-FACTOR / FACTOR-A.           ELCRESP1
  4761                                                                  ELCRESP1
  4762     GO TO 0405-CALCULATE-IBNR-RESERVES.                          ELCRESP1
  4763                                                                  ELCRESP1
  4764 0403-CALC-POS-RESERVE-FACTOR.                                    ELCRESP1
  4765                                                                  ELCRESP1
  4766     ADD +1 TO FACTOR-INDEX.                                      ELCRESP1
  4767                                                                  ELCRESP1
  4768     IF FACTOR-INDEX LESS THAN +41                                ELCRESP1
  4769         COMPUTE RESERVE-FACTOR ROUNDED = RESERVE-FACTOR +        ELCRESP1
  4770                        (POS-FACTOR (FACTOR-INDEX) * FACTOR-V)    ELCRESP1
  4771     ELSE                                                         ELCRESP1
  4772         COMPUTE RESERVE-FACTOR ROUNDED = RESERVE-FACTOR +        ELCRESP1
  4773                                          (.011 * FACTOR-V).      ELCRESP1
  4774                                                                  ELCRESP1
  4775     COMPUTE FACTOR-V  =  FACTOR-V * .99585.                      ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4776                                                                  ELCRESP1
  4777* NOTE ********************************************************** ELCRESP1
  4778*      *   FACTOR-V  =  .99585  =  ( 1 / ( 1 + I ))             * ELCRESP1
  4779*      *                                 WHERE I = .05 / 12     * ELCRESP1
  4780*      **********************************************************.ELCRESP1
  4781                                                                  ELCRESP1
  4782 0403-POS-EXIT.                                                   ELCRESP1
  4783     EXIT.                                                        ELCRESP1
  4784                                                                  ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4786 0405-CALCULATE-IBNR-RESERVES.                                    ELCRESP1
  4787                                                                  ELCRESP1
  4788*    NOTE ******************************************************* ELCRESP1
  4789*         *                                                     * ELCRESP1
  4790*         *          CALCULATE THE I.B.N.R. RESERVE.            * ELCRESP1
  4791*         *******************************************************.ELCRESP1
  4792                                                                  ELCRESP1
  4793     MOVE CP-VALUATION-DT        TO  DC-BIN-DATE-1.               ELCRESP1
  4794                                                                  ELCRESP1
  4795     IF CP-IBNR-RESERVE-SW = '2'                                  ELCRESP1
  4796         MOVE -6                 TO  DC-ELAPSED-MONTHS            ELCRESP1
  4797     ELSE                                                         ELCRESP1
  4798         MOVE -3                 TO  DC-ELAPSED-MONTHS.           ELCRESP1
  4799                                                                  ELCRESP1
  4800     MOVE ZERO                   TO  DC-ELAPSED-DAYS.             ELCRESP1
  4801     MOVE '6'                    TO  DC-OPTION-CODE.              ELCRESP1
  4802     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4803                                                                  ELCRESP1
  4804     IF DC-ERROR-CODE NOT = SPACES                                ELCRESP1
  4805         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4806         GO TO 0999-EXIT.                                         ELCRESP1
  4807                                                                  ELCRESP1
  4808     MOVE DC-BIN-DATE-2          TO  WS-VALUATION-DATE-3.         ELCRESP1
  4809                                                                  ELCRESP1
  4810     IF CP-INCURRED-DT LESS WS-VALUATION-DATE-3  AND              ELCRESP1
  4811        CP-REPORTED-DT GREATER WS-VALUATION-DATE-3                ELCRESP1
  4812         MOVE CP-FUTURE-RESERVE  TO  CP-IBNR-RESERVE              ELCRESP1
  4813     ELSE                                                         ELCRESP1
  4814         MOVE ZERO               TO  CP-IBNR-RESERVE.             ELCRESP1
  4815                                                                  ELCRESP1
  4816     IF CP-CLAIM-STATUS = 'C'                                     ELCRESP1
  4817         GO TO 0500-PTC-RESERVE.                                  ELCRESP1
  4818                                                                  ELCRESP1
  4819     IF CP-COMPANY-ID = 'POS'                                     ELCRESP1
  4820       IF CP-CARRIER = '3'  OR  '5'                               ELCRESP1
  4821           COMPUTE CP-IBNR-RESERVE = CP-ORIGINAL-BENEFIT * 1.10.  ELCRESP1
  4822                                                                  ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4824*    NOTE ******************************************************* ELCRESP1
  4825*         *                                                     * ELCRESP1
  4826*         *        CALCULATE THE PAY-TO-CURRENT RESERVE.        * ELCRESP1
  4827*         ******************************************************* ELCRESP1
  4828                                                                  ELCRESP1
  4829 0415-CALCULATE-PTC-RESERVE.                                      ELCRESP1
  4830                                                                  ELCRESP1
  4831*    IF CP-COMPANY-ID NOT = 'FIM'                                 ELCRESP1
  4832*        GO TO 0420-PTC-RESERVE.                                  ELCRESP1
  4833                                                                  ELCRESP1
  4834     GO TO 0420-PTC-RESERVE.                                      ELCRESP1
  4835                                                                  ELCRESP1
  4836     MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1.               ELCRESP1
  4837     MOVE CP-VALUATION-DT        TO  DC-BIN-DATE-2.               ELCRESP1
  4838     MOVE '1'                    TO  DC-OPTION-CODE.              ELCRESP1
  4839     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4840                                                                  ELCRESP1
  4841     IF DC-ERROR-CODE NOT = SPACE                                 ELCRESP1
  4842         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4843         GO TO 0999-EXIT.                                         ELCRESP1
  4844                                                                  ELCRESP1
  4845     MOVE DC-GREG-DATE-A-EDIT    TO  WS-DATE-WORK.                   CL**2
  4846     MOVE WS-DW-DAY              TO  WS-WK-DAY.                   ELCRESP1
  4847                                                                  ELCRESP1
  4848     MOVE DC-GREG-DATE-B-EDIT    TO  WS-DATE-WORK.                   CL**2
  4849     MOVE WS-DW-CCYR             TO  WS-WK-CCYR.                     CL**2
  4850     MOVE WS-DW-MONTH            TO  WS-WK-MONTH.                 ELCRESP1
  4851                                                                  ELCRESP1
  4852     MOVE WS-WORK-CYMD           TO  DC-GREG-DATE-CYMD.              CL**2
  4853     MOVE 'L'                    TO  DC-OPTION-CODE.                 CL**2
  4854     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4855                                                                  ELCRESP1
  4856     IF DC-ERROR-CODE NOT = SPACES                                ELCRESP1
  4857         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4858         GO TO 0999-EXIT.                                         ELCRESP1
  4859                                                                  ELCRESP1
  4860     MOVE DC-BIN-DATE-1          TO WS-VALUATION-DATE-2.          ELCRESP1
  4861                                                                  ELCRESP1
  4862 0420-PTC-RESERVE.                                                ELCRESP1
  4863                                                                  ELCRESP1
  4864     IF CP-COMPANY-ID = 'POS'                                     ELCRESP1
  4865       IF CP-CARRIER = ('3'  OR  '5')                             ELCRESP1
  4866           COMPUTE CP-PTC-RESERVE = CP-ORIGINAL-BENEFIT * 1.65    ELCRESP1
  4867           GO TO 0500-PTC-RESERVE.                                ELCRESP1
  4868                                                                  ELCRESP1
  4869     IF CP-PAID-THRU-DT = LOW-VALUES                              ELCRESP1
  4870         MOVE CP-INCURRED-DT     TO  DC-BIN-DATE-1                ELCRESP1
  4871     ELSE                                                         ELCRESP1
  4872         MOVE CP-PAID-THRU-DT    TO  DC-BIN-DATE-1.               ELCRESP1
  4873                                                                  ELCRESP1
  4874     MOVE CP-VALUATION-DT        TO  DC-BIN-DATE-2.               ELCRESP1
  4875                                                                  ELCRESP1
  4876*    IF CP-COMPANY-ID = 'FIM'                                     ELCRESP1
  4877*        IF WS-VALUATION-DATE-2  LESS CP-VALUATION-DT             ELCRESP1
  4878*            MOVE WS-VALUATION-DATE-2 TO  DC-BIN-DATE-2.          ELCRESP1
  4879*                                                                 ELCRESP1
  4880     if cp-company-id = 'AHL'
  4881        if dc-bin-date-1 > dc-bin-date-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4882           move dc-bin-date-1    to dc-bin-date-2
  4883           move cp-valuation-dt  to dc-bin-date-1
  4884           move '1'              to dc-option-code
  4885           perform 8500-date-conversion
  4886           if dc-error-code = spaces
  4887              compute cp-ptc-reserve =
  4888                 cp-original-benefit * (dc-elapsed-months +
  4889                 (dc-odd-days-over / 30))
  4890              compute cp-ptc-reserve = cp-ptc-reserve * -1
  4891              move zero          to cp-return-code
  4892              go to 0500-ptc-reserve
  4893           end-if
  4894        end-if
  4895     end-if
  4896     IF DC-BIN-DATE-2 GREATER WS-EXPIRE-DATE                      ELCRESP1
  4897        MOVE WS-EXPIRE-DATE      TO  DC-BIN-DATE-2.               ELCRESP1
  4898                                                                  ELCRESP1
  4899     IF DC-BIN-DATE-1 NOT LESS DC-BIN-DATE-2                      ELCRESP1
  4900         MOVE ZERO               TO  CP-RETURN-CODE               ELCRESP1
  4901         GO TO 0500-PTC-RESERVE.                                  ELCRESP1
  4902                                                                  ELCRESP1
  4903     MOVE '1'                    TO  DC-OPTION-CODE.              ELCRESP1
  4904     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4905                                                                  ELCRESP1
  4906     IF DC-ERROR-CODE NOT = SPACES                                ELCRESP1
  4907         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4908         GO TO 0999-EXIT.                                         ELCRESP1
  4909                                                                  ELCRESP1
  4910     IF CP-CRITICAL-PERIOD
  4911        IF DC-ELAPSED-MONTHS > CP-CRITICAL-MONTHS
  4912           MOVE CP-CRITICAL-MONTHS TO DC-ELAPSED-MONTHS
  4913           MOVE ZEROS            TO DC-ODD-DAYS-OVER
  4914        ELSE
  4915           IF CP-CRITICAL-MONTHS = DC-ELAPSED-MONTHS
  4916              MOVE ZEROS         TO DC-ODD-DAYS-OVER
  4917           END-IF
  4918        END-IF
  4919     END-IF
  4920
  4921     COMPUTE CP-PTC-RESERVE =                                     ELCRESP1
  4922         CP-ORIGINAL-BENEFIT * (DC-ELAPSED-MONTHS +               ELCRESP1
  4923                                   (DC-ODD-DAYS-OVER / 30)).      ELCRESP1
  4924                                                                  ELCRESP1
  4925     MOVE ZERO                   TO  CP-RETURN-CODE.              ELCRESP1
  4926                                                                  ELCRESP1
  4927 0500-PTC-RESERVE.                                                ELCRESP1
  4928     IF CP-IBNR-RESERVE-SW NOT = '2'                              ELCRESP1
  4929         GO TO 0999-EXIT.                                         ELCRESP1
  4930                                                                  ELCRESP1
  4931     IF CP-INCURRED-DT LESS WS-VALUATION-DATE-3  AND              ELCRESP1
  4932        CP-REPORTED-DT GREATER WS-VALUATION-DATE-3                ELCRESP1
  4933         NEXT SENTENCE                                            ELCRESP1
  4934     ELSE                                                         ELCRESP1
  4935         GO TO 0999-EXIT.                                         ELCRESP1
  4936                                                                  ELCRESP1
  4937     IF CP-CLAIM-STATUS = 'C'                                     ELCRESP1
  4938         MOVE CP-TOTAL-PAID      TO  CP-IBNR-RESERVE              ELCRESP1
  4939         GO TO 0999-EXIT.                                         ELCRESP1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ELRESVX.cbl (/apps/prod/cid1p/copy/ELCRESP1)
  4940                                                                  ELCRESP1
  4941     MOVE CP-INCURRED-DT         TO  DC-BIN-DATE-1.               ELCRESP1
  4942*    IF CP-COMPANY-ID = 'FIM'                                     ELCRESP1
  4943*        MOVE WS-VALUATION-DATE-2 TO  DC-BIN-DATE-2               ELCRESP1
  4944*    ELSE                                                         ELCRESP1
  4945     MOVE CP-VALUATION-DT     TO  DC-BIN-DATE-2.                  ELCRESP1
  4946                                                                  ELCRESP1
  4947     MOVE '1'                     TO  DC-OPTION-CODE.             ELCRESP1
  4948                                                                  ELCRESP1
  4949     PERFORM 8500-DATE-CONVERSION.                                ELCRESP1
  4950                                                                  ELCRESP1
  4951     IF DC-ERROR-CODE NOT = SPACES                                ELCRESP1
  4952         MOVE '2'                TO  CP-RETURN-CODE               ELCRESP1
  4953         GO TO 0999-EXIT.                                         ELCRESP1
  4954                                                                  ELCRESP1
  4955     COMPUTE CP-IBNR-RESERVE = CP-IBNR-RESERVE +                  ELCRESP1
  4956             (CP-ORIGINAL-BENEFIT * (DC-ELAPSED-MONTHS +          ELCRESP1
  4957                                 (DC-ODD-DAYS-OVER / 30))).       ELCRESP1
  4958                                                                  ELCRESP1
  4959 0999-EXIT.                                                       ELCRESP1
  4960
  4961     if cp-company-id = 'AHL'
  4962        continue
  4963     else
  4964        IF CP-PTC-RESERVE < ZERO
  4965           MOVE ZERO             TO CP-PTC-RESERVE
  4966        end-if
  4967     end-if
  4968
  4969*    IF CP-COMPANY-ID = 'FIM'  AND  CP-AH-CLAIM                   ELCRESP1
  4970*        COMPUTE CP-FUTURE-RESERVE =                              ELCRESP1
  4971*                         CP-FUTURE-RESERVE - CP-PTC-RESERVE.     ELCRESP1
  4972*                                                                 ELCRESP1
  4973     IF CP-FUTURE-RESERVE NOT GREATER ZERO                        ELCRESP1
  4974         MOVE ZERO               TO  CP-FUTURE-RESERVE.           ELCRESP1
  4975                                                                  ELCRESP1
  4976     IF CP-IBNR-RESERVE NOT GREATER ZERO                          ELCRESP1
  4977         MOVE ZERO               TO  CP-IBNR-RESERVE.             ELCRESP1
  4978                                                                  ELRESVX
  4979     IF CP-RETURN-CODE NOT = ZERO                                 ELRESVX
  4980         MOVE ZERO               TO  CP-RESERVE-REMAINING-TERM    ELRESVX
  4981       ELSE                                                       ELRESVX
  4982         MOVE WS-REMAINING-TERM  TO  CP-RESERVE-REMAINING-TERM.   ELRESVX
  4983                                                                  ELRESVX
  4984     GOBACK.                                                      ELRESVX
  4985                                                                  ELRESVX
  4987 8500-DATE-CONVERSION SECTION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ELRESVX.cbl
*                                    COPY ELCDCS.                       ELRESVX
  4988****************************************************************  04/15/98
  4989*                                                              *  ELCDCS
  4990*                                                              *  ELCDCS
  4991*                            ELCDCS.                           *     LV003
  4992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4993*                            VMOD=2.002                        *     CL**3
  4994*                                                              *  ELCDCS
  4995*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  4996****************************************************************. ELCDCS
  4997                                                                  ELCDCS
  4998 8510-DATE-CONVERSION.                                            ELCDCS
  4999     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5000                                                                  ELCDCS
  5001 8590-EXIT.                                                       ELCDCS
  5002     EXIT.                                                        ELCDCS
  5003                                                                  ELCDCS
  5004                                                                  ELRESVX
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10964     Code:        4204
