* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   1
* ECS050.cbl
* Options: int("ECS050.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS050.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/16/94 13:28:34.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.072.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   2
* ECS050.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        CREATES ALPHA/GAAP FILES.
    27*
    28*    DESCRIPTION OF PROGRAM OPTIONS.
    29*
    30*    1  -  CREATE ALPHA EXTRACT ONLY.
    31*    2  -  CREATE GAAP EXTRACT ONLY.
    32*    3  -  CREATE BOTH ALPHA AND GAAP EXTRACTS.
    33******************************************************************
    34*                   C H A N G E   L O G
    35*
    36* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    37*-----------------------------------------------------------------
    38*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    39* EFFECTIVE    NUMBER
    40*-----------------------------------------------------------------
    41* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    42* 010303    2001061800003  PEMA  ADD DCC PROCESSING
    43* 061703                   PEMA  REMOVE O/W COMM FROM COMM
    44* 061703                         CALC FOR DCC ONLY
    45* 073003                   PEMA BYPASS MORT PROCESSING
    46*                               FOR SALA ACCOUNT
    47* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
    48* 020305    2005020400002  PEMA  ADD CLP STATE PROCESSING
    49* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    50* 062806  CR2006012300001  PEMA  CHANGE STAT UEP FOR OH
    51* 092607    2007031200001  PEMA  ADD AGE ADJUSTMENT
    52* 043008  CR2008030600001  PEMA  VA RULE OF ANTIC
    53* 123109  CR2009020500001  PEMA  CORRECT TERM CALC
    54* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    55* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
    56* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    57* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    58* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    59* 032612  CR2011110200001  PEMA  AHL CHANGES
    60* 042412    2011110200001  PEMA  MORE AHL CHANGES
    61* 013013  CR2012072400002  PEMA  ADD 2013 TABLES
    62* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    63******************************************************************
    64
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   3
* ECS050.cbl
    66 ENVIRONMENT DIVISION.
    67 CONFIGURATION SECTION.
    68 INPUT-OUTPUT SECTION.
    69 FILE-CONTROL.
    70
    71     SELECT CERT-MASTER      ASSIGN TO SYS011-UT-2400-S-SYS011.
    72
    73     SELECT ERACCTT          ASSIGN TO SYS015-FBA1-ERACCTT
    74                             ACCESS IS SEQUENTIAL
    75                             ORGANIZATION IS INDEXED
    76                             FILE STATUS IS ERACCTT-FILE-STATUS
    77                             RECORD KEY IS AM-CONTROL-PRIMARY.
    78
    79     SELECT ERRTBL-IN        ASSIGN TO SYS014-FBA1-ERRTBLT
    80                             ACCESS IS DYNAMIC
    81                             ORGANIZATION IS INDEXED
    82                             FILE STATUS IS ERRTBL-FILE-STATUS
    83                             RECORD KEY IS RE-CONTROL-PRIMARY.
    84
    85     SELECT ERMEBL           ASSIGN SYS024-FBA1-ERMEBL
    86                             ACCESS DYNAMIC
    87                             ORGANIZATION INDEXED
    88                             FILE STATUS ERMEBL-FILE-STATUS
    89                             RECORD KEY ME-CONTROL-PRIMARY.
    90
    91     SELECT ERPDEF           ASSIGN TO ERPDEF
    92                             ACCESS IS DYNAMIC
    93                             ORGANIZATION IS INDEXED
    94                             FILE STATUS IS ERPDEF-FILE-STATUS
    95                             RECORD KEY IS PD-CONTROL-PRIMARY.
    96
    97     SELECT GAAP-EXTRACT     ASSIGN TO SYS012-UT-2400-S-SYS012.
    98
    99     SELECT ALPHA-EXTRACT    ASSIGN TO SYS013-UT-2400-S-SYS013.
   100
   101     SELECT PRINTER          ASSIGN TO SYS008-UR-1403-S-SYS008.
   102
   103     SELECT DISK-DATE        ASSIGN TO SYS019-UT-FBA1-S-SYS019.
   104
   105     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   4
* ECS050.cbl
   107 DATA DIVISION.
   108 FILE SECTION.
   109
   110 FD  CERT-MASTER
   111     BLOCK CONTAINS 0 RECORDS
   112     RECORDING MODE F.
   113
*  114     COPY ECSCRT01.
   115******************************************************************
   116*                                                                *
   117*                            ECSCRT01                            *
   118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   119*                            VMOD=2.016                          *
   120*                                                                *
   121*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   122*                                                                *
   123*   FILE TYPE = SEQUENTIAL
   124*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   125*                                                                *
   126*   KEY DATA =                         START=4, LEN=36           *
   127*                                                                *
   128*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   129*                                                                *
   130******************************************************************
   131******************************************************************
   132*                   C H A N G E   L O G
   133*
   134* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   135*-----------------------------------------------------------------
   136*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   137* EFFECTIVE    NUMBER
   138*-----------------------------------------------------------------
   139* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   140* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   141* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   142* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   143* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   144* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   145* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   146* 032612  CR2011110200001  PEMA  AHL CHANGES
   147******************************************************************
   148
   149 01  CERTIFICATE-RECORD.
   150     12  CR-RECORD-ID                      PIC XX.
   151         88  VALID-CR-ID                      VALUE 'CR'.
   152
   153     12  CR-COMPANY-CD                     PIC X.
   154
   155     12  CR-FULL-CONTROL.
   156         16  CR-CONTROL-1.
   157             20  CR-ACCT-CONTROL.
   158                 24  CR-CARRIER            PIC X.
   159                 24  CR-GROUPING.
   160                     28  CR-GROUP-PREFIX   PIC XXX.
   161                     28  CR-GROUP-PRIME    PIC XXX.
   162                 24  CR-STATE              PIC XX.
   163                 24  CR-ACCOUNT.
   164                     28  CR-ACCT-PREFIX    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   5
* ECS050.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   165                     28  CR-ACCT-PRIME     PIC X(6).
   166             20  CR-DT                     PIC 9(11)  COMP-3.
   167         16  CR-CERT-NO.
   168             20  CR-CERT.
   169                 24  CR-CERT-PREFIX        PIC X(3).
   170                 24  CR-CERT-PRIME         PIC X(7).
   171             20  CR-CERT-SFX               PIC X.
   172
   173     12  CR-INSUREDS-PROFILE.
   174         16  CR-NAME.
   175             20  CR-LNAME                  PIC X(15).
   176             20  CR-FNAME.
   177                 24  CR-1ST-INITIAL        PIC X.
   178                 24  FILLER                PIC X(9).
   179             20  CR-INIT                   PIC X.
   180         16  CR-AGE                        PIC 99.
   181         16  CR-SEX                        PIC X.
   182             88  CR-SEX-MALE                  VALUE 'M'.
   183             88  CR-SEX-FEMALE                VALUE 'F'.
   184         16  CR-SOC-SEC                    PIC X(11).
   185         16  CR-JOINT-NAME.
   186             20  CR-JT-LNAME               PIC X(15).
   187             20  CR-JT-FNAME.
   188                 24  CR-JT-1ST-INIT        PIC X.
   189                 24  FILLER                PIC X(9).
   190             20  CR-JT-INIT                PIC X.
   191         16  CR-JOINT-AGE                  PIC 99.
   192
   193         16  cr-ahl-ah-claim-no            pic x(9).
   194         16  cr-ahl-ah-cert-seq            pic x(3).
   195         16  cr-hst-proc-lf                pic x.
   196         16  f                             pic x(7).
   197
   198     12  CR-LF-COVERAGE-DATA.
   199         16  CR-LFTYP                      PIC XX.
   200         16  CR-LF-TERM                    PIC S999       COMP-3.
   201         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   202         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   203         16  CR-LF-DEV-CODE                PIC XXX.
   204         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   205
   206         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   207         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   208         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   209         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   210
   211         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   212         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   213         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   214         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   215
   216         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   217         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   218
   219         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   220         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   221
   222         16  CR-LF-REFUND-TYPE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   6
* ECS050.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   223         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   224
   225         16  CR-LF-COMM-CHARGEBACK         PIC X.
   226             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   227
   228         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   229
   230         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   231         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   232         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   233
   234         16  cr-ahl-lf-claim-no            pic x(9).
   235         16  cr-ahl-lf-cert-seq            pic x(3).
   236         16  FILLER                        PIC XX.
   237
   238     12  CR-AH-COVERAGE-DATA.
   239         16  CR-AHTYP                      PIC XX.
   240         16  CR-AH-TERM                    PIC S999       COMP-3.
   241         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   242         16  CR-AH-DEV-CODE                PIC XXX.
   243         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   244
   245         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   246         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   247         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   248         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   249
   250         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   251         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   252
   253         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   254         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   255
   256         16  CR-AH-REFUND-TYPE             PIC X.
   257         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   258
   259         16  CR-AH-COMM-CHARGEBACK         PIC X.
   260             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   261
   262         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   263
   264         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   265         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   266         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   267
   268         16  FILLER                        PIC XX.
   269*        16  FILLER                        PIC X(8).
   270
   271     12  CR-LOAN-DATA.
   272         16  CR-LIVES                      PIC S9(7)      COMP-3.
   273         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   274                                           PIC S9(5)V99   COMP-3.
   275         16  CR-BILLED                     PIC S9(7)      COMP-3.
   276         16  CR-APR                        PIC S999V9(4)  COMP-3.
   277         16  CR-PMT-FREQ                   PIC 99.
   278         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   279         16  CR-RATING-CLASS               PIC XX.
   280         16  CR-POLICY-FORM-NO             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   7
* ECS050.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   281         16  CR-GRPTYP                     PIC XX.
   282         16  CR-IND-GRP                    PIC X.
   283             88  CR-INDIVIDUAL                VALUE '1'.
   284             88  CR-GROUP                     VALUE '2'.
   285         16  CR-SKIP                       PIC 99.
   286             88  NO-MONTHS-SKIPPED            VALUE 00.
   287             88  SKIP-JULY                    VALUE 01.
   288             88  SKIP-AUGUST                  VALUE 02.
   289             88  SKIP-SEPTEMBER               VALUE 03.
   290             88  SKIP-JULY-AUG                VALUE 04.
   291             88  SKIP-AUG-SEPT                VALUE 05.
   292             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   293             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   294             88  SKIP-JUNE                    VALUE 08.
   295             88  SKIP-JUNE-JULY               VALUE 09.
   296             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   297             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   298         16  CR-RESIDENT-STATE             PIC XX.
   299         16  CR-RATE-CODE.
   300             20  CR-LF-CLASS-CD            PIC XX.
   301             20  CR-AH-CLASS-CD            PIC XX.
   302         16  CR-MORT.
   303             20  CR-TAB                    PIC X.
   304             20  CR-INT                    PIC 99.
   305             20  CR-GRP                    PIC X.
   306         16  CR-MEMBER-NO                  PIC X(12).
   307         16  CR-OLD-LOF                    PIC XXX.
   308*        16  CR-LOAN-OFFICER               PIC XXX.
   309         16  CR-REIN-TABLE                 PIC XXX.
   310         16  CR-REIN-SPEC                  PIC X.
   311         16  CR-LOAN-1ST-PMT-DT.
   312             20  CR-1ST-PMT-YR             PIC 99.
   313             20  CR-1ST-PMT-MO             PIC 99.
   314             20  CR-1ST-PMT-DA             PIC 99.
   315         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   316         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   317         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   318         16  CR-LAST-ADD-ON-DT             PIC XX.
   319
   320         16  CR-UNDERWRITING-CODE          PIC X.
   321             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   322
   323         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   324         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   325         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   326         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   327
   328     12  CR-STATUS-INFORMATION.
   329         16  CR-ENTRY-STATUS               PIC X.
   330             88  CR-NORMAL-ENTRY              VALUE '1'.
   331             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   332             88  CR-CONVERSION-ENTRY          VALUE '4'.
   333             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   334             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   335             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   336             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   337             88  CR-POLICY-IS-VOID            VALUE 'V'.
   338             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   8
* ECS050.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   339             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   340                                                    '5' '9' 'P'.
   341         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   342
   343         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   344         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   345         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   346
   347         16  CR-LF-STATUS-AT-DEATH         PIC X.
   348         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   349
   350         16  CR-LF-CURRENT-STATUS          PIC X.
   351             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   352             88  CR-LF-POLICY-PENDING         VALUE '2'.
   353             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   354             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   355             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   356             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   357             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   358             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   359             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   360             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   361             88  CR-LF-IS-DECLINED            VALUE 'D'.
   362             88  CR-LF-IS-VOID                VALUE 'V'.
   363             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   364                                                    '4' '5' '9'.
   365
   366         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   367
   368         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   369         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   370
   371         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   372         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   373
   374         16  CR-AH-CURRENT-STATUS          PIC X.
   375             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   376             88  CR-AH-POLICY-PENDING         VALUE '2'.
   377             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   378             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   379             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   380             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   381             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   382             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   383             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   384             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   385             88  CR-AH-IS-DECLINED            VALUE 'D'.
   386             88  CR-AH-IS-VOID                VALUE 'V'.
   387             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   388                                                    '4' '5' '9'.
   389         16  CR-LOAN-OFFICER               PIC X(5).
   390         16  CR-CANCEL-REASON              PIC X.
   391         16  cr-xycor-lf-cov-code          pic x(4).
   392         16  cr-xycor-ah-cov-code          pic x(4).
   393         16  FILLER                        PIC X(6).
   394
   395     12  CR-DEATH-CLAIM-DATA.
   396         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page   9
* ECS050.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   397
   398         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   399         16  CR-DTH-RPT-DT.
   400             20  CR-DTH-RPT-YR             PIC 99.
   401             20  CR-DTH-RPT-MO             PIC 99.
   402             20  CR-DTH-RPT-DA             PIC 99.
   403         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   404
   405         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   406         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   407         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   408         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   409         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   410
   411         16  CR-DTH-AGE                    PIC 99.
   412         16  CR-DTH-PAY-CD                 PIC X.
   413         16  CR-DEATH-CAUSE                PIC X(6).
   414
   415         16  FILLER                        PIC X(16).
   416
   417     12  CR-DISAB-CLAIM-DATA.
   418         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   419
   420         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   421         16  CR-DIS-RPT-DT.
   422             20  CR-DIS-RPT-YR             PIC 99.
   423             20  CR-DIS-RPT-MO             PIC 99.
   424             20  CR-DIS-RPT-DA             PIC 99.
   425         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   426         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   427
   428         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   429         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   430         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   431         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   432         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   433
   434         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   435         16  CR-DIS-PAY-CD                 PIC X.
   436         16  FILLER                        PIC XX.
   437
   438         16  CR-DISAB-INCURRED-DETAIL.
   439             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   440**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   441                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   442                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   443                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   444
   445         16  CR-DISAB-CAUSE                PIC X(6).
   446         16  FILLER                        PIC X(14).
   447
   448     12  CR-REMIT-TO                       PIC 99.
   449
   450     12  CR-COMPENSATION-LEVELS.
   451         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   452             20  CR-COM-AGT.
   453                 24  CR-COM-AGT-PREFIX     PIC X(4).
   454                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  10
* ECS050.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   455             20  CR-AGT-TYPE               PIC X.
   456             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   457             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   458
   459     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   460     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   461     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   462     12  CR-CLP-STATE                      PIC XX.
   463     12  CR-POST-CARD-IND                  PIC X.
   464     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   465     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   466     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   467     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   468     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   469     12  FILLER                            PIC X(07).
   470
   471     12  CR-CSR-CODE                       PIC XXX.
   472
   473     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   474     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   475
   476     12  CR-MICROFILM-NUMBERS.
   477*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   478         16  FILLER                        PIC X(5).
   479     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   480
   481     12  CR-USER-CODE                      PIC X.
   482     12  CR-USER-FUTURE                    PIC X(9).
   483
   484     12  CR-BENEFICIARY.
   485         16  CR-BANK-NO                    PIC X(10).
   486         16  FILLER                        PIC X(15).
   487
   488     12  CR-ENTRY-BATCH                    PIC X(6).
   489     12  CR-LF-EXIT-BATCH                  PIC X(6).
   490     12  CR-AH-EXIT-BATCH                  PIC X(6).
   491
   492     12  CR-NOTE-SW                        PIC X.
   493
   494     12  CR-ORIGIN-INDICATOR               PIC X.
   495         88  CR-ENTERED-MANUALLY              VALUE '1'.
   496         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   497
   498     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   499     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   500     12  FILLER                            PIC X(33).
   501
   502******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  11
* ECS050.cbl
   504 FD  ERACCTT.
   505
*  506     COPY ERCACCT.
   507******************************************************************04/19/98
   508*                                                                *ERCACCT
   509*                                                                *ERCACCT
   510*                            ERCACCT                             *   LV031
   511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   512*                            VMOD=2.031                          *ERCACCT
   513*                                                                *ERCACCT
   514*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   515*                                                                *ERCACCT
   516*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   517*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   518*                                                                *ERCACCT
   519*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   520*                                                                *ERCACCT
   521*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   522*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   523*                                                                *ERCACCT
   524*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   525*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   526*                                                                *ERCACCT
   527*   LOG = NO                                                     *ERCACCT
   528*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   529*                                                                *ERCACCT
   530*                                                                *ERCACCT
   531******************************************************************ERCACCT
   532*                   C H A N G E   L O G
   533*
   534* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   535*-----------------------------------------------------------------
   536*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   537* EFFECTIVE    NUMBER
   538*-----------------------------------------------------------------
   539* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   540* 092705    2005050300006  PEMA  ADD SPP LEASES
   541* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   542* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   543* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   544* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   545* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   546******************************************************************
   547                                                                  ERCACCT
   548 01  ACCOUNT-MASTER.                                              ERCACCT
   549     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   550         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   551                                                                  ERCACCT
   552     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   553         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   554         16  AM-MSTR-CNTRL.                                       ERCACCT
   555             20  AM-CONTROL-A.                                    ERCACCT
   556                 24  AM-CARRIER            PIC X.                 ERCACCT
   557                 24  AM-GROUPING.                                 ERCACCT
   558                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   559                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   560                 24  AM-STATE              PIC XX.                ERCACCT
   561                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  12
* ECS050.cbl (/apps/prod/cid1p/copy/ERCACCT)
   562                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   563                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   564             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   565                                           PIC X(19).             ERCACCT
   566             20  AM-CNTRL-B.                                      ERCACCT
   567                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   568                 24  FILLER                PIC X(4).              ERCACCT
   569             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   570                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   571                                                                  ERCACCT
   572     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   573         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   574         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   575         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   576         16  AM-VG-STATE                   PIC XX.                ERCACCT
   577         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   578         16  AM-VG-DATE.                                          ERCACCT
   579             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   580             20  FILLER                    PIC X(4).              ERCACCT
   581         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   582                                           PIC 9(11)      COMP-3. ERCACCT
   583     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   584         16  FILLER                        PIC X(10).
   585         16  AM-VG-KEY3.
   586             20  AM-VG3-ACCOUNT            PIC X(10).
   587             20  AM-VG3-EXP-DT             PIC XX.
   588         16  FILLER                        PIC X(4).
   589     12  AM-MAINT-INFORMATION.                                    ERCACCT
   590         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   591         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   592         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   593         16  FILLER                        PIC XX.                ERCACCT
   594                                                                  ERCACCT
   595     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   596     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   597                                                                  ERCACCT
   598     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   599         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   600         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   601                                                                  ERCACCT
   602     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   603     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   604                                                                  ERCACCT
   605     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   606     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   607                                                                  ERCACCT
   608     12  AM-NAME                           PIC X(30).             ERCACCT
   609     12  AM-PERSON                         PIC X(30).             ERCACCT
   610     12  AM-ADDRS                          PIC X(30).             ERCACCT
   611     12  AM-CITY.
   612         16  AM-ADDR-CITY                  PIC X(28).
   613         16  AM-ADDR-STATE                 PIC XX.
   614     12  AM-ZIP.                                                  ERCACCT
   615         16  AM-ZIP-PRIME.                                        ERCACCT
   616             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   617                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   618             20  FILLER                    PIC X(4).              ERCACCT
   619         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  13
* ECS050.cbl (/apps/prod/cid1p/copy/ERCACCT)
   620     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   621         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   622         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   623         16  FILLER                        PIC XXX.               ERCACCT
   624     12  AM-TEL-NO.                                               ERCACCT
   625         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   626         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   627         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   628     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   629         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   630         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   631                                                                  ERCACCT
   632     12  AM-COMM-STRUCTURE.                                       ERCACCT
   633         16  AM-DEFN-1.                                           ERCACCT
   634             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   635                 24  AM-AGT.                                      ERCACCT
   636                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   637                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   638                 24  AM-COM-TYP            PIC X.                 ERCACCT
   639                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   640                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   641                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   642                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   643                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   644                 24  AM-GL-CODES           PIC X.                 ERCACCT
   645                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   646                 24  FILLER                PIC X(01).             ERCACCT
   647         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   648             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   649                 24  FILLER                PIC X(11).             ERCACCT
   650                 24  AM-L-COMA             PIC XXX.               ERCACCT
   651                 24  AM-J-COMA             PIC XXX.               ERCACCT
   652                 24  AM-A-COMA             PIC XXX.               ERCACCT
   653                 24  FILLER                PIC X(6).              ERCACCT
   654                                                                  ERCACCT
   655     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   656         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   657                                                                  ERCACCT
   658     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   659                                                                  ERCACCT
   660     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   661         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   662         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   663     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   664         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   665         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   666     12  AM-GPCD                           PIC 99.                ERCACCT
   667     12  AM-IG                             PIC X.                 ERCACCT
   668         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   669         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   670     12  AM-STATUS                         PIC X.                 ERCACCT
   671         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   672         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   673         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   674         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   675         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   676         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   677     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  14
* ECS050.cbl (/apps/prod/cid1p/copy/ERCACCT)
   678     12  AM-ID-NO                          PIC X(11).             ERCACCT
   679                                                                  ERCACCT
   680     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   681     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   682     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   683     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   684     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   685     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   686     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   687     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   688     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   689                                                                  ERCACCT
   690     12  AM-USER-FIELDS.                                          ERCACCT
   691         16  AM-FLD-1                      PIC XX.                ERCACCT
   692         16  AM-FLD-2                      PIC XX.                ERCACCT
   693         16  AM-FLD-3                      PIC XX.                ERCACCT
   694         16  AM-FLD-4                      PIC XX.                ERCACCT
   695         16  AM-FLD-5                      PIC XX.                ERCACCT
   696                                                                  ERCACCT
   697     12  AM-1ST-PROD-DATE.                                        ERCACCT
   698         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   699         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   700         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   701     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   702     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   703         16  AM-PUR-YR                     PIC XX.                ERCACCT
   704         16  AM-PUR-MO                     PIC XX.                ERCACCT
   705         16  AM-PUR-DA                     PIC XX.                ERCACCT
   706     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   707     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   708     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   709     12  AM-INACTIVE-DATE.                                        ERCACCT
   710         16  AM-INA-MO                     PIC 99.                ERCACCT
   711         16  AM-INA-DA                     PIC 99.                ERCACCT
   712         16  AM-INA-YR                     PIC 99.                ERCACCT
   713     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   714                                                                  ERCACCT
   715     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   716     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   717                                                                  ERCACCT
   718     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   719         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   720         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   721         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   722         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   723                                                                  ERCACCT
   724     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   725         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   726         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   727                                                                  ERCACCT
   728     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   729                                                                  ERCACCT
   730     12  AM-OVER-SHORT.                                           ERCACCT
   731         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   732         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   733                                                                  ERCACCT
   734     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   735     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  15
* ECS050.cbl (/apps/prod/cid1p/copy/ERCACCT)
   736                                                                  ERCACCT
   737     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   738     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   739                                                                  ERCACCT
   740     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   741     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   742     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   743     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   744     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   745     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   746     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   747     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   748     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   749     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   750     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   751     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   752     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   753     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   754     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   755     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   756                                                                  ERCACCT
   757     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   758                                                                  ERCACCT
   759     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   760     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   761                                                                  ERCACCT
   762     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   763     12  AM-EARN-METHODS.                                         ERCACCT
   764         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   765             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   766             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   767             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   768             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   769         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   770             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   771             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   772             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   773             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   774         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   775             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   776             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   777             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   778             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   779             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   780             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   781                                                                  ERCACCT
   782     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   783     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   784     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   785                                                                  ERCACCT
   786     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   787     12  AM-RET-P-E                        PIC X.                 ERCACCT
   788     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   789     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   790     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   791     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   792         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   793         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  16
* ECS050.cbl (/apps/prod/cid1p/copy/ERCACCT)
   794     12  AM-RETRO-EARNINGS.                                       ERCACCT
   795         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   796         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   797         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   798     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   799         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   800         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   801     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   802         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   803         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   804         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   805     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   806     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   807                                                                  ERCACCT
   808     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   809         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   810         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   811         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   812         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   813         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   814                                                                  ERCACCT
   815     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   816                                                                  ERCACCT
   817     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   818                                                                  ERCACCT
   819     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   820         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   821                                                                  ERCACCT
   822     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   823         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   824         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   825                                                                  ERCACCT
   826     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   827         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   828                                                                  ERCACCT
   829     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   830         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   831         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   832                                                                  ERCACCT
   833     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   834                                                                  ERCACCT
   835     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   836     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   837     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   838     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   839     12  AM-DCC-UEF-STATE                  PIC XX.
   840     12  FILLER                            PIC XXX.
   841     12  AM-REPORT-CODE-3                  PIC X(10).
   842*    12  FILLER                            PIC X(22).             ERCACCT
   843                                                                  ERCACCT
   844     12  AM-RESERVE-DATE.                                         ERCACCT
   845         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   846         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   847         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   848                                                                  ERCACCT
   849     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   850     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   851         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  17
* ECS050.cbl (/apps/prod/cid1p/copy/ERCACCT)
   852         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   853         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   854         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   855                                                                  ERCACCT
   856     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   857         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   858         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   859         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   860         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   861                                                                  ERCACCT
   862     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   863         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   864             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   865             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   866             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   867             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   868             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   869             20  FILLER                    PIC XX.                ERCACCT
   870         16  FILLER                        PIC X(80).             ERCACCT
   871                                                                  ERCACCT
   872     12  AM-TRANSFER-DATA.                                        ERCACCT
   873         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   874             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   875             20  AM-TRNFROM-GROUPING.                             ERCACCT
   876                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   877                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   878             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   879             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   880                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   881                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   882             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   883         16  AM-TRANSFERRED-TO.                                   ERCACCT
   884             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   885             20  AM-TRNTO-GROUPING.                               ERCACCT
   886                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   887                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   888             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   889             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   890                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   891                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   892             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   893         16  FILLER                        PIC X(10).             ERCACCT
   894                                                                  ERCACCT
   895     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   896                                                                  ERCACCT
   897     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   898         16  AM-DEFN-1-SAVED.                                     ERCACCT
   899             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   900                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   901                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   902                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   903                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   904                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   905                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   906                 24  FILLER                PIC X.                 ERCACCT
   907                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   908                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   909                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  18
* ECS050.cbl (/apps/prod/cid1p/copy/ERCACCT)
   910         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   911             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   912                 24  FILLER                PIC X(11).             ERCACCT
   913                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   914                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   915                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   916                 24  FILLER                PIC X(6).              ERCACCT
   917                                                                  ERCACCT
   918     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   919         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   920            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   921            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   922            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   923                                                                  ERCACCT
   924     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   925     12  FILLER                            PIC X(120).            ERCACCT
   926                                                                  ERCACCT
   927     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   928         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   929         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   930             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   931             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   932                                                          COMP-3. ERCACCT
   933             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   934                                                          COMP-3. ERCACCT
   935         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   936             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   937             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   938                                                          COMP-3. ERCACCT
   939             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   940                                                          COMP-3. ERCACCT
   941                                                                  ERCACCT
   942     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   943         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   944         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   945         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   946         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   947             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   948                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   949                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   950             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   951                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   952                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   953             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   954                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   955                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   956         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   957             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   958                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   959                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   960                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   961             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   962                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   963                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   964             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   965                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   966                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   967                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  19
* ECS050.cbl (/apps/prod/cid1p/copy/ERCACCT)
   968     12  AM-COMMENTS.                                             ERCACCT
   969         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   970                                                                  ERCACCT
   971     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   972         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   973         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   974         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   975         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   976         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   977             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   978             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   979             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   980             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   981         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   982             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   983             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   984             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   985         16  FILLER                        PIC X(102).            ERCACCT
   986                                                                  ERCACCT
   987     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   988         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   989             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   990             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   991             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   992             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   993             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   994         16  FILLER                          PIC X(10).           ERCACCT
   995******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  20
* ECS050.cbl
   997 FD  ERRTBL-IN.
   998
*  999     COPY ERCREIN.
  1000******************************************************************07/27/93
  1001*                                                                *ERCREIN
  1002*                            ERCREIN                             *   LV009
  1003*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1004*                            VMOD=2.010                          *   CL**9
  1005*                                                                *ERCREIN
  1006*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  1007*                                                                *ERCREIN
  1008*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  1009*                                                                *ERCREIN
  1010*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  1011*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  1012*                                                                *ERCREIN
  1013*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  1014*       ALTERNATE PATH = NONE                                    *ERCREIN
  1015*                                                                *ERCREIN
  1016*   LOG = NO                                                     *ERCREIN
  1017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  1018*                                                                *ERCREIN
  1019******************************************************************ERCREIN
  1020*                   C H A N G E   L O G
  1021*
  1022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1023*-----------------------------------------------------------------
  1024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1025* EFFECTIVE    NUMBER
  1026*-----------------------------------------------------------------
  1027* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  1028* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  1029******************************************************************
  1030 01  REINSURANCE-RECORD.                                          ERCREIN
  1031     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  1032         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  1033                                                                  ERCREIN
  1034     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  1035         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  1036         16  RE-KEY.                                              ERCREIN
  1037             20  RE-CODE                   PIC X.                 ERCREIN
  1038                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  1039                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  1040             20  RE-TABLE                  PIC XXX.               ERCREIN
  1041             20  FILLER                    PIC XXX.               ERCREIN
  1042         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  1043             20  FILLER                    PIC X.                 ERCREIN
  1044             20  RE-COMPANY.                                      ERCREIN
  1045                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  1046                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  1047                                                                  ERCREIN
  1048     12  RE-MAINT-INFORMATION.                                    ERCREIN
  1049         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  1050         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  1051         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  1052         16  FILLER                        PIC X(10).             ERCREIN
  1053                                                                  ERCREIN
  1054     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  21
* ECS050.cbl (/apps/prod/cid1p/copy/ERCREIN)
  1055         16  RE-100-COMP                   PIC 99.                ERCREIN
  1056                                                                  ERCREIN
  1057         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  1058             20  RE-REI-COMP-NO.                                  ERCREIN
  1059                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  1060                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  1061             20  RE-LF-QC                  PIC X.                 ERCREIN
  1062             20  RE-AH-QC                  PIC X.                 ERCREIN
  1063             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  1064             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  1065             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  1066             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  1067             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  1068             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  1069             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  1070             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  1071             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  1072             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  1073             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  1074             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  1075             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  1076             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  1077             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  1078             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  1079             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  1080             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  1081             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  1082             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  1083             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  1084             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  1085             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  1086             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  1087             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  1088             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  1089             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  1090             20  RE-REMAINING              PIC X.                 ERCREIN
  1091             20  RE-LF-RUNOFF-SW           PIC X.                      000
  1092             20  RE-AH-RUNOFF-SW           PIC X.                      000
  1093             20  FILLER                    PIC X(19).                  000
  1094                                                                  ERCREIN
  1095         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  1096         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  1097         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  1098         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  1099             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  1100                                                                  ERCREIN
  1101         16  FILLER                        PIC X(27).             ERCREIN
  1102                                                                  ERCREIN
  1103     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  1104         16  RE-NAME                       PIC X(30).             ERCREIN
  1105         16  RE-LF-PE                      PIC X.                 ERCREIN
  1106         16  RE-AH-PE                      PIC X.                 ERCREIN
  1107         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  1108         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  1109         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  1110         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  1111         16  RE-PRT-ST                     PIC X.                 ERCREIN
  1112         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  22
* ECS050.cbl (/apps/prod/cid1p/copy/ERCREIN)
  1113         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
  1114         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  1115         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  1116         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  1117         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  1118         16  RE-LF-COMM                    PIC X.                 ERCREIN
  1119         16  RE-AH-COMM                    PIC X.                 ERCREIN
  1120         16  RE-LF-TAX                     PIC X.                 ERCREIN
  1121         16  RE-AH-TAX                     PIC X.                 ERCREIN
  1122         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  1123         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  1124         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  1125                                                                  ERCREIN
  1126         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  1127             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  1128                                                                  ERCREIN
  1129         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  1130             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  1131                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  1132                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  1133                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  1134                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  1135             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  1136                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  1137                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  1138                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  1139                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  1140                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  1141                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  1142                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  1143                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  1144             20  FILLER                    PIC XXX.               ERCREIN
  1145             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  1146                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  1147                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  1148                                                                  ERCREIN
  1149         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  1150             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  1151                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  1152                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  1153                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  1154                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  1155             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  1156                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  1157                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  1158                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  1159                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  1160                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  1161                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  1162                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  1163                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  1164             20  FILLER                    PIC XXX.               ERCREIN
  1165             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  1166                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  1167                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  1168                                                                  ERCREIN
  1169         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  1170                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  23
* ECS050.cbl (/apps/prod/cid1p/copy/ERCREIN)
  1171         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
  1172                                                                  ERCREIN
  1173         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  1174         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  1175         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  1176         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  1177         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  1178         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  1179         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  1180         16  RE-MORT-SW                    PIC X.                 ERCREIN
  1181         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  1182             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  1183             88  RE-CEDED                          VALUE 'C'.        CL**2
  1184             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  1185             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  1186                                                                  ERCREIN
  1187         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  1188             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  1189         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  1190             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  1191         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  1192             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  1193         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  1194             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  1195         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  1196             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  1197                                                                     CL**3
  1198         16  RE-PRT-CRSV                   PIC X.                    CL**5
  1199                                                                     CL**5
  1200         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1201                                                                     CL**8
  1202         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1203                                                                     CL**8
  1204         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1205                                                                     CL**9
  1206         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1207             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1208             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1209
  1210         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1211             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1212                                                                     CL**9
  1213         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1214         16  FILLER                        PIC X(2281).              CL**9
  1215                                                                  ERCREIN
  1216         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1217                                                                  ERCREIN
  1218******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  24
* ECS050.cbl
  1220 FD  ERMEBL.
  1221
* 1222     COPY ERCMEBL.
  1223******************************************************************04/29/98
  1224*                                                                 ERCMEBL
  1225*                                                                 ERCMEBL
  1226*                            ERCMEBL                             *   LV004
  1227*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1228*                            VMOD 2.004                          *   CL**2
  1229*                                                                *ERCMEBL
  1230*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1231*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1232*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1233*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1234*                                                                *ERCMEBL
  1235*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1236*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1237*                                                                *ERCMEBL
  1238*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1239*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1240*                                                                *ERCMEBL
  1241******************************************************************ERCMEBL
  1242                                                                  ERCMEBL
  1243 01  MONTH-END-BALANCES.                                          ERCMEBL
  1244     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1245     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1246         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1247         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1248     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1249     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1250     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1251     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1252     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1253     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1254     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1255     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1256     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1257     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1258     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1259     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1260     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1261     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1262     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1263     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1264     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1265     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1266     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1267     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1268     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1269     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1270     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1271     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1272     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1273     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1274     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1275     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1276     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1277     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  25
* ECS050.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1278     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1279     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1280     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1281     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1282     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1283     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1284     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1285     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1286     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1287     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1288     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1289     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1290     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1291     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1292     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1293     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1294     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1295     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1296     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1297     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1298     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1299     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1300     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1301     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1302     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1303     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1304     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1305     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1306     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1307     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1308     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1309     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1310     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1311     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1312     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1313     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1314     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1315     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1316     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1317     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1318     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1319     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1320     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1321     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1322     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1323     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1324     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1325     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1326     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1327     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1328     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1329     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1330     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1331     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1332     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1333     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1334     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1335     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  26
* ECS050.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1336     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1337     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1338     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1339     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1340     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1341     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1342     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1343     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1344     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1345     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1346     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1347     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1348     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1349     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1350     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1351     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1352     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1353     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1354     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1355     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1356     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1357     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1358     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1359     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1360     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1361     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1362     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1363     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1364     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1365     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1366     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1367     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1368     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1369     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1370     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1371     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1372     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1373     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1374     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1375     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1376     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1377     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1378     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1379     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1380     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1381     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1382     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1383     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1384     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1385     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1386     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1387     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1388     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1389     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1390     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1391     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1392     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1393     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  27
* ECS050.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1394     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1395     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1396     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1397     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1398     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1399     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1400     12  FILLER                  PIC  X(88).                         CL**2
  1401******************************************************************ERCMEBL
  1402
  1403 FD  ERPDEF.
  1404
* 1405                             COPY ERCPDEF.
  1406******************************************************************
  1407*                                                                *
  1408*                                                                *
  1409*                            ERCPDEF.                            *
  1410*                                                                *
  1411*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  1412*                                                                *
  1413*    FILE TYPE = VSAM,KSDS                                       *
  1414*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  1415*                                                                *
  1416*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  1417*                                                                *
  1418*    LOG = YES                                                   *
  1419*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1420******************************************************************
  1421 01  PRODUCT-MASTER.
  1422    12  PD-RECORD-ID                 PIC X(02).
  1423        88  VALID-PD-ID                  VALUE 'PD'.
  1424
  1425    12  PD-CONTROL-PRIMARY.
  1426        16  PD-COMPANY-CD            PIC X.
  1427        16  PD-STATE                 PIC XX.
  1428        16  PD-PRODUCT-CD            PIC XXX.
  1429        16  PD-FILLER                PIC X(7).
  1430        16  PD-BEN-TYPE              PIC X.
  1431        16  PD-BEN-CODE              PIC XX.
  1432        16  PD-PROD-EXP-DT           PIC XX.
  1433
  1434    12  FILLER                       PIC X(50).
  1435
  1436    12  PD-PRODUCT-DATA OCCURS 8.
  1437        16  PD-PROD-CODE             PIC X.
  1438            88  PD-PROD-LIFE           VALUE 'L'.
  1439            88  PD-PROD-PROP           VALUE 'P'.
  1440            88  PD-PROD-AH             VALUE 'A'.
  1441            88  PD-PROD-IU             VALUE 'I'.
  1442            88  PD-PROD-GAP            VALUE 'G'.
  1443        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  1444        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1445        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1446        16  PD-MAX-TERM              PIC S999        COMP-3.
  1447        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1448        16  FILLER                   PIC X.
  1449        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1450        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1451        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  28
* ECS050.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  1452        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1453        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1454        16  PD-REC-CRIT-PERIOD       PIC X.
  1455        16  PD-RTW-MOS               PIC 99.
  1456        16  FILLER                   PIC X(5).
  1457
  1458    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1459
  1460    12  PD-TERM-LIMITS OCCURS 15.
  1461        16  PD-LOW-TERM              PIC S999        COMP-3.
  1462        16  PD-HI-TERM               PIC S999        COMP-3.
  1463
  1464*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1465    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1466        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1467        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1468
  1469    12  PD-EARN-FACTORS.
  1470        16  FILLER OCCURS 15.
  1471            20  FILLER OCCURS 15.
  1472                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1473
  1474    12  PD-PRODUCT-DESC              PIC X(80).
  1475    12  PD-TRUNCATED                 PIC X.
  1476    12  FILLER                       PIC X(59).
  1477
  1478    12  PD-MAINT-INFORMATION.
  1479        16  PD-LAST-MAINT-DT         PIC X(02).
  1480        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1481        16  PD-LAST-MAINT-BY         PIC X(04).
  1482
  1483 FD  GAAP-EXTRACT
* 1484     COPY ECSGAPFD.
  1485******************************************************************07/10/97
  1486*                                                                *ECSGAPFD
  1487*                            ECSGAPFD                            *   LV001
  1488*                            VMOD=2.001                          *ECSGAPFD
  1489*                                                                *ECSGAPFD
  1490*  NO  CSO  MODS  IN  COPYBOOK  ECSGAPFD                         *ECSGAPFD
  1491*                                                                *ECSGAPFD
  1492******************************************************************ECSGAPFD
  1493     RECORDING MODE F                                             ECSGAPFD
  1494     LABEL RECORDS STANDARD                                       ECSGAPFD
  1495     BLOCK CONTAINS 0 RECORDS
  1496     RECORD CONTAINS 365 CHARACTERS.                              ECSGAPFD
  1497                                                                  ECSGAPFD
  1498 01  GAAP-EXTRACT-RECORD                   PIC X(365).            ECSGAPFD
  1499                                                                  ECSGAPFD
  1500******************************************************************ECSGAPFD
  1501
  1502 FD  ALPHA-EXTRACT
  1503
* 1504     COPY ECSAEXFD.
  1505******************************************************************07/10/97
  1506*                                                                *ECSAEXFD
  1507*                            ECSAEXFD                            *   LV001
  1508*                            VMOD=2.002                          *ECSAEXFD
  1509*                                                                *ECSAEXFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  29
* ECS050.cbl (/apps/prod/cid1p/copy/ECSAEXFD)
  1510*  NO  CID  MODS  IN  COPYBOOK  ECSAEXFD.                        *ECSAEXFD
  1511*                                                                *ECSAEXFD
  1512******************************************************************ECSAEXFD
  1513     RECORDING MODE F                                             ECSAEXFD
  1514     LABEL RECORDS STANDARD                                       ECSAEXFD
  1515     BLOCK CONTAINS 0 RECORDS
  1516     RECORD CONTAINS 300 CHARACTERS.                              ECSAEXFD
  1517                                                                  ECSAEXFD
  1518 01  ALPHA-EXTRACT-RECORD                  PIC X(300).            ECSAEXFD
  1519                                                                  ECSAEXFD
  1520******************************************************************ECSAEXFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  30
* ECS050.cbl
  1522 FD  DISK-DATE
  1523
* 1524     COPY ELCDTEFD.
  1525******************************************************************04/15/98
  1526*                                                                *ELCDTEFD
  1527*                                                                *ELCDTEFD
  1528*                            ELCDTEFD.                           *   LV002
  1529*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1530*                            VMOD=2.007                          *   CL**2
  1531*                                                                *ELCDTEFD
  1532******************************************************************ELCDTEFD
  1533     BLOCK CONTAINS 0 RECORDS
  1534     RECORDING MODE F.                                            ELCDTEFD
  1535                                                                  ELCDTEFD
  1536 01  DATE-DISK.                                                   ELCDTEFD
  1537     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1538     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1539     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1540     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1541     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1542     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1543     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1544                                                                  ELCDTEFD
  1545 01  DATE-DISK-R.                                                 ELCDTEFD
  1546     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1547     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1548                                     PIC  X(32).                  ELCDTEFD
  1549                                                                  ELCDTEFD
  1550 01  DATE-DISK-T.                                                 ELCDTEFD
  1551     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1552     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1553                                     PIC  X(48).                  ELCDTEFD
  1554                                                                  ELCDTEFD
  1555 01  DATE-DISK-M.                                                 ELCDTEFD
  1556     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1557     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1558                                     PIC  X(48).                  ELCDTEFD
  1559                                                                  ELCDTEFD
  1560 01  DATE-DISK-P.                                                 ELCDTEFD
  1561     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1562     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1563     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1564     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1565         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1566                                     PIC  X.                      ELCDTEFD
  1567         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1568     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1569         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1570             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1571             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1572             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1573             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1574         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1575                                                                  ELCDTEFD
  1576 01  DATE-DISK-E.                                                 ELCDTEFD
  1577     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1578     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1579                                     PIC  X(4).                   ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  31
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1580                                                                  ELCDTEFD
  1581 01  DATE-DISK-C.                                                 ELCDTEFD
  1582     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1583     12  DD-CARR1-SECPAY-SW          PIC  X.
  1584     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1585     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1586     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1587     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1588     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1589     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1590     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1591     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1592     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1593     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1594     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1595     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1596     12  DD-CARR2-SECPAY-SW          PIC  X.
  1597     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1598                                                                  ELCDTEFD
  1599 01  DATE-DISK-OPT.                                               ELCDTEFD
  1600     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1601     12  DD-TLR-DATA.                                             ELCDTEFD
  1602         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1603                                     PIC  X(03).                  ELCDTEFD
  1604     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1605         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1606                                     PIC  X(06).                  ELCDTEFD
  1607     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1608         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1609                                     PIC  X(07).                  ELCDTEFD
  1610         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1611     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1612                                     PIC  X(96).                  ELCDTEFD
  1613******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  32
* ECS050.cbl
  1615 FD  PRINTER
  1616
* 1617     COPY ELCPRTFD.
  1618******************************************************************04/15/98
  1619*                                                                *ELCPRTFD
  1620*                                                                *ELCPRTFD
  1621*                            ELCPRTFD.                           *   LV003
  1622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1623*                            VMOD=2.006                          *ELCPRTFD
  1624******************************************************************ELCPRTFD
  1625     RECORDING MODE F                                             ELCPRTFD
  1626     LABEL RECORDS OMITTED                                        ELCPRTFD
  1627     BLOCK CONTAINS 0 RECORDS
  1628     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  1629 01  PRT.                                                         ELCPRTFD
  1630     12  P-CTL               PIC  X.                                 CL**2
  1631     12  P-DATA              PIC  X(132).                         ELCPRTFD
  1632******************************************************************ELCPRTFD
  1633
  1634 FD  FICH
  1635
* 1636     COPY ELCFCHFD.
  1637******************************************************************04/15/98
  1638*                                                                *ELCFCHFD
  1639*                            ELCFCHFD.                           *   LV003
  1640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1641*                            VMOD=2.004                          *   CL**3
  1642*                                                                *ELCFCHFD
  1643******************************************************************ELCFCHFD
  1644     BLOCK CONTAINS 0 RECORDS
  1645     RECORDING MODE F.                                            ELCFCHFD
  1646                                                                  ELCFCHFD
  1647 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1648******************************************************************ELCFCHFD
  1649
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  33
* ECS050.cbl
  1651 WORKING-STORAGE SECTION.
  1652 77  FILLER  PIC X(32) VALUE '********************************'.
  1653 77  FILLER  PIC X(32) VALUE '     ECS050 WORKING STORAGE     '.
  1654 77  FILLER  PIC X(32) VALUE '********** VMOD=2.072 **********'.
  1655
  1656 77  S1                      PIC S9(4)         COMP   VALUE +00.
  1657 77  SRL                     PIC S9(4)         COMP   VALUE +00.
  1658 77  SAVE-REMAINING-AMT      PIC S9(9)V99      COMP-3.
  1659 77  W-PASS-CTR              PIC S9(4)         COMP   VALUE +00.
  1660 77  WS-CEDE-FACT            PIC S9V9(4)       COMP   VALUE +0.
  1661 77  WS-AGE-ADJUST           PIC 9(7)          VALUE ZEROS.
  1662 77  WS-DISPLAY-AMT          PIC 9(7).99       VALUE ZEROS.
  1663 77  DD-IU-SW                    PIC X   VALUE ' '.
  1664     88  DD-IU-PRESENT                 VALUE 'Y'.
  1665 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  1666 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  1667 77  WS-DDF-MGT-FEE          PIC S9(5)V99 VALUE +0 COMP-3.
  1668 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  1669 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  1670 77  WS-DDF-ADDL-CLP         PIC S9(5)V99 COMP-3 VALUE +0.
  1671 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  1672 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  1673 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  1674 77  WS-MONTH                PIC S999     COMP-3 VALUE +0.
  1675 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  1676 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  1677 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  1678 77  COMM-WK                 PIC S9(7)V9(5) COMP-3 VALUE +0.
  1679 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  1680 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  1681 77  c1                      pic s999     comp-3 value +0.
  1682
  1683 01  MONTH-END-DATA.
  1684     12  ME-START-DATE.
  1685         16  ME-START-MO         PIC 99.
  1686         16  FILLER              PIC X.
  1687         16  ME-START-DA         PIC 99.
  1688         16  FILLER              PIC X.
  1689         16  ME-START-YR         PIC 99.
  1690     12  ME-CNDS-DATE            PIC 9(6).
  1691     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  1692         16  ME-CNDS-MO          PIC 99.
  1693         16  ME-CNDS-DA          PIC 99.
  1694         16  ME-CNDS-YR          PIC 99.
  1695     12  ME-START-TIME           PIC 9(6).
  1696     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  1697         88  ME-DO-UPDATE        VALUE 'Y'.
  1698         88  ME-NO-UPDATE        VALUE 'N'.
  1699     12  ERMEBL-FILE-STATUS      PIC XX.
  1700     12  MONTH-END-MOYR          PIC 9999 COMP.
  1701
  1702 01  ERACCTT-FILE-STATUS         PIC XX       VALUE ZEROS.
  1703 01  ERRTBL-FILE-STATUS          PIC XX       VALUE ZEROS.
  1704 01  ERPDEF-FILE-STATUS          PIC XX       VALUE ZEROS.
  1705
  1706 01  WS-ABEND-DATA.
  1707     12  WS-RETURN-CODE          PIC S9(4)    VALUE ZERO   COMP.
  1708     12  WS-ABEND-MESSAGE        PIC X(80)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  34
* ECS050.cbl
  1709     12  WS-ABEND-FILE-STATUS    PIC XX       VALUE ZERO.
  1710     12  WS-ZERO                 PIC S9       VALUE ZERO   COMP-3.
  1711
  1712     12  WS-ABEND-CODE           PIC 9(4).
  1713     12  WORK-ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  1714         16  W-ABEND-CODE-1      PIC XX.
  1715         16  W-ABEND-CODE-2      PIC XX.
  1716
  1717 01  WORK-CERT-NO.
  1718     12  WK-CERT-PREFIX      PIC X.
  1719     12  FILLER              PIC X(10).
  1720
  1721 01  WORK-REGION.
  1722     12  WK-REGION           PIC XXX.
  1723         88  A-CAPTIVE-ACCOUNT  VALUE '500' THRU '599'
  1724                                      '610' THRU '699'.
  1725     12  FILLER              PIC X(7).
  1726
  1727 01  AH-RES-STATE-TABLE.
  1728     12  FILLER              PIC X(42)       VALUE
  1729             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  1730     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  1731
  1732 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  1733     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  1734
  1735 01  TEXAS-REG-WORK-AREAS.
  1736     12  TEX-FACT-1          PIC S9(9)V9(2)  COMP-3.
  1737     12  TEX-FACT-2          PIC S9(3)       COMP-3.
  1738     12  TEX-FACT-3          PIC S9(3)       COMP-3.
  1739     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  1740     12  TEX-FACT-5          PIC S9(3)       COMP-3.
  1741     12  TEX-FACT-6          PIC S9(3)       COMP-3.
  1742     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  1743     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  1744     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  1745
  1746 01  NET-PAY-INTERFACE.
  1747     12  NP-APR              PIC S9(3)V9(4)  COMP-3.
  1748     12  NP-ORIG             PIC S9(3)       COMP-3.
  1749     12  NP-REM              PIC S9(3)       COMP-3.
  1750     12  NP-OPT              PIC X.
  1751     12  NP-CAP              PIC S9(3)       COMP-3.
  1752     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  1753     12  NP-WORK1            PIC S9(9)V9(6)  COMP-3.
  1754     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  1755     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  1756     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  1757     12  NP-ACCOUNT          PIC X(10).
  1758
  1759 01  WS-OU-TOTALS.
  1760     12  TOT-LF-OVER59       PIC S9(11)V99   COMP-3  VALUE +0.
  1761     12  TOT-LF-UNDER60      PIC S9(11)V99   COMP-3  VALUE +0.
  1762     12  TOT-AH-OVER59       PIC S9(11)V99   COMP-3  VALUE +0.
  1763     12  TOT-AH-UNDER60      PIC S9(11)V99   COMP-3  VALUE +0.
  1764     12  F-TOT-LF-OVER59     PIC S9(11)V99   COMP-3  VALUE +0.
  1765     12  F-TOT-LF-UNDER60    PIC S9(11)V99   COMP-3  VALUE +0.
  1766     12  F-TOT-AH-OVER59     PIC S9(11)V99   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  35
* ECS050.cbl
  1767     12  F-TOT-AH-UNDER60    PIC S9(11)V99   COMP-3  VALUE +0.
  1768
  1769 01  MISC.
  1770     12  WS-CB-SW               PIC X VALUE ' '.
  1771         88  DO-NOT-CHARGE-BACK       VALUE 'X'.
  1772     12  MONTHS-DIFF            PIC S9(5) VALUE +0 COMP-3.
  1773     12  WS-GR-LFCOM            PIC S9(7)V99 VALUE +0 COMP-3.
  1774     12  WS-GR-LFCOM-ALT        PIC S9(7)V99 VALUE +0 COMP-3.
  1775     12  WS-GR-AHCOM            PIC S9(7)V99 VALUE +0 COMP-3.
  1776     12  WS-NCL-OB-CERT-NO.
  1777         16  WS-OB-1-2          PIC X(02).
  1778         16  WS-OB-3-4          PIC X(02).
  1779         16  FILLER             PIC X(07) VALUE 'OBUNRN '.
  1780
  1781     12  WS-NCL-OB-DATES-TBL OCCURS 3.
  1782         16  WS-NCL-OB-DATES    PIC 9(08).
  1783**** 1ST CURRENT RUN DATE
  1784**** 2ND LAST MONTH END DATE
  1785**** 3RD MONTH B/4 LAST MONTH END DATE
  1786         16  WS-NCL-OB-DATES-R  REDEFINES WS-NCL-OB-DATES.
  1787             20  WS-OB-CCYY      PIC 9(04).
  1788             20  WS-OB-CCYR  REDEFINES  WS-OB-CCYY.
  1789                 24  WS-OB-CC    PIC 9(02).
  1790                 24  WS-OB-YR    PIC 9(02).
  1791             20  WS-OB-MO        PIC 9(02).
  1792             20  WS-OB-DA        PIC 9(02).
  1793     12  WS-OB-DATE-1-SWITCH     PIC X     VALUE SPACES.
  1794         88  OB-DATE-1-USED         VALUE '*'.
  1795     12  WS-OB-DATE-2-SWITCH     PIC X     VALUE SPACES.
  1796         88  OB-DATE-2-USED         VALUE '*'.
  1797     12  WS-OB-DATE-3-SWITCH     PIC X     VALUE SPACES.
  1798         88  OB-DATE-3-USED         VALUE '*'.
  1799     12  WS-HOLD-AM-CONTROL      PIC X(19) VALUE LOW-VALUES.
  1800     12  WS-HOLD-CERT            PIC X(1056)     VALUE SPACES.
  1801     12  WS-NCL-OB-DATA OCCURS 3.
  1802         16  WS-NCL-LIFE-OB OCCURS 20.
  1803             20  WS-LIFE-OB-CODE PIC X(02).
  1804             20  WS-LIFE-PREM    PIC S9(07)V99   COMP-3.
  1805             20  WS-LIFE-BEN     PIC S9(09)V99   COMP-3.
  1806         16  WS-NCL-AH-OB OCCURS 20.
  1807             20  WS-AH-OB-CODE   PIC X(02).
  1808             20  WS-AH-PREM      PIC S9(07)V99   COMP-3.
  1809             20  WS-AH-BEN       PIC S9(07)V99   COMP-3.
  1810     12  LINER               PIC S999        COMP-3 VALUE +80.
  1811     12  SAVE-YR-GP          PIC S9(4)       COMP.
  1812     12  WS-SUM-LF-FACTOR    PIC S99V9(7)    COMP-3 VALUE +0.
  1813     12  WS-SUM-AH-FACTOR    PIC S99V9(7)    COMP-3 VALUE +0.
  1814     12  SA                  PIC S999        COMP.
  1815     12  SB                  PIC S999        COMP.
  1816     12  D1                  PIC S9(5)       COMP.
  1817     12  P1                  PIC S9(5)       COMP.
  1818     12  P2                  PIC S999        COMP.
  1819     12  PGM-SUB             PIC S999        COMP    VALUE +050.
  1820     12  SUB                 PIC S9999       COMP    VALUE +0.
  1821     12  SUBA                PIC S9999       COMP    VALUE +0.
  1822     12  SUBB                PIC S9999       COMP    VALUE +0.
  1823     12  ABEND-CODE          PIC X(4)                VALUE ZEROS.
  1824     12  ABEND-OPTION        PIC X                   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  36
* ECS050.cbl
  1825     12  X                   PIC X                   VALUE ' '.
  1826     12  AH-EARN-METHOD      PIC X                   VALUE SPACE.
  1827     12  AGE-DIFFERENCE      PIC S99                 VALUE ZEROS.
  1828     12  LF-BAL-REMTERM      PIC S999V99     COMP-3  VALUE ZEROS.
  1829     12  LF-REM-TRM1         PIC S999V99     COMP-3  VALUE ZEROS.
  1830     12  LF-REM-TRM2         PIC S999V99     COMP-3  VALUE ZEROS.
  1831     12  AH-REM-TRM1         PIC S999V99     COMP-3  VALUE ZEROS.
  1832     12  AH-REM-TRM2         PIC S999V99     COMP-3  VALUE ZEROS.
  1833     12  SV-LF-BAL-REMTERM   PIC S999V99     COMP-3  VALUE ZEROS.
  1834     12  SV-LF-REM-TRM1      PIC S999V99     COMP-3  VALUE ZEROS.
  1835     12  SV-LF-REM-TRM2      PIC S999V99     COMP-3  VALUE ZEROS.
  1836     12  SV-AH-REM-TRM1      PIC S999V99     COMP-3  VALUE ZEROS.
  1837     12  SV-AH-REM-TRM2      PIC S999V99     COMP-3  VALUE ZEROS.
  1838     12  OLDEST-LF-REMTERM   PIC S999        COMP-3  VALUE ZEROS.
  1839     12  LF-OVER-100         PIC  9(5)               VALUE ZEROS.
  1840     12  OLDEST-AH-REMTERM   PIC S999        COMP-3  VALUE ZEROS.
  1841     12  INTERMED            PIC S9(9)V9(6)  COMP-3.
  1842     12  WS-FACT             PIC S9V9(6)     COMP-3.
  1843     12  WS-LINE             PIC S9(3)       COMP-3  VALUE +99.
  1844     12  WS-PAGE             PIC S9(5)       COMP-3  VALUE ZERO.
  1845     12  SAVE-GAAP-REC       PIC X(365).
  1846     12  SAVE-ALPHA-REC      PIC X(300).
  1847     12  SAVE-MORT-TYP       PIC X.
  1848     12  BGN-DT              PIC X(6).
  1849     12  ERN-START-DATE      PIC 9(8).
  1850     12  ERN-START-DT  REDEFINES ERN-START-DATE.
  1851         16  ESD-CC          PIC 99.
  1852         16  ESD-YR          PIC 99.
  1853         16  ESD-MO          PIC 99.
  1854         16  ESD-DA          PIC 99.
  1855     12  VALUATION-DATE      PIC 9(08).
  1856     12  VALUATION-DATE-N REDEFINES VALUATION-DATE.
  1857         16  VAL-CC          PIC 99.
  1858         16  VAL-YR          PIC 99.
  1859         16  VAL-MO          PIC 99.
  1860         16  VAL-DA          PIC 99.
  1861     12  END-MO              PIC 99.
  1862     12  END-DA              PIC 99.
  1863     12  END-YR              PIC 99.
  1864     12  WS-BIN-CR-DT        PIC XX.
  1865     12  WS-BIN-VAL-DT       PIC XX.
  1866     12  HLD-TRM             PIC S9(3)V99    COMP-3.
  1867     12  TEMP-1              PIC S9(5)V99    COMP-3.
  1868     12  TEMP-2              PIC S9(5)V99    COMP-3.
  1869     12  TEMP-3              PIC S9(2)V9(9)  COMP-3.
  1870     12  TEMP-4              PIC S9(9)V99    COMP-3.
  1871     12  REIN-RT-SW          PIC X               VALUE SPACES.
  1872     12  DTO-CC              PIC 99              VALUE ZEROS.
  1873     12  DTO-YR              PIC 99              VALUE ZEROS.
  1874     12  DTO-MO              PIC 99              VALUE ZEROS.
  1875     12  FLA-CLM-REIN-BASE   PIC S9(5)V99    COMP-3.
  1876     12  ADJ-FLA-REIN-BASE   PIC S9(5)V9(4)  COMP-3.
  1877     12  CLM-INCUR-REIN-DATE.
  1878         16  CIRD-CCYY.
  1879             20  CIRD-CC     PIC 99.
  1880             20  CIRD-YR     PIC 99.
  1881         16  CIRD-MO         PIC 99.
  1882     12  REIN-AGENT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  37
* ECS050.cbl
  1883         16  FILLER          PIC X(4).
  1884         16  RA-RCO          PIC X(6).
  1885     12  DOMICILE-STATE      PIC XX              VALUE SPACES.
  1886     12  CUR-CALC            PIC S9(5)    COMP-3.
  1887     12  ROH-LF-CALC         PIC S9(5)    COMP-3.
  1888     12  ROH-AH-CALC         PIC S9(5)    COMP-3.
  1889     12  PRIOR-CARRIER       PIC X               VALUE SPACES.
  1890         88  PRINTING-FINAL-TOTALS    VALUE '*'.
  1891     12  O-B-SWITCH          PIC X               VALUE SPACES.
  1892         88  O-B-CERTIFICATE          VALUE '*'.
  1893     12  SUMMARY-SWITCH      PIC X               VALUE SPACES.
  1894         88  SUMMARY-CERTIFICATE      VALUE '*'.
  1895     12  O-B-LF-CNT-SW       PIC X               VALUE SPACES.
  1896         88  EXCLUDE-O-B-LF           VALUE '*'.
  1897     12  O-B-AH-CNT-SW       PIC X               VALUE SPACES.
  1898         88  EXCLUDE-O-B-AH           VALUE '*'.
  1899     12  LF-JOINT-SWITCH     PIC X               VALUE SPACES.
  1900         88  JOINT-LF-COVERAGE        VALUE 'J'.
  1901     12  AH-JOINT-SWITCH     PIC X               VALUE SPACES.
  1902         88  JOINT-AH-COVERAGE        VALUE 'J'.
  1903     12  REIN-ALPHA-SW       PIC X               VALUE SPACES.
  1904**   12  WS-CR-BIN-DATE      PIC XX   VALUE SPACES.
  1905**   12  WS-CR-CCYY          PIC 9(04) VALUE ZERO.
  1906**   12  WS-CR-CCYR REDEFINES WS-CR-CCYY.
  1907**       16  WS-CR-CC        PIC 99.
  1908**       16  WS-CR-YY        PIC 99.
  1909**   12  WS-GR-CCYY          PIC 9(04) VALUE ZERO.
  1910**   12  WS-GR-CCYR REDEFINES WS-GR-CCYY.
  1911**       16  WS-GR-CC        PIC 99.
  1912**       16  WS-GR-YY        PIC 99.
  1913
  1914 01  max-pdef                    pic s9(5) comp-3 value +2000.
  1915 01  DCC-DDF-WORK-AREA.
  1916     05  F OCCURS 2000.
  1917         10  DD-STATE                 PIC XX.
  1918         10  DD-PRODUCT-CD            PIC XXX.
  1919         10  DD-FILLER                PIC X(7).
  1920         10  DD-BEN-TYPE              PIC X.
  1921         10  DD-BEN-CODE              PIC XX.
  1922         10  DD-PROD-EXP-DT           PIC XX.
  1923         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  1924         10  DD-PROD-DATA OCCURS 8.
  1925             15  DD-PROD-CODE         PIC X.
  1926             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  1927         10  DD-EARN-FACTORS.
  1928             15  F OCCURS 15.
  1929                 20  F OCCURS 15.
  1930                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1931         10  DD-TRUNCATED             PIC X.
  1932
* 1933     COPY ELCDATE.
  1934******************************************************************06/11/98
  1935*                                                                *ELCDATE
  1936*                                                                *ELCDATE
  1937*                            ELCDATE.                            *   LV023
  1938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1939*                            VMOD=2.003                           ELCDATE
  1940*                                                                *ELCDATE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  38
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1941*                                                                *ELCDATE
  1942*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1943*                 LENGTH = 200                                   *   CL*19
  1944******************************************************************ELCDATE
  1945                                                                  ELCDATE
  1946 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1947     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1948     12  DC-OPTION-CODE                PIC X.                        CL*15
  1949         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1950         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1951         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1952         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1953         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1954         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1955         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1956         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1957         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1958         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1959         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1960         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1961         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1962         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1963         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1964         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1965         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1966         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1967         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1968         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1969         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1970         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1971         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1972         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1973         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1974         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1975         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1976         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1977         88  THREE-CHARACTER-BIN                                  ELCDATE
  1978                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1979         88  GREGORIAN-TO-BIN                                        CL**2
  1980                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1981         88  BIN-TO-GREGORIAN                                        CL**2
  1982                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1983         88  JULIAN-TO-BINARY                                        CL**2
  1984                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1985     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1986         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1987         88  DATE-CONVERSION-ERROR                                ELCDATE
  1988                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1989         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1990         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1991         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1992         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1993         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1994         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1995         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1996         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1997         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1998         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  39
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1999     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2000         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2001     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2002         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2003         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2004         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2005     12  FILLER                        PIC X.                        CL*15
  2006     12  DC-CONVERSION-DATES.                                        CL*15
  2007         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2008         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2009         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2010         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2011                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2012             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2013             20  SLASH1-1              PIC X.                        CL*15
  2014             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2015             20  SLASH1-2              PIC X.                        CL*15
  2016             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2017         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2018         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2019                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2020             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2021             20  SLASH2-1              PIC X.                        CL*15
  2022             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2023             20  SLASH2-2              PIC X.                        CL*15
  2024             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2025         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2026         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2027                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2028             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2029             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2030             20  DC-YMD-DAY            PIC 99.                       CL*15
  2031         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2032         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2033                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2034             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2035             20  DC-MDY-DAY            PIC 99.                       CL*15
  2036             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2037         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2038             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2039             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2040             20  FILLER                PIC XX.                       CL*15
  2041             20  DC-ALPHA-CENTURY.                                   CL*15
  2042                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2043             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2044         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2045         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2046         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2047         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2048         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  2049                                       PIC 9(05).                    CL*20
  2050         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2051             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2052             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2053         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2054         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2055         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2056     12  DATE-CONVERSION-VARIBLES.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  40
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2057         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2058         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2059             20  FILLER                PIC 9(3).                     CL*15
  2060             20  HOLD-CEN-1-CCYY.                                    CL*15
  2061                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2062                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  2063             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  2064             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  2065         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  2066             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  2067             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  2068             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  2069                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  2070                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  2071             20  FILLER                PIC 9(3).                     CL*15
  2072         16  HOLD-CENTURY-1-X.                                       CL*15
  2073             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  2074             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  2075                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  2076                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  2077             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  2078             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  2079         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  2080             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  2081             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  2082             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  2083                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  2084                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  2085             20  FILLER                PIC XXX.                      CL*23
  2086         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  2087         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  2088         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  2089         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  2090             20  DC-JULIAN-1-CCYY.                                   CL*15
  2091                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  2092                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  2093             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  2094         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  2095         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  2096             20  DC-JULIAN-2-CCYY.                                   CL*15
  2097                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2098                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2099             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2100         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2101             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2102             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2103             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2104             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2105             20  DC-EDITA-CCYY.                                      CL*15
  2106                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  2107                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2108         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2109             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2110             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2111             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2112             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2113             20  DC-EDITB-CCYY.                                      CL*15
  2114                 24  DC-EDITB-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  41
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2115                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2116         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2117         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2118                              DC-GREG-DATE-CYMD.                  ELCDATE
  2119             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2120             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2121             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2122             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2123         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2124         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2125                              DC-GREG-DATE-MDCY.                  ELCDATE
  2126             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2127             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2128             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2129             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2130    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2131        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2132    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2133    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  42
* ECS050.cbl
* 2135     COPY ELCCALC.
  2136******************************************************************04/15/98
  2137*                                                                *ELCCALC
  2138*                           ELCCALC.                            *    LV003
  2139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2140*                            VMOD=2.025                          *   CL**3
  2141*                                                                *   CL**2
  2142*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  2143*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  2144*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  2145*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  2146*                                                                *   CL**2
  2147*  PASSED TO ELRTRM                                              *   CL**2
  2148*  -----------------                                             *   CL**2
  2149*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  2150*  ORIGINAL TERM                                                 *   CL**2
  2151*  BEGINNING DATE                                                *   CL**2
  2152*  ENDING DATE                                                   *   CL**2
  2153*  COMPANY I.D.                                                  *   CL**2
  2154*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  2155*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  2156*  FREE LOOK DAYS                                                *   CL**2
  2157*                                                                *   CL**2
  2158*  RETURNED FROM ELRTRM                                          *   CL**2
  2159*  ---------------------                                         *   CL**2
  2160*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  2161*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  2162*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  2163*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  2164*----------------------------------------------------------------*   CL**2
  2165*  PASSED TO ELRAMT                                              *   CL**2
  2166*  ----------------                                              *   CL**2
  2167*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  2168*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2169*  ORIGINAL AMOUNT                                               *   CL**2
  2170*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  2171*  A.P.R. - NET PAY ONLY                                         *   CL**2
  2172*  METHOD                                                            CL**2
  2173*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  2174*  COMPANY I.D.                                                  *   CL**2
  2175*  BENEFIT TYPE                                                  *   CL**2
  2176*                                                                *   CL**2
  2177*  RETURNED FROM ELRAMT                                          *   CL**2
  2178*  --------------------                                          *   CL**2
  2179*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  2180*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  2181*  REMAINING AMOUNT FACTOR                                           CL**2
  2182*----------------------------------------------------------------*   CL**2
  2183*  PASSED TO ELRESV                                              *   CL**2
  2184*  -----------------                                             *   CL**2
  2185*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  2186*  VALUATION DATE                                                *   CL**2
  2187*  PAID THRU DATE                                                *   CL**2
  2188*  BENEFIT                                                       *   CL**2
  2189*  INCURRED DATE                                                 *   CL**2
  2190*  REPORTED DATE                                                 *   CL**2
  2191*  ISSUE AGE                                                     *   CL**2
  2192*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  43
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2193*  CDT PERCENT                                                   *   CL**2
  2194*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  2195* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  2196* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  2197* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  2198*                                                                *   CL**2
  2199*  RETURNED FROM ELRESV                                          *   CL**2
  2200*  --------------------                                          *   CL**2
  2201*  CDT TABLE USED                                                *   CL**2
  2202*  CDT FACTOR USED                                               *   CL**2
  2203*  PAY TO CURRENT RESERVE                                        *   CL**2
  2204*  I.B.N.R. - A/H ONLY                                           *   CL**2
  2205*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  2206*----------------------------------------------------------------*   CL**2
  2207*  PASSED TO ELRATE                                              *   CL**2
  2208*  ----------------                                              *   CL**2
  2209*  CERT ISSUE DATE                                               *   CL**2
  2210*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2211*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2212*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  2213*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2214*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2215*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2216*  DEVIATION CODE                                                *   CL**2
  2217*  ISSUE AGE                                                     *   CL**2
  2218*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2219*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2220*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  2221*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2222*  A.P.R.                                                        *   CL**2
  2223*  METHOD                                                            CL**2
  2224*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2225*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2226*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2227*  BENEFIT CODE                                                  *   CL**2
  2228*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2229*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  2230*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  2231*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  2232*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  2233*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  2234*                                                                *   CL**2
  2235*  RETURNED FROM ELRATE                                          *   CL**2
  2236*  --------------------                                          *   CL**2
  2237*  CALCULATED PREMIUM                                            *   CL**2
  2238*  PREMIUM RATE                                                  *   CL**2
  2239*  MORTALITY CODE                                                *   CL**2
  2240*  MAX ATTAINED AGE                                              *   CL**2
  2241*  MAX AGE                                                       *   CL**2
  2242*  MAX TERM                                                      *   CL**2
  2243*  MAX MONTHLY BENEFIT                                           *   CL**2
  2244*  MAX TOTAL BENIFIT                                             *   CL**2
  2245*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  2246*----------------------------------------------------------------*   CL**2
  2247*  PASSED TO ELRFND                                              *   CL**2
  2248*  ----------------                                              *   CL**2
  2249*  CERT ISSUE DATE                                               *   CL**2
  2250*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  44
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2251*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2252*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2253*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2254*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2255*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2256*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2257*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2258*  DEVIATION CODE                                                *   CL**2
  2259*  ISSUE AGE                                                     *   CL**2
  2260*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2261*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2262*  PROCESS TYPE (CANCEL)                                         *   CL**2
  2263*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2264*  A.P.R.                                                        *   CL**2
  2265*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  2266*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  2267*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2268*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2269*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2270*  BENEFIT CODE                                                  *   CL**2
  2271*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2272*                                                                *   CL**2
  2273*  RETURNED FROM ELRFND                                          *   CL**2
  2274*  --------------------                                          *   CL**2
  2275*  CALCULATED REFUND                                             *   CL**2
  2276*----------------------------------------------------------------*   CL**2
  2277*  PASSED TO ELEARN                                              *   CL**2
  2278*  ----------------                                              *   CL**2
  2279*  CERT ISSUE DATE                                               *   CL**2
  2280*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2281*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2282*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2283*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2284*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2285*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2286*  DEVIATION CODE                                                *   CL**2
  2287*  ISSUE AGE                                                     *   CL**2
  2288*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2289*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2290*  A.P.R.                                                        *   CL**2
  2291*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  2292*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2293*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2294*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2295*  BENEFIT CODE                                                  *   CL**2
  2296*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2297*                                                                *   CL**2
  2298*  RETURNED FROM ELEARN                                          *   CL**2
  2299*  --------------------                                          *   CL**2
  2300*  INDICATED  EARNINGS                                           *   CL**2
  2301*----------------------------------------------------------------*   CL**2
  2302*                 LENGTH = 450                                   *   CL**2
  2303*                                                                *   CL**2
  2304******************************************************************   CL**2
  2305******************************************************************
  2306*                   C H A N G E   L O G
  2307*
  2308* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  45
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2309*-----------------------------------------------------------------
  2310*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2311* EFFECTIVE    NUMBER
  2312*-----------------------------------------------------------------
  2313* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2314* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2315* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2316* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2317* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2318* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2319* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2320* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2321* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2322******************************************************************
  2323                                                                     CL**2
  2324 01  CALCULATION-PASS-AREA.                                          CL**2
  2325     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  2326                                     COMP.                           CL**2
  2327                                                                     CL**2
  2328     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  2329       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  2330       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  2331                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  2332       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  2333       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  2334       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  2335       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  2336       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  2337       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  2338       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  2339       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  2340       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  2341       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  2342       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  2343       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  2344       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  2345       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  2346       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  2347       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  2348       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  2349                                                                     CL**2
  2350     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  2351       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  2352***********************  INPUT AREAS ****************************    CL**2
  2353                                                                     CL**2
  2354     12  CP-CALCULATION-AREA.                                        CL**2
  2355         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  2356         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  2357         16  CP-VALUATION-DT       PIC XX.                           CL**2
  2358         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  2359         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  2360           88  CP-AH                               VALUE 'A' 'D'     CL**2
  2361                                                   'I' 'U'.          CL**2
  2362           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  2363           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  2364         16  CP-INCURRED-DT        PIC XX.                           CL**2
  2365         16  CP-REPORTED-DT        PIC XX.                           CL**2
  2366         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  46
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2367         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  2368         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  2369                                     COMP-3.                         CL**2
  2370         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  2371                                     COMP-3.                         CL**2
  2372         16  CP-CDT-METHOD         PIC X.                            CL**2
  2373           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  2374           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  2375           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  2376         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  2377           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  2378           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  2379         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  2380                                     COMP-3.                         CL**2
  2381         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  2382                                     COMP-3.                         CL**2
  2383         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  2384                                     COMP-3.                         CL**2
  2385         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  2386                                     COMP-3.                         CL**2
  2387         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2388                                     COMP-3.                         CL**2
  2389         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  2390                                     COMP-3.                         CL**2
  2391         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  2392                                     COMP-3.                         CL**2
  2393         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  2394           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  2395           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  2396           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  2397           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  2398           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  2399           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  2400           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  2401         16  CP-EARNING-METHOD     PIC X.                            CL**2
  2402           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  2403           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  2404           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2405           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2406           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2407           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2408           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  2409           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2410           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  2411           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2412           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2413           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2414           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2415           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2416         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  2417           88  CP-CLAIM                            VALUE '1'.        CL**2
  2418           88  CP-CANCEL                           VALUE '2'.        CL**2
  2419           88  CP-ISSUE                            VALUE '3'.        CL**2
  2420         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  2421           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  2422           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  2423           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  2424           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  47
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2425           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  2426           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  2427           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  2428           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  2429           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  2430           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  2431           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  2432           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  2433           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  2434           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  2435           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  2436           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  2437           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  2438           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  2439                                                     'W' 'X'.        CL**2
  2440           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  2441           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  2442           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  2443           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  2444           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  2445           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  2446           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  2447           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  2448           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  2449           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  2450           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  2451           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  2452           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  2453                                                                     CL**2
  2454         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  2455                                     COMP-3.                         CL**2
  2456         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  2457         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  2458         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  2459         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  2460         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  2461           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  2462               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  2463         16  CP-R78-OPTION         PIC X.                            CL**2
  2464           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  2465           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  2466                                                                     CL**2
  2467         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  2468         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  2469         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  2470         16  CP-RATE-FILE          PIC X.                            CL**2
  2471         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  2472                                     COMP-3.                         CL**2
  2473                                                                     CL**2
  2474         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  2475         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  2476                                                                     CL**2
  2477         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  2478                                     COMP-3.
  2479         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2480                                   PIC S9(5)V99 COMP-3.
  2481         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  2482                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  48
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2483         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2484                                     COMP-3.                         CL**2
  2485         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  2486                                     COMP-3.
  2487         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2488                                  PIC S9(7)V99 COMP-3.
  2489                                                                     CL**2
  2490         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  2491         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  2492         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  2493           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  2494           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  2495           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  2496           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  2497         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  2498         16  CP-CARRIER            PIC X.                            CL**2
  2499         16  CP-REIN-FLAG          PIC X.                            CL**2
  2500         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  2501           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  2502                      '2' '3' '4' '5'.                               CL**2
  2503           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  2504           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  2505           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  2506           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  2507           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  2508           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  2509           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  2510           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2511         16  CP-SIG-SWITCH         PIC X.                            CL**2
  2512         16  CP-RATING-METHOD      PIC X.                            CL**2
  2513           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  2514           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  2515           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2516           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2517           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2518           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2519           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  2520           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2521           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2522         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  2523                                     COMP-3.                         CL**2
  2524         16  CP-BEN-CATEGORY       PIC X.
  2525         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2526         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2527                                   PIC S99V9(5) COMP-3.
  2528         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2529         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2530                                   PIC S99V9(5) COMP-3.
  2531         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2532         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2533         16  CP-EXPIRE-DT          PIC XX.
  2534         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2535         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2536         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2537         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2538         16  CP-DDF-SPEC-CALC      PIC X.
  2539             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2540             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  49
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2541         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2542         16  CP-CANCEL-REASON      PIC X.
  2543         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2544         16  CP-PMT-MODE           PIC X.
  2545         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2546         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2547         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2548         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2549         16  FILLER                PIC X.
  2550                                                                     CL**2
  2551***************    OUTPUT FROM ELRESV   ************************     CL**2
  2552                                                                     CL**2
  2553         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  2554                                                                     CL**2
  2555         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  2556                                     COMP-3.                         CL**2
  2557         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  2558                                     COMP-3.                         CL**2
  2559         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  2560                                     COMP-3.                         CL**2
  2561         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  2562                                     COMP-3.                         CL**2
  2563         16  FILLER                PIC X(09).                        CL**2
  2564***************    OUTPUT FROM ELRTRM   *************************    CL**2
  2565                                                                     CL**2
  2566         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  2567                                     COMP-3.                         CL**2
  2568         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  2569                                     COMP-3.                         CL**2
  2570         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  2571                                     COMP-3.                         CL**2
  2572         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  2573                                     COMP-3.                         CL**2
  2574         16  FILLER                PIC X(12).                        CL**2
  2575                                                                     CL**2
  2576***************    OUTPUT FROM ELRAMT   *************************    CL**2
  2577                                                                     CL**2
  2578         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  2579                                     COMP-3.                         CL**2
  2580         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  2581                                     COMP-3.                         CL**2
  2582         16  FILLER                PIC X(12).                        CL**2
  2583                                                                     CL**2
  2584***************    OUTPUT FROM ELRATE   *************************    CL**2
  2585                                                                     CL**2
  2586         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  2587                                     COMP-3.                         CL**2
  2588         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  2589                                     COMP-3.                         CL**2
  2590         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  2591         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  2592             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  2593         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  2594                                     COMP-3.                         CL**2
  2595         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  2596         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2597         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2598                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  50
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2599         16  FILLER                PIC X(07).                        CL**2
  2600                                                                     CL**2
  2601***************    OUTPUT FROM ELRFND   *************************    CL**2
  2602                                                                     CL**2
  2603         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  2604                                     COMP-3.                         CL**2
  2605         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  2606           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  2607           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  2608           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  2609           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  2610           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2611           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  2612           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  2613           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  2614           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2615           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2616           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2617           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2618           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2619           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2620         16  FILLER                PIC X(12).                        CL**2
  2621                                                                     CL**2
  2622***************    OUTPUT FROM ELEARN   *************************    CL**2
  2623                                                                     CL**2
  2624         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  2625                                     COMP-3.                         CL**2
  2626         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  2627                                     COMP-3.                         CL**2
  2628         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  2629                                     COMP-3.                         CL**2
  2630         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  2631                                     COMP-3.                         CL**2
  2632         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  2633                                     COMP-3.                         CL**2
  2634         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  2635                                     COMP-3.                         CL**2
  2636         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  2637           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  2638           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  2639           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  2640           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  2641           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2642           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  2643           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  2644           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  2645           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2646         16  FILLER                PIC X(12).                        CL**2
  2647                                                                     CL**2
  2648***************    OUTPUT FROM ELPMNT   *************************    CL**2
  2649                                                                     CL**2
  2650         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  2651                                     COMP-3.                         CL**2
  2652         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  2653                                     COMP-3.                         CL**2
  2654         16  FILLER                PIC X(12).                        CL**2
  2655                                                                     CL**2
  2656***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  51
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2657         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  2658                                     COMP-3.                         CL**2
  2659         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  2660                                     COMP-3.                         CL**2
  2661         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  2662                                     COMP-3.                         CL**2
  2663         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  2664                                     COMP-3.                         CL**2
  2665         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2666                                     COMP-3.                         CL**2
  2667         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2668                                     COMP-3.                         CL**2
  2669         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  2670             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  2671             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  2672             88  IO-ERROR                         VALUE 'E'.         CL**2
  2673                                                                     CL**2
  2674         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  2675                                                                     CL**2
  2676         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  2677                                                                     CL**2
  2678         16  CP-RESERVE-REMAINING-TERM                               CL**2
  2679                                   PIC S9(4)V9    VALUE ZERO         CL**2
  2680                                     COMP-3.                         CL**2
  2681                                                                     CL**2
  2682         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  2683                                                                     CL**2
  2684         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  2685                                     COMP-3.                         CL**2
  2686                                                                     CL**2
  2687         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  2688                                     COMP-3.                         CL**2
  2689                                                                     CL**2
  2690         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  2691                                     COMP-3.                         CL**2
  2692                                                                     CL**2
  2693         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  2694                                     COMP-3.                         CL**2
  2695                                                                     CL**2
  2696         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  2697                                     COMP-3.                         CL**2
  2698                                                                     CL**2
  2699         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  2700                                     COMP-3.                         CL**2
  2701                                                                     CL**2
  2702         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  2703                                     COMP-3.                         CL**2
  2704                                                                     CL**2
  2705         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  2706             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  2707                                                                     CL**2
  2708         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  2709                                     COMP-3.                         CL**2
  2710         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2711                                     COMP-3.
  2712         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2713         16  FILLER                PIC X(15).                        CL**2
  2714******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  52
* ECS050.cbl
* 2716     COPY ELCREINV.
  2717******************************************************************04/18/98
  2718*                                                                *ELCREINV
  2719*                                                                *ELCREINV
  2720*                            ELCREINV                            *   LV003
  2721*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2722*                            VMOD=2.001                          *ELCREINV
  2723*                                                                *ELCREINV
  2724*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  2725*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  2726*                                                                *ELCREINV
  2727******************************************************************ELCREINV
  2728                                                                  ELCREINV
  2729 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  2730     05  WS-RE-LO-DATE.                                              CL**3
  2731         10 FILLER                     PIC 999.                      CL**3
  2732         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  2733         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  2734            15 RE-LO-CC                PIC 99.                       CL**3
  2735            15 RE-LO-YR                PIC 99.                       CL**3
  2736         10 RE-LO-MO                   PIC 99.                       CL**3
  2737         10 RE-LO-DA                   PIC 99.                       CL**3
  2738     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  2739            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  2740     05  WS-RE-HI-DATE.                                              CL**3
  2741         10 FILLER                     PIC 999.                      CL**3
  2742         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  2743         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  2744            15 RE-HI-CC                PIC 99.                       CL**3
  2745            15 RE-HI-YR                PIC 99.                       CL**3
  2746         10 RE-HI-MO                   PIC 99.                       CL**3
  2747         10 RE-HI-DA                   PIC 99.                       CL**3
  2748     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  2749            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  2750     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  2751         10 FILLER                     PIC 999.                   ELCREINV
  2752         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  2753         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  2754            15 RE-CLM-CC               PIC 99.                    ELCREINV
  2755            15 RE-CLM-YR               PIC 99.                    ELCREINV
  2756         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  2757         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  2758     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  2759            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  2760     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  2761         10  FILLER                    PIC 999.                   ELCREINV
  2762         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  2763         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  2764             15  RE-EARN-CC            PIC 99.                    ELCREINV
  2765             15  RE-EARN-YR            PIC 99.                    ELCREINV
  2766         10  RE-EARN-MO                PIC 99.                    ELCREINV
  2767         10  RE-EARN-DA                PIC 99.                    ELCREINV
  2768     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  2769            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  2770     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  2771         10  FILLER                    PIC 999.                   ELCREINV
  2772         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  2773         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  53
* ECS050.cbl (/apps/prod/cid1p/copy/ELCREINV)
  2774             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  2775             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  2776         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  2777         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  2778     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  2779            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  54
* ECS050.cbl
* 2781     COPY ECSAEX01.
  2782******************************************************************04/29/98
  2783*                                                                *ECSAEX01
  2784*                           ECSAEX01                            *    LV007
  2785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**7
  2786*                           VMOD=2.007                          * ECSAEX01
  2787*                                                                *ECSAEX01
  2788*   FILE DESCRIPTION = ALPHA EXTRACT RECORD                      *ECSAEX01
  2789*                                                                *ECSAEX01
  2790*   FILE TYPE = SEQUENTIAL                                        ECSAEX01
  2791*   RECORD SIZE = 300  RECFORM = FIXED                           *ECSAEX01
  2792*                                                                *ECSAEX01
  2793*   KEY DATA =                         START=4, LEN=36           *ECSAEX01
  2794*                                                                *ECSAEX01
  2795******************************************************************ECSAEX01
  2796                                                                  ECSAEX01
  2797 01  ALPHA-RECORD.                                                ECSAEX01
  2798     12  AX-RECORD-ID                      PIC XX.                ECSAEX01
  2799         88  VALID-AX-ID                      VALUE 'AX'.         ECSAEX01
  2800                                                                  ECSAEX01
  2801     12  AX-COMPANY-CD                     PIC X.                 ECSAEX01
  2802                                                                  ECSAEX01
  2803     12  AX-CONTROL.                                              ECSAEX01
  2804         16  AX-CARRIER                    PIC X.                 ECSAEX01
  2805         16  AX-GROUPING.                                         ECSAEX01
  2806             20  AX-GRP-PREFIX             PIC XXX.               ECSAEX01
  2807             20  AX-GRP-PRIME              PIC XXX.               ECSAEX01
  2808         16  AX-STATE                      PIC XX.                ECSAEX01
  2809         16  AX-ACCOUNT.                                          ECSAEX01
  2810             20  AX-ACCT-PREFIX            PIC X(4).              ECSAEX01
  2811             20  AX-ACCT-PRIME             PIC X(6).              ECSAEX01
  2812         16  AX-DT                         PIC 9(11) COMP-3.      ECSAEX01
  2813         16  AX-CERT-NO.                                          ECSAEX01
  2814             20  AX-CERT.                                         ECSAEX01
  2815                 24  AX-CERT-PREFIX        PIC XXX.               ECSAEX01
  2816                 24  AX-CERT-PRIME         PIC X(7).              ECSAEX01
  2817             20  AX-CERT-SUFFIX            PIC X.                 ECSAEX01
  2818                                                                  ECSAEX01
  2819     12  AX-DATA-AREA.                                            ECSAEX01
  2820         16  AX-NAME.                                             ECSAEX01
  2821             20  AX-LNAME                  PIC X(15).             ECSAEX01
  2822             20  AX-FNAME.                                        ECSAEX01
  2823                 24  AX-1ST-INIT-FNAME     PIC X.                 ECSAEX01
  2824                 24  FILLER                PIC X(9).              ECSAEX01
  2825             20  AX-INIT                   PIC X.                 ECSAEX01
  2826                                                                  ECSAEX01
  2827         16  AX-AGE                        PIC 99.                ECSAEX01
  2828         16  AX-SEX                        PIC X.                 ECSAEX01
  2829                                                                  ECSAEX01
  2830         16  AX-ALPHA-TYPE-CODE            PIC X(1).              ECSAEX01
  2831             88  AX-INSURED-ALPHA             VALUE 'I'.          ECSAEX01
  2832             88  AX-JOINT-ALPHA               VALUE 'J'.          ECSAEX01
  2833             88  AX-REIN-ALPHA                VALUE 'R'.          ECSAEX01
  2834             88  AX-JOINT-REIN-ALPHA          VALUE '9'.          ECSAEX01
  2835             88  AX-O-B-ALPHA                 VALUE 'O'.          ECSAEX01
  2836             88  AX-SUMMARY-ALPHA             VALUE 'S'.          ECSAEX01
  2837                                                                  ECSAEX01
  2838         16  AX-REIN-COMP.                                        ECSAEX01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  55
* ECS050.cbl (/apps/prod/cid1p/copy/ECSAEX01)
  2839             20  AX-REINCO                 PIC X(03).             ECSAEX01
  2840             20  AX-REINCO-SUB             PIC X(03).             ECSAEX01
  2841                                                                  ECSAEX01
  2842         16  AX-LIFE-DATA.                                        ECSAEX01
  2843             20  AX-LF-TYP                 PIC XX.                ECSAEX01
  2844             20  AX-LF-TERM                PIC S999       COMP-3. ECSAEX01
  2845             20  AX-LF-REMTERM             PIC S999       COMP-3. ECSAEX01
  2846             20  AX-LF-AMT                 PIC S9(9)V99   COMP-3. ECSAEX01
  2847             20  AX-LF-REMAMT              PIC S9(9)V99   COMP-3. ECSAEX01
  2848             20  AX-LF-PRM                 PIC S9(7)V99   COMP-3. ECSAEX01
  2849             20  AX-LF-AMT-ALT             PIC S9(9)V99   COMP-3. ECSAEX01
  2850             20  AX-LF-REMAMT-ALT          PIC S9(9)V99   COMP-3. ECSAEX01
  2851             20  AX-LF-PRM-ALT             PIC S9(7)V99   COMP-3. ECSAEX01
  2852             20  AX-LF-REFUND              PIC S9(7)V99   COMP-3. ECSAEX01
  2853             20  AX-LF-CLAIM-PMTS          PIC S9(9)V99   COMP-3. ECSAEX01
  2854                                                                  ECSAEX01
  2855         16  AX-AH-DATA.                                          ECSAEX01
  2856             20  AX-AH-TYP                 PIC XX.                ECSAEX01
  2857             20  AX-AH-TERM                PIC S999       COMP-3. ECSAEX01
  2858             20  AX-AH-REMTERM             PIC S999       COMP-3. ECSAEX01
  2859             20  AX-AH-AMT                 PIC S9(7)V99   COMP-3. ECSAEX01
  2860             20  AX-AH-REMAMT              PIC S9(7)V99   COMP-3. ECSAEX01
  2861             20  AX-AH-PRM                 PIC S9(7)V99   COMP-3. ECSAEX01
  2862             20  AX-AH-REFUND              PIC S9(7)V99   COMP-3. ECSAEX01
  2863             20  AX-AH-CLAIM-PMTS          PIC S9(7)V99   COMP-3. ECSAEX01
  2864                                                                  ECSAEX01
  2865         16  AX-APR                        PIC S999V9(4)  COMP-3. ECSAEX01
  2866         16  AX-IND-GRP                    PIC X.                 ECSAEX01
  2867         16  AX-PMT-FREQ                   PIC 99.                ECSAEX01
  2868         16  AX-SPEC-REIN                  PIC X.                 ECSAEX01
  2869         16  AX-REIN-TABLE                 PIC X(3).              ECSAEX01
  2870         16  AX-MEM-NO                     PIC X(12).             ECSAEX01
  2871         16  AX-SOC-NO                     PIC X(11).             ECSAEX01
  2872                                                                  ECSAEX01
  2873         16  AX-LF-STATUS                  PIC X.                 ECSAEX01
  2874         16  AX-LF-PRE-PLST                PIC X.                 ECSAEX01
  2875         16  AX-LF-CNCL                    PIC 9(11) COMP-3.      ECSAEX01
  2876         16  AX-DEATH                      PIC 9(11) COMP-3.      ECSAEX01
  2877         16  AX-LF-EXIT                    PIC 9(11) COMP-3.      ECSAEX01
  2878         16  AX-LF-EXPIRES                 PIC 9(11) COMP-3.      ECSAEX01
  2879         16  AX-AH-STATUS                  PIC X.                 ECSAEX01
  2880         16  AX-AH-PRE-PLST                PIC X.                 ECSAEX01
  2881         16  AX-AH-CNCL                    PIC 9(11) COMP-3.      ECSAEX01
  2882         16  AX-LUMP-SUM                   PIC 9(11) COMP-3.      ECSAEX01
  2883         16  AX-AH-EXIT                    PIC 9(11) COMP-3.      ECSAEX01
  2884         16  AX-AH-EXPIRES                 PIC 9(11) COMP-3.      ECSAEX01
  2885         16  AX-ENTRY                      PIC 9(11) COMP-3.      ECSAEX01
  2886         16  AX-ENTRY-STATUS               PIC X.                 ECSAEX01
  2887         16  AX-ISS-MICROFILM-NO           PIC S9(09) COMP-3.     ECSAEX01
  2888         16  AX-CAN-MICROFILM-NO           PIC S9(09) COMP-3.     ECSAEX01
  2889         16  FILLER                        PIC X(40).             ECSAEX01
  2890******************************************************************ECSAEX01
* 2891     COPY ELCAEXVR.
  2892******************************************************************04/14/98
  2893*                                                                *ELCAEXVR
  2894*                            ELCAEXVR                            *   LV002
  2895*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2896*                            VMOD=2.001                          *ELCAEXVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  56
* ECS050.cbl (/apps/prod/cid1p/copy/ELCAEXVR)
  2897*                                                                *ELCAEXVR
  2898*   WORKING STORAGE FOR DATE VARIABLES CREATES                   *ELCAEXVR
  2899*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCAEXVR
  2900*                                                                *ELCAEXVR
  2901*  NO  CID  MODS  IN  COPYBOOK  ELCAEXVR                         *ELCAEXVR
  2902******************************************************************ELCAEXVR
  2903 01  WS-ALPHA-RECORD-DATE.                                        ELCAEXVR
  2904     05  WS-AX-DT.                                                ELCAEXVR
  2905         10  FILLER                    PIC 999.                   ELCAEXVR
  2906         10  AX-CCYY                   PIC 9(04).                 ELCAEXVR
  2907         10  AX-CCYR REDEFINES AX-CCYY.                           ELCAEXVR
  2908             15  AX-CC                 PIC 99.                    ELCAEXVR
  2909             15  AX-YR                 PIC 99.                    ELCAEXVR
  2910         10  AX-MO                     PIC 99.                    ELCAEXVR
  2911         10  AX-DA                     PIC 99.                    ELCAEXVR
  2912     05  WS-AX-DT-N REDEFINES                                        CL**2
  2913            WS-AX-DT                   PIC 9(11).                    CL**2
  2914     05  WS-AX-LF-CNCL.                                           ELCAEXVR
  2915         10  FILLER                    PIC 999.                   ELCAEXVR
  2916         10  AX-LF-C-CCYY              PIC 9(04).                 ELCAEXVR
  2917         10  AX-LF-C-CCYR REDEFINES AX-LF-C-CCYY.                 ELCAEXVR
  2918             15  AX-LF-C-CC            PIC 99.                    ELCAEXVR
  2919             15  AX-LF-C-YR            PIC 99.                    ELCAEXVR
  2920         10  AX-LF-C-MO                PIC 99.                    ELCAEXVR
  2921         10  AX-LF-C-DA                PIC 99.                    ELCAEXVR
  2922     05  WS-AX-LF-CNCL-N REDEFINES                                   CL**2
  2923            WS-AX-LF-CNCL             PIC 9(11).                     CL**2
  2924     05  WS-AX-DEATH.                                             ELCAEXVR
  2925         10  FILLER                    PIC 999.                      CL**3
  2926         10  AX-D-CCYY                 PIC 9(04).                 ELCAEXVR
  2927         10  AX-D-CCYR REDEFINES AX-D-CCYY.                       ELCAEXVR
  2928             15  AX-D-CC               PIC 99.                    ELCAEXVR
  2929             15  AX-D-YR               PIC 99.                    ELCAEXVR
  2930         10  AX-D-MO                   PIC 99.                    ELCAEXVR
  2931         10  AX-D-DA                   PIC 99.                    ELCAEXVR
  2932     05  WS-AX-DEATH-N REDEFINES                                     CL**2
  2933            WS-AX-DEATH                PIC 9(11).                    CL**2
  2934     05  WS-AX-LF-EXIT.                                           ELCAEXVR
  2935         10  FILLER                    PIC 999.                   ELCAEXVR
  2936         10  AX-LX-CCYY                PIC 9(04).                 ELCAEXVR
  2937         10  AX-LX-CCYR  REDEFINES AX-LX-CCYY.                    ELCAEXVR
  2938             15  AX-LX-CC              PIC 99.                    ELCAEXVR
  2939             15  AX-LX-YR              PIC 99.                    ELCAEXVR
  2940         10  AX-LX-MO                  PIC 99.                    ELCAEXVR
  2941         10  AX-LX-DA                  PIC 99.                    ELCAEXVR
  2942     05  WS-AX-LF-EXIT-N REDEFINES                                   CL**2
  2943            WS-AX-LF-EXIT              PIC 9(11).                    CL**2
  2944     05  WS-AX-LF-EXPIRES.                                        ELCAEXVR
  2945         10  FILLER                    PIC 999.                   ELCAEXVR
  2946         10  AX-LE-CCYY                PIC 9(04).                 ELCAEXVR
  2947         10  AX-LE-CCYR  REDEFINES AX-LE-CCYY.                    ELCAEXVR
  2948             15  AX-LE-CC              PIC 99.                    ELCAEXVR
  2949             15  AX-LE-YR              PIC 99.                    ELCAEXVR
  2950         10  AX-LE-MO                  PIC 99.                    ELCAEXVR
  2951         10  AX-LE-DA                  PIC 99.                    ELCAEXVR
  2952     05  WS-AX-LF-EXPIRES-N REDEFINES                                CL**2
  2953            WS-AX-LF-EXPIRES           PIC 9(11).                    CL**2
  2954     05  WS-AX-AH-CNCL.                                           ELCAEXVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  57
* ECS050.cbl (/apps/prod/cid1p/copy/ELCAEXVR)
  2955         10  FILLER                    PIC 999.                   ELCAEXVR
  2956         10  AX-AH-C-CCYY              PIC 9(04).                 ELCAEXVR
  2957         10  AX-AH-C-CCYR  REDEFINES  AX-AH-C-CCYY.               ELCAEXVR
  2958             15  AX-AH-C-CC            PIC 99.                    ELCAEXVR
  2959             15  AX-AH-C-YR            PIC 99.                    ELCAEXVR
  2960         10  AX-AH-C-MO                PIC 99.                    ELCAEXVR
  2961         10  AX-AH-C-DA                PIC 99.                    ELCAEXVR
  2962     05  WS-AX-AH-CNCL-N REDEFINES                                   CL**2
  2963            WS-AX-AH-CNCL              PIC 9(11).                    CL**2
  2964     05  WS-AX-LUMP-SUM.                                          ELCAEXVR
  2965         10  FILLER                    PIC 999.                   ELCAEXVR
  2966         10  AX-LS-CCYY                PIC 9(04).                 ELCAEXVR
  2967         10  AX-LS-CCYR  REDEFINES AX-LS-CCYY.                    ELCAEXVR
  2968             15  AX-LS-CC              PIC 99.                    ELCAEXVR
  2969             15  AX-LS-YR              PIC 99.                    ELCAEXVR
  2970         10  AX-LS-MO                  PIC 99.                    ELCAEXVR
  2971         10  AX-LS-DA                  PIC 99.                    ELCAEXVR
  2972     05  WS-AX-LUMP-SUM-N REDEFINES                                  CL**2
  2973            WS-AX-LUMP-SUM             PIC 9(11).                    CL**2
  2974     05  WS-AX-AH-EXIT.                                           ELCAEXVR
  2975         10  FILLER                    PIC 999.                   ELCAEXVR
  2976         10  AX-AX-CCYY                PIC 9(4).                  ELCAEXVR
  2977         10  AX-AX-CCYR REDEFINES AX-AX-CCYY.                     ELCAEXVR
  2978             15  AX-AX-CC              PIC 99.                    ELCAEXVR
  2979             15  AX-AX-YR              PIC 99.                    ELCAEXVR
  2980         10  AX-AX-MO                  PIC 99.                    ELCAEXVR
  2981         10  AX-AX-DA                  PIC 99.                    ELCAEXVR
  2982     05  WS-AX-AH-EXIT-N REDEFINES                                   CL**2
  2983            WS-AX-AH-EXIT              PIC 9(11).                    CL**2
  2984     05  WS-AX-AH-EXPIRES.                                        ELCAEXVR
  2985         10  FILLER                    PIC 999.                   ELCAEXVR
  2986         10  AX-AE-CCYY                PIC 9(04).                 ELCAEXVR
  2987         10  AX-AE-CCYR REDEFINES AX-AE-CCYY.                     ELCAEXVR
  2988             15  AX-AE-CC              PIC 99.                    ELCAEXVR
  2989             15  AX-AE-YR              PIC 99.                    ELCAEXVR
  2990         10  AX-AE-MO                  PIC 99.                    ELCAEXVR
  2991         10  AX-AE-DA                  PIC 99.                    ELCAEXVR
  2992     05  WS-AX-AH-EXPIRES-N REDEFINES                                CL**2
  2993            WS-AX-AH-EXPIRES           PIC 9(11).                    CL**2
  2994     05  WS-AX-ENTRY.                                             ELCAEXVR
  2995         10  FILLER                    PIC 999.                   ELCAEXVR
  2996         10  AX-E-CCYY                 PIC 9(04).                 ELCAEXVR
  2997         10  AX-E-CCYR REDEFINES  AX-E-CCYY.                      ELCAEXVR
  2998             15  AX-E-CC               PIC 99.                    ELCAEXVR
  2999             15  AX-E-YR               PIC 99.                    ELCAEXVR
  3000         10  AX-E-MO                   PIC 99.                    ELCAEXVR
  3001         10  AX-E-DA                   PIC 99.                    ELCAEXVR
  3002     05  WS-AX-ENTRY-N REDEFINES                                     CL**2
  3003            WS-AX-ENTRY                PIC 9(11).                    CL**2
  3004
  3005 01  INITIALIZED-ALPHA-RECORD PIC X(300).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  58
* ECS050.cbl
* 3007     COPY ECSGAP01.
  3008******************************************************************04/29/98
  3009*                                                                *ECSGAP01
  3010*                            ECSGAP01                            *   LV009
  3011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**9
  3012*                            VMOD=2.009                          *ECSGAP01
  3013*                                                                *ECSGAP01
  3014*   FILE DESCRIPTION = G.A.A.P. EXTRACT RECORD                   *ECSGAP01
  3015*                                                                *ECSGAP01
  3016*   FILE TYPE = SEQUENTIAL                                        ECSGAP01
  3017*   RECORD SIZE = 365  RECFORM = FIXED                           *ECSGAP01
  3018*                                                                *ECSGAP01
  3019*   KEY DATA =                         START=5, LEN=36           *ECSGAP01
  3020*                                                                *ECSGAP01
  3021*  NO  CSO  MODS  IN  COPYBOOK  ECSGAP01                         *ECSGAP01
  3022*                                                                *ECSGAP01
  3023******************************************************************ECSGAP01
  3024*                   C H A N G E   L O G
  3025*
  3026* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3027*-----------------------------------------------------------------
  3028*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3029* EFFECTIVE    NUMBER
  3030*-----------------------------------------------------------------
  3031* 020305    2005020000000  PEMA  ADD CLP STATE TO GAAP RECORD
  3032******************************************************************
  3033                                                                  ECSGAP01
  3034 01  GAAP-RECORD.                                                 ECSGAP01
  3035     12  GR-RECORD-ID                      PIC XX.                ECSGAP01
  3036         88  VALID-GR-ID                      VALUE 'GR'.         ECSGAP01
  3037                                                                  ECSGAP01
  3038     12  GR-COMPANY-CD                     PIC X.                 ECSGAP01
  3039                                                                  ECSGAP01
  3040     12  GR-REIN                           PIC X.                 ECSGAP01
  3041                                                                  ECSGAP01
  3042     12  GR-CONTROL.                                              ECSGAP01
  3043         16  GR-CARRIER                    PIC X.                 ECSGAP01
  3044         16  GR-GROUPING.                                         ECSGAP01
  3045             20  GR-GROUP-PREFIX           PIC XXX.               ECSGAP01
  3046             20  GR-GROUP-PRIME            PIC XXX.               ECSGAP01
  3047         16  GR-STATE                      PIC XX.                ECSGAP01
  3048         16  GR-ACCOUNT.                                          ECSGAP01
  3049             20  GR-ACCT-PREFIX            PIC X(4).              ECSGAP01
  3050             20  GR-ACCT-PRIME             PIC X(6).              ECSGAP01
  3051         16  GR-EFF                        PIC 9(11)  COMP-3.     ECSGAP01
  3052         16  GR-CERT-NO.                                          ECSGAP01
  3053             20  GR-CERT.                                         ECSGAP01
  3054                 24  GR-CERT-PREFIX        PIC XXX.               ECSGAP01
  3055                 24  GR-CERT-PRIME         PIC X(7).              ECSGAP01
  3056             20  GR-CERT-SUFFIX            PIC X.                 ECSGAP01
  3057                                                                  ECSGAP01
  3058     12  GR-REIN-COMP.                                            ECSGAP01
  3059         16  GR-REINCO                     PIC XXX.               ECSGAP01
  3060         16  GR-REINCO-SUB                 PIC XXX.               ECSGAP01
  3061                                                                  ECSGAP01
  3062     12  GR-IG                             PIC X.                 ECSGAP01
  3063     12  GR-APR                            PIC S999V9(4)  COMP-3. ECSGAP01
  3064     12  GR-PMT-FREQ                       PIC 99.                ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  59
* ECS050.cbl (/apps/prod/cid1p/copy/ECSGAP01)
  3065     12  GR-LOAN-TERM                      PIC S999       COMP-3. ECSGAP01
  3066     12  GR-AGE                            PIC 99.                ECSGAP01
  3067     12  GR-ACC-EXPIRES                    PIC 9(11)      COMP-3.    CL**2
  3068                                                                  ECSGAP01
  3069     12  GR-BASIC.                                                ECSGAP01
  3070         16  GR-LFTYP                      PIC XX.                ECSGAP01
  3071         16  GR-LF-TERM                    PIC S999       COMP-3. ECSGAP01
  3072         16  GR-LF-REMTERM                 PIC S999V99    COMP-3. ECSGAP01
  3073         16  GR-LF-UP-REMTERM              PIC S999V99    COMP-3. ECSGAP01
  3074         16  GR-LFBEN                      PIC S9(9)V99   COMP-3. ECSGAP01
  3075         16  GR-LFPRM                      PIC S9(7)V99   COMP-3. ECSGAP01
  3076         16  GR-LFCOM                      PIC S9(7)V99   COMP-3. ECSGAP01
  3077         16  GR-LFEXP                      PIC S9(7)V99   COMP-3. ECSGAP01
  3078         16  GR-LFTAX                      PIC S9(7)V99   COMP-3. ECSGAP01
  3079                                                                  ECSGAP01
  3080         16  GR-AHTYP                      PIC XX.                ECSGAP01
  3081         16  GR-AH-TERM                    PIC S999       COMP-3. ECSGAP01
  3082         16  GR-AH-REMTERM                 PIC S999V9     COMP-3. ECSGAP01
  3083         16  GR-AH-UP-REMTERM              PIC S999V99    COMP-3. ECSGAP01
  3084         16  GR-AHBEN                      PIC S9(7)V99   COMP-3. ECSGAP01
  3085         16  GR-AHPRM                      PIC S9(7)V99   COMP-3. ECSGAP01
  3086         16  GR-AHCOM                      PIC S9(7)V99   COMP-3. ECSGAP01
  3087         16  GR-AHEXP                      PIC S9(7)V99   COMP-3. ECSGAP01
  3088         16  GR-AHTAX                      PIC S9(7)V99   COMP-3. ECSGAP01
  3089                                                                  ECSGAP01
  3090     12  GR-PRORATA.                                              ECSGAP01
  3091         16  GRP-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3092         16  GRP-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3093         16  GRP-LFEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
  3094         16  GRP-LFTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
  3095         16  GRP-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3096         16  GRP-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3097         16  GRP-AHEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
  3098         16  GRP-AHTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
  3099                                                                  ECSGAP01
  3100     12  GR-R78.                                                  ECSGAP01
  3101         16  GRR-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3102         16  GRR-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3103         16  GRR-LFEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
  3104         16  GRR-LFTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
  3105         16  GRR-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3106         16  GRR-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3107         16  GRR-AHEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
  3108         16  GRR-AHTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
  3109                                                                  ECSGAP01
  3110     12  GR-DOMICILE-STAT.                                        ECSGAP01
  3111         16  GRD-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3112         16  GRD-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3113         16  GRD-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3114         16  GRD-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3115                                                                  ECSGAP01
  3116     12  GR-STATE-STAT.                                           ECSGAP01
  3117         16  GRS-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3118         16  GRS-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3119         16  GRS-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3120         16  GRS-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
  3121                                                                  ECSGAP01
  3122     12  GR-MORTALITY-DATA.                                       ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  60
* ECS050.cbl (/apps/prod/cid1p/copy/ECSGAP01)
  3123         16  GR-MORT-CONTROL.                                     ECSGAP01
  3124             20  GR-MORT-CODE.                                    ECSGAP01
  3125                 24  GR-MORT-BASE.                                ECSGAP01
  3126                     28  GR-MORT-TBL       PIC X.                 ECSGAP01
  3127                     28  GR-MORT-INT       PIC XX.                ECSGAP01
  3128                 24  GR-MORT-TYP           PIC X.                 ECSGAP01
  3129             20  GR-MORT-AGE               PIC 99.                ECSGAP01
  3130         16  GR-MORT-DATA.                                        ECSGAP01
  3131             20  GR-REM-AMT                PIC S9(9)V99   COMP-3. ECSGAP01
  3132             20  GR-MO-DEC                 PIC S9(9)V99   COMP-3. ECSGAP01
  3133             20  GR-MORT-FACT              PIC S9(5)V9(4) COMP-3. ECSGAP01
  3134             20  GR-RESV                   PIC S9(7)V99   COMP-3. ECSGAP01
  3135         16  GR-FLAG                       PIC X.                 ECSGAP01
  3136                                                                  ECSGAP01
  3137     12  GR-ALT-MORTALITY-DATA.                                   ECSGAP01
  3138         16  GR-ALT-MORT-CODE.                                    ECSGAP01
  3139             20  GR-ALT-MORT-BASE.                                ECSGAP01
  3140                 24  GR-ALT-MORT-TBL       PIC X.                 ECSGAP01
  3141                 24  GR-ALT-MORT-INT       PIC XX.                ECSGAP01
  3142             20  GR-ALT-MORT-TYP           PIC X.                 ECSGAP01
  3143         16  GR-ALT-MORT-DATA.                                    ECSGAP01
  3144             20  GR-ALT-RESV               PIC S9(7)V99   COMP-3. ECSGAP01
  3145                                                                  ECSGAP01
  3146     12  GR-CNT                            PIC S999       COMP-3. ECSGAP01
  3147     12  GR-CNT-LF                         PIC S999       COMP-3. ECSGAP01
  3148     12  GR-CNT-AH                         PIC S999       COMP-3. ECSGAP01
  3149     12  GR-AH-REM-BEN                     PIC S9(9)V99   COMP-3. ECSGAP01
  3150                                                                  ECSGAP01
  3151     12  GR-ENT-DT                         PIC 9(11)      COMP-3. ECSGAP01
  3152                                                                  ECSGAP01
  3153     12  GR-SUMMARY-FLAG                   PIC X.                 ECSGAP01
  3154         88  GR-SUMMARY-REC                   VALUE 'Z'.          ECSGAP01
  3155                                                                  ECSGAP01
  3156     12  GR-2ND-LFTYP-FLAG                 PIC X.                 ECSGAP01
  3157         88  GR-2ND-LIFE-REC                  VALUE 'S'.          ECSGAP01
  3158                                                                  ECSGAP01
  3159     12  GR-CERT-STATUS                    PIC  X.                ECSGAP01
  3160     12  GR-DIR-CERT-LFBEN                 PIC  S9(7)V99  COMP-3. ECSGAP01
  3161                                                                  ECSGAP01
  3162     12  GR-LF-EXPIRE-DATE                 PIC  9(11)     COMP-3. ECSGAP01
  3163                                                                  ECSGAP01
  3164     12  GR-AH-EXPIRE-DATE                 PIC  9(11)     COMP-3. ECSGAP01
  3165                                                                  ECSGAP01
  3166     12  GR-REGION                         PIC X(6).              ECSGAP01
  3167     12  GR-POOL-PRIME                     PIC XXX.               ECSGAP01
  3168                                                                  ECSGAP01
  3169     12  GR-UNDERWRITING-CODE              PIC X.                 ECSGAP01
  3170         88  GR-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSGAP01
  3171                                                                  ECSGAP01
  3172     12  GR-OB-IND                         PIC X.                 ECSGAP01
  3173                                                                  ECSGAP01
  3174     12  GR-SEX-CODE                       PIC X.                 ECSGAP01
  3175         88  GR-SEX-MALE                      VALUE 'M'.          ECSGAP01
  3176         88  GR-SEX-FEMALE                    VALUE 'F'.          ECSGAP01
  3177                                                                  ECSGAP01
  3178*    12  GR-SERVICE-FEE.                                          ECSGAP01
  3179*        16  GR-LFSRV                      PIC S9(7)V99   COMP-3. ECSGAP01
  3180*        16  GR-AHSRV                      PIC S9(7)V99   COMP-3. ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  61
* ECS050.cbl (/apps/prod/cid1p/copy/ECSGAP01)
  3181     12  GR-UNLD-STAT-MORT-RESV            PIC S9(7)V99   COMP-3.
  3182     12  FILLER                            PIC X(5).
  3183                                                                  ECSGAP01
  3184     12  GR-INS-NAME.
  3185         16  GR-DCC-CLP-STATE              PIC XX.
  3186         16  GR-GRPTYP                     PIC XX.
  3187         16  FILLER                        PIC X(9).
  3188*    12  FILLER                            PIC X(13).             ECSGAP01
  3189                                                                  ECSGAP01
  3190******************************************************************ECSGAP01
* 3191     COPY ELCGAPVR.
  3192******************************************************************04/15/98
  3193*                                                                *ELCGAPVR
  3194*                            ELCGAPVR                            *   LV002
  3195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3196*                            VMOD=2.001                          *ELCGAPVR
  3197*                                                                *ELCGAPVR
  3198*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCGAPVR
  3199*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCGAPVR
  3200*                                                                *ELCGAPVR
  3201******************************************************************ELCGAPVR
  3202                                                                  ELCGAPVR
  3203 01  WS-GAAP-RECORD-DATE.                                         ELCGAPVR
  3204     05  WS-GR-EFF.                                               ELCGAPVR
  3205         10  FILLER                    PIC 999.                   ELCGAPVR
  3206         10  GR-CCYY                   PIC 9(04).                 ELCGAPVR
  3207         10  GR-CCYR  REDEFINES  GR-CCYY.                         ELCGAPVR
  3208             15  GR-CC                 PIC 99.                    ELCGAPVR
  3209             15  GR-YR                 PIC 99.                    ELCGAPVR
  3210         10  GR-MO                     PIC 99.                    ELCGAPVR
  3211         10  GR-DA                     PIC 99.                    ELCGAPVR
  3212     05  WS-GR-EFF-N REDEFINES                                       CL**2
  3213            WS-GR-EFF                  PIC 9(11).                    CL**2
  3214     05  WS-GR-ENT-DT.                                            ELCGAPVR
  3215         10  FILLER                    PIC 999.                   ELCGAPVR
  3216         10  GR-ENT-CCYY               PIC 9(04).                 ELCGAPVR
  3217         10  GR-ENT-CCYR  REDEFINES  GR-ENT-CCYY.                 ELCGAPVR
  3218             15  GR-ENT-CC             PIC 99.                    ELCGAPVR
  3219             15  GR-ENT-YR             PIC 99.                    ELCGAPVR
  3220         10  GR-ENT-MO                 PIC 99.                    ELCGAPVR
  3221         10  GR-ENT-DA                 PIC 99.                    ELCGAPVR
  3222     05  WS-GR-ENT-DT-N REDEFINES                                    CL**2
  3223            WS-GR-ENT-DT               PIC 9(11).                    CL**2
  3224     05  WS-GR-LF-EXPIRE-DATE.                                    ELCGAPVR
  3225         10  FILLER                    PIC 999.                   ELCGAPVR
  3226         10  GR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCGAPVR
  3227         10  GR-LF-EXPIRE-CCYR  REDEFINES  GR-LF-EXPIRE-CCYY.     ELCGAPVR
  3228             15  GR-LF-EXPIRE-CC       PIC 99.                    ELCGAPVR
  3229             15  GR-LF-EXPIRE-YR       PIC 99.                    ELCGAPVR
  3230         10  GR-LF-EXPIRE-MO           PIC 99.                    ELCGAPVR
  3231         10  GR-LF-EXPIRE-DA           PIC 99.                    ELCGAPVR
  3232     05  WS-GR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3233            WS-GR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3234     05  WS-GR-AH-EXPIRE-DATE.                                    ELCGAPVR
  3235         10  FILLER                    PIC 999.                   ELCGAPVR
  3236         10  GR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCGAPVR
  3237         10  GR-AH-EXPIRE-CCYR  REDEFINES  GR-AH-EXPIRE-CCYY.     ELCGAPVR
  3238             15  GR-AH-EXPIRE-CC       PIC 99.                    ELCGAPVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  62
* ECS050.cbl (/apps/prod/cid1p/copy/ELCGAPVR)
  3239             15  GR-AH-EXPIRE-YR       PIC 99.                    ELCGAPVR
  3240         10  GR-AH-EXPIRE-MO           PIC 99.                    ELCGAPVR
  3241         10  GR-AH-EXPIRE-DA           PIC 99.                    ELCGAPVR
  3242     05  WS-GR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3243            WS-GR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3244
  3245 01  INITIALIZED-GAAP-RECORD PIC X(365).
  3246
  3247 01  GAAP-ALT-PRM-COM.
  3248     12  GR-LFCOM-ALT        PIC S9(7)V99    COMP-3.
  3249     12  LF-PRM              PIC S9(7)V99    COMP-3.
  3250     12  LF-PRM-ALT          PIC S9(7)V99    COMP-3.
  3251*    12  GR-LFSRV-ALT        PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  63
* ECS050.cbl
* 3253                             COPY ECSRITAB.
  3254******************************************************************04/29/98
  3255*                                                                *ECSRITAB
  3256*                            ECSRITAB                            *   LV015
  3257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3258*                            VMOD=2.015                          *ECSRITAB
  3259*                                                                *ECSRITAB
  3260*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3261*                                                                *ECSRITAB
  3262******************************************************************ECSRITAB
  3263 01  REIN-WORK-AREAS.                                             ECSRITAB
  3264     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3265     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3266     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3267     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3268     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3269     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3270     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3271     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3272     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3273     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3274     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3275         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3276             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3277             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3278             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3279     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3280     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3281     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3282     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3283     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3284     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3285     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3286     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3287     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3288     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3289     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3290     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3291     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3292     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3293     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3294     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3295     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3296     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3297     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3298     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3299     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3300     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3301     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3302                                                                  ECSRITAB
  3303 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3304     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3305         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3306         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3307             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3308             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3309         16  REIN-WORK-FLDS.                                      ECSRITAB
  3310             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  64
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3311             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3312             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3313             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3314             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3315             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3316             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3317             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3318             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3319             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3320             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3321             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3322             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3323             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3324             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3325             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3326             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3327             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3328             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3329             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3330             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3331             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3332             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3333             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3334             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3335             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3336             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3337             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3338     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3339                                                                  ECSRITAB
  3340     12  RWF-FIELDS.                                              ECSRITAB
  3341         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3342         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3343         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3344         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3345         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3346         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3347         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3348         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3349         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3350         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3351         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3352         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3353         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3354         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3355         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3356         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3357         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3358         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3359         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3360         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3361         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3362         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3363         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3364         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3365         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3366         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3367         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3368         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  65
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3369                                                                  ECSRITAB
  3370     12  WT-COMP-INFO.                                            ECSRITAB
  3371         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3372         16  WT-LF-QC                PIC X.                       ECSRITAB
  3373         16  WT-AH-QC                PIC X.                       ECSRITAB
  3374         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3375         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3376         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3377         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3378         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  3379         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3380         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3381         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3382         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3383         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3384         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3385         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3386         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3387         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3388         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3389         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3390         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3391         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3392         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3393         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3394         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3395         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3396         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3397         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3398         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3399         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3400         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3401         16  WT-REMAINING            PIC X.                       ECSRITAB
  3402         16  FILLER                  PIC X(21).                   ECSRITAB
  3403                                                                  ECSRITAB
  3404 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3405     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3406     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3407     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3408     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3409     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3410     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3411     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3412     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3413     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3414     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3415     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3416     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3417     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3418     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3419     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3420     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3421     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3422     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3423     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3424     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3425     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3426     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  66
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3427     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3428     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3429                                                                  ECSRITAB
  3430     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3431         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3432     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3433         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3434     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3435         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3436     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3437         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3438     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3439         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3440     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3441         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3442                                                                  ECSRITAB
  3443     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3444         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3445         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3446         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3447         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3448         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3449         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3450         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3451         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3452         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3453         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3454         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3455         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3456         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3457         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3458         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3459         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3460         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3461         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3462         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3463         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3464         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3465         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3466         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3467     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3468     12  REIN-SEARCH.                                             ECSRITAB
  3469         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3470         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3471         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3472         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3473     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3474     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3475     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3476     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3477     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3478     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3479     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3480     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3481     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3482     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3483     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3484     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  67
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3485     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3486     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3487     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3488     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3489     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3490     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3491     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3492     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3493     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3494     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  3495     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3496     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3497     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3498                                                                  ECSRITAB
  3499 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3500* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3501     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3502         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3503         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3504         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3505         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3506         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3507         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3508         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3509         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3510         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3511                                                                  ECSRITAB
  3512 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3513     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3514         16  RC2-REIN-CO.                                         ECSRITAB
  3515             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3516             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3517         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3518         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3519         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3520         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3521         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3522         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3523                                                                  ECSRITAB
  3524 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3525     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3526         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3527         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3528     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3529                                                                  ECSRITAB
  3530 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3531     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3532         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3533         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3534         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3535 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3536     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3537         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3538                                                                  ECSRITAB
  3539 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3540******************************************************************ECSRITAB
* 3541                             COPY ELCPSEVR.
  3542******************************************************************04/16/98
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  68
* ECS050.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3543*                                                                *ELCPSEVR
  3544*                                                                *ELCPSEVR
  3545*                            ELCPSEVR                            *   LV003
  3546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3547*                            VMOD=2.001                          *ELCPSEVR
  3548*                                                                *ELCPSEVR
  3549*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3550*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3551*                                                                *ELCPSEVR
  3552******************************************************************ELCPSEVR
  3553                                                                  ELCPSEVR
  3554 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3555     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3556         10  FILLER               PIC 999.                        ELCPSEVR
  3557         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3558         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3559             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3560             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3561         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3562         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3563     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3564            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3565     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3566         10  FILLER              PIC 999.                         ELCPSEVR
  3567         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3568         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3569             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3570             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3571         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3572         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3573     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3574            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3575 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3576     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3577                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3578         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3579             15  FILLER              PIC 999.                     ELCPSEVR
  3580             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3581             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3582                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3583                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3584             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3585             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3586         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3587                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3588         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3589             15  FILLER              PIC 999.                     ELCPSEVR
  3590             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3591             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3592                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3593                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3594             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3595             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3596         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3597                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3598         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3599             15  FILLER              PIC 999.                     ELCPSEVR
  3600             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  69
* ECS050.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3601             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3602                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3603                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3604             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3605             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3606         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3607                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3608     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3609         10  FILLER              PIC 999.                         ELCPSEVR
  3610         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3611         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3612             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3613             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3614         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3615         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3616     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3617            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3618
  3619
  3620 01  REIN-ONLY-HOLDERS.
  3621     12  R-O-H           OCCURS 6.
  3622         16  ROH-CNTRL       PIC X(35).
  3623         16  ROH-ENTRY       PIC X.
  3624         16  ROH-LF-STATUS   PIC X.
  3625         16  ROH-AH-STATUS   PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  70
* ECS050.cbl
  3627 01  PRINT-LINES.
  3628     12  HDR-1.
  3629         16  FILLER          PIC X(45)         VALUE SPACES.
  3630         16  FILLER          PIC X(33)         VALUE
  3631             '       GAAP EXTRACT TOTALS       '.
  3632         16  FILLER          PIC X(42)         VALUE SPACES.
  3633         16  FILLER          PIC X(8)          VALUE 'ECS050  '.
  3634     12  HDR-1A.
  3635         16  FILLER          PIC X(45)         VALUE SPACES.
  3636         16  FILLER          PIC X(33)         VALUE
  3637             '        EXCEPTION LISTING        '.
  3638         16  FILLER          PIC X(42)         VALUE SPACES.
  3639         16  FILLER          PIC X(8)          VALUE 'ECS050  '.
  3640     12  HDR-1B.
  3641         16  FILLER          PIC X(45)         VALUE SPACES.
  3642         16  FILLER          PIC X(33)         VALUE
  3643             'COVERAGES EXCLUDED FROM VALUATION'.
  3644         16  FILLER          PIC X(42)         VALUE SPACES.
  3645         16  FILLER          PIC X(8)          VALUE 'ECS050  '.
  3646     12  HDR-2.
  3647         16  FILLER          PIC X(47)         VALUE SPACES.
  3648         16  H2-COMP         PIC X(30).
  3649         16  FILLER          PIC X(43)         VALUE SPACES.
  3650         16  H2-DATE         PIC X(8).
  3651     12  HDR-3.
  3652         16  FILLER          PIC X(53)         VALUE SPACES.
  3653         16  H3-DATE         PIC X(18).
  3654         16  FILLER          PIC X(49)         VALUE SPACES.
  3655         16  FILLER          PIC X(5)          VALUE 'PAGE '.
  3656         16  H3-PAGE         PIC ZZ,ZZ9.
  3657     12  HDR-4A.
  3658         16  FILLER          PIC X(62)      VALUE SPACES.
  3659         16  FILLER          PIC X(9)       VALUE '*------- '.
  3660         16  HD4A-DESC-1     PIC X(6).
  3661         16  FILLER          PIC X(29)         VALUE
  3662             ' EXCLUSIONS ------* *------- '.
  3663         16  HD4A-DESC-2     PIC X(6).
  3664         16  FILLER          PIC X(20)         VALUE
  3665             ' EXCLUSIONS -------*'.
  3666     12  HDR-4B.
  3667         16  FILLER          PIC X(44)         VALUE
  3668             ' CARRIER  GROUPING  STATE    ACCOUNT    CERT'.
  3669         16  FILLER          PIC X(44)         VALUE
  3670             '. NO.   EFF DATE    EXIT DTE    DATE      RE'.
  3671         16  FILLER          PIC X(44)         VALUE
  3672             'ASON       EXIT DTE    DATE      REASON     '.
  3673     12  HDR-4C.
  3674         16  FILLER          PIC X(44)         VALUE
  3675             ' CARRIER  GROUPING  STATE    ACCOUNT    CERT'.
  3676         16  FILLER          PIC X(44)         VALUE
  3677             '. NO.   EFF DATE  **************************'.
  3678         16  FILLER          PIC X(44)         VALUE
  3679             '***  WARNING  *****************************>'.
  3680     12  HDR-5.
  3681         16  FILLER          PIC X(45)         VALUE
  3682             '                                             '.
  3683         16  FILLER          PIC X(44)         VALUE
  3684             ' GROSS          REINSURANCE                 '.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  71
* ECS050.cbl
  3685     12  HDR-6.
  3686         16  FILLER          PIC X             VALUE SPACES.
  3687         16  FILLER          PIC X(9)          VALUE 'CARRIER'.
  3688         16  HD6-CARR        PIC X             VALUE SPACE.
  3689     12  HDR-7.
  3690         16  HD7-COV         PIC X(27)         VALUE SPACES.
  3691         16  FILLER          PIC X(26)         VALUE SPACES.
  3692         16  HD7-DESC-1      PIC X(12)         VALUE SPACES.
  3693         16  FILLER          PIC X(30)         VALUE SPACES.
  3694         16  HD7-DESC-2      PIC X(12)         VALUE SPACES.
  3695         16  FILLER          PIC X(16)         VALUE SPACES.
  3696     12  HDR-7A.
  3697         16  FILLER          PIC X(47)         VALUE SPACES.
  3698         16  FILLER          PIC X(12)         VALUE 'COUNTS'.
  3699         16  FILLER          PIC X(03)         VALUE SPACES.
  3700         16  FILLER          PIC X(16)         VALUE
  3701                                            'ORIGINAL PREMIUM'.
  3702         16  FILLER          PIC X(12)         VALUE SPACES.
  3703         16  FILLER          PIC X(12)         VALUE 'COUNTS'.
  3704         16  FILLER          PIC X(02)         VALUE SPACES.
  3705         16  FILLER          PIC X(16)         VALUE
  3706                                            'ORIGINAL PREMIUM'.
  3707     12  HDR-7B.
  3708         16  HD7B-COV        PIC X(27)         VALUE SPACES.
  3709         16  FILLER          PIC X(16)         VALUE SPACES.
  3710         16  HD7B-DESC-1     PIC X(12)         VALUE SPACES.
  3711         16  FILLER          PIC X(07)         VALUE SPACES.
  3712         16  HD7B-DESC-2     PIC X(12)         VALUE SPACES.
  3713         16  FILLER          PIC X(16)         VALUE SPACES.
  3714     12  DTL-1.
  3715         16  FILLER.
  3716             20  FILLER          PIC X(4).
  3717             20  D1-CARRIER      PIC X.
  3718             20  FILLER          PIC X(6).
  3719             20  D1-GROUPING     PIC X(6).
  3720             20  FILLER          PIC X(5).
  3721             20  D1-STATE        PIC XX.
  3722             20  FILLER          PIC XXX.
  3723             20  D1-ACCT         PIC X(10).
  3724             20  FILLER          PIC XX.
  3725             20  D1-CERT         PIC X(11).
  3726             20  FILLER          PIC XX.
  3727             20  D1-EFF-MO       PIC 99.
  3728             20  D1-SLASH-1      PIC X.
  3729             20  D1-EFF-DA       PIC 99.
  3730             20  D1-SLASH-2      PIC X.
  3731             20  D1-EFF-YR       PIC 99.
  3732             20  FILLER          PIC X(4).
  3733         16  D1-REIN-MESSAGE.
  3734             20  D1L-EXIT-DATE.
  3735                 24  D1L-EXIT-MO      PIC 99.
  3736                 24  D1L-SLASH-1      PIC X.
  3737                 24  D1L-EXIT-DA      PIC 99.
  3738                 24  D1L-SLASH-2      PIC X.
  3739                 24  D1L-EXIT-YR      PIC 99.
  3740             20  FILLER               PIC XX.
  3741             20  D1L-REAS-DATE.
  3742                 24  D1L-REAS-MO      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  72
* ECS050.cbl
  3743                 24  D1L-SLASH-3      PIC X.
  3744                 24  D1L-REAS-DA      PIC 99.
  3745                 24  D1L-SLASH-4      PIC X.
  3746                 24  D1L-REAS-YR      PIC 99.
  3747             20  FILLER               PIC XX.
  3748             20  D1L-REASON           PIC X(11).
  3749             20  FILLER               PIC X(4).
  3750             20  D1A-EXIT-DATE.
  3751                 24  D1A-EXIT-MO      PIC 99.
  3752                 24  D1A-SLASH-1      PIC X.
  3753                 24  D1A-EXIT-DA      PIC 99.
  3754                 24  D1A-SLASH-2      PIC X.
  3755                 24  D1A-EXIT-YR      PIC 99.
  3756             20  FILLER               PIC XX.
  3757             20  D1A-REAS-DATE.
  3758                 24  D1A-REAS-MO      PIC 99.
  3759                 24  D1A-SLASH-3      PIC X.
  3760                 24  D1A-REAS-DA      PIC 99.
  3761                 24  D1A-SLASH-4      PIC X.
  3762                 24  D1A-REAS-YR      PIC 99.
  3763             20  FILLER               PIC XX.
  3764             20  D1A-REASON           PIC X(11).
  3765             20  FILLER               PIC XX.
  3766
  3767     12  TOT-0.
  3768         16  FILLER          PIC X               VALUE SPACES.
  3769         16  T0-MSG          PIC X(36).
  3770     12  TOT-1.
  3771         16  FILLER          PIC X               VALUE SPACES.
  3772         16  T1-MSG          PIC X(36).
  3773         16  FILLER          PIC X(6)            VALUE SPACES.
  3774         16  T1-COUNT1       PIC ZZZ,ZZZ,ZZ9-.
  3775         16  FILLER          PIC X(6)            VALUE SPACES.
  3776         16  T1-COUNT2       PIC ZZZ,ZZZ,ZZ9-.
  3777     12  TOT-2.
  3778         16  FILLER          PIC X               VALUE SPACES.
  3779         16  T2-MSG          PIC X(36).
  3780         16  T2-GROSS        PIC ZZ,ZZZ,ZZZ,ZZZ.99-.
  3781         16  FILLER          PIC XX              VALUE SPACES.
  3782         16  T2-REIN         PIC ZZ,ZZZ,ZZZ,ZZZ.99-.
  3783
  3784     12  TOT-3.
  3785         16  FILLER          PIC X               VALUE SPACES.
  3786         16  T3-MSG          PIC X(36).
  3787         16  FILLER          PIC X(6)            VALUE SPACES.
  3788         16  T3-GROSS        PIC ZZZ,ZZZ,ZZ9-.
  3789         16  FILLER          PIC X(6)            VALUE SPACES.
  3790         16  T3-REIN         PIC ZZZ,ZZZ,ZZ9-.
  3791
  3792     12  TOT-4.
  3793         16  FILLER          PIC X               VALUE SPACES.
  3794         16  T4-MSG          PIC X(36).
  3795         16  FILLER          PIC X(6)            VALUE SPACES.
  3796         16  T4-COUNT1       PIC ZZZ,ZZZ,ZZ9-.
  3797         16  FILLER          PIC X(6)            VALUE SPACES.
  3798         16  T4-PREM-LF      PIC ZZ,ZZZ,ZZZ,ZZZ.99-.
  3799         16  FILLER          PIC X(6)            VALUE SPACES.
  3800         16  T4-COUNT2       PIC ZZZ,ZZZ,ZZ9-.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  73
* ECS050.cbl
  3801         16  FILLER          PIC X(6)            VALUE SPACES.
  3802         16  T4-PREM-AH      PIC ZZ,ZZZ,ZZZ,ZZZ.99-.
  3803
  3804     12  TOT-MSG-1           PIC X(36)           VALUE
  3805             'CERTIFICATES ON FILE............... '.
  3806     12  TOT-MSG-1A          PIC X(36)           VALUE
  3807             '     (RE-ISSUED CERTS)............. '.
  3808     12  TOT-MSG-1B          PIC X(36)           VALUE
  3809             '     (REINSURANCE ONLY CERTS)...... '.
  3810     12  TOT-MSG-1C          PIC X(36)           VALUE
  3811             '     (VOIDED CERTS)................ '.
  3812     12  TOT-MSG-1D          PIC X(36)           VALUE
  3813             '     (DECLINED CERTS).............. '.
  3814     12  TOT-MSG-2           PIC X(36)           VALUE
  3815             '   SINGLE PREMIUM CERTIFICATES..... '.
  3816     12  TOT-MSG-3           PIC X(36)           VALUE
  3817             '   OUTSTANDING BALANCE CERTIFICATES '.
  3818     12  TOT-MSG-4           PIC X(36)           VALUE
  3819             '   SUMMARY CERTIFICATES............ '.
  3820
  3821     12  TOT-MSG-5A          PIC X(36)           VALUE
  3822             '   INITIAL   COVERAGES............. '.
  3823     12  TOT-MSG-5           PIC X(36)           VALUE
  3824             '   CANCELLED COVERAGES............. '.
  3825     12  TOT-MSG-6           PIC X(36)           VALUE
  3826             '   CLAIMED   COVERAGES............. '.
  3827     12  TOT-MSG-7           PIC X(36)           VALUE
  3828             '   EXPIRED   COVERAGES............. '.
  3829     12  TOT-MSG-8           PIC X(36)           VALUE
  3830             '   FUTURE    COVERAGES............. '.
  3831     12  TOT-MSG-9-OB        PIC X(36)           VALUE
  3832             '   ACTIVE OB COVERAGES............. '.
  3833
  3834     12  TOT-MSG-9           PIC X(36)           VALUE
  3835             '   ACTIVE    COVERAGES............. '.
  3836
  3837     12  TOT-MSG-10          PIC X(36)           VALUE
  3838             'ALPHA EXTRACT RECORDS.............. '.
  3839     12  TOT-MSG-10J         PIC X(36)           VALUE
  3840             'ALPHA JOINT EXTRACT RECORDS........ '.
  3841     12  TOT-MSG-11          PIC X(36)           VALUE
  3842             'INITIAL   FACE AMOUNT.............. '.
  3843     12  TOT-MSG-12          PIC X(36)           VALUE
  3844             'REMAINING FACE AMOUNT.............. '.
  3845     12  TOT-MSG-13          PIC X(36)           VALUE
  3846             'REMAINING MONTHLY BENEFITS......... '.
  3847     12  TOT-MSG-14          PIC X(36)           VALUE
  3848             'FUTURES - FACE AMOUNT.............. '.
  3849     12  TOT-MSG-15          PIC X(36)           VALUE
  3850             'MONTHLY DECREASE................... '.
  3851     12  TOT-MSG-16          PIC X(36)           VALUE
  3852             'GAAP EXTRACT RECORDS............... '.
  3853
  3854     12  TOT-MSG-17          PIC X(36)           VALUE
  3855             '   INDIVIDUAL CERTS UNDER 60 MONTHS '.
  3856     12  TOT-MSG-18          PIC X(36)           VALUE
  3857             '   INDIVIDUAL CERTS OVER  59 MONTHS '.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  74
* ECS050.cbl
  3859
  3860 01  TOT-ACCUMS.
  3861     12  TOT-READ            PIC S9(9)     COMP-3  VALUE ZERO.
  3862     12  TOT-REIS            PIC S9(9)     COMP-3  VALUE ZERO.
  3863     12  TOT-DECLINED        PIC S9(9)     COMP-3  VALUE ZERO.
  3864     12  TOT-VOIDED          PIC S9(9)     COMP-3  VALUE ZERO.
  3865     12  TOT-REIO            PIC S9(9)     COMP-3  VALUE ZERO.
  3866     12  TOT-SNGLPRM         PIC S9(9)     COMP-3  VALUE ZERO.
  3867     12  TOT-OB              PIC S9(9)     COMP-3  VALUE ZERO.
  3868     12  TOT-SUM             PIC S9(9)     COMP-3  VALUE ZERO.
  3869     12  TOT-LF              PIC S9(9)     COMP-3  VALUE ZERO.
  3870     12  TOT-AH              PIC S9(9)     COMP-3  VALUE ZERO.
  3871     12  TOT-CANC-LF         PIC S9(9)     COMP-3  VALUE ZERO.
  3872     12  TOT-CANC-AH         PIC S9(9)     COMP-3  VALUE ZERO.
  3873     12  TOT-DTH             PIC S9(9)     COMP-3  VALUE ZERO.
  3874     12  TOT-DIS             PIC S9(9)     COMP-3  VALUE ZERO.
  3875     12  TOT-EXP-LF          PIC S9(9)     COMP-3  VALUE ZERO.
  3876     12  TOT-EXP-AH          PIC S9(9)     COMP-3  VALUE ZERO.
  3877     12  TOT-FUTR-LF         PIC S9(9)     COMP-3  VALUE ZERO.
  3878     12  TOT-FUTR-AH         PIC S9(9)     COMP-3  VALUE ZERO.
  3879     12  TOT-ACTIVE-LF       PIC S9(9)     COMP-3  VALUE ZERO.
  3880     12  TOT-ACTIVE-LF-OB    PIC S9(9)     COMP-3  VALUE ZERO.
  3881     12  TOT-ACTIVE-AH       PIC S9(9)     COMP-3  VALUE ZERO.
  3882     12  TOT-ACTIVE-AH-OB    PIC S9(9)     COMP-3  VALUE ZERO.
  3883     12  TOT-ALPHA           PIC S9(9)     COMP-3  VALUE ZERO.
  3884     12  TOT-ALPHA-JOINT     PIC S9(9)     COMP-3  VALUE ZERO.
  3885     12  TOT-GAAP            PIC S9(9)     COMP-3  VALUE ZERO.
  3886     12  REI-GAAP            PIC S9(9)     COMP-3  VALUE ZERO.
  3887     12  TOT-INIT-FACE       PIC S9(11)V99 COMP-3  VALUE ZERO.
  3888     12  REI-INIT-FACE       PIC S9(11)V99 COMP-3  VALUE ZERO.
  3889     12  TOT-REM-FACE        PIC S9(11)V99 COMP-3  VALUE ZERO.
  3890     12  REI-REM-FACE        PIC S9(11)V99 COMP-3  VALUE ZERO.
  3891     12  TOT-REM-AH          PIC S9(11)V99 COMP-3  VALUE ZERO.
  3892     12  REI-REM-AH          PIC S9(11)V99 COMP-3  VALUE ZERO.
  3893     12  TOT-FUTR-FACE       PIC S9(11)V99 COMP-3  VALUE ZERO.
  3894     12  REI-FUTR-FACE       PIC S9(11)V99 COMP-3  VALUE ZERO.
  3895     12  TOT-MO-DEC          PIC S9(11)V99 COMP-3  VALUE ZERO.
  3896     12  REI-MO-DEC          PIC S9(11)V99 COMP-3  VALUE ZERO.
  3897     12  TOT-LF-AMT          PIC S9(11)V99 COMP-3  VALUE ZERO.
  3898     12  TOT-AH-AMT          PIC S9(11)V99 COMP-3  VALUE ZERO.
  3899     12  TOT-CANC-LF-AMT     PIC S9(11)V99 COMP-3  VALUE ZERO.
  3900     12  TOT-CANC-AH-AMT     PIC S9(11)V99 COMP-3  VALUE ZERO.
  3901     12  TOT-DTH-AMT         PIC S9(11)V99 COMP-3  VALUE ZERO.
  3902     12  TOT-DIS-AMT         PIC S9(11)V99 COMP-3  VALUE ZERO.
  3903     12  TOT-EXP-LF-AMT      PIC S9(11)V99 COMP-3  VALUE ZERO.
  3904     12  TOT-EXP-AH-AMT      PIC S9(11)V99 COMP-3  VALUE ZERO.
  3905     12  TOT-FUTR-LF-AMT     PIC S9(11)V99 COMP-3  VALUE ZERO.
  3906     12  TOT-FUTR-AH-AMT     PIC S9(11)V99 COMP-3  VALUE ZERO.
  3907     12  TOT-ACTIVE-LF-AMT   PIC S9(11)V99 COMP-3  VALUE ZERO.
  3908     12  TOT-ACTIVE-AH-AMT   PIC S9(11)V99 COMP-3  VALUE ZERO.
  3909     12  TOT-ACT-LF-AMT-OB   PIC S9(11)V99 COMP-3  VALUE ZERO.
  3910     12  TOT-ACT-AH-AMT-OB   PIC S9(11)V99 COMP-3  VALUE ZERO.
  3911
  3912 01  ZERO-ACCUMS             PIC X(298).
  3913
  3914 01  FIN-TOT-ACCUMS.
  3915     12  F-TOT-READ          PIC S9(9)     COMP-3  VALUE ZERO.
  3916     12  F-TOT-REIS          PIC S9(9)     COMP-3  VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  75
* ECS050.cbl
  3917     12  F-TOT-DECLINED      PIC S9(9)     COMP-3  VALUE ZERO.
  3918     12  F-TOT-VOIDED        PIC S9(9)     COMP-3  VALUE ZERO.
  3919     12  F-TOT-REIO          PIC S9(9)     COMP-3  VALUE ZERO.
  3920     12  F-TOT-SNGLPRM       PIC S9(9)     COMP-3  VALUE ZERO.
  3921     12  F-TOT-OB            PIC S9(9)     COMP-3  VALUE ZERO.
  3922     12  F-TOT-SUM           PIC S9(9)     COMP-3  VALUE ZERO.
  3923     12  F-TOT-LF            PIC S9(9)     COMP-3  VALUE ZERO.
  3924     12  F-TOT-AH            PIC S9(9)     COMP-3  VALUE ZERO.
  3925     12  F-TOT-CANC-LF       PIC S9(9)     COMP-3  VALUE ZERO.
  3926     12  F-TOT-CANC-AH       PIC S9(9)     COMP-3  VALUE ZERO.
  3927     12  F-TOT-DTH           PIC S9(9)     COMP-3  VALUE ZERO.
  3928     12  F-TOT-DIS           PIC S9(9)     COMP-3  VALUE ZERO.
  3929     12  F-TOT-EXP-LF        PIC S9(9)     COMP-3  VALUE ZERO.
  3930     12  F-TOT-EXP-AH        PIC S9(9)     COMP-3  VALUE ZERO.
  3931     12  F-TOT-FUTR-LF       PIC S9(9)     COMP-3  VALUE ZERO.
  3932     12  F-TOT-FUTR-AH       PIC S9(9)     COMP-3  VALUE ZERO.
  3933     12  F-TOT-ACTIVE-LF     PIC S9(9)     COMP-3  VALUE ZERO.
  3934     12  F-TOT-ACTIVE-LF-OB  PIC S9(9)     COMP-3  VALUE ZERO.
  3935     12  F-TOT-ACTIVE-AH     PIC S9(9)     COMP-3  VALUE ZERO.
  3936     12  F-TOT-ACTIVE-AH-OB  PIC S9(9)     COMP-3  VALUE ZERO.
  3937     12  F-TOT-ALPHA         PIC S9(9)     COMP-3  VALUE ZERO.
  3938     12  F-TOT-ALPHA-JOINT   PIC S9(9)     COMP-3  VALUE ZERO.
  3939     12  F-TOT-GAAP          PIC S9(9)     COMP-3  VALUE ZERO.
  3940     12  F-REI-GAAP          PIC S9(9)     COMP-3  VALUE ZERO.
  3941     12  F-TOT-INIT-FACE     PIC S9(11)V99 COMP-3  VALUE ZERO.
  3942     12  F-REI-INIT-FACE     PIC S9(11)V99 COMP-3  VALUE ZERO.
  3943     12  F-TOT-REM-FACE      PIC S9(11)V99 COMP-3  VALUE ZERO.
  3944     12  F-REI-REM-FACE      PIC S9(11)V99 COMP-3  VALUE ZERO.
  3945     12  F-TOT-REM-AH        PIC S9(11)V99 COMP-3  VALUE ZERO.
  3946     12  F-REI-REM-AH        PIC S9(11)V99 COMP-3  VALUE ZERO.
  3947     12  F-TOT-FUTR-FACE     PIC S9(11)V99 COMP-3  VALUE ZERO.
  3948     12  F-REI-FUTR-FACE     PIC S9(11)V99 COMP-3  VALUE ZERO.
  3949     12  F-TOT-MO-DEC        PIC S9(11)V99 COMP-3  VALUE ZERO.
  3950     12  F-REI-MO-DEC        PIC S9(11)V99 COMP-3  VALUE ZERO.
  3951     12  F-TOT-LF-AMT        PIC S9(11)V99 COMP-3  VALUE ZERO.
  3952     12  F-TOT-AH-AMT        PIC S9(11)V99 COMP-3  VALUE ZERO.
  3953     12  F-TOT-CANC-LF-AMT   PIC S9(11)V99 COMP-3  VALUE ZERO.
  3954     12  F-TOT-CANC-AH-AMT   PIC S9(11)V99 COMP-3  VALUE ZERO.
  3955     12  F-TOT-DTH-AMT       PIC S9(11)V99 COMP-3  VALUE ZERO.
  3956     12  F-TOT-DIS-AMT       PIC S9(11)V99 COMP-3  VALUE ZERO.
  3957     12  F-TOT-EXP-LF-AMT    PIC S9(11)V99 COMP-3  VALUE ZERO.
  3958     12  F-TOT-EXP-AH-AMT    PIC S9(11)V99 COMP-3  VALUE ZERO.
  3959     12  F-TOT-FUTR-LF-AMT   PIC S9(11)V99 COMP-3  VALUE ZERO.
  3960     12  F-TOT-FUTR-AH-AMT   PIC S9(11)V99 COMP-3  VALUE ZERO.
  3961     12  F-TOT-ACTIVE-LF-AMT PIC S9(11)V99 COMP-3  VALUE ZERO.
  3962     12  F-TOT-ACTIVE-AH-AMT PIC S9(11)V99 COMP-3  VALUE ZERO.
  3963     12  F-TOT-ACT-LF-AMT-OB PIC S9(11)V99 COMP-3  VALUE ZERO.
  3964     12  F-TOT-ACT-AH-AMT-OB PIC S9(11)V99 COMP-3  VALUE ZERO.
  3965
  3966
  3967 01  WS-EXCEP-REPT-LINE.
  3968     03  FILLER                  PIC X(4).
  3969     03  EXP-CARRIER             PIC X.
  3970     03  FILLER                  PIC X(6).
  3971     03  EXP-GROUPING            PIC X(6).
  3972     03  FILLER                  PIC X(5).
  3973     03  EXP-STATE               PIC XX.
  3974     03  FILLER                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  76
* ECS050.cbl
  3975     03  EXP-ACCT                PIC X(10).
  3976     03  FILLER                  PIC XX.
  3977     03  EXP-CERT                PIC X(11).
  3978     03  FILLER                  PIC XX.
  3979     03  EXP-EFF-MO              PIC 99.
  3980     03  EXP-SLASH-1             PIC X.
  3981     03  EXP-EFF-DA              PIC 99.
  3982     03  EXP-SLASH-2             PIC X.
  3983     03  EXP-EFF-YR              PIC 99.
  3984     03  FILLER                  PIC X(2).
  3985     03  EXP-MESSAGE             PIC X(66).
  3986
  3987 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  3988     12  WS-CHARGEBACK-LEVELS.
  3989         16  WS-CHARGEBACK-SW    PIC X(01) OCCURS 10 TIMES.
  3990
  3991 01  EXCEPTION-MESSAGES.
  3992     03  EXC-1.
  3993         05  FILLER              PIC X(17)
  3994                        VALUE 'EARNING METHOD IS'.
  3995         05  FILLER              PIC X(24)
  3996                        VALUE ' NET PAY AND CERT CONTAI'.
  3997         05  FILLER              PIC X(25)
  3998                        VALUE 'NS A ZERO APR.           '.
  3999
  4000     03  EXC-2.
  4001         05  FILLER              PIC X(17)
  4002                        VALUE 'EARN METHOD NET P'.
  4003         05  FILLER              PIC X(24)
  4004                        VALUE 'AY TRUNCATED-LOAN TERM L'.
  4005         05  FILLER              PIC X(25)
  4006                        VALUE 'ESS THAN INSURANCE TERM  '.
  4007
  4008     03  EXC-3.
  4009         05  FILLER              PIC X(17)
  4010                        VALUE 'ERROR OCCURED IN '.
  4011         05  FILLER              PIC X(24)
  4012                        VALUE 'CALCULATING UNEARNED PR'.
  4013         05  FILLER              PIC X(25)
  4014                        VALUE 'EMIUM.                   '.
  4015
* 4016     COPY ELCDTECX.
  4017******************************************************************06/05/98
  4018*                                                                *ELCDTECX
  4019*                            ELCDTECX.                           *   LV005
  4020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4021*                            VMOD=2.015                          *ELCDTECX
  4022*                                                                *ELCDTECX
  4023*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  4024*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  4025*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  4026*                                                                *ELCDTECX
  4027******************************************************************ELCDTECX
  4028******************************************************************
  4029*                   C H A N G E   L O G
  4030*
  4031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4032*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  77
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  4033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4034* EFFECTIVE    NUMBER
  4035*-----------------------------------------------------------------
  4036* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  4037*                                  BENEFIT CODES FROM 300 TO 900
  4038* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  4039* 051304    2003080800002  SMVA  ADD REFUND METHOD
  4040******************************************************************
  4041 01  DATE-CARD.                                                   ELCDTECX
  4042     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  4043     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  4044     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  4045     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  4046     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  4047     12  EP-SW                       PIC  X.                      ELCDTECX
  4048         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  4049     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  4050         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  4051     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  4052     12  RUN-CENTURY.                                             ELCDTECX
  4053         16 RUN-CENTURY-N            PIC  99.                        CL**4
  4054     12  FILLER                      PIC  X.                         CL**4
  4055     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  4056     12  FILLER                      PIC  XXX.                    ELCDTECX
  4057     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  4058                                                                  ELCDTECX
  4059 01  FILLER                          PIC  X(7)                       CL**6
  4060                                          VALUE 'OPTIONS'.        ELCDTECX
  4061 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  4062     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  4063     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  4064     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  4065         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  4066         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  4067     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  4068     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  4069     12  FILLER                      PIC  X.                      ELCDTECX
  4070     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  4071     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  4072     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  4073     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  4074     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  4075     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  4076     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  4077     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  4078     12  FILLER                      PIC  X.                      ELCDTECX
  4079     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  4080     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  4081     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  4082     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  4083     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  4084     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  4085     12  FILLER                      PIC  X.                      ELCDTECX
  4086     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  4087     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  4088     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  4089     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  4090     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  78
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  4091     12  DTE-R78                     PIC  X.                      ELCDTECX
  4092     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  4093     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  4094     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  4095     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  4096     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  4097     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  4098     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  4099                                     PIC  X.                      ELCDTECX
  4100         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  4101                                                 ' '.             ELCDTECX
  4102         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  4103         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  4104     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  4105         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  4106         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  4107     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  4108     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  4109                                     PIC  9.                         CL**4
  4110     12  DTE-SYSTEM.                                              ELCDTECX
  4111         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  4112         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  4113         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  4114         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  4115         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  4116         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  4117         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  4118         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  4119         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  4120         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  4121         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  4122         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  4123         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  4124         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  4125         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  4126         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  4127         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  4128         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  4129         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  4130         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  4131         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  4132         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  4133         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  4134         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  4135         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  4136         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  4137     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  4138         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  4139                                     PIC  X.                      ELCDTECX
  4140     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  4141                                                                  ELCDTECX
  4142 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  4143     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  4144     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  4145     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  4146*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  4147     12  FILLER                      PIC  X.                      ELCDTECX
  4148     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  79
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  4149     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  4150     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  4151     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  4152     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  4153     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  4154     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  4155                                                                  ELCDTECX
  4156     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  4157     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  4158     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  4159     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  4160                                                                  ELCDTECX
  4161     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  4162     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  4163     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  4164     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  4165                                                                  ELCDTECX
  4166     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  4167     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  4168                                                                  ELCDTECX
  4169     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  4170     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  4171                                                                  ELCDTECX
  4172     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  4173                                                                  ELCDTECX
  4174 01  DATE-CARD-FACTORS.                                           ELCDTECX
  4175     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  4176     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  4177     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  4178     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  4179     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  4180     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  4181     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  4182                                                                  ELCDTECX
  4183 01  FILLER                          PIC  X(12)                   ELCDTECX
  4184                                          VALUE 'COMPANY NAME'.   ELCDTECX
  4185 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  4186     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  4187         16  CNT-ID                  PIC  X.                      ELCDTECX
  4188         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  4189                                                                  ELCDTECX
  4190 01  FILLER                          PIC  X(11)                   ELCDTECX
  4191                                          VALUE 'STATE NAMES'.    ELCDTECX
  4192 01  STATE-NAMES.                                                 ELCDTECX
  4193     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  4194         16  STATE-SUB               PIC  XX.                     ELCDTECX
  4195         16  STATE-PIC1.                                          ELCDTECX
  4196             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  4197             20  FILLER              PIC  XXX.                    ELCDTECX
  4198             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  4199             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  4200             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  4201             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  4202                                                                  ELCDTECX
  4203 01  FILLER                          PIC  X(13)                   ELCDTECX
  4204                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  4205 01  CARRIER-NAMES.                                               ELCDTECX
  4206     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  80
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  4207         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  4208         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  4209         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  4210         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  4211         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  4212         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  4213*        16  FILLER                  PIC  X.                      ELCDTECX
  4214         16  CARRIER-SEC-PAY         PIC  X.
  4215             88  SEC-PAY-CARRIER          VALUE 'Y'.
  4216                                                                  ELCDTECX
  4217 01  FILLER                          PIC  X(9)                       CL**6
  4218                                          VALUE 'INS TYPES'.      ELCDTECX
  4219 01  CLAS-INS-TYPES.                                              ELCDTECX
  4220*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  4221     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  4222         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  4223         16  CLAS-I-AB3.                                          ELCDTECX
  4224             20  FILLER              PIC  X.                      ELCDTECX
  4225             20  CLAS-I-AB2.                                      ELCDTECX
  4226                 24  FILLER          PIC  X.                      ELCDTECX
  4227                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  4228         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  4229             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  4230             20  FILLER              PIC  X.                         CL**4
  4231         16  CLAS-I-AB10.                                         ELCDTECX
  4232             20  FILLER              PIC  X(9).                   ELCDTECX
  4233             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  4234         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  4235         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  4236         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  4237         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  4238             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  4239         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  4240         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  4241         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  4242         16  CLAS-I-BEN-CATEGORY     PIC  X.
  4243         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  4244         16  FILLER                  PIC  X(05).
  4245                                                                  ELCDTECX
  4246 01  FILLER                          PIC  X(16)                   ELCDTECX
  4247                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  4248 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  4249     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  4250                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  4251         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  4252         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  4253         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  4254         16  CLAS-MORT-DESC.                                      ELCDTECX
  4255             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  4256             20  FILLER              PIC  XX.                        CL**5
  4257             20  CLAS-YEAR           PIC  X(4).                      CL**6
  4258             20  FILLER              PIC  X.                         CL**5
  4259             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  4260             20  FILLER              PIC  X.                         CL**5
  4261             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  4262             20  FILLER              PIC  X.                         CL**5
  4263             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  4264             20  FILLER              PIC  X(5).                      CL**6
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  81
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  4265                                                                  ELCDTECX
  4266 01  FILLER                          PIC  X(15)                   ELCDTECX
  4267                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  4268 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  4269     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  4270         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  4271         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  4272         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  4273         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  4274         16  FILLER                  PIC  X(4).                      CL**6
  4275                                                                  ELCDTECX
  4276 01  FILLER                          PIC  X(7)                       CL**6
  4277                                     VALUE 'INDEXES'.             ELCDTECX
  4278 01  CLAS-INDEX-TBL.                                              ELCDTECX
  4279     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  4280     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  4281     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  4282     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  4283     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  4284     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  4285     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  4286     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  4287     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  4288     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  4289     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  4290     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  4291     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  4292     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  4293     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  4294     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  4295     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  4296                                                                  ELCDTECX
  4297 01  CLAS-TYPE-MISC.                                              ELCDTECX
  4298     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  4299     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  4300     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  4301     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  4302     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  4303     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  4304     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  4305     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  4306     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  4307     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  4308     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  4309                                                                  ELCDTECX
  4310 01  FILLER                          PIC  X(13)                   ELCDTECX
  4311                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  4312 01  CLAS-MISC.                                                   ELCDTECX
  4313     12  DTE-FICH                    PIC  X.                      ELCDTECX
  4314         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  4315         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  4316         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  4317     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  4318     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  4319     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  4320     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  4321     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  4322     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  82
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  4323     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  4324     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  4325     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  4326     12  STATE-L                     PIC  XX.                     ELCDTECX
  4327     12  CLAS-CN                     PIC  99.                     ELCDTECX
  4328     12  CLAS-CO                     PIC  99.                     ELCDTECX
  4329     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  4330         16  DTE-F-1                 PIC  X.                      ELCDTECX
  4331         16  DTE-F-2                 PIC  X.                      ELCDTECX
  4332     12  DTE-ABEND-WORK.                                          ELCDTECX
  4333         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  4334         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  4335                                                                  ELCDTECX
  4336 01  FILLER                          PIC  X(12)                   ELCDTECX
  4337                                     VALUE 'WORKING DATE'.        ELCDTECX
  4338 01  WS-DATE-AND-TIME.                                            ELCDTECX
  4339     12  WS-ACCEPT-DATE.                                          ELCDTECX
  4340         16  WS-AD-YY                PIC  99.                     ELCDTECX
  4341         16  WS-AD-MM                PIC  99.                     ELCDTECX
  4342         16  WS-AD-DD                PIC  99.                     ELCDTECX
  4343     12  WS-CURRENT-DATE.                                         ELCDTECX
  4344         16  WS-CD-MM                PIC  99.                     ELCDTECX
  4345         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  4346         16  WS-CD-DD                PIC  99.                     ELCDTECX
  4347         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  4348         16  WS-CD-YY                PIC  99.                     ELCDTECX
  4349     12  WS-TIME-OF-DAY.                                          ELCDTECX
  4350         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  4351         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  4352                                                                  ELCDTECX
  4353 01  FILLER                          PIC  X(12)                   ELCDTECX
  4354                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  4355 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  4356     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  4357         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  4358         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  4359         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  4360                                                                  ELCDTECX
  4361 01  FILLER                          PIC  X(10)                   ELCDTECX
  4362                                     VALUE 'STATE TLRS'.          ELCDTECX
  4363 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  4364     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  4365         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  4366         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  4367                                                                  ELCDTECX
  4368 01  FILLER                          PIC  X(13)                   ELCDTECX
  4369                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  4370 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  4371     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  4372         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  4373                                                                  ELCDTECX
  4374 01  FILLER                          PIC  X(13)                   ELCDTECX
  4375                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  4376 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  4377     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  4378     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  4379     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  4380                                     PIC  X.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  83
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  4381     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  4382     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  4383     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  4384     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  4385     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  4386     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  4387     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  4388     12  FILLER                      PIC  X(75).                  ELCDTECX
  4389******************************************************************ELCDTECX
  4390*01  MISC-CARR-PCT-DATA.                                          00001521
  4391*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  4392*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  4393*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  4394*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  4395*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  4396*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  4397******************************************************************ELCDTECX
  4398
* 4399     COPY ELCDTEVR.
  4400***************************************************************** 04/15/98
  4401*                                                                *ELCDTEVR
  4402*                                                                *ELCDTEVR
  4403*                            ELCDTEVR.                           *   LV003
  4404*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4405*                            VMOD=2.001                          *   CL**2
  4406*                                                                *ELCDTEVR
  4407*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  4408*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  4409*                                                                *ELCDTEVR
  4410******************************************************************ELCDTEVR
  4411 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  4412     05  WS-RUN-DATE.                                             ELCDTEVR
  4413         10  FILLER                  PIC  9(03).                  ELCDTEVR
  4414         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  4415         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  4416             15  RUN-CC              PIC  99.                     ELCDTEVR
  4417             15  RUN-YR              PIC  99.                     ELCDTEVR
  4418         10  RUN-MO                  PIC  99.                     ELCDTEVR
  4419         10  RUN-DA                  PIC  99.                     ELCDTEVR
  4420     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  4421            WS-RUN-DATE              PIC 9(11).                      CL**2
  4422     05  WS-EP-DT.                                                ELCDTEVR
  4423         10  FILLER                  PIC  9(03).                  ELCDTEVR
  4424         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  4425         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  4426             15  EP-CC               PIC  99.                     ELCDTEVR
  4427             15  EP-YR               PIC  99.                     ELCDTEVR
  4428         10  EP-MO                   PIC  99.                     ELCDTEVR
  4429         10  EP-DA                   PIC  99.                     ELCDTEVR
  4430     05  WS-EP-DT-N REDEFINES                                        CL**2
  4431            WS-EP-DT                 PIC 9(11).                      CL**2
  4432     05  WS-DTE-CONV-DT.                                             CL**4
  4433         10  FILLER                  PIC  9(03).                     CL**4
  4434         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  4435         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  4436             15  DTE-CONV-CC         PIC  99.                        CL**4
  4437             15  DTE-CONV-YR         PIC  99.                        CL**4
  4438         10  DTE-CONV-MO             PIC  99.                        CL**4
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  84
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  4439         10  DTE-CONV-DA             PIC  99.                        CL**4
  4440     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  4441            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  4442 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  4443     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  4444         10  FILLER                            PIC 999.           ELCDTEVR
  4445         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  4446         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  4447             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  4448             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  4449         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  4450         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  4451     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  4452            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  4453     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  4454         10  FILLER                            PIC 999.           ELCDTEVR
  4455         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  4456         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  4457         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  4458         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  4459     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  4460            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  4461 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  4462     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  4463         10  FILLER                            PIC 999.           ELCDTEVR
  4464         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  4465         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  4466             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  4467             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  4468         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  4469         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  4470     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  4471            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  4472     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  4473         10  FILLER                            PIC 999.           ELCDTEVR
  4474         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  4475         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  4476             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  4477             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  4478         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  4479         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  4480     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  4481            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  4482     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  4483         10  FILLER                            PIC 999.           ELCDTEVR
  4484         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  4485         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  4486             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  4487             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  4488         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  4489         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  4490     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  4491            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  4492 01  WS-RATE-RECORD.                                              ELCDTEVR
  4493         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  4494             10  FILLER                        PIC 999.           ELCDTEVR
  4495             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  4496             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  85
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  4497                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  4498                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  4499             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  4500             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  4501         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  4502                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  4503
* 4504     COPY ELCCRTVR.
  4505***************************************************************** 04/24/98
  4506*                                                                *ELCCRTVR
  4507*                                                                *ELCCRTVR
  4508*                            ELCCRTVR                            *   LV003
  4509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4510*                            VMOD=2.001                          *ELCCRTVR
  4511*                                                                *ELCCRTVR
  4512*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  4513*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  4514*                                                                *ELCCRTVR
  4515******************************************************************ELCCRTVR
  4516                                                                  ELCCRTVR
  4517 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  4518     05  WS-CR-DT.                                                ELCCRTVR
  4519         10  FILLER                PIC 999.                       ELCCRTVR
  4520         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  4521         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  4522             15  CR-CC             PIC 99.                        ELCCRTVR
  4523             15  CR-YR             PIC 99.                        ELCCRTVR
  4524         10  CR-MO                 PIC 99.                        ELCCRTVR
  4525         10  CR-DA                 PIC 99.                        ELCCRTVR
  4526     05  WS-CR-DT-N REDEFINES                                        CL**2
  4527            WS-CR-DT               PIC 9(11).                        CL**2
  4528     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  4529         10  FILLER                    PIC 999.                   ELCCRTVR
  4530         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  4531         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  4532             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  4533             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  4534         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  4535         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  4536     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  4537            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  4538     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  4539         10  FILLER                    PIC 999.                   ELCCRTVR
  4540         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  4541         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  4542             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  4543             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  4544         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  4545         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  4546     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  4547            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  4548     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  4549         10  FILLER                    PIC 999.                   ELCCRTVR
  4550         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  4551         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  4552             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  4553             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  4554         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  86
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4555         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  4556     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  4557            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  4558     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  4559         10  FILLER                    PIC 999.                   ELCCRTVR
  4560         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  4561         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  4562             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  4563             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  4564         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  4565         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  4566     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  4567            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  4568     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  4569         10  FILLER                    PIC 999.                   ELCCRTVR
  4570         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  4571         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  4572             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  4573             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  4574         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  4575         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  4576     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  4577            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  4578     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  4579         10  FILLER                    PIC 999.                   ELCCRTVR
  4580         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  4581         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  4582             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  4583             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  4584         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  4585         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  4586     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  4587            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  4588     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  4589         10  FILLER                    PIC 999.                   ELCCRTVR
  4590         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  4591         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  4592             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  4593             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  4594         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  4595         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  4596     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  4597            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  4598     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  4599         10  FILLER                    PIC 999.                   ELCCRTVR
  4600         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  4601         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  4602             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  4603             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  4604         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  4605         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  4606     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  4607            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  4608     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  4609         10  FILLER                    PIC 999.                   ELCCRTVR
  4610         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  4611         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  4612             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  87
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4613             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  4614         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  4615         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  4616     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  4617          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  4618     05  WS-CR-DTH-DT.                                            ELCCRTVR
  4619         10  FILLER                    PIC 999.                   ELCCRTVR
  4620         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  4621         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  4622             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  4623             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  4624         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  4625         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  4626     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  4627            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  4628     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  4629         10  FILLER                    PIC 999.                   ELCCRTVR
  4630         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  4631         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  4632             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  4633             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  4634         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  4635         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  4636     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  4637            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  4638     05  WS-CR-DIS-DT.                                            ELCCRTVR
  4639         10  FILLER                    PIC 999.                   ELCCRTVR
  4640         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  4641         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  4642             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  4643             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  4644         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  4645         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  4646     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  4647            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  4648     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  4649         10  FILLER                    PIC 999.                   ELCCRTVR
  4650         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  4651         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  4652             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  4653             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  4654         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  4655         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  4656     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  4657            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  4658     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  4659         10  FILLER                    PIC 999.                   ELCCRTVR
  4660         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  4661         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  4662             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  4663             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  4664         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  4665         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  4666     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  4667            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  4668     05  COPY-NDX                      PIC 9.                        CL**6
  4669     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  4670         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  88
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4671             15  FILLER                PIC 999.                   ELCCRTVR
  4672             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  4673             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  4674                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  4675                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  4676             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  4677             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  4678         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  4679                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  4680
* 4681     COPY ELCACCTV.
  4682******************************************************************04/14/98
  4683*                                                                *ELCACCTV
  4684*                            ELCACCTV                            *   LV002
  4685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4686*                            VMOD=2.001                          *ELCACCTV
  4687*                                                                *ELCACCTV
  4688*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  4689*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  4690*                                                                *ELCACCTV
  4691*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  4692*                                                                *ELCACCTV
  4693******************************************************************ELCACCTV
  4694                                                                  ELCACCTV
  4695 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  4696                                                                  ELCACCTV
  4697     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  4698         10  FILLER            PIC 999.                           ELCACCTV
  4699         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  4700         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  4701             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  4702             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  4703         10  AM-EXP-MO         PIC 99.                               CL**5
  4704         10  AM-EXP-DA         PIC 99.                               CL**5
  4705     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  4706            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  4707     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  4708         10  FILLER                    PIC 999.                   ELCACCTV
  4709         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  4710         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  4711             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  4712             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  4713         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  4714         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  4715     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  4716            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  4717     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  4718         10  FILLER                    PIC 999.                   ELCACCTV
  4719         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  4720         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  4721             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  4722             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  4723         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  4724         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  4725     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  4726            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  4727     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  4728         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  89
* ECS050.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  4729         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  4730         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  4731            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  4732            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  4733         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  4734         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  4735     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  4736            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  4737     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  4738         10 FILLER                     PIC 999.                   ELCACCTV
  4739         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  4740         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  4741            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  4742            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  4743         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  4744         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  4745     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  4746            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  4747     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  4748         10  FILLER                    PIC 999.                   ELCACCTV
  4749         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  4750         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  4751             15  AM-AN-CC              PIC 99.                    ELCACCTV
  4752             15  AM-AN-YR              PIC 99.                    ELCACCTV
  4753         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  4754         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  4755     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  4756            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  4757     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  4758         10  FILLER                    PIC 999.                   ELCACCTV
  4759         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  4760         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  4761             15  AM-HI-CC              PIC 99.                    ELCACCTV
  4762             15  AM-HI-YR              PIC 99.                    ELCACCTV
  4763         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  4764         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  4765     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  4766            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  4767     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  4768         10  FILLER                    PIC 999.                   ELCACCTV
  4769         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  4770         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  4771             15  AM-LO-CC              PIC 99.                    ELCACCTV
  4772             15  AM-LO-YR              PIC 99.                    ELCACCTV
  4773         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  4774         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  4775     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  4776            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  4777     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  4778         10  FILLER                    PIC 999.                   ELCACCTV
  4779         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  4780         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  4781             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  4782             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  4783         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  4784         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  4785     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  4786            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  90
* ECS050.cbl
  4787
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  91
* ECS050.cbl
  4789 PROCEDURE DIVISION.
  4790
  4791 0000-GET-START-TIME.
  4792
  4793 0003-LOAD-DATE-CARD.
* 4794                             COPY ELCDTERX.
  4795******************************************************************04/15/98
  4796*                                                                *ELCDTERX
  4797*                                                                *ELCDTERX
  4798*                            ELCDTERX.                           *   LV002
  4799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4800*                            VMOD=2.007                          *ELCDTERX
  4801*                                                                *ELCDTERX
  4802*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  4803*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  4804*      = ELCDTEFD)                                               *ELCDTERX
  4805*                                                                *ELCDTERX
  4806******************************************************************ELCDTERX
  4807                                                                  ELCDTERX
  4808     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  4809                                                                  ELCDTERX
  4810     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  4811     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  4812     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  4813                                                                  ELCDTERX
  4814     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  4815                                                                  ELCDTERX
  4816******************************************************************ELCDTERX
  4817*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  4818*          WARNING MESSAGES.                                      ELCDTERX
  4819******************************************************************ELCDTERX
  4820     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  4821         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  4822                                                                  ELCDTERX
  4823     OPEN INPUT DISK-DATE.                                        ELCDTERX
  4824                                                                  ELCDTERX
  4825     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  4826                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  4827                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  4828                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  4829                   CLAX-ID           CLAS-MISC                    ELCDTERX
  4830                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  4831                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  4832                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  4833                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  4834                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  4835                                                                  ELCDTERX
  4836     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  4837                                                                  ELCDTERX
  4838     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  4839                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  4840                                                                  ELCDTERX
  4841     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  4842     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  4843     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  4844     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  4845                                                                  ELCDTERX
  4846     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  92
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4847         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4848     ELSE                                                         ELCDTERX
  4849         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4850                                                                  ELCDTERX
  4851     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4852         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4853     ELSE                                                         ELCDTERX
  4854         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4855                                                                  ELCDTERX
  4856 0005-READ--CARD.                                                 ELCDTERX
  4857     READ DISK-DATE                                               ELCDTERX
  4858         AT END CLOSE DISK-DATE                                   ELCDTERX
  4859             GO TO 0060-READ--TEST.                               ELCDTERX
  4860                                                                  ELCDTERX
  4861     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4862                                                                  ELCDTERX
  4863     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4864         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4865         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4866         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4867         GO TO 0005-READ--CARD.                                   ELCDTERX
  4868                                                                  ELCDTERX
  4869     IF DD-ID = 'CLAD'                                            ELCDTERX
  4870         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4871         GO TO 0005-READ--CARD.                                   ELCDTERX
  4872                                                                  ELCDTERX
  4873     IF DD-ID = 'CLAX'                                            ELCDTERX
  4874         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4875         GO TO 0005-READ--CARD.                                   ELCDTERX
  4876                                                                  ELCDTERX
  4877     IF DD-ID = 'CLAF'                                            ELCDTERX
  4878         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4879         GO TO 0005-READ--CARD.                                   ELCDTERX
  4880                                                                  ELCDTERX
  4881     IF DD-ID = 'CLAC'                                            ELCDTERX
  4882         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4883                                                                  ELCDTERX
  4884     IF DD-ID = 'CARR'                                            ELCDTERX
  4885         GO TO 0015-READ--CARR.                                   ELCDTERX
  4886                                                                  ELCDTERX
  4887     IF DD-ID = 'STAT'                                            ELCDTERX
  4888         GO TO 0020-READ--STAT.                                   ELCDTERX
  4889                                                                  ELCDTERX
  4890     IF DD-ID = 'BUSC'                                            ELCDTERX
  4891         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4892                                                                  ELCDTERX
  4893     IF DD-ID = 'MORT'                                            ELCDTERX
  4894         GO TO 0030-READ--MORT.                                   ELCDTERX
  4895                                                                  ELCDTERX
  4896     IF DD-ID = 'CLAI'                                            ELCDTERX
  4897         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4898                                                                  ELCDTERX
  4899     IF DD-ID = 'COLC'                                            ELCDTERX
  4900         GO TO 0065-READ--COLC.                                   ELCDTERX
  4901                                                                  ELCDTERX
  4902     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4903        DD-IDA = 'CL'                                             ELCDTERX
  4904         GO TO 0035-READ--CLXX.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  93
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4905                                                                  ELCDTERX
  4906     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4907        DD-IDA = 'PO'                                             ELCDTERX
  4908         GO TO 0050-READ--POXX.                                   ELCDTERX
  4909                                                                  ELCDTERX
  4910     IF DD-ID = 'OPCA'                                            ELCDTERX
  4911         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4912                                                                  ELCDTERX
  4913     IF DD-ID = 'OPST'                                            ELCDTERX
  4914         GO TO 0072-READ--OPST.                                   ELCDTERX
  4915                                                                  ELCDTERX
  4916     IF DD-ID = 'OPBS'                                            ELCDTERX
  4917         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4918                                                                  ELCDTERX
  4919     IF DD-ID = 'OPMS'                                            ELCDTERX
  4920         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4921                                                                  ELCDTERX
  4922     GO TO 0005-READ--CARD.                                       ELCDTERX
  4923                                                                  ELCDTERX
  4924 0010-READ--CLAC.                                                 ELCDTERX
  4925     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4926     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4927     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4928     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4929     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4930     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4931     GO TO 0005-READ--CARD.                                       ELCDTERX
  4932                                                                  ELCDTERX
  4933 0015-READ--CARR.                                                 ELCDTERX
  4934     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4935     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4936        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4937        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4938        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4939        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4940        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4941        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4942        MOVE DD-CARR1-SECPAY-SW
  4943                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4944     END-IF
  4945                                                                  ELCDTERX
  4946     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4947     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4948        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4949        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4950        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4951        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4952        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4953        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4954        MOVE DD-CARR2-SECPAY-SW
  4955                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4956     END-IF
  4957                                                                  ELCDTERX
  4958                                                                  ELCDTERX
  4959     GO TO 0005-READ--CARD.                                       ELCDTERX
  4960                                                                  ELCDTERX
  4961 0020-READ--STAT.                                                 ELCDTERX
  4962     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  94
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4963     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4964        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4965         GO TO 0005-READ--CARD.                                   ELCDTERX
  4966                                                                  ELCDTERX
  4967     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4968     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4969     GO TO 0020-READ--STAT.                                       ELCDTERX
  4970                                                                  ELCDTERX
  4971 0025-READ--BUSC.                                                 ELCDTERX
  4972     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4973     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4974        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4975         GO TO 0005-READ--CARD.                                   ELCDTERX
  4976                                                                  ELCDTERX
  4977     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4978     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4979     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4980                                                                  ELCDTERX
  4981 0030-READ--MORT.                                                 ELCDTERX
  4982     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4983     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4984        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4985         GO TO 0005-READ--CARD.                                   ELCDTERX
  4986                                                                  ELCDTERX
  4987     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4988     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4989     GO TO 0030-READ--MORT.                                       ELCDTERX
  4990                                                                  ELCDTERX
  4991 0035-READ--CLXX.                                                 ELCDTERX
  4992     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4993          GO TO 0005-READ--CARD.                                  ELCDTERX
  4994                                                                  ELCDTERX
  4995     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4996         DISPLAY '***********************************************'ELCDTERX
  4997         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4998         DISPLAY '***********************************************'ELCDTERX
  4999         GO TO 0055-READ--STOP.                                   ELCDTERX
  5000                                                                  ELCDTERX
  5001     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  5002        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  5003         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  5004                                                                  ELCDTERX
  5005     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  5006        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  5007         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  5008                                                                  ELCDTERX
  5009*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  5010     GO TO 0005-READ--CARD.                                       ELCDTERX
  5011                                                                  ELCDTERX
  5012 0040-READ--CLAI.                                                 ELCDTERX
  5013     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  5014     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  5015        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  5016         GO TO 0005-READ--CARD.                                   ELCDTERX
  5017                                                                  ELCDTERX
  5018     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  5019     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  5020     GO TO 0040-READ--CLAI.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  95
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  5021                                                                  ELCDTERX
  5022 0045-READ--DUMP.                                                 ELCDTERX
  5023     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  5024     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  5025                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  5026     PERFORM ABEND-PGM.                                           ELCDTERX
  5027                                                                  ELCDTERX
  5028 0050-READ--POXX.                                                 ELCDTERX
  5029     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  5030         GO TO 0005-READ--CARD.                                   ELCDTERX
  5031                                                                  ELCDTERX
  5032     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  5033         DISPLAY '***********************************************'ELCDTERX
  5034         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  5035         DISPLAY '***********************************************'ELCDTERX
  5036         GO TO 0055-READ--STOP.                                   ELCDTERX
  5037                                                                  ELCDTERX
  5038     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  5039     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  5040     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  5041     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  5042                                                                  ELCDTERX
  5043     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  5044         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  5045     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  5046         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  5047                                                                  ELCDTERX
  5048     GO TO 0005-READ--CARD.                                       ELCDTERX
  5049                                                                  ELCDTERX
  5050 0055-READ--STOP.                                                 ELCDTERX
  5051     GOBACK.                                                      ELCDTERX
  5052                                                                  ELCDTERX
  5053 0060-READ--TEST.                                                 ELCDTERX
  5054     IF DATX-COD        = SPACE  OR                               ELCDTERX
  5055        CLAX-ID         = SPACE  OR                               ELCDTERX
  5056        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  5057         GO TO 0045-READ--DUMP.                                   ELCDTERX
  5058                                                                  ELCDTERX
  5059     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  5060     GO TO 0079-READ--EXIT.                                       ELCDTERX
  5061                                                                  ELCDTERX
  5062 0065-READ--COLC.                                                 ELCDTERX
  5063     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  5064     GO TO 0005-READ--CARD.                                       ELCDTERX
  5065                                                                  ELCDTERX
  5066 0070-READ--OPCA.                                                 ELCDTERX
  5067                                                                  ELCDTERX
  5068     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  5069                                                                  ELCDTERX
  5070     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  5071             OR                                                   ELCDTERX
  5072         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  5073         GO TO 0005-READ--CARD.                                   ELCDTERX
  5074                                                                  ELCDTERX
  5075     ADD 1                       TO INDEXCA.                      ELCDTERX
  5076     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  5077                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  5078     GO TO 0070-READ--OPCA.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  96
* ECS050.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  5079                                                                  ELCDTERX
  5080 0072-READ--OPST.                                                 ELCDTERX
  5081                                                                  ELCDTERX
  5082     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  5083                                                                  ELCDTERX
  5084     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  5085             OR                                                   ELCDTERX
  5086         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  5087         GO TO 0005-READ--CARD.                                   ELCDTERX
  5088                                                                  ELCDTERX
  5089     ADD 1                       TO INDEXST.                      ELCDTERX
  5090     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  5091                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  5092     GO TO 0072-READ--OPST.                                       ELCDTERX
  5093                                                                  ELCDTERX
  5094 0074-READ--OPBS.                                                 ELCDTERX
  5095                                                                  ELCDTERX
  5096     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  5097                                                                  ELCDTERX
  5098     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  5099             OR                                                   ELCDTERX
  5100         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  5101         GO TO 0005-READ--CARD.                                   ELCDTERX
  5102                                                                  ELCDTERX
  5103     ADD 1                       TO INDEXBS.                      ELCDTERX
  5104     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  5105     GO TO 0074-READ--OPBS.                                       ELCDTERX
  5106                                                                  ELCDTERX
  5107 0079-READ--EXIT.                                                 ELCDTERX
  5108*    EXIT.                                                        ELCDTERX
  5109******************************************************************ELCDTERX
  5110
  5111     MOVE WS-TIME                TO ME-START-TIME.
  5112
  5113 0100-INITIALIZATION-ROUTINE.
  5114
  5115     OPEN INPUT  CERT-MASTER
  5116                 ERACCTT
  5117          I-O    ERMEBL
  5118          OUTPUT PRINTER.
  5119
  5120     IF DTE-CLIENT = 'DCC'
  5121        OPEN INPUT ERPDEF
  5122     END-IF
  5123
  5124     IF ERACCTT-FILE-STATUS  = '00' OR '97'
  5125         NEXT SENTENCE
  5126       ELSE
  5127         MOVE '11'                   TO W-ABEND-CODE-1
  5128         MOVE ERACCTT-FILE-STATUS    TO W-ABEND-CODE-2
  5129         MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
  5130         MOVE 'OPEN ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  5131         DISPLAY ' ERROR - ERACCTT - OPEN ' ERACCTT-FILE-STATUS
  5132         GO TO ABEND-PGM.
  5133
  5134     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  5135        CONTINUE
  5136     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  97
* ECS050.cbl
  5137        MOVE '61'                TO W-ABEND-CODE-1
  5138        MOVE ERPDEF-FILE-STATUS  TO W-ABEND-CODE-2
  5139        MOVE 'OPEN ERROR - ERPDEF ' TO WS-ABEND-MESSAGE
  5140        DISPLAY ' ERROR - ERPDEF  - OPEN ' ERPDEF-FILE-STATUS
  5141        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  5142        GO TO ABEND-PGM
  5143     END-IF
  5144
  5145     IF ERMEBL-FILE-STATUS  = '00' OR '97'
  5146         NEXT SENTENCE
  5147       ELSE
  5148         MOVE 'N' TO ME-UPDATE-FLAG.
  5149
  5150     IF DTE-PGM-OPT = '1' OR '3'
  5151         OPEN OUTPUT ALPHA-EXTRACT.
  5152
  5153     IF DTE-PGM-OPT = '2' OR '3'
  5154         OPEN OUTPUT GAAP-EXTRACT.
  5155
  5156     MOVE 'R'                    TO CP-RATE-FILE.
  5157     MOVE 'O'                    TO CP-IO-FUNCTION.
  5158     PERFORM 3090-CALL-RATING-ROUTINE THRU 3099-EXIT.
  5159     IF IO-ERROR
  5160         MOVE 0302               TO WS-RETURN-CODE
  5161         MOVE 'ERROR OCCURED OPENING - ELRATE'
  5162                                 TO WS-ABEND-MESSAGE
  5163         GO TO ABEND-PGM.
  5164
  5165     MOVE WS-CURRENT-DATE        TO H2-DATE
  5166                                    ME-START-DATE.
  5167     MOVE ME-START-MO            TO ME-CNDS-MO.
  5168     MOVE ME-START-DA            TO ME-CNDS-DA.
  5169     MOVE ME-START-YR            TO ME-CNDS-YR.
  5170     MOVE COMPANY-NAME           TO H2-COMP.
  5171     MOVE ALPH-DATE              TO H3-DATE.
  5172     MOVE LIFE-OVERRIDE-L6       TO HD4A-DESC-1.
  5173     MOVE AH-OVERRIDE-L6         TO HD4A-DESC-2.
  5174
  5175     COMPUTE CUR-CALC = (RUN-CCYY * +12) + RUN-MO.
  5176     MOVE CUR-CALC               TO MONTH-END-MOYR.
  5177
  5178     MOVE HIGH-VALUES            TO REIN-HOLD-AREAS.
  5179     MOVE SPACES                 TO REIN-ONLY-HOLDERS
  5180                                    REIN-LEVELS-END.
  5181
  5182     MOVE RUN-DATE               TO VALUATION-DATE.
  5183     MOVE BIN-RUN-DATE           TO WS-BIN-VAL-DT.
  5184
  5185     IF DTE-CLIENT NOT EQUAL 'NCL'
  5186        GO TO 0109-CONTINUE-INIT.
  5187
  5188     MOVE RUN-DATE               TO WS-NCL-OB-DATES(1)
  5189
  5190     MOVE +0                     TO DC-ELAPSED-MONTHS
  5191                                    DC-ELAPSED-DAYS.
  5192     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1.
  5193     MOVE +0                     TO DC-ELAPSED-DAYS.
  5194     MOVE -1                     TO DC-ELAPSED-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  98
* ECS050.cbl
  5195     MOVE '6'                    TO DC-OPTION-CODE.
  5196     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT.
  5197     MOVE DC-GREG-DATE-CYMD      TO WS-NCL-OB-DATES (2).
  5198     MOVE +0                     TO DC-ELAPSED-DAYS.
  5199     MOVE -2                     TO DC-ELAPSED-MONTHS.
  5200     MOVE '6'                    TO DC-OPTION-CODE.
  5201     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT.
  5202     MOVE DC-GREG-DATE-CYMD      TO WS-NCL-OB-DATES (3).
  5203     MOVE +0                     TO DC-ELAPSED-MONTHS
  5204                                    DC-ELAPSED-DAYS.
  5205
  5206     DISPLAY '     '.
  5207     DISPLAY ' CURRENT MONTH DATE ' WS-NCL-OB-DATES (1).
  5208     DISPLAY ' CURRENT DATE - 1   ' WS-NCL-OB-DATES (2).
  5209     DISPLAY ' CURRENT DATE - 2   ' WS-NCL-OB-DATES (3).
  5210     DISPLAY '     '.
  5211
  5212     PERFORM 0102-CLEAR-OB THRU 0102-OB-EXIT
  5213         VARYING SUB FROM +1 BY +1 UNTIL SUB GREATER THAN +20.
  5214
  5215     MOVE +1                     TO SUB.
  5216
  5217     PERFORM 0106-LOAD-LIFE THRU 0106-EXIT
  5218         VARYING CLAS-INDEXL FROM CLAS-STARTL BY +1
  5219           UNTIL CLAS-INDEXL GREATER THAN CLAS-MAXL.
  5220
  5221     MOVE +1                     TO SUB.
  5222
  5223     PERFORM 0107-LOAD-AH THRU 0107-EXIT
  5224         VARYING CLAS-INDEXA FROM CLAS-STARTA BY +1
  5225           UNTIL CLAS-INDEXA GREATER THAN CLAS-MAXA.
  5226
  5227     GO TO 0109-CONTINUE-INIT.
  5228
  5229 0102-CLEAR-OB.
  5230
  5231      MOVE ZEROS                 TO WS-LIFE-OB-CODE (1 SUB)
  5232                                    WS-LIFE-OB-CODE (2 SUB)
  5233                                    WS-LIFE-OB-CODE (3 SUB)
  5234                                    WS-AH-OB-CODE (1 SUB)
  5235                                    WS-AH-OB-CODE (2 SUB)
  5236                                    WS-AH-OB-CODE (3 SUB).
  5237      MOVE +0                    TO WS-LIFE-PREM (1 SUB)
  5238                                    WS-LIFE-PREM (2 SUB)
  5239                                    WS-LIFE-PREM (3 SUB)
  5240                                    WS-AH-PREM (1 SUB)
  5241                                    WS-AH-PREM (2 SUB)
  5242                                    WS-AH-PREM (3 SUB)
  5243                                    WS-LIFE-BEN (1 SUB)
  5244                                    WS-LIFE-BEN (2 SUB)
  5245                                    WS-LIFE-BEN (3 SUB)
  5246                                    WS-AH-BEN (1 SUB)
  5247                                    WS-AH-BEN (2 SUB)
  5248                                    WS-AH-BEN (3 SUB).
  5249
  5250 0102-OB-EXIT.
  5251     EXIT.
  5252
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page  99
* ECS050.cbl
  5253 0103-CLEAR-OB.
  5254
  5255      MOVE +0                    TO WS-LIFE-PREM (1 SUB)
  5256                                    WS-LIFE-PREM (2 SUB)
  5257                                    WS-LIFE-PREM (3 SUB)
  5258                                    WS-AH-PREM (1 SUB)
  5259                                    WS-AH-PREM (2 SUB)
  5260                                    WS-AH-PREM (3 SUB)
  5261                                    WS-LIFE-BEN (1 SUB)
  5262                                    WS-LIFE-BEN (2 SUB)
  5263                                    WS-LIFE-BEN (3 SUB)
  5264                                    WS-AH-BEN (1 SUB)
  5265                                    WS-AH-BEN (2 SUB)
  5266                                    WS-AH-BEN (3 SUB).
  5267
  5268 0103-OB-EXIT.
  5269     EXIT.
  5270
  5271 0106-LOAD-LIFE.
  5272
  5273     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B'
  5274        MOVE CLAS-I-BEN (CLAS-INDEXL)
  5275                                 TO WS-LIFE-OB-CODE (1 SUB)
  5276                                    WS-LIFE-OB-CODE (2 SUB)
  5277                                    WS-LIFE-OB-CODE (3 SUB)
  5278        ADD +1 TO SUB.
  5279
  5280 0106-EXIT.
  5281     EXIT.
  5282
  5283 0107-LOAD-AH.
  5284
  5285     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B'
  5286        MOVE CLAS-I-BEN (CLAS-INDEXA)
  5287                                 TO WS-AH-OB-CODE (1 SUB)
  5288                                    WS-AH-OB-CODE (2 SUB)
  5289                                    WS-AH-OB-CODE (3 SUB)
  5290        ADD +1 TO SUB.
  5291
  5292 0107-EXIT.
  5293     EXIT.
  5294
  5295 0109-CONTINUE-INIT.
  5296
  5297
  5298     IF DTE-CLIENT = 'DCC'
  5299        MOVE 0 TO P1
  5300        MOVE DTE-CLASIC-COMPANY-CD
  5301                                 TO PD-CONTROL-PRIMARY
  5302        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  5303        IF ERPDEF-FILE-STATUS = '00'
  5304           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  5305              READ ERPDEF NEXT RECORD
  5306              IF ERPDEF-FILE-STATUS = '00'
  5307                 ADD 1 TO P1
  5308                 IF P1 > max-pdef
  5309                    DISPLAY ' DDF UEP TABLE BLEW '
  5310                    GO TO ABEND-PGM
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 100
* ECS050.cbl
  5311                 END-IF
  5312                 MOVE PD-STATE   TO DD-STATE (P1)
  5313                 MOVE PD-PRODUCT-CD
  5314                                 TO DD-PRODUCT-CD (P1)
  5315                 MOVE PD-BEN-TYPE
  5316                                 TO DD-BEN-TYPE (P1)
  5317                 MOVE PD-BEN-CODE
  5318                                 TO DD-BEN-CODE (P1)
  5319                 MOVE PD-PROD-EXP-DT
  5320                                 TO DD-PROD-EXP-DT (P1)
  5321                 MOVE PD-1ST-YR-ADMIN-ALLOW
  5322                                 TO DD-1ST-YR-ALLOW (P1)
  5323                 MOVE PD-TRUNCATED TO DD-TRUNCATED (P1)
  5324                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  5325                    P2 > +8
  5326                    MOVE PD-PROD-CODE (P2)
  5327                                 TO DD-PROD-CODE (P1 P2)
  5328                    MOVE PD-MAX-AMT (P2)
  5329                                 TO DD-MAX-BEN-AMT (P1 P2)
  5330                 END-PERFORM
  5331                 MOVE PD-EARN-FACTORS
  5332                                 TO DD-EARN-FACTORS (P1)
  5333              ELSE
  5334                 IF ERPDEF-FILE-STATUS NOT = '10'
  5335                    DISPLAY ' BAD RD NXT ' ERPDEF-FILE-STATUS
  5336                 END-IF
  5337              END-IF
  5338           END-PERFORM
  5339        ELSE
  5340           DISPLAY ' BAD START ERPDEF ' ERPDEF-FILE-STATUS
  5341        END-IF
  5342        CLOSE ERPDEF
  5343     END-IF
  5344
  5345     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  5346     MOVE TOT-ACCUMS             TO ZERO-ACCUMS.
  5347
  5348     MOVE SPACES                 TO ALPHA-RECORD.
  5349     MOVE 'AX'                   TO AX-RECORD-ID.
  5350     MOVE ZEROS                  TO AX-AGE   AX-APR  AX-PMT-FREQ
  5351                                    AX-LF-TYP        AX-AH-TYP
  5352                                    AX-LF-TERM       AX-AH-TERM
  5353                                    AX-LF-REMTERM    AX-AH-REMTERM
  5354                                    AX-LF-AMT        AX-AH-AMT
  5355                                    AX-LF-REMAMT     AX-AH-REMAMT
  5356                                    AX-LF-PRM        AX-AH-PRM
  5357                                    AX-LF-REFUND     AX-AH-REFUND
  5358                                    AX-LF-CLAIM-PMTS AX-DT
  5359                                    AX-AH-CLAIM-PMTS AX-LF-CNCL
  5360                                    AX-CAN-MICROFILM-NO AX-DEATH
  5361                                    AX-ISS-MICROFILM-NO AX-LF-EXIT
  5362                                    AX-LF-AMT-ALT    AX-LF-EXPIRES
  5363                                    AX-LF-REMAMT-ALT AX-AH-CNCL
  5364                                    AX-LF-PRM-ALT    AX-LUMP-SUM
  5365                                    AX-AH-EXIT       AX-AH-EXPIRES
  5366                                    AX-ENTRY.
  5367
  5368     MOVE ALPHA-RECORD           TO INITIALIZED-ALPHA-RECORD.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 101
* ECS050.cbl
  5369
  5370     MOVE SPACES            TO GAAP-RECORD.
  5371     MOVE 'GR'              TO GR-RECORD-ID.
  5372     MOVE ZEROS             TO GR-LFTYP          GR-AHTYP
  5373                               GR-APR            GR-PMT-FREQ
  5374                               GR-LOAN-TERM      GR-AGE
  5375                               GR-ACC-EXPIRES
  5376                               GR-LF-TERM        GR-AH-TERM
  5377                               GR-LF-REMTERM     GR-AH-REMTERM
  5378                               GR-LF-UP-REMTERM  GR-AH-UP-REMTERM
  5379                               GR-LFBEN          GR-AHBEN
  5380                               GR-LFPRM          GR-AHPRM
  5381                               GR-LFCOM          GR-AHCOM
  5382                               GR-LFEXP          GR-AHEXP
  5383                               GR-LFTAX          GR-AHTAX
  5384                               GRP-LFPRM         GRP-AHPRM
  5385                               GRP-LFCOM         GRP-AHCOM
  5386                               GRP-LFEXP         GRP-AHEXP
  5387                               GRP-LFTAX         GRP-AHTAX
  5388                               GRR-LFPRM         GRR-AHPRM
  5389                               GRR-LFCOM         GRR-AHCOM
  5390                               GRR-LFEXP         GRR-AHEXP
  5391                               GRR-LFTAX         GRR-AHTAX
  5392                               GRD-LFPRM         GRD-AHPRM
  5393                               GRD-LFCOM         GRD-AHCOM
  5394                               GRS-LFPRM         GRS-AHPRM
  5395                               GRS-LFCOM         GRS-AHCOM
  5396                               GR-UNLD-STAT-MORT-RESV
  5397*                              GR-LFSRV          GR-AHSRV
  5398                               GR-MORT-AGE       GR-REM-AMT
  5399                               GR-MO-DEC         GR-MORT-FACT
  5400                               GR-RESV           GR-ALT-RESV
  5401                               GR-CNT            GR-CNT-LF
  5402                               GR-CNT-AH         GR-AH-REM-BEN
  5403                               GR-DIR-CERT-LFBEN GR-EFF
  5404                               GR-ENT-DT         GR-LF-EXPIRE-DATE
  5405                               GR-AH-EXPIRE-DATE.
  5406
  5407     MOVE GAAP-RECORD       TO INITIALIZED-GAAP-RECORD.
  5408
  5409     PERFORM 0590-READ-AM-MSTR THRU 0598-EXIT.
  5410
  5411 0110-READ-CERT-MASTER.
  5412
  5413     READ CERT-MASTER
  5414              AT END  GO TO 9000-END-THE-JOB.
  5415
  5416     IF CR-LFTYP = SPACES
  5417        MOVE ZEROS TO CR-LFTYP
  5418     END-IF
  5419     IF CR-AHTYP = SPACES
  5420        MOVE ZEROS TO CR-AHTYP
  5421     END-IF
  5422     IF DTE-CLIENT EQUAL 'HAN'
  5423        IF (CR-GROUPING EQUAL '097713' OR '010184')
  5424                           OR
  5425           ((CR-CARRIER EQUAL '2') AND
  5426            (CR-DT GREATER THAN  19930630 ))
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 102
* ECS050.cbl
  5427           GO TO 0110-READ-CERT-MASTER.
  5428
  5429     IF DTE-CLIENT = 'NCL'
  5430        IF CR-ACCT-CONTROL NOT = WS-HOLD-AM-CONTROL  AND
  5431           WS-HOLD-AM-CONTROL NOT = LOW-VALUES
  5432            MOVE CERTIFICATE-RECORD  TO WS-HOLD-CERT
  5433            PERFORM 0395-CHECK-OUT-OB THRU 0395-EXIT
  5434            MOVE WS-HOLD-CERT        TO CERTIFICATE-RECORD
  5435            PERFORM 0103-CLEAR-OB THRU 0103-OB-EXIT
  5436            VARYING SUB FROM +1 BY +1 UNTIL SUB GREATER THAN +20.
  5437
  5438     if dte-client = 'AHL'
  5439        if (cr-carrier = '8')
  5440           or (cr-account = '00DMREOH02'
  5441                         or '00CSRG5104'
  5442                         or '00CSRG5107'
  5443                         or '00CSRG5108'
  5444                         or '00FSS07116'
  5445                         or '00CRS07121'
  5446                         or '00CWA07101'
  5447                         or '00AR537422'
  5448                         or '00AR537430'
  5449                         or '00AR537432'
  5450                         or '00AR537434'
  5451                         or '00AR537435'
  5452                         or '00AR537437')
  5453           continue
  5454        else
  5455           perform varying c1 from +2 by +1 until
  5456              (c1 > +10)
  5457              or (cr-com-agt (c1) = zeros or spaces)
  5458              inspect cr-agt-type (c1) converting
  5459              'P' TO 'O'
  5460           end-perform
  5461        end-if
  5462     end-if
  5463
* 5464     COPY ELCCRTM1.
  5465******************************************************************04/15/98
  5466*                                                                *ELCCRTM1
  5467*                                                                *ELCCRTM1
  5468*                            ELCCRTM1                            *   LV003
  5469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5470*                            VMOD=2.001                          *ELCCRTM1
  5471*                                                                *ELCCRTM1
  5472*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  5473*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  5474*                                                                *ELCCRTM1
  5475******************************************************************ELCCRTM1
  5476     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  5477     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  5478     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  5479     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  5480     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  5481     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  5482     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  5483     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  5484     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 103
* ECS050.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  5485                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  5486     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  5487                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  5488     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  5489     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  5490     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  5491     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  5492     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  5493     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  5494           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  5495                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  5496     END-PERFORM.                                                 ELCCRTM1
  5497                                                                  ELCCRTM1
  5498
  5499     MOVE CR-ACCT-CONTROL     TO WS-HOLD-AM-CONTROL.
  5500
  5501     IF CR-CARRIER NOT = PRIOR-CARRIER
  5502         PERFORM 8000-CARRIER-BREAK-ROUTINE THRU 8999-EXIT.
  5503
  5504     IF DTE-CLIENT EQUAL 'FIM'
  5505        IF CR-REIN-TABLE EQUAL '38K'
  5506           MOVE SPACES TO CR-REIN-TABLE.
  5507
  5508     MOVE SPACES                 TO O-B-SWITCH
  5509                                    SUMMARY-SWITCH
  5510                                    GR-REIN.
  5511
  5512     ADD +1                      TO TOT-READ.
  5513
  5514     IF CR-ENTRY-STATUS = '5' OR 'M'
  5515         ADD +1                  TO TOT-REIS.
  5516
  5517     IF CR-ENTRY-STATUS = 'D'
  5518         ADD +1                  TO TOT-DECLINED.
  5519
  5520     IF CR-ENTRY-STATUS = 'V'
  5521         ADD +1                  TO TOT-VOIDED.
  5522
  5523     IF CR-ENTRY-STATUS = '9'
  5524         ADD +1                  TO TOT-REIO.
  5525
  5526     PERFORM 7000-REIN-ONLY-STATUS THRU 7599-EXIT.
  5527
  5528
  5529     PERFORM 0500-MATCH-TO-ACC     THRU 0599-EXIT.
  5530
  5531
  5532     MOVE CLAS-STARTL TO CLAS-INDEXL.
  5533     MOVE CLAS-STARTA TO CLAS-INDEXA.
  5534     MOVE CLAS-STARTS TO CLAS-INDEXS.
  5535
  5536     MOVE SPACES TO LF-JOINT-SWITCH, AH-JOINT-SWITCH.
  5537
  5538 0120-STATE-LOOKUP.
  5539     IF CR-STATE NOT = STATE-SUB (CLAS-INDEXS)
  5540         IF CLAS-INDEXS NOT = CLAS-MAXS
  5541             ADD +1 TO CLAS-INDEXS
  5542             GO TO 0120-STATE-LOOKUP.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 104
* ECS050.cbl
  5543
  5544     IF CR-LFTYP = ZERO
  5545         MOVE ZERO TO CLAS-INDEXL
  5546         GO TO 0140-FIND-AH.
  5547
  5548 0130-FIND-LIFE-LOOP.
  5549     IF CLAS-INDEXL GREATER CLAS-MAXL OR CLAS-STARTL = ZERO
  5550         DISPLAY 'LIFE BENEFIT ' CR-LFTYP ' NOT IN TABLE'
  5551         DISPLAY 'RETURN CODE - 0401'
  5552         MOVE 0401 TO WS-RETURN-CODE
  5553         GO TO 0130-LIFE-LOOP-EXIT.
  5554***      GO TO ABEND-PGM.
  5555
  5556     IF CR-LFTYP NOT = CLAS-I-BEN (CLAS-INDEXL)
  5557         ADD +1 TO CLAS-INDEXL
  5558         GO TO 0130-FIND-LIFE-LOOP.
  5559
  5560     MOVE CLAS-I-JOINT (CLAS-INDEXL) TO LF-JOINT-SWITCH.
  5561
  5562 0130-LIFE-LOOP-EXIT.
  5563     EXIT.
  5564
  5565 0140-FIND-AH.
  5566     IF CR-AHTYP = ZERO
  5567         MOVE ZERO TO CLAS-INDEXA
  5568         GO TO 0160-CALC-REM-TERM.
  5569
  5570 0150-FIND-AH-LOOP.
  5571     IF CLAS-INDEXA GREATER CLAS-MAXA OR CLAS-STARTA = ZEROS
  5572         DISPLAY 'A&H BENEFIT ' CR-AHTYP ' NOT IN TABLE'
  5573         MOVE 0402 TO WS-RETURN-CODE
  5574         GO TO ABEND-PGM.
  5575
  5576     IF CR-AHTYP NOT = CLAS-I-BEN (CLAS-INDEXA)
  5577         ADD +1 TO CLAS-INDEXA
  5578         GO TO 0150-FIND-AH-LOOP.
  5579
  5580     MOVE CLAS-I-JOINT (CLAS-INDEXA) TO AH-JOINT-SWITCH.
  5581
  5582     IF AH-EARN-METHOD = SPACE
  5583         MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
  5584
  5585 0160-CALC-REM-TERM.
  5586
  5587     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5588     MOVE 'L'                        TO DC-OPTION-CODE.
  5589     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  5590     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT
  5591                                        WS-BIN-CR-DT.
  5592
  5593     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5594         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5595
  5596     MOVE LOW-VALUES             TO     CP-FIRST-PAY-DATE.
  5597
  5598     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5599         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5600         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 105
* ECS050.cbl
  5601                                        DC-ELAPSED-DAYS
  5602         MOVE '3'                    TO DC-OPTION-CODE
  5603         PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  5604         IF NO-CONVERSION-ERROR
  5605             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  5606         ELSE
  5607             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5608
  5609     IF CP-FIRST-PAY-DATE  LESS THAN  CP-CERT-EFF-DT
  5610         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5611
  5612     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5613         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5614         MOVE +1                     TO DC-ELAPSED-MONTHS
  5615         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5616         MOVE '6'                    TO DC-OPTION-CODE
  5617         PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  5618         MOVE DC-BIN-DATE-2          TO CP-FIRST-PAY-DATE
  5619         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5620
  5621     IF GR-REIN NOT = 'R'
  5622         MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  5623     ELSE
  5624         MOVE ERN-START-DATE         TO DC-GREG-DATE-CYMD
  5625         MOVE 'L'                    TO DC-OPTION-CODE
  5626         PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  5627         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT.
  5628
  5629     MOVE WS-BIN-CR-DT           TO DC-BIN-DATE-1
  5630     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5631     MOVE '1'                    TO DC-OPTION-CODE
  5632     MOVE ' '                    TO DC-CENTURY-ADJUSTMENT
  5633     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5634                                    DC-ODD-DAYS-OVER
  5635                                    DC-ELAPSED-DAYS
  5636                                    MONTHS-DIFF
  5637     PERFORM 0400-DATE-CONVERSION-ROUTINE
  5638                                 THRU 0409-EXIT
  5639
  5640     IF NO-CONVERSION-ERROR
  5641        MOVE DC-ELAPSED-MONTHS   TO MONTHS-DIFF
  5642        IF DC-ODD-DAYS-OVER > ZERO
  5643           ADD +1                TO MONTHS-DIFF
  5644        END-IF
  5645     END-IF
  5646
  5647     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  5648     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  5649     MOVE '3'                        TO CP-PROCESS-TYPE.
  5650     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5651     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5652     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5653     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5654
  5655     IF DTE-CLIENT = 'FIM'
  5656         MOVE '5'                    TO CP-REM-TERM-METHOD.
  5657
  5658     IF DTE-CLIENT = 'CSL'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 106
* ECS050.cbl
  5659         IF CR-CARRIER = '2'
  5660             IF CR-LFTYP = '07'  OR  '08'
  5661                 MOVE '4'            TO CP-REM-TERM-METHOD.
  5662
  5663     IF DTE-CLIENT = 'POS'
  5664         IF CR-CARRIER = '1'
  5665             MOVE '1'                TO CP-REM-TERM-METHOD
  5666         ELSE
  5667             MOVE '2'                TO CP-REM-TERM-METHOD.
  5668
  5669
  5670     IF CR-POLICY-IS-VOID OR CR-POLICY-IS-DECLINED
  5671         MOVE ZEROS                  TO LF-REM-TRM1
  5672                                        LF-REM-TRM2
  5673                                        AH-REM-TRM1
  5674                                        AH-REM-TRM2
  5675         GO TO 0179-CALC-REM-TERM-EXIT.
  5676
  5677     IF CR-LFTYP = ZEROS
  5678         MOVE ZEROS                  TO LF-REM-TRM1
  5679                                        LF-REM-TRM2
  5680         GO TO 0170-CALC-REM-TERM-AH.
  5681
  5682     IF (CR-ENTRY-STATUS NOT = ('9' AND '5' AND 'M') AND
  5683        CR-IND-GRP = '1' AND
  5684        CR-ENTRY-CCYY = RUN-CCYY AND
  5685        GR-REIN NOT = 'R')
  5686         IF CR-LF-TERM LESS THAN +60
  5687             COMPUTE TOT-LF-UNDER60 = TOT-LF-UNDER60 +
  5688                                      CR-LFPRM + CR-LFPRM-ALT
  5689         ELSE
  5690             COMPUTE TOT-LF-OVER59 = TOT-LF-OVER59 +
  5691                                      CR-LFPRM + CR-LFPRM-ALT.
  5692
  5693     IF (CR-ENTRY-STATUS NOT = '9' AND
  5694        CR-IND-GRP = '1' AND
  5695        CR-LF-CEX-CCYY = RUN-CCYY AND
  5696        GR-REIN NOT = 'R')
  5697         IF CR-LF-TERM LESS THAN +60
  5698             SUBTRACT CR-LFRFND FROM TOT-LF-UNDER60
  5699         ELSE
  5700             SUBTRACT CR-LFRFND FROM TOT-LF-OVER59.
  5701
  5702     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5703     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  5704     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  5705                                        CP-LOAN-TERM.
  5706
  5707     IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  5708        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  5709         ADD +1                      TO CP-ORIGINAL-TERM
  5710                                        CP-LOAN-TERM.
  5711
  5712*    IF CP-TRUNCATED-LIFE
  5713*        MOVE CR-LOAN-TERM           TO CP-ORIGINAL-TERM.
  5714     IF CP-TERM-IS-DAYS
  5715         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5716     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 107
* ECS050.cbl
  5717         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5718
  5719     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5720
  5721     PERFORM 0410-GET-REMAINING-TERM THRU 0419-REM-TERM-EXIT.
  5722
  5723     IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  5724            CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  5725         MOVE CP-REMAINING-TERM-2        TO LF-BAL-REMTERM
  5726         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5727         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5728
  5729     IF CP-REMAINING-TERM-1 NEGATIVE
  5730         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
  5731
  5732     IF CP-REMAINING-TERM-2 NEGATIVE
  5733         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
  5734
  5735     MOVE CP-REMAINING-TERM-1        TO LF-REM-TRM1.
  5736     MOVE CP-REMAINING-TERM-2        TO LF-REM-TRM2.
  5737
  5738 0170-CALC-REM-TERM-AH.
  5739
  5740     IF CR-AHTYP = ZEROS
  5741         MOVE ZEROS                  TO AH-REM-TRM1
  5742                                        AH-REM-TRM2
  5743         GO TO 0179-CALC-REM-TERM-EXIT.
  5744
  5745     IF (CR-ENTRY-STATUS NOT = ('9' AND '5' AND 'M') AND
  5746        CR-IND-GRP = '1' AND
  5747        CR-ENTRY-CCYY = RUN-CCYY AND
  5748        GR-REIN NOT = 'R')
  5749         IF CR-AH-TERM LESS THAN +60
  5750             ADD CR-AHPRM            TO TOT-AH-UNDER60
  5751         ELSE
  5752             ADD CR-AHPRM            TO TOT-AH-OVER59.
  5753
  5754     IF (CR-ENTRY-STATUS NOT = '9' AND
  5755        CR-IND-GRP = '1' AND
  5756        CR-AH-CEX-CCYY = RUN-CCYY AND
  5757        GR-REIN NOT = 'R')
  5758         IF CR-AH-TERM LESS THAN +60
  5759             SUBTRACT CR-AHRFND FROM TOT-AH-UNDER60
  5760         ELSE
  5761             SUBTRACT CR-AHRFND FROM TOT-AH-OVER59.
  5762
  5763     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  5764     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  5765     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
  5766                                        CP-LOAN-TERM.
  5767     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
  5768
  5769     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5770
  5771     PERFORM 0410-GET-REMAINING-TERM THRU 0419-REM-TERM-EXIT.
  5772
  5773     MOVE CP-REMAINING-TERM-1        TO AH-REM-TRM1.
  5774     MOVE CP-REMAINING-TERM-2        TO AH-REM-TRM2.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 108
* ECS050.cbl
  5775
  5776 0179-CALC-REM-TERM-EXIT.
  5777     EXIT.
  5778
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 109
* ECS050.cbl
  5780 0200-SET-UP-ALPHA-GAAP.
  5781
  5782     MOVE INITIALIZED-ALPHA-RECORD   TO ALPHA-RECORD.
  5783     PERFORM LOAD-ALPHA-WS-DATES.
  5784
  5785     MOVE INITIALIZED-GAAP-RECORD    TO GAAP-RECORD.
  5786     PERFORM LOAD-GAAP-WS-DATES.
  5787
  5788     MOVE DTE-CLASIC-COMPANY-CD      TO AX-COMPANY-CD
  5789                                        GR-COMPANY-CD.
  5790     MOVE CR-FULL-CONTROL            TO AX-CONTROL
  5791                                        GR-CONTROL.
  5792
  5793     MOVE CR-DT                      TO GR-EFF
  5794                                        WS-GR-EFF-N
  5795                                        AX-DT
  5796                                        WS-AX-DT-N.
  5797
  5798     MOVE CR-APR                     TO AX-APR
  5799                                        GR-APR.
  5800     MOVE CR-IND-GRP                 TO AX-IND-GRP
  5801                                        GR-IG
  5802     MOVE CR-GRPTYP                  TO GR-GRPTYP
  5803     MOVE CR-PMT-FREQ                TO AX-PMT-FREQ
  5804                                        GR-PMT-FREQ.
  5805
  5806     MOVE CR-ENTRY-STATUS            TO AX-ENTRY-STATUS
  5807                                        GR-CERT-STATUS.
  5808     MOVE CR-ENTRY-DATE              TO AX-ENTRY
  5809                                        WS-AX-ENTRY-N
  5810                                        GR-ENT-DT
  5811                                        WS-GR-ENT-DT-N.
  5812
  5813     MOVE CR-NAME                    TO AX-NAME.
  5814     MOVE CR-AGE                     TO AX-AGE.
  5815     MOVE CR-SEX                     TO AX-SEX
  5816                                        GR-SEX-CODE.
  5817
  5818     MOVE CR-REIN-SPEC               TO AX-SPEC-REIN.
  5819     MOVE CR-REIN-TABLE              TO AX-REIN-TABLE.
  5820
  5821     IF DTE-CLIENT = 'NCL'
  5822         MOVE AM-CSR-CODE            TO AX-MEM-NO
  5823     ELSE
  5824         MOVE CR-MEMBER-NO           TO AX-MEM-NO.
  5825
  5826     MOVE CR-SOC-SEC                 TO AX-SOC-NO.
  5827*    MOVE CR-CAN-MICROFILM-NO        TO AX-CAN-MICROFILM-NO
  5828*    MOVE CR-ISS-MICROFILM-NO        TO AX-ISS-MICROFILM-NO
  5829
  5830     MOVE 'P'                        TO GR-REIN.
  5831
  5832     if dte-client = 'AHL'
  5833        if cr-loan-term = zeros
  5834           move cr-lf-term           to cr-loan-term
  5835        end-if
  5836     end-if
  5837
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 110
* ECS050.cbl
  5838     IF CR-LOAN-TERM NUMERIC
  5839         MOVE CR-LOAN-TERM           TO GR-LOAN-TERM
  5840     ELSE
  5841         MOVE ZEROS                  TO GR-LOAN-TERM.
  5842     MOVE CR-AGE                     TO GR-AGE
  5843                                        GR-MORT-AGE.
  5844     MOVE CR-CLP-STATE               TO GR-DCC-CLP-STATE
  5845     MOVE AM-EXPIRE-DT               TO GR-ACC-EXPIRES.
  5846
  5847     MOVE AM-REPORT-CODE-2           TO GR-REGION.
  5848     MOVE AM-POOL-PRIME              TO GR-POOL-PRIME.
  5849
  5850     MOVE CR-UNDERWRITING-CODE       TO GR-UNDERWRITING-CODE.
  5851
  5852     IF CR-LFTYP = ZERO
  5853          GO TO 0220-ALPHA-GAAP-A-H-DATA.
  5854
  5855     IF DTE-CLIENT = 'DAC'
  5856         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'  AND
  5857            CR-AGE LESS THAN CR-JOINT-AGE
  5858             IF CR-SEX = 'M'
  5859                 COMPUTE GR-AGE = CR-JOINT-AGE - +6
  5860                 MOVE GR-AGE         TO GR-MORT-AGE
  5861             ELSE
  5862                 COMPUTE GR-AGE = CR-JOINT-AGE + +6
  5863                 MOVE GR-AGE         TO GR-MORT-AGE.
  5864
  5865 0208-CSL-JOINT-EQUAL-AGE.
  5866
  5867     IF DTE-CLIENT = 'CSL'  AND
  5868        CLAS-I-JOINT (CLAS-INDEXL) = 'J'  AND
  5869        CR-JOINT-AGE NOT = ZEROS
  5870         NEXT SENTENCE
  5871     ELSE
  5872         GO TO 0210-ALPHA-GAAP-LIFE-DATA.
  5873
  5874     IF CR-AGE NOT LESS THAN CR-JOINT-AGE
  5875         COMPUTE AGE-DIFFERENCE = CR-AGE - CR-JOINT-AGE
  5876     ELSE
  5877         COMPUTE AGE-DIFFERENCE = CR-JOINT-AGE - CR-AGE.
  5878
  5879     IF AGE-DIFFERENCE LESS THAN 2    MOVE 0 TO AGE-DIFFERENCE
  5880     ELSE
  5881     IF AGE-DIFFERENCE LESS THAN 4    MOVE 1 TO AGE-DIFFERENCE
  5882     ELSE
  5883     IF AGE-DIFFERENCE LESS THAN 6    MOVE 2 TO AGE-DIFFERENCE
  5884     ELSE
  5885     IF AGE-DIFFERENCE LESS THAN 9    MOVE 3 TO AGE-DIFFERENCE
  5886     ELSE
  5887     IF AGE-DIFFERENCE LESS THAN 12   MOVE 4 TO AGE-DIFFERENCE
  5888     ELSE
  5889     IF AGE-DIFFERENCE LESS THAN 17   MOVE 5 TO AGE-DIFFERENCE
  5890     ELSE
  5891     IF AGE-DIFFERENCE LESS THAN 23   MOVE 6 TO AGE-DIFFERENCE
  5892     ELSE
  5893         MOVE 7 TO AGE-DIFFERENCE.
  5894
  5895     IF CR-AGE NOT LESS THAN CR-JOINT-AGE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 111
* ECS050.cbl
  5896         COMPUTE GR-AGE = CR-AGE - AGE-DIFFERENCE
  5897     ELSE
  5898         COMPUTE GR-AGE = CR-JOINT-AGE - AGE-DIFFERENCE.
  5899
  5900     MOVE GR-AGE                     TO GR-MORT-AGE.
  5901
  5902 0210-ALPHA-GAAP-LIFE-DATA.
  5903
  5904     IF (CLAS-I-JOINT (CLAS-INDEXL) = 'J')
  5905        AND (CR-JOINT-AGE NUMERIC)
  5906        AND (CR-JOINT-AGE NOT = ZEROS)
  5907        AND (CR-JOINT-AGE > CR-AGE)
  5908        AND (CR-MORT = 'L010' OR 'D010')
  5909        ADD +1                   TO WS-AGE-ADJUST
  5910        MOVE CR-JOINT-AGE        TO GR-MORT-AGE
  5911                                    GR-AGE
  5912     END-IF
  5913
  5914     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  5915         MOVE '*'                    TO O-B-SWITCH.
  5916     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  5917         MOVE 'Z'                    TO GR-SUMMARY-FLAG
  5918         ADD CR-SUM-CAN-CNT-ITD      TO TOT-CANC-LF
  5919         ADD CR-LFPRM                TO TOT-CANC-LF-AMT
  5920         ADD CR-LFPRM-ALT            TO TOT-CANC-LF-AMT
  5921         MOVE '*'                    TO SUMMARY-SWITCH.
  5922
  5923     IF CR-ENTRY-STATUS NOT = ('9' AND '5' AND 'D' AND 'V'
  5924        AND 'M')
  5925        COMPUTE TOT-LF-AMT  = TOT-LF-AMT  +
  5926                                      CR-LFPRM + CR-LFPRM-ALT
  5927        IF SUMMARY-CERTIFICATE
  5928           ADD CR-LIVES            TO TOT-LF
  5929        ELSE
  5930           ADD +1                  TO TOT-LF.
  5931
  5932     MOVE CR-LFTYP                   TO AX-LF-TYP
  5933                                        GR-LFTYP.
  5934     MOVE CR-LF-TERM                 TO AX-LF-TERM
  5935                                        GR-LF-TERM.
  5936     MOVE LF-REM-TRM1                TO GR-LF-UP-REMTERM.
  5937     MOVE LF-REM-TRM2                TO AX-LF-REMTERM
  5938                                        GR-LF-REMTERM.
  5939     MOVE CR-LFAMT                   TO AX-LF-AMT.
  5940     ADD CR-LFAMT                    TO GR-LFBEN.
  5941     MOVE CR-LFPRM                   TO AX-LF-PRM.
  5942     ADD CR-LFPRM                    TO GR-LFPRM.
  5943
  5944     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  5945         MOVE CR-LFAMT-ALT           TO AX-LF-AMT-ALT
  5946         ADD CR-LFAMT-ALT            TO GR-LFBEN
  5947         MOVE CR-LFPRM-ALT           TO AX-LF-PRM-ALT
  5948         ADD CR-LFPRM-ALT            TO GR-LFPRM.
  5949
  5950     MOVE GR-LFBEN                   TO GR-DIR-CERT-LFBEN.
  5951
  5952     MOVE CR-LFRFND                  TO AX-LF-REFUND.
  5953     MOVE CR-DTHAMT                  TO AX-LF-CLAIM-PMTS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 112
* ECS050.cbl
  5954
  5955     MOVE CR-LF-CURRENT-STATUS       TO AX-LF-STATUS.
  5956
  5957     MOVE CR-LF-EXPIRE-DATE          TO AX-LF-EXPIRES
  5958                                        WS-AX-LF-EXPIRES-N
  5959                                        GR-LF-EXPIRE-DATE
  5960                                        WS-GR-LF-EXPIRE-DATE-N.
  5961
  5962     IF CR-POLICY-IS-VOID OR CR-POLICY-IS-DECLINED
  5963         GO TO 0220-ALPHA-GAAP-A-H-DATA.
  5964
  5965     IF (AX-LF-STATUS = '7' AND
  5966         CR-ENTRY-STATUS NOT EQUAL '5' AND '9' AND 'M')
  5967         ADD +1                      TO TOT-DTH
  5968         ADD  CR-LFPRM               TO TOT-DTH-AMT
  5969         ADD  CR-LFPRM-ALT           TO TOT-DTH-AMT.
  5970
  5971     IF AX-LF-STATUS = '7'
  5972         MOVE CR-DTH-DT              TO AX-DEATH
  5973                                        WS-AX-DEATH-N
  5974         MOVE CR-LF-CLAIM-EXIT-DATE  TO AX-LF-EXIT
  5975                                        WS-AX-LF-EXIT-N
  5976           GO TO 0220-ALPHA-GAAP-A-H-DATA.
  5977
  5978     IF  CR-POLICY-IS-REISSUE OR CR-POLICY-IS-REIN-ONLY OR
  5979         SUMMARY-CERTIFICATE
  5980         OR CR-POLICY-IS-MONTHLY
  5981             NEXT SENTENCE
  5982     ELSE
  5983         IF (AX-LF-STATUS = '6'  OR  '8' )
  5984             ADD +1                  TO TOT-CANC-LF
  5985             ADD  CR-LFPRM           TO TOT-CANC-LF-AMT
  5986             ADD  CR-LFPRM-ALT       TO TOT-CANC-LF-AMT.
  5987
  5988     IF AX-LF-STATUS = '6'  OR  '8'
  5989         MOVE CR-LF-CANC-DT          TO AX-LF-CNCL
  5990                                        WS-AX-LF-CNCL-N
  5991         MOVE CR-LF-CANCEL-EXIT-DATE TO AX-LF-EXIT
  5992                                        WS-AX-LF-EXIT-N
  5993           GO TO 0220-ALPHA-GAAP-A-H-DATA.
  5994
  5995     IF CR-ENTRY-STATUS EQUAL '5' OR '9' OR 'M'
  5996         NEXT SENTENCE
  5997     ELSE
  5998     IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')  AND
  5999         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'  AND
  6000         LF-BAL-REMTERM NOT GREATER THAN ZERO)
  6001                       OR
  6002        ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')  AND
  6003         CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'  AND
  6004         AX-LF-REMTERM NOT GREATER THAN ZERO)
  6005                       OR
  6006        ((CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L') AND
  6007         AX-LF-REMTERM NOT GREATER ZERO)
  6008                       OR
  6009         (CR-LF-EXPIRE-DATE < RUN-DATE)
  6010         ADD +1                      TO TOT-EXP-LF
  6011         ADD CR-LFPRM                TO TOT-EXP-LF-AMT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 113
* ECS050.cbl
  6012         ADD CR-LFPRM-ALT            TO TOT-EXP-LF-AMT
  6013         IF O-B-CERTIFICATE
  6014            MOVE '*'                 TO O-B-LF-CNT-SW.
  6015
  6016     IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')   AND
  6017         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'  AND
  6018         LF-BAL-REMTERM NOT GREATER THAN ZERO)
  6019                       OR
  6020        ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')  AND
  6021         CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'  AND
  6022         AX-LF-REMTERM NOT GREATER THAN ZERO)
  6023                       OR
  6024        ((CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L') AND
  6025         AX-LF-REMTERM NOT GREATER ZERO AND
  6026         NOT O-B-CERTIFICATE)
  6027                       OR
  6028         (CR-LF-EXPIRE-DATE < RUN-DATE)
  6029         MOVE ZERO                   TO AX-LF-REMTERM
  6030         MOVE 'E'                    TO AX-LF-STATUS
  6031           GO TO 0220-ALPHA-GAAP-A-H-DATA.
  6032
  6033     IF (AX-LF-REMTERM GREATER AX-LF-TERM
  6034        AND CR-ENTRY-STATUS NOT EQUAL '5' AND '9' AND 'M')
  6035         ADD +1                      TO TOT-FUTR-LF
  6036         ADD CR-LFPRM                TO TOT-FUTR-LF-AMT
  6037         ADD CR-LFPRM-ALT            TO TOT-FUTR-LF-AMT.
  6038
  6039     IF AX-LF-REMTERM GREATER AX-LF-TERM
  6040         MOVE AX-LF-TERM             TO AX-LF-REMTERM
  6041                                        LF-REM-TRM1
  6042                                        LF-REM-TRM2
  6043         MOVE 'F'                    TO AX-LF-STATUS
  6044                                        GR-FLAG
  6045           GO TO 0220-ALPHA-GAAP-A-H-DATA.
  6046
  6047     IF (DTE-CLIENT EQUAL 'NCL') AND
  6048        (O-B-CERTIFICATE)
  6049        NEXT SENTENCE
  6050     ELSE
  6051        GO TO 0215-CONTINUE-ALPHA.
  6052
  6053     IF (CR-CCYY LESS THAN WS-OB-CCYY (3)) OR
  6054        (CR-CCYY EQUAL WS-OB-CCYY (3) AND
  6055        CR-MO LESS THAN WS-OB-MO (3))
  6056        GO TO 0215-CONTINUE-ALPHA.
  6057
  6058     PERFORM VARYING SUB FROM +1 BY +1
  6059       UNTIL CR-LFTYP EQUAL WS-LIFE-OB-CODE (1 SUB) OR
  6060       SUB GREATER THAN +20
  6061     END-PERFORM.
  6062
  6063     IF SUB GREATER THAN +20
  6064        GO TO 0215-CONTINUE-ALPHA.
  6065
  6066     IF (CR-CCYY EQUAL WS-OB-CCYY (1)) AND
  6067        (CR-MO EQUAL WS-OB-MO (1))
  6068        MOVE '*'          TO WS-OB-DATE-1-SWITCH
  6069        ADD CR-LFPRM TO WS-LIFE-PREM (1 SUB)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 114
* ECS050.cbl
  6070        ADD CR-LFPRM-ALT TO WS-LIFE-PREM (1 SUB)
  6071        ADD CR-LFAMT TO WS-LIFE-BEN (1 SUB)
  6072        ADD CR-LFAMT-ALT TO WS-LIFE-BEN (1 SUB)
  6073     ELSE
  6074     IF (CR-CCYY EQUAL WS-OB-CCYY (2)) AND
  6075        (CR-MO EQUAL WS-OB-MO (2))
  6076        MOVE '*'          TO WS-OB-DATE-2-SWITCH
  6077        ADD CR-LFPRM TO WS-LIFE-PREM (2 SUB)
  6078        ADD CR-LFPRM-ALT TO WS-LIFE-PREM (2 SUB)
  6079        ADD CR-LFAMT TO WS-LIFE-BEN (2 SUB)
  6080        ADD CR-LFAMT-ALT TO WS-LIFE-BEN (2 SUB)
  6081     ELSE
  6082     IF (CR-CCYY EQUAL WS-OB-CCYY (3)) AND
  6083        (CR-MO EQUAL WS-OB-MO (3))
  6084        MOVE '*'          TO WS-OB-DATE-3-SWITCH
  6085        ADD CR-LFPRM TO WS-LIFE-PREM (3 SUB)
  6086        ADD CR-LFPRM-ALT TO WS-LIFE-PREM (3 SUB)
  6087        ADD CR-LFAMT TO WS-LIFE-BEN (3 SUB)
  6088        ADD CR-LFAMT-ALT TO WS-LIFE-BEN (3 SUB).
  6089
  6090 0215-CONTINUE-ALPHA.
  6091
  6092     IF CR-ENTRY-STATUS = '5' OR '9' OR 'M'
  6093        NEXT SENTENCE
  6094     ELSE
  6095        IF O-B-CERTIFICATE
  6096            IF EXCLUDE-O-B-LF
  6097                MOVE SPACES      TO O-B-LF-CNT-SW
  6098            ELSE
  6099                ADD CR-LFPRM     TO TOT-ACT-LF-AMT-OB
  6100                ADD CR-LFPRM-ALT TO TOT-ACT-LF-AMT-OB
  6101                ADD +1           TO TOT-ACTIVE-LF-OB
  6102        ELSE
  6103            ADD CR-LFPRM         TO TOT-ACTIVE-LF-AMT
  6104            ADD CR-LFPRM-ALT     TO TOT-ACTIVE-LF-AMT
  6105            IF SUMMARY-CERTIFICATE
  6106                COMPUTE TOT-ACTIVE-LF = TOT-ACTIVE-LF +
  6107                                   CR-LIVES - CR-SUM-CAN-CNT-ITD
  6108            ELSE
  6109                ADD +1           TO TOT-ACTIVE-LF.
  6110
  6111     IF (CR-ENTRY-STATUS = '5' OR 'M') OR
  6112        (O-B-CERTIFICATE)
  6113         GO TO 0220-ALPHA-GAAP-A-H-DATA.
  6114
  6115     IF SUMMARY-CERTIFICATE
  6116         COMPUTE GR-CNT-LF = CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6117
  6118     IF NOT SUMMARY-CERTIFICATE
  6119         MOVE +1                         TO GR-CNT-LF.
  6120
  6121 0220-ALPHA-GAAP-A-H-DATA.
  6122
  6123     IF CR-AHTYP = ZERO
  6124         GO TO 0230-CHECK-INFORCE-STATUS.
  6125
  6126     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  6127         MOVE '*'                    TO O-B-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 115
* ECS050.cbl
  6128     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  6129         MOVE 'Z'                    TO GR-SUMMARY-FLAG
  6130         ADD CR-SUM-CAN-CNT-ITD      TO TOT-CANC-AH
  6131         ADD CR-AHPRM                TO TOT-CANC-AH-AMT
  6132         MOVE '*'                    TO SUMMARY-SWITCH.
  6133
  6134     IF CR-ENTRY-STATUS NOT = ('9' AND '5' AND 'D' AND 'V'
  6135        AND 'M')
  6136         ADD CR-AHPRM                TO TOT-AH-AMT
  6137         IF SUMMARY-CERTIFICATE
  6138           ADD CR-LIVES              TO TOT-AH
  6139         ELSE
  6140           ADD +1                    TO TOT-AH.
  6141
  6142     MOVE CR-AHTYP                   TO AX-AH-TYP
  6143                                        GR-AHTYP.
  6144     MOVE CR-AH-TERM                 TO AX-AH-TERM
  6145                                        GR-AH-TERM.
  6146     MOVE AH-REM-TRM1                TO GR-AH-UP-REMTERM.
  6147     MOVE AH-REM-TRM2                TO AX-AH-REMTERM
  6148                                        GR-AH-REMTERM.
  6149     MOVE CR-AHAMT                   TO AX-AH-AMT
  6150                                        GR-AHBEN.
  6151
  6152     MOVE CR-AHPRM                   TO AX-AH-PRM
  6153                                        GR-AHPRM.
  6154     MOVE CR-AHRFND                  TO AX-AH-REFUND.
  6155     MOVE CR-DISAMT                  TO AX-AH-CLAIM-PMTS.
  6156
  6157     MOVE CR-AH-CURRENT-STATUS       TO AX-AH-STATUS.
  6158
  6159     MOVE CR-AH-EXPIRE-DATE          TO AX-AH-EXPIRES
  6160                                        WS-AX-AH-EXPIRES-N
  6161                                        GR-AH-EXPIRE-DATE
  6162                                        WS-GR-AH-EXPIRE-DATE-N.
  6163
  6164     IF CR-DIS-PAY-DT NOT = ZEROS
  6165         MOVE CR-DIS-PAY-DT          TO AX-LUMP-SUM
  6166                                        WS-AX-LUMP-SUM-N
  6167         MOVE '6'                    TO AX-AH-PRE-PLST.
  6168
  6169     IF CR-POLICY-IS-VOID OR CR-POLICY-IS-DECLINED
  6170         GO TO 0230-CHECK-INFORCE-STATUS.
  6171
  6172     IF (AX-AH-STATUS = '6')
  6173         AND (CR-ENTRY-STATUS NOT = '5' AND '9' AND 'M')
  6174         ADD +1                          TO TOT-DIS
  6175         ADD CR-AHPRM                    TO TOT-DIS-AMT.
  6176
  6177     IF AX-AH-STATUS = '6'
  6178         MOVE CR-DIS-DT                  TO AX-LUMP-SUM
  6179                                            WS-AX-LUMP-SUM-N
  6180         MOVE CR-AH-SETTLEMENT-EXIT-DATE TO AX-AH-EXIT
  6181                                            WS-AX-AH-EXIT-N
  6182         GO TO 0230-CHECK-INFORCE-STATUS.
  6183
  6184     IF  CR-POLICY-IS-REISSUE OR CR-POLICY-IS-REIN-ONLY OR
  6185         SUMMARY-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 116
* ECS050.cbl
  6186         OR CR-POLICY-IS-MONTHLY
  6187             NEXT SENTENCE
  6188     ELSE
  6189         IF AX-AH-STATUS = '7' OR '8'
  6190             ADD +1                      TO TOT-CANC-AH
  6191             ADD CR-AHPRM                TO TOT-CANC-AH-AMT.
  6192
  6193     IF AX-AH-STATUS = '7'  OR  '8'
  6194         MOVE CR-AH-CANC-DT          TO AX-AH-CNCL
  6195                                        WS-AX-AH-CNCL-N
  6196         MOVE CR-AH-CANCEL-EXIT-DATE TO AX-AH-EXIT
  6197                                        WS-AX-AH-EXIT-N
  6198         GO TO 0230-CHECK-INFORCE-STATUS.
  6199
  6200     IF CR-ENTRY-STATUS NOT = '5' AND '9' AND 'M'
  6201        IF (AX-AH-REMTERM <= ZERO)
  6202           OR (CR-AH-EXPIRE-DATE < RUN-DATE)
  6203           ADD +1                TO TOT-EXP-AH
  6204           ADD CR-AHPRM          TO TOT-EXP-AH-AMT
  6205           IF O-B-CERTIFICATE
  6206              MOVE '*' TO O-B-AH-CNT-SW
  6207           END-IF
  6208        END-IF
  6209     END-IF
  6210
  6211     IF NOT O-B-CERTIFICATE
  6212        IF (AX-AH-REMTERM <= ZERO)
  6213           OR (CR-AH-EXPIRE-DATE < RUN-DATE)
  6214           MOVE ZERO             TO AX-AH-REMTERM
  6215           MOVE 'E'              TO AX-AH-STATUS
  6216           GO TO 0230-CHECK-INFORCE-STATUS
  6217        END-IF
  6218     END-IF
  6219
  6220     IF (AX-AH-REMTERM GREATER AX-AH-TERM)
  6221         AND (CR-ENTRY-STATUS NOT = '5' AND '9' AND 'M')
  6222         ADD +1                      TO TOT-FUTR-AH
  6223         ADD CR-AHPRM                TO TOT-FUTR-AH-AMT.
  6224
  6225     IF AX-AH-REMTERM GREATER AX-AH-TERM
  6226         MOVE AX-AH-TERM             TO AX-AH-REMTERM
  6227                                        AH-REM-TRM1
  6228                                        AH-REM-TRM2
  6229         MOVE 'F'                    TO AX-AH-STATUS
  6230                                        GR-FLAG
  6231         GO TO 0230-CHECK-INFORCE-STATUS.
  6232
  6233
  6234     IF (DTE-CLIENT EQUAL 'NCL') AND
  6235        (O-B-CERTIFICATE)
  6236        NEXT SENTENCE
  6237     ELSE
  6238        GO TO 0225-CONTINUE-ALPHA.
  6239
  6240     IF (CR-CCYY LESS THAN WS-OB-CCYY (3)) OR
  6241        (CR-CCYY EQUAL WS-OB-CCYY (3) AND
  6242        CR-MO LESS THAN WS-OB-MO (3))
  6243        GO TO 0225-CONTINUE-ALPHA.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 117
* ECS050.cbl
  6244
  6245     PERFORM VARYING SUB FROM +1 BY +1
  6246       UNTIL CR-AHTYP EQUAL WS-AH-OB-CODE (1 SUB) OR
  6247       SUB GREATER THAN +20
  6248     END-PERFORM.
  6249
  6250     IF SUB GREATER THAN +20
  6251        GO TO 0225-CONTINUE-ALPHA.
  6252
  6253     IF (CR-CCYY EQUAL WS-OB-CCYY (1)) AND
  6254        (CR-MO EQUAL WS-OB-MO (1))
  6255        MOVE '*'          TO WS-OB-DATE-1-SWITCH
  6256        ADD CR-AHPRM TO WS-AH-PREM (1 SUB)
  6257        ADD CR-AHAMT TO WS-AH-BEN (1 SUB)
  6258     ELSE
  6259     IF (CR-CCYY EQUAL WS-OB-CCYY (2)) AND
  6260        (CR-MO EQUAL WS-OB-MO (2))
  6261        MOVE '*'          TO WS-OB-DATE-2-SWITCH
  6262        ADD CR-AHPRM TO WS-AH-PREM (2 SUB)
  6263        ADD CR-AHAMT TO WS-AH-BEN (2 SUB)
  6264     ELSE
  6265     IF (CR-CCYY EQUAL WS-OB-CCYY (3)) AND
  6266        (CR-MO EQUAL WS-OB-MO (3))
  6267        MOVE '*'          TO WS-OB-DATE-3-SWITCH
  6268        ADD CR-AHPRM TO WS-AH-PREM (3 SUB)
  6269        ADD CR-AHAMT TO WS-AH-BEN (3 SUB).
  6270
  6271 0225-CONTINUE-ALPHA.
  6272
  6273     IF CR-ENTRY-STATUS EQUAL '5' OR '9' OR 'M'
  6274        NEXT SENTENCE
  6275     ELSE
  6276        IF O-B-CERTIFICATE
  6277            IF EXCLUDE-O-B-AH
  6278                MOVE SPACES      TO O-B-AH-CNT-SW
  6279            ELSE
  6280                ADD CR-AHPRM     TO TOT-ACT-AH-AMT-OB
  6281                ADD +1           TO TOT-ACTIVE-AH-OB
  6282        ELSE
  6283            ADD CR-AHPRM         TO TOT-ACTIVE-AH-AMT
  6284            IF SUMMARY-CERTIFICATE
  6285                COMPUTE TOT-ACTIVE-AH = TOT-ACTIVE-AH +
  6286                                   CR-LIVES - CR-SUM-CAN-CNT-ITD
  6287            ELSE
  6288                ADD +1           TO TOT-ACTIVE-AH.
  6289
  6290
  6291     IF (CR-ENTRY-STATUS = '5' OR 'M') OR
  6292        O-B-CERTIFICATE
  6293         GO TO 0230-CHECK-INFORCE-STATUS.
  6294
  6295     IF SUMMARY-CERTIFICATE
  6296         COMPUTE GR-CNT-AH = CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6297
  6298     IF NOT SUMMARY-CERTIFICATE
  6299         MOVE +1                     TO GR-CNT-AH.
  6300
  6301 0230-CHECK-INFORCE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 118
* ECS050.cbl
  6302
  6303     IF O-B-CERTIFICATE
  6304         ADD +1                      TO TOT-OB
  6305         MOVE ZERO                   TO AX-LF-REMTERM
  6306                                        AX-AH-REMTERM
  6307         MOVE 'OUTSTANDING BAL'      TO AX-NAME
  6308         PERFORM 0600-WRITE-ALPHA-EXTRACT THRU 0699-EXIT
  6309         GO TO 0110-READ-CERT-MASTER
  6310     ELSE
  6311         IF SUMMARY-CERTIFICATE
  6312             ADD +1                  TO TOT-SUM
  6313             MOVE 'SUMMARY CERT.'    TO AX-NAME
  6314         ELSE
  6315             ADD +1                  TO TOT-SNGLPRM.
  6316
  6317     IF (AX-ENTRY-STATUS = '5'  OR 'D' OR 'V' OR 'M') OR
  6318        ((AX-LF-STATUS = ' '  OR  'E'  OR  '6'  OR  '7'  OR  '8')
  6319                AND
  6320         (AX-AH-STATUS = ' '  OR  'E'  OR  '6'  OR  '7'  OR  '8'))
  6321         PERFORM 6000-PRINT-EXCLUSIONS THRU 6999-PRT-EXCLUSIONS-X
  6322         PERFORM 0600-WRITE-ALPHA-EXTRACT THRU 0699-EXIT
  6323         GO TO 0110-READ-CERT-MASTER.
  6324
  6325     IF AX-LF-STATUS = 'E' OR '6' OR '7' OR '8'
  6326         MOVE ZEROS                  TO  GR-LFTYP
  6327                                         GR-LFBEN
  6328                                         GR-LFPRM
  6329                                         GR-LF-TERM
  6330                                         GR-LF-REMTERM
  6331                                         GR-LF-UP-REMTERM.
  6332     IF AX-AH-STATUS = 'E' OR '6' OR '7' OR '8'
  6333         MOVE ZEROS                  TO  GR-AHTYP
  6334                                         GR-AHBEN
  6335                                         GR-AHPRM
  6336                                         GR-AH-TERM
  6337                                         GR-AH-REMTERM
  6338                                         GR-AH-UP-REMTERM.
  6339
  6340 0240-SUMMARY-ADJUSTMENTS.
  6341
  6342     IF SUMMARY-CERTIFICATE
  6343         COMPUTE GR-CNT = CR-LIVES - CR-SUM-CAN-CNT-ITD
  6344     ELSE
  6345         MOVE +1                     TO GR-CNT
  6346         GO TO 0260-CALCULATE-PREMIUM-RESERVE.
  6347
  6348     IF CR-LFTYP = ZERO
  6349         GO TO 0250-A-H-SUMMARY-ADJ.
  6350
  6351     MOVE +1                         TO WS-SUM-LF-FACTOR.
  6352
  6353     IF CR-LFPRM NOT GREATER CR-LFRFND
  6354         MOVE ZERO                   TO GR-LFBEN
  6355         MOVE ZERO                   TO GR-LFPRM
  6356         MOVE +0                     TO WS-SUM-LF-FACTOR
  6357     ELSE
  6358         IF CR-LFRFND = ZERO
  6359             MOVE CR-LFAMT           TO GR-LFBEN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 119
* ECS050.cbl
  6360             MOVE CR-LFPRM           TO GR-LFPRM
  6361         ELSE
  6362             COMPUTE TEMP-3 ROUNDED = CR-LFRFND / CR-LFPRM
  6363             COMPUTE GR-LFBEN ROUNDED =
  6364                              CR-LFAMT - (CR-LFAMT * TEMP-3)
  6365             COMPUTE WS-SUM-LF-FACTOR = GR-LFBEN / CR-LFAMT
  6366             COMPUTE GR-LFPRM ROUNDED =
  6367                              CR-LFPRM - CR-LFRFND.
  6368
  6369     MOVE GR-LFPRM                   TO CR-LFPRM.
  6370
  6371 0250-A-H-SUMMARY-ADJ.
  6372
  6373     IF CR-AHTYP = ZERO
  6374         GO TO 0260-CALCULATE-PREMIUM-RESERVE.
  6375
  6376     MOVE +1                         TO WS-SUM-AH-FACTOR.
  6377
  6378     IF CR-AHPRM NOT GREATER CR-AHRFND
  6379         MOVE ZERO                   TO GR-AHBEN
  6380         MOVE ZERO                   TO GR-AHPRM
  6381         MOVE +0                     TO WS-SUM-AH-FACTOR
  6382     ELSE
  6383         IF CR-AHRFND = ZERO
  6384             MOVE CR-AHAMT           TO GR-AHBEN
  6385             MOVE CR-AHPRM           TO GR-AHPRM
  6386         ELSE
  6387             COMPUTE TEMP-3 ROUNDED = CR-AHRFND / CR-AHPRM
  6388             COMPUTE GR-AHBEN ROUNDED =
  6389                              CR-AHAMT - (CR-AHAMT * TEMP-3)
  6390             COMPUTE WS-SUM-AH-FACTOR = GR-AHBEN / CR-AHAMT
  6391             COMPUTE GR-AHPRM ROUNDED =
  6392                              CR-AHPRM - CR-AHRFND.
  6393
  6394     MOVE GR-AHPRM                   TO CR-AHPRM.
  6395
  6396 0260-CALCULATE-PREMIUM-RESERVE.
  6397
  6398     MOVE CR-LFPRM                   TO LF-PRM.
  6399     MOVE CR-LFPRM-ALT               TO LF-PRM-ALT.
  6400     MOVE SPACE                      TO CP-REIN-FLAG.
  6401
  6402     PERFORM 1000-CALCULATE-UNEARNED THRU 1099-CALC-UNEARNED-X.
  6403
  6404     IF (STATE-ABBR (CLAS-INDEXS) EQUAL 'VA')
  6405        AND (DTE-CLIENT = 'CID')
  6406        MOVE 'A'                 TO AH-EARN-METHOD
  6407     END-IF
  6408
  6409     IF (GR-AHTYP NOT = ZERO)       AND
  6410        (CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B' AND 'Z') AND
  6411        (AH-EARN-METHOD = 'A' OR 'C')
  6412        PERFORM 3000-RE-RATE-AH-ROUTINE THRU 3099-EXIT
  6413        IF CP-ERROR-RATE-NOT-FOUND  OR
  6414           CP-ERROR-RATE-IS-ZERO  OR
  6415           CP-ERROR-IN-DATES
  6416            NEXT SENTENCE
  6417        ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 120
* ECS050.cbl
  6418           COMPUTE GRS-AHPRM ROUNDED = (GR-AH-UP-REMTERM *
  6419              GR-AHBEN / +100 * CP-PREMIUM-RATE)
  6420              / CR-AHPRM-CALC * CR-AHPRM
  6421           MOVE GRS-AHPRM      TO GRD-AHPRM
  6422        END-IF
  6423     END-IF
  6424
  6425     .
  6426 0300-ESTABLISH-MORT-BASIS.
  6427
  6428     MOVE CR-MORT                    TO GR-MORT-CODE.
  6429
  6430     IF CLAS-MORT-OVRD NOT = SPACES
  6431         MOVE CLAS-MORT-OVRD         TO GR-MORT-CODE.
  6432
  6433     MOVE '0'                        TO GR-MORT-TYP.
  6434
  6435     IF (DTE-CLIENT = 'POS') AND
  6436        (GR-CARRIER EQUAL '3' OR '5')
  6437        MOVE 'G250'              TO GR-MORT-CODE.
  6438
  6439     IF DTE-CLIENT = 'BOA'
  6440        MOVE 'I350'              TO GR-MORT-CODE.
  6441
  6442     IF DTE-CLIENT = 'CVL'
  6443        MOVE 'I350'              TO GR-MORT-CODE.
  6444
  6445     IF (DTE-CLIENT = 'FLA')  AND
  6446        (GR-CARRIER EQUAL '0')
  6447         IF (GR-STATE = '36')  AND
  6448            (GR-EFF GREATER THAN 19901231)
  6449             MOVE 'S350'         TO GR-MORT-CODE
  6450         ELSE
  6451         IF (GR-STATE = '09')  AND
  6452            (GR-EFF GREATER THAN 19900930)
  6453             MOVE 'S350'         TO GR-MORT-CODE.
  6454
  6455     IF DTE-CLIENT = 'CRI'
  6456        MOVE 'G350'              TO GR-MORT-CODE.
  6457
  6458     IF DTE-CLIENT = 'MIL'
  6459        MOVE 'G350'              TO GR-MORT-CODE.
  6460
  6461     IF DTE-CLIENT = 'CID'
  6462        AND (CR-ACCOUNT (1:5) NOT = '00010')
  6463        NEXT SENTENCE
  6464      ELSE
  6465        GO TO 0300-CID-MORT-DONE.
  6466
  6467     IF GR-YR = 94
  6468        MOVE 'L990' TO GR-MORT-CODE
  6469        GO TO 0300-CID-MORT-DONE.
  6470
  6471      IF GR-YR = 95 OR 96
  6472        MOVE 'L960' TO GR-MORT-CODE
  6473        GO TO 0300-CID-MORT-DONE.
  6474
  6475      IF GR-YR = 97
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 121
* ECS050.cbl
  6476        MOVE 'L680' TO GR-MORT-CODE
  6477        GO TO 0300-CID-MORT-DONE.
  6478
  6479 0300-CID-MORT-DONE.
  6480
  6481     IF DTE-CLIENT = 'NCB'
  6482       IF GR-CARRIER = 'T'
  6483           MOVE 'F520'               TO GR-MORT-CODE
  6484       ELSE
  6485         IF (GR-CARRIER = 'G' OR '2' OR '3' OR '4')  AND
  6486             GR-CCYY LESS THAN 1994
  6487             MOVE 'A300'             TO GR-MORT-CODE
  6488         ELSE
  6489             IF GR-CCYY GREATER 1993
  6490                 MOVE 'J520'         TO GR-MORT-CODE
  6491             ELSE
  6492                 IF GR-CCYY GREATER 1986
  6493                     MOVE 'L650'     TO GR-MORT-CODE
  6494                 ELSE
  6495                     IF GR-CCYY GREATER THAN 1983
  6496                         MOVE 'L720' TO GR-MORT-CODE.
  6497
  6498     IF DTE-CLIENT = 'POS' AND CR-CARRIER = '2'
  6499         IF GR-CCYY GREATER 1976 AND GR-GROUPING = '000030'
  6500             MOVE '2350'             TO GR-MORT-CODE.
  6501
  6502     IF DTE-CLIENT = 'IST'
  6503        IF CR-LF-TERM GREATER 59
  6504            MOVE 'D550'              TO GR-MORT-CODE
  6505        ELSE
  6506            MOVE 'F550'              TO GR-MORT-CODE.
  6507
  6508     IF DTE-CLIENT = 'FIM'
  6509         IF CR-SEX-FEMALE
  6510             MOVE 'F550'             TO GR-MORT-CODE
  6511         ELSE
  6512             MOVE 'D550'             TO GR-MORT-CODE.
  6513
  6514     IF DTE-CLIENT = 'FIM'
  6515         IF GR-CARRIER = 'H'
  6516             MOVE 'D350'             TO GR-MORT-CODE.
  6517
  6518     IF DTE-CLIENT = 'SNR' AND
  6519        GR-CARRIER = '1' AND
  6520        CR-SEX = 'F'
  6521         MOVE '9350'                 TO GR-MORT-CODE.
  6522
  6523     IF DTE-CLIENT = 'SBG' AND
  6524        GR-EFF GREATER THAN 19820615
  6525          MOVE 'F350'                TO GR-MORT-CODE.
  6526
  6527     IF DTE-CLIENT = 'HAN' OR 'JHL'
  6528       IF GR-CCYR = 1994  OR  1995
  6529           IF CR-SEX-FEMALE
  6530               MOVE 'R550'           TO GR-MORT-CODE
  6531           ELSE
  6532               MOVE 'S550'           TO GR-MORT-CODE
  6533       ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 122
* ECS050.cbl
  6534           IF CR-SEX-FEMALE
  6535               MOVE 'R600'           TO GR-MORT-CODE
  6536           ELSE
  6537               MOVE 'S600'           TO GR-MORT-CODE.
  6538
  6539     IF DTE-CLIENT = 'NCL'
  6540         MOVE AM-REPORT-CODE-2       TO WORK-REGION
  6541         MOVE 'N450'                 TO GR-MORT-CODE
  6542         IF NOT A-CAPTIVE-ACCOUNT
  6543             IF GR-STATE = 'AK' OR 'AR' OR 'CO' OR 'DC' OR 'GA'
  6544                        OR 'IA' OR 'ID' OR 'IL' OR 'IN' OR 'KY'
  6545                        OR 'LA' OR 'MA' OR 'MD' OR 'ME' OR 'MI'
  6546                        OR 'MN' OR 'MT' OR 'NE' OR 'NH' OR 'NM'
  6547                        OR 'NV' OR 'SC' OR 'SD' OR 'UT' OR 'VT'
  6548                        OR 'WV' OR 'MS'
  6549                        OR 'AL' OR 'AZ' OR 'CA' OR 'CT' OR 'FL'
  6550                        OR 'MO' OR 'ND' OR 'RI' OR 'WI' OR 'WY'
  6551                 MOVE 'W450'         TO GR-MORT-CODE.
  6552
  6553     IF DTE-ALT-MORT-CODE NOT = SPACES
  6554         MOVE DTE-ALT-MORT-CODE      TO GR-ALT-MORT-CODE.
  6555
  6556     MOVE ZEROS                      TO GR-ALT-RESV.
  6557
  6558     IF DTE-CLIENT = 'GLC'
  6559         IF GR-CARRIER = '2'
  6560             MOVE 48                 TO GR-AGE  GR-MORT-AGE.
  6561
  6562     IF GR-LFTYP NOT = ZERO
  6563         PERFORM 2000-CALC-REM-AMT THRU 2999-CALC-REM-AMT-X.
  6564
  6565     IF DTE-CLIENT = 'CSL'
  6566        IF GR-LFTYP NOT = ZEROS  AND
  6567           AM-MAX-TOT-BEN NOT = ZEROS
  6568           IF GR-REM-AMT GREATER THAN AM-MAX-TOT-BEN
  6569               MOVE AM-MAX-TOT-BEN   TO GR-REM-AMT.
  6570
  6571     IF GR-AHTYP NOT = ZERO
  6572         COMPUTE GR-AH-REM-BEN ROUNDED = GR-AHBEN * GR-AH-REMTERM.
  6573
  6574     IF DTE-CLIENT = 'CSL'
  6575        IF GR-AHTYP NOT = ZEROS  AND
  6576           AM-MAX-MON-BEN NOT = ZEROS
  6577           IF GR-AHBEN GREATER THAN AM-MAX-MON-BEN
  6578               COMPUTE GR-AH-REM-BEN ROUNDED =
  6579                                AM-MAX-MON-BEN * GR-AH-REMTERM.
  6580
  6581     MOVE GR-REM-AMT                 TO AX-LF-REMAMT.
  6582     MOVE GR-AH-REM-BEN              TO AX-AH-REMAMT.
  6583
  6584     PERFORM 0600-WRITE-ALPHA-EXTRACT THRU 0699-EXIT.
  6585
  6586     IF CR-ENTRY-STATUS = '9'
  6587         GO TO 0390-GENERATE-GAAP-RECORDS.
  6588
  6589     ADD GR-LFBEN                    TO TOT-INIT-FACE
  6590     ADD GR-REM-AMT                  TO TOT-REM-FACE
  6591     ADD GR-AH-REM-BEN               TO TOT-REM-AH.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 123
* ECS050.cbl
  6592     IF GR-FLAG = 'F'
  6593         ADD GR-LFBEN                TO TOT-FUTR-FACE.
  6594     ADD GR-MO-DEC                   TO TOT-MO-DEC.
  6595
  6596 0390-GENERATE-GAAP-RECORDS.
  6597
  6598     IF DTE-PGM-OPT = '1'
  6599         GO TO 0110-READ-CERT-MASTER.
  6600
  6601     MOVE GAAP-RECORD                TO SAVE-GAAP-REC.
  6602     MOVE GR-REM-AMT                 TO SAVE-REMAINING-AMT.
  6603
  6604     IF CR-ENTRY-STATUS NOT = '9'
  6605         ADD +1                      TO TOT-GAAP
  6606         PERFORM 0700-WRITE-GAAP-RECORD THRU 0799-WRITE-GAAP-X.
  6607
  6608     PERFORM 4000-REINSURE-ROUTINE THRU 4099-REINSURE-ROUTINE-X.
  6609
  6610     GO TO 0110-READ-CERT-MASTER.
  6611
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 124
* ECS050.cbl
  6613 0395-CHECK-OUT-OB.
  6614
  6615     MOVE SPACES                 TO O-B-SWITCH
  6616                                    SUMMARY-SWITCH
  6617                                    GR-REIN.
  6618
  6619     IF OB-DATE-1-USED  OR
  6620        OB-DATE-2-USED  OR
  6621        OB-DATE-3-USED
  6622         PERFORM 0397-BUILD-LF-GAAP THRU 0397-EXIT
  6623         VARYING SUB FROM +1 BY +1 UNTIL SUB GREATER THAN +20
  6624         PERFORM 0398-BUILD-AH-GAAP THRU 0398-EXIT
  6625         VARYING SUB FROM +1 BY +1 UNTIL SUB GREATER THAN +20.
  6626
  6627     MOVE SPACES                 TO WS-OB-DATE-1-SWITCH
  6628                                    WS-OB-DATE-2-SWITCH
  6629                                    WS-OB-DATE-3-SWITCH.
  6630
  6631 0395-EXIT.
  6632     EXIT.
  6633 0397-BUILD-LF-GAAP.
  6634
  6635*    DISPLAY '*** BUILD GAAP ***'
  6636*    DISPLAY '*** SUB *** ' SUB
  6637*    DISPLAY '*LF PREM*1 ' WS-LIFE-PREM (1 SUB)
  6638*    DISPLAY '*LF PREM*2 ' WS-LIFE-PREM (2 SUB)
  6639*    DISPLAY '*LF PREM*3 ' WS-LIFE-PREM (3 SUB)
  6640
  6641     IF OB-DATE-1-USED
  6642         IF WS-LIFE-PREM (1 SUB) GREATER THAN +0
  6643             MOVE +1             TO SUBA
  6644             GO TO 0397-BUILD-LF-CONTINUED
  6645         ELSE
  6646             GO TO 0397-EXIT.
  6647
  6648     IF OB-DATE-2-USED
  6649         IF WS-LIFE-PREM (2 SUB) GREATER THAN +0
  6650             MOVE +2             TO SUBA
  6651             GO TO 0397-BUILD-LF-CONTINUED
  6652         ELSE
  6653             GO TO 0397-EXIT.
  6654
  6655     IF OB-DATE-3-USED
  6656         IF WS-LIFE-PREM (3 SUB) GREATER THAN +0
  6657             MOVE +3             TO SUBA
  6658             GO TO 0397-BUILD-LF-CONTINUED
  6659         ELSE
  6660             GO TO 0397-EXIT.
  6661
  6662 0397-BUILD-LF-CONTINUED.
  6663
  6664     MOVE INITIALIZED-GAAP-RECORD TO GAAP-RECORD.
  6665     PERFORM LOAD-GAAP-WS-DATES.
  6666
  6667     MOVE 'P'                    TO GR-REIN.
  6668
  6669     MOVE DTE-CLASIC-COMPANY-CD  TO GR-COMPANY-CD.
  6670     MOVE AM-CONTROL-A           TO GR-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 125
* ECS050.cbl
  6671
  6672     MOVE AM-REPORT-CODE-2       TO GR-REGION.
  6673     MOVE AM-POOL-PRIME          TO GR-POOL-PRIME.
  6674
  6675     MOVE WS-NCL-OB-DATES (SUBA) TO WS-GR-EFF-N.
  6676
  6677     MOVE 01                     TO GR-DA
  6678     MOVE WS-GR-EFF-N            TO GR-EFF.
  6679
  6680     MOVE 'LF'                   TO WS-OB-1-2.
  6681     MOVE WS-LIFE-OB-CODE (SUBA SUB)
  6682                                 TO WS-OB-3-4.
  6683     MOVE WS-NCL-OB-CERT-NO      TO GR-CERT-NO.
  6684
  6685     MOVE SPACES                 TO GR-REIN-COMP.
  6686
  6687     MOVE +42                    TO GR-AGE
  6688                                    GR-MORT-AGE.
  6689
  6690     MOVE +1                     TO GR-LF-TERM
  6691                                    GR-LF-REMTERM
  6692                                    GR-LF-UP-REMTERM.
  6693
  6694     MOVE 'ZER0'                 TO GR-MORT-CODE.
  6695     MOVE +1                     TO GR-CNT GR-CNT-LF.
  6696     MOVE WS-NCL-OB-DATES (SUBA) TO GR-ENT-DT
  6697                                    WS-GR-ENT-DT-N
  6698                                    GR-LF-EXPIRE-DATE
  6699                                    WS-GR-LF-EXPIRE-DATE-N.
  6700
  6701     MOVE WS-LIFE-PREM (SUBA SUB)
  6702                                 TO GR-LFPRM.
  6703     MOVE WS-LIFE-BEN (SUBA SUB) TO GR-LFBEN.
  6704     MOVE WS-LIFE-OB-CODE (SUBA SUB)
  6705                                 TO GR-LFTYP.
  6706     COMPUTE GRR-LFPRM EQUAL GR-LFPRM * .5.
  6707     MOVE GRR-LFPRM              TO GRP-LFPRM
  6708                                    GRS-LFPRM
  6709                                    GRD-LFPRM.
  6710
  6711     COMPUTE GR-REM-AMT EQUAL GR-LFBEN * .5.
  6712
  6713     ADD GR-LFBEN                    TO TOT-INIT-FACE.
  6714     ADD GR-REM-AMT                  TO TOT-REM-FACE.
  6715
  6716     MOVE '*' TO GR-OB-IND.
  6717
  6718     MOVE GAAP-RECORD            TO SAVE-GAAP-REC.
  6719     MOVE GR-REM-AMT             TO SAVE-REMAINING-AMT.
  6720     ADD +1                      TO TOT-GAAP.
  6721     PERFORM 0700-WRITE-GAAP-RECORD THRU 0799-WRITE-GAAP-X.
  6722
  6723     IF AM-REI-TABLE EQUAL SPACES OR ZEROS
  6724        GO TO 0397-EXIT.
  6725
  6726     MOVE GR-CONTROL             TO CR-FULL-CONTROL.
  6727     MOVE GR-LFTYP               TO CR-LFTYP.
  6728     MOVE +1                     TO CR-LF-TERM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 126
* ECS050.cbl
  6729     MOVE GR-LFBEN               TO CR-LFAMT.
  6730     MOVE GR-LFPRM               TO CR-LFPRM CR-LFPRM-CALC.
  6731     MOVE ZEROS                  TO CR-LFAMT-ALT CR-LFPRM-ALT
  6732                                    CR-AHTYP CR-AHAMT
  6733                                    CR-AHPRM CR-AHPRM-CALC.
  6734     MOVE AM-IG                  TO CR-IND-GRP.
  6735     MOVE +42                    TO CR-AGE.
  6736     MOVE AM-REI-TABLE           TO CR-REIN-TABLE.
  6737
  6738     MOVE '*'                    TO O-B-SWITCH.
  6739
  6740     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  6741     PERFORM 0130-FIND-LIFE-LOOP THRU 0130-LIFE-LOOP-EXIT.
  6742***  PERFORM 0130-FIND-LIFE-LOOP.
  6743
  6744     PERFORM 4000-REINSURE-ROUTINE THRU 4099-REINSURE-ROUTINE-X.
  6745
  6746 0397-EXIT.
  6747     EXIT.
  6748 0398-BUILD-AH-GAAP.
  6749
  6750     IF OB-DATE-1-USED
  6751         IF WS-AH-PREM (1 SUB) GREATER THAN +0
  6752             MOVE +1             TO SUBA
  6753             GO TO 0398-BUILD-AH-CONTINUED
  6754         ELSE
  6755             GO TO 0398-EXIT.
  6756
  6757     IF OB-DATE-2-USED
  6758         IF WS-AH-PREM (2 SUB) GREATER THAN +0
  6759             MOVE +2             TO SUBA
  6760             GO TO 0398-BUILD-AH-CONTINUED
  6761         ELSE
  6762             GO TO 0398-EXIT.
  6763
  6764     IF OB-DATE-3-USED
  6765         IF WS-AH-PREM (3 SUB) GREATER THAN +0
  6766             MOVE +3             TO SUBA
  6767             GO TO 0398-BUILD-AH-CONTINUED
  6768         ELSE
  6769             GO TO 0398-EXIT.
  6770
  6771 0398-BUILD-AH-CONTINUED.
  6772
  6773     MOVE INITIALIZED-GAAP-RECORD TO GAAP-RECORD.
  6774     PERFORM LOAD-GAAP-WS-DATES.
  6775
  6776     MOVE 'P'                    TO GR-REIN.
  6777
  6778     MOVE DTE-CLASIC-COMPANY-CD  TO GR-COMPANY-CD.
  6779     MOVE AM-CONTROL-A           TO GR-CONTROL.
  6780
  6781     MOVE AM-REPORT-CODE-2       TO GR-REGION.
  6782     MOVE AM-POOL-PRIME          TO GR-POOL-PRIME.
  6783
  6784     MOVE WS-NCL-OB-DATES (SUBA) TO WS-GR-EFF-N.
  6785
  6786     MOVE 01                     TO GR-DA
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 127
* ECS050.cbl
  6787     MOVE WS-GR-EFF-N            TO GR-EFF.
  6788
  6789     MOVE 'AH'                   TO WS-OB-1-2.
  6790     MOVE WS-AH-OB-CODE (SUBA SUB)
  6791                                 TO WS-OB-3-4.
  6792     MOVE WS-NCL-OB-CERT-NO      TO GR-CERT-NO.
  6793
  6794     MOVE SPACES                 TO GR-REIN-COMP.
  6795
  6796     MOVE +42                    TO GR-AGE
  6797                                    GR-MORT-AGE.
  6798
  6799     MOVE +1                     TO GR-AH-TERM
  6800                                    GR-AH-REMTERM
  6801                                    GR-AH-UP-REMTERM.
  6802
  6803     MOVE 'ZER0'                 TO GR-MORT-CODE.
  6804     MOVE +1                     TO GR-CNT GR-CNT-AH.
  6805     MOVE WS-NCL-OB-DATES (SUBA) TO GR-ENT-DT
  6806                                    WS-GR-ENT-DT-N
  6807                                    GR-AH-EXPIRE-DATE
  6808                                    WS-GR-AH-EXPIRE-DATE-N.
  6809
  6810     MOVE WS-AH-PREM (SUBA SUB)  TO GR-AHPRM.
  6811
  6812     MOVE WS-AH-BEN (SUBA SUB)   TO GR-AHBEN.
  6813     MOVE WS-AH-OB-CODE (SUBA SUB)
  6814                                 TO GR-AHTYP.
  6815     COMPUTE GRR-AHPRM EQUAL GR-AHPRM * .5.
  6816     MOVE GRR-AHPRM              TO GRP-AHPRM
  6817                                    GRS-AHPRM
  6818                                    GRD-AHPRM.
  6819
  6820     COMPUTE GR-AH-REM-BEN EQUAL GR-AHBEN * .5.
  6821
  6822     ADD GR-AH-REM-BEN               TO TOT-REM-AH.
  6823
  6824     MOVE '*' TO GR-OB-IND.
  6825
  6826     MOVE GAAP-RECORD            TO SAVE-GAAP-REC.
  6827     ADD +1                      TO TOT-GAAP.
  6828     PERFORM 0700-WRITE-GAAP-RECORD THRU 0799-WRITE-GAAP-X.
  6829
  6830     IF AM-REI-TABLE EQUAL SPACES OR ZEROS
  6831        GO TO 0398-EXIT.
  6832
  6833     MOVE GR-CONTROL             TO CR-FULL-CONTROL.
  6834     MOVE GR-AHTYP               TO CR-AHTYP.
  6835     MOVE +1                     TO CR-AH-TERM.
  6836     MOVE GR-AHBEN               TO CR-AHAMT.
  6837     MOVE GR-AHPRM               TO CR-AHPRM CR-AHPRM-CALC.
  6838     MOVE ZEROS                  TO CR-LFTYP CR-LFAMT
  6839                                    CR-LFAMT-ALT
  6840                                    CR-LFPRM CR-LFPRM-CALC.
  6841     MOVE AM-IG                  TO CR-IND-GRP.
  6842     MOVE +42                    TO CR-AGE.
  6843     MOVE AM-REI-TABLE           TO CR-REIN-TABLE.
  6844
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 128
* ECS050.cbl
  6845     MOVE '*'                    TO O-B-SWITCH.
  6846
  6847     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  6848     PERFORM 0150-FIND-AH-LOOP.
  6849
  6850     PERFORM 4000-REINSURE-ROUTINE THRU 4099-REINSURE-ROUTINE-X.
  6851
  6852 0398-EXIT.
  6853     EXIT.
  6854
  6855 0400-DATE-CONVERSION-ROUTINE.
  6856
* 6857     COPY ELCDCS.
  6858****************************************************************  04/15/98
  6859*                                                              *  ELCDCS
  6860*                                                              *  ELCDCS
  6861*                            ELCDCS.                           *     LV003
  6862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6863*                            VMOD=2.002                        *     CL**3
  6864*                                                              *  ELCDCS
  6865*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  6866****************************************************************. ELCDCS
  6867                                                                  ELCDCS
  6868 8510-DATE-CONVERSION.                                            ELCDCS
  6869     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  6870                                                                  ELCDCS
  6871 8590-EXIT.                                                       ELCDCS
  6872     EXIT.                                                        ELCDCS
  6873                                                                  ELCDCS
  6874
  6875 0409-EXIT.
  6876     EXIT.
  6877
  6878
  6879 0410-GET-REMAINING-TERM.
  6880
  6881     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
  6882
  6883     IF DTE-CLIENT = 'NCL'
  6884         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2.
  6885
  6886 0419-REM-TERM-EXIT.
  6887     EXIT.
  6888
  6889
  6890 0500-MATCH-TO-ACC.
  6891
  6892     MOVE SPACE TO AH-EARN-METHOD.
  6893
  6894     IF AM-CONTROL-A LESS CR-ACCT-CONTROL
  6895         PERFORM 0590-READ-AM-MSTR THRU 0598-EXIT
  6896         GO TO 0500-MATCH-TO-ACC.
  6897
  6898     IF AM-CONTROL-A GREATER CR-ACCT-CONTROL
  6899         GO TO 0550-AM-MSTR-ERROR.
  6900
  6901     IF CR-DT NOT LESS AM-EXPIRE-DT
  6902         PERFORM 0590-READ-AM-MSTR THRU 0598-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 129
* ECS050.cbl
  6903         GO TO 0500-MATCH-TO-ACC.
  6904
  6905     IF CR-DT LESS AM-EFFECT-DT
  6906         GO TO 0550-AM-MSTR-ERROR.
  6907
  6908*    IF AM-EARN-METHOD-A NOT = SPACES
  6909*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
  6910
  6911     MOVE  'YYYYYYYYYY'           TO  WS-CHARGEBACK-LEVELS
  6912
  6913     PERFORM VARYING SUBB FROM +1 BY +1 UNTIL
  6914        SUBB > +10
  6915        IF AM-COMM-CHARGEBACK (SUBB) NOT NUMERIC
  6916           MOVE ZEROS TO AM-COMM-CHARGEBACK (SUBB)
  6917        END-IF
  6918        IF AM-COMM-CHARGEBACK (SUBB) = ZEROS
  6919           CONTINUE
  6920        ELSE
  6921           IF AM-COMM-CHARGEBACK (SUBB) = '99'
  6922              MOVE 'N' TO WS-CHARGEBACK-SW (SUBB)
  6923           END-IF
  6924        END-IF
  6925     END-PERFORM
  6926
  6927     GO TO 0599-EXIT.
  6928
  6929 0550-AM-MSTR-ERROR.
  6930
  6931     DISPLAY 'NO ACCOUNT MASTER ' CR-ACCT-CONTROL ' '
  6932      cr-dt ' ' cr-cert-no
  6933
  6934     IF DTE-CLIENT = 'ELT' OR 'FMK' OR 'XXX' OR 'PLI' OR
  6935                     'ADL' OR 'DEF' OR 'GIC' OR 'FIA' OR 'AHL'
  6936         GO TO 0599-EXIT.
  6937
  6938     MOVE 0302 TO WS-RETURN-CODE
  6939     GO TO ABEND-PGM.
  6940
  6941 0590-READ-AM-MSTR.
  6942
  6943     READ ERACCTT
  6944         IF ERACCTT-FILE-STATUS = '10'
  6945         MOVE HIGH-VALUES TO AM-MSTR-CNTRL
  6946         GO TO 0598-EXIT.
  6947
  6948     IF ERACCTT-FILE-STATUS NOT = '00'
  6949         MOVE ERACCTT-FILE-STATUS TO W-ABEND-CODE-2
  6950         MOVE WS-ABEND-CODE TO WS-RETURN-CODE
  6951         MOVE 'READ ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  6952         DISPLAY ' ERROR - ERACCTT - READ ' ERACCTT-FILE-STATUS
  6953         ' FOR CERT ' CR-FULL-CONTROL
  6954           GO TO ABEND-PGM.
  6955
  6956*****COPY ELCACCTI.
  6957
  6958*    IF AM-REI-LF-TAX NOT NUMERIC
  6959*        MOVE ZEROS                  TO AM-REI-LF-TAX.
  6960*    IF AM-REI-AH-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 130
* ECS050.cbl
  6961*        MOVE ZEROS                  TO AM-REI-AH-TAX.
  6962     IF AM-MAX-TOT-BEN NOT NUMERIC
  6963         MOVE ZEROS                  TO AM-MAX-TOT-BEN.
  6964     IF AM-MAX-MON-BEN NOT NUMERIC
  6965         MOVE ZEROS                  TO AM-MAX-MON-BEN.
  6966
  6967 0598-EXIT.
  6968     EXIT.
  6969
  6970 0599-EXIT.
  6971     EXIT.
  6972
  6973
  6974 0600-WRITE-ALPHA-EXTRACT.
  6975
  6976     IF DTE-PGM-OPT = ('1' OR '3')
  6977         NEXT SENTENCE
  6978     ELSE
  6979         GO TO 0699-EXIT.
  6980
  6981     IF REIN-ALPHA-SW EQUAL 'R'
  6982         MOVE SPACES                 TO REIN-ALPHA-SW
  6983         MOVE 'R'                    TO AX-ALPHA-TYPE-CODE
  6984         MOVE CR-NAME                TO AX-NAME
  6985         MOVE CR-AGE                 TO AX-AGE
  6986         GO TO 0610-CONTINUE.
  6987
  6988     IF SUMMARY-CERTIFICATE
  6989         MOVE 'S'                    TO AX-ALPHA-TYPE-CODE
  6990     ELSE
  6991         IF O-B-CERTIFICATE
  6992             MOVE 'O'                TO AX-ALPHA-TYPE-CODE
  6993     ELSE
  6994             MOVE 'I'                TO AX-ALPHA-TYPE-CODE.
  6995
  6996 0610-CONTINUE.
  6997
  6998     MOVE ALPHA-RECORD TO SAVE-ALPHA-REC.
  6999
  7000     WRITE ALPHA-EXTRACT-RECORD FROM ALPHA-RECORD.
  7001
  7002     IF AX-REIN-ALPHA
  7003         NEXT SENTENCE
  7004     ELSE
  7005         ADD +1                      TO TOT-ALPHA.
  7006
  7007     IF SUMMARY-CERTIFICATE
  7008         GO TO 0699-EXIT.
  7009
  7010     IF O-B-CERTIFICATE
  7011         GO TO 0699-EXIT.
  7012
  7013     IF CR-JOINT-NAME EQUAL SPACES OR LOW-VALUES
  7014         GO TO 0699-EXIT.
  7015
  7016     IF JOINT-LF-COVERAGE OR JOINT-AH-COVERAGE
  7017         NEXT SENTENCE
  7018     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 131
* ECS050.cbl
  7019         GO TO 0699-EXIT.
  7020
  7021     MOVE CR-JOINT-NAME              TO AX-NAME.
  7022     MOVE CR-JOINT-AGE               TO AX-AGE.
  7023
  7024     MOVE SPACES                     TO AX-SEX
  7025                                        AX-SOC-NO.
  7026
  7027     IF NOT JOINT-LF-COVERAGE
  7028         MOVE SPACES                 TO AX-LF-TYP
  7029         MOVE ZEROS                  TO AX-LF-TERM
  7030                                        AX-LF-REMTERM
  7031                                        AX-LF-AMT
  7032                                        AX-LF-REMAMT
  7033                                        AX-LF-AMT-ALT
  7034                                        AX-LF-REMAMT-ALT
  7035                                        AX-LF-PRM
  7036                                        AX-LF-PRM-ALT
  7037                                        AX-LF-REFUND
  7038                                        AX-LF-CLAIM-PMTS.
  7039
  7040     IF NOT JOINT-AH-COVERAGE
  7041         MOVE SPACES                 TO AX-AH-TYP
  7042         MOVE ZEROS                  TO AX-AH-TERM
  7043                                        AX-AH-REMTERM
  7044                                        AX-AH-AMT
  7045                                        AX-AH-REMAMT
  7046                                        AX-AH-PRM
  7047                                        AX-AH-REFUND
  7048                                        AX-AH-CLAIM-PMTS.
  7049
  7050     IF AX-REIN-ALPHA
  7051         MOVE '9'                    TO AX-ALPHA-TYPE-CODE
  7052     ELSE
  7053         MOVE 'J'                    TO AX-ALPHA-TYPE-CODE.
  7054
  7055     WRITE ALPHA-EXTRACT-RECORD FROM ALPHA-RECORD.
  7056
  7057     ADD +1                          TO TOT-ALPHA-JOINT.
  7058
  7059 0699-EXIT.
  7060     EXIT.
  7061
  7062
  7063 0700-WRITE-GAAP-RECORD.
  7064
  7065     IF GR-LFTYP = ZERO  AND  GR-AHTYP = ZERO
  7066         GO TO 0799-WRITE-GAAP-X.
  7067
  7068******************************************************************
  7069     IF GR-REIN = 'P'
  7070       IF GR-LFTYP NOT = ZEROS
  7071           IF GR-LF-REMTERM GREATER THAN OLDEST-LF-REMTERM
  7072               MOVE GR-LF-REMTERM   TO OLDEST-LF-REMTERM.
  7073
  7074     IF GR-REIN = 'P'
  7075       IF GR-LFTYP NOT = ZEROS
  7076           IF GR-LF-REMTERM GREATER THAN +100
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 132
* ECS050.cbl
  7077               ADD 1 TO LF-OVER-100.
  7078
  7079     IF GR-REIN = 'P'
  7080       IF GR-AHTYP NOT = ZEROS
  7081           IF GR-AH-REMTERM GREATER THAN OLDEST-AH-REMTERM
  7082               MOVE GR-AH-REMTERM   TO OLDEST-AH-REMTERM.
  7083******************************************************************
  7084
  7085     IF DTE-PGM-OPT = ('2' OR '3')
  7086         WRITE GAAP-EXTRACT-RECORD FROM GAAP-RECORD.
  7087
  7088 0799-WRITE-GAAP-X.
  7089     EXIT.
  7090
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 133
* ECS050.cbl
  7092 0900-CALCULATE-COMMISSIONS.
  7093
  7094     MOVE +1                          TO SA.
  7095     MOVE ZEROS                       TO GR-LFCOM
  7096                                         GR-LFCOM-ALT
  7097                                         GR-AHCOM
  7098                                         WS-GR-LFCOM
  7099                                         WS-GR-LFCOM-ALT
  7100                                         WS-GR-AHCOM
  7101
  7102*    MOVE ZEROS                       TO GR-LFSRV
  7103*                                        GR-LFSRV-ALT
  7104*                                        GR-AHSRV.
  7105
  7106     .
  7107 0905-CALC-COMM-LOOP.
  7108
  7109     IF DTE-CLIENT = 'POS'
  7110         COMPUTE GR-LFCOM ROUNDED =
  7111                       GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7112         COMPUTE GR-LFCOM-ALT ROUNDED =
  7113                   GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7114         COMPUTE GR-AHCOM ROUNDED =
  7115                       GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7116         GO TO 0910-CALC-COMM-SKIP.
  7117
  7118*   WS-CB-SW OF SPACES SETS DO-NOT-CHARGE-BACK TO FALSE
  7119     MOVE ' '                    TO WS-CB-SW
  7120
  7121     if dte-client = 'AHL'
  7122        continue
  7123     else
  7124        IF (WS-CHARGEBACK-SW (SA) = 'N') OR
  7125           ((AM-COMM-CHARGEBACK (SA) NOT = ZEROS) AND
  7126           (MONTHS-DIFF > AM-COMM-CHARGEBACK (SA)))
  7127           SET DO-NOT-CHARGE-BACK   TO TRUE
  7128        END-IF
  7129     end-if
  7130
  7131*  I COULD HAVE ADDED THIS IN THE IF STMT BELOW BUT I
  7132*  DIDN'T WANT TO SCREW IT UP SO......
  7133
  7134     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
  7135        OR (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  7136        IF GR-REIN = 'P'
  7137           IF CR-AGT-TYPE (SA) = 'C' OR 'D'
  7138              COMPUTE GR-LFCOM =
  7139                  GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7140              COMPUTE GR-LFCOM-ALT =
  7141                  GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7142              COMPUTE GR-AHCOM =
  7143                  GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7144              IF DO-NOT-CHARGE-BACK
  7145                 CONTINUE
  7146              ELSE
  7147                 COMPUTE WS-GR-LFCOM =
  7148                     WS-GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7149                 COMPUTE WS-GR-LFCOM-ALT =
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 134
* ECS050.cbl
  7150                  WS-GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7151                 COMPUTE WS-GR-AHCOM =
  7152                  WS-GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7153              END-IF
  7154           ELSE
  7155              IF CR-AGT-TYPE (SA) = 'A' OR 'O' OR 'P'
  7156                 COMPUTE GR-LFCOM =
  7157                     GR-LFCOM + (CR-LF-CLP * CR-LCOM-L (SA))
  7158                 COMPUTE GR-AHCOM =
  7159                     GR-AHCOM + (CR-AH-CLP * CR-LCOM-AH (SA))
  7160                 IF DO-NOT-CHARGE-BACK
  7161                    CONTINUE
  7162                 ELSE
  7163                    COMPUTE WS-GR-LFCOM =
  7164                      WS-GR-LFCOM + (CR-LF-CLP * CR-LCOM-L (SA))
  7165                    COMPUTE WS-GR-AHCOM =
  7166                      WS-GR-AHCOM + (CR-AH-CLP * CR-LCOM-AH (SA))
  7167                 END-IF
  7168              END-IF
  7169           END-IF
  7170        ELSE
  7171           IF GR-REIN = 'R'
  7172              IF CR-AGT-TYPE (SA) = 'R' OR 'D'
  7173                 COMPUTE GR-LFCOM =
  7174                     GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7175                 COMPUTE GR-LFCOM-ALT =
  7176                     GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7177                 COMPUTE GR-AHCOM =
  7178                     GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7179                 IF DO-NOT-CHARGE-BACK
  7180                    CONTINUE
  7181                 ELSE
  7182                    COMPUTE WS-GR-LFCOM =
  7183                        WS-GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7184                    COMPUTE WS-GR-LFCOM-ALT = WS-GR-LFCOM-ALT
  7185                       + (LF-PRM-ALT * CR-LCOM-L (SA))
  7186                    COMPUTE WS-GR-AHCOM =
  7187                     WS-GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7188                 END-IF
  7189              ELSE
  7190                 IF CR-AGT-TYPE (SA) = 'T' OR 'P'
  7191                    COMPUTE GR-LFCOM =
  7192                        GR-LFCOM + (CR-LF-CLP * CR-LCOM-L (SA))
  7193                    COMPUTE GR-AHCOM =
  7194                        GR-AHCOM + (CR-AH-CLP * CR-LCOM-AH (SA))
  7195                    IF DO-NOT-CHARGE-BACK
  7196                       CONTINUE
  7197                    ELSE
  7198                       COMPUTE WS-GR-LFCOM = WS-GR-LFCOM +
  7199                          (CR-LF-CLP * CR-LCOM-L (SA))
  7200                       COMPUTE WS-GR-AHCOM = WS-GR-AHCOM +
  7201                          (CR-AH-CLP * CR-LCOM-AH (SA))
  7202                    END-IF
  7203                 END-IF
  7204              END-IF
  7205           END-IF
  7206        END-IF
  7207        GO TO 0905-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 135
* ECS050.cbl
  7208     END-IF
  7209
  7210     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  7211        IF GR-REIN = 'P'
  7212           IF CR-AGT-TYPE (SA) = 'C' OR 'D'
  7213              COMPUTE GR-AHCOM = GR-AHCOM +
  7214                 (GR-AHPRM - (CR-LFPRM-ALT + CR-ADDL-CLP))
  7215              IF (NOT DO-NOT-CHARGE-BACK)
  7216                 AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  7217                 COMPUTE WS-GR-AHCOM = WS-GR-AHCOM +
  7218                    (GR-AHPRM - (CR-LFPRM-ALT + CR-ADDL-CLP))
  7219              END-IF
  7220           ELSE
  7221              IF CR-AGT-TYPE (SA) = 'B' OR 'I' OR 'L' OR 'K'
  7222                                 OR 'J' OR 'N'
  7223                 COMPUTE GR-AHCOM = GR-AHCOM +
  7224                 (CR-LCOM-AH (SA) * +1000)
  7225                 IF (NOT DO-NOT-CHARGE-BACK)
  7226                    AND (CR-AGT-TYPE (SA) NOT = 'N' AND 'I')
  7227                    COMPUTE WS-GR-AHCOM = WS-GR-AHCOM +
  7228                    (CR-LCOM-AH (SA) * +1000)
  7229                 END-IF
  7230              ELSE
  7231                 IF CR-AGT-TYPE (SA) = 'O' OR 'P'
  7232                    COMPUTE GR-AHCOM = GR-AHCOM +
  7233                    (GR-AHPRM * CR-LCOM-AH (SA))
  7234                    IF NOT DO-NOT-CHARGE-BACK
  7235                       COMPUTE WS-GR-AHCOM = WS-GR-AHCOM +
  7236                       (GR-AHPRM * CR-LCOM-AH (SA))
  7237                    END-IF
  7238                 END-IF
  7239              END-IF
  7240           END-IF
  7241        ELSE
  7242           IF GR-REIN = 'R'
  7243              IF CR-AGT-TYPE (SA) = 'K'
  7244                 COMPUTE GR-AHCOM = GR-AHCOM +
  7245                 (GR-AHPRM / CR-AHPRM) *
  7246                 (CR-LCOM-AH (SA) * +1000)
  7247                 IF NOT DO-NOT-CHARGE-BACK
  7248                    COMPUTE WS-GR-AHCOM = WS-GR-AHCOM +
  7249                    (GR-AHPRM / CR-AHPRM) *
  7250                    (CR-LCOM-AH (SA) * +1000)
  7251                 END-IF
  7252              ELSE
  7253                 IF CR-AGT-TYPE (SA) = 'P' OR 'T' OR 'R'
  7254                    COMPUTE GR-AHCOM =
  7255                    GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7256                    IF NOT DO-NOT-CHARGE-BACK
  7257                       COMPUTE WS-GR-AHCOM =
  7258                       WS-GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7259                    END-IF
  7260                 END-IF
  7261              END-IF
  7262           END-IF
  7263        END-IF
  7264     ELSE
  7265
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 136
* ECS050.cbl
  7266
  7267     IF DTE-CLIENT = 'DCC'
  7268       IF ((GR-REIN = 'P')
  7269         AND (CR-AGT-TYPE (SA) = ('C' OR 'D')))
  7270       OR
  7271         ((GR-REIN = 'R')
  7272         AND (CR-AGT-TYPE (SA) = ('R' OR 'D')))
  7273           COMPUTE GR-LFCOM =
  7274               GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7275           COMPUTE GR-LFCOM-ALT =
  7276               GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7277           COMPUTE GR-AHCOM =
  7278               GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7279           IF DO-NOT-CHARGE-BACK
  7280              CONTINUE
  7281           ELSE
  7282              COMPUTE WS-GR-LFCOM =
  7283                  WS-GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7284              COMPUTE WS-GR-LFCOM-ALT =
  7285                  WS-GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7286              COMPUTE WS-GR-AHCOM =
  7287                  WS-GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7288           END-IF
  7289       END-IF
  7290     ELSE
  7291
  7292
  7293     IF GR-REIN = 'P' AND
  7294        CR-AGT-TYPE (SA) = ('C' OR 'D' OR 'O' OR 'P')
  7295     OR
  7296        GR-REIN = 'R' AND
  7297        CR-AGT-TYPE (SA) = ('R' OR 'D' OR 'T' OR 'P')
  7298         COMPUTE GR-LFCOM =
  7299             GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7300         COMPUTE GR-LFCOM-ALT =
  7301             GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7302         COMPUTE GR-AHCOM =
  7303             GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7304         IF DO-NOT-CHARGE-BACK
  7305            CONTINUE
  7306         ELSE
  7307            COMPUTE WS-GR-LFCOM =
  7308                WS-GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
  7309            COMPUTE WS-GR-LFCOM-ALT =
  7310                WS-GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7311            COMPUTE WS-GR-AHCOM =
  7312                WS-GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
  7313         END-IF
  7314     END-IF
  7315     END-IF
  7316     END-IF
  7317
  7318     .
  7319 0905-CONTINUE.
  7320
  7321*    IF GR-REIN = 'P' AND
  7322*       CR-AGT-TYPE (SA) = ('F' OR 'S' OR 'G' OR 'B')
  7323*    OR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 137
* ECS050.cbl
  7324*       GR-REIN = 'R' AND
  7325*       CR-AGT-TYPE (SA) = ('U' OR 'S' OR 'V' OR 'B')
  7326*        COMPUTE GR-LFSRV =
  7327*            GR-LFSRV + (LF-PRM * CR-LCOM-L (SA))
  7328*        COMPUTE GR-LFSRV-ALT =
  7329*            GR-LFSRV-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
  7330*        COMPUTE GR-AHSRV =
  7331*            GR-AHSRV + (GR-AHPRM * CR-LCOM-AH (SA)).
  7332
  7333     IF GR-REIN NOT = 'R' OR
  7334        CR-AGT-TYPE (SA) NOT = 'W'
  7335         GO TO 0910-CALC-COMM-SKIP.
  7336
  7337     MOVE CR-COM-AGT (SA) TO REIN-AGENT.
  7338
  7339     IF RA-RCO NOT = GR-REIN-COMP
  7340         GO TO 0910-CALC-COMM-SKIP.
  7341
  7342     COMPUTE GR-LFCOM =
  7343        GR-LFCOM + (LF-PRM * CR-LCOM-L (SA)).
  7344     COMPUTE GR-LFCOM-ALT =
  7345        GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA)).
  7346     COMPUTE GR-AHCOM =
  7347        GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA)).
  7348
  7349 0910-CALC-COMM-SKIP.
  7350
  7351     ADD +1 TO SA.
  7352
  7353     IF SA LESS +11
  7354         GO TO 0905-CALC-COMM-LOOP.
  7355
  7356     COMPUTE GR-LFCOM = GR-LFCOM + GR-LFCOM-ALT.
  7357*    COMPUTE GR-LFSRV = GR-LFSRV + GR-LFSRV-ALT.
  7358
  7359 0999-CALC-COMM-X.
  7360     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 138
* ECS050.cbl
  7362*****************************************************************
  7363*  ECS050 WAS MODIFIED IN MAY,1989 TO 'CALL' A CENTRAL UNEARNED
  7364*   PREMIUM MODULE.  IF ANY MODIFICATIONS TO UNEARNED PREMIUM
  7365*   ARE NECESSARY, THEY SHOULD BE MADE IN 'ELUPRMX' TO STANDARDIZ
  7366*   AND CENTRALIZE ALL UNEARNED PREMIUM CALCULATIONS.
  7367*****************************************************************
  7368 1000-CALCULATE-UNEARNED.
  7369
  7370     IF (DTE-CLIENT EQUAL 'NCL') AND
  7371        (O-B-CERTIFICATE)
  7372        COMPUTE GRR-LFPRM EQUAL GR-LFPRM * .5
  7373        MOVE GRR-LFPRM           TO GRP-LFPRM
  7374                                    GRS-LFPRM
  7375                                    GRD-LFPRM
  7376        COMPUTE GRR-AHPRM EQUAL GR-AHPRM * .5
  7377        MOVE GRR-AHPRM           TO GRP-AHPRM
  7378                                    GRS-AHPRM
  7379                                    GRD-AHPRM
  7380        GO TO 1099-CALC-UNEARNED-X.
  7381
  7382     PERFORM 0900-CALCULATE-COMMISSIONS THRU 0999-CALC-COMM-X.
  7383
  7384     IF CR-LF-ISS-PREM-TAX NUMERIC
  7385        COMPUTE GR-LFTAX ROUNDED =
  7386           GR-LFPRM * CR-LF-ISS-PREM-TAX
  7387     END-IF
  7388     IF CR-AH-ISS-PREM-TAX NUMERIC
  7389        COMPUTE GR-AHTAX ROUNDED =
  7390           GR-AHPRM * CR-AH-ISS-PREM-TAX
  7391     END-IF
  7392*    COMPUTE GR-LFTAX ROUNDED = GR-LFPRM * AM-REI-LF-TAX.
  7393*    COMPUTE GR-AHTAX ROUNDED = GR-AHPRM * AM-REI-AH-TAX.
  7394
  7395** IF THE REMAINING TERM IS GREATER THAN THE LIFE TERM, AN ERROR
  7396** HAS OCCURRED
  7397
  7398     IF GR-FLAG = 'F'
  7399       MOVE GR-LFPRM              TO GRP-LFPRM
  7400                                     GRR-LFPRM
  7401                                     GRS-LFPRM
  7402                                     GRD-LFPRM
  7403       MOVE GR-LFCOM              TO GRP-LFCOM
  7404                                     GRR-LFCOM
  7405                                     GRS-LFCOM
  7406                                     GRD-LFCOM
  7407       MOVE GR-LFTAX              TO GRP-LFTAX
  7408                                     GRR-LFTAX
  7409       MOVE GR-AHPRM              TO GRP-AHPRM
  7410                                     GRR-AHPRM
  7411                                     GRS-AHPRM
  7412                                     GRD-AHPRM
  7413       MOVE GR-AHCOM              TO GRP-AHCOM
  7414                                     GRR-AHCOM
  7415                                     GRS-AHCOM
  7416                                     GRD-AHCOM
  7417       MOVE GR-AHTAX              TO GRP-AHTAX
  7418                                     GRR-AHTAX
  7419         GO TO 1099-CALC-UNEARNED-X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 139
* ECS050.cbl
  7420
  7421
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 140
* ECS050.cbl
  7423 1001-CALCULATE-UNEARNED-LIFE.
  7424
  7425     IF GR-LFTYP = ZEROS
  7426         GO TO 1010-CALCULATE-UNEARNED-AH.
  7427
  7428     IF GR-REIN = 'R'
  7429         IF RWF-LF-RUNOFF-SW = 'N'  AND
  7430            VALUATION-DATE NOT LESS THAN RWF-EP-STOP-DATE
  7431             MOVE ZEROS              TO GR-LFTYP GR-LFBEN GR-LFPRM
  7432             GO TO 1010-CALCULATE-UNEARNED-AH.
  7433
  7434*    MOVE GR-LFBEN                   TO CP-ORIGINAL-BENEFIT
  7435*                                       CP-RATING-BENEFIT-AMT.
  7436     MOVE LF-PRM                     TO CP-ORIGINAL-PREMIUM.
  7437     MOVE GR-LF-TERM                 TO CP-ORIGINAL-TERM.
  7438     MOVE LF-REM-TRM1                TO CP-REMAINING-TERM.
  7439     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
  7440     MOVE LF-PRM-ALT                 TO CP-ALTERNATE-PREMIUM.
  7441     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  7442     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  7443                                     TO CP-SPECIAL-CALC-CD.
  7444     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
  7445     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
  7446
  7447     PERFORM 3100-CALC-UNEARNED-PREMIUM THRU 3199-EXIT.
  7448
  7449     IF CP-ERROR-OCCURED
  7450        DISPLAY CP-RETURN-CODE ' ERROR OCCUR '
  7451        MOVE EXC-3                   TO EXP-MESSAGE
  7452        PERFORM 7600-EXCEP-REPT      THRU 7699-EXIT
  7453        GO TO 1009-EXIT.
  7454
  7455     IF GR-LFTYP = 'QD'
  7456        MOVE +15.0               TO CP-LOAN-APR
  7457     END-IF
  7458
  7459     IF (CP-EARN-AS-NET-PAY  AND
  7460        CP-LOAN-APR = ZERO)
  7461         MOVE EXC-1                  TO EXP-MESSAGE
  7462         PERFORM 7600-EXCEP-REPT     THRU 7699-EXIT.
  7463
  7464     IF (CP-EARN-AS-NET-PAY  AND
  7465        CP-TRUNCATED-LIFE  AND
  7466        CP-LOAN-TERM LESS THAN CP-ORIGINAL-TERM)
  7467         MOVE EXC-2                  TO EXP-MESSAGE
  7468         PERFORM 7600-EXCEP-REPT     THRU 7699-EXIT.
  7469
  7470
  7471     MOVE CP-R78-U-PRM               TO GRR-LFPRM.
  7472     MOVE CP-PRORATA-U-PRM           TO GRP-LFPRM.
  7473     MOVE CP-STATE-U-PRM             TO GRS-LFPRM.
  7474     MOVE CP-DOMICILE-U-PRM          TO GRD-LFPRM.
  7475
  7476     IF DTE-CLIENT = 'NCL'
  7477        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'
  7478           MOVE GRP-LFPRM        TO GRD-LFPRM
  7479        ELSE
  7480           IF GR-EFF GREATER THAN 19941231
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 141
* ECS050.cbl
  7481              IF CP-EARN-AS-NET-PAY
  7482                 MOVE GRS-LFPRM  TO GRD-LFPRM
  7483              ELSE
  7484              IF CP-EARN-AS-REG-BALLOON
  7485                 MOVE GRS-LFPRM  TO GRD-LFPRM
  7486              ELSE
  7487                 MOVE GRR-LFPRM  TO GRD-LFPRM
  7488           ELSE
  7489              MOVE GRR-LFPRM     TO GRD-LFPRM.
  7490
  7491
  7492     IF (DTE-CLIENT = 'CID')
  7493        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
  7494                   OR
  7495            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
  7496            AND (GR-EFF > 20091231)))
  7497        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
  7498        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
  7499        CONTINUE
  7500     ELSE
  7501        GO TO 1005-BEGIN-COMM
  7502     END-IF
  7503
  7504     PERFORM 2000-CALC-REM-AMT   THRU 2999-CALC-REM-AMT-X
  7505*    MOVE EFFECT-DT              TO  CP-CERT-EFF-DT
  7506
  7507     MOVE LF-REM-TRM1            TO  CP-REMAINING-TERM
  7508     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  7509                                 TO CP-BENEFIT-TYPE
  7510     MOVE SPACES                 TO CP-ACCT-FLD-5
  7511     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  7512     MOVE CR-AGE                 TO CP-ISSUE-AGE
  7513     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM
  7514     MOVE CR-LF-CRIT-PERIOD      TO CP-CRITICAL-MONTHS
  7515     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  7516                                    CP-LOAN-TERM
  7517     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
  7518                                    CP-RATING-BENEFIT-AMT
  7519     MOVE GR-REM-AMT             TO CP-REMAINING-BENEFIT
  7520     MOVE GR-APR                 TO CP-LOAN-APR
  7521     MOVE GR-PMT-FREQ            TO CP-PAY-FREQUENCY
  7522     MOVE CLAS-I-EP (CLAS-INDEXL) TO CP-RATING-METHOD
  7523     MOVE '6'                    TO CP-EARNING-METHOD
  7524     MOVE '3'                    TO CP-PROCESS-TYPE
  7525     MOVE ' '                    TO CP-SPECIAL-CALC-CD
  7526     IF CR-RATING-CLASS NOT = SPACES AND ZEROS
  7527        MOVE CR-RATING-CLASS     TO CP-CLASS-CODE
  7528     ELSE
  7529        MOVE AM-CAL-TABLE        TO CP-CLASS-CODE
  7530     END-IF
  7531
  7532     MOVE CR-LF-DEV-CODE         TO  CP-DEVIATION-CODE
  7533
  7534     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT
  7535     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  7536     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  7537     MOVE CR-LFTYP                   TO CP-BENEFIT-CD
  7538     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 142
* ECS050.cbl
  7539     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS
  7540     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE
  7541
  7542     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
  7543        COMPUTE CP-ORIGINAL-BENEFIT =
  7544         (CR-LFAMT - CR-LFPRM)
  7545     END-IF
  7546
  7547     IF CP-TRUNCATED-LIFE
  7548        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
  7549     END-IF
  7550
  7551     IF CP-TERM-IS-DAYS
  7552        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
  7553     ELSE
  7554        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
  7555     END-IF
  7556
  7557     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
  7558     MOVE CP-CALC-REFUND         TO GRS-LFPRM
  7559
  7560*    IF GRS-LFPRM = ZEROS
  7561*       DISPLAY ' ZERO RED ANTIC UEP FOR ' CR-CARRIER ' '
  7562*          CR-STATE ' ' CR-ACCOUNT ' ' CR-CERT-NO
  7563*    END-IF
  7564
  7565     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  7566        CONTINUE
  7567     ELSE
  7568        GO TO 1005-BEGIN-COMM
  7569     END-IF
  7570
  7571     MOVE 'L'                    TO CP-BENEFIT-TYPE
  7572     MOVE '2'                    TO CP-EARNING-METHOD
  7573                                    CP-RATING-METHOD
  7574     MOVE CR-LFAMT-ALT           TO CP-ORIGINAL-BENEFIT
  7575                                    CP-REMAINING-BENEFIT
  7576                                    CP-RATING-BENEFIT-AMT
  7577
  7578     IF CP-STATE-STD-ABBRV = 'OR'
  7579        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
  7580     END-IF
  7581
  7582     MOVE CR-LFPRM-ALT           TO CP-ORIGINAL-PREMIUM
  7583     MOVE 'LEV'                  TO CP-DEVIATION-CODE
  7584
  7585     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
  7586     COMPUTE GRS-LFPRM = GRS-LFPRM + CP-CALC-REFUND
  7587
  7588     .
  7589 1005-BEGIN-COMM.
  7590
  7591     COMPUTE CP-ORIGINAL-PREMIUM = WS-GR-LFCOM - WS-GR-LFCOM-ALT.
  7592     MOVE WS-GR-LFCOM-ALT            TO CP-ALTERNATE-PREMIUM.
  7593     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
  7594
  7595     PERFORM 3100-CALC-UNEARNED-PREMIUM THRU 3199-EXIT.
  7596
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 143
* ECS050.cbl
  7597     IF CP-ERROR-OCCURED
  7598        GO TO 1009-EXIT.
  7599
  7600     MOVE CP-R78-U-PRM               TO GRR-LFCOM.
  7601     MOVE CP-PRORATA-U-PRM           TO GRP-LFCOM.
  7602     MOVE CP-STATE-U-PRM             TO GRS-LFCOM.
  7603     MOVE CP-DOMICILE-U-PRM          TO GRD-LFCOM.
  7604
  7605     IF GR-LFTYP = 'QD'
  7606        MOVE +15.0               TO CP-LOAN-APR
  7607     END-IF
  7608
  7609*****************************************************************
  7610*
  7611* THE FOLLOWING 7 LINES OF CODE WERE COMMENTED OUT IN THE LOGIC
  7612* BASE SYSTEM CODE. CSO WAS USING THEM IN CURRENT PRODUCTION, SO
  7613* THE ASTRISK WAS REMOVED FROM EACH LINE.
  7614*
  7615* (PUT BACK IN FOR TESTING - 11/16/98)
  7616*
  7617*****************************************************************
  7618
  7619*    IF (CP-EARN-AS-NET-PAY
  7620*       AND GR-LFPRM GREATER THAN ZERO)
  7621*       COMPUTE NP-WORK1 = GRR-LFPRM / GR-LFPRM
  7622*       COMPUTE GRS-LFCOM ROUNDED = GR-LFCOM * NP-WORK1
  7623*       MOVE GRS-LFCOM                 TO GRD-LFCOM
  7624*       IF CP-LOAN-APR EQUAL ZERO
  7625*          MOVE ZERO                   TO GRS-LFPRM.
  7626
  7627*****************************************************************
  7628
  7629
  7630     IF DTE-CLIENT = 'NCL'
  7631        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'
  7632           MOVE GRP-LFCOM        TO GRD-LFCOM
  7633        ELSE
  7634           IF GR-EFF GREATER THAN 19941231
  7635              IF CP-EARN-AS-NET-PAY
  7636                 MOVE GRS-LFCOM  TO GRD-LFCOM
  7637              ELSE
  7638              IF CP-EARN-AS-REG-BALLOON
  7639                 MOVE GRS-LFCOM  TO GRD-LFCOM
  7640              ELSE
  7641                 MOVE GRR-LFCOM  TO GRD-LFCOM
  7642           ELSE
  7643              MOVE GRR-LFCOM     TO GRD-LFCOM.
  7644
  7645     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  7646        MOVE GR-LFTAX            TO CP-ORIGINAL-PREMIUM
  7647        PERFORM 3100-CALC-UNEARNED-PREMIUM
  7648                                 THRU 3199-EXIT
  7649        IF CP-ERROR-OCCURED
  7650           GO TO 1009-EXIT
  7651        ELSE
  7652           MOVE CP-R78-U-PRM     TO GRR-LFTAX
  7653                                    GRP-LFTAX
  7654        END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 144
* ECS050.cbl
  7655     ELSE
  7656        COMPUTE GRP-LFTAX ROUNDED =
  7657*          GRP-LFPRM * AM-REI-LF-TAX
  7658           GRP-LFPRM * CR-LF-ISS-PREM-TAX
  7659        COMPUTE GRR-LFTAX ROUNDED =
  7660*          GRR-LFPRM * AM-REI-LF-TAX.
  7661           GRR-LFPRM * CR-LF-ISS-PREM-TAX
  7662     END-IF
  7663     .
  7664 1009-EXIT.
  7665     EXIT.
  7666
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 145
* ECS050.cbl
  7668 1010-CALCULATE-UNEARNED-AH.
  7669
  7670     IF GR-AHTYP = ZEROS
  7671         GO TO 1099-CALC-UNEARNED-X.
  7672
  7673     IF GR-REIN = 'R'
  7674         IF RWF-AH-RUNOFF-SW = 'N'  AND
  7675            VALUATION-DATE NOT LESS THAN RWF-EP-STOP-DATE
  7676             MOVE ZEROS              TO GR-AHTYP GR-AHBEN GR-AHPRM
  7677             GO TO 1099-CALC-UNEARNED-X.
  7678
  7679     MOVE GR-AH-TERM                 TO CP-ORIGINAL-TERM.
  7680     MOVE GR-AHPRM                   TO CP-ORIGINAL-PREMIUM.
  7681     MOVE GR-AHBEN                   TO CP-ORIGINAL-BENEFIT
  7682                                        CP-RATING-BENEFIT-AMT.
  7683     MOVE AH-REM-TRM1                TO CP-REMAINING-TERM.
  7684
  7685     IF AH-EARN-METHOD EQUAL SPACES
  7686         MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD
  7687     ELSE
  7688         MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
  7689
  7690     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  7691     MOVE ZEROS                      TO CP-ALTERNATE-PREMIUM.
  7692     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA)
  7693                                     TO CP-SPECIAL-CALC-CD.
  7694     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
  7695     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
  7696     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
  7697     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
  7698     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  7699
  7700
  7701     MOVE GR-APR                     TO  CP-LOAN-APR
  7702     MOVE CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
  7703                                     TO CP-BEN-CATEGORY
  7704
  7705     IF (DTE-CLIENT = 'DCC')
  7706        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  7707        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) NOT = 'G' AND 'D')
  7708        MOVE 'S'                 TO CP-EARNING-METHOD
  7709     END-IF
  7710
  7711     IF (DTE-CLIENT = 'DCC')
  7712        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
  7713        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
  7714        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7715        CONTINUE
  7716     ELSE
  7717        GO TO 1020-CONTINUE-AH
  7718     END-IF
  7719
  7720     MOVE +0                     TO WS-DDF-ADMIN-FEES
  7721                                    WS-DDF-CSO-ADMIN-FEE
  7722                                    WS-DDF-MGT-FEE
  7723                                    WS-COMM-AND-MFEE
  7724                                    WS-DDF-1ST-YR-TOT-EXP
  7725
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 146
* ECS050.cbl
  7726     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
  7727        D1 > +10
  7728        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
  7729           AND (CR-LCOM-AH (D1) NUMERIC)
  7730           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7731              + (CR-LCOM-AH (D1) * +1000)
  7732        END-IF
  7733        IF (CR-AGT-TYPE (D1) = 'N')
  7734           AND (CR-LCOM-AH (D1) NUMERIC)
  7735           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
  7736              + (CR-LCOM-AH (D1) * +1000)
  7737        END-IF
  7738        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
  7739           AND (CR-LCOM-AH (D1) NUMERIC)
  7740           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
  7741              + (CR-LCOM-AH (D1) * +1000)
  7742        END-IF
  7743        IF (CR-AGT-TYPE (D1) = 'I')
  7744           AND (CR-LCOM-AH (D1) NUMERIC)
  7745           COMPUTE WS-DDF-MGT-FEE = WS-DDF-MGT-FEE
  7746              + (CR-LCOM-AH (D1) * +1000)
  7747           MOVE WS-DDF-MGT-FEE   TO WS-COMM-AND-MFEE
  7748        END-IF
  7749     END-PERFORM
  7750
  7751     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
  7752     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
  7753        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
  7754     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
  7755     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
  7756
  7757     IF CR-CERT-NO = WS-FACT-CERT
  7758        CONTINUE
  7759     ELSE
  7760        PERFORM 1100-GET-DDF-FACTORS THRU 1100-EXIT
  7761     END-IF
  7762
  7763     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
  7764        + WS-DDF-1ST-YR-TOT-EXP
  7765
  7766     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
  7767     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
  7768
  7769     MOVE CR-ADDL-CLP            TO WS-DDF-ADDL-CLP
  7770
  7771     MOVE 'D'                    TO CP-EARNING-METHOD
  7772     MOVE 'G'                    TO CP-DDF-SPEC-CALC
  7773     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
  7774     MOVE CR-AH-CLP              TO CP-DDF-CLP
  7775     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
  7776
  7777     IF GR-REIN = 'R'
  7778        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  7779        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
  7780        MOVE ZEROS               TO WS-DDF-ADDL-CLP
  7781                                    CP-1ST-YR-ALLOW
  7782     END-IF
  7783
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 147
* ECS050.cbl
  7784     IF DD-IU-PRESENT
  7785        MOVE 'I'              TO CP-EARNING-METHOD
  7786        display ' moving i to earn meth '
  7787     END-IF
  7788
  7789     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7790                                 CP-CLP-RATE-UP
  7791
  7792     IF (CP-CALC-GROSS-FEE)
  7793        AND (CP-IU-RATE-UP NOT = ZEROS)
  7794        COMPUTE TEX-FACT-8 = 1 - ((WS-DDF-ADDL-CLP + CR-AH-CLP)
  7795           / CP-ORIGINAL-PREMIUM)
  7796        COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7797           / (1 - TEX-FACT-8)
  7798     END-IF
  7799
  7800     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
  7801     MOVE AH-REM-TRM1                TO CP-REMAINING-TERM
  7802
  7803     .
  7804 1020-CONTINUE-AH.
  7805
  7806*    IF DTE-CLIENT = 'CID'
  7807*       IF CP-STATE-STD-ABBRV = 'OH'
  7808*          IF GR-LFTYP NOT = ZEROS AND SPACES
  7809*             IF (CLAS-I-EP (CLAS-INDEXL) = 'N' OR '5')
  7810*                         OR
  7811*                ((GR-LF-TERM > +60)
  7812*                 AND (GR-APR > ZEROS))
  7813*                MOVE '5'          TO CP-EARNING-METHOD
  7814*             END-IF
  7815*          END-IF
  7816*       END-IF
  7817*    END-IF
  7818
  7819
  7820     PERFORM 3100-CALC-UNEARNED-PREMIUM THRU 3199-EXIT
  7821
  7822
  7823     IF CP-ERROR-OCCURED
  7824         GO TO 1099-CALC-UNEARNED-X.
  7825
  7826     MOVE CP-R78-U-PRM               TO GRR-AHPRM.
  7827     MOVE CP-PRORATA-U-PRM           TO GRP-AHPRM.
  7828     MOVE CP-STATE-U-PRM             TO GRS-AHPRM.
  7829     MOVE CP-DOMICILE-U-PRM          TO GRD-AHPRM.
  7830
  7831     IF (DTE-CLIENT = 'DCC')
  7832        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
  7833        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
  7834        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7835        IF CP-DDF-SPEC-CALC = 'C'
  7836           COMPUTE UECLP-CLP-FACT = GRS-AHPRM / CR-AH-CLP
  7837        ELSE
  7838           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7839           MOVE CR-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7840           MOVE ZEROS            TO WS-DDF-ADDL-CLP
  7841                                    CP-1ST-YR-ALLOW
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 148
* ECS050.cbl
  7842           PERFORM 3100-CALC-UNEARNED-PREMIUM THRU 3199-EXIT
  7843           COMPUTE UECLP-CLP-FACT = CP-STATE-U-PRM / CR-AH-CLP
  7844           MOVE 'G' TO CP-DDF-SPEC-CALC
  7845           COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
  7846              + WS-DDF-1ST-YR-TOT-EXP
  7847        END-IF
  7848     END-IF
  7849
  7850     IF DTE-CLIENT = 'NCL'
  7851         MOVE GRP-AHPRM              TO GRD-AHPRM
  7852         IF GR-STATE = 'NM'  OR  'WI'
  7853             COMPUTE GRS-AHPRM = ((GRR-AHPRM + GRP-AHPRM) / 2)
  7854         ELSE
  7855             MOVE GRR-AHPRM          TO GRS-AHPRM.
  7856
  7857     IF DTE-CLIENT = 'NCL'
  7858        IF GR-EFF GREATER THAN 19941231
  7859           COMPUTE GRD-AHPRM = ((GRR-AHPRM + GRP-AHPRM) / 2).
  7860
  7861     IF (DTE-CLIENT = 'DCC')
  7862        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L')
  7863        IF CP-SPECIAL-CALC-CD = 'C'
  7864           MOVE GRP-AHPRM        TO GRS-AHPRM
  7865        ELSE
  7866           COMPUTE GRS-AHPRM = ((GRR-AHPRM + GRP-AHPRM) / 2)
  7867        END-IF
  7868     END-IF
  7869
  7870     MOVE WS-GR-AHCOM                TO CP-ORIGINAL-PREMIUM.
  7871     MOVE ZEROS                      TO CP-ALTERNATE-PREMIUM.
  7872
  7873     IF WS-GR-AHCOM > ZEROS
  7874        MOVE '1'                 TO CP-EARNING-METHOD
  7875        PERFORM 3100-CALC-UNEARNED-PREMIUM THRU 3199-EXIT
  7876     ELSE
  7877        MOVE ZEROS               TO CP-R78-U-PRM
  7878                                    CP-PRORATA-U-PRM
  7879                                    CP-STATE-U-PRM
  7880                                    CP-DOMICILE-U-PRM
  7881     END-IF
  7882
  7883
  7884     IF CP-ERROR-OCCURED
  7885         GO TO 1099-CALC-UNEARNED-X.
  7886
  7887     MOVE CP-R78-U-PRM               TO GRR-AHCOM.
  7888     MOVE CP-PRORATA-U-PRM           TO GRP-AHCOM.
  7889     MOVE CP-STATE-U-PRM             TO GRS-AHCOM.
  7890     MOVE CP-DOMICILE-U-PRM          TO GRD-AHCOM.
  7891
  7892     IF DTE-CLIENT = 'NCL'
  7893         MOVE GRP-AHCOM              TO GRD-AHCOM
  7894         IF GR-STATE = 'NM'  OR  'WI'
  7895             COMPUTE GRS-AHCOM = ((GRR-AHCOM + GRP-AHCOM) / 2)
  7896         ELSE
  7897             MOVE GRR-AHCOM          TO GRS-AHCOM.
  7898
  7899     IF DTE-CLIENT = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 149
* ECS050.cbl
  7900        IF GR-EFF GREATER THAN 19941231
  7901           COMPUTE GRD-AHCOM = ((GRR-AHCOM + GRP-AHCOM) / 2).
  7902
  7903     IF (DTE-CLIENT = 'DCC')
  7904        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  7905        IF CP-SPECIAL-CALC-CD = 'C'
  7906           MOVE GRP-AHCOM        TO GRS-AHCOM
  7907                                    GRD-AHCOM
  7908        ELSE
  7909           COMPUTE GRS-AHCOM = ((GRR-AHCOM + GRP-AHCOM) / 2)
  7910           MOVE GRS-AHCOM        TO GRD-AHCOM
  7911        END-IF
  7912     END-IF
  7913
  7914     IF (DTE-CLIENT = 'DCC')
  7915        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7916        AND (GR-REIN = 'P')
  7917        IF (WS-CHARGEBACK-SW (1) = 'N') OR
  7918           ((AM-COMM-CHARGEBACK (1) NOT = ZEROS) AND
  7919           (MONTHS-DIFF > AM-COMM-CHARGEBACK (1)))
  7920           CONTINUE
  7921        ELSE
  7922           COMPUTE CNC-FACT = GRP-AHPRM / GR-AHPRM
  7923           COMPUTE GRP-AHCOM ROUNDED = GRP-AHCOM +
  7924             ((GR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) * CNC-FACT)
  7925           DISPLAY ' GRP COMM AF C ' GRP-AHCOM
  7926           COMPUTE CNC-FACT = GRR-AHPRM / GR-AHPRM
  7927           COMPUTE GRR-AHCOM ROUNDED = GRR-AHCOM +
  7928             ((GR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) * CNC-FACT)
  7929           COMPUTE CNC-FACT = GRD-AHPRM / GR-AHPRM
  7930           COMPUTE GRD-AHCOM ROUNDED = GRD-AHCOM +
  7931             ((GR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) * CNC-FACT)
  7932           PERFORM 1110-CALC-DDF-UECOMM THRU 1110-EXIT
  7933           COMPUTE GRS-AHCOM = GRS-AHCOM + COMM-WK
  7934        END-IF
  7935     END-IF
  7936
  7937     IF DTE-CLIENT = 'DCC'
  7938        AND GR-REIN = 'P'
  7939        AND AM-DCC-PRODUCT-CODE = 'DDF'
  7940        AND WS-DDF-MGT-FEE NOT = ZEROS
  7941        COMPUTE CNC-FACT = GRR-AHPRM / GR-AHPRM
  7942        COMPUTE GRR-AHCOM ROUNDED = GRR-AHCOM +
  7943          (WS-DDF-MGT-FEE * CNC-FACT)
  7944        COMPUTE CNC-FACT = GRP-AHPRM / GR-AHPRM
  7945        COMPUTE GRP-AHCOM ROUNDED = GRP-AHCOM +
  7946          (WS-DDF-MGT-FEE * CNC-FACT)
  7947        COMPUTE CNC-FACT = GRD-AHPRM / GR-AHPRM
  7948        COMPUTE GRD-AHCOM ROUNDED = GRD-AHCOM +
  7949          (WS-DDF-MGT-FEE * CNC-FACT)
  7950        PERFORM 1120-CALC-DDF-UEMGTFEE THRU 1120-EXIT
  7951        COMPUTE GRS-AHCOM = GRS-AHCOM + COMM-WK
  7952     END-IF
  7953
  7954     IF DTE-CLIENT = 'DCC'
  7955        AND GR-REIN = 'P'
  7956        AND AM-DCC-PRODUCT-CODE = 'DDF'
  7957        AND WS-DDF-CSO-ADMIN-FEE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 150
* ECS050.cbl
  7958        CONTINUE
  7959     ELSE
  7960        GO TO 1030-CONTINUE-AH
  7961     END-IF
  7962
  7963     PERFORM 1130-CALC-DDF-UECSO-ADMFEE THRU 1130-EXIT
  7964
  7965*    COMPUTE TEX-FACT-8 ROUNDED = WS-GR-AHCOM / GR-AHPRM
  7966*    COMPUTE GRS-AHCOM = GRS-AHPRM * TEX-FACT-8
  7967*    COMPUTE GRS-AHCOM = WS-GR-AHCOM / GR-AHPRM
  7968*       * GRS-AHPRM
  7969*    display ' grs-ahcom after compute ' grs-ahcom
  7970
  7971*    MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-ORIGINAL-PREMIUM
  7972*    PERFORM 3100-CALC-UNEARNED-PREMIUM
  7973*                                THRU 3199-EXIT
  7974
  7975*    IF CP-ERROR-OCCURED
  7976*       DISPLAY ' PROBLEM WITH CSO ADMIN FEE UNEARN '
  7977*       GO TO 1030-CONTINUE-AH
  7978*    END-IF
  7979
  7980     COMPUTE CNC-FACT = GRR-AHPRM / GR-AHPRM
  7981     COMPUTE GRR-AHCOM ROUNDED = GRR-AHCOM +
  7982          (WS-DDF-CSO-ADMIN-FEE * CNC-FACT)
  7983     COMPUTE CNC-FACT = GRP-AHPRM / GR-AHPRM
  7984     COMPUTE GRP-AHCOM ROUNDED = GRP-AHCOM +
  7985          (WS-DDF-CSO-ADMIN-FEE * CNC-FACT)
  7986     COMPUTE CNC-FACT = GRD-AHPRM / GR-AHPRM
  7987     COMPUTE GRD-AHCOM ROUNDED = GRD-AHCOM +
  7988          (WS-DDF-CSO-ADMIN-FEE * CNC-FACT)
  7989
  7990     COMPUTE GRS-AHCOM = GRS-AHCOM + COMM-WK
  7991
  7992     .
  7993 1030-CONTINUE-AH.
  7994
  7995     COMPUTE GRP-AHTAX ROUNDED =
  7996*         GRP-AHPRM * AM-REI-AH-TAX.
  7997          GRP-AHPRM * CR-AH-ISS-PREM-TAX
  7998
  7999     COMPUTE GRR-AHTAX ROUNDED =
  8000*         GRR-AHPRM * AM-REI-AH-TAX.
  8001          GRR-AHPRM * CR-AH-ISS-PREM-TAX
  8002     .
  8003 1099-CALC-UNEARNED-X.
  8004     EXIT.
  8005
  8006 1100-GET-DDF-FACTORS.
  8007
  8008     MOVE ' ' TO DD-IU-SW
  8009     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
  8010        ((CR-STATE = DD-STATE (D1))
  8011        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
  8012        AND ('A'           = DD-BEN-TYPE   (D1))
  8013        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
  8014        AND (WS-BIN-CR-DT < DD-PROD-EXP-DT (D1)))
  8015                        OR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 151
* ECS050.cbl
  8016        D1 > max-pdef
  8017     END-PERFORM
  8018     IF D1 > max-pdef
  8019        DISPLAY ' COULD NOT FIND UEP FACTORS '
  8020        GO TO 1100-EXIT
  8021     END-IF
  8022
  8023     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8024        (P1 > +8)
  8025        OR (DD-PROD-CODE (D1 P1) = 'I')
  8026     END-PERFORM
  8027     IF P1 < +9
  8028        SET DD-IU-PRESENT        TO TRUE
  8029     END-IF
  8030
  8031     MOVE CR-AH-TERM             TO WS-DDF-TERM
  8032     IF (CR-LOAN-TERM > WS-DDF-TERM)
  8033        AND (DD-TRUNCATED (D1) = 'Y')
  8034        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
  8035        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
  8036     END-IF
  8037
  8038     EVALUATE TRUE
  8039        WHEN WS-DDF-TERM > +168
  8040           MOVE 15               TO P1
  8041        WHEN WS-DDF-TERM > +156
  8042           MOVE 14               TO P1
  8043        WHEN WS-DDF-TERM > +144
  8044           MOVE 13               TO P1
  8045        WHEN WS-DDF-TERM > +132
  8046           MOVE 12               TO P1
  8047        WHEN WS-DDF-TERM > +120
  8048           MOVE 11               TO P1
  8049        WHEN WS-DDF-TERM > +108
  8050           MOVE 10               TO P1
  8051        WHEN WS-DDF-TERM > +96
  8052           MOVE 9                TO P1
  8053        WHEN WS-DDF-TERM > +84
  8054           MOVE 8                TO P1
  8055        WHEN WS-DDF-TERM > +72
  8056           MOVE 7                TO P1
  8057        WHEN WS-DDF-TERM > +60
  8058           MOVE 6                TO P1
  8059        WHEN WS-DDF-TERM > +48
  8060           MOVE 5                TO P1
  8061        WHEN WS-DDF-TERM > +36
  8062           MOVE 4                TO P1
  8063        WHEN WS-DDF-TERM > +24
  8064           MOVE 3                TO P1
  8065        WHEN WS-DDF-TERM > +12
  8066           MOVE 2                TO P1
  8067        WHEN OTHER
  8068           MOVE 1                TO P1
  8069     END-EVALUATE
  8070
  8071     EVALUATE TRUE
  8072*       WHEN ((CR-AH-TERM - AH-REM-TRM1) < +13)
  8073*          AND (DD-IU-PRESENT)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 152
* ECS050.cbl
  8074*          MOVE 2                TO P2
  8075*       WHEN (CR-AH-TERM - AH-REM-TRM1) < +13
  8076*          MOVE 1                TO P2
  8077        WHEN (CR-AH-TERM - AH-REM-TRM1) < +25
  8078           MOVE 2                TO P2
  8079        WHEN (CR-AH-TERM - AH-REM-TRM1) < +37
  8080           MOVE 3                TO P2
  8081        WHEN (CR-AH-TERM - AH-REM-TRM1) < +49
  8082           MOVE 4                TO P2
  8083        WHEN (CR-AH-TERM - AH-REM-TRM1) < +61
  8084           MOVE 5                TO P2
  8085        WHEN (CR-AH-TERM - AH-REM-TRM1) < +73
  8086           MOVE 6                TO P2
  8087        WHEN (CR-AH-TERM - AH-REM-TRM1) < +85
  8088           MOVE 7                TO P2
  8089        WHEN (CR-AH-TERM - AH-REM-TRM1) < +97
  8090           MOVE 8                TO P2
  8091        WHEN (CR-AH-TERM - AH-REM-TRM1) < +109
  8092           MOVE 9                TO P2
  8093        WHEN (CR-AH-TERM - AH-REM-TRM1) < +121
  8094           MOVE 10               TO P2
  8095        WHEN (CR-AH-TERM - AH-REM-TRM1) < +133
  8096           MOVE 11               TO P2
  8097        WHEN (CR-AH-TERM - AH-REM-TRM1) < +145
  8098           MOVE 12               TO P2
  8099        WHEN (CR-AH-TERM - AH-REM-TRM1) < +157
  8100           MOVE 13               TO P2
  8101        WHEN (CR-AH-TERM - AH-REM-TRM1) < +169
  8102           MOVE 14               TO P2
  8103        WHEN OTHER
  8104           MOVE 15               TO P2
  8105     END-EVALUATE
  8106
  8107     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1) TO WS-LO-UEF
  8108     MOVE DD-UEP-FACTOR (D1 P1 P2)     TO WS-HI-UEF
  8109     MOVE CR-CERT-NO             TO WS-FACT-CERT
  8110
  8111
  8112     .
  8113 1100-EXIT.
  8114     EXIT.
  8115
  8116 1110-CALC-DDF-UECOMM.
  8117
  8118     IF CR-CERT-NO = WS-FACT-CERT
  8119        DISPLAY ' FACT ALREADY FOUND IN 1110 ' CR-CERT-NO
  8120     ELSE
  8121        PERFORM 1100-GET-DDF-FACTORS
  8122                                 THRU 1100-EXIT
  8123     END-IF
  8124
  8125     COMPUTE WS-MONTH =
  8126        FUNCTION REM(CR-AH-TERM - AH-REM-TRM1, 12)
  8127     IF WS-MONTH = 0
  8128        MOVE 12 TO WS-MONTH
  8129     END-IF
  8130
  8131     MOVE ZEROS                  TO COMM-WK
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 153
* ECS050.cbl
  8132
  8133     EVALUATE TRUE
  8134        WHEN CR-CANCEL-REASON = 'R'
  8135           COMPUTE COMM-WK =  (CR-AHPRM - CR-AH-CLP
  8136              - CR-ADDL-CLP)
  8137        WHEN ((CR-AH-TERM - AH-REM-TRM1) < 4)
  8138           OR (NOT DD-IU-PRESENT)
  8139              COMPUTE COMM-WK = UECLP-CLP-FACT *
  8140                 (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
  8141        WHEN (CR-AH-TERM - AH-REM-TRM1) < 13
  8142            COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
  8143               CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
  8144               WS-LO-UEF) * 3 / 12
  8145            DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  8146            COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
  8147            COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
  8148                 (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
  8149            DISPLAY ' UECOMMO3 ' WS-COMM-MO3
  8150            COMPUTE COMM-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  8151              (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
  8152              WS-HI-UEF) * (WS-MONTH - 3) / 9
  8153        WHEN (CR-AH-TERM - AH-REM-TRM1) > 12
  8154           COMPUTE COMM-WK = (CR-AHPRM - CR-AH-CLP -
  8155              CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
  8156              WS-LO-UEF) * WS-MONTH / 12)
  8157     END-EVALUATE
  8158
  8159     .
  8160 1110-EXIT.
  8161     EXIT.
  8162
  8163 1120-CALC-DDF-UEMGTFEE.
  8164
  8165     IF CR-CERT-NO = WS-FACT-CERT
  8166        DISPLAY ' FACT ALREADY FOUND IN 1120 ' CR-CERT-NO
  8167     ELSE
  8168        PERFORM 1100-GET-DDF-FACTORS
  8169                                 THRU 1100-EXIT
  8170     END-IF
  8171
  8172     MOVE ZEROS                  TO COMM-WK
  8173
  8174     COMPUTE WS-MONTH =
  8175        FUNCTION REM(CR-AH-TERM - AH-REM-TRM1, 12)
  8176     IF WS-MONTH = 0
  8177        MOVE 12 TO WS-MONTH
  8178     END-IF
  8179
  8180     EVALUATE TRUE
  8181        WHEN CR-CANCEL-REASON = 'R'
  8182           MOVE WS-DDF-MGT-FEE   TO COMM-WK
  8183        WHEN ((CR-AH-TERM - AH-REM-TRM1) < 4)
  8184              OR (NOT DD-IU-PRESENT)
  8185              COMPUTE COMM-WK = UECLP-CLP-FACT * WS-DDF-MGT-FEE
  8186            WHEN (CR-AH-TERM - AH-REM-TRM1) < 13
  8187               COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
  8188                  CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
  8189                  WS-LO-UEF) * 3 / 12
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 154
* ECS050.cbl
  8190               DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  8191               COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
  8192               COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
  8193                  WS-DDF-MGT-FEE
  8194               DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
  8195               COMPUTE COMM-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  8196                  WS-DDF-MGT-FEE * WS-HI-UEF) *
  8197                  (WS-MONTH - 3) / 9
  8198           WHEN (CR-AH-TERM - AH-REM-TRM1) > 12
  8199              COMPUTE COMM-WK = WS-DDF-MGT-FEE *
  8200                 (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
  8201                 WS-MONTH / 12)
  8202        END-EVALUATE
  8203
  8204     .
  8205 1120-EXIT.
  8206     EXIT.
  8207
  8208 1130-CALC-DDF-UECSO-ADMFEE.
  8209
  8210     IF CR-CERT-NO = WS-FACT-CERT
  8211        DISPLAY ' FACT ALREADY FOUND IN 1130 ' CR-CERT-NO
  8212     ELSE
  8213        PERFORM 1100-GET-DDF-FACTORS
  8214                                 THRU 1100-EXIT
  8215     END-IF
  8216
  8217     COMPUTE WS-MONTH =
  8218        FUNCTION REM(CR-AH-TERM - AH-REM-TRM1, 12)
  8219     IF WS-MONTH = 0
  8220        MOVE 12 TO WS-MONTH
  8221     END-IF
  8222
  8223     MOVE ZEROS                  TO COMM-WK
  8224
  8225     EVALUATE TRUE
  8226        WHEN (AH-REM-TRM1 = 0)
  8227           OR (CR-CANCEL-REASON = 'R')
  8228           DISPLAY ' REM TERM = 0 OR REPO'
  8229           MOVE 0                TO COMM-WK
  8230
  8231        WHEN AH-REM-TRM1 = CR-AH-TERM
  8232           DISPLAY ' REM TERM  = ORIG TERM '
  8233           MOVE WS-DDF-CSO-ADMIN-FEE TO COMM-WK
  8234
  8235        WHEN (CR-AH-TERM - AH-REM-TRM1) < 4
  8236           DISPLAY ' ORIG TERM - REM TRM < 4 '
  8237           COMPUTE CNC-FACT ROUNDED = WS-DDF-CSO-ADMIN-FEE -
  8238              (DD-1ST-YR-ALLOW (D1)
  8239              * WS-MONTH / 3) - (WS-DDF-CSO-ADMIN-FEE -
  8240              DD-1ST-YR-ALLOW (D1))
  8241              * (1 - WS-HI-UEF) * WS-MONTH / 12
  8242           COMPUTE COMM-WK = CNC-FACT * 1
  8243
  8244**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
  8245
  8246        WHEN (CR-AH-TERM - AH-REM-TRM1) < 13
  8247           DISPLAY ' ORIG TERM - REM TRM < 13 '
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 155
* ECS050.cbl
  8248           COMPUTE CNC-FACT ROUNDED = (WS-DDF-CSO-ADMIN-FEE -
  8249              DD-1ST-YR-ALLOW (D1))
  8250              - (WS-DDF-CSO-ADMIN-FEE - DD-1ST-YR-ALLOW (D1))
  8251              * (1 - WS-hi-UEF) * WS-MONTH / 12
  8252           COMPUTE COMM-WK = CNC-FACT * 1
  8253
  8254****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
  8255
  8256        WHEN OTHER
  8257           DISPLAY ' OTHER '
  8258           COMPUTE CNC-FACT ROUNDED = (WS-DDF-CSO-ADMIN-FEE -
  8259              DD-1ST-YR-ALLOW (D1))
  8260              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
  8261              * WS-MONTH / 12)
  8262           COMPUTE COMM-WK = CNC-FACT * 1
  8263     END-EVALUATE
  8264
  8265     .
  8266 1130-EXIT.
  8267     EXIT.
  8268
  8269 2000-CALC-REM-AMT.
  8270
  8271     IF (DTE-CLIENT = 'ABL') AND (GR-CARRIER NOT EQUAL '2')
  8272         IF (CR-SEX = 'F') AND
  8273            (GR-MORT-AGE GREATER +22) AND
  8274            (CR-MORT = 'E550' OR 'F550')
  8275                COMPUTE GR-AGE = GR-AGE - +6.
  8276
  8277     IF (DTE-CLIENT EQUAL 'NCL') AND
  8278        (O-B-CERTIFICATE)
  8279        COMPUTE GR-REM-AMT EQUAL GR-LFBEN * .5
  8280        GO TO 2999-CALC-REM-AMT-X.
  8281
  8282****************************************************************
  8283*  THIS LOGIC ALLOWS THE CLIENT TO CONTROL THE AGE CALCULATION *
  8284*  ROUTINE THROUGH A COMPANY LEVEL CONTROL.  OPTIONS ALLOW THE *
  8285*  CLIENT TO 1) USE THE AGE METHOD ASSIGNED TO THE TABLE WHEN  *
  8286*  WHEN IT WAS GENERATED, 2) USE AGE-LAST, 3) USE AGE-NEAR.    *
  8287****************************************************************
  8288
  8289     IF  DTE-USE-ALL-AGE-LAST
  8290         COMPUTE GR-MORT-AGE =
  8291             GR-AGE + ((GR-LF-TERM - GR-LF-REMTERM) / +12)
  8292
  8293     ELSE
  8294         IF  DTE-USE-ALL-AGE-NEAR
  8295             COMPUTE GR-MORT-AGE ROUNDED =
  8296                 GR-AGE + ((GR-LF-TERM - GR-LF-REMTERM) / +12)
  8297
  8298         ELSE
  8299             IF  DTE-USE-TABLE-ASSIGNED-METHOD
  8300                 SET CLAS-MORT-NDX TO +1
  8301                 SEARCH CLAS-MORT-FLD
  8302                     VARYING CLAS-MORT-NDX
  8303
  8304                     AT END
  8305******THIS IS A DEFAULT TO AGE LAST FOR A TABLE MISSING****
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 156
* ECS050.cbl
  8306******ECS080 SHOULD REPORT THE MISSING TABLE           ****
  8307                         COMPUTE GR-MORT-AGE = GR-AGE +
  8308                             ((GR-LF-TERM - GR-LF-REMTERM) / +12)
  8309
  8310                     WHEN
  8311                         CLAS-MORT-CODE (CLAS-MORT-NDX)
  8312                             EQUAL GR-MORT-CODE
  8313                         PERFORM 2040-DETERMINE-AGE-METHOD
  8314                             THRU 2040-EXIT.
  8315
  8316     ADD +1                      TO W-PASS-CTR.
  8317
  8318     IF DTE-CLIENT = 'DAC' OR 'BPI'
  8319         IF CR-SEX = 'F'
  8320             COMPUTE GR-MORT-AGE = GR-MORT-AGE - +6.
  8321
  8322     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  8323         MOVE GR-LFBEN TO GR-REM-AMT
  8324         GO TO 2999-CALC-REM-AMT-X.
  8325
  8326     if dte-client = 'CID'
  8327        IF GR-LFTYP = 'QD'
  8328*          MOVE +15.0            TO CP-LOAN-APR  (PAUL CHANGE)
  8329           MOVE +15.0            TO GR-APR
  8330        END-IF
  8331     END-IF
  8332
  8333     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  8334           GR-REIN = 'P'
  8335        COMPUTE INTERMED ROUNDED = CR-LFAMT / GR-LF-TERM
  8336     ELSE
  8337        if dte-client = 'AHL'
  8338           COMPUTE INTERMED ROUNDED = GR-LFBEN / GR-LOAN-TERM
  8339        ELSE
  8340           COMPUTE INTERMED ROUNDED = GR-LFBEN / GR-LF-TERM
  8341        END-IF
  8342     END-IF
  8343
  8344     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')  AND
  8345        GR-REIN = 'R'
  8346         COMPUTE INTERMED ROUNDED EQUAL
  8347             (CR-LFAMT * WS-CEDE-FACT) / GR-LF-TERM.
  8348
  8349     MOVE INTERMED                    TO GR-MO-DEC.
  8350
  8351     IF GR-LF-REMTERM = GR-LF-TERM
  8352         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  8353            (GR-REIN = 'R')
  8354             NEXT SENTENCE
  8355         ELSE
  8356             MOVE GR-LFBEN TO GR-REM-AMT
  8357             GO TO 2999-CALC-REM-AMT-X.
  8358
  8359*    IF GR-SUMMARY-REC  OR
  8360*       (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  8361*        GO TO 2010-ORDINARY-REM.
  8362
  8363     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 157
* ECS050.cbl
  8364         GO TO 2010-ORDINARY-REM.
  8365
  8366     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  8367         GO TO 2020-CALC-TEXAS-REM.
  8368
  8369     IF DTE-CLIENT = 'NCL'
  8370         IF GR-EFF LESS THAN 19910101
  8371             GO TO 2010-ORDINARY-REM.
  8372
  8373     IF GR-LFTYP = 'QD'
  8374*       MOVE +15.0               TO CP-LOAN-APR  (PAUL CHANGE)
  8375        MOVE +15.0               TO GR-APR
  8376        MOVE 'N'           TO CLAS-I-CALC-TYPE (CLAS-INDEXL)
  8377        GO TO 2030-CALC-NET-PAY-REM
  8378     END-IF
  8379
  8380     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  8381         GO TO 2030-CALC-NET-PAY-REM.
  8382
  8383*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  8384     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  8385        (CR-RATING-CLASS NOT = 'L ')
  8386         IF (GR-LF-TERM GREATER THAN +60) AND
  8387            (GR-EFF GREATER THAN 19831031) AND
  8388            (GR-APR GREATER THAN ZERO)
  8389             GO TO 2030-CALC-NET-PAY-REM.
  8390
  8391     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  8392         IF (GR-LF-TERM GREATER THAN +61) AND
  8393            (GR-EFF GREATER THAN 19830318) AND
  8394            (GR-APR GREATER THAN ZERO)
  8395             GO TO 2030-CALC-NET-PAY-REM.
  8396
  8397     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  8398         IF (GR-LF-TERM GREATER THAN +62) AND
  8399            (GR-EFF GREATER THAN 19810831) AND
  8400            (GR-EFF LESS THAN 19830901) AND
  8401            (GR-APR GREATER THAN ZERO)
  8402             GO TO 2030-CALC-NET-PAY-REM.
  8403
  8404     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  8405         IF (GR-LF-TERM GREATER THAN +60) AND
  8406            (GR-EFF GREATER THAN 19831231) AND
  8407            (GR-APR GREATER THAN ZERO)
  8408             GO TO 2030-CALC-NET-PAY-REM.
  8409
  8410 2010-ORDINARY-REM.
  8411
  8412     if dte-client = 'AHL'
  8413        if gr-loan-term > gr-lf-term
  8414           compute gr-rem-amt = intermed *
  8415           (gr-lf-remterm +
  8416              (gr-loan-term - gr-lf-term))
  8417           go to 2999-calc-rem-amt-x
  8418        end-if
  8419     end-if
  8420
  8421     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')  AND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 158
* ECS050.cbl
  8422        GR-REIN = 'P'
  8423         COMPUTE GR-REM-AMT ROUNDED =
  8424                        (INTERMED * GR-LF-REMTERM) + CR-LFAMT-ALT
  8425     ELSE
  8426         COMPUTE GR-REM-AMT ROUNDED = INTERMED * GR-LF-REMTERM.
  8427
  8428     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')  AND
  8429        GR-REIN = 'R'
  8430         COMPUTE GR-REM-AMT ROUNDED EQUAL
  8431            (INTERMED * GR-LF-REMTERM) +
  8432            (CR-LFAMT-ALT * WS-CEDE-FACT).
  8433
  8434     GO TO 2999-CALC-REM-AMT-X.
  8435
  8436 2020-CALC-TEXAS-REM.
  8437     DIVIDE GR-LFBEN BY GR-LF-TERM
  8438         GIVING TEX-FACT-1.
  8439     DIVIDE LF-REM-TRM2 BY GR-PMT-FREQ
  8440         GIVING TEX-FACT-2
  8441         REMAINDER TEX-FACT-3.
  8442
  8443     IF TEX-FACT-3 NOT = ZERO
  8444         ADD +1 TO TEX-FACT-2.
  8445
  8446     IF (TEX-FACT-2 * GR-PMT-FREQ) = GR-LF-TERM
  8447         MOVE GR-LFBEN TO GR-REM-AMT
  8448     ELSE
  8449         COMPUTE GR-REM-AMT ROUNDED =
  8450             (TEX-FACT-1 * (TEX-FACT-2 * GR-PMT-FREQ)).
  8451
  8452     GO TO 2999-CALC-REM-AMT-X.
  8453
  8454 2030-CALC-NET-PAY-REM.
  8455
  8456     MOVE GR-EFF                     TO  DC-GREG-DATE-CYMD
  8457     MOVE 'L'                        TO  DC-OPTION-CODE.
  8458     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT.
  8459     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
  8460
  8461     IF CR-LOAN-1ST-PMT-DT IS NOT EQUAL TO ZEROS
  8462         MOVE CR-LOAN-1ST-PMT-DT     TO  DC-GREG-DATE-1-YMD
  8463         MOVE '3'                    TO  DC-OPTION-CODE
  8464         PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8465         MOVE DC-BIN-DATE-1          TO  CP-FIRST-PAY-DATE
  8466     ELSE
  8467         MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1
  8468         MOVE +1                     TO  DC-ELAPSED-MONTHS
  8469         MOVE +0                     TO  DC-ELAPSED-DAYS
  8470         MOVE '6'                    TO  DC-OPTION-CODE
  8471         PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8472         MOVE DC-BIN-DATE-2          TO  CP-FIRST-PAY-DATE.
  8473
  8474     MOVE GR-LFBEN                   TO  CP-ORIGINAL-BENEFIT.
  8475     MOVE GR-APR                     TO  CP-LOAN-APR.
  8476
  8477     if dte-client = 'AHL'
  8478        MOVE +14                 TO CP-LOAN-APR
  8479     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 159
* ECS050.cbl
  8480
  8481     MOVE GR-LF-TERM                 TO  CP-ORIGINAL-TERM.
  8482     MOVE GR-LOAN-TERM               TO  CP-LOAN-TERM.
  8483     MOVE LF-REM-TRM2                TO  CP-REMAINING-TERM.
  8484     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO CP-SPECIAL-CALC-CD.
  8485     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  8486     MOVE CLAS-I-EP (CLAS-INDEXL)    TO  CP-EARNING-METHOD.
  8487
  8488     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
  8489     IF (DTE-CLIENT = 'DCC')
  8490        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  8491        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
  8492           ((CR-STATE = DD-STATE (D1))
  8493           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
  8494           AND ('A'           = DD-BEN-TYPE   (D1))
  8495           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
  8496           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
  8497                           OR
  8498           D1 > max-pdef
  8499        END-PERFORM
  8500        IF D1 <= max-pdef
  8501           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8502              (P1 > +8)
  8503              OR (DD-PROD-CODE (D1 P1) = 'L')
  8504           END-PERFORM
  8505           IF P1 < +9
  8506              MOVE DD-MAX-BEN-AMT (D1 P1)
  8507                                 TO CP-R-MAX-TOT-BEN
  8508           END-IF
  8509        END-IF
  8510     END-IF
  8511
  8512     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  8513
  8514     MOVE CP-REMAINING-AMT           TO  GR-REM-AMT.
  8515
  8516     GO TO 2999-CALC-REM-AMT-X.
  8517
  8518 2040-DETERMINE-AGE-METHOD.
  8519
  8520     IF DTE-CLIENT EQUAL 'ACM'
  8521             COMPUTE GR-MORT-AGE EQUAL
  8522                 GR-AGE + ((GR-LF-TERM - GR-LF-REMTERM) / +12)
  8523     ELSE
  8524     IF  CLAS-AGE-METHOD (CLAS-MORT-NDX) EQUAL 'AL'
  8525         COMPUTE GR-MORT-AGE =
  8526             GR-AGE + ((GR-LF-TERM - GR-LF-REMTERM) / +12)
  8527
  8528     ELSE
  8529         IF  CLAS-AGE-METHOD (CLAS-MORT-NDX) EQUAL 'AN'
  8530             COMPUTE GR-MORT-AGE ROUNDED =
  8531                 GR-AGE + ((GR-LF-TERM - GR-LF-REMTERM) / +12).
  8532
  8533
  8534 2040-EXIT.
  8535     EXIT.
  8536
  8537 2999-CALC-REM-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 160
* ECS050.cbl
  8538     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 161
* ECS050.cbl
  8540 3000-RE-RATE-AH-ROUTINE.
  8541
  8542     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  8543     MOVE 'L'                        TO DC-OPTION-CODE.
  8544     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8545     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  8546     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  8547     MOVE SPACES                     TO CP-ACCT-FLD-5.
  8548     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  8549     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  8550     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  8551     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  8552     MOVE GR-AH-UP-REMTERM           TO CP-ORIGINAL-TERM.
  8553     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
  8554                                        CP-RATING-BENEFIT-AMT.
  8555     IF CP-STATE-STD-ABBRV = 'OR'
  8556         COMPUTE CP-RATING-BENEFIT-AMT =
  8557                                  CR-AHAMT * GR-AH-UP-REMTERM.
  8558     MOVE CR-APR                     TO CP-LOAN-APR.
  8559     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
  8560     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
  8561     MOVE '3'                        TO CP-PROCESS-TYPE.
  8562     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  8563     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
  8564     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  8565         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
  8566     ELSE
  8567         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
  8568     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
  8569     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
  8570     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  8571     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  8572     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
  8573     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
  8574
  8575
  8576 3090-CALL-RATING-ROUTINE.
  8577
  8578     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  8579
  8580 3099-EXIT.
  8581     EXIT.
  8582 3100-CALC-UNEARNED-PREMIUM.
  8583
  8584     MOVE CR-DT                      TO DC-GREG-DATE-CYMD
  8585     MOVE 'L'                        TO DC-OPTION-CODE.
  8586     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8587     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  8588
  8589     MOVE BIN-RUN-DATE               TO CP-VALUATION-DT.
  8590
  8591     MOVE DTE-R78                    TO CP-R78-OPTION.
  8592     MOVE SPACES                     TO CP-ACCT-FLD-5.
  8593     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  8594     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  8595     MOVE CR-APR                     TO CP-LOAN-APR.
  8596     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
  8597     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 162
* ECS050.cbl
  8598     MOVE DOMICILE-STATE             TO CP-DOMICILE-STATE.
  8599     MOVE GR-CARRIER                 TO CP-CARRIER.
  8600
  8601     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  8602         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
  8603     ELSE
  8604         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
  8605     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  8606     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  8607     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  8608     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  8609
  8610
  8611 3190-CALL-UNEARNED-ROUTINE.
  8612
  8613     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA.
  8614
  8615 3199-EXIT.
  8616     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 163
* ECS050.cbl
  8618 4000-REINSURE-ROUTINE.
  8619     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  8620
  8621     IF CR-REIN-TABLE = SPACES OR ZEROS
  8622         GO TO 4020-REINSURE-ROUTINE-SKIP-1.
  8623
  8624     MOVE CR-REIN-TABLE TO REIN-SRCH.
  8625
  8626     PERFORM 4800-RR-READ-REIN THRU 4899-RR-READ-REIN-X.
  8627
  8628     IF RE-REMAINING (1) NOT = 'I'
  8629         GO TO 4010-REINSURE-ROUTINE-GET-CALC.
  8630
  8631     MOVE ZEROS                     TO REIN-EARN-LF-TERM
  8632                                       REIN-EARN-AH-TERM.
  8633
  8634     MOVE WS-BIN-CR-DT              TO DC-BIN-DATE-1.
  8635     MOVE WS-BIN-VAL-DT             TO DC-BIN-DATE-2.
  8636     MOVE '1'                       TO DC-OPTION-CODE.
  8637     MOVE ' '                       TO DC-CENTURY-ADJUSTMENT.
  8638     MOVE ZEROS                     TO DC-ELAPSED-MONTHS
  8639                                       DC-ODD-DAYS-OVER
  8640                                       DC-ELAPSED-DAYS.
  8641     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT.
  8642
  8643     IF CR-LFTYP NOT = ZEROS  AND  SPACES
  8644         IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
  8645             MOVE CR-LF-TERM        TO REIN-EARN-LF-TERM
  8646         ELSE
  8647             MOVE DC-ELAPSED-MONTHS TO REIN-EARN-LF-TERM.
  8648
  8649     IF CR-AHTYP NOT = ZEROS  AND  SPACES
  8650         IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
  8651             MOVE CR-AH-TERM        TO REIN-EARN-AH-TERM
  8652         ELSE
  8653             MOVE DC-ELAPSED-MONTHS TO REIN-EARN-AH-TERM.
  8654
  8655
  8656 4010-REINSURE-ROUTINE-GET-CALC.
  8657
* 8658                             COPY ECSRTPFM.
  8659******************************************************************07/10/97
  8660*                                                                *ECSRTPFM
  8661*                            ECSRTPFM                            *   LV001
  8662*                            VMOD=2.002                          *ECSRTPFM
  8663*                                                                *ECSRTPFM
  8664******************************************************************ECSRTPFM
  8665                                                                  ECSRTPFM
  8666     IF    CR-LFAMT  NUMERIC                                      00000072
  8667           NEXT SENTENCE                                          00000073
  8668        ELSE                                                      00000074
  8669           MOVE ZEROS TO CR-LFAMT.                                00000075
  8670                                                                  00000076
  8671     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  8672           NEXT SENTENCE                                          00000078
  8673        ELSE                                                      00000079
  8674           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  8675                                                                  00000081
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 164
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  8676                                                                  00000082
  8677     IF    CR-LFPRM  NUMERIC                                      00000083
  8678           NEXT SENTENCE                                          00000084
  8679        ELSE                                                      00000085
  8680           MOVE ZEROS TO CR-LFPRM.                                00000086
  8681                                                                  00000087
  8682     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  8683           NEXT SENTENCE                                          00000089
  8684        ELSE                                                      00000090
  8685           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  8686                                                                  00000092
  8687                                                                  00000093
  8688     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  8689           NEXT SENTENCE                                          00000095
  8690        ELSE                                                      00000096
  8691           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  8692                                                                  00000098
  8693     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  8694           NEXT SENTENCE                                          00000100
  8695        ELSE                                                      00000101
  8696           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  8697                                                                  00000103
  8698     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
  8699           NEXT SENTENCE                                          00000105
  8700        ELSE                                                      00000106
  8701           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  8702                                                                  00000108
  8703     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  8704     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  8705     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  8706         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
  8707     ELSE                                                         ECSRTPFM
  8708         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  8709     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  8710                                                                  ECSRTPFM
  8711     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  8712     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  8713     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  8714         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  8715     ELSE                                                         ECSRTPFM
  8716         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
  8717     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  8718                                                                  ECSRTPFM
  8719     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  8720         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  8721             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  8722                                                                  ECSRTPFM
  8723
  8724 4020-REINSURE-ROUTINE-SKIP-1.
  8725     MOVE +1 TO SUB1.
  8726
  8727 4030-REINSURE-ROUTINE-BLD-GAAP.
  8728     IF REIN-COMP (SUB1) = SPACES
  8729         GO TO 4099-REINSURE-ROUTINE-X.
  8730
  8731     IF REIN-REM-SW (SUB1) = 'Z'
  8732         ADD +1 TO SUB1
  8733         GO TO 4030-REINSURE-ROUTINE-BLD-GAAP.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 165
* ECS050.cbl
  8734
  8735     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  8736         ADD +1 TO SUB1
  8737         GO TO 4030-REINSURE-ROUTINE-BLD-GAAP.
  8738
  8739     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
  8740         VARYING CO-SUB FROM +1 BY +1 UNTIL
  8741           (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))   OR
  8742           (CO-SUB GREATER THAN REIN-CO-TABLE-ENT-CNT) OR
  8743           (RCT-REIN-CO (CO-SUB) = SPACES).
  8744
  8745     IF (CO-SUB GREATER THAN REIN-CO-TABLE-ENT-CNT)  OR
  8746        (RCT-REIN-CO (CO-SUB) = SPACES)
  8747         MOVE ZEROS          TO CO-SUB.
  8748
  8749     MOVE ZEROS              TO ERN-START-DATE.
  8750
  8751     IF CO-SUB NOT = ZEROS
  8752       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZEROS
  8753         MOVE RCT-EARNING-START-DT (CO-SUB)
  8754                             TO DC-GREG-DATE-CYMD
  8755         MOVE 'L'            TO DC-OPTION-CODE
  8756         PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8757         MOVE +0             TO DC-ELAPSED-MONTHS
  8758         MOVE -1             TO DC-ELAPSED-DAYS
  8759         MOVE '6'            TO DC-OPTION-CODE
  8760         PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8761         MOVE +0             TO DC-ELAPSED-MONTHS
  8762                                DC-ELAPSED-DAYS
  8763         MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
  8764         MOVE ' '            TO DC-OPTION-CODE
  8765         PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8766         IF NO-CONVERSION-ERROR
  8767             MOVE DC-GREG-DATE-CYMD  TO ERN-START-DATE
  8768         ELSE
  8769             DISPLAY 'ERROR OCCURED CONVERTING EARNING START '
  8770                'DATE FOR REIN. CO. ' GR-REIN-COMP
  8771                '  START DATE: ' RCT-EARNING-START-DT (CO-SUB)
  8772                '  IN TABLE: ' CR-REIN-TABLE
  8773             MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
  8774                                 TO WS-ABEND-MESSAGE
  8775             MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
  8776             MOVE 0501           TO WS-ABEND-CODE
  8777             GO TO ABEND-PGM.
  8778
  8779     MOVE SAVE-GAAP-REC      TO GAAP-RECORD.
  8780     PERFORM LOAD-GAAP-WS-DATES.
  8781     MOVE 'R'                TO GR-REIN.
  8782     MOVE REIN-COMP (SUB1)   TO GR-REIN-COMP.
  8783     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
  8784     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.
  8785
  8786     IF REIN-LF-FLG (SUB1) = 'X'  AND
  8787        GR-LFTYP NOT = ZERO
  8788         MOVE RWF-LFAMT TO GR-LFBEN
  8789         MOVE RWF-LFPRM TO GR-LFPRM
  8790         IF GR-LFBEN = ZEROS AND
  8791            GR-LFPRM = ZEROS
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 166
* ECS050.cbl
  8792              MOVE ZEROS TO GR-LFTYP
  8793         ELSE
  8794              NEXT SENTENCE
  8795     ELSE
  8796         MOVE ZERO TO GR-LFTYP  GR-LFBEN  GR-LFPRM.
  8797
  8798     IF DTE-CLIENT = 'MIC'
  8799         IF GR-LFTYP NOT = ZERO
  8800             COMPUTE GR-LFBEN = CR-LFAMT + CR-LFAMT-ALT.
  8801
  8802     IF REIN-AH-FLG (SUB1) = 'X'  AND
  8803        GR-AHTYP NOT = ZERO
  8804         MOVE RWF-AHAMT TO GR-AHBEN
  8805         MOVE RWF-AHPRM TO GR-AHPRM
  8806         IF GR-AHBEN = ZEROS AND
  8807            GR-AHPRM = ZEROS
  8808              MOVE ZEROS TO GR-AHTYP
  8809         ELSE
  8810              NEXT SENTENCE
  8811     ELSE
  8812         MOVE ZERO TO GR-AHTYP  GR-AHBEN  GR-AHPRM.
  8813
  8814     IF DTE-CLIENT = 'MIC'
  8815         IF GR-AHTYP NOT = ZERO
  8816             MOVE CR-AHAMT  TO GR-AHBEN.
  8817
  8818     IF GR-SUMMARY-REC
  8819         COMPUTE GR-AHBEN = GR-AHBEN * WS-SUM-AH-FACTOR
  8820         COMPUTE GR-LFBEN = GR-LFBEN * WS-SUM-LF-FACTOR.
  8821
  8822     MOVE ZEROS                     TO GRP-LFPRM  GRP-AHPRM
  8823                                       GRP-LFCOM  GRP-AHCOM
  8824                                       GRR-LFPRM  GRR-AHPRM
  8825                                       GRR-LFCOM  GRR-AHCOM
  8826                                       GRS-LFPRM  GRS-AHPRM
  8827                                       GRS-LFCOM  GRS-AHCOM
  8828                                       GRD-LFPRM  GRD-AHPRM
  8829                                       GRD-LFCOM  GRD-AHCOM.
  8830
  8831     MOVE GR-LFPRM                  TO LF-PRM.
  8832     MOVE ZEROS                     TO LF-PRM-ALT.
  8833
  8834     MOVE 'R'                        TO CP-REIN-FLAG.
  8835
  8836     MOVE LF-REM-TRM1              TO SV-LF-REM-TRM1.
  8837     MOVE LF-REM-TRM2              TO SV-LF-REM-TRM2.
  8838     MOVE LF-BAL-REMTERM           TO SV-LF-BAL-REMTERM.
  8839     MOVE AH-REM-TRM1              TO SV-AH-REM-TRM1.
  8840     MOVE AH-REM-TRM2              TO SV-AH-REM-TRM2.
  8841
  8842     IF ERN-START-DATE NOT GREATER THAN VALUATION-DATE
  8843         GO TO 4050-CALCULATE-REIN-UNEARNED.
  8844
  8845     PERFORM 0160-CALC-REM-TERM THRU 0179-CALC-REM-TERM-EXIT.
  8846
  8847     IF GR-LFTYP NOT = ZEROS
  8848       IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')  AND
  8849           CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'  AND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 167
* ECS050.cbl
  8850           LF-BAL-REMTERM NOT GREATER THAN ZERO)
  8851                           OR
  8852          ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')  AND
  8853           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'  AND
  8854           LF-REM-TRM2 NOT GREATER THAN ZERO)
  8855                           OR
  8856          ((CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L') AND
  8857           LF-REM-TRM2 NOT GREATER ZERO AND
  8858           NOT O-B-CERTIFICATE)
  8859           MOVE ZERO                     TO LF-REM-TRM2.
  8860
  8861     IF LF-REM-TRM2 NOT GREATER THAN ZERO
  8862         MOVE ZEROS                TO GR-LFTYP GR-LFBEN GR-LFPRM
  8863     ELSE
  8864         MOVE LF-REM-TRM1          TO GR-LF-UP-REMTERM
  8865         MOVE LF-REM-TRM2          TO GR-LF-REMTERM.
  8866
  8867     IF AH-REM-TRM2 NOT GREATER THAN ZERO
  8868         MOVE ZEROS                TO GR-AHTYP GR-AHBEN GR-AHPRM
  8869     ELSE
  8870         MOVE AH-REM-TRM1          TO GR-AH-UP-REMTERM
  8871         MOVE AH-REM-TRM2          TO GR-AH-REMTERM.
  8872
  8873     IF GR-LFTYP = ZEROS  AND
  8874        GR-AHTYP = ZEROS
  8875         GO TO 4095-REINSURE-ROUTINE-FINISH.
  8876
  8877 4050-CALCULATE-REIN-UNEARNED.
  8878
  8879     IF REIN-REM-SW (SUB1) = 'I'
  8880         GO TO 4080-REINSURE-RISK-PREMIUMS.
  8881
  8882     IF GR-LFTYP NOT EQUAL ZERO
  8883        IF (CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L')
  8884           COMPUTE WS-CEDE-FACT EQUAL
  8885                   GR-LFBEN / (CR-LFAMT + CR-LFAMT-ALT)
  8886           COMPUTE LF-PRM ROUNDED EQUAL
  8887                         (CR-LFPRM * WS-CEDE-FACT)
  8888           COMPUTE LF-PRM-ALT ROUNDED EQUAL
  8889                         (CR-LFPRM-ALT * WS-CEDE-FACT).
  8890
  8891     PERFORM 1000-CALCULATE-UNEARNED THRU 1099-CALC-UNEARNED-X.
  8892
  8893     IF GR-LFTYP = ZEROS  AND
  8894        GR-AHTYP = ZEROS
  8895         GO TO 4095-REINSURE-ROUTINE-FINISH.
  8896
  8897     IF (STATE-ABBR (CLAS-INDEXS) EQUAL 'VA')
  8898        AND (DTE-CLIENT = 'CID')
  8899        MOVE 'A'                 TO AH-EARN-METHOD
  8900     END-IF
  8901
  8902     IF (GR-AHTYP NOT = ZERO)  AND
  8903        (CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B' AND 'Z')  AND
  8904        (AH-EARN-METHOD = 'A' OR 'C') AND
  8905        (GR-AHPRM NOT = ZERO)
  8906        PERFORM 4500-REIN-AH-RATE-LOOKUP
  8907             THRU 4599-E-REIN-AH-RATE-LOOKUP
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 168
* ECS050.cbl
  8908        IF CP-ERROR-RATE-NOT-FOUND  OR
  8909           CP-ERROR-RATE-IS-ZERO  OR
  8910           CP-ERROR-IN-DATES
  8911           CONTINUE
  8912        ELSE
  8913           COMPUTE GRS-AHPRM ROUNDED = (GR-AH-UP-REMTERM *
  8914              GR-AHBEN / +100 * CP-PREMIUM-RATE)
  8915              / CR-AHPRM-CALC * CR-AHPRM
  8916           MOVE GRS-AHPRM      TO GRD-AHPRM
  8917        END-IF
  8918     END-IF
  8919
  8920     MOVE ZEROS TO GR-REM-AMT.
  8921     MOVE ZEROS TO GR-MO-DEC.
  8922
  8923     IF GR-LFTYP NOT EQUAL ZERO
  8924         PERFORM 2000-CALC-REM-AMT THRU 2999-CALC-REM-AMT-X.
  8925
  8926     IF WT-REMAINING = 'L'
  8927         IF SAVE-REMAINING-AMT GREATER THAN GR-LFBEN
  8928             MOVE GR-LFBEN TO GR-REM-AMT
  8929             MOVE GR-LF-TERM TO GR-LF-REMTERM
  8930         ELSE
  8931             MOVE SAVE-REMAINING-AMT TO GR-REM-AMT.
  8932
  8933     MOVE ZEROS                          TO GR-AH-REM-BEN.
  8934
  8935     IF GR-AHTYP NOT = ZERO
  8936         COMPUTE GR-AH-REM-BEN ROUNDED = GR-AHBEN * GR-AH-REMTERM
  8937         IF DTE-CLIENT = 'NCL'  AND
  8938            O-B-CERTIFICATE
  8939             COMPUTE GR-AH-REM-BEN = GR-AHBEN * .5.
  8940
  8941     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
  8942         GO TO 4090-REINSURE-ROUTINE-CONT.
  8943
  8944     IF CO-SUB = ZEROS
  8945         GO TO 4090-REINSURE-ROUTINE-CONT.
  8946
  8947     IF GR-AHTYP NOT = ZEROS  AND
  8948        RCT-AH-CLM-MAX (CO-SUB) NOT = ZEROS
  8949         IF GR-AH-REM-BEN GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
  8950             MOVE RCT-AH-CLM-MAX (CO-SUB) TO GR-AH-REM-BEN.
  8951
  8952     IF GR-LFTYP = ZEROS  OR
  8953        RCT-LF-CLM-MAX (CO-SUB) = ZEROS
  8954         GO TO 4090-REINSURE-ROUTINE-CONT.
  8955
  8956     IF RCT-LF-CLM-MAX (CO-SUB) NOT LESS THAN GR-LFBEN
  8957         GO TO 4090-REINSURE-ROUTINE-CONT.
  8958
  8959     MOVE RCT-LF-CLM-MAX (CO-SUB)   TO GR-LFBEN.
  8960
  8961     IF GR-REM-AMT GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
  8962         MOVE RCT-LF-CLM-MAX (CO-SUB) TO GR-REM-AMT
  8963         COMPUTE GR-MO-DEC ROUNDED =
  8964                       (RCT-LF-CLM-MAX (CO-SUB) / GR-LF-REMTERM).
  8965
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 169
* ECS050.cbl
  8966     GO TO 4090-REINSURE-ROUTINE-CONT.
  8967
  8968
  8969 4080-REINSURE-RISK-PREMIUMS.
  8970
  8971     IF GR-LFTYP = ZERO
  8972         MOVE ZEROS                   TO GR-REM-AMT
  8973                                         GR-MO-DEC
  8974         GO TO 4085-CONTINUE.
  8975
  8976     COMPUTE GR-MO-DEC = RS-LIFE-BEN / CR-LF-TERM.
  8977
  8978     COMPUTE GR-REM-AMT = GR-LFBEN -
  8979                         (GR-MO-DEC * REIN-EARN-LF-TERM).
  8980
  8981     IF GR-REM-AMT NEGATIVE
  8982         MOVE ZEROS                   TO GR-LFTYP
  8983                                         GR-MO-DEC
  8984                                         GR-REM-AMT
  8985         GO TO 4085-CONTINUE.
  8986
  8987      COMPUTE GR-LF-REMTERM = GR-REM-AMT / GR-MO-DEC.
  8988      MOVE GR-LF-REMTERM              TO GR-LF-UP-REMTERM.
  8989
  8990 4085-CONTINUE.
  8991
  8992     IF GR-AHTYP = ZERO
  8993         MOVE ZEROS                   TO GR-AH-REM-BEN
  8994         GO TO 4090-REINSURE-ROUTINE-CONT.
  8995
  8996     COMPUTE GR-AH-REM-BEN = (GR-AHBEN * CR-AH-TERM) -
  8997                             (RS-AH-BEN * REIN-EARN-AH-TERM).
  8998
  8999     IF GR-AH-REM-BEN NEGATIVE
  9000         MOVE ZEROS                   TO GR-AHTYP
  9001                                         GR-AH-REM-BEN
  9002         GO TO 4090-REINSURE-ROUTINE-CONT.
  9003
  9004      COMPUTE GR-AH-REMTERM = GR-AH-REM-BEN / RS-AH-BEN.
  9005      MOVE GR-AH-REMTERM              TO GR-AH-UP-REMTERM.
  9006
  9007
  9008 4090-REINSURE-ROUTINE-CONT.
  9009
  9010     ADD GR-LFBEN TO REI-INIT-FACE.
  9011     ADD GR-REM-AMT TO REI-REM-FACE.
  9012     ADD GR-AH-REM-BEN TO REI-REM-AH.
  9013     IF GR-FLAG = 'F'
  9014         ADD GR-LFBEN TO REI-FUTR-FACE.
  9015     ADD GR-MO-DEC TO REI-MO-DEC.
  9016
  9017 4095-REINSURE-ROUTINE-FINISH.
  9018
  9019     IF GR-LFTYP = ZERO  AND  GR-AHTYP = ZERO
  9020         GO TO 4097-CONTINUE.
  9021
  9022     IF DTE-CLIENT EQUAL 'CVL'
  9023         ADD +1 TO REI-GAAP
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 170
* ECS050.cbl
  9024         PERFORM 0700-WRITE-GAAP-RECORD THRU 0799-WRITE-GAAP-X
  9025         PERFORM 4100-FORMAT-REIN-ALPHA THRU 4199-EXIT
  9026         PERFORM 0600-WRITE-ALPHA-EXTRACT THRU 0699-EXIT
  9027     ELSE
  9028         ADD +1 TO REI-GAAP
  9029         PERFORM 0700-WRITE-GAAP-RECORD THRU 0799-WRITE-GAAP-X.
  9030
  9031 4097-CONTINUE.
  9032
  9033     MOVE SV-LF-REM-TRM1           TO LF-REM-TRM1.
  9034     MOVE SV-LF-REM-TRM2           TO LF-REM-TRM2.
  9035     MOVE SV-LF-BAL-REMTERM        TO LF-BAL-REMTERM.
  9036     MOVE SV-AH-REM-TRM1           TO AH-REM-TRM1.
  9037     MOVE SV-AH-REM-TRM2           TO AH-REM-TRM2.
  9038
  9039     ADD +1 TO SUB1.
  9040
  9041     GO TO 4030-REINSURE-ROUTINE-BLD-GAAP.
  9042
  9043 4099-REINSURE-ROUTINE-X.
  9044     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 171
* ECS050.cbl
  9046 4100-FORMAT-REIN-ALPHA.
  9047
  9048     MOVE 'R'                    TO  REIN-ALPHA-SW.
  9049
  9050     MOVE GR-REIN-COMP           TO  AX-REIN-COMP.
  9051
  9052     MOVE GR-LFBEN               TO  AX-LF-AMT.
  9053     MOVE GR-LFPRM               TO  AX-LF-PRM.
  9054     MOVE GR-LFTYP               TO  AX-LF-TYP.
  9055     MOVE GR-LF-REMTERM          TO  AX-LF-REMTERM.
  9056     MOVE GR-REM-AMT             TO  AX-LF-REMAMT.
  9057
  9058     MOVE GR-AHBEN               TO  AX-AH-AMT.
  9059     MOVE GR-AHPRM               TO  AX-AH-PRM.
  9060     MOVE GR-AHTYP               TO  AX-AH-TYP.
  9061     MOVE GR-AH-REMTERM          TO  AX-AH-REMTERM.
  9062     MOVE GR-AH-REM-BEN          TO  AX-AH-REMAMT.
  9063
  9064 4199-EXIT.
  9065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 172
* ECS050.cbl
  9067 4500-REIN-AH-RATE-LOOKUP.
  9068
  9069     PERFORM 3000-RE-RATE-AH-ROUTINE.
  9070
  9071     IF DTE-CLIENT = 'ELT'
  9072         IF CR-CARRIER = 'E' OR '1' OR '2' OR '4' OR '6' OR '7'
  9073             MOVE SPACE             TO CP-CLASS-CODE
  9074                                       CP-STATE-STD-ABBRV
  9075             MOVE ZERO              TO CP-DEVIATION-CODE
  9076             IF CR-REIN-SPEC = 'R'
  9077                 MOVE '71'          TO CP-STATE
  9078             ELSE
  9079                 MOVE '70'          TO CP-STATE.
  9080
  9081     PERFORM 3090-CALL-RATING-ROUTINE THRU 3099-EXIT.
  9082
  9083 4599-E-REIN-AH-RATE-LOOKUP.
  9084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 173
* ECS050.cbl
  9086 4800-RR-READ-REIN.
  9087     IF REIN-OPEN-SW = ' '
  9088         MOVE 'X'                   TO REIN-OPEN-SW
  9089         MOVE DTE-CLASIC-COMPANY-CD TO REIN-SRCH-COMP-CD
  9090         MOVE 'A'                   TO REIN-SRCH-CODE
  9091         OPEN INPUT ERRTBL-IN
  9092             IF ERRTBL-FILE-STATUS NOT = '00'  AND  '97'
  9093                 MOVE '21'               TO W-ABEND-CODE-1
  9094                 MOVE ERRTBL-FILE-STATUS TO W-ABEND-CODE-2
  9095                 MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  9096                 MOVE 'OPEN ERROR - ERRTBL' TO WS-ABEND-MESSAGE
  9097                 GO TO ABEND-PGM
  9098             ELSE
  9099                 PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT.
  9100
  9101     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  9102         MOVE REIN-SRCH TO SAVE-REIN-SRCH
  9103         MOVE REIN-SEARCH TO RE-CONTROL-PRIMARY
  9104         READ ERRTBL-IN
  9105             IF ERRTBL-FILE-STATUS = '23'
  9106                 DISPLAY 'INVALID REINSURANCE TABLE CODE - '
  9107                           REIN-SRCH ' ' CR-FULL-CONTROL
  9108                 MOVE '24'               TO W-ABEND-CODE-1
  9109                 MOVE ERRTBL-FILE-STATUS TO W-ABEND-CODE-2
  9110                 MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  9111                 GO TO 4020-REINSURE-ROUTINE-SKIP-1
  9112****             GO TO ABEND-PGM
  9113             ELSE
  9114                 IF ERRTBL-FILE-STATUS NOT = '00'
  9115                     MOVE '24'               TO W-ABEND-CODE-1
  9116                     MOVE ERRTBL-FILE-STATUS TO W-ABEND-CODE-2
  9117                     MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  9118                     GO TO ABEND-PGM.
  9119
  9120     IF RE-CODE NOT = 'A'
  9121        PERFORM REIN-DATE-LOAD.
  9122
  9123 4899-RR-READ-REIN-X.
  9124     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 174
* ECS050.cbl
  9126 4900-REINSURANCE-ROUTINES.
* 9127                             COPY ECSRIRTN.
  9128******************************************************************04/30/98
  9129*                                                                *ECSRIRTN
  9130*                            ECSRIRTN                            *   LV012
  9131*                            VMOD=2.025.                         *ECSRIRTN
  9132*                                                                *ECSRIRTN
  9133******************************************************************ECSRIRTN
  9134******************************************************************
  9135*                   C H A N G E   L O G
  9136*
  9137* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9138*-----------------------------------------------------------------
  9139*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9140* EFFECTIVE    NUMBER
  9141*-----------------------------------------------------------------
  9142* 062703                   PEMA  ADD DCC CLIENT ID TO
  9143*                                SPECIAL CEDED CLAIM CALC
  9144* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9145                                                                  ECSRIRTN
  9146 REINSURE-CALC.                                                   ECSRIRTN
  9147                                                                  ECSRIRTN
  9148     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  9149     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  9150     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  9151     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  9152                                   REIN-REM-SW (SUB1).            ECSRIRTN
  9153                                                                  ECSRIRTN
  9154     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  9155                                   WS-RWF-EP-STOP-DATE-N             CL*12
  9156                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  9157                                                                  ECSRIRTN
  9158     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  9159                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  9160                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  9161                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  9162                                                                  ECSRIRTN
  9163     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  9164        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  9165          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  9166          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  9167          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  9168                                                                  ECSRIRTN
  9169     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  9170        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  9171         GO TO CALC-CONTINUED.                                    ECSRIRTN
  9172                                                                  ECSRIRTN
  9173     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  9174                                          WS-RWF-EP-STOP-DATE-N      CL*12
  9175                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  9176                                                                  ECSRIRTN
  9177     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  9178         GO TO CALC-CONTINUED.                                    ECSRIRTN
  9179                                                                  ECSRIRTN
  9180     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  9181         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
  9182                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
  9183                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 175
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9184     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  9185         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  9186                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  9187                                                                  ECSRIRTN
  9188 CALC-CONTINUED.                                                  ECSRIRTN
  9189                                                                  ECSRIRTN
  9190     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  9191     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  9192                                                                  ECSRIRTN
  9193     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  9194         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  9195     ELSE                                                         ECSRIRTN
  9196         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  9197     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  9198                                                                  ECSRIRTN
  9199     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  9200     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  9201     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  9202         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  9203     ELSE                                                         ECSRIRTN
  9204         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  9205     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  9206                                                                  ECSRIRTN
  9207     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  9208         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  9209         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  9210         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  9211         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  9212         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  9213         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  9214                                                                  ECSRIRTN
  9215     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  9216         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  9217                                                                  ECSRIRTN
  9218     IF CR-DT LESS WT-LO-DATE                                        CL**2
  9219         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  9220                                                                  ECSRIRTN
  9221     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  9222         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  9223                                                                  ECSRIRTN
  9224     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  9225     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  9226                                                                  ECSRIRTN
  9227     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  9228         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  9229                                                                  ECSRIRTN
  9230     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  9231       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  9232        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  9233        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  9234           NEXT SENTENCE                                          ECSRIRTN
  9235       ELSE                                                       ECSRIRTN
  9236           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  9237                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  9238                                                                  ECSRIRTN
  9239     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  9240         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
  9241            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 176
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9242             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  9243                                                                  ECSRIRTN
  9244     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  9245         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  9246            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  9247             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  9248                                                                  ECSRIRTN
  9249     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  9250         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  9251             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  9252                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  9253             ELSE                                                 ECSRIRTN
  9254                 NEXT SENTENCE                                    ECSRIRTN
  9255         ELSE                                                     ECSRIRTN
  9256             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  9257                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  9258                                                                  ECSRIRTN
  9259     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  9260         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  9261             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  9262                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  9263             ELSE                                                 ECSRIRTN
  9264                 NEXT SENTENCE                                    ECSRIRTN
  9265         ELSE                                                     ECSRIRTN
  9266             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  9267                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  9268                                                                  ECSRIRTN
  9269     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  9270         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  9271                                                                  ECSRIRTN
  9272     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  9273         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  9274         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  9275                                                                  ECSRIRTN
  9276     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  9277         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  9278                                                                  ECSRIRTN
  9279     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  9280         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  9281         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  9282                                                                  ECSRIRTN
  9283     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9284         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  9285                                                                  ECSRIRTN
  9286     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9287         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  9288                                                                  ECSRIRTN
  9289     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  9290                                                                  ECSRIRTN
  9291 REINSURE-CK-LIFE.                                                ECSRIRTN
  9292                                                                  ECSRIRTN
  9293     IF CR-LFTYP = ZERO                                           ECSRIRTN
  9294         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9295                                                                  ECSRIRTN
  9296     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  9297         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9298                                                                  ECSRIRTN
  9299     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 177
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9300         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  9301             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9302                                                                  ECSRIRTN
  9303     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  9304                                                                  ECSRIRTN
  9305     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  9306         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  9307             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  9308         ELSE                                                     ECSRIRTN
  9309             NEXT SENTENCE                                        ECSRIRTN
  9310     ELSE                                                         ECSRIRTN
  9311         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  9312             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9313                                                                  ECSRIRTN
  9314     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  9315         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  9316             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  9317         ELSE                                                     ECSRIRTN
  9318             NEXT SENTENCE                                        ECSRIRTN
  9319     ELSE                                                         ECSRIRTN
  9320         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  9321             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9322                                                                  ECSRIRTN
  9323     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  9324         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  9325             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9326                                                                  ECSRIRTN
  9327     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  9328         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  9329            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9330                                                                  ECSRIRTN
  9331     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  9332         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  9333             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9334                                                                  ECSRIRTN
  9335     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  9336         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  9337            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9338                                                                  ECSRIRTN
  9339     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  9340         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  9341             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9342                                                                  ECSRIRTN
  9343     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  9344         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  9345            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  9346            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  9347             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9348                                                                  ECSRIRTN
  9349     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  9350         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  9351            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  9352             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9353                                                                  ECSRIRTN
  9354     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  9355         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  9356             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9357                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 178
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9358     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  9359         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  9360             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9361                                                                  ECSRIRTN
  9362     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  9363        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  9364           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  9365            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9366                                                                  ECSRIRTN
  9367     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  9368         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9369            CR-IND-GRP = '1'                                      ECSRIRTN
  9370             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9371                                                                  ECSRIRTN
  9372     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  9373         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  9374            CR-IND-GRP = '1'                                      ECSRIRTN
  9375             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9376                                                                  ECSRIRTN
  9377     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  9378         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9379            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  9380            CR-IND-GRP = '1'                                      ECSRIRTN
  9381             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9382                                                                  ECSRIRTN
  9383     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  9384         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9385            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  9386            CR-IND-GRP = '1'                                      ECSRIRTN
  9387             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9388                                                                  ECSRIRTN
  9389     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  9390         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  9391            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9392                                                                  ECSRIRTN
  9393     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  9394        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  9395                                                                  ECSRIRTN
  9396     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  9397         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9398                                                                  ECSRIRTN
  9399     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  9400         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9401                                                                  ECSRIRTN
  9402     IF CR-LF-TERM  NUMERIC                                       00002331
  9403        NEXT SENTENCE                                             00002332
  9404     ELSE                                                         00002333
  9405        MOVE ZEROS               TO CR-LF-TERM                    00002334
  9406     END-IF
  9407                                                                  00002335
  9408     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  9409         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9410                                                                  ECSRIRTN
  9411     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  9412         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9413                                                                  ECSRIRTN
  9414     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  9415                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 179
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9416     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  9417         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9418                                                                  ECSRIRTN
  9419     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  9420         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9421                                                                  ECSRIRTN
  9422     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  9423                                                                  ECSRIRTN
  9424 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  9425     EXIT.                                                        ECSRIRTN
  9426                                                                  ECSRIRTN
  9427 REINSURE-CK-AH.                                                  ECSRIRTN
  9428                                                                  ECSRIRTN
  9429     IF CR-AHTYP = ZERO                                           ECSRIRTN
  9430         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9431                                                                  ECSRIRTN
  9432     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  9433         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9434                                                                  ECSRIRTN
  9435     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  9436         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  9437             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9438                                                                  ECSRIRTN
  9439     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  9440                                                                  ECSRIRTN
  9441     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  9442         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  9443             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  9444         ELSE                                                     ECSRIRTN
  9445             NEXT SENTENCE                                        ECSRIRTN
  9446     ELSE                                                         ECSRIRTN
  9447         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  9448             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9449                                                                  ECSRIRTN
  9450     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  9451         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  9452             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9453                                                                  ECSRIRTN
  9454     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  9455         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  9456             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9457                                                                  ECSRIRTN
  9458     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  9459         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  9460             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9461                                                                  ECSRIRTN
  9462     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  9463         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  9464             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9465                                                                  ECSRIRTN
  9466     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  9467         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  9468            CR-IND-GRP = '1'                                      ECSRIRTN
  9469             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9470                                                                  ECSRIRTN
  9471     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  9472         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  9473             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 180
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9474                                                                  ECSRIRTN
  9475     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  9476         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  9477            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  9478                                                                  ECSRIRTN
  9479     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  9480         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  9481            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  9482                                                                  ECSRIRTN
  9483     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  9484         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  9485             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9486                                                                  ECSRIRTN
  9487     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  9488        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  9489                                                                  ECSRIRTN
  9490     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  9491         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9492                                                                  ECSRIRTN
  9493     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  9494         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9495                                                                  ECSRIRTN
  9496     IF CR-AH-TERM  NUMERIC                                       00002331
  9497        NEXT SENTENCE                                             00002332
  9498     ELSE                                                         00002333
  9499        MOVE ZEROS               TO CR-AH-TERM                    00002334
  9500     END-IF
  9501                                                                  00002335
  9502     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  9503         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9504                                                                  ECSRIRTN
  9505     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  9506         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9507                                                                  ECSRIRTN
  9508     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  9509                                                                  ECSRIRTN
  9510     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  9511         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  9512             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  9513                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  9514                                                                  ECSRIRTN
  9515     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  9516         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  9517             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  9518                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  9519                                                                  ECSRIRTN
  9520     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  9521     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  9522                                                                  ECSRIRTN
  9523     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  9524         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  9525                                                                  ECSRIRTN
  9526     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  9527         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  9528                                                                  ECSRIRTN
  9529     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
  9530                                                                  ECSRIRTN
  9531     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 181
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9532                                                                  ECSRIRTN
  9533     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  9534         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9535                                                                  ECSRIRTN
  9536     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  9537         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9538                                                                  ECSRIRTN
  9539     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  9540                                                                  ECSRIRTN
  9541 REINSURE-CK-AH-X.                                                ECSRIRTN
  9542     EXIT.                                                        ECSRIRTN
  9543                                                                  ECSRIRTN
  9544 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  9545                                                                  ECSRIRTN
  9546     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  9547        RS-AH-BEN = ZERO                                          ECSRIRTN
  9548         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  9549                                                                  ECSRIRTN
  9550     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  9551        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9552         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  9553                                                                  ECSRIRTN
  9554     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9555                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  9556                                                                  ECSRIRTN
  9557     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  9558         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  9559             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  9560                                     WT-AHBEN-HI.                 ECSRIRTN
  9561     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  9562         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  9563             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  9564                                     WT-AHMOA-HI.                 ECSRIRTN
  9565                                                                  ECSRIRTN
  9566     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  9567     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  9568                                                                  ECSRIRTN
  9569     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  9570         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  9571                                                                  ECSRIRTN
  9572     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  9573         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  9574                                                                  ECSRIRTN
  9575     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  9576                                                                  ECSRIRTN
  9577     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  9578         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  9579                                                                  ECSRIRTN
  9580     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  9581         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  9582                                       / RW-AHWRK                 ECSRIRTN
  9583       ELSE                                                       ECSRIRTN
  9584         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  9585                                                                  ECSRIRTN
  9586     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  9587         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
  9588                                       / RS-LIFE-BEN              ECSRIRTN
  9589       ELSE                                                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 182
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9590         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  9591                                                                  ECSRIRTN
  9592     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  9593        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  9594          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  9595          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  9596                                      / CR-AH-TERM.               ECSRIRTN
  9597                                                                  ECSRIRTN
  9598     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  9599        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  9600          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9601          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  9602               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  9603            ELSE                                                  ECSRIRTN
  9604                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  9605                                                                  ECSRIRTN
  9606     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  9607        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  9608        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  9609          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  9610          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  9611                                      / CR-AH-TERM                ECSRIRTN
  9612         ELSE                                                     ECSRIRTN
  9613          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9614          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  9615               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  9616            ELSE                                                  ECSRIRTN
  9617                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  9618                                                                  ECSRIRTN
  9619 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  9620     EXIT.                                                        ECSRIRTN
  9621                                                                  ECSRIRTN
  9622                                                                  ECSRIRTN
  9623 REIN-CALC-LIFE.                                                  ECSRIRTN
  9624                                                                  ECSRIRTN
  9625     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
  9626         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
  9627     ELSE                                                         ECSRIRTN
  9628         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
  9629                                                                  ECSRIRTN
  9630     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
  9631         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
  9632     ELSE                                                         ECSRIRTN
  9633         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
  9634           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
  9635               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
  9636           ELSE                                                   ECSRIRTN
  9637               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
  9638                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
  9639                                                                  ECSRIRTN
  9640 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
  9641                                                                  ECSRIRTN
  9642     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
  9643                                                                  ECSRIRTN
  9644     IF WT-REMAINING = 'I'                                        ECSRIRTN
  9645         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
  9646                                                                  ECSRIRTN
  9647     IF WT-REMAINING = 'L'                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 183
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9648         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
  9649         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  9650                                                                  ECSRIRTN
  9651     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
  9652         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
  9653                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  9654         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
  9655                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  9656     ELSE                                                         ECSRIRTN
  9657         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  9658             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
  9659             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
  9660                                                                  ECSRIRTN
  9661     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
  9662         (WT-LF-QC = '2' AND                                         CL**8
  9663          PGM-SUB = +50  AND                                         CL**8
  9664          DTE-CLIENT = 'LAP'))                                       CL**8
  9665          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
  9666     ELSE                                                         ECSRIRTN
  9667         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
  9668                                                                  ECSRIRTN
  9669     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  9670         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
  9671         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
  9672         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
  9673                                                                  ECSRIRTN
  9674     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
  9675                                                                  ECSRIRTN
  9676 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
  9677                                                                  ECSRIRTN
  9678     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  9679         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
  9680         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  9681                                                                  ECSRIRTN
  9682     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
  9683     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  9684     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
  9685                                       RW-LFPRM.                  ECSRIRTN
  9686                                                                  ECSRIRTN
  9687 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
  9688                                                                  ECSRIRTN
  9689     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
  9690                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  9691                                                                  ECSRIRTN
  9692     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  9693        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  9694                                                                  ECSRIRTN
  9695     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
  9696        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  9697         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
  9698     ELSE                                                         ECSRIRTN
  9699         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  9700         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
  9701                                                                  ECSRIRTN
  9702                                                                  ECSRIRTN
  9703 REIN-CALC-LIFE-X.                                                ECSRIRTN
  9704     EXIT.                                                        ECSRIRTN
  9705                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 184
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9706 REIN-CALC-AH.                                                    ECSRIRTN
  9707                                                                  ECSRIRTN
  9708     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  9709         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  9710             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
  9711                                 WT-AHBEN-HI.                     ECSRIRTN
  9712                                                                  ECSRIRTN
  9713     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  9714         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  9715             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
  9716                                 WT-AHMOA-HI.                     ECSRIRTN
  9717                                                                  ECSRIRTN
  9718     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  9719     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  9720                                                                  ECSRIRTN
  9721     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  9722         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
  9723                                                                  ECSRIRTN
  9724     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  9725         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
  9726                                                                  ECSRIRTN
  9727     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  9728         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
  9729                                                                  ECSRIRTN
  9730     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
  9731         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
  9732     ELSE                                                         ECSRIRTN
  9733         IF WT-REMAINING = 'L'                                    ECSRIRTN
  9734             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
  9735         ELSE                                                     ECSRIRTN
  9736             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
  9737             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
  9738                                                                  ECSRIRTN
  9739 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
  9740                                                                  ECSRIRTN
  9741     IF WT-REMAINING = 'I'                                        ECSRIRTN
  9742         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
  9743                                                                  ECSRIRTN
  9744     IF WT-REMAINING = 'L'                                        ECSRIRTN
  9745         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
  9746         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  9747                                                                  ECSRIRTN
  9748     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
  9749         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
  9750                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  9751         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
  9752                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  9753     ELSE                                                         ECSRIRTN
  9754         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
  9755             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
  9756             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
  9757                                                                  ECSRIRTN
  9758     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
  9759         (WT-AH-QC = '2' AND                                         CL**8
  9760          PGM-SUB = +50  AND                                         CL**8
  9761          DTE-CLIENT = 'LAP'))                                       CL**8
  9762         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
  9763     ELSE                                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 185
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9764         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
  9765                                                                  ECSRIRTN
  9766     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
  9767         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
  9768            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
  9769                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
  9770                                                                  ECSRIRTN
  9771     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  9772         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
  9773         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
  9774         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
  9775                                                                  ECSRIRTN
  9776     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
  9777                                                                  ECSRIRTN
  9778 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
  9779                                                                  ECSRIRTN
  9780     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  9781         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
  9782         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  9783                                                                  ECSRIRTN
  9784     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  9785     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  9786     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  9787                                    RW-AHPRM.                     ECSRIRTN
  9788                                                                  ECSRIRTN
  9789 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
  9790                                                                  ECSRIRTN
  9791     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
  9792                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  9793                                                                  ECSRIRTN
  9794     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  9795                                                                  ECSRIRTN
  9796     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
  9797        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  9798         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
  9799     ELSE                                                         ECSRIRTN
  9800         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  9801         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
  9802                                                                  ECSRIRTN
  9803                                                                  ECSRIRTN
  9804 REIN-CALC-AH-X.                                                  ECSRIRTN
  9805     EXIT.                                                        ECSRIRTN
  9806                                                                  ECSRIRTN
  9807 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
  9808                                                                  ECSRIRTN
  9809     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
  9810     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
  9811     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
  9812     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
  9813                                                                  ECSRIRTN
  9814     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
  9815         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
  9816                                                                  ECSRIRTN
  9817     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
  9818        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
  9819           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  9820                                                                  ECSRIRTN
  9821     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 186
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9822        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
  9823           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  9824                                                                  ECSRIRTN
  9825 REINSURE-CALC-X.                                                 ECSRIRTN
  9826                                                                  ECSRIRTN
  9827     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  9828         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  9829                                                                  ECSRIRTN
  9830     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  9831                                                                  ECSRIRTN
  9832 REINSURE-SUBTRACT.                                               ECSRIRTN
  9833                                                                  ECSRIRTN
  9834     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
  9835     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
  9836     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
  9837     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
  9838                                                                  ECSRIRTN
  9839 REINSURE-SUBTRACT-X.                                             ECSRIRTN
  9840     EXIT.                                                        ECSRIRTN
  9841                                                                  ECSRIRTN
  9842 REINSURE-CALC-CANCEL.                                            ECSRIRTN
  9843                                                                  ECSRIRTN
  9844     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  9845     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  9846                                                                  ECSRIRTN
  9847     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  9848         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
  9849                                                                  ECSRIRTN
  9850     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9851         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  9852                                                                  ECSRIRTN
  9853     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  9854         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
  9855             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
  9856                                                                  ECSRIRTN
  9857     IF WT-REMAINING = 'I'                                        ECSRIRTN
  9858         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
  9859                                                                  ECSRIRTN
  9860     IF WT-REMAINING = 'L'                                        ECSRIRTN
  9861         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
  9862         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  9863                                                                  ECSRIRTN
  9864     IF CR-LFPRM = ZERO                                           ECSRIRTN
  9865        MOVE ZERO                TO REIN-FACTOR
  9866     ELSE                                                         ECSRIRTN
  9867        IF DTE-CLIENT = 'GIC'  AND
  9868           CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9869           MOVE +1.0             TO REIN-FACTOR
  9870        ELSE
  9871           IF DTE-CLIENT = 'DCC'
  9872              COMPUTE REIN-FACTOR = CR-LFRFND /
  9873                 (CR-LFPRM + CR-LFPRM-ALT)
  9874           ELSE
  9875              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
  9876                 (CR-LFPRM + CR-LFPRM-ALT)
  9877            END-IF
  9878         END-IF
  9879     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 187
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9880                                                                  ECSRIRTN
  9881     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  9882         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  9883             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  9884                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
  9885                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  9886             ELSE                                                 ECSRIRTN
  9887                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  9888                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  9889                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
  9890                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  9891         ELSE                                                     ECSRIRTN
  9892             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  9893                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
  9894                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
  9895             ELSE                                                 ECSRIRTN
  9896*                COMPUTE RWF-LFRFND = REIN-FACTOR
  9897*                   * REIN-CALCED-LIFE *
  9898*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
  9899                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  9900                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  9901                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
  9902                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
  9903                                                                  ECSRIRTN
  9904     IF CR-LFAMT = ZERO                                           ECSRIRTN
  9905         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  9906             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  9907                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  9908                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
  9909             ELSE                                                 ECSRIRTN
  9910                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  9911                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  9912                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  9913                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
  9914                                                                  ECSRIRTN
  9915     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
  9916                                                                  ECSRIRTN
  9917                                                                  ECSRIRTN
  9918 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
  9919                                                                  ECSRIRTN
  9920     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  9921       (CR-LF-CANC-DT = ZEROS)                                       CL*10
  9922         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  9923         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  9924                                                                  ECSRIRTN
  9925     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  9926       IF VOIDING-LF-CANCEL                                       ECSRIRTN
  9927           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
  9928           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
  9929       ELSE                                                       ECSRIRTN
  9930           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
  9931               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
  9932                                                                  ECSRIRTN
  9933     IF FLAT-CANCEL-LF                                            ECSRIRTN
  9934         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
  9935         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  9936                                                                  ECSRIRTN
  9937     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 188
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9938         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  9939         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  9940                                                                  ECSRIRTN
  9941     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
  9942     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  9943     MOVE +0                          TO REIN-WORKA               ECSRIRTN
  9944                                         RW-LFRFND.               ECSRIRTN
  9945                                                                  ECSRIRTN
  9946 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
  9947                                                                  ECSRIRTN
  9948     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
  9949                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  9950                                                                  ECSRIRTN
  9951     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  9952        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  9953                                                                  ECSRIRTN
  9954     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
  9955        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  9956         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
  9957     ELSE                                                         ECSRIRTN
  9958         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  9959         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
  9960                                                                  ECSRIRTN
  9961                                                                  ECSRIRTN
  9962 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
  9963                                                                  ECSRIRTN
  9964     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9965         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  9966                                                                  ECSRIRTN
  9967     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  9968         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
  9969             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
  9970                                                                  ECSRIRTN
  9971     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  9972         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
  9973         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
  9974             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
  9975                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  9976         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  9977                                                                  ECSRIRTN
  9978     IF WT-REMAINING = 'I'                                        ECSRIRTN
  9979         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
  9980                                                                  ECSRIRTN
  9981     IF WT-REMAINING = 'L'                                        ECSRIRTN
  9982         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
  9983         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  9984                                                                  ECSRIRTN
  9985     IF CR-AHPRM = ZERO                                           ECSRIRTN
  9986        MOVE ZERO                TO REIN-FACTOR
  9987     ELSE
  9988        IF DTE-CLIENT = 'GIC'  AND
  9989           CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9990            MOVE +1.0            TO REIN-FACTOR
  9991        ELSE
  9992           IF DTE-CLIENT = 'DCC'
  9993              COMPUTE REIN-FACTOR =
  9994                 CR-AHRFND / CR-AHPRM
  9995           ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 189
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9996              COMPUTE REIN-FACTOR ROUNDED =
  9997                                CR-AHRFND-CALC / CR-AHPRM
  9998           END-IF
  9999        END-IF
 10000     END-IF
 10001
 10002     IF CR-AHAMT NOT = ZERO
 10003        IF (DTE-CLIENT = 'DCC')
 10004           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 10005           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 10006        ELSE
 10007           IF WT-AH-QC = ('1' OR '4')
 10008              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
 10009                       RWF-AHAMT) / CR-AHAMT
 10010           ELSE
 10011              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 10012              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 10013                       RWF-AHAMT) / CR-AHAMT
 10014           END-IF
 10015        END-IF
 10016     ELSE
 10017        IF RWF-AH-LIMIT = ZERO
 10018           IF WT-AH-QC = ('1' OR '4')
 10019              COMPUTE RWF-AHRFND ROUNDED =
 10020                       CR-AHRFND * WT-AH-PCT
 10021           ELSE
 10022              COMPUTE RWF-AHRFND =
 10023                            REIN-FACTOR * REIN-CALCED-AH
 10024              COMPUTE RWF-AHRFND ROUNDED =
 10025                       RWF-AHRFND * WT-AH-PCT
 10026           END-IF
 10027        END-IF
 10028     END-IF
 10029
 10030     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 10031                                                                  ECSRIRTN
 10032                                                                  ECSRIRTN
 10033 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 10034                                                                  ECSRIRTN
 10035     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 10036       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 10037         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 10038         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10039                                                                  ECSRIRTN
 10040     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 10041       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 10042           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 10043           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 10044       ELSE                                                       ECSRIRTN
 10045           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 10046               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 10047                                                                  ECSRIRTN
 10048     IF FLAT-CANCEL-AH                                            ECSRIRTN
 10049         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 10050         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10051                                                                  ECSRIRTN
 10052     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 10053         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 190
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10054         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10055                                                                  ECSRIRTN
 10056     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 10057     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 10058     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 10059                                    RW-AHRFND.                    ECSRIRTN
 10060                                                                  ECSRIRTN
 10061 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 10062                                                                  ECSRIRTN
 10063     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 10064                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 10065                                                                  ECSRIRTN
 10066     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 10067                                                                  ECSRIRTN
 10068     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 10069        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10070         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 10071     ELSE                                                         ECSRIRTN
 10072         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10073         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 10074                                                                  ECSRIRTN
 10075                                                                  ECSRIRTN
 10076 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 10077                                                                  ECSRIRTN
 10078     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 10079         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10080                                                                  ECSRIRTN
 10081     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 10082         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10083                                                                  ECSRIRTN
 10084     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 10085                                                                  ECSRIRTN
 10086 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 10087                                                                  ECSRIRTN
 10088     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 10089     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 10090                                                                  ECSRIRTN
 10091     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 10092         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 10093             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 10094                                                                  ECSRIRTN
 10095     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 10096         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10097                                                                  ECSRIRTN
 10098     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 10099         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10100                                                                  ECSRIRTN
 10101 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 10102                                                                  ECSRIRTN
 10103     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 10104         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 10105                                                                  ECSRIRTN
 10106     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 10107                                                                  ECSRIRTN
 10108 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 10109                                                                  ECSRIRTN
 10110     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 10111     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 191
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10112                                                                  ECSRIRTN
 10113 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 10114     EXIT.                                                        ECSRIRTN
 10115                                                                  ECSRIRTN
 10116 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 10117                                                                  ECSRIRTN
 10118     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 10119         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 10120                                                                  ECSRIRTN
 10121 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 10122     EXIT.                                                        ECSRIRTN
 10123                                                                  ECSRIRTN
 10124 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 10125                                                                  ECSRIRTN
 10126     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 10127     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 10128                                                                  ECSRIRTN
 10129     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 10130         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 10131                                                                  ECSRIRTN
 10132     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 10133        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 10134          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 10135          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 10136          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 10137                                                                  ECSRIRTN
 10138     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 10139        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 10140          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 10141                                                                  ECSRIRTN
 10142     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 10143                                  RWF-AHCLML.                     ECSRIRTN
 10144                                                                  ECSRIRTN
 10145     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10146         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10147                                                                  ECSRIRTN
 10148     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 10149         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10150                                                                  ECSRIRTN
 10151     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10152         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 10153             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 10154                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 10155                                                                  ECSRIRTN
 10156     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 10157         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 10158                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 10159                                                                  ECSRIRTN
 10160     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10161         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 10162                                                                  ECSRIRTN
 10163     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10164         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 10165             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 10166                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 10167             ELSE                                                 ECSRIRTN
 10168                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 10169         ELSE                                                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 192
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10170             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 10171                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 10172                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 10173             ELSE                                                 ECSRIRTN
 10174                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 10175                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 10176                                                                  ECSRIRTN
 10177     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10178         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10179                                                                  ECSRIRTN
 10180     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 10181         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 10182            OR 'DCC'
 10183             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 10184                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 10185         ELSE                                                     ECSRIRTN
 10186             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 10187                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 10188                                                                  ECSRIRTN
 10189     IF CR-LFAMT = ZERO                                           ECSRIRTN
 10190         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 10191             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 10192                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 10193                                                                  ECSRIRTN
 10194     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10195         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 10196             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 10197                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 10198                                                                  ECSRIRTN
 10199     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10200         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 10201             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 10202               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 10203                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 10204                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 10205                  ELSE                                            ECSRIRTN
 10206                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 10207                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 10208              ELSE                                                ECSRIRTN
 10209                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 10210                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 10211                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 10212                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 10213                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 10214                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 10215                                                                  ECSRIRTN
 10216     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 10217                                                                  ECSRIRTN
 10218     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 10219                                                                  ECSRIRTN
 10220                                                                  ECSRIRTN
 10221 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 10222                                                                  ECSRIRTN
 10223     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 10224         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10225                                                                  ECSRIRTN
 10226     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 10227         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 193
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10228     ELSE                                                         ECSRIRTN
 10229         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 10230                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 10231                                                                  ECSRIRTN
 10232     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10233         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10234                                                                  ECSRIRTN
 10235     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10236         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 10237             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 10238         ELSE                                                     ECSRIRTN
 10239             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 10240     ELSE                                                         ECSRIRTN
 10241         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 10242             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 10243             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 10244         ELSE                                                     ECSRIRTN
 10245             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 10246             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 10247                                                                  ECSRIRTN
 10248                                                                  ECSRIRTN
 10249 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 10250                                                                  ECSRIRTN
 10251     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10252         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 10253                                                                  ECSRIRTN
 10254     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10255         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10256                                                                  ECSRIRTN
 10257     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 10258         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 10259                                                                  ECSRIRTN
 10260     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 10261     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 10262                                                                  ECSRIRTN
 10263     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 10264             VARYING                                              ECSRIRTN
 10265         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 10266             UNTIL                                                ECSRIRTN
 10267         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 10268                                                                  ECSRIRTN
 10269     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10270         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 10271     ELSE                                                         ECSRIRTN
 10272         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 10273                                                                  ECSRIRTN
 10274 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 10275                                                                  ECSRIRTN
 10276     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 10277         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10278                                                                  ECSRIRTN
 10279     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10280       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 10281           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 10282                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 10283               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 10284                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 10285               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 194
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10286                                                                  ECSRIRTN
 10287     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 10288       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 10289           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 10290                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 10291           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 10292                                                                  ECSRIRTN
 10293     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 10294         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 10295                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 10296                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 10297         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10298                                                                  ECSRIRTN
 10299     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 10300         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10301                                                                  ECSRIRTN
 10302     IF INC-SUB = +1                                              ECSRIRTN
 10303         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10304     IF INC-SUB = +2                                              ECSRIRTN
 10305         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10306     IF INC-SUB = +3                                              ECSRIRTN
 10307         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10308     IF INC-SUB = +4                                              ECSRIRTN
 10309         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10310     IF INC-SUB = +5                                              ECSRIRTN
 10311         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10312                                                                  ECSRIRTN
 10313     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 10314                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 10315                                                                  ECSRIRTN
 10316     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10317         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10318                                                                  ECSRIRTN
 10319     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 10320              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 10321         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 10322     ELSE                                                         ECSRIRTN
 10323         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 10324                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 10325                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 10326                                                                  ECSRIRTN
 10327 CHECK-DISABS-EXIT.                                               ECSRIRTN
 10328      EXIT.                                                       ECSRIRTN
 10329                                                                  ECSRIRTN
 10330 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 10331                                                                  ECSRIRTN
 10332     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10333         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10334                                                                  ECSRIRTN
 10335     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10336         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 10337             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 10338                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 10339                                                                  ECSRIRTN
 10340     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 10341         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 10342             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 10343                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 195
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10344 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 10345                                                                  ECSRIRTN
 10346     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 10347         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 10348         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 10349             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 10350                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 10351         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 10352         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10353                                                                  ECSRIRTN
 10354     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10355         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 10356                                                                  ECSRIRTN
 10357     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10358         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 10359             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 10360                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 10361             ELSE                                                 ECSRIRTN
 10362                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 10363         ELSE                                                     ECSRIRTN
 10364             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 10365                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 10366                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 10367             ELSE                                                 ECSRIRTN
 10368                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 10369                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 10370                                                                  ECSRIRTN
 10371     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10372         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10373                                                                  ECSRIRTN
 10374     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 10375         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 10376                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 10377     ELSE                                                         ECSRIRTN
 10378         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 10379             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 10380                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 10381                                                                  ECSRIRTN
 10382     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10383         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 10384             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 10385                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 10386                                                                  ECSRIRTN
 10387     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10388         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 10389             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 10390               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 10391                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 10392                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 10393                  ELSE                                            ECSRIRTN
 10394                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 10395                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 10396              ELSE                                                ECSRIRTN
 10397                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 10398                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 10399                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 10400                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 10401                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 196
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10402                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 10403                                                                  ECSRIRTN
 10404                                                                  ECSRIRTN
 10405     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 10406        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 10407                               '220000' OR '230000')              ECSRIRTN
 10408           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 10409               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 10410                                                                  ECSRIRTN
 10411     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 10412                                                                  ECSRIRTN
 10413     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 10414                                                                  ECSRIRTN
 10415                                                                  ECSRIRTN
 10416 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 10417                                                                  ECSRIRTN
 10418     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 10419         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10420                                                                  ECSRIRTN
 10421     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10422         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 10423         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10424                                                                  ECSRIRTN
 10425     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 10426                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 10427                                                                  ECSRIRTN
 10428     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10429         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10430                                                                  ECSRIRTN
 10431     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 10432         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10433                                                                  ECSRIRTN
 10434     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 10435                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 10436         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 10437                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 10438         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 10439     ELSE                                                         ECSRIRTN
 10440         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 10441         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 10442                                                                  ECSRIRTN
 10443                                                                  ECSRIRTN
 10444 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 10445                                                                  ECSRIRTN
 10446     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 10447         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10448                                                                  ECSRIRTN
 10449     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 10450         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10451                                                                  ECSRIRTN
 10452     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 10453                                                                  ECSRIRTN
 10454 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 10455                                                                  ECSRIRTN
 10456     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 10457     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 10458                                                                  ECSRIRTN
 10459     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 197
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10460         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 10461             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 10462                                                                  ECSRIRTN
 10463     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 10464     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 10465                                                                  ECSRIRTN
 10466     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 10467         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10468                                                                  ECSRIRTN
 10469     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 10470         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10471                                                                  ECSRIRTN
 10472 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 10473                                                                  ECSRIRTN
 10474     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 10475         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 10476                                                                  ECSRIRTN
 10477     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 10478                                                                  ECSRIRTN
 10479 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 10480                                                                  ECSRIRTN
 10481     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 10482     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 10483                                                                  ECSRIRTN
 10484 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 10485     EXIT.                                                        ECSRIRTN
 10486                                                                  ECSRIRTN
 10487 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 10488                                                                  ECSRIRTN
 10489     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 10490         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 10491                                                                  ECSRIRTN
 10492 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 10493     EXIT.                                                        ECSRIRTN
 10494                                                                  ECSRIRTN
 10495                                                                  ECSRIRTN
 10496 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 10497                                                                  ECSRIRTN
 10498     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 10499     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 10500     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 10501     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 10502                                                                  ECSRIRTN
 10503     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 10504         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 10505         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 10506         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 10507         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 10508         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 10509         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 10510         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 10511         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 10512         REIN-AH-LIMIT (1).                                       ECSRIRTN
 10513                                                                  ECSRIRTN
 10514     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 10515         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 10516                                                                  ECSRIRTN
 10517     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 198
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10518                                                                  ECSRIRTN
 10519 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 10520                                                                  ECSRIRTN
 10521     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 10522                                                                  ECSRIRTN
 10523 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 10524     EXIT.                                                        ECSRIRTN
 10525                                                                  ECSRIRTN
 10526 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 10527                                                                  ECSRIRTN
 10528     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 10529                                                                  ECSRIRTN
 10530     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 10531         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 10532                                                                  ECSRIRTN
 10533     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 10534         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 10535             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 10536                                                                  ECSRIRTN
 10537     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10538         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 10539         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 10540         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 10541     ELSE                                                         ECSRIRTN
 10542         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 10543         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 10544         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 10545                                                                  ECSRIRTN
 10546     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 10547                                                                  ECSRIRTN
 10548     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 10549        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 10550         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 10551                                                                  ECSRIRTN
 10552     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 10553         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 10554                                                                  ECSRIRTN
 10555 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 10556     EXIT.                                                        ECSRIRTN
 10557                                                                  ECSRIRTN
 10558 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 10559                                                                  ECSRIRTN
 10560     CONTINUE.                                                    ECSRIRTN
 10561*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 10562 FIND-REI-CO-EXIT.                                                ECSRIRTN
 10563     EXIT.                                                        ECSRIRTN
 10564                                                                  ECSRIRTN
 10565 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 10566                                                                  ECSRIRTN
 10567     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 10568         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 10569                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 10570                                                                  ECSRIRTN
 10571     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 10572         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 10573                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 10574                                                                  ECSRIRTN
 10575     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 199
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10576                                                                  ECSRIRTN
 10577     START ERRTBL-IN                                              ECSRIRTN
 10578           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 10579             INVALID KEY                                          ECSRIRTN
 10580               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 10581                                                                  ECSRIRTN
 10582     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 10583     MOVE 0 TO SUB1.                                              ECSRIRTN
 10584 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 10585                                                                  ECSRIRTN
 10586     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 10587                                                                  ECSRIRTN
 10588     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 10589        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 10590                                                                  ECSRIRTN
 10591     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 10592        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 10593        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 10594                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 10595        GO TO ABEND-PGM.                                          ECSRIRTN
 10596                                                                  ECSRIRTN
 10597     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 10598        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 10599                                                                  ECSRIRTN
 10600     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 10601        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 10602                                                                  ECSRIRTN
 10603     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 10604        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 10605                                                                  ECSRIRTN
 10606     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 10607        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 10608                                                                  ECSRIRTN
 10609     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 10610        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10611                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 10612        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 199)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10613                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 10614        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 199)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10615                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 10616     END-PERFORM.                                                 ECSRIRTN
 10617     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 10618                                                                  ECSRIRTN
 10619     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 10620        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 10621                                                                  ECSRIRTN
 10622     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 10623        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 10624                                                                  ECSRIRTN
 10625     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 10626        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 10627                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 200
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10628     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 10629        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 10630                                                                  ECSRIRTN
 10631     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 10632        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 10633        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 10634        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 10635        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 10636        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 10637        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 10638          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 10639                                                                  ECSRIRTN
 10640     ADD +1 TO CO-SUB.                                            ECSRIRTN
 10641                                                                  ECSRIRTN
 10642     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 10643        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 10644        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 10645        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 10646        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 10647                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 10648        GO TO ABEND-PGM.                                          ECSRIRTN
 10649                                                                  ECSRIRTN
 10650     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 10651                                                                  ECSRIRTN
 10652     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 10653                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 10654     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 10655                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 10656     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 10657                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 10658                                                                  ECSRIRTN
 10659     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 10660         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 10661     ELSE                                                         ECSRIRTN
 10662         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 10663                                                                  ECSRIRTN
 10664     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 10665     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 10666     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 10667     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 10668                                                                  ECSRIRTN
 10669 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 10670                                                                  ECSRIRTN
 10671     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 10672        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 10673                                                                  ECSRIRTN
 10674     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 10675        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 10676                                                                  ECSRIRTN
 10677     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 10678        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 10679                                                                  ECSRIRTN
 10680     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 10681        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 10682                                                                  ECSRIRTN
 10683     ADD +1 TO SUB1.                                              ECSRIRTN
 10684                                                                  ECSRIRTN
 10685     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 201
* ECS050.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10686        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 10687        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 10688                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 10689        GO TO ABEND-PGM.                                          ECSRIRTN
 10690                                                                  ECSRIRTN
 10691     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 10692     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 10693     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 10694     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 10695     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 10696     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 10697     if re-state-exhibit-opt-f = 'Y'
 10698        move 'Y'         to rc2-ecs152-rpt (sub1)
 10699     else
 10700        move 'N'         to rc2-ecs152-rpt (sub1)
 10701     end-if
 10702                                                                  ECSRIRTN
 10703     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 10704                                                                  ECSRIRTN
 10705 REIN-BUILD-EXIT.                                                 ECSRIRTN
 10706     EXIT.                                                        ECSRIRTN
 10707                                                                  ECSRIRTN
 10708 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 10709                                                                  ECSRIRTN
 10710     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 10711                                                                  ECSRIRTN
 10712     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 10713                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 10714                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 10715                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 10716                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 10717                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 10718                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 10719                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 10720                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 10721                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 10722                                                                  ECSRIRTN
 10723 ZERO-RCT-EXIT.                                                   ECSRIRTN
 10724     EXIT.                                                        ECSRIRTN
 10725                                                                  ECSRIRTN
 10726 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 10727                                                                  ECSRIRTN
 10728     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 10729                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 10730     move spaces      to rc2-ecs152-rpt (co-sub)
 10731                                                                  ECSRIRTN
 10732     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 10733                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 10734                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 10735                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 10736                                                                  ECSRIRTN
 10737 ZERO-RC2-EXIT.                                                   ECSRIRTN
 10738     EXIT.                                                        ECSRIRTN
 10739******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 202
* ECS050.cbl
 10741 5000-PRINT-ROUTINE.
*10742                             COPY ELCPRT2.
 10743******************************************************************04/15/98
 10744*                                                                *ELCPRT2
 10745*                                                                *ELCPRT2
 10746*                            ELCPRT2                             *   LV005
 10747*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 10748*                            VMOD=2.002                          *   CL**5
 10749*                                                                *   CL**4
 10750******************************************************************   CL**4
 10751                                                                     CL**4
 10752     IF DTE-FICH NOT = SPACE AND                                     CL**4
 10753        FICH-OPEN    = SPACE                                         CL**4
 10754         MOVE 'X'                TO  FICH-OPEN                       CL**4
 10755         OPEN OUTPUT FICH.                                           CL**4
 10756                                                                     CL**4
 10757     IF DTE-FICH NOT = SPACE                                         CL**4
 10758         MOVE X                  TO  P-CTL                           CL**4
 10759         WRITE FICH-REC FROM PRT.                                    CL**4
 10760                                                                     CL**4
 10761     IF DTE-FICH = SPACE OR '2'                                      CL**4
 10762       MOVE X                    TO  P-CTL                           CL**4
 10763       IF P-CTL = ' '                                                CL**4
 10764         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 10765       ELSE                                                          CL**4
 10766         IF P-CTL = '0'                                              CL**4
 10767           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 10768         ELSE                                                        CL**4
 10769           IF P-CTL = '-'                                            CL**4
 10770             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 10771           ELSE                                                      CL**4
 10772             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 10773                                                                     CL**4
 10774******************************************************************   CL**4
 10775
 10776 5899-PRINT-X.
 10777     EXIT.
 10778
 10779 5900-HEADING-ROUTINE.
 10780     MOVE HDR-1B          TO PRT.
 10781     MOVE '1'             TO X.
 10782
 10783     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 10784
 10785     MOVE HDR-2           TO PRT.
 10786     MOVE ' '             TO X.
 10787
 10788     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 10789
 10790     ADD +1               TO WS-PAGE.
 10791     MOVE WS-PAGE         TO H3-PAGE.
 10792     MOVE HDR-3           TO PRT.
 10793
 10794     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 10795
 10796     MOVE HDR-4A TO PRT.
 10797     MOVE '0' TO X.
 10798
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 203
* ECS050.cbl
 10799     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 10800
 10801     MOVE HDR-4B TO PRT.
 10802     MOVE ' ' TO X.
 10803
 10804     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 10805
 10806     MOVE SPACES TO PRT.
 10807
 10808     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 10809
 10810     MOVE ZEROS                  TO WS-LINE.
 10811
 10812 5999-HEADINGS-X.
 10813     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 204
* ECS050.cbl
 10815 6000-PRINT-EXCLUSIONS.
 10816
 10817     IF DTE-CLIENT NOT = 'FMK'
 10818         GO TO 6999-PRT-EXCLUSIONS-X.
 10819
 10820     IF CR-ENTRY-STATUS = '5' OR 'D' OR 'V' OR 'M'
 10821         GO TO 6999-PRT-EXCLUSIONS-X.
 10822
 10823     IF WS-LINE GREATER +50
 10824         PERFORM 5900-HEADING-ROUTINE THRU 5999-HEADINGS-X.
 10825
 10826     MOVE SPACES               TO DTL-1.
 10827
 10828     MOVE CR-CARRIER           TO D1-CARRIER.
 10829     MOVE CR-GROUPING          TO D1-GROUPING.
 10830     MOVE CR-STATE             TO D1-STATE.
 10831     MOVE CR-ACCOUNT           TO D1-ACCT.
 10832     MOVE CR-CERT-NO           TO D1-CERT.
 10833     MOVE CR-MO                TO D1-EFF-MO.
 10834     MOVE CR-DA                TO D1-EFF-DA.
 10835     MOVE CR-YR                TO D1-EFF-YR.
 10836     MOVE '/'                  TO D1-SLASH-1
 10837                                  D1-SLASH-2.
 10838     MOVE '/' TO D1-SLASH-1  D1-SLASH-2.
 10839     MOVE '00/00/00'           TO D1L-EXIT-DATE
 10840                                  D1A-EXIT-DATE.
 10841
 10842     IF CR-LFTYP = ZEROS
 10843         GO TO 6500-A-H-EXCLUSIONS.
 10844
 10845     IF CR-LF-CURRENT-STATUS = '7'
 10846         MOVE CR-LF-DEX-MO TO D1L-EXIT-MO
 10847         MOVE CR-LF-DEX-DA TO D1L-EXIT-DA
 10848         MOVE CR-LF-DEX-YR TO D1L-EXIT-YR
 10849         MOVE '/' TO D1L-SLASH-1  D1L-SLASH-2
 10850         MOVE CR-DTH-MO TO D1L-REAS-MO
 10851         MOVE CR-DTH-DA TO D1L-REAS-DA
 10852         MOVE CR-DTH-YR TO D1L-REAS-YR
 10853         MOVE '/' TO D1L-SLASH-3  D1L-SLASH-4
 10854         MOVE 'DEATH CLAIM' TO D1L-REASON
 10855           GO TO 6500-A-H-EXCLUSIONS.
 10856
 10857     IF CR-LF-CURRENT-STATUS = '8'
 10858         MOVE CR-LF-CEX-MO TO D1L-EXIT-MO
 10859         MOVE CR-LF-CEX-DA TO D1L-EXIT-DA
 10860         MOVE CR-LF-CEX-YR TO D1L-EXIT-YR
 10861         MOVE '/' TO D1L-SLASH-1  D1L-SLASH-2
 10862         MOVE CR-LF-CNC-MO TO D1L-REAS-MO
 10863         MOVE CR-LF-CNC-DA TO D1L-REAS-DA
 10864         MOVE CR-LF-CNC-YR TO D1L-REAS-YR
 10865         MOVE '/' TO D1L-SLASH-3  D1L-SLASH-4
 10866         MOVE 'CANCELLED  ' TO D1L-REASON
 10867           GO TO 6500-A-H-EXCLUSIONS.
 10868
 10869     IF LF-REM-TRM2 NOT GREATER ZERO
 10870         COMPUTE D1L-EXIT-YR =
 10871            ((CR-YR * 12) + CR-MO + CR-LF-TERM - 1) / 12
 10872         COMPUTE D1L-EXIT-MO =
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 205
* ECS050.cbl
 10873          ((CR-YR * 12) + CR-MO + CR-LF-TERM) -
 10874                                       (D1L-EXIT-YR * 12)
 10875         MOVE CR-DA TO D1L-EXIT-DA
 10876         MOVE '/' TO D1L-SLASH-1  D1L-SLASH-2
 10877         MOVE CR-YR TO D1L-REAS-YR
 10878         MOVE CR-MO TO D1L-REAS-MO
 10879         MOVE CR-DA TO D1L-REAS-DA
 10880         MOVE '/' TO D1L-SLASH-3  D1L-SLASH-4
 10881         MOVE 'EXPIRED    ' TO D1L-REASON.
 10882
 10883 6500-A-H-EXCLUSIONS.
 10884
 10885     IF CR-AHTYP = ZEROS
 10886         GO TO 6900-PRINT-EXCLUSION-DETAIL.
 10887
 10888     IF CR-AH-CURRENT-STATUS = '6'
 10889         MOVE CR-AH-DEX-MO TO D1A-EXIT-MO
 10890         MOVE CR-AH-DEX-DA TO D1A-EXIT-DA
 10891         MOVE CR-AH-DEX-YR TO D1A-EXIT-YR
 10892         MOVE '/' TO D1A-SLASH-1  D1A-SLASH-2
 10893         MOVE CR-DIS-MO TO D1A-REAS-MO
 10894         MOVE CR-DIS-DA TO D1A-REAS-DA
 10895         MOVE CR-DIS-YR TO D1A-REAS-YR
 10896         MOVE '/' TO D1A-SLASH-3  D1A-SLASH-4
 10897         MOVE 'LUMP DISAB ' TO D1A-REASON
 10898           GO TO 6900-PRINT-EXCLUSION-DETAIL.
 10899
 10900     IF CR-AH-CURRENT-STATUS = '8'
 10901         MOVE CR-AH-CEX-MO TO D1A-EXIT-MO
 10902         MOVE CR-AH-CEX-DA TO D1A-EXIT-DA
 10903         MOVE CR-AH-CEX-YR TO D1A-EXIT-YR
 10904         MOVE '/' TO D1A-SLASH-1  D1A-SLASH-2
 10905         MOVE CR-AH-CNC-MO TO D1A-REAS-MO
 10906         MOVE CR-AH-CNC-DA TO D1A-REAS-DA
 10907         MOVE CR-AH-CNC-YR TO D1A-REAS-YR
 10908         MOVE '/' TO D1A-SLASH-3  D1A-SLASH-4
 10909         MOVE 'CANCELLED  ' TO D1A-REASON
 10910           GO TO 6900-PRINT-EXCLUSION-DETAIL.
 10911
 10912     IF AH-REM-TRM2 NOT GREATER ZERO
 10913         COMPUTE D1A-EXIT-YR =
 10914            ((CR-YR * 12) + CR-MO + CR-AH-TERM - 1) / 12
 10915         COMPUTE D1A-EXIT-MO =
 10916          ((CR-YR * 12) + CR-MO + CR-AH-TERM) - (D1A-EXIT-YR * 12)
 10917         MOVE CR-DA TO D1A-EXIT-DA
 10918         MOVE '/' TO D1A-SLASH-1  D1A-SLASH-2
 10919         MOVE CR-YR TO D1A-REAS-YR
 10920         MOVE CR-MO TO D1A-REAS-MO
 10921         MOVE CR-DA TO D1A-REAS-DA
 10922         MOVE '/' TO D1A-SLASH-3  D1A-SLASH-4
 10923         MOVE 'EXPIRED    ' TO D1A-REASON.
 10924
 10925 6900-PRINT-EXCLUSION-DETAIL.
 10926
 10927     IF (D1L-EXIT-YR = RUN-YR  AND  D1L-EXIT-MO = RUN-MO)  OR
 10928        (D1A-EXIT-YR = RUN-YR  AND  D1A-EXIT-MO = RUN-MO)
 10929         NEXT SENTENCE
 10930     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 206
* ECS050.cbl
 10931         GO TO 6999-PRT-EXCLUSIONS-X.
 10932
 10933     IF D1L-EXIT-DATE = '00/00/00'
 10934         MOVE SPACES TO D1L-EXIT-DATE.
 10935     IF D1A-EXIT-DATE = '00/00/00'
 10936         MOVE SPACES TO D1A-EXIT-DATE.
 10937
 10938     MOVE DTL-1 TO PRT.
 10939     MOVE ' ' TO X.
 10940
 10941     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 10942
 10943     ADD +1 TO WS-LINE.
 10944
 10945 6999-PRT-EXCLUSIONS-X.
 10946     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 207
* ECS050.cbl
 10948 7000-REIN-ONLY-STATUS.
 10949***  THIS ROUTINE CHECKS FOR THE EXISTENCE OF A 'REAL' CERT THAT
 10950***  A REINSURANCE-ONLY CERT CAN MATCH UP WITH.  THE ASSUMPTION
 10951***  IS MADE THAT THE REINSURANCE-ONLY CERT WILL HAVE THE SAME
 10952***  CONTROL AS THE 'REAL' CERT EXCEPT FOR THE SUFFIX.  ALSO IT
 10953***  WILL CHECK THE STATUS OF THE REINSURANCE-ONLY CERT TO SEE
 10954***  THAT IT AGREES WITH THE 'REAL' CERT.
 10955
 10956***  DECLINED CERTIFICATES OR VOIDED CERTIFICATES SHOULD NOT
 10957***  GO THROUGH ANY USELESS REINSURANCE PROCESSING LOGIC.
 10958
 10959     IF CR-ENTRY-STATUS EQUAL 'D' OR 'V'
 10960         GO TO 7599-EXIT.
 10961
 10962     IF DTE-CLIENT = 'CSL'
 10963         IF CR-REIN-TABLE = 'RRR'
 10964             GO TO 7599-EXIT.
 10965
 10966     IF DTE-CLIENT = 'FLI' OR 'FLU'
 10967         MOVE CR-CERT-NO         TO WORK-CERT-NO
 10968         IF WK-CERT-PREFIX = 'R'
 10969             GO TO 7599-EXIT.
 10970
 10971     MOVE CR-FULL-CONTROL        TO ROH-CNTRL (1).
 10972     MOVE CR-ENTRY-STATUS        TO ROH-ENTRY (1).
 10973
 10974     IF CR-LFTYP = ZEROS
 10975         MOVE SPACE              TO ROH-LF-STATUS (1)
 10976         MOVE ZEROS              TO ROH-LF-CALC
 10977     ELSE
 10978         MOVE CR-LF-CURRENT-STATUS TO ROH-LF-STATUS (1)
 10979         IF ROH-LF-STATUS (1) NOT = '7' AND NOT = '8'
 10980             MOVE '1'             TO ROH-LF-STATUS (1).
 10981
 10982     IF CR-AHTYP = ZEROS
 10983         MOVE SPACE              TO ROH-AH-STATUS (1)
 10984         MOVE ZEROS              TO ROH-AH-CALC
 10985     ELSE
 10986         MOVE CR-AH-CURRENT-STATUS TO ROH-AH-STATUS (1)
 10987         IF ROH-AH-STATUS (1) NOT = '6' AND NOT = '8'
 10988             MOVE '1'             TO ROH-AH-STATUS (1).
 10989
 10990     IF CR-ENTRY-STATUS NOT = 'R' AND NOT = '9'
 10991         GO TO 7500-SHIFT-ROH.
 10992
 10993     IF ROH-CNTRL (1) NOT = ROH-CNTRL (2) AND
 10994                      NOT = ROH-CNTRL (3) AND
 10995                      NOT = ROH-CNTRL (4) AND
 10996                      NOT = ROH-CNTRL (5) AND
 10997                      NOT = ROH-CNTRL (6)
 10998         GO TO 7400-ROH-ERROR.
 10999
 11000     MOVE +2 TO SB.
 11001
 11002 7100-ROH-LOOP.
 11003     IF ROH-CNTRL (1) = ROH-CNTRL (SB)
 11004         GO TO 7300-CK-ROH-STATS.
 11005
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 208
* ECS050.cbl
 11006 7200-ROH-INCRE.
 11007     ADD +1 TO SB.
 11008
 11009     IF SB LESS +7
 11010         GO TO 7100-ROH-LOOP.
 11011
 11012     GO TO 7400-ROH-ERROR.
 11013
 11014 7300-CK-ROH-STATS.
 11015     IF ROH-ENTRY (SB) = 'R' OR '9'
 11016         GO TO 7200-ROH-INCRE.
 11017
 11018     IF ROH-LF-STATUS (1) NOT = SPACE
 11019         IF ROH-LF-STATUS (1) NOT = ROH-LF-STATUS (SB)
 11020             GO TO 7400-ROH-ERROR.
 11021
 11022     IF ROH-AH-STATUS (1) NOT = SPACE
 11023         IF ROH-AH-STATUS (1) NOT = ROH-AH-STATUS (SB)
 11024             GO TO 7400-ROH-ERROR.
 11025
 11026     GO TO 7500-SHIFT-ROH.
 11027
 11028 7400-ROH-ERROR.
 11029
 11030     IF CR-LFTYP NOT = ZEROS
 11031         COMPUTE ROH-LF-CALC = (CR-CCYY * 12) + CR-MO
 11032                                              + CR-LF-TERM.
 11033     IF CR-AHTYP NOT = ZEROS
 11034         COMPUTE ROH-AH-CALC = (CR-CCYY * 12) + CR-MO
 11035                                              + CR-AH-TERM.
 11036
 11037     IF ROH-LF-CALC NOT GREATER CUR-CALC  AND
 11038        ROH-AH-CALC NOT GREATER CUR-CALC
 11039         GO TO 7500-SHIFT-ROH.
 11040
 11041     MOVE SPACES                 TO DTL-1.
 11042     MOVE CR-CARRIER             TO D1-CARRIER.
 11043     MOVE CR-GROUPING            TO D1-GROUPING.
 11044     MOVE CR-STATE               TO D1-STATE.
 11045     MOVE CR-ACCOUNT             TO D1-ACCT.
 11046     MOVE CR-CERT-NO             TO D1-CERT.
 11047     MOVE CR-MO                  TO D1-EFF-MO.
 11048     MOVE CR-DA                  TO D1-EFF-DA.
 11049     MOVE CR-YR                  TO D1-EFF-YR.
 11050     MOVE '/'                    TO D1-SLASH-1   D1-SLASH-2.
 11051     MOVE 'POSSIBLE REINSURANCE ONLY STATUS ERROR'
 11052                                 TO D1-REIN-MESSAGE.
 11053
 11054     IF WS-LINE GREATER +50
 11055         PERFORM 5900-HEADING-ROUTINE THRU 5999-HEADINGS-X.
 11056
 11057     MOVE DTL-1                  TO PRT.
 11058     MOVE ' '                    TO X.
 11059
 11060     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11061
 11062     ADD +1                      TO WS-LINE.
 11063
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 209
* ECS050.cbl
 11064 7500-SHIFT-ROH.
 11065
 11066     MOVE R-O-H (5)              TO R-O-H (6).
 11067     MOVE R-O-H (4)              TO R-O-H (5).
 11068     MOVE R-O-H (3)              TO R-O-H (4).
 11069     MOVE R-O-H (2)              TO R-O-H (3).
 11070     MOVE R-O-H (1)              TO R-O-H (2).
 11071
 11072 7599-EXIT.
 11073     EXIT.
 11074 7600-EXCEP-REPT.
 11075     IF LINER GREATER THAN +60
 11076         MOVE HDR-1A             TO PRT
 11077         MOVE '1'                TO X
 11078         PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X
 11079         MOVE HDR-2              TO PRT
 11080         MOVE ' '                TO X
 11081         PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X
 11082         ADD +1                  TO WS-PAGE
 11083         MOVE WS-PAGE            TO H3-PAGE
 11084         MOVE HDR-3              TO PRT
 11085         PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X
 11086         MOVE HDR-4C             TO PRT
 11087         MOVE '0'                TO X
 11088         PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X
 11089         MOVE SPACES TO PRT
 11090         PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X
 11091         MOVE +8                 TO LINER.
 11092
 11093     MOVE ZEROS                TO WS-LINE.
 11094     MOVE CR-CARRIER           TO EXP-CARRIER.
 11095     MOVE CR-GROUPING          TO EXP-GROUPING.
 11096     MOVE CR-STATE             TO EXP-STATE.
 11097     MOVE CR-ACCOUNT           TO EXP-ACCT.
 11098     MOVE CR-CERT-NO           TO EXP-CERT.
 11099     MOVE CR-MO                TO EXP-EFF-MO.
 11100     MOVE CR-DA                TO EXP-EFF-DA.
 11101     MOVE CR-YR                TO EXP-EFF-YR.
 11102     MOVE '/'                  TO EXP-SLASH-1
 11103                                  EXP-SLASH-2.
 11104
 11105     MOVE WS-EXCEP-REPT-LINE   TO PRT.
 11106     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11107     MOVE SPACES               TO   WS-EXCEP-REPT-LINE.
 11108     ADD +2                    TO LINER.
 11109
 11110 7699-EXIT.
 11111     EXIT.
 11112
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 210
* ECS050.cbl
 11114 8000-CARRIER-BREAK-ROUTINE.
 11115
 11116     IF PRIOR-CARRIER = SPACES
 11117         GO TO 8900-INITIALIZE-TOTALS.
 11118
 11119     MOVE HDR-1                  TO PRT.
 11120     MOVE '1'                    TO X.
 11121
 11122     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11123
 11124     MOVE HDR-2                  TO PRT.
 11125     MOVE ' '                    TO X.
 11126
 11127     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11128
 11129     ADD +1                      TO WS-PAGE.
 11130     MOVE WS-PAGE                TO H3-PAGE.
 11131     MOVE HDR-3                  TO PRT.
 11132
 11133     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11134
 11135     MOVE SPACES                 TO PRT.
 11136     MOVE '-'                    TO X.
 11137
 11138     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11139
 11140     IF PRINTING-FINAL-TOTALS
 11141         MOVE SPACES             TO HDR-6
 11142     ELSE
 11143         MOVE PRIOR-CARRIER      TO HD6-CARR.
 11144     MOVE HDR-6 TO PRT.
 11145     MOVE ' ' TO X.
 11146
 11147     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11148
 11149     MOVE SPACES                 TO TOT-1.
 11150
 11151     MOVE TOT-MSG-1              TO T1-MSG.
 11152     MOVE TOT-READ               TO T1-COUNT1.
 11153
 11154     MOVE TOT-1                  TO PRT.
 11155     MOVE '0'                    TO X.
 11156
 11157     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11158
 11159     MOVE TOT-MSG-1A             TO T1-MSG.
 11160     MOVE TOT-REIS               TO T1-COUNT1.
 11161
 11162     MOVE TOT-1                  TO PRT.
 11163     MOVE ' '                    TO X.
 11164
 11165     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11166
 11167     MOVE TOT-MSG-1B             TO T1-MSG.
 11168     MOVE TOT-REIO               TO T1-COUNT1.
 11169
 11170     MOVE TOT-1                  TO PRT.
 11171     MOVE ' '                    TO X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 211
* ECS050.cbl
 11172
 11173     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11174
 11175     MOVE TOT-MSG-1C             TO T1-MSG.
 11176     MOVE TOT-VOIDED             TO T1-COUNT1.
 11177
 11178     MOVE TOT-1                  TO PRT.
 11179     MOVE ' '                    TO X.
 11180
 11181     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11182
 11183     MOVE TOT-MSG-1D             TO T1-MSG.
 11184     MOVE TOT-DECLINED           TO T1-COUNT1.
 11185
 11186     MOVE TOT-1                  TO PRT.
 11187     MOVE ' '                    TO X.
 11188
 11189     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11190
 11191     MOVE TOT-MSG-2              TO T1-MSG.
 11192     MOVE TOT-SNGLPRM            TO T1-COUNT1.
 11193
 11194     MOVE TOT-1                  TO PRT.
 11195     MOVE ' '                    TO X.
 11196
 11197     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11198
 11199     MOVE TOT-MSG-3              TO T1-MSG.
 11200     MOVE TOT-OB                 TO T1-COUNT1.
 11201
 11202     MOVE TOT-1                  TO PRT.
 11203
 11204     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11205
 11206     MOVE TOT-MSG-4              TO T1-MSG.
 11207     MOVE TOT-SUM                TO T1-COUNT1.
 11208
 11209     MOVE TOT-1                  TO PRT.
 11210
 11211     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11212
 11213     MOVE SPACES                 TO PRT.
 11214     MOVE '0'                    TO X.
 11215
 11216     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11217
 11218     MOVE ' COVERAGE STATISTICS - '  TO HD7-COV.
 11219     MOVE LIFE-OVERRIDE-L12          TO HD7-DESC-1.
 11220     MOVE   AH-OVERRIDE-L12          TO HD7-DESC-2.
 11221
 11222     MOVE HDR-7                  TO PRT.
 11223     MOVE '-'                    TO X.
 11224
 11225     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11226
 11227     MOVE HDR-7A                 TO PRT.
 11228     MOVE ' '                    TO X.
 11229
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 212
* ECS050.cbl
 11230     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11231
 11232     MOVE TOT-MSG-5A             TO T4-MSG.
 11233     MOVE TOT-LF                 TO T4-COUNT1.
 11234     MOVE TOT-LF-AMT             TO T4-PREM-LF.
 11235     MOVE TOT-AH                 TO T4-COUNT2.
 11236     MOVE TOT-AH-AMT             TO T4-PREM-AH.
 11237
 11238     MOVE TOT-4                  TO PRT.
 11239     MOVE '0'                    TO X.
 11240
 11241     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11242
 11243     MOVE TOT-MSG-5              TO T4-MSG.
 11244     MOVE TOT-CANC-LF            TO T4-COUNT1.
 11245     MOVE TOT-CANC-LF-AMT        TO T4-PREM-LF.
 11246     MOVE TOT-CANC-AH            TO T4-COUNT2.
 11247     MOVE TOT-CANC-AH-AMT        TO T4-PREM-AH.
 11248
 11249     MOVE TOT-4                  TO PRT.
 11250     MOVE '0'                    TO X.
 11251
 11252     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11253
 11254     MOVE TOT-MSG-6              TO T4-MSG.
 11255     MOVE TOT-DTH                TO T4-COUNT1.
 11256     MOVE TOT-DTH-AMT            TO T4-PREM-LF.
 11257     MOVE TOT-DIS                TO T4-COUNT2.
 11258     MOVE TOT-DIS-AMT            TO T4-PREM-AH.
 11259
 11260     MOVE TOT-4                  TO PRT.
 11261     MOVE ' '                    TO X.
 11262
 11263     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11264
 11265     MOVE TOT-MSG-7              TO T4-MSG.
 11266     MOVE TOT-EXP-LF             TO T4-COUNT1.
 11267     MOVE TOT-EXP-LF-AMT         TO T4-PREM-LF.
 11268     MOVE TOT-EXP-AH             TO T4-COUNT2.
 11269     MOVE TOT-EXP-AH-AMT         TO T4-PREM-AH.
 11270
 11271     MOVE TOT-4                  TO PRT.
 11272
 11273     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11274
 11275     MOVE TOT-MSG-8              TO T4-MSG.
 11276     MOVE TOT-FUTR-LF            TO T4-COUNT1.
 11277     MOVE TOT-FUTR-LF-AMT        TO T4-PREM-LF.
 11278     MOVE TOT-FUTR-AH            TO T4-COUNT2.
 11279     MOVE TOT-FUTR-AH-AMT        TO T4-PREM-AH.
 11280
 11281     MOVE TOT-4                  TO PRT.
 11282
 11283     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11284
 11285     MOVE TOT-MSG-9-OB           TO T4-MSG.
 11286     MOVE TOT-ACTIVE-LF-OB       TO T4-COUNT1.
 11287     MOVE TOT-ACT-LF-AMT-OB      TO T4-PREM-LF.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 213
* ECS050.cbl
 11288     MOVE TOT-ACTIVE-AH-OB       TO T4-COUNT2.
 11289     MOVE TOT-ACT-AH-AMT-OB      TO T4-PREM-AH.
 11290
 11291     MOVE TOT-4                  TO PRT.
 11292
 11293     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11294
 11295     MOVE TOT-MSG-9              TO T4-MSG.
 11296     MOVE TOT-ACTIVE-LF          TO T4-COUNT1.
 11297     MOVE TOT-ACTIVE-LF-AMT      TO T4-PREM-LF.
 11298     MOVE TOT-ACTIVE-AH          TO T4-COUNT2.
 11299     MOVE TOT-ACTIVE-AH-AMT      TO T4-PREM-AH.
 11300
 11301     MOVE TOT-4                  TO PRT.
 11302
 11303     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11304
 11305     MOVE SPACES                 TO TOT-1.
 11306     MOVE TOT-MSG-10             TO T1-MSG.
 11307     MOVE TOT-ALPHA              TO T1-COUNT1.
 11308
 11309     MOVE TOT-1                  TO PRT.
 11310     MOVE '-'                    TO X.
 11311
 11312     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11313
 11314     MOVE SPACES                 TO TOT-1.
 11315     MOVE TOT-MSG-10J            TO T1-MSG.
 11316     MOVE TOT-ALPHA-JOINT        TO T1-COUNT1.
 11317
 11318     MOVE TOT-1                  TO PRT.
 11319     MOVE ' '                    TO X.
 11320
 11321     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11322
 11323     MOVE SPACES                 TO PRT.
 11324     MOVE '0'                    TO X.
 11325
 11326     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11327
 11328     MOVE HDR-5                  TO PRT.
 11329
 11330     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11331
 11332     MOVE TOT-MSG-11             TO T2-MSG.
 11333     MOVE TOT-INIT-FACE          TO T2-GROSS.
 11334     MOVE REI-INIT-FACE          TO T2-REIN.
 11335
 11336     MOVE TOT-2                  TO PRT.
 11337     MOVE '0'                    TO X.
 11338
 11339     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11340
 11341     MOVE TOT-MSG-12             TO T2-MSG.
 11342     MOVE TOT-REM-FACE           TO T2-GROSS.
 11343     MOVE REI-REM-FACE           TO T2-REIN.
 11344
 11345     MOVE TOT-2                  TO PRT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 214
* ECS050.cbl
 11346     MOVE ' '                    TO X.
 11347
 11348     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11349
 11350     MOVE TOT-MSG-13             TO T2-MSG.
 11351     MOVE TOT-REM-AH             TO T2-GROSS.
 11352     MOVE REI-REM-AH             TO T2-REIN.
 11353
 11354     MOVE TOT-2                  TO PRT.
 11355
 11356     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11357
 11358     MOVE TOT-MSG-14             TO T2-MSG.
 11359     MOVE TOT-FUTR-FACE          TO T2-GROSS.
 11360     MOVE REI-FUTR-FACE          TO T2-REIN.
 11361
 11362     MOVE TOT-2                  TO PRT.
 11363
 11364     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11365
 11366     MOVE TOT-MSG-15             TO T2-MSG.
 11367     MOVE TOT-MO-DEC             TO T2-GROSS.
 11368     MOVE REI-MO-DEC             TO T2-REIN.
 11369
 11370     MOVE TOT-2                  TO PRT.
 11371
 11372     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11373
 11374     MOVE TOT-MSG-16             TO T3-MSG.
 11375     MOVE TOT-GAAP               TO T3-GROSS.
 11376     MOVE REI-GAAP               TO T3-REIN.
 11377
 11378     MOVE TOT-3                  TO PRT.
 11379     MOVE '-'                    TO X.
 11380
 11381     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11382
 11383     MOVE SPACES                 TO PRT.
 11384     MOVE '0'                    TO X.
 11385
 11386     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11387
 11388     MOVE ' YEAR TO DATE NET PREMIUM - '  TO HD7B-COV.
 11389     MOVE LIFE-OVERRIDE-L12      TO HD7B-DESC-1.
 11390     MOVE   AH-OVERRIDE-L12      TO HD7B-DESC-2.
 11391
 11392     MOVE HDR-7B                 TO PRT.
 11393     MOVE '-'                    TO X.
 11394
 11395     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11396
 11397     MOVE TOT-MSG-17             TO T2-MSG.
 11398     MOVE TOT-LF-UNDER60         TO T2-GROSS.
 11399     MOVE TOT-AH-UNDER60         TO T2-REIN.
 11400
 11401     MOVE TOT-2                  TO PRT.
 11402     MOVE '0'                    TO X.
 11403
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 215
* ECS050.cbl
 11404     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11405
 11406     MOVE TOT-MSG-18             TO T2-MSG.
 11407     MOVE TOT-LF-OVER59          TO T2-GROSS.
 11408     MOVE TOT-AH-OVER59          TO T2-REIN.
 11409
 11410     MOVE TOT-2                  TO PRT.
 11411     MOVE ' '                    TO X.
 11412
 11413     PERFORM 5000-PRINT-ROUTINE THRU 5899-PRINT-X.
 11414
 11415 8800-ADD-TO-FINAL-TOTALS.
 11416
 11417     MOVE +80                    TO WS-LINE
 11418                                    LINER.
 11419     ADD TOT-LF-AMT              TO F-TOT-LF-AMT.
 11420     ADD TOT-AH-AMT              TO F-TOT-AH-AMT.
 11421     ADD TOT-CANC-LF-AMT         TO F-TOT-CANC-LF-AMT.
 11422     ADD TOT-CANC-AH-AMT         TO F-TOT-CANC-AH-AMT.
 11423     ADD TOT-DTH-AMT             TO F-TOT-DTH-AMT.
 11424     ADD TOT-DIS-AMT             TO F-TOT-DIS-AMT.
 11425     ADD TOT-EXP-LF-AMT          TO F-TOT-EXP-LF-AMT.
 11426     ADD TOT-EXP-AH-AMT          TO F-TOT-EXP-AH-AMT.
 11427     ADD TOT-FUTR-LF-AMT         TO F-TOT-FUTR-LF-AMT.
 11428     ADD TOT-FUTR-AH-AMT         TO F-TOT-FUTR-AH-AMT.
 11429     ADD TOT-ACTIVE-LF-AMT       TO F-TOT-ACTIVE-LF-AMT.
 11430     ADD TOT-ACTIVE-AH-AMT       TO F-TOT-ACTIVE-AH-AMT.
 11431     ADD TOT-ACT-LF-AMT-OB       TO F-TOT-ACT-LF-AMT-OB.
 11432     ADD TOT-ACT-AH-AMT-OB       TO F-TOT-ACT-AH-AMT-OB.
 11433
 11434     ADD TOT-READ                TO F-TOT-READ.
 11435     ADD TOT-REIS                TO F-TOT-REIS.
 11436     ADD TOT-VOIDED              TO F-TOT-VOIDED.
 11437     ADD TOT-DECLINED            TO F-TOT-DECLINED.
 11438     ADD TOT-REIO                TO F-TOT-REIO.
 11439     ADD TOT-SNGLPRM             TO F-TOT-SNGLPRM.
 11440     ADD TOT-OB                  TO F-TOT-OB.
 11441     ADD TOT-SUM                 TO F-TOT-SUM.
 11442     ADD TOT-LF                  TO F-TOT-LF.
 11443     ADD TOT-AH                  TO F-TOT-AH.
 11444     ADD TOT-CANC-LF             TO F-TOT-CANC-LF.
 11445     ADD TOT-CANC-AH             TO F-TOT-CANC-AH.
 11446     ADD TOT-DTH                 TO F-TOT-DTH.
 11447     ADD TOT-DIS                 TO F-TOT-DIS.
 11448     ADD TOT-EXP-LF              TO F-TOT-EXP-LF.
 11449     ADD TOT-EXP-AH              TO F-TOT-EXP-AH.
 11450     ADD TOT-FUTR-LF             TO F-TOT-FUTR-LF.
 11451     ADD TOT-FUTR-AH             TO F-TOT-FUTR-AH.
 11452     ADD TOT-ACTIVE-LF           TO F-TOT-ACTIVE-LF.
 11453     ADD TOT-ACTIVE-AH           TO F-TOT-ACTIVE-AH.
 11454     ADD TOT-ACTIVE-LF-OB        TO F-TOT-ACTIVE-LF-OB.
 11455     ADD TOT-ACTIVE-AH-OB        TO F-TOT-ACTIVE-AH-OB.
 11456     ADD TOT-ALPHA               TO F-TOT-ALPHA.
 11457     ADD TOT-ALPHA-JOINT         TO F-TOT-ALPHA-JOINT.
 11458     ADD TOT-GAAP                TO F-TOT-GAAP.
 11459     ADD REI-GAAP                TO F-REI-GAAP.
 11460     ADD TOT-INIT-FACE           TO F-TOT-INIT-FACE.
 11461     ADD REI-INIT-FACE           TO F-REI-INIT-FACE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 216
* ECS050.cbl
 11462     ADD TOT-REM-FACE            TO F-TOT-REM-FACE.
 11463     ADD REI-REM-FACE            TO F-REI-REM-FACE.
 11464     ADD TOT-REM-AH              TO F-TOT-REM-AH.
 11465     ADD REI-REM-AH              TO F-REI-REM-AH.
 11466     ADD TOT-FUTR-FACE           TO F-TOT-FUTR-FACE.
 11467     ADD REI-FUTR-FACE           TO F-REI-FUTR-FACE.
 11468     ADD TOT-MO-DEC              TO F-TOT-MO-DEC.
 11469     ADD REI-MO-DEC              TO F-REI-MO-DEC.
 11470
 11471     ADD TOT-LF-OVER59           TO F-TOT-LF-OVER59.
 11472     ADD TOT-LF-UNDER60          TO F-TOT-LF-UNDER60.
 11473     ADD TOT-AH-OVER59           TO F-TOT-AH-OVER59.
 11474     ADD TOT-AH-UNDER60          TO F-TOT-AH-UNDER60.
 11475
 11476 8900-INITIALIZE-TOTALS.
 11477
 11478     MOVE ZEROS                  TO TOT-LF-OVER59  TOT-AH-OVER59
 11479                                    TOT-LF-UNDER60 TOT-AH-UNDER60.
 11480     MOVE ZERO-ACCUMS            TO TOT-ACCUMS.
 11481     MOVE CR-CARRIER             TO PRIOR-CARRIER.
 11482
 11483 8910-SET-CARRIER.
 11484     IF CARRIER-SUB (1) = SPACE
 11485         MOVE SPACES             TO DOMICILE-STATE
 11486         GO TO 8999-EXIT.
 11487
 11488     MOVE +0                     TO S1.
 11489 8915-S-C-LOOP.
 11490
 11491     ADD +1                      TO S1.
 11492
 11493     IF S1 GREATER THAN CLAS-MAXCN
 11494         MOVE SPACES             TO DOMICILE-STATE
 11495         GO TO 8999-EXIT.
 11496
 11497     IF PRIOR-CARRIER = CARRIER-SUB (S1)
 11498         MOVE CARRIER-DOM-ST (S1) TO DOMICILE-STATE
 11499         GO TO 8999-EXIT.
 11500
 11501     GO TO 8915-S-C-LOOP.
 11502
 11503 8999-EXIT.
 11504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 217
* ECS050.cbl
 11506 ABEND-PGM.
*11507                             COPY ELCABEND.
 11508***************************************************************** 04/14/98
 11509*                                                               * ELCABEND
 11510*                            ELCABEND.                          *    LV003
 11511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 11512*                            VMOD 2.002                              CL**2
 11513*                                                               * ELCABEND
 11514*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 11515*            AND THEN ABENDS.                                   * ELCABEND
 11516*                                                               * ELCABEND
 11517*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 11518*                                                               * ELCABEND
 11519***************************************************************** ELCABEND
 11520*APS-010.                                                         ELCABEND
 11521     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 11522     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 11523                                                                  ELCABEND
 11524     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 11525         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 11526         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 11527                                 UPON CONSOLE.                    ELCABEND
 11528                                                                  ELCABEND
 11529     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 11530         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 11531         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 11532                                 UPON CONSOLE.                    ELCABEND
 11533                                                                  ELCABEND
 11534     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 11535     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 11536                                 UPON CONSOLE.                    ELCABEND
 11537                                                                  ELCABEND
 11538     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 11539     CALL 'ABORTME'.
 11540                                                                  ELCABEND
 11541 APS-EXIT.                                                        ELCABEND
 11542     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 218
* ECS050.cbl
 11544 9000-END-THE-JOB.
 11545
 11546     IF DTE-CLIENT EQUAL 'NCL'
 11547           PERFORM 0395-CHECK-OUT-OB THRU 0395-EXIT.
 11548
 11549     MOVE CR-ACCT-CONTROL     TO WS-HOLD-AM-CONTROL.
 11550
 11551     PERFORM 8000-CARRIER-BREAK-ROUTINE THRU 8999-EXIT.
 11552
 11553     MOVE FIN-TOT-ACCUMS         TO TOT-ACCUMS.
 11554     MOVE F-TOT-LF-OVER59        TO TOT-LF-OVER59.
 11555     MOVE F-TOT-LF-UNDER60       TO TOT-LF-UNDER60.
 11556     MOVE F-TOT-AH-OVER59        TO TOT-AH-OVER59.
 11557     MOVE F-TOT-AH-UNDER60       TO TOT-AH-UNDER60.
 11558
 11559     MOVE '*'                    TO PRIOR-CARRIER.
 11560
 11561     PERFORM 8000-CARRIER-BREAK-ROUTINE.
 11562
 11563 LOAD-GAAP-WS-DATES.
*11564     COPY ELCGAPM1.
 11565******************************************************************04/15/98
 11566*                                                                *ELCGAPM1
 11567*                            ELCGAPM1                            *   LV003
 11568*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 11569*                            VMOD=2.001                          *ELCGAPM1
 11570*                                                                *ELCGAPM1
 11571*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCGAPM1
 11572*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCGAPM1
 11573*                                                                *ELCGAPM1
 11574******************************************************************ELCGAPM1
 11575     MOVE GR-EFF                 TO  WS-GR-EFF-N.                    CL**2
 11576     MOVE GR-ENT-DT              TO  WS-GR-ENT-DT-N.                 CL**2
 11577     MOVE GR-LF-EXPIRE-DATE      TO  WS-GR-LF-EXPIRE-DATE-N.         CL**2
 11578     MOVE GR-AH-EXPIRE-DATE      TO  WS-GR-AH-EXPIRE-DATE-N.         CL**2
 11579
 11580*UNLOAD-GAAP-WS-DATES.
 11581*****COPY ELCGAPM2.
 11582
 11583 REIN-DATE-LOAD.
*11584     COPY ELCRENM1.
 11585******************************************************************04/15/98
 11586*                                                                *ELCRENM1
 11587*                                                                *ELCRENM1
 11588*                            ELCRENM1                            *   LV002
 11589*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 11590*                            VMOD=2.001                          *ELCRENM1
 11591*                                                                *ELCRENM1
 11592*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 11593*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 11594*                                                                *ELCRENM1
 11595******************************************************************ELCRENM1
 11596     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 11597     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 11598     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 11599                                                                  ELCRENM1
 11600
 11601 LOAD-ALPHA-WS-DATES.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 219
* ECS050.cbl
*11602     COPY ELCAEXM1.
 11603******************************************************************04/14/98
 11604*                                                                *ELCAEXM1
 11605*                            ELCAEXM1                            *   LV002
 11606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 11607*                            VMOD=2.001                          *ELCAEXM1
 11608*                                                                *ELCAEXM1
 11609*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCAEXM1
 11610*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCAEXM1
 11611*                                                                *ELCAEXM1
 11612*  NO  CID  MODS  IN  COPYBOOK  ELCAEXM1                         *ELCAEXM1
 11613******************************************************************ELCAEXM1
 11614     MOVE AX-DT         TO  WS-AX-DT-N.                              CL**2
 11615     MOVE AX-LF-CNCL    TO  WS-AX-LF-CNCL-N.                         CL**2
 11616     MOVE AX-DEATH      TO  WS-AX-DEATH-N.                           CL**2
 11617     MOVE AX-LF-EXIT    TO  WS-AX-LF-EXIT-N.                         CL**2
 11618     MOVE AX-LF-EXPIRES TO  WS-AX-LF-EXPIRES-N.                      CL**2
 11619     MOVE AX-AH-CNCL    TO  WS-AX-AH-CNCL-N.                         CL**2
 11620     MOVE AX-LUMP-SUM   TO  WS-AX-LUMP-SUM-N.                        CL**2
 11621     MOVE AX-AH-EXIT    TO  WS-AX-AH-EXIT-N.                         CL**2
 11622     MOVE AX-AH-EXPIRES TO  WS-AX-AH-EXPIRES-N.                      CL**2
 11623     MOVE AX-ENTRY      TO  WS-AX-ENTRY-N.                           CL**2
 11624                                                                  ELCAEXM1
 11625
 11626*UNLOAD-ALPHA-WS-DATES.
 11627*****COPY ELCAEXM2.
 11628
 11629*LOAD-CERT-WS-DATES.
 11630*****COPY ELCCRTM1.
 11631
 11632*UNLOAD-CERT-WS-DATES.
 11633*****COPY ELCCRTM2.
 11634
 11635 9900-CLOSE-FILES.
 11636
 11637     DISPLAY '     '.
 11638     DISPLAY '     '.
 11639     DISPLAY '     '.
 11640     DISPLAY 'GREATEST REMAINING TERM-LIFE: ' OLDEST-LF-REMTERM.
 11641     DISPLAY '     '.
 11642     DISPLAY '    REMAINING TERMS OVER 100: ' LF-OVER-100.
 11643     DISPLAY '     '.
 11644     DISPLAY '     '.
 11645     DISPLAY 'GREATEST REMAINING TERM- A&H: ' OLDEST-AH-REMTERM.
 11646     DISPLAY '     '.
 11647     DISPLAY '     '.
 11648
 11649     CLOSE ERACCTT
 11650           CERT-MASTER
 11651           PRINTER.
 11652
 11653     IF DTE-PGM-OPT = ('1' OR '3')
 11654         CLOSE ALPHA-EXTRACT.
 11655
 11656     IF DTE-PGM-OPT = ('2' OR '3')
 11657         CLOSE GAAP-EXTRACT.
 11658
 11659     IF REIN-OPEN-SW = 'X'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 220
* ECS050.cbl
 11660         CLOSE ERRTBL-IN
 11661         IF ERRTBL-FILE-STATUS NOT = '00'
 11662             MOVE '22'               TO W-ABEND-CODE-1
 11663             MOVE ERRTBL-FILE-STATUS TO W-ABEND-CODE-2
 11664             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11665             GO TO ABEND-PGM.
 11666
 11667     MOVE 'C'                    TO CP-IO-FUNCTION.
 11668     PERFORM 3090-CALL-RATING-ROUTINE THRU 3099-EXIT.
 11669     IF IO-ERROR
 11670         MOVE 0302               TO WS-RETURN-CODE
 11671         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 11672                                 TO WS-ABEND-MESSAGE
 11673         GO TO ABEND-PGM.
 11674
 11675 9990-CLOSE-FICH.
*11676                             COPY ELCPRTC.
 11677******************************************************************04/15/98
 11678*                                                                *ELCPRTC
 11679*                                                                *ELCPRTC
 11680*                            ELCPRTC.                            *   LV003
 11681*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 11682*                            VMOD=2.002                          *   CL**2
 11683*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 11684*                                                                *ELCPRTC
 11685* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 11686******************************************************************ELCPRTC
 11687                                                                  ELCPRTC
 11688      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 11689          CLOSE FICH.                                             ELCPRTC
 11690                                                                  ELCPRTC
 11691******************************************************************ELCPRTC
 11692
 11693 9999-END-OF-JOB.
 11694
 11695     DISPLAY ' ADJUSTED AGES ' WS-AGE-ADJUST
 11696     IF ME-DO-UPDATE
 11697         MOVE DTE-CLIENT         TO ME-COMPANY
 11698         MOVE MONTH-END-MOYR     TO ME-MOYR
 11699         READ ERMEBL
 11700         IF ERMEBL-FILE-STATUS NOT = '00'
 11701             MOVE 'N'            TO ME-UPDATE-FLAG
 11702             CLOSE ERMEBL.
 11703
 11704     IF ME-DO-UPDATE
 11705         MOVE F-TOT-READ         TO ME-050-CERT-IN
 11706                                    ME-050-CERT-OUT
 11707         MOVE ME-START-TIME      TO ME-050-START
 11708         MOVE ME-CNDS-DATE       TO ME-050-RUN-DT
 11709         ACCEPT WS-TIME-OF-DAY   FROM TIME
 11710         MOVE WS-TIME            TO ME-050-END
 11711         ADD 1                   TO ME-050-RUN-CT
 11712         REWRITE MONTH-END-BALANCES
 11713         CLOSE ERMEBL
 11714         DISPLAY 'MONTH-END BALANCES POSTED'
 11715     ELSE
 11716         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 11717
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:56 Page 221
* ECS050.cbl
 11718     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  199
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1759412     Code:       59021
