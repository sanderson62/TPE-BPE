* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    83* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    84******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   4
* ECS010.cbl
    86 ENVIRONMENT DIVISION.
    87 CONFIGURATION SECTION.
    88 SPECIAL-NAMES.
    89     C02 IS LCP-CH2
    90     C03 IS LCP-CH3
    91     C04 IS LCP-CH4
    92     C05 IS LCP-CH5
    93     C06 IS LCP-CH6
    94     C07 IS LCP-CH7
    95     C08 IS LCP-CH8
    96     C09 IS LCP-CH9
    97     C10 IS LCP-CH10
    98     C11 IS LCP-CH11
    99     C12 IS LCP-CH12
   100     S01 IS LCP-P01
   101     S02 IS LCP-P02.
   102
   103 INPUT-OUTPUT SECTION.
   104 FILE-CONTROL.
   105
   106     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   107
   108     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   109
   110     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   111                             ACCESS IS SEQUENTIAL
   112                             ORGANIZATION IS INDEXED
   113                             FILE STATUS IS ERACCTT-FILE-STATUS
   114                             RECORD KEY IS AM-CONTROL-PRIMARY.
   115
   116     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   117                             ACCESS IS DYNAMIC
   118                             ORGANIZATION IS INDEXED
   119                             FILE STATUS IS ERRTBL-FILE-STATUS
   120                             RECORD KEY IS RE-CONTROL-PRIMARY.
   121
   122     SELECT ERCTBL           ASSIGN TO ERCTBLT
   123                             ACCESS IS DYNAMIC
   124                             ORGANIZATION IS INDEXED
   125                             FILE STATUS IS ERCTBL-FILE-STATUS
   126                             RECORD KEY IS CT-CONTROL-PRIMARY.
   127
   128     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   129                             ORGANIZATION INDEXED
   130                             ACCESS DYNAMIC
   131                             RECORD KEY ME-CONTROL-PRIMARY
   132                             FILE STATUS ERMEBL-FILE-STATUS.
   133
   134     SELECT ERRESC-IN        ASSIGN TO ERRESC
   135                             ORGANIZATION IS INDEXED
   136                             ACCESS IS DYNAMIC
   137                             RECORD KEY IS ERRESC-RECORD-KEY
   138                             FILE STATUS IS ERRESC-FILE-STATUS.
   139
   140     SELECT ELCRTT           ASSIGN TO ELCRTT
   141                             ACCESS IS DYNAMIC
   142                             ORGANIZATION IS INDEXED
   143                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   5
* ECS010.cbl
   144                             RECORD KEY IS CS-CONTROL-PRIMARY.
   145
   146     SELECT ERAGTC           ASSIGN TO ERAGTC
   147                             ACCESS IS DYNAMIC
   148                             ORGANIZATION IS INDEXED
   149                             FILE STATUS IS ERAGTC-FILE-STATUS
   150                             RECORD KEY IS AG-CONTROL-PRIMARY.
   151
   152     SELECT ERPDEF           ASSIGN TO ERPDEF
   153                             ACCESS IS DYNAMIC
   154                             ORGANIZATION IS INDEXED
   155                             FILE STATUS IS ERPDEF-FILE-STATUS
   156                             RECORD KEY IS PD-CONTROL-PRIMARY.
   157
   158     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   159
   160     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   161
   162     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   163
   164     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   165
   166
   167     SELECT ME-ECS010-BALANCE
   168                             ASSIGN TO SYS012
   169                             ORGANIZATION IS LINE SEQUENTIAL.
   170
   171     SELECT ME50-ECS010-BALANCE
   172                             ASSIGN TO SYS013
   173                             ORGANIZATION IS LINE SEQUENTIAL.
   174
   175     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   176
   177     SELECT DISK-DATE        ASSIGN TO SYS019.
   178
   179     SELECT PRINT-COPY       ASSIGN TO SYS008.
   180
   181     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   182
   183     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   6
* ECS010.cbl
   185 DATA DIVISION.
   186 FILE SECTION.
   187
   188 FD  PENDING-EXTRACT
   189     BLOCK CONTAINS 0 RECORDS
   190     RECORDING MODE F.
   191
*  192                             COPY ERCEXTD.
   193******************************************************************04/29/98
   194*                                                                *ERCEXTD
   195*                                                                *ERCEXTD
   196*                            ERCEXTD                             *   LV002
   197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   198*                            VMOD=2.002                          *   CL**2
   199*                                                                *ERCEXTD
   200*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   201*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   202*                                                                *ERCEXTD
   203*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   204*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   205*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   206*                                                                *ERCEXTD
   207*         RECORD                                                 *ERCEXTD
   208*          TYPE          PROGRAM USING                           *ERCEXTD
   209*        --------        --------------------------------        *ERCEXTD
   210*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   211*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   212*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   213*                                                                *ERCEXTD
   214* -------------------------------------------------------------- *ERCEXTD
   215*                                                                *ERCEXTD
   216*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   217*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   218*                                                                *ERCEXTD
   219*   FILENAME = EREXTD                                            *ERCEXTD
   220*                                                                *ERCEXTD
   221******************************************************************ERCEXTD
   222                                                                  ERCEXTD
   223 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   224     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   225         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   226                                                                  ERCEXTD
   227     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   228         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   229         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   230         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   231                                                                  ERCEXTD
   232     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   233                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   7
* ECS010.cbl
   235 FD  CERT-MASTER-IN
*  236                             COPY ECSCRIFD.
   237******************************************************************07/10/97
   238*                                                                *ECSCRIFD
   239*                            ECSCRIFD                            *   LV001
   240*                            VMOD 2.005                          *ECSCRIFD
   241*                                                                *ECSCRIFD
   242*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   243*                                                                *ECSCRIFD
   244******************************************************************ECSCRIFD
   245     BLOCK CONTAINS 0 RECORDS
   246     RECORDING MODE F.                                            ECSCRIFD
   247                                                                  ECSCRIFD
   248 01  CERT-IN-RECORD.                                              ECSCRIFD
   249                                                                  ECSCRIFD
   250     12  FILLER                            PIC XXX.               ECSCRIFD
   251     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   252     12  FILLER                            PIC X(66).             ECSCRIFD
   253     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   254     12  FILLER                            PIC X(20).             ECSCRIFD
   255     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   256     12  FILLER                            PIC X(14).             ECSCRIFD
   257     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   258     12  FILLER                            PIC X(39).             ECSCRIFD
   259     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   260     12  FILLER                            PIC X(45).             ECSCRIFD
   261     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   262     12  FILLER                            PIC X(35).             ECSCRIFD
   263     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   264     12  FILLER                            PIC X(41).             ECSCRIFD
   265     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   266     12  FILLER                            PIC X(48).             ECSCRIFD
   267     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   268     12  FILLER                            PIC X(9).              ECSCRIFD
   269     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   270     12  FILLER                            PIC X(120).            ECSCRIFD
   271     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   272     12  FILLER                            PIC X(73).             ECSCRIFD
   273     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   274     12  FILLER                            PIC X(464).            ECSCRIFD
   275                                                                  ECSCRIFD
   276******************************************************************ECSCRIFD
   277
   278 01  CI-RECORD.
   279     12  FILLER          PIC  X(03).
   280     12  CI-ACCOUNT-CONTROL.
   281         16  CI-CARRIER      PIC  X(01).
   282         16  CI-GROUPING     PIC  X(06).
   283         16  CI-STATE        PIC  X(02).
   284         16  CI-ACCOUNT      PIC  X(10).
   285     12  FILLER          PIC  X(06).
   286     12  CI-CERT-NO.
   287         16  CI-CERT     PIC X(10).
   288         16  CI-CERT-SFX PIC X.
   289     12  FILLER          PIC  X(1017).
   290
   291******************************************************
   292*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   8
* ECS010.cbl
   293*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   294*   COMMERCIAL FEDERAL BANK
   295******************************************************
   296 01  CF-RECORD.
   297     12  FILLER          PIC X(759).
   298     12  CF-THIRD-AGENT  PIC X(10).
   299     12  FILLER          PIC X(7).
   300     12  CF-FOURTH-AGENT PIC X(10).
   301     12  FILLER          PIC X(270).
   302
   303******************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   9
* ECS010.cbl
   305 FD  ERACCTT-IN.
   306
*  307                             COPY ERCACCT.
   308******************************************************************04/19/98
   309*                                                                *ERCACCT
   310*                                                                *ERCACCT
   311*                            ERCACCT                             *   LV031
   312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   313*                            VMOD=2.031                          *ERCACCT
   314*                                                                *ERCACCT
   315*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   316*                                                                *ERCACCT
   317*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   318*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   319*                                                                *ERCACCT
   320*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   321*                                                                *ERCACCT
   322*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   323*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   324*                                                                *ERCACCT
   325*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   326*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   327*                                                                *ERCACCT
   328*   LOG = NO                                                     *ERCACCT
   329*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   330*                                                                *ERCACCT
   331*                                                                *ERCACCT
   332******************************************************************ERCACCT
   333*                   C H A N G E   L O G
   334*
   335* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   336*-----------------------------------------------------------------
   337*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   338* EFFECTIVE    NUMBER
   339*-----------------------------------------------------------------
   340* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   341* 092705    2005050300006  PEMA  ADD SPP LEASES
   342* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   343* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   344* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   345* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   346* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   347******************************************************************
   348                                                                  ERCACCT
   349 01  ACCOUNT-MASTER.                                              ERCACCT
   350     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   351         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   352                                                                  ERCACCT
   353     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   354         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   355         16  AM-MSTR-CNTRL.                                       ERCACCT
   356             20  AM-CONTROL-A.                                    ERCACCT
   357                 24  AM-CARRIER            PIC X.                 ERCACCT
   358                 24  AM-GROUPING.                                 ERCACCT
   359                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   360                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   361                 24  AM-STATE              PIC XX.                ERCACCT
   362                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   363                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   364                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   365             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   366                                           PIC X(19).             ERCACCT
   367             20  AM-CNTRL-B.                                      ERCACCT
   368                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   369                 24  FILLER                PIC X(4).              ERCACCT
   370             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   371                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   372                                                                  ERCACCT
   373     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   374         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   375         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   376         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   377         16  AM-VG-STATE                   PIC XX.                ERCACCT
   378         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   379         16  AM-VG-DATE.                                          ERCACCT
   380             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   381             20  FILLER                    PIC X(4).              ERCACCT
   382         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   383                                           PIC 9(11)      COMP-3. ERCACCT
   384     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   385         16  FILLER                        PIC X(10).
   386         16  AM-VG-KEY3.
   387             20  AM-VG3-ACCOUNT            PIC X(10).
   388             20  AM-VG3-EXP-DT             PIC XX.
   389         16  FILLER                        PIC X(4).
   390     12  AM-MAINT-INFORMATION.                                    ERCACCT
   391         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   392         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   393         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   394         16  FILLER                        PIC XX.                ERCACCT
   395                                                                  ERCACCT
   396     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   397     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   398                                                                  ERCACCT
   399     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   400         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   401         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   402                                                                  ERCACCT
   403     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   404     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   405                                                                  ERCACCT
   406     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   407     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   408                                                                  ERCACCT
   409     12  AM-NAME                           PIC X(30).             ERCACCT
   410     12  AM-PERSON                         PIC X(30).             ERCACCT
   411     12  AM-ADDRS                          PIC X(30).             ERCACCT
   412     12  AM-CITY.
   413         16  AM-ADDR-CITY                  PIC X(28).
   414         16  AM-ADDR-STATE                 PIC XX.
   415     12  AM-ZIP.                                                  ERCACCT
   416         16  AM-ZIP-PRIME.                                        ERCACCT
   417             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   418                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   419             20  FILLER                    PIC X(4).              ERCACCT
   420         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   421     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   422         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   423         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   424         16  FILLER                        PIC XXX.               ERCACCT
   425     12  AM-TEL-NO.                                               ERCACCT
   426         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   427         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   428         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   429     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   430         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   431         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   432                                                                  ERCACCT
   433     12  AM-COMM-STRUCTURE.                                       ERCACCT
   434         16  AM-DEFN-1.                                           ERCACCT
   435             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   436                 24  AM-AGT.                                      ERCACCT
   437                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   438                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   439                 24  AM-COM-TYP            PIC X.                 ERCACCT
   440                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   441                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   442                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   443                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   444                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   445                 24  AM-GL-CODES           PIC X.                 ERCACCT
   446                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   447                 24  FILLER                PIC X(01).             ERCACCT
   448         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   449             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   450                 24  FILLER                PIC X(11).             ERCACCT
   451                 24  AM-L-COMA             PIC XXX.               ERCACCT
   452                 24  AM-J-COMA             PIC XXX.               ERCACCT
   453                 24  AM-A-COMA             PIC XXX.               ERCACCT
   454                 24  FILLER                PIC X(6).              ERCACCT
   455                                                                  ERCACCT
   456     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   457         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   458                                                                  ERCACCT
   459     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   460                                                                  ERCACCT
   461     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   462         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   463         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   464     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   465         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   466         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   467     12  AM-GPCD                           PIC 99.                ERCACCT
   468     12  AM-IG                             PIC X.                 ERCACCT
   469         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   470         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   471     12  AM-STATUS                         PIC X.                 ERCACCT
   472         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   473         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   474         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   475         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   476         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   477         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   478     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   479     12  AM-ID-NO                          PIC X(11).             ERCACCT
   480                                                                  ERCACCT
   481     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   482     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   483     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   484     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   485     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   486     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   487     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   488     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   489     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   490                                                                  ERCACCT
   491     12  AM-USER-FIELDS.                                          ERCACCT
   492         16  AM-FLD-1                      PIC XX.                ERCACCT
   493         16  AM-FLD-2                      PIC XX.                ERCACCT
   494         16  AM-FLD-3                      PIC XX.                ERCACCT
   495         16  AM-FLD-4                      PIC XX.                ERCACCT
   496         16  AM-FLD-5                      PIC XX.                ERCACCT
   497                                                                  ERCACCT
   498     12  AM-1ST-PROD-DATE.                                        ERCACCT
   499         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   500         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   501         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   502     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   503     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   504         16  AM-PUR-YR                     PIC XX.                ERCACCT
   505         16  AM-PUR-MO                     PIC XX.                ERCACCT
   506         16  AM-PUR-DA                     PIC XX.                ERCACCT
   507     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   508     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   509     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   510     12  AM-INACTIVE-DATE.                                        ERCACCT
   511         16  AM-INA-MO                     PIC 99.                ERCACCT
   512         16  AM-INA-DA                     PIC 99.                ERCACCT
   513         16  AM-INA-YR                     PIC 99.                ERCACCT
   514     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   515                                                                  ERCACCT
   516     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   517     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   518                                                                  ERCACCT
   519     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   520         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   521         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   522         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   523         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   524                                                                  ERCACCT
   525     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   526         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   527         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   528                                                                  ERCACCT
   529     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   530                                                                  ERCACCT
   531     12  AM-OVER-SHORT.                                           ERCACCT
   532         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   533         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   534                                                                  ERCACCT
   535     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   536     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   537                                                                  ERCACCT
   538     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   539     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   540                                                                  ERCACCT
   541     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   542     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   543     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   544     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   545     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   546     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   547     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   548     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   549     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   550     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   551     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   552     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   553     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   554     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   555     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   556     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   557                                                                  ERCACCT
   558     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   559                                                                  ERCACCT
   560     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   561     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   562                                                                  ERCACCT
   563     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   564     12  AM-EARN-METHODS.                                         ERCACCT
   565         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   566             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   567             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   568             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   569             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   570         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   571             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   572             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   573             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   574             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   575         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   576             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   577             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   578             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   579             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   580             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   581             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   582                                                                  ERCACCT
   583     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   584     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   585     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   586                                                                  ERCACCT
   587     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   588     12  AM-RET-P-E                        PIC X.                 ERCACCT
   589     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   590     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   591     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   592     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   593         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   594         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   595     12  AM-RETRO-EARNINGS.                                       ERCACCT
   596         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   597         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   598         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   599     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   600         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   601         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   602     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   603         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   604         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   605         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   606     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   607     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   608                                                                  ERCACCT
   609     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   610         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   611         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   612         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   613         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   614         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   615                                                                  ERCACCT
   616     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   617                                                                  ERCACCT
   618     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   619                                                                  ERCACCT
   620     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   621         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   622                                                                  ERCACCT
   623     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   624         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   625         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   626                                                                  ERCACCT
   627     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   628         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   629                                                                  ERCACCT
   630     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   631         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   632         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   633                                                                  ERCACCT
   634     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   635                                                                  ERCACCT
   636     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   637     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   638     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   639     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   640     12  AM-DCC-UEF-STATE                  PIC XX.
   641     12  FILLER                            PIC XXX.
   642     12  AM-REPORT-CODE-3                  PIC X(10).
   643*    12  FILLER                            PIC X(22).             ERCACCT
   644                                                                  ERCACCT
   645     12  AM-RESERVE-DATE.                                         ERCACCT
   646         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   647         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   648         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   649                                                                  ERCACCT
   650     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   651     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   652         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   653         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   654         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   655         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   656                                                                  ERCACCT
   657     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   658         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   659         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   660         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   661         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   662                                                                  ERCACCT
   663     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   664         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   665             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   666             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   667             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   668             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   669             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   670             20  FILLER                    PIC XX.                ERCACCT
   671         16  FILLER                        PIC X(80).             ERCACCT
   672                                                                  ERCACCT
   673     12  AM-TRANSFER-DATA.                                        ERCACCT
   674         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   675             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   676             20  AM-TRNFROM-GROUPING.                             ERCACCT
   677                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   678                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   679             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   680             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   681                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   682                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   683             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   684         16  AM-TRANSFERRED-TO.                                   ERCACCT
   685             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   686             20  AM-TRNTO-GROUPING.                               ERCACCT
   687                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   688                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   689             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   690             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   691                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   692                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   693             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   694         16  FILLER                        PIC X(10).             ERCACCT
   695                                                                  ERCACCT
   696     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   697                                                                  ERCACCT
   698     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   699         16  AM-DEFN-1-SAVED.                                     ERCACCT
   700             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   701                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   702                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   703                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   704                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   705                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   706                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   707                 24  FILLER                PIC X.                 ERCACCT
   708                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   709                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   710                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   711         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   712             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   713                 24  FILLER                PIC X(11).             ERCACCT
   714                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   715                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   716                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   717                 24  FILLER                PIC X(6).              ERCACCT
   718                                                                  ERCACCT
   719     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   720         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   721            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   722            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   723            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   724                                                                  ERCACCT
   725     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   726     12  FILLER                            PIC X(120).            ERCACCT
   727                                                                  ERCACCT
   728     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   729         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   730         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   731             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   732             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   733                                                          COMP-3. ERCACCT
   734             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   735                                                          COMP-3. ERCACCT
   736         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   737             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   738             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   739                                                          COMP-3. ERCACCT
   740             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   741                                                          COMP-3. ERCACCT
   742                                                                  ERCACCT
   743     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   744         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   745         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   746         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   747         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   748             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   749                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   750                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   751             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   752                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   753                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   754             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   755                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   756                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   757         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   758             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   759                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   760                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   761                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   762             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   763                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   764                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   765             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   766                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   767                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   768                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   769     12  AM-COMMENTS.                                             ERCACCT
   770         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   771                                                                  ERCACCT
   772     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   773         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   774         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   775         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   776         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   777         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   778             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   779             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   780             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   781             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   782         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   783             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   784             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   785             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   786         16  FILLER                        PIC X(102).            ERCACCT
   787                                                                  ERCACCT
   788     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   789         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   790             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   791             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   792             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   793             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   794             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   795         16  FILLER                          PIC X(10).           ERCACCT
   796******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  18
* ECS010.cbl
   798 FD  ERRTBL-IN.
   799
*  800                             COPY ERCREIN.
   801******************************************************************07/27/93
   802*                                                                *ERCREIN
   803*                            ERCREIN                             *   LV009
   804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   805*                            VMOD=2.010                          *   CL**9
   806*                                                                *ERCREIN
   807*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   808*                                                                *ERCREIN
   809*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   810*                                                                *ERCREIN
   811*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   812*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   813*                                                                *ERCREIN
   814*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   815*       ALTERNATE PATH = NONE                                    *ERCREIN
   816*                                                                *ERCREIN
   817*   LOG = NO                                                     *ERCREIN
   818*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   819*                                                                *ERCREIN
   820******************************************************************ERCREIN
   821*                   C H A N G E   L O G
   822*
   823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   824*-----------------------------------------------------------------
   825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   826* EFFECTIVE    NUMBER
   827*-----------------------------------------------------------------
   828* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   829* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   830******************************************************************
   831 01  REINSURANCE-RECORD.                                          ERCREIN
   832     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   833         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   834                                                                  ERCREIN
   835     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   836         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   837         16  RE-KEY.                                              ERCREIN
   838             20  RE-CODE                   PIC X.                 ERCREIN
   839                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   840                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   841             20  RE-TABLE                  PIC XXX.               ERCREIN
   842             20  FILLER                    PIC XXX.               ERCREIN
   843         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   844             20  FILLER                    PIC X.                 ERCREIN
   845             20  RE-COMPANY.                                      ERCREIN
   846                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   847                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   848                                                                  ERCREIN
   849     12  RE-MAINT-INFORMATION.                                    ERCREIN
   850         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   851         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   852         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   853         16  FILLER                        PIC X(10).             ERCREIN
   854                                                                  ERCREIN
   855     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   856         16  RE-100-COMP                   PIC 99.                ERCREIN
   857                                                                  ERCREIN
   858         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   859             20  RE-REI-COMP-NO.                                  ERCREIN
   860                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   861                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   862             20  RE-LF-QC                  PIC X.                 ERCREIN
   863             20  RE-AH-QC                  PIC X.                 ERCREIN
   864             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   865             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   866             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   867             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   868             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   869             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   870             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   871             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   872             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   873             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   874             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   875             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   876             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   877             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   878             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   879             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   880             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   881             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   882             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   883             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   884             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   886             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   887             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   888             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   889             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   890             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   891             20  RE-REMAINING              PIC X.                 ERCREIN
   892             20  RE-LF-RUNOFF-SW           PIC X.                      000
   893             20  RE-AH-RUNOFF-SW           PIC X.                      000
   894             20  FILLER                    PIC X(19).                  000
   895                                                                  ERCREIN
   896         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   897         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   898         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   899         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   900             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   901                                                                  ERCREIN
   902         16  FILLER                        PIC X(27).             ERCREIN
   903                                                                  ERCREIN
   904     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   905         16  RE-NAME                       PIC X(30).             ERCREIN
   906         16  RE-LF-PE                      PIC X.                 ERCREIN
   907         16  RE-AH-PE                      PIC X.                 ERCREIN
   908         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   909         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   910         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   911         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   912         16  RE-PRT-ST                     PIC X.                 ERCREIN
   913         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   914         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   915         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   916         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   917         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   918         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   919         16  RE-LF-COMM                    PIC X.                 ERCREIN
   920         16  RE-AH-COMM                    PIC X.                 ERCREIN
   921         16  RE-LF-TAX                     PIC X.                 ERCREIN
   922         16  RE-AH-TAX                     PIC X.                 ERCREIN
   923         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   924         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   925         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   926                                                                  ERCREIN
   927         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   928             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   929                                                                  ERCREIN
   930         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   931             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   932                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   933                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   934                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   935                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   936             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   937                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   938                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   939                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   940                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   941                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   942                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   943                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   944                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   945             20  FILLER                    PIC XXX.               ERCREIN
   946             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   947                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   948                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   949                                                                  ERCREIN
   950         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   951             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   952                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   953                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   954                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   955                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   956             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   957                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   958                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   959                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   960                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   961                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   962                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   963                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   964                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   965             20  FILLER                    PIC XXX.               ERCREIN
   966             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   967                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   968                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   969                                                                  ERCREIN
   970         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   971                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   972         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   973                                                                  ERCREIN
   974         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   975         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   976         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   977         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   978         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   979         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   980         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   981         16  RE-MORT-SW                    PIC X.                 ERCREIN
   982         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   983             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   984             88  RE-CEDED                          VALUE 'C'.        CL**2
   985             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   986             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   987                                                                  ERCREIN
   988         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   989             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   990         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   991             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   992         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   993             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   994         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   995             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   996         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   997             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   998                                                                     CL**3
   999         16  RE-PRT-CRSV                   PIC X.                    CL**5
  1000                                                                     CL**5
  1001         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1002                                                                     CL**8
  1003         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1004                                                                     CL**8
  1005         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1006                                                                     CL**9
  1007         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1008             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1009             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1010
  1011         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1012             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1013                                                                     CL**9
  1014         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1015         16  FILLER                        PIC X(2281).              CL**9
  1016                                                                  ERCREIN
  1017         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1018                                                                  ERCREIN
  1019******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  22
* ECS010.cbl
  1021 FD  ERCTBL.
  1022
* 1023                             COPY ERCCTBL.
  1024******************************************************************04/29/98
  1025*                                                                *ERCCTBL
  1026*                                                                *ERCCTBL
  1027*                            ERCCTBL                             *   LV002
  1028*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1029*                            VMOD=2.003                              CL**2
  1030*                                                                *ERCCTBL
  1031*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1032*                                                                *ERCCTBL
  1033*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1034*                                                                *ERCCTBL
  1035*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1036*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1037*                                                                *ERCCTBL
  1038*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1039*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1040*                                                                *ERCCTBL
  1041*   LOG = NO                                                     *ERCCTBL
  1042*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1043*                                                                *ERCCTBL
  1044*                                                                *ERCCTBL
  1045******************************************************************ERCCTBL
  1046                                                                  ERCCTBL
  1047 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1048     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1049         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1050                                                                  ERCCTBL
  1051     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1052         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1053         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1054         16  CT-CNTRL-2.                                          ERCCTBL
  1055             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1056             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1057                                                                  ERCCTBL
  1058     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1059         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1060         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1061         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1062         16  FILLER                        PIC X(31).             ERCCTBL
  1063                                                                  ERCCTBL
  1064     12  CT-LIMITS.                                               ERCCTBL
  1065         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1066                                                                  ERCCTBL
  1067         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1068                                                                  ERCCTBL
  1069         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1070                                                                  ERCCTBL
  1071     12  CT-RATES.                                                ERCCTBL
  1072         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1073             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1074             20  CT-RT-R   REDEFINES                              ERCCTBL
  1075                 CT-RT                     PIC XXX.               ERCCTBL
  1076                                                                  ERCCTBL
  1077     12  FILLER                            PIC  X(42).            ERCCTBL
  1078                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  23
* ECS010.cbl
  1079******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  24
* ECS010.cbl
  1081 FD  ERMEBL-INOUT.
  1082
* 1083                             COPY ERCMEBL.
  1084******************************************************************04/29/98
  1085*                                                                 ERCMEBL
  1086*                                                                 ERCMEBL
  1087*                            ERCMEBL                             *   LV004
  1088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1089*                            VMOD 2.004                          *   CL**2
  1090*                                                                *ERCMEBL
  1091*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1092*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1093*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1094*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1095*                                                                *ERCMEBL
  1096*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1097*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1098*                                                                *ERCMEBL
  1099*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1100*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1101*                                                                *ERCMEBL
  1102******************************************************************ERCMEBL
  1103                                                                  ERCMEBL
  1104 01  MONTH-END-BALANCES.                                          ERCMEBL
  1105     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1106     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1107         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1108         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1109     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1110     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1111     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1112     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1113     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1117     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1118     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1119     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1120     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1121     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1122     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1123     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1124     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1125     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1126     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1127     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1128     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1129     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1130     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1131     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1132     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1133     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1134     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1135     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1136     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1137     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1138     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1139     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1140     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1141     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1142     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1143     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1144     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1145     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1146     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1147     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1148     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1149     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1150     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1151     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1152     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1153     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1154     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1155     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1156     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1157     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1158     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1159     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1160     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1161     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1162     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1163     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1164     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1165     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1166     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1167     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1168     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1169     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1170     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1171     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1172     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1173     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1174     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1175     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1176     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1177     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1178     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1179     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1180     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1181     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1182     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1183     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1184     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1185     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1186     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1187     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1188     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1189     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1190     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1191     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1192     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1193     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1194     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1195     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1196     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1197     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1198     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1199     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1200     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1201     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1202     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1203     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1204     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1205     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1206     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1207     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1208     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1209     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1210     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1211     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1212     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1213     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1214     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1215     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1216     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1217     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1218     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1219     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1220     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1221     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1222     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1223     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1224     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1225     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1226     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1227     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1235     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1236     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1237     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1238     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1239     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1240     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1241     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1242     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1243     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1244     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1245     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1246     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1247     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1248     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1249     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1250     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1251     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1252     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1253     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1254     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1255     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1256     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1257     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1258     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1259     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1260     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1261     12  FILLER                  PIC  X(88).                         CL**2
  1262******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  28
* ECS010.cbl
  1264 FD  CERT-MASTER-OUT
* 1265                             COPY ECSCROFD.
  1266******************************************************************07/10/97
  1267*                                                                *ECSCROFD
  1268*                            ECSCROFD                            *   LV001
  1269*                            VMOD=2.002                          *ECSCROFD
  1270*                                                                *ECSCROFD
  1271*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1272*                                                                *ECSCROFD
  1273******************************************************************ECSCROFD
  1274     RECORDING MODE F                                             ECSCROFD
  1275     LABEL RECORDS STANDARD                                       ECSCROFD
  1276     BLOCK CONTAINS 0 RECORDS
  1277     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1278 01  CERT-OUT-RECORD.                                             ECSCROFD
  1279     12  FILLER                            PIC  XXX.              ECSCROFD
  1280     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1281     12  FILLER                            PIC  X(1017).          ECSCROFD
  1282                                                                  ECSCROFD
  1283******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  29
* ECS010.cbl
  1285 FD  DETAIL-EXTR
  1286     BLOCK CONTAINS 0 RECORDS
  1287     RECORDING MODE F.
  1288
* 1289                             COPY ECSEXT01.
  1290******************************************************************04/29/98
  1291*                                                                *ECSEXT01
  1292*                            ECSEXT01                            *   LV015
  1293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1294*                            VMOD=2.015                          *ECSEXT01
  1295*                                                                *ECSEXT01
  1296*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1297*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1298*                                                                *ECSEXT01
  1299*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1300*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1301*                                                                *ECSEXT01
  1302*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1303*                                                                *ECSEXT01
  1304******************************************************************ECSEXT01
  1305******************************************************************
  1306*                   C H A N G E   L O G
  1307*
  1308* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1309*-----------------------------------------------------------------
  1310*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1311* EFFECTIVE    NUMBER
  1312*-----------------------------------------------------------------
  1313* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1314* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1315* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1316* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1317* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1318* 032612  CR2011110200001  PEMA  AHL CHANGES
  1319******************************************************************
  1320                                                                  ECSEXT01
  1321 01  DETAIL-EXTRACT.                                              ECSEXT01
  1322     02 DETAIL-FILE.                                              ECSEXT01
  1323     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1324         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1325                                                                  ECSEXT01
  1326     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1327                                                                  ECSEXT01
  1328     12  DE-REIN                           PIC X.                 ECSEXT01
  1329                                                                  ECSEXT01
  1330     12  DE-CONTROL.                                              ECSEXT01
  1331         16  DE-CNTRL1.                                           ECSEXT01
  1332             20  DE-CARRIER                PIC X.                 ECSEXT01
  1333             20  DE-GROUPING.                                     ECSEXT01
  1334                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1335                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1336             20  DE-STATE                  PIC XX.                ECSEXT01
  1337             20  DE-ACCOUNT.                                      ECSEXT01
  1338                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1339                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1340         16  DE-CNTRL2.                                           ECSEXT01
  1341             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1342             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1343                 24 DE-CERT-NO.                                   ECSEXT01
  1344                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1345                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1346                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1347                                                                  ECSEXT01
  1348     12  DE-TRANS                          PIC X.                 ECSEXT01
  1349         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1350         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1351         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1352         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1353         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1354         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1355         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1356         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1357         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1358         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1359                                                                  ECSEXT01
  1360     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1361     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1362                                                                  ECSEXT01
  1363     12  DE-NAME.                                                 ECSEXT01
  1364         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1365         16  DE-FNAME.                                            ECSEXT01
  1366             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1367             20  FILLER                    PIC X(9).              ECSEXT01
  1368         16  DE-INIT                       PIC X.                 ECSEXT01
  1369     12  DE-AGE                            PIC 99.                ECSEXT01
  1370     12  DE-SEX                            PIC X.                 ECSEXT01
  1371     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1372                                                                  ECSEXT01
  1373     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1374     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1375     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1376     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1377     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1378     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1379     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1380     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1381     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1382                                                                  ECSEXT01
  1383     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1384     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1385     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1386     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1387                                                                  ECSEXT01
  1388     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1389     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1390     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1391     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1392     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1393                                                                  ECSEXT01
  1394     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1395     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1396     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1397     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1398                                                                  ECSEXT01
  1399     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1400     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1401                                           PIC S9(5)V99   COMP-3.
  1402     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1403     12  FILLER REDEFINES DE-NUM-BILLED.
  1404         16  DE-CLP-STATE                  PIC XX.
  1405         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1406     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1407     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1408                                                                  ECSEXT01
  1409     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1410     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1411     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1412     12  DE-IG                             PIC X.                 ECSEXT01
  1413     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1414*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1415     12  DE-MEMBER-NO.                                            ECSEXT01
  1416         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1417         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1418         16  FILLER                        PIC X(03).             ECSEXT01
  1419     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1420                                                                  ECSEXT01
  1421     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1422         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1423                                                                  ECSEXT01
  1424     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1425     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1426                                                                  ECSEXT01
  1427     12  DE-REI-AREA.                                             ECSEXT01
  1428         16  DE-REI-COMP.                                         ECSEXT01
  1429             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1430             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1431         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1432         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1433         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1434         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1435         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1436         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1437         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1438                                                                  ECSEXT01
  1439     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1440     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1441         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1442         16  F                             PIC X.
  1443*    12  FILLER                            PIC X(5).              ECSEXT01
  1444                                                                  ECSEXT01
  1445     12  DE-BILLED-AREA.                                          ECSEXT01
  1446         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1447             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1448                                                                  ECSEXT01
  1449         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1450             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1451             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1452             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1453             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1454             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1455             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1456                                                                  ECSEXT01
  1457         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1458             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1459                                                                  ECSEXT01
  1460         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1461         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1462         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1463         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1464                                                                  ECSEXT01
  1465         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1466*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1467*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1468                                                                  ECSEXT01
  1469     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1470         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1471         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1472         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1473                                                                  ECSEXT01
  1474     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1475         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1476         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1477     12  DE-CANCEL-REASON                  PIC X.
  1478                                                                  ECSEXT01
  1479     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1480     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1481                                                                  ECSEXT01
  1482     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1483         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1484             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1485         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1486             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1487                                                                  ECSEXT01
  1488     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1489         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1490                                                                  ECSEXT01
  1491     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1492     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1493         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1494         16  FILLER                        PIC X.
  1495                                                                  ECSEXT01
  1496****************************************************************  ECSEXT01
  1497**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1498****************************************************************  ECSEXT01
  1499     12  DE-COMM-LEVELS.                                          ECSEXT01
  1500         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1501             20  DE-AGT.                                          ECSEXT01
  1502                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1503                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1504             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1505             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1506             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1507                                                                  ECSEXT01
  1508     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1509****************************************************************  ECSEXT01
  1510*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1511****************************************************************  ECSEXT01
  1512     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1513     12  FILLER                            PIC X(334).            ECSEXT01
  1514     12  DE-TYPE                           PIC X.                 ECSEXT01
  1515         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1516         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1517         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1518         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1519         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1520         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1521                                                                  ECSEXT01
  1522     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1523     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1524                                                                  ECSEXT01
  1525     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1526     12  DE-REPORTED.                                             ECSEXT01
  1527         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1528         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1529         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1530     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1531     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1532                                                                  ECSEXT01
  1533     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1534     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1535     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1536     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1537     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1538     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1539         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1540         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1541         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1542         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1543         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1544         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1545         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1546                                                                  ECSEXT01
  1547     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1548                                                                  ECSEXT01
  1549     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1550     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1551     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1552     12  FILLER                            PIC XX.                ECSEXT01
  1553     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1554                                                                  ECSEXT01
  1555     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1556     12  DE-BENEFICIARY                    PIC X(10).
  1557     12  filler redefines de-beneficiary.
  1558         16  de-birth-date                 pic 9(11)  comp-3.
  1559         16  f                             pic x(4).
  1560     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1561     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1562     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1563     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1564     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1565     12  DE-CLM-CLASS                      PIC XX.
  1566     12  DE-CLM-DEV                        PIC XXX.
  1567     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1568     12  de-xycor-cert-seq                 pic x(3).
  1569     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1570     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1571     12  DE-XYCOR-STATUS                   PIC X.
  1572     12  FILLER                            PIC X(4).              ECSEXT01
  1573                                                                  ECSEXT01
  1574     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1575                                                                  ECSEXT01
  1576****************************************************************  ECSEXT01
  1577*******               RESERVE EXTRACT                      *****  ECSEXT01
  1578****************************************************************  ECSEXT01
  1579     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1580     12  FILLER                            PIC X(334).            ECSEXT01
  1581                                                                  ECSEXT01
  1582     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1583         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1584         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1585                                                                  ECSEXT01
  1586     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1587     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1588     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1589                                                                  ECSEXT01
  1590     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1591                                                                  ECSEXT01
  1592     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1593     12  DE-RSV-REPORTED.                                         ECSEXT01
  1594         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1595         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1596         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1597     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1598                                                                  ECSEXT01
  1599     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1600     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1601     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1602                                                                  ECSEXT01
  1603     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1604     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1605     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1606                                                                  ECSEXT01
  1607     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1608                                                                  ECSEXT01
  1609     12  DE-RATE-CLASS                     PIC XX.
  1610     12  DE-DEV-CODE                       PIC XXX.
  1611     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1612     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1613     12  FILLER                            PIC X(58).             ECSEXT01
  1614                                                                  ECSEXT01
  1615     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1616******************************************************************ECSEXT01
  1617
  1618 FD  NEW-DETAIL-EXTR
  1619     BLOCK CONTAINS 0 RECORDS
  1620     RECORDING MODE F.
  1621
* 1622                                 COPY ECSEXX01.
  1623******************************************************************
  1624*                                                                *
  1625*                            ECSEXX01                            *
  1626*                            VMOD=2.015                          *
  1627*                                                                *
  1628*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1629*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1630*                                                                *
  1631*   FILE TYPE = SEQUENTIAL                                       *
  1632*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1633*                                                                *
  1634*   KEY DATA =                                   START=5, LEN=36 *
  1635*                                                                *
  1636******************************************************************
  1637******************************************************************
  1638*                   C H A N G E   L O G
  1639*
  1640* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1641*-----------------------------------------------------------------
  1642*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1643* EFFECTIVE    NUMBER
  1644*-----------------------------------------------------------------
  1645*                                    TEMPORARY
  1646******************************************************************
  1647
  1648 01  NEW-DETAIL-EXTRACT.
  1649     02 NEW-DETAIL-FILE.
  1650     12  DX-RECORD-ID                      PIC XX.
  1651         88  VALID-DX-ID                      VALUE 'DX'.
  1652
  1653     12  DX-COMPANY-CD                     PIC X.
  1654
  1655     12  DX-REIN                           PIC X.
  1656
  1657     12  DX-CONTROL.
  1658         16  DX-CNTRL1.
  1659             20  DX-CARRIER                PIC X.
  1660             20  DX-GROUPING.
  1661                 24  DX-GROUP-PREFIX       PIC XXX.
  1662                 24  DX-GROUP-PRIME        PIC XXX.
  1663             20  DX-STATE                  PIC XX.
  1664             20  DX-ACCOUNT.
  1665                 24  DX-ACCT-PREFIX        PIC X(4).
  1666                 24  DX-ACCT-PRIME         PIC X(6).
  1667         16  DX-CNTRL2.
  1668             20  DX-EFF                    PIC 9(11)  COMP-3.
  1669             20  DX-CERT.
  1670                 24 DX-CERT-NO.
  1671                     28  DX-CRT-PREFIX     PIC XXX.
  1672                     28  DX-CRT-PRIME      PIC X(7).
  1673                 24  DX-CRT-SUF            PIC X.
  1674
  1675     12  DX-TRANS                          PIC X.
  1676         88  DX-ISSUE                         VALUE 'I'.
  1677         88  DX-RC-ISSUE                      VALUE '8'.
  1678         88  DX-CANCEL                        VALUE 'C'.
  1679         88  DX-RC-CANCEL                     VALUE '7'.
  1680         88  DX-CLAIM                         VALUE 'X'.
  1681         88  DX-RESTORE                       VALUE 'R'.
  1682         88  DX-RESERVE                       VALUE 'Y'.
  1683         88  DX-RR-RC-ISS                     VALUE 'J'.
  1684         88  DX-RR-RC-CNC                     VALUE 'K'.
  1685         88  DX-RR-RC-CLM                     VALUE 'L'.
  1686
  1687     12  DX-REPORT-CODX-1                  PIC X(10).
  1688     12  DX-REPORT-CODX-2                  PIC X(10).
  1689
  1690     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1691         16  DX-LNAME                      PIC X(15).
  1692         16  DX-FNAME.
  1693             20  DX-1ST-INIT-FNAME         PIC X.
  1694             20  FILLER                    PIC X(9).
  1695         16  DX-INIT                       PIC X.
  1696     12  DX-AGE                            PIC 99.
  1697     12  DX-SEX                            PIC X.
  1698     12  DX-SOC-SEC-NO                     PIC X(11).
  1699
  1700     12  DX-LF-TYPE                        PIC XX.
  1701     12  DX-LF-TERM                        PIC 999        COMP-3.
  1702     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1703     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1704     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1705     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1706     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1707     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1708     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1709
  1710     12  DX-LF-STAT-CDE                    PIC X.
  1711     12  DX-LF-PREV-STAT                   PIC X.
  1712     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1713     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1714
  1715     12  DX-AH-TYPE                        PIC XX.
  1716     12  DX-AH-TERM                        PIC 999        COMP-3.
  1717     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1718     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1719     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1720
  1721     12  DX-AH-STAT-CDE                    PIC X.
  1722     12  DX-AH-PREV-STAT                   PIC X.
  1723     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1724     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1725
  1726     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1727     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1728                                           PIC S9(5)V99   COMP-3.
  1729     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1730     12  FILLER REDEFINES DX-NUM-BILLED.
  1731         16  DX-CLP-STATE                  PIC XX.
  1732         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1733     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1734     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1735
  1736     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1737     12  DX-PMT-FREQ                       PIC 99.
  1738     12  DX-ACC-GPCD                       PIC XX.
  1739     12  DX-IG                             PIC X.
  1740     12  DX-REMIT-TO                       PIC XX.
  1741*    12  DX-MEMBER-NO                      PIC X(12).
  1742     12  DX-MEMBER-NO.
  1743         16  DX-MASTER-POLICY              PIC X(06).
  1744         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1745         16  FILLER                        PIC X(03).
  1746     12  DX-LN-OFFICER                     PIC XXX.
  1747
  1748     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1749         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1750
  1751     12  DX-ENTRY-STATUS                   PIC X.
  1752     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1753
  1754     12  DX-REI-AREA.
  1755         16  DX-REI-COMP.
  1756             20  DX-REINCO                 PIC XXX.
  1757             20  DX-REINCO-SUB             PIC XXX.
  1758         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1759         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1760         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1761         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1762         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1763         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1764         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1765
  1766     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1767     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1768         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1769         16  F                             PIC X.
  1770*    12  FILLER                            PIC X(5).
  1771
  1772     12  DX-BILLED-AREA.
  1773         16  DX-GL-INTERFACE-CODES.
  1774             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1775
  1776         16  DX-BILL-SW                    PIC X.
  1777             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1778             88  DX-RECORD-RETURNED           VALUE 'R'.
  1779             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1780             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1781             88  DX-OVERRIDX-AH               VALUE 'A'.
  1782             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1783
  1784         16  DX-REFUND-SW                  PIC X.
  1785             88  DX-REFUND-CREATED            VALUE 'Y'.
  1786
  1787         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1788         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1789         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1790         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1791
  1792         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1793*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1794*            88  DX-BILLED-GA                 VALUE 'B'.
  1795
  1796     12  DX-BILL-STATUS                    PIC X.
  1797         88  DX-NO-PRE-BILL                   VALUE ' '.
  1798         88  DX-BILLED                        VALUE 'B'.
  1799         88  DX-REVERSE                       VALUE 'R'.
  1800
  1801     12  DX-REVERSE-REASONS.
  1802         16  DX-REVERSE-REASON-1           PIC X.
  1803         16  DX-REVERSE-REASON-2           PIC X.
  1804     12  DX-CANCEL-REASON                  PIC X.
  1805
  1806     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1807     12  DX-RECALC-TYPE                    PIC X.
  1808
  1809     12  DX-CHARGEBACK-CODES.
  1810         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1811             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1812         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1813             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1814
  1815     12  DX-UNDERWRITING-CODE              PIC X.
  1816         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1817
  1818     12  DX-NCL-POOL-CODE                  PIC XXX.
  1819     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1820         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1821         16  FILLER                        PIC X.
  1822
  1823****************************************************************
  1824**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1825****************************************************************
  1826     12  DX-COMM-LEVELS.
  1827         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1828             20  DX-AGT.
  1829                 24  DX-AGT-PREFIX         PIC X(4).
  1830                 24  DX-AGT-PRIME          PIC X(6).
  1831             20  DX-AGT-TYPE               PIC X.
  1832             20  DX-L-PC                   PIC S999V99    COMP-3.
  1833             20  DX-A-PC                   PIC S999V99    COMP-3.
  1834
  1835     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1836****************************************************************
  1837*******                 CLAIM EXTRACT                      *****
  1838****************************************************************
  1839     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1840     12  FILLER                            PIC X(334).
  1841     12  DX-TYPE                           PIC X.
  1842         88  DX-DTH                           VALUE '1'.
  1843         88  DX-AH                            VALUE '2'.
  1844         88  DX-OB-DTH                        VALUE '3'.
  1845         88  DX-OB-AH                         VALUE '4'.
  1846         88  DX-DEATH                         VALUES '1' '3'.
  1847         88  DX-DISABILITY                    VALUES '2' '4'.
  1848
  1849     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1850     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1851
  1852     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1853     12  DX-REPORTED.
  1854         16  DX-RPT-YR                     PIC 99.
  1855         16  DX-RPT-MO                     PIC 99.
  1856         16  DX-RPT-DA                     PIC 99.
  1857     12  DX-PAY                            PIC 9(11)      COMP-3.
  1858     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1859
  1860     12  DX-CNUM                           PIC X(7).
  1861     12  DX-CHECK                          PIC X(7).
  1862     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1863     12  DX-DAYS-DISAB                     PIC 999.
  1864     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1865     12  DX-PAY-CODE                       PIC X.
  1866         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1867         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1868         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1869         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1870         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1871         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1872         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1873
  1874     12  DX-CLM-ERR                        PIC XX.
  1875
  1876     12  DX-ACC-NAME                       PIC X(30).
  1877     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1878     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1879     12  FILLER                            PIC XX.
  1880     12  DX-LOAN-OFFICER                   PIC XXX.
  1881
  1882     12  DX-LOAN-TYPE                      PIC X(02).
  1883     12  DX-BENEFICIARY                    PIC X(10).
  1884     12  filler redefines DX-beneficiary.
  1885         16  DX-birth-date                 pic 9(11)  comp-3.
  1886         16  f                             pic x(4).
  1887     12  DX-LOAN-CLASS                     PIC X(02).
  1888     12  DX-LOSS-CODE                      PIC X(06).
  1889     12  DX-ASSOCIATES                     PIC X(01).
  1890     12  DX-LEGAL-STATE                    PIC X(02).
  1891     12  DX-CLM-CAUSE                      PIC X(6).
  1892     12  DX-CLM-CLASS                      PIC XX.
  1893     12  DX-CLM-DEV                        PIC XXX.
  1894     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1895     12  DX-xycor-cert-seq                 pic x(3).
  1896     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1897     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1898     12  DX-XYCOR-STATUS                   PIC X.
  1899     12  FILLER                            PIC X(4).
  1900
  1901     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1902
  1903****************************************************************
  1904*******               RESERVE EXTRACT                      *****
  1905****************************************************************
  1906     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1907     12  FILLER                            PIC X(334).
  1908
  1909     12  DX-RESERVE-TYPE                   PIC X.
  1910         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1911         88  DX-AH-RSV                        VALUE '2' '4'.
  1912
  1913     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1914     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1915     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1916
  1917     12  DX-CLMNO                          PIC X(7).
  1918
  1919     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1920     12  DX-RSV-REPORTED.
  1921         16  DX-RSV-RPT-YR                 PIC 99.
  1922         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1923         16  DX-RSV-RPT-DA                 PIC 99.
  1924     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1925
  1926     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1927     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1928     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1929
  1930     12  DX-RSV-ACC-NAME                   PIC X(30).
  1931     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1932     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1933
  1934     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1935
  1936     12  DX-RATE-CLASS                     PIC XX.
  1937     12  DX-DEV-CODE                       PIC XXX.
  1938     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1939     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1940     12  FILLER                            PIC X(58).
  1941
  1942     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1943******************************************************************
  1944
  1945 FD  SUMMARY-EXTR
  1946     BLOCK CONTAINS 0 RECORDS
  1947     RECORDING MODE F.
  1948
* 1949                             COPY ECSEPC01.
  1950******************************************************************
  1951*                                                                *
  1952*                            ECSEPC01                            *
  1953*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1954*                            VMOD=2.008                          *
  1955*                                                                *
  1956*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1957*                                                                *
  1958*   FILE TYPE = SEQUENTIAL                                       *
  1959*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1960*                                                                *
  1961*   KEY DATA =                                  START=5, LEN=31  *
  1962*                                                                *
  1963*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1964*                                                                *
  1965******************************************************************
  1966
  1967 01  EP-RECORD.
  1968     02 EP-FILE.
  1969     12  EP-RECORD-ID                      PIC XX.
  1970         88  VALID-EP-ID                      VALUE 'EP'.
  1971
  1972     12  EP-COMPANY-CD                     PIC X.
  1973
  1974     12  EP-REIN                           PIC X.
  1975         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1976
  1977     12  EP-CONTROL.
  1978         16  EP-CNTRL-1.
  1979             20  EP-COMPANY.
  1980                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  41
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1981                 24  EP-GROUPING.
  1982                     28  EP-GROUP-PREFIX   PIC XXX.
  1983                     28  EP-GROUP-PRIME    PIC XXX.
  1984             20  EP-STATE                  PIC XX.
  1985             20  EP-ACCOUNT.
  1986                 24  EP-ACCT-PREFIX        PIC X(4).
  1987                 24  EP-ACCT-PRIME         PIC X(6).
  1988         16  EP-CNTRL-2.
  1989             20  EP-DATES.
  1990                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1991                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1992
  1993     12  EP-REI-CO.
  1994         16  EP-REINCO                     PIC XXX.
  1995         16  EP-REINCO-SUB                 PIC XXX.
  1996
  1997     12  EP-RCD-TYPE                       PIC X.
  1998         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1999         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  2000         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  2001         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2002         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2003         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2004     12  EP-BEN-CODE                       PIC XX.
  2005     12  FILLER                            PIC X.
  2006
  2007     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2008     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2009     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2010
  2011     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2012     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2013     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2014
  2015     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2016     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2017     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2018     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2019
  2020     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2021     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2022     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2023
  2024     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2025     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2026     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2027
  2028     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2029     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2030     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2031     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2032     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2033
  2034     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2035     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2036     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2037
  2038     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  42
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2039     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2040     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2041
  2042     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2043         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2044         16  EP-NEW-DATA-IND               PIC X(01).
  2045             88  EP-NEW-DATA                   VALUE 'Y'.
  2046         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2047         16  FILLER                        PIC X(19).
  2048
  2049     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2050     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2051     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2052
  2053     12  FILLER                            PIC XXX.
  2054
  2055     12  EP-UNDERWRITING-CODE              PIC X.
  2056         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2057
  2058     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
  2059
  2060     12  FILLER                            PIC X(30).
  2061*    12  FILLER                            PIC X(34).
  2062
  2063     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2064     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2065     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2066     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2067     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2068     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2069
  2070     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2071
  2072     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2073     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2074
  2075     12  EP-PURGE                          PIC X.
  2076         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2077
  2078     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2079
  2080     02 EC-RECORD     REDEFINES     EP-FILE.
  2081     12  EC-RECORD-ID                      PIC XX.
  2082         88  VALID-EC-ID                      VALUE 'EC'.
  2083
  2084     12  EC-COMPANY-CD                     PIC X.
  2085
  2086     12  EC-REIN                           PIC X.
  2087         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2088
  2089     12  EC-CONTROL.
  2090         16  EC-CARRIER                    PIC X.
  2091         16  EC-GROUPING.
  2092             20  EC-GROUP-PREFIX           PIC XXX.
  2093             20  EC-GROUP-PRIME            PIC XXX.
  2094         16  EC-STATE                      PIC XX.
  2095         16  EC-ACCOUNT.
  2096             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  43
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2097             20  EC-ACCT-PRIME             PIC X(6).
  2098         16  EC-DATES.
  2099             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2100             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2101
  2102     12  EC-REI-CO.
  2103         16  EC-REINCO                     PIC XXX.
  2104         16  EC-REINCO-SUB                 PIC XXX.
  2105
  2106     12  EC-RCD-TYPE                       PIC X.
  2107         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2108         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2109         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2110         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2111         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2112     12  EC-BEN-CODE                       PIC XX.
  2113     12  EC-SEQ-NBR                        PIC X.
  2114         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2115         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2116
  2117     12  EC-AGENTS-DATA.
  2118         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2119             20  EC-AGT-NO.
  2120                 24  EC-AGT-PREFIX         PIC X(4).
  2121                 24  EC-AGT-PRIME          PIC X(6).
  2122             20  EC-AGT-TYPE               PIC X.
  2123             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2124             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2125             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2126             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2127             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2128
  2129     12  EC-UNDERWRITING-CODE              PIC X.
  2130         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2131
  2132     12  EC-AGENTS-DATA-II.
  2133         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2134             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2135             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2136
  2137     12  FILLER                            PIC X(7).
  2138
  2139     12  EC-PURGE                          PIC X.
  2140         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2141
  2142     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2143
  2144******************************************************************
  2145
  2146 FD  ERRESC-IN.
* 2147                             COPY ERCRESC.
  2148******************************************************************04/29/98
  2149*                                                                *ERCRESC
  2150*                            ERCRESC                             *   LV002
  2151*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2152*                            VMOD=2.003                          *   CL**2
  2153*                                                                *ERCRESC
  2154*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2155*                                                                *ERCRESC
  2156*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2157*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2158*                                                                *ERCRESC
  2159*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2160*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2161*                                                                *ERCRESC
  2162*   LOG = NO                                                     *ERCRESC
  2163*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2164*                                                                *ERCRESC
  2165******************************************************************ERCRESC
  2166                                                                  ERCRESC
  2167 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2168                                                                  ERCRESC
  2169     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2170         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2171         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2172         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2173         15  RESC-STATE                PIC   XX.                  ERCRESC
  2174         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2175         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2176         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2177         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2178*                                           YYYYMMDD              ERCRESC
  2179     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2180                                                                  ERCRESC
  2181     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2182         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2183             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2184             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2185             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2186                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2187                                                                  ERCRESC
  2188     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2189     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2190     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2191*                                          YYYYMMDD               ERCRESC
  2192 FD  ELCRTT.
  2193
* 2194                             COPY ELCCRTT.
  2195******************************************************************
  2196*                                                                *ELCCRTT
  2197*                            ELCCRTT.                            *
  2198*                                                                *ELCCRTT
  2199*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2200*                                                                *ELCCRTT
  2201*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2202*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2203*                                                                *ELCCRTT
  2204*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2205*                                                                *ELCCRTT
  2206*   LOG = YES                                                    *ELCCRTT
  2207*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2208******************************************************************
  2209*                   C H A N G E   L O G
  2210*
  2211* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2212*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  45
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2213*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2214* EFFECTIVE    NUMBER
  2215*-----------------------------------------------------------------
  2216* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2217* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2218* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2219* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2220* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2221******************************************************************
  2222                                                                  ELCCRTT
  2223 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2224     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2225         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2226                                                                  ELCCRTT
  2227     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2228         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2229         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2230         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2231         16  CS-STATE                      PIC XX.                ELCCRTT
  2232         16  CS-ACCOUNT                    PIC X(10).
  2233         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2234         16  CS-CERT-NO.                                          ELCCRTT
  2235             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2236             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2237         16  CS-TRAILER-TYPE               PIC X.
  2238             88  COMM-TRLR           VALUE 'A'.
  2239             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2240             88  CERT-DATA-TRLR      VALUE 'C'.
  2241                                                                  ELCCRTT
  2242     12  CS-DATA-AREA                      PIC X(516).
  2243
  2244     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2245         16  CS-BANK-COMMISSION-AREA.
  2246             20  CS-BANK-COMMS       OCCURS 10.
  2247                 24  CS-AGT                PIC X(10).
  2248                 24  CS-COM-TYP            PIC X.
  2249                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2250                 24  CS-RECALC-LV-INDIC    PIC X.
  2251                 24  FILLER                PIC X(10).
  2252
  2253         16  FILLER                        PIC X(256).
  2254
  2255     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2256****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2257****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2258         16  CS-MB-CLAIM-DATA OCCURS 2.
  2259             20  FILLER OCCURS 10.
  2260                 24  CS-CLAIM-TYPE         PIC X.
  2261                     88  CS-AH-CLM           VALUE 'A'.
  2262                     88  CS-IU-CLM           VALUE 'I'.
  2263                     88  CS-GP-CLM           VALUE 'G'.
  2264                     88  CS-LF-CLM           VALUE 'L'.
  2265                     88  CS-PR-CLM           VALUE 'P'.
  2266                 24  CS-BANK               PIC S999 COMP-3.
  2267                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2268                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2269                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2270         16  FILLER                        PIC X(216).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  46
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2271
  2272     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2273         16  CS-VIN-NUMBER                 PIC X(17).
  2274         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2275         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2276         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2277         16  FILLER                        PIC X(496).
  2278
  2279******************************************************************ELCCRTT
  2280
  2281 FD  ERAGTC.
  2282
* 2283                             COPY ERCAGTC.
  2284******************************************************************
  2285*                                                                *
  2286*                                                                *
  2287*                            ERCAGTC                             *
  2288*                            VMOD=2.001                          *
  2289*                                                                *
  2290*   ONLINE CREDIT SYSTEM                                         *
  2291*                                                                *
  2292*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2293*                                                                *
  2294*   FILE TYPE = VSAM,KSDS                                        *
  2295*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2296*                                                                *
  2297*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2298*       ALTERNATE PATH = NONE                                    *
  2299*                                                                *
  2300*   LOG = NO                                                     *
  2301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2302*                                                                *
  2303******************************************************************
  2304*                   C H A N G E   L O G
  2305*
  2306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2307*-----------------------------------------------------------------
  2308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2309* EFFECTIVE    NUMBER
  2310*-----------------------------------------------------------------
  2311* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2312* 111004                         NEW FILE AND COPYBOOK
  2313* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2314******************************************************************
  2315
  2316 01  AGENT-COMMISSIONS.
  2317     12  AG-RECORD-ID                          PIC XX.
  2318         88  VALID-CO-ID                          VALUE 'AG'.
  2319
  2320     12  AG-CONTROL-PRIMARY.
  2321         16  AG-COMPANY-CD                     PIC X.
  2322         16  AG-CONTROL.
  2323             20  AG-CTL-1.
  2324                 24  AG-CARR-GROUP.
  2325                     28  AG-CARRIER            PIC X.
  2326                     28  AG-GROUPING           PIC X(6).
  2327                 24  AG-BANK                   PIC X(10).
  2328             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2329                 24  AG-EXP-DT                 PIC XX.
  2330         16  AG-TYPE                           PIC X.
  2331             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2332             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2333
  2334     12  AG-MAINT-INFORMATION.
  2335         16  AG-LAST-MAINT-DT                  PIC XX.
  2336         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2337         16  AG-LAST-MAINT-USER                PIC X(4).
  2338         16  FILLER                            PIC X(10).
  2339
  2340     12  AG-EFF-DT                             PIC XX.
  2341     12  AG-COMM-STRUCTURE.
  2342         16  AG-AGT-COMMS OCCURS 10.
  2343             20  AG-AGT                PIC X(10).
  2344             20  AG-COM-TYP            PIC X.
  2345             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2346             20  AG-RECALC-LV-INDIC    PIC X.
  2347             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2348             20  AG-LRCALC-LV-INDIC    PIC X.
  2349             20  FILLER                PIC X(05).
  2350
  2351     12  FILLER                  PIC X(145).
  2352******************************************************************
  2353
  2354 FD  ERPDEF.
  2355
* 2356                             COPY ERCPDEF.
  2357******************************************************************
  2358*                                                                *
  2359*                                                                *
  2360*                            ERCPDEF.                            *
  2361*                                                                *
  2362*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2363*                                                                *
  2364*    FILE TYPE = VSAM,KSDS                                       *
  2365*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2366*                                                                *
  2367*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2368*                                                                *
  2369*    LOG = YES                                                   *
  2370*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2371******************************************************************
  2372 01  PRODUCT-MASTER.
  2373    12  PD-RECORD-ID                 PIC X(02).
  2374        88  VALID-PD-ID                  VALUE 'PD'.
  2375
  2376    12  PD-CONTROL-PRIMARY.
  2377        16  PD-COMPANY-CD            PIC X.
  2378        16  PD-STATE                 PIC XX.
  2379        16  PD-PRODUCT-CD            PIC XXX.
  2380        16  PD-FILLER                PIC X(7).
  2381        16  PD-BEN-TYPE              PIC X.
  2382        16  PD-BEN-CODE              PIC XX.
  2383        16  PD-PROD-EXP-DT           PIC XX.
  2384
  2385    12  FILLER                       PIC X(50).
  2386
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  48
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  2387    12  PD-PRODUCT-DATA OCCURS 8.
  2388        16  PD-PROD-CODE             PIC X.
  2389            88  PD-PROD-LIFE           VALUE 'L'.
  2390            88  PD-PROD-PROP           VALUE 'P'.
  2391            88  PD-PROD-AH             VALUE 'A'.
  2392            88  PD-PROD-IU             VALUE 'I'.
  2393            88  PD-PROD-GAP            VALUE 'G'.
  2394        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2395        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2396        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2397        16  PD-MAX-TERM              PIC S999        COMP-3.
  2398        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2399        16  FILLER                   PIC X.
  2400        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2401        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2402        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2403        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2404        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2405        16  PD-REC-CRIT-PERIOD       PIC X.
  2406        16  PD-RTW-MOS               PIC 99.
  2407        16  FILLER                   PIC X(5).
  2408
  2409    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2410
  2411    12  PD-TERM-LIMITS OCCURS 15.
  2412        16  PD-LOW-TERM              PIC S999        COMP-3.
  2413        16  PD-HI-TERM               PIC S999        COMP-3.
  2414
  2415*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2416    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2417        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2418        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2419
  2420    12  PD-EARN-FACTORS.
  2421        16  FILLER OCCURS 15.
  2422            20  FILLER OCCURS 15.
  2423                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2424
  2425    12  PD-PRODUCT-DESC              PIC X(80).
  2426    12  PD-TRUNCATED                 PIC X.
  2427    12  FILLER                       PIC X(59).
  2428
  2429    12  PD-MAINT-INFORMATION.
  2430        16  PD-LAST-MAINT-DT         PIC X(02).
  2431        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2432        16  PD-LAST-MAINT-BY         PIC X(04).
  2433
  2434 FD  ME-ECS010-BALANCE
  2435     RECORDING MODE IS F
  2436     BLOCK CONTAINS 0 RECORDS.
  2437 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2438
  2439 FD  ME50-ECS010-BALANCE
  2440     RECORDING MODE IS F
  2441     BLOCK CONTAINS 0 RECORDS.
  2442 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2443
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  49
* ECS010.cbl
  2445 FD  DISK-DATE
* 2446                             COPY ELCDTEFD.
  2447******************************************************************04/15/98
  2448*                                                                *ELCDTEFD
  2449*                                                                *ELCDTEFD
  2450*                            ELCDTEFD.                           *   LV002
  2451*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2452*                            VMOD=2.007                          *   CL**2
  2453*                                                                *ELCDTEFD
  2454******************************************************************ELCDTEFD
  2455     BLOCK CONTAINS 0 RECORDS
  2456     RECORDING MODE F.                                            ELCDTEFD
  2457                                                                  ELCDTEFD
  2458 01  DATE-DISK.                                                   ELCDTEFD
  2459     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2460     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2461     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2462     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2463     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2464     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2465     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2466                                                                  ELCDTEFD
  2467 01  DATE-DISK-R.                                                 ELCDTEFD
  2468     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2469     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2470                                     PIC  X(32).                  ELCDTEFD
  2471                                                                  ELCDTEFD
  2472 01  DATE-DISK-T.                                                 ELCDTEFD
  2473     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2474     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2475                                     PIC  X(48).                  ELCDTEFD
  2476                                                                  ELCDTEFD
  2477 01  DATE-DISK-M.                                                 ELCDTEFD
  2478     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2479     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2480                                     PIC  X(48).                  ELCDTEFD
  2481                                                                  ELCDTEFD
  2482 01  DATE-DISK-P.                                                 ELCDTEFD
  2483     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2484     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2485     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2486     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2487         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2488                                     PIC  X.                      ELCDTEFD
  2489         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2490     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2491         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2492             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2493             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2494             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2495             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2496         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2497                                                                  ELCDTEFD
  2498 01  DATE-DISK-E.                                                 ELCDTEFD
  2499     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2500     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2501                                     PIC  X(4).                   ELCDTEFD
  2502                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  50
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2503 01  DATE-DISK-C.                                                 ELCDTEFD
  2504     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2505     12  DD-CARR1-SECPAY-SW          PIC  X.
  2506     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2507     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2508     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2509     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2510     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2511     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2512     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2513     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2514     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2515     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2516     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2517     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2518     12  DD-CARR2-SECPAY-SW          PIC  X.
  2519     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2520                                                                  ELCDTEFD
  2521 01  DATE-DISK-OPT.                                               ELCDTEFD
  2522     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2523     12  DD-TLR-DATA.                                             ELCDTEFD
  2524         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2525                                     PIC  X(03).                  ELCDTEFD
  2526     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2527         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2528                                     PIC  X(06).                  ELCDTEFD
  2529     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2530         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2531                                     PIC  X(07).                  ELCDTEFD
  2532         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2533     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2534                                     PIC  X(96).                  ELCDTEFD
  2535******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  51
* ECS010.cbl
  2537 FD  PRINT-COPY
* 2538                             COPY ELCPRTFD.
  2539******************************************************************04/15/98
  2540*                                                                *ELCPRTFD
  2541*                                                                *ELCPRTFD
  2542*                            ELCPRTFD.                           *   LV003
  2543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2544*                            VMOD=2.006                          *ELCPRTFD
  2545******************************************************************ELCPRTFD
  2546     RECORDING MODE F                                             ELCPRTFD
  2547     LABEL RECORDS OMITTED                                        ELCPRTFD
  2548     BLOCK CONTAINS 0 RECORDS
  2549     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2550 01  PRT.                                                         ELCPRTFD
  2551     12  P-CTL               PIC  X.                                 CL**2
  2552     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2553******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  52
* ECS010.cbl
  2555 FD  MISMATCH-REPORT
  2556     RECORDING MODE F.
  2557
  2558 01  MISMATCH-RPT.
  2559     12  MR-CTL              PIC X.
  2560     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  53
* ECS010.cbl
  2562 FD  FICH
* 2563                             COPY ELCFCHFD.
  2564******************************************************************04/15/98
  2565*                                                                *ELCFCHFD
  2566*                            ELCFCHFD.                           *   LV003
  2567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2568*                            VMOD=2.004                          *   CL**3
  2569*                                                                *ELCFCHFD
  2570******************************************************************ELCFCHFD
  2571     BLOCK CONTAINS 0 RECORDS
  2572     RECORDING MODE F.                                            ELCFCHFD
  2573                                                                  ELCFCHFD
  2574 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2575******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  54
* ECS010.cbl
  2577 FD  DISPLAY-PRT
  2578     RECORDING MODE IS F
  2579     LABEL RECORDS ARE STANDARD
  2580     BLOCK CONTAINS 0 RECORDS
  2581     RECORD CONTAINS 133 CHARACTERS.
  2582
  2583 01  DISPLAY-REC.
  2584     05  DISPLAY-CC           PIC X.
  2585     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  55
* ECS010.cbl
  2587 WORKING-STORAGE SECTION.
  2588 77  LCP-ASA                       PIC X.
  2589 77  FILLER  PIC X(32)  VALUE '********************************'.
  2590 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2591 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2592
  2593 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2594 77  ws-dcc-cnc-flag         pic x  value ' '.
  2595 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2596 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2597 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2598 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2599 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2600 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2601 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2602 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2603 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2604 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2605 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2606 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2607 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2608 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2609 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2610 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2611 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2612 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2613 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2614 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2615 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2616 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2617 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2618 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2619 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2620 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2621 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2622 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2623 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2624 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2625 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2626 77  X                       PIC X.
  2627 77  DD-FLG                  PIC X               VALUE SPACE.
  2628 77  AGT-SW                  PIC X               VALUE SPACE.
  2629 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2630 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2631 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2632 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2633 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2634 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2635 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2636 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2637 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2638 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2639 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2640 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2641 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2642 77  SV-TRD-CERT             PIC X(11).
  2643 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2644 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  56
* ECS010.cbl
  2645 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2646*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2647*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2648 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2649 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2650 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2651 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2652 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2653 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2654 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2655 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2656 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2657 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2658 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2659 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2660 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2661 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2662 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2663 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2664 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2665 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2666 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2667 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2668 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2669 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2670 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2671 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2672 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2673 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2674 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2675 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2676 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2677 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2678 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2679 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2680 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2681 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2682 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2683 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2684 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2685 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2686 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2687 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2688 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2689 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2690 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2691 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2692 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2693 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2694 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2695 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2696 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2697 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2698 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2699 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2700 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2701 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2702 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  57
* ECS010.cbl
  2703 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2704 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2705 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2706 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2707 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2708 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2709 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2710 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2711 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2712 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2713 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2714 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2715 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2716 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2717 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2718 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2719 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2720 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2721 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2722 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2723 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2724 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2725 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2726 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2727 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2728 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2729 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  2730 77  P1                      PIC S999 COMP-3 VALUE +0.
  2731 77  P2                      PIC S999 COMP-3 VALUE +0.
  2732 77  DD-IU-SW                    PIC X   VALUE ' '.
  2733     88  DD-IU-PRESENT                 VALUE 'Y'.
  2734 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2735 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2736 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2737 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2738 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2739 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2740 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2741 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2742 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2743 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2744
  2745 01  MONTH-END-DATA.
  2746     12  ME-START-DATE.
  2747         16  ME-START-MO         PIC 99.
  2748         16  FILLER              PIC X.
  2749         16  ME-START-DA         PIC 99.
  2750         16  FILLER              PIC X.
  2751         16  ME-START-YR         PIC 99.
  2752     12  ME-CNDS-DATE            PIC 9(6).
  2753     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2754         16  ME-CNDS-MO          PIC 99.
  2755         16  ME-CNDS-DA          PIC 99.
  2756         16  ME-CNDS-YR          PIC 99.
  2757     12  ME-START-TIME           PIC 9(6).
  2758     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2759         88  ME-DO-UPDATE        VALUE 'Y'.
  2760         88  ME-NO-UPDATE        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  58
* ECS010.cbl
  2761     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2762
  2763 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2764 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2765     'Life Claims Paid'.
  2766
  2767 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2768     'A&H Claims Paid'.
  2769
  2770 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2771     'Output Certificate Master Records Prior Month'.
  2772
  2773 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2774     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2775
  2776 01  WS-ME-BALANCE-REC.
  2777     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2778     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2779     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2780     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2781     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2782     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2783     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2784
  2785 01  WS-ME50-BALANCE-REC.
  2786     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2787     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2788     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2789     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2790     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2791     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2792     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2793     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2794     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2795
  2796 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2797 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2798 01  WS-BANK-COMMISSIONS.
  2799     12  WS-BANK-COMMS           OCCURS 10.
  2800         16  WS-BNK-AGT          PIC X(10).
  2801         16  WS-BNK-TYPE         PIC X.
  2802         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2803         16  WS-BNK-RECALC       PIC X.
  2804         16  FILLER              PIC X(10).
  2805
  2806 01  PENDING-MATCH-CONTROL.
  2807     12  PENDING-ACCOUNT-CONTROL.
  2808         16  PEND-MATCH-CARRIER    PIC X.
  2809         16  PEND-MATCH-GROUPING   PIC X(6).
  2810         16  PEND-MATCH-STATE      PIC XX.
  2811         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2812     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2813     12  PEND-MATCH-CERT-NO.
  2814         16  PEND-MATCH-CERT       PIC X(10).
  2815         16  PEND-MATCH-CERT-SFX   PIC X.
  2816 01  PENDING-RECORD-TYPE           PIC X.
  2817     88  ISSUE-TRANSACTION            VALUE '1'.
  2818     88  CANCEL-TRANSACTION           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  59
* ECS010.cbl
  2819     88  CLAIM-TRANSACTION            VALUE '3'.
  2820     88  RESERVE-TRANSACTION          VALUE '4'.
  2821     88  UPDATE-TRANSACTION           VALUE '5'.
  2822
  2823 01  CLM-INCUR-REIN-DATE.
  2824     12  CIRD-CCYY.
  2825         16  CIRD-CC         PIC 99.
  2826         16  CIRD-YR         PIC 99.
  2827     12  CIRD-MO             PIC 99.
  2828
  2829 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2830
  2831 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2832
  2833 01  REIN-BILLING-TABLE.
  2834     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2835         16  RB-COMPANY      PIC X(6).
  2836         16  RB-COUNT        PIC S9(5)   COMP-3.
  2837
  2838 01  B-SUB                   PIC S9(4)   COMP.
  2839
  2840 01  BINARY-COUNTERS     COMP      SYNC.
  2841     12  IA                  PIC S999            VALUE +0.
  2842     12  IB                  PIC S999            VALUE +0.
  2843     12  SUB                 PIC S999            VALUE +0.
  2844     12  SUBM                PIC S999            VALUE +0.
  2845     12  SUB3                PIC S999            VALUE +0.
  2846     12  SUB4                PIC S999            VALUE +0.
  2847     12  SUB5                PIC S999            VALUE +0.
  2848     12  SUB6                PIC S999            VALUE +0.
  2849     12  SUB7                PIC S999            VALUE +0.
  2850     12  SUB8                PIC S999            VALUE +0.
  2851     12  SUB9                PIC S999            VALUE +0.
  2852     12  SUB10               PIC S999            VALUE +0.
  2853     12  SUB11               PIC S999            VALUE +0.
  2854     12  SUB12               PIC S999            VALUE +0.
  2855     12  SUB13               PIC S999            VALUE +0.
  2856     12  SUB14               PIC S999            VALUE +0.
  2857     12  SUB15               PIC S999            VALUE +0.
  2858     12  SUB16               PIC S999            VALUE +0.
  2859     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2860 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2861
  2862 01  WS.
  2863     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2864     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2865     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2866     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2867
  2868     12  WS-ABEND-CODE         PIC 9(4).
  2869     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2870         16  ABEND-CODE-1    PIC XX.
  2871         16  ABEND-CODE-2.
  2872             20  AC2-ONE     PIC X.
  2873             20  AC2-TWO     PIC X.
  2874
  2875     12  CTBL-SEARCH.
  2876         16  CTBL-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  60
* ECS010.cbl
  2877         16  CTBL-TABLE-CD   PIC XXX.
  2878         16  CTBL-BEN-TYPE   PIC X.
  2879         16  CTBL-BEN-CODE   PIC XX.
  2880     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2881     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2882     12  WS-COMM-TERM        PIC S999            COMP-3.
  2883     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2884         88  CTBL-ERROR         VALUE '*'.
  2885
  2886     12  REIN-SPEC.
  2887         16  REIN-SPEC-A     PIC X.
  2888         16  REIN-SPEC-B     PIC X.
  2889         16  REIN-SPEC-C     PIC X.
  2890
  2891     12  WS-CHECK-NUMBER.
  2892         16  WS-CHECK-NO     PIC X(4).
  2893         16  FILLER          PIC XXX.
  2894
  2895     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2896         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2897         88  AH-EARN-NET                         VALUE 'N'.
  2898
  2899     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2900     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2901
  2902 01  max-pdef                    pic s9(5) comp-3 value +2000.
  2903 01  DCC-DDF-WORK-AREA.
  2904     05  F OCCURS 2000.
  2905         10  DD-STATE                 PIC XX.
  2906         10  DD-PRODUCT-CD            PIC XXX.
  2907         10  DD-FILLER                PIC X(7).
  2908         10  DD-BEN-TYPE              PIC X.
  2909         10  DD-BEN-CODE              PIC XX.
  2910         10  DD-PROD-EXP-DT           PIC XX.
  2911         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2912         10  DD-PROD-DATA OCCURS 8.
  2913             15  DD-PROD-CODE         PIC X.
  2914             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2915         10  DD-EARN-FACTORS.
  2916             15  F OCCURS 15.
  2917                 20  F OCCURS 15.
  2918                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2919         10  DD-TRUNCATED        PIC X.
  2920
  2921 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2922 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2923 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2924 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2925 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2926 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2927 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2928 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2929
  2930 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2931 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2932 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2933 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2934
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  61
* ECS010.cbl
  2935 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2936     12  WS-LF-CHARGEBACK-LEVELS.
  2937         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2938     12  WS-AH-CHARGEBACK-LEVELS.
  2939         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2940 01  WS-DCC-DDF-CB.
  2941     12  WS-DCC-DDF-CB-LEVELS.
  2942         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2943*****************************************************************
  2944*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2945*****************************************************************
  2946*RESIDENT STATE TAXES MASTER(ERRESC)
  2947*
  2948 01  WORK-AREAS.
  2949     12  WS-ERRESC-KEY.
  2950         16 WS-ERRESC-SEARCH-KEY.
  2951             20  WS-ERRESC-COMPANY-CD PIC  X.
  2952             20  WS-ERRESC-CARRIER    PIC  X.
  2953             20  WS-ERRESC-GROUP      PIC X(6).
  2954             20  WS-ERRESC-STATE      PIC XX.
  2955             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2956         16 WS-ERRESC-RESIDUAL-KEY.
  2957             20  WS-ERRESC-AGENT      PIC X(10).
  2958             20  WS-ERRESC-RES-STATE  PIC XX.
  2959             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2960*                                          YYYYMMDD
  2961     12  WS-YYYYMMDD-DT               PIC 9(8).
  2962     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2963     12  WS-SUB                       PIC    99  COMP-3.
  2964     12  WS-SUB1                      PIC    99  COMP-3.
  2965*****************************************************************
  2966*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2967*****************************************************************
  2968
  2969 01  COMM-WORK-AREAS.
  2970     12  FILLER              PIC  X(17)
  2971         VALUE 'COMMON WORK AREAS'.
  2972     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2973     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2974     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2975     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2976     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2977     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2978     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2979     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2980     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2981     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2982     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2983     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2984     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2985     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2986     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2987     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2988     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2989     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2990     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2991
  2992     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  62
* ECS010.cbl
  2993                                         COMP-3 VALUE ZEROS.
  2994     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2995                                         COMP-3 VALUE ZEROS.
  2996     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2997                                         COMP-3 VALUE ZEROS.
  2998     12  W-EDIT-FIELD        PIC ----------9.
  2999     12  W-EDIT-FIELD2       PIC ----------9.99.
  3000     12  W-EDIT-7            PIC Z(06)9.
  3001     12  W-FACTOR            PIC S9(09)V9(08)
  3002                                         COMP-3 VALUE ZEROS.
  3003     12  W-IBNR-1            PIC S9(07)V9(02)
  3004                                         COMP-3 VALUE ZEROS.
  3005     12  W-IBNR-2            PIC S9(07)V9(02)
  3006                                         COMP-3 VALUE ZEROS.
  3007     12  W-ISS-BEN           PIC S9(11)V9(02)
  3008                                         COMP-3 VALUE ZEROS.
  3009     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  3010                                         COMP-3 VALUE ZEROS.
  3011     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3012     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  3013     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3014     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3015     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3016     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3017     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3018     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  3019     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3020     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3021     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3022     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3023     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3024     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3025     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3026     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3027                                         COMP-3 VALUE ZEROS.
  3028     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3029     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3030     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3031     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3032     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3033     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3034     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3035     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3036     12  W-POLICY-INACTIVE-CTR
  3037                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3038     12  W-POLICY-REISSUE-CTR
  3039                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3040     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3041     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3042     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3043                                         COMP-3 VALUE ZEROS.
  3044     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3045     12  W-WK-IBNR           PIC S9(07)V9(02)
  3046                                         COMP-3 VALUE ZEROS.
  3047
  3048     12  W-CLAIM-TYPE        PIC  X(01).
  3049         88  W-A-H                              VALUE 'A'.
  3050         88  W-LIFE                             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  63
* ECS010.cbl
  3051     12  W-CUTOFF-DATE       PIC  9(08).
  3052     12  W-DIS-DT            PIC  XX.
  3053     12  W-DIS-PTO-DT        PIC  XX.
  3054     12  WK-LEVEL.
  3055         16  WK-AGT          PIC X(10).
  3056         16  WK-A-TYPE       PIC X.
  3057         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3058         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3059         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3060         16  FILLER          PIC X(6).
  3061     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3062         16  FILLER          PIC X(11).
  3063         16  WK-L-RTX        PIC X(3).
  3064         16  WK-J-RTX        PIC X(3).
  3065         16  WK-A-RTX        PIC X(3).
  3066         16  FILLER          PIC X(6).
  3067     12  WK-NEW-RATES.
  3068         16  WK-N-R      OCCURS 10.
  3069             20  WK-N-AGT    PIC X(10).
  3070             20  WK-N-TYPE   PIC X.
  3071             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3072             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3073     12  W-LIFE-YEARS-ZERO.
  3074         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3075         16  FILLER          PIC  X(01)         VALUE SPACES.
  3076         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3077         16  FILLER          PIC  X(01)         VALUE SPACES.
  3078         16  FILLER          PIC  X(01)         VALUE SPACES.
  3079         16  FILLER          PIC  X(01)         VALUE SPACES.
  3080         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3081         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3082         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3083         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3084         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3085         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3086         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3087         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3088         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3089         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3090         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3091         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3092         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3093         16  FILLER          PIC S9(09)V9(02) COMP-3
  3094                                                VALUE ZEROS.
  3095         16  FILLER          PIC S9(09)V9(02) COMP-3
  3096                                                VALUE ZEROS.
  3097         16  FILLER          PIC S9(09)V9(02) COMP-3
  3098                                                VALUE ZEROS.
  3099         16  FILLER          PIC S9(09)V9(02) COMP-3
  3100                                                VALUE ZEROS.
  3101         16  FILLER          PIC S9(11)V9(02) COMP-3
  3102                                                VALUE ZEROS.
  3103
  3104     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3105         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3106     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  3107         88  W-REIN-PROCESS                     VALUE 'Y'.
  3108         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  64
* ECS010.cbl
  3109     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  3110         88  W-SELECTION-ON                     VALUE 'Y'.
  3111         88  W-SELECTION-OFF                    VALUE SPACES.
  3112     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3113         88  W-RTRM-0                           VALUE 'Y'.
  3114         88  W-RTRM-NOT-0                       VALUE SPACES.
  3115     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3116     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3117         88  W-TABLE-USED                       VALUE 'Y'.
  3118         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3119     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3120         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3121
  3122     12  W-VAL-ERRORS.
  3123         16  FILLER          PIC  X(40)
  3124             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3125         16  FILLER          PIC  X(40)
  3126             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3127         16  FILLER          PIC  X(40)
  3128             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3129         16  FILLER          PIC  X(40)
  3130             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3131         16  FILLER          PIC  X(40)
  3132             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3133         16  FILLER          PIC  X(40)
  3134             VALUE 'RUN DATE EPEC - A&H - '.
  3135         16  FILLER          PIC  X(40)
  3136             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3137         16  FILLER          PIC  X(40)
  3138             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3139         16  FILLER          PIC  X(40)
  3140             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3141     12  FILLER REDEFINES W-VAL-ERRORS.
  3142         16  W-VAL-ERROR OCCURS 9 TIMES
  3143                             PIC  X(40).
  3144
  3145     12  W-WORK-DATE         PIC  X(02).
  3146     12  SAVE-WK-NEW-RATES.
  3147         16  FILLER          PIC X(170).
  3148
  3149***   The following data area is for NCL only
  3150*    12  W-WORK-OB-DATA OCCURS 300.
  3151*    12  W-WORK-OB-DATA OCCURS 220.
  3152     12  W-WORK-OB-DATA OCCURS 900.
  3153         16  WS-OB-REIN-CO       PIC X(06).
  3154         16  WS-OB-LF-AH         PIC X.
  3155         16  WS-OB-BENEFIT-CODE  PIC XX.
  3156         16  WS-OB-EARNED OCCURS 3.
  3157             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3158
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  65
* ECS010.cbl
  3160 01  EPEC-WORK-AREAS.
  3161     12  WE-REIN-CO          PIC X(6).
  3162     12  WE-LF-AH            PIC X.
  3163     12  WE-BEN-TYPE         PIC XX.
  3164     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3165     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3166     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3167     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3168     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3169     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3170     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3171     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3172     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3173     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3174     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3175     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3176     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3177     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3178     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3179     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3180     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3181     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3182     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3183     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3184     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3185     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3186     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3187     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3188     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3189     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3190     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3191     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3192     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3193     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3194     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3195     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3196     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3197     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3198     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3199     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3200     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3201     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3202     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3203     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3204     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3205     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3206     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3207     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3208     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3209     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3210     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3211     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3212     12  WX-SETTLEMENT-EXIT-DATE
  3213                             PIC  9(11)      COMP-3.
  3214     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3215     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3216     12  WX-STATUS-AT-SETTLEMENT
  3217                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  66
* ECS010.cbl
  3218     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3219
  3220 01  EPEC-WORK.
  3221     12  EW-REIN-CO          PIC X(6).
  3222     12  EW-SUB-KEY.
  3223         16  EW-LF-AH        PIC X.
  3224         16  EW-BEN-TYPE     PIC XX.
  3225     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3226     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3227     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3228     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3229     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3230     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3231     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3232     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3233     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3234     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3235     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3236     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3237     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3238     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3239     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3240     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3241     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3242     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3243     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3244     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3245     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3246     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3247     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3248     12  EW-AGENTS       OCCURS 10.
  3249         16  EW-AGT-NO       PIC X(10).
  3250         16  EW-AGT-TYPE     PIC X.
  3251         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3252         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3253         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3254         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3255         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3256         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3257         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3258     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3259     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3260     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3261     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3262     12  EW-AGE              PIC S9(9)       COMP-3.
  3263     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3264     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3265     12  EW-LEVEL-USED       PIC X.
  3266
  3267 01  EPEC-TOTALS.
  3268     12  EPEC-LEVELS     OCCURS 900.
  3269*    12  EPEC-LEVELS     OCCURS 220.
  3270*    12  EPEC-LEVELS     OCCURS 300.
  3271         16  EPEC-REIN-CO          PIC X(6).
  3272         16  EPEC-SUB-KEY.
  3273             24  EPEC-LF-AH        PIC X.
  3274             24  EPEC-BEN-TYPE     PIC XX.
  3275*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  67
* ECS010.cbl
  3276         16  FILLER                PIC X(699).
  3277     12  EPEC-LEVELS-END           PIC X(6).
  3278
  3279 01  EPEC-UNDERWRITTEN-TOTALS.
  3280     12  EPEC-LEVELS-II  OCCURS 900.
  3281*    12  EPEC-LEVELS-II  OCCURS 220.
  3282*    12  EPEC-LEVELS-II  OCCURS 300.
  3283         16  EPEC-REIN-CO-II       PIC X(6).
  3284         16  EPEC-SUB-KEY-II.
  3285             24  EPEC-LF-AH-II     PIC X.
  3286             24  EPEC-BEN-TYPE-II  PIC XX.
  3287*        16  FILLER                PIC X(694).
  3288         16  FILLER                PIC X(699).
  3289     12  EPEC-LEVELS-END-II        PIC X(6).
  3290
  3291
  3292 01  FILLER                      PIC  X(11)
  3293                                 VALUE 'OPT RSV TBL'.
  3294*
  3295* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3296*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3297*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3298*      EPEC-OPT-GRP  (108)
  3299*
  3300*      300 X 108 = 32400.
  3301*
  3302 01  EPEC-OPT-DATA-TABLE.
  3303*    12  FILLER                  PIC X(32400).
  3304*    12  FILLER                  PIC X(23760).
  3305     12  FILLER                  PIC X(97200).
  3306
  3307 01  FILLER                      PIC  X(16)
  3308                                 VALUE 'OPT RSV TBL UNDW'.
  3309 01  EPEC-UNDW-OPT-DATA-TABLE.
  3310*    12  FILLER                  PIC X(32400).
  3311*    12  FILLER                  PIC X(23760).
  3312     12  FILLER                  PIC X(97200).
  3313
  3314 01  FILLER                      PIC  X(16)
  3315                                 VALUE 'OPT RSV TBL WORK'.
  3316 01  EPEC-OPT-WORK-TABLE.
  3317*    12  EPEC-OPT-GRP        OCCURS 300.
  3318*    12  EPEC-OPT-GRP        OCCURS 220.
  3319     12  EPEC-OPT-GRP        OCCURS 900.
  3320         16  EPEC-REIN-CO-OPT
  3321                             PIC  X(06).
  3322         16  EPEC-SUB-KEY-OPT.
  3323             24  EPEC-LF-AH-OPT
  3324                             PIC  X(01).
  3325             24  EPEC-BEN-TYPE-OPT
  3326                             PIC  X(02).
  3327         16  EPEC-OPT-DATA.
  3328             20  EPEC-REIN-ONLY-IND
  3329                             PIC  X(01).
  3330                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3331             20  EPEC-LINE-NOT-USED-IND
  3332                             PIC  X(01).
  3333                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  68
* ECS010.cbl
  3334             20  EPEC-LIFE-CTR-USED-IND
  3335                             PIC  X(01).
  3336                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3337                 88  EPEC-LIFE-CTR-NOT-USED
  3338                                           VALUE ' '.
  3339             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3340                             PIC S9(09)       COMP-3.
  3341             20  EPEC-EARNED-PREMIUM-AH
  3342                             PIC S9(09)V9(02) COMP-3.
  3343             20  EPEC-CLAIMS-MADE-PAID
  3344                             PIC S9(09)V9(02) COMP-3.
  3345             20  EPEC-CLM-EXP
  3346                             PIC S9(09)V9(02) COMP-3.
  3347             20  EPEC-LIFE-IBNR
  3348                             PIC S9(09)V9(02) COMP-3.
  3349             20  EPEC-REIN-ISS-BEN
  3350                             PIC S9(11)V9(02) COMP-3.
  3351
  3352 01  FILLER                  PIC X(09)
  3353                                 VALUE 'EOM TABLE'.
  3354
  3355 01  EOM-DATE-TABLE.
  3356     12  EOM-DATE            OCCURS 13
  3357                             PIC 9(08).
  3358
  3359 01  EPEC-SUBS.
  3360     12  EPEC-SUB-LEVELS OCCURS 31.
  3361         16  EPEC-SUB-REIN   PIC X(6).
  3362         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3363         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3364     12  EPEC-SUBS-END       PIC X(6).
  3365
  3366 01  SAVE-REIN-WORK.
  3367     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3368     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3369     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3370     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3371     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3372
  3373 01  SAVE-REIN-TABLE.
  3374     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3375         16  SR-TIME         PIC 9(6).
  3376         16  SR-ENTRY.
  3377             20  FILLER      PIC XX.
  3378             20  SR-CONTROL  PIC X(8).
  3379             20  FILLER      PIC X(3990).
  3380
  3381
* 3382                             COPY ECSRITAB.
  3383******************************************************************04/29/98
  3384*                                                                *ECSRITAB
  3385*                            ECSRITAB                            *   LV015
  3386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3387*                            VMOD=2.015                          *ECSRITAB
  3388*                                                                *ECSRITAB
  3389*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3390*                                                                *ECSRITAB
  3391******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  69
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3392 01  REIN-WORK-AREAS.                                             ECSRITAB
  3393     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3394     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3395     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3396     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3397     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3398     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3399     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3400     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3401     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3402     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3403     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3404         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3405             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3406             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3407             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3408     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3409     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3410     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3411     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3412     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3413     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3414     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3415     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3416     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3417     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3418     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3419     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3420     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3421     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3422     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3423     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3424     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3425     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3426     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3427     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3428     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3429     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3430     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3431                                                                  ECSRITAB
  3432 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3433     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3434         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3435         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3436             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3437             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3438         16  REIN-WORK-FLDS.                                      ECSRITAB
  3439             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3440             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3441             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3442             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3443             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3444             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3445             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3446             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3447             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3448             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3449             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3450             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3451             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3452             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3453             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3454             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3455             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3456             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3457             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3458             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3459             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3460             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3461             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3462             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3463             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3464             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3465             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3466             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3467     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3468                                                                  ECSRITAB
  3469     12  RWF-FIELDS.                                              ECSRITAB
  3470         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3471         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3472         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3473         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3474         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3475         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3476         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3477         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3478         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3479         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3480         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3481         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3482         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3483         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3484         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3485         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3486         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3487         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3488         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3489         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3490         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3491         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3492         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3493         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3494         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3495         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3496         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3497         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3498                                                                  ECSRITAB
  3499     12  WT-COMP-INFO.                                            ECSRITAB
  3500         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3501         16  WT-LF-QC                PIC X.                       ECSRITAB
  3502         16  WT-AH-QC                PIC X.                       ECSRITAB
  3503         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3504         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3505         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3506         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3507         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3508         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3509         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3510         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3511         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3512         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3513         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3514         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3515         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3516         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3517         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3518         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3519         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3520         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3521         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3522         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3523         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3524         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3525         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3526         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3527         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3528         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3529         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3530         16  WT-REMAINING            PIC X.                       ECSRITAB
  3531         16  FILLER                  PIC X(21).                   ECSRITAB
  3532                                                                  ECSRITAB
  3533 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3534     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3535     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3536     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3537     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3538     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3539     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3540     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3541     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3542     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3543     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3544     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3545     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3546     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3547     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3548     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3549     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3550     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3551     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3552     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3553     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3554     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3555     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3556     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3557     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3558                                                                  ECSRITAB
  3559     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3560         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3561     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3562         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3563     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3564         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3565     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3566         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3567     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3568         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3569     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3570         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3571                                                                  ECSRITAB
  3572     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3573         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3574         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3575         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3576         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3577         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3578         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3579         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3580         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3581         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3582         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3583         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3584         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3585         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3586         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3587         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3588         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3589         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3590         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3591         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3592         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3593         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3594         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3595         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3596     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3597     12  REIN-SEARCH.                                             ECSRITAB
  3598         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3599         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3600         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3601         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3602     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3603     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3604     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3605     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3606     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3607     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3608     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3609     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3610     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3611     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3612     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3613     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3614     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3615     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3616     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3617     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3618     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3619     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3620     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3621     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3622     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3623     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3624     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3625     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3626     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3627                                                                  ECSRITAB
  3628 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3629* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3630     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3631         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3632         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3633         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3634         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3635         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3636         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3637         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3638         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3639         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3640                                                                  ECSRITAB
  3641 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3642     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3643         16  RC2-REIN-CO.                                         ECSRITAB
  3644             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3645             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3646         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3647         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3648         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3649         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3650         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3651         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3652                                                                  ECSRITAB
  3653 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3654     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3655         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3656         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3657     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3658                                                                  ECSRITAB
  3659 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3660     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3661         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3662         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3663         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3664 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3665     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3666         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3667                                                                  ECSRITAB
  3668 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3669******************************************************************ECSRITAB
  3670
* 3671                             COPY ELCPSEVR.
  3672******************************************************************04/16/98
  3673*                                                                *ELCPSEVR
  3674*                                                                *ELCPSEVR
  3675*                            ELCPSEVR                            *   LV003
  3676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3677*                            VMOD=2.001                          *ELCPSEVR
  3678*                                                                *ELCPSEVR
  3679*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3680*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3681*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3682******************************************************************ELCPSEVR
  3683                                                                  ELCPSEVR
  3684 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3685     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3686         10  FILLER               PIC 999.                        ELCPSEVR
  3687         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3688         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3689             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3690             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3691         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3692         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3693     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3694            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3695     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3696         10  FILLER              PIC 999.                         ELCPSEVR
  3697         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3698         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3699             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3700             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3701         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3702         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3703     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3704            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3705 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3706     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3707                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3708         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3709             15  FILLER              PIC 999.                     ELCPSEVR
  3710             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3711             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3712                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3713                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3714             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3715             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3716         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3717                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3718         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3719             15  FILLER              PIC 999.                     ELCPSEVR
  3720             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3721             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3722                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3723                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3724             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3725             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3726         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3727                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3728         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3729             15  FILLER              PIC 999.                     ELCPSEVR
  3730             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3731             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3732                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3733                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3734             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3735             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3736         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3737                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3738     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3739         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3740         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3741         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3742             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3743             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3744         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3745         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3746     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3747            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3748
* 3749                             COPY ELCEPCVR.
  3750******************************************************************05/15/98
  3751*                                                                *ELCEPCVR
  3752*                                                                *ELCEPCVR
  3753*                            ELCEPCVR                            *   LV003
  3754*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3755*                            VMOD=2.001                          *ELCEPCVR
  3756*                                                                *ELCEPCVR
  3757*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3758*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3759*                                                                *ELCEPCVR
  3760******************************************************************ELCEPCVR
  3761 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3762     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3763         10  FILLER            PIC 999.                           ELCEPCVR
  3764         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3765         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3766             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3767             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3768         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3769         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3770     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3771            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3772     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3773         10  FILLER            PIC 999.                              CL**5
  3774         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3775         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3776             15  EC-EXP-CC     PIC 99.                               CL**5
  3777             15  EC-EXP-YR     PIC 99.                               CL**5
  3778         10  EC-EXP-MO         PIC 99.                               CL**5
  3779         10  EC-EXP-DA         PIC 99.                               CL**5
  3780     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3781            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3782     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3783         10  FILLER            PIC 999.                           ELCEPCVR
  3784         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3785         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3786             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3787             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3788         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3789         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3790     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3791            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3792     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3793         10  FILLER            PIC 999.                              CL**5
  3794         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3795         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3796             15  EC-EFF-CC     PIC 99.                               CL**5
  3797             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3798         10  EC-EFF-MO         PIC 99.                               CL**5
  3799         10  EC-EFF-DA         PIC 99.                               CL**5
  3800     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3801            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3802     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3803         10  FILLER            PIC 999.                           ELCEPCVR
  3804         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3805         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3806             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3807             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3808         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3809         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3810     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3811            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3812     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3813         10  FILLER            PIC 999.                           ELCEPCVR
  3814         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3815         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3816             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3817             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3818         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3819         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3820     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3821            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3822     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3823         10  FILLER            PIC 999.                           ELCEPCVR
  3824         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3825         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3826             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3827             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3828         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3829         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3830     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3831            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3832     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3833         10  FILLER            PIC 999.                           ELCEPCVR
  3834         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3835         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3836             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3837             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3838         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3839         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3840     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3841            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3842     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3843         10  FILLER            PIC 999.                           ELCEPCVR
  3844         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3845         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3846             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3847             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3848         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3849         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3850     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3851            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3852
* 3853                             COPY ELCREINV.
  3854******************************************************************04/18/98
  3855*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3856*                                                                *ELCREINV
  3857*                            ELCREINV                            *   LV003
  3858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3859*                            VMOD=2.001                          *ELCREINV
  3860*                                                                *ELCREINV
  3861*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3862*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3863*                                                                *ELCREINV
  3864******************************************************************ELCREINV
  3865                                                                  ELCREINV
  3866 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3867     05  WS-RE-LO-DATE.                                              CL**3
  3868         10 FILLER                     PIC 999.                      CL**3
  3869         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3870         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3871            15 RE-LO-CC                PIC 99.                       CL**3
  3872            15 RE-LO-YR                PIC 99.                       CL**3
  3873         10 RE-LO-MO                   PIC 99.                       CL**3
  3874         10 RE-LO-DA                   PIC 99.                       CL**3
  3875     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3876            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3877     05  WS-RE-HI-DATE.                                              CL**3
  3878         10 FILLER                     PIC 999.                      CL**3
  3879         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3880         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3881            15 RE-HI-CC                PIC 99.                       CL**3
  3882            15 RE-HI-YR                PIC 99.                       CL**3
  3883         10 RE-HI-MO                   PIC 99.                       CL**3
  3884         10 RE-HI-DA                   PIC 99.                       CL**3
  3885     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3886            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3887     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3888         10 FILLER                     PIC 999.                   ELCREINV
  3889         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3890         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3891            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3892            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3893         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3894         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3895     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3896            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3897     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3898         10  FILLER                    PIC 999.                   ELCREINV
  3899         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3900         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3901             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3902             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3903         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3904         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3905     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3906            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3907     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3908         10  FILLER                    PIC 999.                   ELCREINV
  3909         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3910         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3911             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3912             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3913         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3914         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3915     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3916            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3917
  3918 01  RC-REIN-HOLD-AREAS.
  3919     12  RC-REIN-LEVELS  OCCURS 30.
  3920         16  RC-REIN-COMP    PIC X(6).
  3921         16  RC-OLD-ISS      PIC X.
  3922         16  RC-NEW-ISS      PIC X.
  3923         16  RC-OLD-CNC      PIC X.
  3924         16  RC-NEW-CNC      PIC X.
  3925         16  RC-OLD-LF-CLM   PIC X.
  3926         16  RC-OLD-AH-CLM   PIC X.
  3927         16  RC-NEW-LF-CLM   PIC X.
  3928         16  RC-NEW-AH-CLM   PIC X.
  3929         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3930         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3931         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3932         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3933         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3934         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3935         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3936         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3937         16  RC-REIN-REM-SW  PIC X.
  3938     12  RC-REIN-LEVELS-END  PIC X(6).
  3939
  3940 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3941     12  TPC-COUNTERS    OCCURS 6.
  3942         16  TPL-ISS-PRM     PIC S9(9)V99.
  3943         16  TPA-ISS-PRM     PIC S9(9)V99.
  3944         16  TPL-CNC-PRM     PIC S9(9)V99.
  3945         16  TPA-CNC-PRM     PIC S9(9)V99.
  3946         16  TPL-ACCT-COM    PIC S9(9)V99.
  3947         16  TPA-ACCT-COM    PIC S9(9)V99.
  3948         16  TPL-CLAIMS      PIC S9(9)V99.
  3949         16  TPA-CLAIMS      PIC S9(9)V99.
  3950
  3951 01  HLD-DTS SYNC.
  3952     12  EOM-RUN-DATE        PIC 9(08).
  3953     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3954         16  EOM-CCYY.
  3955             20  EOM-CC      PIC 99.
  3956             20  EOM-YR      PIC 99.
  3957         16  EOM-MO          PIC 99.
  3958         16  EOM-DA          PIC 99.
  3959
  3960****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3961****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3962     12  OB-RUN-DATES OCCURS 2.
  3963         16  OB-CCYY         PIC 9(4).
  3964         16  OB-MO           PIC 99.
  3965         16  OB-DA           PIC 99.
  3966
  3967     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3968         88  OB-DATE-1-USED     VALUE '*'.
  3969     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3970         88  OB-DATE-2-USED     VALUE '*'.
  3971     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  79
* ECS010.cbl
  3972         88  OB-DATE-3-USED     VALUE '*'.
  3973     12  EARNING-START-DATE  PIC 9(08).
  3974     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3975         16  E-ERN-START-CC  PIC 99.
  3976         16  E-ERN-START-YR  PIC 99.
  3977         16  E-ERN-START-MO  PIC 99.
  3978         16  E-ERN-START-DA  PIC 99.
  3979     12  EARNING-STOP-DATE   PIC 9(08).
  3980     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3981         16  E-ERN-STOP-CC   PIC 99.
  3982         16  E-ERN-STOP-YR   PIC 99.
  3983         16  E-ERN-STOP-MO   PIC 99.
  3984         16  E-ERN-STOP-DA   PIC 99.
  3985     12  STOP-LF-DATE        PIC 9(08).
  3986     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3987         16  STOP-LF-CC      PIC 99.
  3988         16  STOP-LF-YR      PIC 99.
  3989         16  STOP-LF-MO      PIC 99.
  3990         16  STOP-LF-DA      PIC 99.
  3991     12  STOP-AH-DATE        PIC 9(08).
  3992     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3993         16  STOP-AH-CC      PIC 99.
  3994         16  STOP-AH-YR      PIC 99.
  3995         16  STOP-AH-MO      PIC 99.
  3996         16  STOP-AH-DA      PIC 99.
  3997     12  BIN-VALUATION-DT    PIC XX.
  3998     12  BIN-EOM-RUN-DATE    PIC XX.
  3999     12  LAST-YRS-DATE       PIC 9(08).
  4000     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  4001         16  LYD-CCYY        PIC 9(04).
  4002         16  LYD-CCYR REDEFINES LYD-CCYY.
  4003             20  LYD-CC      PIC 99.
  4004             20  LYD-YR      PIC 99.
  4005         16  LYD-MO          PIC 99.
  4006         16  LYD-DA          PIC 99.
  4007     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  4008     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  4009         16  VAL-CC          PIC 99.
  4010         16  VAL-YR          PIC 99.
  4011         16  VAL-MO          PIC 99.
  4012         16  VAL-DA          PIC 99.
  4013     12  INCURRED-DATE       PIC 9(08).
  4014     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  4015         16  DTO-CC          PIC 99.
  4016         16  DTO-YR          PIC 99.
  4017         16  DTO-MO          PIC 99.
  4018         16  DTO-DA          PIC 99.
  4019     12  REPORTED-DATE.
  4020         16  RPT-YR          PIC 99.
  4021         16  RPT-MO          PIC 99.
  4022         16  RPT-DA          PIC 99.
  4023     12  PAYMENT-DATE        PIC 9(08).
  4024     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4025         16  PAY-CC          PIC 99.
  4026         16  PAY-YR          PIC 99.
  4027         16  PAY-MO          PIC 99.
  4028         16  PAY-DA          PIC 99.
  4029     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  80
* ECS010.cbl
  4030     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4031         16  PAYTO-CC        PIC 99.
  4032         16  PAYTO-YR        PIC 99.
  4033         16  PAYTO-MO        PIC 99.
  4034         16  PAYTO-DA        PIC 99.
  4035
  4036 01  AH-RES-STATE-TABLE.
  4037     12  FILLER              PIC X(42)       VALUE
  4038             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4039     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4040
  4041 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4042     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4043
  4044 01  BILLING-COUNTERS    COMP-3.
  4045     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4046     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4047     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4048     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4049     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4050     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4051     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4052     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4053     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4054     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4055     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4056     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4057     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4058     12  BC-COMM             PIC S9(5)           VALUE +0.
  4059     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4060     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4061     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4062     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4063     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4064     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4065     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4066     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4067     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4068     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4069
  4070 01  FLAGS SYNC.
  4071     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4072         88  CHECK-BILLED                        VALUE 'Y'.
  4073     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4074         88  EOF-ON-TRANS                        VALUE '*'.
  4075     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4076         88  EOF-ON-CERT                         VALUE '*'.
  4077     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4078         88  PROCESSING-COMPLETED                VALUE '*'.
  4079     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4080         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4081     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4082         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4083     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4084         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4085     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4086         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4087     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  81
* ECS010.cbl
  4088         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4089     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4090         88  A-H-FULLY-EARNED                    VALUE '*'.
  4091     12  CNCL-FLG            PIC X               VALUE SPACE.
  4092     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4093         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4094         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4095     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4096         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4097     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4098         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4099     12  EP-FLG              PIC X               VALUE SPACE.
  4100     12  END-FLG             PIC X               VALUE SPACE.
  4101     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4102     12  PRIOR-CERT-IN-CNTRL.
  4103         16  PCIC-FIRST      PIC x(19)  value low-values.
  4104         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4105         16  pcic-cert-no    pic x(11)  value low-values.
  4106     12  ACCT-FLG            PIC X               VALUE SPACE.
  4107     12  STATE-FLG           PIC X               VALUE SPACE.
  4108     12  COMP-FLG            PIC X               VALUE SPACE.
  4109     12  CARR-FLG            PIC X               VALUE SPACE.
  4110     12  FINAL-FLG           PIC X               VALUE SPACE.
  4111     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4112     12  REIN-FLG            PIC X               VALUE SPACE.
  4113     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4114     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4115
  4116 01  TEXAS-REG-WORK-AREAS   SYNC.
  4117     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4118     12  TEX-FACT-2          PIC S999        COMP-3.
  4119     12  TEX-FACT-3          PIC S999        COMP-3.
  4120     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4121     12  TEX-FACT-5          PIC S999        COMP-3.
  4122     12  TEX-FACT-6          PIC S999        COMP-3.
  4123     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4124     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4125     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4126
  4127 01  NET-PAY-INTERFACE.
  4128     12  NP-APR              PIC S999V9(4)   COMP-3.
  4129     12  NP-ORIG             PIC S999        COMP-3.
  4130     12  NP-REM              PIC S999        COMP-3.
  4131     12  NP-OPT              PIC X.
  4132     12  NP-CAP              PIC S999        COMP-3.
  4133     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4134     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4135     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4136     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4137     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4138     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4139     12  NP-ACCOUNT          PIC X(10).
  4140
  4141 01  HOLDERS SYNC.
  4142     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4143     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4144     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4145     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  82
* ECS010.cbl
  4146     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4147     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4148     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4149     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4150     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4151     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4152     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4153     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4154     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4155     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4156     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4157     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4158     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4159     12  REM-TRM1            PIC S999V99  COMP-3.
  4160     12  REM-TRM2            PIC S999V99  COMP-3.
  4161     12  REM-TRM3            PIC S999V99  COMP-3.
  4162     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4163     12  TEM-TRM1            PIC S999V99  COMP-3.
  4164     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4165     12  ORIG-TERM           PIC S999V99  COMP-3.
  4166     12  HLD-CONTROL.
  4167         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4168         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4169         16  HLD-STATE       PIC XX              VALUE SPACES.
  4170         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4171     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4172
  4173 01  DISPLAY-IBNR-LINE.
  4174     05  FILLER                  PIC X       VALUE SPACES.
  4175     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4176     05  FILLER                  PIC XX      VALUE SPACES.
  4177     05  DIL-TYPE                PIC X       VALUE SPACES.
  4178     05  FILLER                  PIC X       VALUE SPACES.
  4179     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4180     05  FILLER                  PIC XXX     VALUE SPACES.
  4181     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4182
  4183 01  DISPLAY-HD-1.
  4184     05  FILLER      PIC X       VALUE SPACES.
  4185     05  FILLER      PIC X(50)   VALUE SPACES.
  4186     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4187     05  FILLER      PIC X(51)   VALUE SPACES.
  4188     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4189
  4190 01  DISPLAY-HD-2.
  4191     05  FILLER                 PIC X       VALUE SPACE.
  4192     05  FILLER                 PIC X(57)   VALUE SPACES.
  4193     05  DIS-DATE               PIC X(8).
  4194     05  FILLER                 PIC X(66)   VALUE SPACES.
  4195
  4196 01  DISPLAY-LINE.
  4197     05  DL-FULL.
  4198         10  FILLER           PIC X       VALUE SPACE.
  4199         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4200         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4201
  4202 01  PRT-HDNGS SYNC.
  4203     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  83
* ECS010.cbl
  4204         16  FILLER      PIC X       VALUE '1'.
  4205         16  FILLER      PIC X(53)   VALUE SPACES.
  4206         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4207         16  FILLER      PIC X(48)   VALUE SPACES.
  4208         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4209     12  TR-HD-2.
  4210         16  FILLER      PIC X       VALUE SPACE.
  4211         16  FILLER      PIC X(47)   VALUE SPACES.
  4212         16  TRHDNM      PIC X(30).
  4213         16  FILLER      PIC X(42)   VALUE SPACES.
  4214         16  TR-RN-DT    PIC X(8).
  4215     12  TR-HD-3.
  4216         16  FILLER      PIC X       VALUE SPACE.
  4217         16  FILLER      PIC X(53)   VALUE SPACES.
  4218         16  TR-MODAYR   PIC X(18).
  4219         16  FILLER      PIC X       VALUE SPACE.
  4220         16  TR-YRASK    PIC X       VALUE SPACE.
  4221         16  FILLER      PIC X(46)   VALUE SPACES.
  4222         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4223         16  TR-PG       PIC ZZ,ZZ9.
  4224     12  TR-HD-4.
  4225         16  FILLER      PIC X       VALUE SPACE.
  4226         16  TR-AGCY     PIC X(30).
  4227     12  TR-HD-5.
  4228         16  FILLER      PIC X       VALUE SPACE.
  4229         16  TR-CARR     PIC X.
  4230         16  FILLER      PIC X       VALUE '-'.
  4231         16  TR-GROUP    PIC X(6).
  4232         16  FILLER      PIC X       VALUE '-'.
  4233         16  TR-ST-NO    PIC X(2).
  4234         16  FILLER      PIC X       VALUE '-'.
  4235         16  TR-AG-NO    PIC X(10).
  4236         16  FILLER      PIC X(23)   VALUE SPACES.
  4237         16  TR5-RP-TYP.
  4238             20  FILLER  PIC X(20)   VALUE
  4239                     '* * * * TRANSACTION '.
  4240             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4241     12  TR-HD-6.
  4242         16  FILLER      PIC X       VALUE SPACE.
  4243         16  TR-CE-MO    PIC XX.
  4244         16  FILLER      PIC X       VALUE '-'.
  4245         16  TR-CE-DA    PIC XX.
  4246         16  FILLER      PIC X       VALUE '-'.
  4247         16  TR-CE-YR    PIC XX.
  4248         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4249         16  TR-CX.
  4250             20  TR-CX-MO PIC XX.
  4251             20  HSHR1    PIC X.
  4252             20  TR-CX-DA PIC XX.
  4253             20  HSHR2    PIC X.
  4254             20  TR-CX-YR PIC XX.
  4255     12  TR-HD-7.
  4256         16  FILLER  PIC X      VALUE '0'.
  4257         16  FILLER  PIC X(24)  VALUE SPACES.
  4258         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4259         16  TR-7-LF PIC X(6).
  4260         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4261         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  84
* ECS010.cbl
  4262         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4263         16  TR-7-AH PIC X(6).
  4264         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4265         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4266     12  TR-HD-8.
  4267         16  FILLER  PIC X      VALUE SPACE.
  4268         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4269         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4270         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4271         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4272         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4273     12  TR-HD-9.
  4274         16  FILLER  PIC X      VALUE SPACE.
  4275         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4276         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4277         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4278         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4279         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4280         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4281     12  TR-TTL-HD.
  4282         16  FILLER      PIC X       VALUE '0'.
  4283         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4284         16  FILLER      PIC XX      VALUE SPACES.
  4285         16  TTL-HD-DS   PIC X(60)   VALUE
  4286             'ECS010 CONTROL TOTALS'.
  4287
  4288 01  TR-DTL.
  4289     12  FILLER                  PIC X           VALUE SPACE.
  4290     12  TR-DTL1.
  4291         16  TRD-CERT            PIC X(11).
  4292         16  TRD-ISDT.
  4293             20  FILLER          PIC X           VALUE SPACE.
  4294             20  TRD-ISMO        PIC XX.
  4295             20  TRD-IS-S1       PIC X           VALUE '/'.
  4296             20  TRD-ISDA        PIC XX.
  4297             20  TRD-IS-S2       PIC X           VALUE '/'.
  4298             20  TRD-ISYR        PIC XX.
  4299             20  FILLER          PIC X           VALUE SPACE.
  4300         16  TRD-AGE             PIC XX.
  4301     12  TR-DTL2.
  4302         16  FILLER              PIC X           VALUE SPACE.
  4303         16  TRD-LFTYP           PIC XXX.
  4304         16  FILLER              PIC X           VALUE SPACE.
  4305         16  TRD-LFTRM           PIC ZZ9.
  4306         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4307         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4308         16  TRD-LFACTDT.
  4309             20  FILLER          PIC X           VALUE SPACE.
  4310             20  TRD-LFACTMO     PIC XX.
  4311             20  TRD-LF-S1       PIC X           VALUE '/'.
  4312             20  TRD-LFACTDA     PIC XX.
  4313             20  TRD-LF-S2       PIC X           VALUE '/'.
  4314             20  TRD-LFACTYR     PIC XX.
  4315             20  FILLER          PIC X           VALUE SPACE.
  4316         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4317         16  FILLER              PIC X           VALUE SPACE.
  4318         16  TRD-LF-STATUS       PIC X.
  4319         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  85
* ECS010.cbl
  4320         16  TRD-AHTYP           PIC XXX.
  4321         16  FILLER              PIC X           VALUE SPACE.
  4322         16  TRD-AHTRM           PIC ZZ9.
  4323         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4324         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4325         16  TRD-AHACTDT.
  4326             20  FILLER          PIC X           VALUE SPACE.
  4327             20  TRD-AHACTMO     PIC XX.
  4328             20  TRD-AH-S1       PIC X           VALUE '/'.
  4329             20  TRD-AHACTDA     PIC XX.
  4330             20  TRD-AH-S2       PIC X           VALUE '/'.
  4331             20  TRD-AHACTYR     PIC XX.
  4332             20  FILLER          PIC X           VALUE SPACE.
  4333         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4334         16  FILLER              PIC X           VALUE SPACE.
  4335         16  TRD-AH-STATUS       PIC X.
  4336     12  TR-DTL3 REDEFINES TR-DTL2.
  4337         16  FILLER              PIC X(20).
  4338         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4339         16  FILLER              PIC X.
  4340         16  TRD-IBNRX           PIC X(4).
  4341         16  FILLER              PIC X(2).
  4342         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4343         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4344                                 PIC X(11).
  4345         16  FILLER              PIC X.
  4346         16  TRD-PAYCURX         PIC X(8).
  4347         16  FILLER              PIC X(2).
  4348         16  TRD-FUTRSV-DATA.
  4349             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4350             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4351                                 PIC X(11).
  4352             20  FILLER          PIC X.
  4353             20  TRD-FUTRSVX     PIC X(6).
  4354         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4355             20  TRD-BENEFIT-X   PIC X(10).
  4356             20  TRD-BENEFIT-CODE
  4357                                 PIC X(02).
  4358             20  FILLER          PIC X(06).
  4359         16  FILLER              PIC X(4).
  4360         16  TRD-RSV-DESC        PIC X(6).
  4361         16  TRD-RSV-ACTION      PIC X(21).
  4362
  4363 01  DET-PR-UREC.
  4364     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4365     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4366     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4367     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4368     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4369     12  DET-SEX             PIC X.
  4370     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4371     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4372     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4373     12  DET-PR-MEM          PIC X(12).
  4374     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4375     12  DET-PR-SS           PIC X(11).
  4376     12  FILLER              PIC XXX      VALUE SPACES.
  4377     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  86
* ECS010.cbl
  4378
  4379 01  DET-PR-UREC-2.
  4380     12  FILLER              PIC X        VALUE SPACE.
  4381     12  DET-LF-DESC         PIC XX.
  4382     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4383     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4384     12  FILLER              PIC X(4)     VALUE ' TO '.
  4385     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4386     12  FILLER              PIC X        VALUE SPACE.
  4387     12  DET-AH-DESC         PIC XX.
  4388     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4389     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4390     12  FILLER              PIC X(4)     VALUE ' TO '.
  4391     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4392     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4393     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4394     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4395     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4396     12  FILLER              PIC X(5)     VALUE SPACES.
  4397     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4398
  4399 01  DET-PR-UREC-3.
  4400     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4401     12  DET-IND-GRP         PIC X.
  4402     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4403     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4404     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4405     12  DET-POL-FORM        PIC X(12).
  4406     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4407     12  DET-LOAN-OFFICER    PIC XXX.
  4408     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4409     12  DET-USER-CODE       PIC X.
  4410     12  FILLER              PIC X(8)     VALUE SPACES.
  4411     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4412
  4413 01  DET-PR-UREC-4.
  4414     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4415     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4416     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4417     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4418     12  FILLER              PIC X(37)    VALUE SPACES.
  4419     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4420
  4421 01  DET-PR-UREC-5.
  4422     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4423     12  DET-LF-BEN-CD       PIC XX.
  4424     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4425     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4426     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4427     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4428     12  FILLER              PIC X(30)    VALUE SPACES.
  4429     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4430
  4431 01  DET-PR-UREC-6.
  4432     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4433     12  DET-AH-BEN-CD       PIC XX.
  4434     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4435     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  87
* ECS010.cbl
  4436     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4437     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4438     12  FILLER              PIC X(30)    VALUE SPACES.
  4439     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4440
  4441 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4442     88  WS-CHANGE-REC              VALUE 'Y'.
  4443
  4444 01  TOTAL-PAGE-HD1.
  4445     12  FILLER              PIC X               VALUE SPACE.
  4446     12  TPH1-TYPE           PIC X(8).
  4447     12  TPH1-DESC.
  4448         16  TPH1-ST-CODE    PIC XX.
  4449         16  FILLER          PIC XXX.
  4450         16  TPH1-ST-DESC    PIC X(20).
  4451
  4452 01  TOTAL-PAGE-HD2.
  4453     12  FILLER              PIC X           VALUE SPACE.
  4454     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4455     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4456     12  FILLER              PIC X(9)        VALUE SPACES.
  4457     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4458     12  FILLER              PIC X(11)       VALUE SPACES.
  4459     12  FILLER              PIC X(3)        VALUE 'NET'.
  4460     12  FILLER              PIC X(11)       VALUE SPACES.
  4461     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4462     12  FILLER              PIC X(10)       VALUE SPACES.
  4463     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4464
  4465 01  TOTAL-PAGE-HD3.
  4466     12  FILLER              PIC X           VALUE SPACE.
  4467     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4468     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4469     12  FILLER              PIC X(10)       VALUE SPACES.
  4470     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4471     12  FILLER              PIC X(10)       VALUE SPACES.
  4472     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4473     12  FILLER              PIC X(7)        VALUE SPACES.
  4474     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4475     12  FILLER              PIC X(08)       VALUE SPACES.
  4476     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4477     12  FILLER              PIC X(11)       VALUE SPACES.
  4478     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4479
  4480 01  TOTAL-PAGE-DETAIL.
  4481     12  FILLER              PIC X(5).
  4482     12  TPD-DESC            PIC X(6).
  4483     12  FILLER              PIC X(3).
  4484     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4485     12  FILLER              PIC X(2).
  4486     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4487     12  FILLER              PIC X(2).
  4488     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4489     12  FILLER              PIC X(2).
  4490     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4491     12  FILLER              PIC X(2).
  4492     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4493     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  88
* ECS010.cbl
  4494     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4495     12  FILLER              PIC X(4).
  4496     12  TPD-LO-CERT         PIC X(6).
  4497     12  FILLER              PIC X(2).
  4498     12  TPD-HI-CERT         PIC X(6).
  4499*    12  FILLER              PIC X.
  4500*    12  TPD-LO-CERT         PIC X(8).
  4501*    12  FILLER              PIC X.
  4502*    12  TPD-HI-CERT         PIC X(8).
  4503
  4504 01  DUPE-CERT-TABLE.
  4505     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4506         16  DUPE-ENTRY      PIC X(36).
  4507         16  DUPE-STATUS     PIC X(01).
  4508         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4509         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4510
  4511 01  MISMATCH-HEADING-1.
  4512     12  FILLER              PIC X           VALUE '1'.
  4513     12  FILLER              PIC X(45)       VALUE SPACES.
  4514     12  FILLER              PIC X(42)       VALUE
  4515             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4516     12  FILLER              PIC X(35)       VALUE SPACES.
  4517     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4518
  4519 01  MISMATCH-HEADING-2.
  4520     12  FILLER              PIC X           VALUE '0'.
  4521     12  FILLER              PIC X(44)       VALUE
  4522             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4523     12  FILLER              PIC X(44)       VALUE
  4524             'YPE      CERT IN CONTROL                    '.
  4525     12  FILLER              PIC X(44)       VALUE
  4526             '        CERT OUT CONTROL           STATUS   '.
  4527
  4528 01  MISMATCH-DETAIL.
  4529     12  FILLER              PIC X           VALUE '0'.
  4530     12  FILLER              PIC X           VALUE SPACES.
  4531     12  DTL-MATCH-CONTROL   PIC X(36).
  4532     12  FILLER              PIC X(3)        VALUE SPACES.
  4533     12  DTL-REC-TYPE        PIC X.
  4534     12  FILLER              PIC X(2)        VALUE SPACES.
  4535     12  DTL-REC-TYPE-DESC   PIC X(3).
  4536     12  FILLER              PIC X(3)        VALUE SPACES.
  4537     12  DTL-CERT-IN-CONTROL
  4538                             PIC X(36).
  4539     12  FILLER              PIC X           VALUE SPACES.
  4540     12  DTL-CERT-OUT-CONTROL
  4541                             PIC X(36).
  4542     12  FILLER              PIC X           VALUE SPACES.
  4543     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4544     12  FILLER              PIC X(2)        VALUE SPACES.
  4545
  4546 01  MISMATCH-DETAIL-2.
  4547     12  FILLER              PIC X           VALUE ' '.
  4548     12  FILLER              PIC X           VALUE SPACES.
  4549     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4550             ' LIFE PREMIUM = '.
  4551     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  89
* ECS010.cbl
  4552     12  FILLER              PIC X           VALUE SPACES.
  4553     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4554             'LIFE ALT PREM = '.
  4555     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4556     12  FILLER              PIC XX          VALUE SPACES.
  4557     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4558             'A/H PREMIUM = '.
  4559     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4560     12  FILLER              PIC X(39)       VALUE SPACES.
  4561
  4562 01  MISMATCH-DETAIL-3.
  4563     12  FILLER              PIC X           VALUE ' '.
  4564     12  FILLER              PIC X           VALUE SPACES.
  4565     12  FILLER              PIC X(16)       VALUE
  4566             ' LIFE  REFUND = '.
  4567     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4568     12  FILLER              PIC X           VALUE SPACES.
  4569     12  FILLER              PIC X(16)       VALUE
  4570             'A & H  REFUND = '.
  4571     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4572     12  FILLER              PIC X(72)       VALUE SPACES.
  4573
  4574 01  MISMATCH-DETAIL-4.
  4575     12  FILLER              PIC X           VALUE ' '.
  4576     12  FILLER              PIC X           VALUE SPACES.
  4577     12  FILLER              PIC X(16)       VALUE
  4578             ' LIFE  CLAIM  = '.
  4579     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4580     12  FILLER              PIC X           VALUE SPACES.
  4581     12  FILLER              PIC X(16)       VALUE
  4582             'A & H  CLAIM  = '.
  4583     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4584     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  90
* ECS010.cbl
  4586*
  4587*
  4588* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  91
* ECS010.cbl
  4590 01  PB-STARTS-HERE              PIC X(48)
  4591       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4592
* 4593                             COPY ERCPNDB.
  4594******************************************************************
  4595*                                                                *
  4596*                                                                *
  4597*                            ERCPNDB.                            *
  4598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4599*                            VMOD=2.025                          *
  4600*                                                                *
  4601*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4602*                                                                *
  4603******************************************************************
  4604*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4605*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4606******************************************************************
  4607*                                                                *
  4608*                                                                *
  4609*   FILE TYPE = VSAM,KSDS                                        *
  4610*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4611*                                                                *
  4612*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4613*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4614*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4615*                                                 RKP=13,LEN=36  *
  4616*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4617*                                      AND CHG-SEQ.)             *
  4618*                                                RKP=49,LEN=11   *
  4619*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4620*                                      AND CHG-SEQ.)             *
  4621*                                                RKP=60,LEN=15   *
  4622*                                                                *
  4623*   LOG = NO                                                     *
  4624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4625******************************************************************
  4626******************************************************************
  4627*                   C H A N G E   L O G
  4628*
  4629* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4630*-----------------------------------------------------------------
  4631*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4632* EFFECTIVE    NUMBER
  4633*-----------------------------------------------------------------
  4634* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4635* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4636* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4637* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4638* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4639* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4640* 032306                   PEMA  ADD BOW LOAN NUMBER
  4641* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4642* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4643* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4644* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4645* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4646* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4647* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  92
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4648* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4649******************************************************************
  4650
  4651 01  PENDING-BUSINESS.
  4652     12  PB-RECORD-ID                     PIC XX.
  4653         88  VALID-PB-ID                        VALUE 'PB'.
  4654
  4655     12  PB-CONTROL-PRIMARY.
  4656         16  PB-COMPANY-CD                PIC X.
  4657         16  PB-ENTRY-BATCH               PIC X(6).
  4658         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4659         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4660
  4661     12  PB-CONTROL-BY-ACCOUNT.
  4662         16  PB-COMPANY-CD-A1             PIC X.
  4663         16  PB-CARRIER                   PIC X.
  4664         16  PB-GROUPING.
  4665             20  PB-GROUPING-PREFIX       PIC XXX.
  4666             20  PB-GROUPING-PRIME        PIC XXX.
  4667         16  PB-STATE                     PIC XX.
  4668         16  PB-ACCOUNT.
  4669             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4670             20  PB-ACCOUNT-PRIME         PIC X(6).
  4671         16  PB-CERT-EFF-DT               PIC XX.
  4672         16  PB-CERT-NO.
  4673             20  PB-CERT-PRIME            PIC X(10).
  4674             20  PB-CERT-SFX              PIC X.
  4675         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4676
  4677         16  PB-RECORD-TYPE               PIC X.
  4678             88  PB-MAILING-DATA                VALUE '0'.
  4679             88  PB-ISSUE                       VALUE '1'.
  4680             88  PB-CANCELLATION                VALUE '2'.
  4681             88  PB-BATCH-TRAILER               VALUE '9'.
  4682
  4683     12  PB-CONTROL-BY-ORIG-BATCH.
  4684         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4685         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4686         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4687         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4688
  4689     12  PB-CONTROL-BY-CSR.
  4690         16  PB-CSR-COMPANY-CD            PIC X.
  4691         16  PB-CSR-ID                    PIC X(4).
  4692         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4693         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4694         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4695******************************************************************
  4696*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4697******************************************************************
  4698
  4699     12  PB-LAST-MAINT-DT                 PIC XX.
  4700     12  PB-LAST-MAINT-BY                 PIC X(4).
  4701     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4702
  4703     12  PB-RECORD-BODY                   PIC X(375).
  4704
  4705     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4706         16  PB-CERT-ORIGIN               PIC X.
  4707             88  CLASIC-CREATED-CERT         VALUE '1'.
  4708         16  PB-I-NAME.
  4709             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4710             20  PB-I-INSURED-FIRST-NAME.
  4711                 24  PB-I-INSURED-1ST-INIT PIC X.
  4712                 24  FILLER                PIC X(9).
  4713             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4714         16  PB-I-AGE                     PIC S99   COMP-3.
  4715         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4716         16  PB-I-BIRTHDAY                PIC XX.
  4717         16  PB-I-INSURED-SEX             PIC X.
  4718             88  PB-SEX-MALE     VALUE 'M'.
  4719             88  PB-SEX-FEMALE   VALUE 'F'.
  4720
  4721         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4722         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4723         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4724         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4725         16  PB-I-SKIP-CODE               PIC X.
  4726             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4727             88  PB-SKIP-JULY              VALUE '1'.
  4728             88  PB-SKIP-AUGUST            VALUE '2'.
  4729             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4730             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4731             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4732             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4733             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4734             88  PB-SKIP-JUNE              VALUE '8'.
  4735             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4736             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4737             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4738         16  PB-I-TERM-TYPE               PIC X.
  4739             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4740             88  PB-PAID-WEEKLY            VALUE 'W'.
  4741             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4742             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4743             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4744         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4745         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4746         16  PB-I-DATA-ENTRY-SW           PIC X.
  4747             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4748             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4749             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4750             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4751         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4752         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4753*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4754         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4755         16  FILLER                       PIC X.
  4756
  4757         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4758             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4759             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4760                                                   '90' THRU '99'.
  4761         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4762                                          PIC XX.
  4763         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4764         16  PB-I-AMOUNT-FINANCED REDEFINES
  4765                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4766         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4767         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4768                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4769         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4770         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4771         16  PB-I-CLP-AMOUNT REDEFINES
  4772                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4773         16  PB-I-LF-CALC-FLAG            PIC X.
  4774             88 PB-COMP-LF-PREM               VALUE '?'.
  4775         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4776         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4777         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4778         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4779         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4780         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4781         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4782         16  PB-I-LF-ABBR                 PIC XXX.
  4783         16  PB-I-LF-INPUT-CD             PIC XX.
  4784
  4785         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4786             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4787             88  PB-INVALID-AH               VALUE '  ' '00'
  4788                                                   '90' THRU '99'.
  4789         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4790         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4791         16  PB-I-AH-CALC-FLAG            PIC X.
  4792             88 PB-COMP-AH-PREM                  VALUE '?'.
  4793         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4794         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4795         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4796         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4797         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4798         16  PB-I-AH-ABBR                 PIC XXX.
  4799         16  PB-I-AH-INPUT-CD             PIC XXX.
  4800
  4801         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4802         16  PB-I-REIN-TABLE              PIC XXX.
  4803         16  PB-I-BUSINESS-TYPE           PIC 99.
  4804         16  PB-I-INDV-GRP-CD             PIC X.
  4805         16  PB-I-MORT-CODE.
  4806             20  PB-I-TABLE               PIC X.
  4807             20  PB-I-INTEREST            PIC XX.
  4808             20  PB-I-MORT-TYP            PIC X.
  4809         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4810         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4811         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4812         16  PB-I-INDV-GRP-OVRD           PIC X.
  4813         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4814         16  PB-I-SIG-SW                  PIC X.
  4815             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4816         16  PB-I-RATE-CLASS              PIC XX.
  4817         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4818         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4819         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4820         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4821         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4822         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4823         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4824         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4825         16  PB-I-OB-FLAG                 PIC X.
  4826             88  PB-I-OB                      VALUE 'B'.
  4827             88  PB-I-SUMMARY                 VALUE 'Z'.
  4828         16  PB-I-ENTRY-STATUS            PIC X.
  4829             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4830                                              'M' '5' '9' '2'.
  4831             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4832             88  PB-I-POLICY-PENDING          VALUE '2'.
  4833             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4834             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4835             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4836             88  PB-I-REIN-ONLY               VALUE '9'.
  4837             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4838             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4839             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4840             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4841         16  PB-I-INT-CODE                PIC X.
  4842             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4843             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4844         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4845         16  PB-I-SOC-SEC-NO              PIC X(11).
  4846         16  PB-I-MEMBER-NO               PIC X(12).
  4847         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4848*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4849         16  PB-I-OLD-LOF                 PIC XXX.
  4850         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4851         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4852         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4853         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4854         16  PB-I-LIFE-INDICATOR          PIC X.
  4855             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4856         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4857         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4858                                          PIC S9(5)V99    COMP-3.
  4859         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4860             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4861             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4862         16  PB-I-1ST-PMT-DT              PIC XX.
  4863         16  PB-I-JOINT-INSURED.
  4864             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4865             20 PB-I-JOINT-FIRST-NAME.
  4866                24  PB-I-JOINT-FIRST-INIT PIC X.
  4867                24  FILLER                PIC X(9).
  4868             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4869*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4870         16  PB-I-BENEFICIARY-NAME.
  4871             20  PB-I-BANK-NUMBER         PIC X(10).
  4872             20  FILLER                   PIC X(15).
  4873         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4874         16  PB-I-REFERENCE               PIC X(12).
  4875         16  FILLER REDEFINES PB-I-REFERENCE.
  4876             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4877             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4878             20  PB-I-CLP-STATE           PIC XX.
  4879         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4880             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4881             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4882             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4883         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4884         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4885         16  PB-I-RESIDENT-STATE          PIC XX.
  4886         16  PB-I-RATE-CODE               PIC X(4).
  4887         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4888         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4889         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4890         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4891         16  PB-I-BANK-NOCHRGB            PIC 99.
  4892         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4893         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4894
  4895     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4896         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4897             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4898         16  PB-C-CANCEL-ORIGIN           PIC X.
  4899             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4900         16  PB-C-LF-CANCEL-DT            PIC XX.
  4901         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4902         16  PB-C-LF-CALC-REQ             PIC X.
  4903             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4904         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4905         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4906         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4907             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4908         16  PB-C-AH-CANCEL-DT            PIC XX.
  4909         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4910         16  PB-C-AH-CALC-REQ             PIC X.
  4911             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4912         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4913         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4914         16  PB-C-LAST-NAME               PIC X(15).
  4915         16  PB-C-REFUND-SW               PIC X.
  4916             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4917             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4918         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4919         16  PB-C-PAYEE-CODE              PIC X(6).
  4920         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4921         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4922         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4923         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4924         16  PB-C-REFERENCE               PIC X(12).
  4925         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4926         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4927         16  PB-C-POST-CARD-IND           PIC X.
  4928         16  PB-C-CANCEL-REASON           PIC X.
  4929         16  PB-C-REF-INTERFACE-SW        PIC X.
  4930         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4931         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4932         16  FILLER                       PIC X(01).
  4933*        16  FILLER                       PIC X(18).
  4934         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4935*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4936         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4937         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4938             20  PB-CI-INSURED-NAME.
  4939                 24  PB-CI-LAST-NAME      PIC X(15).
  4940                 24  PB-CI-INITIALS       PIC XX.
  4941             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4942             20  PB-CI-INSURED-SEX        PIC X.
  4943             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4944             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4945             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4946             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4947             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4948             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4949             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4950             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4951             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4952             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4953             20  PB-CI-RATE-CLASS         PIC XX.
  4954             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4955             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4956             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4957             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4958             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4959             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4960             20  PB-CI-LF-ABBR            PIC X(3).
  4961             20  PB-CI-AH-ABBR            PIC X(3).
  4962             20  PB-CI-OB-FLAG            PIC X.
  4963                 88  PB-CI-OB                VALUE 'B'.
  4964             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4965                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4966                                           'M' '4' '5' '9' '2'.
  4967                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4968                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4969                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4970                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4971                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4972                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4973                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4974                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4975                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4976                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4977                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4978                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4979             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4980                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4981                                           'M' '4' '5' '9' '2'.
  4982                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4983                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4984                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4985                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4986                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4987                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4988                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4989                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4990                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4991                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4992                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4993                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4994             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4995             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4996             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4997             20  PB-CI-MEMBER-NO          PIC X(12).
  4998             20  PB-CI-INT-CODE           PIC X.
  4999                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5000                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5001             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5002             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5003             20  PB-CI-COMP-EXCP-SW       PIC X.
  5004                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5005                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5006             20  PB-CI-ENTRY-STATUS       PIC X.
  5007             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5008             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5009             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5010             20  PB-CI-DEATH-DT           PIC XX.
  5011             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5012             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5013             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5014             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5015             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5016             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5017             20  PB-CI-ENTRY-DT              PIC XX.
  5018             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5019             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5020             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5021             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5022             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5023             20  PB-CI-OLD-LOF               PIC XXX.
  5024*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5025             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5026             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5027             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5028             20  PB-CI-INDV-GRP-CD           PIC X.
  5029             20  PB-CI-BENEFICIARY-NAME.
  5030                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5031                 24  FILLER                  PIC X(15).
  5032             20  PB-CI-NOTE-SW               PIC X.
  5033             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5034             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5035             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5036             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5037             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5038             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5039             20  PB-CI-FIRST-NAME            PIC X(10).
  5040             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5041
  5042         16  FILLER                       PIC X(13).
  5043*032306  16  FILLER                       PIC X(27).
  5044*        16  FILLER                       PIC X(46).
  5045
  5046     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5047         16  FILLER                       PIC X(10).
  5048         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5049         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5050         16  PB-M-INSURED-MID-INIT        PIC X.
  5051         16  PB-M-INSURED-AGE             PIC 99.
  5052         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5053         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5054         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5055         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5056         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5057         16  PB-M-INSURED-CITY-STATE.
  5058             20  PB-M-INSURED-CITY        PIC X(28).
  5059             20  PB-M-INSURED-STATE       PIC XX.
  5060         16  PB-M-INSURED-ZIP-CODE.
  5061             20  PB-M-INSURED-ZIP-PRIME.
  5062                 24  PB-M-INSURED-ZIP-1   PIC X.
  5063                     88  PB-M-CANADIAN-POST-CODE
  5064                                             VALUE 'A' THRU 'Z'.
  5065                 24  FILLER               PIC X(4).
  5066             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5067         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5068                                        PB-M-INSURED-ZIP-CODE.
  5069             20  PM-M-INS-CAN-POST1       PIC XXX.
  5070             20  PM-M-INS-CAN-POST2       PIC XXX.
  5071             20  FILLER                   PIC XXX.
  5072         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5073         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5074         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5075         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5076         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5077         16  PB-M-CRED-BENE-CITYST.
  5078             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5079             20  PB-M-CRED-BENE-STATE     PIC XX.
  5080
  5081         16  FILLER                       PIC X(92).
  5082
  5083     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5084         16  FILLER                       PIC X(10).
  5085         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5086         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5087         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5088         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5089         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5090         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5091         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5092         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5093         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5094         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5095         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5096         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5097         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5098         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5099         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5100         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5101         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5102         16  PB-ACCOUNT-NAME              PIC X(30).
  5103         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5104         16  PB-REFERENCE                 PIC X(12).
  5105         16  PB-B-RECEIVED-DT             PIC XX.
  5106         16  FILLER                       PIC X(234).
  5107
  5108     12  PB-RECORD-STATUS.
  5109         16  PB-CREDIT-SELECT-DT          PIC XX.
  5110         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5111         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5112         16  PB-BILLING-STATUS            PIC X.
  5113             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5114             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5115             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5116         16  PB-RECORD-BILL               PIC X.
  5117             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5118             88  PB-RECORD-RETURNED           VALUE 'R'.
  5119             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5120             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5121             88  PB-OVERRIDE-AH               VALUE 'A'.
  5122             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5123         16  PB-BATCH-ENTRY               PIC X.
  5124             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5125             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5126             88  PB-REISSUED-CERT             VALUE 'E'.
  5127             88  PB-MONTHLY-CERT              VALUE 'M'.
  5128             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5129             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5130             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5131         16  PB-FORCE-CODE                PIC X.
  5132             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5133             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5134             88  PB-CANCEL-FORCE              VALUE '8'.
  5135             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5136             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5137             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5138             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5139             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5140             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5141             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5142         16  PB-FATAL-FLAG                PIC X.
  5143             88  PB-FATAL-ERRORS              VALUE 'X'.
  5144         16  PB-FORCE-ER-CD               PIC X.
  5145             88  PB-FORCE-ERRORS              VALUE 'F'.
  5146             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5147         16  PB-WARN-ER-CD                PIC X.
  5148             88  PB-WARNING-ERRORS            VALUE 'W'.
  5149         16  FILLER                       PIC X.
  5150         16  PB-OUT-BAL-CD                PIC X.
  5151             88  PB-OUT-OF-BAL                VALUE 'O'.
  5152         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5153         16  PB-AH-OVERRIDE-L1            PIC X.
  5154         16  PB-INPUT-DT                  PIC XX.
  5155         16  PB-INPUT-BY                  PIC X(4).
  5156         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5157         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5158         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5159         16  PB-LF-EARNING-METHOD         PIC X.
  5160         16  PB-AH-EARNING-METHOD         PIC X.
  5161         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5162         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5163         16  PB-REIN-CD                   PIC XXX.
  5164         16  PB-LF-REFUND-TYPE            PIC X.
  5165         16  PB-AH-REFUND-TYPE            PIC X.
  5166         16  PB-ACCT-EFF-DT               PIC XX.
  5167         16  PB-ACCT-EXP-DT               PIC XX.
  5168         16  PB-COMPANY-ID                PIC X(3).
  5169         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5170         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5171         16  PB-SV-CARRIER                PIC X.
  5172         16  PB-SV-GROUPING               PIC X(6).
  5173         16  PB-SV-STATE                  PIC XX.
  5174         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5175         16  PB-GA-BILLING-INFO.
  5176             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5177                                          PIC XX.
  5178         16  PB-SV-REMIT-TO  REDEFINES
  5179             PB-GA-BILLING-INFO           PIC X(10).
  5180         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5181         16  PB-I-LOAN-OFFICER            PIC X(5).
  5182         16  PB-I-VIN                     PIC X(17).
  5183
  5184         16  FILLER                       PIC X(04).
  5185         16  IMNET-BYPASS-SW              PIC X.
  5186
  5187******************************************************************
  5188*                COMMON EDIT ERRORS                              *
  5189******************************************************************
  5190
  5191     12  PB-COMMON-ERRORS.
  5192         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5193                                           PIC S9(4)     COMP.
  5194
  5195******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 102
* ECS010.cbl
  5197 01  PC-STARTS-HERE              PIC X(48)
  5198       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5199
* 5200                             COPY ERCPNDC.
  5201******************************************************************04/29/98
  5202*                                                                *ERCPNDC
  5203*                                                                *ERCPNDC
  5204*                            ERCPNDC                             *   LV003
  5205*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5206*                            VMOD=2.004                          *   CL**2
  5207*                                                                *ERCPNDC
  5208*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5209*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5210*                                                                *ERCPNDC
  5211*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5212*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5213*                                                                *ERCPNDC
  5214*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5215*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5216*                                                                *ERCPNDC
  5217*   LOG = YES                                                    *ERCPNDC
  5218*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5219******************************************************************ERCPNDC
  5220                                                                  ERCPNDC
  5221 01  PENDING-CLAIMS.                                              ERCPNDC
  5222     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5223         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5224                                                                  ERCPNDC
  5225     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5226         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5227         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5228         16  PC-GROUPING.                                         ERCPNDC
  5229             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5230             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5231         16  PC-STATE                     PIC XX.                 ERCPNDC
  5232         16  PC-ACCOUNT.                                          ERCPNDC
  5233             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5234             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5235         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5236         16  PC-CERT-NO.                                          ERCPNDC
  5237             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5238             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5239         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5240         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5241                                                                  ERCPNDC
  5242         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5243             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5244             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5245         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5246                                                                  ERCPNDC
  5247     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5248     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5249     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5250                                                                  ERCPNDC
  5251     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5252         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5253             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5254             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 103
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5255             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5256             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5257         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5258         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5259         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5260         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5261         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5262         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5263         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5264         16  FILLER                       PIC XX.                 ERCPNDC
  5265         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5266             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5267             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5268             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5269             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5270             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5271             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5272             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5273                                                                  ERCPNDC
  5274         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5275         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5276         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5277         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5278                                                                  ERCPNDC
  5279         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5280         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5281         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5282                                                                  ERCPNDC
  5283         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5284             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5285                                                                  ERCPNDC
  5286         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5287         16  FILLER                       PIC X(48).              ERCPNDC
  5288                                                                  ERCPNDC
  5289         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5290             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5291                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5292                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5293             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5294             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5295             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5296             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5297             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5298             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5299             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5300             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5301             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5302             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5303             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5304             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5305             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5306                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5307             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5308                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5309                                               '4' '5' '9' '2'.   ERCPNDC
  5310                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5311                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5312                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5313                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5314                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5315                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5316                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5317                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5318                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5319             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5320                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5321                                               '4' '5' '9' '2'.   ERCPNDC
  5322                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5323                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5324                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5325                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5326                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5327                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5328                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5329                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5330                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5331             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5332             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5333             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5334             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5335             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5336                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5337                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5338             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5339             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5340             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5341             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5342             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5343             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5344             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5345             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5346         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5347         16  PC-CC-CLP-STATE              PIC XX.
  5348         16  FILLER                       PIC X(14).              ERCPNDC
  5349         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5350         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5351         16  FILLER                       PIC X(34).              ERCPNDC
  5352                                                                  ERCPNDC
  5353     12  PC-RECORD-STATUS.                                        ERCPNDC
  5354         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5355         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5356         16  FILLER                       PIC XX.                 ERCPNDC
  5357         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5358             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5359         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5360             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5361             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5362                                                     '8'.         ERCPNDC
  5363         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5364             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5365             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5366         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5367             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5368         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5369         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5370         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5371         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5372             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5373         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5374         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5375                                                                  ERCPNDC
  5376     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5377         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5378             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5379         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5380             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5381                                                                  ERCPNDC
  5382     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5383         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5384                                                                  ERCPNDC
  5385     12  FILLER                           PIC X(25).              ERCPNDC
  5386                                                                  ERCPNDC
  5387******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 106
* ECS010.cbl
  5389 01  CC-STARTS-HERE              PIC X(48)
  5390       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5391
* 5392                             COPY ERCCRTC.
  5393******************************************************************04/29/98
  5394*                                                                *ERCCRTC
  5395*                                                                *ERCCRTC
  5396*                            ERCCRTC                             *   LV003
  5397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5398*                            VMOD=2.005                          *   CL**3
  5399*                                                                *ERCCRTC
  5400*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5401*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5402*                       ISSUES AND CANCELS)                      *ERCCRTC
  5403*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5404*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5405*                                                                *ERCCRTC
  5406*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5407*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5408*                                                                *ERCCRTC
  5409*   LOG = YES                                                    *ERCCRTC
  5410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5411******************************************************************ERCCRTC
  5412*                   C H A N G E   L O G
  5413*
  5414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5415*-----------------------------------------------------------------
  5416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5417* EFFECTIVE    NUMBER
  5418*-----------------------------------------------------------------
  5419* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5420******************************************************************
  5421 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5422     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5423         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5424                                                                  ERCCRTC
  5425     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5426         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5427         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5428         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5429         16  CC-STATE                     PIC XX.                 ERCCRTC
  5430         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5431         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5432         16  CC-CERT-NO.                                          ERCCRTC
  5433             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5434             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5435                                                                  ERCCRTC
  5436         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5437                                                                  ERCCRTC
  5438     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5439     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5440     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5441                                                                  ERCCRTC
  5442     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5443                                                                  ERCCRTC
  5444     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5445         16  FILLER                       PIC X(10).              ERCCRTC
  5446         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 107
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5447             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5448             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5449                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5450                 24  FILLER               PIC X(9).               ERCCRTC
  5451             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5452         16  CC-AGE                       PIC S99.                ERCCRTC
  5453         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5454         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5455         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5456             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5457             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5458         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5459             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5460             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5461                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5462                 24  FILLER               PIC X(9).               ERCCRTC
  5463             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5464         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5465         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5466         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5467         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5468         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5469         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5470         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5471         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5472         16  CC-OLD-LOF                   PIC XXX.
  5473*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5474         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5475         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5476         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5477         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5478         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5479         16  FILLER                       PIC X(3).               ERCCRTC
  5480         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5481         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5482         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5483         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5484         16  CC-LOAN-OFFICER              PIC X(5).
  5485         16  FILLER                       PIC XXX.                ERCCRTC
  5486     12  CC-RECORD-STATUS.                                        ERCCRTC
  5487         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5488         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5489     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5490         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5491         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5492         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5493         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5494     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5495     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5496         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5497             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5498         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5499             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5500     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5501         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5502         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5503         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5504         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5505                                                                  ERCCRTC
  5506     12  FILLER                           PIC X(05).              ERCCRTC
  5507******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 109
* ECS010.cbl
  5509 01  CR-STARTS-HERE              PIC X(48)
  5510       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5511
* 5512                             COPY ECSCRT01.
  5513******************************************************************
  5514*                                                                *
  5515*                            ECSCRT01                            *
  5516*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5517*                            VMOD=2.016                          *
  5518*                                                                *
  5519*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5520*                                                                *
  5521*   FILE TYPE = SEQUENTIAL
  5522*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5523*                                                                *
  5524*   KEY DATA =                         START=4, LEN=36           *
  5525*                                                                *
  5526*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5527*                                                                *
  5528******************************************************************
  5529******************************************************************
  5530*                   C H A N G E   L O G
  5531*
  5532* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5533*-----------------------------------------------------------------
  5534*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5535* EFFECTIVE    NUMBER
  5536*-----------------------------------------------------------------
  5537* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5538* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5539* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5540* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5541* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5542* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5543* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5544* 032612  CR2011110200001  PEMA  AHL CHANGES
  5545******************************************************************
  5546
  5547 01  CERTIFICATE-RECORD.
  5548     12  CR-RECORD-ID                      PIC XX.
  5549         88  VALID-CR-ID                      VALUE 'CR'.
  5550
  5551     12  CR-COMPANY-CD                     PIC X.
  5552
  5553     12  CR-FULL-CONTROL.
  5554         16  CR-CONTROL-1.
  5555             20  CR-ACCT-CONTROL.
  5556                 24  CR-CARRIER            PIC X.
  5557                 24  CR-GROUPING.
  5558                     28  CR-GROUP-PREFIX   PIC XXX.
  5559                     28  CR-GROUP-PRIME    PIC XXX.
  5560                 24  CR-STATE              PIC XX.
  5561                 24  CR-ACCOUNT.
  5562                     28  CR-ACCT-PREFIX    PIC X(4).
  5563                     28  CR-ACCT-PRIME     PIC X(6).
  5564             20  CR-DT                     PIC 9(11)  COMP-3.
  5565         16  CR-CERT-NO.
  5566             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 110
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5567                 24  CR-CERT-PREFIX        PIC X(3).
  5568                 24  CR-CERT-PRIME         PIC X(7).
  5569             20  CR-CERT-SFX               PIC X.
  5570
  5571     12  CR-INSUREDS-PROFILE.
  5572         16  CR-NAME.
  5573             20  CR-LNAME                  PIC X(15).
  5574             20  CR-FNAME.
  5575                 24  CR-1ST-INITIAL        PIC X.
  5576                 24  FILLER                PIC X(9).
  5577             20  CR-INIT                   PIC X.
  5578         16  CR-AGE                        PIC 99.
  5579         16  CR-SEX                        PIC X.
  5580             88  CR-SEX-MALE                  VALUE 'M'.
  5581             88  CR-SEX-FEMALE                VALUE 'F'.
  5582         16  CR-SOC-SEC                    PIC X(11).
  5583         16  CR-JOINT-NAME.
  5584             20  CR-JT-LNAME               PIC X(15).
  5585             20  CR-JT-FNAME.
  5586                 24  CR-JT-1ST-INIT        PIC X.
  5587                 24  FILLER                PIC X(9).
  5588             20  CR-JT-INIT                PIC X.
  5589         16  CR-JOINT-AGE                  PIC 99.
  5590
  5591         16  cr-ahl-ah-claim-no            pic x(9).
  5592         16  cr-ahl-ah-cert-seq            pic x(3).
  5593         16  cr-hst-proc-lf                pic x.
  5594         16  f                             pic x(7).
  5595
  5596     12  CR-LF-COVERAGE-DATA.
  5597         16  CR-LFTYP                      PIC XX.
  5598         16  CR-LF-TERM                    PIC S999       COMP-3.
  5599         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5600         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5601         16  CR-LF-DEV-CODE                PIC XXX.
  5602         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5603
  5604         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5605         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5606         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5607         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5608
  5609         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5610         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5611         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5612         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5613
  5614         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5615         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5616
  5617         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5618         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5619
  5620         16  CR-LF-REFUND-TYPE             PIC X.
  5621         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5622
  5623         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5624             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5625
  5626         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5627
  5628         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5629         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5630         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5631
  5632         16  cr-ahl-lf-claim-no            pic x(9).
  5633         16  cr-ahl-lf-cert-seq            pic x(3).
  5634         16  FILLER                        PIC XX.
  5635
  5636     12  CR-AH-COVERAGE-DATA.
  5637         16  CR-AHTYP                      PIC XX.
  5638         16  CR-AH-TERM                    PIC S999       COMP-3.
  5639         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5640         16  CR-AH-DEV-CODE                PIC XXX.
  5641         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5642
  5643         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5644         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5645         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5646         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5647
  5648         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5649         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5650
  5651         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5652         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5653
  5654         16  CR-AH-REFUND-TYPE             PIC X.
  5655         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5656
  5657         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5658             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5659
  5660         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5661
  5662         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5663         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5664         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5665
  5666         16  FILLER                        PIC XX.
  5667*        16  FILLER                        PIC X(8).
  5668
  5669     12  CR-LOAN-DATA.
  5670         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5671         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5672                                           PIC S9(5)V99   COMP-3.
  5673         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5674         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5675         16  CR-PMT-FREQ                   PIC 99.
  5676         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5677         16  CR-RATING-CLASS               PIC XX.
  5678         16  CR-POLICY-FORM-NO             PIC X(12).
  5679         16  CR-GRPTYP                     PIC XX.
  5680         16  CR-IND-GRP                    PIC X.
  5681             88  CR-INDIVIDUAL                VALUE '1'.
  5682             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5683         16  CR-SKIP                       PIC 99.
  5684             88  NO-MONTHS-SKIPPED            VALUE 00.
  5685             88  SKIP-JULY                    VALUE 01.
  5686             88  SKIP-AUGUST                  VALUE 02.
  5687             88  SKIP-SEPTEMBER               VALUE 03.
  5688             88  SKIP-JULY-AUG                VALUE 04.
  5689             88  SKIP-AUG-SEPT                VALUE 05.
  5690             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5691             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5692             88  SKIP-JUNE                    VALUE 08.
  5693             88  SKIP-JUNE-JULY               VALUE 09.
  5694             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5695             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5696         16  CR-RESIDENT-STATE             PIC XX.
  5697         16  CR-RATE-CODE.
  5698             20  CR-LF-CLASS-CD            PIC XX.
  5699             20  CR-AH-CLASS-CD            PIC XX.
  5700         16  CR-MORT.
  5701             20  CR-TAB                    PIC X.
  5702             20  CR-INT                    PIC 99.
  5703             20  CR-GRP                    PIC X.
  5704         16  CR-MEMBER-NO                  PIC X(12).
  5705         16  CR-OLD-LOF                    PIC XXX.
  5706*        16  CR-LOAN-OFFICER               PIC XXX.
  5707         16  CR-REIN-TABLE                 PIC XXX.
  5708         16  CR-REIN-SPEC                  PIC X.
  5709         16  CR-LOAN-1ST-PMT-DT.
  5710             20  CR-1ST-PMT-YR             PIC 99.
  5711             20  CR-1ST-PMT-MO             PIC 99.
  5712             20  CR-1ST-PMT-DA             PIC 99.
  5713         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5714         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5715         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5716         16  CR-LAST-ADD-ON-DT             PIC XX.
  5717
  5718         16  CR-UNDERWRITING-CODE          PIC X.
  5719             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5720
  5721         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5722         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5723         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5724         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5725
  5726     12  CR-STATUS-INFORMATION.
  5727         16  CR-ENTRY-STATUS               PIC X.
  5728             88  CR-NORMAL-ENTRY              VALUE '1'.
  5729             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5730             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5731             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5732             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5733             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5734             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5735             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5736             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5737             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5738                                                    '5' '9' 'P'.
  5739         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5740
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5741         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5742         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5743         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5744
  5745         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5746         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5747
  5748         16  CR-LF-CURRENT-STATUS          PIC X.
  5749             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5750             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5751             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5752             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5753             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5754             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5755             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5756             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5757             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5758             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5759             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5760             88  CR-LF-IS-VOID                VALUE 'V'.
  5761             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5762                                                    '4' '5' '9'.
  5763
  5764         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5765
  5766         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5767         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5768
  5769         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5770         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5771
  5772         16  CR-AH-CURRENT-STATUS          PIC X.
  5773             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5774             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5775             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5776             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5777             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5778             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5779             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5780             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5781             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5782             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5783             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5784             88  CR-AH-IS-VOID                VALUE 'V'.
  5785             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5786                                                    '4' '5' '9'.
  5787         16  CR-LOAN-OFFICER               PIC X(5).
  5788         16  CR-CANCEL-REASON              PIC X.
  5789         16  cr-xycor-lf-cov-code          pic x(4).
  5790         16  cr-xycor-ah-cov-code          pic x(4).
  5791         16  FILLER                        PIC X(6).
  5792
  5793     12  CR-DEATH-CLAIM-DATA.
  5794         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5795
  5796         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5797         16  CR-DTH-RPT-DT.
  5798             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5799             20  CR-DTH-RPT-MO             PIC 99.
  5800             20  CR-DTH-RPT-DA             PIC 99.
  5801         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5802
  5803         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5804         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5805         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5806         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5807         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5808
  5809         16  CR-DTH-AGE                    PIC 99.
  5810         16  CR-DTH-PAY-CD                 PIC X.
  5811         16  CR-DEATH-CAUSE                PIC X(6).
  5812
  5813         16  FILLER                        PIC X(16).
  5814
  5815     12  CR-DISAB-CLAIM-DATA.
  5816         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5817
  5818         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5819         16  CR-DIS-RPT-DT.
  5820             20  CR-DIS-RPT-YR             PIC 99.
  5821             20  CR-DIS-RPT-MO             PIC 99.
  5822             20  CR-DIS-RPT-DA             PIC 99.
  5823         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5824         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5825
  5826         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5827         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5828         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5829         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5830         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5831
  5832         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5833         16  CR-DIS-PAY-CD                 PIC X.
  5834         16  FILLER                        PIC XX.
  5835
  5836         16  CR-DISAB-INCURRED-DETAIL.
  5837             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5838**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5839                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5840                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5841                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5842
  5843         16  CR-DISAB-CAUSE                PIC X(6).
  5844         16  FILLER                        PIC X(14).
  5845
  5846     12  CR-REMIT-TO                       PIC 99.
  5847
  5848     12  CR-COMPENSATION-LEVELS.
  5849         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5850             20  CR-COM-AGT.
  5851                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5852                 24  CR-COM-AGT-PRIME      PIC X(6).
  5853             20  CR-AGT-TYPE               PIC X.
  5854             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5855             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5856
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5857     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5858     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5859     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5860     12  CR-CLP-STATE                      PIC XX.
  5861     12  CR-POST-CARD-IND                  PIC X.
  5862     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5863     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5864     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5865     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5866     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5867     12  FILLER                            PIC X(07).
  5868
  5869     12  CR-CSR-CODE                       PIC XXX.
  5870
  5871     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5872     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5873
  5874     12  CR-MICROFILM-NUMBERS.
  5875*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5876         16  FILLER                        PIC X(5).
  5877     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5878
  5879     12  CR-USER-CODE                      PIC X.
  5880     12  CR-USER-FUTURE                    PIC X(9).
  5881
  5882     12  CR-BENEFICIARY.
  5883         16  CR-BANK-NO                    PIC X(10).
  5884         16  FILLER                        PIC X(15).
  5885
  5886     12  CR-ENTRY-BATCH                    PIC X(6).
  5887     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5888     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5889
  5890     12  CR-NOTE-SW                        PIC X.
  5891
  5892     12  CR-ORIGIN-INDICATOR               PIC X.
  5893         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5894         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5895
  5896     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5897     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5898     12  FILLER                            PIC X(33).
  5899
  5900******************************************************************
* 5901                             COPY ELCCRTVR.
  5902***************************************************************** 04/24/98
  5903*                                                                *ELCCRTVR
  5904*                                                                *ELCCRTVR
  5905*                            ELCCRTVR                            *   LV003
  5906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5907*                            VMOD=2.001                          *ELCCRTVR
  5908*                                                                *ELCCRTVR
  5909*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5910*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5911*                                                                *ELCCRTVR
  5912******************************************************************ELCCRTVR
  5913                                                                  ELCCRTVR
  5914 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5915     05  WS-CR-DT.                                                ELCCRTVR
  5916         10  FILLER                PIC 999.                       ELCCRTVR
  5917         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5918         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5919             15  CR-CC             PIC 99.                        ELCCRTVR
  5920             15  CR-YR             PIC 99.                        ELCCRTVR
  5921         10  CR-MO                 PIC 99.                        ELCCRTVR
  5922         10  CR-DA                 PIC 99.                        ELCCRTVR
  5923     05  WS-CR-DT-N REDEFINES                                        CL**2
  5924            WS-CR-DT               PIC 9(11).                        CL**2
  5925     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5926         10  FILLER                    PIC 999.                   ELCCRTVR
  5927         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5928         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5929             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5930             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5931         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5932         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5933     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5934            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5935     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5936         10  FILLER                    PIC 999.                   ELCCRTVR
  5937         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5938         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5939             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5940             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5941         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5942         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5943     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5944            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5945     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5946         10  FILLER                    PIC 999.                   ELCCRTVR
  5947         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5948         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5949             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5950             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5951         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5952         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5953     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5954            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5955     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5956         10  FILLER                    PIC 999.                   ELCCRTVR
  5957         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5958         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5959             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5960             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5961         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5962         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5963     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5964            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5965     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5966         10  FILLER                    PIC 999.                   ELCCRTVR
  5967         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5968         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5969             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5970             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5971         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5972         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5973     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5974            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5975     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5976         10  FILLER                    PIC 999.                   ELCCRTVR
  5977         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5978         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5979             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5980             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5981         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5982         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5983     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5984            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5985     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5986         10  FILLER                    PIC 999.                   ELCCRTVR
  5987         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5988         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5989             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5990             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5991         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5992         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5993     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5994            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5995     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5996         10  FILLER                    PIC 999.                   ELCCRTVR
  5997         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5998         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5999             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  6000             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  6001         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  6002         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  6003     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6004            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6005     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  6006         10  FILLER                    PIC 999.                   ELCCRTVR
  6007         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6008         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  6009             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  6010             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  6011         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  6012         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  6013     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  6014          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  6015     05  WS-CR-DTH-DT.                                            ELCCRTVR
  6016         10  FILLER                    PIC 999.                   ELCCRTVR
  6017         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  6018         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  6019             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  6020             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  6021         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  6022         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  6023     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6024            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6025     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6026         10  FILLER                    PIC 999.                   ELCCRTVR
  6027         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6028         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6029             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6030             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6031         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6032         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6033     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6034            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6035     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6036         10  FILLER                    PIC 999.                   ELCCRTVR
  6037         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6038         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6039             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6040             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6041         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6042         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6043     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6044            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6045     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6046         10  FILLER                    PIC 999.                   ELCCRTVR
  6047         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6048         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6049             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6050             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6051         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6052         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6053     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6054            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6055     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6056         10  FILLER                    PIC 999.                   ELCCRTVR
  6057         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6058         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6059             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6060             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6061         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6062         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6063     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6064            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6065     05  COPY-NDX                      PIC 9.                        CL**6
  6066     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6067         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6068             15  FILLER                PIC 999.                   ELCCRTVR
  6069             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6070             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6071                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6072                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6073             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6074             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6075         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6076                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6077
  6078 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 119
* ECS010.cbl
* 6080                             COPY ELCDATE.
  6081******************************************************************06/11/98
  6082*                                                                *ELCDATE
  6083*                                                                *ELCDATE
  6084*                            ELCDATE.                            *   LV023
  6085*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6086*                            VMOD=2.003                           ELCDATE
  6087*                                                                *ELCDATE
  6088*                                                                *ELCDATE
  6089*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6090*                 LENGTH = 200                                   *   CL*19
  6091******************************************************************ELCDATE
  6092                                                                  ELCDATE
  6093 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6094     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6095     12  DC-OPTION-CODE                PIC X.                        CL*15
  6096         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6097         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6098         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6099         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6100         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6101         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6102         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6103         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6104         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6105         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6106         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6107         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6108         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6109         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6110         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6111         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6112         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6113         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6114         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6115         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6116         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6117         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6118         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6119         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6120         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6121         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6122         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6123         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6124         88  THREE-CHARACTER-BIN                                  ELCDATE
  6125                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6126         88  GREGORIAN-TO-BIN                                        CL**2
  6127                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6128         88  BIN-TO-GREGORIAN                                        CL**2
  6129                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6130         88  JULIAN-TO-BINARY                                        CL**2
  6131                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6132     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6133         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6134         88  DATE-CONVERSION-ERROR                                ELCDATE
  6135                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6136         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6137         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 120
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6138         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6139         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6140         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6141         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6142         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6143         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6144         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6145         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6146     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6147         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6148     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6149         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6150         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6151         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6152     12  FILLER                        PIC X.                        CL*15
  6153     12  DC-CONVERSION-DATES.                                        CL*15
  6154         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6155         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6156         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6157         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6158                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6159             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6160             20  SLASH1-1              PIC X.                        CL*15
  6161             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6162             20  SLASH1-2              PIC X.                        CL*15
  6163             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6164         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6165         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6166                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6167             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6168             20  SLASH2-1              PIC X.                        CL*15
  6169             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6170             20  SLASH2-2              PIC X.                        CL*15
  6171             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6172         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6173         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6174                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6175             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6176             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6177             20  DC-YMD-DAY            PIC 99.                       CL*15
  6178         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6179         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6180                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6181             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6182             20  DC-MDY-DAY            PIC 99.                       CL*15
  6183             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6184         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6185             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6186             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6187             20  FILLER                PIC XX.                       CL*15
  6188             20  DC-ALPHA-CENTURY.                                   CL*15
  6189                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6190             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6191         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6192         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6193         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6194         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6195         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6196                                       PIC 9(05).                    CL*20
  6197         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6198             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6199             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6200         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6201         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6202         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6203     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6204         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6205         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6206             20  FILLER                PIC 9(3).                     CL*15
  6207             20  HOLD-CEN-1-CCYY.                                    CL*15
  6208                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6209                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6210             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6211             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6212         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6213             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6214             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6215             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6216                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6217                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6218             20  FILLER                PIC 9(3).                     CL*15
  6219         16  HOLD-CENTURY-1-X.                                       CL*15
  6220             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6221             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6222                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6223                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6224             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6225             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6226         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6227             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6228             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6229             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6230                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6231                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6232             20  FILLER                PIC XXX.                      CL*23
  6233         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6234         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6235         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6236         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6237             20  DC-JULIAN-1-CCYY.                                   CL*15
  6238                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6239                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6240             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6241         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6242         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6243             20  DC-JULIAN-2-CCYY.                                   CL*15
  6244                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6245                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6246             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6247         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6248             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6249             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6250             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6251             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6252             20  DC-EDITA-CCYY.                                      CL*15
  6253                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6254                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6255         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6256             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6257             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6258             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6259             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6260             20  DC-EDITB-CCYY.                                      CL*15
  6261                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6262                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6263         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6264         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6265                              DC-GREG-DATE-CYMD.                  ELCDATE
  6266             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6267             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6268             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6269             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6270         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6271         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6272                              DC-GREG-DATE-MDCY.                  ELCDATE
  6273             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6274             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6275             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6276             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6277    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6278        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6279    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6280    12  FILLER                         PIC X(28).                    CL*26
* 6281                             COPY ELCFUNDT.
  6282***************************************************************** 12/03/98
  6283*                                                               * ELCFUNDT
  6284*                            ELCFUNDT.                          *    LV004
  6285*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6286*                            VMOD=2.001                         * ELCFUNDT
  6287*                                                               * ELCFUNDT
  6288*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6289*                                                               * ELCFUNDT
  6290***************************************************************** ELCFUNDT
  6291                                                                  ELCFUNDT
  6292                                                                  ELCFUNDT
  6293 01  FUNCTION-DATE.                                                  CL**2
  6294     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6295     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6296         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6297         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6298             15  WS-FN-CC          PIC 99.                           CL**3
  6299             15  WS-FN-YR          PIC 99.                           CL**3
  6300         10  WS-FN-MO              PIC 99.                           CL**3
  6301         10  WS-FN-DA              PIC 99.                           CL**3
  6302     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6303     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6304     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6305     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6306     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6307         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6308         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6309         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6310     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6311     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 123
* ECS010.cbl
  6312
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 124
* ECS010.cbl
  6314 01  CPA-STARTS-HERE             PIC X(48)
  6315       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6316                             COPY ELCCALC.
  6317******************************************************************04/15/98
  6318*                                                                *ELCCALC
  6319*                           ELCCALC.                            *    LV003
  6320*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6321*                            VMOD=2.025                          *   CL**3
  6322*                                                                *   CL**2
  6323*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6324*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6325*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6326*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6327*                                                                *   CL**2
  6328*  PASSED TO ELRTRM                                              *   CL**2
  6329*  -----------------                                             *   CL**2
  6330*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6331*  ORIGINAL TERM                                                 *   CL**2
  6332*  BEGINNING DATE                                                *   CL**2
  6333*  ENDING DATE                                                   *   CL**2
  6334*  COMPANY I.D.                                                  *   CL**2
  6335*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6336*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6337*  FREE LOOK DAYS                                                *   CL**2
  6338*                                                                *   CL**2
  6339*  RETURNED FROM ELRTRM                                          *   CL**2
  6340*  ---------------------                                         *   CL**2
  6341*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6342*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6343*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6344*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6345*----------------------------------------------------------------*   CL**2
  6346*  PASSED TO ELRAMT                                              *   CL**2
  6347*  ----------------                                              *   CL**2
  6348*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6349*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6350*  ORIGINAL AMOUNT                                               *   CL**2
  6351*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6352*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6353*  METHOD                                                            CL**2
  6354*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6355*  COMPANY I.D.                                                  *   CL**2
  6356*  BENEFIT TYPE                                                  *   CL**2
  6357*                                                                *   CL**2
  6358*  RETURNED FROM ELRAMT                                          *   CL**2
  6359*  --------------------                                          *   CL**2
  6360*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6361*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6362*  REMAINING AMOUNT FACTOR                                           CL**2
  6363*----------------------------------------------------------------*   CL**2
  6364*  PASSED TO ELRESV                                              *   CL**2
  6365*  -----------------                                             *   CL**2
  6366*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6367*  VALUATION DATE                                                *   CL**2
  6368*  PAID THRU DATE                                                *   CL**2
  6369*  BENEFIT                                                       *   CL**2
  6370*  INCURRED DATE                                                 *   CL**2
  6371*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 125
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6372*  ISSUE AGE                                                     *   CL**2
  6373*  TERM                                                          *   CL**2
  6374*  CDT PERCENT                                                   *   CL**2
  6375*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6376* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6377* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6378* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6379*                                                                *   CL**2
  6380*  RETURNED FROM ELRESV                                          *   CL**2
  6381*  --------------------                                          *   CL**2
  6382*  CDT TABLE USED                                                *   CL**2
  6383*  CDT FACTOR USED                                               *   CL**2
  6384*  PAY TO CURRENT RESERVE                                        *   CL**2
  6385*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6386*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6387*----------------------------------------------------------------*   CL**2
  6388*  PASSED TO ELRATE                                              *   CL**2
  6389*  ----------------                                              *   CL**2
  6390*  CERT ISSUE DATE                                               *   CL**2
  6391*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6392*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6393*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6394*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6395*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6396*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6397*  DEVIATION CODE                                                *   CL**2
  6398*  ISSUE AGE                                                     *   CL**2
  6399*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6400*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6401*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6402*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6403*  A.P.R.                                                        *   CL**2
  6404*  METHOD                                                            CL**2
  6405*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6406*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6407*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6408*  BENEFIT CODE                                                  *   CL**2
  6409*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6410*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6411*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6412*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6413*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6414*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6415*                                                                *   CL**2
  6416*  RETURNED FROM ELRATE                                          *   CL**2
  6417*  --------------------                                          *   CL**2
  6418*  CALCULATED PREMIUM                                            *   CL**2
  6419*  PREMIUM RATE                                                  *   CL**2
  6420*  MORTALITY CODE                                                *   CL**2
  6421*  MAX ATTAINED AGE                                              *   CL**2
  6422*  MAX AGE                                                       *   CL**2
  6423*  MAX TERM                                                      *   CL**2
  6424*  MAX MONTHLY BENEFIT                                           *   CL**2
  6425*  MAX TOTAL BENIFIT                                             *   CL**2
  6426*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6427*----------------------------------------------------------------*   CL**2
  6428*  PASSED TO ELRFND                                              *   CL**2
  6429*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6430*  CERT ISSUE DATE                                               *   CL**2
  6431*  REFUND DATE                                                   *   CL**2
  6432*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6433*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6434*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6435*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6436*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6437*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6438*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6439*  DEVIATION CODE                                                *   CL**2
  6440*  ISSUE AGE                                                     *   CL**2
  6441*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6442*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6443*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6444*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6445*  A.P.R.                                                        *   CL**2
  6446*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6447*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6448*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6449*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6450*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6451*  BENEFIT CODE                                                  *   CL**2
  6452*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6453*                                                                *   CL**2
  6454*  RETURNED FROM ELRFND                                          *   CL**2
  6455*  --------------------                                          *   CL**2
  6456*  CALCULATED REFUND                                             *   CL**2
  6457*----------------------------------------------------------------*   CL**2
  6458*  PASSED TO ELEARN                                              *   CL**2
  6459*  ----------------                                              *   CL**2
  6460*  CERT ISSUE DATE                                               *   CL**2
  6461*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6462*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6463*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6464*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6465*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6466*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6467*  DEVIATION CODE                                                *   CL**2
  6468*  ISSUE AGE                                                     *   CL**2
  6469*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6470*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6471*  A.P.R.                                                        *   CL**2
  6472*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6473*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6474*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6475*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6476*  BENEFIT CODE                                                  *   CL**2
  6477*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6478*                                                                *   CL**2
  6479*  RETURNED FROM ELEARN                                          *   CL**2
  6480*  --------------------                                          *   CL**2
  6481*  INDICATED  EARNINGS                                           *   CL**2
  6482*----------------------------------------------------------------*   CL**2
  6483*                 LENGTH = 450                                   *   CL**2
  6484*                                                                *   CL**2
  6485******************************************************************   CL**2
  6486******************************************************************
  6487*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6488*
  6489* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6490*-----------------------------------------------------------------
  6491*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6492* EFFECTIVE    NUMBER
  6493*-----------------------------------------------------------------
  6494* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6495* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6496* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6497* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6498* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6499* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6500* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6501* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6502* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6503******************************************************************
  6504                                                                     CL**2
  6505 01  CALCULATION-PASS-AREA.                                          CL**2
  6506     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6507                                     COMP.                           CL**2
  6508                                                                     CL**2
  6509     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6510       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6511       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6512                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6513       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6514       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6515       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6516       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6517       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6518       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6519       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6520       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6521       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6522       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6523       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6524       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6525       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6526       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6527       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6528       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6529       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6530                                                                     CL**2
  6531     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6532       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6533***********************  INPUT AREAS ****************************    CL**2
  6534                                                                     CL**2
  6535     12  CP-CALCULATION-AREA.                                        CL**2
  6536         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6537         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6538         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6539         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6540         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6541           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6542                                                   'I' 'U'.          CL**2
  6543           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6544           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6545         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6546         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6547         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6548         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6549         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6550                                     COMP-3.                         CL**2
  6551         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6552                                     COMP-3.                         CL**2
  6553         16  CP-CDT-METHOD         PIC X.                            CL**2
  6554           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6555           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6556           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6557         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6558           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6559           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6560         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6561                                     COMP-3.                         CL**2
  6562         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6563                                     COMP-3.                         CL**2
  6564         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6565                                     COMP-3.                         CL**2
  6566         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6567                                     COMP-3.                         CL**2
  6568         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6569                                     COMP-3.                         CL**2
  6570         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6571                                     COMP-3.                         CL**2
  6572         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6573                                     COMP-3.                         CL**2
  6574         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6575           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6576           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6577           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6578           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6579           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6580           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6581           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6582         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6583           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6584           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6585           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6586           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6587           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6588           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6589           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6590           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6591           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6592           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6593           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6594           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6595           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6596           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6597         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6598           88  CP-CLAIM                            VALUE '1'.        CL**2
  6599           88  CP-CANCEL                           VALUE '2'.        CL**2
  6600           88  CP-ISSUE                            VALUE '3'.        CL**2
  6601         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6602           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6603           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6604           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6605           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6606           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6607           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6608           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6609           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6610           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6611           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6612           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6613           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6614           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6615           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6616           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6617           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6618           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6619           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6620                                                     'W' 'X'.        CL**2
  6621           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6622           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6623           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6624           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6625           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6626           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6627           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6628           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6629           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6630           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6631           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6632           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6633           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6634                                                                     CL**2
  6635         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6636                                     COMP-3.                         CL**2
  6637         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6638         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6639         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6640         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6641         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6642           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6643               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6644         16  CP-R78-OPTION         PIC X.                            CL**2
  6645           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6646           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6647                                                                     CL**2
  6648         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6649         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6650         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6651         16  CP-RATE-FILE          PIC X.                            CL**2
  6652         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6653                                     COMP-3.                         CL**2
  6654                                                                     CL**2
  6655         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6656         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6657                                                                     CL**2
  6658         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6659                                     COMP-3.
  6660         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6661                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6662         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6663                                     COMP-3.                         CL**2
  6664         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6665                                     COMP-3.                         CL**2
  6666         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6667                                     COMP-3.
  6668         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6669                                  PIC S9(7)V99 COMP-3.
  6670                                                                     CL**2
  6671         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6672         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6673         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6674           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6675           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6676           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6677           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6678         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6679         16  CP-CARRIER            PIC X.                            CL**2
  6680         16  CP-REIN-FLAG          PIC X.                            CL**2
  6681         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6682           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6683                      '2' '3' '4' '5'.                               CL**2
  6684           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6685           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6686           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6687           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6688           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6689           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6690           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6691           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6692         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6693         16  CP-RATING-METHOD      PIC X.                            CL**2
  6694           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6695           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6696           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6697           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6698           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6699           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6700           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6701           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6702           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6703         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6704                                     COMP-3.                         CL**2
  6705         16  CP-BEN-CATEGORY       PIC X.
  6706         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6707         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6708                                   PIC S99V9(5) COMP-3.
  6709         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6710         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6711                                   PIC S99V9(5) COMP-3.
  6712         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6713         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6714         16  CP-EXPIRE-DT          PIC XX.
  6715         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6716         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6717         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6718         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6719         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6720             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6721             88  CP-CALC-CLP              VALUE 'C'.
  6722         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6723         16  CP-CANCEL-REASON      PIC X.
  6724         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6725         16  CP-PMT-MODE           PIC X.
  6726         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6727         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6728         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6729         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6730         16  FILLER                PIC X.
  6731                                                                     CL**2
  6732***************    OUTPUT FROM ELRESV   ************************     CL**2
  6733                                                                     CL**2
  6734         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6735                                                                     CL**2
  6736         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6737                                     COMP-3.                         CL**2
  6738         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6739                                     COMP-3.                         CL**2
  6740         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6741                                     COMP-3.                         CL**2
  6742         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6743                                     COMP-3.                         CL**2
  6744         16  FILLER                PIC X(09).                        CL**2
  6745***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6746                                                                     CL**2
  6747         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6748                                     COMP-3.                         CL**2
  6749         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6750                                     COMP-3.                         CL**2
  6751         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6752                                     COMP-3.                         CL**2
  6753         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6754                                     COMP-3.                         CL**2
  6755         16  FILLER                PIC X(12).                        CL**2
  6756                                                                     CL**2
  6757***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6758                                                                     CL**2
  6759         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6760                                     COMP-3.                         CL**2
  6761         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6762                                     COMP-3.                         CL**2
  6763         16  FILLER                PIC X(12).                        CL**2
  6764                                                                     CL**2
  6765***************    OUTPUT FROM ELRATE   *************************    CL**2
  6766                                                                     CL**2
  6767         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6768                                     COMP-3.                         CL**2
  6769         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6770                                     COMP-3.                         CL**2
  6771         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6772         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6773             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6774         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6775                                     COMP-3.                         CL**2
  6776         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6777         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6778         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6779                                   PIC S9(7)V99 COMP-3.
  6780         16  FILLER                PIC X(07).                        CL**2
  6781                                                                     CL**2
  6782***************    OUTPUT FROM ELRFND   *************************    CL**2
  6783                                                                     CL**2
  6784         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6785                                     COMP-3.                         CL**2
  6786         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6787           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6788           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6789           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6790           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6791           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6792           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6793           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6794           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6795           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6796           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6797           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6798           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6799           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6800           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6801         16  FILLER                PIC X(12).                        CL**2
  6802                                                                     CL**2
  6803***************    OUTPUT FROM ELEARN   *************************    CL**2
  6804                                                                     CL**2
  6805         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6806                                     COMP-3.                         CL**2
  6807         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6808                                     COMP-3.                         CL**2
  6809         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6810                                     COMP-3.                         CL**2
  6811         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6812                                     COMP-3.                         CL**2
  6813         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6814                                     COMP-3.                         CL**2
  6815         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6816                                     COMP-3.                         CL**2
  6817         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6818           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6819           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6820           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6821           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6822           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6823           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6824           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6825           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6826           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6827         16  FILLER                PIC X(12).                        CL**2
  6828                                                                     CL**2
  6829***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6830                                                                     CL**2
  6831         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6832                                     COMP-3.                         CL**2
  6833         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6834                                     COMP-3.                         CL**2
  6835         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6836                                                                     CL**2
  6837***************   MISC WORK AREAS    *****************************   CL**2
  6838         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6839                                     COMP-3.                         CL**2
  6840         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6841                                     COMP-3.                         CL**2
  6842         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6843                                     COMP-3.                         CL**2
  6844         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6845                                     COMP-3.                         CL**2
  6846         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6847                                     COMP-3.                         CL**2
  6848         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6849                                     COMP-3.                         CL**2
  6850         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6851             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6852             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6853             88  IO-ERROR                         VALUE 'E'.         CL**2
  6854                                                                     CL**2
  6855         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6856                                                                     CL**2
  6857         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6858                                                                     CL**2
  6859         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6860                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6861                                     COMP-3.                         CL**2
  6862                                                                     CL**2
  6863         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6864                                                                     CL**2
  6865         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6866                                     COMP-3.                         CL**2
  6867                                                                     CL**2
  6868         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6869                                     COMP-3.                         CL**2
  6870                                                                     CL**2
  6871         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6872                                     COMP-3.                         CL**2
  6873                                                                     CL**2
  6874         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6875                                     COMP-3.                         CL**2
  6876                                                                     CL**2
  6877         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6878                                     COMP-3.                         CL**2
  6879                                                                     CL**2
  6880         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6881                                     COMP-3.                         CL**2
  6882                                                                     CL**2
  6883         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6884                                     COMP-3.                         CL**2
  6885                                                                     CL**2
  6886         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6887             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6888                                                                     CL**2
  6889         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6890                                     COMP-3.                         CL**2
  6891         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6892                                     COMP-3.
  6893         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 134
* ECS010.cbl
  6894         16  FILLER                PIC X(15).                        CL**2
  6895******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 135
* ECS010.cbl
* 6897                             COPY ELCDTECX.
  6898******************************************************************06/05/98
  6899*                                                                *ELCDTECX
  6900*                            ELCDTECX.                           *   LV005
  6901*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6902*                            VMOD=2.015                          *ELCDTECX
  6903*                                                                *ELCDTECX
  6904*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6905*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6906*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6907*                                                                *ELCDTECX
  6908******************************************************************ELCDTECX
  6909******************************************************************
  6910*                   C H A N G E   L O G
  6911*
  6912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6913*-----------------------------------------------------------------
  6914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6915* EFFECTIVE    NUMBER
  6916*-----------------------------------------------------------------
  6917* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6918*                                  BENEFIT CODES FROM 300 TO 900
  6919* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6920* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6921******************************************************************
  6922 01  DATE-CARD.                                                   ELCDTECX
  6923     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6924     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6925     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6926     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6927     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6928     12  EP-SW                       PIC  X.                      ELCDTECX
  6929         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6930     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6931         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6932     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6933     12  RUN-CENTURY.                                             ELCDTECX
  6934         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6935     12  FILLER                      PIC  X.                         CL**4
  6936     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6937     12  FILLER                      PIC  XXX.                    ELCDTECX
  6938     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6939                                                                  ELCDTECX
  6940 01  FILLER                          PIC  X(7)                       CL**6
  6941                                          VALUE 'OPTIONS'.        ELCDTECX
  6942 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6943     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6944     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6945     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6946         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6947         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6948     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6949     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6950     12  FILLER                      PIC  X.                      ELCDTECX
  6951     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6952     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6953     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  6954     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 136
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6955     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6956     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6957     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6958     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6959     12  FILLER                      PIC  X.                      ELCDTECX
  6960     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6961     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6962     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6963     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6964     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6965     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6966     12  FILLER                      PIC  X.                      ELCDTECX
  6967     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6968     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6969     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6970     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6971     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6972     12  DTE-R78                     PIC  X.                      ELCDTECX
  6973     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6974     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6975     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6976     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6977     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6978     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6979     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6980                                     PIC  X.                      ELCDTECX
  6981         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6982                                                 ' '.             ELCDTECX
  6983         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6984         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6985     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6986         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6987         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6988     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6989     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6990                                     PIC  9.                         CL**4
  6991     12  DTE-SYSTEM.                                              ELCDTECX
  6992         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6993         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6994         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6995         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6996         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6997         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6998         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6999         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  7000         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  7001         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  7002         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  7003         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  7004         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  7005         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  7006         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  7007         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  7008         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  7009         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  7010         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  7011         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  7012         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 137
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7013         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  7014         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  7015         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  7016         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  7017         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  7018     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  7019         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  7020                                     PIC  X.                      ELCDTECX
  7021     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  7022                                                                  ELCDTECX
  7023 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7024     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7025     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7026     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7027*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7028     12  FILLER                      PIC  X.                      ELCDTECX
  7029     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7030     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7031     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7032     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7033     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7034     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7035     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7036                                                                  ELCDTECX
  7037     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7038     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7039     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7040     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7041                                                                  ELCDTECX
  7042     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7043     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7044     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7045     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7046                                                                  ELCDTECX
  7047     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7048     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7049                                                                  ELCDTECX
  7050     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7051     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7052                                                                  ELCDTECX
  7053     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7054                                                                  ELCDTECX
  7055 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7056     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7057     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7058     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7059     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7060     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7061     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7062     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7063                                                                  ELCDTECX
  7064 01  FILLER                          PIC  X(12)                   ELCDTECX
  7065                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7066 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7067     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7068         16  CNT-ID                  PIC  X.                      ELCDTECX
  7069         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  7070                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7071 01  FILLER                          PIC  X(11)                   ELCDTECX
  7072                                          VALUE 'STATE NAMES'.    ELCDTECX
  7073 01  STATE-NAMES.                                                 ELCDTECX
  7074     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7075         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7076         16  STATE-PIC1.                                          ELCDTECX
  7077             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7078             20  FILLER              PIC  XXX.                    ELCDTECX
  7079             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7080             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7081             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7082             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7083                                                                  ELCDTECX
  7084 01  FILLER                          PIC  X(13)                   ELCDTECX
  7085                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7086 01  CARRIER-NAMES.                                               ELCDTECX
  7087     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7088         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7089         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7090         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7091         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7092         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7093         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7094*        16  FILLER                  PIC  X.                      ELCDTECX
  7095         16  CARRIER-SEC-PAY         PIC  X.
  7096             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7097                                                                  ELCDTECX
  7098 01  FILLER                          PIC  X(9)                       CL**6
  7099                                          VALUE 'INS TYPES'.      ELCDTECX
  7100 01  CLAS-INS-TYPES.                                              ELCDTECX
  7101*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7102     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7103         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7104         16  CLAS-I-AB3.                                          ELCDTECX
  7105             20  FILLER              PIC  X.                      ELCDTECX
  7106             20  CLAS-I-AB2.                                      ELCDTECX
  7107                 24  FILLER          PIC  X.                      ELCDTECX
  7108                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7109         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7110             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7111             20  FILLER              PIC  X.                         CL**4
  7112         16  CLAS-I-AB10.                                         ELCDTECX
  7113             20  FILLER              PIC  X(9).                   ELCDTECX
  7114             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7115         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7116         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7117         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7118         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7119             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7120         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7121         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7122         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7123         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7124         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  7125         16  FILLER                  PIC  X(05).
  7126                                                                  ELCDTECX
  7127 01  FILLER                          PIC  X(16)                   ELCDTECX
  7128                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7129 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7130     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7131                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7132         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7133         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7134         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7135         16  CLAS-MORT-DESC.                                      ELCDTECX
  7136             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7137             20  FILLER              PIC  XX.                        CL**5
  7138             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7139             20  FILLER              PIC  X.                         CL**5
  7140             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7141             20  FILLER              PIC  X.                         CL**5
  7142             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7143             20  FILLER              PIC  X.                         CL**5
  7144             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7145             20  FILLER              PIC  X(5).                      CL**6
  7146                                                                  ELCDTECX
  7147 01  FILLER                          PIC  X(15)                   ELCDTECX
  7148                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7149 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7150     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7151         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7152         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7153         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7154         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7155         16  FILLER                  PIC  X(4).                      CL**6
  7156                                                                  ELCDTECX
  7157 01  FILLER                          PIC  X(7)                       CL**6
  7158                                     VALUE 'INDEXES'.             ELCDTECX
  7159 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7160     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7161     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7162     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7163     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7164     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7165     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7166     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7167     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7168     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7169     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7170     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7171     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7172     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7173     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7174     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7175     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7176     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7177                                                                  ELCDTECX
  7178 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7179     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7180     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7181     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7182     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7183     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7184     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  7185     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7186     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7187     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7188     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7189     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7190                                                                  ELCDTECX
  7191 01  FILLER                          PIC  X(13)                   ELCDTECX
  7192                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7193 01  CLAS-MISC.                                                   ELCDTECX
  7194     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7195         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7196         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7197         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7198     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7199     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7200     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7201     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7202     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7203     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7204     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7205     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7206     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7207     12  STATE-L                     PIC  XX.                     ELCDTECX
  7208     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7209     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7210     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7211         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7212         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7213     12  DTE-ABEND-WORK.                                          ELCDTECX
  7214         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7215         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7216                                                                  ELCDTECX
  7217 01  FILLER                          PIC  X(12)                   ELCDTECX
  7218                                     VALUE 'WORKING DATE'.        ELCDTECX
  7219 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7220     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7221         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7222         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7223         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7224     12  WS-CURRENT-DATE.                                         ELCDTECX
  7225         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7226         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7227         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7228         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7229         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7230     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7231         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7232         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7233                                                                  ELCDTECX
  7234 01  FILLER                          PIC  X(12)                   ELCDTECX
  7235                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7236 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7237     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7238         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7239         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7240         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7241                                                                  ELCDTECX
  7242 01  FILLER                          PIC  X(10)                   ELCDTECX
  7243                                     VALUE 'STATE TLRS'.          ELCDTECX
  7244 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7245     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7246         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7247         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7248                                                                  ELCDTECX
  7249 01  FILLER                          PIC  X(13)                   ELCDTECX
  7250                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7251 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7252     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7253         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7254                                                                  ELCDTECX
  7255 01  FILLER                          PIC  X(13)                   ELCDTECX
  7256                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7257 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7258     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7259     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7260     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7261                                     PIC  X.                         CL**5
  7262     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7263     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7264     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7265     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7266     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7267     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7268     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7269     12  FILLER                      PIC  X(75).                  ELCDTECX
  7270******************************************************************ELCDTECX
  7271*01  MISC-CARR-PCT-DATA.                                          00001521
  7272*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7273*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7274*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7275*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7276*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7277*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7278******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 142
* ECS010.cbl
* 7280                             COPY ELCDTEVR.
  7281***************************************************************** 04/15/98
  7282*                                                                *ELCDTEVR
  7283*                                                                *ELCDTEVR
  7284*                            ELCDTEVR.                           *   LV003
  7285*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7286*                            VMOD=2.001                          *   CL**2
  7287*                                                                *ELCDTEVR
  7288*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7289*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7290*                                                                *ELCDTEVR
  7291******************************************************************ELCDTEVR
  7292 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7293     05  WS-RUN-DATE.                                             ELCDTEVR
  7294         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7295         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7296         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7297             15  RUN-CC              PIC  99.                     ELCDTEVR
  7298             15  RUN-YR              PIC  99.                     ELCDTEVR
  7299         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7300         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7301     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7302            WS-RUN-DATE              PIC 9(11).                      CL**2
  7303     05  WS-EP-DT.                                                ELCDTEVR
  7304         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7305         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7306         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7307             15  EP-CC               PIC  99.                     ELCDTEVR
  7308             15  EP-YR               PIC  99.                     ELCDTEVR
  7309         10  EP-MO                   PIC  99.                     ELCDTEVR
  7310         10  EP-DA                   PIC  99.                     ELCDTEVR
  7311     05  WS-EP-DT-N REDEFINES                                        CL**2
  7312            WS-EP-DT                 PIC 9(11).                      CL**2
  7313     05  WS-DTE-CONV-DT.                                             CL**4
  7314         10  FILLER                  PIC  9(03).                     CL**4
  7315         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7316         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7317             15  DTE-CONV-CC         PIC  99.                        CL**4
  7318             15  DTE-CONV-YR         PIC  99.                        CL**4
  7319         10  DTE-CONV-MO             PIC  99.                        CL**4
  7320         10  DTE-CONV-DA             PIC  99.                        CL**4
  7321     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7322            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7323 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7324     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7325         10  FILLER                            PIC 999.           ELCDTEVR
  7326         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7327         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7328             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7329             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7330         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7331         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7332     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7333            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7334     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7335         10  FILLER                            PIC 999.           ELCDTEVR
  7336         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7337         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 143
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7338         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7339         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7340     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7341            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7342 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7343     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7344         10  FILLER                            PIC 999.           ELCDTEVR
  7345         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7346         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7347             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7348             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7349         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7350         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7351     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7352            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7353     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7354         10  FILLER                            PIC 999.           ELCDTEVR
  7355         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7356         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7357             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7358             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7359         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7360         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7361     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7362            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7363     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7364         10  FILLER                            PIC 999.           ELCDTEVR
  7365         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7366         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7367             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7368             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7369         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7370         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7371     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7372            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7373 01  WS-RATE-RECORD.                                              ELCDTEVR
  7374         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7375             10  FILLER                        PIC 999.           ELCDTEVR
  7376             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7377             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7378                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7379                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7380             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7381             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7382         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7383                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 144
* ECS010.cbl
* 7385                             COPY ELCACCTV.
  7386******************************************************************04/14/98
  7387*                                                                *ELCACCTV
  7388*                            ELCACCTV                            *   LV002
  7389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7390*                            VMOD=2.001                          *ELCACCTV
  7391*                                                                *ELCACCTV
  7392*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7393*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7394*                                                                *ELCACCTV
  7395*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7396*                                                                *ELCACCTV
  7397******************************************************************ELCACCTV
  7398                                                                  ELCACCTV
  7399 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7400                                                                  ELCACCTV
  7401     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7402         10  FILLER            PIC 999.                           ELCACCTV
  7403         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7404         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7405             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7406             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7407         10  AM-EXP-MO         PIC 99.                               CL**5
  7408         10  AM-EXP-DA         PIC 99.                               CL**5
  7409     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7410            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7411     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7412         10  FILLER                    PIC 999.                   ELCACCTV
  7413         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7414         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7415             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7416             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7417         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7418         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7419     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7420            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7421     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7422         10  FILLER                    PIC 999.                   ELCACCTV
  7423         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7424         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7425             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7426             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7427         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7428         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7429     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7430            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7431     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7432         10 FILLER                     PIC 999.                   ELCACCTV
  7433         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7434         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7435            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7436            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7437         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7438         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7439     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7440            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7441     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7442         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 145
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7443         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7444         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7445            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7446            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7447         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7448         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7449     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7450            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7451     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7452         10  FILLER                    PIC 999.                   ELCACCTV
  7453         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7454         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7455             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7456             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7457         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7458         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7459     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7460            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7461     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7462         10  FILLER                    PIC 999.                   ELCACCTV
  7463         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7464         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7465             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7466             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7467         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7468         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7469     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7470            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7471     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7472         10  FILLER                    PIC 999.                   ELCACCTV
  7473         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7474         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7475             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7476             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7477         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7478         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7479     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7480            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7481     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7482         10  FILLER                    PIC 999.                   ELCACCTV
  7483         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7484         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7485             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7486             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7487         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7488         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7489     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7490            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 146
* ECS010.cbl
* 7492                             COPY ELCEXTVR.
  7493******************************************************************04/15/98
  7494*                                                                *ELCEXTVR
  7495*                                                                *ELCEXTVR
  7496*                             ELCEXTVR                           *   LV002
  7497*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7498*                            VMOD=2.001                          *ELCEXTVR
  7499*                                                                *ELCEXTVR
  7500*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7501*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7502*                                                                *ELCEXTVR
  7503******************************************************************ELCEXTVR
  7504 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7505     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7506         10  FILLER              PIC 999.                         ELCEXTVR
  7507         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7508         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7509             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7510             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7511         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7512         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7513     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7514            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7515 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7516     05  WS-DE-EFF.                                               ELCEXTVR
  7517         10  FILLER              PIC 999.                         ELCEXTVR
  7518         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7519         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7520             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7521             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7522         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7523         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7524     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7525            WS-DE-EFF            PIC 9(11).                          CL**2
  7526     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7527         10  FILLER              PIC 999.                         ELCEXTVR
  7528         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7529         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7530             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7531             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7532         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7533         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7534     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7535            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7536     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7537         10  FILLER                 PIC 999.                      ELCEXTVR
  7538         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7539         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7540             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7541             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7542         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7543         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7544     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7545            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7546     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7547         10  FILLER                 PIC 999.                      ELCEXTVR
  7548         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7549         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 147
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7550             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7551             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7552         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7553         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7554     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7555            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7556     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7557         10  FILLER                 PIC 999.                      ELCEXTVR
  7558         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7559         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7560             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7561             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7562         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7563         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7564     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7565            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7566     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7567         10  FILLER                 PIC 999.                      ELCEXTVR
  7568         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7569         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7570             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7571             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7572         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7573         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7574     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7575            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7576     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7577         10  FILLER                 PIC 999.                      ELCEXTVR
  7578         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7579         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7580             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7581             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7582         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7583         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7584     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7585            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7586     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7587         10  FILLER                 PIC 999.                         CL**5
  7588         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7589         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7590             15  DE-CP-CC           PIC 99.                          CL**5
  7591             15  DE-CP-YR           PIC 99.                          CL**5
  7592         10  DE-CP-MO               PIC 99.                          CL**5
  7593         10  DE-CP-DA               PIC 99.                          CL**5
  7594     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7595            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7596     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7597         10  FILLER                 PIC 999.                         CL**5
  7598         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7599         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7600             15  DE-RP-CC           PIC 99.                          CL**5
  7601             15  DE-RP-YR           PIC 99.                          CL**5
  7602         10  DE-RP-MO                      PIC 99.                   CL**5
  7603         10  DE-RP-DA                      PIC 99.                   CL**5
  7604     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7605            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7606     05  WS-DE-INCUR.                                             ELCEXTVR
  7607         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7608         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7609         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7610             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7611             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7612         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7613         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7614     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7615            WS-DE-INCUR             PIC 9(11).                       CL**2
  7616     05  WS-DE-PAY.                                               ELCEXTVR
  7617         10  FILLER                 PIC 999.                      ELCEXTVR
  7618         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7619         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7620             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7621             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7622         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7623         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7624     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7625            WS-DE-PAY               PIC 9(11).                       CL**2
  7626     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7627         10  FILLER                 PIC 999.                      ELCEXTVR
  7628         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7629         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7630             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7631             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7632         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7633         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7634     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7635            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7636     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7637         10 FILLER                  PIC 999.                      ELCEXTVR
  7638         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7639         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7640            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7641            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7642         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7643         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7644     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7645            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7646     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7647         10 FILLER                  PIC 999.                      ELCEXTVR
  7648         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7649         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7650            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7651            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7652         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7653         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7654     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7655            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7656     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7657         10  FILLER                 PIC 999.                      ELCEXTVR
  7658         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7659         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7660             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7661             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7662         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7663         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7664     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7665            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7666     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7667         10  FILLER                 PIC 999.                      ELCEXTVR
  7668         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7669         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7670             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7671             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7672         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7673         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7674     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7675            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7676     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7677         10  FILLER                        PIC 999.               ELCEXTVR
  7678         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7679         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7680                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7681             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7682             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7683         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7684         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7685     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7686            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7687     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7688         10  FILLER                        PIC 999.               ELCEXTVR
  7689         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7690         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7691                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7692             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7693             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7694         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7695         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7696     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7697            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7698                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 150
* ECS010.cbl
  7700 PROCEDURE DIVISION.
  7701
  7702 0000-START.
  7703
  7704******************************************************************
  7705***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7706******************************************************************
  7707
  7708*0003-LOAD-DATE-CARD.
* 7709                             COPY ELCDTERX.
  7710******************************************************************04/15/98
  7711*                                                                *ELCDTERX
  7712*                                                                *ELCDTERX
  7713*                            ELCDTERX.                           *   LV002
  7714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7715*                            VMOD=2.007                          *ELCDTERX
  7716*                                                                *ELCDTERX
  7717*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7718*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7719*      = ELCDTEFD)                                               *ELCDTERX
  7720*                                                                *ELCDTERX
  7721******************************************************************ELCDTERX
  7722                                                                  ELCDTERX
  7723     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7724                                                                  ELCDTERX
  7725     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7726     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7727     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7728                                                                  ELCDTERX
  7729     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7730                                                                  ELCDTERX
  7731******************************************************************ELCDTERX
  7732*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7733*          WARNING MESSAGES.                                      ELCDTERX
  7734******************************************************************ELCDTERX
  7735     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7736         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7737                                                                  ELCDTERX
  7738     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7739                                                                  ELCDTERX
  7740     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7741                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7742                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7743                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7744                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7745                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7746                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7747                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7748                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7749                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7750                                                                  ELCDTERX
  7751     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7752                                                                  ELCDTERX
  7753     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7754                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7755                                                                  ELCDTERX
  7756     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7757     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 151
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7758     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7759     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7760                                                                  ELCDTERX
  7761     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7762         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7763     ELSE                                                         ELCDTERX
  7764         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7765                                                                  ELCDTERX
  7766     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7767         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7768     ELSE                                                         ELCDTERX
  7769         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7770                                                                  ELCDTERX
  7771 0005-READ--CARD.                                                 ELCDTERX
  7772     READ DISK-DATE                                               ELCDTERX
  7773         AT END CLOSE DISK-DATE                                   ELCDTERX
  7774             GO TO 0060-READ--TEST.                               ELCDTERX
  7775                                                                  ELCDTERX
  7776     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7777                                                                  ELCDTERX
  7778     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7779         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7780         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7781         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7782         GO TO 0005-READ--CARD.                                   ELCDTERX
  7783                                                                  ELCDTERX
  7784     IF DD-ID = 'CLAD'                                            ELCDTERX
  7785         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7786         GO TO 0005-READ--CARD.                                   ELCDTERX
  7787                                                                  ELCDTERX
  7788     IF DD-ID = 'CLAX'                                            ELCDTERX
  7789         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7790         GO TO 0005-READ--CARD.                                   ELCDTERX
  7791                                                                  ELCDTERX
  7792     IF DD-ID = 'CLAF'                                            ELCDTERX
  7793         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7794         GO TO 0005-READ--CARD.                                   ELCDTERX
  7795                                                                  ELCDTERX
  7796     IF DD-ID = 'CLAC'                                            ELCDTERX
  7797         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7798                                                                  ELCDTERX
  7799     IF DD-ID = 'CARR'                                            ELCDTERX
  7800         GO TO 0015-READ--CARR.                                   ELCDTERX
  7801                                                                  ELCDTERX
  7802     IF DD-ID = 'STAT'                                            ELCDTERX
  7803         GO TO 0020-READ--STAT.                                   ELCDTERX
  7804                                                                  ELCDTERX
  7805     IF DD-ID = 'BUSC'                                            ELCDTERX
  7806         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7807                                                                  ELCDTERX
  7808     IF DD-ID = 'MORT'                                            ELCDTERX
  7809         GO TO 0030-READ--MORT.                                   ELCDTERX
  7810                                                                  ELCDTERX
  7811     IF DD-ID = 'CLAI'                                            ELCDTERX
  7812         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7813                                                                  ELCDTERX
  7814     IF DD-ID = 'COLC'                                            ELCDTERX
  7815         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7816                                                                  ELCDTERX
  7817     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7818        DD-IDA = 'CL'                                             ELCDTERX
  7819         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7820                                                                  ELCDTERX
  7821     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7822        DD-IDA = 'PO'                                             ELCDTERX
  7823         GO TO 0050-READ--POXX.                                   ELCDTERX
  7824                                                                  ELCDTERX
  7825     IF DD-ID = 'OPCA'                                            ELCDTERX
  7826         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7827                                                                  ELCDTERX
  7828     IF DD-ID = 'OPST'                                            ELCDTERX
  7829         GO TO 0072-READ--OPST.                                   ELCDTERX
  7830                                                                  ELCDTERX
  7831     IF DD-ID = 'OPBS'                                            ELCDTERX
  7832         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7833                                                                  ELCDTERX
  7834     IF DD-ID = 'OPMS'                                            ELCDTERX
  7835         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7836                                                                  ELCDTERX
  7837     GO TO 0005-READ--CARD.                                       ELCDTERX
  7838                                                                  ELCDTERX
  7839 0010-READ--CLAC.                                                 ELCDTERX
  7840     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7841     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7842     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7843     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7844     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7845     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7846     GO TO 0005-READ--CARD.                                       ELCDTERX
  7847                                                                  ELCDTERX
  7848 0015-READ--CARR.                                                 ELCDTERX
  7849     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7850     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7851        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7852        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7853        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7854        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7855        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7856        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7857        MOVE DD-CARR1-SECPAY-SW
  7858                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7859     END-IF
  7860                                                                  ELCDTERX
  7861     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7862     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7863        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7864        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7865        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7866        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7867        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7868        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7869        MOVE DD-CARR2-SECPAY-SW
  7870                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7871     END-IF
  7872                                                                  ELCDTERX
  7873                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7874     GO TO 0005-READ--CARD.                                       ELCDTERX
  7875                                                                  ELCDTERX
  7876 0020-READ--STAT.                                                 ELCDTERX
  7877     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7878     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7879        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7880         GO TO 0005-READ--CARD.                                   ELCDTERX
  7881                                                                  ELCDTERX
  7882     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7883     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7884     GO TO 0020-READ--STAT.                                       ELCDTERX
  7885                                                                  ELCDTERX
  7886 0025-READ--BUSC.                                                 ELCDTERX
  7887     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7888     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7889        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7890         GO TO 0005-READ--CARD.                                   ELCDTERX
  7891                                                                  ELCDTERX
  7892     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7893     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7894     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7895                                                                  ELCDTERX
  7896 0030-READ--MORT.                                                 ELCDTERX
  7897     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7898     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7899        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7900         GO TO 0005-READ--CARD.                                   ELCDTERX
  7901                                                                  ELCDTERX
  7902     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7903     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7904     GO TO 0030-READ--MORT.                                       ELCDTERX
  7905                                                                  ELCDTERX
  7906 0035-READ--CLXX.                                                 ELCDTERX
  7907     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7908          GO TO 0005-READ--CARD.                                  ELCDTERX
  7909                                                                  ELCDTERX
  7910     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7911         DISPLAY '***********************************************'ELCDTERX
  7912         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7913         DISPLAY '***********************************************'ELCDTERX
  7914         GO TO 0055-READ--STOP.                                   ELCDTERX
  7915                                                                  ELCDTERX
  7916     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7917        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7918         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7919                                                                  ELCDTERX
  7920     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7921        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7922         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7923                                                                  ELCDTERX
  7924*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7925     GO TO 0005-READ--CARD.                                       ELCDTERX
  7926                                                                  ELCDTERX
  7927 0040-READ--CLAI.                                                 ELCDTERX
  7928     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7929     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7930        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7931         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7932                                                                  ELCDTERX
  7933     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7934     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7935     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7936                                                                  ELCDTERX
  7937 0045-READ--DUMP.                                                 ELCDTERX
  7938     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7939     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7940                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7941     PERFORM ABEND-PGM.                                           ELCDTERX
  7942                                                                  ELCDTERX
  7943 0050-READ--POXX.                                                 ELCDTERX
  7944     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7945         GO TO 0005-READ--CARD.                                   ELCDTERX
  7946                                                                  ELCDTERX
  7947     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7948         DISPLAY '***********************************************'ELCDTERX
  7949         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7950         DISPLAY '***********************************************'ELCDTERX
  7951         GO TO 0055-READ--STOP.                                   ELCDTERX
  7952                                                                  ELCDTERX
  7953     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7954     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7955     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7956     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7957                                                                  ELCDTERX
  7958     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7959         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7960     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7961         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7962                                                                  ELCDTERX
  7963     GO TO 0005-READ--CARD.                                       ELCDTERX
  7964                                                                  ELCDTERX
  7965 0055-READ--STOP.                                                 ELCDTERX
  7966     GOBACK.                                                      ELCDTERX
  7967                                                                  ELCDTERX
  7968 0060-READ--TEST.                                                 ELCDTERX
  7969     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7970        CLAX-ID         = SPACE  OR                               ELCDTERX
  7971        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7972         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7973                                                                  ELCDTERX
  7974     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7975     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7976                                                                  ELCDTERX
  7977 0065-READ--COLC.                                                 ELCDTERX
  7978     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7979     GO TO 0005-READ--CARD.                                       ELCDTERX
  7980                                                                  ELCDTERX
  7981 0070-READ--OPCA.                                                 ELCDTERX
  7982                                                                  ELCDTERX
  7983     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7984                                                                  ELCDTERX
  7985     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7986             OR                                                   ELCDTERX
  7987         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7988         GO TO 0005-READ--CARD.                                   ELCDTERX
  7989                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7990     ADD 1                       TO INDEXCA.                      ELCDTERX
  7991     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7992                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7993     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7994                                                                  ELCDTERX
  7995 0072-READ--OPST.                                                 ELCDTERX
  7996                                                                  ELCDTERX
  7997     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7998                                                                  ELCDTERX
  7999     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8000             OR                                                   ELCDTERX
  8001         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8002         GO TO 0005-READ--CARD.                                   ELCDTERX
  8003                                                                  ELCDTERX
  8004     ADD 1                       TO INDEXST.                      ELCDTERX
  8005     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8006                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8007     GO TO 0072-READ--OPST.                                       ELCDTERX
  8008                                                                  ELCDTERX
  8009 0074-READ--OPBS.                                                 ELCDTERX
  8010                                                                  ELCDTERX
  8011     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8012                                                                  ELCDTERX
  8013     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8014             OR                                                   ELCDTERX
  8015         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8016         GO TO 0005-READ--CARD.                                   ELCDTERX
  8017                                                                  ELCDTERX
  8018     ADD 1                       TO INDEXBS.                      ELCDTERX
  8019     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8020     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8021                                                                  ELCDTERX
  8022 0079-READ--EXIT.                                                 ELCDTERX
  8023*    EXIT.                                                        ELCDTERX
  8024******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 156
* ECS010.cbl
  8026******************************************************************
  8027***           O P E N   F I L E S   R O U T I N E              ***
  8028******************************************************************
  8029
  8030     DISPLAY ' '.
  8031     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8032         'ECS010 ******'
  8033     DISPLAY ' '.
  8034
  8035     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8036     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8037     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8038     .
  8039 0080-OPEN-FILES.
  8040*    IF DTE-PGM-OPT = '1'
  8041*       open output detail-extr
  8042*    end-if
  8043     OPEN INPUT  PENDING-EXTRACT
  8044                 CERT-MASTER-IN
  8045                 ERACCTT-IN
  8046                 ERAGTC
  8047
  8048          I-O    ERMEBL-INOUT
  8049                 ELCRTT
  8050
  8051          OUTPUT SUMMARY-EXTR
  8052                 ME-ECS010-BALANCE
  8053                 ME50-ECS010-BALANCE
  8054                 DISPLAY-PRT
  8055                 MISMATCH-REPORT
  8056                 PRINT-COPY.
  8057     IF DTE-CLIENT = 'DCC'
  8058        OPEN INPUT ERPDEF
  8059     END-IF
  8060
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 157
* ECS010.cbl
  8062*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8063     IF DTE-CLIENT NOT = 'DMD'
  8064         NEXT SENTENCE
  8065     ELSE
  8066         OPEN INPUT ERRESC-IN
  8067            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8068                NEXT SENTENCE
  8069            ELSE
  8070                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8071                MOVE 'ERROR OPENING ERRESC FILE'
  8072                                        TO WS-ABEND-MESSAGE
  8073                GO TO ABEND-PGM.
  8074*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8075
  8076     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8077         NEXT SENTENCE
  8078       ELSE
  8079         MOVE '11'                    TO ABEND-CODE-1
  8080         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8081         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8082         GO TO ABEND-PGM.
  8083
  8084     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8085        CONTINUE
  8086     ELSE
  8087        DISPLAY ' OPEN ERROR ELCRTT '
  8088        MOVE '31'                TO ABEND-CODE-1
  8089        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8090        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8091        GO TO ABEND-PGM
  8092     END-IF
  8093
  8094     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8095        CONTINUE
  8096     ELSE
  8097        DISPLAY ' OPEN ERROR ERAGTC '
  8098        MOVE '41'                TO ABEND-CODE-1
  8099        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8100        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8101        GO TO ABEND-PGM
  8102     END-IF
  8103
  8104     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8105        CONTINUE
  8106     ELSE
  8107        DISPLAY ' OPEN ERROR ERPDEF '
  8108        MOVE '61'                TO ABEND-CODE-1
  8109        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8110        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8111        GO TO ABEND-PGM
  8112     END-IF
  8113
  8114     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8115         NEXT SENTENCE
  8116       ELSE
  8117         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8118
  8119           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 158
* ECS010.cbl
  8120              and (dte-pgm-opt = '1')
  8121              open output new-detail-extr
  8122           end-if
  8123
  8124     IF DTE-PGM-OPT = '1'
  8125         OPEN OUTPUT  CERT-MASTER-OUT
  8126                      DETAIL-EXTR
  8127     ELSE
  8128         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8129         MOVE '*'                     TO TRANS-EOF-FLAG.
  8130
  8131     MOVE 'R'                         TO CP-RATE-FILE.
  8132     MOVE 'O'                         TO CP-IO-FUNCTION.
  8133     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8134     IF IO-ERROR
  8135         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8136                                      TO WS-ABEND-MESSAGE
  8137         MOVE 0302                    TO WS-RETURN-CODE
  8138         GO TO ABEND-PGM.
  8139
  8140******************************************************************
  8141***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8142******************************************************************
  8143
  8144 0090-INITIALIZATION-ROUTINE.
  8145
  8146     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8147     MOVE WS-TIME                     TO ME-START-TIME.
  8148     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8149                                         TR-RN-DT.
  8150     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8151     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8152     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8153     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8154     MOVE COMPANY-NAME                TO TRHDNM.
  8155     MOVE ALPH-DATE                   TO TR-MODAYR.
  8156     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8157     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8158
  8159     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8160     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8161     COMPUTE LYD-MO = LYD-MO - 1.
  8162     IF LYD-MO = ZERO
  8163         MOVE 12                      TO LYD-MO
  8164         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8165
  8166     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8167
  8168
  8169     IF DTE-CLIENT = 'CID'
  8170         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8171         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8172     ELSE
  8173       IF DTE-CLIENT = 'AHL'
  8174         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8175         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8176       ELSE
  8177         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 159
* ECS010.cbl
  8178         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8179       END-IF
  8180     END-IF.
  8181
  8182     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8183         GO TO 0090-CONTINUE.
  8184
  8185     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8186     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8187     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8188     MOVE '6'                    TO DC-OPTION-CODE.
  8189     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8190
  8191     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8192         MOVE '**** WORK DATE CALC ERROR ****'
  8193                                 TO WS-ABEND-MESSAGE
  8194         MOVE '90'               TO ABEND-CODE-1
  8195         MOVE '0'                TO AC2-ONE
  8196         MOVE DC-ERROR-CODE      TO AC2-TWO
  8197         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8198         GO TO ABEND-PGM.
  8199
  8200     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8201
  8202     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8203     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8204
  8205     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8206             VARYING
  8207         SUBM FROM +2 BY +1
  8208             UNTIL
  8209         SUBM GREATER THAN +12.
  8210
  8211     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8212
  8213     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8214             VARYING
  8215         SUBM FROM +1 BY +1
  8216             UNTIL
  8217         SUBM GREATER THAN +13.
  8218
  8219     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8220*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8221     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8222                                    DC-ELAPSED-MONTHS.
  8223     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8224     MOVE 1                      TO DC-END-OF-MONTH.
  8225     MOVE '6'                    TO DC-OPTION-CODE.
  8226     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8227
  8228     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8229         MOVE '**** CUT OFF DATE ERROR ****'
  8230                                 TO WS-ABEND-MESSAGE
  8231         MOVE '90'               TO ABEND-CODE-1
  8232         MOVE '0'                TO AC2-ONE
  8233         MOVE DC-ERROR-CODE      TO AC2-TWO
  8234         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8235         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 160
* ECS010.cbl
  8236
  8237     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8238     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8239
  8240 0090-CONTINUE.
  8241
  8242     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8243     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8244     MOVE +0                     TO DC-ELAPSED-DAYS.
  8245     MOVE '6'                    TO DC-OPTION-CODE.
  8246     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8247
  8248     IF NO-CONVERSION-ERROR
  8249        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8250
  8251     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8252     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8253     MOVE +0                     TO DC-ELAPSED-DAYS.
  8254     MOVE '6'                    TO DC-OPTION-CODE.
  8255     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8256
  8257     IF NO-CONVERSION-ERROR
  8258        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8259
  8260     MOVE +0                     TO DC-ELAPSED-MONTHS
  8261                                    DC-ELAPSED-DAYS.
  8262
  8263     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8264     MOVE 'CR'                   TO CR-RECORD-ID.
  8265     MOVE ZEROS                  TO
  8266               CR-AGE                  CR-JOINT-AGE
  8267               CR-LFTYP                CR-AHTYP
  8268               CR-LF-TERM              CR-AH-TERM
  8269               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8270               CR-LF-TERM-IN-DAYS
  8271               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8272               CR-LFAMT                CR-AHAMT
  8273               CR-LFPRM                CR-AHPRM
  8274               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8275               CR-LFPRM-CALC           CR-AHPRM-CALC
  8276               CR-LFPRM-RATE           CR-AHPRM-RATE
  8277               CR-LFAMT-ALT
  8278               CR-LFPRM-ALT
  8279               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8280               CR-LFPRM-RATE-ALT
  8281               CR-LFRFND               CR-AHRFND
  8282               CR-LFRFND-CALC          CR-AHRFND-CALC
  8283               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8284               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8285               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8286               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8287               CR-LIVES                CR-APR
  8288               CR-BILLED
  8289               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8290               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8291               CR-PMT-FREQ             CR-LOAN-TERM
  8292               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8293               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 161
* ECS010.cbl
  8294               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8295               CR-LF-CANC-DT           CR-AH-CANC-DT
  8296               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8297               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8298               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8299               CR-DTH-DT               CR-DIS-DT
  8300               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8301               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8302                                       CR-DIS-PTO-DT
  8303               CR-DTHAMT               CR-DISAMT
  8304               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8305               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8306               CR-DTHEXP               CR-DISEXP
  8307               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8308               CR-DTH-AGE              CR-DAYS-DISAB
  8309               CR-DIS-INCUR-DT (1)
  8310***            CR-CLAIM-DEDUCT-WITHHELD
  8311               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8312               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8313               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8314               CR-MOB-NET-TOT-FEES
  8315               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8316               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8317
  8318     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8319                                       CR-DISAB-DETAIL-DATA (3)
  8320                                       CR-DISAB-DETAIL-DATA (4)
  8321                                       CR-DISAB-DETAIL-DATA (5).
  8322
  8323     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8324
  8325     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8326     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8327        IA > +10
  8328        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8329     END-PERFORM
  8330     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8331
  8332     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8333
  8334     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8335                          EPEC-TOTALS      EPEC-SUBS
  8336                          EPEC-UNDERWRITTEN-TOTALS.
  8337
  8338     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8339                          EPEC-LEVELS-END-II.
  8340     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8341                          DUPE-CERT-TABLE.
  8342
  8343     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8344     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8345     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8346                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8347     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8348                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8349
  8350     IF RUN-DATE NOT = EP-DT
  8351         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 162
* ECS010.cbl
  8352     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8353     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8354     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8355     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8356
  8357     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8358         MOVE +1000                   TO DUP-MAX.
  8359
  8360     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8361     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8362     IF ME-DO-UPDATE
  8363         READ ERMEBL-INOUT INVALID KEY
  8364                       CLOSE ERMEBL-INOUT
  8365                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8366
  8367     IF DTE-CLIENT = 'DCC'
  8368        MOVE 0 TO B-SUB
  8369        MOVE DTE-CLASIC-COMPANY-CD
  8370                                 TO PD-CONTROL-PRIMARY
  8371        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8372        IF ERPDEF-FILE-STATUS = '00'
  8373           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8374              READ ERPDEF NEXT RECORD
  8375              IF ERPDEF-FILE-STATUS = '00'
  8376                 ADD 1 TO B-SUB
  8377                 IF B-SUB > max-pdef
  8378                    DISPLAY ' DDF UEP TABLE BLEW ' b-sub
  8379                    GO TO ABEND-PGM
  8380                 END-IF
  8381                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8382                 MOVE PD-PRODUCT-CD
  8383                                 TO DD-PRODUCT-CD (B-SUB)
  8384                 MOVE PD-BEN-TYPE
  8385                                 TO DD-BEN-TYPE (B-SUB)
  8386                 MOVE PD-BEN-CODE
  8387                                 TO DD-BEN-CODE (B-SUB)
  8388                 MOVE PD-PROD-EXP-DT
  8389                                 TO DD-PROD-EXP-DT (B-SUB)
  8390                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8391                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8392                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8393                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8394                    P2 > +8
  8395                    MOVE PD-PROD-CODE (P2)
  8396                                 TO DD-PROD-CODE (B-SUB P2)
  8397                    MOVE PD-MAX-AMT (P2)
  8398                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8399                 END-PERFORM
  8400                 MOVE PD-EARN-FACTORS
  8401                                 TO DD-EARN-FACTORS (B-SUB)
  8402              END-IF
  8403           END-PERFORM
  8404           display ' pdef table entries ' b-sub
  8405        END-IF
  8406        CLOSE ERPDEF
  8407     END-IF
  8408
  8409     GO TO 0150-READ-ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 163
* ECS010.cbl
  8410
  8411 0090-EXIT.
  8412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 164
* ECS010.cbl
  8414 0095-GET-EOM-DATES.
  8415
  8416     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8417     MOVE '6'                    TO DC-OPTION-CODE.
  8418     MOVE 1                      TO DC-ELAPSED-MONTHS
  8419                                    DC-END-OF-MONTH.
  8420     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8421     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8422
  8423     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8424         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8425                                 TO WS-ABEND-MESSAGE
  8426         MOVE '90'               TO ABEND-CODE-1
  8427         MOVE '0'                TO AC2-ONE
  8428         MOVE DC-ERROR-CODE      TO AC2-TWO
  8429         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8430         GO TO ABEND-PGM.
  8431
  8432     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8433                                     DC-BIN-DATE-1.
  8434     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8435     MOVE ' '                    TO  DC-OPTION-CODE.
  8436     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8437
  8438     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8439         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8440                                 TO WS-ABEND-MESSAGE
  8441         MOVE '90'               TO ABEND-CODE-1
  8442         MOVE '0'                TO AC2-ONE
  8443         MOVE DC-ERROR-CODE      TO AC2-TWO
  8444         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8445         GO TO ABEND-PGM.
  8446
  8447     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8448
  8449 0095-EXIT.
  8450     EXIT.
  8451
  8452 0096-DISPLAY-EOM-DATES.
  8453
  8454     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8455
  8456 0096-EXIT.
  8457     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 165
* ECS010.cbl
  8459******************************************************************
  8460***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8461******************************************************************
  8462
  8463 0100-ACCT-MASTER-READ-ROUTINE.
  8464
  8465     IF EP-FLG = '1'
  8466        ADD +1                   TO BC-ACT-ACCTS
  8467        IF DTE-OPT-RESERVE-METHOD-AUTH
  8468           PERFORM 4700-CALC-OPT-IBNR
  8469                                 THRU 4700-EXIT
  8470        END-IF
  8471        PERFORM 4500-BUILD-EPEC-EXTRACT
  8472                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8473     END-IF
  8474
  8475     IF TRANSACTION-WAS-PROCESSED
  8476         MOVE '1'                     TO ACCT-FLG
  8477                                         STATE-FLG
  8478                                         COMP-FLG
  8479                                         CARR-FLG
  8480                                         FINAL-FLG.
  8481
  8482 0150-READ-ACCOUNT-MASTER.
  8483
  8484     READ ERACCTT-IN AT END
  8485         GO TO 9930-EOJ-3.
  8486
  8487     ADD +1                            TO ERACCTT-READS.
  8488
* 8489     COPY ELCACCTI.
  8490******************************************************************04/14/98
  8491*                                                                *ELCACCTI
  8492*                            ELCACCTI                            *   LV003
  8493*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8494*                            VMOD=2.001                          *ELCACCTI
  8495*                                                                *ELCACCTI
  8496*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8497*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8498*                                                                *ELCACCTI
  8499*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8500*                                                                *ELCACCTI
  8501******************************************************************ELCACCTI
  8502     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8503     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8504     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8505     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8506     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8507     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8508     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8509     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8510     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8511
  8512     IF FIRST-ACCOUNT EQUAL +1
  8513        MOVE +0                  TO FIRST-ACCOUNT
  8514        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8515
  8516     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 166
* ECS010.cbl
  8517         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8518     ELSE
  8519     IF AM-GROUPING NOT = HLD-GROUPING
  8520         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8521     ELSE
  8522     IF AM-STATE NOT = HLD-STATE
  8523         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8524     ELSE
  8525     IF AM-ACCOUNT NOT = HLD-ACCT
  8526         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8527     ELSE
  8528     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8529
  8530     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8531        (AM-GROUPING NOT = HLD-GROUPING)
  8532         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8533
  8534 0190-PROCESS-NEW-ACCOUNT.
  8535
  8536     IF AM-CARRIER NOT = HLD-CARRIER
  8537         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8538
  8539     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8540     MOVE AM-CARRIER            TO TR-CARR.
  8541     MOVE AM-GROUPING           TO TR-GROUP.
  8542     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8543     MOVE AM-NAME               TO TR-AGCY.
  8544     MOVE AM-EFF-MO             TO TR-CE-MO.
  8545     MOVE AM-EFF-DA             TO TR-CE-DA.
  8546     MOVE AM-EFF-YR             TO TR-CE-YR.
  8547     MOVE AM-STATE              TO TR-ST-NO.
  8548     IF AM-EXPIRE-DT =  99999999999
  8549         MOVE 'CURRENT '        TO TR-CX
  8550     ELSE
  8551         MOVE AM-EXP-MO         TO TR-CX-MO
  8552         MOVE AM-EXP-DA         TO TR-CX-DA
  8553         MOVE AM-EXP-YR         TO TR-CX-YR
  8554         MOVE '-'               TO HSHR1  HSHR2.
  8555
  8556     ADD +1 TO BC-ACCTS.
  8557
  8558     IF AM-RECORD-ID = '**'
  8559         ADD +1 TO BC-NEW-ACCTS.
  8560     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8561         ADD +1 TO BC-ER-ACCTS.
  8562
  8563     MOVE ZEROS                 TO SV-LO-CERT
  8564                                   SV-HI-CERT.
  8565     MOVE SPACE                 TO TRANSACTION-FLAG
  8566                                   LST-TRD-CERT
  8567                                   LST-TRD-ISDT
  8568                                   OB-DATE-1-SWITCH
  8569                                   OB-DATE-2-SWITCH
  8570                                   OB-DATE-3-SWITCH.
  8571     MOVE +81                   TO LN-CNT.
  8572
  8573     IF DTE-CLIENT = 'DCC'
  8574        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 167
* ECS010.cbl
  8575        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8576           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8577              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8578           END-IF
  8579           IF AM-COMM-CHARGEBACK (SUB) = 99
  8580              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8581           END-IF
  8582        END-PERFORM
  8583     END-IF
  8584     .
  8585 0199-READ-ACCOUNT-X.
  8586     EXIT.
  8587
  8588 0199A-CARRIER-TABLE-LOOKUP.
  8589
  8590     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8591            VARYING CLAS-INDEXCN FROM 1 BY 1
  8592         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8593               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8594
  8595     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8596         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8597         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8598                                 TO WS-ABEND-MESSAGE
  8599         MOVE 4004               TO WS-ABEND-CODE
  8600         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8601         GO TO ABEND-PGM.
  8602
  8603 0199A-LOOKUP-XIT.
  8604     EXIT.
  8605 0199B-SEARCH-CARRIER-TABLE.
  8606     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 168
* ECS010.cbl
  8608******************************************************************
  8609***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8610******************************************************************
  8611
  8612 0200-CERT-MASTER-READ-ROUTINE.
  8613
  8614     IF EOF-ON-CERT
  8615         GO TO 0299-READ-CERT-X.
  8616
  8617     IF FIRST-CERT EQUAL +1
  8618        MOVE +0                  TO FIRST-CERT
  8619        GO TO 0250-READ-CERT-MASTER.
  8620
  8621     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8622
  8623     PERFORM CERT-DATE-LOAD.
  8624
  8625     IF CR-IND-GRP = 'I'  OR  '1'
  8626         MOVE '1'                    TO CR-IND-GRP
  8627     ELSE
  8628         MOVE '2'                    TO CR-IND-GRP.
  8629
  8630     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8631         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8632     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8633         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8634
  8635************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8636     IF DTE-CLIENT NOT = 'NSL'
  8637         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8638                                      CR-AH-REI-RISK-PRM.
  8639******************************************************************
  8640
  8641**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8642****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8643     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8644         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8645
  8646     MOVE CR-STATE                   TO STATE-L.
  8647     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8648
  8649     IF CR-LFTYP NOT = ZERO
  8650         MOVE CR-LFTYP               TO CLAS-LOOK
  8651         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8652
  8653     IF CR-AHTYP NOT = ZERO
  8654         MOVE CR-AHTYP               TO CLAS-LOOK
  8655         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8656
  8657     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8658     MOVE 'L'                    TO DC-OPTION-CODE
  8659     MOVE +0                     TO DC-ELAPSED-MONTHS
  8660                                    DC-ELAPSED-DAYS
  8661     PERFORM 8000-DATE-CONVERT-ROUTINE
  8662                                 THRU 8099-DATE-CONVERT-X
  8663     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8664
  8665     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 169
* ECS010.cbl
  8666        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8667        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8668        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8669        PERFORM 0395-GET-CERT-TRLRS
  8670                                 THRU 0395-EXIT
  8671     END-IF
  8672
  8673     IF RUN-MO NOT = 01
  8674         GO TO 0250-READ-CERT-MASTER.
  8675
  8676     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8677                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8678
  8679     IF ((CR-LFTYP NOT = ZERO)  AND
  8680         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8681        ((CR-AHTYP NOT = ZERO)  AND
  8682         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8683           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8684
  8685     .
  8686 0250-READ-CERT-MASTER.
  8687
  8688     READ CERT-MASTER-IN
  8689               AT END GO TO 9920-EOJ-2.
  8690
  8691     ADD +1 TO CMIN-CNT.
  8692
  8693*     DISPLAY ' READ CERT ' CIR-CONTROL
  8694     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8695         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8696         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8697         DISPLAY 'SECOND - '  CIR-CONTROL
  8698         MOVE 0612                    TO WS-ABEND-CODE
  8699         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8700         GO TO ABEND-PGM.
  8701
  8702     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8703         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8704            pcic-dt ' ' pcic-cert-no
  8705         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8706            GO TO 0250-READ-CERT-MASTER
  8707         ELSE
  8708            MOVE 'DUPLICATE CERT ON FILE'
  8709                                      TO WS-ABEND-MESSAGE
  8710            MOVE 0302                 TO WS-ABEND-CODE
  8711            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8712            GO TO ABEND-PGM.
  8713
  8714******************************************************
  8715*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8716*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8717*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8718******************************************************
  8719     IF DTE-CLIENT = 'CID'
  8720        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8721           IF (CF-THIRD-AGENT  = '0000713100') OR
  8722              (CF-FOURTH-AGENT = '0000713100')
  8723              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 170
* ECS010.cbl
  8724           ELSE
  8725              GO TO 0250-READ-CERT-MASTER
  8726           END-IF
  8727        ELSE
  8728           IF COMPANY-NAME = '        PEOPLES TRUST'
  8729              IF CI-ACCOUNT = '0000845800'
  8730                 CONTINUE
  8731              ELSE
  8732                 GO TO 0250-READ-CERT-MASTER
  8733              END-IF
  8734           ELSE
  8735              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8736                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8737                    (CF-FOURTH-AGENT = '0000681700')
  8738                    CONTINUE
  8739                 ELSE
  8740                    GO TO 0250-READ-CERT-MASTER
  8741                 END-IF
  8742              ELSE
  8743                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8744                    IF CI-ACCOUNT = '0001107200'
  8745                       CONTINUE
  8746                    ELSE
  8747                       GO TO 0250-READ-CERT-MASTER
  8748                    END-IF
  8749                 END-IF
  8750              END-IF
  8751           END-IF
  8752        END-IF
  8753     END-IF
  8754
  8755******************************************************
  8756     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8757
  8758 0299-READ-CERT-X.
  8759     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 171
* ECS010.cbl
  8761******************************************************************
  8762***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8763******************************************************************
  8764
  8765 0300-READ-PENDING-TRANSACTIONS.
  8766
  8767     READ PENDING-EXTRACT
  8768                   AT END GO TO 9910-EOJ-1.
  8769
  8770     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8771
  8772     IF NOT ED-PENDING-BUSINESS  AND
  8773        NOT ED-PENDING-CLAIMS  AND
  8774        NOT ED-CERT-CHANGES
  8775           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8776                                               ED-RECORD-TYPE
  8777           MOVE 0301                        TO WS-ABEND-CODE
  8778           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8779           GO TO ABEND-PGM.
  8780
  8781     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8782
  8783     IF DTE-CLIENT = 'NCL'
  8784         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8785             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8786                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8787             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8788
  8789     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8790         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8791         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8792         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8793         MOVE 0603                    TO WS-ABEND-CODE
  8794         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8795         GO TO ABEND-PGM.
  8796
  8797     ADD +1 TO TR-CNT.
  8798
  8799     IF ISSUE-TRANSACTION   OR
  8800        CANCEL-TRANSACTION  OR
  8801        CLAIM-TRANSACTION   OR
  8802        RESERVE-TRANSACTION OR
  8803        UPDATE-TRANSACTION
  8804         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8805         GO TO 0330-MATCH-PENDING-TO-CERT.
  8806
  8807     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8808
  8809     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8810     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8811             PENDING-RECORD-TYPE ')'.
  8812
  8813     MOVE 0301                   TO WS-ABEND-CODE.
  8814     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8815     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 172
* ECS010.cbl
  8817 0310-SET-UP-MATCHING-KEY.
  8818
  8819     IF ED-PENDING-BUSINESS
  8820         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8821         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8822         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8823         MOVE PB-STATE           TO PEND-MATCH-STATE
  8824         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8825         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8826         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8827         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8828
  8829     IF ED-PENDING-CLAIMS
  8830         ADD +1                  TO W-PENDING-CLMS
  8831         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8832         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8833         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8834         MOVE PC-STATE           TO PEND-MATCH-STATE
  8835         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8836         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8837         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8838         IF PC-CLAIMS
  8839             MOVE '3'            TO PENDING-RECORD-TYPE
  8840         ELSE
  8841             IF PC-RESERVES
  8842                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8843
  8844     IF ED-CERT-CHANGES
  8845         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8846         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8847         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8848         MOVE CC-STATE           TO PEND-MATCH-STATE
  8849         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8850         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8851         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8852         MOVE '5'                TO PENDING-RECORD-TYPE.
  8853
  8854     MOVE ' '                    TO DC-OPTION-CODE.
  8855     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8856     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8857
  8858 0310-EXIT.
  8859     EXIT.
  8860
  8861******************************************************************
  8862***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8863******************************************************************
  8864
  8865 0330-MATCH-PENDING-TO-CERT.
  8866
  8867     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8868         GO TO 0390-CERT-MISMATCH-ERROR.
  8869
  8870     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8871*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8872       IF CLAIM-TRANSACTION
  8873*         DISPLAY ' CLAIM '
  8874         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 173
* ECS010.cbl
  8875            NOT PC-NON-CHARGEBLE-EXPENSE
  8876             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8877                                      OR
  8878                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8879                  GO TO 0390-CERT-MISMATCH-ERROR.
  8880
  8881     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8882       IF RESERVE-TRANSACTION
  8883*         DISPLAY ' RESV '
  8884         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8885                                  OR
  8886            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8887              GO TO 0390-CERT-MISMATCH-ERROR.
  8888
  8889     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8890         IF ISSUE-TRANSACTION
  8891*           DISPLAY ' ISSUE '
  8892             GO TO 0380-DUPLICATE-CERT-ERROR
  8893         ELSE
  8894             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8895
  8896     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8897         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8898         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8899                                               0299-READ-CERT-X
  8900         GO TO 0330-MATCH-PENDING-TO-CERT.
  8901
  8902     IF ISSUE-TRANSACTION
  8903         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8904     ELSE
  8905         GO TO 0390-CERT-MISMATCH-ERROR.
  8906
  8907 0350-MATCH-PENDING-TO-ACCOUNT.
  8908
  8909     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8910       ADD +1  TO ERROR-COUNT
  8911         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8912           TO  DL-FULL
  8913             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8914         MOVE    ' PENDING CONTROL = '
  8915           TO  DIS-LINE-REASON
  8916         MOVE  PENDING-MATCH-CONTROL
  8917           TO  DIS-LINE-REC
  8918             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8919         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8920           TO  DIS-LINE-REASON
  8921         MOVE  PENDING-MATCH-CONTROL
  8922           TO  DIS-LINE-REC
  8923             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8924         MOVE  SPACES
  8925           TO  DISPLAY-LINE
  8926             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8928         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8929         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8930         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8931         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8932         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8933         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 174
* ECS010.cbl
  8934         AM-MSTR-CNTRL AM-EFFECT-DT
  8935         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8936            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8937            GO TO 0300-READ-PENDING-TRANSACTIONS
  8938         ELSE
  8939            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8940                                      TO WS-ABEND-MESSAGE
  8941            MOVE 0302 TO WS-ABEND-CODE
  8942            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8943            GO TO ABEND-PGM.
  8944
  8945     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8946         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8947                                              0199-READ-ACCOUNT-X
  8948         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8949
  8950     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8951        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8952         GO TO 0500-APPLY-PENDING-BUSINESS.
  8953
  8954     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8955                                       0199-READ-ACCOUNT-X.
  8956     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8957
  8958
  8959 0370-ACCOUNT-MISMATCH-ERROR.
  8960
  8961     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8962     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8963     MOVE 'MISMATCH ACCOUNT ERROR'
  8964                               TO WS-ABEND-MESSAGE.
  8965     MOVE 0302 TO WS-ABEND-CODE.
  8966         DISPLAY '******************************'
  8967         DISPLAY '***** ERROR LOCATION 009 *****'
  8968         DISPLAY '******************************'
  8969     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8970     GO TO ABEND-PGM.
  8971
  8972
  8973 0380-DUPLICATE-CERT-ERROR.
  8974
  8975     IF PB-I-OB  OR  PB-I-SUMMARY
  8976         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8977
  8978     ADD +1 TO DUP-CNT.
  8979
  8980     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8981         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8982         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8983                                         PB-I-LF-ALT-PREMIUM-AMT
  8984         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8985         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8986         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8987
  8988     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8989     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8990
  8991*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 175
* ECS010.cbl
  8992*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8993*    GO TO ABEND-PGM.
  8994
  8995
  8996 0390-CERT-MISMATCH-ERROR.
  8997
  8998     IF ISSUE-TRANSACTION  OR
  8999        CANCEL-TRANSACTION  OR
  9000        CLAIM-TRANSACTION
  9001         ADD +1                  TO  MISMATCH-COUNT.
  9002
  9003     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  9004       ADD  +1  TO  ERROR-COUNT
  9005         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  9006           TO  DL-FULL
  9007             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9008         MOVE    ' TRANS CONTROL = '
  9009           TO  DIS-LINE-REASON
  9010         MOVE  PENDING-MATCH-CONTROL
  9011           TO  DIS-LINE-REC
  9012             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9013         MOVE    ' TRANS TYPE    = '
  9014           TO  DIS-LINE-REASON
  9015         MOVE  PENDING-RECORD-TYPE
  9016           TO  DIS-LINE-REC
  9017             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9018         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9019           TO  DL-FULL
  9020             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9021         MOVE    ' CERT IN CTL   = '
  9022           TO  DIS-LINE-REASON
  9023         MOVE  CIR-CONTROL
  9024           TO  DIS-LINE-REC
  9025             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9026         MOVE    ' BYPASSED TRANS  = '
  9027           TO  DIS-LINE-REASON
  9028         MOVE  PENDING-MATCH-CONTROL
  9029           TO  DIS-LINE-REC
  9030             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9031         MOVE  SPACES
  9032           TO  DISPLAY-LINE
  9033             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9034         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9035
  9036     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9037     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9038
  9039     IF ISSUE-TRANSACTION
  9040         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9041     ELSE
  9042         IF CANCEL-TRANSACTION
  9043             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9044         ELSE
  9045             IF CLAIM-TRANSACTION
  9046                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9047             ELSE
  9048                 IF RESERVE-TRANSACTION
  9049                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 176
* ECS010.cbl
  9050                 ELSE
  9051                     IF UPDATE-TRANSACTION
  9052                         MOVE 'CHG'
  9053                                 TO  DTL-REC-TYPE-DESC.
  9054
  9055     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9056     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9057     MOVE 'DROPPED'              TO  DTL-STATUS.
  9058
  9059     IF ISSUE-TRANSACTION
  9060         MOVE PB-I-LF-PREMIUM-AMT
  9061                                 TO  MD2-LF-PREM
  9062         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9063                                 TO  MD2-LF-ALT-PREM
  9064         MOVE PB-I-AH-PREMIUM-AMT
  9065                                 TO  MD2-AH-PREM
  9066         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9067         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9068         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9069     ELSE
  9070         IF CANCEL-TRANSACTION
  9071             MOVE PB-C-LF-CANCEL-AMT
  9072                                 TO  MD3-LF-REFUND
  9073             MOVE PB-C-AH-CANCEL-AMT
  9074                                 TO  MD3-AH-REFUND
  9075             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9076             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9077         ELSE
  9078             IF CLAIM-TRANSACTION
  9079                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9080                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9081                     MOVE ZEROS             TO MD4-AH-CLAIM
  9082                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9083                 ELSE
  9084                     MOVE ZEROS             TO MD4-LF-CLAIM
  9085                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9086                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9087
  9088     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9089         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9090         MOVE MISMATCH-PAGE-NUMBER
  9091                                 TO  TR-PG
  9092         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9093         MOVE MR-CTL             TO  X
  9094         MOVE X TO LCP-ASA
  9095         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9096             THRU LCP-WRITE-END-MISMATCH-RPT
  9097         MOVE TR-HD-2            TO  MISMATCH-RPT
  9098         MOVE MR-CTL             TO  X
  9099         MOVE X TO LCP-ASA
  9100         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9101             THRU LCP-WRITE-END-MISMATCH-RPT
  9102         MOVE TR-HD-3            TO  MISMATCH-RPT
  9103         MOVE MR-CTL             TO  X
  9104         MOVE X TO LCP-ASA
  9105         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9106             THRU LCP-WRITE-END-MISMATCH-RPT
  9107         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 177
* ECS010.cbl
  9108         MOVE MR-CTL             TO  X
  9109         MOVE X TO LCP-ASA
  9110         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9111             THRU LCP-WRITE-END-MISMATCH-RPT
  9112         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9113
  9114     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9115     MOVE MR-CTL                 TO  X.
  9116     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9117
  9118     MOVE X TO LCP-ASA
  9119     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9120         THRU LCP-WRITE-END-MISMATCH-RPT.
  9121
  9122     IF ISSUE-TRANSACTION
  9123         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9124         MOVE MR-CTL             TO  X
  9125         ADD +1                  TO  MISMATCH-LINE-COUNT
  9126         MOVE X TO LCP-ASA
  9127         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9128             THRU LCP-WRITE-END-MISMATCH-RPT.
  9129
  9130     IF CANCEL-TRANSACTION
  9131         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9132         MOVE MR-CTL             TO  X
  9133         ADD +1                  TO  MISMATCH-LINE-COUNT
  9134         MOVE X TO LCP-ASA
  9135         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9136             THRU LCP-WRITE-END-MISMATCH-RPT.
  9137
  9138     IF CLAIM-TRANSACTION
  9139         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9140         MOVE MR-CTL             TO  X
  9141         ADD +1                  TO  MISMATCH-LINE-COUNT
  9142         MOVE X TO LCP-ASA
  9143         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9144             THRU LCP-WRITE-END-MISMATCH-RPT.
  9145
  9146     MOVE SPACES                 TO  MISMATCH-RPT.
  9147
  9148     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9149
  9150 0395-GET-CERT-TRLRS.
  9151
  9152     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9153     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9154     MOVE CR-CARRIER             TO CS-CARRIER
  9155     MOVE CR-GROUPING            TO CS-GROUPING
  9156     MOVE CR-STATE               TO CS-STATE
  9157     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9158     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9159     MOVE CR-CERT-NO             TO CS-CERT-NO
  9160     MOVE 'A'                    TO CS-TRAILER-TYPE
  9161
  9162     READ ELCRTT
  9163
  9164     IF ELCRTT-FILE-STATUS = '00'
  9165        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 178
* ECS010.cbl
  9166                                 TO WS-BANK-COMMISSIONS
  9167     ELSE
  9168        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9169           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9170           PERFORM ABEND-PGM
  9171        END-IF
  9172     END-IF
  9173
  9174     .
  9175 0395-EXIT.
  9176     EXIT.
  9177
  9178******************************************************************
  9179***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9180******************************************************************
  9181
  9182 0400-WRITE-CERT-RECORD.
  9183*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9184
  9185     IF CERTIFICATE-RECORD = LOW-VALUES
  9186         GO TO 0499-WRITE-CERT-X.
  9187
  9188     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9189         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9190         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9191            ' ' cr-dt ' ' cr-cert-no
  9192         ADD  +1  TO  ERROR-COUNT
  9193         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9194           TO  DL-FULL
  9195             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9196         MOVE    ' CERT. CONTROL = '
  9197           TO  DIS-LINE-REASON
  9198         MOVE  CR-FULL-CONTROL
  9199           TO  DIS-LINE-REC
  9200             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9201         MOVE  SPACES
  9202           TO  DISPLAY-LINE
  9203             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9204            if dte-pgm-opt = '1'
  9205               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9206               ADD +1 TO CMOT-CNT
  9207            end-if
  9208            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9209                                 thru 0299-READ-CERT-X
  9210               GO TO 0400-WRITE-CERT-RECORD.
  9211
  9212*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9213
  9214     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9215         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9216                                              0199-READ-ACCOUNT-X
  9217         GO TO 0400-WRITE-CERT-RECORD.
  9218
  9219     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9220        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9221         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9222                                              0199-READ-ACCOUNT-X
  9223         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 179
* ECS010.cbl
  9224
  9225*     DISPLAY ' BEFORE REIN '
  9226     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9227*     DISPLAY ' AFTER REIN '
  9228
  9229     IF CR-LFTYP = ZEROS  AND
  9230        CR-DTHEXP NOT = ZEROS
  9231         ADD +1                     TO W-LFTYP-99
  9232         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9233         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9234
  9235     IF CR-AHTYP = ZEROS  AND
  9236        CR-DISEXP NOT = ZEROS
  9237         ADD +1                     TO W-AHTYP-99
  9238         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9239         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9240
  9241*     DISPLAY ' BEFORE EP BUMP'
  9242     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9243*     DISPLAY ' AFTER EP BUMP'
  9244
  9245      if (dte-client = 'DCC')
  9246         and (ws-dcc-cnc-flag = 'Y')
  9247         write new-detail-extract
  9248      end-if
  9249
  9250     IF CR-LFTYP = '99'
  9251         MOVE '00'                  TO CR-LFTYP.
  9252     IF CR-AHTYP = '99'
  9253         MOVE '00'                  TO CR-AHTYP.
  9254
  9255*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9256*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9257
  9258     IF CR-NH-INT-ON-REF NOT NUMERIC
  9259         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9260     END-IF
  9261
  9262     IF  CR-POLICY-IS-ACTIVE
  9263         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9264         IF  CR-POLICY-IS-REISSUE
  9265             OR CR-POLICY-IS-MONTHLY
  9266             ADD +1              TO W-POLICY-REISSUE-CTR
  9267         ELSE
  9268             IF  CR-POLICY-IS-REIN-ONLY
  9269                 ADD +1          TO W-POLICY-REIN-CTR
  9270             ELSE
  9271                 NEXT SENTENCE
  9272     ELSE
  9273         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9274
  9275     IF DTE-PGM-OPT = '1'
  9276       IF REIN-IS-RISK-PREMIUM  AND
  9277          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9278         IF NOT CR-POLICY-IS-REISSUE  AND
  9279            NOT CR-POLICY-IS-DECLINED  AND
  9280            NOT CR-POLICY-IS-VOID
  9281            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 180
* ECS010.cbl
  9282             MOVE '*'            TO RISK-PREM-FLAG
  9283             PERFORM 3100-REINSURE-ISSUE THRU
  9284                     3199-REINSURE-ISSUE-X.
  9285
* 9286     COPY ELCCRTM2.
  9287******************************************************************04/16/98
  9288*                                                                *ELCCRTM2
  9289*                                                                *ELCCRTM2
  9290*                            ELCCRTM2                            *   LV004
  9291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9292*                            VMOD=2.001                          *ELCCRTM2
  9293*                                                                *ELCCRTM2
  9294*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9295*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9296*                                                                *ELCCRTM2
  9297******************************************************************ELCCRTM2
  9298     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9299     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9300     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9301     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9302     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9303     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9304                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9305     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9306     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9307     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9308     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9309                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9310     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9311     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9312     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9313     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9314     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9315                                                                     CL**4
  9316     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9317                UNTIL COPY-NDX > 5                                   CL**4
  9318           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9319                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9320     END-PERFORM.                                                 ELCCRTM2
  9321                                                                  ELCCRTM2
  9322
  9323     IF DTE-PGM-OPT = '1'
  9324         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9325         ADD +1 TO CMOT-CNT.
  9326
  9327     move zeros                  to ueclp-clp-fact
  9328     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9329                                    RISK-REIN-FLAG
  9330                                    RISK-PREM-FLAG
  9331                                    RC-COMM-FLG.
  9332
  9333 0499-WRITE-CERT-X.
  9334     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 181
* ECS010.cbl
  9336******************************************************************
  9337***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9338******************************************************************
  9339
  9340 0500-APPLY-PENDING-BUSINESS.
  9341
  9342     IF CANCEL-TRANSACTION
  9343*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9344         GO TO 0600-PROCESS-CANCELLATIONS.
  9345
  9346     IF CLAIM-TRANSACTION
  9347*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9348         GO TO 0700-PROCESS-CLAIMS.
  9349
  9350     IF RESERVE-TRANSACTION
  9351*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9352         GO TO 0800-PROCESS-RESERVES.
  9353
  9354     IF UPDATE-TRANSACTION
  9355*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9356         GO TO 0900-PROCESS-CERT-CHANGES.
  9357
  9358******************************************************************
  9359***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9360******************************************************************
  9361
  9362 0505-PROCESS-ISSUES.
  9363
  9364     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9365     PERFORM CERT-DATE-LOAD.
  9366
  9367     ADD +1                      TO  W-POL-ISSUES.
  9368
  9369     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9370     MOVE PB-CARRIER             TO  CR-CARRIER.
  9371     MOVE PB-GROUPING            TO  CR-GROUPING.
  9372     MOVE PB-STATE               TO  CR-STATE.
  9373     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9374     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9375                                     WS-CR-BIN-DATE
  9376     MOVE ' '                    TO  DC-OPTION-CODE.
  9377     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9378     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9379                                     WS-CR-DT-N.
  9380     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9381
  9382*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9383     MOVE PB-I-NAME              TO  CR-NAME.
  9384     MOVE PB-I-AGE               TO  CR-AGE.
  9385     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9386     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9387
  9388     IF PB-I-JOINT-COVERAGE
  9389         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9390         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9391     ELSE
  9392        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9393           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 182
* ECS010.cbl
  9394             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9395
  9396     IF PB-I-SUMMARY  OR
  9397        DTE-CLIENT = 'DMD'
  9398         MOVE PB-I-LIVES         TO  CR-LIVES.
  9399
  9400     IF PB-I-NUM-BILLED NOT NUMERIC
  9401        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9402
  9403     IF PB-I-STATE-TAX NOT NUMERIC
  9404        MOVE ZEROS               TO PB-I-STATE-TAX.
  9405
  9406     IF PB-I-MUNI-TAX NOT NUMERIC
  9407        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9408     IF PB-I-TOT-FEES NOT NUMERIC
  9409        MOVE ZEROS               TO PB-I-TOT-FEES
  9410     END-IF
  9411     IF PB-I-ADDL-CLP NOT NUMERIC
  9412        MOVE ZEROS               TO PB-I-ADDL-CLP
  9413     END-IF
  9414
  9415     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9416     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9417     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9418     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9419     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9420     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9421     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9422     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9423     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9424     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9425     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9426     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9427     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9428
  9429     IF PB-I-RATE-CLASS-OVRD = SPACES
  9430         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9431     ELSE
  9432         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9433
  9434     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9435     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9436
  9437     IF PB-I-INDV-GRP-OVRD = SPACES
  9438         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9439     ELSE
  9440         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9441
  9442     IF CR-IND-GRP = 'I'  OR  '1'
  9443         MOVE '1'                TO  CR-IND-GRP
  9444     ELSE
  9445         MOVE '2'                TO  CR-IND-GRP.
  9446
  9447     IF PB-I-SKIP-CODE = '1'
  9448         MOVE 01                 TO  CR-SKIP.
  9449     IF PB-I-SKIP-CODE = '2'
  9450         MOVE 02                 TO  CR-SKIP.
  9451     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 183
* ECS010.cbl
  9452         MOVE 03                 TO  CR-SKIP.
  9453     IF PB-I-SKIP-CODE = '4'
  9454         MOVE 04                 TO  CR-SKIP.
  9455     IF PB-I-SKIP-CODE = '5'
  9456         MOVE 05                 TO  CR-SKIP.
  9457     IF PB-I-SKIP-CODE = '6'
  9458         MOVE 06                 TO  CR-SKIP.
  9459     IF PB-I-SKIP-CODE = '7'
  9460         MOVE 07                 TO  CR-SKIP.
  9461     IF PB-I-SKIP-CODE = '8'
  9462         MOVE 08                 TO  CR-SKIP.
  9463     IF PB-I-SKIP-CODE = '9'
  9464         MOVE 09                 TO  CR-SKIP.
  9465     IF PB-I-SKIP-CODE = 'A'
  9466         MOVE 10                 TO  CR-SKIP.
  9467     IF PB-I-SKIP-CODE = 'X'
  9468         MOVE 11                 TO  CR-SKIP.
  9469
  9470     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9471     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9472     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9473
  9474     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9475         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9476                                        REIN-SPEC-A
  9477                                        REIN-SPEC-B
  9478                                        REIN-SPEC-C
  9479         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9480     ELSE
  9481         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9482
  9483     IF DTE-CLIENT = 'DCC'
  9484        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9485        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9486           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9487        END-IF
  9488     END-IF
  9489
  9490     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9491     MOVE ' '                    TO  DC-OPTION-CODE.
  9492     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9493     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9494
  9495     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9496
  9497     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9498         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9499     ELSE
  9500         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9501
  9502     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9503         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9504
  9505     IF PB-BATCH-ENTRY = SPACE  OR
  9506        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9507         MOVE '1'                TO  CR-ENTRY-STATUS
  9508     ELSE
  9509         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 184
* ECS010.cbl
  9510
  9511     IF PB-POLICY-IS-DECLINED
  9512         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9513
  9514     IF PB-POLICY-IS-VOIDED
  9515         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9516
  9517***  IF DTE-CLIENT NOT = 'CRI'
  9518***      IF PB-I-PREM-ACCTNG-ONLY
  9519***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9520
  9521     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9522                                     WS-CR-ENTRY-DATE-N.
  9523
  9524*    IF PB-I-MICROFILM-NO NUMERIC
  9525*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9526
  9527     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9528        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9529        OR 'AHL'
  9530         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9531     END-IF
  9532
  9533*************************************************
  9534***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9535***  WAS CONVERTED TO 1056 BYTES.             ***
  9536*************************************************
  9537     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9538     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9539
  9540     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9541
  9542     MOVE CR-STATE               TO STATE-L.
  9543
  9544     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9545
  9546     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9547
  9548***************************************************
  9549***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9550***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9551***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9552***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9553***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9554***************************************************
  9555     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9556         IF CR-LF-POLICY-IS-RESTORE
  9557             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9558             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9559         ELSE
  9560         IF CR-LF-POLICY-IS-REISSUE
  9561             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9562             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9563         ELSE
  9564         IF CR-LF-IS-REIN-ONLY
  9565             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9566             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9567         ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 185
* ECS010.cbl
  9568         IF CR-LF-IS-DECLINED
  9569             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9570             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9571         ELSE
  9572         IF CR-LF-IS-VOID
  9573             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9574             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9575         ELSE
  9576         IF CR-LF-POLICY-IS-MONTHLY
  9577            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9578            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9579
  9580
  9581 0510-PROCESS-LIFE-ISSUE.
  9582
  9583     IF PB-INVALID-LIFE
  9584         GO TO 0520-PROCESS-A-H-ISSUE.
  9585
  9586     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9587     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9588     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9589
  9590     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9591     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9592     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9593     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9594     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9595     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9596
  9597     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9598     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9599     IF PB-I-LF-POLICY-FEE  NUMERIC
  9600         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9601     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9602     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9603
  9604     IF PB-I-LF-PREM-TAX NUMERIC
  9605        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9606     END-IF
  9607
  9608
  9609     IF PB-I-LF-REI-RATE NOT = ZEROS
  9610        IF DTE-CLIENT = 'DCC'
  9611           CONTINUE
  9612*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9613        ELSE
  9614           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9615           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9616                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9617        END-IF
  9618     END-IF
  9619
  9620     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9621         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9622         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9623         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9624         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9625         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 186
* ECS010.cbl
  9626             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9627                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9628
  9629     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9630     MOVE ' '                    TO  DC-OPTION-CODE.
  9631     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9632     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9633                                     WS-CR-LF-EXPIRE-DATE-N.
  9634
  9635     IF CR-ENTRY-STATUS = 'P'
  9636         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9637     ELSE
  9638         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9639
  9640     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9641     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9642     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9643     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9644     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9645
  9646     IF CR-LF-POLICY-IS-RESTORE
  9647         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9648     IF CR-LF-POLICY-IS-REISSUE
  9649         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9650     IF CR-LF-IS-REIN-ONLY
  9651         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9652
  9653     IF CR-LF-IS-DECLINED
  9654         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9655
  9656     IF CR-LF-IS-VOID
  9657         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9658     IF CR-LF-POLICY-IS-MONTHLY
  9659         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9660
  9661     ADD +1                      TO  W-LF-ISSUES.
  9662
  9663 0520-PROCESS-A-H-ISSUE.
  9664
  9665     IF PB-INVALID-AH
  9666         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9667
  9668     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9669     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9670     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9671
  9672     IF (NOT PB-I-JOINT-COVERAGE)
  9673        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9674        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9675        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9676     END-IF
  9677
  9678     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9679     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9680     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9681     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9682     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9683
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 187
* ECS010.cbl
  9684     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9685     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9686     IF PB-I-AH-POLICY-FEE  NUMERIC
  9687         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9688     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9689     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9690
  9691     IF PB-I-AH-PREM-TAX NUMERIC
  9692        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9693     END-IF
  9694
  9695     IF PB-I-AH-REI-RATE NOT = ZEROS
  9696        IF DTE-CLIENT = 'DCC'
  9697           CONTINUE
  9698        ELSE
  9699           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9700           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9701             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9702        END-IF
  9703     END-IF
  9704
  9705     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9706        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9707           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9708           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9709        END-IF
  9710        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9711     END-IF
  9712     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9713     MOVE ' '                    TO  DC-OPTION-CODE.
  9714     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9715     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9716                                     WS-CR-AH-EXPIRE-DATE-N.
  9717
  9718     IF CR-ENTRY-STATUS = 'P'
  9719         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9720     ELSE
  9721         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9722
  9723     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9724     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9725     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9726     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9727     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9728
  9729     IF CR-AH-POLICY-IS-RESTORE
  9730         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9731     IF CR-AH-POLICY-IS-REISSUE
  9732         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9733     IF CR-AH-IS-REIN-ONLY
  9734         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9735
  9736     IF CR-AH-IS-DECLINED
  9737         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9738
  9739     IF CR-AH-IS-VOID
  9740         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9741     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 188
* ECS010.cbl
  9742         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9743
  9744     ADD +1                      TO  W-AH-ISSUES.
  9745
  9746 0530-PROCESS-ISSUE-CONTINUED.
  9747
  9748     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9749     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9750     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9751     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9752
  9753     IF (DTE-CLIENT = 'DCC')
  9754        AND (CR-AHTYP NOT = '00' AND '  ')
  9755        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9756        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9757           PERFORM 0920-GET-BANK-FEES
  9758                                 THRU 0920-EXIT
  9759           PERFORM 0930-BUILD-CERT-TRLR
  9760                                 THRU 0930-EXIT
  9761           PERFORM 0395-GET-CERT-TRLRS
  9762                                 THRU 0395-EXIT
  9763     END-IF
  9764
  9765     IF DTE-CLIENT = 'DCC'
  9766        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9767           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9768        END-IF
  9769        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9770           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9771              (CR-LFPRM + CR-LFPRM-ALT) -
  9772              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9773        END-IF
  9774     END-IF
  9775
  9776     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9777        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9778        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9779     ELSE
  9780        IF DTE-CLIENT = 'DCC'
  9781           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9782              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9783              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9784           END-IF
  9785           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9786              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9787              (CR-AHPRM * CR-LCOM-AH (1))
  9788           END-IF
  9789        END-IF
  9790     END-IF
  9791
  9792     IF DTE-CLIENT = 'DCC'
  9793         IF PB-I-VIN > SPACES
  9794             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9795         END-IF
  9796     END-IF.
  9797
  9798     IF CR-ENTRY-STATUS = 'P'
  9799         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 189
* ECS010.cbl
  9800
  9801     IF CR-POLICY-IS-REISSUE  OR
  9802        CR-POLICY-IS-REIN-ONLY OR
  9803        CR-POLICY-IS-DECLINED OR
  9804        CR-POLICY-IS-VOID
  9805        OR CR-POLICY-IS-MONTHLY
  9806         GO TO 0590-END-ISSUE-PROCESSING.
  9807
  9808     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9809     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9810        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9811     END-IF
  9812     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9813
  9814     IF NOT PB-INVALID-LIFE
  9815         COMPUTE H-LFCM ROUNDED =
  9816                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9817         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9818         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9819
  9820     IF NOT PB-INVALID-AH
  9821        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9822           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9823              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9824              + CR-ADDL-CLP)
  9825           ELSE
  9826              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9827              - CR-ADDL-CLP
  9828           END-IF
  9829        ELSE
  9830           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9831        END-IF
  9832        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9833        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9834     END-IF
  9835
  9836     ADD +1 TO BC-G-ISS.
  9837     ADD +1 TO BC-COMM.
  9838     ADD CR-LFPRM TO BC-NET-WRIT.
  9839     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9840        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9841     END-IF
  9842     ADD CR-AHPRM TO BC-NET-WRIT.
  9843
  9844     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9845        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9846        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9847     ELSE
  9848        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9849        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9850           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9851        END-IF
  9852     END-IF
  9853
  9854     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9855         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9856     ELSE
  9857         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 190
* ECS010.cbl
  9858
  9859 0590-END-ISSUE-PROCESSING.
  9860
  9861     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9862
  9863     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9864
  9865     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9866        NOT CR-POLICY-IS-DECLINED  AND
  9867        NOT CR-POLICY-IS-VOID
  9868         MOVE 'Y' TO BILLED-SWITCH
  9869         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9870         IF DTE-CLIENT = 'DCC'
  9871            move detail-extract  to new-detail-extract
  9872            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9873               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9874                  cr-addl-clp
  9875            end-if
  9876            write new-detail-extract
  9877         end-if
  9878
  9879     IF NOT CR-POLICY-IS-REISSUE  AND
  9880        NOT CR-POLICY-IS-DECLINED  AND
  9881        NOT CR-POLICY-IS-VOID
  9882        AND NOT CR-POLICY-IS-MONTHLY
  9883         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9884
  9885     MOVE '*'                   TO TRANSACTION-FLAG.
  9886     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 191
* ECS010.cbl
  9888******************************************************************
  9889***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9890******************************************************************
  9891
  9892 0600-PROCESS-CANCELLATIONS.
  9893
  9894*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9895     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9896
  9897     IF AM-RECALC-COMM = ('Y' OR '1')
  9898        PERFORM 1600-RECALC-COMM-EXTR
  9899                                 THRU 1899-RECALC-COMM-EXTR-X
  9900        MOVE ' '                 TO RECALC-TYPE
  9901     END-IF
  9902
  9903     MOVE CR-LFRFND               TO LIFE-REFUND.
  9904     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9905     MOVE CR-AHRFND               TO A-H-REFUND.
  9906     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9907     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9908
  9909     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9910     IF CR-LFRFND NOT = ZEROS
  9911        IF CR-LFRFND-CALC = ZEROS
  9912           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9913                                    LIFE-REFUND-CALC
  9914        ELSE
  9915           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9916        END-IF
  9917     END-IF
  9918
  9919     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9920
  9921     IF CR-AHRFND-CALC = ZEROS
  9922        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9923                                    A-H-REFUND-CALC
  9924     ELSE
  9925        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9926     END-IF
  9927
  9928     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9929        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9930     ELSE
  9931        MOVE SPACES              TO CR-POST-CARD-IND
  9932     END-IF
  9933
  9934*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9935*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9936*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9937*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9938
  9939     IF PB-C-NH-INT-ON-REFS NUMERIC
  9940        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9941        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9942     END-IF
  9943     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9944
  9945     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 192
* ECS010.cbl
  9946        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9947
  9948     IF PB-CI-MUNI-TAX NOT NUMERIC
  9949        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9950
  9951     IF CR-CANCEL-STATE-TAX NUMERIC
  9952         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9953       ELSE
  9954         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9955
  9956     IF CR-CANCEL-MUNI-TAX NUMERIC
  9957         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9958       ELSE
  9959         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9960
  9961     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9962                                    MONTHS-DIFF-AH.
  9963
  9964     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9965
  9966 0630-PROCESS-LIFE-CANCEL.
  9967
  9968     IF CR-LFTYP = ZERO  OR
  9969        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9970         MOVE ZEROS               TO H-LFCM
  9971         GO TO 0650-PROCESS-A-H-CANCEL.
  9972
  9973     IF CR-LFRFND = +0
  9974        AND CR-DTHAMT > ZEROS
  9975        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
  9976        MOVE ZEROS               TO H-LFCM
  9977        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
  9978        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
  9979        GO TO 0650-PROCESS-A-H-CANCEL
  9980     END-IF
  9981
  9982     IF DTE-CLIENT = 'DCC'
  9983        IF PB-C-LF-RFND-CLP NUMERIC
  9984           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
  9985        END-IF
  9986     END-IF
  9987
  9988     IF PB-C-LF-PREM-TAX NUMERIC
  9989        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9990     END-IF
  9991     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9992     MOVE ' '                     TO  DC-OPTION-CODE.
  9993     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9994     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9995                                      WS-CR-LF-CANC-DT-N.
  9996
  9997
  9998     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9999     MOVE ' '                    TO DC-OPTION-CODE
 10000     PERFORM 8000-DATE-CONVERT-ROUTINE
 10001                                 THRU 8099-DATE-CONVERT-X
 10002     IF CR-LF-CNC-ENT-DT NOT NUMERIC
 10003        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 193
* ECS010.cbl
 10004     END-IF
 10005     IF NO-CONVERSION-ERROR
 10006        IF CR-LF-CNC-ENT-DT = ZEROS
 10007           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
 10008        END-IF
 10009     END-IF
 10010
 10011     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10012     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
 10013     MOVE '1'                     TO  DC-OPTION-CODE.
 10014     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10015     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10016                                      DC-ODD-DAYS-OVER
 10017                                      DC-ELAPSED-DAYS.
 10018     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10019     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 10020
 10021     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 10022         ADD  +1                  TO  MONTHS-DIFF-LF.
 10023
 10024     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10025
 10026     MOVE  ZEROS                  TO  SUB.
 10027
 10028 0635-LIFE-CHARGEBACK-LOOP.
 10029
 10030     ADD    +1                    TO  SUB.
 10031
 10032     IF  SUB  GREATER THAN  +10
 10033         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10034
 10035*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10036*** WE FULLY EARN THE FEE
 10037     IF CR-CANCEL-REASON = 'R'
 10038        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10039           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10040           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10041           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10042        END-IF
 10043     END-IF
 10044
 10045     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10046         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10047         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10048
 10049     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10050         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10051
 10052     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10053         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10054
 10055     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10056
 10057
 10058 0640-CONTINUE-LIFE-CANCEL.
 10059
 10060     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10061        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 194
* ECS010.cbl
 10062
 10063     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10064
 10065     IF DTE-CLIENT = 'GIC'
 10066         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10067             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10068                                     LIFE-REFUND-CALC.
 10069
 10070*    IF DTE-CLIENT = 'TMS'
 10071     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10072
 10073     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10074         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10075     ELSE
 10076         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10077             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10078             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10079             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10080             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10081                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10082         ELSE
 10083             IF CR-LF-CURRENT-STATUS = '6'
 10084                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10085                 MOVE PB-C-LF-COMM-CHARGEBACK
 10086                                       TO CR-LF-COMM-CHARGEBACK
 10087                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10088                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10089
 10090*************************************************
 10091***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10092***  WAS CONVERTED TO 1056 BYTES.             ***
 10093*************************************************
 10094     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10095
 10096     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10097     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10098     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10099
 10100     COMPUTE H-LFCM ROUNDED =
 10101                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10102     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10103
 10104     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10105     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10106     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10107     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10108
 10109     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10110     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10111
 10112 0650-PROCESS-A-H-CANCEL.
 10113
 10114     IF CR-AHTYP = ZERO  OR
 10115        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10116         MOVE ZEROS               TO H-AHCM
 10117         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10118
 10119*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 195
* ECS010.cbl
 10120*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10121*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10122*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10123
 10124     IF DTE-CLIENT = 'DCC'
 10125        IF PB-C-AH-RFND-CLP NUMERIC
 10126           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10127        END-IF
 10128     END-IF
 10129
 10130     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10131     MOVE ' '                     TO  DC-OPTION-CODE.
 10132     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10133     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10134                                      WS-CR-AH-CANC-DT-N.
 10135
 10136     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10137     MOVE ' '                    TO DC-OPTION-CODE
 10138     PERFORM 8000-DATE-CONVERT-ROUTINE
 10139                                 THRU 8099-DATE-CONVERT-X
 10140     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10141        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10142     END-IF
 10143     IF NO-CONVERSION-ERROR
 10144        IF CR-AH-CNC-ENT-DT = ZEROS
 10145           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10146        END-IF
 10147     END-IF
 10148
 10149     IF PB-C-AH-PREM-TAX NUMERIC
 10150        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10151     END-IF
 10152     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10153     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10154     MOVE '1'                     TO  DC-OPTION-CODE.
 10155     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10156     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10157                                      DC-ODD-DAYS-OVER
 10158                                      DC-ELAPSED-DAYS.
 10159     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10160     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10161
 10162     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10163          ADD  +1                 TO  MONTHS-DIFF-AH.
 10164
 10165     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10166                                      WS-DCC-DDF-CB-LEVELS
 10167     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10168        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10169     END-IF
 10170*    IF DTE-CLIENT = 'DCC'
 10171*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10172*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10173*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10174*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10175*             OR (SUB > +10)
 10176*          END-PERFORM
 10177*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 196
* ECS010.cbl
 10178*             MOVE CR-BANK-NOCHRGB-MONTHS
 10179*                                TO AM-COMM-CHARGEBACK (SUB)
 10180*          END-IF
 10181*       END-IF
 10182*    END-IF
 10183
 10184
 10185     MOVE 'Y'                     TO WS-FIRST-K
 10186     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10187     MOVE  ZEROS                  TO  SUB.
 10188
 10189 0653-A-H-CHARGEBACK-LOOP.
 10190
 10191     ADD    +1                    TO  SUB.
 10192
 10193     IF  SUB  GREATER THAN  +10
 10194         GO TO  0655-CONTINUE-A-H-CANCEL.
 10195
 10196     IF CR-CANCEL-REASON = 'R'
 10197        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10198           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10199              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10200              GO TO  0653-A-H-CHARGEBACK-LOOP
 10201           END-IF
 10202           IF AM-COM-TYP (SUB) = 'J'
 10203              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10204              GO TO  0653-A-H-CHARGEBACK-LOOP
 10205           END-IF
 10206        END-IF
 10207     END-IF
 10208
 10209     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10210         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10211         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10212
 10213     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10214         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10215
 10216     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10217         OR ((DTE-CLIENT = 'DCC')
 10218             AND (CR-AHRFND = ZEROS))
 10219         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10220
 10221     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10222
 10223
 10224 0655-CONTINUE-A-H-CANCEL.
 10225
 10226     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10227        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10228
 10229     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10230
 10231     IF DTE-CLIENT = 'GIC'
 10232         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10233             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10234                                     A-H-REFUND-CALC.
 10235
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 197
* ECS010.cbl
 10236*    IF DTE-CLIENT = 'TMS'
 10237     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10238*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10239
 10240
 10241     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10242         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10243     ELSE
 10244         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10245             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10246             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10247             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10248             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10249                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10250         ELSE
 10251             IF CR-AH-CURRENT-STATUS = '7'
 10252                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10253                 MOVE PB-C-AH-COMM-CHARGEBACK
 10254                                       TO CR-AH-COMM-CHARGEBACK
 10255                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10256                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10257
 10258*************************************************
 10259***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10260***  WAS CONVERTED TO 1056 BYTES.             ***
 10261*************************************************
 10262     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10263
 10264     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10265     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10266     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10267
 10268     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10269        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10270        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10271           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10272           MOVE CNC-FACT TO UECLP-CLP-FACT
 10273        END-IF
 10274        IF CR-CANCEL-REASON = 'R'
 10275           MOVE +1               TO CNC-FACT
 10276        END-IF
 10277        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10278           (CR-AHPRM - (CR-LFPRM-ALT
 10279           + CR-ADDL-CLP)) * -1
 10280     ELSE
 10281        COMPUTE H-AHCM ROUNDED =
 10282          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10283     END-IF
 10284
 10285     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10286
 10287     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10288     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10289     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10290     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10291
 10292     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10293     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 198
* ECS010.cbl
 10294
 10295 0660-PROCESS-CANCEL-CONTINUE.
 10296
 10297     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10298
 10299     IF CR-POLICY-IS-REIN-ONLY
 10300        GO TO 0660-CONT.
 10301
 10302     MOVE 'Y'                    TO BILLED-SWITCH.
 10303     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10304
 10305     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10306     if dte-client = 'DCC'
 10307        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10308     end-if
 10309
 10310     IF CR-POLICY-IS-MONTHLY
 10311        GO TO 0660-CONT
 10312     END-IF
 10313
 10314     ADD +1                      TO BC-G-CNC.
 10315     ADD +1                      TO BC-COMM.
 10316     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10317     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10318     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10319     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10320     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10321     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10322
 10323     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10324         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10325     ELSE
 10326         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10327
 10328     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10329         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10330     ELSE
 10331         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10332
 10333
 10334 0660-CONT.
 10335
 10336     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10337     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10338
 10339     IF CR-LFRFND NEGATIVE
 10340       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10341           MOVE '*'                 TO REIN-VOID-LF-SW.
 10342     IF CR-AHRFND NEGATIVE
 10343       IF CR-AHRFND + A-H-REFUND = ZEROS
 10344           MOVE '*'                 TO REIN-VOID-AH-SW.
 10345
 10346     IF CR-LFRFND NOT = ZEROS
 10347       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10348           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10349     IF CR-AHRFND NOT = ZEROS
 10350       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10351           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 199
* ECS010.cbl
 10352
 10353     IF CR-DT = CR-LF-CANC-DT
 10354       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10355     IF CR-DT = CR-AH-CANC-DT
 10356       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10357
 10358     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10359
 10360     MOVE SPACES                    TO REIN-VOID-LF-SW
 10361                                       REIN-VOID-AH-SW
 10362                                       REIN-ADDL-LF-SW
 10363                                       REIN-ADDL-AH-SW.
 10364
 10365     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10366     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10367
 10368     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10369     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10370
 10371     IF (CR-LFTYP NOT = ZERO  AND
 10372        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10373        (CR-AHTYP NOT = ZERO  AND
 10374        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10375         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10376         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10377
 10378 0670-LIFE-CANCEL-VOID.
 10379
 10380     IF CR-LFTYP NOT = ZERO  AND
 10381        CR-LFRFND = ZERO  AND
 10382        PB-C-LF-CANCEL-AMT NEGATIVE
 10383         NEXT SENTENCE
 10384     ELSE
 10385         GO TO 0680-A-H-CANCEL-VOID.
 10386
 10387     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10388                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10389                                          CR-LF-CANC-DT
 10390                                          WS-CR-LF-CANC-DT-N
 10391                                          CR-LFRFND-CALC.
 10392
 10393     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10394
 10395     IF CR-LF-CANCEL-APPLIED
 10396         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10397         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10398     ELSE
 10399         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10400         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10401
 10402     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10403
 10404     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10405     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10406
 10407     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10408
 10409 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 200
* ECS010.cbl
 10410
 10411     IF CR-AHTYP NOT = ZERO  AND
 10412        CR-AHRFND = ZERO  AND
 10413        PB-C-AH-CANCEL-AMT NEGATIVE
 10414         NEXT SENTENCE
 10415     ELSE
 10416         GO TO 0690-END-CANCEL-PROCESSING.
 10417
 10418     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10419                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10420                                        CR-AH-CANC-DT
 10421                                        WS-CR-AH-CANC-DT-N
 10422                                        CR-AHRFND-CALC.
 10423
 10424     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10425
 10426     IF CR-AH-CANCEL-APPLIED
 10427         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10428         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10429     ELSE
 10430         MOVE CR-AH-STATUS-AT-CANCEL
 10431                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10432         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10433
 10434     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10435
 10436     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10437     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10438
 10439     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10440
 10441 0690-END-CANCEL-PROCESSING.
 10442
 10443     IF CR-LF-CANC-DT = ZEROS  AND
 10444        CR-AH-CANC-DT = ZEROS
 10445         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10446     END-IF
 10447
 10448     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10449         NEXT SENTENCE
 10450     ELSE
 10451         MOVE 'X'               TO REIN-RT-SW
 10452         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10453         MOVE ' '               TO REIN-RT-SW.
 10454
 10455     MOVE '*'                   TO TRANSACTION-FLAG.
 10456     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10457
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 201
* ECS010.cbl
 10459******************************************************************
 10460***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10461******************************************************************
 10462
 10463 0700-PROCESS-CLAIMS.
 10464
 10465     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10466        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10467         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10468             PENDING-MATCH-CONTROL
 10469         MOVE 0301 TO WS-ABEND-CODE
 10470         DISPLAY '******************************'
 10471         DISPLAY '***** ERROR LOCATION 011 *****'
 10472         DISPLAY '******************************'
 10473         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10474         GO TO ABEND-PGM.
 10475
 10476     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10477
 10478     ADD +1                       TO  W-LF-CLAIMS.
 10479
 10480     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10481     MOVE ' '                     TO  DC-OPTION-CODE.
 10482     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10483     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10484
 10485     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10486     MOVE ' '                     TO  DC-OPTION-CODE.
 10487     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10488     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10489
 10490     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10491     MOVE ' '                     TO  DC-OPTION-CODE.
 10492     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10493     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10494
 10495     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10496     MOVE ' '                     TO  DC-OPTION-CODE.
 10497     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10498     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10499
 10500     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10501
 10502**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10503****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10504****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10505****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10506****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10507****     ELSE
 10508****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10509
 10510     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10511         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10512
 10513******************************************************************
 10514***           P R O C E S S   D E A T H   C L A I M            ***
 10515******************************************************************
 10516
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 202
* ECS010.cbl
 10517     IF REIN-IS-RISK-PREMIUM
 10518       IF CR-DTH-DT = ZEROS
 10519           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10520           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10521           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10522
 10523     MOVE INCURRED-DATE            TO CR-DTH-DT
 10524                                      WS-CR-DTH-DT-N.
 10525
 10526     IF PC-CHARGEBLE-EXPENSE  OR
 10527        PC-NON-CHARGEBLE-EXPENSE
 10528         IF CR-LFTYP = '00'
 10529             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10530             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10531                     8399-LIFE-LOOKUP-X.
 10532
 10533     IF PC-CHARGEBLE-EXPENSE  OR
 10534        PC-NON-CHARGEBLE-EXPENSE
 10535         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10536         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10537         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10538         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10539         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10540         GO TO 0780-END-CLAIMS-PROCESSING.
 10541
 10542     ADD +1                       TO  CR-NUM-DTH-CLM.
 10543     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10544     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10545                                      WS-CR-DTH-PAY-DT-N.
 10546
 10547     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10548     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10549     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10550     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10551     IF CR-DTH-PAY-CD NOT = 'F'
 10552         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10553     INSPECT CR-DTH-PAY-CD
 10554         CONVERTING '12349' TO 'PFSXV'.
 10555     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10556
 10557     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10558         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10559       AND
 10560       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10561       OR
 10562        DTE-CLIENT = 'ACC' OR 'FDL')
 10563        NEXT SENTENCE
 10564     ELSE
 10565     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10566         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10567             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10568             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10569             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10570                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10571
 10572     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10573     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10574     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 203
* ECS010.cbl
 10575     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10576         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10577     ELSE
 10578         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10579     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10580
 10581     IF NOT CR-POLICY-IS-REIN-ONLY
 10582         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10583
 10584 0720-CANCEL-AH-COVERAGE.
 10585
 10586     IF CR-AHTYP = ZEROS  OR
 10587        NOT CR-AH-POLICY-IS-ACTIVE
 10588         GO TO 0740-DEATH-CLAIM-VOID.
 10589
 10590     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10591     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10592     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10593                                           WS-CR-AH-CANC-DT-N.
 10594     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10595                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10596
 10597     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10598     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10599     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10600     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10601     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10602     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10603     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10604     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10605
 10606 0740-DEATH-CLAIM-VOID.
 10607
 10608     IF CR-DTHAMT = ZERO  AND
 10609        PC-CLAIM-PAYMENT NEGATIVE
 10610         NEXT SENTENCE
 10611     ELSE
 10612         GO TO 0780-END-CLAIMS-PROCESSING.
 10613
 10614     MOVE '*'                           TO DEATH-VOID-FLAG.
 10615
 10616     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10617                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10618                                           CR-NUM-DTH-CLM
 10619                                           CR-DTH-RPT-DT
 10620                                           CR-DTH-PAY-DT
 10621                                           WS-CR-DTH-PAY-DT-N
 10622*                                          CR-DTHAMT-YTD
 10623*                                          CR-DTHAMT-LAST
 10624                                           CR-DTH-AGE.
 10625     MOVE ' '                           TO CR-DTH-PAY-CD.
 10626
 10627     IF CR-LF-DEATH-CLAIM-APPLIED
 10628         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10629         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10630     ELSE
 10631         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10632         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 204
* ECS010.cbl
 10633
 10634     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10635     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10636
 10637     IF CR-AH-DEATH-CLAIM-APPLIED
 10638         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10639         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10640         MOVE ZEROS                     TO CR-AH-CANC-DT
 10641                                           WS-CR-AH-CANC-DT-N
 10642                                           CR-AH-CANCEL-EXIT-DATE
 10643                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10644         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10645         MOVE CR-AH-TERM                TO TRD-AHTRM
 10646         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10647         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10648
 10649     GO TO 0780-END-CLAIMS-PROCESSING.
 10650
 10651******************************************************************
 10652***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10653******************************************************************
 10654
 10655 0750-PROCESS-DISABILITY-CLAIM.
 10656
 10657     ADD +1                       TO W-AH-CLAIMS.
 10658
 10659     MOVE INCURRED-DATE           TO CR-DIS-DT
 10660                                     WS-CR-DIS-DT-N.
 10661
 10662     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10663
 10664     IF REIN-AH-CLM-MONTHS = +1
 10665         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10666     ELSE
 10667       IF REIN-AH-CLM-MONTHS = +2
 10668           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10669       ELSE
 10670         IF REIN-AH-CLM-MONTHS = +3
 10671             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10672         ELSE
 10673           IF REIN-AH-CLM-MONTHS = +4
 10674               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10675           ELSE
 10676               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10677
 10678     IF PC-CHARGEBLE-EXPENSE  OR
 10679        PC-NON-CHARGEBLE-EXPENSE
 10680         IF CR-AHTYP = '00'
 10681             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10682             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10683                     8499-A-H-LOOKUP-X.
 10684
 10685     IF PC-CHARGEBLE-EXPENSE  OR
 10686        PC-NON-CHARGEBLE-EXPENSE
 10687         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10688         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10689         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10690         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 205
* ECS010.cbl
 10691         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10692         GO TO 0780-END-CLAIMS-PROCESSING.
 10693
 10694     ADD +1                       TO CR-NUM-DIS-CLM.
 10695
 10696     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10697     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10698                                      WS-CR-DIS-PAY-DT-N.
 10699     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10700                                      WS-CR-DIS-PTO-DT-N.
 10701
 10702     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10703     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10704     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10705
 10706     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10707     IF CR-DIS-PAY-CD NOT = 'S'
 10708         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10709     INSPECT CR-DIS-PAY-CD
 10710         CONVERTING '12349' TO 'PFSXV'.
 10711     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10712
 10713     IF PC-LUMP-SUM-PAYMENT
 10714         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10715           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10716           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10717           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10718                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10719
 10720     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10721     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10722     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10723     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10724     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10725
 10726     IF NOT CR-POLICY-IS-REIN-ONLY
 10727         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10728
 10729     IF NOT PC-LUMP-SUM-PAYMENT
 10730         GO TO 0780-END-CLAIMS-PROCESSING.
 10731
 10732 0770-CANCEL-LF-COVERAGE.
 10733
 10734     IF CR-LFTYP = ZEROS  OR
 10735        NOT CR-LF-POLICY-IS-ACTIVE
 10736         GO TO 0780-END-CLAIMS-PROCESSING.
 10737
 10738     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10739     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10740     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10741                                           WS-CR-LF-CANC-DT-N.
 10742     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10743                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10744
 10745     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10746     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10747     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10748     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 206
* ECS010.cbl
 10749     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10750     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10751     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10752     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10753
 10754 0780-END-CLAIMS-PROCESSING.
 10755
 10756     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10757         MOVE DTO-MO               TO TRD-LFACTMO
 10758         MOVE DTO-DA               TO TRD-LFACTDA
 10759         MOVE DTO-YR               TO TRD-LFACTYR
 10760         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10761     ELSE
 10762         MOVE PAY-MO               TO TRD-AHACTMO
 10763         MOVE PAY-DA               TO TRD-AHACTDA
 10764         MOVE PAY-YR               TO TRD-AHACTYR
 10765         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10766
 10767     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10768
 10769     IF NOT CR-POLICY-IS-REIN-ONLY
 10770         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10771         ADD +1                    TO BC-G-CLM.
 10772
 10773     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10774
 10775     IF DEATH-CLAIM-VOIDED
 10776         MOVE ZEROS                TO CR-DTH-DT
 10777                                      WS-CR-DTH-DT-N.
 10778     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10779
 10780     MOVE '*'                      TO TRANSACTION-FLAG.
 10781     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10782
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 207
* ECS010.cbl
 10784 0790-TABLE-DISAB-PERIODS.
 10785
 10786     MOVE +1                       TO SUB14.
 10787     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10788
 10789     MOVE +1                       TO SUB14.
 10790
 10791**************************************************************
 10792**                                                          **
 10793**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10794**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10795**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10796**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10797**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10798**                                                          **
 10799**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10800**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10801**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10802**                                                          **
 10803**************************************************************
 10804
 10805 0791-TABLE-AH-AMOUNT.
 10806
 10807     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10808         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10809
 10810     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10811         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10812                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10813         IF REIN-IS-RISK-PREMIUM
 10814             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10815             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10816             IF SUB14 = +1
 10817               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10818             ELSE
 10819             IF SUB14 = +2
 10820               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10821             ELSE
 10822             IF SUB14 = +3
 10823               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10824             ELSE
 10825             IF SUB14 = +4
 10826               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10827             ELSE
 10828               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10829
 10830
 10831     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10832         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10833         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10834                                        +  CR-INCUR-DISEXP (SUB14)
 10835         IF PC-CHARGEBLE-EXPENSE  OR
 10836            PC-NON-CHARGEBLE-EXPENSE
 10837             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10838             GO TO 0791-TABLE-AH-EXIT
 10839         ELSE
 10840             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10841             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 208
* ECS010.cbl
 10842
 10843     ADD +1                       TO SUB14.
 10844
 10845     GO TO 0791-TABLE-AH-AMOUNT.
 10846
 10847 0791-TABLE-AH-EXIT.
 10848     EXIT.
 10849
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 209
* ECS010.cbl
 10851**************************************************************
 10852**                                                          **
 10853** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10854** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10855**                                                          **
 10856** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10857** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10858** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10859** OCCURRENCE.                                              **
 10860**************************************************************
 10861 0792-MOVE-TABLE.
 10862
 10863     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10864                                  WS-CR-DIS-INCUR-DT-N (1).
 10865     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10866     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10867
 10868     MOVE +2                   TO SUB14.
 10869     MOVE +3                   TO SUB15.
 10870     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10871
 10872     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10873
 10874     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10875                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10876
 10877 0792-MOVE-TABLE-EXIT.
 10878     EXIT.
 10879
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 210
* ECS010.cbl
 10881**************************************************************
 10882**                                                          **
 10883**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10884** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10885** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10886** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10887** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10888**************************************************************
 10889
 10890 0794-REVIEW-TABLE.
 10891
 10892     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10893         GO TO 0794-REVIEW-TABLE-EXIT.
 10894
 10895     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10896         GO TO 0794-REVIEW-TABLE-EXIT.
 10897
 10898     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10899        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10900         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10901         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10902                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10903         MOVE SUB14            TO SUB15
 10904         ADD +1                TO SUB15
 10905         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10906         MOVE +1               TO SUB14
 10907         GO TO 0794-REVIEW-TABLE.
 10908
 10909     ADD +1                    TO SUB14.
 10910
 10911     GO TO 0794-REVIEW-TABLE.
 10912
 10913 0794-REVIEW-TABLE-EXIT.
 10914     EXIT.
 10915
 10916 0794A-BUMP-TBL.
 10917
 10918     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10919         GO TO 0794A-BUMP-TBL-EXIT.
 10920
 10921     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10922                             CR-DISAB-DETAIL-DATA (SUB14).
 10923     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 10924                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 10925
 10926     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10927                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10928                                  CR-INCUR-DISAMT (SUB15)
 10929                                  CR-INCUR-DISEXP (SUB15).
 10930
 10931     ADD +1                    TO SUB14
 10932                                  SUB15.
 10933     GO TO 0794A-BUMP-TBL.
 10934
 10935 0794A-BUMP-TBL-EXIT.
 10936     EXIT.
 10937
 10938 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 211
* ECS010.cbl
 10939
 10940     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 10941     MOVE 'L'                        TO DC-OPTION-CODE.
 10942     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10943     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10944     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10945     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10946     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10947     MOVE CR-APR                     TO CP-LOAN-APR.
 10948     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10949     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10950     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10951     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10952
 10953     MOVE '3'                        TO CP-PROCESS-TYPE.
 10954     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10955     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10956
 10957     IF CR-LFTYP = ZERO
 10958         GO TO 0795-EXIT
 10959     END-IF
 10960
 10961     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10962         GO TO 0795-EXIT
 10963     END-IF
 10964     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10965     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10966     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10967     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10968                                        CP-RATING-BENEFIT-AMT.
 10969     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10970     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10971     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10972     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10973     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10974     MOVE CR-STATE                   TO CP-STATE.
 10975     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10976
 10977     IF CP-STATE-STD-ABBRV = 'OR'
 10978         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10979
 10980     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10981
 10982     IF CP-ERROR-RATE-NOT-FOUND  OR
 10983        CP-ERROR-RATE-IS-ZERO
 10984         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10985                                     TO WS-ABEND-MESSAGE
 10986         MOVE 0302                   TO WS-ABEND-CODE
 10987         DISPLAY '******************************'
 10988         DISPLAY '***** ERROR LOCATION 018 *****'
 10989         DISPLAY '******************************'
 10990         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10991         GO TO ABEND-PGM.
 10992
 10993     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10994
 10995*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10996*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 212
* ECS010.cbl
 10997
 10998     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 10999                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 11000
 11001     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 11002
 11003 0795-exit.
 11004     exit.
 11005
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 213
* ECS010.cbl
 11007******************************************************************
 11008***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 11009******************************************************************
 11010
 11011 0800-PROCESS-RESERVES.
 11012
 11013     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 11014       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 11015           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 11016
 11017     if (dte-client = 'AHL')
 11018        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 11019        and (cr-ahtyp (1:1) = 'M')
 11020        and ((pc-future-reserve-amt > zeros)
 11021            or (pc-ptc-reserve-amt > zeros))
 11022        compute pc-ibnr-reserve-amt =
 11023           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 11024        display ' using 205 of ptc and future ' cr-cert-no
 11025     end-if
 11026
 11027     if (dte-client = 'AHL')
 11028        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11029        and (cr-lftyp (1:1) = 'M')
 11030        and (pc-ptc-reserve-amt > zeros)
 11031        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11032        display ' using 217 of ptc ' cr-cert-no
 11033     end-if
 11034
 11035     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11036
 11037     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11038     MOVE ' '                     TO  DC-OPTION-CODE.
 11039     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11040     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11041
 11042     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11043     MOVE ' '                     TO  DC-OPTION-CODE.
 11044     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11045     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11046
 11047     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11048     MOVE ' '                     TO  DC-OPTION-CODE.
 11049     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11050     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11051
 11052     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11053
 11054     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11055         ADD +1                     TO W-LF-RESERVES
 11056         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11057         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11058         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11059         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11060         MOVE INCURRED-DATE         TO CR-DTH-DT
 11061                                       WS-CR-DTH-DT-N
 11062         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11063
 11064     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 214
* ECS010.cbl
 11065         ADD +1                     TO W-AH-RESERVES
 11066         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11067         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11068         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11069         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11070         MOVE INCURRED-DATE         TO CR-DIS-DT
 11071                                       WS-CR-DIS-DT-N
 11072         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11073
 11074     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11075     MOVE 'IBNR'                    TO TRD-IBNRX.
 11076     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11077     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11078     COMPUTE TRD-FUTRSV EQUAL
 11079            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11080     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11081     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11082
 11083 0820-END-RESERVE-PROCESSING.
 11084
 11085     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11086
 11087     IF NOT CR-POLICY-IS-REIN-ONLY
 11088         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11089                                            2499-BLD-RESERVE-X
 11090         ADD +1 TO BC-G-CRS.
 11091
 11092     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11093
 11094     MOVE '*'                    TO TRANSACTION-FLAG.
 11095     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11096
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 215
* ECS010.cbl
 11098******************************************************************
 11099***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11100******************************************************************
 11101
 11102 0900-PROCESS-CERT-CHANGES.
 11103
 11104     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11105
 11106     IF CC-AGE NOT NUMERIC  OR
 11107        CC-AGE = CR-AGE
 11108         MOVE ZEROS TO CC-AGE.
 11109
 11110     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11111        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11112         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11113
 11114     IF CC-INSURED-SEX NOT = 'M'  AND
 11115        CC-INSURED-SEX NOT = 'F'
 11116         MOVE SPACES TO CC-INSURED-SEX.
 11117
 11118     IF CC-LOAN-APR NOT NUMERIC  OR
 11119        CC-LOAN-APR = CR-APR
 11120         MOVE ZEROS TO CC-LOAN-APR.
 11121
 11122     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11123        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11124         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11125
 11126     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11127        CC-IND-GRP-TYPE NOT = '2'
 11128         MOVE SPACES TO CC-IND-GRP-TYPE.
 11129
 11130     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11131****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11132         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11133
 11134     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11135        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11136         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11137
 11138     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11139        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11140        CR-LFTYP = ZEROS
 11141         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11142
 11143     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11144        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11145        CR-AHTYP = ZEROS
 11146         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11147
 11148     IF CR-BILLED NOT NUMERIC
 11149         MOVE ZEROS TO CR-BILLED.
 11150
 11151     IF CR-LIVES NOT NUMERIC
 11152         MOVE ZEROS TO CR-LIVES.
 11153
 11154     IF CC-LIVES NOT NUMERIC  OR
 11155        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 216
* ECS010.cbl
 11156         MOVE ZEROS TO CC-LIVES.
 11157
 11158     IF CC-BILLED NOT NUMERIC  OR
 11159        CC-BILLED = CR-BILLED
 11160         MOVE ZEROS TO CC-BILLED.
 11161
 11162     IF CC-INSURED-LAST-NAME NOT = SPACES
 11163         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11164     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11165         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11166     IF CC-INSURED-INITIAL2 NOT = SPACES
 11167         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11168     IF CC-JT-LAST-NAME NOT = SPACES
 11169         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11170     IF CC-JT-FIRST-NAME NOT = SPACES
 11171         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11172     IF CC-JT-INITIAL NOT = SPACES
 11173         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11174
 11175     IF CC-AGE NOT = ZEROS
 11176         MOVE CC-AGE                 TO CR-AGE
 11177                                        DET-AGE
 11178     ELSE
 11179         MOVE ZEROS                  TO DET-AGE.
 11180
 11181     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11182         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11183                                        DET-JT-AGE
 11184     ELSE
 11185         MOVE ZEROS                  TO DET-JT-AGE.
 11186
 11187     IF CC-INSURED-SEX NOT = SPACES
 11188         MOVE CC-INSURED-SEX         TO CR-SEX
 11189                                        DET-SEX
 11190     ELSE
 11191         MOVE SPACE                  TO DET-SEX.
 11192
 11193     IF CC-MEMBER-NO NOT = SPACES
 11194         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11195                                        DET-PR-MEM
 11196     ELSE
 11197         MOVE SPACES                 TO DET-PR-MEM.
 11198
 11199     IF CC-SOC-SEC-NO NOT = SPACES
 11200         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11201                                        DET-PR-SS
 11202     ELSE
 11203         MOVE SPACES                 TO DET-PR-SS.
 11204
 11205     IF CC-LOAN-APR NOT = ZEROS
 11206         MOVE CC-LOAN-APR            TO CR-APR
 11207                                        DET-PR-APR
 11208     ELSE
 11209         MOVE ZEROS                  TO DET-PR-APR.
 11210
 11211     IF CC-AGE NOT = ZERO  OR
 11212        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11213        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 217
* ECS010.cbl
 11214        CC-MEMBER-NO NOT = SPACES  OR
 11215        CC-SOC-SEC-NO NOT = SPACES  OR
 11216        CC-LOAN-APR NOT = ZERO
 11217         MOVE DET-PR-UREC            TO TR-DTL2
 11218         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11219         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11220
 11221     IF CC-LF-ORIG-TERM NOT = ZEROS
 11222         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11223         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11224                                        DET-N-LF-TERM
 11225     ELSE
 11226         MOVE ZEROS                  TO DET-O-LF-TERM
 11227                                        DET-N-LF-TERM.
 11228
 11229     IF CC-AH-ORIG-TERM NOT = ZEROS
 11230         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11231         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11232                                        DET-N-AH-TERM
 11233     ELSE
 11234         MOVE ZEROS                  TO DET-O-AH-TERM
 11235                                        DET-N-AH-TERM.
 11236
 11237     IF CC-LIVES NOT = ZEROS
 11238         MOVE CR-LIVES               TO DET-O-LIVES
 11239         MOVE CC-LIVES               TO CR-LIVES
 11240                                        DET-N-LIVES
 11241     ELSE
 11242         MOVE ZEROS                  TO DET-O-LIVES
 11243                                        DET-N-LIVES.
 11244
 11245     IF CC-BILLED NOT  = ZEROES
 11246         MOVE CC-BILLED              TO CR-BILLED.
 11247
 11248     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11249        CC-AH-ORIG-TERM NOT = ZERO  OR
 11250        CC-LIVES NOT = ZERO
 11251         MOVE DET-PR-UREC-2          TO TR-DTL2
 11252         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11253         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11254
 11255     IF CC-IND-GRP-TYPE NOT = SPACES
 11256         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11257                                        DET-IND-GRP
 11258     ELSE
 11259         MOVE SPACE                  TO DET-IND-GRP.
 11260
 11261     IF CC-PAY-FREQUENCY NOT = ZEROS
 11262         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11263                                        DET-PMT-FREQ
 11264     ELSE
 11265         MOVE ZEROS                  TO DET-PMT-FREQ.
 11266
 11267     IF CC-POLICY-FORM-NO NOT = SPACES
 11268         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11269                                        DET-POL-FORM
 11270     ELSE
 11271         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 218
* ECS010.cbl
 11272
 11273     IF CC-LOAN-OFFICER NOT = SPACES
 11274         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11275                                        DET-LOAN-OFFICER
 11276     ELSE
 11277         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11278
 11279     IF CC-USER-FIELD NOT = SPACES
 11280         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11281                                        DET-USER-CODE
 11282     ELSE
 11283         MOVE SPACE                  TO DET-USER-CODE.
 11284
 11285     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11286        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11287        CC-POLICY-FORM-NO NOT = SPACES  OR
 11288        CC-LOAN-OFFICER NOT = SPACES  OR
 11289        CC-USER-FIELD NOT = SPACES
 11290         MOVE DET-PR-UREC-3          TO TR-DTL2
 11291         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11292         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11293
 11294**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11295****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11296****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11297****                                    DET-CLM-DEDUCT
 11298**** ELSE
 11299****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11300
 11301     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11302         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11303                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11304                                        DET-CAN-DEDUCT
 11305     ELSE
 11306         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11307
 11308**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11309     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11310         MOVE DET-PR-UREC-4          TO TR-DTL2
 11311         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11312         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11313
 11314     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11315         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11316
 11317     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11318         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11319
 11320     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11321         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11322
 11323     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11324         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11325
 11326     IF CC-LF-BENEFIT-CD NOT = SPACES
 11327         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11328                                     DET-LF-BEN-CD
 11329     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 219
* ECS010.cbl
 11330         MOVE SPACES             TO DET-LF-BEN-CD.
 11331
 11332     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11333         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11334                                     DET-LF-PREM
 11335     ELSE
 11336         MOVE ZEROS              TO DET-LF-PREM.
 11337
 11338     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11339         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11340                                     DET-LF-BEN
 11341     ELSE
 11342         MOVE ZEROS              TO DET-LF-BEN.
 11343
 11344     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11345        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11346        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11347         MOVE DET-PR-UREC-5          TO TR-DTL2
 11348         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11349         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11350
 11351     IF CC-AH-BENEFIT-CD NOT = SPACES
 11352         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11353                                     DET-AH-BEN-CD
 11354     ELSE
 11355         MOVE SPACES             TO DET-AH-BEN-CD.
 11356
 11357     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11358         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11359                                     DET-AH-PREM
 11360     ELSE
 11361         MOVE ZEROS              TO DET-AH-PREM.
 11362
 11363     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11364         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11365                                     DET-AH-BEN
 11366     ELSE
 11367         MOVE ZEROS              TO DET-AH-BEN.
 11368
 11369     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11370        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11371        CC-AH-BENEFIT-AMT NOT = ZEROS
 11372         MOVE DET-PR-UREC-6          TO TR-DTL2
 11373         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11374         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11375
 11376 0910-END-CHANGE-PROCESSING.
 11377
 11378     IF CR-LNAME = ALL '*'
 11379         MOVE SPACES                 TO CR-LNAME.
 11380     IF CR-FNAME = ALL '*'
 11381         MOVE SPACES                 TO CR-FNAME.
 11382     IF CR-INIT = '*'
 11383         MOVE SPACES                 TO CR-INIT.
 11384     IF CR-SOC-SEC = ALL '*'
 11385         MOVE SPACES                 TO CR-SOC-SEC.
 11386     IF CR-JT-LNAME = ALL '*'
 11387         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 220
* ECS010.cbl
 11388     IF CR-JT-FNAME = ALL '*'
 11389         MOVE SPACES                 TO CR-JT-FNAME.
 11390     IF CR-JT-INIT = '*'
 11391         MOVE SPACES                 TO CR-JT-INIT.
 11392     IF CR-POLICY-FORM-NO = ALL '*'
 11393         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11394     IF CR-MEMBER-NO = ALL '*'
 11395         MOVE SPACES                 TO CR-MEMBER-NO.
 11396     IF CR-LOAN-OFFICER = ALL '*'
 11397         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11398     IF CR-USER-CODE = ALL '*'
 11399         MOVE SPACES                 TO CR-USER-CODE.
 11400
 11401     ADD +1 TO BC-G-CTN.
 11402     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 221
* ECS010.cbl
 11404 0920-GET-BANK-FEES.
 11405
 11406     IF CR-CERT-NO = '0008771354 '
 11407        DISPLAY ' MADE IT TO 0920 '
 11408     END-IF
 11409
 11410     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11411     MOVE CR-CARRIER             TO AG-CARRIER
 11412     MOVE CR-GROUPING            TO AG-GROUPING
 11413     MOVE CR-BANK-NO             TO AG-BANK
 11414     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11415     MOVE 'B'                    TO AG-TYPE
 11416
 11417*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11418*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11419*                                THRU 0925-EXIT
 11420*       GO TO 0920-EXIT
 11421*    END-IF
 11422
 11423     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11424
 11425     IF CR-CERT-NO = '0008771354 '
 11426        DISPLAY ' MADE IT AFTER START '
 11427     END-IF
 11428
 11429     .
 11430 0920-READ-ERAGTC.
 11431
 11432     IF ERAGTC-FILE-STATUS = '00'
 11433        READ ERAGTC NEXT RECORD
 11434     IF CR-CERT-NO = '0008771354 '
 11435        DISPLAY ' MADE ONE READ '
 11436     END-IF
 11437
 11438        IF ERAGTC-FILE-STATUS = '00'
 11439           IF (CR-CARRIER         = AG-CARRIER)
 11440              AND (CR-GROUPING    = AG-GROUPING)
 11441              AND (CR-BANK-NO     = AG-BANK)
 11442              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11443                 GO TO 0920-READ-ERAGTC
 11444              ELSE
 11445                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11446                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11447                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11448                                 THRU 0925-EXIT
 11449                    MOVE AG-CONTROL-PRIMARY
 11450                                 TO WS-PREV-BANK-COMM-KEY
 11451                    GO TO 0920-EXIT
 11452                 END-IF
 11453              END-IF
 11454           END-IF
 11455        END-IF
 11456     END-IF
 11457
 11458     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11459*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11460
 11461     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 222
* ECS010.cbl
 11462        AND (PB-I-BANK-FEE NOT = ZEROS)
 11463        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11464        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11465        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11466        MOVE ' '                 TO WS-BNK-RECALC (1)
 11467        MOVE +2                  TO IB
 11468     END-IF
 11469
 11470     .
 11471 0920-EXIT.
 11472     EXIT.
 11473
 11474 0925-BUILD-WORK-BNK-COMM.
 11475
 11476     IF CR-CERT-NO = '0008771354 '
 11477        DISPLAY ' MADE IT TO 0925 '
 11478     END-IF
 11479
 11480     MOVE +1                     TO IA IB
 11481
 11482*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11483*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11484*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11485*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11486*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11487*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11488*       ADD +1                   TO IB
 11489*    END-IF
 11490*    .
 11491*0925-BUILD-CONTINUE.
 11492
 11493     IF CR-CERT-NO = '00087735841'
 11494        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11495        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11496        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11497     END-IF
 11498
 11499*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11500     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11501        (IA > +10)
 11502        OR (IB > +10)
 11503        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11504           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11505           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11506*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11507           IF AG-SPP-FEES (IA) NOT NUMERIC
 11508              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11509           END-IF
 11510           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11511           MOVE AG-RECALC-LV-INDIC (IA)
 11512                                 TO WS-BNK-RECALC (IB)
 11513        ELSE
 11514           MOVE SPACES           TO WS-BNK-AGT (IB)
 11515                                    WS-BNK-TYPE (IB)
 11516                                    WS-BNK-RECALC (IB)
 11517           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11518        END-IF
 11519        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 223
* ECS010.cbl
 11520     END-PERFORM
 11521
 11522     .
 11523 0925-EXIT.
 11524     EXIT.
 11525
 11526 0930-BUILD-CERT-TRLR.
 11527
 11528     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11529     MOVE 'CS'                   TO CS-RECORD-ID
 11530     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11531     MOVE CR-CARRIER             TO CS-CARRIER
 11532     MOVE CR-GROUPING            TO CS-GROUPING
 11533     MOVE CR-STATE               TO CS-STATE
 11534     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11535     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11536     MOVE CR-CERT-NO             TO CS-CERT-NO
 11537     MOVE 'A'                    TO CS-TRAILER-TYPE
 11538
 11539     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11540
 11541     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11542        WRITE CERTIFICATE-TRAILERS
 11543        IF ELCRTT-FILE-STATUS = '00'
 11544           CONTINUE
 11545        ELSE
 11546           IF ELCRTT-FILE-STATUS = '22'
 11547              READ ELCRTT
 11548              IF ELCRTT-FILE-STATUS = '00'
 11549                 MOVE WS-BANK-COMMISSIONS
 11550                                 TO CS-BANK-COMMISSION-AREA
 11551                 REWRITE CERTIFICATE-TRAILERS
 11552                 IF ELCRTT-FILE-STATUS NOT = '00'
 11553                    DISPLAY ' BAD REWRITE ELCRTT '
 11554                                 ELCRTT-FILE-STATUS
 11555                    PERFORM ABEND-PGM
 11556                 END-IF
 11557              ELSE
 11558                 DISPLAY ' BAD READ    ELCRTT '
 11559                                  ELCRTT-FILE-STATUS
 11560                 PERFORM ABEND-PGM
 11561              END-IF
 11562           ELSE
 11563              DISPLAY ' BAD WRITE ELCRTT '
 11564                                 ELCRTT-FILE-STATUS
 11565              PERFORM ABEND-PGM
 11566           END-IF
 11567        END-IF
 11568     END-IF
 11569
 11570     .
 11571 0930-EXIT.
 11572     EXIT.
 11573
 11574 0950-BUILD-CERT-C-TRLR.
 11575
 11576     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11577     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 224
* ECS010.cbl
 11578     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11579     MOVE CR-CARRIER             TO CS-CARRIER.
 11580     MOVE CR-GROUPING            TO CS-GROUPING.
 11581     MOVE CR-STATE               TO CS-STATE.
 11582     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11583     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11584     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11585     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11586
 11587     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11588
 11589     WRITE CERTIFICATE-TRAILERS.
 11590     IF ELCRTT-FILE-STATUS = '00'
 11591        CONTINUE
 11592     ELSE
 11593        IF ELCRTT-FILE-STATUS = '22'
 11594           READ ELCRTT
 11595           IF ELCRTT-FILE-STATUS = '00'
 11596              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11597              REWRITE CERTIFICATE-TRAILERS
 11598              IF ELCRTT-FILE-STATUS NOT = '00'
 11599                 DISPLAY ' BAD REWRITE ELCRTT '
 11600                              ELCRTT-FILE-STATUS
 11601                 PERFORM ABEND-PGM
 11602              END-IF
 11603           ELSE
 11604              DISPLAY ' BAD READ    ELCRTT '
 11605                               ELCRTT-FILE-STATUS
 11606              PERFORM ABEND-PGM
 11607           END-IF
 11608        ELSE
 11609           DISPLAY ' BAD WRITE ELCRTT '
 11610                              ELCRTT-FILE-STATUS
 11611           PERFORM ABEND-PGM
 11612        END-IF
 11613     END-IF.
 11614
 11615     .
 11616 0950-EXIT.
 11617     EXIT.
 11618
 11619
 11620******************************************************************
 11621***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11622******************************************************************
 11623
 11624 1000-SET-COMMISSION-STRUCTURE.
 11625
 11626     MOVE +1                     TO IA
 11627                                    IB.
 11628
 11629 1100-GET-COMMISSION-LEVEL.
 11630
 11631     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11632
 11633     IF WK-AGT = '0000000000' OR SPACES
 11634         MOVE +0                 TO WK-L-RT
 11635                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 225
* ECS010.cbl
 11636                                    WK-A-RT
 11637         GO TO 1200-SET-COMMISSION-LEVEL.
 11638
 11639 1110-LIFE-COMMISSION.
 11640
 11641     IF CR-LFTYP = ZERO  OR
 11642       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11643         MOVE +0 TO WK-L-RT
 11644                    WK-J-RT
 11645         GO TO 1130-A-H-COMMISSION.
 11646
 11647     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11648         GO TO 1120-JOINT-LIFE-COMMISSION.
 11649
 11650     IF WK-L-RT NUMERIC
 11651        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11652         MOVE WK-L-RT                TO WS-COMMISSION
 11653         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11654         MOVE WS-COMMISSION          TO WK-L-RT
 11655         GO TO 1130-A-H-COMMISSION.
 11656
 11657     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11658     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11659     MOVE ZEROS                      TO WS-SUB1.
 11660     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11661
 11662     IF WS-SUB1 = ZEROS
 11663         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11664     ELSE
 11665         MOVE WK-RATE                TO WK-L-RT
 11666         GO TO 1130-A-H-COMMISSION.
 11667
 11668     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11669
 11670     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11671     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11672     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11673     MOVE WK-RATE                    TO WK-L-RT.
 11674
 11675     GO TO 1130-A-H-COMMISSION.
 11676
 11677 1120-JOINT-LIFE-COMMISSION.
 11678
 11679     IF WK-J-RT NUMERIC
 11680        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11681         MOVE WK-J-RT                TO WS-COMMISSION
 11682         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11683         MOVE WS-COMMISSION          TO WK-J-RT
 11684         GO TO 1130-A-H-COMMISSION.
 11685
 11686     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11687     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11688     MOVE ZEROS                      TO WS-SUB1.
 11689     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11690
 11691     IF WS-SUB1 = ZEROS
 11692         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11693     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 226
* ECS010.cbl
 11694         MOVE WK-RATE                TO WK-J-RT
 11695         GO TO 1130-A-H-COMMISSION.
 11696
 11697     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11698
 11699     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11700     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11701     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11702     MOVE WK-RATE                    TO WK-J-RT.
 11703
 11704 1130-A-H-COMMISSION.
 11705
 11706     IF CR-AHTYP = ZERO  OR
 11707       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11708         MOVE +0 TO WK-A-RT
 11709         GO TO 1200-SET-COMMISSION-LEVEL.
 11710
 11711     IF WK-A-RT NUMERIC
 11712        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11713         MOVE WK-A-RT                TO WS-COMMISSION
 11714         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11715         MOVE WS-COMMISSION          TO WK-A-RT
 11716         GO TO 1200-SET-COMMISSION-LEVEL.
 11717
 11718     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11719     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11720     MOVE ZEROS                      TO WS-SUB1.
 11721     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11722
 11723     IF WS-SUB1 = ZEROS
 11724         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11725     ELSE
 11726         MOVE WK-RATE                TO WK-A-RT
 11727         GO TO 1200-SET-COMMISSION-LEVEL.
 11728
 11729     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11730
 11731     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11732     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11733     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11734     MOVE WK-RATE                    TO WK-A-RT.
 11735
 11736 1200-SET-COMMISSION-LEVEL.
 11737
 11738     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11739     IF WK-AGT = '0000000000' OR SPACES
 11740         MOVE SPACE                   TO WK-N-TYPE (IA)
 11741     ELSE
 11742         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11743
 11744     IF CR-LFTYP = ZERO
 11745         MOVE +0                      TO WK-L-RT1  (IA)
 11746     ELSE
 11747         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11748             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11749         ELSE
 11750             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11751
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 227
* ECS010.cbl
 11752     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11753
 11754     IF RC-COMM-FLG = 'X'
 11755        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11756*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11757*             AND (IA = +5))
 11758            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11759            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11760            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11761            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11762
 11763     IF IA LESS THAN +10
 11764         ADD +1 TO IA
 11765         GO TO 1100-GET-COMMISSION-LEVEL.
 11766
 11767     GO TO 1499-SET-COMM-X.
 11768
 11769 1300-READ-ERCTBL-FILE.
 11770
 11771     IF CTBL-SEARCH = LAST-CTBL
 11772         GO TO 1399-READ-ERCTBL-X.
 11773
 11774     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11775
 11776     IF COMM-OPEN-SW = ' '
 11777         MOVE 'X'                        TO COMM-OPEN-SW
 11778         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11779         OPEN INPUT ERCTBL
 11780         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11781             NEXT SENTENCE
 11782            ELSE
 11783             MOVE '41'                   TO ABEND-CODE-1
 11784             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11785             DISPLAY '******************************'
 11786             DISPLAY '***** ERROR LOCATION 012 *****'
 11787             DISPLAY '******************************'
 11788             DISPLAY '******************************'
 11789             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11790             GO TO ABEND-PGM.
 11791
 11792     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11793                                            LAST-CTBL.
 11794     READ ERCTBL.
 11795
 11796     IF ERCTBL-FILE-STATUS = '23'
 11797         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11798                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11799                 ' CTBL: ' CTBL-SEARCH
 11800         MOVE '*'                TO CTBL-ERROR-SWITCH
 11801         MOVE '44'               TO ABEND-CODE-1
 11802         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11803         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11804         DISPLAY '******************************'
 11805         DISPLAY '***** ERROR LOCATION 013 *****'
 11806         DISPLAY '******************************'
 11807         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11808*        IF DTE-CLIENT NOT = 'NCL'
 11809         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 228
* ECS010.cbl
 11810           AND 'AHL'
 11811             GO TO ABEND-PGM
 11812         ELSE
 11813             NEXT SENTENCE
 11814     ELSE
 11815         IF ERCTBL-FILE-STATUS NOT = '00'
 11816             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11817             MOVE '44'               TO ABEND-CODE-1
 11818             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11819             DISPLAY '******************************'
 11820             DISPLAY '***** ERROR LOCATION 014 *****'
 11821             DISPLAY '******************************'
 11822             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11823             GO TO ABEND-PGM.
 11824
 11825     ADD +1                            TO ERCTBL-READS.
 11826
 11827 1399-READ-ERCTBL-X.
 11828     EXIT.
 11829
 11830 1400-GET-COMM-PERCENT.
 11831
 11832     IF CTBL-ERROR
 11833         MOVE ZEROS                      TO WK-RATE
 11834         GO TO 1489-GET-PERCENT-X.
 11835
 11836     MOVE +1 TO IB.
 11837     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11838        (CT-TBF (1) NOT EQUAL +9999999.99)
 11839         ADD +9 TO IB
 11840         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11841            (CT-TBF (2) NOT EQUAL +9999999.99)
 11842             ADD +9 TO IB.
 11843
 11844     IF CR-AGE GREATER CT-AGE (1)
 11845         ADD +3 TO IB
 11846         IF CR-AGE GREATER CT-AGE (2)
 11847             ADD +3 TO IB.
 11848
 11849     IF WS-COMM-TERM GREATER CT-TRM (1)
 11850         ADD +1 TO IB
 11851         IF WS-COMM-TERM GREATER CT-TRM (2)
 11852             ADD +1 TO IB.
 11853
 11854     IF CT-RT (IB) NOT NUMERIC
 11855         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11856         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11857         GO TO 1300-READ-ERCTBL-FILE.
 11858
 11859     MOVE CT-RT (IB) TO WK-RATE.
 11860
 11861 1489-GET-PERCENT-X.
 11862     EXIT.
 11863
 11864 1499-SET-COMM-X.
 11865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 229
* ECS010.cbl
 11867******************************************************************
 11868***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11869******************************************************************
 11870
 11871 1500-GET-ACCT-LEVEL-LF-COMM.
 11872
 11873     MOVE ZEROS                      TO ACCT-COMM-LF
 11874                                        ACCT-COMM-AH.
 11875
 11876     MOVE +1                         TO IA.
 11877
 11878 1510-ACCT-LEVEL-LOOP.
 11879
 11880     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11881         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11882             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11883             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11884         ELSE
 11885             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11886                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11887
 11888     IF IA LESS THAN +10
 11889         ADD +1 TO IA
 11890         GO TO 1510-ACCT-LEVEL-LOOP.
 11891
 11892 1519-ACCT-LF-COMM-X.
 11893     EXIT.
 11894
 11895
 11896 1550-GET-ACCT-LEVEL-AH-COMM.
 11897
 11898     MOVE ZEROS                      TO ACCT-COMM-AH.
 11899
 11900     MOVE +1                         TO IA.
 11901
 11902 1555-ACCT-LEVEL-LOOP.
 11903
 11904     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11905         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11906             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11907
 11908     IF IA LESS THAN +10
 11909         ADD +1 TO IA
 11910         GO TO 1555-ACCT-LEVEL-LOOP.
 11911
 11912 1599-ACCT-AH-COMM-X.
 11913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 230
* ECS010.cbl
 11915******************************************************************
 11916***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11917******************************************************************
 11918
 11919 1600-RECALC-COMM-EXTR.
 11920
 11921     IF RC-COMM-FLG = 'X'  OR
 11922        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11923        CR-POLICY-IS-DECLINED  OR
 11924        CR-POLICY-IS-VOID
 11925         GO TO 1899-RECALC-COMM-EXTR-X.
 11926
 11927     MOVE 'X'                           TO RC-COMM-FLG.
 11928
 11929     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11930         GO TO 1899-RECALC-COMM-EXTR-X.
 11931
 11932     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11933
 11934     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11935         GO TO 1899-RECALC-COMM-EXTR-X.
 11936
 11937     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11938
 11939     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11940         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11941             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11942
 11943     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11944         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11945                                           WK-NEW-RATES
 11946         GO TO 1899-RECALC-COMM-EXTR-X.
 11947
 11948     MOVE +1                            TO SUB8.
 11949     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11950
 11951 1610-CK-DUPLICATE-ENTRIES.
 11952     PERFORM 1620-CK-DUPL-ENTR-NEW
 11953         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11954             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11955
 11956 1619-CK-DUPLICATE-ENTRIES-XIT.
 11957     EXIT.
 11958
 11959 1620-CK-DUPL-ENTR-NEW.
 11960     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11961         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11962         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11963         MOVE +0                        TO CR-LCOM-L (SUB11)
 11964                                           CR-LCOM-AH (SUB11)
 11965         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11966         MOVE 11                        TO SUB12.
 11967
 11968 1629-CK-DUPL-ENTR-NEW-XIT.
 11969     EXIT.
 11970
 11971 1700-REVERSE-OLD-COMM-LOOP.
 11972     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 231
* ECS010.cbl
 11973     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11974
 11975     IF SUB8 LESS THAN +10
 11976         ADD +1 TO SUB8
 11977         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11978
 11979     MOVE 'O' TO RECALC-TYPE.
 11980
 11981     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11982
 11983     GO TO 1800-MOVE-NEW-COMM-RATES.
 11984
 11985 1710-DO-R-C-EXTRACTS.
 11986
 11987     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11988
 11989     PERFORM 1720-CHECK-COMM-LEVELS
 11990         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11991             VARYING SUB13 FROM +1 BY +1
 11992                 UNTIL SUB13 GREATER THAN 10.
 11993
 11994     MOVE '8'                           TO DE-TRANS.
 11995     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11996*****PERFORM EXTRACT-DATE-RELOAD.
 11997     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11998     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11999     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 12000     PERFORM EXTRACT-DATE-LOAD.
 12001     MOVE 'R'                           TO DE-REIN.
 12002     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12003     MOVE +1                            TO SUB1.
 12004     PERFORM 3110-REINSURE-ISSUE-LOOP
 12005         THRU 3119-REINSURE-ISSUE-LOOP-END.
 12006
 12007     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 12008         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 12009                                       2259-END-CANCEL-BUILD
 12010         PERFORM 1720-CHECK-COMM-LEVELS
 12011             THRU 1729-CHECK-COMM-LEVELS-EXIT
 12012                 VARYING SUB13 FROM +1 BY +1
 12013                     UNTIL SUB13 GREATER THAN 10
 12014         MOVE '7'                       TO DE-TRANS
 12015         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 12016*********PERFORM EXTRACT-DATE-RELOAD
 12017         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12018         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 12019         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 12020         PERFORM EXTRACT-DATE-LOAD
 12021         MOVE 'R'                       TO DE-REIN
 12022         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12023         MOVE +1                        TO SUB1
 12024         PERFORM 3210-REINSURE-CANCEL-LOOP
 12025             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12026
 12027 1719-DO-R-C-EXTRACTS-X.
 12028     EXIT.
 12029
 12030 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 232
* ECS010.cbl
 12031
 12032     IF  DE-AGT (SUB13)       =  SPACES  AND
 12033         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12034         DE-L-PC (SUB13)      =  ZEROS   AND
 12035         DE-A-PC (SUB13)      =  ZEROS
 12036         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12037
 12038 1729-CHECK-COMM-LEVELS-EXIT.
 12039     EXIT.
 12040
 12041 1800-MOVE-NEW-COMM-RATES.
 12042     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12043     MOVE 'N'                           TO RECALC-TYPE.
 12044     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12045     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12046                                           CR-COMPENSATION-LEVELS.
 12047     IF DTE-CLIENT = 'DCC'
 12048        IF CR-LF-NSP-PRM NOT = ZEROS
 12049           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12050              (CR-LFPRM + CR-LFPRM-ALT) -
 12051              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12052        END-IF
 12053        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12054           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12055                                        NOT = 'G' AND 'L')
 12056           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12057           CR-AHPRM -
 12058           (CR-AHPRM * CR-LCOM-AH (1))
 12059        END-IF
 12060     END-IF
 12061     .
 12062
 12063 1899-RECALC-COMM-EXTR-X.
 12064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 233
* ECS010.cbl
 12066******************************************************************
 12067***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12068******************************************************************
 12069
 12070 2000-INITIALIZE-DETAIL-EXTRACT.
 12071
 12072     MOVE SPACES                   TO DETAIL-EXTRACT.
 12073
 12074     MOVE 'DE'                     TO DE-RECORD-ID.
 12075     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12076     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12077
 12078     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12079     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12080
 12081     MOVE CR-NAME                  TO DE-NAME.
 12082     MOVE CR-AGE                   TO DE-AGE.
 12083     MOVE CR-SEX                   TO DE-SEX.
 12084     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12085
 12086     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12087     MOVE CR-LF-TERM               TO DE-LF-TERM
 12088     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12089     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12090     MOVE ZEROS                    TO DE-LF-CNBEN.
 12091     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12092     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12093     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12094     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12095     MOVE ZEROS                    TO DE-LF-RFND.
 12096
 12097     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12098     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12099                                      DE-LF-CANC-EXIT-DT.
 12100
 12101     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12102     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12103     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12104     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12105     MOVE ZEROS                    TO DE-AH-RFND.
 12106
 12107     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12108     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12109                                      DE-AH-CANC-EXIT-DT.
 12110     IF DTE-CLIENT = 'DCC'
 12111        IF CR-ENTRY-STATUS = 'M'
 12112           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12113        ELSE
 12114           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12115              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12116           END-IF
 12117        END-IF
 12118     END-IF
 12119
 12120     IF DTE-CLIENT = 'DCC'
 12121        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12122        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12123     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 234
* ECS010.cbl
 12124        IF (CR-LFTYP NOT = ZERO   AND
 12125           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12126           (CR-AHTYP NOT = ZERO  AND
 12127           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12128           MOVE CR-LIVES           TO DE-LIVES
 12129           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12130                                      DE-CANCEL-CNT-YTD
 12131        END-IF
 12132     END-IF
 12133
 12134     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12135     IF AM-ZIP-PRIME NUMERIC
 12136        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12137      ELSE
 12138        MOVE ZEROS                 TO DE-ZIP.
 12139     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12140
 12141     MOVE CR-APR                   TO DE-APR.
 12142     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12143     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12144     MOVE CR-IND-GRP               TO DE-IG.
 12145     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12146     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12147
 12148     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12149     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12150     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12151
 12152     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12153*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12154
 12155     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12156                                      DE-REI-AHAMT  DE-REI-AHPRM
 12157                                      DE-REI-LFRFND DE-REI-AHRFND
 12158                                      DE-REI-CNAMT.
 12159
 12160     MOVE +1                       TO SUB1.
 12161
 12162* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12163* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12164* CALC IT IN ECS017.
 12165     IF DTE-CLIENT = 'DCC'
 12166        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12167           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12168           IF CR-ACCOUNT = '05500500DD'
 12169              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12170                ' ' DE-REI-LFRFND
 12171           END-IF
 12172        END-IF
 12173        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12174                      OR
 12175           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12176            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12177           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12178           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12179        END-IF
 12180     END-IF
 12181
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 235
* ECS010.cbl
 12182
 12183     PERFORM EXTRACT-DATE-LOAD.
 12184
 12185     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12186                                      WS-DE-INCUR-N
 12187                                      WS-DE-PAY-N
 12188                                      WS-DE-PAID-TO-N
 12189                                      WS-DE-ACC-EXP-DTE-N
 12190                                      WS-DE-ACC-EFF-DTE-N
 12191                                      WS-DE-RSV-INCUR-N
 12192                                      WS-DE-RSV-PAYTO-N
 12193                                      WS-DE-ACC-EXP-DTE-RSV-N
 12194                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12195
 12196 2090-GL-CODE-LOOP.
 12197
 12198     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12199
 12200     IF SUB1 LESS THAN +10
 12201         ADD +1 TO SUB1
 12202         GO TO 2090-GL-CODE-LOOP.
 12203
 12204     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12205
 12206     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12207
 12208     IF (DTE-CLIENT = 'DCC')
 12209        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12210        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12211        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12212        AND (RECALC-TYPE = SPACES)
 12213        MOVE +1                  TO IA
 12214*       IF CR-ACCOUNT = '05500500DD'
 12215**      IF CR-CERT-NO = '0008773536 '
 12216*          DISPLAY ' MADE IT TO 2000 '
 12217*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12218*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12219*             (IB > +10)
 12220*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12221*                MOVE IB TO DIL-BEN-CODE
 12222*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12223*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12224*                DISPLAY DISPLAY-IBNR-LINE
 12225*             END-IF
 12226*          END-PERFORM
 12227*          DISPLAY ' TRLR AREA  '
 12228*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12229*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12230*             (IB > +10)
 12231*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12232*                MOVE IB TO DIL-BEN-CODE
 12233*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12234*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12235*                DISPLAY DISPLAY-IBNR-LINE
 12236*             END-IF
 12237*          END-PERFORM
 12238*       END-IF
 12239        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 236
* ECS010.cbl
 12240           IB > +10
 12241           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12242              CONTINUE
 12243           ELSE
 12244              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12245                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12246                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12247                 COMPUTE DE-A-PC (IB) =
 12248                        WS-BNK-SPP-FEES (IA) / +1000
 12249                 MOVE +0              TO DE-L-PC (IB)
 12250                 ADD +1               TO IA
 12251              END-IF
 12252*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12253*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12254*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12255*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12256*                MOVE +0              TO DE-L-PC (IB)
 12257*                ADD +1               TO IA
 12258*             END-IF
 12259           END-IF
 12260        END-PERFORM
 12261     END-IF
 12262
 12263
 12264
 12265     .
 12266 2099-INIT-DTL-X.
 12267     EXIT.
 12268
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 237
* ECS010.cbl
 12270******************************************************************
 12271***            B U I L D   I S S U E   E X T R A C T           ***
 12272******************************************************************
 12273
 12274 2100-BUILD-ISSUE-EXTRACT.
 12275
 12276     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12277
 12278     MOVE 'I'                      TO DE-TRANS.
 12279
 12280     IF CHECK-BILLED
 12281         MOVE 'N' TO BILLED-SWITCH
 12282     ELSE
 12283         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12284
 12285     MOVE +1                        TO SUB1.
 12286 2150-GA-BILL-LOOP.
 12287
 12288     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12289         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12290
 12291     IF SUB1 LESS THAN +5
 12292         ADD +1 TO SUB1
 12293         GO TO 2150-GA-BILL-LOOP.
 12294
 12295     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12296     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12297                                       DE-BILLED-LFRFND
 12298                                       DE-BILLED-AHPRM
 12299                                       DE-BILLED-AHRFND.
 12300
 12301     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12302         IF PB-LF-BILLED-AMTS = ZERO  AND
 12303            PB-AH-BILLED-AMTS = ZERO
 12304             MOVE ' '                    TO DE-BILL-STATUS
 12305         ELSE
 12306             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12307                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12308                 MOVE 'B'                TO DE-BILL-STATUS
 12309             ELSE
 12310                 MOVE 'R'                TO DE-BILL-STATUS
 12311                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12312                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12313     ELSE
 12314         MOVE 'B'                        TO DE-BILL-STATUS.
 12315
 12316 2190-WRITE-ISSUE-EXTRACT.
 12317
 12318     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12319
 12320 2199-BLD-ISSUE-X.
 12321     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 238
* ECS010.cbl
 12323******************************************************************
 12324***           B U I L D   C A N C E L   E X T R A C T          ***
 12325******************************************************************
 12326
 12327 2200-BUILD-CANCEL-EXTRACT.
 12328
 12329     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12330
 12331     MOVE 'C'                           TO DE-TRANS.
 12332
 12333     IF CR-LFTYP = ZERO
 12334         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12335
 12336     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12337         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12338             CR-LFRFND = +0
 12339              MOVE +0                   TO TEMP-5
 12340              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12341
 12342     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12343          IF CR-LFRFND = +0
 12344              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12345
 12346     MOVE +1 TO TEMP-5.
 12347     MOVE CR-LF-TERM             TO ORIG-TERM.
 12348     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12349     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12350     MOVE '1'                    TO W-VAL-SOURCE.
 12351     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12352
 12353     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12354         MOVE CR-LFAMT TO DE-LF-CNBEN
 12355         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12356
 12357     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12358         GO TO 2220-BLD-DE-CANCEL-SUM.
 12359
 12360     IF REM-TRM3 = CR-LF-TERM
 12361         MOVE CR-LFAMT TO DE-LF-CNBEN
 12362         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12363
 12364     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12365         GO TO 2210-BLD-DE-CANCEL-TEX.
 12366
 12367     IF DTE-CLIENT = 'NCL'
 12368         IF CR-DT LESS THAN 19910101
 12369             GO TO 2205-BLD-DE-CANCEL-BEN.
 12370
 12371     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12372         GO TO 2230-BLD-DE-CANCEL-NP.
 12373
 12374     IF DTE-CLIENT = 'FUL'
 12375         GO TO 2240-BLD-DE-CANCEL-FUL.
 12376
 12377*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12378     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12379        (CR-RATING-CLASS NOT = 'L ')
 12380         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 239
* ECS010.cbl
 12381            (CR-LF-TERM GREATER THAN 060)  AND
 12382            (CR-DT GREATER THAN 19831031)
 12383              GO TO 2230-BLD-DE-CANCEL-NP.
 12384
 12385     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12386         IF (CR-APR GREATER THAN ZERO)  AND
 12387            (CR-LF-TERM GREATER THAN 061)  AND
 12388            (CR-DT GREATER THAN 19830318)
 12389              GO TO 2230-BLD-DE-CANCEL-NP.
 12390
 12391     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12392         IF (CR-APR GREATER THAN ZERO)  AND
 12393            (CR-LF-TERM GREATER THAN 062)  AND
 12394            (CR-DT GREATER THAN 19810831)  AND
 12395            (CR-DT LESS THAN 19830901)
 12396              GO TO 2230-BLD-DE-CANCEL-NP.
 12397
 12398     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12399         IF (CR-APR GREATER THAN ZERO)  AND
 12400            (CR-LF-TERM GREATER THAN 060)  AND
 12401            (CR-DT GREATER THAN 19831231)
 12402              GO TO 2230-BLD-DE-CANCEL-NP.
 12403
 12404 2205-BLD-DE-CANCEL-BEN.
 12405
 12406     IF CR-LF-TERM EQUAL +0
 12407         MOVE +0          TO TEMP-5
 12408     ELSE
 12409         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12410
 12411     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12412
 12413     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12414
 12415 2210-BLD-DE-CANCEL-TEX.
 12416
 12417     DIVIDE CR-LFAMT BY CR-LF-TERM
 12418         GIVING TEX-FACT-1.
 12419     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12420         GIVING TEX-FACT-2
 12421             REMAINDER TEX-FACT-3.
 12422     IF TEX-FACT-3 NOT = ZERO
 12423         ADD +1 TO TEX-FACT-2.
 12424     COMPUTE DE-LF-CNBEN =
 12425         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12426
 12427     IF CR-LFAMT EQUAL +0
 12428         MOVE +0                  TO TEMP-5
 12429     ELSE
 12430         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12431
 12432     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12433
 12434 2220-BLD-DE-CANCEL-SUM.
 12435
 12436     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12437     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12438
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 240
* ECS010.cbl
 12439     IF CR-LFRFND NOT LESS CR-LFPRM
 12440         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12441          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12442
 12443     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12444     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12445     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12446         MOVE TEMP-7             TO DE-LF-CNBEN
 12447       ELSE
 12448         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12449         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12450
 12451     IF CR-LFAMT EQUAL +0
 12452         MOVE +0                  TO TEMP-5
 12453     ELSE
 12454         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12455
 12456     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12457         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12458
 12459 2230-BLD-DE-CANCEL-NP.
 12460
 12461     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12462     MOVE 'L'                        TO  DC-OPTION-CODE.
 12463     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12464     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12465
 12466     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12467       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12468       MOVE '3'                      TO  DC-OPTION-CODE
 12469       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12470       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12471     ELSE
 12472       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12473       MOVE '6'                      TO  DC-OPTION-CODE
 12474       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12475       MOVE +0                       TO  DC-ELAPSED-DAYS
 12476       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12477       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12478
 12479     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12480     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12481     MOVE CR-APR                     TO  CP-LOAN-APR.
 12482     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12483     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12484     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12485     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12486     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12487     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12488
 12489     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12490     IF (DTE-CLIENT = 'DCC')
 12491        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12492        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12493           ((CR-STATE = DD-STATE (D1))
 12494           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12495           AND ('A'           = DD-BEN-TYPE   (D1))
 12496           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 241
* ECS010.cbl
 12497           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12498                           OR
 12499           D1 > max-pdef
 12500        END-PERFORM
 12501        IF D1 <= max-pdef
 12502           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12503              (P1 > +8)
 12504              OR (DD-PROD-CODE (D1 P1) = 'L')
 12505           END-PERFORM
 12506           IF P1 < +9
 12507              MOVE DD-MAX-BEN-AMT (D1 P1)
 12508                                 TO CP-R-MAX-TOT-BEN
 12509           END-IF
 12510        END-IF
 12511     END-IF
 12512
 12513     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12514
 12515     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12516         COMPUTE DE-LF-CNBEN =
 12517                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12518      ELSE
 12519          COMPUTE DE-LF-CNBEN ROUNDED =
 12520                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12521
 12522     IF CR-LFAMT EQUAL +0
 12523         MOVE +0                  TO TEMP-5
 12524     ELSE
 12525         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12526
 12527     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12528
 12529 2240-BLD-DE-CANCEL-FUL.
 12530
 12531     MOVE CR-APR                  TO NP-APR.
 12532     MOVE CR-LF-TERM              TO NP-ORIG.
 12533     MOVE REM-TRM3                TO NP-REM.
 12534     MOVE '2'                     TO NP-OPT.
 12535     MOVE CR-AHPRM                TO NP-AHPRM.
 12536     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12537     MOVE CR-LFAMT                TO NP-BENEFIT.
 12538
 12539*    CALL 'FULNETRM'
 12540*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12541*              NP-ACCOUNT NP-REMAINING.
 12542
 12543     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12544
 12545     IF CR-LFAMT EQUAL +0
 12546         MOVE +0                  TO TEMP-5
 12547     ELSE
 12548         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12549
 12550 2250-CONTINUE-CANCEL-BUILD.
 12551
 12552     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12553     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12554     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 242
* ECS010.cbl
 12555                                         WS-DE-LF-CANC-DTE-N.
 12556     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12557                                         WS-DE-LF-CANC-EXIT-DT-N.
 12558     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12559
 12560
 12561     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12562     IF (DTE-CLIENT = 'DCC')
 12563        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12564        AND (CR-AHTYP NOT = '00' AND '  ')
 12565        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12566        MOVE CR-AH-TERM          TO ORIG-TERM
 12567        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12568        MOVE '1'                 TO W-VAL-SOURCE
 12569        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12570        PERFORM 8500-REMAINING-TERM-ROUTINE
 12571                                 THRU 8599-REM-TERM-X
 12572        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12573        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12574     END-IF
 12575
 12576     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12577
 12578     IF DTE-CLIENT = 'DCC'
 12579        IF DE-AH-RFND = ZEROS
 12580           MOVE ZEROS                 TO DE-ADDL-CLP
 12581        END-IF
 12582     END-IF
 12583
 12584     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12585     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12586                                         WS-DE-AH-CANC-DTE-N.
 12587     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12588                                         WS-DE-AH-CANC-EXIT-DT-N.
 12589     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12590
 12591     IF PB-LAST-MAINT-BY = 'E570'
 12592         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12593
 12594     IF CHECK-BILLED
 12595         MOVE 'N' TO BILLED-SWITCH
 12596     ELSE
 12597         GO TO 2259-END-CANCEL-BUILD.
 12598
 12599     MOVE +1                        TO SUB1.
 12600 2255-GA-BILL-LOOP.
 12601
 12602     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12603         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12604
 12605     IF SUB1 LESS THAN +5
 12606         ADD +1 TO SUB1
 12607         GO TO 2255-GA-BILL-LOOP.
 12608
 12609     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12610     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12611     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12612                                       DE-BILLED-LFRFND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 243
* ECS010.cbl
 12613                                       DE-BILLED-AHPRM
 12614                                       DE-BILLED-AHRFND.
 12615
 12616     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12617         IF PB-LF-BILLED-AMTS = ZERO  AND
 12618            PB-AH-BILLED-AMTS = ZERO
 12619             MOVE ' '                    TO DE-BILL-STATUS
 12620         ELSE
 12621             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12622                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12623                 MOVE 'B'                TO DE-BILL-STATUS
 12624             ELSE
 12625                 MOVE 'R'                TO DE-BILL-STATUS
 12626                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12627                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12628     ELSE
 12629         MOVE 'B'                        TO DE-BILL-STATUS.
 12630
 12631 2259-END-CANCEL-BUILD.
 12632     EXIT.
 12633
 12634 2290-WRITE-CANCEL-EXTRACT.
 12635
 12636     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12637
 12638 2299-BLD-CANCEL-X.
 12639     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 244
* ECS010.cbl
 12641******************************************************************
 12642***            B U I L D   C L A I M   E X T R A C T           ***
 12643******************************************************************
 12644
 12645 2300-BUILD-CLAIM-EXTRACT.
 12646
 12647     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12648
 12649     MOVE 'X'                       TO DE-TRANS.
 12650
 12651     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12652
 12653     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12654     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12655
 12656     MOVE INCURRED-DATE             TO DE-INCUR
 12657                                       WS-DE-INCUR-N.
 12658     MOVE REPORTED-DATE             TO DE-REPORTED.
 12659     MOVE PAYMENT-DATE              TO DE-PAY
 12660                                       WS-DE-PAY-N.
 12661     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12662                                       WS-DE-PAID-TO-N.
 12663
 12664     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12665     MOVE PC-CHECK-NO               TO DE-CHECK.
 12666     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12667     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12668     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12669     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12670     INSPECT DE-PAY-CODE
 12671         CONVERTING '1234569' TO 'PFSXEEV'.
 12672
 12673     MOVE AM-NAME                   TO DE-ACC-NAME.
 12674     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12675                                       WS-DE-ACC-EXP-DTE-N.
 12676     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12677                                       WS-DE-ACC-EFF-DTE-N.
 12678     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12679     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12680
 12681     IF DE-DTH  OR  DE-OB-DTH
 12682         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12683     ELSE
 12684         IF CR-AH-LUMP-SUM-DISAB
 12685             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12686                                    TO DE-AH-PREV-STAT.
 12687
 12688     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12689         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12690
 12691 2390-WRITE-CLAIM-EXTRACT.
 12692
 12693     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12694
 12695 2399-BLD-CLAIM-X.
 12696     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 245
* ECS010.cbl
 12698******************************************************************
 12699***          B U I L D   R E S E R V E   E X T R A C T         ***
 12700******************************************************************
 12701
 12702 2400-BUILD-RESERVE-EXTRACT.
 12703
 12704     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12705
 12706     MOVE 'Y'                         TO DE-TRANS.
 12707     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12708
 12709     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12710     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12711     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12712     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12713     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12714     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12715
 12716     IF DTE-CLIENT  =  'NCL'
 12717        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12718            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12719
 12720     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12721
 12722     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12723                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12724
 12725     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12726                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12727
 12728     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12729                                         WS-DE-RSV-INCUR-N.
 12730     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12731     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12732                                         WS-DE-RSV-PAYTO-N.
 12733
 12734     MOVE ZEROS                       TO DE-REI-IBNR
 12735                                         DE-REI-PAYCUR
 12736                                         DE-REI-FUTRSV.
 12737
 12738     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12739
 12740     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12741         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12742
 12743 2490-WRITE-RESERVE-EXTRACT.
 12744
 12745     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12746
 12747 2499-BLD-RESERVE-X.
 12748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 246
* ECS010.cbl
 12750******************************************************************
 12751***          W R I T E   D E T A I L   E X T R A C T S         ***
 12752******************************************************************
 12753
 12754 2500-WRITE-DETAIL-EXTRACTS.
 12755
 12756
 12757     MOVE  ZEROS            TO  SUB.
 12758
 12759     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12760         GO TO 2520-WRITE-CONTINUE.
 12761
 12762 2510-ZERO-CHARGEBACK-LOOP.
 12763
 12764     ADD  +1                TO  SUB.
 12765
 12766     IF  SUB    GREATER  THAN     +10
 12767         GO TO  2520-WRITE-CONTINUE.
 12768
 12769*    DISPLAY ' CERT NO ' CR-CERT-NO
 12770*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12771*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12772
 12773
 12774     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12775         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12776
 12777     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12778         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12779         OR (WS-DDF-AH-CB (SUB) = 'N')
 12780         MOVE  ZEROS             TO DE-A-PC (SUB)
 12781     END-IF
 12782
 12783     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12784
 12785 2520-WRITE-CONTINUE.
 12786
 12787     IF DTE-CLIENT NOT = 'HER'
 12788         GO TO 2590-WRITE-EXTRACTS.
 12789
 12790     IF DE-REINCO NOT = 'LNL'
 12791         GO TO 2590-WRITE-EXTRACTS.
 12792
 12793     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12794         GO TO 2590-WRITE-EXTRACTS.
 12795
 12796     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12797     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12798     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12799     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12800     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12801     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12802     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12803     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12804     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12805     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12806
 12807     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 247
* ECS010.cbl
 12808     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12809     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12810     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12811     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12812     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12813     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12814     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12815     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12816     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12817
 12818
 12819 2590-WRITE-EXTRACTS.
 12820
 12821     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12822                                     WS-DE-PROC-DT-N.
 12823
 12824     IF DTE-PGM-OPT = '1'
 12825         ADD +1                   TO DE-CNT
 12826*********PERFORM EXTRACT-DATE-RELOAD
 12827         WRITE DETAIL-EXTRACT.
 12828
 12829
 12830 2599-WRT-DETAIL-X.
 12831     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 248
* ECS010.cbl
 12833******************************************************************
 12834***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12835******************************************************************
 12836
 12837 3000-REINSURE-ROUTINE.
 12838
 12839     IF (CR-POLICY-IS-DECLINED) OR
 12840        (CR-POLICY-IS-VOID)
 12841        GO TO 3099-REINSURE-ROUTINE-X.
 12842
 12843     IF REIN-FLG = 'X'
 12844         GO TO 3099-REINSURE-ROUTINE-X.
 12845
 12846     MOVE 'X' TO REIN-FLG.
 12847
 12848     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12849
 12850     IF CR-REIN-TABLE = SPACES OR ZEROS
 12851         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12852
 12853******************************************************************
 12854***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12855******************************************************************
 12856
 12857 3010-RR-READ-REIN.
 12858
 12859     IF REIN-OPEN-SW = ' '
 12860         MOVE 'X'                       TO REIN-OPEN-SW
 12861         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12862         MOVE 'A'                       TO REIN-SRCH-CODE
 12863         OPEN INPUT ERRTBL-IN
 12864         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12865             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12866          ELSE
 12867             MOVE '21'                  TO ABEND-CODE-1
 12868             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12869             DISPLAY '******************************'
 12870             DISPLAY '***** ERROR LOCATION 015 *****'
 12871             DISPLAY '******************************'
 12872             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12873             GO TO ABEND-PGM.
 12874
 12875     IF CR-REIN-TABLE = REIN-SRCH
 12876         GO TO 3019-RR-READ-REIN-X.
 12877
 12878     MOVE +0                            TO REIN-SUB-1.
 12879     MOVE 999999                        TO REIN-LOW-TIME.
 12880     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12881
 12882 3011-RR-CHECK-REIN-SAVE-TABLE.
 12883
 12884     ADD +1                             TO REIN-SUB-1.
 12885     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12886        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12887         GO TO 3015-RR-READ-ERRTBL.
 12888
 12889     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12890         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 249
* ECS010.cbl
 12891         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12892         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12893         GO TO 3019-RR-READ-REIN-X.
 12894
 12895     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12896         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12897         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12898
 12899     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12900
 12901 3015-RR-READ-ERRTBL.
 12902
 12903     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12904
 12905     READ ERRTBL-IN.
 12906
 12907     IF ERRTBL-FILE-STATUS  = '23'
 12908         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12909                                           ' ' CR-FULL-CONTROL
 12910         MOVE '24'                      TO ABEND-CODE-1
 12911         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12912         DISPLAY '******************************'
 12913         DISPLAY '***** ERROR LOCATION 016 *****'
 12914         DISPLAY '******************************'
 12915         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12916         GO TO ABEND-PGM.
 12917
 12918     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12919         NEXT SENTENCE
 12920       ELSE
 12921         MOVE '24'                      TO ABEND-CODE-1
 12922         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12923         DISPLAY '******************************'
 12924         DISPLAY '***** ERROR LOCATION 017 *****'
 12925         DISPLAY '******************************'
 12926         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12927         GO TO ABEND-PGM.
 12928
 12929     ADD +1                            TO ERRTBL-READS.
 12930
 12931     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12932         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12933         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12934         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12935     ELSE
 12936         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12937         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12938         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12939         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12940
 12941 3019-RR-READ-REIN-X.
 12942     EXIT.
 12943
 12944 3020-CALCULATE-REINSURANCE.
 12945
 12946*    IF DTE-CLIENT = '???'  AND
 12947*       (CR-REIN-TABLE = 'SE1')
 12948*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 250
* ECS010.cbl
 12949*        IF CR-STATE NOT = STATE-L
 12950*            MOVE CR-STATE             TO STATE-L
 12951*            PERFORM 8200-STATE-CODE-LOOKUP
 12952*                         THRU 8299-STATE-LOOKUP-X.
 12953
 12954
 12955*    IF DTE-CLIENT = 'DCC'
 12956*       IF CR-LF-NSP-PRM NOT = ZEROS
 12957*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12958*             (CR-LFPRM + CR-LFPRM-ALT) -
 12959*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12960*       END-IF
 12961*       IF CR-AH-NSP-PRM NOT = ZEROS
 12962*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12963*          CR-AHPRM -
 12964*          (CR-AHPRM * CR-LCOM-AH (1))
 12965*       END-IF
 12966*    END-IF
 12967
 12968
 12969     IF RE-REMAINING (1) = 'I'
 12970         MOVE '*'                      TO RISK-REIN-FLAG
 12971     ELSE
 12972         GO TO 3029-CONTINUE-REIN-CALC.
 12973
 12974     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12975                                          REIN-CANCEL-AH-SW.
 12976     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12977                                          REIN-LCNC-EARN-TERM
 12978                                          REIN-LF-CLM-MONTHS
 12979                                          REIN-EARN-AH-TERM
 12980                                          REIN-ACNC-EARN-TERM
 12981                                          REIN-AH-PRIOR-CLMS-PAID
 12982                                          REIN-AH-CLM-MONTHS
 12983                                          REIN-AH-CLM-MTH-1
 12984                                          REIN-AH-CLM-MTH-2
 12985                                          REIN-AH-CLM-MTH-3
 12986                                          REIN-AH-CLM-MTH-4
 12987                                          REIN-AH-CLM-MTH-5.
 12988
 12989*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12990*    MOVE 'L'                          TO DC-OPTION-CODE.
 12991*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12992*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12993
 12994     IF CR-LFTYP = ZEROS  OR  SPACES
 12995         GO TO 3023-CONTINUE.
 12996
 12997     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12998
 12999     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 13000       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13001           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 13002
 13003     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 13004       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 13005           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 13006
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 251
* ECS010.cbl
 13007     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13008     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13009
 13010     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 13011         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 13012     ELSE
 13013         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 13014
 13015     IF CR-LF-CANC-DT NOT = ZEROS
 13016         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 13017         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13018         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 13019         IF CR-DT = CR-LF-CANC-DT
 13020             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 13021
 13022     IF CR-DTH-DT NOT = ZEROS
 13023         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 13024         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13025         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13026
 13027     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13028
 13029
 13030 3023-CONTINUE.
 13031
 13032     IF CR-AHTYP = ZEROS  OR  SPACES
 13033        GO TO 3029-CONTINUE-REIN-CALC.
 13034
 13035     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13036
 13037     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13038       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13039           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13040
 13041     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13042       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13043           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13044
 13045     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13046     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13047
 13048     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13049         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13050     ELSE
 13051         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13052
 13053     IF CR-AH-CANC-DT NOT = ZEROS
 13054         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13055         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13056         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13057         IF CR-DT = CR-AH-CANC-DT
 13058             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13059
 13060     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13061         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13062         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13063         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13064
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 252
* ECS010.cbl
 13065     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13066         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13067         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13068         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13069
 13070     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13071         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13072         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13073         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13074
 13075     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13076         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13077         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13078         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13079
 13080     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13081         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13082         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13083         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13084
 13085     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13086
 13087
 13088     GO TO 3029-CONTINUE-REIN-CALC.
 13089
 13090
 13091 3025-CALC-ELAPSED-MONTHS.
 13092
 13093     MOVE 'L'                          TO DC-OPTION-CODE.
 13094     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13095     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13096     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13097     MOVE '1'                          TO DC-OPTION-CODE.
 13098     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13099     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13100                                          DC-ODD-DAYS-OVER
 13101                                          DC-ELAPSED-DAYS.
 13102     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13103
 13104 3026-CALC-EXIT.
 13105     EXIT.
 13106
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 253
* ECS010.cbl
 13108 3029-CONTINUE-REIN-CALC.
 13109
*13110                             COPY ECSRTPFM.
 13111******************************************************************07/10/97
 13112*                                                                *ECSRTPFM
 13113*                            ECSRTPFM                            *   LV001
 13114*                            VMOD=2.002                          *ECSRTPFM
 13115*                                                                *ECSRTPFM
 13116******************************************************************ECSRTPFM
 13117                                                                  ECSRTPFM
 13118     IF    CR-LFAMT  NUMERIC                                      00000072
 13119           NEXT SENTENCE                                          00000073
 13120        ELSE                                                      00000074
 13121           MOVE ZEROS TO CR-LFAMT.                                00000075
 13122                                                                  00000076
 13123     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13124           NEXT SENTENCE                                          00000078
 13125        ELSE                                                      00000079
 13126           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13127                                                                  00000081
 13128                                                                  00000082
 13129     IF    CR-LFPRM  NUMERIC                                      00000083
 13130           NEXT SENTENCE                                          00000084
 13131        ELSE                                                      00000085
 13132           MOVE ZEROS TO CR-LFPRM.                                00000086
 13133                                                                  00000087
 13134     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13135           NEXT SENTENCE                                          00000089
 13136        ELSE                                                      00000090
 13137           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13138                                                                  00000092
 13139                                                                  00000093
 13140     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13141           NEXT SENTENCE                                          00000095
 13142        ELSE                                                      00000096
 13143           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13144                                                                  00000098
 13145     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13146           NEXT SENTENCE                                          00000100
 13147        ELSE                                                      00000101
 13148           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13149                                                                  00000103
 13150     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13151           NEXT SENTENCE                                          00000105
 13152        ELSE                                                      00000106
 13153           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13154                                                                  00000108
 13155     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13156     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13157     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13158         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13159     ELSE                                                         ECSRTPFM
 13160         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13161     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13162                                                                  ECSRTPFM
 13163     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13164     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13165     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 254
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13166         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13167     ELSE                                                         ECSRTPFM
 13168         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13169     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13170                                                                  ECSRTPFM
 13171     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13172         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13173             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13174                                                                  ECSRTPFM
 13175
 13176     MOVE 'X'                  TO REIN-RT-SW.
 13177     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13178     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13179     MOVE ' '                  TO REIN-RT-SW.
 13180
 13181 3030-RE-CALCULATE-REINSURANCE.
 13182
 13183     IF AM-RECALC-REIN = 'Y'
 13184         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13185            CR-REIN-SPEC = SPACE  AND
 13186            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13187             PERFORM 3600-RC-REINSURANCE
 13188                 THRU 3799-RC-REINSURANCE-X.
 13189
 13190     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13191         VARYING SUB1 FROM 1 BY 1
 13192             UNTIL REIN-COMP (SUB1) = SPACES.
 13193
 13194     GO TO 3099-REINSURE-ROUTINE-X.
 13195
 13196 3040-REIN-REC-CNT.
 13197
 13198     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13199         GO TO 3049-RRC-XIT.
 13200
 13201     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13202         VARYING B-SUB FROM 1 BY 1
 13203             UNTIL B-SUB GREATER THAN 50.
 13204
 13205 3049-RRC-XIT.
 13206     EXIT.
 13207
 13208 3050-REIN-COMP-ADD.
 13209
 13210     IF RB-COMPANY (B-SUB) = SPACES
 13211         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13212     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13213         MOVE 1   TO RB-COUNT (B-SUB)
 13214         MOVE +50 TO B-SUB.
 13215
 13216 3059-RCA-XIT.
 13217     EXIT.
 13218
 13219 3099-REINSURE-ROUTINE-X.
 13220     EXIT.
 13221
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 255
* ECS010.cbl
 13223******************************************************************
 13224***                R E I N S U R E   I S S U E S               ***
 13225******************************************************************
 13226
 13227 3100-REINSURE-ISSUE.
 13228
 13229     IF  REIN-COMP (1) = SPACES
 13230         GO TO 3199-REINSURE-ISSUE-X.
 13231
 13232     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13233     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13234     MOVE 'I'      TO DE-TRANS.
 13235     MOVE 'R'      TO DE-REIN.
 13236*****PERFORM EXTRACT-DATE-RELOAD.
 13237     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13238     MOVE +1       TO SUB1.
 13239
 13240 3110-REINSURE-ISSUE-LOOP.
 13241
 13242     IF REIN-COMP (SUB1) = SPACES
 13243         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13244
 13245     IF UPDATING-RISK-PREMIUMS
 13246       IF REIN-REM-SW (SUB1) NOT = 'I'
 13247         ADD +1 TO SUB1
 13248         GO TO 3110-REINSURE-ISSUE-LOOP.
 13249
 13250     IF REIN-REM-SW (SUB1) = 'Z'
 13251         ADD +1 TO SUB1
 13252         GO TO 3110-REINSURE-ISSUE-LOOP.
 13253
 13254     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13255     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13256     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13257     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13258     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13259     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13260
 13261     IF REIN-REM-SW (SUB1) NOT = 'I'
 13262         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13263
 13264     IF RWF-LFPRM = ZEROS  AND
 13265        RWF-AHPRM = ZEROS
 13266         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13267
 13268     IF RWF-LFPRM NOT = ZEROS
 13269         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13270         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13271
 13272     IF RWF-AHPRM NOT = ZEROS
 13273         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13274         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13275
 13276 3115-CONTINUE-ISSUE-LOOP.
 13277
 13278     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13279     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13280
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 256
* ECS010.cbl
 13281     IF DE-REI-LFAMT NOT = ZERO
 13282        OR DE-REI-LFPRM NOT = ZERO
 13283        OR DE-REI-AHAMT NOT = ZERO
 13284        OR DE-REI-AHPRM NOT = ZERO
 13285         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13286                 2599-WRT-DETAIL-X
 13287         ADD +1 TO BC-R-ISS.
 13288
 13289     ADD +1 TO SUB1.
 13290     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13291     PERFORM EXTRACT-DATE-LOAD.
 13292
 13293     GO TO 3110-REINSURE-ISSUE-LOOP.
 13294
 13295 3119-REINSURE-ISSUE-LOOP-END.
 13296     EXIT.
 13297
 13298 3190-REINSURE-ISSUE-PRINT.
 13299
 13300     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13301     IF RW-ACCUM-LF NOT = ZERO
 13302         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13303         MOVE CR-LF-TERM               TO TRD-LFTRM
 13304         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13305         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13306     IF RW-ACCUM-AH NOT = ZERO
 13307         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13308         MOVE CR-AH-TERM               TO TRD-AHTRM
 13309         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13310         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13311     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13312         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13313
 13314 3199-REINSURE-ISSUE-X.
 13315     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 257
* ECS010.cbl
 13317******************************************************************
 13318***               R E I N S U R E   C A N C E L S              ***
 13319******************************************************************
 13320
 13321 3200-REINSURE-CANCEL.
 13322
 13323     IF REIN-COMP (1) = SPACES
 13324         GO TO 3299-REINSURE-CANCEL-X.
 13325
 13326     IF CR-LFRFND = ZERO
 13327        AND CR-AHRFND = ZERO
 13328         GO TO 3299-REINSURE-CANCEL-X.
 13329
 13330     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13331             VARYING SUB1 FROM +1 BY +1 UNTIL
 13332                       REIN-COMP (SUB1) = SPACES.
 13333
 13334     IF REIN-RT-SW = 'X'
 13335         GO TO 3299-REINSURE-CANCEL-X.
 13336
 13337     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13338     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13339     MOVE 'R'      TO DE-REIN.
 13340*****PERFORM EXTRACT-DATE-RELOAD.
 13341     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13342     MOVE +1       TO SUB1.
 13343
 13344 3210-REINSURE-CANCEL-LOOP.
 13345
 13346     IF REIN-COMP (SUB1) = SPACES
 13347         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13348
 13349     IF REIN-REM-SW (SUB1) = 'Z'
 13350         ADD +1        TO SUB1
 13351         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13352         PERFORM EXTRACT-DATE-LOAD
 13353         GO TO 3210-REINSURE-CANCEL-LOOP.
 13354
 13355     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13356     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13357
 13358     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13359     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13360     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13361     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13362     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13363     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13364     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13365     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13366     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13367
 13368     IF REIN-REM-SW (SUB1) NOT = 'I'
 13369         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13370
 13371     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13372        VOIDING-LF-CANCEL
 13373         NEXT SENTENCE
 13374     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 258
* ECS010.cbl
 13375         MOVE ZEROS             TO DE-REI-LFRFND.
 13376
 13377     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13378        VOIDING-AH-CANCEL
 13379         NEXT SENTENCE
 13380     ELSE
 13381         MOVE ZEROS             TO DE-REI-AHRFND.
 13382
 13383 3215-CONTINUE-CANCEL-LOOP.
 13384
 13385     IF RWF-LF-RUNOFF-SW = 'N'
 13386         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13387             MOVE ZEROS         TO DE-LF-TYPE
 13388                                   DE-REI-LFAMT
 13389                                   DE-REI-LFPRM
 13390                                   DE-REI-LFRFND
 13391                                   DE-REI-CNAMT.
 13392
 13393     IF RWF-AH-RUNOFF-SW = 'N'
 13394         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13395             MOVE ZEROS         TO DE-AH-TYPE
 13396                                   DE-REI-AHAMT
 13397                                   DE-REI-AHPRM
 13398                                   DE-REI-AHRFND.
 13399
 13400     IF DE-REI-LFAMT NOT = ZERO
 13401        OR DE-REI-LFPRM NOT = ZERO
 13402        OR DE-REI-AHAMT NOT = ZERO
 13403        OR DE-REI-AHPRM NOT = ZERO
 13404        OR DE-REI-LFRFND NOT = ZERO
 13405        OR DE-REI-AHRFND NOT = ZERO
 13406        OR DE-REI-CNAMT NOT = ZERO
 13407         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13408                                            2599-WRT-DETAIL-X
 13409         ADD +1 TO BC-R-CNC.
 13410
 13411     ADD +1 TO SUB1.
 13412     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13413     PERFORM EXTRACT-DATE-LOAD.
 13414     GO TO 3210-REINSURE-CANCEL-LOOP.
 13415
 13416 3219-REINSURE-CANCEL-LOOP-END.
 13417     EXIT.
 13418
 13419 3290-REINSURE-CANCEL-PRINT.
 13420
 13421     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13422     IF RW-ACCUM-LF NOT = ZERO
 13423         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13424         MOVE CR-LF-TERM               TO TRD-LFTRM
 13425         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13426         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13427     IF RW-ACCUM-AH NOT = ZERO
 13428         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13429         MOVE CR-AH-TERM               TO TRD-AHTRM
 13430         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13431         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13432     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 259
* ECS010.cbl
 13433         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13434
 13435 3299-REINSURE-CANCEL-X.
 13436     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 260
* ECS010.cbl
 13438******************************************************************
 13439***                R E I N S U R E   C L A I M S               ***
 13440******************************************************************
 13441
 13442 3300-REINSURE-CLAIM.
 13443
 13444*    IF DTE-CLIENT = '???'
 13445*       IF (REIN-RT-SW NOT = 'X')  AND
 13446*          (PC-PAYMENT-TYPE = '5' OR '6')
 13447*        GO TO 3399-REINSURE-CLAIM-X.
 13448
 13449     IF REIN-COMP (1) = SPACES
 13450         GO TO 3399-REINSURE-CLAIM-X.
 13451
 13452     IF REIN-RT-SW = 'X'
 13453         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13454         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13455         MOVE CR-DISAMT   TO RW-AHCLMWK
 13456         ADD  CR-DISEXP   TO RW-AHCLMWK
 13457     ELSE
 13458         IF PC-CLAIM-TYPE  = 1 OR 3
 13459             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13460             MOVE +0                  TO RW-AHCLMWK
 13461         ELSE
 13462             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13463             MOVE +0                  TO RW-LFCLMWK.
 13464
 13465     MOVE +0                          TO RW-LFCLM
 13466                                         RW-AHCLM.
 13467     IF RW-LFCLMWK = ZERO
 13468        AND RW-AHCLMWK = ZERO
 13469         GO TO 3399-REINSURE-CLAIM-X.
 13470
 13471     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13472         VARYING SUB1 FROM +1 BY +1
 13473             UNTIL REIN-COMP (SUB1) = SPACES.
 13474
 13475     IF REIN-RT-SW = 'X'
 13476         GO TO 3399-REINSURE-CLAIM-X.
 13477
 13478     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13479     MOVE ZEROS                TO RW-ACCUM-CLM.
 13480     MOVE 'R'                  TO DE-REIN.
 13481*****PERFORM EXTRACT-DATE-RELOAD.
 13482     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13483     MOVE +1                   TO SUB1.
 13484
 13485 3310-REINSURE-CLAIM-LOOP.
 13486
 13487     IF REIN-COMP (SUB1) = SPACES
 13488         GO TO 3390-REINSURE-CLAIM-PRINT.
 13489
 13490     IF REIN-REM-SW (SUB1) = 'Z'
 13491         ADD +1        TO SUB1
 13492         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13493         PERFORM EXTRACT-DATE-LOAD
 13494         GO TO 3310-REINSURE-CLAIM-LOOP.
 13495
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 261
* ECS010.cbl
 13496     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13497     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13498
 13499     IF PC-CLAIM-TYPE  = 1 OR 3
 13500         IF RWF-LF-RUNOFF-SW = 'N'
 13501           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13502               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13503
 13504     IF PC-CLAIM-TYPE  = 2 OR 4
 13505         IF RWF-AH-RUNOFF-SW = 'N'
 13506           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13507               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13508
 13509     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13510     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13511     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13512     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13513
 13514     IF PC-CLAIM-TYPE  = 1 OR 3
 13515         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13516         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13517     ELSE
 13518         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13519         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13520
 13521     IF PC-CLAIM-TYPE = 1 OR 3
 13522         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13523            AND DE-REI-CLAIM-AMT
 13524             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13525         ELSE
 13526             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13527     ELSE
 13528         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13529            AND DE-REI-CLAIM-AMT
 13530             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13531         ELSE
 13532             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13533
 13534 3320-REINSURE-CLAIM-LOOP-GO.
 13535
 13536     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13537     ADD +1                     TO BC-R-CLM.
 13538
 13539 3330-REINSURE-CLAIM-LOOP-ADD.
 13540
 13541     ADD +1                     TO SUB1.
 13542     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13543     PERFORM EXTRACT-DATE-LOAD.
 13544     GO TO 3310-REINSURE-CLAIM-LOOP.
 13545
 13546 3390-REINSURE-CLAIM-PRINT.
 13547
 13548     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13549     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13550         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13551         MOVE CR-LF-TERM               TO TRD-LFTRM
 13552         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13553         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 262
* ECS010.cbl
 13554     ELSE
 13555         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13556         MOVE CR-AH-TERM               TO TRD-AHTRM
 13557         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13558         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13559         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13560         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13561         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13562         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13563     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13564
 13565 3399-REINSURE-CLAIM-X.
 13566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 263
* ECS010.cbl
 13568******************************************************************
 13569***              R E I N S U R E   R E S E R V E S             ***
 13570******************************************************************
 13571
 13572 3400-REINSURE-RESERVE.
 13573
 13574     IF REIN-COMP (1) = SPACES
 13575         GO TO 3499-REINSURE-RESERVE-X.
 13576
 13577     IF PC-CLAIM-TYPE = '1' OR '3'
 13578         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13579         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13580         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13581         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13582         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13583     ELSE
 13584         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13585         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13586         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13587         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13588         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13589
 13590     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13591                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13592     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13593         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13594          GO TO 3499-REINSURE-RESERVE-X.
 13595
 13596     IF DTE-CLIENT NOT = 'MIC'
 13597         GO TO 3405-REINSURE-RESERVE-CONT.
 13598
 13599     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13600         GO TO 3405-REINSURE-RESERVE-CONT.
 13601
 13602     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13603     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13604     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13605     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13606                                        CP-CLAIM-TYPE.
 13607     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13608     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13609     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13610     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13611     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13612     MOVE '3'                        TO CP-CDT-METHOD.
 13613     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13614     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13615                                        CP-RATING-BENEFIT-AMT.
 13616     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13617     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13618
 13619 3405-REINSURE-RESERVE-CONT.
 13620
 13621     PERFORM 3500-REINSURE-CALC-RESERVE
 13622         THRU 3599-REINSURE-CALC-RESERVE-X
 13623             VARYING SUB1 FROM +1 BY +1
 13624                 UNTIL REIN-COMP (SUB1) = SPACES.
 13625
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 264
* ECS010.cbl
 13626     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13627     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13628     MOVE 'R'            TO DE-REIN.
 13629*****PERFORM EXTRACT-DATE-RELOAD.
 13630     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13631     MOVE +1             TO SUB1.
 13632
 13633 3410-REINSURE-RESERVE-LOOP.
 13634
 13635     IF REIN-COMP (SUB1) = SPACES
 13636         GO TO 3490-REINSURE-RESERVE-PRINT.
 13637
 13638     IF REIN-REM-SW (SUB1) = 'Z'
 13639         ADD +1 TO SUB1
 13640         GO TO 3410-REINSURE-RESERVE-LOOP.
 13641
 13642     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13643     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13644
 13645     IF PC-CLAIM-TYPE  = 1 OR 3
 13646         IF RWF-LF-RUNOFF-SW = 'N'
 13647           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13648               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13649
 13650     IF PC-CLAIM-TYPE  = 2 OR 4
 13651         IF RWF-AH-RUNOFF-SW = 'N'
 13652           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13653               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13654
 13655     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13656     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13657     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13658     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13659
 13660     IF PC-CLAIM-TYPE = 1 OR 3
 13661         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13662         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13663         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13664     ELSE
 13665         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13666         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13667         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13668
 13669     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13670     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13671     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13672
 13673     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13674        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13675        OR DE-REI-FUTRSV
 13676         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13677                                            2599-WRT-DETAIL-X
 13678         ADD +1 TO BC-R-CRS.
 13679
 13680 3415-REINSURE-RESERVE-LOOP-ADD.
 13681
 13682     ADD +1 TO SUB1.
 13683     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 265
* ECS010.cbl
 13684     PERFORM EXTRACT-DATE-LOAD.
 13685     GO TO 3410-REINSURE-RESERVE-LOOP.
 13686
 13687 3490-REINSURE-RESERVE-PRINT.
 13688
 13689     IF RW-ACCUM-IBNR   = ZERO  AND
 13690        RW-ACCUM-PAYCUR = ZERO  AND
 13691        RW-ACCUM-FUTRSV = ZERO
 13692         GO TO 3499-REINSURE-RESERVE-X.
 13693
 13694     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13695     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13696     MOVE 'IBNR'                    TO TRD-IBNRX.
 13697     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13698     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13699     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13700     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13701
 13702     IF PC-CLAIM-TYPE = 1
 13703         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13704     ELSE
 13705         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13706     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13707
 13708     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13709
 13710 3499-REINSURE-RESERVE-X.
 13711     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 266
* ECS010.cbl
 13713******************************************************************
 13714***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13715******************************************************************
 13716
 13717 3500-REINSURE-CALC-RESERVE.
 13718
 13719     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13720     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13721                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13722
 13723     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13724        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13725          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13726       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13727
 13728     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13729        MOVE ZERO TO CO-SUB.
 13730
 13731     IF CO-SUB NOT = ZERO
 13732        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13733           IF PC-CLAIM-TYPE = '1' OR '3'
 13734             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13735                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13736
 13737     IF PC-CLAIM-TYPE  = 1 OR 3
 13738         IF RWF-LF-RUNOFF-SW = 'N'
 13739           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13740               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13741
 13742     IF CO-SUB NOT = ZERO
 13743        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13744           IF PC-CLAIM-TYPE = '2' OR '4'
 13745             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13746                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13747
 13748     IF PC-CLAIM-TYPE  = 2 OR 4
 13749         IF RWF-AH-RUNOFF-SW = 'N'
 13750           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13751               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13752
 13753     IF DTE-CLIENT NOT = 'MIC'
 13754         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13755
 13756     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13757         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13758
 13759     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13760
 13761     IF CR-AHTYP = ZERO  OR
 13762        CO-SUB = ZERO
 13763         GO TO 3505-REIN-CALC-RESERVE-CONT
 13764     ELSE
 13765         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13766             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13767
 13768     COMPUTE MAX-REM-TERM ROUNDED =
 13769                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13770
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 267
* ECS010.cbl
 13771     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13772         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13773
 13774     COMPUTE CP-ORIGINAL-TERM =
 13775                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13776
 13777     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13778
 13779     IF  CP-RETURN-CODE = ZERO
 13780         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13781
 13782 3505-REIN-CALC-RESERVE-CONT.
 13783
 13784     IF SUB1 = RE-100-COMP
 13785         GO TO 3520-REIN-REMAINDER-RSRV.
 13786
 13787     IF CR-LFAMT NOT = ZERO  AND
 13788        RWF-LFAMT NOT = ZERO
 13789         IF DTE-CLIENT NOT = 'MIC'
 13790             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13791                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13792             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13793                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13794             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13795                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13796         ELSE
 13797             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13798             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13799             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13800
 13801     IF CR-AHAMT NOT = ZERO  AND
 13802        RWF-AHAMT NOT = ZERO
 13803         IF DTE-CLIENT NOT = 'MIC'
 13804             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13805                         RWF-AHAMT) / CR-AHAMT
 13806             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13807                         RWF-AHAMT) / CR-AHAMT
 13808             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13809                         RWF-AHAMT) / CR-AHAMT
 13810         ELSE
 13811             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13812             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13813             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13814
 13815 3510-REINSURE-CALC-RESERVE-ADD.
 13816
 13817     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13818     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13819     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13820     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13821     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13822     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13823
 13824     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13825         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13826
 13827     IF CO-SUB = ZERO
 13828         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 268
* ECS010.cbl
 13829
 13830 3513-REIN-CHK-LF-RSRV-LIMIT.
 13831     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13832         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13833
 13834     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13835         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13836
 13837     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13838                                      (RWF-LFCLM +
 13839                                       RWF-DTH-PAYCUR +
 13840                                       RWF-DTH-FUTRSV).
 13841
 13842     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13843         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13844
 13845     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13846
 13847     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13848         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13849         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13850     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13851         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13852
 13853     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13854
 13855     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13856         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13857         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13858     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13859         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13860
 13861 3515-REIN-CHK-AH-RSRV-LIMIT.
 13862     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13863         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13864
 13865     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13866         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13867
 13868     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13869                                      (RWF-AHCLM +
 13870                                       RWF-DIS-PAYCUR +
 13871                                       RWF-DIS-FUTRSV).
 13872
 13873     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13874         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13875
 13876     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13877
 13878     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13879         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13880         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13881     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13882         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13883
 13884     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13885
 13886     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 269
* ECS010.cbl
 13887         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13888         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13889     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13890         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13891
 13892 3519-REINSURE-CALC-RESERVE-END.
 13893
 13894     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13895        OR RWF-DTH-FUTRSV
 13896         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13897
 13898     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13899        OR RWF-DIS-FUTRSV
 13900         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13901
 13902     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13903
 13904 3520-REIN-REMAINDER-RSRV.
 13905
 13906     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13907     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13908     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13909     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13910     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13911     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13912
 13913     PERFORM 3530-REIN-SUB-RSRV
 13914         THRU 3539-REIN-SUB-RSRV-X
 13915             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13916
 13917     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13918
 13919 3530-REIN-SUB-RSRV.
 13920
 13921     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13922     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13923     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13924     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13925     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13926     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13927
 13928 3539-REIN-SUB-RSRV-X.
 13929     EXIT.
 13930
 13931 3540-CONT-REIN-CALC-RESERVE.
 13932
 13933     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13934         MOVE 'X' TO REIN-BUS-FLAG.
 13935     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13936
 13937 3599-REINSURE-CALC-RESERVE-X.
 13938     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 270
* ECS010.cbl
 13940******************************************************************
 13941***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13942******************************************************************
 13943
 13944*REINSURANCE-CALCULATIONS.
*13945                             COPY ECSRIRTN.
 13946******************************************************************04/30/98
 13947*                                                                *ECSRIRTN
 13948*                            ECSRIRTN                            *   LV012
 13949*                            VMOD=2.025.                         *ECSRIRTN
 13950*                                                                *ECSRIRTN
 13951******************************************************************ECSRIRTN
 13952******************************************************************
 13953*                   C H A N G E   L O G
 13954*
 13955* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13956*-----------------------------------------------------------------
 13957*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13958* EFFECTIVE    NUMBER
 13959*-----------------------------------------------------------------
 13960* 062703                   PEMA  ADD DCC CLIENT ID TO
 13961*                                SPECIAL CEDED CLAIM CALC
 13962* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13963                                                                  ECSRIRTN
 13964 REINSURE-CALC.                                                   ECSRIRTN
 13965                                                                  ECSRIRTN
 13966     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13967     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13968     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13969     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13970                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13971                                                                  ECSRIRTN
 13972     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13973                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13974                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13975                                                                  ECSRIRTN
 13976     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13977                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13978                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13979                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13980                                                                  ECSRIRTN
 13981     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13982        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13983          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13984          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13985          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13986                                                                  ECSRIRTN
 13987     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13988        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13989         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13990                                                                  ECSRIRTN
 13991     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13992                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13993                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13994                                                                  ECSRIRTN
 13995     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13996         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13997                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 271
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13998     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13999         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14000                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 14001                                                                  ECSRIRTN
 14002     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 14003         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 14004                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14005                                                                  ECSRIRTN
 14006 CALC-CONTINUED.                                                  ECSRIRTN
 14007                                                                  ECSRIRTN
 14008     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 14009     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 14010                                                                  ECSRIRTN
 14011     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 14012         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 14013     ELSE                                                         ECSRIRTN
 14014         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 14015     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 14016                                                                  ECSRIRTN
 14017     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 14018     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 14019     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 14020         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 14021     ELSE                                                         ECSRIRTN
 14022         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 14023     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 14024                                                                  ECSRIRTN
 14025     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14026         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14027         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14028         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14029         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14030         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14031         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14032                                                                  ECSRIRTN
 14033     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14034         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14035                                                                  ECSRIRTN
 14036     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14037         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14038                                                                  ECSRIRTN
 14039     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14040         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14041                                                                  ECSRIRTN
 14042     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14043     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14044                                                                  ECSRIRTN
 14045     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14046         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14047                                                                  ECSRIRTN
 14048     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14049       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14050        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14051        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14052           NEXT SENTENCE                                          ECSRIRTN
 14053       ELSE                                                       ECSRIRTN
 14054           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
 14055                       REIN-AH-FLG (SUB1).                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 272
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14056                                                                  ECSRIRTN
 14057     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14058         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14059            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14060             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14061                                                                  ECSRIRTN
 14062     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14063         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14064            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14065             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14066                                                                  ECSRIRTN
 14067     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14068         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14069             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14070                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14071             ELSE                                                 ECSRIRTN
 14072                 NEXT SENTENCE                                    ECSRIRTN
 14073         ELSE                                                     ECSRIRTN
 14074             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14075                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14076                                                                  ECSRIRTN
 14077     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14078         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14079             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14080                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14081             ELSE                                                 ECSRIRTN
 14082                 NEXT SENTENCE                                    ECSRIRTN
 14083         ELSE                                                     ECSRIRTN
 14084             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14085                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14086                                                                  ECSRIRTN
 14087     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14088         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14089                                                                  ECSRIRTN
 14090     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14091         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14092         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14093                                                                  ECSRIRTN
 14094     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14095         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14096                                                                  ECSRIRTN
 14097     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14098         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14099         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14100                                                                  ECSRIRTN
 14101     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14102         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14103                                                                  ECSRIRTN
 14104     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14105         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14106                                                                  ECSRIRTN
 14107     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14108                                                                  ECSRIRTN
 14109 REINSURE-CK-LIFE.                                                ECSRIRTN
 14110                                                                  ECSRIRTN
 14111     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14112         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14113                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 273
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14114     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14115         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14116                                                                  ECSRIRTN
 14117     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14118         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14119             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14120                                                                  ECSRIRTN
 14121     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14122                                                                  ECSRIRTN
 14123     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14124         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14125             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14126         ELSE                                                     ECSRIRTN
 14127             NEXT SENTENCE                                        ECSRIRTN
 14128     ELSE                                                         ECSRIRTN
 14129         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14130             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14131                                                                  ECSRIRTN
 14132     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14133         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14134             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14135         ELSE                                                     ECSRIRTN
 14136             NEXT SENTENCE                                        ECSRIRTN
 14137     ELSE                                                         ECSRIRTN
 14138         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14139             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14140                                                                  ECSRIRTN
 14141     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14142         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14143             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14144                                                                  ECSRIRTN
 14145     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14146         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14147            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14148                                                                  ECSRIRTN
 14149     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14150         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14151             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14152                                                                  ECSRIRTN
 14153     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14154         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14155            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14156                                                                  ECSRIRTN
 14157     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14158         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14159             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14160                                                                  ECSRIRTN
 14161     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14162         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14163            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14164            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14165             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14166                                                                  ECSRIRTN
 14167     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14168         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14169            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14170             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14171                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 274
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14172     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14173         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14174             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14175                                                                  ECSRIRTN
 14176     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14177         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14178             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14179                                                                  ECSRIRTN
 14180     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14181        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14182           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14183            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14184                                                                  ECSRIRTN
 14185     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14186         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14187            CR-IND-GRP = '1'                                      ECSRIRTN
 14188             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14189                                                                  ECSRIRTN
 14190     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14191         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14192            CR-IND-GRP = '1'                                      ECSRIRTN
 14193             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14194                                                                  ECSRIRTN
 14195     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14196         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14197            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14198            CR-IND-GRP = '1'                                      ECSRIRTN
 14199             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14200                                                                  ECSRIRTN
 14201     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14202         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14203            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14204            CR-IND-GRP = '1'                                      ECSRIRTN
 14205             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14206                                                                  ECSRIRTN
 14207     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14208         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14209            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14210                                                                  ECSRIRTN
 14211     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14212        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14213                                                                  ECSRIRTN
 14214     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14215         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14216                                                                  ECSRIRTN
 14217     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14218         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14219                                                                  ECSRIRTN
 14220     IF CR-LF-TERM  NUMERIC                                       00002331
 14221        NEXT SENTENCE                                             00002332
 14222     ELSE                                                         00002333
 14223        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14224     END-IF
 14225                                                                  00002335
 14226     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14227         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14228                                                                  ECSRIRTN
 14229     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 275
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14230         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14231                                                                  ECSRIRTN
 14232     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14233                                                                  ECSRIRTN
 14234     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14235         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14236                                                                  ECSRIRTN
 14237     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14238         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14239                                                                  ECSRIRTN
 14240     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14241                                                                  ECSRIRTN
 14242 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14243     EXIT.                                                        ECSRIRTN
 14244                                                                  ECSRIRTN
 14245 REINSURE-CK-AH.                                                  ECSRIRTN
 14246                                                                  ECSRIRTN
 14247     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14248         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14249                                                                  ECSRIRTN
 14250     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14251         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14252                                                                  ECSRIRTN
 14253     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14254         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14255             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14256                                                                  ECSRIRTN
 14257     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14258                                                                  ECSRIRTN
 14259     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14260         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14261             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14262         ELSE                                                     ECSRIRTN
 14263             NEXT SENTENCE                                        ECSRIRTN
 14264     ELSE                                                         ECSRIRTN
 14265         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14266             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14267                                                                  ECSRIRTN
 14268     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14269         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14270             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14271                                                                  ECSRIRTN
 14272     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14273         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14274             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14275                                                                  ECSRIRTN
 14276     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14277         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14278             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14279                                                                  ECSRIRTN
 14280     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14281         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14282             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14283                                                                  ECSRIRTN
 14284     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14285         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14286            CR-IND-GRP = '1'                                      ECSRIRTN
 14287             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 276
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14288                                                                  ECSRIRTN
 14289     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14290         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14291             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14292                                                                  ECSRIRTN
 14293     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14294         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14295            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14296                                                                  ECSRIRTN
 14297     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14298         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14299            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14300                                                                  ECSRIRTN
 14301     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14302         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14303             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14304                                                                  ECSRIRTN
 14305     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14306        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14307                                                                  ECSRIRTN
 14308     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14309         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14310                                                                  ECSRIRTN
 14311     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14312         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14313                                                                  ECSRIRTN
 14314     IF CR-AH-TERM  NUMERIC                                       00002331
 14315        NEXT SENTENCE                                             00002332
 14316     ELSE                                                         00002333
 14317        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14318     END-IF
 14319                                                                  00002335
 14320     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14321         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14322                                                                  ECSRIRTN
 14323     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14324         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14325                                                                  ECSRIRTN
 14326     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14327                                                                  ECSRIRTN
 14328     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14329         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14330             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14331                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14332                                                                  ECSRIRTN
 14333     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14334         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14335             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14336                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14337                                                                  ECSRIRTN
 14338     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14339     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14340                                                                  ECSRIRTN
 14341     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14342         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14343                                                                  ECSRIRTN
 14344     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
 14345         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 277
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14346                                                                  ECSRIRTN
 14347     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14348                                                                  ECSRIRTN
 14349     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14350                                                                  ECSRIRTN
 14351     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14352         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14353                                                                  ECSRIRTN
 14354     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14355         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14356                                                                  ECSRIRTN
 14357     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14358                                                                  ECSRIRTN
 14359 REINSURE-CK-AH-X.                                                ECSRIRTN
 14360     EXIT.                                                        ECSRIRTN
 14361                                                                  ECSRIRTN
 14362 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14363                                                                  ECSRIRTN
 14364     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14365        RS-AH-BEN = ZERO                                          ECSRIRTN
 14366         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14367                                                                  ECSRIRTN
 14368     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14369        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14370         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14371                                                                  ECSRIRTN
 14372     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14373                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14374                                                                  ECSRIRTN
 14375     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14376         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14377             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14378                                     WT-AHBEN-HI.                 ECSRIRTN
 14379     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14380         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14381             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14382                                     WT-AHMOA-HI.                 ECSRIRTN
 14383                                                                  ECSRIRTN
 14384     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14385     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14386                                                                  ECSRIRTN
 14387     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14388         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14389                                                                  ECSRIRTN
 14390     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14391         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14392                                                                  ECSRIRTN
 14393     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14394                                                                  ECSRIRTN
 14395     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14396         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14397                                                                  ECSRIRTN
 14398     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14399         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14400                                       / RW-AHWRK                 ECSRIRTN
 14401       ELSE                                                       ECSRIRTN
 14402         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
 14403                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 278
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14404     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14405         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14406                                       / RS-LIFE-BEN              ECSRIRTN
 14407       ELSE                                                       ECSRIRTN
 14408         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14409                                                                  ECSRIRTN
 14410     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14411        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14412          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14413          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14414                                      / CR-AH-TERM.               ECSRIRTN
 14415                                                                  ECSRIRTN
 14416     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14417        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14418          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14419          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14420               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14421            ELSE                                                  ECSRIRTN
 14422                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14423                                                                  ECSRIRTN
 14424     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14425        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14426        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14427          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14428          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14429                                      / CR-AH-TERM                ECSRIRTN
 14430         ELSE                                                     ECSRIRTN
 14431          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14432          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14433               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14434            ELSE                                                  ECSRIRTN
 14435                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14436                                                                  ECSRIRTN
 14437 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14438     EXIT.                                                        ECSRIRTN
 14439                                                                  ECSRIRTN
 14440                                                                  ECSRIRTN
 14441 REIN-CALC-LIFE.                                                  ECSRIRTN
 14442                                                                  ECSRIRTN
 14443     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14444         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14445     ELSE                                                         ECSRIRTN
 14446         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14447                                                                  ECSRIRTN
 14448     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14449         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14450     ELSE                                                         ECSRIRTN
 14451         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14452           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14453               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14454           ELSE                                                   ECSRIRTN
 14455               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14456                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14457                                                                  ECSRIRTN
 14458 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14459                                                                  ECSRIRTN
 14460     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
 14461                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 279
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14462     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14463         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14464                                                                  ECSRIRTN
 14465     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14466         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14467         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14468                                                                  ECSRIRTN
 14469     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14470         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14471                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14472         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14473                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14474     ELSE                                                         ECSRIRTN
 14475         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14476             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14477             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14478                                                                  ECSRIRTN
 14479     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14480         (WT-LF-QC = '2' AND                                         CL**8
 14481          PGM-SUB = +50  AND                                         CL**8
 14482          DTE-CLIENT = 'LAP'))                                       CL**8
 14483          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14484     ELSE                                                         ECSRIRTN
 14485         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14486                                                                  ECSRIRTN
 14487     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14488         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14489         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14490         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14491                                                                  ECSRIRTN
 14492     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14493                                                                  ECSRIRTN
 14494 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14495                                                                  ECSRIRTN
 14496     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14497         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14498         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14499                                                                  ECSRIRTN
 14500     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14501     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14502     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14503                                       RW-LFPRM.                  ECSRIRTN
 14504                                                                  ECSRIRTN
 14505 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14506                                                                  ECSRIRTN
 14507     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14508                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14509                                                                  ECSRIRTN
 14510     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14511        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14512                                                                  ECSRIRTN
 14513     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14514        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14515         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14516     ELSE                                                         ECSRIRTN
 14517         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14518         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
 14519                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 280
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14520                                                                  ECSRIRTN
 14521 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14522     EXIT.                                                        ECSRIRTN
 14523                                                                  ECSRIRTN
 14524 REIN-CALC-AH.                                                    ECSRIRTN
 14525                                                                  ECSRIRTN
 14526     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14527         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14528             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14529                                 WT-AHBEN-HI.                     ECSRIRTN
 14530                                                                  ECSRIRTN
 14531     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14532         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14533             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14534                                 WT-AHMOA-HI.                     ECSRIRTN
 14535                                                                  ECSRIRTN
 14536     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14537     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14538                                                                  ECSRIRTN
 14539     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14540         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14541                                                                  ECSRIRTN
 14542     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14543         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14544                                                                  ECSRIRTN
 14545     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14546         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14547                                                                  ECSRIRTN
 14548     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14549         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14550     ELSE                                                         ECSRIRTN
 14551         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14552             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14553         ELSE                                                     ECSRIRTN
 14554             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14555             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14556                                                                  ECSRIRTN
 14557 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14558                                                                  ECSRIRTN
 14559     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14560         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14561                                                                  ECSRIRTN
 14562     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14563         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14564         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14565                                                                  ECSRIRTN
 14566     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14567         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14568                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14569         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14570                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14571     ELSE                                                         ECSRIRTN
 14572         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14573             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14574             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14575                                                                  ECSRIRTN
 14576     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
 14577         (WT-AH-QC = '2' AND                                         CL**8
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 281
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14578          PGM-SUB = +50  AND                                         CL**8
 14579          DTE-CLIENT = 'LAP'))                                       CL**8
 14580         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14581     ELSE                                                         ECSRIRTN
 14582         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14583                                                                  ECSRIRTN
 14584     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14585         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14586            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14587                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14588                                                                  ECSRIRTN
 14589     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14590         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14591         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14592         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14593                                                                  ECSRIRTN
 14594     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14595                                                                  ECSRIRTN
 14596 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14597                                                                  ECSRIRTN
 14598     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14599         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14600         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14601                                                                  ECSRIRTN
 14602     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14603     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14604     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14605                                    RW-AHPRM.                     ECSRIRTN
 14606                                                                  ECSRIRTN
 14607 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14608                                                                  ECSRIRTN
 14609     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14610                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14611                                                                  ECSRIRTN
 14612     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14613                                                                  ECSRIRTN
 14614     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14615        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14616         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14617     ELSE                                                         ECSRIRTN
 14618         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14619         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14620                                                                  ECSRIRTN
 14621                                                                  ECSRIRTN
 14622 REIN-CALC-AH-X.                                                  ECSRIRTN
 14623     EXIT.                                                        ECSRIRTN
 14624                                                                  ECSRIRTN
 14625 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14626                                                                  ECSRIRTN
 14627     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14628     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14629     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14630     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14631                                                                  ECSRIRTN
 14632     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14633         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14634                                                                  ECSRIRTN
 14635     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 282
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14636        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14637           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14638                                                                  ECSRIRTN
 14639     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14640        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14641           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14642                                                                  ECSRIRTN
 14643 REINSURE-CALC-X.                                                 ECSRIRTN
 14644                                                                  ECSRIRTN
 14645     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14646         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14647                                                                  ECSRIRTN
 14648     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14649                                                                  ECSRIRTN
 14650 REINSURE-SUBTRACT.                                               ECSRIRTN
 14651                                                                  ECSRIRTN
 14652     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14653     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14654     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14655     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14656                                                                  ECSRIRTN
 14657 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14658     EXIT.                                                        ECSRIRTN
 14659                                                                  ECSRIRTN
 14660 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14661                                                                  ECSRIRTN
 14662     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14663     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14664                                                                  ECSRIRTN
 14665     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14666         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14667                                                                  ECSRIRTN
 14668     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14669         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14670                                                                  ECSRIRTN
 14671     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14672         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14673             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14674                                                                  ECSRIRTN
 14675     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14676         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14677                                                                  ECSRIRTN
 14678     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14679         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14680         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14681                                                                  ECSRIRTN
 14682     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14683        MOVE ZERO                TO REIN-FACTOR
 14684     ELSE                                                         ECSRIRTN
 14685        IF DTE-CLIENT = 'GIC'  AND
 14686           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14687           MOVE +1.0             TO REIN-FACTOR
 14688        ELSE
 14689           IF DTE-CLIENT = 'DCC'
 14690              COMPUTE REIN-FACTOR = CR-LFRFND /
 14691                 (CR-LFPRM + CR-LFPRM-ALT)
 14692           ELSE
 14693              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 283
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14694                 (CR-LFPRM + CR-LFPRM-ALT)
 14695            END-IF
 14696         END-IF
 14697     END-IF
 14698                                                                  ECSRIRTN
 14699     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14700         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14701             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14702                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14703                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14704             ELSE                                                 ECSRIRTN
 14705                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14706                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14707                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14708                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14709         ELSE                                                     ECSRIRTN
 14710             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14711                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
 14712                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
 14713             ELSE                                                 ECSRIRTN
 14714*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14715*                   * REIN-CALCED-LIFE *
 14716*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14717                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14718                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14719                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14720                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14721                                                                  ECSRIRTN
 14722     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14723         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14724             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14725                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14726                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14727             ELSE                                                 ECSRIRTN
 14728                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14729                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14730                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14731                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14732                                                                  ECSRIRTN
 14733     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14734                                                                  ECSRIRTN
 14735                                                                  ECSRIRTN
 14736 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14737                                                                  ECSRIRTN
 14738     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14739       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14740         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14741         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14742                                                                  ECSRIRTN
 14743     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14744       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14745           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14746           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14747       ELSE                                                       ECSRIRTN
 14748           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
 14749               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14750                                                                  ECSRIRTN
 14751     IF FLAT-CANCEL-LF                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 284
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14752         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14753         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14754                                                                  ECSRIRTN
 14755     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14756         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14757         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14758                                                                  ECSRIRTN
 14759     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14760     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14761     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14762                                         RW-LFRFND.               ECSRIRTN
 14763                                                                  ECSRIRTN
 14764 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14765                                                                  ECSRIRTN
 14766     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14767                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14768                                                                  ECSRIRTN
 14769     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14770        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14771                                                                  ECSRIRTN
 14772     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14773        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14774         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14775     ELSE                                                         ECSRIRTN
 14776         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14777         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14778                                                                  ECSRIRTN
 14779                                                                  ECSRIRTN
 14780 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14781                                                                  ECSRIRTN
 14782     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14783         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14784                                                                  ECSRIRTN
 14785     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14786         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14787             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14788                                                                  ECSRIRTN
 14789     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14790         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14791         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14792             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14793                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14794         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14795                                                                  ECSRIRTN
 14796     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14797         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14798                                                                  ECSRIRTN
 14799     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14800         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14801         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14802                                                                  ECSRIRTN
 14803     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14804        MOVE ZERO                TO REIN-FACTOR
 14805     ELSE
 14806        IF DTE-CLIENT = 'GIC'  AND
 14807           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14808            MOVE +1.0            TO REIN-FACTOR
 14809        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 285
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14810           IF DTE-CLIENT = 'DCC'
 14811              COMPUTE REIN-FACTOR =
 14812                 CR-AHRFND / CR-AHPRM
 14813           ELSE
 14814              COMPUTE REIN-FACTOR ROUNDED =
 14815                                CR-AHRFND-CALC / CR-AHPRM
 14816           END-IF
 14817        END-IF
 14818     END-IF
 14819
 14820     IF CR-AHAMT NOT = ZERO
 14821        IF (DTE-CLIENT = 'DCC')
 14822           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14823           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14824        ELSE
 14825           IF WT-AH-QC = ('1' OR '4')
 14826              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
 14827                       RWF-AHAMT) / CR-AHAMT
 14828           ELSE
 14829              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14830              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14831                       RWF-AHAMT) / CR-AHAMT
 14832           END-IF
 14833        END-IF
 14834     ELSE
 14835        IF RWF-AH-LIMIT = ZERO
 14836           IF WT-AH-QC = ('1' OR '4')
 14837              COMPUTE RWF-AHRFND ROUNDED =
 14838                       CR-AHRFND * WT-AH-PCT
 14839           ELSE
 14840              COMPUTE RWF-AHRFND =
 14841                            REIN-FACTOR * REIN-CALCED-AH
 14842              COMPUTE RWF-AHRFND ROUNDED =
 14843                       RWF-AHRFND * WT-AH-PCT
 14844           END-IF
 14845        END-IF
 14846     END-IF
 14847
 14848     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14849                                                                  ECSRIRTN
 14850                                                                  ECSRIRTN
 14851 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14852                                                                  ECSRIRTN
 14853     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14854       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14855         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14856         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14857                                                                  ECSRIRTN
 14858     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14859       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14860           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14861           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14862       ELSE                                                       ECSRIRTN
 14863           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 14864               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14865                                                                  ECSRIRTN
 14866     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14867         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 286
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14868         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14869                                                                  ECSRIRTN
 14870     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14871         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14872         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14873                                                                  ECSRIRTN
 14874     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14875     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14876     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14877                                    RW-AHRFND.                    ECSRIRTN
 14878                                                                  ECSRIRTN
 14879 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14880                                                                  ECSRIRTN
 14881     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14882                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14883                                                                  ECSRIRTN
 14884     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14885                                                                  ECSRIRTN
 14886     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14887        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14888         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14889     ELSE                                                         ECSRIRTN
 14890         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14891         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14892                                                                  ECSRIRTN
 14893                                                                  ECSRIRTN
 14894 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14895                                                                  ECSRIRTN
 14896     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14897         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14898                                                                  ECSRIRTN
 14899     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14900         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14901                                                                  ECSRIRTN
 14902     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14903                                                                  ECSRIRTN
 14904 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14905                                                                  ECSRIRTN
 14906     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14907     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14908                                                                  ECSRIRTN
 14909     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14910         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14911             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14912                                                                  ECSRIRTN
 14913     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14914         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14915                                                                  ECSRIRTN
 14916     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14917         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14918                                                                  ECSRIRTN
 14919 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14920                                                                  ECSRIRTN
 14921     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14922         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14923                                                                  ECSRIRTN
 14924     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14925                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 287
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14926 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14927                                                                  ECSRIRTN
 14928     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14929     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14930                                                                  ECSRIRTN
 14931 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14932     EXIT.                                                        ECSRIRTN
 14933                                                                  ECSRIRTN
 14934 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14935                                                                  ECSRIRTN
 14936     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14937         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14938                                                                  ECSRIRTN
 14939 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14940     EXIT.                                                        ECSRIRTN
 14941                                                                  ECSRIRTN
 14942 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14943                                                                  ECSRIRTN
 14944     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14945     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14946                                                                  ECSRIRTN
 14947     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14948         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14949                                                                  ECSRIRTN
 14950     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14951        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14952          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14953          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14954          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14955                                                                  ECSRIRTN
 14956     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14957        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14958          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14959                                                                  ECSRIRTN
 14960     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14961                                  RWF-AHCLML.                     ECSRIRTN
 14962                                                                  ECSRIRTN
 14963     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14964         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14965                                                                  ECSRIRTN
 14966     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14967         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14968                                                                  ECSRIRTN
 14969     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14970         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14971             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14972                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14973                                                                  ECSRIRTN
 14974     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14975         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14976                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14977                                                                  ECSRIRTN
 14978     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14979         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 14980                                                                  ECSRIRTN
 14981     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14982         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14983             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 288
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14984                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14985             ELSE                                                 ECSRIRTN
 14986                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14987         ELSE                                                     ECSRIRTN
 14988             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14989                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14990                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14991             ELSE                                                 ECSRIRTN
 14992                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14993                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14994                                                                  ECSRIRTN
 14995     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14996         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14997                                                                  ECSRIRTN
 14998     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14999         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 15000            OR 'DCC'
 15001             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 15002                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 15003         ELSE                                                     ECSRIRTN
 15004             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 15005                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 15006                                                                  ECSRIRTN
 15007     IF CR-LFAMT = ZERO                                           ECSRIRTN
 15008         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 15009             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15010                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 15011                                                                  ECSRIRTN
 15012     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15013         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15014             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15015                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 15016                                                                  ECSRIRTN
 15017     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15018         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15019             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15020               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 15021                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15022                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15023                  ELSE                                            ECSRIRTN
 15024                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15025                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15026              ELSE                                                ECSRIRTN
 15027                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15028                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15029                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15030                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15031                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15032                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15033                                                                  ECSRIRTN
 15034     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15035                                                                  ECSRIRTN
 15036     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15037                                                                  ECSRIRTN
 15038                                                                  ECSRIRTN
 15039 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15040                                                                  ECSRIRTN
 15041     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 289
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15042         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15043                                                                  ECSRIRTN
 15044     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15045         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15046     ELSE                                                         ECSRIRTN
 15047         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15048                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15049                                                                  ECSRIRTN
 15050     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15051         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15052                                                                  ECSRIRTN
 15053     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15054         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15055             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15056         ELSE                                                     ECSRIRTN
 15057             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15058     ELSE                                                         ECSRIRTN
 15059         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15060             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15061             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15062         ELSE                                                     ECSRIRTN
 15063             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15064             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15065                                                                  ECSRIRTN
 15066                                                                  ECSRIRTN
 15067 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15068                                                                  ECSRIRTN
 15069     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15070         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15071                                                                  ECSRIRTN
 15072     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15073         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15074                                                                  ECSRIRTN
 15075     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15076         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15077                                                                  ECSRIRTN
 15078     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15079     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15080                                                                  ECSRIRTN
 15081     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15082             VARYING                                              ECSRIRTN
 15083         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15084             UNTIL                                                ECSRIRTN
 15085         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15086                                                                  ECSRIRTN
 15087     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15088         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15089     ELSE                                                         ECSRIRTN
 15090         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15091                                                                  ECSRIRTN
 15092 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15093                                                                  ECSRIRTN
 15094     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15095         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15096                                                                  ECSRIRTN
 15097     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15098       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15099           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 290
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15100                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15101               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15102                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15103               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15104                                                                  ECSRIRTN
 15105     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15106       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15107           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15108                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15109           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15110                                                                  ECSRIRTN
 15111     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15112         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15113                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15114                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15115         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15116                                                                  ECSRIRTN
 15117     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15118         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15119                                                                  ECSRIRTN
 15120     IF INC-SUB = +1                                              ECSRIRTN
 15121         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15122     IF INC-SUB = +2                                              ECSRIRTN
 15123         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15124     IF INC-SUB = +3                                              ECSRIRTN
 15125         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15126     IF INC-SUB = +4                                              ECSRIRTN
 15127         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15128     IF INC-SUB = +5                                              ECSRIRTN
 15129         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15130                                                                  ECSRIRTN
 15131     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15132                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15133                                                                  ECSRIRTN
 15134     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15135         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15136                                                                  ECSRIRTN
 15137     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15138              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15139         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15140     ELSE                                                         ECSRIRTN
 15141         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15142                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15143                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15144                                                                  ECSRIRTN
 15145 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15146      EXIT.                                                       ECSRIRTN
 15147                                                                  ECSRIRTN
 15148 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15149                                                                  ECSRIRTN
 15150     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15151         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15152                                                                  ECSRIRTN
 15153     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15154         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15155             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15156                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15157                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 291
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15158     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15159         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15160             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15161                                                                  ECSRIRTN
 15162 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15163                                                                  ECSRIRTN
 15164     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15165         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15166         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15167             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15168                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15169         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15170         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15171                                                                  ECSRIRTN
 15172     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15173         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15174                                                                  ECSRIRTN
 15175     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15176         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15177             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15178                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15179             ELSE                                                 ECSRIRTN
 15180                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15181         ELSE                                                     ECSRIRTN
 15182             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15183                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15184                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15185             ELSE                                                 ECSRIRTN
 15186                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15187                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15188                                                                  ECSRIRTN
 15189     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15190         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15191                                                                  ECSRIRTN
 15192     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15193         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15194                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15195     ELSE                                                         ECSRIRTN
 15196         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15197             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15198                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15199                                                                  ECSRIRTN
 15200     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15201         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15202             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15203                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15204                                                                  ECSRIRTN
 15205     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15206         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15207             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15208               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15209                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15210                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15211                  ELSE                                            ECSRIRTN
 15212                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15213                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15214              ELSE                                                ECSRIRTN
 15215                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 292
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15216                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15217                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15218                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15219                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15220                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15221                                                                  ECSRIRTN
 15222                                                                  ECSRIRTN
 15223     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15224        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15225                               '220000' OR '230000')              ECSRIRTN
 15226           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15227               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15228                                                                  ECSRIRTN
 15229     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15230                                                                  ECSRIRTN
 15231     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15232                                                                  ECSRIRTN
 15233                                                                  ECSRIRTN
 15234 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15235                                                                  ECSRIRTN
 15236     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15237         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15238                                                                  ECSRIRTN
 15239     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15240         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15241         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15242                                                                  ECSRIRTN
 15243     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15244                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15245                                                                  ECSRIRTN
 15246     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15247         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15248                                                                  ECSRIRTN
 15249     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15250         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15251                                                                  ECSRIRTN
 15252     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15253                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15254         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15255                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15256         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15257     ELSE                                                         ECSRIRTN
 15258         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15259         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15260                                                                  ECSRIRTN
 15261                                                                  ECSRIRTN
 15262 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15263                                                                  ECSRIRTN
 15264     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15265         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15266                                                                  ECSRIRTN
 15267     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15268         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15269                                                                  ECSRIRTN
 15270     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15271                                                                  ECSRIRTN
 15272 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15273                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 293
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15274     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15275     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15276                                                                  ECSRIRTN
 15277     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15278         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15279             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15280                                                                  ECSRIRTN
 15281     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15282     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15283                                                                  ECSRIRTN
 15284     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15285         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15286                                                                  ECSRIRTN
 15287     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15288         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15289                                                                  ECSRIRTN
 15290 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15291                                                                  ECSRIRTN
 15292     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15293         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15294                                                                  ECSRIRTN
 15295     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15296                                                                  ECSRIRTN
 15297 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15298                                                                  ECSRIRTN
 15299     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15300     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15301                                                                  ECSRIRTN
 15302 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15303     EXIT.                                                        ECSRIRTN
 15304                                                                  ECSRIRTN
 15305 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15306                                                                  ECSRIRTN
 15307     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15308         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15309                                                                  ECSRIRTN
 15310 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15311     EXIT.                                                        ECSRIRTN
 15312                                                                  ECSRIRTN
 15313                                                                  ECSRIRTN
 15314 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15315                                                                  ECSRIRTN
 15316     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15317     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15318     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15319     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15320                                                                  ECSRIRTN
 15321     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15322         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15323         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15324         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15325         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15326         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15327         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 15328         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15329         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15330         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15331                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 294
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15332     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15333         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15334                                                                  ECSRIRTN
 15335     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15336                                                                  ECSRIRTN
 15337 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15338                                                                  ECSRIRTN
 15339     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15340                                                                  ECSRIRTN
 15341 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15342     EXIT.                                                        ECSRIRTN
 15343                                                                  ECSRIRTN
 15344 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15345                                                                  ECSRIRTN
 15346     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15347                                                                  ECSRIRTN
 15348     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15349         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15350                                                                  ECSRIRTN
 15351     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15352         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15353             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15354                                                                  ECSRIRTN
 15355     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15356         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15357         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15358         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15359     ELSE                                                         ECSRIRTN
 15360         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15361         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15362         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15363                                                                  ECSRIRTN
 15364     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15365                                                                  ECSRIRTN
 15366     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15367        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15368         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15369                                                                  ECSRIRTN
 15370     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15371         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15372                                                                  ECSRIRTN
 15373 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15374     EXIT.                                                        ECSRIRTN
 15375                                                                  ECSRIRTN
 15376 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15377                                                                  ECSRIRTN
 15378     CONTINUE.                                                    ECSRIRTN
 15379*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15380 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15381     EXIT.                                                        ECSRIRTN
 15382                                                                  ECSRIRTN
 15383 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15384                                                                  ECSRIRTN
 15385     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 15386         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15387                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15388                                                                  ECSRIRTN
 15389     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 295
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15390         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15391                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15392                                                                  ECSRIRTN
 15393     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15394                                                                  ECSRIRTN
 15395     START ERRTBL-IN                                              ECSRIRTN
 15396           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15397             INVALID KEY                                          ECSRIRTN
 15398               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15399                                                                  ECSRIRTN
 15400     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15401     MOVE 0 TO SUB1.                                              ECSRIRTN
 15402 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15403                                                                  ECSRIRTN
 15404     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15405                                                                  ECSRIRTN
 15406     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15407        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15408                                                                  ECSRIRTN
 15409     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15410        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15411        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15412                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15413        GO TO ABEND-PGM.                                          ECSRIRTN
 15414                                                                  ECSRIRTN
 15415     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15416        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15417                                                                  ECSRIRTN
 15418     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15419        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15420                                                                  ECSRIRTN
 15421     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15422        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15423                                                                  ECSRIRTN
 15424     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15425        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15426                                                                  ECSRIRTN
 15427     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15428        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15429                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15430        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15431                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15432        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15433                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15434     END-PERFORM.                                                 ECSRIRTN
 15435     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15436                                                                  ECSRIRTN
 15437     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15438        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15439                                                                  ECSRIRTN
 15440     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15441        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 296
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15442                                                                  ECSRIRTN
 15443     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15444        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15445                                                                  ECSRIRTN
 15446     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15447        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15448                                                                  ECSRIRTN
 15449     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15450        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15451        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15452        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15453        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15454        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15455        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15456          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15457                                                                  ECSRIRTN
 15458     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15459                                                                  ECSRIRTN
 15460     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15461        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15462        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15463        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15464        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15465                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15466        GO TO ABEND-PGM.                                          ECSRIRTN
 15467                                                                  ECSRIRTN
 15468     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15469                                                                  ECSRIRTN
 15470     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15471                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15472     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15473                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15474     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15475                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15476                                                                  ECSRIRTN
 15477     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15478         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15479     ELSE                                                         ECSRIRTN
 15480         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15481                                                                  ECSRIRTN
 15482     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15483     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15484     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15485     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15486                                                                  ECSRIRTN
 15487 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15488                                                                  ECSRIRTN
 15489     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15490        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15491                                                                  ECSRIRTN
 15492     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15493        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15494                                                                  ECSRIRTN
 15495     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15496        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15497                                                                  ECSRIRTN
 15498     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15499        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 297
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15500                                                                  ECSRIRTN
 15501     ADD +1 TO SUB1.                                              ECSRIRTN
 15502                                                                  ECSRIRTN
 15503     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15504        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15505        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15506                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15507        GO TO ABEND-PGM.                                          ECSRIRTN
 15508                                                                  ECSRIRTN
 15509     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15510     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15511     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15512     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15513     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15514     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15515     if re-state-exhibit-opt-f = 'Y'
 15516        move 'Y'         to rc2-ecs152-rpt (sub1)
 15517     else
 15518        move 'N'         to rc2-ecs152-rpt (sub1)
 15519     end-if
 15520                                                                  ECSRIRTN
 15521     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15522                                                                  ECSRIRTN
 15523 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15524     EXIT.                                                        ECSRIRTN
 15525                                                                  ECSRIRTN
 15526 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15527                                                                  ECSRIRTN
 15528     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15529                                                                  ECSRIRTN
 15530     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15531                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15532                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15533                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15534                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15535                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15536                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15537                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15538                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15539                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15540                                                                  ECSRIRTN
 15541 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15542     EXIT.                                                        ECSRIRTN
 15543                                                                  ECSRIRTN
 15544 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15545                                                                  ECSRIRTN
 15546     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15547                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15548     move spaces      to rc2-ecs152-rpt (co-sub)
 15549                                                                  ECSRIRTN
 15550     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15551                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15552                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15553                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 15554                                                                  ECSRIRTN
 15555 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15556     EXIT.                                                        ECSRIRTN
 15557******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 298
* ECS010.cbl
 15559******************************************************************
 15560***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15561******************************************************************
 15562
 15563 3600-RC-REINSURANCE.
 15564
 15565     IF DTE-PGM-OPT NOT = '1'
 15566         GO TO 3799-RC-REINSURANCE-X.
 15567
 15568     IF DTE-CLIENT = 'WSL'
 15569         IF CR-REIN-TABLE = '00A'
 15570             GO TO 3799-RC-REINSURANCE-X.
 15571
 15572     IF CR-REIN-TABLE = SPACES OR ZEROS
 15573         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15574
 15575 3610-CLEAR-RC-REIN.
 15576
 15577     MOVE SPACES TO RC-REIN-LEVELS (1).
 15578     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15579                    RC-REIN-LFPRM (1)
 15580                    RC-REIN-AHAMT (1)
 15581                    RC-REIN-AHPRM (1)
 15582                    RC-REIN-LFRFND (1)
 15583                    RC-REIN-AHRFND (1)
 15584                    RC-REIN-LFCLM (1)
 15585                    RC-REIN-AHCLM (1).
 15586
 15587     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15588         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15589
 15590     MOVE +1 TO SUB1.
 15591     MOVE +0 TO SUB2.
 15592
 15593     GO TO 3630-RC-REIN-LOOP-1.
 15594
 15595 3620-CLEAR-RC-LEVELS.
 15596
 15597     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15598
 15599
 15600 3630-RC-REIN-LOOP-1.
 15601
 15602     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15603         ADD +1 TO SUB2
 15604         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15605         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15606         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15607         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15608         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15609         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15610         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15611         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15612         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15613         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15614
 15615     ADD +1 TO SUB1.
 15616     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 299
* ECS010.cbl
 15617         GO TO 3630-RC-REIN-LOOP-1.
 15618
 15619     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15620
 15621     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15622     IF CR-REIN-TABLE = SPACES OR ZEROS
 15623         MOVE +1                     TO SUB1
 15624         GO TO 3710-RC-REIN-LOOP-2.
 15625
 15626     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15627
 15628 3640-NSP-REIN-RATING-ROUTINE.
 15629
 15630     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15631     MOVE 'L'                        TO DC-OPTION-CODE.
 15632     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15633     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15634     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15635     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15636     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15637     MOVE CR-APR                     TO CP-LOAN-APR.
 15638     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15639     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15640     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15641     MOVE ZEROS                      TO CP-CLASS-CODE.
 15642
 15643     IF DTE-CLIENT = 'TIC'
 15644        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15645            MOVE ZERO                TO CP-CLASS-CODE
 15646        ELSE
 15647            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15648
 15649     MOVE '3'                        TO CP-PROCESS-TYPE.
 15650     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15651     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15652
 15653 3650-NSP-REIN-LIFE.
 15654
 15655     IF CR-LFTYP = ZERO
 15656         GO TO 3660-NSP-REIN-AH.
 15657     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15658        OR (DTE-CLIENT = 'DCC')
 15659         GO TO 3660-NSP-REIN-AH.
 15660     IF DTE-CLIENT NOT = 'LBL'
 15661         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15662             GO TO 3660-NSP-REIN-AH.
 15663
 15664     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15665         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15666         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15667
 15668     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15669     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15670     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15671                                        CP-RATING-BENEFIT-AMT.
 15672     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15673     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15674     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 300
* ECS010.cbl
 15675     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15676     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15677     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15678     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15679
 15680     IF CP-STATE-STD-ABBRV = 'OR'
 15681         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15682
 15683     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15684
 15685     IF CP-ERROR-RATE-NOT-FOUND  OR
 15686        CP-ERROR-RATE-IS-ZERO
 15687         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15688                                     TO WS-ABEND-MESSAGE
 15689         MOVE 0302                   TO WS-ABEND-CODE
 15690         DISPLAY '******************************'
 15691         DISPLAY '***** ERROR LOCATION 018 *****'
 15692         DISPLAY '******************************'
 15693         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15694         GO TO ABEND-PGM.
 15695
 15696     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15697
 15698*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15699*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15700
 15701     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15702                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15703
 15704     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15705
 15706 3660-NSP-REIN-AH.
 15707
 15708     IF CR-AHTYP = ZERO
 15709         GO TO 3669-NSP-REIN-X.
 15710     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15711        OR (DTE-CLIENT = 'DCC')
 15712         GO TO 3669-NSP-REIN-X.
 15713     IF DTE-CLIENT NOT = 'LBL'
 15714         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15715             GO TO 3669-NSP-REIN-X.
 15716
 15717     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15718         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15719         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15720
 15721     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15722     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15723     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15724                                        CP-RATING-BENEFIT-AMT.
 15725     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15726     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15727     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15728     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15729     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15730     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15731     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15732
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 301
* ECS010.cbl
 15733     IF CP-STATE-STD-ABBRV = 'OR'
 15734         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15735
 15736     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15737
 15738     IF CP-ERROR-RATE-NOT-FOUND  OR
 15739        CP-ERROR-RATE-IS-ZERO
 15740         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15741                                     TO WS-ABEND-MESSAGE
 15742         MOVE 0302                   TO WS-ABEND-CODE
 15743         DISPLAY '******************************'
 15744         DISPLAY '***** ERROR LOCATION 019 *****'
 15745         DISPLAY '******************************'
 15746         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15747         GO TO ABEND-PGM.
 15748
 15749     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15750             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15751
 15752     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15753
 15754 3669-NSP-REIN-X.
 15755     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 302
* ECS010.cbl
 15757******************************************************************
 15758***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15759******************************************************************
 15760
 15761 3700-RC-REIN-PERF-CALC.
 15762
*15763                             COPY ECSRTPFM.
 15764******************************************************************07/10/97
 15765*                                                                *ECSRTPFM
 15766*                            ECSRTPFM                            *   LV001
 15767*                            VMOD=2.002                          *ECSRTPFM
 15768*                                                                *ECSRTPFM
 15769******************************************************************ECSRTPFM
 15770                                                                  ECSRTPFM
 15771     IF    CR-LFAMT  NUMERIC                                      00000072
 15772           NEXT SENTENCE                                          00000073
 15773        ELSE                                                      00000074
 15774           MOVE ZEROS TO CR-LFAMT.                                00000075
 15775                                                                  00000076
 15776     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15777           NEXT SENTENCE                                          00000078
 15778        ELSE                                                      00000079
 15779           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15780                                                                  00000081
 15781                                                                  00000082
 15782     IF    CR-LFPRM  NUMERIC                                      00000083
 15783           NEXT SENTENCE                                          00000084
 15784        ELSE                                                      00000085
 15785           MOVE ZEROS TO CR-LFPRM.                                00000086
 15786                                                                  00000087
 15787     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15788           NEXT SENTENCE                                          00000089
 15789        ELSE                                                      00000090
 15790           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15791                                                                  00000092
 15792                                                                  00000093
 15793     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15794           NEXT SENTENCE                                          00000095
 15795        ELSE                                                      00000096
 15796           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15797                                                                  00000098
 15798     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15799           NEXT SENTENCE                                          00000100
 15800        ELSE                                                      00000101
 15801           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15802                                                                  00000103
 15803     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15804           NEXT SENTENCE                                          00000105
 15805        ELSE                                                      00000106
 15806           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15807                                                                  00000108
 15808     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15809     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15810     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15811         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15812     ELSE                                                         ECSRTPFM
 15813         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15814     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 303
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15815                                                                  ECSRTPFM
 15816     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15817     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15818     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15819         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15820     ELSE                                                         ECSRTPFM
 15821         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15822     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15823                                                                  ECSRTPFM
 15824     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15825         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15826             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15827                                                                  ECSRTPFM
 15828
 15829     IF CR-STATE NOT = STATE-L
 15830         MOVE CR-STATE               TO STATE-L
 15831         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15832
 15833     MOVE 'X'                     TO REIN-RT-SW.
 15834     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15835     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15836     MOVE ' '                     TO REIN-RT-SW.
 15837
 15838 3710-RC-REIN-LOOP-2.
 15839
 15840     IF REIN-COMP (SUB1) = SPACES
 15841         GO TO 3730-RC-REIN-EXTRACTS.
 15842
 15843     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15844        ADD +1 TO SUB1
 15845         GO TO 3710-RC-REIN-LOOP-2.
 15846
 15847     MOVE +1 TO SUB2.
 15848
 15849 3720-RC-REIN-LOOP-3.
 15850
 15851     IF RC-REIN-COMP (SUB2) = SPACES
 15852         ADD +1 TO SUB1
 15853         GO TO 3710-RC-REIN-LOOP-2.
 15854
 15855     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15856         ADD +1 TO SUB2
 15857         GO TO 3720-RC-REIN-LOOP-3.
 15858
 15859     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15860        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15861        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15862        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15863         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15864         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15865
 15866     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15867        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15868         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15869         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15870
 15871     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15872         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 304
* ECS010.cbl
 15873         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15874
 15875     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15876         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15877         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15878
 15879     ADD +1 TO SUB2.
 15880     GO TO 3720-RC-REIN-LOOP-3.
 15881
 15882 3730-RC-REIN-EXTRACTS.
 15883
 15884     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15885     MOVE 'R' TO DE-REIN.
 15886     MOVE 'J' TO DE-TRANS.
 15887*****PERFORM EXTRACT-DATE-RELOAD.
 15888     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15889     MOVE +1 TO SUB1.
 15890
 15891 3740-RC-REIN-OLD-ISSUE.
 15892
 15893     IF RC-REIN-COMP (SUB1) = SPACES
 15894         MOVE +1 TO SUB1
 15895         GO TO 3745-RC-REIN-NEW-ISSUE.
 15896
 15897     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15898         ADD +1 TO SUB1
 15899         GO TO 3740-RC-REIN-OLD-ISSUE.
 15900
 15901     IF RC-OLD-ISS (SUB1) = 'X'
 15902         ADD +1 TO SUB1
 15903         GO TO 3740-RC-REIN-OLD-ISSUE.
 15904
 15905     IF RC-REIN-LFAMT (SUB1) = ZERO
 15906        AND RC-REIN-LFPRM (SUB1) = ZERO
 15907        AND RC-REIN-AHAMT (SUB1) = ZERO
 15908        AND RC-REIN-AHPRM (SUB1) = ZERO
 15909         ADD +1 TO SUB1
 15910         GO TO 3740-RC-REIN-OLD-ISSUE.
 15911
 15912     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15913     PERFORM EXTRACT-DATE-LOAD.
 15914     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15915     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15916     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15917     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15918     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15919     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15920
 15921     ADD +1 TO BC-R-ISS.
 15922     ADD +1 TO SUB1.
 15923     GO TO 3740-RC-REIN-OLD-ISSUE.
 15924
 15925 3745-RC-REIN-NEW-ISSUE.
 15926
 15927     IF REIN-COMP (SUB1) = SPACES
 15928         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15929                                         2259-END-CANCEL-BUILD
 15930         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 305
* ECS010.cbl
 15931         MOVE 'K'      TO DE-TRANS
 15932*********PERFORM EXTRACT-DATE-RELOAD
 15933         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15934         MOVE +1       TO SUB1
 15935         GO TO 3750-RC-REIN-OLD-CANCEL.
 15936
 15937     IF REIN-REM-SW (SUB1) = 'Z'
 15938         ADD +1 TO SUB1
 15939         GO TO 3745-RC-REIN-NEW-ISSUE.
 15940
 15941     IF RC-NEW-ISS (SUB1) = 'X'
 15942         ADD +1 TO SUB1
 15943         GO TO 3745-RC-REIN-NEW-ISSUE.
 15944
 15945     IF REIN-LFAMT (SUB1) = ZERO
 15946        AND REIN-LFPRM (SUB1) = ZERO
 15947        AND REIN-AHAMT (SUB1) = ZERO
 15948        AND REIN-AHPRM (SUB1) = ZERO
 15949         ADD +1 TO SUB1
 15950         GO TO 3745-RC-REIN-NEW-ISSUE.
 15951
 15952     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15953     PERFORM EXTRACT-DATE-LOAD.
 15954     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15955     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15956     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15957     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15958     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15959     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15960
 15961     ADD +1 TO BC-R-ISS.
 15962     ADD +1 TO SUB1.
 15963     GO TO 3745-RC-REIN-NEW-ISSUE.
 15964
 15965 3750-RC-REIN-OLD-CANCEL.
 15966
 15967     IF RC-REIN-COMP (SUB1) = SPACES
 15968         MOVE +1 TO SUB1
 15969         GO TO 3755-RC-REIN-NEW-CANCEL.
 15970
 15971     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15972         ADD +1 TO SUB1
 15973         GO TO 3750-RC-REIN-OLD-CANCEL.
 15974
 15975     IF RC-OLD-CNC (SUB1) = 'X'
 15976         ADD +1 TO SUB1
 15977         GO TO 3750-RC-REIN-OLD-CANCEL.
 15978
 15979     IF RC-REIN-LFRFND (SUB1) = ZERO
 15980        AND RC-REIN-AHRFND (SUB1) = ZERO
 15981         ADD +1 TO SUB1
 15982         GO TO 3750-RC-REIN-OLD-CANCEL.
 15983
 15984     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15985     PERFORM EXTRACT-DATE-LOAD.
 15986     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15987     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15988     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 306
* ECS010.cbl
 15989     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15990
 15991     ADD +1 TO BC-R-CNC.
 15992     ADD +1 TO SUB1.
 15993     GO TO 3750-RC-REIN-OLD-CANCEL.
 15994
 15995 3755-RC-REIN-NEW-CANCEL.
 15996
 15997     IF REIN-COMP (SUB1) = SPACES
 15998         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15999         MOVE 'R' TO DE-REIN
 16000         MOVE 'L' TO DE-TRANS
 16001*********PERFORM EXTRACT-DATE-RELOAD
 16002         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16003         MOVE +1 TO SUB1
 16004         GO TO 3760-RC-REIN-OLD-CLAIM.
 16005
 16006     IF REIN-REM-SW (SUB1) = 'Z'
 16007         ADD +1 TO SUB1
 16008         GO TO 3755-RC-REIN-NEW-CANCEL.
 16009
 16010     IF RC-NEW-CNC (SUB1) = 'X'
 16011         ADD +1 TO SUB1
 16012         GO TO 3755-RC-REIN-NEW-CANCEL.
 16013
 16014     IF REIN-LFRFND (SUB1) = ZERO
 16015        AND REIN-AHRFND (SUB1) = ZERO
 16016         ADD +1 TO SUB1
 16017         GO TO 3755-RC-REIN-NEW-CANCEL.
 16018
 16019     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 16020     PERFORM EXTRACT-DATE-LOAD.
 16021     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 16022     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 16023     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 16024     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16025
 16026     ADD +1 TO BC-R-CNC.
 16027     ADD +1 TO SUB1.
 16028     GO TO 3755-RC-REIN-NEW-CANCEL.
 16029
 16030 3760-RC-REIN-OLD-CLAIM.
 16031
 16032     IF RC-REIN-COMP (SUB1) = SPACES
 16033         MOVE +1 TO SUB1
 16034         GO TO 3780-RC-REIN-NEW-CLAIM.
 16035
 16036     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16037         ADD +1 TO SUB1
 16038         GO TO 3760-RC-REIN-OLD-CLAIM.
 16039
 16040     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16041         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16042
 16043     IF RC-REIN-LFCLM (SUB1) = ZERO
 16044         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16045
 16046     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 307
* ECS010.cbl
 16047     PERFORM EXTRACT-DATE-LOAD.
 16048     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16049     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16050     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16051     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16052     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16053     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16054     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16055     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16056     MOVE CR-DTH-PAY-DT TO DE-PAY
 16057                           WS-DE-PAY-N.
 16058
 16059     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16060         MOVE '3' TO DE-TYPE
 16061     ELSE
 16062         MOVE '1' TO DE-TYPE.
 16063
 16064     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16065
 16066     ADD +1 TO BC-R-CLM.
 16067
 16068 3770-RC-REIN-OLD-AH-CLM.
 16069
 16070     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16071         ADD +1 TO SUB1
 16072         GO TO 3760-RC-REIN-OLD-CLAIM.
 16073
 16074     IF RC-REIN-AHCLM (SUB1) = ZERO
 16075         ADD +1 TO SUB1
 16076         GO TO 3760-RC-REIN-OLD-CLAIM.
 16077
 16078     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16079     PERFORM EXTRACT-DATE-LOAD.
 16080     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16081     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16082     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16083     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16084     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16085     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16086     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16087     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16088     MOVE CR-DIS-PAY-DT TO DE-PAY
 16089                           WS-DE-PAY-N.
 16090
 16091     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16092         MOVE '4' TO DE-TYPE
 16093     ELSE
 16094         MOVE '2' TO DE-TYPE.
 16095
 16096     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16097
 16098     ADD +1 TO BC-R-CLM.
 16099     ADD +1 TO SUB1.
 16100
 16101     GO TO 3760-RC-REIN-OLD-CLAIM.
 16102
 16103 3780-RC-REIN-NEW-CLAIM.
 16104
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 308
* ECS010.cbl
 16105     IF REIN-COMP (SUB1) = SPACES
 16106         GO TO 3799-RC-REINSURANCE-X.
 16107
 16108     IF REIN-REM-SW (SUB1) = 'Z'
 16109         ADD +1 TO SUB1
 16110         GO TO 3780-RC-REIN-NEW-CLAIM.
 16111
 16112     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16113         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16114
 16115     IF REIN-LFCLM (SUB1) = ZERO
 16116         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16117
 16118     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16119     PERFORM EXTRACT-DATE-LOAD.
 16120     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16121     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16122     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16123     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16124     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16125     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16126     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16127     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16128     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16129                               WS-DE-PAY-N.
 16130
 16131     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16132         MOVE '3' TO DE-TYPE
 16133     ELSE
 16134         MOVE '1' TO DE-TYPE.
 16135
 16136     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16137
 16138     ADD +1 TO BC-R-CLM.
 16139
 16140 3790-RC-REIN-NEW-AH-CLM.
 16141
 16142     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16143         ADD +1 TO SUB1
 16144         GO TO 3780-RC-REIN-NEW-CLAIM.
 16145
 16146     IF REIN-AHCLM (SUB1) = ZERO
 16147         ADD +1 TO SUB1
 16148         GO TO 3780-RC-REIN-NEW-CLAIM.
 16149
 16150     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16151     PERFORM EXTRACT-DATE-LOAD.
 16152     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16153     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16154     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16155     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16156     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16157     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16158     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16159     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16160     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16161                               WS-DE-PAY-N.
 16162
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 309
* ECS010.cbl
 16163     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16164         MOVE '4' TO DE-TYPE
 16165     ELSE
 16166         MOVE '2' TO DE-TYPE.
 16167
 16168     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16169
 16170     ADD +1 TO BC-R-CLM.
 16171     ADD +1 TO SUB1.
 16172
 16173     GO TO 3780-RC-REIN-NEW-CLAIM.
 16174
 16175 3799-RC-REINSURANCE-X.
 16176     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 310
* ECS010.cbl
 16178******************************************************************
 16179***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16180******************************************************************
 16181
 16182 4000-EP-BUMP-RTN.
 16183
 16184     IF AM-RECALC-COMM = ('Y' OR '1')
 16185        PERFORM 1600-RECALC-COMM-EXTR
 16186                                 THRU 1899-RECALC-COMM-EXTR-X
 16187        MOVE ' '                 TO RECALC-TYPE
 16188     END-IF
 16189
 16190     MOVE '1'    TO EP-FLG.
 16191     ADD +1      TO BC-G-CERTS.
 16192
 16193     MOVE CR-DT               TO HIGH-CERT.
 16194     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16195         MOVE CR-DT           TO LOW-CERT
 16196         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16197
 16198     IF CR-POLICY-IS-REIN-ONLY
 16199         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16200                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16201                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16202                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16203                              DTH-IBNR           DIS-IBNR
 16204                              DTH-PAYCUR         DIS-PAYCUR
 16205                              DTH-FUTRSV         DIS-FUTRSV
 16206         GO TO 4050-EP-DO-REINSURE.
 16207
 16208     MOVE CR-LFAMT       TO WE-LFAMT.
 16209     MOVE CR-LFPRM       TO WE-LFPRM.
 16210     IF CR-LFTYP NOT = ZEROS
 16211         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16212             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16213             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16214         ELSE
 16215             MOVE ZEROS               TO WE-LFAMT-ALT
 16216                                         WE-LFPRM-ALT.
 16217
 16218     MOVE SPACES         TO REIN-EP-FLG
 16219                            WE-REIN-CO.
 16220     MOVE CR-LFRFND      TO WE-LFRFND.
 16221     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16222     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16223     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16224     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16225     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16226     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16227     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16228
 16229     MOVE CR-AHPRM       TO WE-AHPRM.
 16230     MOVE CR-AHAMT       TO WE-AHAMT.
 16231     MOVE CR-AHRFND      TO WE-AHRFND.
 16232     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16233     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16234     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16235     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 311
* ECS010.cbl
 16236     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16237     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16238     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16239
 16240     IF CR-POLICY-IS-RESTORE  OR
 16241        CR-POLICY-IS-REISSUE
 16242        OR CR-POLICY-IS-MONTHLY
 16243         MOVE ZEROS      TO WE-LFPRM
 16244                            WE-LFPRM-ALT
 16245                            WE-AHPRM.
 16246
 16247     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16248                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16249                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16250                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16251                              DTH-IBNR           DIS-IBNR
 16252                              DTH-PAYCUR         DIS-PAYCUR
 16253                              DTH-FUTRSV         DIS-FUTRSV.
 16254
 16255*     DISPLAY ' B4 4100 '
 16256     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16257*     DISPLAY ' AFTER 4100 '
 16258
 16259     IF CR-POLICY-IS-DECLINED  OR
 16260        CR-POLICY-IS-VOID
 16261         GO TO 4099-EP-BUMP-RTN-X.
 16262
 16263 4050-EP-DO-REINSURE.
 16264
 16265     MOVE 'R' TO REIN-EP-FLG.
 16266     MOVE +1  TO SUB5.
 16267
 16268 4090-EP-DO-REINSURE-LOOP.
 16269
 16270*     DISPLAY ' 4090 '
 16271     IF REIN-COMP (SUB5) = SPACES
 16272         MOVE SPACE TO REIN-EP-FLG
 16273         GO TO 4099-EP-BUMP-RTN-X.
 16274
 16275     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16276        REIN-LF-AH-FLGS (SUB5) = SPACES
 16277         ADD +1 TO SUB5
 16278         GO TO 4090-EP-DO-REINSURE-LOOP.
 16279
 16280     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16281        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16282          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16283          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16284          (RCT-REIN-CO (CO-SUB) = SPACES).
 16285
 16286     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16287        (RCT-REIN-CO (CO-SUB) = SPACES)
 16288        MOVE ZERO TO CO-SUB.
 16289
 16290*     DISPLAY ' 4090 A '
 16291*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16292     ADD +1 TO BC-R-CERTS.
 16293     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 312
* ECS010.cbl
 16294     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16295     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16296
 16297     IF (DTE-CLIENT = 'DCC')
 16298        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16299*        DISPLAY ' B4 CEDE FACT '
 16300*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16301*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16302*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16303        COMPUTE WS-CEDE-FACT =
 16304           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16305*        DISPLAY ' AFTER CEDE FACT '
 16306        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16307           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16308                                     NOT = 'G' AND 'L')
 16309           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16310*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16311*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16312           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16313           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16314        END-IF
 16315     END-IF
 16316
 16317     MOVE RWF-LFPRM      TO WE-LFPRM.
 16318     MOVE RWF-LFAMT      TO WE-LFAMT.
 16319     MOVE RWF-LFRFND     TO WE-LFRFND.
 16320     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16321     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16322     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16323     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16324     MOVE +0             TO WE-LFAMT-ALT
 16325                            WE-LFPRM-ALT
 16326                            WE-DTHEXP
 16327                            WE-NUM-DTH-CLM.
 16328
 16329*     DISPLAY ' 4090 B '
 16330     IF (DTE-CLIENT EQUAL 'NSL') AND
 16331        (CR-REIN-TABLE EQUAL 'NAR')
 16332        CONTINUE
 16333     ELSE
 16334      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16335       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16336        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16337            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16338        COMPUTE WE-LFAMT ROUNDED EQUAL
 16339                           CR-LFAMT * WS-CEDE-FACT
 16340        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16341                           CR-LFAMT-ALT * WS-CEDE-FACT
 16342        IF (DTE-CLIENT = 'CID')
 16343           AND (CR-LF-NSP-PRM > +0)
 16344           AND (CR-ENTRY-DATE > 20031130)
 16345           AND (WT-LF-QC NOT = '1' AND '3')
 16346           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16347              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16348           MOVE +0            TO WE-LFPRM-ALT
 16349        ELSE
 16350          IF (DTE-CLIENT = 'CID')
 16351             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 313
* ECS010.cbl
 16352             AND (CR-ENTRY-DATE > 20030430)
 16353             AND (WT-LF-QC NOT = '1' AND '3')
 16354             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16355             MOVE +0            TO WE-LFPRM-ALT
 16356          ELSE
 16357             COMPUTE WE-LFPRM ROUNDED EQUAL
 16358                           CR-LFPRM * WS-CEDE-FACT
 16359             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16360                           CR-LFPRM-ALT * WS-CEDE-FACT
 16361          END-IF
 16362        END-IF
 16363        IF (DTE-CLIENT = 'CID')
 16364           AND (CR-LF-NSP-PRM > +0)
 16365           AND (CR-LFRFND-CALC > +0)
 16366           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16367           AND (WT-LF-QC NOT = '1' AND '4')
 16368           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16369              (CR-LFPRM + CR-LFPRM-ALT)
 16370           COMPUTE WE-LFRFND =
 16371              REIN-FACTOR * REIN-CALCED-LIFE
 16372           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16373              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16374*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16375*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16376*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16377        ELSE
 16378
 16379          IF (DTE-CLIENT = 'CID')
 16380           AND (CR-LF-NSP-PRM > +0)
 16381           AND (CR-LFRFND-CALC > +0)
 16382           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16383           AND (WT-LF-QC NOT = '1' AND '4')
 16384           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16385           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16386              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16387
 16388          END-IF
 16389        END-IF
 16390       ELSE
 16391         MOVE +0 TO WS-CEDE-FACT
 16392       END-IF
 16393      END-IF
 16394     END-IF
 16395
 16396*     DISPLAY ' 4090 C '
 16397     IF DTE-CLIENT = 'DCC'
 16398        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16399           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16400                                   NOT = 'G' AND 'L')
 16401           AND (CR-AHAMT NOT = ZEROS)
 16402*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16403           COMPUTE WS-CEDE-FACT =
 16404               RWF-AHAMT / CR-AHAMT
 16405           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16406*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16407*          / CR-AHPRM * CR-AHRFND
 16408           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16409           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 314
* ECS010.cbl
 16410        END-IF
 16411     END-IF
 16412
 16413     MOVE RWF-AHPRM      TO WE-AHPRM.
 16414
 16415     MOVE RWF-AHAMT      TO WE-AHAMT
 16416     MOVE RWF-AHRFND     TO WE-AHRFND.
 16417     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16418     MOVE +0             TO WE-DSPY-EXP
 16419                            WE-NUM-DIS-CLM.
 16420     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16421     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16422     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16423
 16424     IF  RWF-LF-RUNOFF-SW = 'N'
 16425             OR
 16426         RWF-AH-RUNOFF-SW = 'N'
 16427         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16428
 16429     IF  RWF-LF-RUNOFF-SW = 'N'
 16430         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16431     ELSE
 16432         MOVE 99999999             TO STOP-LF-DATE.
 16433
 16434     IF  RWF-AH-RUNOFF-SW = 'N'
 16435         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16436     ELSE
 16437         MOVE 99999999             TO STOP-AH-DATE.
 16438
 16439     IF CR-POLICY-IS-RESTORE  OR
 16440        CR-POLICY-IS-REISSUE
 16441        OR CR-POLICY-IS-MONTHLY
 16442         MOVE ZEROS      TO WE-LFPRM
 16443                            WE-LFPRM-ALT
 16444                            WE-AHPRM.
 16445
 16446*     DISPLAY ' B4 4100-EP-DO-LF '
 16447     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16448*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16449
 16450     IF CO-SUB NOT = ZERO
 16451       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16452         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16453             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16454
 16455     ADD +1 TO SUB5.
 16456     GO TO 4090-EP-DO-REINSURE-LOOP.
 16457
 16458 4099-EP-BUMP-RTN-X.
 16459     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 315
* ECS010.cbl
 16461******************************************************************
 16462***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16463******************************************************************
 16464
 16465 4100-EP-DO-LF.
 16466
 16467     MOVE +0                         TO ISS-BEN  EPR-R78
 16468                                        CNC-BEN  EPR-PRO
 16469                                        ISS-PRM  EPR-ST
 16470                                        ISS-PRMTAX
 16471                                        CNC-PRM  ACTIVE-COUNT.
 16472     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16473
 16474     IF CR-LFTYP = ZERO
 16475         GO TO 4200-EP-DO-AH.
 16476
 16477     IF REIN-EP-FLG = 'R'
 16478         IF REIN-LF-FLG (SUB5) = SPACE
 16479             GO TO 4200-EP-DO-AH.
 16480
 16481     IF CR-APR NOT NUMERIC
 16482         MOVE ZERO TO CR-APR.
 16483
 16484     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16485     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16486     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16487
 16488     IF CR-POLICY-IS-DECLINED  OR
 16489        CR-POLICY-IS-VOID
 16490         GO TO 4191-CONTINUE.
 16491
 16492     MOVE CR-LF-TERM             TO ORIG-TERM.
 16493     MOVE CLAS-INDEXL            TO W-NDX.
 16494
 16495     IF CR-DT GREATER EW-COV-DTE
 16496         MOVE CR-DT              TO EW-COV-DTE.
 16497
 16498     IF (NOT CR-POLICY-IS-RESTORE) AND
 16499        (NOT CR-POLICY-IS-REISSUE)
 16500        AND (NOT CR-POLICY-IS-MONTHLY)
 16501         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16502         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16503             ADD CR-LIVES TO EW-ISS-CNT
 16504             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16505                                    (ORIG-TERM * CR-LIVES)
 16506             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16507             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16508             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16509                                   (ORIG-TERM * ISS-BEN)
 16510         ELSE
 16511             IF (DTE-CLIENT = 'DCC')
 16512                AND (CR-LFTYP = 'DD')
 16513                CONTINUE
 16514             ELSE
 16515                ADD +1 TO EW-ISS-CNT
 16516             END-IF
 16517             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16518             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 316
* ECS010.cbl
 16519             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16520             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16521                                   (ORIG-TERM * ISS-BEN).
 16522
 16523     MOVE RUN-DATE        TO VALUATION-DT.
 16524     MOVE '2'             TO W-VAL-SOURCE.
 16525
 16526     IF REIN-EP-FLG = 'R'
 16527         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16528            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16529             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16530             MOVE '10'              TO W-VAL-SOURCE.
 16531
 16532     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16533
 16534     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16535        (REM-TRM3 GREATER ZERO)
 16536        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16537            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16538                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16539            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16540                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16541          ELSE
 16542            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16543            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16544
 16545     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16546
 16547     IF DTE-CLIENT = 'GIC'
 16548         IF REIN-EP-FLG NOT = 'R'  AND
 16549            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16550            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16551            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16552
 16553     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16554         GO TO 4105-EP-DO-LF-REIN-CHK.
 16555
 16556     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16557             AND
 16558         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16559             AND
 16560         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16561                 OR
 16562             CR-LF-CANC-DT EQUAL ZEROS)
 16563             AND
 16564         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16565                 OR
 16566             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16567         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16568         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16569                 VARYING
 16570             SUBM FROM +1 BY +1
 16571                 UNTIL
 16572             SUBM GREATER THAN +13.
 16573
 16574     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16575     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16576
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 317
* ECS010.cbl
 16577 4105-EP-DO-LF-REIN-CHK.
 16578
 16579     IF REIN-EP-FLG = 'R'  AND
 16580        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16581         NEXT SENTENCE
 16582     ELSE
 16583         GO TO 4110-EP-DO-LF-CLM.
 16584
 16585     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16586         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16587             GO TO 4130-EP-DO-LF-EP.
 16588
 16589     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16590         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16591             GO TO 4130-EP-DO-LF-EP.
 16592
 16593 4110-EP-DO-LF-CLM.
 16594
 16595     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16596         NEXT  SENTENCE
 16597       ELSE
 16598         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16599
 16600     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16601     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16602
 16603     IF CR-LF-STATUS-AT-DEATH = ' '
 16604         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16605             GO TO 4115-EP-DO-LF-CLM-EPR.
 16606
 16607     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16608     ADD +1             TO EW-CLM-CRT.
 16609
 16610 4115-EP-DO-LF-CLM-EPR.
 16611
 16612     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16613         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16614         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16615     END-IF
 16616     .
 16617 4120-EP-DO-LF-CNCL.
 16618
 16619     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16620        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16621         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16622             GO TO 4190-EP-DO-LF-COMM
 16623         ELSE
 16624             GO TO 4130-EP-DO-LF-EP.
 16625
 16626     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16627         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16628         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16629
 16630     IF CR-LFTYP NOT = 'DD'
 16631        ADD +1                    TO EW-CNC-CNT
 16632     END-IF
 16633
 16634     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 318
* ECS010.cbl
 16635
 16636     IF DTE-CLIENT = 'GIC'
 16637         IF REIN-EP-FLG NOT = 'R'  AND
 16638            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16639             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16640
 16641*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16642*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16643*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16644*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16645
 16646     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16647     MOVE 'L'                   TO  DC-OPTION-CODE.
 16648     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16649     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16650
 16651     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16652     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16653     MOVE '1'                     TO  DC-OPTION-CODE.
 16654     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16655     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16656     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16657                                      DC-ODD-DAYS-OVER
 16658                                      DC-ELAPSED-DAYS.
 16659     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16660     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16661
 16662     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16663         ADD  +1                  TO  MONTHS-DIFF-LF.
 16664
 16665     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16666
 16667     if (dte-client = 'AHL')
 16668        and (cr-lf-cancel-exit-date < 20120401)
 16669        go to 4120-continue-life-cancel
 16670     end-if
 16671
 16672     IF DTE-CLIENT = 'ACE'
 16673         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16674
 16675     MOVE  ZEROS                  TO  SUB.
 16676
 16677 4120-LIFE-CHARGEBACK-LOOP.
 16678
 16679     ADD    +1                    TO  SUB.
 16680
 16681     IF  SUB  GREATER THAN  +10
 16682         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16683
 16684     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16685         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16686         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16687
 16688     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16689         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16690
 16691     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16692         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 319
* ECS010.cbl
 16693
 16694     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16695
 16696
 16697 4120-CONTINUE-LIFE-CANCEL.
 16698
 16699     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16700     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16701
 16702     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16703         GO TO 4190-EP-DO-LF-COMM.
 16704
 16705     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16706         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16707         GO TO 4190-EP-DO-LF-COMM.
 16708
 16709     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16710     MOVE '3'           TO W-VAL-SOURCE.
 16711     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16712
 16713     IF REM-TRM3 = CR-LF-TERM
 16714         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16715         GO TO 4190-EP-DO-LF-COMM.
 16716
 16717     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16718         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16719
 16720     IF DTE-CLIENT = 'NCL'
 16721         IF CR-DT LESS THAN 19910101
 16722             GO TO 4121-EP-DO-LF-CNC-BEN.
 16723
 16724     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16725         GO TO 4126-EP-DO-LF-CNCL-NP.
 16726
 16727     IF DTE-CLIENT = 'FUL'
 16728         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16729
 16730*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16731     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16732        (CR-RATING-CLASS NOT = 'L ')
 16733         IF (CR-APR GREATER THAN ZERO)  AND
 16734            (CR-LF-TERM GREATER THAN 060)  AND
 16735            (CR-DT GREATER THAN 19831031)
 16736              GO TO 4126-EP-DO-LF-CNCL-NP.
 16737
 16738     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16739         IF (CR-APR GREATER THAN ZERO)  AND
 16740            (CR-LF-TERM GREATER THAN 061)  AND
 16741            (CR-DT GREATER THAN 19830318)
 16742              GO TO 4126-EP-DO-LF-CNCL-NP.
 16743
 16744     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16745         IF (CR-APR GREATER THAN ZERO)  AND
 16746            (CR-LF-TERM GREATER THAN 062)  AND
 16747            (CR-DT GREATER THAN 19810831)  AND
 16748            (CR-DT LESS THAN 19830901)
 16749              GO TO 4126-EP-DO-LF-CNCL-NP.
 16750
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 320
* ECS010.cbl
 16751     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16752         IF (CR-APR GREATER THAN ZERO)  AND
 16753            (CR-LF-TERM GREATER THAN 060)  AND
 16754            (CR-DT GREATER THAN 19831231)
 16755              GO TO 4126-EP-DO-LF-CNCL-NP.
 16756
 16757 4121-EP-DO-LF-CNC-BEN.
 16758
 16759     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16760
 16761     COMPUTE TEMP-3 ROUNDED EQUAL
 16762         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16763
 16764     MOVE TEMP-3                 TO CNC-BEN.
 16765
 16766     GO TO 4190-EP-DO-LF-COMM.
 16767
 16768 4122-EP-DO-LF-CNCL-TEX.
 16769
 16770     DIVIDE WE-LFAMT BY CR-LF-TERM
 16771         GIVING TEX-FACT-1.
 16772     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16773         GIVING TEX-FACT-2
 16774             REMAINDER TEX-FACT-3.
 16775     IF TEX-FACT-3 NOT = ZERO
 16776         ADD +1 TO TEX-FACT-2.
 16777
 16778     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16779
 16780     GO TO 4190-EP-DO-LF-COMM.
 16781
 16782 4124-EP-DO-LF-CNCL-SUM.
 16783
 16784     IF WE-LFRFND = ZERO
 16785         GO TO 4130-EP-DO-LF-EP.
 16786
 16787     MOVE WE-LFRFND TO CNC-PRM.
 16788
 16789     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16790
 16791     IF WE-LFRFND NOT LESS WE-LFPRM
 16792         MOVE WE-LFAMT TO CNC-BEN
 16793          GO TO 4130-EP-DO-LF-EP.
 16794
 16795
 16796     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16797
 16798     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16799         MOVE TEMP-7 TO CNC-BEN
 16800          GO TO 4130-EP-DO-LF-EP.
 16801
 16802     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16803     MOVE '4'           TO W-VAL-SOURCE.
 16804     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16805
 16806     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16807         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16808         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 321
* ECS010.cbl
 16809
 16810 4126-EP-DO-LF-CNCL-NP.
 16811
 16812     IF WE-LFAMT = ZERO
 16813        GO TO 4190-EP-DO-LF-COMM.
 16814
 16815     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16816     MOVE 'L'                        TO  DC-OPTION-CODE.
 16817     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16818     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16819
 16820     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16821       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16822       MOVE '3'                      TO  DC-OPTION-CODE
 16823       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16824       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16825     ELSE
 16826       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16827       MOVE '6'                      TO  DC-OPTION-CODE
 16828       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16829       MOVE +0                       TO  DC-ELAPSED-DAYS
 16830       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16831       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16832
 16833     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16834     MOVE CR-APR                     TO  CP-LOAN-APR.
 16835     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16836     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16837     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16838     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16839     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16840     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16841
 16842
 16843     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16844     IF (DTE-CLIENT = 'DCC')
 16845        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16846        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16847           ((CR-STATE = DD-STATE (D1))
 16848           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16849           AND ('A'           = DD-BEN-TYPE   (D1))
 16850           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 16851           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16852                           OR
 16853           D1 > max-pdef
 16854        END-PERFORM
 16855        IF D1 <= max-pdef
 16856           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 16857              (P1 > +8)
 16858              OR (DD-PROD-CODE (D1 P1) = 'L')
 16859           END-PERFORM
 16860           IF P1 < +9
 16861              MOVE DD-MAX-BEN-AMT (D1 P1)
 16862                                 TO CP-R-MAX-TOT-BEN
 16863           END-IF
 16864        END-IF
 16865     END-IF
 16866
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 322
* ECS010.cbl
 16867     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16868
 16869     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16870       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16871       GO TO 4130-EP-DO-LF-EP
 16872     ELSE
 16873       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16874
 16875     GO TO 4190-EP-DO-LF-COMM.
 16876
 16877 4128-EP-DO-LF-CNCL-FUL.
 16878
 16879     IF WE-LFAMT = ZERO
 16880        GO TO 4190-EP-DO-LF-COMM.
 16881
 16882     MOVE CR-APR              TO NP-APR.
 16883     MOVE CR-LF-TERM          TO NP-ORIG.
 16884     MOVE REM-TRM3            TO NP-REM.
 16885     MOVE '2'                 TO NP-OPT.
 16886     MOVE CR-AHPRM            TO NP-AHPRM.
 16887     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16888     MOVE CR-LFAMT            TO NP-BENEFIT.
 16889
 16890*    CALL 'FULNETRM'
 16891*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16892*              NP-ACCOUNT NP-REMAINING.
 16893
 16894     MOVE NP-REMAINING TO CNC-BEN.
 16895
 16896     GO TO 4190-EP-DO-LF-COMM.
 16897
 16898 4130-EP-DO-LF-EP.
 16899
 16900     MOVE SPACE                  TO STATUTORY-SWITCH.
 16901
 16902     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16903     MOVE '5'           TO W-VAL-SOURCE.
 16904
 16905     IF REIN-EP-FLG = 'R'
 16906       IF REIN-REM-SW (SUB5) = 'I'
 16907           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16908           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16909           GO TO 4190-EP-DO-LF-COMM.
 16910
 16911     IF REIN-EP-FLG = 'R'
 16912         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16913            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16914             MOVE '*'               TO LIFE-EARNED-SWITCH
 16915             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16916             MOVE '10'              TO W-VAL-SOURCE.
 16917
 16918     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16919
 16920     IF REM-TRM2 GREATER CR-LF-TERM
 16921         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16922         GO TO 4190-EP-DO-LF-COMM.
 16923
 16924     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 323
* ECS010.cbl
 16925         GO TO 4180-EP-DO-LF-EP-SUM.
 16926
 16927     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16928         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16929             IF REM-TRM2 NOT GREATER THAN +0
 16930                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16931                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16932                 GO TO 4190-EP-DO-LF-COMM
 16933             ELSE
 16934                 NEXT SENTENCE
 16935         ELSE
 16936             IF W-BAL-REMTRM NOT GREATER +0
 16937                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16938                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16939                 GO TO 4190-EP-DO-LF-COMM
 16940             ELSE
 16941                 NEXT SENTENCE
 16942     ELSE
 16943        IF DTE-CLIENT = 'NCL'  AND
 16944           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16945            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16946        ELSE
 16947         IF REM-TRM2 NOT GREATER +0  OR
 16948            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16949             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16950             GO TO 4190-EP-DO-LF-COMM.
 16951
 16952     MOVE +1 TO ACTIVE-COUNT.
 16953
 16954     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16955         GO TO 4140-EP-DO-LF-EP-TEX.
 16956
 16957     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16958         GO TO 4150-EP-DO-LF-EP-NP.
 16959
 16960*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16961     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16962        (CR-RATING-CLASS NOT = 'L ')
 16963         IF (CR-APR GREATER THAN ZERO)  AND
 16964            (CR-LF-TERM GREATER THAN 060)  AND
 16965            (CR-DT GREATER THAN 19831031)
 16966             MOVE '*'             TO STATUTORY-SWITCH
 16967              GO TO 4150-EP-DO-LF-EP-NP.
 16968
 16969     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16970         IF (CR-APR GREATER THAN ZERO)  AND
 16971            (CR-LF-TERM GREATER THAN 061)  AND
 16972            (CR-DT GREATER THAN 19830318)
 16973             MOVE '*'             TO STATUTORY-SWITCH
 16974              GO TO 4150-EP-DO-LF-EP-NP.
 16975
 16976     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16977         IF (CR-APR GREATER THAN ZERO)  AND
 16978            (CR-LF-TERM GREATER THAN 062)  AND
 16979            (CR-DT GREATER THAN 19810831)  AND
 16980            (CR-DT LESS THAN 19830901)
 16981             MOVE '*'             TO STATUTORY-SWITCH
 16982              GO TO 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 324
* ECS010.cbl
 16983
 16984     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16985         IF (CR-APR GREATER THAN ZERO)  AND
 16986            (CR-LF-TERM GREATER THAN 060)  AND
 16987            (CR-DT GREATER THAN 19831231)
 16988             MOVE '*'             TO STATUTORY-SWITCH
 16989              GO TO 4150-EP-DO-LF-EP-NP.
 16990
 16991     GO TO 4160-EP-DO-LF-EP-R78.
 16992
 16993 4140-EP-DO-LF-EP-TEX.
 16994
 16995     IF CR-PMT-FREQ = 0
 16996       DISPLAY '*************************************'
 16997       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16998       DISPLAY '*************************************'
 16999       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 17000       DISPLAY '*************************************'
 17001       COMPUTE TEX-FACT-4 =
 17002          (CR-LF-TERM * CR-LF-TERM) +
 17003                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 17004     ELSE
 17005        COMPUTE TEX-FACT-4 =
 17006         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17007
 17008     IF CR-PMT-FREQ = 0
 17009       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 17010           GIVING TEX-FACT-5
 17011               REMAINDER TEX-FACT-6
 17012     ELSE
 17013        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17014            GIVING TEX-FACT-5
 17015                REMAINDER TEX-FACT-6.
 17016
 17017     IF CR-PMT-FREQ > 0
 17018        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 17019
 17020     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17021     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17022         (TEX-FACT-5 * CR-PMT-FREQ) +
 17023         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17024     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17025
 17026     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17027
 17028     GO TO 4170-EP-DO-LF-EP-PRO.
 17029
 17030 4150-EP-DO-LF-EP-NP.
 17031
 17032     IF WE-LFPRM = ZERO
 17033         GO TO 4160-EP-DO-LF-EP-R78.
 17034
 17035     if cr-apr = zeros
 17036        display ' found 0 apr cert ' cr-cert-no
 17037        go to 4160-ep-do-lf-ep-r78
 17038     end-if
 17039     IF DTE-CLIENT = 'CRI'
 17040       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 325
* ECS010.cbl
 17041             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17042           GO TO 4160-EP-DO-LF-EP-R78.
 17043
 17044     IF DTE-CLIENT = 'AHL'
 17045        GO TO 4160-EP-DO-LF-EP-R78
 17046     END-IF
 17047
 17048     IF DTE-CLIENT = 'NCL'
 17049       IF CR-DT LESS THAN 19910101
 17050           GO TO 4160-EP-DO-LF-EP-R78.
 17051
 17052     IF REM-TRM1 = CR-LF-TERM
 17053         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17054         GO TO 4190-EP-DO-LF-COMM.
 17055
 17056     MOVE CR-APR TO NP-APR.
 17057     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17058     MOVE REM-TRM1 TO NP-REM.
 17059     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17060     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17061         MOVE CR-LOAN-TERM TO NP-ORIG.
 17062
 17063     MOVE 'R' TO NP-OPT.
 17064     CALL 'ECSNETRM'
 17065         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17066
 17067     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17068
 17069     IF STATUTORY-REQUIREMENT
 17070         MOVE EPR-R78                TO EPR-ST.
 17071
 17072 4160-EP-DO-LF-EP-R78.
 17073
 17074     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17075        (DTE-CLIENT EQUAL 'NCL')
 17076        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17077           (CR-MO EQUAL EOM-MO)
 17078           MOVE '*'            TO OB-DATE-1-SWITCH
 17079           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17080           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17081           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17082           COMPUTE WS-EPR-R78 (SUB3 1) =
 17083                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17084           GO TO 4190-EP-DO-LF-COMM
 17085        ELSE
 17086        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17087           (CR-MO EQUAL OB-MO (1))
 17088           MOVE '*'            TO OB-DATE-2-SWITCH
 17089           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17090           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17091           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17092           COMPUTE WS-EPR-R78 (SUB3 2) =
 17093                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17094           GO TO 4190-EP-DO-LF-COMM
 17095        ELSE
 17096        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17097           (CR-MO EQUAL OB-MO (2))
 17098           MOVE '*'            TO OB-DATE-3-SWITCH
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 326
* ECS010.cbl
 17099           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17100           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17101           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17102           COMPUTE WS-EPR-R78 (SUB3 3) =
 17103                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17104           GO TO 4190-EP-DO-LF-COMM
 17105        ELSE
 17106           GO TO 4190-EP-DO-LF-COMM.
 17107
 17108     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17109
 17110     IF DTE-R78 = '1'
 17111         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17112     ELSE
 17113         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17114
 17115     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17116
 17117     IF REM-TRM1 GREATER THAN +0
 17118         COMPUTE TEMP-7 ROUNDED EQUAL
 17119             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17120     ELSE
 17121         MOVE WE-LFPRM                TO TEMP-7.
 17122
 17123     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17124         MOVE TEMP-7                 TO EPR-ST.
 17125
 17126     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17127         MOVE ZEROS                  TO TEMP-8
 17128         GO TO 4165-END-LF-EP-R78.
 17129
 17130     IF EPR-ST = ZEROS
 17131         MOVE TEMP-7                 TO EPR-ST.
 17132
 17133     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17134         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17135         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17136         IF DTE-R78 = '1'
 17137             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17138
 17139     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17140
 17141     COMPUTE TEMP-8 ROUNDED =
 17142               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17143
 17144 4165-END-LF-EP-R78.
 17145
 17146     IF EPR-R78 = ZEROS
 17147         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17148     ELSE
 17149         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17150
 17151 4170-EP-DO-LF-EP-PRO.
 17152
 17153     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17154         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17155     ELSE
 17156         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 327
* ECS010.cbl
 17157
 17158     IF REM-TRM1 GREATER THAN +0
 17159         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17160     ELSE
 17161         MOVE WE-LFPRM                  TO TEMP-7.
 17162
 17163     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17164         MOVE ZEROS                     TO TEMP-8
 17165         GO TO 4175-END-LF-EP-PRO.
 17166
 17167     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17168         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17169             COMPUTE TEMP-5 ROUNDED =
 17170                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17171         ELSE
 17172             COMPUTE TEMP-5 ROUNDED =
 17173                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17174
 17175     COMPUTE TEMP-8 ROUNDED =
 17176                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17177
 17178     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17179
 17180 4175-END-LF-EP-PRO.
 17181
 17182     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17183
 17184     GO TO 4185-EP-DO-LF-STATUTORY.
 17185
 17186 4180-EP-DO-LF-EP-SUM.
 17187
 17188     IF REM-TRM1 NOT GREATER +0
 17189         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17190         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17191         GO TO 4190-EP-DO-LF-COMM.
 17192
 17193     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17194
 17195     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17196         MOVE ZEROS                 TO TEMP-7
 17197     ELSE
 17198         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17199                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17200
 17201     IF TEMP-7 NOT GREATER ZERO
 17202         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17203             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17204             GO TO 4190-EP-DO-LF-COMM
 17205         ELSE
 17206             MOVE ZEROS             TO TEMP-7.
 17207
 17208     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17209     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17210     IF DTE-R78 = '1'
 17211         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17212
 17213     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17214     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 328
* ECS010.cbl
 17215
 17216     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17217
 17218     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17219
 17220     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17221         GO TO 4185-EP-DO-LF-STATUTORY.
 17222
 17223     MOVE EPR-R78                  TO EPR-ST.
 17224
 17225     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17226         MOVE ZEROS                 TO TEMP-8
 17227     ELSE
 17228         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17229                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17230
 17231     IF TEMP-8 NOT GREATER ZERO
 17232         GO TO 4185-EP-DO-LF-STATUTORY.
 17233
 17234     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17235                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17236
 17237     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17238                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17239
 17240     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17241                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17242
 17243 4185-EP-DO-LF-STATUTORY.
 17244
 17245*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17246*07636          MOVE EPR-R78                TO EPR-ST.
 17247     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17248         MOVE EPR-PRO                TO EPR-ST.
 17249
 17250     IF DTE-CLIENT = 'AHL'
 17251        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17252           MOVE EPR-R78          TO EPR-ST
 17253        ELSE
 17254           MOVE EPR-PRO          TO EPR-ST
 17255        END-IF
 17256     END-IF
 17257
 17258     IF (DTE-CLIENT = 'CID')
 17259        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17260                   OR
 17261            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17262            AND (CR-DT > 20091231)))
 17263        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17264        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17265           GO TO 4187-EP-DO-LF-STAT-ROA
 17266     END-IF.
 17267
 17268     IF EPR-ST NOT = ZEROS
 17269         GO TO 4190-EP-DO-LF-COMM.
 17270
 17271     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17272         MOVE EPR-R78                TO EPR-ST
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 329
* ECS010.cbl
 17273     ELSE
 17274         MOVE EPR-PRO                TO EPR-ST.
 17275
 17276     GO TO 4190-EP-DO-LF-COMM.
 17277
 17278 4187-EP-DO-LF-STAT-ROA.
 17279     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17280     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17281     MOVE 'L'                        TO DC-OPTION-CODE.
 17282     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17283     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17284     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17285        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17286        MOVE '3'                     TO  DC-OPTION-CODE
 17287        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17288                              8099-DATE-CONVERT-X
 17289        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17290     ELSE
 17291        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17292        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17293        MOVE +0                      TO  DC-ELAPSED-DAYS
 17294        MOVE '6'                     TO  DC-OPTION-CODE
 17295        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17296                              8099-DATE-CONVERT-X
 17297        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17298     END-IF.
 17299     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17300     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17301     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17302     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17303     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17304     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17305     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17306     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17307     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17308     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17309                                        CP-LOAN-TERM.
 17310     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17311                                        CP-RATING-BENEFIT-AMT.
 17312     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17313     MOVE CR-APR                     TO CP-LOAN-APR.
 17314     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17315     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17316     MOVE '6'                        TO CP-EARNING-METHOD.
 17317     MOVE '3'                        TO CP-PROCESS-TYPE.
 17318     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17319     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17320         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17321     ELSE
 17322         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17323     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17324     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17325     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17326     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17327     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17328     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17329
 17330     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 330
* ECS010.cbl
 17331        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17332     END-IF
 17333
 17334     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 17335        COMPUTE CP-ORIGINAL-BENEFIT =
 17336         (CR-LFAMT - CR-LFPRM)
 17337     END-IF
 17338
 17339     IF CP-TRUNCATED-LIFE
 17340        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17341     END-IF
 17342
 17343     IF CP-TERM-IS-DAYS
 17344        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17345     ELSE
 17346        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17347     END-IF
 17348
 17349     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17350
 17351     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17352
 17353 4190-EP-DO-LF-COMM.
 17354
 17355     MOVE +0 TO SUB1.
 17356     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17357         10 TIMES.
 17358
 17359     IF REIN-EP-FLG NOT = 'R'  OR
 17360        CR-POLICY-IS-REIN-ONLY
 17361         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17362         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17363         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17364         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17365
 17366     ADD ISS-BEN TO EW-ISS-BEN.
 17367     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17368     ADD CNC-BEN TO EW-CNC-BEN.
 17369     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17370     ADD ISS-PRM TO EW-ISS-PRM.
 17371     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17372     ADD CNC-PRM TO EW-CNC-PRM.
 17373     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17374
 17375     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17376     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17377     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17378
 17379     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17380        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17381     END-IF
 17382     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17383        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17384     END-IF
 17385
 17386     COMPUTE ISS-PRMTAX =
 17387        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17388        (CNC-PRM * CR-LF-CNC-PREM-TAX)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 331
* ECS010.cbl
 17389
 17390     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17391
 17392     IF LIFE-FULLY-EARNED
 17393         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17394                                            (ISS-PRM - EPR-R78)
 17395         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17396                                            (ISS-PRM - EPR-PRO)
 17397         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17398                                            (ISS-PRM - EPR-ST).
 17399
 17400     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17401         IF  REIN-EP-FLG NOT = 'R'
 17402                 OR
 17403             CR-POLICY-IS-REIN-ONLY
 17404             MOVE 'L'      TO W-CLAIM-TYPE
 17405             MOVE EPR-R78  TO W-OPT-R78
 17406             MOVE EPR-PRO  TO W-OPT-PRO
 17407             MOVE EPR-ST   TO W-OPT-ST
 17408             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17409             MOVE ZEROS    TO EW-CLM-IBNR
 17410         ELSE
 17411             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17412                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17413                 MOVE ZEROS      TO EW-CLM-IBNR
 17414             ELSE
 17415                 MOVE ZEROS      TO EW-CLM-IBNR
 17416     ELSE
 17417         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17418             ADD WE-DTH-IBNR
 17419                       TO EW-CLM-IBNR
 17420         ELSE
 17421             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17422                     AND
 17423                 CR-DT GREATER THAN LAST-YRS-DATE
 17424                 COMPUTE  EW-CLM-IBNR
 17425                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17426
 17427     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17428     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17429
 17430 4191-CONTINUE.
 17431
 17432     MOVE 'Y'          TO EW-LEVEL-USED.
 17433
 17434     IF CR-POLICY-UNDERWRITTEN
 17435         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17436         MOVE EPEC-OPT-WORK-TABLE
 17437                              TO EPEC-UNDW-OPT-DATA-TABLE
 17438     ELSE
 17439         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17440         MOVE EPEC-OPT-WORK-TABLE
 17441                              TO EPEC-OPT-DATA-TABLE.
 17442
 17443     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 332
* ECS010.cbl
 17445 4194-SLOT-INTO-EFFECTED-MONTHS.
 17446
 17447     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17448             AND
 17449         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17450             AND
 17451         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17452                 OR
 17453          CR-LF-CANC-DT EQUAL ZEROS)
 17454             AND
 17455         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17456                 OR
 17457          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17458         MOVE 'Y'                 TO W-TABLE-USED-SW
 17459         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17460             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17461                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17462                 + CR-LIVES
 17463         ELSE
 17464             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17465                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17466
 17467 4194-EXIT.
 17468     EXIT.
 17469
 17470 4196-CALC-REM-AMT.
 17471
 17472     IF CR-LFTYP = 'QD'
 17473        MOVE +15.0               TO CR-APR
 17474     END-IF
 17475
 17476     MOVE +0                     TO WS-REM-AMT
 17477     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17478        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17479           COMPUTE WS-REM-AMT =
 17480             CR-LFAMT + CR-LFAMT-ALT
 17481        ELSE
 17482           MOVE CR-LFAMT         TO WS-REM-AMT
 17483        END-IF
 17484        GO TO 4199-EXIT
 17485     END-IF
 17486
 17487     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17488
 17489     IF REM-TRM1 = CR-LF-TERM
 17490        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17491           COMPUTE WS-REM-AMT =
 17492             CR-LFAMT + CR-LFAMT-ALT
 17493        ELSE
 17494           MOVE CR-LFAMT         TO WS-REM-AMT
 17495        END-IF
 17496        GO TO 4199-EXIT
 17497     END-IF
 17498
 17499     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17500        GO TO 4198-ORDINARY-REM
 17501     END-IF
 17502
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 333
* ECS010.cbl
 17503     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17504        GO TO 4198-CALC-TEXAS-REM
 17505     END-IF
 17506
 17507     IF CR-LFTYP = 'QD'
 17508        MOVE +15.0               TO CR-APR
 17509        MOVE 'N'                 TO
 17510                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17511        GO TO 4198-CALC-NET-PAY-REM
 17512     END-IF
 17513
 17514     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17515        GO TO 4198-CALC-NET-PAY-REM
 17516     END-IF
 17517
 17518     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17519        (CR-RATING-CLASS NOT = 'L ')
 17520         IF (CR-LF-TERM GREATER THAN +60) AND
 17521            (CR-DT GREATER THAN 19831031) AND
 17522            (CR-APR GREATER THAN ZERO)
 17523             GO TO 4198-CALC-NET-PAY-REM
 17524        END-IF
 17525     END-IF
 17526
 17527     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17528         IF (CR-LF-TERM GREATER THAN +61) AND
 17529            (CR-DT  GREATER THAN 19830318) AND
 17530            (CR-APR GREATER THAN ZERO)
 17531             GO TO 4198-CALC-NET-PAY-REM
 17532        END-IF
 17533     END-IF
 17534
 17535     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17536         IF (CR-LF-TERM GREATER THAN +62) AND
 17537            (CR-DT  GREATER THAN 19810831) AND
 17538            (CR-DT  LESS THAN 19830901) AND
 17539            (CR-APR GREATER THAN ZERO)
 17540             GO TO 4198-CALC-NET-PAY-REM
 17541        END-IF
 17542     END-IF
 17543
 17544     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17545         IF (CR-LF-TERM GREATER THAN +60) AND
 17546            (CR-DT  GREATER THAN 19831231) AND
 17547            (CR-APR GREATER THAN ZERO)
 17548             GO TO 4198-CALC-NET-PAY-REM
 17549        END-IF
 17550     END-IF
 17551
 17552     .
 17553 4198-ORDINARY-REM.
 17554
 17555     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17556         COMPUTE WS-REM-AMT ROUNDED =
 17557                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17558     ELSE
 17559         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17560     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 334
* ECS010.cbl
 17561
 17562     GO TO 4199-EXIT
 17563
 17564     .
 17565 4198-CALC-TEXAS-REM.
 17566
 17567     DIVIDE CR-LFAMT BY CR-LF-TERM
 17568         GIVING TEX-FACT-1.
 17569     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17570         GIVING TEX-FACT-2
 17571         REMAINDER TEX-FACT-3.
 17572
 17573     IF TEX-FACT-3 NOT = ZERO
 17574         ADD +1                  TO TEX-FACT-2
 17575     END-IF
 17576
 17577     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17578         MOVE CR-LFAMT           TO WS-REM-AMT
 17579     ELSE
 17580         COMPUTE WS-REM-AMT ROUNDED =
 17581             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17582     END-IF
 17583
 17584     GO TO 4199-EXIT
 17585
 17586     .
 17587 4198-CALC-NET-PAY-REM.
 17588
 17589     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17590     MOVE 'L'                        TO DC-OPTION-CODE.
 17591     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17592     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17593
 17594     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17595        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17596        MOVE '3'                 TO  DC-OPTION-CODE
 17597        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17598                                  8099-DATE-CONVERT-X
 17599        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17600     ELSE
 17601        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17602        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17603        MOVE +0                  TO  DC-ELAPSED-DAYS
 17604        MOVE '6'                 TO  DC-OPTION-CODE
 17605        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17606                                  8099-DATE-CONVERT-X
 17607        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17608     END-IF
 17609
 17610     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17611        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17612     ELSE
 17613        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17614     END-IF
 17615     MOVE CR-APR                 TO  CP-LOAN-APR
 17616     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17617     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17618     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 335
* ECS010.cbl
 17619     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17620                                 TO CP-SPECIAL-CALC-CD
 17621     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17622                                 TO  CP-BENEFIT-TYPE
 17623     MOVE CLAS-I-EP (CLAS-INDEXL)
 17624                                 TO  CP-EARNING-METHOD
 17625
 17626     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17627     IF (DTE-CLIENT = 'DCC')
 17628        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17629        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17630           ((CR-STATE = DD-STATE (D1))
 17631           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17632           AND ('A'           = DD-BEN-TYPE   (D1))
 17633           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 17634           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17635                           OR
 17636           D1 > max-pdef
 17637        END-PERFORM
 17638        IF D1 <= max-pdef
 17639           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17640              (P1 > +8)
 17641              OR (DD-PROD-CODE (D1 P1) = 'L')
 17642           END-PERFORM
 17643           IF P1 < +9
 17644              MOVE DD-MAX-BEN-AMT (D1 P1)
 17645                                 TO CP-R-MAX-TOT-BEN
 17646           END-IF
 17647        END-IF
 17648     END-IF
 17649
 17650     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17651
 17652     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17653
 17654     .
 17655 4199-EXIT.
 17656     EXIT.
 17657
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 336
* ECS010.cbl
 17659******************************************************************
 17660***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17661******************************************************************
 17662
 17663 4200-EP-DO-AH.
 17664
 17665     MOVE +0                         TO ISS-BEN  EPR-R78
 17666                                        CNC-BEN  EPR-PRO
 17667                                        ISS-PRM  EPR-ST
 17668                                        CNC-PRM
 17669                                        WX-CLM-AMT
 17670                                        WX-CLM-EXP
 17671                                        WX-CLM-CNT
 17672                                        WX-CLM-CRT
 17673                                        WX-ACTIVE-COUNT
 17674                                        ISS-PRMTAX
 17675                                        WX-CNC-CNT.
 17676     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17677
 17678     IF CR-AHTYP = ZERO
 17679         GO TO 4295-EP-DO-COUNT.
 17680
 17681     IF REIN-EP-FLG = 'R'
 17682         IF REIN-AH-FLG (SUB5) = SPACE
 17683             GO TO 4295-EP-DO-COUNT.
 17684
 17685     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17686     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17687     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17688
 17689     IF CR-POLICY-IS-DECLINED  OR
 17690        CR-POLICY-IS-VOID
 17691         GO TO 4290-CONTINUE.
 17692
 17693     MOVE CR-AH-TERM           TO ORIG-TERM.
 17694
 17695     IF CR-DT GREATER EW-COV-DTE
 17696         MOVE CR-DT            TO EW-COV-DTE.
 17697
 17698     IF NOT CR-POLICY-IS-RESTORE  AND
 17699        NOT CR-POLICY-IS-REISSUE
 17700        AND NOT CR-POLICY-IS-MONTHLY
 17701         MOVE WE-AHAMT         TO ISS-BEN
 17702         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17703         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17704         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17705         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17706                                   (ORIG-TERM * ISS-BEN).
 17707
 17708     MOVE CLAS-INDEXA     TO W-NDX.
 17709     MOVE RUN-DATE        TO VALUATION-DT
 17710     MOVE '6'             TO W-VAL-SOURCE.
 17711
 17712     IF REIN-EP-FLG = 'R'
 17713         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17714            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17715             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17716             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 337
* ECS010.cbl
 17717
 17718     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17719
 17720     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17721        (REM-TRM3 GREATER ZERO)
 17722        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17723            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17724                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17725            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17726                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17727          ELSE
 17728            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17729            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17730
 17731     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17732         GO TO 4210-BY-OPT-LOGIC.
 17733
 17734     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17735             AND
 17736         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17737             AND
 17738         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17739                 OR
 17740          CR-AH-CANC-DT EQUAL ZEROS)
 17741         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17742         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17743                 VARYING
 17744             SUBM FROM +1 BY +1
 17745                 UNTIL
 17746             SUBM GREATER THAN +13.
 17747
 17748     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17749     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17750
 17751 4210-BY-OPT-LOGIC.
 17752
 17753     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17754         ADD CR-LIVES TO EW-ISS-CNT
 17755         MOVE WE-AHPRM TO ISS-PRM
 17756         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17757                                (ORIG-TERM * CR-LIVES)
 17758         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17759         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17760         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17761                                   (ORIG-TERM * ISS-BEN)
 17762         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17763         GO TO 4225-CONTINUE.
 17764
 17765     IF (NOT CR-POLICY-IS-RESTORE) AND
 17766        (NOT CR-POLICY-IS-REISSUE)
 17767        AND (NOT CR-POLICY-IS-MONTHLY)
 17768        ADD +1 TO EW-ISS-CNT.
 17769
 17770     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17771
 17772     .
 17773 4225-CONTINUE.
 17774
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 338
* ECS010.cbl
 17775     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17776         NEXT  SENTENCE
 17777       ELSE
 17778         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17779
 17780     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17781     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17782     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17783     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17784     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17785     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17786
 17787     MOVE +0           TO SUB1.
 17788
 17789     IF DTE-CLIENT = 'DCC'
 17790        IF CR-AH-CANC-DT NOT = ZEROS
 17791           MOVE CR-AH-TERM       TO ORIG-TERM
 17792           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17793           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17794           MOVE '1'              TO W-VAL-SOURCE
 17795           PERFORM 8500-REMAINING-TERM-ROUTINE
 17796                                 THRU 8599-REM-TERM-X
 17797           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17798        END-IF
 17799     END-IF
 17800
 17801     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17802         10 TIMES.
 17803     MOVE +0                     TO SUB16
 17804     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17805        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17806
 17807     IF REIN-EP-FLG NOT = 'R'  OR
 17808        CR-POLICY-IS-REIN-ONLY
 17809         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17810         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17811         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17812         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17813
 17814     ADD ISS-BEN TO EW-ISS-BEN.
 17815     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17816     ADD CNC-BEN TO EW-CNC-BEN.
 17817     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17818     ADD ISS-PRM TO EW-ISS-PRM.
 17819     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17820     ADD CNC-PRM TO EW-CNC-PRM.
 17821     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17822
 17823     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17824     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17825     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17826
 17827     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17828        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17829     END-IF
 17830     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17831        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17832     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 339
* ECS010.cbl
 17833     COMPUTE ISS-PRMTAX =
 17834        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17835        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17836     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17837
 17838     IF A-H-FULLY-EARNED
 17839         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17840                                            (ISS-PRM - EPR-R78)
 17841         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17842                                            (ISS-PRM - EPR-PRO)
 17843         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17844                                            (ISS-PRM - EPR-ST).
 17845
 17846     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17847         IF  REIN-EP-FLG NOT = 'R'
 17848                 OR
 17849             CR-POLICY-IS-REIN-ONLY
 17850             MOVE 'A'      TO W-CLAIM-TYPE
 17851             MOVE EPR-R78  TO W-OPT-R78
 17852             MOVE EPR-PRO  TO W-OPT-PRO
 17853             MOVE EPR-ST   TO W-OPT-ST
 17854             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17855             MOVE ZEROS    TO EW-CLM-IBNR
 17856         ELSE
 17857             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17858                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17859                 MOVE ZEROS TO EW-CLM-IBNR
 17860             ELSE
 17861                 MOVE ZEROS TO EW-CLM-IBNR
 17862     ELSE
 17863         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17864             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17865         ELSE
 17866             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17867                 IF  CR-AH-POLICY-IS-ACTIVE
 17868                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17869                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17870                 ELSE
 17871                     NEXT SENTENCE
 17872             ELSE
 17873                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17874                     COMPUTE  EW-CLM-IBNR
 17875                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17876
 17877     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17878     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17879
 17880 4290-CONTINUE.
 17881*     DISPLAY ' 4290 '
 17882
 17883     MOVE 'Y'          TO EW-LEVEL-USED.
 17884
 17885     IF CR-POLICY-UNDERWRITTEN
 17886         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17887         MOVE EPEC-OPT-WORK-TABLE
 17888                              TO EPEC-UNDW-OPT-DATA-TABLE
 17889     ELSE
 17890         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 340
* ECS010.cbl
 17891         MOVE EPEC-OPT-WORK-TABLE
 17892                              TO EPEC-OPT-DATA-TABLE.
 17893
 17894
 17895 4295-EP-DO-COUNT.
 17896
 17897     IF REIN-EP-FLG = 'R'
 17898         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17899     ELSE
 17900         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17901
 17902     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 341
* ECS010.cbl
 17904 4296-SLOT-INTO-EFFECTED-MONTHS.
 17905
 17906     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17907             AND
 17908         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17909             AND
 17910         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17911                 OR
 17912          CR-AH-CANC-DT EQUAL ZEROS)
 17913         MOVE 'Y'                 TO W-TABLE-USED-SW
 17914         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17915             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17916                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17917                 + CR-LIVES
 17918         ELSE
 17919             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17920                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17921
 17922 4296-EXIT.
 17923     EXIT.
 17924
 17925 4299-EPBX.
 17926     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 342
* ECS010.cbl
 17928******************************************************************
 17929***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17930******************************************************************
 17931
 17932 4300-EP-COMM-LOOP.
 17933
 17934     IF DTE-CLIENT = 'DMD'
 17935         GO TO 4350-EP-COMM-LOOP-X.
 17936
 17937     ADD +1                         TO SUB1.
 17938     MOVE ZEROS                     TO SUB16.
 17939
 17940     IF CR-ADDL-CLP NOT NUMERIC
 17941        MOVE ZEROS               TO CR-ADDL-CLP
 17942     END-IF
 17943     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17944         GO TO 4350-EP-COMM-LOOP-X.
 17945
 17946 4300-AGENT-LOOP.
 17947
 17948     ADD +1                         TO SUB16.
 17949
 17950     IF SUB16 GREATER THAN WS-LOOP-MAX
 17951         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17952         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17953         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17954                                     TO WS-ABEND-MESSAGE
 17955         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17956         MOVE 4001                   TO WS-ABEND-CODE
 17957         GO TO ABEND-PGM.
 17958
 17959     IF EW-AGT-NO (SUB16) = SPACES
 17960         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 17961         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 17962     ELSE
 17963         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 17964            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 17965             NEXT SENTENCE
 17966         ELSE
 17967             GO TO 4300-AGENT-LOOP.
 17968
 17969     IF EW-LF-AH = AH-OVERRIDE-L1
 17970         GO TO 4350-EP-COMM-LOOP-A.
 17971
 17972     IF (DTE-CLIENT = 'DCC')
 17973        AND (REIN-EP-FLG = 'R')
 17974        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17975        AND (WE-LFPRM NOT = ZEROS)
 17976        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17977           COMPUTE ISS-WK ROUNDED =
 17978              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 17979        ELSE
 17980           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 17981               (CR-LFAMT + CR-LFAMT-ALT)
 17982           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 17983              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 17984        END-IF
 17985     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 343
* ECS010.cbl
 17986        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 17987                             OR 'J' OR 'N'
 17988           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 17989        ELSE
 17990           IF CR-AGT-TYPE (SUB1) = 'A'
 17991              COMPUTE ISS-WK ROUNDED =
 17992                   CR-LF-CLP * CR-LCOM-L (SUB1)
 17993           ELSE
 17994              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17995                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 17996                 COMPUTE ISS-WK ROUNDED =
 17997                      CR-LF-CLP * CR-LCOM-L (SUB1)
 17998              ELSE
 17999                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 18000                    * CR-LCOM-L (SUB1)
 18001              END-IF
 18002           END-IF
 18003        END-IF
 18004     END-IF
 18005
 18006     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18007
 18008     MOVE ZEROS                  TO CNC-WK
 18009                                    CNC-FACT
 18010     IF DTE-CLIENT EQUAL 'XXX'
 18011         IF NOT CR-NO-LF-CHARGEBACK
 18012            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 18013            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 18014                                + CNC-WK
 18015            GO TO 4300-CONTINUE-LOOP.
 18016
 18017     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18018        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18019
 18020      IF (DTE-CLIENT = 'DCC')
 18021         AND (REIN-EP-FLG = 'R')
 18022         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18023         AND (WE-LFRFND NOT = ZEROS)
 18024         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18025            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18026            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18027               CR-LCOM-L (SUB1)
 18028            IF CR-ACCOUNT = '05500500DD'
 18029               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18030            END-IF
 18031         ELSE
 18032            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18033            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18034               * CR-LCOM-L (SUB1)
 18035         END-IF
 18036      ELSE
 18037        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18038                              OR 'L' OR 'J' OR 'K')
 18039           AND (CNC-PRM > +0)
 18040           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18041           IF CR-CANCEL-REASON = 'R'
 18042              MOVE 1             TO CNC-FACT
 18043           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 344
* ECS010.cbl
 18044           COMPUTE CNC-WK = CNC-FACT *
 18045              (CR-LCOM-L (SUB1) * +1000)
 18046*       ELSE
 18047*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18048*          AND (CNC-PRM > +0)
 18049*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18050*                                THRU 4380-EXIT
 18051*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18052*          COMPUTE CNC-WK = CNC-FACT *
 18053*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18054*       ELSE
 18055*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18056*              AND (CR-AHTYP NOT = '00' AND '  ')
 18057*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18058*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18059*             COMPUTE CNC-WK = CNC-FACT *
 18060*                (CR-AHPRM - (CR-LFPRM-ALT
 18061*                + CR-ADDL-CLP))
 18062         ELSE
 18063            IF (CR-AGT-TYPE (SUB1) = 'A')
 18064                      OR
 18065              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18066                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18067              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18068              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18069                CR-LCOM-L (SUB1)
 18070            ELSE
 18071               COMPUTE CNC-WK  ROUNDED =
 18072                 CNC-PRM * CR-LCOM-L (SUB1)
 18073            END-IF
 18074         END-IF
 18075*       END-IF
 18076      END-IF
 18077        COMPUTE EW-CNC-COM (SUB16) =
 18078                                  EW-CNC-COM (SUB16) + CNC-WK
 18079     END-IF
 18080
 18081     if (ws-dcc-cnc-flag = 'Y')
 18082        and (rein-ep-flg not = 'R')
 18083        move cnc-wk              to dx-l-pc (sub1)
 18084     end-if
 18085
 18086     .
 18087 4300-CONTINUE-LOOP.
 18088
 18089*     DISPLAY ' 4300 CONTINUE '
 18090     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18091               OR
 18092        ((ISS-WK - CNC-WK) = ZEROS)
 18093        MOVE ZEROS              TO COMM-WK
 18094     ELSE
 18095        COMPUTE EC-FACT ROUNDED =
 18096           EPR-R78 / (ISS-PRM - CNC-PRM)
 18097        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18098     END-IF
 18099
 18100     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18101
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 345
* ECS010.cbl
 18102     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18103               OR
 18104        ((ISS-WK - CNC-WK) = ZEROS)
 18105        MOVE ZEROS              TO COMM-WK
 18106     ELSE
 18107        COMPUTE EC-FACT ROUNDED =
 18108           EPR-PRO / (ISS-PRM - CNC-PRM)
 18109        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18110     END-IF
 18111     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18112
 18113     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18114               OR
 18115        ((ISS-WK - CNC-WK) = ZEROS)
 18116        MOVE ZEROS              TO COMM-WK
 18117     ELSE
 18118        COMPUTE EC-FACT ROUNDED =
 18119           EPR-ST / (ISS-PRM - CNC-PRM)
 18120        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18121     END-IF
 18122
 18123     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18124
 18125     IF LIFE-FULLY-EARNED
 18126         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18127                                                CR-LCOM-L (SUB1)
 18128         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18129                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18130         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18131                                                CR-LCOM-L (SUB1)
 18132         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18133                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18134
 18135     GO TO 4350-EP-COMM-LOOP-X.
 18136
 18137 4350-EP-COMM-LOOP-A.
 18138
 18139     IF (DTE-CLIENT = 'DCC')
 18140        AND (REIN-EP-FLG = 'R')
 18141        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18142        AND (WE-AHPRM NOT = ZEROS)
 18143
 18144        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18145           COMPUTE ISS-WK ROUNDED =
 18146              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18147        ELSE
 18148           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18149           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18150              * CR-LCOM-AH (SUB1)
 18151        END-IF
 18152     ELSE
 18153        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18154                                    OR 'J' OR 'N'
 18155           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18156        ELSE
 18157           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18158             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18159              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 346
* ECS010.cbl
 18160              + CR-ADDL-CLP)
 18161           ELSE
 18162              IF (CR-AGT-TYPE (SUB1) = 'M')
 18163                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18164                              = 'G' OR 'L')
 18165                 COMPUTE ISS-WK ROUNDED =
 18166                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18167              ELSE
 18168                 IF CR-AGT-TYPE (SUB1) = 'A'
 18169                    COMPUTE ISS-WK ROUNDED =
 18170                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18171                 ELSE
 18172                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18173                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18174                                     'D')
 18175                       COMPUTE ISS-WK ROUNDED =
 18176                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18177                    ELSE
 18178                       COMPUTE ISS-WK  ROUNDED =
 18179                         ISS-PRM * CR-LCOM-AH (SUB1)
 18180                    END-IF
 18181                 END-IF
 18182              END-IF
 18183           END-IF
 18184        END-IF
 18185     END-IF
 18186
 18187     COMPUTE EW-ISS-COM (SUB16) =
 18188             EW-ISS-COM (SUB16) + ISS-WK.
 18189
 18190     MOVE ZEROS                  TO CNC-WK
 18191     IF DTE-CLIENT EQUAL 'XXX'
 18192         IF NOT CR-NO-LF-CHARGEBACK
 18193           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18194           COMPUTE EW-CNC-COM (SUB16) =
 18195                   EW-CNC-COM (SUB16) + CNC-WK
 18196           GO TO 4300-CONTINUE-LOOP-AH.
 18197
 18198     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18199        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18200        EVALUATE TRUE
 18201           WHEN DTE-CLIENT = 'DCC'
 18202             AND (REIN-EP-FLG = 'R')
 18203             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18204             AND (WE-AHRFND NOT = ZEROS)
 18205             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18206                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18207                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18208                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18209             ELSE
 18210                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18211                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18212                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18213             END-IF
 18214           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18215             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18216             AND (CNC-PRM > +0)
 18217             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 347
* ECS010.cbl
 18218           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18219             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18220             AND (CNC-PRM > +0)
 18221             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18222           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18223                              OR 'L' OR 'J' OR 'K')
 18224             AND (CNC-PRM > +0)
 18225             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18226             IF CR-CANCEL-REASON = 'R'
 18227                MOVE 1             TO CNC-FACT
 18228             END-IF
 18229             COMPUTE CNC-WK = CNC-FACT *
 18230                (CR-LCOM-AH (SUB1) * +1000)
 18231
 18232           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18233             AND (CNC-PRM > +0)
 18234             AND (CNC-PRM = ISS-PRM)
 18235             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18236
 18237           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18238             AND (CNC-PRM > +0)
 18239             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18240           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18241              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18242                              = 'G' OR 'L')
 18243              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18244              COMPUTE CNC-WK = CNC-FACT *
 18245                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18246           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18247              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18248              IF (CR-CANCEL-REASON = 'R')
 18249                 AND (CNC-PRM > +0)
 18250                 MOVE +1      TO CNC-FACT
 18251              END-IF
 18252              COMPUTE CNC-WK = CNC-FACT *
 18253              (CR-AHPRM - (CR-LFPRM-ALT
 18254                 + CR-ADDL-CLP))
 18255           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18256                      OR
 18257              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18258               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18259               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18260               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18261                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18262            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18263                      CNC-PRM * CR-LCOM-AH (SUB1)
 18264        END-EVALUATE
 18265        COMPUTE EW-CNC-COM (SUB16) =
 18266           EW-CNC-COM (SUB16) + CNC-WK
 18267     END-IF
 18268
 18269     if (ws-dcc-cnc-flag = 'Y')
 18270        and (rein-ep-flg not = 'R')
 18271        move cnc-wk              to dx-a-pc (sub1)
 18272     end-if
 18273
 18274*      IF (DTE-CLIENT = 'DCC')
 18275*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 348
* ECS010.cbl
 18276*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18277*         AND (WE-AHRFND NOT = ZEROS)
 18278*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18279*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18280*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18281*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18282*         ELSE
 18283*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18284*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18285*            * CR-LCOM-AH (SUB1)
 18286*         END-IF
 18287*      ELSE
 18288*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18289*                              OR 'L' OR 'J' OR 'K')
 18290*           AND (CNC-PRM > +0)
 18291*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18292*           IF CR-CANCEL-REASON = 'R'
 18293*              MOVE 1             TO CNC-FACT
 18294*           END-IF
 18295*           COMPUTE CNC-WK = CNC-FACT *
 18296*              (CR-LCOM-AH (SUB1) * +1000)
 18297*        ELSE
 18298*          IF CR-AGT-TYPE (SUB1) = 'N'
 18299*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18300*                                 THRU 4380-EXIT
 18301**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18302**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18303**            IF CNC-PRM NOT = ISS-PRM
 18304**               COMPUTE CNC-WK = CNC-FACT *
 18305**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18306**            ELSE
 18307**               COMPUTE CNC-WK = CNC-FACT *
 18308**               (CR-LCOM-AH (SUB1) * +1000)
 18309**            END-IF
 18310*          ELSE
 18311*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18312*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18313*                              = 'G' OR 'L')
 18314*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18315*              COMPUTE CNC-WK = CNC-FACT *
 18316*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18317*           ELSE
 18318*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18319*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18320*                 IF CR-CANCEL-REASON = 'R'
 18321*                    MOVE +1      TO CNC-FACT
 18322*                 END-IF
 18323*                 COMPUTE CNC-WK = CNC-FACT *
 18324*                 (CR-AHPRM - (CR-LFPRM-ALT
 18325*                    + CR-ADDL-CLP))
 18326*              ELSE
 18327*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18328*                           OR
 18329*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18330*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18331*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18332*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18333*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 349
* ECS010.cbl
 18334*                 ELSE
 18335*                    COMPUTE CNC-WK  ROUNDED =
 18336*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18337*                 END-IF
 18338*              END-IF
 18339*           END-IF
 18340*          END-IF
 18341*        END-IF
 18342**       END-IF
 18343*      END-IF
 18344*        COMPUTE EW-CNC-COM (SUB16) =
 18345*           EW-CNC-COM (SUB16) + CNC-WK
 18346*     END-IF
 18347
 18348     .
 18349 4300-CONTINUE-LOOP-AH.
 18350
 18351     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18352        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18353        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18354        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18355        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18356           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18357        END-IF
 18358     END-IF
 18359
 18360*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18361     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18362                OR
 18363        ((ISS-WK - CNC-WK) = ZEROS)
 18364        MOVE ZEROS          TO COMM-WK
 18365     ELSE
 18366        COMPUTE EC-FACT ROUNDED =
 18367           EPR-R78 / (ISS-PRM - CNC-PRM)
 18368        IF WS-DDF-AH-CB (SUB1) = 'N'
 18369           MOVE ISS-WK           TO COMM-WK
 18370        ELSE
 18371           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18372        END-IF
 18373     END-IF
 18374
 18375     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18376
 18377     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18378                OR
 18379        ((ISS-WK - CNC-WK) = ZEROS)
 18380        MOVE ZEROS          TO COMM-WK
 18381     ELSE
 18382        COMPUTE EC-FACT ROUNDED =
 18383           EPR-PRO / (ISS-PRM - CNC-PRM)
 18384        IF WS-DDF-AH-CB (SUB1) = 'N'
 18385           MOVE ISS-WK           TO COMM-WK
 18386        ELSE
 18387           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18388        END-IF
 18389     END-IF
 18390
 18391     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 350
* ECS010.cbl
 18392
 18393     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18394                OR
 18395        ((ISS-WK - CNC-WK) = ZEROS)
 18396        MOVE ZEROS          TO COMM-WK
 18397     ELSE
 18398        EVALUATE TRUE
 18399           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18400              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18401                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18402                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18403           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18404             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18405              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18406           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18407              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18408              MOVE ISS-WK TO COMM-WK
 18409           WHEN OTHER
 18410              COMPUTE EC-FACT ROUNDED =
 18411                EPR-ST / (ISS-PRM - CNC-PRM)
 18412              COMPUTE COMM-WK ROUNDED = EC-FACT
 18413                 * (ISS-WK - CNC-WK)
 18414        END-EVALUATE
 18415     END-IF
 18416
 18417     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18418
 18419     IF A-H-FULLY-EARNED
 18420         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18421                                                CR-LCOM-AH (SUB1)
 18422         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18423                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18424         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18425                                                CR-LCOM-AH (SUB1)
 18426         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18427                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18428
 18429 4350-EP-COMM-LOOP-X.
 18430     EXIT.
 18431
 18432******************************************************************
 18433***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18434******************************************************************
 18435
 18436 4375-EP-BANK-COMM.
 18437*     DISPLAY ' 4375 '
 18438
 18439     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18440        GO TO 4375-EXIT
 18441     END-IF
 18442     .
 18443 4375-BANK-LOOP.
 18444
 18445     ADD +1                      TO SUB16
 18446
 18447     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18448        GO TO 4375-EXIT
 18449     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 351
* ECS010.cbl
 18450
 18451     IF SUB16 GREATER THAN WS-LOOP-MAX
 18452         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18453         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18454         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18455                                     TO WS-ABEND-MESSAGE
 18456         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18457         MOVE 4001                   TO WS-ABEND-CODE
 18458         PERFORM ABEND-PGM
 18459     END-IF
 18460
 18461     IF EW-AGT-NO (SUB16) = SPACES
 18462        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18463        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18464     ELSE
 18465        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18466           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18467           CONTINUE
 18468        ELSE
 18469           GO TO 4375-BANK-LOOP
 18470        END-IF
 18471     END-IF
 18472
 18473     IF CS-COM-TYP  (SUB1) = 'B'
 18474        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18475     END-IF
 18476
 18477     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18478
 18479     MOVE ZEROS                  TO CNC-WK
 18480                                    CNC-FACT
 18481
 18482     IF (CS-COM-TYP (SUB1) = 'B')
 18483        AND (CNC-PRM > +0)
 18484        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18485        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18486     END-IF
 18487
 18488     COMPUTE EW-CNC-COM (SUB16) =
 18489                  EW-CNC-COM (SUB16) + CNC-WK
 18490
 18491     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18492                OR
 18493        ((ISS-WK - CNC-WK) = ZEROS)
 18494        MOVE ZEROS          TO COMM-WK
 18495     ELSE
 18496        COMPUTE EC-FACT ROUNDED =
 18497           EPR-R78 / (ISS-PRM - CNC-PRM)
 18498        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18499     END-IF
 18500
 18501     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18502
 18503     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18504                OR
 18505        ((ISS-WK - CNC-WK) = ZEROS)
 18506        MOVE ZEROS          TO COMM-WK
 18507     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 352
* ECS010.cbl
 18508        COMPUTE EC-FACT ROUNDED =
 18509           EPR-PRO / (ISS-PRM - CNC-PRM)
 18510        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18511     END-IF
 18512
 18513     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18514
 18515     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18516                OR
 18517        ((ISS-WK - CNC-WK) = ZEROS)
 18518        MOVE ZEROS          TO COMM-WK
 18519     ELSE
 18520        COMPUTE EC-FACT ROUNDED =
 18521           EPR-ST / (ISS-PRM - CNC-PRM)
 18522        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18523     END-IF
 18524
 18525     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18526
 18527     IF A-H-FULLY-EARNED
 18528        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18529        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18530                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18531        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18532                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18533     END-IF
 18534
 18535     .
 18536 4375-EXIT.
 18537     EXIT.
 18538
 18539
 18540 4376-DCC-DDF-SPEC.
 18541
 18542     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18543                                 THRU 4910-EXIT
 18544
 18545     display ' acct - cert ' cr-account ' ' cr-cert-no
 18546     display ' orig term rem term ' orig-term ' ' rem-trm1
 18547     display ' agt type ' cr-agt-type (sub1)
 18548     COMPUTE CP-MONTH =
 18549        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18550     IF CP-MONTH = 0
 18551        MOVE 12 TO CP-MONTH
 18552     END-IF
 18553
 18554     EVALUATE TRUE
 18555        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18556           PERFORM 4380-REF-CSO-ADMIN-FEE
 18557                                 THRU 4380-EXIT
 18558        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18559           AND (CR-CANCEL-REASON = 'R')
 18560              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18561        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18562           EVALUATE TRUE
 18563              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18564                 OR (NOT DD-IU-PRESENT)
 18565                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 353
* ECS010.cbl
 18566                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18567                       / CR-AH-CLP
 18568                 end-if
 18569                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18570                    (CR-LCOM-AH (SUB1) * +1000)
 18571               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18572                  AND (DD-IU-PRESENT)
 18573                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18574                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18575                     WS-LO-UEF) * 3/12
 18576                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18577                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18578                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18579                    (CR-LCOM-AH (SUB1) * +1000)
 18580                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18581                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18582                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18583                     * (CP-MONTH - 3) / 9
 18584              WHEN (ORIG-TERM - REM-TRM1) > 12
 18585                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18586                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18587                    CP-MONTH / 12)
 18588           END-EVALUATE
 18589        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18590           EVALUATE TRUE
 18591              WHEN CR-CANCEL-REASON = 'R'
 18592                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18593                    + CR-ADDL-CLP))
 18594              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18595                 OR (NOT DD-IU-PRESENT)
 18596                   if ueclp-clp-fact = zeros
 18597                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18598                       / CR-AH-CLP
 18599                   end-if
 18600                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18601                       (CR-AHPRM - (CR-AH-CLP
 18602                       + CR-ADDL-CLP))
 18603              WHEN (ORIG-TERM - REM-TRM1) < 13
 18604                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18605                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18606                     WS-LO-UEF) * 3/12
 18607                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18608                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18609                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18610                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18611                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18612                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18613                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18614                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18615              WHEN (ORIG-TERM - REM-TRM1) > 12
 18616                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18617                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18618                    WS-LO-UEF) * CP-MONTH / 12)
 18619           END-EVALUATE
 18620     END-EVALUATE
 18621
 18622     .
 18623 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 354
* ECS010.cbl
 18624     EXIT.
 18625
 18626
 18627
 18628 4380-REF-CSO-ADMIN-FEE.
 18629
 18630*    IF CR-AH-CANC-DT NOT = ZEROS
 18631*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18632*       MOVE CR-AH-TERM          TO ORIG-TERM
 18633*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18634*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18635*       MOVE '1'                 TO W-VAL-SOURCE
 18636*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18637*                                THRU 8599-REM-TERM-X
 18638*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18639*    END-IF
 18640
 18641     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18642                                 THRU 4910-EXIT
 18643
 18644     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18645        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18646
 18647     MOVE ZEROS                  TO CNC-WK
 18648
 18649     EVALUATE TRUE
 18650        WHEN (REM-TRM1 = 0)
 18651           OR (CR-CANCEL-REASON = 'R')
 18652           DISPLAY ' REM TERM = 0 OR REPO'
 18653           MOVE 0                TO CNC-WK
 18654
 18655        WHEN REM-TRM1 = ORIG-TERM
 18656           DISPLAY ' REM TERM  = ORIG TERM '
 18657           MOVE ISS-WK           TO CNC-WK
 18658
 18659        WHEN (ORIG-TERM - REM-TRM1) < 4
 18660           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18661           COMPUTE CP-MONTH =
 18662              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18663           IF CP-MONTH = 0
 18664              MOVE 12 TO CP-MONTH
 18665           END-IF
 18666           DISPLAY ' CP MONTH ' CP-MONTH
 18667           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18668              (DD-1ST-YR-ALLOW (D1)
 18669              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18670              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18671           COMPUTE CNC-WK = W-FACTOR * 1
 18672
 18673**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18674
 18675        WHEN (ORIG-TERM - REM-TRM1) < 13
 18676           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18677           COMPUTE CP-MONTH =
 18678              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18679           IF CP-MONTH = 0
 18680              MOVE 12 TO CP-MONTH
 18681           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 355
* ECS010.cbl
 18682           DISPLAY ' CP MONTH ' CP-MONTH
 18683           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18684              DD-1ST-YR-ALLOW (D1))
 18685              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18686              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18687           COMPUTE CNC-WK = W-FACTOR * 1
 18688
 18689****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18690
 18691        WHEN OTHER
 18692           DISPLAY ' OTHER '
 18693           COMPUTE CP-MONTH =
 18694              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18695           IF CP-MONTH = 0
 18696              MOVE 12 TO CP-MONTH
 18697           END-IF
 18698           DISPLAY ' CP MONTH ' CP-MONTH
 18699           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18700              DD-1ST-YR-ALLOW (D1))
 18701              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18702              * CP-MONTH / 12)
 18703           COMPUTE CNC-WK = W-FACTOR * 1
 18704     END-EVALUATE
 18705
 18706     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18707        ' ' CNC-WK
 18708
 18709     .
 18710 4380-EXIT.
 18711     EXIT.
 18712
 18713******************************************************************
 18714******************************************************************
 18715******************************************************************
 18716******************************************************************
 18717******************************************************************
 18718******************************************************************
 18719******************************************************************
 18720******************************************************************
 18721******************************************************************
 18722******************************************************************
 18723***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18724******************************************************************
 18725
 18726 S-4100-EP-DO-LF.
 18727
 18728     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18729                                        EPR-PRO
 18730                                        EPR-ST.
 18731
 18732     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18733     MOVE 'L'                    TO DC-OPTION-CODE.
 18734     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18735
 18736     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18737     MOVE -1                     TO DC-ELAPSED-DAYS.
 18738     MOVE '6'                    TO DC-OPTION-CODE.
 18739     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 356
* ECS010.cbl
 18740
 18741     MOVE +0                     TO DC-ELAPSED-MONTHS
 18742                                    DC-ELAPSED-DAYS.
 18743
 18744     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18745     MOVE ' '                    TO DC-OPTION-CODE.
 18746     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18747
 18748     IF NO-CONVERSION-ERROR
 18749        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18750     ELSE
 18751         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18752                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18753                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18754         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18755                                     TO WS-ABEND-MESSAGE
 18756         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18757         MOVE 4001                   TO WS-ABEND-CODE
 18758         GO TO ABEND-PGM.
 18759
 18760     IF CR-LFTYP = ZERO
 18761         GO TO S-4200-EP-DO-AH.
 18762
 18763     IF REIN-LF-FLG (SUB5) = SPACE
 18764         GO TO S-4200-EP-DO-AH.
 18765
 18766     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18767     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18768     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18769
 18770     MOVE CR-LF-TERM             TO ORIG-TERM.
 18771     MOVE CLAS-INDEXL            TO W-NDX.
 18772
 18773 S-4120-EP-DO-LF-CNCL.
 18774
 18775     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18776        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18777         GO TO S-4130-EP-DO-LF-EP.
 18778
 18779     COMPUTE EARNED-BY-CANCEL =
 18780                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18781
 18782 S-4130-EP-DO-LF-EP.
 18783
 18784     MOVE SPACE                  TO STATUTORY-SWITCH.
 18785
 18786     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18787     MOVE '9'                    TO W-VAL-SOURCE.
 18788     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18789
 18790     IF REM-TRM2 GREATER CR-LF-TERM
 18791         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18792         GO TO S-4190-EP-DO-LF-COMM.
 18793
 18794     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18795         GO TO S-4180-EP-DO-LF-EP-SUM.
 18796
 18797     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 357
* ECS010.cbl
 18798         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18799             IF REM-TRM2 NOT GREATER THAN +0
 18800                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18801                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18802                 GO TO S-4190-EP-DO-LF-COMM
 18803             ELSE
 18804                 NEXT SENTENCE
 18805         ELSE
 18806             IF W-BAL-REMTRM NOT GREATER +0
 18807                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18808                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18809                 GO TO S-4190-EP-DO-LF-COMM
 18810             ELSE
 18811                 NEXT SENTENCE
 18812     ELSE
 18813        IF (DTE-CLIENT EQUAL 'NCL') AND
 18814           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18815             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18816        ELSE
 18817         IF REM-TRM2 NOT GREATER +0  OR
 18818            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18819             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18820             GO TO S-4190-EP-DO-LF-COMM.
 18821
 18822     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18823         GO TO S-4140-EP-DO-LF-EP-TEX.
 18824
 18825     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18826         GO TO S-4150-EP-DO-LF-EP-NP.
 18827
 18828*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18829     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18830        (CR-RATING-CLASS NOT = 'L ')
 18831         IF (CR-APR GREATER THAN ZERO)  AND
 18832            (CR-LF-TERM GREATER THAN 060)  AND
 18833            (CR-DT GREATER THAN 19831031)
 18834             MOVE '*'             TO STATUTORY-SWITCH
 18835              GO TO S-4150-EP-DO-LF-EP-NP.
 18836
 18837     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18838         IF (CR-APR GREATER THAN ZERO)  AND
 18839            (CR-LF-TERM GREATER THAN 061)  AND
 18840            (CR-DT GREATER THAN 19830318)
 18841             MOVE '*'             TO STATUTORY-SWITCH
 18842              GO TO S-4150-EP-DO-LF-EP-NP.
 18843
 18844     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18845         IF (CR-APR GREATER THAN ZERO)  AND
 18846            (CR-LF-TERM GREATER THAN 062)  AND
 18847            (CR-DT GREATER THAN 19810831)  AND
 18848            (CR-DT LESS THAN 19830901)
 18849             MOVE '*'             TO STATUTORY-SWITCH
 18850              GO TO S-4150-EP-DO-LF-EP-NP.
 18851
 18852     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18853         IF (CR-APR GREATER THAN ZERO)  AND
 18854            (CR-LF-TERM GREATER THAN 060)  AND
 18855            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 358
* ECS010.cbl
 18856             MOVE '*'             TO STATUTORY-SWITCH
 18857              GO TO S-4150-EP-DO-LF-EP-NP.
 18858
 18859     GO TO S-4160-EP-DO-LF-EP-R78.
 18860
 18861 S-4140-EP-DO-LF-EP-TEX.
 18862
 18863     COMPUTE TEX-FACT-4 =
 18864         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18865     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18866         GIVING TEX-FACT-5
 18867             REMAINDER TEX-FACT-6.
 18868     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18869     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18870         (TEX-FACT-5 * CR-PMT-FREQ) +
 18871         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18872     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18873
 18874     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18875
 18876     GO TO S-4170-EP-DO-LF-EP-PRO.
 18877
 18878 S-4150-EP-DO-LF-EP-NP.
 18879
 18880     IF WE-LFPRM = ZERO
 18881         GO TO S-4160-EP-DO-LF-EP-R78.
 18882
 18883     IF DTE-CLIENT = 'CRI'
 18884       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18885             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18886           GO TO S-4160-EP-DO-LF-EP-R78.
 18887
 18888     IF DTE-CLIENT = 'NCL'
 18889       IF CR-DT LESS THAN 19910101
 18890           GO TO S-4160-EP-DO-LF-EP-R78.
 18891
 18892     IF REM-TRM1 = CR-LF-TERM
 18893         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18894         GO TO S-4190-EP-DO-LF-COMM.
 18895
 18896     MOVE CR-APR TO NP-APR.
 18897     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18898     MOVE REM-TRM1 TO NP-REM.
 18899     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18900     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18901         MOVE CR-LOAN-TERM TO NP-ORIG.
 18902     MOVE 'R' TO NP-OPT.
 18903     CALL 'ECSNETRM'
 18904         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18905
 18906     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18907
 18908     IF STATUTORY-REQUIREMENT
 18909         MOVE EPR-R78                TO EPR-ST.
 18910
 18911 S-4160-EP-DO-LF-EP-R78.
 18912
 18913     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 359
* ECS010.cbl
 18914        (DTE-CLIENT EQUAL 'NCL')
 18915        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18916           (CR-MO EQUAL EOM-MO)
 18917           MOVE '*'            TO OB-DATE-1-SWITCH
 18918           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18919           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18920           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18921           COMPUTE WS-EPR-R78 (SUB3 1) =
 18922                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18923           GO TO S-4190-EP-DO-LF-COMM
 18924        ELSE
 18925        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18926           (CR-MO EQUAL OB-MO (1))
 18927           MOVE '*'            TO OB-DATE-2-SWITCH
 18928           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18929           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18930           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18931           COMPUTE WS-EPR-R78 (SUB3 2) =
 18932                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 18933           GO TO S-4190-EP-DO-LF-COMM
 18934        ELSE
 18935        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18936           (CR-MO EQUAL OB-MO (2))
 18937           MOVE '*'            TO OB-DATE-3-SWITCH
 18938           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18939           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18940           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18941           COMPUTE WS-EPR-R78 (SUB3 3) =
 18942                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 18943           GO TO S-4190-EP-DO-LF-COMM
 18944        ELSE
 18945           GO TO S-4190-EP-DO-LF-COMM.
 18946
 18947     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 18948
 18949     IF DTE-R78 = '1'
 18950         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 18951     ELSE
 18952         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18953
 18954     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18955
 18956     IF REM-TRM1 GREATER THAN +0
 18957         COMPUTE TEMP-7 ROUNDED EQUAL
 18958             WE-LFPRM - (WE-LFPRM * TEMP-4)
 18959     ELSE
 18960         MOVE WE-LFPRM                TO TEMP-7.
 18961
 18962     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 18963         MOVE TEMP-7                 TO EPR-ST.
 18964
 18965     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18966         MOVE ZEROS                  TO TEMP-8
 18967         GO TO S-4165-END-LF-EP-R78.
 18968
 18969     IF EPR-ST NOT = ZEROS
 18970         MOVE TEMP-7                 TO EPR-ST.
 18971
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 360
* ECS010.cbl
 18972     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18973         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 18974         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 18975         IF DTE-R78 = '1'
 18976             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 18977
 18978     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18979
 18980     COMPUTE TEMP-8 ROUNDED =
 18981               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 18982
 18983 S-4165-END-LF-EP-R78.
 18984
 18985     IF EPR-R78 = ZEROS
 18986         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 18987     ELSE
 18988         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 18989
 18990 S-4170-EP-DO-LF-EP-PRO.
 18991
 18992     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18993         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 18994     ELSE
 18995         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 18996
 18997     IF REM-TRM1 GREATER THAN +0
 18998         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 18999     ELSE
 19000         MOVE WE-LFPRM                  TO TEMP-7.
 19001
 19002     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19003         MOVE ZEROS                     TO TEMP-8
 19004         GO TO S-4175-END-LF-EP-PRO.
 19005
 19006     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19007         IF DTE-CLIENT = 'MIC' OR 'MCC'
 19008             COMPUTE TEMP-5 ROUNDED =
 19009                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 19010         ELSE
 19011             COMPUTE TEMP-5 ROUNDED =
 19012                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 19013
 19014     COMPUTE TEMP-8 ROUNDED =
 19015                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 19016
 19017     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 19018
 19019 S-4175-END-LF-EP-PRO.
 19020
 19021     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 19022
 19023     GO TO S-4185-EP-DO-LF-STATUTORY.
 19024
 19025 S-4180-EP-DO-LF-EP-SUM.
 19026
 19027     IF REM-TRM1 NOT GREATER +0
 19028         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19029         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 361
* ECS010.cbl
 19030         GO TO S-4190-EP-DO-LF-COMM.
 19031
 19032     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19033         MOVE ZEROS                 TO TEMP-7
 19034     ELSE
 19035         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19036                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19037
 19038     IF TEMP-7 NOT GREATER ZERO
 19039         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19040             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19041             GO TO S-4190-EP-DO-LF-COMM
 19042         ELSE
 19043             MOVE ZEROS             TO TEMP-7.
 19044
 19045     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19046     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19047     IF DTE-R78 = '1'
 19048         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19049
 19050     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19051     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19052
 19053     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19054
 19055     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19056
 19057     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19058         GO TO S-4185-EP-DO-LF-STATUTORY.
 19059
 19060     MOVE EPR-R78                  TO EPR-ST.
 19061
 19062     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19063         MOVE ZEROS                 TO TEMP-8
 19064     ELSE
 19065         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19066                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19067
 19068     IF TEMP-8 NOT GREATER ZERO
 19069         GO TO S-4185-EP-DO-LF-STATUTORY.
 19070
 19071     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19072                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19073
 19074     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19075                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19076
 19077     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19078                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19079
 19080 S-4185-EP-DO-LF-STATUTORY.
 19081
 19082*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19083*08473          MOVE EPR-R78                TO EPR-ST.
 19084
 19085     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19086         MOVE EPR-PRO                TO EPR-ST.
 19087
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 362
* ECS010.cbl
 19088     IF (DTE-CLIENT = 'CID') AND
 19089        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19090        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19091        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19092           GO TO S-4187-EP-DO-LF-STAT-ROA
 19093     END-IF.
 19094
 19095     IF EPR-ST NOT = ZEROS
 19096         GO TO S-4190-EP-DO-LF-COMM.
 19097
 19098     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19099         MOVE EPR-R78                TO EPR-ST
 19100     ELSE
 19101         MOVE EPR-PRO                TO EPR-ST.
 19102
 19103     GO TO S-4190-EP-DO-LF-COMM.
 19104
 19105 S-4187-EP-DO-LF-STAT-ROA.
 19106     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19107     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19108     MOVE 'L'                        TO DC-OPTION-CODE.
 19109     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19110     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19111     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19112        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19113        MOVE '3'                 TO  DC-OPTION-CODE
 19114        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19115                              8099-DATE-CONVERT-X
 19116        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19117     ELSE
 19118        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19119        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19120        MOVE +0                  TO  DC-ELAPSED-DAYS
 19121        MOVE '6'                 TO  DC-OPTION-CODE
 19122        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19123                              8099-DATE-CONVERT-X
 19124        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19125     END-IF
 19126     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19127     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19128     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19129     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19130     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19131     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19132     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19133     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19134     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19135     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19136                                        CP-LOAN-TERM.
 19137     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19138                                        CP-RATING-BENEFIT-AMT.
 19139     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19140         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19141     ELSE
 19142         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19143     END-IF.
 19144     MOVE CR-APR                     TO CP-LOAN-APR.
 19145     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 363
* ECS010.cbl
 19146     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19147     MOVE '6'                        TO CP-EARNING-METHOD.
 19148     MOVE '3'                        TO CP-PROCESS-TYPE.
 19149     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19150     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19151         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19152     ELSE
 19153         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19154     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19155     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19156     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19157     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19158     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19159     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19160
 19161
 19162     IF CP-STATE-STD-ABBRV = 'OR'
 19163        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19164     END-IF
 19165
 19166     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19167        COMPUTE CP-ORIGINAL-BENEFIT =
 19168         (CR-LFAMT - CR-LFPRM)
 19169     END-IF
 19170
 19171     IF CP-TRUNCATED-LIFE
 19172        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19173     END-IF
 19174
 19175     IF CP-TERM-IS-DAYS
 19176        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19177     ELSE
 19178        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19179     END-IF
 19180
 19181     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19182
 19183     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19184
 19185 S-4190-EP-DO-LF-COMM.
 19186
 19187     IF EARNED-BY-CANCEL = ZEROS
 19188         GO TO S-4195-LF-COMM-CONTINUE.
 19189
 19190     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19191         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19192
 19193     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19194         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19195
 19196     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19197         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19198
 19199 S-4195-LF-COMM-CONTINUE.
 19200
 19201     MOVE +0 TO SUB1.
 19202     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19203         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 364
* ECS010.cbl
 19204
 19205     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19206     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19207     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19208
 19209     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19210     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19211     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19212
 19213     MOVE 'Y'          TO EW-LEVEL-USED.
 19214
 19215     IF CR-POLICY-UNDERWRITTEN
 19216         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19217
 19218     ELSE
 19219         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19220
 19221     GO TO S-4200-EP-DO-AH.
 19222
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 365
* ECS010.cbl
 19224******************************************************************
 19225***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19226******************************************************************
 19227
 19228 S-4200-EP-DO-AH.
 19229
 19230     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19231                                        EPR-PRO
 19232                                        EPR-ST.
 19233
 19234     IF CR-AHTYP = ZERO
 19235         GO TO S-4299-EPBX.
 19236
 19237     IF REIN-AH-FLG (SUB5) = SPACE
 19238         GO TO S-4299-EPBX.
 19239
 19240     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19241     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19242     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19243
 19244     MOVE CR-AH-TERM           TO ORIG-TERM.
 19245     MOVE CLAS-INDEXA          TO W-NDX.
 19246
 19247     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19248     MOVE '9'                    TO W-VAL-SOURCE.
 19249     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19250
 19251 S-4220-EP-DO-AH-CNCL.
 19252
 19253     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19254         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19255
 19256 S-4230-EP-DO-AH-EP.
 19257
 19258     IF REM-TRM2 GREATER CR-AH-TERM
 19259         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19260         GO TO S-4290-EP-DO-AH-COMM.
 19261
 19262     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19263         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19264
 19265 S-4235-CHECK-OB-AH-NCL.
 19266
 19267     IF (DTE-CLIENT EQUAL 'NCL') AND
 19268        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19269           MOVE WE-AHPRM         TO EPR-R78
 19270                                    EPR-PRO
 19271                                    EPR-ST
 19272        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19273           (CR-MO EQUAL EOM-MO)
 19274           MOVE '*'            TO OB-DATE-1-SWITCH
 19275           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19276           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19277           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19278           COMPUTE WS-EPR-R78 (SUB3 1) =
 19279                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19280            GO TO S-4290-EP-DO-AH-COMM
 19281        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 366
* ECS010.cbl
 19282        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19283           (CR-MO EQUAL OB-MO (1))
 19284           MOVE '*'            TO OB-DATE-2-SWITCH
 19285           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19286           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19287           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19288           COMPUTE WS-EPR-R78 (SUB3 2) =
 19289                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19290            GO TO S-4290-EP-DO-AH-COMM
 19291        ELSE
 19292        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19293           (CR-MO EQUAL OB-MO (2))
 19294           MOVE '*'            TO OB-DATE-3-SWITCH
 19295           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19296           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19297           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19298           COMPUTE WS-EPR-R78 (SUB3 3) =
 19299                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19300            GO TO S-4290-EP-DO-AH-COMM
 19301        ELSE
 19302            GO TO S-4290-EP-DO-AH-COMM.
 19303
 19304     IF REM-TRM2 NOT GREATER +0
 19305         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19306         GO TO S-4290-EP-DO-AH-COMM.
 19307
 19308     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19309         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19310         GO TO S-4290-EP-DO-AH-COMM.
 19311
 19312     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19313     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19314     IF DTE-R78 = '1'
 19315         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19316     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19317
 19318     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19319         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19320     ELSE
 19321         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19322
 19323     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19324     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19325
 19326     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19327     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19328
 19329     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19330
 19331*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19332*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19333
 19334     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19335
 19336     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19337        (CR-DT GREATER THAN  19921231)
 19338         IF CR-AH-TERM GREATER THAN  +61
 19339             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 367
* ECS010.cbl
 19340             MOVE '*' TO STATUTORY-SWITCH-AH
 19341             GO TO S-4245-EP-DO-AH-EP-AN
 19342         ELSE
 19343             GO TO S-4250-EP-DO-AH-STATUTORY.
 19344
 19345     IF AH-EARN-METHOD EQUAL 'N'
 19346         GO TO S-4240-EP-DO-AH-EP-NP.
 19347
 19348     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19349         MOVE 'A' TO AH-EARN-METHOD
 19350         GO TO S-4245-EP-DO-AH-EP-AN.
 19351
 19352     GO TO S-4250-EP-DO-AH-STATUTORY.
 19353
 19354 S-4240-EP-DO-AH-EP-NP.
 19355
 19356     IF WE-AHPRM = ZERO
 19357         GO TO S-4250-EP-DO-AH-STATUTORY.
 19358
 19359     IF CR-APR GREATER THAN +0
 19360         NEXT SENTENCE
 19361     ELSE
 19362         GO TO S-4250-EP-DO-AH-STATUTORY.
 19363
 19364     IF DTE-CLIENT = 'NCL'
 19365       IF CR-DT LESS THAN 19910101
 19366           GO TO S-4250-EP-DO-AH-STATUTORY.
 19367
 19368     IF REM-TRM1 = CR-AH-TERM
 19369         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19370         GO TO S-4290-EP-DO-AH-COMM.
 19371
 19372     MOVE CR-APR TO NP-APR.
 19373     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19374     MOVE REM-TRM1 TO NP-REM.
 19375     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19376     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19377         MOVE CR-LOAN-TERM TO NP-ORIG.
 19378     MOVE 'R' TO NP-OPT.
 19379     CALL 'ECSNETRM'
 19380         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19381
 19382     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19383
 19384     GO TO S-4250-EP-DO-AH-STATUTORY.
 19385
 19386 S-4245-EP-DO-AH-EP-AN.
 19387     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19388     MOVE 'L'                        TO DC-OPTION-CODE.
 19389     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19390     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19391     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19392     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19393     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19394     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19395     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19396     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19397     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 368
* ECS010.cbl
 19398     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19399                                        CP-RATING-BENEFIT-AMT.
 19400     IF CP-STATE-STD-ABBRV = 'OR'
 19401         COMPUTE CP-RATING-BENEFIT-AMT =
 19402                                  CR-AHAMT * REM-TRM1.
 19403     MOVE CR-APR                     TO CP-LOAN-APR.
 19404     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19405     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19406     MOVE '3'                        TO CP-PROCESS-TYPE.
 19407     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19408     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19409
 19410     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19411         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19412     ELSE
 19413         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19414
 19415     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19416     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19417     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19418     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19419     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19420     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19421
 19422     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19423
 19424     IF CP-ERROR-RATE-NOT-FOUND  OR
 19425        CP-ERROR-RATE-IS-ZERO  OR
 19426        CP-ERROR-IN-DATES
 19427         GO TO S-4250-EP-DO-AH-STATUTORY.
 19428
 19429     COMPUTE EPR-R78 ROUNDED =
 19430             (REM-TRM1 * WE-AHAMT / +100 *
 19431               CP-PREMIUM-RATE)
 19432              / CR-AHPRM-CALC * CR-AHPRM
 19433
 19434     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19435
 19436     IF STATUTORY-REQUIREMENT-AH
 19437         MOVE EPR-R78                TO EPR-ST
 19438         GO TO S-4290-EP-DO-AH-COMM.
 19439
 19440 S-4250-EP-DO-AH-STATUTORY.
 19441     IF (DTE-CLIENT EQUAL 'CID') AND
 19442        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19443         GO TO S-4267-EP-DO-AH-STAT-ROA
 19444     END-IF.
 19445
 19446 S-4250-EP-DO-AH-STATUTORY-VA.
 19447
 19448     MOVE EPR-R78                    TO EPR-ST.
 19449
 19450     MOVE +0                         TO SUB1.
 19451
 19452 S-4255-EP-AH-STAT-LOOP.
 19453     ADD +1 TO SUB1.
 19454
 19455     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 369
* ECS010.cbl
 19456         MOVE EPR-PRO                TO EPR-ST
 19457     ELSE
 19458         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19459             GO TO S-4255-EP-AH-STAT-LOOP.
 19460
 19461     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19462         CR-DT GREATER THAN 19831031)
 19463                    OR
 19464        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19465         CR-DT GREATER THAN 19820629)
 19466                    OR
 19467        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19468         CR-DT GREATER THAN 19830831)
 19469             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19470
 19471     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19472       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19473         IF CR-DT LESS THAN 19970101
 19474             MOVE EPR-R78            TO EPR-ST
 19475         ELSE
 19476             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19477
 19478     GO TO S-4290-EP-DO-AH-COMM.
 19479
 19480 S-4267-EP-DO-AH-STAT-ROA.
 19481     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19482     MOVE 'L'                        TO DC-OPTION-CODE.
 19483     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19484     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19485     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19486     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19487     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19488     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19489     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19490     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19491     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19492     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19493                                        CP-RATING-BENEFIT-AMT.
 19494     IF CP-STATE-STD-ABBRV = 'OR'
 19495         COMPUTE CP-RATING-BENEFIT-AMT =
 19496                                  CR-AHAMT * REM-TRM1.
 19497     MOVE CR-APR                     TO CP-LOAN-APR.
 19498     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19499     MOVE 'A'                        TO CP-EARNING-METHOD.
 19500     MOVE '3'                        TO CP-PROCESS-TYPE.
 19501     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19502     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19503     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19504         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19505     ELSE
 19506         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19507     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19508     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19509     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19510     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19511     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19512     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19513
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 370
* ECS010.cbl
 19514     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19515
 19516     IF CP-ERROR-RATE-NOT-FOUND  OR
 19517        CP-ERROR-RATE-IS-ZERO  OR
 19518        CP-ERROR-IN-DATES
 19519         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19520
 19521     COMPUTE EPR-ST ROUNDED =
 19522             (REM-TRM1 * WE-AHAMT / +100 *
 19523               CP-PREMIUM-RATE)
 19524              / CR-AHPRM-CALC * CR-AHPRM
 19525
 19526     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19527
 19528     GO TO S-4290-EP-DO-AH-COMM.
 19529
 19530 S-4290-EP-DO-AH-COMM.
 19531
 19532     IF EARNED-BY-CANCEL = ZEROS
 19533         GO TO S-4295-AH-COMM-CONTINUE.
 19534
 19535     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19536         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19537
 19538     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19539         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19540
 19541     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19542         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19543
 19544 S-4295-AH-COMM-CONTINUE.
 19545
 19546     MOVE +0           TO SUB1.
 19547     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19548         10 TIMES.
 19549
 19550     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19551     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19552     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19553
 19554     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19555     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19556     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19557
 19558     MOVE 'Y'          TO EW-LEVEL-USED.
 19559
 19560     IF CR-POLICY-UNDERWRITTEN
 19561         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19562     ELSE
 19563         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19564
 19565
 19566 S-4299-EPBX.
 19567     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 371
* ECS010.cbl
 19569******************************************************************
 19570***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19571******************************************************************
 19572
 19573 S-4300-EP-COMM-LOOP.
 19574
 19575     ADD +1 TO SUB1.
 19576     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19577         GO TO S-4399-EP-COMM-LOOP-X.
 19578
 19579     IF EW-LF-AH = AH-OVERRIDE-L1
 19580         GO TO S-4350-EP-COMM-LOOP-A.
 19581
 19582*    IF CR-AGT-TYPE (SUB1) = 'K'
 19583*       COMPUTE COMM-WK =
 19584     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19585     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19586     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19587                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19588
 19589     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19590     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19591     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19592                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19593
 19594     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19595     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19596
 19597     GO TO S-4399-EP-COMM-LOOP-X.
 19598
 19599 S-4350-EP-COMM-LOOP-A.
 19600
 19601     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19602     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19603     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19604                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19605
 19606     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19607     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19608     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19609                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19610
 19611     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19612     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19613
 19614 S-4399-EP-COMM-LOOP-X.
 19615     EXIT.
 19616
 19617******************************************************************
 19618******************************************************************
 19619******************************************************************
 19620******************************************************************
 19621******************************************************************
 19622******************************************************************
 19623******************************************************************
 19624******************************************************************
 19625******************************************************************
 19626******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 372
* ECS010.cbl
 19628******************************************************************
 19629***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19630******************************************************************
 19631
 19632 4400-EP-FIND-TAB-ENT.
 19633
 19634     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19635         GO TO 4490-EP-FIND-TAB-SUB.
 19636     MOVE +1 TO SUB9.
 19637
 19638 4450-EP-FIND-TAB-LOOP.
 19639
 19640     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19641         GO TO 4490-EP-FIND-TAB-SUB.
 19642     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19643         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19644         GO TO 4490-EP-FIND-TAB-SUB.
 19645
 19646     ADD +1 TO SUB9.
 19647     IF SUB9 GREATER THAN +31
 19648         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19649         MOVE 0201 TO WS-ABEND-CODE
 19650         DISPLAY '******************************'
 19651         DISPLAY '***** ERROR LOCATION 020 *****'
 19652         DISPLAY '******************************'
 19653         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19654         GO TO ABEND-PGM.
 19655
 19656     GO TO 4450-EP-FIND-TAB-LOOP.
 19657
 19658 4490-EP-FIND-TAB-SUB.
 19659
 19660     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19661         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19662             ADD +1 TO SUB10
 19663             MOVE SUB10 TO SUB3
 19664             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19665         ELSE
 19666             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19667
 19668     IF WE-LF-AH = AH-OVERRIDE-L1
 19669         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19670             ADD +1 TO SUB10
 19671             MOVE SUB10 TO SUB3
 19672             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19673         ELSE
 19674             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19675
 19676*    IF SUB3 GREATER THAN +220
 19677*    IF SUB3 GREATER THAN +300
 19678     IF SUB3 GREATER THAN +900
 19679         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19680         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19681         MOVE 0202 TO WS-ABEND-CODE
 19682         DISPLAY '******************************'
 19683         DISPLAY '***** ERROR LOCATION 021 *****'
 19684         DISPLAY '******************************'
 19685         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 373
* ECS010.cbl
 19686         GO TO ABEND-PGM.
 19687
 19688     IF CR-POLICY-UNDERWRITTEN
 19689         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19690         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19691                                     TO EPEC-OPT-WORK-TABLE
 19692     ELSE
 19693         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19694         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19695
 19696     MOVE WE-REIN-CO         TO EW-REIN-CO
 19697                                EPEC-REIN-CO (SUB3)
 19698                                EPEC-REIN-CO-II (SUB3).
 19699     MOVE WE-LF-AH           TO EW-LF-AH
 19700                                EPEC-LF-AH (SUB3)
 19701                                EPEC-LF-AH-II (SUB3).
 19702     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19703                                EPEC-BEN-TYPE (SUB3)
 19704                                EPEC-BEN-TYPE-II (SUB3).
 19705
 19706 4499-EP-FIND-TAB-ENT-X.
 19707     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 374
* ECS010.cbl
 19709******************************************************************
 19710***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19711******************************************************************
 19712
 19713 4500-BUILD-EPEC-EXTRACT.
 19714
 19715     IF (DTE-CLIENT = 'DCC')
 19716*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19717        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19718     END-IF
 19719
 19720     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19721         VARYING SUB2 FROM +1 BY +1
 19722             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19723
 19724     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19725
 19726     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19727
 19728
 19729 4510-BUILD-EPEC-EXT.
 19730
 19731     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19732     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19733     IF EW-LEVEL-USED = 'Y'
 19734         MOVE SPACE                     TO W-UNDERWRITING-SW
 19735         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19736                 4518-BUILD-EPEC-RCD-X.
 19737
 19738     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19739     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19740     IF EW-LEVEL-USED = 'Y'
 19741         MOVE '*'                       TO W-UNDERWRITING-SW
 19742         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19743                 4518-BUILD-EPEC-RCD-X.
 19744
 19745     GO TO 4519-BUILD-EPEC-EXT-X.
 19746
 19747 4511-BUILD-EPEC-RECORD.
 19748
 19749     MOVE SPACES                        TO EP-RECORD.
 19750     MOVE 'EP'                          TO EP-RECORD-ID.
 19751     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19752     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19753     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19754     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19755                                           WS-EP-EFF-DTE-N.
 19756     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19757     IF EP-REI-CO NOT = SPACES
 19758         MOVE 'R'                       TO EP-REIN.
 19759     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19760     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19761
 19762     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19763     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19764     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19765
 19766     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 375
* ECS010.cbl
 19767     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19768     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19769
 19770     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19771     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19772     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19773     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19774
 19775     IF DTE-CLIENT NOT = 'NCL'
 19776         GO TO 4512-BUILD-EPEC-CONTINUE.
 19777
 19778     IF W-UNDERWRITTEN-DATA
 19779         GO TO 4512-BUILD-EPEC-CONTINUE.
 19780
 19781     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19782         GO TO 4512-BUILD-EPEC-CONTINUE.
 19783
 19784     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19785        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19786        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19787         NEXT SENTENCE
 19788     ELSE
 19789         GO TO 4512-BUILD-EPEC-CONTINUE.
 19790
 19791     IF OB-DATE-1-USED  OR
 19792        OB-DATE-2-USED  OR
 19793        OB-DATE-3-USED
 19794         NEXT SENTENCE
 19795     ELSE
 19796         GO TO 4512-BUILD-EPEC-CONTINUE.
 19797
 19798     IF OB-DATE-1-USED
 19799         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19800             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19801                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19802             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19803                                   EW-EPR-ST
 19804             GO TO 4512-BUILD-EPEC-CONTINUE
 19805         ELSE
 19806             GO TO 4512-BUILD-EPEC-CONTINUE.
 19807
 19808     IF OB-DATE-2-USED
 19809         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19810             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19811                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19812             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19813                                   EW-EPR-ST
 19814             GO TO 4512-BUILD-EPEC-CONTINUE
 19815         ELSE
 19816             GO TO 4512-BUILD-EPEC-CONTINUE.
 19817
 19818     IF OB-DATE-3-USED
 19819         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19820             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19821                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19822             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19823                                   EW-EPR-ST
 19824             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 376
* ECS010.cbl
 19825         ELSE
 19826             GO TO 4512-BUILD-EPEC-CONTINUE.
 19827
 19828 4512-BUILD-EPEC-CONTINUE.
 19829
 19830     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19831     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19832     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19833
 19834     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19835     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19836     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19837
 19838     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19839
 19840     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19841     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19842     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19843
 19844     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19845     MOVE ZEROS                         TO EP-CLM-PV.
 19846
 19847     if (dte-client = 'AHL')
 19848        and (ep-rcd-type = 'A')
 19849        and (ep-ben-code (1:1) = 'M')
 19850*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19851        continue
 19852     else
 19853        IF EP-RCD-TYPE = 'A' OR 'U'
 19854           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19855              PERFORM 4599A-CALC-IBNR
 19856                                 THRU 4599A-CALC-EXIT
 19857           end-if
 19858        end-if
 19859     end-if
 19860
 19861     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19862
 19863     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19864     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19865
 19866     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19867
 19868     IF EW-ISS-CNT = ZERO
 19869         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19870                                           EP-AVG-AGE
 19871       ELSE
 19872         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19873                                EW-ORIG-TERM / EW-ISS-CNT
 19874         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19875
 19876     IF EW-INFORCE-CNT = ZERO
 19877         MOVE ZERO                      TO EP-AVG-REM-TERM
 19878       ELSE
 19879         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19880                             EW-REM-TERM / EW-INFORCE-CNT.
 19881
 19882     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 377
* ECS010.cbl
 19883         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19884                                           EP-WEIGHTED-AGE
 19885       ELSE
 19886         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19887                                  EW-TERM-BEN / EW-ISS-BEN
 19888         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19889                                   EW-AGE-BEN / EW-ISS-BEN.
 19890
 19891     MOVE ZEROS                         TO
 19892         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19893         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19894
 19895     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19896                                           WS-EP-HI-COV-DT-N.
 19897     MOVE HIGH-CERT                     TO EP-HI-CERT
 19898                                           WS-EP-HI-CERT-N.
 19899     MOVE LOW-CERT                      TO EP-LO-CERT
 19900                                           WS-EP-LO-CERT-N.
 19901     IF DTE-PGM-OPT = '3'
 19902         MOVE 'P'                       TO EP-PURGE.
 19903
 19904     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19905         GO TO 4514-CONTINUE.
 19906
 19907     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19908
 19909     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19910         MOVE +1                 TO EP-LIFE-YEARS
 19911     ELSE
 19912         MOVE ZEROS              TO W-LIFE-YEARS
 19913         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19914                 VARYING
 19915             SUBM FROM +1 BY +1
 19916                 UNTIL
 19917             SUBM GREATER THAN +13
 19918         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19919             = W-LIFE-YEARS / 12
 19920             - (EPEC-LIFE-CTR (SUB2 1)
 19921             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19922         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19923         IF  EP-LIFE-YEARS LESS THAN +1
 19924             MOVE +1             TO EP-LIFE-YEARS.
 19925
 19926 4514-CONTINUE.
 19927
 19928     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 19929
 19930     MOVE SPACES                        TO EC-RECORD.
 19931     MOVE '1'                           TO WS-SEQ-NBR.
 19932     MOVE +0                            TO SUB3.
 19933     MOVE +0                            TO SUB4.
 19934     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 19935         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 19936         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 19937
 19938     GO TO 4518-BUILD-EPEC-RCD-X.
 19939
 19940 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 378
* ECS010.cbl
 19941
 19942     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 19943
 19944 4515-EXIT.
 19945     EXIT.
 19946
 19947 4518-BUILD-EPEC-RCD-X.
 19948     EXIT.
 19949
 19950 4519-BUILD-EPEC-EXT-X.
 19951     EXIT.
 19952
 19953 4520-BUILD-EPEC-LOAD-COMM.
 19954
 19955     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 19956
 19957     ADD +1 TO SUB3  SUB4.
 19958     MOVE ZEROS                  TO LEVELS-BUILT.
 19959
 19960 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 19961
 19962     IF SUB4 GREATER THAN WS-LOOP-MAX
 19963         IF AGT-SW = 'X'
 19964             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19965                 THRU 4900-WRT-SUMMARY-X
 19966             MOVE ' '            TO AGT-SW
 19967             MOVE WS-LOOP-MAX    TO  SUB4
 19968             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19969         ELSE
 19970             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 19971
 19972     IF LEVELS-BUILT EQUAL +5
 19973         IF AGT-SW = 'X'
 19974             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19975                 THRU 4900-WRT-SUMMARY-X
 19976             MOVE ' '            TO AGT-SW
 19977             MOVE ZEROS          TO LEVELS-BUILT
 19978             ADD 1 TO WS-SEQ-NBR
 19979             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 19980             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 19981                     4540-BUILD-CLEAR-X
 19982                 VARYING SUB3 FROM +1 BY +1
 19983                 UNTIL SUB3 GREATER THAN +5
 19984             MOVE +1             TO SUB3
 19985             GO TO 4531-BUILD-EPEC-LOAD-COMM
 19986         ELSE
 19987             MOVE +1             TO SUB3
 19988             MOVE ZEROS          TO LEVELS-BUILT
 19989             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 19990
 19991     IF SUB4 GREATER THAN WS-LOOP-MAX
 19992         IF AGT-SW = 'X'
 19993             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19994                 THRU 4900-WRT-SUMMARY-X
 19995             MOVE ' '                   TO AGT-SW
 19996             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19997         ELSE
 19998             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 379
* ECS010.cbl
 19999
 20000 4531-BUILD-EPEC-LOAD-COMM.
 20001
 20002     IF (EW-AGT-NO (SUB4) = SPACES)
 20003                  OR
 20004        ((EW-ISS-COM (SUB4) = ZEROS) AND
 20005         (EW-CNC-COM (SUB4) = ZEROS) AND
 20006         (EW-ECR-R78 (SUB4) = ZEROS) AND
 20007         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 20008         (EW-ECR-PRO (SUB4) = ZEROS) AND
 20009         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 20010         (EW-ECR-ST (SUB4) = ZEROS))
 20011         PERFORM 4540-BUILD-EPEC-CLEAR
 20012             THRU 4540-BUILD-CLEAR-X
 20013         ADD +1 TO SUB4
 20014         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20015
 20016     MOVE 'X'                           TO AGT-SW.
 20017     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 20018     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 20019     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 20020     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 20021     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 20022     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 20023     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 20024     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 20025     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 20026
 20027     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 20028
 20029     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20030
 20031 4539-BUILD-EPEC-LOAD-COMM-X.
 20032     EXIT.
 20033
 20034 4540-BUILD-EPEC-CLEAR.
 20035
 20036     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20037     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20038     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20039                                           EC-CNC-COMM (SUB3)
 20040                                           EC-COMM-78 (SUB3)
 20041                                           EC-COMM-PR (SUB3)
 20042                                           EC-COMM-ST (SUB3)
 20043                                           EC-COMM-78-ADJ (SUB3)
 20044                                           EC-COMM-PR-ADJ (SUB3).
 20045
 20046 4540-BUILD-CLEAR-X.
 20047     EXIT.
 20048
 20049 4541-CALC-IBNR.
 20050
 20051     MOVE +0                    TO TOT-AH-IBNR
 20052                                   TOT-AH-PRM
 20053                                   TOT-AH-PD-CLMS
 20054                                   TOT-AH-CLMRSV
 20055                                   TOT-LF-IBNR
 20056                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 380
* ECS010.cbl
 20057                                   TOT-LF-PD-CLMS
 20058                                   TOT-LF-CLMRSV
 20059
 20060     MOVE +0                    TO RTOT-AH-IBNR
 20061                                   RTOT-AH-PRM
 20062                                   RTOT-AH-PRMB
 20063                                   RTOT-AH-PD-CLMS
 20064                                   RTOT-AH-CLMRSV
 20065                                   RTOT-LF-IBNR
 20066                                   RTOT-LF-PRM
 20067                                   RTOT-LF-PD-CLMS
 20068                                   RTOT-LF-CLMRSV
 20069
 20070     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20071        (SUB2 > +900)
 20072        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20073*       IF W-UNDERWRITTEN-DATA
 20074*          MOVE EPEC-LEVELS-II (SUB2)
 20075*                                TO EPEC-WORK
 20076*       ELSE
 20077           MOVE EPEC-LEVELS (SUB2)
 20078                                 TO EPEC-WORK
 20079*       END-IF
 20080*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20081           IF EW-REIN-CO = SPACES
 20082              CONTINUE
 20083*             IF EW-LF-AH = 'L'
 20084*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20085*                   + EW-EPR-ST
 20086*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20087*                   + EW-CLM-AMT
 20088*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20089*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20090*             ELSE
 20091*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20092*                   + EW-EPR-ST
 20093*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20094*                   + EW-CLM-AMT
 20095*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20096*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20097           ELSE
 20098              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20099                 EW-LF-AH ' ' EW-BEN-TYPE
 20100              IF EW-LF-AH = 'L'
 20101                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20102                    + EW-EPR-ST
 20103                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20104                    + EW-CLM-AMT
 20105                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20106                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20107              ELSE
 20108                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20109                    + EW-EPR-ST
 20110                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20111                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20112                       + EW-EPR-ST
 20113                 END-IF
 20114                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 381
* ECS010.cbl
 20115                    + EW-CLM-AMT
 20116                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20117                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20118              END-IF
 20119           END-IF
 20120*       END-IF
 20121     END-PERFORM
 20122
 20123*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20124*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20125*    IF TOT-AH-IBNR < ZEROS
 20126*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20127*    END-IF
 20128*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20129*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20130*    IF TOT-LF-IBNR < ZEROS
 20131*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20132*    END-IF
 20133
 20134     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20135        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20136     IF RTOT-AH-IBNR < ZEROS
 20137        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20138     END-IF
 20139     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20140        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20141     IF RTOT-LF-IBNR < ZEROS
 20142        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20143     END-IF
 20144
 20145     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20146        (SUB2 > +900)
 20147        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20148*       IF W-UNDERWRITTEN-DATA
 20149*          MOVE EPEC-LEVELS-II (SUB2)
 20150*                                TO EPEC-WORK
 20151*       ELSE
 20152           MOVE EPEC-LEVELS (SUB2)
 20153                                 TO EPEC-WORK
 20154*       END-IF
 20155*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20156           IF EW-REIN-CO = SPACES
 20157              CONTINUE
 20158*             IF EW-LF-AH = 'L'
 20159*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20160*                   / TOT-LF-PRM
 20161*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20162*                   * RTOT-LF-IBNR
 20163**                  * TOT-LF-IBNR
 20164*             ELSE
 20165*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20166*                   / TOT-AH-PRM
 20167*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20168*                   * RTOT-AH-IBNR
 20169**                  * TOT-AH-IBNR
 20170*             END-IF
 20171           ELSE
 20172              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 382
* ECS010.cbl
 20173                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20174                    EW-EPR-ST ' ' RTOT-AH-PRM
 20175              IF EW-LF-AH = 'L'
 20176                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20177                    / RTOT-LF-PRM
 20178                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20179                    * RTOT-LF-IBNR
 20180              ELSE
 20181                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20182                    / RTOT-AH-PRMB
 20183                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20184                    * RTOT-AH-IBNR
 20185              END-IF
 20186              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20187                 move zeros to ew-clm-ibnr
 20188              end-if
 20189           END-IF
 20190*       END-IF
 20191*       IF W-UNDERWRITTEN-DATA
 20192*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20193*       ELSE
 20194           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20195*       END-IF
 20196     END-PERFORM
 20197
 20198     .
 20199 4541-EXIT.
 20200     EXIT.
 20201
 20202 4545-BUILD-BASE.
 20203
 20204     MOVE 'EC'                   TO EC-RECORD-ID.
 20205     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20206     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20207     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20208     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20209                                    WS-EC-EFF-DTE.
 20210     MOVE EW-REIN-CO             TO EC-REI-CO.
 20211     IF EC-REI-CO NOT = SPACES
 20212         MOVE 'R'                TO EC-REIN.
 20213     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20214     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20215     IF DTE-PGM-OPT = '3'
 20216         MOVE 'P'                TO EC-PURGE.
 20217     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20218
 20219 4545-BUILD-BASE-X.
 20220     EXIT.
 20221
 20222******************************************************************
 20223***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20224******************************************************************
 20225
 20226 4550-CLEAR-EPEC-TOTALS.
 20227
 20228     MOVE LOW-CERT             TO SV-LO-CERT.
 20229     MOVE HIGH-CERT            TO SV-HI-CERT.
 20230     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 383
* ECS010.cbl
 20231     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20232
 20233     MOVE +1                   TO SUB9.
 20234     MOVE +0                   TO SUB10.
 20235     MOVE ZERO                 TO EW-REIN-CO
 20236                                  EW-BEN-TYPE.
 20237     MOVE SPACE                TO EP-FLG
 20238                                  EW-LF-AH
 20239                                  EW-LEVEL-USED
 20240                                  W-TABLE-USED-SW.
 20241
 20242     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20243                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20244                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20245                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20246                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20247                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20248                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20249                                  EW-CLM-AMT     EW-COV-DTE
 20250                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20251                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20252                                  EW-CLM-CRT     EW-ISS-CNT
 20253                                  EW-CNC-CNT     EW-AGE
 20254                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20255                                  EW-AGE-BEN     EW-TERM-BEN
 20256                                  EW-ISS-PRM-TAX
 20257                                  EW-REM-TERM.
 20258
 20259     MOVE +1 TO SUB1.
 20260     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20261     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20262         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20263     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20264                                    EPEC-UNDW-OPT-DATA-TABLE.
 20265     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20266         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20267
 20268     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20269         VARYING SUB3 FROM +1 BY +1
 20270*        UNTIL SUB3 GREATER THAN +300.
 20271*        UNTIL SUB3 GREATER THAN +220.
 20272         UNTIL SUB3 GREATER THAN +900.
 20273
 20274     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20275
 20276 4555-CLEAR-EPEC-COMM.
 20277
 20278     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20279                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20280                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20281                EW-ECR-ST  (SUB1).
 20282     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20283                                    EW-AGT-TYPE (SUB1).
 20284
 20285     ADD +1 TO SUB1.
 20286
 20287 4560-CLEAR-EPEC-ALL.
 20288
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 384
* ECS010.cbl
 20289     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20290                                    EPEC-LEVELS-II (SUB1).
 20291     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20292
 20293 4570-CLEAR-EPEC-SUB-A.
 20294
 20295     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20296     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20297*        UNTIL SUB2 GREATER +300.
 20298         UNTIL SUB2 GREATER +900.
 20299
 20300 4580-CLEAR-EPEC-SUB-B.
 20301
 20302     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20303     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20304
 20305 4589-CLEAR-EPEC-TOTALS-X.
 20306     EXIT.
 20307
 20308 4590-INIT-OB.
 20309
 20310     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20311     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20312     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20313
 20314 4590-EXIT.
 20315     EXIT.
 20316
 20317 4599-BUILD-EPEC-EXTRACT-X.
 20318     EXIT.
 20319
 20320*********************************************************
 20321*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20322*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20323*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20324*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20325*  IN THE DATE CARD.                                    *
 20326*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20327*********************************************************
 20328
 20329 4599A-CALC-IBNR.
 20330
 20331     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20332        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20333                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20334         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20335                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20336                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20337
 20338     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20339         MOVE ZEROS                 TO EW-CLM-IBNR
 20340         GO TO 4599A-CALC-EXIT.
 20341
 20342     IF EP-REIN = 'R'
 20343         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20344
 20345     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20346
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 385
* ECS010.cbl
 20347 4599A-CALC-EXIT.
 20348      EXIT.
 20349 4599B-SEARCH.
 20350      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 386
* ECS010.cbl
 20352******************************************************************
 20353***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20354******************************************************************
 20355
 20356 4600-GET-OPT-IBNR.
 20357
 20358     IF  CR-POLICY-IS-ACTIVE
 20359         IF  CR-POLICY-IS-REISSUE
 20360             OR CR-POLICY-IS-MONTHLY
 20361             IF  W-LIFE
 20362                 GO TO 4600-EXIT
 20363             ELSE
 20364                 NEXT SENTENCE
 20365         ELSE
 20366             NEXT SENTENCE
 20367     ELSE
 20368         IF  W-LIFE
 20369             GO TO 4600-EXIT.
 20370
 20371     IF  W-LIFE
 20372         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20373     ELSE
 20374         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20375
 20376 4600-EXIT.
 20377     EXIT.
 20378
 20379 4620-DETERMINE-LIFE-IBNR.
 20380
 20381     IF  CR-LF-POLICY-IS-ACTIVE
 20382         ADD +1                  TO W-LF-ACTIVE
 20383         IF  CR-LF-POLICY-IS-REISSUE
 20384             OR CR-LF-POLICY-IS-MONTHLY
 20385             MOVE ZEROS          TO W-WK-IBNR
 20386             ADD +1              TO W-LF-REISSUE
 20387             GO TO 4620-EXIT
 20388         ELSE
 20389             NEXT SENTENCE
 20390     ELSE
 20391         ADD +1                  TO W-LF-INACTIVE
 20392         MOVE ZEROS              TO W-WK-IBNR
 20393         GO TO 4620-EXIT.
 20394
 20395     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20396         MOVE ZEROS              TO W-WK-IBNR
 20397         ADD +1                  TO W-LF-CALC-B
 20398         GO TO 4620-EXIT.
 20399
 20400     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20401                 AND
 20402             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20403                 AND
 20404             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20405             OR
 20406         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20407                 AND
 20408             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20409                 AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 387
* ECS010.cbl
 20410             REM-TRM2 NOT GREATER THAN ZERO)
 20411         MOVE ZEROS              TO W-WK-IBNR
 20412         ADD +1                  TO W-LF-BALLOON
 20413         GO TO 4620-EXIT
 20414     ELSE
 20415         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20416                 AND
 20417             REM-TRM2 NOT GREATER THAN ZERO)
 20418             ADD +1              TO W-LF-REMTERM-0
 20419             MOVE ZEROS          TO W-WK-IBNR
 20420             GO TO 4620-EXIT.
 20421
 20422     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20423
 20424     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20425         ADD +1                  TO W-LF-REMAMT-0
 20426         MOVE ZEROS              TO W-WK-IBNR
 20427         GO TO 4620-EXIT.
 20428
 20429     IF  AM-LIFE-IBNR-PCT NUMERIC
 20430             AND
 20431         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20432         COMPUTE W-WK-IBNR ROUNDED
 20433             = CP-REMAINING-AMT
 20434             / 1000
 20435             * AM-LIFE-IBNR-PCT
 20436     ELSE
 20437         COMPUTE W-WK-IBNR ROUNDED
 20438             = CP-REMAINING-AMT
 20439             / 1000
 20440             * COMPANY-IBNR-LIFE-FACTOR.
 20441
 20442     IF  CR-LF-IS-REIN-ONLY
 20443         ADD +1                  TO W-LF-REIN
 20444     ELSE
 20445         ADD +1                  TO W-LF-DATA-USED
 20446         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20447         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20448         IF  CR-LFTYP = '01'
 20449             ADD CP-REMAINING-AMT
 20450                                 TO W-01-REMAMT
 20451             ADD +1              TO W-01-DATA-USED
 20452         ELSE
 20453         IF  CR-LFTYP = '02'
 20454             ADD CP-REMAINING-AMT
 20455                                 TO W-02-REMAMT
 20456             ADD +1              TO W-02-DATA-USED
 20457         ELSE
 20458         IF  CR-LFTYP = '03'
 20459             ADD CP-REMAINING-AMT
 20460                                 TO W-03-REMAMT
 20461             ADD +1              TO W-03-DATA-USED
 20462         ELSE
 20463         IF  CR-LFTYP = '04'
 20464             ADD CP-REMAINING-AMT
 20465                                 TO W-04-REMAMT
 20466             ADD +1              TO W-04-DATA-USED
 20467         ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 388
* ECS010.cbl
 20468         IF  CR-LFTYP = '05'
 20469             ADD CP-REMAINING-AMT
 20470                                 TO W-05-REMAMT
 20471             ADD +1              TO W-05-DATA-USED
 20472         ELSE
 20473         IF  CR-LFTYP = '06'
 20474             ADD CP-REMAINING-AMT
 20475                                 TO W-06-REMAMT
 20476             ADD +1              TO W-06-DATA-USED
 20477         ELSE
 20478         IF  CR-LFTYP = '30'
 20479             ADD CP-REMAINING-AMT
 20480                                 TO W-30-REMAMT
 20481             ADD +1              TO W-30-DATA-USED
 20482         ELSE
 20483         IF  CR-LFTYP = '31'
 20484             ADD CP-REMAINING-AMT
 20485                                 TO W-31-REMAMT
 20486             ADD +1              TO W-31-DATA-USED
 20487         ELSE
 20488             ADD CP-REMAINING-AMT
 20489                                 TO W-XX-REMAMT
 20490             ADD +1              TO W-XX-DATA-USED.
 20491
 20492     IF  CR-POLICY-IS-REIN-ONLY
 20493             OR
 20494         CR-LF-IS-REIN-ONLY
 20495         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20496         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20497         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20498     ELSE
 20499         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20500
 20501 4620-EXIT.
 20502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 389
* ECS010.cbl
 20504 4640-GET-A-H-EARNED-PREMIUM.
 20505
 20506     IF  CR-AH-POLICY-IS-ACTIVE
 20507         ADD +1                  TO W-AH-ACTIVE
 20508         IF  CR-AH-POLICY-IS-REISSUE
 20509             OR CR-AH-POLICY-IS-MONTHLY
 20510             ADD +1              TO W-AH-REISSUE
 20511         ELSE
 20512             NEXT SENTENCE
 20513     ELSE
 20514         ADD +1                  TO W-AH-INACTIVE.
 20515
 20516     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20517         ADD +1                  TO W-AH-CALC-B
 20518         GO TO 4640-EXIT.
 20519
 20520     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20521         MOVE 'Y'                TO W-RTRM-0-SW
 20522     ELSE
 20523         MOVE SPACES             TO W-RTRM-0-SW.
 20524
 20525     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20526
 20527****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20528******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20529******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20530******        THAT CLAIM.
 20531
 20532     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20533
 20534     IF  CR-POLICY-IS-REIN-ONLY
 20535              OR
 20536         CR-AH-IS-REIN-ONLY
 20537         ADD +1                  TO W-AH-REIN
 20538         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20539         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20540         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20541         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20542         GO TO 4640-EXIT.
 20543
 20544     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20545                                    W-EPEC-EP-IN.
 20546     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20547                                    W-CLAIMS-MADE-PAID-IN.
 20548     ADD +1                      TO W-AH-DATA-USED.
 20549     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20550     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20551
 20552     IF  W-CLMAMT GREATER THAN ZEROS
 20553         ADD +1                  TO W-AH-CLAIM-CTR
 20554         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20555
 20556     IF  W-RTRM-0
 20557             AND
 20558         NOT CR-POLICY-IS-REIN-ONLY
 20559             AND
 20560         NOT CR-AH-IS-REIN-ONLY
 20561         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 390
* ECS010.cbl
 20562         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20563         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20564         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20565         ADD +1                  TO W-AH-REMTERM-0.
 20566
 20567 4640-EXIT.
 20568     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 391
* ECS010.cbl
 20570 4650-DETERMINE-CLM-AMT-AH.
 20571
 20572     MOVE ZEROS                  TO W-CLMAMT.
 20573
 20574     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20575             OR
 20576         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20577         GO TO 4650-EXIT.
 20578
 20579     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20580             AND
 20581         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20582         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20583         MOVE 'L'                    TO DC-OPTION-CODE
 20584         PERFORM 8000-DATE-CONVERT-ROUTINE
 20585             THRU 8099-DATE-CONVERT-X
 20586         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20587         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20588         MOVE 'L'                    TO DC-OPTION-CODE
 20589         PERFORM 8000-DATE-CONVERT-ROUTINE
 20590             THRU 8099-DATE-CONVERT-X
 20591         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20592         IF  DATE-CONVERSION-ERROR
 20593             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20594             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20595             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20596             MOVE 0303               TO WS-ABEND-CODE
 20597             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20598             GO TO ABEND-PGM
 20599         ELSE
 20600             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20601             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20602             MOVE '1'                TO DC-OPTION-CODE
 20603             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20604                                        DC-ELAPSED-DAYS
 20605             PERFORM 8000-DATE-CONVERT-ROUTINE
 20606                 THRU 8099-DATE-CONVERT-X
 20607             IF  DATE-CONVERSION-ERROR
 20608                 DISPLAY 'DIS TO PTO DATE ERROR '
 20609                     CR-FULL-CONTROL
 20610                 MOVE 'DIS TO PTO DATE ERROR '
 20611                                     TO WS-ABEND-MESSAGE
 20612                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20613                 MOVE 0303           TO WS-ABEND-CODE
 20614                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20615                 GO TO ABEND-PGM
 20616             ELSE
 20617                 COMPUTE W-CLMAMT ROUNDED
 20618                     = CR-AHAMT
 20619                     * (DC-ELAPSED-DAYS / 30)
 20620                 GO TO 4650-EXIT.
 20621
 20622     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20623             OR
 20624         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20625         GO TO 4650-EXIT.
 20626
 20627     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 392
* ECS010.cbl
 20628         = CR-AHAMT * 3.
 20629
 20630     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20631         MOVE CR-DISAMT          TO W-CLMAMT
 20632     ELSE
 20633         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20634
 20635     IF  NOT CR-POLICY-IS-REIN-ONLY
 20636              AND
 20637         NOT CR-AH-IS-REIN-ONLY
 20638         ADD +1          TO W-CLM-EXCEPT-CNT
 20639         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20640
 20641 4650-EXIT.
 20642     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 393
* ECS010.cbl
 20644 4660-DETERMINE-EARNED-PREMIUM.
 20645
 20646     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20647
 20648     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20649
 20650     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20651
 20652     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20653         MOVE ZEROS              TO W-EARNED-PREMIUM
 20654         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20655         MOVE '7'                TO W-VAL-SOURCE
 20656         PERFORM 8500-REMAINING-TERM-ROUTINE
 20657             THRU 8599-REM-TERM-X
 20658         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20659         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20660         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20661         MOVE EPR-R78            TO W-OPT-R78
 20662         MOVE EPR-PRO            TO W-OPT-PRO
 20663         MOVE EPR-ST             TO W-OPT-ST
 20664         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20665         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20666     ELSE
 20667         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20668
 20669     COMPUTE W-EARNED-PREMIUM ROUNDED
 20670         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20671
 20672     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20673         ADD +1                  TO W-EP-LESS-THAN-0
 20674         MOVE ZERO               TO W-EARNED-PREMIUM.
 20675
 20676 4660-EXIT.
 20677     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 394
* ECS010.cbl
 20679 4666-SAVE-AHCR-DATA.
 20680
 20681     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20682                                    WX-STATUS-AT-SETTLEMENT.
 20683
 20684     MOVE ZEROS                  TO WX-CANC-DT
 20685                                    WX-EOM-RUN-DATE
 20686                                    WX-SETTLEMENT-EXIT-DATE.
 20687
 20688     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20689         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20690         MOVE CR-AH-STATUS-AT-CANCEL
 20691                                 TO WX-STATUS-AT-CANCEL
 20692         MOVE ZEROS              TO CR-AH-CANC-DT
 20693                                    WS-CR-AH-CANC-DT-N
 20694         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20695
 20696     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20697         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20698                                 TO WX-SETTLEMENT-EXIT-DATE
 20699         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20700                                 TO WX-STATUS-AT-SETTLEMENT
 20701         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20702                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20703         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20704
 20705     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20706     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20707
 20708 4666-EXIT.
 20709     EXIT.
 20710
 20711 4668-RESTORE-AHCR-DATA.
 20712
 20713     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20714         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20715                                    WS-CR-AH-CANC-DT-N
 20716         MOVE WX-STATUS-AT-CANCEL
 20717                                 TO CR-AH-STATUS-AT-CANCEL.
 20718
 20719     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20720         MOVE WX-SETTLEMENT-EXIT-DATE
 20721                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20722                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20723         MOVE WX-STATUS-AT-SETTLEMENT
 20724                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20725
 20726     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20727
 20728 4668-EXIT.
 20729     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 395
* ECS010.cbl
 20731 4670-CALC-EP.
 20732
 20733     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20734         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20735         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20736         GO TO 4670-EXIT.
 20737
 20738     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20739         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20740         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20741         GO TO 4670-EXIT.
 20742
 20743***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20744
 20745     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20746         COMPUTE W-EARNED-PREMIUM
 20747             = (W-OPT-PRO + W-OPT-R78) / +2
 20748         ADD W-EARNED-PREMIUM    TO W-M-EP
 20749     ELSE
 20750         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20751             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20752             ADD W-EARNED-PREMIUM
 20753                                 TO W-R-EP
 20754         ELSE
 20755             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20756                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20757                 ADD W-EARNED-PREMIUM
 20758                                 TO W-P-EP
 20759             ELSE
 20760                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20761                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20762                         = (W-OPT-PRO * +.6667)
 20763                         + (W-OPT-R78 * +.3333)
 20764                     ADD W-EARNED-PREMIUM
 20765                                 TO W-1-EP
 20766                 ELSE
 20767                     ADD +1      TO W-OTHERS-COUNT
 20768                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20769
 20770 4670-EXIT.
 20771     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 396
* ECS010.cbl
 20773 4680-CALC-REMAINING-AMT-LF.
 20774
 20775     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20776     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20777     MOVE CR-APR                 TO CP-LOAN-APR.
 20778     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20779
 20780     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20781         MOVE +1                 TO CR-PMT-FREQ.
 20782
 20783     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20784
 20785     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20786     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20787                                    CP-RATING-BENEFIT-AMT.
 20788     IF CP-STATE-STD-ABBRV = 'OR'
 20789         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20790     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20791     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20792     MOVE ZEROS                  TO CP-REMAINING-AMT
 20793                                    CP-REMAINING-AMT-PRV
 20794                                    CP-RETURN-CODE
 20795                                    CP-RETURN-CODE-2.
 20796
 20797     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20798     IF (DTE-CLIENT = 'DCC')
 20799        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 20800        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20801           ((CR-STATE = DD-STATE (D1))
 20802           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20803           AND ('A'           = DD-BEN-TYPE   (D1))
 20804           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 20805           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20806                           OR
 20807           D1 > max-pdef
 20808        END-PERFORM
 20809        IF D1 <= max-pdef
 20810           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20811              (P1 > +8)
 20812              OR (DD-PROD-CODE (D1 P1) = 'L')
 20813           END-PERFORM
 20814           IF P1 < +9
 20815              MOVE DD-MAX-BEN-AMT (D1 P1)
 20816                                 TO CP-R-MAX-TOT-BEN
 20817           END-IF
 20818        END-IF
 20819     END-IF
 20820
 20821     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20822
 20823     IF  CP-RETURN-CODE NOT = ZERO
 20824         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20825                             TO WS-ABEND-MESSAGE
 20826         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20827         MOVE 2001           TO WS-ABEND-CODE
 20828         GO TO ABEND-PGM.
 20829
 20830 4680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 397
* ECS010.cbl
 20831     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 398
* ECS010.cbl
 20833******************************************************************
 20834***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20835******************************************************************
 20836
 20837 4700-CALC-OPT-IBNR.
 20838
 20839     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20840     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20841
 20842     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20843             VARYING
 20844         SUB2 FROM +1 BY +1
 20845             UNTIL
 20846*        SUB2 GREATER THAN 300.
 20847*        SUB2 GREATER THAN 220.
 20848         SUB2 GREATER THAN 900.
 20849
 20850     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20851                                 TO EPEC-OPT-WORK-TABLE.
 20852     MOVE '*'                    TO W-UNDERWRITING-SW.
 20853
 20854     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20855             VARYING
 20856         SUB2 FROM +1 BY +1
 20857             UNTIL
 20858*        SUB2 GREATER THAN 300.
 20859*        SUB2 GREATER THAN 220.
 20860         SUB2 GREATER THAN 900.
 20861
 20862 4700-EXIT.
 20863     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 399
* ECS010.cbl
 20865 4710-PROCESS-THRU-EPEC-TABLE.
 20866
 20867     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20868         GO TO 4710-EXIT.
 20869
 20870     IF  W-UNDERWRITTEN-DATA
 20871         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20872     ELSE
 20873         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20874
 20875     IF EW-LEVEL-USED NOT = 'Y'
 20876         GO TO 4710-EXIT.
 20877
 20878     IF  EW-REIN-CO GREATER THAN SPACES
 20879         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20880         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20881             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20882             IF  W-WK-IBNR GREATER THAN ZEROS
 20883                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20884                 GO TO 4710-EXIT
 20885             ELSE
 20886                 GO TO 4710-EXIT
 20887         ELSE
 20888             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20889                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20890                 GO TO 4710-EXIT
 20891             ELSE
 20892                 GO TO 4710-EXIT.
 20893
 20894     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20895
 20896     IF  EW-LF-AH EQUAL 'L'
 20897         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20898             GO TO 4710-EXIT
 20899         ELSE
 20900             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20901             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20902     ELSE
 20903         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20904                 GREATER THAN ZEROS
 20905             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20906             ADD W-WK-IBNR       TO W-AH-IBNR
 20907         ELSE
 20908             GO TO 4710-EXIT.
 20909
 20910     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20911     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20912     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20913
 20914     IF  W-UNDERWRITTEN-DATA
 20915         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 20916     ELSE
 20917         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 20918
 20919
 20920     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20921     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 20922
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 400
* ECS010.cbl
 20923 4710-EXIT.
 20924     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 401
* ECS010.cbl
 20926 4720-PROCESS-LIFE.
 20927
 20928     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 20929
 20930 4720-EXIT.
 20931     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 402
* ECS010.cbl
 20933 4730-PROCESS-A-H.
 20934
 20935     IF  AM-TARGET-LOSS-RATIO NUMERIC
 20936             AND
 20937         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 20938         MOVE AM-TARGET-LOSS-RATIO
 20939                                 TO W-TARGET-LOSS-RATIO
 20940     ELSE
 20941         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 20942             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 20943                                 TO W-TARGET-LOSS-RATIO
 20944             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 20945
 20946     IF  W-NOT-REIN-PROCESS
 20947         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 20948         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 20949
 20950     COMPUTE W-IBNR-1 ROUNDED
 20951         = EPEC-EARNED-PREMIUM-AH (SUB2)
 20952         * COMPANY-IBNR-AH-FACTOR
 20953         * W-TARGET-LOSS-RATIO.
 20954
 20955     COMPUTE W-IBNR-2 ROUNDED
 20956         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 20957         * W-TARGET-LOSS-RATIO)
 20958         - EPEC-CLAIMS-MADE-PAID (SUB2).
 20959
 20960     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 20961         MOVE W-IBNR-1           TO W-WK-IBNR
 20962         IF  W-NOT-REIN-PROCESS
 20963             ADD +1              TO W-AH-IBNR-1-CNT
 20964             ADD W-IBNR-1        TO W-AH-IBNR-1
 20965         ELSE
 20966             NEXT SENTENCE
 20967     ELSE
 20968         MOVE W-IBNR-2           TO W-WK-IBNR
 20969         IF  W-NOT-REIN-PROCESS
 20970             ADD +1              TO W-AH-IBNR-2-CNT
 20971             ADD W-IBNR-2        TO W-AH-IBNR-2.
 20972
 20973 4730-EXIT.
 20974     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 403
* ECS010.cbl
 20976 4735-GET-BUSINESS-ADJUSTMENT.
 20977
 20978     IF  CR-GRPTYP NOT NUMERIC
 20979         MOVE '99'               TO INDEXBS
 20980     ELSE
 20981         MOVE CR-GRPTYP          TO INDEXBS.
 20982
 20983     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 20984             AND
 20985         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20986             NOT EQUAL ZEROS
 20987             AND
 20988         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20989             NOT EQUAL +1.0000
 20990         MOVE INDEXBS           TO W-EDIT-7
 20991         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 20992             = W-TARGET-LOSS-RATIO
 20993             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 20994
 20995 4735-EXIT.
 20996     EXIT.
 20997
 20998 4740-CREATE-DETAIL-EXTR.
 20999
 21000     IF DTE-PGM-OPT NOT = '1'
 21001         GO TO 4740-EXIT.
 21002
 21003     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 21004         GO TO 4740-EXIT.
 21005
 21006     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 21007     MOVE ZEROS                  TO REPORTED-DATE
 21008                                    PAY-TO-DATE.
 21009
 21010     MOVE SPACES                 TO TR-DTL2.
 21011     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 21012
 21013     MOVE EOM-YR                 TO TRD-ISYR.
 21014     MOVE EOM-MO                 TO TRD-ISMO.
 21015     MOVE EOM-DA                 TO TRD-ISDA.
 21016     MOVE ZERO                   TO TRD-AGE.
 21017
 21018     IF  EW-LF-AH EQUAL 'L'
 21019         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 21020     ELSE
 21021         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 21022
 21023     MOVE SPACES                 TO TRD-PAYCURX
 21024                                    TRD-PAYCUR-SPACE
 21025                                    TRD-FUTRSV-SPACE
 21026                                    TRD-FUTRSVX.
 21027
 21028     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21029     MOVE 'IBNR'                 TO TRD-IBNRX.
 21030     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21031     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21032
 21033     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 404
* ECS010.cbl
 21034         IF  W-REIN-IN-PROCESS
 21035             MOVE ' ACCT/BEN REIN RSV UW'
 21036                                 TO TRD-RSV-ACTION
 21037         ELSE
 21038             MOVE ' ACCT/BEN RESERVES UW'
 21039                                 TO TRD-RSV-ACTION
 21040     ELSE
 21041         IF  W-REIN-IN-PROCESS
 21042             MOVE ' ACCT/BEN REIN RSV'
 21043                                 TO TRD-RSV-ACTION
 21044         ELSE
 21045             MOVE ' ACCT/BEN RESERVES'
 21046                                 TO TRD-RSV-ACTION.
 21047
 21048     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21049
 21050     MOVE SPACES                 TO DETAIL-EXTRACT.
 21051
 21052     IF  W-REIN-IN-PROCESS
 21053         MOVE EW-REIN-CO         TO DE-REI-COMP
 21054         MOVE 'R'                TO DE-REIN
 21055         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21056         MOVE ZEROS              TO DE-IBNR
 21057     ELSE
 21058         MOVE EW-CLM-IBNR        TO DE-IBNR
 21059         MOVE ZEROS              TO DE-REI-IBNR.
 21060
 21061     MOVE 'DE'                   TO DE-RECORD-ID.
 21062     MOVE 'Y'                    TO DE-TRANS.
 21063     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21064     MOVE '1'                    TO DE-ENTRY-STATUS.
 21065     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21066
 21067     MOVE EOM-RUN-DATE           TO DE-EFF
 21068                                    WS-DE-EFF-N
 21069                                    DE-ENTRY-DTE
 21070                                    WS-DE-ENTRY-DTE-N.
 21071     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21072                                    WS-DE-RSV-INCUR-N.
 21073
 21074     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21075     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21076     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21077                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21078     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21079                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21080
 21081     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21082     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21083     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21084     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21085     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21086*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21087     MOVE AM-IG                  TO DE-IG.
 21088
 21089     IF W-UNDERWRITTEN-DATA
 21090         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21091     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 405
* ECS010.cbl
 21092         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21093
 21094     IF  EW-LF-AH EQUAL 'L'
 21095         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21096         MOVE '1'                TO DE-RESERVE-TYPE
 21097         MOVE ZEROS              TO DE-AH-TYPE
 21098     ELSE
 21099         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21100         MOVE '2'                TO DE-RESERVE-TYPE
 21101         MOVE ZEROS              TO DE-LF-TYPE.
 21102
 21103     MOVE SPACES                 TO DE-NAME
 21104                                    DE-ACC-GPCD
 21105                                    DE-AH-STAT-CDE
 21106                                    DE-LF-STAT-CDE
 21107                                    DE-MEMBER-NO
 21108                                    DE-NAME
 21109                                    DE-SEX.
 21110     MOVE ZEROS                  TO DE-AGE
 21111                                    DE-AH-BEN
 21112                                    DE-AH-CANC-DTE
 21113                                    WS-DE-AH-CANC-DTE-N
 21114                                    DE-AH-CANC-EXIT-DT
 21115                                    WS-DE-AH-CANC-EXIT-DT-N
 21116                                    DE-AH-PRM
 21117                                    DE-AH-RFND
 21118                                    DE-AH-TERM
 21119                                    DE-APR
 21120                                    DE-CANCEL-CNT-ITD
 21121                                    DE-CANCEL-CNT-YTD
 21122                                    DE-FUTRSV
 21123                                    DE-LF-BEN
 21124                                    DE-LF-BEN-ALT
 21125                                    DE-LF-CANC-DTE
 21126                                    WS-DE-LF-CANC-DTE-N
 21127                                    DE-LF-CANC-EXIT-DT
 21128                                    WS-DE-LF-CANC-EXIT-DT-N
 21129                                    DE-LF-CNBEN
 21130                                    DE-LF-CNBEN-ALT
 21131                                    DE-LF-PRM
 21132                                    DE-LF-PRM-ALT
 21133                                    DE-LF-RFND
 21134                                    DE-LF-TERM
 21135                                    DE-LOAN-TERM
 21136                                    DE-LIVES
 21137                                    DE-PAYCUR
 21138                                    DE-PMT-FREQ
 21139                                    DE-REI-AHAMT
 21140                                    DE-REI-AHPRM
 21141                                    DE-REI-AHRFND
 21142                                    DE-REI-CNAMT
 21143                                    DE-REI-FUTRSV
 21144                                    DE-REI-LFAMT
 21145                                    DE-REI-LFPRM
 21146                                    DE-REI-LFRFND
 21147                                    DE-REI-PAYCUR
 21148                                    DE-RSV-REPORTED
 21149                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 406
* ECS010.cbl
 21150                                    WS-DE-RSV-PAYTO-N
 21151                                    DE-MOB-NET-TOT-FEES
 21152                                    DE-SOC-SEC-NO.
 21153
 21154     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21155
 21156     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21157         THRU 2599-WRT-DETAIL-X.
 21158     ADD +1                      TO BC-G-CRS.
 21159
 21160 4740-EXIT.
 21161     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 407
* ECS010.cbl
 21163 4750-UPDATE-REIN.
 21164
 21165     COMPUTE SUB3 = SUB2 + 1.
 21166
 21167     IF  W-UNDERWRITTEN-DATA
 21168         MOVE EPEC-SUB-KEY-II (SUB2)
 21169                                 TO W-SUB-KEY
 21170     ELSE
 21171         MOVE EPEC-SUB-KEY (SUB2)
 21172                                 TO W-SUB-KEY.
 21173
 21174     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21175             VARYING
 21176         SUB3 FROM SUB3 BY +1
 21177             UNTIL
 21178         SUB3 GREATER THAN +900
 21179*        SUB3 GREATER THAN +220
 21180*        SUB3 GREATER THAN +300
 21181             OR
 21182         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21183
 21184 4750-EXIT.
 21185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 408
* ECS010.cbl
 21187 4755-MATCH-REIN-EPEC.
 21188
 21189     IF  W-UNDERWRITTEN-DATA
 21190         MOVE EPEC-LEVELS-II (SUB3)
 21191                                 TO EPEC-WORK
 21192     ELSE
 21193         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21194
 21195     IF  EPEC-LINE-NOT-USED (SUB3)
 21196         GO TO 4755-EXIT.
 21197
 21198     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21199             OR
 21200         EW-REIN-CO EQUAL SPACES
 21201         GO TO 4755-EXIT.
 21202
 21203     IF  W-ISS-BEN GREATER THAN ZEROS
 21204         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21205             COMPUTE W-FACTOR ROUNDED
 21206                 = (EW-ISS-BEN
 21207                 - EPEC-REIN-ISS-BEN (SUB3))
 21208                 / W-ISS-BEN
 21209         ELSE
 21210             COMPUTE W-FACTOR ROUNDED
 21211                 = EW-ISS-BEN
 21212                 / W-ISS-BEN.
 21213
 21214     COMPUTE EW-CLM-IBNR ROUNDED
 21215         = EW-CLM-IBNR
 21216         + (W-WK-IBNR * W-FACTOR).
 21217
 21218     IF  W-UNDERWRITTEN-DATA
 21219         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21220     ELSE
 21221         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21222
 21223 4755-EXIT.
 21224     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 409
* ECS010.cbl
 21226 4760-PROCESS-REIN-ONLY.
 21227
 21228     MOVE ZEROS                  TO W-WK-IBNR.
 21229
 21230     IF  EPEC-LINE-NOT-USED (SUB2)
 21231         GO TO 4760-EXIT.
 21232
 21233     IF  EW-LF-AH EQUAL 'L'
 21234         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21235             GO TO 4760-EXIT
 21236         ELSE
 21237             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21238             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21239     ELSE
 21240         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21241             GO TO 4760-EXIT
 21242         ELSE
 21243             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21244             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21245
 21246 4760-EXIT.
 21247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 410
* ECS010.cbl
 21249 4770-CREATE-REIN-DETAIL.
 21250
 21251     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21252     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21253
 21254 4770-EXIT.
 21255     EXIT.
 21256
 21257 4799-EXIT.
 21258     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 411
* ECS010.cbl
 21260 4800-CALC-EARNED-PREMIUM-AH.
 21261
 21262     MOVE +0                         TO CNC-BEN  EPR-R78
 21263                                        ISS-PRM  EPR-PRO
 21264                                        CNC-PRM  EPR-ST
 21265                                        WX-CLM-AMT
 21266                                        WX-CLM-EXP
 21267                                        WX-CLM-CNT
 21268                                        WX-CLM-CRT
 21269                                        WX-CNC-CNT
 21270                                        ISS-PRMTAX
 21271                                        WX-ACTIVE-COUNT.
 21272     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21273
 21274     MOVE WE-AHPRM TO ISS-PRM.
 21275
 21276     IF DTE-CLIENT = 'GIC'
 21277         IF REIN-EP-FLG NOT = 'R'  AND
 21278            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21279            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21280            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21281
 21282     IF REIN-EP-FLG = 'R'  AND
 21283        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21284         NEXT SENTENCE
 21285     ELSE
 21286         GO TO 4810-EP-DO-AH-CLM.
 21287
 21288     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21289         IF WE-DSPY-AMT NOT = +0
 21290             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21291             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21292             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21293             ADD +1             TO WX-CLM-CNT.
 21294
 21295     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21296         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21297             GO TO 4830-EP-DO-AH-EP.
 21298
 21299     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21300         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21301             GO TO 4830-EP-DO-AH-EP.
 21302
 21303     GO TO 4815-EP-DO-AH-CLM-EPR.
 21304
 21305 4810-EP-DO-AH-CLM.
 21306
 21307     IF WE-DSPY-AMT NOT = +0
 21308         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21309         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21310         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21311         ADD +1             TO WX-CLM-CNT.
 21312
 21313 4815-EP-DO-AH-CLM-EPR.
 21314
 21315     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21316         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21317
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 412
* ECS010.cbl
 21318 4820-EP-DO-AH-CNCL.
 21319
 21320     IF CR-AH-STATUS-AT-CANCEL = ' '
 21321         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21322            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21323             GO TO 4899-EXIT
 21324         ELSE
 21325             GO TO 4830-EP-DO-AH-EP.
 21326
 21327     IF (DTE-CLIENT = 'DCC')
 21328        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21329        IF CR-AHRFND NOT = ZEROS
 21330           ADD +1                TO WX-CNC-CNT
 21331        END-IF
 21332     ELSE
 21333        ADD +1                   TO WX-CNC-CNT
 21334     END-IF
 21335
 21336     MOVE WE-AHRFND TO CNC-PRM.
 21337
 21338*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21339*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21340*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21341*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21342
 21343     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21344     MOVE 'L'                   TO  DC-OPTION-CODE.
 21345     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21346     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21347
 21348     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21349     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21350     MOVE '1'                     TO  DC-OPTION-CODE.
 21351     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21352     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21353                                      DC-ODD-DAYS-OVER
 21354                                      DC-ELAPSED-DAYS.
 21355     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21356     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21357
 21358     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21359         ADD  +1                  TO  MONTHS-DIFF-AH.
 21360
 21361     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21362                                      WS-DCC-DDF-CB-LEVELS
 21363
 21364     if (dte-client = 'AHL')
 21365        and (cr-ah-cancel-exit-date < 20120401)
 21366        go to 4820-continue-ah-cancel
 21367     end-if
 21368
 21369     IF DTE-CLIENT = 'ACE'
 21370         GO TO 4820-CONTINUE-AH-CANCEL.
 21371
 21372     MOVE  ZEROS                  TO  SUB.
 21373
 21374 4820-AH-CHARGEBACK-LOOP.
 21375
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 413
* ECS010.cbl
 21376     ADD    +1                    TO  SUB.
 21377
 21378     IF  SUB  GREATER THAN  +10
 21379         GO TO  4820-CONTINUE-AH-CANCEL.
 21380
 21381     IF CR-CANCEL-REASON = 'R'
 21382        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21383           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21384              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21385              GO TO  4820-AH-CHARGEBACK-LOOP
 21386           END-IF
 21387           IF AM-COM-TYP (SUB) = 'J'
 21388              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21389              GO TO  4820-AH-CHARGEBACK-LOOP
 21390           END-IF
 21391        END-IF
 21392     END-IF
 21393
 21394     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21395         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21396         GO TO  4820-AH-CHARGEBACK-LOOP.
 21397
 21398     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21399         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21400
 21401     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21402         OR (CR-AHRFND = ZEROS)
 21403         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21404     END-IF
 21405
 21406     GO TO  4820-AH-CHARGEBACK-LOOP.
 21407
 21408
 21409 4820-CONTINUE-AH-CANCEL.
 21410
 21411     IF DTE-CLIENT = 'GIC'
 21412         IF REIN-EP-FLG NOT = 'R'  AND
 21413            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21414            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21415
 21416     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21417     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21418
 21419     IF CR-AH-LUMP-SUM-DISAB
 21420         GO TO 4899-EXIT.
 21421
 21422     MOVE WE-AHAMT TO CNC-BEN.
 21423
 21424     GO TO 4899-EXIT.
 21425
 21426 4825-EP-DO-AH-CNCL-SUM.
 21427
 21428     IF WE-DSPY-AMT NOT = +0
 21429         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21430         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21431         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21432         ADD +1             TO WX-CLM-CNT.
 21433
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 414
* ECS010.cbl
 21434     IF WE-AHRFND = ZERO
 21435        GO TO 4830-EP-DO-AH-EP.
 21436
 21437     MOVE WE-AHRFND TO CNC-PRM.
 21438
 21439     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21440
 21441     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21442                                      WS-DCC-DDF-CB-LEVELS
 21443
 21444     IF WE-AHRFND NOT LESS WE-AHPRM
 21445         MOVE WE-AHAMT TO CNC-BEN
 21446          GO TO 4830-EP-DO-AH-EP.
 21447
 21448     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21449     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21450     MOVE TEMP-7 TO CNC-BEN.
 21451
 21452 4830-EP-DO-AH-EP.
 21453
 21454     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21455     MOVE '8'           TO W-VAL-SOURCE.
 21456
 21457     IF REIN-EP-FLG = 'R'
 21458       IF REIN-REM-SW (SUB5) = 'I'
 21459           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21460           GO TO 4899-EXIT.
 21461
 21462     IF REIN-EP-FLG = 'R'
 21463         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21464            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21465             MOVE '*'               TO A-H-EARNED-SWITCH
 21466             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21467             MOVE '10'              TO W-VAL-SOURCE.
 21468
 21469     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21470
 21471     IF REM-TRM2 GREATER CR-AH-TERM
 21472         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21473         GO TO 4899-EXIT.
 21474
 21475     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21476         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21477*
 21478 4835-CHECK-OB-AH-NCL.
 21479
 21480     IF (DTE-CLIENT EQUAL 'NCL') AND
 21481        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21482           MOVE WE-AHPRM         TO EPR-R78
 21483                                    EPR-PRO
 21484                                    EPR-ST
 21485        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21486           (CR-MO EQUAL EOM-MO)
 21487           MOVE '*'            TO OB-DATE-1-SWITCH
 21488           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21489           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21490           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21491           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 415
* ECS010.cbl
 21492                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21493           GO TO 4899-EXIT
 21494        ELSE
 21495        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21496           (CR-MO EQUAL OB-MO (1))
 21497           MOVE '*'            TO OB-DATE-2-SWITCH
 21498           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21499           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21500           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21501           COMPUTE WS-EPR-R78 (SUB3 2) =
 21502                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21503           GO TO 4899-EXIT
 21504        ELSE
 21505        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21506           (CR-MO EQUAL OB-MO (2))
 21507           MOVE '*'            TO OB-DATE-3-SWITCH
 21508           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21509           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21510           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21511           COMPUTE WS-EPR-R78 (SUB3 3) =
 21512                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21513           GO TO 4899-EXIT
 21514        ELSE
 21515           GO TO 4899-EXIT.
 21516
 21517     IF REM-TRM2 NOT GREATER +0
 21518         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21519         GO TO 4899-EXIT.
 21520
 21521     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21522         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21523         GO TO 4899-EXIT.
 21524
 21525     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21526         MOVE +1 TO WX-ACTIVE-COUNT
 21527     ELSE
 21528         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21529
 21530     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21531     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21532     IF DTE-R78 = '1'
 21533         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21534     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21535
 21536     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21537         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21538     ELSE
 21539         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21540
 21541     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21542     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21543
 21544     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21545     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21546
 21547     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21548
 21549*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 416
* ECS010.cbl
 21550*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21551
 21552     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21553
 21554     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21555        (CR-DT GREATER THAN  19921231)
 21556        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21557         IF CR-AH-TERM GREATER THAN  +61
 21558             MOVE 'A' TO AH-EARN-METHOD
 21559             MOVE '*' TO STATUTORY-SWITCH-AH
 21560             GO TO 4845-EP-DO-AH-EP-AN
 21561         ELSE
 21562             GO TO 4860-EP-DO-AH-STATUTORY.
 21563
 21564     IF (AH-EARN-METHOD EQUAL 'N')
 21565                  OR
 21566        ((DTE-CLIENT = 'DCC')
 21567         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21568         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21569                                    NOT = 'G' AND 'D'))
 21570         GO TO 4840-EP-DO-AH-EP-NP
 21571     END-IF
 21572
 21573     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21574         MOVE 'A' TO AH-EARN-METHOD
 21575         GO TO 4845-EP-DO-AH-EP-AN.
 21576
 21577     GO TO 4860-EP-DO-AH-STATUTORY.
 21578
 21579 4840-EP-DO-AH-EP-NP.
 21580
 21581     IF WE-AHPRM = ZERO
 21582         GO TO 4860-EP-DO-AH-STATUTORY.
 21583
 21584     IF CR-APR GREATER THAN +0
 21585         NEXT SENTENCE
 21586     ELSE
 21587         GO TO 4860-EP-DO-AH-STATUTORY.
 21588
 21589     IF DTE-CLIENT = 'NCL'
 21590       IF CR-DT LESS THAN 19910101
 21591           GO TO 4860-EP-DO-AH-STATUTORY.
 21592
 21593     IF REM-TRM1 = CR-AH-TERM
 21594         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21595         GO TO 4899-EXIT.
 21596
 21597     MOVE CR-APR TO NP-APR.
 21598     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21599     MOVE REM-TRM1 TO NP-REM.
 21600     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21601     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21602         MOVE CR-LOAN-TERM TO NP-ORIG.
 21603
 21604     IF (DTE-CLIENT = 'DCC')
 21605        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21606        MOVE 'S'                 TO NP-OPT
 21607     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 417
* ECS010.cbl
 21608        MOVE 'R'                 TO NP-OPT
 21609     END-IF
 21610
 21611
 21612*    MOVE 'R' TO NP-OPT.
 21613     CALL 'ECSNETRM'
 21614         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21615
 21616     IF (DTE-CLIENT = 'DCC')
 21617        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21618        COMPUTE EPR-ST ROUNDED =
 21619           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21620        GO TO 4899-EXIT
 21621     ELSE
 21622        COMPUTE EPR-R78 ROUNDED =
 21623           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21624     END-IF
 21625
 21626     GO TO 4860-EP-DO-AH-STATUTORY.
 21627
 21628 4845-EP-DO-AH-EP-AN.
 21629     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21630     MOVE 'L'                        TO DC-OPTION-CODE.
 21631     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21632     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21633     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21634     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21635     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21636     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21637     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21638     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21639     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21640     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21641                                        CP-RATING-BENEFIT-AMT.
 21642     IF CP-STATE-STD-ABBRV = 'OR'
 21643         COMPUTE CP-RATING-BENEFIT-AMT =
 21644                                  CR-AHAMT * REM-TRM1.
 21645     MOVE CR-APR                     TO CP-LOAN-APR.
 21646     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21647     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21648     MOVE '3'                        TO CP-PROCESS-TYPE.
 21649     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21650     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21651     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21652         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21653     ELSE
 21654         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21655     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21656     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21657     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21658     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21659     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21660     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21661
 21662     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21663
 21664     IF CP-ERROR-RATE-NOT-FOUND  OR
 21665        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 418
* ECS010.cbl
 21666        CP-ERROR-IN-DATES
 21667         GO TO 4860-EP-DO-AH-STATUTORY.
 21668
 21669     COMPUTE EPR-R78 ROUNDED =
 21670             (REM-TRM1 * WE-AHAMT / +100 *
 21671               CP-PREMIUM-RATE)
 21672              / CR-AHPRM-CALC * CR-AHPRM
 21673
 21674     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21675
 21676     IF STATUTORY-REQUIREMENT-AH
 21677         MOVE EPR-R78                TO EPR-ST
 21678         GO TO 4899-EXIT.
 21679
 21680 4860-EP-DO-AH-STATUTORY.
 21681     IF (DTE-CLIENT EQUAL 'CID') AND
 21682        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21683         GO TO 4867-EP-DO-AH-STAT-ROA
 21684     END-IF.
 21685
 21686 4860-EP-DO-AH-STATUTORY-VA.
 21687
 21688     IF (DTE-CLIENT = 'DCC')
 21689        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21690        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21691        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21692        MOVE EPR-R78             TO EPR-ST
 21693        GO TO 4899-EXIT
 21694     END-IF
 21695
 21696     IF (DTE-CLIENT = 'DCC')
 21697        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21698        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21699        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21700        MOVE +1.0000                TO TEMP-6
 21701        IF REM-TRM1 < +9
 21702           COMPUTE TEMP-6 =
 21703              ((9 - (9 - REM-TRM1)) - 1)
 21704              * +.125
 21705        END-IF
 21706        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21707        MOVE EPR-ST              TO EPR-R78
 21708                                    EPR-PRO
 21709        GO TO 4899-EXIT
 21710     END-IF
 21711
 21712     MOVE EPR-R78                    TO EPR-ST.
 21713
 21714***  WE WANT R78 IN AH STAT FOR AHL
 21715
 21716     IF DTE-CLIENT = 'AHL'
 21717        GO TO 4899-EXIT
 21718     END-IF
 21719
 21720     MOVE +0                         TO SUB1.
 21721
 21722 4865-EP-AH-STAT-LOOP.
 21723     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 419
* ECS010.cbl
 21724
 21725     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21726         MOVE EPR-PRO                TO EPR-ST
 21727     ELSE
 21728         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21729             GO TO 4865-EP-AH-STAT-LOOP.
 21730
 21731     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21732         CR-DT GREATER THAN 19831031)  OR
 21733
 21734        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21735         CR-DT GREATER THAN 19820629)  OR
 21736
 21737        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21738         CR-DT GREATER THAN 19830831)  OR
 21739
 21740        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21741         CR-DT GREATER THAN 20091231)
 21742
 21743         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21744
 21745     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21746       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21747         IF CR-DT LESS THAN 19970101
 21748             MOVE EPR-R78            TO EPR-ST
 21749         ELSE
 21750             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21751
 21752     IF DTE-CLIENT = 'DCC'
 21753        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21754           MOVE EPR-PRO          TO EPR-ST
 21755        ELSE
 21756           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21757        END-IF
 21758     END-IF
 21759
 21760     IF (DTE-CLIENT = 'DCC')
 21761        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21762        CONTINUE
 21763     ELSE
 21764        GO TO 4899-EXIT
 21765     END-IF
 21766
 21767*    MOVE ' '                    TO DD-IU-SW
 21768
 21769     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21770                                    WS-DDF-CSO-ADMIN-FEE
 21771                                    WS-DDF-1ST-YR-TOT-EXP
 21772                                    WS-COMM-AND-MFEE
 21773
 21774     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21775        D1 > +10
 21776        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21777           AND (CR-LCOM-AH (D1) NUMERIC)
 21778           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21779              + (CR-LCOM-AH (D1) * +1000)
 21780        END-IF
 21781        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 420
* ECS010.cbl
 21782           AND (CR-LCOM-AH (D1) NUMERIC)
 21783           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21784              + (CR-LCOM-AH (D1) * +1000)
 21785        END-IF
 21786        IF (CR-AGT-TYPE (D1) = 'I' )
 21787           AND (CR-LCOM-AH (D1) NUMERIC)
 21788           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21789              + (CR-LCOM-AH (D1) * +1000)
 21790        END-IF
 21791        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21792           AND (CR-LCOM-AH (D1) NUMERIC)
 21793           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21794              + (CR-LCOM-AH (D1) * +1000)
 21795        END-IF
 21796     END-PERFORM
 21797
 21798     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21799     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21800
 21801     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21802                                 THRU 4910-EXIT
 21803
 21804     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21805        + WS-DDF-1ST-YR-TOT-EXP
 21806
 21807     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21808        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21809     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21810     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21811
 21812     MOVE 'D'                    TO CP-EARNING-METHOD
 21813     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21814     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21815     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21816     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21817     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21818
 21819     IF REIN-EP-FLG = 'R'
 21820        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21821        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21822        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21823     END-IF
 21824
 21825     IF DD-IU-PRESENT
 21826        MOVE 'I'              TO CP-EARNING-METHOD
 21827     END-IF
 21828
 21829     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21830                                 CP-CLP-RATE-UP
 21831
 21832
 21833     display ' cert no ' cr-cert-no
 21834     display ' rate up ' cp-iu-rate-up
 21835     display ' addl clp ' cr-addl-clp
 21836     display ' ah clp  ' cr-ah-clp
 21837     display ' orig prem ' cp-original-premium
 21838
 21839     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 421
* ECS010.cbl
 21840        AND (CP-IU-RATE-UP NOT = ZEROS)
 21841        COMPUTE CP-IU-RATE-UP =
 21842           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21843           / CP-ORIGINAL-PREMIUM))
 21844     END-IF
 21845
 21846     display ' here 4 '
 21847     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21848     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21849
 21850     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21851        + WS-DDF-1ST-YR-TOT-EXP
 21852
 21853     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21854
 21855     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21856
 21857     IF CP-DDF-SPEC-CALC = 'C'
 21858        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21859     ELSE
 21860        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21861        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21862        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21863        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21864        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21865        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21866     END-IF
 21867
 21868     display ' here 6 '
 21869     GO TO 4899-EXIT
 21870
 21871     .
 21872 4867-EP-DO-AH-STAT-ROA.
 21873     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21874     MOVE 'L'                        TO DC-OPTION-CODE.
 21875     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21876     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21877     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21878     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21879     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21880     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21881     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21882     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21883     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21884     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21885                                        CP-RATING-BENEFIT-AMT.
 21886     IF CP-STATE-STD-ABBRV = 'OR'
 21887         COMPUTE CP-RATING-BENEFIT-AMT =
 21888                                  CR-AHAMT * REM-TRM1.
 21889     MOVE CR-APR                     TO CP-LOAN-APR.
 21890     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21891     MOVE 'A'                        TO CP-EARNING-METHOD.
 21892     MOVE '3'                        TO CP-PROCESS-TYPE.
 21893     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21894     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21895     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21896         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21897     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 422
* ECS010.cbl
 21898         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21899     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21900     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21901     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21902     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21903     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21904     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21905
 21906     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21907
 21908     IF CP-ERROR-RATE-NOT-FOUND  OR
 21909        CP-ERROR-RATE-IS-ZERO  OR
 21910        CP-ERROR-IN-DATES
 21911         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21912
 21913     COMPUTE EPR-ST ROUNDED =
 21914             (REM-TRM1 * WE-AHAMT / +100 *
 21915               CP-PREMIUM-RATE)
 21916              / CR-AHPRM-CALC * CR-AHPRM
 21917
 21918     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 21919
 21920     GO TO 4899-EXIT.
 21921
 21922 4899-EXIT.
 21923     EXIT.
 21924******************************************************************
 21925***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 21926******************************************************************
 21927
 21928 4900-WRITE-SUMMARY-EXTRACTS.
 21929
 21930     IF DTE-CLIENT = 'HER'
 21931         IF EP-RECORD-ID = 'EC'  AND
 21932            EP-REINCO = 'LNL'
 21933             GO TO 4900-WRT-SUMMARY-X.
 21934
 21935     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 21936                                     WS-EP-RUN-DTE-N.
 21937
 21938     IF W-UNDERWRITTEN-DATA
 21939         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 21940     ELSE
 21941         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 21942
 21943     IF  DTE-OPT-RESERVE-METHOD-AUTH
 21944         IF VALID-EP-ID
 21945             MOVE 'Y'             TO EP-NEW-DATA-IND.
 21946
 21947     WRITE EP-RECORD.
 21948
 21949     ADD +1                       TO EP-CNT.
 21950
 21951 4900-WRT-SUMMARY-X.
 21952     EXIT.
 21953
 21954 4910-DCC-DFF-FACT-LOOKUP.
 21955
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 423
* ECS010.cbl
 21956     IF CR-CERT-NO = WS-FACT-CERT
 21957        go to 4910-exit
 21958     end-if
 21959
 21960     MOVE ' ' TO DD-IU-SW
 21961     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 21962        ((CR-STATE = DD-STATE (D1))
 21963        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 21964        AND ('A'           = DD-BEN-TYPE   (D1))
 21965        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 21966        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 21967                        OR
 21968        D1 > max-pdef
 21969     END-PERFORM
 21970     IF D1 > max-pdef
 21971        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 21972           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 21973        GO TO 4910-EXIT
 21974     END-IF
 21975
 21976     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 21977        (P1 > +8)
 21978        OR (DD-PROD-CODE (D1 P1) = 'I')
 21979     END-PERFORM
 21980     IF P1 < +9
 21981        display ' setting iu present to true '
 21982        SET DD-IU-PRESENT        TO TRUE
 21983     END-IF
 21984
 21985     MOVE CR-AH-TERM             TO WS-DDF-TERM
 21986     IF (CR-LOAN-TERM > WS-DDF-TERM)
 21987        AND (DD-TRUNCATED (D1) = 'Y')
 21988        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 21989        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 21990     END-IF
 21991
 21992     EVALUATE TRUE
 21993        WHEN WS-DDF-TERM > +168
 21994           MOVE 15               TO P1
 21995        WHEN WS-DDF-TERM > +156
 21996           MOVE 14               TO P1
 21997        WHEN WS-DDF-TERM > +144
 21998           MOVE 13               TO P1
 21999        WHEN WS-DDF-TERM > +132
 22000           MOVE 12               TO P1
 22001        WHEN WS-DDF-TERM > +120
 22002           MOVE 11               TO P1
 22003        WHEN WS-DDF-TERM > +108
 22004           MOVE 10               TO P1
 22005        WHEN WS-DDF-TERM > +96
 22006           MOVE 9                TO P1
 22007        WHEN WS-DDF-TERM > +84
 22008           MOVE 8                TO P1
 22009        WHEN WS-DDF-TERM > +72
 22010           MOVE 7                TO P1
 22011        WHEN WS-DDF-TERM > +60
 22012           MOVE 6                TO P1
 22013        WHEN WS-DDF-TERM > +48
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 424
* ECS010.cbl
 22014           MOVE 5                TO P1
 22015        WHEN WS-DDF-TERM > +36
 22016           MOVE 4                TO P1
 22017        WHEN WS-DDF-TERM > +24
 22018           MOVE 3                TO P1
 22019        WHEN WS-DDF-TERM > +12
 22020           MOVE 2                TO P1
 22021        WHEN OTHER
 22022           MOVE 1                TO P1
 22023     END-EVALUATE
 22024
 22025     EVALUATE TRUE
 22026*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 22027*          AND (DD-IU-PRESENT)
 22028*          MOVE 2                TO P2
 22029*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22030*          MOVE 1                TO P2
 22031        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22032           MOVE 2                TO P2
 22033        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22034           MOVE 3                TO P2
 22035        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22036           MOVE 4                TO P2
 22037        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22038           MOVE 5                TO P2
 22039        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22040           MOVE 6                TO P2
 22041        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22042           MOVE 7                TO P2
 22043        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22044           MOVE 8                TO P2
 22045        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22046           MOVE 9                TO P2
 22047        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22048           MOVE 10               TO P2
 22049        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22050           MOVE 11               TO P2
 22051        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22052           MOVE 12               TO P2
 22053        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22054           MOVE 13               TO P2
 22055        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22056           MOVE 14               TO P2
 22057        WHEN OTHER
 22058           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22059           MOVE 15               TO P2
 22060     END-EVALUATE
 22061
 22062     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22063     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22064                                 TO WS-LO-UEF
 22065     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22066                                 TO WS-HI-UEF
 22067
 22068     .
 22069 4910-EXIT.
 22070     EXIT.
 22071
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 425
* ECS010.cbl
 22072******************************************************************
 22073***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22074******************************************************************
 22075
 22076 5000-DATE-RANGE-BREAK.
 22077
 22078     IF NO-TRANSACTION-WAS-PROCESSED
 22079         GO TO 5099-DATE-RANGE-BREAK-X.
 22080
 22081     ADD +1  TO RANGE-CNT.
 22082     MOVE +1 TO SUB6.
 22083     MOVE +2 TO SUB7.
 22084     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22085     IF LN-CNT GREATER +50
 22086         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22087                 8750-PRT-RANGE-HEADING.
 22088
 22089     MOVE SPACES                     TO PRT.
 22090     PERFORM 8800-PRINT-ROUTINE.
 22091     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22092     MOVE '  TOTALS'                 TO TPH3-DESC.
 22093     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22094     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22095     PERFORM 5900-CLEAR-TOTAL-PAGES
 22096         THRU 5999-CLEAR-TOTAL-PAGES-X
 22097             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22098
 22099 5099-DATE-RANGE-BREAK-X.
 22100     EXIT.
 22101
 22102 5100-ACCOUNT-BREAK.
 22103
 22104     IF RANGE-CNT NOT = +0
 22105         PERFORM 5000-DATE-RANGE-BREAK
 22106             THRU 5099-DATE-RANGE-BREAK-X
 22107     ELSE
 22108         MOVE +1 TO SUB6
 22109         MOVE +2 TO SUB7
 22110         PERFORM 5800-ADD-PAGES-LEVELS
 22111             THRU 5899-ADD-PAGES-LEVELS-X
 22112         PERFORM 5900-CLEAR-TOTAL-PAGES
 22113             THRU 5999-CLEAR-TOTAL-PAGES-X
 22114                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22115
 22116     MOVE +0 TO RANGE-CNT.
 22117     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22118         VARYING B-SUB FROM 1 BY 1
 22119             UNTIL B-SUB GREATER THAN 50  OR
 22120                   RB-COMPANY (B-SUB) = SPACES.
 22121     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22122         VARYING B-SUB FROM 1 BY 1
 22123             UNTIL B-SUB GREATER THAN 50.
 22124
 22125     IF ACCT-FLG = SPACE
 22126         GO TO 5199-ACCOUNT-BREAK-X.
 22127
 22128     MOVE SPACE TO ACCT-FLG.
 22129     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 426
* ECS010.cbl
 22130     MOVE +3 TO SUB7.
 22131     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22132     IF LN-CNT GREATER +50
 22133         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22134                 8725-PRT-ACCT-HEADING.
 22135
 22136     MOVE SPACES                     TO PRT.
 22137     PERFORM 8800-PRINT-ROUTINE.
 22138     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22139     MOVE ' TOTALS'                  TO TPH3-DESC.
 22140     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22141     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22142     PERFORM 5900-CLEAR-TOTAL-PAGES
 22143         THRU 5999-CLEAR-TOTAL-PAGES-X
 22144             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22145
 22146 5199-ACCOUNT-BREAK-X.
 22147     EXIT.
 22148
 22149 5200-STATE-BREAK.
 22150
 22151     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22152     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22153     MOVE +3 TO SUB6.
 22154     MOVE +4 TO SUB7.
 22155     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22156
 22157     IF STATE-FLG = SPACE
 22158         GO TO 5299-STATE-BREAK-X.
 22159
 22160     MOVE SPACE         TO STATE-FLG.
 22161     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22162     MOVE 'STATE'       TO TPH1-TYPE.
 22163     MOVE HLD-STATE     TO STATE-L.
 22164
 22165     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22166
 22167     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22168         MOVE SPACES          TO TPH1-DESC
 22169         MOVE HLD-STATE       TO TPH1-ST-CODE
 22170         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22171     ELSE
 22172         MOVE SPACES TO TPH1-DESC
 22173         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22174         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22175
 22176     MOVE 'STATE'  TO TPH2-DESC.
 22177     MOVE 'TOTALS' TO TPH3-DESC.
 22178     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22179     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22180     PERFORM 5900-CLEAR-TOTAL-PAGES
 22181         THRU 5999-CLEAR-TOTAL-PAGES-X
 22182             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22183
 22184 5299-STATE-BREAK-X.
 22185     EXIT.
 22186
 22187 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 427
* ECS010.cbl
 22188
 22189     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22190     MOVE +4 TO SUB6.
 22191     MOVE +5 TO SUB7.
 22192     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22193
 22194     IF COMP-FLG = SPACE
 22195         GO TO 5399-COMP-BREAK-X.
 22196
 22197     MOVE ' ' TO COMP-FLG.
 22198     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22199     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22200     MOVE HLD-GROUPING                TO TPH1-DESC.
 22201     MOVE 'COMPANY'                   TO TPH2-DESC.
 22202     MOVE ' TOTALS'                   TO TPH3-DESC.
 22203     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22204     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22205     PERFORM 5900-CLEAR-TOTAL-PAGES
 22206         THRU 5999-CLEAR-TOTAL-PAGES-X
 22207             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22208
 22209 5399-COMP-BREAK-X.
 22210     EXIT.
 22211
 22212 5400-CARR-BREAK.
 22213
 22214     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22215     MOVE +5 TO SUB6.
 22216     MOVE +6 TO SUB7.
 22217     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22218
 22219     IF CARR-FLG = SPACE
 22220         GO TO 5499-CARR-BREAK-X.
 22221
 22222     MOVE ' ' TO CARR-FLG.
 22223     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22224     MOVE 'CARRIER'               TO TPH1-TYPE.
 22225     MOVE HLD-CARRIER             TO TPH1-DESC.
 22226     MOVE 'CARRIER'               TO TPH2-DESC.
 22227     MOVE ' TOTALS'               TO TPH3-DESC.
 22228     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22229     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22230     PERFORM 5900-CLEAR-TOTAL-PAGES
 22231         THRU 5999-CLEAR-TOTAL-PAGES-X
 22232             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22233
 22234 5499-CARR-BREAK-X.
 22235     EXIT.
 22236
 22237 5500-FINAL-BREAK.
 22238
 22239     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22240
 22241     IF FINAL-FLG = SPACE
 22242         GO TO 5599-FINAL-BREAK-X.
 22243
 22244     IF DTE-FICH = '1'
 22245         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 428
* ECS010.cbl
 22246     MOVE +6 TO SUB6.
 22247     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22248     MOVE SPACES   TO TPH1-TYPE.
 22249     MOVE SPACES   TO TPH1-DESC.
 22250     MOVE 'FINAL'  TO TPH2-DESC.
 22251     MOVE 'TOTALS' TO TPH3-DESC.
 22252     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22253     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22254
 22255 5599-FINAL-BREAK-X.
 22256     EXIT.
 22257
 22258 5800-ADD-PAGES-LEVELS.
 22259
 22260     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22261     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22262     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22263     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22264     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22265     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22266     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22267     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22268
 22269 5899-ADD-PAGES-LEVELS-X.
 22270     EXIT.
 22271
 22272 5900-CLEAR-TOTAL-PAGES.
 22273
 22274     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22275             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22276             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22277             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22278
 22279 5999-CLEAR-TOTAL-PAGES-X.
 22280     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 429
* ECS010.cbl
 22282******************************************************************
 22283***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22284******************************************************************
 22285
 22286 6000-TOTAL-PAGE-HEADINGS.
 22287
 22288     MOVE TOTAL-PAGE-HD1 TO PRT.
 22289     PERFORM 8800-PRINT-ROUTINE.
 22290
 22291 6100-ACCT-TOTAL-HEADINGS.
 22292
 22293     MOVE TOTAL-PAGE-HD2 TO PRT.
 22294     MOVE '0' TO P-CTL.
 22295     PERFORM 8800-PRINT-ROUTINE.
 22296     MOVE TOTAL-PAGE-HD3 TO PRT.
 22297     MOVE ' ' TO P-CTL.
 22298     PERFORM 8800-PRINT-ROUTINE.
 22299     PERFORM 8800-PRINT-ROUTINE.
 22300     MOVE +81 TO LN-CNT.
 22301
 22302 6199-PAGE-HEADINGS-X.
 22303     EXIT.
 22304
 22305 6500-PRINT-TOTAL-PAGE.
 22306
 22307     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22308     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22309     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22310
 22311     IF SUB6 = 6 AND ME-DO-UPDATE
 22312         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22313
 22314     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22315
 22316     IF SUB6 = 6 AND ME-DO-UPDATE
 22317         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22318
 22319     COMPUTE TPD-NET-PRM =
 22320         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22321
 22322     IF SUB6 = 6 AND ME-DO-UPDATE
 22323         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22324         GIVING ME-010-NET-L.
 22325
 22326     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22327
 22328     IF SUB6 = 6 AND ME-DO-UPDATE
 22329         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22330
 22331     COMPUTE TPD-PREM-COMP =
 22332         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22333                            - TPL-ACCT-COM (SUB6).
 22334     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22335
 22336     IF SUB6 = 6 AND ME-DO-UPDATE
 22337         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22338
 22339     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 430
* ECS010.cbl
 22340         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22341         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22342         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22343     END-IF.
 22344
 22345     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22346     PERFORM 8800-PRINT-ROUTINE.
 22347     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22348     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22349     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22350     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22351
 22352     IF SUB6 = 6 AND ME-DO-UPDATE
 22353         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22354         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22355
 22356     COMPUTE TPD-NET-PRM =
 22357         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22358
 22359     IF SUB6 = 6 AND ME-DO-UPDATE
 22360         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22361         GIVING ME-010-NET-AH.
 22362
 22363     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22364
 22365     IF SUB6 = 6 AND ME-DO-UPDATE
 22366         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22367
 22368     COMPUTE TPD-PREM-COMP =
 22369         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22370                            - TPA-ACCT-COM (SUB6).
 22371     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22372
 22373     IF SUB6 = 6 AND ME-DO-UPDATE
 22374         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22375
 22376     IF SUB6 = 6
 22377         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22378         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22379         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22380     END-IF.
 22381
 22382     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22383     PERFORM 8800-PRINT-ROUTINE.
 22384
 22385     MOVE 'TOTAL' TO TPD-DESC.
 22386
 22387     COMPUTE TPD-ISS-PRM =
 22388         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22389
 22390     COMPUTE TPD-CNC-PRM =
 22391         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22392
 22393     COMPUTE TPD-NET-PRM =
 22394         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22395         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22396
 22397     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 431
* ECS010.cbl
 22398         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22399
 22400     COMPUTE TPD-PREM-COMP =
 22401         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22402         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22403         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22404
 22405     COMPUTE TPD-CLAIMS =
 22406         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22407
 22408     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22409         NEXT SENTENCE
 22410     ELSE
 22411         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22412         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22413         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22414*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22415*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22416*        MOVE ZEROS               TO SV-LO-CERT
 22417*                                    SV-HI-CERT.
 22418
 22419     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22420     MOVE '0'                     TO P-CTL.
 22421     PERFORM 8800-PRINT-ROUTINE.
 22422     PERFORM 8800-PRINT-ROUTINE.
 22423
 22424 6599-TOTAL-PAGE-PRINT-X.
 22425     EXIT.
 22426*
 22427*
 22428*
 22429**START***********************************************************
 22430*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22431*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22432******************************************************************
 22433*
 22434 6650-GET-RES-STATE-COMM.
 22435*6650-BROWSE-FORWARD.
 22436
 22437     IF DTE-CLIENT NOT = 'DMD'
 22438         GO TO 6700-COMM-EXIT.
 22439
 22440     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22441     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22442     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22443     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22444     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22445     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22446     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22447     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22448
 22449     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22450
 22451*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22452*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22453*VALUE OF PB-CERT-EFF-DT
 22454*
 22455     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 432
* ECS010.cbl
 22456
 22457     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22458
 22459     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22460         GO TO 6700-COMM-EXIT.
 22461
 22462*GET RECORD WHERE POSITIONED
 22463
 22464 6650-READ-ERRESC-NEXT.
 22465     READ ERRESC-IN NEXT RECORD.
 22466
 22467     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22468         GO TO 6700-COMM-EXIT.
 22469
 22470*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22471
 22472     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22473        NEXT SENTENCE
 22474     ELSE
 22475         GO TO 6700-COMM-EXIT.
 22476
 22477     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22478         NEXT SENTENCE
 22479     ELSE
 22480         GO TO 6650-READ-ERRESC-NEXT.
 22481
 22482*  CR-DT  = WS-YYYYMMDD-DT
 22483*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22484*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22485
 22486     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22487         GO TO 6700-COMM-EXIT.
 22488
 22489* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22490
 22491     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22492
 22493     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22494
 22495     IF WS-SUB1 IS GREATER THAN ZERO
 22496         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22497             PERFORM 6680-SET-TABLE-CODE
 22498         ELSE
 22499             PERFORM 6680-SET-COMMISSION.
 22500
 22501     GO TO 6700-COMM-EXIT.
 22502
 22503 6680-SET-TABLE-CODE.
 22504     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22505        MOVE ZEROS             TO WS-SUB1
 22506     ELSE
 22507* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22508* TO COMPUTE AH COMMISSION.
 22509        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22510        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22511        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22512        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22513                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 433
* ECS010.cbl
 22514        PERFORM 6680-READ-CTBL-TABLE
 22515        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22516           MOVE ZEROS          TO WS-SUB1.
 22517
 22518 6680-READ-CTBL-TABLE.
 22519*
 22520* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22521* TO COMPUTE LIFE COMMISSION
 22522
 22523     IF CR-AHTYP = ZERO
 22524        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22525        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22526        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22527
 22528     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22529
 22530     IF ERCTBL-FILE-STATUS EQUAL '00'
 22531* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22532        IF CR-AHTYP NOT = ZERO
 22533             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22534             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22535             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22536             MOVE WK-RATE           TO WS-COMMISSION
 22537                                       PB-I-AH-COMMISSION
 22538        ELSE
 22539* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22540             MOVE CR-LFAMT    TO COMM-CK-AMT
 22541             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22542             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22543             MOVE WK-RATE     TO WS-COMMISSION
 22544                                 PB-I-LIFE-COMMISSION.
 22545
 22546 6680-SET-COMMISSION.
 22547     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22548           MOVE ZEROS         TO WS-SUB1
 22549       ELSE
 22550           MOVE RESC-COMMISSION-PER (WS-SUB)
 22551                              TO WS-COMMISSION WK-RATE
 22552           IF CR-AHTYP NOT = ZERO
 22553                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22554           ELSE
 22555                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22556
 22557 6680-SEARCH-CATEGORY.
 22558     ADD +1 TO WS-SUB.
 22559
 22560     IF WS-SUB IS GREATER THAN +12
 22561         GO TO 6680-EXIT.
 22562
 22563     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22564          MOVE WS-SUB         TO WS-SUB1
 22565          GO TO 6680-EXIT.
 22566
 22567     GO TO 6680-SEARCH-CATEGORY.
 22568
 22569 6680-EXIT.
 22570     EXIT.
 22571
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 434
* ECS010.cbl
 22572 6700-COMM-EXIT.
 22573     EXIT.
 22574*
 22575*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22576
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 435
* ECS010.cbl
 22578******************************************************************
 22579***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22580******************************************************************
 22581
 22582 7000-CLIENT-BILLING-ROUTINE.
 22583*
 22584*
 22585* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22586
 22587     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22588                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22589                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22590                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22591                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22592                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22593                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22594
 22595 7099-BILL-X.
 22596     EXIT.
 22597
 22598
 22599 7500-ADD-UP-REIN-CO.
 22600
 22601     IF RB-COMPANY (B-SUB) NOT = SPACES
 22602         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22603
 22604 7599-ADD-UP-REIN-X.
 22605     EXIT.
 22606
 22607 7900-CLEAR-BILLING-TABLE.
 22608
 22609     MOVE SPACES TO RB-COMPANY (B-SUB).
 22610     MOVE 0      TO RB-COUNT (B-SUB).
 22611
 22612 7999-CLEAR-BILLING-X.
 22613     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 436
* ECS010.cbl
 22615******************************************************************
 22616***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22617******************************************************************
 22618
 22619 8000-DATE-CONVERT-ROUTINE.
 22620
 22621     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22622
 22623 8099-DATE-CONVERT-X.
 22624     EXIT.
 22625
 22626 8000R-CONVERT-STOP-DATE.
 22627
 22628     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22629     MOVE 'L'                     TO DC-OPTION-CODE.
 22630     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22631     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22632     MOVE -1                      TO DC-ELAPSED-DAYS.
 22633     MOVE '6'                     TO DC-OPTION-CODE.
 22634     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22635     MOVE +0                      TO DC-ELAPSED-MONTHS
 22636                                     DC-ELAPSED-DAYS.
 22637     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22638     MOVE ' '                     TO DC-OPTION-CODE.
 22639     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22640
 22641     IF NO-CONVERSION-ERROR
 22642         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22643     ELSE
 22644         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22645                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22646                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22647         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22648                                  TO WS-ABEND-MESSAGE
 22649         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22650         MOVE 4002                TO WS-ABEND-CODE
 22651         GO TO ABEND-PGM.
 22652
 22653 8099R-STOP-DATE-X.
 22654     EXIT.
 22655
 22656
 22657 8100-GET-RATE.
 22658
 22659     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22660
 22661 8199-GET-RATE-X.
 22662     EXIT.
 22663
 22664
 22665 8200-STATE-CODE-LOOKUP.
 22666
 22667     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22668        CLAS-INDEXS NOT = ZERO
 22669         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22670             GO TO 8299-STATE-LOOKUP-X.
 22671
 22672     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 437
* ECS010.cbl
 22673
 22674 8250-STATE-LOOKUP-LOOP.
 22675
 22676     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22677         MOVE 0302 TO WS-ABEND-CODE
 22678         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22679         DISPLAY '******************************'
 22680         DISPLAY '***** ERROR LOCATION 022 *****'
 22681         DISPLAY '******************************'
 22682         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22683         GO TO ABEND-PGM.
 22684
 22685     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22686         ADD +1 TO CLAS-INDEXS
 22687         GO TO 8250-STATE-LOOKUP-LOOP.
 22688
 22689 8299-STATE-LOOKUP-X.
 22690     EXIT.
 22691
 22692
 22693 8300-LIFE-TYPE-LOOKUP.
 22694
 22695     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22696        CLAS-INDEXL NOT = ZERO
 22697         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22698             GO TO 8399-LIFE-LOOKUP-X.
 22699
 22700     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22701
 22702 8350-LIFE-LOOKUP-LOOP.
 22703
 22704     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22705         MOVE 0401 TO WS-ABEND-CODE
 22706         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22707         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22708         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22709         DISPLAY '******************************'
 22710         DISPLAY '***** ERROR LOCATION 023 *****'
 22711         DISPLAY '******************************'
 22712         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22713         IF DTE-CLIENT = 'NCL'
 22714                      OR 'CID' OR 'AHL'
 22715             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22716             MOVE '05'             TO CLAS-LOOK
 22717             GO TO 8350-LIFE-LOOKUP-LOOP
 22718         ELSE
 22719             GO TO ABEND-PGM.
 22720
 22721     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22722         ADD +1 TO CLAS-INDEXL
 22723         GO TO 8350-LIFE-LOOKUP-LOOP.
 22724
 22725     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22726         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22727
 22728 8399-LIFE-LOOKUP-X.
 22729     EXIT.
 22730
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 438
* ECS010.cbl
 22731
 22732 8400-A-H-TYPE-LOOKUP.
 22733
 22734     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22735        CLAS-INDEXA NOT = ZERO
 22736         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22737             GO TO 8499-A-H-LOOKUP-X.
 22738
 22739     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22740
 22741 8450-A-H-LOOKUP-LOOP.
 22742
 22743     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22744         MOVE 0402 TO WS-ABEND-CODE
 22745         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22746         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22747         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22748         DISPLAY '******************************'
 22749         DISPLAY '***** ERROR LOCATION 024 *****'
 22750         DISPLAY '******************************'
 22751         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22752         IF DTE-CLIENT = 'NCL'
 22753             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22754             MOVE '05'             TO CLAS-LOOK
 22755             GO TO 8450-A-H-LOOKUP-LOOP
 22756         ELSE
 22757             GO TO ABEND-PGM.
 22758
 22759     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22760         ADD +1 TO CLAS-INDEXA
 22761         GO TO 8450-A-H-LOOKUP-LOOP.
 22762
 22763 8499-A-H-LOOKUP-X.
 22764     EXIT.
 22765
 22766 8500-REMAINING-TERM-ROUTINE.
 22767
 22768     MOVE ZEROS                      TO CP-REMAINING-TERM
 22769                                        CP-REMAINING-TERM-1
 22770                                        CP-REMAINING-TERM-2
 22771                                        CP-REMAINING-TERM-3
 22772                                        CP-RETURN-CODE
 22773                                        CP-RETURN-CODE-2
 22774                                        REM-TRM1
 22775                                        REM-TRM2
 22776                                        REM-TRM3
 22777                                        TEM-TRM1.
 22778     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22779
 22780     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22781     MOVE 'L'                        TO DC-OPTION-CODE.
 22782     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22783
 22784     IF  NO-CONVERSION-ERROR
 22785         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22786     ELSE
 22787         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22788                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 439
* ECS010.cbl
 22789         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22790         MOVE 3001                   TO WS-ABEND-CODE
 22791         GO TO ABEND-PGM.
 22792
 22793     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22794
 22795     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22796         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22797
 22798     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22799         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22800         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22801                                        DC-ELAPSED-DAYS
 22802         MOVE '3'                    TO DC-OPTION-CODE
 22803         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22804                 8099-DATE-CONVERT-X
 22805         IF  NO-CONVERSION-ERROR
 22806             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22807         ELSE
 22808             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22809
 22810     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22811         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22812
 22813     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22814         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22815         MOVE +1                     TO DC-ELAPSED-MONTHS
 22816         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22817         MOVE '6'                    TO DC-OPTION-CODE
 22818         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22819                 8099-DATE-CONVERT-X
 22820         IF  NO-CONVERSION-ERROR
 22821             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22822             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22823         ELSE
 22824             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22825                                     TO WS-ABEND-MESSAGE
 22826             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22827             MOVE 3002               TO WS-ABEND-CODE
 22828             GO TO ABEND-PGM.
 22829
 22830     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22831     MOVE 'L'                        TO DC-OPTION-CODE.
 22832     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22833
 22834     IF  NO-CONVERSION-ERROR
 22835         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22836     ELSE
 22837         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22838             W-VAL-ERROR (W-VAL-SOURCE)
 22839         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22840             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22841             DC-ERROR-CODE
 22842         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22843         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22844             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22845             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22846             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 440
* ECS010.cbl
 22847*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22848*                                    TO WS-ABEND-MESSAGE
 22849*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22850*        MOVE 3003                   TO WS-ABEND-CODE
 22851*        GO TO ABEND-PGM.
 22852
 22853     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22854     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22855     MOVE '3'                        TO CP-PROCESS-TYPE.
 22856     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22857     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22858     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22859
 22860*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22861*                                    TO CP-REM-TERM-METHOD.
 22862
 22863     IF  DTE-CLIENT = 'FIM'
 22864         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22865
 22866     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22867         IF WE-LF-AH = AH-OVERRIDE-L1
 22868             MOVE '2'                TO CP-REM-TERM-METHOD
 22869         ELSE
 22870             IF CR-LFTYP = '01' OR '03'
 22871                 MOVE '4'            TO CP-REM-TERM-METHOD
 22872             ELSE
 22873                 IF CR-LFTYP = '02' OR '04'
 22874                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22875
 22876     IF  DTE-CLIENT = 'CSL'
 22877         IF  CR-CARRIER = '2'
 22878             IF  CR-LFTYP = '07' OR  '08'
 22879                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22880
 22881     IF  DTE-CLIENT = 'POS'
 22882         IF  CR-CARRIER = '1'
 22883             MOVE '1'                TO CP-REM-TERM-METHOD
 22884         ELSE
 22885             MOVE '2'                TO CP-REM-TERM-METHOD.
 22886
 22887     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22888         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22889
 22890     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22891         GO TO 8540-CALC-REM-TERM-AH.
 22892
 22893 8520-CALC-REM-TERM-LIFE.
 22894
 22895     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22896     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22897     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22898*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22899     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22900                                        CP-LOAN-TERM.
 22901
 22902     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22903             AND
 22904         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 441
* ECS010.cbl
 22905         ADD +1                      TO CP-ORIGINAL-TERM
 22906                                        CP-LOAN-TERM.
 22907
 22908     IF  CP-TERM-IS-DAYS
 22909         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22910     ELSE
 22911         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 22912
 22913     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22914
 22915     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22916         ADD +1                      TO W-ORGTRM-0-LF
 22917         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 22918             CR-FULL-CONTROL
 22919         GO TO 8599-REM-TERM-X.
 22920
 22921     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22922
 22923     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22924         ADD +1                      TO W-RET-CODE-LF
 22925         GO TO 8599-REM-TERM-X.
 22926*
 22927*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 22928*                                    TO WS-ABEND-MESSAGE
 22929*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22930*        MOVE 2002                   TO WS-ABEND-CODE
 22931*        GO TO ABEND-PGM.
 22932
 22933     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22934             AND
 22935         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 22936         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 22937         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 22938         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 22939
 22940     IF  CP-REMAINING-TERM-1 NEGATIVE
 22941         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 22942
 22943     IF  CP-REMAINING-TERM-2 NEGATIVE
 22944         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 22945
 22946     IF DTE-CLIENT = 'NCL'
 22947         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22948                                        CP-REMAINING-TERM-3.
 22949
 22950     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22951     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22952     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22953     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22954
 22955     GO TO 8599-REM-TERM-X.
 22956
 22957 8520-EXIT.
 22958     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 442
* ECS010.cbl
 22960 8540-CALC-REM-TERM-AH.
 22961
 22962     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 22963     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 22964     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 22965     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 22966                                        CP-LOAN-TERM.
 22967     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 22968
 22969     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22970
 22971     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22972         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 22973             CR-FULL-CONTROL
 22974         ADD +1                      TO W-ORGTRM-0-AH
 22975         GO TO 8599-REM-TERM-X.
 22976
 22977     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22978
 22979     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22980         ADD +1                      TO W-RET-CODE-AH
 22981         GO TO 8599-REM-TERM-X.
 22982*
 22983*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 22984*                                    TO WS-ABEND-MESSAGE
 22985*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22986*        MOVE 2001                   TO WS-ABEND-CODE
 22987*        GO TO ABEND-PGM.
 22988
 22989     IF DTE-CLIENT = 'NCL'
 22990         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22991                                        CP-REMAINING-TERM-3.
 22992
 22993     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22994     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22995     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22996     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22997
 22998 8599-REM-TERM-X.
 22999     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 443
* ECS010.cbl
 23001
 23002******************************************************************
 23003***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 23004******************************************************************
 23005
 23006 8600-DISPLAY-PRT.
 23007
 23008     IF  DIS-LINE-CNT GREATER THAN 59
 23009         PERFORM 8600-DISPLAY-HD THRU
 23010             8600-HD-EXIT.
 23011
 23012     ADD  1  TO DIS-LINE-CNT.
 23013     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 23014     MOVE  SPACES TO DISPLAY-REC
 23015                     DISPLAY-LINE.
 23016
 23017 8600-DISPLAY-EXIT.
 23018     EXIT.
 23019
 23020
 23021 8600-DISPLAY-HD.
 23022
 23023     MOVE '1'  TO  DISPLAY-CC.
 23024     MOVE ZEROS TO DIS-LINE-CNT.
 23025     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 23026     ADD +1 TO DIS-LINE-CNT.
 23027     MOVE ' '  TO  DISPLAY-CC.
 23028     MOVE SPACES TO DISPLAY-REC.
 23029     WRITE DISPLAY-REC.
 23030     ADD +1 TO DIS-LINE-CNT.
 23031     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23032     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23033     ADD +1 TO DIS-LINE-CNT.
 23034     MOVE SPACES TO DISPLAY-REC.
 23035     ADD +1 TO DIS-LINE-CNT.
 23036     WRITE DISPLAY-REC.
 23037
 23038 8600-HD-EXIT.
 23039     EXIT.
 23040
 23041******************************************************************
 23042***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23043******************************************************************
 23044
 23045 8600-SETUP-DETAIL-LINE.
 23046
 23047     MOVE SPACES                TO TR-DTL2.
 23048
 23049     MOVE CR-CERT-NO            TO TRD-CERT.
 23050     MOVE CR-YR                 TO TRD-ISYR.
 23051     MOVE CR-MO                 TO TRD-ISMO.
 23052     MOVE CR-DA                 TO TRD-ISDA.
 23053     MOVE CR-AGE                TO TRD-AGE.
 23054
 23055 8689-SETUP-DETAIL-X.
 23056     EXIT.
 23057
 23058 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 444
* ECS010.cbl
 23059
 23060     IF LN-CNT GREATER THAN LN-MX
 23061         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23062                 8799-PRT-HEADINGS-X.
 23063     MOVE TRD-CERT TO SV-TRD-CERT.
 23064     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23065
 23066     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23067         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23068
 23069     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23070     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23071     MOVE TR-DTL TO PRT.
 23072
 23073     IF NOT WS-CHANGE-REC
 23074         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23075     ELSE
 23076         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23077
 23078     PERFORM 8800-PRINT-ROUTINE.
 23079
 23080 8699-PRT-DETAIL-X.
 23081     EXIT.
 23082
 23083 8700-PRINT-REPORT-HEADINGS.
 23084     ADD +1 TO PG-CNT.
 23085     MOVE PG-CNT TO TR-PG.
 23086     MOVE +0 TO LN-CNT.
 23087     MOVE TR-HD-1 TO PRT.
 23088     PERFORM 8800-PRINT-ROUTINE.
 23089     MOVE TR-HD-2 TO PRT.
 23090     PERFORM 8800-PRINT-ROUTINE.
 23091     MOVE TR-HD-3 TO PRT.
 23092     PERFORM 8800-PRINT-ROUTINE.
 23093     ADD +1 TO LN-CNT.
 23094
 23095 8725-PRT-ACCT-HEADING.
 23096     MOVE TR-HD-4 TO PRT.
 23097     PERFORM 8800-PRINT-ROUTINE.
 23098     MOVE TR-HD-5 TO PRT.
 23099     PERFORM 8800-PRINT-ROUTINE.
 23100
 23101 8750-PRT-RANGE-HEADING.
 23102     MOVE TR-HD-6 TO PRT.
 23103     PERFORM 8800-PRINT-ROUTINE.
 23104
 23105 8775-PRT-COLUMN-HEADINGS.
 23106     MOVE TR-HD-7 TO PRT.
 23107     PERFORM 8800-PRINT-ROUTINE.
 23108     MOVE TR-HD-8 TO PRT.
 23109     PERFORM 8800-PRINT-ROUTINE.
 23110     MOVE TR-HD-9 TO PRT.
 23111     PERFORM 8800-PRINT-ROUTINE.
 23112     PERFORM 8800-PRINT-ROUTINE.
 23113
 23114 8799-PRT-HEADINGS-X.
 23115     EXIT.
 23116
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 445
* ECS010.cbl
 23117 8800-PRINT-ROUTINE.
 23118     MOVE P-CTL TO X.
 23119     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23120     ADD +1 TO LN-CNT.
 23121     MOVE SPACES TO PRT.
 23122
 23123 8900-PRINT-A-LINE.
*23124                             COPY ELCPRT2.
 23125******************************************************************04/15/98
 23126*                                                                *ELCPRT2
 23127*                                                                *ELCPRT2
 23128*                            ELCPRT2                             *   LV005
 23129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23130*                            VMOD=2.002                          *   CL**5
 23131*                                                                *   CL**4
 23132******************************************************************   CL**4
 23133                                                                     CL**4
 23134     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23135        FICH-OPEN    = SPACE                                         CL**4
 23136         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23137         OPEN OUTPUT FICH.                                           CL**4
 23138                                                                     CL**4
 23139     IF DTE-FICH NOT = SPACE                                         CL**4
 23140         MOVE X                  TO  P-CTL                           CL**4
 23141         WRITE FICH-REC FROM PRT.                                    CL**4
 23142                                                                     CL**4
 23143     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23144       MOVE X                    TO  P-CTL                           CL**4
 23145       IF P-CTL = ' '                                                CL**4
 23146         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23147       ELSE                                                          CL**4
 23148         IF P-CTL = '0'                                              CL**4
 23149           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23150         ELSE                                                        CL**4
 23151           IF P-CTL = '-'                                            CL**4
 23152             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23153           ELSE                                                      CL**4
 23154             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23155                                                                     CL**4
 23156******************************************************************   CL**4
 23157
 23158 8999-PRT-LINE-X.
 23159     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 446
* ECS010.cbl
 23161******************************************************************
 23162***          E N D   O F   J O B   P R O C E S S I N G         ***
 23163******************************************************************
 23164
 23165 9910-EOJ-1.
 23166     IF TR-CNT = ZERO
 23167         IF (DTE-PGM-OPT = '2' OR '3') OR
 23168            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23169                          'ITY' OR 'DAC' OR 'FLC')
 23170             NEXT SENTENCE
 23171         ELSE
 23172             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23173             MOVE 0703                    TO WS-ABEND-CODE
 23174             DISPLAY '******************************'
 23175             DISPLAY '***** ERROR LOCATION 025 *****'
 23176             DISPLAY '******************************'
 23177             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23178             GO TO ABEND-PGM.
 23179
 23180     MOVE '*'         TO TRANS-EOF-FLAG.
 23181     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23182
 23183     IF EOF-ON-CERT
 23184         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23185         GO TO 9940-EOJ-FIN.
 23186
 23187     GO TO 0330-MATCH-PENDING-TO-CERT.
 23188
 23189 9920-EOJ-2.
 23190     MOVE '*'         TO CERT-EOF-FLAG.
 23191     MOVE HIGH-VALUES TO CIR-CONTROL.
 23192
 23193     IF EOF-ON-TRANS
 23194         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23195         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23196         GO TO 9940-EOJ-FIN.
 23197
 23198     GO TO 0299-READ-CERT-X.
 23199
 23200 9930-EOJ-3.
 23201     IF PROCESSING-COMPLETED
 23202         GO TO 9950-EOJ-FIN-GO.
 23203
 23204     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23205     MOVE 'MISSING ACCOUNT MASTER'
 23206                               TO WS-ABEND-MESSAGE.
 23207     MOVE 0302                 TO WS-ABEND-CODE.
 23208     DISPLAY '******************************'
 23209     DISPLAY '***** ERROR LOCATION 026 *****'
 23210     DISPLAY '******************************'
 23211     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23212     GO TO ABEND-PGM.
 23213
 23214 9940-EOJ-FIN.
 23215     MOVE '*'        TO PROCESSING-FLAG.
 23216     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23217
 23218     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 447
* ECS010.cbl
 23219             0199-READ-ACCOUNT-X.
 23220     GO TO 9940-EOJ-FIN.
 23221
 23222 9950-EOJ-FIN-GO.
 23223     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23224     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23225*
 23226*
 23227* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23228     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23229
 23230 9960-NO-TOTS.
 23231
 23232     MOVE +15                    TO LN-CNT.
 23233     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23234     IF ME-DO-UPDATE
 23235         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23236
 23237     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23238     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23239     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23240
 23241
 23242     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23243     MOVE TR-TTL-HD              TO PRT.
 23244     PERFORM 8800-PRINT-ROUTINE.
 23245     ADD +1 TO LN-CNT.
 23246     MOVE TR-CNT                TO TTL-PT-CNT.
 23247     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23248     MOVE TR-TTL-HD             TO PRT.
 23249     PERFORM 8800-PRINT-ROUTINE.
 23250     ADD +1 TO LN-CNT.
 23251
 23252     IF DUP-CNT = ZERO
 23253         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23254
 23255     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23256
 23257     IF ME-DO-UPDATE
 23258         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23259
 23260     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23261     MOVE TR-TTL-HD               TO PRT.
 23262     PERFORM 8800-PRINT-ROUTINE.
 23263     PERFORM 8800-PRINT-ROUTINE.
 23264     ADD +1 TO LN-CNT.
 23265
 23266     MOVE '1'                           TO  DTL-REC-TYPE.
 23267     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23268     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23269     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23270                                        TO  DTL-CERT-OUT-CONTROL.
 23271     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23272     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23273     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23274
 23275     MOVE +1 TO SUB3.
 23276 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 448
* ECS010.cbl
 23277
 23278     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23279         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23280         MOVE MISMATCH-PAGE-NUMBER
 23281                                 TO  TR-PG
 23282         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23283         MOVE MR-CTL             TO  X
 23284         MOVE X TO LCP-ASA
 23285         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23286             THRU LCP-WRITE-END-MISMATCH-RPT
 23287         MOVE TR-HD-2            TO  MISMATCH-RPT
 23288         MOVE MR-CTL             TO  X
 23289         MOVE X TO LCP-ASA
 23290         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23291             THRU LCP-WRITE-END-MISMATCH-RPT
 23292         MOVE TR-HD-3            TO  MISMATCH-RPT
 23293         MOVE MR-CTL             TO  X
 23294         MOVE X TO LCP-ASA
 23295         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23296             THRU LCP-WRITE-END-MISMATCH-RPT
 23297         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23298         MOVE MR-CTL             TO  X
 23299         MOVE X TO LCP-ASA
 23300         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23301             THRU LCP-WRITE-END-MISMATCH-RPT
 23302         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23303
 23304     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23305
 23306     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23307     MOVE MR-CTL                        TO  X.
 23308     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23309
 23310     MOVE X TO LCP-ASA
 23311     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23312         THRU LCP-WRITE-END-MISMATCH-RPT.
 23313
 23314     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23315     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23316
 23317     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23318     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23319
 23320     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23321     IF  DUPE-STATUS (SUB3)  =  '2'
 23322         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23323     IF  DUPE-STATUS (SUB3)  =  '5'
 23324         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23325     IF  DUPE-STATUS (SUB3)  =  'M'
 23326         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23327     IF  DUPE-STATUS (SUB3)  =  '9'
 23328         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23329     IF  DUPE-STATUS (SUB3)  =  'D'
 23330         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23331     IF  DUPE-STATUS (SUB3)  =  'V'
 23332         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23333     IF  DUPE-STATUS (SUB3)  =  'P'
 23334         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 449
* ECS010.cbl
 23335
 23336     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23337     MOVE MR-CTL                        TO  X.
 23338     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23339
 23340     MOVE X TO LCP-ASA
 23341     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23342         THRU LCP-WRITE-END-MISMATCH-RPT.
 23343
 23344     IF SUB3 LESS THAN DUP-CNT
 23345         ADD +1 TO SUB3
 23346         GO TO 9965-PRT-DUPES.
 23347
 23348 9969-CHECK-MISMATCHED-TOTS.
 23349
 23350     IF W-MM-LF-PRM = ZEROS  AND
 23351        W-MM-AH-PRM = ZEROS  AND
 23352        W-MM-LF-RFD = ZEROS  AND
 23353        W-MM-AH-RFD = ZEROS  AND
 23354        W-MM-LF-CLM = ZEROS  AND
 23355        W-MM-AH-CLM = ZEROS
 23356         GO TO 9970-FIN-TOTS.
 23357
 23358     MOVE SPACES                        TO  MISMATCH-RPT.
 23359     MOVE '0'                           TO  MR-CTL  X.
 23360     MOVE X TO LCP-ASA
 23361     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23362         THRU LCP-WRITE-END-MISMATCH-RPT.
 23363
 23364     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23365     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23366     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23367
 23368     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23369     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23370     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23371
 23372     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23373     MOVE '0'                           TO  MR-CTL  X.
 23374     MOVE X TO LCP-ASA
 23375     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23376         THRU LCP-WRITE-END-MISMATCH-RPT.
 23377
 23378     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23379     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23380     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23381
 23382     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23383     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23384     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23385
 23386     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23387     MOVE '0'                           TO  MR-CTL  X.
 23388     MOVE X TO LCP-ASA
 23389     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23390         THRU LCP-WRITE-END-MISMATCH-RPT.
 23391
 23392     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 450
* ECS010.cbl
 23393     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23394     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23395
 23396     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23397     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23398     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23399
 23400     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23401     MOVE '0'                           TO  MR-CTL  X.
 23402     MOVE X TO LCP-ASA
 23403     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23404         THRU LCP-WRITE-END-MISMATCH-RPT.
 23405
 23406 9970-FIN-TOTS.
 23407
 23408     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23409
 23410     IF ME-DO-UPDATE
 23411         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23412
 23413     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23414     MOVE TR-TTL-HD               TO PRT.
 23415     PERFORM 8800-PRINT-ROUTINE.
 23416
 23417     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23418     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23419     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23420     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23421
 23422     MOVE DE-CNT                  TO TTL-PT-CNT.
 23423     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23424     MOVE TR-TTL-HD               TO PRT.
 23425     PERFORM 8800-PRINT-ROUTINE.
 23426
 23427     MOVE EP-CNT                  TO TTL-PT-CNT.
 23428     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23429     MOVE TR-TTL-HD               TO PRT.
 23430     PERFORM 8800-PRINT-ROUTINE.
 23431     PERFORM 8800-PRINT-ROUTINE.
 23432
 23433     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23434     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23435     MOVE TR-TTL-HD               TO PRT.
 23436     PERFORM 8800-PRINT-ROUTINE.
 23437
 23438     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23439     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23440     MOVE TR-TTL-HD               TO PRT.
 23441     PERFORM 8800-PRINT-ROUTINE.
 23442
 23443     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23444     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23445     MOVE TR-TTL-HD               TO PRT.
 23446     PERFORM 8800-PRINT-ROUTINE.
 23447
 23448     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23449         GO TO 9990-FINAL-CLOSE.
 23450
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 451
* ECS010.cbl
 23451**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23452**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23453**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23454**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23455
 23456     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23457     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23458     MOVE TR-TTL-HD               TO PRT.
 23459     PERFORM 8800-PRINT-ROUTINE.
 23460
 23461     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23462     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23463     MOVE TR-TTL-HD               TO PRT.
 23464     PERFORM 8800-PRINT-ROUTINE.
 23465
 23466     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23467     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23468     MOVE TR-TTL-HD               TO PRT.
 23469     PERFORM 8800-PRINT-ROUTINE.
 23470
 23471     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23472     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23473     MOVE TR-TTL-HD               TO PRT.
 23474     PERFORM 8800-PRINT-ROUTINE.
 23475
 23476     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23477     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23478     MOVE TR-TTL-HD               TO PRT.
 23479     PERFORM 8800-PRINT-ROUTINE.
 23480
 23481     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23482     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23483     MOVE TR-TTL-HD               TO PRT.
 23484     PERFORM 8800-PRINT-ROUTINE.
 23485
 23486     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23487     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23488     MOVE TR-TTL-HD               TO PRT.
 23489     PERFORM 8800-PRINT-ROUTINE.
 23490
 23491     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23492     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23493     MOVE TR-TTL-HD               TO PRT.
 23494     PERFORM 8800-PRINT-ROUTINE.
 23495
 23496     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23497     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23498     MOVE TR-TTL-HD               TO PRT.
 23499     PERFORM 8800-PRINT-ROUTINE.
 23500
 23501     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23502     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23503     MOVE TR-TTL-HD               TO PRT.
 23504     PERFORM 8800-PRINT-ROUTINE.
 23505
 23506     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23507     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23508     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 452
* ECS010.cbl
 23509     PERFORM 8800-PRINT-ROUTINE.
 23510
 23511     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23512     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23513     MOVE TR-TTL-HD               TO PRT.
 23514     PERFORM 8800-PRINT-ROUTINE.
 23515
 23516     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23517     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23518     MOVE TR-TTL-HD               TO PRT.
 23519     PERFORM 8800-PRINT-ROUTINE.
 23520
 23521     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23522     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23523     MOVE TR-TTL-HD               TO PRT.
 23524     PERFORM 8800-PRINT-ROUTINE.
 23525
 23526     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23527     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23528     MOVE TR-TTL-HD               TO PRT.
 23529     PERFORM 8800-PRINT-ROUTINE.
 23530
 23531     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23532     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23533     MOVE TR-TTL-HD               TO PRT.
 23534     PERFORM 8800-PRINT-ROUTINE.
 23535
 23536     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23537     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23538     MOVE TR-TTL-HD               TO PRT.
 23539     PERFORM 8800-PRINT-ROUTINE.
 23540
 23541     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23542     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23543     MOVE TR-TTL-HD               TO PRT.
 23544     PERFORM 8800-PRINT-ROUTINE.
 23545
 23546     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23547     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23548     MOVE TR-TTL-HD               TO PRT.
 23549     PERFORM 8800-PRINT-ROUTINE.
 23550
 23551     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23552     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23553     MOVE TR-TTL-HD               TO PRT.
 23554     PERFORM 8800-PRINT-ROUTINE.
 23555
 23556     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23557     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23558     MOVE TR-TTL-HD               TO PRT.
 23559     PERFORM 8800-PRINT-ROUTINE.
 23560
 23561     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23562     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23563     MOVE TR-TTL-HD               TO PRT.
 23564     PERFORM 8800-PRINT-ROUTINE.
 23565
 23566     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 453
* ECS010.cbl
 23567     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23568     MOVE TR-TTL-HD               TO PRT.
 23569     PERFORM 8800-PRINT-ROUTINE.
 23570
 23571     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23572     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23573     MOVE TR-TTL-HD               TO PRT.
 23574     PERFORM 8800-PRINT-ROUTINE.
 23575
 23576     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23577     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23578     MOVE TR-TTL-HD               TO PRT.
 23579     PERFORM 8800-PRINT-ROUTINE.
 23580
 23581     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23582     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23583     MOVE TR-TTL-HD               TO PRT.
 23584     PERFORM 8800-PRINT-ROUTINE.
 23585
 23586     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23587     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23588     MOVE TR-TTL-HD               TO PRT.
 23589     PERFORM 8800-PRINT-ROUTINE.
 23590
 23591     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23592     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23593     MOVE TR-TTL-HD               TO PRT.
 23594     PERFORM 8800-PRINT-ROUTINE.
 23595
 23596     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23597     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23598     MOVE TR-TTL-HD               TO PRT.
 23599     PERFORM 8800-PRINT-ROUTINE.
 23600
 23601     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23602     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23603     MOVE TR-TTL-HD               TO PRT.
 23604     PERFORM 8800-PRINT-ROUTINE.
 23605
 23606     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23607     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23608     MOVE TR-TTL-HD               TO PRT.
 23609     PERFORM 8800-PRINT-ROUTINE.
 23610
 23611     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23612     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23613     MOVE TR-TTL-HD               TO PRT.
 23614     PERFORM 8800-PRINT-ROUTINE.
 23615
 23616     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23617     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23618     MOVE TR-TTL-HD               TO PRT.
 23619     PERFORM 8800-PRINT-ROUTINE.
 23620
 23621     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23622     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23623     MOVE TR-TTL-HD               TO PRT.
 23624     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 454
* ECS010.cbl
 23625
 23626     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23627     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23628     MOVE TR-TTL-HD               TO PRT.
 23629     PERFORM 8800-PRINT-ROUTINE.
 23630
 23631     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23632     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23633     MOVE TR-TTL-HD               TO PRT.
 23634     PERFORM 8800-PRINT-ROUTINE.
 23635
 23636     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23637     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23638     MOVE TR-TTL-HD               TO PRT.
 23639     PERFORM 8800-PRINT-ROUTINE.
 23640
 23641     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23642     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23643     MOVE TR-TTL-HD               TO PRT.
 23644     PERFORM 8800-PRINT-ROUTINE.
 23645
 23646     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23647     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23648     MOVE TR-TTL-HD               TO PRT.
 23649     PERFORM 8800-PRINT-ROUTINE.
 23650
 23651     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23652     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23653                                  TO TTL-HD-DS.
 23654     MOVE TR-TTL-HD               TO PRT.
 23655     PERFORM 8800-PRINT-ROUTINE.
 23656
 23657     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23658     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23659                                  TO TTL-HD-DS.
 23660     MOVE TR-TTL-HD               TO PRT.
 23661     PERFORM 8800-PRINT-ROUTINE.
 23662
 23663     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23664     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23665                                  TO TTL-HD-DS.
 23666     MOVE TR-TTL-HD               TO PRT.
 23667     PERFORM 8800-PRINT-ROUTINE.
 23668
 23669     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23670     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23671                                  TO TTL-HD-DS.
 23672     MOVE TR-TTL-HD               TO PRT.
 23673     PERFORM 8800-PRINT-ROUTINE.
 23674
 23675     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23676     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23677                                  TO TTL-HD-DS.
 23678     MOVE TR-TTL-HD               TO PRT.
 23679     PERFORM 8800-PRINT-ROUTINE.
 23680
 23681     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23682     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 455
* ECS010.cbl
 23683                                  TO TTL-HD-DS.
 23684     MOVE TR-TTL-HD               TO PRT.
 23685     PERFORM 8800-PRINT-ROUTINE.
 23686
 23687     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23688     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23689     MOVE TR-TTL-HD               TO PRT.
 23690     PERFORM 8800-PRINT-ROUTINE.
 23691
 23692     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23693     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23694     MOVE TR-TTL-HD               TO PRT.
 23695     PERFORM 8800-PRINT-ROUTINE.
 23696
 23697     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23698     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23699     MOVE TR-TTL-HD               TO PRT.
 23700     PERFORM 8800-PRINT-ROUTINE.
 23701
 23702     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23703     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23704     MOVE TR-TTL-HD               TO PRT.
 23705     PERFORM 8800-PRINT-ROUTINE.
 23706
 23707     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23708     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23709     MOVE TR-TTL-HD               TO PRT.
 23710     PERFORM 8800-PRINT-ROUTINE.
 23711
 23712     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23713     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23714     MOVE TR-TTL-HD               TO PRT.
 23715     PERFORM 8800-PRINT-ROUTINE.
 23716
 23717     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23718     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23719     MOVE TR-TTL-HD               TO PRT.
 23720     PERFORM 8800-PRINT-ROUTINE.
 23721
 23722     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23723     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23724     MOVE TR-TTL-HD               TO PRT.
 23725     PERFORM 8800-PRINT-ROUTINE.
 23726
 23727     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23728     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23729     MOVE TR-TTL-HD               TO PRT.
 23730     PERFORM 8800-PRINT-ROUTINE.
 23731
 23732     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23733     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23734     MOVE TR-TTL-HD               TO PRT.
 23735     PERFORM 8800-PRINT-ROUTINE.
 23736
 23737     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23738     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23739     MOVE TR-TTL-HD               TO PRT.
 23740     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 456
* ECS010.cbl
 23741
 23742     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23743     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23744     MOVE TR-TTL-HD               TO PRT.
 23745     PERFORM 8800-PRINT-ROUTINE.
 23746
 23747     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23748     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23749     MOVE TR-TTL-HD               TO PRT.
 23750     PERFORM 8800-PRINT-ROUTINE.
 23751
 23752     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23753     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23754     MOVE TR-TTL-HD               TO PRT.
 23755     PERFORM 8800-PRINT-ROUTINE.
 23756
 23757     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23758     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23759     MOVE TR-TTL-HD               TO PRT.
 23760     PERFORM 8800-PRINT-ROUTINE.
 23761
 23762     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23763     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23764     MOVE TR-TTL-HD               TO PRT.
 23765     PERFORM 8800-PRINT-ROUTINE.
 23766
 23767     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23768     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23769     MOVE TR-TTL-HD               TO PRT.
 23770     PERFORM 8800-PRINT-ROUTINE.
 23771
 23772     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23773     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23774     MOVE TR-TTL-HD               TO PRT.
 23775     PERFORM 8800-PRINT-ROUTINE.
 23776
 23777     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23778     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23779     MOVE TR-TTL-HD               TO PRT.
 23780     PERFORM 8800-PRINT-ROUTINE.
 23781
 23782     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23783     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23784     MOVE TR-TTL-HD               TO PRT.
 23785     PERFORM 8800-PRINT-ROUTINE.
 23786
 23787     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23788     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23789     MOVE TR-TTL-HD               TO PRT.
 23790     PERFORM 8800-PRINT-ROUTINE.
 23791
 23792     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23793     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23794     MOVE TR-TTL-HD               TO PRT.
 23795     PERFORM 8800-PRINT-ROUTINE.
 23796
 23797     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23798     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 457
* ECS010.cbl
 23799     MOVE TR-TTL-HD               TO PRT.
 23800     PERFORM 8800-PRINT-ROUTINE.
 23801
 23802     MOVE W-1-EP                  TO TTL-PT-CNT.
 23803     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23804     MOVE TR-TTL-HD               TO PRT.
 23805     PERFORM 8800-PRINT-ROUTINE.
 23806
 23807     MOVE W-P-EP                  TO TTL-PT-CNT.
 23808     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23809     MOVE TR-TTL-HD               TO PRT.
 23810     PERFORM 8800-PRINT-ROUTINE.
 23811
 23812     MOVE W-M-EP                  TO TTL-PT-CNT.
 23813     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23814     MOVE TR-TTL-HD               TO PRT.
 23815     PERFORM 8800-PRINT-ROUTINE.
 23816
 23817     MOVE W-R-EP                  TO TTL-PT-CNT.
 23818     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23819     MOVE TR-TTL-HD               TO PRT.
 23820     PERFORM 8800-PRINT-ROUTINE.
 23821
 23822     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23823     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23824     MOVE TR-TTL-HD               TO PRT.
 23825     PERFORM 8800-PRINT-ROUTINE.
 23826
 23827     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23828     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23829     MOVE TR-TTL-HD               TO PRT.
 23830     PERFORM 8800-PRINT-ROUTINE.
 23831
 23832     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23833     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23834     MOVE TR-TTL-HD               TO PRT.
 23835     PERFORM 8800-PRINT-ROUTINE.
 23836
 23837     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23838     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23839     MOVE TR-TTL-HD               TO PRT.
 23840     PERFORM 8800-PRINT-ROUTINE.
 23841
 23842     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23843     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23844     MOVE TR-TTL-HD               TO PRT.
 23845     PERFORM 8800-PRINT-ROUTINE.
 23846
 23847     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23848     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23849     MOVE TR-TTL-HD               TO PRT.
 23850     PERFORM 8800-PRINT-ROUTINE.
 23851
 23852     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23853     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23854     MOVE TR-TTL-HD               TO PRT.
 23855     PERFORM 8800-PRINT-ROUTINE.
 23856
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 458
* ECS010.cbl
 23857     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23858     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23859     MOVE TR-TTL-HD               TO PRT.
 23860     PERFORM 8800-PRINT-ROUTINE.
 23861
 23862     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23863     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23864     MOVE TR-TTL-HD               TO PRT.
 23865     PERFORM 8800-PRINT-ROUTINE.
 23866
 23867     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23868     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23869     MOVE TR-TTL-HD               TO PRT.
 23870     PERFORM 8800-PRINT-ROUTINE.
 23871
 23872     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23873     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23874     MOVE TR-TTL-HD               TO PRT.
 23875     PERFORM 8800-PRINT-ROUTINE.
 23876
 23877 9990-FINAL-CLOSE.
*23878                             COPY ELCPRTC.
 23879******************************************************************04/15/98
 23880*                                                                *ELCPRTC
 23881*                                                                *ELCPRTC
 23882*                            ELCPRTC.                            *   LV003
 23883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23884*                            VMOD=2.002                          *   CL**2
 23885*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23886*                                                                *ELCPRTC
 23887* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23888******************************************************************ELCPRTC
 23889                                                                  ELCPRTC
 23890      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23891          CLOSE FICH.                                             ELCPRTC
 23892                                                                  ELCPRTC
 23893******************************************************************ELCPRTC
 23894
 23895     IF DTE-CLIENT = 'DMD'
 23896         CLOSE ERRESC-IN.
 23897
 23898     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23899
 23900     DISPLAY ' '.
 23901     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23902     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23903     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23904     DISPLAY ' '.
 23905
 23906     MOVE    ' DISPLAY ERROR COUNT = '
 23907       TO  DIS-LINE-REASON.
 23908     MOVE  ERROR-COUNT
 23909       TO  DIS-LINE-REC.
 23910         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23911
 23912     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 23913           DISPLAY-PRT
 23914           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 459
* ECS010.cbl
 23915           ME50-ECS010-BALANCE
 23916           PENDING-EXTRACT  SUMMARY-EXTR.
 23917
 23918     if (dte-client = 'DCC')
 23919        and (dte-pgm-opt = '1')
 23920        close new-detail-extr
 23921     end-if
 23922
 23923     IF DTE-PGM-OPT = '1'
 23924         CLOSE CERT-MASTER-OUT
 23925               DETAIL-EXTR
 23926     end-if
 23927
 23928     IF ERACCTT-FILE-STATUS NOT = '00'
 23929         MOVE '12'                TO ABEND-CODE-1
 23930         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 23931         DISPLAY '******************************'
 23932         DISPLAY '***** ERROR LOCATION 027 *****'
 23933         DISPLAY '******************************'
 23934         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23935           GO TO ABEND-PGM.
 23936
 23937     IF COMM-OPEN-SW = 'X'
 23938         CLOSE ERCTBL
 23939         IF ERCTBL-FILE-STATUS NOT = '00'
 23940             MOVE '42'               TO ABEND-CODE-1
 23941             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 23942             DISPLAY '******************************'
 23943             DISPLAY '***** ERROR LOCATION 028 *****'
 23944             DISPLAY '******************************'
 23945             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23946             GO TO ABEND-PGM.
 23947
 23948     IF REIN-OPEN-SW = 'X'
 23949         CLOSE ERRTBL-IN
 23950         IF ERRTBL-FILE-STATUS NOT = '00'
 23951             MOVE '22'               TO ABEND-CODE-1
 23952             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 23953             DISPLAY '******************************'
 23954             DISPLAY '***** ERROR LOCATION 029 *****'
 23955             DISPLAY '******************************'
 23956             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23957             GO TO ABEND-PGM.
 23958
 23959     MOVE 'C'                         TO CP-IO-FUNCTION.
 23960     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 23961     IF IO-ERROR
 23962         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 23963                                      TO WS-ABEND-MESSAGE
 23964         MOVE 0302                    TO WS-RETURN-CODE
 23965         DISPLAY '******************************'
 23966         DISPLAY '***** ERROR LOCATION 030 *****'
 23967         DISPLAY '******************************'
 23968         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23969         GO TO ABEND-PGM.
 23970
 23971     IF ME-DO-UPDATE
 23972           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 460
* ECS010.cbl
 23973           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 23974           ACCEPT WS-TIME-OF-DAY   FROM TIME
 23975           MOVE WS-TIME              TO ME-010-END
 23976           ADD 1 TO ME-010-RUN-CT
 23977           REWRITE MONTH-END-BALANCES
 23978           DISPLAY 'MONTH-END BALANCES POSTED'
 23979           CLOSE ERMEBL-INOUT
 23980     ELSE
 23981         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 23982
 23983     GO TO 9999-END-THE-JOB.
 23984
 23985 CERT-DATE-LOAD.
*23986     COPY ELCCRTM1.
 23987******************************************************************04/15/98
 23988*                                                                *ELCCRTM1
 23989*                                                                *ELCCRTM1
 23990*                            ELCCRTM1                            *   LV003
 23991*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23992*                            VMOD=2.001                          *ELCCRTM1
 23993*                                                                *ELCCRTM1
 23994*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 23995*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 23996*                                                                *ELCCRTM1
 23997******************************************************************ELCCRTM1
 23998     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 23999     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 24000     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 24001     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 24002     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 24003     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 24004     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 24005     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 24006     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 24007                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 24008     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 24009                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 24010     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 24011     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 24012     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 24013     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 24014     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 24015     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 24016           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 24017                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 24018     END-PERFORM.                                                 ELCCRTM1
 24019                                                                  ELCCRTM1
 24020
 24021 EXTRACT-DATE-LOAD.
*24022     COPY ELCEXTM1.
 24023******************************************************************04/15/98
 24024*                                                                *ELCEXTM1
 24025*                                                                *ELCEXTM1
 24026*                            ELCEXTM1                            *   LV010
 24027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 24028*                            VMOD=2.001                          *ELCEXTM1
 24029*                                                                *ELCEXTM1
 24030*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 461
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24031*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24032*                                                                *ELCEXTM1
 24033******************************************************************ELCEXTM1
 24034                                                                  ELCEXTM1
 24035     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24036     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24037     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24038     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24039     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24040     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24041                                                                     CL**9
 24042     EVALUATE TRUE                                                   CL**5
 24043        WHEN DE-ISSUE      OR                                        CL**8
 24044             DE-RC-ISSUE   OR                                        CL**8
 24045             DE-RR-RC-ISS  OR                                        CL**8
 24046             DE-CANCEL     OR                                        CL**8
 24047             DE-RC-CANCEL  OR                                        CL**8
 24048             DE-RR-RC-CNC                                            CL**8
 24049           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24050                                                                     CL**9
 24051        WHEN DE-CLAIM      OR                                        CL**8
 24052             DE-RR-RC-CLM                                            CL**6
 24053           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24054           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24055           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24056           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24057           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24058           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24059                                                                     CL**9
 24060        WHEN DE-RESERVE                                              CL**9
 24061           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24062           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24063           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24064                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24065           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24066                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24067           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24068     END-EVALUATE.                                                   CL**9
 24069                                                                     CL**9
 24070
 24071 EXTRACT-DATE-RELOAD.
*24072     COPY ELCEXTM2.
 24073******************************************************************04/15/98
 24074*                                                                *ELCEXTM2
 24075*                                                                *ELCEXTM2
 24076*                            ELCEXTM2                            *   LV011
 24077*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24078*                            VMOD=2.001                          *ELCEXTM2
 24079*                                                                *ELCEXTM2
 24080*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24081*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24082*                                                                *   CL**9
 24083******************************************************************ELCEXTM2
 24084                                                                  ELCEXTM2
 24085     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24086     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24087     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24088     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 462
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24089     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24090     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24091                                                                     CL*10
 24092     EVALUATE TRUE                                                   CL*10
 24093        WHEN DE-ISSUE      OR                                        CL*10
 24094             DE-RC-ISSUE   OR                                        CL*10
 24095             DE-RR-RC-ISS  OR                                        CL*10
 24096             DE-CANCEL     OR                                        CL*10
 24097             DE-RC-CANCEL  OR                                        CL*10
 24098             DE-RR-RC-CNC                                            CL*10
 24099           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24100                                                                     CL*10
 24101        WHEN DE-CLAIM      OR                                        CL*10
 24102             DE-RR-RC-CLM                                            CL**7
 24103           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24104           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24105           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24106           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24107           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24108           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24109                                                                     CL*10
 24110        WHEN DE-RESERVE                                              CL**7
 24111            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24112            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24113            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24114                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24115            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24116                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24117            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24118     END-EVALUATE.                                                   CL**5
 24119                                                                  ELCEXTM2
 24120
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 463
* ECS010.cbl
 24122 ABEND-PGM.
 24123     DISPLAY '******************************'
 24124     DISPLAY '***** ABEND PGM **************'
 24125     DISPLAY '******************************'
*24126                             COPY ELCABEND.
 24127***************************************************************** 04/14/98
 24128*                                                               * ELCABEND
 24129*                            ELCABEND.                          *    LV003
 24130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24131*                            VMOD 2.002                              CL**2
 24132*                                                               * ELCABEND
 24133*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24134*            AND THEN ABENDS.                                   * ELCABEND
 24135*                                                               * ELCABEND
 24136*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24137*                                                               * ELCABEND
 24138***************************************************************** ELCABEND
 24139*APS-010.                                                         ELCABEND
 24140     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24141     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24142                                                                  ELCABEND
 24143     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24144         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24145         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24146                                 UPON CONSOLE.                    ELCABEND
 24147                                                                  ELCABEND
 24148     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24149         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24150         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24151                                 UPON CONSOLE.                    ELCABEND
 24152                                                                  ELCABEND
 24153     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24154     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24155                                 UPON CONSOLE.                    ELCABEND
 24156                                                                  ELCABEND
 24157     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24158     CALL 'ABORTME'.
 24159                                                                  ELCABEND
 24160 APS-EXIT.                                                        ELCABEND
 24161     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 464
* ECS010.cbl
 24163 9999-END-THE-JOB.
 24164
 24165     DISPLAY ' '.
 24166     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24167         'ECS010 ******'
 24168     DISPLAY ' '.
 24169     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 465
* ECS010.cbl
 24170/
 24171 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24172     IF LCP-ASA = '+'
 24173         WRITE MISMATCH-RPT AFTER 0 LINE
 24174     ELSE
 24175     IF LCP-ASA = ' '
 24176         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24177     ELSE
 24178     IF LCP-ASA = '0'
 24179         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24180     ELSE
 24181     IF LCP-ASA = '-'
 24182         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24183     ELSE
 24184     IF LCP-ASA = '1'
 24185         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24186     ELSE
 24187     IF LCP-ASA = '2'
 24188         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24189     ELSE
 24190     IF LCP-ASA = '3'
 24191         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24192     ELSE
 24193     IF LCP-ASA = '4'
 24194         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24195     ELSE
 24196     IF LCP-ASA = '5'
 24197         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24198     ELSE
 24199     IF LCP-ASA = '6'
 24200         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24201     ELSE
 24202     IF LCP-ASA = '7'
 24203         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24204     ELSE
 24205     IF LCP-ASA = '8'
 24206         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24207     ELSE
 24208     IF LCP-ASA = '9'
 24209         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24210     ELSE
 24211     IF LCP-ASA = 'A'
 24212         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24213     ELSE
 24214     IF LCP-ASA = 'B'
 24215         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24216     ELSE
 24217     IF LCP-ASA = 'C'
 24218         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24219     ELSE
 24220     IF LCP-ASA = 'V'
 24221         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24222     ELSE
 24223     IF LCP-ASA = 'W'
 24224         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24225     ELSE
 24226     DISPLAY 'ASA CODE ERROR'.
 24227 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 466
* ECS010.cbl
 24228     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  295
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     3652340     Code:      138528
