* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   1
* EL583.cbl
* Options: int("EL583.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL583.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL583.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL583.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL583.
     5
     6
     7*AUTHOR.     SUZAN VUKOV.
     8******************************************************************
     9*REMARKS.
    10*        THIS PROGRAM CREATES A PRINTED CHECK LIST FOR CID.
    11*
    12*     INPUT:   CI.DD.LG.ELCHKQ
    13*     REPORT: - SORTED BY CONTROL NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   2
* EL583.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 110101    2001100100006  SMVA  INITIAL IMPL FOR UNIKIX
    23*                              REWRITE OF MAINFRAME CULPRIT
    24* 010704                   SMVA  HANDLE ELCHKQ STATUS 23
    25* 050307    2007032100007  PEMA  ADD FLAG TO ID PMTS WITH INTEREST
    26* 111709    2009111700001  AJRA  ADD PARM TO LIMIT CARRIER
    27* 061814  CR2013092700001  PEMA  UPLOAD DLY G/L INT BAL DATA
    28******************************************************************
    29
    30 ENVIRONMENT DIVISION.
    31
    32 INPUT-OUTPUT SECTION.
    33
    34 FILE-CONTROL.
    35     SELECT DISK-DATE        ASSIGN TO SYS019-FBA1-S-SYS019.
    36
    37     SELECT ELCHKQ           ASSIGN TO SYS027-FBA1-ELCHKQ
    38                             ORGANIZATION IS INDEXED
    39                             ACCESS IS DYNAMIC
    40                             RECORD KEY IS CQ-CONTROL-PRIMARY
    41                             FILE STATUS IS ELCHKQ-FILE-STATUS.
    42
    43     SELECT ELTRLR           ASSIGN TO ELTRLR
    44                             ORGANIZATION IS INDEXED
    45                             ACCESS IS DYNAMIC
    46                             RECORD KEY IS AT-CONTROL-PRIMARY
    47                             FILE STATUS IS ELTRLR-FILE-STATUS.
    48
    49     SELECT PRNTR            ASSIGN TO SYS008-UR-1403-S-SYS008.
    50
    51     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
    52
    53     SELECT ELREPT           ASSIGN TO SYS018-FBA1-ELREPT
    54                             ORGANIZATION IS INDEXED
    55                             ACCESS IS DYNAMIC
    56                             RECORD KEY IS RF-CONTROL-PRIMARY
    57                             FILE STATUS IS DTE-VSAM-FLAGS.
    58
    59 DATA DIVISION.
    60
    61 FILE SECTION.
    62
    63 FD  DISK-DATE
*   64                          COPY ELCDTEFD.
    65******************************************************************04/15/98
    66*                                                                *ELCDTEFD
    67*                                                                *ELCDTEFD
    68*                            ELCDTEFD.                           *   LV002
    69*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    70*                            VMOD=2.007                          *   CL**2
    71*                                                                *ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   3
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    72******************************************************************ELCDTEFD
    73     BLOCK CONTAINS 0 RECORDS
    74     RECORDING MODE F.                                            ELCDTEFD
    75                                                                  ELCDTEFD
    76 01  DATE-DISK.                                                   ELCDTEFD
    77     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    78     12  FILLER                      PIC  X(14).                  ELCDTEFD
    79     12  DD-CR1                      PIC  9.                      ELCDTEFD
    80     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    81     12  DD-CR2                      PIC  9.                      ELCDTEFD
    82     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    83     12  FILLER                      PIC  X(20).                  ELCDTEFD
    84                                                                  ELCDTEFD
    85 01  DATE-DISK-R.                                                 ELCDTEFD
    86     12  FILLER                      PIC  X(4).                   ELCDTEFD
    87     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    88                                     PIC  X(32).                  ELCDTEFD
    89                                                                  ELCDTEFD
    90 01  DATE-DISK-T.                                                 ELCDTEFD
    91     12  FILLER                      PIC  X(4).                   ELCDTEFD
    92     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    93                                     PIC  X(48).                  ELCDTEFD
    94                                                                  ELCDTEFD
    95 01  DATE-DISK-M.                                                 ELCDTEFD
    96     12  FILLER                      PIC  X(4).                   ELCDTEFD
    97     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    98                                     PIC  X(48).                  ELCDTEFD
    99                                                                  ELCDTEFD
   100 01  DATE-DISK-P.                                                 ELCDTEFD
   101     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   102     12  DD-IDX                      PIC  99.                     ELCDTEFD
   103     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   104     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   105         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   106                                     PIC  X.                      ELCDTEFD
   107         16  FILLER                  PIC  X(46).                  ELCDTEFD
   108     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   109         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   110             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   111             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   112             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   113             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   114         16  FILLER                  PIC  X(16).                  ELCDTEFD
   115                                                                  ELCDTEFD
   116 01  DATE-DISK-E.                                                 ELCDTEFD
   117     12  FILLER                      PIC  X(4).                   ELCDTEFD
   118     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   119                                     PIC  X(4).                   ELCDTEFD
   120                                                                  ELCDTEFD
   121 01  DATE-DISK-C.                                                 ELCDTEFD
   122     12  FILLER                      PIC  X(7).                   ELCDTEFD
   123     12  DD-CARR1-SECPAY-SW          PIC  X.
   124     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   125     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   126     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   127     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   128     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   129     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   4
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   131     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   132     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   133     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   134     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   135     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   136     12  DD-CARR2-SECPAY-SW          PIC  X.
   137     12  FILLER                      PIC  X(7).                   ELCDTEFD
   138                                                                  ELCDTEFD
   139 01  DATE-DISK-OPT.                                               ELCDTEFD
   140     12  FILLER                      PIC  X(04).                  ELCDTEFD
   141     12  DD-TLR-DATA.                                             ELCDTEFD
   142         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   143                                     PIC  X(03).                  ELCDTEFD
   144     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   145         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   146                                     PIC  X(06).                  ELCDTEFD
   147     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   148         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   149                                     PIC  X(07).                  ELCDTEFD
   150         16  FILLER                  PIC  X(05).                  ELCDTEFD
   151     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   152                                     PIC  X(96).                  ELCDTEFD
   153******************************************************************ELCDTEFD
   154
   155 FD  ELCHKQ.
*  156                          COPY ELCCHKQ.
   157******************************************************************04/15/98
   158*                                                                *ELCCHKQ
   159*                                                                *ELCCHKQ
   160*                            ELCCHKQ.                            *   LV002
   161*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   162*                            VMOD=2.007                          *   CL**2
   163*                                                                *ELCCHKQ
   164*   FILE DESCRIPTION = CHECK QUE FILE                            *ELCCHKQ
   165*                                                                *ELCCHKQ
   166*   FILE TYPE = VSAM,KSDS                                        *ELCCHKQ
   167*   RECORD SIZE = 100  RECFORM = FIXED                           *ELCCHKQ
   168*                                                                *ELCCHKQ
   169*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *ELCCHKQ
   170*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *ELCCHKQ
   171*                                                                *ELCCHKQ
   172*   LOG = YES                                                    *ELCCHKQ
   173*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCHKQ
   174******************************************************************ELCCHKQ
   175 01  CHECK-QUE.                                                   ELCCHKQ
   176     12  CQ-RECORD-ID                PIC XX.                      ELCCHKQ
   177         88  VALID-CQ-ID         VALUE 'CQ'.                      ELCCHKQ
   178                                                                  ELCCHKQ
   179     12  CQ-CONTROL-PRIMARY.                                      ELCCHKQ
   180         16  CQ-COMPANY-CD           PIC X.                       ELCCHKQ
   181         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.        ELCCHKQ
   182         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.        ELCCHKQ
   183                                                                  ELCCHKQ
   184     12  CQ-CONTROL-BY-PAYEE.                                     ELCCHKQ
   185         16  CQ-CONTROL-BY-NUMBER.                                ELCCHKQ
   186             20  CQ-COMPANY-CD-A1     PIC X.                      ELCCHKQ
   187             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.        ELCCHKQ
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   5
* EL583.cbl (/apps/prod/cid1p/copy/ELCCHKQ)
   188         16  CQ-PAYEE-CARRIER        PIC X.                       ELCCHKQ
   189         16  CQ-PAYEE-GROUPING       PIC X(6).                    ELCCHKQ
   190         16  CQ-PAYEE-STATE          PIC XX.                      ELCCHKQ
   191         16  CQ-PAYEE-BENE-ACCT      PIC X(10).                   ELCCHKQ
   192         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.        ELCCHKQ
   193                                                                  ELCCHKQ
   194     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.          ELCCHKQ
   195         16  CQ-DMD-COMPANY-CD-A2    PIC X.                       ELCCHKQ
   196         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.                       ELCCHKQ
   197         16  CQ-DMD-BENE-CODE-A2     PIC X(10).                   ELCCHKQ
   198         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).                    ELCCHKQ
   199         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.        ELCCHKQ
   200         16  FILLER                  PIC X(3).                    ELCCHKQ
   201                                                                  ELCCHKQ
   202     12  CQ-ENTRY-TYPE               PIC X.                       ELCCHKQ
   203             88  CHECK-ON-QUE           VALUE 'Q'.                ELCCHKQ
   204             88  ALIGNMENT-CHECK        VALUE 'A'.                ELCCHKQ
   205             88  SPOILED-CHECK          VALUE 'S'.                ELCCHKQ
   206             88  PAYMENT-ABORTED        VALUE 'X'.                ELCCHKQ
   207                                                                  ELCCHKQ
   208     12  CQ-CLAIM-MAST-CNTL.                                      ELCCHKQ
   209         16  CQ-CARRIER              PIC X.                       ELCCHKQ
   210         16  CQ-CLAIM-NO             PIC X(7).                    ELCCHKQ
   211         16  CQ-CERT-NO.                                          ELCCHKQ
   212             20  CQ-CERT-PRIME       PIC X(10).                   ELCCHKQ
   213             20  CQ-CERT-SFX         PIC X.                       ELCCHKQ
   214         16  CQ-CLAIM-TYPE           PIC X.                       ELCCHKQ
   215             88  CQ-LIFE-CLAIM          VALUE 'L'.                ELCCHKQ
   216             88  CQ-AH-CLAIM            VALUE 'A'.                ELCCHKQ
   217         16  CQ-CLAIM-SUB-TYPE       PIC X.                       ELCCHKQ
   218             88  CQ-FIXED-COVERAGE      VALUE '1'.                ELCCHKQ
   219             88  CQ-O-B-COVERAGE        VALUE '2'.                ELCCHKQ
   220             88  CQ-OPEN-END-COVERAGE   VALUE '3'.                ELCCHKQ
   221                                                                  ELCCHKQ
   222     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.        ELCCHKQ
   223     12  CQ-CHECK-NUMBER             PIC X(7).                    ELCCHKQ
   224     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.      ELCCHKQ
   225     12  CQ-PAYMENT-TYPE             PIC X.                       ELCCHKQ
   226             88  CQ-PARTIAL-PAYMENT        VALUE '1'.             ELCCHKQ
   227             88  CQ-FINAL-PAYMENT          VALUE '2'.             ELCCHKQ
   228             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.             ELCCHKQ
   229             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.             ELCCHKQ
   230             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.             ELCCHKQ
   231             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.             ELCCHKQ
   232             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.             ELCCHKQ
   233             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.             ELCCHKQ
   234     12  CQ-VOID-INDICATOR           PIC X.                       ELCCHKQ
   235             88  CHECK-IS-STOPPED          VALUE 'S'.             ELCCHKQ
   236             88  CHECK-IS-VOID             VALUE 'V'.             ELCCHKQ
   237     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.        ELCCHKQ
   238     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.        ELCCHKQ
   239     12  CQ-CHECK-BY-USER            PIC X(4).                    ELCCHKQ
   240     12  CQ-PRE-NUMBERING-SW         PIC X.                       ELCCHKQ
   241       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.           ELCCHKQ
   242       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.             ELCCHKQ
   243                                                                  ELCCHKQ
   244     12  CQ-CHECK-WRITTEN-DT         PIC XX.                      ELCCHKQ
   245     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.        ELCCHKQ
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   6
* EL583.cbl (/apps/prod/cid1p/copy/ELCCHKQ)
   246     12  CQ-LEDGER-FLAG              PIC X(01).                   ELCCHKQ
   247     12  CQ-VOID-AFTER-LEDGER        PIC X(01).                   ELCCHKQ
   248     12  CQ-LAST-UPDATED-DT          PIC XX.                      ELCCHKQ
   249     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.      ELCCHKQ
   250     12  CQ-APPLIED-TO-RCON-DT       PIC XX.                      ELCCHKQ
   251                                                                  ELCCHKQ
   252     12  FILLER                      PIC X(04).                   ELCCHKQ
   253                                                                  ELCCHKQ
   254******************************************************************ELCCHKQ
   255
   256 FD  ELTRLR.
*  257                          COPY ELCTRLR.
   258******************************************************************04/16/98
   259*                                                                *ELCTRLR
   260*                            ELCTRLR.                            *   LV002
   261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   262*                            VMOD=2.014                          *   CL**2
   263*                                                                *ELCTRLR
   264*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *ELCTRLR
   265*                                                                *ELCTRLR
   266*   FILE TYPE = VSAM,KSDS                                        *ELCTRLR
   267*   RECORD SIZE = 200    RECFORM = FIXED                         *ELCTRLR
   268*                                                                *ELCTRLR
   269*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *ELCTRLR
   270*       ALTERNATE INDEX = NONE                                   *ELCTRLR
   271*                                                                *ELCTRLR
   272*   LOG = YES                                                    *ELCTRLR
   273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCTRLR
   274******************************************************************
   275*                   C H A N G E   L O G
   276*
   277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   278*-----------------------------------------------------------------
   279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   280* EFFECTIVE    NUMBER
   281*-----------------------------------------------------------------
   282* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   283* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   284* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   285* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   286* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   287* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   288* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   289* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   290* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   291* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   292* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   293* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   294* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAILER
   295* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM IND
   296* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   297* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   298* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   299* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   300* 040814    2014030500002  AJRA  ADD ICD CODES
   301* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   302******************************************************************ELCTRLR
   303 01  ACTIVITY-TRAILERS.                                           ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   7
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   304     12  AT-RECORD-ID                    PIC XX.                  ELCTRLR
   305         88  VALID-AT-ID                       VALUE 'AT'.        ELCTRLR
   306                                                                  ELCTRLR
   307     12  AT-CONTROL-PRIMARY.                                      ELCTRLR
   308         16  AT-COMPANY-CD               PIC X.                   ELCTRLR
   309         16  AT-CARRIER                  PIC X.                   ELCTRLR
   310         16  AT-CLAIM-NO                 PIC X(7).                ELCTRLR
   311         16  AT-CERT-NO.                                          ELCTRLR
   312             20  AT-CERT-PRIME           PIC X(10).               ELCTRLR
   313             20  AT-CERT-SFX             PIC X.                   ELCTRLR
   314         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.      ELCTRLR
   315             88  AT-1ST-TRL-AVAIL             VALUE +4095.        ELCTRLR
   316             88  AT-LAST-TRL-AVAIL            VALUE +100.         ELCTRLR
   317             88  AT-RESV-EXP-HIST-TRL         VALUE +0.           ELCTRLR
   318             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.   ELCTRLR
   319             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19. ELCTRLR
   320             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29. ELCTRLR
   321             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39. ELCTRLR
   322             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49. ELCTRLR
   323             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59. ELCTRLR
   324             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69. ELCTRLR
   325             88  AT-DIAGNOSIS-TRL             VALUE +90.          ELCTRLR
   326             88  AT-BENEFICIARY-TRL           VALUE +91.
   327             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   328             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   329             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   330             88  AT-ERROR-MSGS-TRL            VALUE +95.
   331                                                                  ELCTRLR
   332     12  AT-TRAILER-TYPE                 PIC X.                   ELCTRLR
   333         88  RESERVE-EXPENSE-TR               VALUE '1'.          ELCTRLR
   334         88  PAYMENT-TR                       VALUE '2'.          ELCTRLR
   335         88  AUTO-PAY-TR                      VALUE '3'.          ELCTRLR
   336         88  CORRESPONDENCE-TR                VALUE '4'.          ELCTRLR
   337         88  ADDRESS-TR                       VALUE '5'.          ELCTRLR
   338         88  GENERAL-INFO-TR                  VALUE '6'.          ELCTRLR
   339         88  AUTO-PROMPT-TR                   VALUE '7'.          ELCTRLR
   340         88  DENIAL-TR                        VALUE '8'.          ELCTRLR
   341         88  INCURRED-CHG-TR                  VALUE '9'.          ELCTRLR
   342         88  FORM-CONTROL-TR                  VALUE 'A'.          ELCTRLR
   343                                                                  ELCTRLR
   344     12  AT-RECORDED-DT                  PIC XX.                  ELCTRLR
   345     12  AT-RECORDED-BY                  PIC X(4).                ELCTRLR
   346     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.    ELCTRLR
   347                                                                  ELCTRLR
   348     12  AT-TRAILER-BODY                 PIC X(165).              ELCTRLR
   349                                                                  ELCTRLR
   350     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.       ELCTRLR
   351         16  AT-RESERVE-CONTROLS.                                 ELCTRLR
   352             20  AT-MANUAL-SW            PIC X.                   ELCTRLR
   353                 88  AT-MANUAL-RESERVES-USED VALUE '1'.           ELCTRLR
   354             20  AT-FUTURE-SW            PIC X.                   ELCTRLR
   355                 88  AT-FUTURE-RESERVES-USED VALUE '1'.           ELCTRLR
   356             20  AT-PTC-SW               PIC X.                   ELCTRLR
   357                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.           ELCTRLR
   358             20  AT-IBNR-SW              PIC X.                   ELCTRLR
   359                 88  AT-IBNR-RESERVES-USED   VALUE '1'.           ELCTRLR
   360             20  AT-PTC-LF-SW            PIC X.                   ELCTRLR
   361                 88  AT-LF-PTC-USED          VALUE '1'.           ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   8
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   362             20  AT-CDT-ACCESS-METHOD    PIC X.                   ELCTRLR
   363                 88  AT-CDT-ROUND-NEAR       VALUE '1'.           ELCTRLR
   364                 88  AT-CDT-ROUND-HIGH       VALUE '2'.           ELCTRLR
   365                 88  AT-CDT-INTERPOLATED     VALUE '3'.           ELCTRLR
   366             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.  ELCTRLR
   367         16  AT-LAST-COMPUTED-DT         PIC XX.                  ELCTRLR
   368         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.  ELCTRLR
   369         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.  ELCTRLR
   370         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.  ELCTRLR
   371         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   372         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   373         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   374         16  AT-EXPENSE-CONTROLS.                                 ELCTRLR
   375             20  AT-EXPENSE-METHOD       PIC X.                   ELCTRLR
   376                 88  NO-EXPENSE-CALCULATED    VALUE '1'.          ELCTRLR
   377                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.          ELCTRLR
   378                 88  PERCENT-OF-PMT           VALUE '3'.          ELCTRLR
   379                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.          ELCTRLR
   380             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.  ELCTRLR
   381             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.  ELCTRLR
   382         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.  ELCTRLR
   383         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.  ELCTRLR
   384                                                                  ELCTRLR
   385         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.  ELCTRLR
   386         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.  ELCTRLR
   387                                                                  ELCTRLR
   388*        16  FILLER                      PIC X(53).               ELCTRLR
   389         16  FILLER                      PIC X(47).               ELCTRLR
   390                                                                  ELCTRLR
   391         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   392         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   393                                                                  ELCTRLR
   394         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.                ELCTRLR
   395             20  AT-OPEN-CLOSE-DATE      PIC XX.                  ELCTRLR
   396             20  AT-OPEN-CLOSE-TYPE      PIC X.                   ELCTRLR
   397*                    C = CLOSED                                   ELCTRLR
   398*                    O = OPEN                                     ELCTRLR
   399             20  AT-OPEN-CLOSE-REASON    PIC X(5).                ELCTRLR
   400*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE      ELCTRLR
   401                                                                  ELCTRLR
   402     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   403         16  AT-PAYMENT-TYPE             PIC X.                   ELCTRLR
   404             88  PARTIAL-PAYMENT                VALUE '1'.        ELCTRLR
   405             88  FINAL-PAYMENT                  VALUE '2'.        ELCTRLR
   406             88  LUMP-SUM-PAYMENT               VALUE '3'.        ELCTRLR
   407             88  ADDITIONAL-PAYMENT             VALUE '4'.        ELCTRLR
   408             88  CHARGEABLE-EXPENSE             VALUE '5'.        ELCTRLR
   409             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.        ELCTRLR
   410             88  VOIDED-PAYMENT                 VALUE '9'.        ELCTRLR
   411             88  TRANSFER                       VALUE 'T'.
   412             88  LIFE-INTEREST                  VALUE 'I'.
   413                                                                  ELCTRLR
   414         16  AT-CLAIM-TYPE               PIC X.                   ELCTRLR
   415             88  PAID-FOR-AH                    VALUE 'A'.        ELCTRLR
   416             88  PAID-FOR-LIFE                  VALUE 'L'.        ELCTRLR
   417             88  PAID-FOR-IUI                   VALUE 'I'.        ELCTRLR
   418             88  PAID-FOR-GAP                   VALUE 'G'.        ELCTRLR
   419             88  PAID-FOR-FAM                   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page   9
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   420         16  AT-CLAIM-PREM-TYPE          PIC X.                   ELCTRLR
   421             88  AT-SINGLE-PREMIUM              VALUE '1'.        ELCTRLR
   422             88  AT-O-B-COVERAGE                VALUE '2'.        ELCTRLR
   423             88  AT-OPEN-END-COVERAGE           VALUE '3'.        ELCTRLR
   424         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.    ELCTRLR
   425         16  AT-CHECK-NO                 PIC X(7).                ELCTRLR
   426         16  AT-PAID-FROM-DT             PIC XX.                  ELCTRLR
   427         16  AT-PAID-THRU-DT             PIC XX.                  ELCTRLR
   428         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.      ELCTRLR
   429         16  FILLER                      PIC X.                   ELCTRLR
   430         16  AT-PAYEES-NAME              PIC X(30).               ELCTRLR
   431         16  AT-PAYMENT-ORIGIN           PIC X.                   ELCTRLR
   432             88  ONLINE-MANUAL-PMT              VALUE '1'.        ELCTRLR
   433             88  ONLINE-AUTO-PMT                VALUE '2'.        ELCTRLR
   434             88  OFFLINE-PMT                    VALUE '3'.        ELCTRLR
   435         16  AT-CHECK-WRITTEN-DT         PIC XX.                  ELCTRLR
   436         16  AT-TO-BE-WRITTEN-DT         PIC XX.                  ELCTRLR
   437         16  AT-VOID-DATA.                                        ELCTRLR
   438             20  AT-VOID-DT              PIC XX.                  ELCTRLR
   439*00144       20  AT-VOID-REASON          PIC X(30).               ELCTRLR
   440             20  AT-VOID-REASON          PIC X(26).
   441         16  AT-PMT-APPROVED-BY          PIC X(04).
   442         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.    ELCTRLR
   443         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.    ELCTRLR
   444         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   445                                         PIC S99V9(5)  COMP-3.
   446         16  AT-CREDIT-INTERFACE.                                 ELCTRLR
   447             20  AT-PMT-SELECT-DT        PIC XX.                  ELCTRLR
   448                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.       ELCTRLR
   449             20  AT-PMT-ACCEPT-DT        PIC XX.                  ELCTRLR
   450                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.       ELCTRLR
   451             20  AT-VOID-SELECT-DT       PIC XX.                  ELCTRLR
   452                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.       ELCTRLR
   453             20  AT-VOID-ACCEPT-DT       PIC XX.                  ELCTRLR
   454                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.       ELCTRLR
   455                                                                  ELCTRLR
   456         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.      ELCTRLR
   457                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.     ELCTRLR
   458                 88  CONVERSION-PAYMENT           VALUE +99999999.ELCTRLR
   459         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.      ELCTRLR
   460                                                                  ELCTRLR
   461         16  AT-FORCE-CONTROL            PIC X.                   ELCTRLR
   462             88  PAYMENT-WAS-FORCED           VALUE '1'.          ELCTRLR
   463         16  AT-PREV-LAST-PMT-DT         PIC XX.                  ELCTRLR
   464         16  AT-PREV-PAID-THRU-DT        PIC XX.                  ELCTRLR
   465         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   466         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.    ELCTRLR
   467         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.    ELCTRLR
   468         16  AT-BENEFIT-TYPE             PIC X.                   ELCTRLR
   469                                                                  ELCTRLR
   470         16  AT-EXPENSE-TYPE             PIC X.                   ELCTRLR
   471         16  AT-PAYMENT-APPROVAL-SW      PIC X.                   ELCTRLR
   472                                                                  ELCTRLR
   473         16  AT-PAYEE-TYPE-CD.                                    ELCTRLR
   474             20  AT-PAYEE-TYPE           PIC X.                   ELCTRLR
   475                 88  INSURED-PAID           VALUE 'I'.            ELCTRLR
   476                 88  BENEFICIARY-PAID       VALUE 'B'.            ELCTRLR
   477                 88  ACCOUNT-PAID           VALUE 'A'.            ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  10
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   478                 88  OTHER-1-PAID           VALUE 'O'.            ELCTRLR
   479                 88  OTHER-2-PAID           VALUE 'Q'.            ELCTRLR
   480                 88  DOCTOR-PAID            VALUE 'P'.            ELCTRLR
   481                 88  EMPLOYER-PAID          VALUE 'E'.            ELCTRLR
   482             20  AT-PAYEE-SEQ            PIC X.                   ELCTRLR
   483                                                                  ELCTRLR
   484         16  AT-CASH-PAYMENT             PIC X.                   ELCTRLR
   485         16  AT-GROUPED-PAYMENT          PIC X.                   ELCTRLR
   486         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.    ELCTRLR
   487         16  AT-APPROVAL-LEVEL-REQD      PIC X.                   ELCTRLR
   488         16  AT-APPROVED-LEVEL           PIC X.                   ELCTRLR
   489         16  AT-VOID-TYPE                PIC X.                   ELCTRLR
   490             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.            ELCTRLR
   491             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.            ELCTRLR
   492         16  AT-AIG-UNEMP-IND            PIC X.                   ELCTRLR
   493             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.            ELCTRLR
   494         16  AT-ASSOCIATES               PIC X.                   ELCTRLR
   495             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.        ELCTRLR
   496             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.        ELCTRLR
   497                                                                  ELCTRLR
   498         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.    ELCTRLR
   499         16  AT-CV-PMT-CODE              PIC X.                   ELCTRLR
   500             88  FULL-DEATH-PAYMENT         VALUE '1'.            ELCTRLR
   501             88  HALF-DEATH-PAYMENT         VALUE '2'.            ELCTRLR
   502             88  FULL-ADD-PAYMENT           VALUE '3'.            ELCTRLR
   503             88  HALF-ADD-PAYMENT           VALUE '4'.            ELCTRLR
   504             88  FULL-RIDER-PAYMENT         VALUE '5'.            ELCTRLR
   505             88  HALF-RIDER-PAYMENT         VALUE '6'.            ELCTRLR
   506             88  NON-CHG-EXP-PAYMENT        VALUE '7'.            ELCTRLR
   507             88  ADDL-PAYMENT               VALUE '8'.            ELCTRLR
   508                                                                  ELCTRLR
   509         16  AT-EOB-CODE1                PIC XXX.                 ELCTRLR
   510         16  AT-EOB-CODE2                PIC XXX.                 ELCTRLR
   511         16  AT-EOB-CODE3                PIC XXX.
   512         16  FILLER REDEFINES AT-EOB-CODE3.
   513             20  AT-PRINT-CLM-FORM       PIC X.
   514             20  AT-PRINT-SURVEY         PIC X.
   515             20  AT-SPECIAL-RELEASE      PIC X.
   516         16  AT-EOB-CODE4                PIC XXX.                 ELCTRLR
   517         16  FILLER REDEFINES AT-EOB-CODE4.
   518             20  AT-INT-PMT-SELECT-DT    PIC XX.
   519             20  FILLER                  PIC X.
   520         16  AT-EOB-CODE5                PIC XXX.                 ELCTRLR
   521         16  FILLER REDEFINES AT-EOB-CODE5.
   522             20  AT-PMT-PROOF-DT         PIC XX.
   523             20  FILLER                  PIC X.
   524                                                                  ELCTRLR
   525         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   526             88  AT-PRINT-EOB            VALUE 'Y'.
   527                                                                  ELCTRLR
   528         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   529         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   530                                                                  ELCTRLR
   531     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.              ELCTRLR
   532         16  AT-SCHEDULE-START-DT        PIC XX.                  ELCTRLR
   533         16  AT-SCHEDULE-END-DT          PIC XX.                  ELCTRLR
   534         16  AT-TERMINATED-DT            PIC XX.                  ELCTRLR
   535         16  AT-LAST-PMT-TYPE            PIC X.                   ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  11
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   536             88  LAST-PMT-IS-FINAL              VALUE 'F'.        ELCTRLR
   537             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.        ELCTRLR
   538         16  AT-FIRST-PMT-DATA.                                   ELCTRLR
   539             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   540             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.      ELCTRLR
   541             20  AT-1ST-PAY-THRU-DT      PIC XX.                  ELCTRLR
   542         16  AT-REGULAR-PMT-DATA.                                 ELCTRLR
   543             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.    ELCTRLR
   544             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.      ELCTRLR
   545             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.      ELCTRLR
   546         16  AT-AUTO-PAYEE-CD.                                    ELCTRLR
   547             20  AT-AUTO-PAYEE-TYPE      PIC X.                   ELCTRLR
   548                 88  INSURED-PAID-AUTO      VALUE 'I'.            ELCTRLR
   549                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.            ELCTRLR
   550                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.            ELCTRLR
   551                 88  OTHER-1-PAID-AUTO      VALUE 'O'.            ELCTRLR
   552                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.            ELCTRLR
   553             20  AT-AUTO-PAYEE-SEQ       PIC X.                   ELCTRLR
   554         16  AT-AUTO-PAY-DAY             PIC 99.                  ELCTRLR
   555         16  AT-AUTO-CASH                PIC X.                   ELCTRLR
   556             88  AT-CASH                      VALUE 'Y'.          ELCTRLR
   557             88  AT-NON-CASH                  VALUE 'N'.          ELCTRLR
   558*        16  FILLER                      PIC X(129).              ELCTRLR
   559         16  AT-AUTO-END-LETTER          PIC X(4).
   560         16  FILLER                      PIC X(125).
   561                                                                  ELCTRLR
   562         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   563         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   564                                                                  ELCTRLR
   565     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.        ELCTRLR
   566         16  AT-LETTER-SENT-DT           PIC XX.                  ELCTRLR
   567         16  AT-RECEIPT-FOLLOW-UP        PIC XX.                  ELCTRLR
   568         16  AT-AUTO-RE-SEND-DT          PIC XX.                  ELCTRLR
   569         16  AT-LETTER-ANSWERED-DT       PIC XX.                  ELCTRLR
   570         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.      ELCTRLR
   571         16  AT-LETTER-ORIGIN            PIC X.                   ELCTRLR
   572             88  ONLINE-CREATION              VALUE '1' '3'.
   573             88  OFFLINE-CREATION             VALUE '2' '4'.
   574             88  NAPER-ONLINE-CREATION        VALUE '3'.
   575             88  NAPER-OFFLINE-CREATION       VALUE '4'.
   576         16  AT-STD-LETTER-FORM          PIC X(4).                ELCTRLR
   577         16  AT-REASON-TEXT              PIC X(70).               ELCTRLR
   578         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.      ELCTRLR
   579         16  AT-ADDRESEE-TYPE            PIC X.                   ELCTRLR
   580              88  INSURED-ADDRESEE            VALUE 'I'.          ELCTRLR
   581              88  BENEFICIARY-ADDRESEE        VALUE 'B'.          ELCTRLR
   582              88  ACCOUNT-ADDRESEE            VALUE 'A'.          ELCTRLR
   583              88  PHYSICIAN-ADDRESEE          VALUE 'P'.          ELCTRLR
   584              88  EMPLOYER-ADDRESEE           VALUE 'E'.          ELCTRLR
   585              88  OTHER-ADDRESEE-1            VALUE 'O'.          ELCTRLR
   586              88  OTHER-ADDRESEE-2            VALUE 'Q'.          ELCTRLR
   587         16  AT-ADDRESSEE-NAME           PIC X(30).               ELCTRLR
   588         16  AT-INITIAL-PRINT-DATE       PIC XX.                  ELCTRLR
   589         16  AT-RESEND-PRINT-DATE        PIC XX.                  ELCTRLR
   590         16  AT-CORR-SOL-UNSOL           PIC X.                   ELCTRLR
   591         16  AT-LETTER-PURGED-DT         PIC XX.                  ELCTRLR
   592*                                                                 ELCTRLR
   593*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.          ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  12
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   594*                                                                 ELCTRLR
   595         16  AT-CSO-REDEFINITION.                                 00001862
   596             20  AT-RESEND-LETTER-FORM   PIC X(4).
   597             20  AT-AUTO-CLOSE-IND       PIC X(1).
   598             20  AT-LETTER-TO-BENE       PIC X(1).
   599             20  AT-STOP-LETTER-DT       PIC X(2).
   600             20  FILLER                  PIC X(19).
   601*             20  FILLER                  PIC X(27).               0000186
   602             20  AT-CSO-LETTER-STATUS    PIC X.                   00001864
   603                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.           00001865
   604                 88  AT-CSO-LETTER-PURGED    VALUE '2'.           00001866
   605                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.           00001867
   606             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.               00001868
   607             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.               00001869
   608*                                                                 ELCTRLR
   609*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED ELCTRLR
   610*                                                                 ELCTRLR
   611*        16  FILLER                      PIC X(26).               ELCTRLR
   612*                                                                 ELCTRLR
   613*        16  AT-DMD-BSR-CODE             PIC X.                   ELCTRLR
   614*            88  AT-AUTOMATED-BSR              VALUE 'A'.         ELCTRLR
   615*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.     ELCTRLR
   616*                                                                 ELCTRLR
   617*        16  AT-DMD-LETTER-STATUS        PIC X.                   ELCTRLR
   618*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.         ELCTRLR
   619*            88  AT-DMD-LETTER-PURGED          VALUE '2'.         ELCTRLR
   620*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.         ELCTRLR
   621*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.                  ELCTRLR
   622*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.                  ELCTRLR
   623                                                                  ELCTRLR
   624         16  AT-CORR-LAST-MAINT-DT       PIC XX.                  ELCTRLR
   625         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   626                                                                  ELCTRLR
   627     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   628         16  AT-ADDRESS-TYPE             PIC X.                   ELCTRLR
   629             88  INSURED-ADDRESS               VALUE 'I'.         ELCTRLR
   630             88  BENEFICIARY-ADDRESS           VALUE 'B'.         ELCTRLR
   631             88  ACCOUNT-ADDRESS               VALUE 'A'.         ELCTRLR
   632             88  PHYSICIAN-ADDRESS             VALUE 'P'.         ELCTRLR
   633             88  EMPLOYER-ADDRESS              VALUE 'E'.         ELCTRLR
   634             88  OTHER-ADDRESS-1               VALUE 'O'.         ELCTRLR
   635             88  OTHER-ADDRESS-2               VALUE 'Q'.         ELCTRLR
   636         16  AT-MAIL-TO-NAME             PIC X(30).               ELCTRLR
   637         16  AT-ADDRESS-LINE-1           PIC X(30).               ELCTRLR
   638         16  AT-ADDRESS-LINE-2           PIC X(30).               ELCTRLR
   639         16  AT-CITY-STATE.
   640             20  AT-CITY                 PIC X(28).
   641             20  AT-STATE                PIC XX.
   642         16  AT-ZIP.                                              ELCTRLR
   643             20  AT-ZIP-CODE.                                     ELCTRLR
   644                 24  AT-ZIP-1ST          PIC X.                   ELCTRLR
   645                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.ELCTRLR
   646                 24  FILLER              PIC X(4).                ELCTRLR
   647             20  AT-ZIP-PLUS4            PIC X(4).                ELCTRLR
   648         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.          ELCTRLR
   649             20  AT-CAN-POSTAL-1         PIC XXX.                 ELCTRLR
   650             20  AT-CAN-POSTAL-2         PIC XXX.                 ELCTRLR
   651             20  FILLER                  PIC XXX.                 ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  13
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   652         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.    ELCTRLR
   653*         16  FILLER                      PIC X(23).               ELCTRLR
   654         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
   655         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
   656         16  FILLER                      PIC X(13).
   657         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   658         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   659                                                                  ELCTRLR
   660     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   661         16  AT-INFO-LINE-1              PIC X(60).               ELCTRLR
   662         16  FILLER REDEFINES AT-INFO-LINE-1.
   663             20  AT-NOTE-ERROR-NO OCCURS 15
   664                                         PIC X(4).
   665         16  AT-INFO-LINE-2              PIC X(60).               ELCTRLR
   666         16  FILLER REDEFINES AT-INFO-LINE-2.
   667             20  AT-ICD-CODE-1           PIC X(8).
   668             20  AT-ICD-CODE-2           PIC X(8).
   669             20  FILLER                  PIC X(44).
   670         16  AT-INFO-TRAILER-TYPE        PIC X.                   ELCTRLR
   671             88  AT-ERRORS-NOTE          VALUE 'E'.
   672             88  AT-PAYMENT-NOTE         VALUE 'P'.               ELCTRLR
   673             88  AT-CALL-NOTE            VALUE 'C'.               ELCTRLR
   674             88  AT-MAINT-NOTE           VALUE 'M'.               ELCTRLR
   675             88  AT-CERT-CHANGE          VALUE 'X'.               ELCTRLR
   676             88  AT-APPROVAL-NOTE        VALUE 'R'.
   677             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
   678             88  AT-CERT-CANCELLED       VALUE 'T'.
   679         16  AT-CALL-TYPE                PIC X.                   ELCTRLR
   680             88  AT-PHONE-CALL-IN        VALUE 'I'.               ELCTRLR
   681             88  AT-PHONE-CALL-OUT       VALUE 'O'.               ELCTRLR
   682         16  AT-NOTE-CONTINUATION        PIC X.                   ELCTRLR
   683             88  AT-CONTINUED-NOTE       VALUE 'X'.
   684         16  AT-EOB-CODES-EXIST          PIC X.
   685             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
   686         16  FILLER                      PIC X(35).               ELCTRLR
   687         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   688         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   689                                                                  ELCTRLR
   690     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   691         16  AT-PROMPT-LINE-1            PIC X(60).               ELCTRLR
   692         16  AT-PROMPT-LINE-2            PIC X(60).               ELCTRLR
   693         16  AT-PROMPT-START-DT          PIC XX.                  ELCTRLR
   694         16  AT-PROMPT-END-DT            PIC XX.                  ELCTRLR
   695         16  FILLER                      PIC X(35).               ELCTRLR
   696         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   697         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   698                                                                  ELCTRLR
   699     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   700         16  AT-DENIAL-INFO-1            PIC X(60).               ELCTRLR
   701         16  AT-DENIAL-INFO-2            PIC X(60).               ELCTRLR
   702         16  AT-DENIAL-DT                PIC XX.                  ELCTRLR
   703         16  AT-RETRACTION-DT            PIC XX.                  ELCTRLR
   704         16  AT-DENIAL-REASON-CODE       PIC X(4).                ELCTRLR
   705*         16  FILLER                      PIC X(31).               ELCTRLR
   706         16  AT-DENIAL-PROOF-DT          PIC XX.
   707         16  FILLER                      PIC X(29).
   708         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   709         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  14
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   710                                                                  ELCTRLR
   711     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   712         16  AT-OLD-INCURRED-DT          PIC XX.                  ELCTRLR
   713         16  AT-OLD-REPORTED-DT          PIC XX.                  ELCTRLR
   714         16  AT-OLD-ESTABLISHED-DT       PIC XX.                  ELCTRLR
   715         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3. ELCTRLR
   716         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.   ELCTRLR
   717         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3. ELCTRLR
   718         16  AT-OLD-PAID-THRU-DT         PIC XX.                  ELCTRLR
   719         16  AT-LAST-PMT-MADE-DT         PIC XX.                  ELCTRLR
   720         16  FILLER                      PIC X(26).               ELCTRLR
   721         16  AT-OLD-DIAG-CODE            PIC X(6).                ELCTRLR
   722         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.   ELCTRLR
   723         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3. ELCTRLR
   724         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3. ELCTRLR
   725         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   726         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3. ELCTRLR
   727         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   728         16  AT-OLD-DIAG-DESCRIP         PIC X(60).               ELCTRLR
   729         16  AT-OLD-ICD-CODE-1           PIC X(8).
   730         16  AT-OLD-ICD-CODE-2           PIC X(8).
   731         16  FILLER                      PIC X(9).                ELCTRLR
   732         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   733                                                                  ELCTRLR
   734     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   735         16  AT-FORM-SEND-ON-DT          PIC XX.                  ELCTRLR
   736         16  AT-FORM-FOLLOW-UP-DT        PIC XX.                  ELCTRLR
   737         16  AT-FORM-RE-SEND-DT          PIC XX.                  ELCTRLR
   738         16  AT-FORM-ANSWERED-DT         PIC XX.                  ELCTRLR
   739         16  AT-FORM-PRINTED-DT          PIC XX.                  ELCTRLR
   740         16  AT-FORM-REPRINT-DT          PIC XX.                  ELCTRLR
   741         16  AT-FORM-TYPE                PIC X.                   ELCTRLR
   742             88  INITIAL-FORM                  VALUE '1'.         ELCTRLR
   743             88  PROGRESS-FORM                 VALUE '2'.         ELCTRLR
   744         16  AT-INSTRUCT-LN-1            PIC X(28).               ELCTRLR
   745         16  AT-INSTRUCT-LN-2            PIC X(28).               ELCTRLR
   746         16  AT-INSTRUCT-LN-3            PIC X(28).               ELCTRLR
   747         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.     ELCTRLR
   748         16  AT-FORM-ADDRESS             PIC X.                   ELCTRLR
   749             88  FORM-TO-INSURED              VALUE 'I'.          ELCTRLR
   750             88  FORM-TO-ACCOUNT              VALUE 'A'.          ELCTRLR
   751             88  FORM-TO-OTHER-1              VALUE 'O'.          ELCTRLR
   752             88  FORM-TO-OTHER-2              VALUE 'Q'.          ELCTRLR
   753         16  AT-RELATED-1.                                        ELCTRLR
   754             20 AT-REL-CARR-1            PIC X.                   ELCTRLR
   755             20 AT-REL-CLAIM-1           PIC X(7).                ELCTRLR
   756             20 AT-REL-CERT-1            PIC X(11).               ELCTRLR
   757         16  AT-RELATED-2.                                        ELCTRLR
   758             20 AT-REL-CARR-2            PIC X.                   ELCTRLR
   759             20 AT-REL-CLAIM-2           PIC X(7).                ELCTRLR
   760             20 AT-REL-CERT-2            PIC X(11).               ELCTRLR
   761         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   762         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   763         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   764         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   765         16  AT-FORM-REM-PRINT-DT        PIC XX.                  ELCTRLR
   766         16  AT-STOP-FORM-DT             PIC X(2).
   767                                                                  ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  15
* EL583.cbl (/apps/test/cid1s/copy/ELCTRLR)
   768         16  FILLER                      PIC X(09).               ELCTRLR
   769         16  AT-FORM-LAST-MAINT-DT       PIC XX.                  ELCTRLR
   770         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   771******************************************************************ELCTRLR
   772
   773 FD  PRNTR
*  774                          COPY ELCPRTFD.
   775******************************************************************04/15/98
   776*                                                                *ELCPRTFD
   777*                                                                *ELCPRTFD
   778*                            ELCPRTFD.                           *   LV003
   779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   780*                            VMOD=2.006                          *ELCPRTFD
   781******************************************************************ELCPRTFD
   782     RECORDING MODE F                                             ELCPRTFD
   783     LABEL RECORDS OMITTED                                        ELCPRTFD
   784     BLOCK CONTAINS 0 RECORDS
   785     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   786 01  PRT.                                                         ELCPRTFD
   787     12  P-CTL               PIC  X.                                 CL**2
   788     12  P-DATA              PIC  X(132).                         ELCPRTFD
   789******************************************************************ELCPRTFD
   790
   791*********** OLD FICHE PROCESSING USED FOR SEQUENTIAL FILE ARCHIVE
   792*               IF DTE-PRT-OPT = 'B'
   793 FD  FICH
*  794                          COPY ELCFCHFD.
   795******************************************************************04/15/98
   796*                                                                *ELCFCHFD
   797*                            ELCFCHFD.                           *   LV003
   798*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   799*                            VMOD=2.004                          *   CL**3
   800*                                                                *ELCFCHFD
   801******************************************************************ELCFCHFD
   802     BLOCK CONTAINS 0 RECORDS
   803     RECORDING MODE F.                                            ELCFCHFD
   804                                                                  ELCFCHFD
   805 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   806******************************************************************ELCFCHFD
   807
   808
   809 FD  ELREPT
*  810                          COPY ELCRPTFD.
   811******************************************************************04/16/98
   812*                                                                *ELCRPTFD
   813*                            ELCRPTFD.                           *   LV002
   814*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   815*                            VMOD=2.001                          *ELCRPTFD
   816*                                                                *ELCRPTFD
   817* NOTE- USE ELCREPT AS COPY FOR 01 LEVEL                         *ELCRPTFD
   818*                                                                *ELCRPTFD
   819******************************************************************ELCRPTFD
   820      LABEL RECORDS ARE STANDARD.                                 ELCRPTFD
   821******************************************************************ELCRPTFD
*  822                          COPY ELCREPT.
   823******************************************************************04/15/98
   824*                                                                *ELCREPT
   825*                                                                *ELCREPT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  16
* EL583.cbl (/apps/prod/cid1p/copy/ELCREPT)
   826*                            ELCREPT.                            *   LV002
   827*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   828*                            VMOD=2.002                          *   CL**2
   829*                                                                *ELCREPT
   830*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
   831*                                                                *ELCREPT
   832*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
   833*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
   834*                                                                *ELCREPT
   835*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
   836*       ALTERNATE PATH  = NOT USED                               *ELCREPT
   837*                                                                *ELCREPT
   838*   LOG = NO                                                     *ELCREPT
   839*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
   840******************************************************************ELCREPT
   841 01  REPORT-SAVE-FILE.                                            ELCREPT
   842     12  RF-RECORD-ID                PIC XX.                      ELCREPT
   843         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
   844                                                                  ELCREPT
   845     12  RF-CONTROL-PRIMARY.                                      ELCREPT
   846         16  RF-COMPANY-CD           PIC X.                       ELCREPT
   847         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
   848             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
   849             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
   850         16  RF-REPORT-ID.                                        ELCREPT
   851             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
   852                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
   853                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
   854             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
   855         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
   856     12  RF-REPORT-LINE-133.                                      ELCREPT
   857         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
   858         16  RF-DATA-133             PIC X(132).                  ELCREPT
   859         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
   860             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
   861             20  FILLER              PIC X(52).                   ELCREPT
   862         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
   863             20  FILLER              PIC X(53).                   ELCREPT
   864             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
   865     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
   866         16  FILLER                  PIC X.                       ELCREPT
   867         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
   868         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
   869         16  FILLER                  PIC X(115).                  ELCREPT
   870         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
   871******************************************************************ELCREPT
   872
   873 WORKING-STORAGE SECTION.
   874
*  875 EXEC SQL
*  876    INCLUDE SQLCA
*  877 END-EXEC
   878 01 SQLCA.
   879     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   880     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   881     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   882     05  SQLERRM.
   883         49  SQLERRML    PIC S9(4) COMP-5.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  17
* EL583.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   884         49  SQLERRMC    PIC X(70).
   885     05  SQLERRP         PIC X(8).
   886     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   887     05  SQLWARN.
   888         10  SQLWARN0    PIC X.
   889         10  SQLWARN1    PIC X.
   890         10  SQLWARN2    PIC X.
   891         10  SQLWARN3    PIC X.
   892         10  SQLWARN4    PIC X.
   893         10  SQLWARN5    PIC X.
   894         10  SQLWARN6    PIC X.
   895         10  SQLWARN7    PIC X.
   896     05  SQLEXT.
   897         10  SQLWARN8    PIC X.
   898         10  SQLWARN9    PIC X.
   899         10  SQLWARN10   PIC X.
   900         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   901     05  SQLSTATE    PIC X(5).
   902
   903 01  LCP-ABND-CODE                 PIC S999 COMP   VALUE +519.
   904
   905 77  FILLER  PIC X(32)   VALUE '********************************'.
   906 77  FILLER  PIC X(32)   VALUE '*     EL583  WORKING STORAGE   *'.
   907 77  FILLER  PIC X(32)   VALUE '********** V/M 2.008 ***********'.
   908 77  ws-clm-payments             pic s9(9)v99 comp-3 value +0.
   909
   910 01  P pointer.
   911 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   912 01  var-ptr pointer.
   913 01  env-var-len                 pic 9(4)  binary.
   914 01  rc                          pic 9(9)  binary.
   915
   916 01  WS-KIXSYS.
   917     05  WS-KIX-FIL1             PIC X(10).
   918     05  WS-KIX-APPS             PIC X(10).
   919     05  WS-KIX-ENV              PIC X(10).
   920     05  WS-KIX-MYENV            PIC X(10).
   921     05  WS-KIX-SYS              PIC X(10).
   922
   923 EXEC SQL BEGIN DECLARE SECTION END-EXEC
   924
   925 01  svr                         pic x(32).
   926 01  usr                         pic x(32).
   927 01  pass                        pic x(32).
   928 01  usr-pass                    pic x(64).
   929 01  ws-disp-code                pic s9(11).
   930
   931 01  ws-table-values.
   932     05  tbl-comp-id             pic x(5)   value spaces.
   933     05  tbl-batch-no            pic x(50)  value spaces.
   934     05  tbl-carrier             pic x      value spaces.
   935     05  tbl-date                pic x(10)  value spaces.
   936     05  tbl-source-rpt          pic x(8)   value 'EL585'.
   937     05  tbl-remits              pic x(10)  value spaces.
   938     05  tbl-charges             pic x(10)  value spaces.
   939     05  tbl-other               pic x(10)  value spaces.
   940     05  tbl-clm-pmts            pic x(10)  value spaces.
   941     05  em-clm-pmts redefines tbl-clm-pmts
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  18
* EL583.cbl
   942                                 pic zzzzzzz.99.
   943     05  tbl-clm-stop-pays       pic x(10)  value spaces.
   944     05  em-clm-stop-pays redefines tbl-clm-stop-pays
   945                                 pic zzzzzzz.99.
   946     05  tbl-clm-offline-pmts    pic x(10)  value spaces.
   947     05  em-clm-offline-pmts redefines tbl-clm-offline-pmts
   948                                 pic zzzzzzz.99.
   949
   950 EXEC SQL END DECLARE SECTION END-EXEC
   951
   952 01  FILLER                          COMP-3.
   953     05  WS-LINE-COUNT               PIC S9(03)    VALUE +0.
   954     05  WS-LINE-COUNT-MAX           PIC S9(03)    VALUE +45.
   955     05  WS-PAGE                     PIC S9(05)    VALUE +0.
   956     05  WS-CONTROL-TOTAL-CHECK-CNT  PIC S9(06)    VALUE +0.
   957     05  WS-GRAND-TOTAL-CHECK-CNT    PIC S9(06)    VALUE +0.
   958     05  WS-CONTROL-TOTAL-CHECK-AMT  PIC S9(08)V99 VALUE +0.
   959     05  WS-GRAND-TOTAL-CHECK-AMT    PIC S9(08)V99 VALUE +0.
   960     05  WS-RETURN-CODE              PIC S9(03)    VALUE +0.
   961     05  WS-ZERO                     PIC S9        VALUE +0.
   962
   963
   964 01  FILLER                          COMP SYNC.
   965     05  PGM-SUB                     PIC S9(04)    VALUE +583.
   966
   967 01  FILLER.
   968     05  ABEND-CODE                  PIC X(04).
   969     05  ABEND-OPTION                PIC X(01).
   970     05  OLC-REPORT-NAME             PIC X(05)     VALUE 'EL583'.
   971
   972     05  WS-HOLD-CONTROL-NUMBER      PIC S9(08) COMP VALUE ZEROS.
   973
   974     05  WS-CYCLE-DT-BINARY          PIC X(02)     VALUE SPACES.
   975
   976     05  WS-CYCLE-DT.
   977         10  WS-CYCLE-DT-CC          PIC 9(02)     VALUE ZEROS.
   978         10  WS-CYCLE-DT-YY          PIC 9(02)     VALUE ZEROS.
   979         10  WS-CYCLE-DT-MM          PIC 9(02)     VALUE ZEROS.
   980         10  WS-CYCLE-DT-DD          PIC 9(02)     VALUE ZEROS.
   981
   982     05  WS-EDITED-CYCLE-DT.
   983         10  WS-EDITED-CYCLE-DT-MM   PIC X(02)     VALUE SPACES.
   984         10  FILLER                  PIC X(01)     VALUE '/'.
   985         10  WS-EDITED-CYCLE-DT-DD   PIC X(02)     VALUE SPACES.
   986         10  FILLER                  PIC X(01)     VALUE '/'.
   987         10  WS-EDITED-CYCLE-DT-YY   PIC X(02)     VALUE SPACES.
   988
   989     05  WS-EOF-SW                   PIC X(01)     VALUE SPACE.
   990         88  END-OF-ELCHKQ                         VALUE '1'.
   991
   992     05  ELCHKQ-FILE-STATUS          PIC X(02)     VALUE ZERO.
   993     05  ELTRLR-FILE-STATUS          PIC XX        VALUE ZERO.
   994
   995     05  WS-FIRST-TIME-SW            PIC X(01)     VALUE 'Y'.
   996         88  FIRST-TIME-THROUGH                    VALUE 'Y'.
   997         88  NOT-FIRST-TIME                        VALUE 'N'.
   998
   999     05  WS-REPORT-DELETE-SW         PIC X(01)     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  19
* EL583.cbl
  1000         88  BEGIN-REPORT-DELETE                   VALUE 'B'.
  1001         88  REPORT-DELETE-DONE                    VALUE 'D'.
  1002
  1003     05  WS-ABEND-MESSAGE            PIC X(80)     VALUE SPACES.
  1004
  1005     05  WS-ABEND-FILE-STATUS        PIC X(02)     VALUE ZERO.
  1006
  1007*    05  WS-FILE-ERROR-MESSAGE.
  1008*        10  FILLER                  PIC X(24)     VALUE
  1009*            'ERROR OCCURED OPENING - '.
  1010*        10  WS-FEM-FILE-NAME        PIC X(08).
  1011
  1012
  1013 01  WS-HEADING1.
  1014     05  FILLER                      PIC X(01)     VALUE '1'.
  1015     05  FILLER                      PIC X(32)     VALUE SPACES.
  1016     05  WS-H1-TITLE                 PIC X(14)     VALUE
  1017         'PRINTED CHECKS'.
  1018     05  FILLER                      PIC X(21)     VALUE SPACES.
  1019     05  WS-H1-REPORT-ID             PIC X(05)     VALUE 'EL583'.
  1020     05  FILLER                      PIC X(07)     VALUE SPACES.
  1021
  1022
  1023 01  WS-HEADING2.
  1024     05  FILLER                      PIC X(01)     VALUE SPACE.
  1025     05  FILLER                      PIC X(25)     VALUE SPACES.
  1026     05  WS-H2-COMPANY-NAME          PIC X(30)     VALUE SPACES.
  1027     05  FILLER                      PIC X(12)     VALUE SPACES.
  1028     05  WS-H2-DATE                  PIC X(08)     VALUE SPACES.
  1029     05  FILLER                      PIC X(04)     VALUE SPACES.
  1030
  1031
  1032 01  WS-HEADING3.
  1033     05  FILLER                      PIC X(01)     VALUE SPACE.
  1034     05  FILLER                      PIC X(26)     VALUE SPACES.
  1035     05  FILLER                      PIC X(12)     VALUE
  1036         'CYCLE DATE: '.
  1037     05  WS-H3-CYCLE-DT              PIC X(10)     VALUE SPACES.
  1038     05  FILLER                      PIC X(19)     VALUE SPACES.
  1039     05  FILLER                      PIC X(04)     VALUE 'PAGE'.
  1040     05  FILLER                      PIC X(02)     VALUE SPACES.
  1041     05  WS-H3-PAGE                  PIC ZZ,ZZ9.
  1042
  1043
  1044 01  WS-HEADING4.
  1045     05  FILLER                      PIC X(01)     VALUE '-'.
  1046     05  FILLER                      PIC X         VALUE ' '.
  1047     05  FILLER                      PIC X(10)     VALUE
  1048         'CONTROL   '.
  1049     05  FILLER                      PIC X(09)     VALUE
  1050         'CHECK    '.
  1051     05  FILLER                      PIC X(09)     VALUE
  1052         'CHECK    '.
  1053     05  FILLER                      PIC X(10)     VALUE
  1054         'PAYMENT   '.
  1055     05  FILLER                      PIC X(08)     VALUE
  1056         'CLAIM   '.
  1057     05  FILLER                      PIC X(08)     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  20
* EL583.cbl
  1058     05  FILLER                      PIC X(12)     VALUE
  1059         'CERT        '.
  1060     05  FILLER                      PIC X(09)     VALUE
  1061         'PAYMENT  '.
  1062     05  FILLER                      PIC X(04)     VALUE
  1063         'USER'.
  1064
  1065
  1066 01  WS-HEADING5.
  1067     05  FILLER                      PIC X(01)     VALUE SPACE.
  1068     05  FILLER                      PIC X         VALUE ' '.
  1069     05  FILLER                      PIC X(10)     VALUE
  1070         'NUMBER    ' .
  1071     05  FILLER                      PIC X(09)     VALUE
  1072         'NUMBER   '.
  1073     05  FILLER                      PIC X(10)     VALUE
  1074         'DATE      '.
  1075     05  FILLER                      PIC X(09)     VALUE
  1076         'TYPE     '.
  1077     05  FILLER                      PIC X(08)     VALUE
  1078         'NUMBER  '.
  1079     05  FILLER                      PIC X(07)     VALUE
  1080         'CAR    '.
  1081     05  FILLER                      PIC X(13)     VALUE
  1082         'NUMBER       '.
  1083     05  FILLER                      PIC X(10)     VALUE
  1084         'AMOUNT    '.
  1085     05  FILLER                      PIC X(03)     VALUE
  1086         'ID '.
  1087
  1088
  1089 01  WS-DETAIL1.
  1090     05  FILLER                      PIC X(01)     VALUE SPACE.
  1091     05  WS-D1-INT-PMT-PRESENT       PIC X         VALUE SPACES.
  1092     05  WS-D1-CONTROL-NUMBER        PIC X(08)     VALUE SPACES.
  1093     05  FILLER                      PIC X(02)     VALUE SPACES.
  1094     05  WS-D1-CHECK-NUMBER          PIC X(07)     VALUE SPACES.
  1095     05  FILLER                      PIC X(01)     VALUE SPACES.
  1096     05  WS-D1-CHECK-DT              PIC X(08)     VALUE SPACES.
  1097     05  FILLER                      PIC X(02)     VALUE SPACES.
  1098     05  WS-D1-PAYMENT-TYPE          PIC X(07)     VALUE SPACES.
  1099     05  FILLER                      PIC X(02)     VALUE SPACES.
  1100     05  WS-D1-CLAIM-NUMBER          PIC X(07)     VALUE SPACES.
  1101     05  FILLER                      PIC X(03)     VALUE SPACES.
  1102     05  WS-D1-CARRIER               PIC X(01)     VALUE SPACE.
  1103     05  FILLER                      PIC X(03)     VALUE SPACES.
  1104     05  WS-D1-CERT-NUMBER           PIC X(10)     VALUE SPACES.
  1105     05  WS-D1-CHECK-AMT             PIC Z,ZZZ,ZZ9.99.
  1106     05  FILLER                      PIC X(02)     VALUE SPACES.
  1107     05  WS-D1-USER-ID               PIC X(04)     VALUE SPACES.
  1108
  1109
  1110 01  WS-TOTAL-LINE1.
  1111     05  FILLER                      PIC X(01)     VALUE '-'.
  1112     05  FILLER                      PIC X(12)     VALUE SPACES.
  1113     05  FILLER                      PIC X(13)     VALUE
  1114         'NO. CHECKS:  '.
  1115     05  WS-T1-CHECK-CNT             PIC ZZZ,ZZ9.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  21
* EL583.cbl
  1116     05  FILLER                      PIC X(12)     VALUE SPACES.
  1117     05  FILLER                      PIC X(16)     VALUE
  1118         'CONTROL TOTAL:  '.
  1119     05  WS-T1-TOTAL-CHECK-AMT       PIC $$Z,ZZZ,ZZ9.99.
  1120     05  FILLER                      PIC X(05)     VALUE SPACES.
  1121
  1122
  1123 01  WS-GRAND-TOTAL-LINE1.
  1124     05  FILLER                      PIC X(01)     VALUE '0'.
  1125     05  FILLER                      PIC X(25)     VALUE
  1126         'GRAND TOTAL NO. CHECKS:  '.
  1127     05  WS-GT1-CHECK-CNT            PIC ZZZ,ZZ9.
  1128     05  FILLER                      PIC X(14)     VALUE SPACES.
  1129     05  FILLER                      PIC X(14)     VALUE
  1130         'GRAND TOTAL:  '.
  1131     05  WS-GT1-TOTAL-CHECK-AMT      PIC $$Z,ZZZ,ZZ9.99.
  1132     05  FILLER                      PIC X(05)     VALUE SPACES.
  1133
  1134
  1135*              *************
  1136*              ELCDTECX: LAYOUT FOR DISK-DATE FILE
* 1137               COPY ELCDTECX.
  1138******************************************************************06/05/98
  1139*                                                                *ELCDTECX
  1140*                            ELCDTECX.                           *   LV005
  1141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1142*                            VMOD=2.015                          *ELCDTECX
  1143*                                                                *ELCDTECX
  1144*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1145*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1146*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1147*                                                                *ELCDTECX
  1148******************************************************************ELCDTECX
  1149******************************************************************
  1150*                   C H A N G E   L O G
  1151*
  1152* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1153*-----------------------------------------------------------------
  1154*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1155* EFFECTIVE    NUMBER
  1156*-----------------------------------------------------------------
  1157* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1158*                                  BENEFIT CODES FROM 300 TO 900
  1159* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1160* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1161* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1162******************************************************************
  1163 01  DATE-CARD.                                                   ELCDTECX
  1164     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1165     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1166     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1167     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1168     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1169     12  EP-SW                       PIC  X.                      ELCDTECX
  1170         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1171     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1172         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1173     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  22
* EL583.cbl (/apps/test/cid1s/copy/ELCDTECX)
  1174     12  RUN-CENTURY.                                             ELCDTECX
  1175         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1176     12  FILLER                      PIC  X.                         CL**4
  1177     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1178     12  FILLER                      PIC  XXX.                    ELCDTECX
  1179     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1180                                                                  ELCDTECX
  1181 01  FILLER                          PIC  X(7)                       CL**6
  1182                                          VALUE 'OPTIONS'.        ELCDTECX
  1183 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1184     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1185     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1186     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1187         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1188         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1189     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1190     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1191     12  FILLER                      PIC  X.                      ELCDTECX
  1192     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1193     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1194     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1195     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1196     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1197     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1198     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1199     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1200     12  FILLER                      PIC  X.                      ELCDTECX
  1201     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1202     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1203     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1204     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1205     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1206     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1207     12  FILLER                      PIC  X.                      ELCDTECX
  1208     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1209     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1210     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1211     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1212     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1213     12  DTE-R78                     PIC  X.                      ELCDTECX
  1214     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1215     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1216     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1217     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1218     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1219     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1220     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1221                                     PIC  X.                      ELCDTECX
  1222         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1223                                                 ' '.             ELCDTECX
  1224         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1225         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1226     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1227         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1228         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1229     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1230     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1231                                     PIC  9.                         CL**4
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  23
* EL583.cbl (/apps/test/cid1s/copy/ELCDTECX)
  1232     12  DTE-SYSTEM.                                              ELCDTECX
  1233         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1234         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1235         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1236         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1237         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1238         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1239         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1240         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1241         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1242         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1243         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1244         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1245         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1246         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1247         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1248         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1249         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1250         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1251         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1252         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1253         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1254         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1255         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1256         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1257         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1258         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1259     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1260         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1261                                     PIC  X.                      ELCDTECX
  1262     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1263                                                                  ELCDTECX
  1264 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1265     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1266     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1267     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1268*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1269     12  FILLER                      PIC  X.                      ELCDTECX
  1270     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1271     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1272     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1273     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1274     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1275     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1276     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1277                                                                  ELCDTECX
  1278     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1279     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1280     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1281     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1282                                                                  ELCDTECX
  1283     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1284     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1285     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1286     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1287                                                                  ELCDTECX
  1288     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1289     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  24
* EL583.cbl (/apps/test/cid1s/copy/ELCDTECX)
  1290                                                                  ELCDTECX
  1291     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1292     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1293                                                                  ELCDTECX
  1294     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1295                                                                  ELCDTECX
  1296 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1297     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1298     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1299     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1300     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1301     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1302     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1303     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1304                                                                  ELCDTECX
  1305 01  FILLER                          PIC  X(12)                   ELCDTECX
  1306                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1307 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1308     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1309         16  CNT-ID                  PIC  X.                      ELCDTECX
  1310         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1311                                                                  ELCDTECX
  1312 01  FILLER                          PIC  X(11)                   ELCDTECX
  1313                                          VALUE 'STATE NAMES'.    ELCDTECX
  1314 01  STATE-NAMES.                                                 ELCDTECX
  1315     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1316         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1317         16  STATE-PIC1.                                          ELCDTECX
  1318             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1319             20  FILLER              PIC  XXX.                    ELCDTECX
  1320             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1321             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1322             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1323             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1324                                                                  ELCDTECX
  1325 01  FILLER                          PIC  X(13)                   ELCDTECX
  1326                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1327 01  CARRIER-NAMES.                                               ELCDTECX
  1328     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1329         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1330         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1331         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1332         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1333         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1334         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1335*        16  FILLER                  PIC  X.                      ELCDTECX
  1336         16  CARRIER-SEC-PAY         PIC  X.
  1337             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1338                                                                  ELCDTECX
  1339 01  FILLER                          PIC  X(9)                       CL**6
  1340                                          VALUE 'INS TYPES'.      ELCDTECX
  1341 01  CLAS-INS-TYPES.                                              ELCDTECX
  1342*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1343     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1344         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1345         16  CLAS-I-AB3.                                          ELCDTECX
  1346             20  FILLER              PIC  X.                      ELCDTECX
  1347             20  CLAS-I-AB2.                                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  25
* EL583.cbl (/apps/test/cid1s/copy/ELCDTECX)
  1348                 24  FILLER          PIC  X.                      ELCDTECX
  1349                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1350         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1351             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1352             20  FILLER              PIC  X.                         CL**4
  1353         16  CLAS-I-AB10.                                         ELCDTECX
  1354             20  FILLER              PIC  X(9).                   ELCDTECX
  1355             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1356         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1357         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1358         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1359         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1360             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1361         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1362         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1363         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1364         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1365         16  CLAS-I-REFUND-METHOD    PIC  X.
  1366         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1367         16  FILLER                  PIC  XXX.
  1368                                                                  ELCDTECX
  1369 01  FILLER                          PIC  X(16)                   ELCDTECX
  1370                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1371 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1372     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1373                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1374         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1375         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1376         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1377         16  CLAS-MORT-DESC.                                      ELCDTECX
  1378             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1379             20  FILLER              PIC  XX.                        CL**5
  1380             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1381             20  FILLER              PIC  X.                         CL**5
  1382             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1383             20  FILLER              PIC  X.                         CL**5
  1384             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1385             20  FILLER              PIC  X.                         CL**5
  1386             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1387             20  FILLER              PIC  X(5).                      CL**6
  1388                                                                  ELCDTECX
  1389 01  FILLER                          PIC  X(15)                   ELCDTECX
  1390                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1391 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1392     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1393         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1394         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1395         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1396         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1397         16  FILLER                  PIC  X(4).                      CL**6
  1398                                                                  ELCDTECX
  1399 01  FILLER                          PIC  X(7)                       CL**6
  1400                                     VALUE 'INDEXES'.             ELCDTECX
  1401 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1402     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1403     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1404     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1405     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  26
* EL583.cbl (/apps/test/cid1s/copy/ELCDTECX)
  1406     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1407     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1408     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1409     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1410     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1411     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1412     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1413     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1414     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1415     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1416     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1417     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1418     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1419                                                                  ELCDTECX
  1420 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1421     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1422     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1423     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1424     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1425     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1426     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1427     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1428     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1429     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1430     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1431     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1432                                                                  ELCDTECX
  1433 01  FILLER                          PIC  X(13)                   ELCDTECX
  1434                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1435 01  CLAS-MISC.                                                   ELCDTECX
  1436     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1437         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1438         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1439         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1440     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1441     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1442     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1443     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1444     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1445     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1446     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1447     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1448     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1449     12  STATE-L                     PIC  XX.                     ELCDTECX
  1450     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1451     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1452     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1453         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1454         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1455     12  DTE-ABEND-WORK.                                          ELCDTECX
  1456         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1457         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1458                                                                  ELCDTECX
  1459 01  FILLER                          PIC  X(12)                   ELCDTECX
  1460                                     VALUE 'WORKING DATE'.        ELCDTECX
  1461 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1462     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1463         16  WS-AD-YY                PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  27
* EL583.cbl (/apps/test/cid1s/copy/ELCDTECX)
  1464         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1465         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1466     12  WS-CURRENT-DATE.                                         ELCDTECX
  1467         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1468         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1469         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1470         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1471         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1472     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1473         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1474         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1475                                                                  ELCDTECX
  1476 01  FILLER                          PIC  X(12)                   ELCDTECX
  1477                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1478 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1479     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1480         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1481         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1482         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1483                                                                  ELCDTECX
  1484 01  FILLER                          PIC  X(10)                   ELCDTECX
  1485                                     VALUE 'STATE TLRS'.          ELCDTECX
  1486 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1487     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1488         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1489         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1490                                                                  ELCDTECX
  1491 01  FILLER                          PIC  X(13)                   ELCDTECX
  1492                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1493 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1494     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1495         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1496                                                                  ELCDTECX
  1497 01  FILLER                          PIC  X(13)                   ELCDTECX
  1498                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1499 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1500     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1501     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1502     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1503                                     PIC  X.                         CL**5
  1504     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1505     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1506     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1507     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1508     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1509     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1510     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1511     12  FILLER                      PIC  X(75).                  ELCDTECX
  1512******************************************************************ELCDTECX
  1513*01  MISC-CARR-PCT-DATA.                                          00001521
  1514*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1515*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1516*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1517*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1518*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1519*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1520******************************************************************ELCDTECX
  1521
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  28
* EL583.cbl
  1522
* 1523               COPY ELCDTEVR.
  1524***************************************************************** 04/15/98
  1525*                                                                *ELCDTEVR
  1526*                                                                *ELCDTEVR
  1527*                            ELCDTEVR.                           *   LV003
  1528*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1529*                            VMOD=2.001                          *   CL**2
  1530*                                                                *ELCDTEVR
  1531*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1532*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1533*                                                                *ELCDTEVR
  1534******************************************************************ELCDTEVR
  1535 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1536     05  WS-RUN-DATE.                                             ELCDTEVR
  1537         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1538         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1539         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1540             15  RUN-CC              PIC  99.                     ELCDTEVR
  1541             15  RUN-YR              PIC  99.                     ELCDTEVR
  1542         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1543         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1544     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1545            WS-RUN-DATE              PIC 9(11).                      CL**2
  1546     05  WS-EP-DT.                                                ELCDTEVR
  1547         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1548         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1549         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1550             15  EP-CC               PIC  99.                     ELCDTEVR
  1551             15  EP-YR               PIC  99.                     ELCDTEVR
  1552         10  EP-MO                   PIC  99.                     ELCDTEVR
  1553         10  EP-DA                   PIC  99.                     ELCDTEVR
  1554     05  WS-EP-DT-N REDEFINES                                        CL**2
  1555            WS-EP-DT                 PIC 9(11).                      CL**2
  1556     05  WS-DTE-CONV-DT.                                             CL**4
  1557         10  FILLER                  PIC  9(03).                     CL**4
  1558         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1559         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1560             15  DTE-CONV-CC         PIC  99.                        CL**4
  1561             15  DTE-CONV-YR         PIC  99.                        CL**4
  1562         10  DTE-CONV-MO             PIC  99.                        CL**4
  1563         10  DTE-CONV-DA             PIC  99.                        CL**4
  1564     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1565            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1566 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1567     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1568         10  FILLER                            PIC 999.           ELCDTEVR
  1569         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1570         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1571             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1572             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1573         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1574         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1575     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1576            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1577     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1578         10  FILLER                            PIC 999.           ELCDTEVR
  1579         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  29
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1580         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1581         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1582         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1583     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1584            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1585 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1586     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1587         10  FILLER                            PIC 999.           ELCDTEVR
  1588         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1589         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1590             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1591             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1592         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1593         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1594     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1595            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1596     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1597         10  FILLER                            PIC 999.           ELCDTEVR
  1598         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1599         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1600             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1601             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1602         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1603         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1604     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1605            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1606     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1607         10  FILLER                            PIC 999.           ELCDTEVR
  1608         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1609         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1610             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1611             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1612         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1613         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1614     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1615            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1616 01  WS-RATE-RECORD.                                              ELCDTEVR
  1617         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1618             10  FILLER                        PIC 999.           ELCDTEVR
  1619             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1620             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1621                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1622                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1623             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1624             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1625         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1626                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1627
  1628*              *************
  1629*              ELCDATE: LAYOUT OF DATA PASSED TO DATE CONV RTN
* 1630               COPY ELCDATE.
  1631******************************************************************06/11/98
  1632*                                                                *ELCDATE
  1633*                                                                *ELCDATE
  1634*                            ELCDATE.                            *   LV023
  1635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1636*                            VMOD=2.003                           ELCDATE
  1637*                                                                *ELCDATE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  30
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1638*                                                                *ELCDATE
  1639*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1640*                 LENGTH = 200                                   *   CL*19
  1641******************************************************************ELCDATE
  1642                                                                  ELCDATE
  1643 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1644     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1645     12  DC-OPTION-CODE                PIC X.                        CL*15
  1646         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1647         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1648         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1649         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1650         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1651         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1652         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1653         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1654         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1655         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1656         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1657         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1658         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1659         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1660         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1661         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1662         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1663         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1664         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1665         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1666         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1667         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1668         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1669         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1670         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1671         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1672         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1673         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1674         88  THREE-CHARACTER-BIN                                  ELCDATE
  1675                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1676         88  GREGORIAN-TO-BIN                                        CL**2
  1677                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1678         88  BIN-TO-GREGORIAN                                        CL**2
  1679                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1680         88  JULIAN-TO-BINARY                                        CL**2
  1681                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1682     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1683         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1684         88  DATE-CONVERSION-ERROR                                ELCDATE
  1685                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1686         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1687         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1688         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1689         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1690         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1691         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1692         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1693         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1694         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1695         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  31
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1696     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1697         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1698     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1699         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1700         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1701         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1702     12  FILLER                        PIC X.                        CL*15
  1703     12  DC-CONVERSION-DATES.                                        CL*15
  1704         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1705         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1706         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1707         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1708                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1709             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1710             20  SLASH1-1              PIC X.                        CL*15
  1711             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1712             20  SLASH1-2              PIC X.                        CL*15
  1713             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1714         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1715         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1716                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1717             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1718             20  SLASH2-1              PIC X.                        CL*15
  1719             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1720             20  SLASH2-2              PIC X.                        CL*15
  1721             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1722         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1723         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1724                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1725             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1726             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1727             20  DC-YMD-DAY            PIC 99.                       CL*15
  1728         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1729         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1730                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1731             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1732             20  DC-MDY-DAY            PIC 99.                       CL*15
  1733             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1734         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1735             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1736             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1737             20  FILLER                PIC XX.                       CL*15
  1738             20  DC-ALPHA-CENTURY.                                   CL*15
  1739                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1740             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1741         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1742         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1743         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1744         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1745         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1746                                       PIC 9(05).                    CL*20
  1747         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1748             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1749             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1750         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1751         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1752         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1753     12  DATE-CONVERSION-VARIBLES.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  32
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1754         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1755         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1756             20  FILLER                PIC 9(3).                     CL*15
  1757             20  HOLD-CEN-1-CCYY.                                    CL*15
  1758                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1759                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1760             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1761             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1762         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1763             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1764             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1765             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1766                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1767                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1768             20  FILLER                PIC 9(3).                     CL*15
  1769         16  HOLD-CENTURY-1-X.                                       CL*15
  1770             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1771             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1772                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1773                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1774             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1775             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1776         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1777             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1778             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1779             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1780                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1781                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1782             20  FILLER                PIC XXX.                      CL*23
  1783         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1784         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1785         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1786         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1787             20  DC-JULIAN-1-CCYY.                                   CL*15
  1788                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1789                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1790             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1791         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1792         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1793             20  DC-JULIAN-2-CCYY.                                   CL*15
  1794                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1795                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1796             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1797         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1798             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1799             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1800             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1801             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1802             20  DC-EDITA-CCYY.                                      CL*15
  1803                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1804                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1805         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1806             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1807             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1808             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1809             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1810             20  DC-EDITB-CCYY.                                      CL*15
  1811                 24  DC-EDITB-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  33
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1812                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1813         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1814         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1815                              DC-GREG-DATE-CYMD.                  ELCDATE
  1816             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1817             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1818             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1819             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1820         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1821         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1822                              DC-GREG-DATE-MDCY.                  ELCDATE
  1823             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1824             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1825             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1826             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1827    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1828        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1829    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1830    12  FILLER                         PIC X(28).                    CL*26
  1831
  1832
  1833 LINKAGE SECTION.
  1834
  1835 01  var  pic x(30).
  1836
  1837 01  PARM.
  1838     05  PARM-LENGTH        COMP     PIC S9(04)    VALUE ZEROS.
  1839     05  PARM-CYCLE-DATE             PIC X(08)     VALUE SPACES.
  1840     05  FILLER                      PIC X(01)     VALUE SPACES.
  1841     05  PARM-COMPANY-CD             PIC X(03)     VALUE SPACES.
  1842
  1843******************************************************************
  1844********************************
  1845 PROCEDURE DIVISION USING PARM.
  1846
  1847****************READ DISK-DATE FILE
  1848 0000-DATE-CARD-READ.
*                           COPY ELCDTERX.
  1849******************************************************************04/15/98
  1850*                                                                *ELCDTERX
  1851*                                                                *ELCDTERX
  1852*                            ELCDTERX.                           *   LV002
  1853*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1854*                            VMOD=2.007                          *ELCDTERX
  1855*                                                                *ELCDTERX
  1856*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1857*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1858*      = ELCDTEFD)                                               *ELCDTERX
  1859*                                                                *ELCDTERX
  1860******************************************************************ELCDTERX
  1861                                                                  ELCDTERX
  1862     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1863                                                                  ELCDTERX
  1864     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1865     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1866     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1867                                                                  ELCDTERX
  1868     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  34
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1869                                                                  ELCDTERX
  1870******************************************************************ELCDTERX
  1871*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1872*          WARNING MESSAGES.                                      ELCDTERX
  1873******************************************************************ELCDTERX
  1874     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1875         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1876                                                                  ELCDTERX
  1877     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1878                                                                  ELCDTERX
  1879     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1880                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1881                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1882                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1883                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1884                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1885                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1886                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1887                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1888                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1889                                                                  ELCDTERX
  1890     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1891                                                                  ELCDTERX
  1892     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1893                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1894                                                                  ELCDTERX
  1895     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1896     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1897     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1898     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1899                                                                  ELCDTERX
  1900     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1901         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1902     ELSE                                                         ELCDTERX
  1903         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1904                                                                  ELCDTERX
  1905     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1906         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1907     ELSE                                                         ELCDTERX
  1908         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1909                                                                  ELCDTERX
  1910 0005-READ--CARD.                                                 ELCDTERX
  1911     READ DISK-DATE                                               ELCDTERX
  1912         AT END CLOSE DISK-DATE                                   ELCDTERX
  1913             GO TO 0060-READ--TEST.                               ELCDTERX
  1914                                                                  ELCDTERX
  1915     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1916                                                                  ELCDTERX
  1917     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1918         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1919         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1920         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1921         GO TO 0005-READ--CARD.                                   ELCDTERX
  1922                                                                  ELCDTERX
  1923     IF DD-ID = 'CLAD'                                            ELCDTERX
  1924         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1925         GO TO 0005-READ--CARD.                                   ELCDTERX
  1926                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  35
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1927     IF DD-ID = 'CLAX'                                            ELCDTERX
  1928         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1929         GO TO 0005-READ--CARD.                                   ELCDTERX
  1930                                                                  ELCDTERX
  1931     IF DD-ID = 'CLAF'                                            ELCDTERX
  1932         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1933         GO TO 0005-READ--CARD.                                   ELCDTERX
  1934                                                                  ELCDTERX
  1935     IF DD-ID = 'CLAC'                                            ELCDTERX
  1936         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1937                                                                  ELCDTERX
  1938     IF DD-ID = 'CARR'                                            ELCDTERX
  1939         GO TO 0015-READ--CARR.                                   ELCDTERX
  1940                                                                  ELCDTERX
  1941     IF DD-ID = 'STAT'                                            ELCDTERX
  1942         GO TO 0020-READ--STAT.                                   ELCDTERX
  1943                                                                  ELCDTERX
  1944     IF DD-ID = 'BUSC'                                            ELCDTERX
  1945         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1946                                                                  ELCDTERX
  1947     IF DD-ID = 'MORT'                                            ELCDTERX
  1948         GO TO 0030-READ--MORT.                                   ELCDTERX
  1949                                                                  ELCDTERX
  1950     IF DD-ID = 'CLAI'                                            ELCDTERX
  1951         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1952                                                                  ELCDTERX
  1953     IF DD-ID = 'COLC'                                            ELCDTERX
  1954         GO TO 0065-READ--COLC.                                   ELCDTERX
  1955                                                                  ELCDTERX
  1956     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1957        DD-IDA = 'CL'                                             ELCDTERX
  1958         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1959                                                                  ELCDTERX
  1960     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1961        DD-IDA = 'PO'                                             ELCDTERX
  1962         GO TO 0050-READ--POXX.                                   ELCDTERX
  1963                                                                  ELCDTERX
  1964     IF DD-ID = 'OPCA'                                            ELCDTERX
  1965         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1966                                                                  ELCDTERX
  1967     IF DD-ID = 'OPST'                                            ELCDTERX
  1968         GO TO 0072-READ--OPST.                                   ELCDTERX
  1969                                                                  ELCDTERX
  1970     IF DD-ID = 'OPBS'                                            ELCDTERX
  1971         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1972                                                                  ELCDTERX
  1973     IF DD-ID = 'OPMS'                                            ELCDTERX
  1974         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1975                                                                  ELCDTERX
  1976     GO TO 0005-READ--CARD.                                       ELCDTERX
  1977                                                                  ELCDTERX
  1978 0010-READ--CLAC.                                                 ELCDTERX
  1979     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1980     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1981     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1982     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1983     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1984     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  36
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1985     GO TO 0005-READ--CARD.                                       ELCDTERX
  1986                                                                  ELCDTERX
  1987 0015-READ--CARR.                                                 ELCDTERX
  1988     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1989     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1990        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1991        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1992        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1993        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1994        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1995        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1996        MOVE DD-CARR1-SECPAY-SW
  1997                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1998     END-IF
  1999                                                                  ELCDTERX
  2000     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2001     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2002        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2003        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2004        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2005        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2006        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2007        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2008        MOVE DD-CARR2-SECPAY-SW
  2009                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2010     END-IF
  2011                                                                  ELCDTERX
  2012                                                                  ELCDTERX
  2013     GO TO 0005-READ--CARD.                                       ELCDTERX
  2014                                                                  ELCDTERX
  2015 0020-READ--STAT.                                                 ELCDTERX
  2016     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2017     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2018        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2019         GO TO 0005-READ--CARD.                                   ELCDTERX
  2020                                                                  ELCDTERX
  2021     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2022     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2023     GO TO 0020-READ--STAT.                                       ELCDTERX
  2024                                                                  ELCDTERX
  2025 0025-READ--BUSC.                                                 ELCDTERX
  2026     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2027     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2028        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2029         GO TO 0005-READ--CARD.                                   ELCDTERX
  2030                                                                  ELCDTERX
  2031     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2032     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2033     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2034                                                                  ELCDTERX
  2035 0030-READ--MORT.                                                 ELCDTERX
  2036     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2037     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2038        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2039         GO TO 0005-READ--CARD.                                   ELCDTERX
  2040                                                                  ELCDTERX
  2041     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2042     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  37
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2043     GO TO 0030-READ--MORT.                                       ELCDTERX
  2044                                                                  ELCDTERX
  2045 0035-READ--CLXX.                                                 ELCDTERX
  2046     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2047          GO TO 0005-READ--CARD.                                  ELCDTERX
  2048                                                                  ELCDTERX
  2049     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2050         DISPLAY '***********************************************'ELCDTERX
  2051         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2052         DISPLAY '***********************************************'ELCDTERX
  2053         GO TO 0055-READ--STOP.                                   ELCDTERX
  2054                                                                  ELCDTERX
  2055     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2056        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2057         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2058                                                                  ELCDTERX
  2059     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2060        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2061         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2062                                                                  ELCDTERX
  2063*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2064     GO TO 0005-READ--CARD.                                       ELCDTERX
  2065                                                                  ELCDTERX
  2066 0040-READ--CLAI.                                                 ELCDTERX
  2067     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2068     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2069        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2070         GO TO 0005-READ--CARD.                                   ELCDTERX
  2071                                                                  ELCDTERX
  2072     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2073     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2074     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2075                                                                  ELCDTERX
  2076 0045-READ--DUMP.                                                 ELCDTERX
  2077     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2078     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2079                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2080     PERFORM ABEND-PGM.                                           ELCDTERX
  2081                                                                  ELCDTERX
  2082 0050-READ--POXX.                                                 ELCDTERX
  2083     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2084         GO TO 0005-READ--CARD.                                   ELCDTERX
  2085                                                                  ELCDTERX
  2086     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2087         DISPLAY '***********************************************'ELCDTERX
  2088         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2089         DISPLAY '***********************************************'ELCDTERX
  2090         GO TO 0055-READ--STOP.                                   ELCDTERX
  2091                                                                  ELCDTERX
  2092     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2093     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2094     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2095     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2096                                                                  ELCDTERX
  2097     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2098         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2099     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2100         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  38
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2101                                                                  ELCDTERX
  2102     GO TO 0005-READ--CARD.                                       ELCDTERX
  2103                                                                  ELCDTERX
  2104 0055-READ--STOP.                                                 ELCDTERX
  2105     GOBACK.                                                      ELCDTERX
  2106                                                                  ELCDTERX
  2107 0060-READ--TEST.                                                 ELCDTERX
  2108     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2109        CLAX-ID         = SPACE  OR                               ELCDTERX
  2110        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2111         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2112                                                                  ELCDTERX
  2113     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2114     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2115                                                                  ELCDTERX
  2116 0065-READ--COLC.                                                 ELCDTERX
  2117     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2118     GO TO 0005-READ--CARD.                                       ELCDTERX
  2119                                                                  ELCDTERX
  2120 0070-READ--OPCA.                                                 ELCDTERX
  2121                                                                  ELCDTERX
  2122     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2123                                                                  ELCDTERX
  2124     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2125             OR                                                   ELCDTERX
  2126         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2127         GO TO 0005-READ--CARD.                                   ELCDTERX
  2128                                                                  ELCDTERX
  2129     ADD 1                       TO INDEXCA.                      ELCDTERX
  2130     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2131                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2132     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2133                                                                  ELCDTERX
  2134 0072-READ--OPST.                                                 ELCDTERX
  2135                                                                  ELCDTERX
  2136     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2137                                                                  ELCDTERX
  2138     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2139             OR                                                   ELCDTERX
  2140         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2141         GO TO 0005-READ--CARD.                                   ELCDTERX
  2142                                                                  ELCDTERX
  2143     ADD 1                       TO INDEXST.                      ELCDTERX
  2144     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2145                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2146     GO TO 0072-READ--OPST.                                       ELCDTERX
  2147                                                                  ELCDTERX
  2148 0074-READ--OPBS.                                                 ELCDTERX
  2149                                                                  ELCDTERX
  2150     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2151                                                                  ELCDTERX
  2152     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2153             OR                                                   ELCDTERX
  2154         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2155         GO TO 0005-READ--CARD.                                   ELCDTERX
  2156                                                                  ELCDTERX
  2157     ADD 1                       TO INDEXBS.                      ELCDTERX
  2158     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  39
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2159     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2160                                                                  ELCDTERX
  2161 0079-READ--EXIT.                                                 ELCDTERX
  2162*    EXIT.                                                        ELCDTERX
  2163******************************************************************ELCDTERX
  2164
  2165 1000-MAIN-LOGIC.
  2166
  2167     set P to address of KIXSYS
  2168     CALL "getenv" using by value P returning var-ptr
  2169     if var-ptr = null then
  2170        display ' kixsys not set '
  2171     else
  2172        set address of var to var-ptr
  2173        move 0 to env-var-len
  2174        inspect var tallying env-var-len
  2175          for characters before X'00'
  2176        unstring var (1:env-var-len) delimited by '/'
  2177           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2178              WS-KIX-SYS
  2179        end-unstring
  2180     end-if
  2181
  2182     display ' KIXSYS  ' ws-kix-myenv
  2183
  2184     PERFORM 1500-EDIT-CYCLE-DATE     THRU 1500-EXIT
  2185
  2186     PERFORM OPEN-FILES
  2187
  2188     MOVE COMPANY-NAME                TO WS-H2-COMPANY-NAME
  2189     MOVE WS-CURRENT-DATE             TO WS-H2-DATE
  2190     MOVE WS-EDITED-CYCLE-DT          TO WS-H3-CYCLE-DT
  2191     PERFORM 3500-PRINT-HEADINGS      THRU 3500-EXIT
  2192
  2193     MOVE DTE-CLASIC-COMPANY-CD       TO CQ-COMPANY-CD
  2194     START ELCHKQ KEY NOT < CQ-COMPANY-CD
  2195     END-START
  2196
  2197     EVALUATE TRUE
  2198     WHEN ELCHKQ-FILE-STATUS = '00'
  2199         PERFORM 2000-BUILD-REPORT-DETAIL THRU 2000-EXIT
  2200             UNTIL END-OF-ELCHKQ
  2201
  2202     WHEN ELCHKQ-FILE-STATUS = '23'
  2203         SET END-OF-ELCHKQ TO TRUE
  2204
  2205     WHEN OTHER
  2206        DISPLAY ' ELCHKQ START ' ELCHKQ-FILE-STATUS
  2207        PERFORM ABEND-PGM THRU APS-EXIT
  2208     END-EVALUATE
  2209
  2210
  2211     IF WS-GRAND-TOTAL-CHECK-CNT > +0
  2212         IF WS-CONTROL-TOTAL-CHECK-CNT > +0
  2213             PERFORM 3700-PRINT-CONTROL-TOTAL THRU 3700-EXIT
  2214         END-IF
  2215         PERFORM 3800-PRINT-GRAND-TOTAL       THRU 3800-EXIT
  2216
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  40
* EL583.cbl
  2217     ELSE
  2218         MOVE '0NO CHECKS PRINTED FOR THE CURRENT CYCLE DATE'
  2219                                              TO PRT
  2220         PERFORM 3900-WRITE                   THRU 3900-EXIT
  2221     END-IF
  2222
  2223
  2224     PERFORM CLOSE-FILES THRU CLOSE-FILES-EXIT
  2225
  2226******************************************************************
  2227****                      ****                                ****
  2228****  If the parm has a company ID in it then we want to      ****
  2229****  interface to the daily G/L feed. This program           ****
  2230****  also runs without a parm so we will just bypass         ****
  2231****  the interface.                                          ****
  2232****                      ****                                ****
  2233******************************************************************
  2234
  2235     if (dte-client = 'DCC')
  2236        and (parm-company-cd = 'DCC' OR 'CSI' OR 'CCC')
  2237        perform 5000-build-sql-table
  2238                                 thru 5000-exit
  2239     end-if
  2240
  2241     GOBACK.
  2242
  2243 1500-EDIT-CYCLE-DATE.
  2244
  2245     IF PARM-LENGTH = 0
  2246         DISPLAY 'CYCLE DATE INPUT PARM MISSING '
  2247         PERFORM ABEND-PGM         THRU APS-EXIT
  2248     END-IF
  2249
  2250     MOVE PARM-CYCLE-DATE          TO DC-GREG-DATE-CYMD
  2251     MOVE 'L'                      TO DC-OPTION-CODE
  2252     PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT
  2253
  2254     IF NO-CONVERSION-ERROR
  2255         MOVE DC-BIN-DATE-1        TO WS-CYCLE-DT-BINARY
  2256         MOVE PARM-CYCLE-DATE      TO WS-CYCLE-DT
  2257         MOVE WS-CYCLE-DT-MM       TO WS-EDITED-CYCLE-DT-MM
  2258         MOVE WS-CYCLE-DT-DD       TO WS-EDITED-CYCLE-DT-DD
  2259         MOVE WS-CYCLE-DT-YY       TO WS-EDITED-CYCLE-DT-YY
  2260         move dc-greg-date-a-edit     to tbl-date
  2261     ELSE
  2262         DISPLAY 'INVALID CYCLE DATE ' PARM-CYCLE-DATE
  2263         PERFORM ABEND-PGM         THRU APS-EXIT
  2264     END-IF
  2265     .
  2266 1500-EXIT.
  2267     EXIT.
  2268
  2269
  2270 2000-BUILD-REPORT-DETAIL.
  2271
  2272     READ ELCHKQ NEXT RECORD
  2273         AT END SET END-OF-ELCHKQ         TO TRUE
  2274             GO TO 2000-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  41
* EL583.cbl
  2275     END-READ
  2276
  2277
  2278********* COMPANY CODE OF HEX '04' = CID
  2279     IF CQ-COMPANY-CD = DTE-CLASIC-COMPANY-CD
  2280         CONTINUE
  2281     ELSE
  2282         SET END-OF-ELCHKQ                TO TRUE
  2283         GO TO 2000-EXIT
  2284     END-IF
  2285
  2286
  2287     IF CQ-CHECK-WRITTEN-DT = WS-CYCLE-DT-BINARY
  2288         CONTINUE
  2289     ELSE
  2290         GO TO 2000-EXIT
  2291     END-IF
  2292
  2293     IF PARM-COMPANY-CD = 'DCC'
  2294        IF CQ-CARRIER = '1' OR '2'
  2295          CONTINUE
  2296        ELSE
  2297          GO TO 2000-EXIT
  2298        END-IF
  2299     END-IF
  2300     IF PARM-COMPANY-CD = 'CSI'
  2301        IF CQ-CARRIER = '3' OR '4'
  2302          CONTINUE
  2303        ELSE
  2304          GO TO 2000-EXIT
  2305        END-IF
  2306     END-IF
  2307     IF PARM-COMPANY-CD = 'CCC'
  2308        IF CQ-CARRIER = '5' OR '6'
  2309          CONTINUE
  2310     ELSE
  2311          GO TO 2000-EXIT
  2312        END-IF
  2313     END-IF
  2314
  2315     INITIALIZE WS-DETAIL1
  2316
  2317     MOVE CQ-CONTROL-NUMBER        TO WS-D1-CONTROL-NUMBER
  2318     MOVE CQ-CHECK-NUMBER          TO WS-D1-CHECK-NUMBER
  2319
  2320
  2321     MOVE CQ-CHECK-WRITTEN-DT      TO DC-BIN-DATE-1
  2322     MOVE SPACE                    TO DC-OPTION-CODE
  2323     PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT
  2324
  2325     IF NO-CONVERSION-ERROR
  2326         MOVE DC-GREG-DATE-1-EDIT  TO WS-D1-CHECK-DT
  2327     ELSE
  2328         DISPLAY 'CHECK DATE CONVERSION ERROR ' DC-ERROR-CODE
  2329         MOVE SPACES               TO WS-D1-CHECK-DT
  2330     END-IF
  2331
  2332
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  42
* EL583.cbl
  2333     EVALUATE TRUE
  2334     WHEN  CQ-PARTIAL-PAYMENT
  2335           MOVE 'PARTIAL'          TO WS-D1-PAYMENT-TYPE
  2336
  2337     WHEN  CQ-FINAL-PAYMENT
  2338           MOVE 'FINAL'            TO WS-D1-PAYMENT-TYPE
  2339
  2340     WHEN  CQ-LUMP-SUM-PAYMENT
  2341           MOVE 'LUMPSUM'          TO WS-D1-PAYMENT-TYPE
  2342
  2343     WHEN  CQ-ADDITIONAL-PAYMENT
  2344           MOVE 'ADDL'             TO WS-D1-PAYMENT-TYPE
  2345
  2346     WHEN  OTHER
  2347           MOVE SPACES             TO WS-D1-PAYMENT-TYPE
  2348     END-EVALUATE
  2349
  2350
  2351     MOVE CQ-CLAIM-NO              TO WS-D1-CLAIM-NUMBER
  2352     MOVE CQ-CARRIER               TO WS-D1-CARRIER
  2353     MOVE CQ-CERT-NO               TO WS-D1-CERT-NUMBER
  2354     MOVE CQ-CHECK-AMOUNT          TO WS-D1-CHECK-AMT
  2355     MOVE CQ-CHECK-BY-USER         TO WS-D1-USER-ID
  2356
  2357
  2358     IF FIRST-TIME-THROUGH
  2359         MOVE CQ-CONTROL-NUMBER    TO WS-HOLD-CONTROL-NUMBER
  2360         MOVE '0'                  TO P-CTL
  2361         SET NOT-FIRST-TIME        TO TRUE
  2362     END-IF
  2363
  2364     IF CQ-LIFE-CLAIM
  2365        MOVE CQ-COMPANY-CD       TO AT-COMPANY-CD
  2366        MOVE CQ-CARRIER          TO AT-CARRIER
  2367        MOVE CQ-CLAIM-NO         TO AT-CLAIM-NO
  2368        MOVE CQ-CERT-NO          TO AT-CERT-NO
  2369        MOVE CQ-PMT-TRLR-SEQUENCE TO AT-SEQUENCE-NO
  2370        SUBTRACT +1              FROM AT-SEQUENCE-NO
  2371        READ ELTRLR
  2372        IF (ELTRLR-FILE-STATUS = '00')
  2373           AND (AT-TRAILER-TYPE = '2')
  2374           AND (AT-PAYMENT-TYPE = 'I')
  2375           AND (AT-VOID-DT = LOW-VALUES)
  2376           MOVE '*'              TO WS-D1-INT-PMT-PRESENT
  2377        END-IF
  2378     END-IF
  2379
  2380     PERFORM 3000-PRINT-DETAIL     THRU 3000-EXIT
  2381
  2382     .
  2383 2000-EXIT.
  2384     EXIT.
  2385
  2386 3000-PRINT-DETAIL.
  2387
  2388     IF CQ-CONTROL-NUMBER = WS-HOLD-CONTROL-NUMBER
  2389         CONTINUE
  2390     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  43
* EL583.cbl
  2391         PERFORM 3700-PRINT-CONTROL-TOTAL THRU 3700-EXIT
  2392         PERFORM 3500-PRINT-HEADINGS      THRU 3500-EXIT
  2393         MOVE +0                   TO WS-CONTROL-TOTAL-CHECK-CNT
  2394         MOVE +0                   TO WS-CONTROL-TOTAL-CHECK-AMT
  2395         MOVE CQ-CONTROL-NUMBER    TO WS-HOLD-CONTROL-NUMBER
  2396     END-IF
  2397
  2398     IF WS-LINE-COUNT = WS-LINE-COUNT-MAX
  2399         PERFORM 3500-PRINT-HEADINGS THRU 3500-EXIT
  2400     END-IF
  2401
  2402     MOVE WS-DETAIL1               TO PRT
  2403     PERFORM 3900-WRITE            THRU 3900-EXIT
  2404
  2405     ADD +1                        TO WS-CONTROL-TOTAL-CHECK-CNT
  2406     ADD +1                        TO WS-GRAND-TOTAL-CHECK-CNT
  2407     ADD CQ-CHECK-AMOUNT           TO WS-CONTROL-TOTAL-CHECK-AMT
  2408
  2409     compute ws-clm-payments = ws-clm-payments + cq-check-amount
  2410
  2411     ADD CQ-CHECK-AMOUNT           TO WS-GRAND-TOTAL-CHECK-AMT
  2412
  2413     .
  2414 3000-EXIT.
  2415     EXIT.
  2416
  2417 3500-PRINT-HEADINGS.
  2418
  2419     MOVE WS-HEADING1              TO PRT
  2420     PERFORM 3900-WRITE            THRU 3900-EXIT
  2421
  2422     MOVE WS-HEADING2              TO PRT
  2423     PERFORM 3900-WRITE            THRU 3900-EXIT
  2424
  2425     ADD +1                        TO WS-PAGE
  2426     MOVE WS-PAGE                  TO WS-H3-PAGE
  2427     MOVE WS-HEADING3              TO PRT
  2428     PERFORM 3900-WRITE            THRU 3900-EXIT
  2429
  2430     MOVE WS-HEADING4              TO PRT
  2431     PERFORM 3900-WRITE            THRU 3900-EXIT
  2432
  2433     MOVE WS-HEADING5              TO PRT
  2434     PERFORM 3900-WRITE            THRU 3900-EXIT
  2435
  2436     MOVE SPACES                   TO PRT
  2437     PERFORM 3900-WRITE            THRU 3900-EXIT
  2438
  2439     .
  2440 3500-EXIT.
  2441     EXIT.
  2442
  2443
  2444 3700-PRINT-CONTROL-TOTAL.
  2445
  2446     MOVE '0'                         TO P-CTL
  2447     MOVE SPACES                      TO P-DATA
  2448     PERFORM 3900-WRITE               THRU 3900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  44
* EL583.cbl
  2449
  2450     MOVE WS-CONTROL-TOTAL-CHECK-CNT  TO WS-T1-CHECK-CNT
  2451     MOVE WS-CONTROL-TOTAL-CHECK-AMT  TO WS-T1-TOTAL-CHECK-AMT
  2452     MOVE WS-TOTAL-LINE1              TO PRT
  2453     PERFORM 3900-WRITE               THRU 3900-EXIT
  2454
  2455     .
  2456 3700-EXIT.
  2457     EXIT.
  2458
  2459
  2460 3800-PRINT-GRAND-TOTAL.
  2461
  2462     MOVE WS-GRAND-TOTAL-CHECK-CNT    TO WS-GT1-CHECK-CNT
  2463     MOVE WS-GRAND-TOTAL-CHECK-AMT    TO WS-GT1-TOTAL-CHECK-AMT
  2464     MOVE WS-GRAND-TOTAL-LINE1        TO PRT
  2465     PERFORM 3900-WRITE               THRU 3900-EXIT
  2466
  2467     MOVE '0    * - INDICATES INTEREST PAYMENT PRESENT '
  2468                                 TO WS-GRAND-TOTAL-LINE1
  2469     MOVE WS-GRAND-TOTAL-LINE1        TO PRT
  2470     PERFORM 3900-WRITE          THRU 3900-EXIT
  2471
  2472     .
  2473 3800-EXIT.
  2474     EXIT.
  2475
  2476
  2477 3900-WRITE.
  2478
  2479     EVALUATE TRUE
  2480     WHEN P-CTL = '1'
  2481         MOVE +1                     TO WS-LINE-COUNT
  2482
  2483     WHEN P-CTL = SPACE
  2484         ADD +1                      TO WS-LINE-COUNT
  2485
  2486     WHEN P-CTL = '0'
  2487         ADD +2                      TO WS-LINE-COUNT
  2488
  2489     WHEN OTHER
  2490         ADD +3                      TO WS-LINE-COUNT
  2491     END-EVALUATE
  2492
  2493
  2494     EVALUATE TRUE
  2495**************************** P = HARDCOPY ONLY
  2496     WHEN DTE-PRT-OPT = 'P'
  2497         WRITE PRT
  2498
  2499**************************** B = FICH (NOW USED FOR SEQUENTIAL
  2500*                                 FILE ARCHIVE) AND HARDCOPY
  2501     WHEN DTE-PRT-OPT = 'B'
  2502         PERFORM 4000-SEQ-FILE-ARCHIVE THRU 4000-EXIT
  2503         WRITE PRT
  2504
  2505**************************** S = ONLINE REPORT FILE ONLY (ELREPT)
  2506     WHEN DTE-PRT-OPT = 'S'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  45
* EL583.cbl
  2507         PERFORM 4300-ONLINE-REPORT    THRU 4300-EXIT
  2508
  2509**************************** T = ONLINE REPORT FILE AND HARDCOPY
  2510     WHEN DTE-PRT-OPT = 'T'
  2511         PERFORM 4300-ONLINE-REPORT    THRU 4300-EXIT
  2512         WRITE PRT
  2513
  2514     WHEN OTHER
  2515         MOVE 'INVALID DTE-PRT-OPT'    TO WS-ABEND-MESSAGE
  2516         PERFORM ABEND-PGM             THRU APS-EXIT
  2517     END-EVALUATE
  2518
  2519     .
  2520 3900-EXIT.
  2521     EXIT.
  2522
  2523
  2524 4000-SEQ-FILE-ARCHIVE.
  2525******************************************************************
  2526* WHILE FICHE IS NO LONGER BEING PRODUCED, THE FICHE LOGIC IS
  2527* BEING USED TO CREATE A SEQUENTIAL FILE REPORT ARCHIVE WHEN
  2528* THE DTE-PRT-OPT IS SET TO 'B'
  2529******************************************************************
  2530     IF FICH-NO
  2531         GO TO 4000-EXIT
  2532     ELSE
  2533         IF FICH-OPEN = SPACE
  2534             MOVE 'X'                TO FICH-OPEN
  2535             OPEN OUTPUT FICH
  2536         END-IF
  2537     END-IF
  2538
  2539     MOVE SPACE                      TO P-CTL
  2540     WRITE FICH-REC                  FROM PRT
  2541
  2542     .
  2543 4000-EXIT.
  2544     EXIT.
  2545
  2546
  2547 4300-ONLINE-REPORT.
  2548
  2549     IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)
  2550         OPEN I-O ELREPT
  2551
  2552         IF DTE-F-1 NOT = ZERO AND
  2553             DTE-VSAM-FLAGS NOT = '97'
  2554             MOVE DTE-VSAM-FLAGS TO WS-ABEND-FILE-STATUS
  2555             MOVE 'ERROR OPENING ELREPT'
  2556                                 TO WS-ABEND-MESSAGE
  2557             PERFORM ABEND-PGM   THRU APS-EXIT
  2558         ELSE
  2559             MOVE '1'                   TO REPT-OPEN
  2560             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2561             MOVE '1'                   TO RF-RECORD-TYPE
  2562             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
  2563             MOVE ZERO                  TO RF-LINE-NUMBER
  2564             START ELREPT KEY NOT LESS RF-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  46
* EL583.cbl
  2565             SET BEGIN-REPORT-DELETE    TO TRUE
  2566             PERFORM 4500-REPORT-DELETE THRU 4500-EXIT
  2567                 UNTIL REPORT-DELETE-DONE
  2568
  2569             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2570             MOVE '2'                   TO RF-RECORD-TYPE
  2571             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
  2572             MOVE ZERO                  TO RF-LINE-NUMBER
  2573             START ELREPT KEY NOT LESS RF-CONTROL-PRIMARY
  2574             SET BEGIN-REPORT-DELETE    TO TRUE
  2575             PERFORM 4500-REPORT-DELETE THRU 4500-EXIT
  2576                 UNTIL REPORT-DELETE-DONE
  2577
  2578             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2579             MOVE '1'                   TO RF-RECORD-TYPE
  2580             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
  2581             MOVE SPACES                TO RF-REPORT-LINE-133
  2582         END-IF
  2583     END-IF
  2584
  2585
  2586     IF DTE-ABEND-CD-1 = '81' AND
  2587        DTE-PRT-OPT = 'S'
  2588         MOVE +0302                     TO WS-RETURN-CODE
  2589         PERFORM ABEND-PGM              THRU APS-EXIT
  2590     END-IF
  2591
  2592
  2593     MOVE P-CTL                         TO RF-CTL-CHAR-133
  2594     MOVE P-DATA                        TO RF-DATA-133
  2595
  2596     IF DTE-ABEND-CD-1 = SPACES
  2597         ADD +1                         TO DTE-TOT-LINES
  2598         MOVE DTE-TOT-LINES             TO RF-LINE-NUMBER
  2599         WRITE REPORT-SAVE-FILE
  2600             INVALID KEY
  2601                 MOVE '88'              TO DTE-ABEND-CD-1
  2602                 CLOSE ELREPT
  2603                 MOVE SPACE             TO REPT-OPEN
  2604     END-IF
  2605
  2606     .
  2607 4300-EXIT.
  2608     EXIT.
  2609
  2610 4500-REPORT-DELETE.
  2611
  2612     IF DTE-F-1 NOT = ZERO
  2613         MOVE ZERO                          TO DTE-VSAM-FLAGS
  2614         SET REPORT-DELETE-DONE             TO TRUE
  2615         GO TO 4500-EXIT
  2616     END-IF
  2617
  2618     READ ELREPT NEXT RECORD
  2619         AT END
  2620             SET REPORT-DELETE-DONE         TO TRUE
  2621             GO TO 4500-EXIT
  2622     END-READ
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  47
* EL583.cbl
  2623
  2624     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND
  2625        OLC-REPORT-NAME = RF-REPORT-ID
  2626         DELETE ELREPT RECORD
  2627     END-IF
  2628
  2629     .
  2630 4500-EXIT.
  2631     EXIT.
  2632
  2633 5000-build-sql-table.
  2634
  2635     move 'NTSQLTST2_Logic'      to svr
  2636     move 'sa'                   to usr
  2637     move 'sql2008r2'            to pass
  2638
  2639*    if ws-kix-myenv = 'cid1p'
  2640*       move 'NTCSO2_Logic'      to svr
  2641*       move 'sa'                to usr
  2642*       move 'ntcso2'            to pass
  2643*    end-if
  2644
  2645     display 'Begin connect to DB '
  2646     string
  2647         usr delimited space
  2648         "." delimited size
  2649         pass delimited space into usr-pass
  2650     end-string
  2651
  2652     display ' usr pass ' usr-pass
  2653
  2654     EXEC SQL
  2655        CONNECT TO :svr USER :usr-pass
  2656     END-EXEC
  2657
  2658     if sqlcode not = 0
  2659        display "Error: cannot connect "
  2660        display sqlcode
  2661        display sqlerrmc
  2662        goback
  2663     end-if
  2664
  2665     display " connect to DB successful "
  2666
  2667*    perform 5010-drop-table     thru 5010-exit
  2668*    perform 5020-truncate-table thru 5020-exit
  2669*    perform 5030-create-table   thru 5030-exit
  2670     perform 5040-insert-row     thru 5040-exit
  2671     perform 5050-finish-up      thru 5050-exit
  2672
  2673     .
  2674 5000-exit.
  2675     exit.
  2676
  2677 5010-drop-table.
  2678
  2679     display 'Begin Drop table'
  2680     EXEC SQL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  48
* EL583.cbl
  2681         drop table DAILYGLINT
  2682     END-EXEC
  2683     if sqlcode not = 0
  2684        display "Error(anticipated) : cannot drop table "
  2685        display sqlcode
  2686        display sqlerrmc
  2687*       goback
  2688     end-if
  2689
  2690     display ' sql return code ' sqlcode
  2691     display ' sql err mess    ' sqlerrmc
  2692
  2693     .
  2694 5010-exit.
  2695     exit.
  2696
  2697 5020-truncate-table.
  2698
  2699     display '*** Begin Truncate table ***'
  2700     EXEC SQL
  2701         truncate table DAILYGLINT
  2702     END-EXEC
  2703     if sqlcode not = 0
  2704        display "Error : cannot truncate table "
  2705        display sqlcode
  2706        display sqlerrmc
  2707        goback
  2708     end-if
  2709
  2710     display ' sql return code ' sqlcode
  2711     display ' sql err mess    ' sqlerrmc
  2712     display '***  End  Truncate table ***'
  2713
  2714     .
  2715 5020-exit.
  2716     exit.
  2717
  2718 5030-create-table.
  2719
  2720     display ' Begin Create table'
  2721     EXEC SQL
  2722        create table DAILYGLINT (
  2723         compid char(5),
  2724         batchno char(50),
  2725         carrier char(1),
  2726         procdate datetime,
  2727         sourcerpt char(8),
  2728         dlyremits decimal(9,2),
  2729         dlycharges decimal(9,2),
  2730         dlyclmpmts decimal(9,2),
  2731         dlystoppays decimal(9,2),
  2732         dlyoffline decimal(9,2))
  2733     END-EXEC
  2734     if sqlcode not = 0
  2735        display "Error: cannot create table "
  2736        move sqlcode             to ws-disp-code
  2737        display ' sql return code ' ws-disp-code
  2738        display ' sql err mess    ' sqlerrmc
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  49
* EL583.cbl
  2739        goback
  2740     end-if
  2741
  2742     display " Create table successful "
  2743
  2744     .
  2745 5030-exit.
  2746     exit.
  2747
  2748 5040-insert-row.
  2749
  2750*    display ' Begin Insert row '
  2751
  2752     evaluate true
  2753        when parm-company-cd = 'DCC'
  2754           move 'LPAC'           to tbl-comp-id
  2755           move 'Batch 75 and 4 LPAC TPC Claims'
  2756                                 to tbl-batch-no
  2757        when parm-company-cd = 'CSI'
  2758           move 'CSO'            to tbl-comp-id
  2759           move 'Batch 76 CSI DCC Claims'
  2760                                 to tbl-batch-no
  2761        when other
  2762           move 'CCC'            to tbl-comp-id
  2763           move 'Batch 6 CCC DCC Claims'
  2764                                 to tbl-batch-no
  2765     end-evaluate
  2766
  2767*    move current-date           to tbl-date
  2768     move 'EL583'                to tbl-source-rpt
  2769     move '0000000.00'           to tbl-remits
  2770                                    tbl-charges
  2771                                    tbl-other
  2772                                    tbl-clm-stop-pays
  2773                                    tbl-clm-offline-pmts
  2774
  2775     move ws-clm-payments        to em-clm-pmts
  2776
  2777     EXEC SQL
  2778        insert into DAILYGLINT (
  2779         compid,
  2780         batchno,
  2781         carrier,
  2782         procdate,
  2783         sourcerpt,
  2784         dlyremits,
  2785         dlycharges,
  2786         dlyclmpmts,
  2787         dlystoppays,
  2788         dlyoffline)
  2789         values (
  2790            :tbl-comp-id,
  2791            :tbl-batch-no,
  2792            :tbl-carrier,
  2793            :tbl-date,
  2794            :tbl-source-rpt,
  2795            :tbl-remits,
  2796            :tbl-charges,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  50
* EL583.cbl
  2797            :tbl-clm-pmts,
  2798            :tbl-clm-stop-pays,
  2799            :tbl-clm-offline-pmts)
  2800     END-EXEC
  2801     if sqlcode not = 0
  2802        display "Error: cannot insert row "
  2803        display ' sql return code ' sqlcode
  2804        display ' sql err mess    ' sqlerrmc
  2805        goback
  2806     end-if
  2807
  2808     .
  2809 5040-exit.
  2810     exit.
  2811
  2812 5050-finish-up.
  2813
  2814     display ' Begin Commit '
  2815     EXEC SQL
  2816         commit transaction
  2817     END-EXEC
  2818     if sqlcode not = 0
  2819        display "Error: commit "
  2820        display ' sql return code ' sqlcode
  2821        display ' sql err mess    ' sqlerrmc
  2822        goback
  2823     end-if
  2824
  2825     display " Commit trans successful "
  2826
  2827     display ' Begin Disconnect '
  2828     EXEC SQL
  2829         commit work release
  2830     END-EXEC
  2831     if sqlcode not = 0
  2832        display "Error: commit release "
  2833        display ' sql return code ' sqlcode
  2834        display ' sql err mess    ' sqlerrmc
  2835     end-if
  2836
  2837     .
  2838 5050-exit.
  2839     exit.
  2840
  2841
  2842 8500-DATE-CONVERSION.
  2843
  2844     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2845
  2846     .
  2847 8500-EXIT.
  2848     EXIT.
  2849
  2850 OPEN-FILES.
  2851
  2852     OPEN INPUT  ELCHKQ ELTRLR
  2853          OUTPUT PRNTR
  2854
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  51
* EL583.cbl
  2855     IF ELCHKQ-FILE-STATUS  = '00' OR '97'
  2856        CONTINUE
  2857     ELSE
  2858        MOVE 'OPEN INPUT ERROR OCCURRED ON ELCHKQ' TO
  2859                                      WS-ABEND-MESSAGE
  2860        MOVE ELCHKQ-FILE-STATUS    TO WS-ABEND-FILE-STATUS
  2861        PERFORM ABEND-PGM          THRU APS-EXIT
  2862     END-IF
  2863
  2864     IF ELTRLR-FILE-STATUS  = '00' OR '97'
  2865        CONTINUE
  2866     ELSE
  2867        MOVE 'OPEN INPUT ERROR OCCURRED ON ELTRLR' TO
  2868                                      WS-ABEND-MESSAGE
  2869        MOVE ELTRLR-FILE-STATUS    TO WS-ABEND-FILE-STATUS
  2870        PERFORM ABEND-PGM          THRU APS-EXIT
  2871     END-IF
  2872
  2873     .
  2874 OPEN-FILES-EXIT.
  2875     EXIT.
  2876
  2877 CLOSE-FILES.
  2878
  2879 CFS-010.
*               COPY ELCPRTCX.
  2880******************************************************************04/15/98
  2881*                                                                *ELCPRTCX
  2882*                                                                *ELCPRTCX
  2883*                            ELCPRTCX.                           *   LV003
  2884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2885*                            VMOD=2.003                          *   CL**3
  2886*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
  2887*                                                                *ELCPRTCX
  2888* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  2889******************************************************************ELCPRTCX
  2890                                                                  ELCPRTCX
  2891      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
  2892          CLOSE FICH.                                             ELCPRTCX
  2893                                                                  ELCPRTCX
  2894      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
  2895          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
  2896          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
  2897          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
  2898          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
  2899          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
  2900          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
  2901          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
  2902          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
  2903              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  2904              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  2905              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  2906                  UPON CONSOLE                                    ELCPRTCX
  2907              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  2908                  UPON CONSOLE                                    ELCPRTCX
  2909            ELSE                                                  ELCPRTCX
  2910              DISPLAY '***************************************'   ELCPRTCX
  2911              DISPLAY '***************************************'   ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  52
* EL583.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
  2912              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
  2913              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
  2914              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
  2915              DISPLAY '**                                   **'   ELCPRTCX
  2916              DISPLAY '***************************************'   ELCPRTCX
  2917              DISPLAY '***************************************'   ELCPRTCX
  2918              CLOSE ELREPT.                                       ELCPRTCX
  2919                                                                  ELCPRTCX
  2920      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
  2921          DISPLAY '***************************************'       ELCPRTCX
  2922          DISPLAY '***************************************'       ELCPRTCX
  2923          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  2924          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
  2925          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
  2926          DISPLAY '**                                   **'       ELCPRTCX
  2927          DISPLAY '***************************************'       ELCPRTCX
  2928          DISPLAY '***************************************'       ELCPRTCX
  2929          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  2930                                                                  ELCPRTCX
  2931      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
  2932          DISPLAY '***************************************'       ELCPRTCX
  2933          DISPLAY '***************************************'       ELCPRTCX
  2934          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  2935          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
  2936          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
  2937          DISPLAY '**                                   **'       ELCPRTCX
  2938          DISPLAY '***************************************'       ELCPRTCX
  2939          DISPLAY '***************************************'       ELCPRTCX
  2940          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  2941                                                                  ELCPRTCX
  2942                                                                  ELCPRTCX
  2943******************************************************************ELCPRTCX
  2944
  2945     CLOSE ELCHKQ ELTRLR
  2946           PRNTR
  2947
  2948     .
  2949 CLOSE-FILES-EXIT.
  2950     EXIT.
  2951
  2952 ABEND-PGM.
*                 COPY ELCABEND.
  2953***************************************************************** 04/14/98
  2954*                                                               * ELCABEND
  2955*                            ELCABEND.                          *    LV003
  2956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2957*                            VMOD 2.002                              CL**2
  2958*                                                               * ELCABEND
  2959*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2960*            AND THEN ABENDS.                                   * ELCABEND
  2961*                                                               * ELCABEND
  2962*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2963*                                                               * ELCABEND
  2964***************************************************************** ELCABEND
  2965*APS-010.                                                         ELCABEND
  2966     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2967     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2968                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:47 Page  53
* EL583.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2969     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2970         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2971         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2972                                 UPON CONSOLE.                    ELCABEND
  2973                                                                  ELCABEND
  2974     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2975         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2976         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2977                                 UPON CONSOLE.                    ELCABEND
  2978                                                                  ELCABEND
  2979     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2980     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2981                                 UPON CONSOLE.                    ELCABEND
  2982                                                                  ELCABEND
  2983     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2984     CALL 'ABORTME'.
  2985                                                                  ELCABEND
  2986 APS-EXIT.                                                        ELCABEND
  2987     EXIT.                                                        ELCABEND
  2988
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116728     Code:       12655
