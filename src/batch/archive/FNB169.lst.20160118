* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB169.cbl
* Options: int("FNB169.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB169.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB169.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB169.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB169.
     3
     4******************************************************************
     5*                                                                *
     6*            FREEDOM INTERFACE FOR DCC CONTRACT FEES             *
     7*                                                                *
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB169.cbl
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
    16* 050704    2003080800002  SMVA  NEW PROGRAM FOR SECURE PAY
    17* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
    18* 021009  IR2009020900001  PEMA  ADD AGT TYPE J AS INCENTIVE
    19* 022009    2008050500001  AJRA  ADD PROCESSING FOR CCC
    20* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    21* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    22* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    23* 080212  IR2012080100002  PEMA  CORRECT AGT TYPE N
    24* 082912  IR2012080700001  PEMA  CORRECT REF ADMIN FEE
    25* 080612  IR2013080500001  PEMA  CORRECT REF CSO ADMIN FEE
    26* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    27* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    28* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
    29******************************************************************
    30
    31 ENVIRONMENT DIVISION.
    32 INPUT-OUTPUT SECTION.
    33 FILE-CONTROL.
    34
    35     SELECT DETEXTR              ASSIGN TO SYS010
    36                                 FILE STATUS IS DETEXT-STATUS.
    37     SELECT FREEDOM-EXTRACT      ASSIGN TO SYS011
    38                                 ORGANIZATION IS LINE SEQUENTIAL.
    39
    40     SELECT CSI-FREEDOM-EXTRACT  ASSIGN TO SYS012
    41                                 ORGANIZATION IS LINE SEQUENTIAL.
    42
    43     SELECT CCC-FREEDOM-EXTRACT  ASSIGN TO SYS013
    44                                 ORGANIZATION IS LINE SEQUENTIAL.
    45
    46     SELECT ERACCT               ASSIGN TO ERACCT
    47                                 ORGANIZATION IS INDEXED
    48                                 ACCESS IS DYNAMIC
    49                                 RECORD KEY IS AM-CONTROL-PRIMARY
    50                                 FILE STATUS IS ERACCT-STATUS.
    51
    52     SELECT ERPDEF           ASSIGN TO ERPDEF
    53                             ACCESS IS DYNAMIC
    54                             ORGANIZATION IS INDEXED
    55                             FILE STATUS IS ERPDEF-FILE-STATUS
    56                             RECORD KEY IS PD-CONTROL-PRIMARY.
    57
    58     SELECT DISK-DATE            ASSIGN TO SYS019.
    59
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB169.cbl
    61 DATA DIVISION.
    62 FILE SECTION.
    63
    64 FD  DETEXTR
    65     LABEL RECORDS ARE STANDARD
    66     RECORDING MODE IS F
    67     RECORD CONTAINS 510 CHARACTERS
    68     BLOCK CONTAINS 0 RECORDS.
*   69     COPY ECSEXT01.
    70******************************************************************04/29/98
    71*                                                                *ECSEXT01
    72*                            ECSEXT01                            *   LV015
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    74*                            VMOD=2.015                          *ECSEXT01
    75*                                                                *ECSEXT01
    76*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    77*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    78*                                                                *ECSEXT01
    79*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    80*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    81*                                                                *ECSEXT01
    82*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    83*                                                                *ECSEXT01
    84******************************************************************ECSEXT01
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    94* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    95* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    96* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    97* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    98* 032612  CR2011110200001  PEMA  AHL CHANGES
    99******************************************************************
   100                                                                  ECSEXT01
   101 01  DETAIL-EXTRACT.                                              ECSEXT01
   102     02 DETAIL-FILE.                                              ECSEXT01
   103     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
   104         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
   105                                                                  ECSEXT01
   106     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
   107                                                                  ECSEXT01
   108     12  DE-REIN                           PIC X.                 ECSEXT01
   109                                                                  ECSEXT01
   110     12  DE-CONTROL.                                              ECSEXT01
   111         16  DE-CNTRL1.                                           ECSEXT01
   112             20  DE-CARRIER                PIC X.                 ECSEXT01
   113             20  DE-GROUPING.                                     ECSEXT01
   114                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   115                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
   116             20  DE-STATE                  PIC XX.                ECSEXT01
   117             20  DE-ACCOUNT.                                      ECSEXT01
   118                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   119                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   120         16  DE-CNTRL2.                                           ECSEXT01
   121             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   122             20  DE-CERT.                                         ECSEXT01
   123                 24 DE-CERT-NO.                                   ECSEXT01
   124                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   125                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   126                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   127                                                                  ECSEXT01
   128     12  DE-TRANS                          PIC X.                 ECSEXT01
   129         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   130         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   131         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   132         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   133         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   134         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   135         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   136         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   137         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   138         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   139                                                                  ECSEXT01
   140     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   141     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   142                                                                  ECSEXT01
   143     12  DE-NAME.                                                 ECSEXT01
   144         16  DE-LNAME                      PIC X(15).             ECSEXT01
   145         16  DE-FNAME.                                            ECSEXT01
   146             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   147             20  FILLER                    PIC X(9).              ECSEXT01
   148         16  DE-INIT                       PIC X.                 ECSEXT01
   149     12  DE-AGE                            PIC 99.                ECSEXT01
   150     12  DE-SEX                            PIC X.                 ECSEXT01
   151     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   152                                                                  ECSEXT01
   153     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   154     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   155     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   156     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   157     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   158     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   159     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   160     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   161     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   162                                                                  ECSEXT01
   163     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   164     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   165     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   166     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   167                                                                  ECSEXT01
   168     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   169     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   170     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   171     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   172     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   173                                                                  ECSEXT01
   174     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   175     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   176     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   177     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   178                                                                  ECSEXT01
   179     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   180     12  DE-ADDL-CLP REDEFINES DE-LIVES
   181                                           PIC S9(5)V99   COMP-3.
   182     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   183     12  FILLER REDEFINES DE-NUM-BILLED.
   184         16  DE-CLP-STATE                  PIC XX.
   185         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   186     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   187     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   188                                                                  ECSEXT01
   189     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   190     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   191     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   192     12  DE-IG                             PIC X.                 ECSEXT01
   193     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   194*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   195     12  DE-MEMBER-NO.                                            ECSEXT01
   196         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   197         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   198         16  FILLER                        PIC X(03).             ECSEXT01
   199     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   200                                                                  ECSEXT01
   201     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
   202         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   203                                                                  ECSEXT01
   204     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   205     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   206                                                                  ECSEXT01
   207     12  DE-REI-AREA.                                             ECSEXT01
   208         16  DE-REI-COMP.                                         ECSEXT01
   209             20  DE-REINCO                 PIC XXX.               ECSEXT01
   210             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   211         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   212         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   213         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   214         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   215         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   216         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   217         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   218                                                                  ECSEXT01
   219     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   220     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   221         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   222         16  F                             PIC X.
   223*    12  FILLER                            PIC X(5).              ECSEXT01
   224                                                                  ECSEXT01
   225     12  DE-BILLED-AREA.                                          ECSEXT01
   226         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   227             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   228                                                                  ECSEXT01
   229         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   230             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   231             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   232             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   233             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   234             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   235             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   236                                                                  ECSEXT01
   237         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   238             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   239                                                                  ECSEXT01
   240         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   241         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   242         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   243         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   244                                                                  ECSEXT01
   245         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   246*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   247*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   248                                                                  ECSEXT01
   249     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   250         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   251         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   252         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   253                                                                  ECSEXT01
   254     12  DE-REVERSE-REASONS.                                      ECSEXT01
   255         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   256         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   257     12  DE-CANCEL-REASON                  PIC X.
   258                                                                  ECSEXT01
   259     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
   260     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   261                                                                  ECSEXT01
   262     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   263         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   264             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   265         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   266             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   267                                                                  ECSEXT01
   268     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   269         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   270                                                                  ECSEXT01
   271     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   272     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   273         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   274         16  FILLER                        PIC X.
   275                                                                  ECSEXT01
   276****************************************************************  ECSEXT01
   277**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   278****************************************************************  ECSEXT01
   279     12  DE-COMM-LEVELS.                                          ECSEXT01
   280         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   281             20  DE-AGT.                                          ECSEXT01
   282                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   283                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   284             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   285             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   286             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   287                                                                  ECSEXT01
   288     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   289****************************************************************  ECSEXT01
   290*******                 CLAIM EXTRACT                      *****  ECSEXT01
   291****************************************************************  ECSEXT01
   292     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   293     12  FILLER                            PIC X(334).            ECSEXT01
   294     12  DE-TYPE                           PIC X.                 ECSEXT01
   295         88  DE-DTH                           VALUE '1'.          ECSEXT01
   296         88  DE-AH                            VALUE '2'.          ECSEXT01
   297         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   298         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   299         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   300         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   301                                                                  ECSEXT01
   302     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   303     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   304                                                                  ECSEXT01
   305     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   306     12  DE-REPORTED.                                             ECSEXT01
   307         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   308         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   309         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   310     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   311     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   312                                                                  ECSEXT01
   313     12  DE-CNUM                           PIC X(7).              ECSEXT01
   314     12  DE-CHECK                          PIC X(7).              ECSEXT01
   315     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   316     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   317     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
   318     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   319         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   320         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   321         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   322         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   323         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   324         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   325         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   326                                                                  ECSEXT01
   327     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   328                                                                  ECSEXT01
   329     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   330     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   331     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   332     12  FILLER                            PIC XX.                ECSEXT01
   333     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   334                                                                  ECSEXT01
   335     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   336     12  DE-BENEFICIARY                    PIC X(10).
   337     12  filler redefines de-beneficiary.
   338         16  de-birth-date                 pic 9(11)  comp-3.
   339         16  f                             pic x(4).
   340     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   341     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   342     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   343     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   344     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   345     12  DE-CLM-CLASS                      PIC XX.
   346     12  DE-CLM-DEV                        PIC XXX.
   347     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   348     12  de-xycor-cert-seq                 pic x(3).
   349     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   350     12  DE-XYCOR-ACTION-CD                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   351     12  DE-XYCOR-STATUS                   PIC X.
   352     12  FILLER                            PIC X(4).              ECSEXT01
   353                                                                  ECSEXT01
   354     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   355                                                                  ECSEXT01
   356****************************************************************  ECSEXT01
   357*******               RESERVE EXTRACT                      *****  ECSEXT01
   358****************************************************************  ECSEXT01
   359     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   360     12  FILLER                            PIC X(334).            ECSEXT01
   361                                                                  ECSEXT01
   362     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   363         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   364         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   365                                                                  ECSEXT01
   366     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   367     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   368     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   369                                                                  ECSEXT01
   370     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   371                                                                  ECSEXT01
   372     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   373     12  DE-RSV-REPORTED.                                         ECSEXT01
   374         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   375         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
   376         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   377     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   378                                                                  ECSEXT01
   379     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   380     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   381     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   382                                                                  ECSEXT01
   383     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   384     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   385     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   386                                                                  ECSEXT01
   387     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   388                                                                  ECSEXT01
   389     12  DE-RATE-CLASS                     PIC XX.
   390     12  DE-DEV-CODE                       PIC XXX.
   391     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   392     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   393     12  FILLER                            PIC X(58).             ECSEXT01
   394                                                                  ECSEXT01
   395     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   396******************************************************************ECSEXT01
   397
   398 FD  FREEDOM-EXTRACT
   399     LABEL RECORDS ARE STANDARD
   400     RECORDING MODE IS F
   401     BLOCK CONTAINS 0 RECORDS.
   402 01  EXTRACT-RECORD      PIC X(250).
   403
   404 FD  CSI-FREEDOM-EXTRACT
   405     LABEL RECORDS ARE STANDARD
   406     RECORDING MODE IS F
   407     BLOCK CONTAINS 0 RECORDS.
   408 01  CSI-EXTRACT-RECORD          PIC X(250).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* FNB169.cbl
   409
   410 FD  CCC-FREEDOM-EXTRACT
   411     LABEL RECORDS ARE STANDARD
   412     RECORDING MODE IS F
   413     BLOCK CONTAINS 0 RECORDS.
   414 01  CCC-EXTRACT-RECORD          PIC X(250).
   415
   416 FD  ERACCT.
*  417     COPY ERCACCT.
   418******************************************************************04/19/98
   419*                                                                *ERCACCT
   420*                                                                *ERCACCT
   421*                            ERCACCT                             *   LV031
   422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   423*                            VMOD=2.031                          *ERCACCT
   424*                                                                *ERCACCT
   425*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   426*                                                                *ERCACCT
   427*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   428*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   429*                                                                *ERCACCT
   430*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   431*                                                                *ERCACCT
   432*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   433*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   434*                                                                *ERCACCT
   435*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   436*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   437*                                                                *ERCACCT
   438*   LOG = NO                                                     *ERCACCT
   439*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   440*                                                                *ERCACCT
   441*                                                                *ERCACCT
   442******************************************************************ERCACCT
   443*                   C H A N G E   L O G
   444*
   445* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   446*-----------------------------------------------------------------
   447*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   448* EFFECTIVE    NUMBER
   449*-----------------------------------------------------------------
   450* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   451* 092705    2005050300006  PEMA  ADD SPP LEASES
   452* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   453* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   454* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   455* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   456* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   457******************************************************************
   458                                                                  ERCACCT
   459 01  ACCOUNT-MASTER.                                              ERCACCT
   460     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   461         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   462                                                                  ERCACCT
   463     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   464         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   465         16  AM-MSTR-CNTRL.                                       ERCACCT
   466             20  AM-CONTROL-A.                                    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   467                 24  AM-CARRIER            PIC X.                 ERCACCT
   468                 24  AM-GROUPING.                                 ERCACCT
   469                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   470                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   471                 24  AM-STATE              PIC XX.                ERCACCT
   472                 24  AM-ACCOUNT.                                  ERCACCT
   473                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   474                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   475             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   476                                           PIC X(19).             ERCACCT
   477             20  AM-CNTRL-B.                                      ERCACCT
   478                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   479                 24  FILLER                PIC X(4).              ERCACCT
   480             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   481                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   482                                                                  ERCACCT
   483     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   484         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   485         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   486         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   487         16  AM-VG-STATE                   PIC XX.                ERCACCT
   488         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   489         16  AM-VG-DATE.                                          ERCACCT
   490             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   491             20  FILLER                    PIC X(4).              ERCACCT
   492         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   493                                           PIC 9(11)      COMP-3. ERCACCT
   494     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   495         16  FILLER                        PIC X(10).
   496         16  AM-VG-KEY3.
   497             20  AM-VG3-ACCOUNT            PIC X(10).
   498             20  AM-VG3-EXP-DT             PIC XX.
   499         16  FILLER                        PIC X(4).
   500     12  AM-MAINT-INFORMATION.                                    ERCACCT
   501         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   502         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   503         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   504         16  FILLER                        PIC XX.                ERCACCT
   505                                                                  ERCACCT
   506     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   507     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   508                                                                  ERCACCT
   509     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   510         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   511         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   512                                                                  ERCACCT
   513     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   514     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   515                                                                  ERCACCT
   516     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   517     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   518                                                                  ERCACCT
   519     12  AM-NAME                           PIC X(30).             ERCACCT
   520     12  AM-PERSON                         PIC X(30).             ERCACCT
   521     12  AM-ADDRS                          PIC X(30).             ERCACCT
   522     12  AM-CITY.
   523         16  AM-ADDR-CITY                  PIC X(28).
   524         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   525     12  AM-ZIP.                                                  ERCACCT
   526         16  AM-ZIP-PRIME.                                        ERCACCT
   527             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   528                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   529             20  FILLER                    PIC X(4).              ERCACCT
   530         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   531     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   532         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   533         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   534         16  FILLER                        PIC XXX.               ERCACCT
   535     12  AM-TEL-NO.                                               ERCACCT
   536         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   537         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   538         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   539     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   540         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   541         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   542                                                                  ERCACCT
   543     12  AM-COMM-STRUCTURE.                                       ERCACCT
   544         16  AM-DEFN-1.                                           ERCACCT
   545             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   546                 24  AM-AGT.                                      ERCACCT
   547                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   548                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   549                 24  AM-COM-TYP            PIC X.                 ERCACCT
   550                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   551                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   552                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   553                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   554                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   555                 24  AM-GL-CODES           PIC X.                 ERCACCT
   556                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   557                 24  FILLER                PIC X(01).             ERCACCT
   558         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   559             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   560                 24  FILLER                PIC X(11).             ERCACCT
   561                 24  AM-L-COMA             PIC XXX.               ERCACCT
   562                 24  AM-J-COMA             PIC XXX.               ERCACCT
   563                 24  AM-A-COMA             PIC XXX.               ERCACCT
   564                 24  FILLER                PIC X(6).              ERCACCT
   565                                                                  ERCACCT
   566     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   567         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   568                                                                  ERCACCT
   569     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   570                                                                  ERCACCT
   571     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   572         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   573         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   574     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   575         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   576         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   577     12  AM-GPCD                           PIC 99.                ERCACCT
   578     12  AM-IG                             PIC X.                 ERCACCT
   579         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   580         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   581     12  AM-STATUS                         PIC X.                 ERCACCT
   582         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   583         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   584         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   585         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   586         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   587         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   588     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   589     12  AM-ID-NO                          PIC X(11).             ERCACCT
   590                                                                  ERCACCT
   591     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   592     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   593     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   594     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   595     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   596     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   597     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   598     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   599     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   600                                                                  ERCACCT
   601     12  AM-USER-FIELDS.                                          ERCACCT
   602         16  AM-FLD-1                      PIC XX.                ERCACCT
   603         16  AM-FLD-2                      PIC XX.                ERCACCT
   604         16  AM-FLD-3                      PIC XX.                ERCACCT
   605         16  AM-FLD-4                      PIC XX.                ERCACCT
   606         16  AM-FLD-5                      PIC XX.                ERCACCT
   607                                                                  ERCACCT
   608     12  AM-1ST-PROD-DATE.                                        ERCACCT
   609         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   610         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   611         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   612     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   613     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   614         16  AM-PUR-YR                     PIC XX.                ERCACCT
   615         16  AM-PUR-MO                     PIC XX.                ERCACCT
   616         16  AM-PUR-DA                     PIC XX.                ERCACCT
   617     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   618     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   619     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   620     12  AM-INACTIVE-DATE.                                        ERCACCT
   621         16  AM-INA-MO                     PIC 99.                ERCACCT
   622         16  AM-INA-DA                     PIC 99.                ERCACCT
   623         16  AM-INA-YR                     PIC 99.                ERCACCT
   624     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   625                                                                  ERCACCT
   626     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   627     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   628                                                                  ERCACCT
   629     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   630         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   631         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   632         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   633         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   634                                                                  ERCACCT
   635     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   636         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   637         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   638                                                                  ERCACCT
   639     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   640                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   641     12  AM-OVER-SHORT.                                           ERCACCT
   642         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   643         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   644                                                                  ERCACCT
   645     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   646     12  AM-DCC-CLP-STATE                  PIC XX.
   647                                                                  ERCACCT
   648     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   649     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   650                                                                  ERCACCT
   651     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   652     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   653     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   654     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   655     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   656     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   657     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   658     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   659     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   660     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   661     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   662     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   663     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   664     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   665     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   666     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   667                                                                  ERCACCT
   668     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   669                                                                  ERCACCT
   670     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   671     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   672                                                                  ERCACCT
   673     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   674     12  AM-EARN-METHODS.                                         ERCACCT
   675         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   676             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   677             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   678             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   679             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   680         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   681             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   682             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   683             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   684             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   685         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   686             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   687             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   688             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   689             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   690             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   691             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   692                                                                  ERCACCT
   693     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   694     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   695     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   696                                                                  ERCACCT
   697     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   698     12  AM-RET-P-E                        PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   699     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   700     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   701     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   702     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   703         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   704         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   705     12  AM-RETRO-EARNINGS.                                       ERCACCT
   706         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   707         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   708         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   709     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   710         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   711         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   712     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   713         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   714         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   715         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   716     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   717     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   718                                                                  ERCACCT
   719     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   720         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   721         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   722         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   723         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   724         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   725                                                                  ERCACCT
   726     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   727                                                                  ERCACCT
   728     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   729                                                                  ERCACCT
   730     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   731         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   732                                                                  ERCACCT
   733     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   734         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   735         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   736                                                                  ERCACCT
   737     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   738         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   739                                                                  ERCACCT
   740     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   741         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   742         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   743                                                                  ERCACCT
   744     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   745                                                                  ERCACCT
   746     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   747     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   748     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   749     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   750     12  AM-DCC-UEF-STATE                  PIC XX.
   751     12  FILLER                            PIC XXX.
   752     12  AM-REPORT-CODE-3                  PIC X(10).
   753*    12  FILLER                            PIC X(22).             ERCACCT
   754                                                                  ERCACCT
   755     12  AM-RESERVE-DATE.                                         ERCACCT
   756         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   757         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   758         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   759                                                                  ERCACCT
   760     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   761     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   762         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   763         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   764         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   765         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   766                                                                  ERCACCT
   767     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   768         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   769         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   770         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   771         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   772                                                                  ERCACCT
   773     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   774         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   775             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   776             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   777             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   778             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   779             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   780             20  FILLER                    PIC XX.                ERCACCT
   781         16  FILLER                        PIC X(80).             ERCACCT
   782                                                                  ERCACCT
   783     12  AM-TRANSFER-DATA.                                        ERCACCT
   784         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   785             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   786             20  AM-TRNFROM-GROUPING.                             ERCACCT
   787                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   788                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   789             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   790             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   791                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   792                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   793             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   794         16  AM-TRANSFERRED-TO.                                   ERCACCT
   795             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   796             20  AM-TRNTO-GROUPING.                               ERCACCT
   797                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   798                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   799             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   800             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   801                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   802                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   803             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   804         16  FILLER                        PIC X(10).             ERCACCT
   805                                                                  ERCACCT
   806     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   807                                                                  ERCACCT
   808     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   809         16  AM-DEFN-1-SAVED.                                     ERCACCT
   810             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   811                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   812                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   813                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   814                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   815                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   816                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   817                 24  FILLER                PIC X.                 ERCACCT
   818                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   819                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   820                 24  FILLER                PIC X.                 ERCACCT
   821         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   822             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   823                 24  FILLER                PIC X(11).             ERCACCT
   824                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   825                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   826                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   827                 24  FILLER                PIC X(6).              ERCACCT
   828                                                                  ERCACCT
   829     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   830         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   831            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   832            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   833            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   834                                                                  ERCACCT
   835     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   836     12  FILLER                            PIC X(120).            ERCACCT
   837                                                                  ERCACCT
   838     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   839         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   840         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   841             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   842             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   843                                                          COMP-3. ERCACCT
   844             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   845                                                          COMP-3. ERCACCT
   846         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   847             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   848             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   849                                                          COMP-3. ERCACCT
   850             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   851                                                          COMP-3. ERCACCT
   852                                                                  ERCACCT
   853     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   854         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   855         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   856         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   857         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   858             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   859                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   860                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   861             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   862                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   863                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   864             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   865                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   866                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   867         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   868             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   869                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   870                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   871                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   872             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   873                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   874                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   875             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   876                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   877                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   878                                                                  ERCACCT
   879     12  AM-COMMENTS.                                             ERCACCT
   880         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   881                                                                  ERCACCT
   882     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   883         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   884         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   885         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   886         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   887         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   888             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   889             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   890             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   891             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   892         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   893             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   894             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   895             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   896         16  FILLER                        PIC X(102).            ERCACCT
   897                                                                  ERCACCT
   898     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   899         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   900             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   901             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   902             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   903             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   904             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   905         16  FILLER                          PIC X(10).           ERCACCT
   906******************************************************************ERCACCT
   907
   908 FD  ERPDEF.
   909
*  910                             COPY ERCPDEF.
   911******************************************************************
   912*                                                                *
   913*                                                                *
   914*                            ERCPDEF.                            *
   915*                                                                *
   916*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   917*                                                                *
   918*    FILE TYPE = VSAM,KSDS                                       *
   919*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   920*                                                                *
   921*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   922*                                                                *
   923*    LOG = YES                                                   *
   924*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   925******************************************************************
   926*                   C H A N G E   L O G
   927*
   928* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   929*-----------------------------------------------------------------
   930*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* FNB169.cbl (/apps/prod/cid1p/copy/ERCPDEF)
   931* EFFECTIVE    NUMBER
   932*-----------------------------------------------------------------
   933* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   934* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   935* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   936******************************************************************
   937 01  PRODUCT-MASTER.
   938    12  PD-RECORD-ID                 PIC X(02).
   939        88  VALID-PD-ID                  VALUE 'PD'.
   940
   941    12  PD-CONTROL-PRIMARY.
   942        16  PD-COMPANY-CD            PIC X.
   943        16  PD-STATE                 PIC XX.
   944        16  PD-PRODUCT-CD            PIC XXX.
   945        16  PD-FILLER                PIC X(7).
   946        16  PD-BEN-TYPE              PIC X.
   947        16  PD-BEN-CODE              PIC XX.
   948        16  PD-PROD-EXP-DT           PIC XX.
   949
   950    12  FILLER                       PIC X(50).
   951
   952    12  PD-PRODUCT-DATA OCCURS 8.
   953        16  PD-PROD-CODE             PIC X.
   954            88  PD-PROD-LIFE           VALUE 'L'.
   955            88  PD-PROD-PROP           VALUE 'P'.
   956            88  PD-PROD-AH             VALUE 'A'.
   957            88  PD-PROD-IU             VALUE 'I'.
   958            88  PD-PROD-GAP            VALUE 'G'.
   959            88  PD-PROD-FAML           VALUE 'F'.
   960        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   961        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   962        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   963        16  PD-MAX-TERM              PIC S999        COMP-3.
   964        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   965        16  FILLER                   PIC X.
   966        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   967        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   968        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   969        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   970        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   971        16  PD-REC-CRIT-PERIOD       PIC 99.
   972        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   973            20  PD-RECURRING-YN      PIC X.
   974            20  FILLER               PIC X.
   975        16  PD-RTW-MOS               PIC 99.
   976        16  PD-MAX-EXTENSION         PIC 99.
   977        16  pd-ben-pct               pic sv999 comp-3.
   978*       16  FILLER                   PIC XX.
   979
   980    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   981
   982    12  PD-TERM-LIMITS OCCURS 15.
   983        16  PD-LOW-TERM              PIC S999        COMP-3.
   984        16  PD-HI-TERM               PIC S999        COMP-3.
   985
   986*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   987    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   988        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* FNB169.cbl (/apps/prod/cid1p/copy/ERCPDEF)
   989        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   990
   991    12  PD-EARN-FACTORS.
   992        16  FILLER OCCURS 15.
   993            20  FILLER OCCURS 15.
   994                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   995
   996    12  PD-PRODUCT-DESC              PIC X(80).
   997    12  PD-TRUNCATED                 PIC X.
   998    12  FILLER                       PIC X(59).
   999
  1000    12  PD-MAINT-INFORMATION.
  1001        16  PD-LAST-MAINT-DT         PIC X(02).
  1002        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1003        16  PD-LAST-MAINT-BY         PIC X(04).
  1004
  1005 FD  DISK-DATE
* 1006     COPY ELCDTEFD.
  1007******************************************************************04/15/98
  1008*                                                                *ELCDTEFD
  1009*                                                                *ELCDTEFD
  1010*                            ELCDTEFD.                           *   LV002
  1011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1012*                            VMOD=2.007                          *   CL**2
  1013*                                                                *ELCDTEFD
  1014******************************************************************ELCDTEFD
  1015     BLOCK CONTAINS 0 RECORDS
  1016     RECORDING MODE F.                                            ELCDTEFD
  1017                                                                  ELCDTEFD
  1018 01  DATE-DISK.                                                   ELCDTEFD
  1019     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1020     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1021     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1022     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1023     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1024     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1025     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1026                                                                  ELCDTEFD
  1027 01  DATE-DISK-R.                                                 ELCDTEFD
  1028     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1029     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1030                                     PIC  X(32).                  ELCDTEFD
  1031                                                                  ELCDTEFD
  1032 01  DATE-DISK-T.                                                 ELCDTEFD
  1033     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1034     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1035                                     PIC  X(48).                  ELCDTEFD
  1036                                                                  ELCDTEFD
  1037 01  DATE-DISK-M.                                                 ELCDTEFD
  1038     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1039     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1040                                     PIC  X(48).                  ELCDTEFD
  1041                                                                  ELCDTEFD
  1042 01  DATE-DISK-P.                                                 ELCDTEFD
  1043     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1044     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1045     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1046     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1047         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1048                                     PIC  X.                      ELCDTEFD
  1049         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1050     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1051         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1052             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1053             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1054             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1055             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1056         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1057                                                                  ELCDTEFD
  1058 01  DATE-DISK-E.                                                 ELCDTEFD
  1059     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1060     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1061                                     PIC  X(4).                   ELCDTEFD
  1062                                                                  ELCDTEFD
  1063 01  DATE-DISK-C.                                                 ELCDTEFD
  1064     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1065     12  DD-CARR1-SECPAY-SW          PIC  X.
  1066     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1067     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1068     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1069     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1070     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1071     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1072     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1073     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1074     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1075     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1076     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1077     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1078     12  DD-CARR2-SECPAY-SW          PIC  X.
  1079     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1080                                                                  ELCDTEFD
  1081 01  DATE-DISK-OPT.                                               ELCDTEFD
  1082     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1083     12  DD-TLR-DATA.                                             ELCDTEFD
  1084         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1085                                     PIC  X(03).                  ELCDTEFD
  1086     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1087         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1088                                     PIC  X(06).                  ELCDTEFD
  1089     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1090         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1091                                     PIC  X(07).                  ELCDTEFD
  1092         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1093     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1094                                     PIC  X(96).                  ELCDTEFD
  1095******************************************************************ELCDTEFD
  1096
  1097
  1098 WORKING-STORAGE SECTION.
  1099
  1100 77  B-SUB                   PIC S9(4)   COMP.
  1101 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  1102 77  P1                      PIC S999 COMP-3 VALUE +0.
  1103 77  P2                      PIC S999 COMP-3 VALUE +0.
  1104 77  CNC-WK                  PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* FNB169.cbl
  1105 77  WS-MONTH                PIC S999     COMP-3 VALUE +0.
  1106 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  1107 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  1108 77  DD-IU-SW                    PIC X   VALUE ' '.
  1109     88  DD-IU-PRESENT                 VALUE 'Y'.
  1110 77  WS-FACT-CERT            PIC X(11) VALUE SPACES.
  1111 77  A-OW                        PIC S9(7)V99 COMP-3 VALUE +0.
  1112 77  W-FACTOR            PIC S9(09)V9(08) COMP-3 VALUE +0.
  1113 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  1114 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  1115 77  WS-DDF-TERM             PIC S999 COMP-3 VALUE +0.
  1116
  1117 01  WS-DCC-PRODUCT-CODE         PIC XXX  VALUE SPACES.
  1118 01  AGT-LEVEL                 COMP   PIC 9(04).
  1119 01  WS-CNC-FACT               COMP-3 PIC S9(03)V9(07) VALUE +0.
  1120 01  WS-LF-CNC-FACT            COMP-3 PIC S9(03)V9(07) VALUE +0.
  1121 01  WS-WORK-AMT               COMP-3 PIC S9(7)V99 VALUE +0.
  1122 01  WS-LF-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1123 01  WS-AH-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1124 01  TEST-DISP-FX-AMT PIC ZZZZZZZZ9.99.
  1125 01  TEST-DISP-L-PC PIC ZZ.ZZZZZ.
  1126 01  TEST-DISP-A-PC PIC ZZ.ZZZZZ.
  1127 01  FILLER.
  1128     05  WS-ZERO               COMP-3 PIC S9(03) VALUE +0.
  1129     05  WS-ABEND-MESSAGE             PIC X(80)  VALUE SPACES.
  1130     05  PGM-SUB               COMP   PIC S9(04) VALUE +310.
  1131     05  WS-RETURN-CODE        COMP-3 PIC S9(03) VALUE +0.
  1132
  1133     05  DETEXT-STATUS                PIC X(02)  VALUE '00'.
  1134         88  EOF-DETEXT                          VALUE '10'.
  1135
  1136     05  DATE-SW                      PIC X(01)  VALUE ' '.
  1137         88  VALID-DATE                          VALUE 'V'.
  1138
  1139     05  VALID-RECORD-SW              PIC X(01)  VALUE '0'.
  1140         88  VALID-RECORD                        VALUE '1'.
  1141
  1142     05  END-OF-SEARCH-SW             PIC X(01)  VALUE '0'.
  1143         88  END-OF-SEARCH                       VALUE '1'.
  1144
  1145     05  ERACCT-STATUS                PIC X(02)  VALUE '00'.
  1146     05  ERPDEF-FILE-STATUS           PIC XX     VALUE '00'.
  1147
  1148
  1149 01  max-pdef                    pic s9(5) comp-3 value +5000.
  1150 01  DCC-DDF-WORK-AREA.
  1151     05  F OCCURS 5000.
  1152         10  DD-STATE                 PIC XX.
  1153         10  DD-PRODUCT-CD            PIC XXX.
  1154         10  DD-FILLER                PIC X(7).
  1155         10  DD-BEN-TYPE              PIC X.
  1156         10  DD-BEN-CODE              PIC XX.
  1157         10  DD-PROD-EXP-DT           PIC XX.
  1158         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  1159         10  DD-PROD-DATA OCCURS 8.
  1160             15  DD-PROD-CODE         PIC X.
  1161         10  DD-EARN-FACTORS.
  1162             15  F OCCURS 15.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* FNB169.cbl
  1163                 20  F OCCURS 15.
  1164                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1165         10  DD-TRUNCATED             PIC X.
  1166
  1167 01  WS-EXTRACT-RECORD.
* 1168     COPY FNC022.
  1169     05  FX-COMMON-SECTION.                                       00010001
  1170         10  FX-SYSTEM             PIC X(10).                     00020001
  1171         10  FX-SOURCE-CODE        PIC X(6).                      00030001
  1172         10  FX-DIVISION           PIC X(2).                      00040001
  1173         10  FX-TRAN-TYPE          PIC X(2).                      00050001
  1174         10  FX-SUB-TYPE           PIC X(2).                      00060001
  1175         10  FX-CLM-RES            PIC X(2).                      00070001
  1176         10  FX-ANN-STMT           PIC X(3).                      00080001
  1177         10  FX-PLAN-CODE          PIC X(6).                      00090001
  1178         10  FX-FORM               PIC X(3).                      00091001
  1179         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
  1180         10  FX-POSTING-DATE       PIC X(8).                      00093001
  1181         10  FX-POLICY-NO          PIC X(10).                     00094001
  1182         10  FX-CITY               PIC X(30).                     00095002
  1183         10  FX-STATE              PIC X(2).                      00095102
  1184         10  FX-ZIP-CODE           PIC X(9).                      00096001
  1185         10  FX-LOC-CODE           PIC X.                         00096102
  1186         10  FX-FY-REN             PIC X.                         00097001
  1187         10  FX-AGENT-01           PIC X(9).                      00098001
  1188         10  FX-AGENT-50           PIC X(9).                      00099001
  1189         10  FX-COST-CENTER        PIC X(4).                      00100001
  1190         10  FX-TAXABLE            PIC X.                         00110004
  1191         10  FX-DISTR              PIC X(2).                      00120001
  1192         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
  1193         10  FX-DESCRIPTION        PIC X(30).                     00140001
  1194         10  FX-REFERENCE          PIC X(10).                     00150001
  1195         10  FX-SUSPENSE           PIC X(15).                     00151002
  1196         10  FX-AMOUNT             PIC S9(10)V99                  00160001
  1197                                   SIGN IS TRAILING SEPARATE.     00170001
  1198                                                                  00180001
  1199     05  FX-CLAIM-SECTION.                                        00190001
  1200         10  FX-CLAIM-NO           PIC X(10).                     00200001
  1201         10  FX-CLAIM-TYPE         PIC X.                         00210001
  1202         10  FX-DRAFT-NO           PIC X(10).                     00220001
  1203         10  FX-DRAFT-STATUS       PIC X.                         00230001
  1204         10  FX-TAX-ID             PIC X(10).                     00240001
  1205         10  FILLER                PIC X(10).                     00250003
  1206                                                                  00290001
  1207
  1208
  1209 01  FNX001-PARMS.
  1210     05  FNX001-DATA                  PIC X(50).
  1211     05  FNX001-CITY                  PIC X(30).
  1212     05  FNX001-STATE                 PIC X(02).
  1213     05  FNX001-ZIP                   PIC X(09).
  1214
  1215 01  SYSTEM-DATE.
  1216     05  SYS-MO                       PIC 9(02).
  1217     05  SYS-DA                       PIC 9(02).
  1218     05  SYS-CCYY                     PIC 9(04).
  1219
  1220***** FUNCTION-DATE COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* FNB169.cbl
* 1221 COPY ELCFUNDT.
  1222***************************************************************** 12/03/98
  1223*                                                               * ELCFUNDT
  1224*                            ELCFUNDT.                          *    LV004
  1225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1226*                            VMOD=2.001                         * ELCFUNDT
  1227*                                                               * ELCFUNDT
  1228*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  1229*                                                               * ELCFUNDT
  1230***************************************************************** ELCFUNDT
  1231                                                                  ELCFUNDT
  1232                                                                  ELCFUNDT
  1233 01  FUNCTION-DATE.                                                  CL**2
  1234     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  1235     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  1236         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  1237         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  1238             15  WS-FN-CC          PIC 99.                           CL**3
  1239             15  WS-FN-YR          PIC 99.                           CL**3
  1240         10  WS-FN-MO              PIC 99.                           CL**3
  1241         10  WS-FN-DA              PIC 99.                           CL**3
  1242     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  1243     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  1244     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  1245     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  1246     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  1247         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  1248         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  1249         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  1250     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  1251     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  1252
  1253
  1254***** STATE EDIT TABLE
* 1255 COPY FNC018.
  1256***************************************************************** 00020002
  1257*                                                               * 00030002
  1258*                     STATE CODE TABLE                          * 00040002
  1259*                                                               * 00050002
  1260*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
  1261*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
  1262*                                                               * 00080002
  1263***************************************************************** 00090002
  1264*                                                                 00100002
  1265 01  STATE-VALUES.                                                00110002
  1266     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
  1267     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
  1268     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
  1269     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
  1270     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
  1271     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
  1272     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
  1273     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
  1274     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
  1275     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
  1276     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
  1277     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
  1278     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* FNB169.cbl (/apps/prod/cid1p/copy/FNC018)
  1279     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
  1280     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
  1281     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
  1282     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
  1283     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
  1284     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
  1285     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
  1286     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
  1287     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
  1288     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
  1289     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
  1290     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
  1291     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
  1292     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
  1293     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
  1294     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
  1295     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
  1296     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
  1297     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
  1298     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
  1299     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
  1300     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
  1301     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
  1302     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
  1303     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
  1304     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
  1305     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
  1306     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
  1307     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
  1308     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
  1309     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
  1310     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
  1311     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
  1312     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
  1313     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
  1314     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
  1315     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
  1316     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
  1317     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
  1318     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
  1319     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
  1320     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
  1321     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
  1322     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
  1323     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
  1324     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
  1325     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
  1326                                                                  00720002
  1327 01  FILLER REDEFINES STATE-VALUES.                               00730002
  1328     05  STATE-TABLE                                              00740002
  1329             OCCURS 60 TIMES                                      00750002
  1330             ASCENDING KEY IS ST-STATE                            00760002
  1331             INDEXED BY ST-INDEX.                                 00770002
  1332         10  ST-STATE          PIC XX.                            00780002
  1333         10  ST-ALT-STATE      PIC XX.                            00790002
  1334         10  ST-NAME           PIC X(20).                         00800002
  1335                                                                  00810002
  1337
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* FNB169.cbl
* 1338 COPY ELCDTECX.
  1339******************************************************************06/05/98
  1340*                                                                *ELCDTECX
  1341*                            ELCDTECX.                           *   LV005
  1342*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1343*                            VMOD=2.015                          *ELCDTECX
  1344*                                                                *ELCDTECX
  1345*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1346*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1347*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1348*                                                                *ELCDTECX
  1349******************************************************************ELCDTECX
  1350******************************************************************
  1351*                   C H A N G E   L O G
  1352*
  1353* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1354*-----------------------------------------------------------------
  1355*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1356* EFFECTIVE    NUMBER
  1357*-----------------------------------------------------------------
  1358* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1359*                                  BENEFIT CODES FROM 300 TO 900
  1360* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1361* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1362* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1363******************************************************************
  1364 01  DATE-CARD.                                                   ELCDTECX
  1365     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1366     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1367     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1368     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1369     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1370     12  EP-SW                       PIC  X.                      ELCDTECX
  1371         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1372     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1373         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1374     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1375     12  RUN-CENTURY.                                             ELCDTECX
  1376         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1377     12  FILLER                      PIC  X.                         CL**4
  1378     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1379     12  FILLER                      PIC  XXX.                    ELCDTECX
  1380     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1381                                                                  ELCDTECX
  1382 01  FILLER                          PIC  X(7)                       CL**6
  1383                                          VALUE 'OPTIONS'.        ELCDTECX
  1384 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1385     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1386     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1387     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1388         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1389         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1390     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1391     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1392     12  FILLER                      PIC  X.                      ELCDTECX
  1393     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1394     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1395     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1396     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1397     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1398     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1399     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1400     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1401     12  FILLER                      PIC  X.                      ELCDTECX
  1402     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1403     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1404     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1405     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1406     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1407     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1408     12  FILLER                      PIC  X.                      ELCDTECX
  1409     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1410     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1411     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1412     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1413     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1414     12  DTE-R78                     PIC  X.                      ELCDTECX
  1415     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1416     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1417     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1418     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1419     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1420     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1421     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1422                                     PIC  X.                      ELCDTECX
  1423         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1424                                                 ' '.             ELCDTECX
  1425         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1426         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1427     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1428         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1429         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1430     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1431     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1432                                     PIC  9.                         CL**4
  1433     12  DTE-SYSTEM.                                              ELCDTECX
  1434         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1435         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1436         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1437         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1438         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1439         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1440         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1441         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1442         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1443         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1444         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1445         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1446         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1447         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1448         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1449         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1450         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1451         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1452         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1453         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1454         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1455         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1456         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1457         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1458         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1459         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1460     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1461         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1462                                     PIC  X.                      ELCDTECX
  1463     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1464                                                                  ELCDTECX
  1465 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1466     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1467     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1468     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1469*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1470     12  FILLER                      PIC  X.                      ELCDTECX
  1471     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1472     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1473     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1474     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1475     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1476     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1477     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1478                                                                  ELCDTECX
  1479     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1480     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1481     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1482     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1483                                                                  ELCDTECX
  1484     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1485     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1486     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1487     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1488                                                                  ELCDTECX
  1489     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1490     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1491                                                                  ELCDTECX
  1492     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1493     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1494                                                                  ELCDTECX
  1495     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1496                                                                  ELCDTECX
  1497 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1498     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1499     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1500     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1501     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1502     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1503     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1504     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1505                                                                  ELCDTECX
  1506 01  FILLER                          PIC  X(12)                   ELCDTECX
  1507                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1508 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1509     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1510         16  CNT-ID                  PIC  X.                      ELCDTECX
  1511         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1512                                                                  ELCDTECX
  1513 01  FILLER                          PIC  X(11)                   ELCDTECX
  1514                                          VALUE 'STATE NAMES'.    ELCDTECX
  1515 01  STATE-NAMES.                                                 ELCDTECX
  1516     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1517         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1518         16  STATE-PIC1.                                          ELCDTECX
  1519             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1520             20  FILLER              PIC  XXX.                    ELCDTECX
  1521             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1522             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1523             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1524             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1525                                                                  ELCDTECX
  1526 01  FILLER                          PIC  X(13)                   ELCDTECX
  1527                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1528 01  CARRIER-NAMES.                                               ELCDTECX
  1529     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1530         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1531         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1532         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1533         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1534         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1535         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1536*        16  FILLER                  PIC  X.                      ELCDTECX
  1537         16  CARRIER-SEC-PAY         PIC  X.
  1538             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1539                                                                  ELCDTECX
  1540 01  FILLER                          PIC  X(9)                       CL**6
  1541                                          VALUE 'INS TYPES'.      ELCDTECX
  1542 01  CLAS-INS-TYPES.                                              ELCDTECX
  1543*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1544     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1545         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1546         16  CLAS-I-AB3.                                          ELCDTECX
  1547             20  FILLER              PIC  X.                      ELCDTECX
  1548             20  CLAS-I-AB2.                                      ELCDTECX
  1549                 24  FILLER          PIC  X.                      ELCDTECX
  1550                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1551         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1552             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1553             20  FILLER              PIC  X.                         CL**4
  1554         16  CLAS-I-AB10.                                         ELCDTECX
  1555             20  FILLER              PIC  X(9).                   ELCDTECX
  1556             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1557         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1558         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1559         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1560         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1561             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1562         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1563         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1564         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1565         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1566         16  CLAS-I-REFUND-METHOD    PIC  X.
  1567         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1568         16  FILLER                  PIC  XXX.
  1569                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1570 01  FILLER                          PIC  X(16)                   ELCDTECX
  1571                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1572 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1573     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1574                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1575         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1576         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1577         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1578         16  CLAS-MORT-DESC.                                      ELCDTECX
  1579             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1580             20  FILLER              PIC  XX.                        CL**5
  1581             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1582             20  FILLER              PIC  X.                         CL**5
  1583             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1584             20  FILLER              PIC  X.                         CL**5
  1585             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1586             20  FILLER              PIC  X.                         CL**5
  1587             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1588             20  FILLER              PIC  X(5).                      CL**6
  1589                                                                  ELCDTECX
  1590 01  FILLER                          PIC  X(15)                   ELCDTECX
  1591                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1592 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1593     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1594         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1595         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1596         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1597         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1598         16  FILLER                  PIC  X(4).                      CL**6
  1599                                                                  ELCDTECX
  1600 01  FILLER                          PIC  X(7)                       CL**6
  1601                                     VALUE 'INDEXES'.             ELCDTECX
  1602 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1603     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1604     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1605     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1606     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1607     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1608     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1609     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1610     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1611     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1612     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1613     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1614     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1615     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1616     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1617     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1618     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1619     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1620                                                                  ELCDTECX
  1621 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1622     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1623     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1624     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1625     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1626     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1627     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1628     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1629     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1630     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1631     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1632     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1633                                                                  ELCDTECX
  1634 01  FILLER                          PIC  X(13)                   ELCDTECX
  1635                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1636 01  CLAS-MISC.                                                   ELCDTECX
  1637     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1638         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1639         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1640         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1641     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1642     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1643     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1644     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1645     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1646     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1647     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1648     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1649     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1650     12  STATE-L                     PIC  XX.                     ELCDTECX
  1651     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1652     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1653     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1654         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1655         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1656     12  DTE-ABEND-WORK.                                          ELCDTECX
  1657         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1658         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1659                                                                  ELCDTECX
  1660 01  FILLER                          PIC  X(12)                   ELCDTECX
  1661                                     VALUE 'WORKING DATE'.        ELCDTECX
  1662 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1663     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1664         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1665         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1666         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1667     12  WS-CURRENT-DATE.                                         ELCDTECX
  1668         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1669         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1670         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1671         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1672         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1673     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1674         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1675         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1676                                                                  ELCDTECX
  1677 01  FILLER                          PIC  X(12)                   ELCDTECX
  1678                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1679 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1680     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1681         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1682         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1683         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1684                                                                  ELCDTECX
  1685 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1686                                     VALUE 'STATE TLRS'.          ELCDTECX
  1687 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1688     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1689         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1690         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1691                                                                  ELCDTECX
  1692 01  FILLER                          PIC  X(13)                   ELCDTECX
  1693                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1694 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1695     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1696         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1697                                                                  ELCDTECX
  1698 01  FILLER                          PIC  X(13)                   ELCDTECX
  1699                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1700 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1701     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1702     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1703     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1704                                     PIC  X.                         CL**5
  1705     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1706     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1707     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1708     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1709     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1710     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1711     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1712     12  FILLER                      PIC  X(75).                  ELCDTECX
  1713******************************************************************ELCDTECX
  1714*01  MISC-CARR-PCT-DATA.                                          00001521
  1715*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1716*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1717*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1718*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1719*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1720*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1721******************************************************************ELCDTECX
* 1722 COPY ELCDTEVR.
  1723***************************************************************** 04/15/98
  1724*                                                                *ELCDTEVR
  1725*                                                                *ELCDTEVR
  1726*                            ELCDTEVR.                           *   LV003
  1727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1728*                            VMOD=2.001                          *   CL**2
  1729*                                                                *ELCDTEVR
  1730*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1731*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1732*                                                                *ELCDTEVR
  1733******************************************************************ELCDTEVR
  1734 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1735     05  WS-RUN-DATE.                                             ELCDTEVR
  1736         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1737         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1738         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1739             15  RUN-CC              PIC  99.                     ELCDTEVR
  1740             15  RUN-YR              PIC  99.                     ELCDTEVR
  1741         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1742         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1743     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1744            WS-RUN-DATE              PIC 9(11).                      CL**2
  1745     05  WS-EP-DT.                                                ELCDTEVR
  1746         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1747         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1748         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1749             15  EP-CC               PIC  99.                     ELCDTEVR
  1750             15  EP-YR               PIC  99.                     ELCDTEVR
  1751         10  EP-MO                   PIC  99.                     ELCDTEVR
  1752         10  EP-DA                   PIC  99.                     ELCDTEVR
  1753     05  WS-EP-DT-N REDEFINES                                        CL**2
  1754            WS-EP-DT                 PIC 9(11).                      CL**2
  1755     05  WS-DTE-CONV-DT.                                             CL**4
  1756         10  FILLER                  PIC  9(03).                     CL**4
  1757         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1758         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1759             15  DTE-CONV-CC         PIC  99.                        CL**4
  1760             15  DTE-CONV-YR         PIC  99.                        CL**4
  1761         10  DTE-CONV-MO             PIC  99.                        CL**4
  1762         10  DTE-CONV-DA             PIC  99.                        CL**4
  1763     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1764            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1765 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1766     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1767         10  FILLER                            PIC 999.           ELCDTEVR
  1768         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1769         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1770             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1771             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1772         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1773         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1774     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1775            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1776     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1777         10  FILLER                            PIC 999.           ELCDTEVR
  1778         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1779         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1780         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1781         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1782     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1783            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1784 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1785     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1786         10  FILLER                            PIC 999.           ELCDTEVR
  1787         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1788         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1789             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1790             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1791         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1792         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1793     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1794            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1795     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1796         10  FILLER                            PIC 999.           ELCDTEVR
  1797         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1798         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1799             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1800             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1801         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1802         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1803     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1804            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1805     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1806         10  FILLER                            PIC 999.           ELCDTEVR
  1807         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1808         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1809             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1810             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1811         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1812         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1813     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1814            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1815 01  WS-RATE-RECORD.                                              ELCDTEVR
  1816         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1817             10  FILLER                        PIC 999.           ELCDTEVR
  1818             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1819             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1820                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1821                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1822             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1823             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1824         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1825                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1826
  1827 LINKAGE SECTION.
  1828
  1829 01  PARM.
  1830     05  PARM-LENGTH                  PIC S9(04) COMP.
  1831     05  CYCLE-DATE                   PIC X(08).
  1832
  1833
  1834
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* FNB169.cbl
  1836
  1837 PROCEDURE DIVISION USING PARM.
  1838
  1839*************************************************************
* 1840 COPY ELCDTERX.
  1841******************************************************************04/15/98
  1842*                                                                *ELCDTERX
  1843*                                                                *ELCDTERX
  1844*                            ELCDTERX.                           *   LV002
  1845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1846*                            VMOD=2.007                          *ELCDTERX
  1847*                                                                *ELCDTERX
  1848*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1849*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1850*      = ELCDTEFD)                                               *ELCDTERX
  1851*                                                                *ELCDTERX
  1852******************************************************************ELCDTERX
  1853                                                                  ELCDTERX
  1854     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1855                                                                  ELCDTERX
  1856     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1857     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1858     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1859                                                                  ELCDTERX
  1860     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1861                                                                  ELCDTERX
  1862******************************************************************ELCDTERX
  1863*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1864*          WARNING MESSAGES.                                      ELCDTERX
  1865******************************************************************ELCDTERX
  1866     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1867         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1868                                                                  ELCDTERX
  1869     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1870                                                                  ELCDTERX
  1871     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1872                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1873                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1874                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1875                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1876                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1877                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1878                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1879                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1880                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1881                                                                  ELCDTERX
  1882     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1883                                                                  ELCDTERX
  1884     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1885                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1886                                                                  ELCDTERX
  1887     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1888     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1889     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1890     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1891                                                                  ELCDTERX
  1892     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1893         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1894     ELSE                                                         ELCDTERX
  1895         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1896                                                                  ELCDTERX
  1897     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1898         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1899     ELSE                                                         ELCDTERX
  1900         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1901                                                                  ELCDTERX
  1902 0005-READ--CARD.                                                 ELCDTERX
  1903     READ DISK-DATE                                               ELCDTERX
  1904         AT END CLOSE DISK-DATE                                   ELCDTERX
  1905             GO TO 0060-READ--TEST.                               ELCDTERX
  1906                                                                  ELCDTERX
  1907     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1908                                                                  ELCDTERX
  1909     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1910         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1911         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1912         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1913         GO TO 0005-READ--CARD.                                   ELCDTERX
  1914                                                                  ELCDTERX
  1915     IF DD-ID = 'CLAD'                                            ELCDTERX
  1916         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1917         GO TO 0005-READ--CARD.                                   ELCDTERX
  1918                                                                  ELCDTERX
  1919     IF DD-ID = 'CLAX'                                            ELCDTERX
  1920         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1921         GO TO 0005-READ--CARD.                                   ELCDTERX
  1922                                                                  ELCDTERX
  1923     IF DD-ID = 'CLAF'                                            ELCDTERX
  1924         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1925         GO TO 0005-READ--CARD.                                   ELCDTERX
  1926                                                                  ELCDTERX
  1927     IF DD-ID = 'CLAC'                                            ELCDTERX
  1928         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1929                                                                  ELCDTERX
  1930     IF DD-ID = 'CARR'                                            ELCDTERX
  1931         GO TO 0015-READ--CARR.                                   ELCDTERX
  1932                                                                  ELCDTERX
  1933     IF DD-ID = 'STAT'                                            ELCDTERX
  1934         GO TO 0020-READ--STAT.                                   ELCDTERX
  1935                                                                  ELCDTERX
  1936     IF DD-ID = 'BUSC'                                            ELCDTERX
  1937         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1938                                                                  ELCDTERX
  1939     IF DD-ID = 'MORT'                                            ELCDTERX
  1940         GO TO 0030-READ--MORT.                                   ELCDTERX
  1941                                                                  ELCDTERX
  1942     IF DD-ID = 'CLAI'                                            ELCDTERX
  1943         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1944                                                                  ELCDTERX
  1945     IF DD-ID = 'COLC'                                            ELCDTERX
  1946         GO TO 0065-READ--COLC.                                   ELCDTERX
  1947                                                                  ELCDTERX
  1948     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1949        DD-IDA = 'CL'                                             ELCDTERX
  1950         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1951                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1952     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1953        DD-IDA = 'PO'                                             ELCDTERX
  1954         GO TO 0050-READ--POXX.                                   ELCDTERX
  1955                                                                  ELCDTERX
  1956     IF DD-ID = 'OPCA'                                            ELCDTERX
  1957         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1958                                                                  ELCDTERX
  1959     IF DD-ID = 'OPST'                                            ELCDTERX
  1960         GO TO 0072-READ--OPST.                                   ELCDTERX
  1961                                                                  ELCDTERX
  1962     IF DD-ID = 'OPBS'                                            ELCDTERX
  1963         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1964                                                                  ELCDTERX
  1965     IF DD-ID = 'OPMS'                                            ELCDTERX
  1966         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1967                                                                  ELCDTERX
  1968     GO TO 0005-READ--CARD.                                       ELCDTERX
  1969                                                                  ELCDTERX
  1970 0010-READ--CLAC.                                                 ELCDTERX
  1971     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1972     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1973     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1974     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1975     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1976     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1977     GO TO 0005-READ--CARD.                                       ELCDTERX
  1978                                                                  ELCDTERX
  1979 0015-READ--CARR.                                                 ELCDTERX
  1980     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1981     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1982        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1983        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1984        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1985        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1986        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1987        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1988        MOVE DD-CARR1-SECPAY-SW
  1989                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1990     END-IF
  1991                                                                  ELCDTERX
  1992     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1993     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1994        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1995        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1996        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1997        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1998        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1999        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2000        MOVE DD-CARR2-SECPAY-SW
  2001                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2002     END-IF
  2003                                                                  ELCDTERX
  2004                                                                  ELCDTERX
  2005     GO TO 0005-READ--CARD.                                       ELCDTERX
  2006                                                                  ELCDTERX
  2007 0020-READ--STAT.                                                 ELCDTERX
  2008     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2009     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2010        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2011         GO TO 0005-READ--CARD.                                   ELCDTERX
  2012                                                                  ELCDTERX
  2013     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2014     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2015     GO TO 0020-READ--STAT.                                       ELCDTERX
  2016                                                                  ELCDTERX
  2017 0025-READ--BUSC.                                                 ELCDTERX
  2018     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2019     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2020        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2021         GO TO 0005-READ--CARD.                                   ELCDTERX
  2022                                                                  ELCDTERX
  2023     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2024     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2025     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2026                                                                  ELCDTERX
  2027 0030-READ--MORT.                                                 ELCDTERX
  2028     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2029     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2030        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2031         GO TO 0005-READ--CARD.                                   ELCDTERX
  2032                                                                  ELCDTERX
  2033     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2034     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2035     GO TO 0030-READ--MORT.                                       ELCDTERX
  2036                                                                  ELCDTERX
  2037 0035-READ--CLXX.                                                 ELCDTERX
  2038     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2039          GO TO 0005-READ--CARD.                                  ELCDTERX
  2040                                                                  ELCDTERX
  2041     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2042         DISPLAY '***********************************************'ELCDTERX
  2043         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2044         DISPLAY '***********************************************'ELCDTERX
  2045         GO TO 0055-READ--STOP.                                   ELCDTERX
  2046                                                                  ELCDTERX
  2047     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2048        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2049         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2050                                                                  ELCDTERX
  2051     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2052        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2053         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2054                                                                  ELCDTERX
  2055*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2056     GO TO 0005-READ--CARD.                                       ELCDTERX
  2057                                                                  ELCDTERX
  2058 0040-READ--CLAI.                                                 ELCDTERX
  2059     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2060     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2061        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2062         GO TO 0005-READ--CARD.                                   ELCDTERX
  2063                                                                  ELCDTERX
  2064     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2065     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2066     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2067                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2068 0045-READ--DUMP.                                                 ELCDTERX
  2069     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2070     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2071                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2072     PERFORM ABEND-PGM.                                           ELCDTERX
  2073                                                                  ELCDTERX
  2074 0050-READ--POXX.                                                 ELCDTERX
  2075     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2076         GO TO 0005-READ--CARD.                                   ELCDTERX
  2077                                                                  ELCDTERX
  2078     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2079         DISPLAY '***********************************************'ELCDTERX
  2080         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2081         DISPLAY '***********************************************'ELCDTERX
  2082         GO TO 0055-READ--STOP.                                   ELCDTERX
  2083                                                                  ELCDTERX
  2084     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2085     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2086     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2087     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2088                                                                  ELCDTERX
  2089     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2090         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2091     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2092         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2093                                                                  ELCDTERX
  2094     GO TO 0005-READ--CARD.                                       ELCDTERX
  2095                                                                  ELCDTERX
  2096 0055-READ--STOP.                                                 ELCDTERX
  2097     GOBACK.                                                      ELCDTERX
  2098                                                                  ELCDTERX
  2099 0060-READ--TEST.                                                 ELCDTERX
  2100     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2101        CLAX-ID         = SPACE  OR                               ELCDTERX
  2102        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2103         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2104                                                                  ELCDTERX
  2105     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2106     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2107                                                                  ELCDTERX
  2108 0065-READ--COLC.                                                 ELCDTERX
  2109     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2110     GO TO 0005-READ--CARD.                                       ELCDTERX
  2111                                                                  ELCDTERX
  2112 0070-READ--OPCA.                                                 ELCDTERX
  2113                                                                  ELCDTERX
  2114     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2115                                                                  ELCDTERX
  2116     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2117             OR                                                   ELCDTERX
  2118         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2119         GO TO 0005-READ--CARD.                                   ELCDTERX
  2120                                                                  ELCDTERX
  2121     ADD 1                       TO INDEXCA.                      ELCDTERX
  2122     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2123                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2124     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2125                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2126 0072-READ--OPST.                                                 ELCDTERX
  2127                                                                  ELCDTERX
  2128     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2129                                                                  ELCDTERX
  2130     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2131             OR                                                   ELCDTERX
  2132         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2133         GO TO 0005-READ--CARD.                                   ELCDTERX
  2134                                                                  ELCDTERX
  2135     ADD 1                       TO INDEXST.                      ELCDTERX
  2136     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2137                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2138     GO TO 0072-READ--OPST.                                       ELCDTERX
  2139                                                                  ELCDTERX
  2140 0074-READ--OPBS.                                                 ELCDTERX
  2141                                                                  ELCDTERX
  2142     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2143                                                                  ELCDTERX
  2144     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2145             OR                                                   ELCDTERX
  2146         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2147         GO TO 0005-READ--CARD.                                   ELCDTERX
  2148                                                                  ELCDTERX
  2149     ADD 1                       TO INDEXBS.                      ELCDTERX
  2150     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2151     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2152                                                                  ELCDTERX
  2153 0079-READ--EXIT.                                                 ELCDTERX
  2154*    EXIT.                                                        ELCDTERX
  2155******************************************************************ELCDTERX
  2156*************************************************************
  2157     PERFORM 0000-HOUSEKEEPING       THRU 0000-EXIT
  2158
  2159     PERFORM 1000-PROCESS            THRU 1000-EXIT
  2160         UNTIL EOF-DETEXT
  2161
  2162     CLOSE DETEXTR
  2163           FREEDOM-EXTRACT
  2164           CSI-FREEDOM-EXTRACT
  2165           CCC-FREEDOM-EXTRACT
  2166           ERACCT
  2167     GOBACK.
  2168
  2169
  2170 1000-PROCESS.
  2171
  2172     PERFORM 1100-GET-LOGIC-RECORD   THRU 1100-EXIT
  2173          WITH TEST AFTER
  2174              UNTIL VALID-RECORD OR EOF-DETEXT
  2175
  2176     IF EOF-DETEXT
  2177         GO TO 1000-EXIT
  2178     END-IF
  2179
  2180*    IF DE-ADDL-CLP = +0
  2181*        GO TO 1000-EXIT
  2182*    END-IF
  2183
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* FNB169.cbl
  2184     MOVE SPACES                     TO WS-EXTRACT-RECORD
  2185
  2186     MOVE 'LOGIC '                   TO FX-SOURCE-CODE
  2187     MOVE '11'                       TO FX-DIVISION
  2188     MOVE ' '                        TO FX-FY-REN
  2189
  2190     MOVE CYCLE-DATE                 TO FX-POSTING-DATE
  2191     MOVE DE-CERT                    TO FX-POLICY-NO
  2192
  2193     IF DE-CLP-STATE = SPACES
  2194        MOVE DE-STATE                TO DE-CLP-STATE
  2195     END-IF
  2196     MOVE DE-CLP-STATE               TO FX-STATE
  2197*    MOVE DE-STATE                   TO FX-STATE
  2198     MOVE 'Y'                        TO FX-LOC-CODE
  2199
  2200     PERFORM 1300-GET-ADDR           THRU 1300-EXIT
  2201
  2202*    DISPLAY ' CARRIER = ' DE-CARRIER
  2203*    MOVE '3'                    TO DE-CARRIER
  2204
  2205     IF DE-CARRIER = '3' OR '4'
  2206        MOVE 'CSIDCCFEES'        TO FX-SYSTEM
  2207     ELSE
  2208       IF DE-CARRIER = '5' OR '6' or '7'
  2209          MOVE 'CCCDCCFEES'      TO FX-SYSTEM
  2210          MOVE '50'              TO FX-DIVISION
  2211       ELSE
  2212        MOVE 'LPAC LOGIC'        TO FX-SYSTEM
  2213       END-IF
  2214     END-IF
  2215
  2216     MOVE DE-ACCT-PRIME              TO FX-AGENT-01
  2217     MOVE '6211'                     TO FX-COST-CENTER
  2218     MOVE ' '                        TO FX-DISTR
  2219     MOVE ' '                        TO FX-SOURCE-ACCT
  2220     MOVE ' '                        TO FX-REFERENCE
  2221
  2222     MOVE +1                         TO AGT-LEVEL
  2223
  2224
  2225     PERFORM UNTIL AGT-LEVEL > +10
  2226
  2227*    DISPLAY 'DE CERT ' DE-CERT
  2228*    DISPLAY 'AGT LEVEL ' AGT-LEVEL
  2229*    DISPLAY 'DE-AGT ' DE-AGT (AGT-LEVEL)
  2230*    DISPLAY 'DE-AGT-TYPE ' DE-AGT-TYPE (AGT-LEVEL)
  2231*    DISPLAY 'DE-TRAN ' DE-TRANS
  2232     MOVE DE-L-PC (AGT-LEVEL) TO TEST-DISP-L-PC
  2233*    DISPLAY 'DE-L-PC ' TEST-DISP-L-PC
  2234     MOVE DE-A-PC (AGT-LEVEL) TO TEST-DISP-A-PC
  2235*    DISPLAY 'DE-A-PC ' TEST-DISP-A-PC
  2236
  2237         EVALUATE DE-TRANS
  2238          WHEN 'I'
  2239            EVALUATE TRUE
  2240              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2241                MOVE 'ISSUE INCENTIVE'     TO FX-DESCRIPTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* FNB169.cbl
  2242                MOVE '01'                  TO FX-SUB-TYPE
  2243                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2244                                    * -1
  2245                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2246                MOVE '70'                  TO FX-TRAN-TYPE
  2247                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2248                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2249                MOVE '90'                  TO FX-TRAN-TYPE
  2250                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2251
  2252              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2253                MOVE 'ISSUE LMBA FEE'      TO FX-DESCRIPTION
  2254                MOVE '01'                  TO FX-SUB-TYPE
  2255                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2256                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2257                                    * -1
  2258                ELSE
  2259                   COMPUTE WS-LF-WORK ROUNDED = DE-REI-LFPRM *
  2260                      DE-L-PC (AGT-LEVEL)
  2261                   COMPUTE WS-AH-WORK ROUNDED = DE-REI-AHPRM *
  2262                      DE-A-PC (AGT-LEVEL)
  2263                   COMPUTE FX-AMOUNT ROUNDED = (WS-LF-WORK +
  2264                      WS-AH-WORK) * -1
  2265                END-IF
  2266                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2267                MOVE '75'                  TO FX-TRAN-TYPE
  2268                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2269                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2270                MOVE '95'                  TO FX-TRAN-TYPE
  2271                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2272
  2273              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2274                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2275                MOVE 'ISSUE CONTRACT FEE'  TO FX-DESCRIPTION
  2276                MOVE '01'                  TO FX-SUB-TYPE
  2277                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2278                                    * -1
  2279                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2280                MOVE '72'                  TO FX-TRAN-TYPE
  2281                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2282                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2283                MOVE '92'                  TO FX-TRAN-TYPE
  2284                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2285
  2286              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2287                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2288                MOVE 'ISSUE CSO ADMIN FEE'  TO FX-DESCRIPTION
  2289                MOVE '01'                  TO FX-SUB-TYPE
  2290                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2291                                    * -1
  2292                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2293                MOVE '77'                  TO FX-TRAN-TYPE
  2294                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2295                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2296                MOVE '97'                  TO FX-TRAN-TYPE
  2297                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2298              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'S')
  2299                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* FNB169.cbl
  2300                MOVE 'ISSUE CSO ADMIN FEE'  TO FX-DESCRIPTION
  2301                MOVE '01'                  TO FX-SUB-TYPE
  2302                COMPUTE FX-AMOUNT rounded =
  2303                   DE-A-PC (AGT-LEVEL) * de-ah-prm * -1
  2304                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2305                MOVE '77'                  TO FX-TRAN-TYPE
  2306                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2307                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2308                MOVE '97'                  TO FX-TRAN-TYPE
  2309                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2310            END-EVALUATE
  2311          WHEN '8'
  2312            EVALUATE TRUE
  2313              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2314                MOVE 'ISSUE RC-L INCENTIVE'
  2315                                           TO FX-DESCRIPTION
  2316                MOVE '01'                  TO FX-SUB-TYPE
  2317                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2318                                    * -1
  2319                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2320                MOVE '70'                  TO FX-TRAN-TYPE
  2321                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2322                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2323                MOVE '90'                  TO FX-TRAN-TYPE
  2324                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2325
  2326              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2327                MOVE 'ISSUE RC-L LMBA FEE' TO FX-DESCRIPTION
  2328                MOVE '01'                  TO FX-SUB-TYPE
  2329                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2330                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2331                                    * -1
  2332                ELSE
  2333                   COMPUTE FX-AMOUNT ROUNDED = ((DE-REI-LFPRM
  2334                      * DE-L-PC (AGT-LEVEL)) + (DE-REI-AHPRM
  2335                      * DE-A-PC (AGT-LEVEL))) * -1
  2336                END-IF
  2337                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2338                MOVE '75'                  TO FX-TRAN-TYPE
  2339                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2340                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2341                MOVE '95'                  TO FX-TRAN-TYPE
  2342                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2343
  2344              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2345                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2346                MOVE 'ISSUE RC-L CONTRACT FEE'
  2347                                           TO FX-DESCRIPTION
  2348                MOVE '01'                  TO FX-SUB-TYPE
  2349                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2350                                    * -1
  2351                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2352                MOVE '72'                  TO FX-TRAN-TYPE
  2353                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2354                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2355                MOVE '92'                  TO FX-TRAN-TYPE
  2356                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2357
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* FNB169.cbl
  2358            END-EVALUATE
  2359          WHEN 'C'
  2360            EVALUATE TRUE
  2361              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I'
  2362                MOVE 'CANCEL MGT FEE  '    TO FX-DESCRIPTION
  2363                MOVE '01'                  TO FX-SUB-TYPE
  2364                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2365                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2366                move cnc-wk to fx-amount
  2367                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2368                MOVE '70'                  TO FX-TRAN-TYPE
  2369                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2370                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2371                MOVE '90'                  TO FX-TRAN-TYPE
  2372                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2373              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'J'
  2374                MOVE 'CANCEL SLS MKT  '    TO FX-DESCRIPTION
  2375                MOVE '01'                  TO FX-SUB-TYPE
  2376                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2377                IF DE-CANCEL-REASON = 'R'
  2378                   MOVE +1      TO WS-CNC-FACT
  2379                END-IF
  2380                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2381                                    * WS-CNC-FACT
  2382                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2383                MOVE '70'                  TO FX-TRAN-TYPE
  2384                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2385                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2386                MOVE '90'                  TO FX-TRAN-TYPE
  2387                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2388
  2389              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2390                MOVE 'CANCEL LMBA FEE'     TO FX-DESCRIPTION
  2391                MOVE '01'                  TO FX-SUB-TYPE
  2392                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2393                   IF DE-AH-PRM NOT = ZEROS
  2394                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2395                         DE-AH-PRM
  2396                      IF DE-CANCEL-REASON = 'R'
  2397                         MOVE +1 TO WS-CNC-FACT
  2398                      END-IF
  2399                      COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL)
  2400                         * 1000 * WS-CNC-FACT
  2401                   END-IF
  2402                ELSE
  2403                   MOVE ZEROS   TO WS-WORK-AMT
  2404                   IF DE-LF-PRM NOT = ZEROS
  2405                      COMPUTE WS-CNC-FACT ROUNDED = DE-LF-RFND /
  2406                         DE-LF-PRM
  2407                      COMPUTE WS-WORK-AMT ROUNDED =
  2408                        (DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2409                          * WS-CNC-FACT
  2410                   END-IF
  2411                   IF DE-AH-PRM NOT = ZEROS
  2412                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2413                         DE-AH-PRM
  2414                      COMPUTE WS-WORK-AMT ROUNDED = WS-WORK-AMT +
  2415                     ((DE-A-PC (AGT-LEVEL) * DE-REI-AHPRM)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* FNB169.cbl
  2416                        * WS-CNC-FACT)
  2417                   END-IF
  2418                   MOVE WS-WORK-AMT TO FX-AMOUNT
  2419                END-IF
  2420                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2421                MOVE '75'                  TO FX-TRAN-TYPE
  2422                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2423                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2424                MOVE '95'                  TO FX-TRAN-TYPE
  2425                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2426
  2427              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2428                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2429                MOVE 'CANCEL CONTRACT FEE' TO FX-DESCRIPTION
  2430                MOVE '01'                  TO FX-SUB-TYPE
  2431                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2432                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2433                                    * WS-CNC-FACT
  2434                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2435                MOVE '72'                  TO FX-TRAN-TYPE
  2436                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2437                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2438                MOVE '92'                  TO FX-TRAN-TYPE
  2439                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2440
  2441              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2442                AND (DE-A-PC (AGT-LEVEL) NOT = ZEROS)
  2443                MOVE 'CANCEL CSO ADMIN FEE' TO FX-DESCRIPTION
  2444                MOVE '01'                  TO FX-SUB-TYPE
  2445
  2446                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2447                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2448
  2449                MOVE CNC-WK      TO FX-AMOUNT
  2450                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2451                MOVE '77'                  TO FX-TRAN-TYPE
  2452                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2453                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2454                MOVE '97'                  TO FX-TRAN-TYPE
  2455                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2456
  2457              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'S')
  2458                AND (DE-A-PC (AGT-LEVEL) NOT = ZEROS)
  2459                MOVE 'CANCEL CSO ADMIN FEE' TO FX-DESCRIPTION
  2460                MOVE '01'                  TO FX-SUB-TYPE
  2461
  2462                COMPUTE fx-amount =
  2463                   DE-A-PC (AGT-LEVEL) * de-ah-rfnd
  2464                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2465                MOVE '77'                  TO FX-TRAN-TYPE
  2466                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2467                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2468                MOVE '97'                  TO FX-TRAN-TYPE
  2469                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2470
  2471            END-EVALUATE
  2472          WHEN '7'
  2473            EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  45
* FNB169.cbl
  2474              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2475                MOVE 'CANCEL RC-L INCENTIVE'
  2476                                           TO FX-DESCRIPTION
  2477                MOVE '01'                  TO FX-SUB-TYPE
  2478                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2479                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2480                                    * WS-CNC-FACT
  2481                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2482                MOVE '70'                  TO FX-TRAN-TYPE
  2483                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2484                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2485                MOVE '90'                  TO FX-TRAN-TYPE
  2486                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2487
  2488              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2489                MOVE 'CANCEL RC-L LMBA FEE'
  2490                                           TO FX-DESCRIPTION
  2491                MOVE '01'                  TO FX-SUB-TYPE
  2492                IF DE-AH-PRM NOT = ZEROS
  2493                   COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2494                ELSE
  2495                   MOVE ZEROS   TO WS-CNC-FACT
  2496                END-IF
  2497                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2498                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2499                                    * WS-CNC-FACT
  2500                ELSE
  2501                   COMPUTE WS-WORK-AMT = (DE-A-PC (AGT-LEVEL) *
  2502                      DE-REI-AHPRM)  * WS-CNC-FACT
  2503                   IF DE-LF-PRM NOT = ZEROS
  2504                      COMPUTE WS-LF-CNC-FACT = DE-LF-RFND /
  2505                         DE-LF-PRM
  2506                      COMPUTE FX-AMOUNT ROUNDED = WS-WORK-AMT +
  2507                       ((DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2508                          * WS-LF-CNC-FACT)
  2509                   END-IF
  2510                END-IF
  2511                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2512                MOVE '75'                  TO FX-TRAN-TYPE
  2513                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2514                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2515                MOVE '95'                  TO FX-TRAN-TYPE
  2516                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2517
  2518              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2519                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2520                MOVE 'CANCEL RC-L CONTRACT FEE'
  2521                                           TO FX-DESCRIPTION
  2522                MOVE '01'                  TO FX-SUB-TYPE
  2523                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2524                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2525                                    * WS-CNC-FACT
  2526                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2527                MOVE '72'                  TO FX-TRAN-TYPE
  2528                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2529                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2530                MOVE '92'                  TO FX-TRAN-TYPE
  2531                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  46
* FNB169.cbl
  2532            END-EVALUATE
  2533         END-EVALUATE
  2534         MOVE FX-AMOUNT TO TEST-DISP-FX-AMT
  2535*        DISPLAY 'FX AMT ' TEST-DISP-FX-AMT
  2536*        DISPLAY ' '
  2537
  2538         ADD +1                      TO AGT-LEVEL
  2539     END-PERFORM
  2540
  2541     .
  2542 1000-EXIT.
  2543     EXIT.
  2544
  2545 1010-WRITE-EXTRACT.
  2546
  2547     IF DE-CARRIER = '3' OR '4'
  2548        WRITE CSI-EXTRACT-RECORD
  2549                     FROM WS-EXTRACT-RECORD
  2550     ELSE
  2551       IF DE-CARRIER = '5' OR '6' or '7'
  2552          WRITE CCC-EXTRACT-RECORD FROM
  2553                WS-EXTRACT-RECORD
  2554       ELSE
  2555        WRITE EXTRACT-RECORD
  2556                     FROM WS-EXTRACT-RECORD
  2557       END-IF
  2558     END-IF
  2559
  2560     .
  2561 1010-EXIT.
  2562     EXIT.
  2563
  2564 1100-GET-LOGIC-RECORD.
  2565
  2566     MOVE '0'                        TO VALID-RECORD-SW
  2567     READ DETEXTR
  2568         AT END GO TO 1100-EXIT
  2569     END-READ
  2570
  2571     IF DE-REIN NOT = SPACE
  2572         GO TO 1100-EXIT
  2573     END-IF
  2574
  2575     IF DE-TRANS = 'I' OR 'C' OR '7' OR '8'
  2576         CONTINUE
  2577     ELSE
  2578         GO TO 1100-EXIT
  2579     END-IF
  2580
  2581     IF DE-ENTRY-STATUS = 'M'
  2582        GO TO 1100-EXIT
  2583     END-IF
  2584
  2585     IF (DE-TRANS = 'I' OR '8')
  2586       AND (DE-ENTRY-STATUS = '3' OR '5')
  2587         GO TO 1100-EXIT
  2588     END-IF
  2589
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  47
* FNB169.cbl
  2590     IF (DE-LF-TYPE = ZERO)  AND
  2591        (DE-AH-TYPE = ZERO)
  2592           GO TO 1100-EXIT
  2593     END-IF
  2594
  2595     SET VALID-RECORD TO TRUE
  2596
  2597     .
  2598 1100-EXIT.
  2599     EXIT.
  2600
  2601
  2602 1300-GET-ADDR.
  2603
  2604     MOVE DE-COMPANY-CD          TO AM-COMPANY-CD
  2605     MOVE DE-CNTRL1              TO AM-CNTRL-1
  2606     MOVE DE-EFF                 TO AM-EXPIRE-DT
  2607
  2608     START ERACCT KEY >= AM-CONTROL-PRIMARY
  2609
  2610     IF ERACCT-STATUS NOT = '00'
  2611         DISPLAY 'ERROR ON ERACCT START ' ERACCT-STATUS
  2612         GO TO 1300-EXIT
  2613     END-IF
  2614
  2615     MOVE '0' TO END-OF-SEARCH-SW
  2616     MOVE ' '                    TO WS-DCC-PRODUCT-CODE
  2617
  2618     PERFORM UNTIL END-OF-SEARCH
  2619        READ ERACCT NEXT
  2620
  2621        IF ERACCT-STATUS = '00'
  2622           IF (AM-COMPANY-CD = DE-COMPANY-CD)
  2623              AND (AM-CNTRL-1 = DE-CNTRL1)
  2624              MOVE SPACES        TO FX-CITY
  2625              STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  2626                DELIMITED BY '  ' INTO FX-CITY
  2627              END-STRING
  2628              MOVE AM-ZIP        TO FX-ZIP-CODE
  2629              IF (DE-EFF >= AM-EFFECT-DT)
  2630                 AND (DE-EFF < AM-EXPIRE-DT)
  2631                 MOVE AM-DCC-PRODUCT-CODE
  2632                                 TO WS-DCC-PRODUCT-CODE
  2633              END-IF
  2634           ELSE
  2635              SET END-OF-SEARCH  TO TRUE
  2636           END-IF
  2637        ELSE
  2638           DISPLAY 'ERACCT READ NEXT STATUS ' ERACCT-STATUS
  2639           SET END-OF-SEARCH     TO TRUE
  2640        END-IF
  2641     END-PERFORM
  2642
  2643     MOVE FX-CITY                    TO FNX001-DATA
  2644     CALL 'FNX001' USING FNX001-PARMS
  2645     MOVE FNX001-CITY                TO FX-CITY
  2646
  2647     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  48
* FNB169.cbl
  2648 1300-EXIT.
  2649     EXIT.
  2650
  2651
  2652 1400-OTHER-FX-DATA.
  2653
  2654     IF FX-STATE NOT= SPACES
  2655         SEARCH ALL STATE-TABLE
  2656             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  2657             WHEN ST-STATE (ST-INDEX) = FX-STATE
  2658                 MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  2659         END-SEARCH
  2660     END-IF
  2661
  2662     MOVE SYSTEM-DATE                TO FX-JOURNAL-DATE
  2663
  2664**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  2665**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  2666     MOVE '*'                        TO WS-EXTRACT-RECORD(250:1)
  2667
  2668     .
  2669 1400-EXIT.
  2670     EXIT.
  2671
  2672 2520-REF-CSO-ADMIN-FEE.
  2673
  2674     IF DE-CERT-NO = WS-FACT-CERT
  2675        CONTINUE
  2676     ELSE
  2677        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2678     END-IF
  2679
  2680     MOVE ZEROS                  TO CNC-WK
  2681
  2682     EVALUATE TRUE
  2683        WHEN (DE-DCC-DDF-REM-TRM3 = 0)
  2684           OR (DE-CANCEL-REASON = 'R')
  2685           DISPLAY ' REM TERM = 0 OR REPO'
  2686           MOVE 0                TO CNC-WK
  2687
  2688        when de-ah-rfnd = de-ah-prm
  2689           display ' full refund '
  2690           move a-ow             to cnc-wk
  2691        WHEN DE-DCC-DDF-REM-TRM3 = DE-AH-TERM
  2692           DISPLAY ' REM TERM  = ORIG TERM '
  2693           MOVE A-OW             TO CNC-WK
  2694
  2695        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4
  2696           DISPLAY ' ORIG TERM - REM TRM < 4 '
  2697           COMPUTE W-FACTOR ROUNDED = A-OW -
  2698              (DD-1ST-YR-ALLOW (D1)
  2699              * WS-MONTH / 3) - (A-OW - DD-1ST-YR-ALLOW (D1))
  2700              * (1 - WS-HI-UEF) * WS-MONTH / 12
  2701           COMPUTE CNC-WK = W-FACTOR * 1
  2702
  2703**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
  2704
  2705        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  49
* FNB169.cbl
  2706           DISPLAY ' ORIG TERM - REM TRM < 13 '
  2707           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2708              DD-1ST-YR-ALLOW (D1))
  2709              - (a-ow - DD-1ST-YR-ALLOW (D1))
  2710              * (1 - WS-hi-UEF) * ws-MONTH / 12
  2711           COMPUTE CNC-WK = W-FACTOR * 1
  2712
  2713****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
  2714
  2715        WHEN OTHER
  2716           DISPLAY ' OTHER '
  2717           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2718              DD-1ST-YR-ALLOW (D1))
  2719              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
  2720              * ws-MONTH / 12)
  2721           COMPUTE CNC-WK = W-FACTOR * 1
  2722     END-EVALUATE
  2723
  2724     .
  2725 2520-EXIT.
  2726     EXIT.
  2727
  2728 2530-CALC-DDF-FEES.
  2729
  2730*****   THIS PARA IS ONLY FOR COMM TYPES N AND I
  2731*****   DCC DDF REFUNDS ONLY
  2732
  2733     IF DE-CERT-NO = WS-FACT-CERT
  2734        CONTINUE
  2735     ELSE
  2736        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2737     END-IF
  2738
  2739     COMPUTE WS-MONTH =
  2740        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2741     IF WS-MONTH = 0
  2742        MOVE 12 TO WS-MONTH
  2743     END-IF
  2744     DISPLAY ' WS MONTH ' WS-MONTH
  2745
  2746     EVALUATE TRUE
  2747        WHEN DE-AGT-TYPE (AGT-LEVEL) = 'N'
  2748           PERFORM 2520-REF-CSO-ADMIN-FEE
  2749                                 THRU 2520-EXIT
  2750        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2751           AND (DE-CANCEL-REASON = 'R')
  2752              MOVE A-OW TO CNC-WK
  2753        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2754           EVALUATE TRUE
  2755              WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2756                 OR (NOT DD-IU-PRESENT)
  2757                 COMPUTE WS-CNC-FACT = DE-REI-AHRFND /
  2758                   DE-REI-AHPRM
  2759                 COMPUTE CNC-WK ROUNDED = WS-CNC-FACT * A-OW
  2760               WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13)
  2761                  AND (DD-IU-PRESENT)
  2762                  COMPUTE WS-CLP-MO3 = DE-REI-AHPRM -
  2763                     (DE-REI-AHPRM -
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  50
* FNB169.cbl
  2764                     DE-IU-RATE-UP) * (WS-HI-UEF -
  2765                     WS-LO-UEF) * 3 / 12
  2766                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2767                  COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2768                  COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT
  2769                   * A-OW
  2770                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
  2771                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2772                    A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2773              WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2774                 COMPUTE CNC-WK = A-OW *
  2775                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
  2776                    WS-MONTH / 12)
  2777           END-EVALUATE
  2778           DISPLAY ' CSO REF MGT FEE ' DE-CERT-NO ' ' CNC-WK
  2779     END-EVALUATE
  2780
  2781     .
  2782 2530-EXIT.
  2783     EXIT.
  2784
  2785 2540-CALC-DDF-COMM.
  2786
  2787     IF DE-CERT-NO = WS-FACT-CERT
  2788        DISPLAY ' FACTORS ALREADY BUILT IN 2540 ' DE-CERT-NO
  2789     ELSE
  2790        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2791     END-IF
  2792
  2793     COMPUTE WS-MONTH =
  2794        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2795     IF WS-MONTH = 0
  2796        MOVE 12 TO WS-MONTH
  2797     END-IF
  2798     DISPLAY ' WS MONTH ' WS-MONTH
  2799
  2800     EVALUATE TRUE
  2801        WHEN DE-CANCEL-REASON = 'R'
  2802           MOVE A-OW             TO CNC-WK
  2803        WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2804           OR (NOT DD-IU-PRESENT)
  2805              COMPUTE WS-CNC-FACT = DE-REI-AHRFND / DE-REI-AHPRM
  2806              COMPUTE CNC-WK = WS-CNC-FACT * A-OW
  2807        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2808            COMPUTE WS-CLP-MO3 = DE-REI-AHPRM - (DE-REI-AHPRM -
  2809               DE-IU-RATE-UP) * (WS-HI-UEF -
  2810               WS-LO-UEF) * 3 / 12
  2811            DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2812            COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2813            COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT * A-OW
  2814            DISPLAY ' UECOMMO3 ' WS-COMM-MO3
  2815            COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2816              A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2817        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2818           COMPUTE CNC-WK = a-ow * (WS-HI-UEF - (WS-HI-UEF -
  2819              WS-LO-UEF) * ws-MONTH / 12)
  2820     END-EVALUATE
  2821
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  51
* FNB169.cbl
  2822     DISPLAY ' CSO REF comm    ' DE-CERT-NO ' ' CNC-WK
  2823
  2824     .
  2825 2540-EXIT.
  2826     EXIT.
  2827
  2828 2550-GET-DDF-FACTORS.
  2829
  2830     MOVE ZEROS                  TO CNC-WK
  2831                                    WS-LO-UEF WS-HI-UEF
  2832     move ' '                    to dd-iu-sw
  2833     if de-clp-state = spaces
  2834        move de-state            to de-clp-state
  2835     end-if
  2836
  2837     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
  2838        ((DE-clp-STATE = DD-STATE (D1))
  2839        and (WS-DCC-PRODUCT-CODE = dd-product-cd (d1))
  2840*       AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
  2841        AND ('A'           = DD-BEN-TYPE   (D1))
  2842        AND (DE-AH-TYPE    = DD-BEN-CODE   (D1))
  2843        AND (DE-EFF        < DD-PROD-EXP-DT (D1)))
  2844                        OR
  2845        D1 > max-pdef
  2846     END-PERFORM
  2847     IF D1 > max-pdef
  2848        DISPLAY ' COULD NOT FIND UEP FACTORS '
  2849        GO TO 2550-EXIT
  2850     END-IF
  2851
  2852     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  2853        (P1 > +8)
  2854        OR (DD-PROD-CODE (D1 P1) = 'I')
  2855     END-PERFORM
  2856     IF P1 < +9
  2857        display ' setting iu present to true '
  2858        SET DD-IU-PRESENT        TO TRUE
  2859     END-IF
  2860
  2861     MOVE DE-AH-TERM             TO WS-DDF-TERM
  2862
  2863     IF (DE-LOAN-TERM > WS-DDF-TERM)
  2864        AND (DD-TRUNCATED (D1) = 'Y')
  2865        MOVE DE-LOAN-TERM        TO WS-DDF-TERM
  2866        DISPLAY ' FOUND TRUNCATED ' DE-CERT-NO
  2867     END-IF
  2868
  2869     EVALUATE TRUE
  2870        WHEN WS-DDF-TERM > +168
  2871           MOVE 15               TO P1
  2872        WHEN WS-DDF-TERM > +156
  2873           MOVE 14               TO P1
  2874        WHEN WS-DDF-TERM > +144
  2875           MOVE 13               TO P1
  2876        WHEN WS-DDF-TERM > +132
  2877           MOVE 12               TO P1
  2878        WHEN WS-DDF-TERM > +120
  2879           MOVE 11               TO P1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  52
* FNB169.cbl
  2880        WHEN WS-DDF-TERM > +108
  2881           MOVE 10               TO P1
  2882        WHEN WS-DDF-TERM > +96
  2883           MOVE 9                TO P1
  2884        WHEN WS-DDF-TERM > +84
  2885           MOVE 8                TO P1
  2886        WHEN WS-DDF-TERM > +72
  2887           MOVE 7                TO P1
  2888        WHEN WS-DDF-TERM > +60
  2889           MOVE 6                TO P1
  2890        WHEN WS-DDF-TERM > +48
  2891           MOVE 5                TO P1
  2892        WHEN WS-DDF-TERM > +36
  2893           MOVE 4                TO P1
  2894        WHEN WS-DDF-TERM > +24
  2895           MOVE 3                TO P1
  2896        WHEN WS-DDF-TERM > +12
  2897           MOVE 2                TO P1
  2898        WHEN OTHER
  2899           MOVE 1                TO P1
  2900     END-EVALUATE
  2901
  2902     EVALUATE TRUE
  2903*       WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13)
  2904*          and (dd-iu-present)
  2905*          MOVE 2                TO P2
  2906*       WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13
  2907*          MOVE 1                TO P2
  2908        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +25
  2909           MOVE 2                TO P2
  2910        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +37
  2911           MOVE 3                TO P2
  2912        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +49
  2913           MOVE 4                TO P2
  2914        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +61
  2915           MOVE 5                TO P2
  2916        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +73
  2917           MOVE 6                TO P2
  2918        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +85
  2919           MOVE 7                TO P2
  2920        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +97
  2921           MOVE 8                TO P2
  2922        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +109
  2923           MOVE 9                TO P2
  2924        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +121
  2925           MOVE 10               TO P2
  2926        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +133
  2927           MOVE 11               TO P2
  2928        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +145
  2929           MOVE 12               TO P2
  2930        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +157
  2931           MOVE 13               TO P2
  2932        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +169
  2933           MOVE 14               TO P2
  2934        WHEN OTHER
  2935           MOVE 15               TO P2
  2936     END-EVALUATE
  2937
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  53
* FNB169.cbl
  2938     MOVE DE-CERT-NO             TO WS-FACT-CERT
  2939     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
  2940                                 TO WS-LO-UEF
  2941     MOVE DD-UEP-FACTOR (D1 P1 P2)
  2942                                 TO WS-HI-UEF
  2943
  2944     .
  2945 2550-EXIT.
  2946     EXIT.
  2947
  2948 0000-HOUSEKEEPING.
  2949
  2950     CALL 'DATEEDIT' USING CYCLE-DATE,  DATE-SW
  2951     IF NOT VALID-DATE
  2952         DISPLAY 'INVALID DATE PARAMETER: ' CYCLE-DATE
  2953         PERFORM ABEND-PGM           THRU ABEND-EXIT
  2954     END-IF
  2955
  2956     MOVE FUNCTION CURRENT-DATE      TO FUNCTION-DATE
  2957     MOVE WS-FN-MO                   TO SYS-MO
  2958     MOVE WS-FN-DA                   TO SYS-DA
  2959     MOVE WS-FN-CCYR                 TO SYS-CCYY
  2960
  2961     OPEN INPUT  ERACCT ERPDEF
  2962                 DETEXTR
  2963          OUTPUT FREEDOM-EXTRACT CSI-FREEDOM-EXTRACT
  2964                 CCC-FREEDOM-EXTRACT
  2965
  2966     IF ERACCT-STATUS = '00' OR '97'
  2967         CONTINUE
  2968     ELSE
  2969         DISPLAY 'OPEN ERROR ' ERACCT-STATUS ' ON ERACCT'
  2970     END-IF
  2971
  2972     IF ERPDEF-FILE-STATUS = '00' OR '97'
  2973         CONTINUE
  2974     ELSE
  2975         DISPLAY 'OPEN ERROR ' ERPDEF-FILE-STATUS ' ON ERPDEF'
  2976     END-IF
  2977
  2978     IF DTE-CLIENT = 'DCC'
  2979        MOVE 0 TO B-SUB
  2980        MOVE DTE-CLASIC-COMPANY-CD
  2981                                 TO PD-CONTROL-PRIMARY
  2982        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  2983        IF ERPDEF-FILE-STATUS = '00'
  2984           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  2985              READ ERPDEF NEXT RECORD
  2986              IF ERPDEF-FILE-STATUS = '00'
  2987                 ADD 1 TO B-SUB
  2988                 IF B-SUB > max-pdef
  2989                    DISPLAY ' DDF UEP TABLE BLEW '
  2990                    GO TO ABEND-PGM
  2991                 END-IF
  2992                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  2993                 MOVE PD-PRODUCT-CD
  2994                                 TO DD-PRODUCT-CD (B-SUB)
  2995                 MOVE PD-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  54
* FNB169.cbl
  2996                                 TO DD-BEN-TYPE (B-SUB)
  2997                 MOVE PD-BEN-CODE
  2998                                 TO DD-BEN-CODE (B-SUB)
  2999                 MOVE PD-PROD-EXP-DT
  3000                                 TO DD-PROD-EXP-DT (B-SUB)
  3001                 MOVE PD-1ST-YR-ADMIN-ALLOW
  3002                                 TO DD-1ST-YR-ALLOW (B-SUB)
  3003                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  3004                    P2 > +8
  3005                    MOVE PD-PROD-CODE (P2)
  3006                                 TO DD-PROD-CODE (B-SUB P2)
  3007                 END-PERFORM
  3008                 MOVE PD-EARN-FACTORS
  3009                                 TO DD-EARN-FACTORS (B-SUB)
  3010                 move pd-truncated to dd-truncated (b-sub)
  3011              END-IF
  3012           END-PERFORM
  3013        DISPLAY ' DCC PRODUCT DEF TABLE LOADED SUCCESSFULLY '
  3014        END-IF
  3015        CLOSE ERPDEF
  3016     END-IF
  3017
  3018     .
  3019 0000-EXIT.
  3020     EXIT.
  3021
  3022
  3023 ABEND-PGM SECTION.
  3024     DIVIDE WS-ZERO BY WS-ZERO       GIVING WS-ZERO.
  3025 ABEND-EXIT.
  3026
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:     3575132     Code:       12116
