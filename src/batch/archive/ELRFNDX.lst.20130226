* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ELRFNDX.cbl
* Options: int("ELRFNDX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELRFNDX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFNDX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFNDX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFNDX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/20/95 13:26:06.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ELRFNDX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  CAPPED TERM      - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  STATE CODE       - CP-STATE                                   *
    42*  STATE CODE       - CP-STATE-STD-ABBV                          *
    43*  CLASS CODE       - CP-CLASS-CODE                              *
    44*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    45*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    46*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    47*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    48*  A.P.R.           - CP-LOAN-APR                                *
    49*  METHOD           - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    52*  COMPANY I.D.     - CP-COMPANY-ID                              *
    53*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    54*  INSURED AGE      - CP-ISSUE-AGE                               *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ELRFNDX.cbl
    60 WORKING-STORAGE SECTION.
    61 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRFNDX WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*** VMOD=2.011 *****************'.
    65 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    66 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    68
    69 01  WS-WORK-MISC.
    70     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    71     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    72     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    73     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    74     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    75     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    76     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    77     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    78     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    79     12  WS-SAVE-EARN-METHOD PIC X.
    80     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    81     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    82     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    83     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-5            PIC S9(7)        COMP-3.
    86     12  FACTOR-6            PIC S9(7)        COMP-3.
    87     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    88     12  RATE-FACTOR-2       PIC S999         COMP-3.
    89     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    90     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    91     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    92     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    93
    94 01  TEXAS-REG-WORK-AREAS.
    95     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    96     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    97     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-4          PIC S9(7)       COMP-3.
    99     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   100     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   101     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   102     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   103     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   104
   105 01  NET-PAY-INTERFACE.
   106     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   107     12  N-P-ORIG            PIC S9(3)       COMP-3.
   108     12  N-P-REM             PIC S9(3)       COMP-3.
   109     12  N-P-OPT             PIC X.
   110     12  N-P-LOAN            PIC S9(3)       COMP-3.
   111     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   112
*  113                         COPY ERCNETWS.
   114***************************************************************** 04/29/98
   115*                                                               * ERCNETWS
   116*                                                               * ERCNETWS
   117*                            ERCNETWS                           *    LV004
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   119*                            VMOD=2.014                         *    CL**3
   120*                                                               * ERCNETWS
   121*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   122*                                                               * ERCNETWS
   123*****************************************************************.ERCNETWS
   124*                   C H A N G E   L O G
   125*
   126* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   127*-----------------------------------------------------------------
   128*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   129* EFFECTIVE    NUMBER
   130*-----------------------------------------------------------------
   131* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   132* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   133* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   134* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   135******************************************************************
   136                                                                  ERCNETWS
   137 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   138     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   139        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   140        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   141        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   142        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   143        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   144        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   145        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   146        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   147        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   148        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   149        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   150        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   151        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   152        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   153                                                                  ERCNETWS
   154     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   155        88  NET-STD             VALUE 'N'.                        ERCNETWS
   156        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   157                                                                  ERCNETWS
   158     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   159        88  NP-RATING           VALUE '1'.                        ERCNETWS
   160        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   161        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   162                                                                  ERCNETWS
   163     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   164         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   165         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   166         16  J               PIC SV9(9)        VALUE +0.
   167         16  K               PIC SV9(9)        VALUE +0.
   168         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   169         16  D               PIC S9(5)         VALUE +.0.
   170         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   171         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   172         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   173         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   174         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   175         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   176         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   177         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   178         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   179         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   180         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   181         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   182         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   183         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   184         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   185         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   186         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   187         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   188         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   189         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   190         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   191         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   192         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   193         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   194         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   195         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   196         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   197         16  K1              PIC S999          VALUE +1.          ERCNETWS
   198         16  K12             PIC S999          VALUE +12.         ERCNETWS
   199         16  K100            PIC S999          VALUE +100.        ERCNETWS
   200         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   201         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   202         16  Y REDEFINES NC-LR
   203                             PIC S99V9(5).
   204         16  TI              PIC S999V9(5)     VALUE +0.
   205         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   206         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   207         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   208         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   209         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   210         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   211         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   212         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   213                                                                  ERCNETWS
   214         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   215         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   216         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   217         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   218         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   219         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   220         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   221         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   222         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   223         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   224         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
   225         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   226         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   227                                                                  ERCNETWS
   228         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
   229                                                                  ERCNETWS
   230         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   231         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
   232                             PIC S999.                            ERCNETWS
   233                                                                  ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   234         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   235         16  R              REDEFINES REMAINING-TERM              ERCNETWS
   236                             PIC S999.                            ERCNETWS
   237                                                                  ERCNETWS
   238         16  LOAN-TERM       PIC S999.                            ERCNETWS
   239         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   240                             PIC S999.                            ERCNETWS
   241                                                                  ERCNETWS
   242         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
   243         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
   244                             PIC S999.                            ERCNETWS
   245                                                                  ERCNETWS
   246         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   247                             PIC S9(7)V9(8).                      ERCNETWS
   248         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   249                             PIC S9(7)V9(8).                      ERCNETWS
   250                                                                  ERCNETWS
   251         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   252         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   253         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   254         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   255         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   256         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   257         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   258         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   259         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   260                                                                  ERCNETWS
   261     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   262         16  X1              PIC S999        VALUE +0.            ERCNETWS
   263         16  X2              PIC S999        VALUE +0.            ERCNETWS
   264         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   265         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   266         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   267         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   268                                                                  ERCNETWS
   269     12  CSO-RATE-WORK-AREAS.
   270         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   271         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   272         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   273
   274     12  WS-WORK-MISC.                                            ERCNETWS
   275         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   276         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   277*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   278         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   279         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   280         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   281         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
   282         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   283         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   284         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   285         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   286         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   287         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   288         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
   289         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   290******************************************************************ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ELRFNDX.cbl
   292
*  293                         COPY ELCDATE.
   294******************************************************************06/11/98
   295*                                                                *ELCDATE
   296*                                                                *ELCDATE
   297*                            ELCDATE.                            *   LV023
   298*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   299*                            VMOD=2.003                           ELCDATE
   300*                                                                *ELCDATE
   301*                                                                *ELCDATE
   302*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   303*                 LENGTH = 200                                   *   CL*19
   304******************************************************************ELCDATE
   305                                                                  ELCDATE
   306 01  DATE-CONVERSION-DATA.                                        ELCDATE
   307     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   308     12  DC-OPTION-CODE                PIC X.                        CL*15
   309         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   310         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   311         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   312         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   313         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   314         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   315         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   316         88  FIND-CENTURY               VALUE '7'.                   CL*22
   317         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   318         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   319         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   320         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   321         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   322         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   323         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   324         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   325         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   326         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   327         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   328         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   329         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   330         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   331         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   332         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   333         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   334         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   335         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   336         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   337         88  THREE-CHARACTER-BIN                                  ELCDATE
   338                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   339         88  GREGORIAN-TO-BIN                                        CL**2
   340                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   341         88  BIN-TO-GREGORIAN                                        CL**2
   342                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   343         88  JULIAN-TO-BINARY                                        CL**2
   344                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   345     12  DC-ERROR-CODE                 PIC X.                        CL*15
   346         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   347         88  DATE-CONVERSION-ERROR                                ELCDATE
   348                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   349         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   350         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   351         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   352         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   353         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   354         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   355         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   356         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   357         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   358         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   359     12  DC-END-OF-MONTH               PIC X.                        CL*15
   360         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   361     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   362         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   363         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   364         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   365     12  FILLER                        PIC X.                        CL*15
   366     12  DC-CONVERSION-DATES.                                        CL*15
   367         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   368         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   369         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   370         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   371                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   372             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   373             20  SLASH1-1              PIC X.                        CL*15
   374             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   375             20  SLASH1-2              PIC X.                        CL*15
   376             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   377         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   378         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   379                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   380             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   381             20  SLASH2-1              PIC X.                        CL*15
   382             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   383             20  SLASH2-2              PIC X.                        CL*15
   384             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   385         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   386         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   387                     DC-GREG-DATE-1-YMD.                          ELCDATE
   388             20  DC-YMD-YEAR           PIC 99.                       CL*15
   389             20  DC-YMD-MONTH          PIC 99.                       CL*15
   390             20  DC-YMD-DAY            PIC 99.                       CL*15
   391         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   392         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   393                      DC-GREG-DATE-1-MDY.                         ELCDATE
   394             20  DC-MDY-MONTH          PIC 99.                       CL*15
   395             20  DC-MDY-DAY            PIC 99.                       CL*15
   396             20  DC-MDY-YEAR           PIC 99.                       CL*15
   397         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   398             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   399             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   400             20  FILLER                PIC XX.                       CL*15
   401             20  DC-ALPHA-CENTURY.                                   CL*15
   402                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   403             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   404         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   405         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   406         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   407         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   408         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   409                                       PIC 9(05).                    CL*20
   410         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   411             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   412             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   413         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   414         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   415         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   416     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   417         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   418         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   419             20  FILLER                PIC 9(3).                     CL*15
   420             20  HOLD-CEN-1-CCYY.                                    CL*15
   421                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   422                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   423             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   424             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   425         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   426             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   427             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   428             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   429                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   430                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   431             20  FILLER                PIC 9(3).                     CL*15
   432         16  HOLD-CENTURY-1-X.                                       CL*15
   433             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   434             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   435                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   436                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   437             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   438             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   439         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   440             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   441             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   442             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   443                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   444                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   445             20  FILLER                PIC XXX.                      CL*23
   446         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   447         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   448         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   449         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   450             20  DC-JULIAN-1-CCYY.                                   CL*15
   451                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   452                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   453             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   454         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   455         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   456             20  DC-JULIAN-2-CCYY.                                   CL*15
   457                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   458                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   459             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   460         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   461             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   462             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   463             20  DC-EDITA-DAY          PIC 99.                       CL*15
   464             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   465             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   466                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   467                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   468         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   469             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   470             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   471             20  DC-EDITB-DAY          PIC 99.                       CL*15
   472             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   473             20  DC-EDITB-CCYY.                                      CL*15
   474                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   475                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   476         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   477         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   478                              DC-GREG-DATE-CYMD.                  ELCDATE
   479             20  DC-CYMD-CEN           PIC 99.                       CL*15
   480             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   481             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   482             20  DC-CYMD-DAY           PIC 99.                       CL*15
   483         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   484         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   485                              DC-GREG-DATE-MDCY.                  ELCDATE
   486             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   487             20  DC-MDCY-DAY           PIC 99.                       CL*15
   488             20  DC-MDCY-CEN           PIC 99.                       CL*15
   489             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   490    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   491        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   492    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   493    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ELRFNDX.cbl
   495 LINKAGE SECTION.
*  496                         COPY ELCCALC.
   497******************************************************************04/15/98
   498*                                                                *ELCCALC
   499*                           ELCCALC.                            *    LV003
   500*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   501*                            VMOD=2.025                          *   CL**3
   502*                                                                *   CL**2
   503*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   504*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   505*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   506*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   507*                                                                *   CL**2
   508*  PASSED TO ELRTRM                                              *   CL**2
   509*  -----------------                                             *   CL**2
   510*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   511*  ORIGINAL TERM                                                 *   CL**2
   512*  BEGINNING DATE                                                *   CL**2
   513*  ENDING DATE                                                   *   CL**2
   514*  COMPANY I.D.                                                  *   CL**2
   515*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   516*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   517*  FREE LOOK DAYS                                                *   CL**2
   518*                                                                *   CL**2
   519*  RETURNED FROM ELRTRM                                          *   CL**2
   520*  ---------------------                                         *   CL**2
   521*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   522*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   523*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   524*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   525*----------------------------------------------------------------*   CL**2
   526*  PASSED TO ELRAMT                                              *   CL**2
   527*  ----------------                                              *   CL**2
   528*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   529*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   530*  ORIGINAL AMOUNT                                               *   CL**2
   531*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   532*  A.P.R. - NET PAY ONLY                                         *   CL**2
   533*  METHOD                                                            CL**2
   534*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   535*  COMPANY I.D.                                                  *   CL**2
   536*  BENEFIT TYPE                                                  *   CL**2
   537*                                                                *   CL**2
   538*  RETURNED FROM ELRAMT                                          *   CL**2
   539*  --------------------                                          *   CL**2
   540*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   541*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   542*  REMAINING AMOUNT FACTOR                                           CL**2
   543*----------------------------------------------------------------*   CL**2
   544*  PASSED TO ELRESV                                              *   CL**2
   545*  -----------------                                             *   CL**2
   546*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   547*  VALUATION DATE                                                *   CL**2
   548*  PAID THRU DATE                                                *   CL**2
   549*  BENEFIT                                                       *   CL**2
   550*  INCURRED DATE                                                 *   CL**2
   551*  REPORTED DATE                                                 *   CL**2
   552*  ISSUE AGE                                                     *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   553*  TERM                                                          *   CL**2
   554*  CDT PERCENT                                                   *   CL**2
   555*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   556* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   557* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   558* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   559*                                                                *   CL**2
   560*  RETURNED FROM ELRESV                                          *   CL**2
   561*  --------------------                                          *   CL**2
   562*  CDT TABLE USED                                                *   CL**2
   563*  CDT FACTOR USED                                               *   CL**2
   564*  PAY TO CURRENT RESERVE                                        *   CL**2
   565*  I.B.N.R. - A/H ONLY                                           *   CL**2
   566*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   567*----------------------------------------------------------------*   CL**2
   568*  PASSED TO ELRATE                                              *   CL**2
   569*  ----------------                                              *   CL**2
   570*  CERT ISSUE DATE                                               *   CL**2
   571*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   572*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   573*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   574*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   575*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   576*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   577*  DEVIATION CODE                                                *   CL**2
   578*  ISSUE AGE                                                     *   CL**2
   579*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   580*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   581*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   582*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   583*  A.P.R.                                                        *   CL**2
   584*  METHOD                                                            CL**2
   585*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   586*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   587*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   588*  BENEFIT CODE                                                  *   CL**2
   589*  BENEFIT OVERRIDE CODE                                         *   CL**2
   590*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   591*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   592*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   593*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   594*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   595*                                                                *   CL**2
   596*  RETURNED FROM ELRATE                                          *   CL**2
   597*  --------------------                                          *   CL**2
   598*  CALCULATED PREMIUM                                            *   CL**2
   599*  PREMIUM RATE                                                  *   CL**2
   600*  MORTALITY CODE                                                *   CL**2
   601*  MAX ATTAINED AGE                                              *   CL**2
   602*  MAX AGE                                                       *   CL**2
   603*  MAX TERM                                                      *   CL**2
   604*  MAX MONTHLY BENEFIT                                           *   CL**2
   605*  MAX TOTAL BENIFIT                                             *   CL**2
   606*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   607*----------------------------------------------------------------*   CL**2
   608*  PASSED TO ELRFND                                              *   CL**2
   609*  ----------------                                              *   CL**2
   610*  CERT ISSUE DATE                                               *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   611*  REFUND DATE                                                   *   CL**2
   612*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   613*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   614*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   615*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   616*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   617*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   618*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   619*  DEVIATION CODE                                                *   CL**2
   620*  ISSUE AGE                                                     *   CL**2
   621*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   622*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   623*  PROCESS TYPE (CANCEL)                                         *   CL**2
   624*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   625*  A.P.R.                                                        *   CL**2
   626*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   627*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   628*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   629*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   630*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   631*  BENEFIT CODE                                                  *   CL**2
   632*  BENEFIT OVERRIDE CODE                                         *   CL**2
   633*                                                                *   CL**2
   634*  RETURNED FROM ELRFND                                          *   CL**2
   635*  --------------------                                          *   CL**2
   636*  CALCULATED REFUND                                             *   CL**2
   637*----------------------------------------------------------------*   CL**2
   638*  PASSED TO ELEARN                                              *   CL**2
   639*  ----------------                                              *   CL**2
   640*  CERT ISSUE DATE                                               *   CL**2
   641*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   642*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   643*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   644*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   645*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   646*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   647*  DEVIATION CODE                                                *   CL**2
   648*  ISSUE AGE                                                     *   CL**2
   649*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   650*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   651*  A.P.R.                                                        *   CL**2
   652*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   653*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   654*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   655*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   656*  BENEFIT CODE                                                  *   CL**2
   657*  BENEFIT OVERRIDE CODE                                         *   CL**2
   658*                                                                *   CL**2
   659*  RETURNED FROM ELEARN                                          *   CL**2
   660*  --------------------                                          *   CL**2
   661*  INDICATED  EARNINGS                                           *   CL**2
   662*----------------------------------------------------------------*   CL**2
   663*                 LENGTH = 450                                   *   CL**2
   664*                                                                *   CL**2
   665******************************************************************   CL**2
   666******************************************************************
   667*                   C H A N G E   L O G
   668*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   670*-----------------------------------------------------------------
   671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   672* EFFECTIVE    NUMBER
   673*-----------------------------------------------------------------
   674* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   675* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   676* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   677* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   678* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   679* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   680* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   681* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   682* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   683******************************************************************
   684                                                                     CL**2
   685 01  CALCULATION-PASS-AREA.                                          CL**2
   686     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   687                                     COMP.                           CL**2
   688                                                                     CL**2
   689     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   690       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   691       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   692                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   693       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   694       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   695       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   696       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   697       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   698       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   699       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   700       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   701       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   702       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   703       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   704       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   705       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   706       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   707       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   708       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   709       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   710                                                                     CL**2
   711     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   712       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   713***********************  INPUT AREAS ****************************    CL**2
   714                                                                     CL**2
   715     12  CP-CALCULATION-AREA.                                        CL**2
   716         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   717         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   718         16  CP-VALUATION-DT       PIC XX.                           CL**2
   719         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   720         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   721           88  CP-AH                               VALUE 'A' 'D'     CL**2
   722                                                   'I' 'U'.          CL**2
   723           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   724           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   725         16  CP-INCURRED-DT        PIC XX.                           CL**2
   726         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   727         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   728         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   729         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   730                                     COMP-3.                         CL**2
   731         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   732                                     COMP-3.                         CL**2
   733         16  CP-CDT-METHOD         PIC X.                            CL**2
   734           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   735           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   736           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   737         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   738           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   739           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   740         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   741                                     COMP-3.                         CL**2
   742         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   743                                     COMP-3.                         CL**2
   744         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   745                                     COMP-3.                         CL**2
   746         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   747                                     COMP-3.                         CL**2
   748         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   749                                     COMP-3.                         CL**2
   750         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   751                                     COMP-3.                         CL**2
   752         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   753                                     COMP-3.                         CL**2
   754         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   755           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   756           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   757           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   758           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   759           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   760           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   761           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   762         16  CP-EARNING-METHOD     PIC X.                            CL**2
   763           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   764           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   765           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   766           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   767           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   768           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   769           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   770           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   771           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   772           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   773           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   774           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   775           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   776           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   777         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   778           88  CP-CLAIM                            VALUE '1'.        CL**2
   779           88  CP-CANCEL                           VALUE '2'.        CL**2
   780           88  CP-ISSUE                            VALUE '3'.        CL**2
   781         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   782           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   783           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
   784           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   785           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   786           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   787           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   788           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   789           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   790           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   791           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   792           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   793           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   794           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   795           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   796           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   797           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   798           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   799           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   800                                                     'W' 'X'.        CL**2
   801           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   802           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   803           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   804           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   805           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   806           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   807           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   808           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   809           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   810           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   811           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   812           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   813           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   814                                                                     CL**2
   815         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   816                                     COMP-3.                         CL**2
   817         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   818         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   819         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   820         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   821         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   822           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   823               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   824         16  CP-R78-OPTION         PIC X.                            CL**2
   825           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   826           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   827                                                                     CL**2
   828         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   829         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   830         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   831         16  CP-RATE-FILE          PIC X.                            CL**2
   832         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   833                                     COMP-3.                         CL**2
   834                                                                     CL**2
   835         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   836         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   837                                                                     CL**2
   838         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   839                                     COMP-3.
   840         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   841                                   PIC S9(5)V99 COMP-3.
   842         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   843                                     COMP-3.                         CL**2
   844         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   845                                     COMP-3.                         CL**2
   846         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   847                                     COMP-3.
   848         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   849                                  PIC S9(7)V99 COMP-3.
   850                                                                     CL**2
   851         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   852         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   853         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   854           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   855           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   856           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   857           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   858         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   859         16  CP-CARRIER            PIC X.                            CL**2
   860         16  CP-REIN-FLAG          PIC X.                            CL**2
   861         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   862           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   863                      '2' '3' '4' '5'.                               CL**2
   864           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   865           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   866           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   867           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   868           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   869           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   870           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   871           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   872         16  CP-SIG-SWITCH         PIC X.                            CL**2
   873         16  CP-RATING-METHOD      PIC X.                            CL**2
   874           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   875           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   876           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   877           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   878           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   879           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   880           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   881           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   882           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   883         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   884                                     COMP-3.                         CL**2
   885         16  CP-BEN-CATEGORY       PIC X.
   886         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   887         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   888                                   PIC S99V9(5) COMP-3.
   889         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   890         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   891                                   PIC S99V9(5) COMP-3.
   892         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   893         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   894         16  CP-EXPIRE-DT          PIC XX.
   895         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   896         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   897         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   898         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   899         16  CP-DDF-SPEC-CALC      PIC X.
   900             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   901             88  CP-CALC-CLP              VALUE 'C'.
   902         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   903         16  CP-CANCEL-REASON      PIC X.
   904         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   905         16  CP-PMT-MODE           PIC X.
   906         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   907         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   908         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   909         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   910         16  FILLER                PIC X.
   911                                                                     CL**2
   912***************    OUTPUT FROM ELRESV   ************************     CL**2
   913                                                                     CL**2
   914         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   915                                                                     CL**2
   916         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   917                                     COMP-3.                         CL**2
   918         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   919                                     COMP-3.                         CL**2
   920         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   921                                     COMP-3.                         CL**2
   922         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   923                                     COMP-3.                         CL**2
   924         16  FILLER                PIC X(09).                        CL**2
   925***************    OUTPUT FROM ELRTRM   *************************    CL**2
   926                                                                     CL**2
   927         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   928                                     COMP-3.                         CL**2
   929         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   930                                     COMP-3.                         CL**2
   931         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   932                                     COMP-3.                         CL**2
   933         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   934                                     COMP-3.                         CL**2
   935         16  FILLER                PIC X(12).                        CL**2
   936                                                                     CL**2
   937***************    OUTPUT FROM ELRAMT   *************************    CL**2
   938                                                                     CL**2
   939         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   940                                     COMP-3.                         CL**2
   941         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   942                                     COMP-3.                         CL**2
   943         16  FILLER                PIC X(12).                        CL**2
   944                                                                     CL**2
   945***************    OUTPUT FROM ELRATE   *************************    CL**2
   946                                                                     CL**2
   947         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   948                                     COMP-3.                         CL**2
   949         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   950                                     COMP-3.                         CL**2
   951         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   952         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   953             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   954         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   955                                     COMP-3.                         CL**2
   956         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   957         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   958         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   959                                   PIC S9(7)V99 COMP-3.
   960         16  FILLER                PIC X(07).                        CL**2
   961                                                                     CL**2
   962***************    OUTPUT FROM ELRFND   *************************    CL**2
   963                                                                     CL**2
   964         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   965                                     COMP-3.                         CL**2
   966         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   967           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   968           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   969           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   970           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   971           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   972           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   973           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   974           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   975           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   976           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   977           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   978           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   979           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   980           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   981         16  FILLER                PIC X(12).                        CL**2
   982                                                                     CL**2
   983***************    OUTPUT FROM ELEARN   *************************    CL**2
   984                                                                     CL**2
   985         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   986                                     COMP-3.                         CL**2
   987         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   988                                     COMP-3.                         CL**2
   989         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
   990                                     COMP-3.                         CL**2
   991         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
   992                                     COMP-3.                         CL**2
   993         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
   994                                     COMP-3.                         CL**2
   995         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
   996                                     COMP-3.                         CL**2
   997         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
   998           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
   999           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1000           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1001           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1002           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1003           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1004           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1005           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1006           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1007         16  FILLER                PIC X(12).                        CL**2
  1008                                                                     CL**2
  1009***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1010                                                                     CL**2
  1011         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1012                                     COMP-3.                         CL**2
  1013         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1014                                     COMP-3.                         CL**2
  1015         16  FILLER                PIC X(12).                        CL**2
  1016                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1017***************   MISC WORK AREAS    *****************************   CL**2
  1018         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1019                                     COMP-3.                         CL**2
  1020         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1021                                     COMP-3.                         CL**2
  1022         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1023                                     COMP-3.                         CL**2
  1024         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1025                                     COMP-3.                         CL**2
  1026         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1027                                     COMP-3.                         CL**2
  1028         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1029                                     COMP-3.                         CL**2
  1030         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1031             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1032             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1033             88  IO-ERROR                         VALUE 'E'.         CL**2
  1034                                                                     CL**2
  1035         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1036                                                                     CL**2
  1037         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1038                                                                     CL**2
  1039         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1040                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1041                                     COMP-3.                         CL**2
  1042                                                                     CL**2
  1043         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1044                                                                     CL**2
  1045         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1046                                     COMP-3.                         CL**2
  1047                                                                     CL**2
  1048         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1049                                     COMP-3.                         CL**2
  1050                                                                     CL**2
  1051         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1052                                     COMP-3.                         CL**2
  1053                                                                     CL**2
  1054         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1055                                     COMP-3.                         CL**2
  1056                                                                     CL**2
  1057         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1058                                     COMP-3.                         CL**2
  1059                                                                     CL**2
  1060         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1061                                     COMP-3.                         CL**2
  1062                                                                     CL**2
  1063         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1064                                     COMP-3.                         CL**2
  1065                                                                     CL**2
  1066         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1067             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1068                                                                     CL**2
  1069         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1070                                     COMP-3.                         CL**2
  1071         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1072                                     COMP-3.
  1073         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1074         16  FILLER                PIC X(15).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ELRFNDX.cbl
  1075******************************************************************   CL**2
  1076
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ELRFNDX.cbl
  1078 PROCEDURE DIVISION  USING CALCULATION-PASS-AREA.
  1079
  1080 000-START-REFUND-CALC.
* 1081                       COPY ELCRFNDP.
  1082****************************************************************
  1083*                                                              *
  1084*                            ELCRFNDP.                         *
  1085*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1086*                            VMOD=2.028                        *
  1087*                                                              *
  1088****************************************************************.
  1089*                   C H A N G E   L O G
  1090*
  1091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1092*-----------------------------------------------------------------
  1093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1094* EFFECTIVE    NUMBER
  1095*-----------------------------------------------------------------
  1096* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1097* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1098* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1099* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1100* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1101* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1102* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1103* 032612  CR2011110200001  PEMA AHL CHANGES
  1104******************************************************************
  1105
  1106     MOVE ZERO                   TO  CP-RETURN-CODE
  1107                                     CP-CALC-REFUND.
  1108     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1109
  1110 0001-GET-CANCEL-TYPE.
  1111     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1112        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1113        GO TO 1999-CALC-REF-AMT-X.
  1114
  1115     IF CP-CANCEL-REASON = 'R'
  1116        IF CP-CALC-CLP
  1117           MOVE CP-ORIGINAL-PREMIUM
  1118                                 TO CP-CALC-REFUND
  1119        ELSE
  1120           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1121              CP-DDF-ADMIN-FEES
  1122        END-IF
  1123        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1124        GO TO 1999-CALC-REF-AMT-X
  1125     END-IF
  1126
  1127     IF CP-REMAINING-TERM = ZERO   OR
  1128        CP-REMAINING-TERM NEGATIVE
  1129          MOVE ZERO TO CP-CALC-REFUND
  1130          GO TO 1999-CALC-REF-AMT-X.
  1131
  1132     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1133     MOVE SPACE              TO DC-OPTION-CODE.
  1134     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1135
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1136     IF DATE-CONVERSION-ERROR
  1137         MOVE '2' TO CP-RETURN-CODE
  1138         GO TO 1999-CALC-REF-AMT-X.
  1139
  1140     IF CP-AH
  1141        GO TO 1030-GET-AH-REFUND.
  1142
  1143********************    LIFE REFUNDS    **************************
  1144
  1145     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1146         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1147
  1148     IF CP-LOAN-TERM NOT NUMERIC
  1149         MOVE +0                TO CP-LOAN-TERM.
  1150
  1151     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1152
  1153     COMPUTE R78-FACTOR =
  1154            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1155              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1156************************************************************
  1157***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1158***---------------------------------------------------------
  1159     IF CP-TRUNCATED-LIFE
  1160        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1161     ELSE
  1162        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1163***
  1164************************************************************
  1165**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1166**** FOLLOWING.
  1167****       FOR NC. LIFE..
  1168****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1169****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1170****                             TERM <= 60 USE SUM OF DIGITS.
  1171****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1172****                             TERM > 60 USE RULE OF ANTIC
  1173****                             OTHERWISE USE RULE OF 78.
  1174****
  1175****
  1176
  1177     IF (CP-COMPANY-ID = 'NCL') AND
  1178        (CP-STATE-STD-ABBRV = 'NC')
  1179        IF CP-LEVEL-LIFE
  1180           GO TO 1023-REF-PR
  1181        ELSE
  1182        IF CP-EARN-AS-NET-PAY AND
  1183           CP-TRUNCATED-LIFE
  1184           IF CP-ORIGINAL-TERM GREATER THAN 60
  1185              GO TO 1021-ANTICIPATION-REF
  1186           ELSE
  1187              GO TO 1026-REF-R78
  1188        ELSE
  1189        IF CP-REDUCING-LIFE
  1190           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1191              CP-ORIGINAL-TERM GREATER THAN 60)
  1192              GO TO 1021-ANTICIPATION-REF
  1193           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1194              GO TO 1075-SUM-OF-DIGITS.
  1195
  1196****
  1197**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1198**** FOLLOWING.
  1199****       FOR OH. LIFE..
  1200****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1201****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1202****  GROSS DECREASING       --- RULE OF 78
  1203****
  1204****
  1205
  1206     IF (CP-COMPANY-ID = 'CID') AND
  1207        (CP-STATE-STD-ABBRV = 'OH') AND
  1208        (CP-CLASS-CODE NOT = 'L ')
  1209        IF CP-LEVEL-LIFE
  1210           GO TO 1023-REF-PR
  1211        ELSE
  1212           IF (CP-ORIGINAL-TERM > 60) OR
  1213              (CP-EARN-AS-NET-PAY)
  1214              GO TO 1028-NET-PAY-REFUND
  1215           ELSE
  1216              GO TO 1026-REF-R78
  1217           END-IF
  1218        END-IF
  1219     END-IF
  1220
  1221**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1222**** FOLLOWING.
  1223****       FOR VA. LIFE..
  1224****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1225****           NET COVERAGES --- USE RULE OF ANTIC.
  1226****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1227****                         --- EFF DATE > 123194 USE ANTIC.
  1228****                         --- EFF DATE BETWEEN 010193 AND 12319
  1229****                             WITH TERM > 61 USE RULE OF ANTIC
  1230****                             OTHERWISE USE RULE OF 78.
  1231****
  1232****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1233****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1234****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1235****            WILL FOLLOW.
  1236****
  1237****
  1238****
  1239
  1240     IF (CP-COMPANY-ID = 'NCL') AND
  1241        (CP-STATE-STD-ABBRV = 'VA')
  1242        IF CP-LEVEL-LIFE
  1243           GO TO 1023-REF-PR
  1244        ELSE
  1245        IF CP-EARN-AS-NET-PAY
  1246           GO TO 1021-ANTICIPATION-REF
  1247        ELSE
  1248        IF CP-REDUCING-LIFE
  1249           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1250              GO TO 1026-REF-R78
  1251           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1252           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1253              GO TO 1021-ANTICIPATION-REF
  1254           ELSE
  1255           IF CP-ORIGINAL-TERM GREATER THAN 61
  1256              GO TO 1021-ANTICIPATION-REF
  1257           ELSE
  1258              GO TO 1026-REF-R78.
  1259
  1260     IF (CP-COMPANY-ID = 'CID')
  1261        AND (CP-STATE-STD-ABBRV = 'IN')
  1262        AND (DC-GREG-DATE-CYMD < 20030401)
  1263        IF CP-REDUCING-LIFE
  1264           GO TO 1026-REF-R78
  1265        ELSE
  1266           IF CP-LEVEL-LIFE
  1267              GO TO 1023-REF-PR
  1268           END-IF
  1269        END-IF
  1270     END-IF
  1271
  1272     IF (CP-COMPANY-ID = 'CID')
  1273        AND (CP-STATE-STD-ABBRV = 'FL')
  1274        AND (DC-GREG-DATE-CYMD > 20030630)
  1275        IF CP-RATE-AS-NET-PAY
  1276           GO TO 1028-NET-PAY-REFUND
  1277        END-IF
  1278     END-IF
  1279
  1280     IF (CP-COMPANY-ID = 'CID')
  1281        AND (CP-STATE-STD-ABBRV = 'MN')
  1282        AND (CP-EARN-AS-NET-PAY)
  1283        AND (CP-RATE-AS-REG-BALLOON)
  1284        AND (DC-GREG-DATE-CYMD > 20091231)
  1285        GO TO 1028-NET-PAY-REFUND
  1286     END-IF
  1287
  1288     IF (CP-COMPANY-ID = 'CID')
  1289        AND (CP-STATE-STD-ABBRV = 'MN')
  1290        AND (DC-GREG-DATE-CYMD > 20091231)
  1291        AND (CP-RATE-AS-NET-PAY)
  1292        GO TO 1021-ANTICIPATION-REF
  1293     END-IF
  1294
  1295     IF (CP-COMPANY-ID = 'CID')
  1296        AND (CP-STATE-STD-ABBRV = 'MO')
  1297        AND (DC-GREG-DATE-CYMD > 20030630)
  1298        AND (CP-LOAN-TERM < +121)
  1299        IF CP-RATE-AS-NET-PAY
  1300           GO TO 1028-NET-PAY-REFUND
  1301        END-IF
  1302     END-IF
  1303
  1304     IF (CP-COMPANY-ID = 'CID')
  1305        AND (CP-STATE-STD-ABBRV = 'ND')
  1306        AND (DC-GREG-DATE-CYMD > 20011231)
  1307        AND (CP-REDUCING-LIFE)
  1308        GO TO 1021-ANTICIPATION-REF
  1309     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1310
  1311     IF CP-CRITICAL-PERIOD
  1312        IF CP-COMPANY-ID = 'NCL'
  1313           NEXT SENTENCE
  1314        ELSE
  1315           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1316
  1317     IF CP-TERM-IS-DAYS  AND
  1318        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1319         GO TO 1024-REF-PR-DAYS.
  1320
  1321     IF CP-STATE-STD-ABBRV = 'NM'
  1322       IF CP-REDUCING-LIFE
  1323*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1324         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1325             GO TO 1026-REF-R78.
  1326
  1327     IF CP-EARN-ANTICIPATION
  1328         GO TO 1021-ANTICIPATION-REF.
  1329
  1330     IF CP-STATE-STD-ABBRV = 'ME'
  1331         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1332            NEXT SENTENCE
  1333         ELSE
  1334            IF CP-REDUCING-LIFE
  1335               GO TO 1021-ANTICIPATION-REF.
  1336
  1337     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1338        IF CP-STATE-STD-ABBRV = 'TX'
  1339            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1340        END-IF
  1341     END-IF.
  1342
  1343     IF CP-STATE-STD-ABBRV = 'TX'
  1344       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1345          NEXT SENTENCE
  1346       END-IF
  1347        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1348           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1349           GO TO 1021-ANTICIPATION-REF.
  1350
  1351 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1352
  1353     IF CP-EARN-BY-PRORATA
  1354         GO TO 1023-REF-PR.
  1355
  1356     IF CP-EARN-AS-MEAN
  1357         GO TO 1025-REF-MEAN.
  1358
  1359     IF CP-EARN-AS-TEXAS
  1360         GO TO 1027-TEXAS-REFUND.
  1361
  1362     IF CP-EARN-AS-NET-PAY
  1363         GO TO 1028-NET-PAY-REFUND.
  1364
  1365     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1366         GO TO 1000-NO-NET-PAY.
  1367
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1368     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1369       IF CP-STATE-STD-ABBRV = 'NC'
  1370         IF CP-REDUCING-LIFE
  1371           IF CP-ORIGINAL-TERM GREATER 60  AND
  1372              DC-GREG-DATE-CYMD GREATER 19810930
  1373                GO TO 1028-NET-PAY-REFUND
  1374           ELSE
  1375              GO TO 1026-REF-R78.
  1376
  1377
  1378     IF CP-STATE-STD-ABBRV = 'NC'
  1379       IF CP-COMPANY-ID EQUAL 'NCL'
  1380          NEXT SENTENCE
  1381       END-IF
  1382       IF CP-REDUCING-LIFE
  1383         IF CP-ORIGINAL-TERM GREATER 60  AND
  1384            DC-GREG-DATE-CYMD GREATER 19810930
  1385             GO TO 1021-ANTICIPATION-REF
  1386         ELSE
  1387             GO TO 1026-REF-R78.
  1388
  1389     IF CP-STATE-STD-ABBRV = 'UT'
  1390       IF CP-COMPANY-ID EQUAL 'NCL'
  1391          NEXT SENTENCE
  1392       END-IF
  1393         IF CP-ORIGINAL-TERM GREATER 62         AND
  1394            CP-LOAN-APR GREATER ZERO            AND
  1395            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1396            DC-GREG-DATE-CYMD LESS    19830901
  1397             GO TO 1028-NET-PAY-REFUND
  1398         ELSE
  1399             GO TO 1026-REF-R78.
  1400
  1401     IF CP-STATE-STD-ABBRV = 'OH'
  1402       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1403          NEXT SENTENCE
  1404       END-IF
  1405           IF CP-ORIGINAL-TERM GREATER 60         AND
  1406              CP-CLASS-CODE NOT = 'L '            AND
  1407              CP-LOAN-APR GREATER ZERO            AND
  1408              DC-GREG-DATE-CYMD GREATER 19831031
  1409              GO TO 1028-NET-PAY-REFUND
  1410           ELSE
  1411              GO TO 1026-REF-R78.
  1412
  1413     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1414       IF CP-STATE-STD-ABBRV = 'MT'
  1415         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1416
  1417
  1418     IF CP-STATE-STD-ABBRV = 'MT'
  1419       IF CP-COMPANY-ID EQUAL 'NCL'
  1420          NEXT SENTENCE
  1421       END-IF
  1422         IF CP-ORIGINAL-TERM GREATER 61         AND
  1423            CP-LOAN-APR GREATER ZERO            AND
  1424            DC-GREG-DATE-CYMD GREATER 19830318
  1425             GO TO 1028-NET-PAY-REFUND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1426         ELSE
  1427             GO TO 1026-REF-R78.
  1428
  1429 SKIP-CSO-MT-LF-PROCESSING.
  1430
  1431     IF CP-STATE-STD-ABBRV = 'RI'
  1432       IF CP-COMPANY-ID EQUAL 'NCL'
  1433          NEXT SENTENCE
  1434       END-IF
  1435         IF CP-ORIGINAL-TERM GREATER 60         AND
  1436            CP-LOAN-APR GREATER ZERO            AND
  1437            DC-GREG-DATE-CYMD GREATER 19831231
  1438             GO TO 1028-NET-PAY-REFUND
  1439         ELSE
  1440             GO TO 1026-REF-R78.
  1441
  1442
  1443 1000-NO-NET-PAY.
  1444
  1445     IF CP-STATE-STD-ABBRV = 'WY'
  1446       IF CP-COMPANY-ID EQUAL 'NCL'
  1447          NEXT SENTENCE
  1448       END-IF
  1449        IF CP-COMPANY-ID = 'TMS'
  1450           GO TO 1026-REF-R78
  1451        ELSE
  1452           GO TO 1023-REF-PR.
  1453
  1454     IF CP-EARN-BY-R78
  1455         GO TO 1026-REF-R78.
  1456
  1457     IF CP-EARN-AS-SUM-OF-DIGITS
  1458         GO TO 1075-SUM-OF-DIGITS.
  1459
  1460     IF CP-LEVEL-LIFE
  1461         GO TO 1023-REF-PR
  1462     ELSE
  1463         GO TO 1026-REF-R78.
  1464
  1465*-----------------------------------------------------------------
  1466 1021-ANTICIPATION-REF.
  1467     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1468
  1469     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1470     IF CP-LOAN-TERM = ZEROS
  1471        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1472     END-IF
  1473
  1474     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1475                            CP-REMAINING-TERM.
  1476
  1477     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1478     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1479     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1480
  1481     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1482     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1483     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1484
  1485     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1486         MOVE 'N'              TO CP-ROA-REFUND
  1487     ELSE
  1488         MOVE 'Y'              TO CP-ROA-REFUND.
  1489
  1490******    TO COMPUTE PREMIUM AT REFUND DATE
  1491
  1492     PERFORM 2500-GET-RATE.
  1493
  1494     MOVE 'N'                  TO CP-ROA-REFUND.
  1495     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1496     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1497     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1498
  1499     IF CP-PREMIUM-RATE = ZEROS
  1500        MOVE '7'                 TO CP-RETURN-CODE
  1501        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1502        GO TO 1999-CALC-REF-AMT-X.
  1503
  1504     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1505
  1506******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1507
  1508     PERFORM 2500-GET-RATE.
  1509
  1510     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1511
  1512     IF CP-PREMIUM-RATE = ZEROS
  1513        MOVE '7'            TO CP-RETURN-CODE
  1514        GO TO 1999-CALC-REF-AMT-X.
  1515
  1516     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1517
  1518     IF  WS-ORIG-PREM = ZEROS
  1519         MOVE ZEROS TO WS-NP-REF-FACTOR
  1520        ELSE
  1521         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1522                                            WS-ORIG-PREM.
  1523
  1524     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1525                                        CP-ORIGINAL-PREMIUM.
  1526
  1527     GO TO 1999-CALC-REF-AMT-X.
  1528
  1529*---------------------------------------------------------------
  1530 1022-REF-CRITICAL-PERIOD-LF.
  1531     GO TO 1023-REF-PR.
  1532
  1533*---------------------------------------------------------------
  1534 1023-REF-PR.
  1535     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1536     COMPUTE CP-CALC-REFUND ROUNDED =
  1537            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1538
  1539     GO TO 1999-CALC-REF-AMT-X.
  1540
  1541*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1542 1024-REF-PR-DAYS.
  1543     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1544     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1545     MOVE '1'                TO DC-OPTION-CODE.
  1546     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1547
  1548     IF DATE-CONVERSION-ERROR
  1549         MOVE '2' TO CP-RETURN-CODE
  1550         GO TO 1999-CALC-REF-AMT-X.
  1551
  1552     COMPUTE CP-CALC-REFUND ROUNDED =
  1553         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1554                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1555
  1556     GO TO 1999-CALC-REF-AMT-X.
  1557
  1558*---------------------------------------------------------------
  1559 1025-REF-MEAN.
  1560     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1561     COMPUTE CP-CALC-REFUND ROUNDED =
  1562          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1563           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1564
  1565     GO TO 1999-CALC-REF-AMT-X.
  1566
  1567*---------------------------------------------------------------
  1568 1026-REF-R78.
  1569     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1570*    IF CP-TERM-TIMES-TERM
  1571*        COMPUTE R78-FACTOR =
  1572*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1573*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1574*
  1575     COMPUTE CP-CALC-REFUND ROUNDED =
  1576        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1577
  1578     GO TO 1999-CALC-REF-AMT-X.
  1579
  1580*---------------------------------------------------------------
  1581 1027-TEXAS-REFUND.
  1582     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1583     IF CP-PAY-FREQUENCY = ZERO
  1584        MOVE ZERO TO CP-CALC-REFUND
  1585        MOVE '5'  TO CP-RETURN-CODE
  1586        GO TO 1999-CALC-REF-AMT-X.
  1587
  1588     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1589         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1590
  1591     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1592         GIVING TEX-FACT-5
  1593             REMAINDER TEX-FACT-6.
  1594
  1595     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1596
  1597     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1598         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1599         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1600
  1601     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1602
  1603     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1604                                        * TEX-FACT-8.
  1605
  1606     GO TO 1999-CALC-REF-AMT-X.
  1607
  1608*---------------------------------------------------------------
  1609 1028-NET-PAY-REFUND.
  1610
  1611     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1612     IF CP-LOAN-APR = ZERO
  1613        MOVE ZERO TO CP-CALC-REFUND
  1614        MOVE '1'  TO CP-RETURN-CODE
  1615        GO TO 1999-CALC-REF-AMT-X.
  1616
  1617     MOVE CP-LOAN-APR           TO N-P-APR.
  1618     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1619     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1620
  1621     IF CP-TRUNCATED-LIFE
  1622        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1623
  1624     MOVE 'R'                   TO N-P-OPT.
  1625
  1626     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1627
  1628     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1629                                        CP-ORIGINAL-PREMIUM.
  1630
  1631 1029-UTAH-REFUND.
  1632*
  1633*---------------------------------------------------------------
  1634* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1635*---------------------------------------------------------------
  1636*
  1637     GO TO 1999-CALC-REF-AMT-X.
  1638*
  1639*---------------------------------------------------------------
  1640     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1641                      OR
  1642        (CP-COMPANY-ID EQUAL 'NCL')
  1643         GO TO 1999-CALC-REF-AMT-X.
  1644     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1645
  1646     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1647        GREATER ZERO AND LESS 13
  1648         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1649                 (CP-CALC-REFUND * .05).
  1650
  1651     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1652        GREATER 12 AND LESS 25
  1653         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1654                 (CP-CALC-REFUND * .025).
  1655
  1656     GO TO 1999-CALC-REF-AMT-X.
  1657*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1659*---------------------------------------------------------------
  1660 1030-GET-AH-REFUND.
  1661     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1662
  1663     COMPUTE R78-FACTOR =
  1664            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1665                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1666
  1667*    IF CP-TERM-TIMES-TERM
  1668*        COMPUTE R78-FACTOR =
  1669*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1670*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1671*
  1672
  1673**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1674**** FOLLOWING.
  1675****       FOR VA. DISABILITY
  1676****                         --- EFF DATE > 123192 AND
  1677****                             TERM > 61 USE RULE OF ANTIC
  1678****                             OTHERWISE USE RULE OF 78.
  1679****
  1680****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1681****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1682****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1683****            WILL FOLLOW.
  1684****
  1685****
  1686****
  1687     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1688        IF CP-STATE-STD-ABBRV = 'VA'
  1689           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1690              (CP-ORIGINAL-TERM GREATER THAN 61)
  1691               MOVE '6'        TO CP-EARNING-METHOD
  1692               GO TO 1060-ANTICIPATION-REF
  1693            ELSE
  1694               MOVE '1'        TO CP-EARNING-METHOD
  1695               GO TO 1050-R78-REF.
  1696
  1697     IF CP-STATE-STD-ABBRV = 'WY'
  1698        IF CP-COMPANY-ID = 'TMS'
  1699           GO TO 1050-R78-REF.
  1700
  1701     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC' OR 'AHL'
  1702         NEXT SENTENCE
  1703     ELSE
  1704         IF CP-CRITICAL-PERIOD
  1705             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1706
  1707
  1708*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1709*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1710*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1711*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1712
  1713     IF (CP-GAP-NON-REFUNDABLE)
  1714        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1715           OR (CP-BENEFIT-CD = '55' OR '56')
  1716           MOVE ZEROS            TO CP-CALC-REFUND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1717           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1718           GO TO 1999-CALC-REF-AMT-X
  1719        END-IF
  1720     END-IF
  1721
  1722     IF CP-GAP-ACTUARIAL
  1723         GO TO 1070-NET-PAY-REFUND
  1724     END-IF
  1725
  1726     IF (CP-COMPANY-ID = 'CID')
  1727        AND (CP-STATE-STD-ABBRV = 'MN')
  1728        AND (DC-GREG-DATE-CYMD > 20091231)
  1729        IF (CP-CRITICAL-PERIOD)
  1730           GO TO 1040-PR-REF
  1731        ELSE
  1732           GO TO 1055-MEAN-REF
  1733     END-IF
  1734
  1735     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC'
  1736        IF CP-STATE-STD-ABBRV = 'NC'
  1737           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1738
  1739     IF (CP-COMPANY-ID = 'CID')
  1740        AND (CP-STATE-STD-ABBRV = 'IN')
  1741        AND (DC-GREG-DATE-CYMD < 20030401)
  1742        GO TO 1026-REF-R78
  1743     END-IF
  1744
  1745     IF (CP-COMPANY-ID = 'CID')
  1746        AND (CP-STATE-STD-ABBRV = 'FL')
  1747        AND (DC-GREG-DATE-CYMD > 20030630)
  1748        AND (CP-CRITICAL-PERIOD)
  1749        GO TO 1040-PR-REF
  1750     END-IF
  1751
  1752     IF (CP-COMPANY-ID = 'CID')
  1753        AND (CP-STATE-STD-ABBRV = 'MO')
  1754        AND (DC-GREG-DATE-CYMD > 20030630)
  1755        AND (CP-CRITICAL-PERIOD)
  1756        GO TO 1040-PR-REF
  1757     END-IF
  1758
  1759     IF (CP-COMPANY-ID = 'CID')
  1760        AND (CP-STATE-STD-ABBRV = 'ND')
  1761        AND (CP-CRITICAL-PERIOD)
  1762        AND (DC-GREG-DATE-CYMD > 20011231)
  1763        GO TO 1040-PR-REF
  1764     END-IF
  1765
  1766     IF (CP-COMPANY-ID = 'CID')
  1767        AND (CP-STATE-STD-ABBRV = 'ND')
  1768        AND (DC-GREG-DATE-CYMD > 20011231)
  1769        GO TO 1060-ANTICIPATION-REF
  1770     END-IF
  1771
  1772     IF CP-STATE-STD-ABBRV = 'NC'
  1773       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1774          NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1775       END-IF
  1776         IF DC-GREG-DATE-CYMD GREATER 19810930
  1777            IF CP-EARN-ANTICIPATION
  1778                GO TO 1060-ANTICIPATION-REF
  1779            ELSE
  1780                GO TO 1055-MEAN-REF.
  1781
  1782 SKIP-CSO-NC-AH-PROCESSING.
  1783
  1784     IF CP-STATE-STD-ABBRV = 'NM'
  1785       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL'
  1786          NEXT SENTENCE
  1787       END-IF
  1788         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1789            IF CP-COMPANY-ID = 'MON'
  1790              MOVE '6'             TO CP-EARNING-METHOD
  1791              GO TO 1060-ANTICIPATION-REF
  1792             ELSE
  1793              GO TO 1055-MEAN-REF.
  1794
  1795     IF CP-STATE-STD-ABBRV = 'CT'
  1796       IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC'
  1797          NEXT SENTENCE
  1798       END-IF
  1799          MOVE '6'              TO CP-EARNING-METHOD
  1800          GO TO 1060-ANTICIPATION-REF.
  1801
  1802     IF CP-STATE-STD-ABBRV = 'ME'
  1803       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC'
  1804          NEXT SENTENCE
  1805       END-IF
  1806           IF CP-EARN-BY-PRORATA
  1807              GO TO 1040-PR-REF
  1808           ELSE
  1809              MOVE '6'           TO CP-EARNING-METHOD
  1810              GO TO 1060-ANTICIPATION-REF.
  1811
  1812
  1813     IF CP-COMPANY-ID = 'CID' OR 'DCC'
  1814        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1815            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1816
  1817     IF CP-STATE-STD-ABBRV = 'TX'
  1818       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1819          NEXT SENTENCE
  1820       END-IF
  1821        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1822           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1823           MOVE '6'              TO CP-EARNING-METHOD
  1824           GO TO 1060-ANTICIPATION-REF.
  1825
  1826     IF CP-STATE-STD-ABBRV = 'VA'
  1827       IF CP-COMPANY-ID EQUAL 'NCL'
  1828          NEXT SENTENCE
  1829       END-IF
  1830       IF CP-COMPANY-ID = 'NCB'
  1831           MOVE '6'                TO CP-EARNING-METHOD
  1832           GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1833       ELSE
  1834           IF DC-GREG-DATE-CYMD GREATER 19921231
  1835               IF CP-ORIGINAL-TERM GREATER THAN 61
  1836                   MOVE '6'        TO CP-EARNING-METHOD
  1837                   GO TO 1060-ANTICIPATION-REF
  1838               ELSE
  1839                   MOVE '1'        TO CP-EARNING-METHOD
  1840                   GO TO 1050-R78-REF.
  1841
  1842 SKIP-CSO-TX-VA-AH-PROCESSING.
  1843
  1844     IF CP-EARN-BY-PRORATA
  1845         GO TO 1040-PR-REF.
  1846
  1847     IF CP-EARN-BY-R78
  1848         GO TO 1050-R78-REF.
  1849
  1850     IF CP-EARN-AS-MEAN
  1851        GO TO 1055-MEAN-REF.
  1852
  1853     IF CP-EARN-AS-SUM-OF-DIGITS
  1854         GO TO 1075-SUM-OF-DIGITS.
  1855
  1856     IF CP-DCC-SPP-DDF
  1857        GO TO 1080-DCC-DDF-SPECIAL
  1858     END-IF
  1859
  1860     IF CP-EARN-AS-CALIF
  1861         GO TO 1060-ANTICIPATION-REF.
  1862
  1863     IF CP-EARN-ANTICIPATION
  1864         GO TO 1060-ANTICIPATION-REF.
  1865
  1866     IF CP-EARN-AS-NET-PAY
  1867         GO TO 1070-NET-PAY-REFUND.
  1868
  1869     GO TO 1050-R78-REF.
  1870
  1871*---------------------------------------------------------------
  1872 1035-REF-AH-CRITICAL-PERIOD.
  1873     IF CP-REMAINING-TERM GREATER +6
  1874        COMPUTE CP-CALC-REFUND ROUNDED =
  1875          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1876                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1877      ELSE
  1878        COMPUTE CP-CALC-REFUND ROUNDED =
  1879          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1880                                           CP-REMAINING-TERM + 1)
  1881                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1882
  1883     IF CP-CALC-REFUND LESS ZERO
  1884         MOVE ZERO TO CP-CALC-REFUND.
  1885
  1886     GO TO 1999-CALC-REF-AMT-X.
  1887
  1888*---------------------------------------------------------------
  1889 1040-PR-REF.
  1890     MOVE '2'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1891     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1892
  1893     GO TO 1999-CALC-REF-AMT-X.
  1894
  1895*---------------------------------------------------------------
  1896 1050-R78-REF.
  1897     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1898     COMPUTE CP-CALC-REFUND ROUNDED =
  1899           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1900
  1901     GO TO 1999-CALC-REF-AMT-X.
  1902
  1903*---------------------------------------------------------------
  1904 1055-MEAN-REF.
  1905     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1906     COMPUTE CP-CALC-REFUND ROUNDED =
  1907         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1908          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1909
  1910     GO TO 1999-CALC-REF-AMT-X.
  1911
  1912*---------------------------------------------------------------
  1913 1060-ANTICIPATION-REF.
  1914     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1915
  1916     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1917     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1918     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  1919
  1920     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  1921                               CP-LOAN-TERM.
  1922     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  1923
  1924     PERFORM 2500-GET-RATE.
  1925
  1926     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  1927     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  1928
  1929     IF CP-PREMIUM-RATE = ZEROS
  1930        MOVE '7'                 TO CP-RETURN-CODE
  1931        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1932        GO TO 1999-CALC-REF-AMT-X.
  1933
  1934     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1935
  1936     PERFORM 2500-GET-RATE.
  1937
  1938     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1939
  1940     IF CP-PREMIUM-RATE = ZEROS
  1941        MOVE '7'            TO CP-RETURN-CODE
  1942        GO TO 1999-CALC-REF-AMT-X.
  1943
  1944     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1945
  1946     IF  WS-ORIG-PREM = ZERO
  1947         MOVE ZERO                TO WS-NP-REF-FACTOR
  1948        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1949         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1950                                            WS-ORIG-PREM.
  1951
  1952     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1953                                        CP-ORIGINAL-PREMIUM.
  1954
  1955     IF NOT CP-EARN-AS-CALIF
  1956         GO TO 1999-CALC-REF-AMT-X.
  1957
  1958*---------------------------------------------------------------
  1959 1065-CALIF-REGS.
  1960     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1961     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1962         GIVING FACTOR-5.
  1963
  1964     IF FACTOR-5 NOT GREATER +6  AND
  1965        CP-CLASS-CODE = 'A '
  1966         GO TO 1050-R78-REF.
  1967
  1968     IF FACTOR-5 = ZERO
  1969         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  1970         GO TO 1999-CALC-REF-AMT-X.
  1971
  1972     IF CP-ORIGINAL-TERM LESS +014
  1973         GO TO 1999-CALC-REF-AMT-X.
  1974
  1975     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  1976                                   GIVING FACTOR-5 ROUNDED.
  1977
  1978     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  1979
  1980     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  1981                                   GIVING FACTOR-2 ROUNDED.
  1982
  1983     SUBTRACT FACTOR-2 FROM FACTOR-1.
  1984     ADD +0.099375 TO FACTOR-1.
  1985
  1986     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1987                                   GIVING FACTOR-5 ROUNDED.
  1988
  1989     SUBTRACT +1.00 FROM FACTOR-5.
  1990
  1991     IF CP-ORIGINAL-TERM LESS +049
  1992         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  1993                                   GIVING FACTOR-6 ROUNDED
  1994     ELSE
  1995         MOVE +035 TO FACTOR-6.
  1996
  1997     MOVE +001 TO FACTOR-2.
  1998
  1999     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2000     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2001     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2002     MOVE +001 TO FACTOR-2.
  2003     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2004
  2005     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2006         GIVING CAL-RFND ROUNDED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2007
  2008     IF CAL-RFND LESS +0.01
  2009         MOVE ZEROS TO CAL-RFND.
  2010
  2011     IF CAL-RFND LESS CP-CALC-REFUND
  2012         MOVE CAL-RFND TO CP-CALC-REFUND.
  2013
  2014     GO TO 1999-CALC-REF-AMT-X.
  2015
  2016*-----------------------------------------------------------------
  2017 1070-NET-PAY-REFUND.
  2018     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2019     IF CP-LOAN-APR = ZERO
  2020         MOVE ZEROS              TO  CP-CALC-REFUND
  2021         MOVE '1'                TO  CP-RETURN-CODE
  2022         GO TO 1999-CALC-REF-AMT-X.
  2023
  2024     MOVE CP-LOAN-APR            TO  N-P-APR.
  2025     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2026     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2027
  2028     MOVE 'R'                    TO  N-P-OPT.
  2029
  2030     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2031
  2032     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2033                                        CP-ORIGINAL-PREMIUM.
  2034
  2035     GO TO 1999-CALC-REF-AMT-X.
  2036*---------------------------------------------------------------
  2037
  2038 1075-SUM-OF-DIGITS.
  2039
  2040     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2041
  2042     COMPUTE RSUM-REMAINING-TERM =
  2043             CP-LOAN-TERM -
  2044                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2045
  2046     COMPUTE RSUM-FACTOR =
  2047        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2048               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2049                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2050            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2051               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2052                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2053
  2054     COMPUTE CP-CALC-REFUND ROUNDED =
  2055           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2056
  2057     GO TO 1999-CALC-REF-AMT-X
  2058
  2059     .
  2060 1080-DCC-DDF-SPECIAL.
  2061
  2062     COMPUTE CP-MONTH =
  2063        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2064*    DISPLAY ' BEGIN ELCRFNDP ************** '
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2065*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2066*    DISPLAY ' MONTH      ' CP-MONTH
  2067*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2068*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2069*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2070*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2071*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2072*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2073*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
  2074*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2075*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2076*    DISPLAY '   END ELCRFNDP ************** '
  2077
  2078     IF CP-MONTH = 0
  2079        MOVE 12                  TO CP-MONTH
  2080     END-IF
  2081     MOVE CP-MONTH               TO WS-MONTH
  2082
  2083     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2084
  2085     IF CP-DCC-SPP-DDF-IU
  2086        GO TO 1090-DCC-DDF-IU
  2087     END-IF
  2088
  2089     IF CP-CALC-CLP
  2090        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2091     END-IF
  2092
  2093     EVALUATE TRUE
  2094        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2095           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2096           MOVE CP-ORIGINAL-PREMIUM
  2097                                 TO CP-CALC-REFUND
  2098
  2099        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2100           MOVE CP-MONTH         TO WS-MONTH
  2101           PERFORM 1150-UE-GROSS-LT-4
  2102           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2103
  2104        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2105           MOVE CP-MONTH         TO WS-MONTH
  2106           PERFORM 1160-UE-GROSS-LT-13
  2107           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2108
  2109        WHEN OTHER
  2110           MOVE CP-MONTH         TO WS-MONTH
  2111           PERFORM 1170-UE-GROSS-GT-12
  2112           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2113     END-EVALUATE
  2114
  2115     GO TO 1999-CALC-REF-AMT-X
  2116
  2117     .
  2118 1085-DCC-DDF-SPECIAL-CLP.
  2119
  2120     EVALUATE TRUE
  2121        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2122           OR (CP-ORIGINAL-PREMIUM = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2123           MOVE CP-ORIGINAL-PREMIUM
  2124                                 TO CP-CALC-REFUND
  2125
  2126        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2127           MOVE CP-MONTH         TO WS-MONTH
  2128           PERFORM 1100-UE-CLP-LT-4
  2129           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2130
  2131        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2132           MOVE CP-MONTH         TO WS-MONTH
  2133           PERFORM 1110-UE-CLP-LT-13
  2134           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2135
  2136        WHEN OTHER
  2137           MOVE CP-MONTH         TO WS-MONTH
  2138           PERFORM 1120-UE-CLP-GT-12
  2139           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2140     END-EVALUATE
  2141
  2142     GO TO 1999-CALC-REF-AMT-X
  2143
  2144     .
  2145 1090-DCC-DDF-IU.
  2146
  2147     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2148
  2149     IF CP-CALC-CLP
  2150        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
  2151     END-IF
  2152
  2153     EVALUATE TRUE
  2154        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2155           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2156           MOVE CP-ORIGINAL-PREMIUM
  2157                                 TO CP-CALC-REFUND
  2158
  2159        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2160           MOVE CP-MONTH         TO WS-MONTH
  2161           PERFORM 1250-IU-UE-GROSS-LT-4
  2162           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2163
  2164        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2165           MOVE CP-MONTH         TO WS-MONTH
  2166           PERFORM 1260-IU-UE-GROSS-LT-13
  2167           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2168
  2169        WHEN OTHER
  2170           MOVE CP-MONTH         TO WS-MONTH
  2171           PERFORM 1270-IU-UE-GROSS-GT-12
  2172           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2173
  2174     END-EVALUATE
  2175
  2176     GO TO 1999-CALC-REF-AMT-X
  2177
  2178     .
  2179 1095-DCC-DDF-IU-SPECIAL-CLP.
  2180
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2181     EVALUATE TRUE
  2182        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2183           OR (CP-DDF-CLP = ZEROS)
  2184           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2185
  2186        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2187           MOVE CP-MONTH         TO WS-MONTH
  2188           PERFORM 1200-IU-UE-CLP-LT-4
  2189           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2190
  2191        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2192           MOVE CP-MONTH         TO WS-MONTH
  2193           PERFORM 1210-IU-UE-CLP-LT-13
  2194           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2195
  2196        WHEN OTHER
  2197           MOVE CP-MONTH         TO WS-MONTH
  2198           PERFORM 1220-IU-UE-CLP-GT-12
  2199           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2200
  2201     END-EVALUATE
  2202
  2203     GO TO 1999-CALC-REF-AMT-X
  2204
  2205     .
  2206 1100-UE-CLP-LT-4.
  2207
  2208*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2209
  2210     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2211        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2212        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2213        * WS-MONTH / 12)
  2214
  2215     .
  2216 1110-UE-CLP-LT-13.
  2217
  2218*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2219*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2220*****  -CLP*UEF1}*(mo-3)/9]
  2221
  2222     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2223        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2224        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2225        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2226        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
  2227        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
  2228        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2229
  2230     .
  2231 1120-UE-CLP-GT-12.
  2232
  2233*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2234
  2235     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2236        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2237        * WS-MONTH / 12)
  2238
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2239     .
  2240 1150-UE-GROSS-LT-4.
  2241
  2242     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2243     COMPUTE WS-TEMP-RESULT ROUNDED =
  2244        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2245        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2246        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2247        * WS-MONTH / 12
  2248
  2249     .
  2250 1160-UE-GROSS-LT-13.
  2251
  2252     MOVE 3                      TO WS-MONTH
  2253     PERFORM 1150-UE-GROSS-LT-4
  2254     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2255     MOVE CP-MONTH               TO WS-MONTH
  2256     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2257        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2258        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2259
  2260     .
  2261 1170-UE-GROSS-GT-12.
  2262
  2263*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2264
  2265     COMPUTE WS-TEMP-RESULT ROUNDED =
  2266        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2267        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2268        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2269
  2270     .
  2271 1200-IU-UE-CLP-LT-4.
  2272
  2273*****  no changes with < 4  pema 08/03/11
  2274*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2275
  2276     COMPUTE WS-TEMP-RESULT ROUNDED =
  2277        (CP-DDF-CLP - 0)
  2278        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2279        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2280        * WS-MONTH / 12
  2281
  2282     .
  2283 1210-IU-UE-CLP-LT-13.
  2284
  2285
  2286*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2287*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2288*****  - CLP*UEF1]*(mo-3)/9
  2289
  2290     MOVE 3                      TO WS-MONTH
  2291     PERFORM 1200-IU-UE-CLP-LT-4
  2292     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2293     MOVE CP-MONTH               TO WS-MONTH
  2294     COMPUTE WS-TEMP-RESULT ROUNDED =
  2295        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2296          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2297
  2298     .
  2299 1220-IU-UE-CLP-GT-12.
  2300
  2301*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2302
  2303     COMPUTE WS-TEMP-RESULT ROUNDED =
  2304        (CP-DDF-CLP - CP-CLP-RATE-UP)
  2305        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2306        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2307
  2308     .
  2309 1250-IU-UE-GROSS-LT-4.
  2310
  2311*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2312*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2313*****  (1-UEF1)]*mo/12
  2314
  2315     PERFORM 1200-IU-UE-CLP-LT-4
  2316     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2317
  2318     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2319        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2320        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2321        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2322        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2323        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2324        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2325
  2326     .
  2327 1260-IU-UE-GROSS-LT-13.
  2328
  2329***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2330
  2331     MOVE 3                      TO WS-MONTH
  2332     PERFORM 1250-IU-UE-GROSS-LT-4
  2333     move cp-month               to ws-month
  2334     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2335     COMPUTE WS-TEMP-RESULT ROUNDED =
  2336        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2337        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2338        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2339
  2340     .
  2341 1270-IU-UE-GROSS-GT-12.
  2342
  2343***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2344
  2345     COMPUTE WS-TEMP-RESULT ROUNDED =
  2346        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2347        - CP-CLP-RATE-UP) *
  2348        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2349        * WS-MONTH / 12)
  2350
  2351     .
  2352 1299-END-DDF-CALCS.
  2353     .
  2354 1999-CALC-REF-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ELRFNDX.cbl
  2355     GOBACK.
  2356
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ELRFNDX.cbl
  2358 2500-GET-RATE.
  2359     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  2360
  2361 2500-EXIT.
  2362      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ELRFNDX.cbl
  2364
  2365 9100-CONVERT-DATE.
  2366     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  2367
  2368 9100-EXIT.
  2369      EXIT.
  2370
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ELRFNDX.cbl
  2372 10000-NET-TERM SECTION.
* 2373                             COPY ERCNETP.
  2374***************************************************************** 04/29/98
  2375*                                                               * ERCNETP
  2376*                            ERCNETP                            *    LV006
  2377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  2378*                            VMOD=2.029                         *    CL**3
  2379*                                                               * ERCNETP
  2380*****************************************************************.ERCNETP
  2381*                                                                 ERCNETP
  2382*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  2383*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  2384*                                   ORIGINAL TERM (S999)          ERCNETP
  2385*                                   REMAINING TERM (S999)         ERCNETP
  2386*                                   NET PAY OPTION (X)            ERCNETP
  2387*                                   LOAN TERM (S999)              ERCNETP
  2388*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  2389*                                                                 ERCNETP
  2390*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  2391*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  2392*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  2393*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  2394*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  2395*    CHARGED.                                                     ERCNETP
  2396*                                                                 ERCNETP
  2397*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  2398*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  2399*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  2400*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  2401*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  2402*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  2403*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  2404*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  2405*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  2406*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  2407*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  2408*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  2409******************************************************************
  2410*                   C H A N G E   L O G
  2411*
  2412* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2413*-----------------------------------------------------------------
  2414*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2415* EFFECTIVE    NUMBER
  2416*-----------------------------------------------------------------
  2417* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2418* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2419* 120403                   PEMA  ADD SPECIAL TX CALC
  2420* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2421* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2422* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2423* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2424* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2425* 021207                   PEMA  ADD PA NP
  2426* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2427* 032807                   PEMA  ADD VT NP PLUS 2
  2428* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2429* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2430* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2431* 110207      TO 'AL' NET PAY CALC
  2432* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2433* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2434* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2435* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2436* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2437* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2438* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2439* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2440* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2441* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2442* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2443* 032612  CR2011110200001  PEMA  AHL CHANGES
  2444******************************************************************
  2445                                                                  ERCNETP
  2446     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  2447     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  2448     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  2449     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  2450     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  2451                                                                  ERCNETP
  2452     MOVE +0 TO FACTOR.                                           ERCNETP
  2453                                                                  ERCNETP
  2454     IF ANNUAL-INT-RATE = ZERO                                    ERCNETP
  2455         GO TO 99000-ERROR.                                       ERCNETP
  2456     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  2457         GO TO 99999-RETURN.                                      ERCNETP
  2458     IF REMAINING-TERM = ZERO                                     ERCNETP
  2459         GO TO 99999-RETURN.                                      ERCNETP
  2460     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  2461         GO TO 99000-ERROR.                                       ERCNETP
  2462     IF LOAN-TERM = ZERO                                          ERCNETP
  2463         GO TO 99999-RETURN.                                      ERCNETP
  2464     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  2465         GO TO 99000-ERROR.                                       ERCNETP
  2466                                                                  ERCNETP
  2467*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2468*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2469*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2470*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2471*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2472*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2473                                                                  ERCNETP
  2474     IF NPO-REFUND                                                ERCNETP
  2475         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
  2476       ELSE                                                       ERCNETP
  2477         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  2478            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  2479           ELSE                                                   ERCNETP
  2480            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  2481                                                                  ERCNETP
  2482     IF NPO-SIMPLE                                                ERCNETP
  2483         MOVE 'S' TO TYPE-SW                                      ERCNETP
  2484     ELSE                                                         ERCNETP
  2485         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  2486                                                                  ERCNETP
  2487     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2488                                                                  ERCNETP
  2489     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  2490                                                                  ERCNETP
  2491     MOVE V     TO VX                                             ERCNETP
  2492                   SV.                                            ERCNETP
  2493                                                                  ERCNETP
  2494     MOVE +1    TO X1                                             ERCNETP
  2495                   SX.                                            ERCNETP
  2496                                                                  ERCNETP
  2497     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  2498                                                                  ERCNETP
  2499     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  2500                                                                  ERCNETP
  2501     IF MAX-X = +1                                                ERCNETP
  2502        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  2503                                                                  ERCNETP
  2504     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  2505                                                                  ERCNETP
  2506     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  2507         OR 'DCC'        OR 'NCL') AND                            ERCNETP
  2508        (NOT NP-REFUND)                                           ERCNETP
  2509        NEXT SENTENCE                                             ERCNETP
  2510     ELSE                                                         ERCNETP
  2511     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  2512        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  2513                                                                  ERCNETP
  2514     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  2515                                                                  ERCNETP
  2516 10500-VX-LOOP.                                                   ERCNETP
  2517                                                                  ERCNETP
  2518***  VX = AMORT. LOAN TERM.                                       ERCNETP
  2519***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  2520***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  2521***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  2522***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  2523                                                                  ERCNETP
  2524     IF X2 = 1
  2525        MOVE V         TO SX
  2526     END-IF
  2527     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  2528                                                                  ERCNETP
  2529     ADD B1 TO X1.                                                ERCNETP
  2530                                                                  ERCNETP
  2531     IF X1 = REMAINING-TERM                                       ERCNETP
  2532          MOVE VX    TO SV.                                       ERCNETP
  2533                                                                  ERCNETP
  2534     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  2535        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  2536                                                                  ERCNETP
  2537     IF X1 = X2                                                   ERCNETP
  2538          MOVE VX    TO SX.                                       ERCNETP
  2539                                                                  ERCNETP
  2540     IF X1 NOT = MAX-X                                            ERCNETP
  2541          GO TO 10500-VX-LOOP.                                    ERCNETP
  2542                                                                  ERCNETP
  2543 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  2544*****  WK1 = LOAN TERM AMORT
  2545     COMPUTE WK1 = K1 - VX.                                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2546*****  WK2 = INS TERM AMORT
  2547     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  2548*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2549     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  2550*****  WK6 = INS TERM - 1
  2551     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  2552                                                                  ERCNETP
  2553     IF NP-RATING                                                 ERCNETP
  2554         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  2555                                                                  ERCNETP
  2556     IF NP-REFUND                                                 ERCNETP
  2557         GO TO 11000-REFUND-CALC.                                 ERCNETP
  2558                                                                  ERCNETP
  2559     IF NET-STD                                                   ERCNETP
  2560         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  2561                                                                  ERCNETP
  2562     IF NET-SMP                                                   ERCNETP
  2563         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  2564         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  2565         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  2566         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  2567                                                                  ERCNETP
  2568     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  2569         MOVE +0 TO WK3.                                          ERCNETP
  2570                                                                  ERCNETP
  2571     MOVE WK3 TO FACTOR.                                          ERCNETP
  2572                                                                  ERCNETP
  2573     GO TO 99999-RETURN.                                          ERCNETP
  2574                                                                  ERCNETP
  2575 11000-REFUND-CALC.                                               ERCNETP
  2576     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  2577        MOVE +1 TO FACTOR                                         ERCNETP
  2578        GO TO 99999-RETURN.                                       ERCNETP
  2579                                                                  ERCNETP
  2580     IF REMAINING-TERM LESS +1                                    ERCNETP
  2581        MOVE 0 TO FACTOR                                          ERCNETP
  2582        GO TO 99999-RETURN.                                       ERCNETP
  2583                                                                  ERCNETP
  2584     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  2585     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  2586     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  2587                                                                  ERCNETP
  2588     IF (CP-COMPANY-ID EQUAL 'CID')
  2589        AND (CP-STATE-STD-ABBRV = 'MN')
  2590        AND (CP-CERT-EFF-DT > X'A4FF')
  2591        AND (CP-RATE-AS-REG-BALLOON)
  2592        AND (CP-EARN-AS-NET-PAY)
  2593        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2594        CONTINUE
  2595     ELSE
  2596        GO TO 11000-CHECK-MN-LEV-BALLOON
  2597     END-IF
  2598
  2599     COMPUTE R = M - E
  2600     COMPUTE FACTOR = (R - WK2 + WK5) /
  2601        (M - WK1 + WK5)
  2602
  2603     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2604
  2605      .
  2606 11000-CHECK-MN-LEV-BALLOON.
  2607
  2608     IF (CP-COMPANY-ID EQUAL 'CID')
  2609        AND (CP-STATE-STD-ABBRV = 'MN')
  2610        AND (CP-CERT-EFF-DT > X'A4FF')
  2611        AND (CP-RATE-AS-REG-BALLOON)
  2612        AND (CP-EARN-AS-NET-PAY)
  2613        AND (CP-DEVIATION-CODE = 'LEV')
  2614        CONTINUE
  2615     ELSE
  2616        GO TO 11000-CONTINUE-REFUND
  2617     END-IF
  2618
  2619     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2620     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2621        ** (M - E)) / I
  2622
  2623     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2624
  2625     GO TO 99999-RETURN
  2626
  2627     .
  2628 11000-CONTINUE-REFUND.
  2629
  2630*    IF CP-GAP-ACTUARIAL
  2631*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2632*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2633*       COMPUTE WK3 = WK2 / ANGLEN
  2634*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2635
  2636     IF CP-GAP-ACTUARIAL
  2637        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2638           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2639        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2640     ELSE
  2641        COMPUTE WK3 ROUNDED =
  2642          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2643     END-IF
  2644                                                                  ERCNETP
  2645     MOVE WK3  TO FACTOR.                                         ERCNETP
  2646                                                                  ERCNETP
  2647     GO TO 99999-RETURN.                                          ERCNETP
  2648                                                                  ERCNETP
  2649 12000-PREMIUM-RATE.                                              ERCNETP
  2650*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  2651*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  2652*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  2653*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  2654*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  2655*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  2656                                                                  ERCNETP
  2657     COMPUTE K-I = K1 + I.                                        ERCNETP
  2658     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  2659                                                                  ERCNETP
  2660     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  2661         MOVE K1 TO K-I.                                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2662                                                                  ERCNETP
  2663     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  2664         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  2665                                                                  ERCNETP
  2666     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  2667         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  2668                                                                  ERCNETP
  2669     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  2670         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  2671                                                                  ERCNETP
  2672     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  2673             ((X2 * (X2 + 1)) /                                   ERCNETP
  2674              (N *  (N  + 1))).                                   ERCNETP
  2675                                                                  ERCNETP
  2676     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  2677        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  2678        NEXT SENTENCE                                             ERCNETP
  2679     ELSE                                                         ERCNETP
  2680        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  2681                                                                  ERCNETP
  2682     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  2683     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  2684     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2685                                                                  ERCNETP
  2686     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2687        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2688        MOVE ZEROS               TO FACTOR                        ERCNETP
  2689                                    CP-CALC-PREMIUM               ERCNETP
  2690         GO TO 99999-RETURN.                                      ERCNETP
  2691                                                                  ERCNETP
  2692     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  2693     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  2694     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  2695     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2696                                                                  ERCNETP
  2697     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2698        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2699        MOVE ZEROS               TO FACTOR                        ERCNETP
  2700                                    CP-CALC-PREMIUM               ERCNETP
  2701         GO TO 99999-RETURN.                                      ERCNETP
  2702                                                                  ERCNETP
  2703     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
  2704                                                                  ERCNETP
  2705     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
  2706                                                                  ERCNETP
  2707     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  2708        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2709        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  2710     ELSE                                                         ERCNETP
  2711        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2712        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  2713                                                                  ERCNETP
  2714     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  2715     13).                                                         ERCNETP
  2716                                                                  ERCNETP
  2717     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  2718     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  2719                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2720     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  2721                                                                  ERCNETP
  2722     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  2723       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  2724                                                                  ERCNETP
  2725     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  2726       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  2727       WS-CALC-FREQ-RATE).                                        ERCNETP
  2728                                                                  ERCNETP
  2729     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  2730       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  2731                                                                  ERCNETP
  2732     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  2733       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  2734                                                                  ERCNETP
  2735     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  2736       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  2737       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  2738                                                                  ERCNETP
  2739     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  2740                                                                  ERCNETP
  2741     GO TO 99999-RETURN.                                          ERCNETP
  2742                                                                  ERCNETP
  2743 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  2744                                                                  ERCNETP
  2745     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  2746        NEXT SENTENCE                                             ERCNETP
  2747     ELSE                                                         ERCNETP
  2748        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  2749                                                                  ERCNETP
  2750      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2751                                                                  ERCNETP
  2752      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2753                                                                  ERCNETP
  2754      COMPUTE WK3 EQUAL                                           ERCNETP
  2755        (12 *                                                     ERCNETP
  2756        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  2757        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
  2758        APR100.                                                   ERCNETP
  2759                                                                  ERCNETP
  2760     COMPUTE WK3 EQUAL                                            ERCNETP
  2761        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
  2762                                                                  ERCNETP
  2763     COMPUTE WK3 EQUAL                                            ERCNETP
  2764        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  2765                                                                  ERCNETP
  2766      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2767                                                                  ERCNETP
  2768     GO TO 99999-RETURN.                                          ERCNETP
  2769                                                                  ERCNETP
  2770 12000-CHECK-CLIENT.                                              ERCNETP
  2771                                                                  ERCNETP
  2772     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  2773        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2774        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2775        NEXT SENTENCE                                             ERCNETP
  2776     ELSE                                                         ERCNETP
  2777        GO TO 12000-CHECK-NEXT.                                   ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2778                                                                  ERCNETP
  2779     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2780                                                                  ERCNETP
  2781     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2782     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2783                                                                  ERCNETP
  2784     COMPUTE FM EQUAL                                             ERCNETP
  2785                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  2786                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  2787                    - 1.                                          ERCNETP
  2788                                                                  ERCNETP
  2789     COMPUTE FN EQUAL                                             ERCNETP
  2790                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  2791                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  2792                    - 1.                                          ERCNETP
  2793                                                                  ERCNETP
  2794     COMPUTE FNM EQUAL                                            ERCNETP
  2795                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  2796                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  2797                    - 1.                                          ERCNETP
  2798                                                                  ERCNETP
  2799     COMPUTE GR EQUAL                                             ERCNETP
  2800                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  2801                    (M - ANGLEM).                                 ERCNETP
  2802                                                                  ERCNETP
  2803     COMPUTE ODF EQUAL                                            ERCNETP
  2804                     (1 +                                         ERCNETP
  2805                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  2806                     360)) /                                      ERCNETP
  2807                     ONE-PLUS-I.                                  ERCNETP
  2808                                                                  ERCNETP
  2809     COMPUTE OD EQUAL                                             ERCNETP
  2810                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  2811                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  2812                                                                  ERCNETP
  2813     COMPUTE WK3 EQUAL                                            ERCNETP
  2814*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  2815                    ((1 + FN) * ODF *                             ERCNETP
  2816                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  2817                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  2818                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  2819                                                                  ERCNETP
  2820     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
  2821     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
  2822                                                                  ERCNETP
  2823     COMPUTE WK3 EQUAL                                            ERCNETP
  2824                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  2825*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  2826                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  2827                                                                  ERCNETP
  2828      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2829                                                                  ERCNETP
  2830     GO TO 99999-RETURN.                                          ERCNETP
  2831                                                                  ERCNETP
  2832 12000-CHECK-NEXT.                                                ERCNETP
  2833                                                                  ERCNETP
  2834     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  2835        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2836     ELSE                                                         ERCNETP
  2837        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  2838                                                                  ERCNETP
  2839      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  2840         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  2841         MOVE ZEROS              TO FACTOR                        ERCNETP
  2842                                    CP-CALC-PREMIUM               ERCNETP
  2843         GO TO 99999-RETURN.                                      ERCNETP
  2844                                                                  ERCNETP
  2845      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2846                                                                  ERCNETP
  2847      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2848                                                                  ERCNETP
  2849      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  2850         ADD .00001 TO APR100.                                    ERCNETP
  2851                                                                  ERCNETP
  2852      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  2853      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  2854                                                                  ERCNETP
  2855
  2856
  2857     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2858        / (1 + I)
  2859     COMPUTE ANGLEN-1 = ANGLEN / Y
  2860
  2861      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  2862         COMPUTE WK3 EQUAL                                        ERCNETP
  2863                                                                  ERCNETP
  2864          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  2865          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  2866                                                                  ERCNETP
  2867          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2868                                                                  ERCNETP
  2869          ((WK8 ** N) /                                           ERCNETP
  2870          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2871                                                                  ERCNETP
  2872          ((WK9 ** N) /                                           ERCNETP
  2873          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
  2874                                                                  ERCNETP
  2875      ELSE                                                        ERCNETP
  2876         COMPUTE WK3 EQUAL                                        ERCNETP
  2877                                                                  ERCNETP
  2878          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2879          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
  2880                                                                  ERCNETP
  2881          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2882                                                                  ERCNETP
  2883          ((WK8 ** N) /                                           ERCNETP
  2884          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2885                                                                  ERCNETP
  2886          ((WK9 ** N) /                                           ERCNETP
  2887          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  2888                                                                  ERCNETP
  2889      COMPUTE WK3 EQUAL                                           ERCNETP
  2890          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  2891                                                                  ERCNETP
  2892      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2893                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2894     GO TO 99999-RETURN.                                          ERCNETP
  2895                                                                  ERCNETP
  2896 12000-CHECK-PA-TRUNC.                                            ERCNETP
  2897                                                                  ERCNETP
  2898     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2899        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  2900        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2901        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2902        NEXT SENTENCE                                             ERCNETP
  2903     ELSE                                                         ERCNETP
  2904        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  2905                                                                  ERCNETP
  2906     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2907                                                                  ERCNETP
  2908     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2909     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2910                                                                  ERCNETP
  2911     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2912                                                                  ERCNETP
  2913     COMPUTE WK3 EQUAL                                            ERCNETP
  2914        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  2915        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  2916                                                                  ERCNETP
  2917     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2918                                                                  ERCNETP
  2919     GO TO 99999-RETURN.                                          ERCNETP
  2920                                                                  ERCNETP
  2921 12000-CHECK-MD-TRUNC.                                            ERCNETP
  2922                                                                  ERCNETP
  2923     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2924        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2925        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2926        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2927        NEXT SENTENCE                                             ERCNETP
  2928     ELSE                                                         ERCNETP
  2929        GO TO 12000-CHECK-MD.                                     ERCNETP
  2930                                                                  ERCNETP
  2931     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2932                                                                  ERCNETP
  2933     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2934     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2935     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2936                                                                  ERCNETP
  2937     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2938                                                                  ERCNETP
  2939     COMPUTE WK3 EQUAL                                            ERCNETP
  2940        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  2941        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  2942        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  2943                                                                  ERCNETP
  2944     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2945                                                                  ERCNETP
  2946     GO TO 99999-RETURN.                                          ERCNETP
  2947                                                                  ERCNETP
  2948 12000-CHECK-MD.                                                  ERCNETP
  2949                                                                  ERCNETP
  2950     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2951        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2952        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  2953        NEXT SENTENCE                                             ERCNETP
  2954     ELSE                                                         ERCNETP
  2955        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  2956                                                                  ERCNETP
  2957     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2958                                                                  ERCNETP
  2959     COMPUTE WK3 EQUAL                                            ERCNETP
  2960        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  2961                                                                  ERCNETP
  2962     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2963                                                                  ERCNETP
  2964     GO TO 99999-RETURN.                                          ERCNETP
  2965                                                                  ERCNETP
  2966 12000-CHECK-ME-TRUNC.                                            ERCNETP
  2967                                                                  ERCNETP
  2968     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  2969        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  2970        AND (CP-EARN-AS-NET-PAY)
  2971        AND (CP-TRUNCATED-LIFE)
  2972        CONTINUE
  2973     ELSE
  2974        GO TO 12000-CHECK-CID-FARMPLAN
  2975     END-IF
  2976                                                                  ERCNETP
  2977     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  2978
  2979     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2980
  2981     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2982
  2983     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2984
  2985     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2986     COMPUTE ANGLEN-1 = ANGLEN / Y
  2987
  2988     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2989
  2990     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  2991
  2992     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  2993
  2994     COMPUTE WK3
  2995        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  2996        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  2997            * (1 / (1.0635 ** (M / 12))))
  2998
  2999*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  3000*    COMPUTE WK9 EQUAL                                            ERCNETP
  3001*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  3002*    COMPUTE WK7 EQUAL                                            ERCNETP
  3003*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  3004*    COMPUTE WK3 EQUAL                                            ERCNETP
  3005*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  3006*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  3007*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  3008*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  3009*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3010*                                                                 ERCNETP
  3011     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3012                                                                  ERCNETP
  3013     GO TO 99999-RETURN.                                          ERCNETP
  3014
  3015 12000-CHECK-CID-FARMPLAN.
  3016
  3017     IF (CP-COMPANY-ID EQUAL 'CID')
  3018        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3019           OR 'IN' OR 'AZ')
  3020        AND (CP-FARM-PLAN)
  3021        CONTINUE
  3022     ELSE
  3023        GO TO 12000-CHECK-SC-CID
  3024     END-IF
  3025
  3026     COMPUTE N = M / CP-PAY-FREQUENCY
  3027     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3028     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3029        ** CP-PAY-FREQUENCY) - 1
  3030     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3031     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3032        ** TI) / WS-WORK-DIS-RATE
  3033     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3034     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3035     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3036        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3037     COMPUTE WK2 = WK2 * (1 + J)
  3038     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3039     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3040     COMPUTE WK3 = WK3 * (1 + J)
  3041     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3042        ** (N - 1))) / J
  3043     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3044        ((N * WK2) - WK5)) + (N * WK1)) *
  3045        (CP-PREMIUM-RATE / 1000)
  3046     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3047     COMPUTE WK6 = (WK7 * GR)
  3048
  3049     MOVE WK6 TO CP-CALC-PREMIUM
  3050
  3051     GO TO 99999-RETURN
  3052
  3053     .
  3054 12000-CHECK-SC-CID.
  3055
  3056     IF (CP-COMPANY-ID EQUAL 'CID')
  3057        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  3058        AND (CP-EARN-AS-NET-PAY)
  3059        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3060        CONTINUE
  3061     ELSE
  3062        GO TO 12000-CHECK-AL-CID
  3063     END-IF
  3064
  3065
  3066
  3067     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3068     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3069     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3070     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3071     COMPUTE ANGLEN-1 = ANGLEN / Y
  3072     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3073        / 12)) / ((M + 1) / 2)
  3074     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3075     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3076        + 6 * M) * (WK2 / 100) * (1 + I)
  3077
  3078
  3079     MOVE WK3 TO CP-CALC-PREMIUM
  3080
  3081     GO TO 99999-RETURN
  3082
  3083     .
  3084 12000-CHECK-AL-CID.
  3085
  3086     IF (CP-COMPANY-ID EQUAL 'CID')
  3087        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3088        AND (CP-EARN-AS-NET-PAY)
  3089        CONTINUE
  3090     ELSE
  3091        GO TO 12000-CHECK-NH-CID
  3092     END-IF
  3093
  3094     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3095     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3096     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3097
  3098     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3099                   / (1 + I)
  3100
  3101     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3102
  3103     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3104
  3105     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3106        (CP-PREMIUM-RATE / 1000)
  3107
  3108     MOVE WK3 TO CP-CALC-PREMIUM
  3109
  3110     GO TO 99999-RETURN
  3111
  3112     .
  3113 12000-CHECK-NH-CID.
  3114
  3115     IF (CP-COMPANY-ID EQUAL 'CID')
  3116        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3117        AND (CP-EARN-AS-NET-PAY)
  3118        CONTINUE
  3119     ELSE
  3120        GO TO 12000-CHECK-PA-CID
  3121     END-IF
  3122
  3123     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3124     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3125
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3126     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3127                   / (1 + I)
  3128
  3129     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3130
  3131     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3132
  3133     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3134        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3135
  3136     MOVE WK3 TO CP-CALC-PREMIUM
  3137
  3138     GO TO 99999-RETURN
  3139
  3140     .
  3141 12000-CHECK-PA-CID.
  3142
  3143     IF (CP-COMPANY-ID EQUAL 'CID')
  3144        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3145        AND (CP-EARN-AS-NET-PAY)
  3146        CONTINUE
  3147     ELSE
  3148        GO TO 12000-CHECK-ME-CID
  3149     END-IF
  3150
  3151
  3152     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3153     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3154     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3155     COMPUTE ANGLEN-1 = ANGLEN / Y
  3156     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3157     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3158     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3159     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3160        * WK5
  3161
  3162     MOVE WK3 TO CP-CALC-PREMIUM
  3163
  3164     GO TO 99999-RETURN
  3165
  3166     .
  3167 12000-CHECK-ME-CID.
  3168
  3169     IF (CP-COMPANY-ID EQUAL 'CID')
  3170        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3171        AND (CP-EARN-AS-NET-PAY)
  3172        CONTINUE
  3173     ELSE
  3174        GO TO 12000-CHECK-VT-TRUNC
  3175     END-IF
  3176
  3177     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3178
  3179     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3180
  3181     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3182     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3183     COMPUTE ANGLEN-1 = ANGLEN / Y
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3184
  3185     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3186
  3187     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3188
  3189     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3190        * WK5
  3191
  3192     MOVE WK3 TO CP-CALC-PREMIUM
  3193
  3194     GO TO 99999-RETURN
  3195
  3196     .
  3197 12000-CHECK-VT-TRUNC.                                            ERCNETP
  3198                                                                  ERCNETP
  3199     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3200        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  3201        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3202        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3203        NEXT SENTENCE                                             ERCNETP
  3204     ELSE                                                         ERCNETP
  3205        GO TO 12000-CHECK-VT.                                     ERCNETP
  3206                                                                  ERCNETP
  3207      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  3208                                                                  ERCNETP
  3209      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3210                                                                  ERCNETP
  3211      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3212                                                                  ERCNETP
  3213      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  3214      COMPUTE WK9 EQUAL                                           ERCNETP
  3215        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  3216        ((.0054 - I) / (1 + I)).                                  ERCNETP
  3217      COMPUTE WK7 EQUAL                                           ERCNETP
  3218        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
  3219      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
  3220        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  3221                                                                  ERCNETP
  3222      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3223                                                                  ERCNETP
  3224     GO TO 99999-RETURN.                                          ERCNETP
  3225                                                                  ERCNETP
  3226 12000-CHECK-VT.                                                  ERCNETP
  3227                                                                  ERCNETP
  3228     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3229        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  3230        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3231        NEXT SENTENCE                                             ERCNETP
  3232     ELSE                                                         ERCNETP
  3233        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  3234                                                                  ERCNETP
  3235      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  3236                                                                  ERCNETP
  3237      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3238                                                                  ERCNETP
  3239      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3240                                                                  ERCNETP
  3241      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3242                        (ANGLEN-1 * I)) *                         ERCNETP
  3243                                                                  ERCNETP
  3244                        (((1.0054 ** N - 1) /                     ERCNETP
  3245                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  3246                                                                  ERCNETP
  3247                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  3248                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  3249                                                                  ERCNETP
  3250      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3251                                                                  ERCNETP
  3252     GO TO 99999-RETURN.                                          ERCNETP
  3253                                                                  ERCNETP
  3254 12000-CHECK-MINN-WDS.                                            ERCNETP
  3255                                                                  ERCNETP
  3256     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3257        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3258        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3259        NEXT SENTENCE                                             ERCNETP
  3260     ELSE                                                         ERCNETP
  3261        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  3262                                                                  ERCNETP
  3263     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3264     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  3265              (N / +12) * (2 / (N + 1)).                          ERCNETP
  3266     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  3267         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  3268                                                                  ERCNETP
  3269      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3270                                                                  ERCNETP
  3271     GO TO 99999-RETURN.                                          ERCNETP
  3272                                                                  ERCNETP
  3273 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  3274                                                                  ERCNETP
  3275     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3276        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3277        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3278        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3279        NEXT SENTENCE                                             ERCNETP
  3280     ELSE                                                         ERCNETP
  3281        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  3282                                                                  ERCNETP
  3283     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3284                                                                  ERCNETP
  3285     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  3286                                                                  ERCNETP
  3287     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3288        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  3289                                                                  ERCNETP
  3290     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3291                                                                  ERCNETP
  3292     GO TO 99999-RETURN.                                          ERCNETP
  3293                                                                  ERCNETP
  3294 12000-CHECK-MINN-BALL.                                           ERCNETP
  3295                                                                  ERCNETP
  3296     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3297        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3298        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3299        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3300     ELSE                                                         ERCNETP
  3301        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  3302                                                                  ERCNETP
  3303     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3304     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3305                                                                  ERCNETP
  3306     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3307     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3308     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  3309                                                                  ERCNETP
  3310      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3311                                                                  ERCNETP
  3312     GO TO 99999-RETURN.                                          ERCNETP
  3313                                                                  ERCNETP
  3314 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  3315                                                                  ERCNETP
  3316     IF (CP-COMPANY-ID EQUAL 'CID')
  3317        AND (CP-STATE-STD-ABBRV = 'MN')
  3318        AND (CP-CERT-EFF-DT > X'A4FF')
  3319        AND (CP-EARN-AS-REG-BALLOON)
  3320        CONTINUE
  3321     ELSE
  3322        GO TO 12000-CHECK-NC-WDS
  3323     END-IF
  3324                                                                  ERCNETP
  3325     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3326     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3327     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3328     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3329     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3330     COMPUTE V = 1 / (1 + I)
  3331     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3332     COMPUTE Y = (1 + (D * I) / +30)
  3333        / (1 + I)
  3334
  3335
  3336     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3337        * CP-PREMIUM-RATE / 1000
  3338
  3339*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3340*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3341*    ELSE
  3342*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3343*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3344*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3345*       DISPLAY ' BALLOON TOP ' WK6
  3346*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3347*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3348*          / 100
  3349*       DISPLAY ' BALLOON BOTTOM ' WK7
  3350*       COMPUTE GR = WK6 / WK7
  3351*       DISPLAY ' BALLOON PAYMENT ' GR
  3352*    END-IF
  3353
  3354     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3355     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3356        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3357     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3358
  3359     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3360        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3361           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3362           * CP-PREMIUM-RATE / 1000
  3363
  3364     MOVE WK3                    TO CP-CALC-PREMIUM
  3365                                                                  ERCNETP
  3366     GO TO 99999-RETURN.                                          ERCNETP
  3367
  3368     .
  3369 12000-CHECK-NC-WDS.                                              ERCNETP
  3370                                                                  ERCNETP
  3371     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3372        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3373        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3374        NEXT SENTENCE                                             ERCNETP
  3375     ELSE                                                         ERCNETP
  3376        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  3377                                                                  ERCNETP
  3378     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  3379     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3380     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
  3381              CP-PREMIUM-RATE / +100 *                            ERCNETP
  3382              N / +12 * 2 / (N + 1) *                             ERCNETP
  3383              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  3384                                                                  ERCNETP
  3385      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3386                                                                  ERCNETP
  3387     GO TO 99999-RETURN.                                          ERCNETP
  3388                                                                  ERCNETP
  3389 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  3390                                                                  ERCNETP
  3391     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3392        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3393        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3394        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3395        NEXT SENTENCE                                             ERCNETP
  3396     ELSE                                                         ERCNETP
  3397        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  3398                                                                  ERCNETP
  3399     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3400                                                                  ERCNETP
  3401**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3402                                                                  ERCNETP
  3403     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3404        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
  3405                                                                  ERCNETP
  3406     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3407                                                                  ERCNETP
  3408     GO TO 99999-RETURN.                                          ERCNETP
  3409                                                                  ERCNETP
  3410 12000-CHECK-NC-BALL.                                             ERCNETP
  3411                                                                  ERCNETP
  3412     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3413        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3414        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3415        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3416     ELSE                                                         ERCNETP
  3417        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
  3418                                                                  ERCNETP
  3419     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  3420     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3421     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3422**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3423                                                                  ERCNETP
  3424     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3425     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3426     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  3427                                                                  ERCNETP
  3428      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3429                                                                  ERCNETP
  3430     GO TO 99999-RETURN.                                          ERCNETP
  3431                                                                  ERCNETP
  3432 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  3433                                                                  ERCNETP
  3434     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3435        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3436        (M GREATER THAN +63) AND                                  ERCNETP
  3437        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3438        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3439        NEXT SENTENCE                                             ERCNETP
  3440     ELSE                                                         ERCNETP
  3441        GO TO 12000-CHECK-MINN.                                   ERCNETP
  3442                                                                  ERCNETP
  3443      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3444      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3445                                                                  ERCNETP
  3446      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3447                                                                  ERCNETP
  3448      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3449       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3450       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  3451                                                                  ERCNETP
  3452      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3453                                                                  ERCNETP
  3454     GO TO 99999-RETURN.                                          ERCNETP
  3455                                                                  ERCNETP
  3456 12000-CHECK-MINN.                                                ERCNETP
  3457                                                                  ERCNETP
  3458     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3459        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3460        (M GREATER THAN +63) AND                                  ERCNETP
  3461        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3462        NEXT SENTENCE                                             ERCNETP
  3463     ELSE                                                         ERCNETP
  3464        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  3465                                                                  ERCNETP
  3466      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3467                                                                  ERCNETP
  3468      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3469                                                                  ERCNETP
  3470      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3471       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3472       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  3473                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3474      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3475                                                                  ERCNETP
  3476     GO TO 99999-RETURN.                                          ERCNETP
  3477                                                                  ERCNETP
  3478 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  3479                                                                  ERCNETP
  3480     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3481        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3482        (M GREATER THAN +63) AND                                  ERCNETP
  3483        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3484        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3485        NEXT SENTENCE                                             ERCNETP
  3486     ELSE                                                         ERCNETP
  3487        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  3488                                                                  ERCNETP
  3489      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3490      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3491                                                                  ERCNETP
  3492      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3493                                                                  ERCNETP
  3494      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  3495      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3496       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
  3497                                                                  ERCNETP
  3498      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3499                                                                  ERCNETP
  3500     GO TO 99999-RETURN.                                          ERCNETP
  3501                                                                  ERCNETP
  3502 12000-CHECK-MONTANA.                                             ERCNETP
  3503                                                                  ERCNETP
  3504     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3505        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3506        (M GREATER THAN +63) AND                                  ERCNETP
  3507        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3508        NEXT SENTENCE                                             ERCNETP
  3509     ELSE                                                         ERCNETP
  3510        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  3511                                                                  ERCNETP
  3512      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3513                                                                  ERCNETP
  3514      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3515                                                                  ERCNETP
  3516      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3517       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3518       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  3519                                                                  ERCNETP
  3520      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3521                                                                  ERCNETP
  3522     GO TO 99999-RETURN.                                          ERCNETP
  3523                                                                  ERCNETP
  3524 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  3525                                                                  ERCNETP
  3526     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3527        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3528        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3529        NEXT SENTENCE                                             ERCNETP
  3530     ELSE                                                         ERCNETP
  3531        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3532                                                                  ERCNETP
  3533      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3534      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3535                                                                  ERCNETP
  3536      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3537                                                                  ERCNETP
  3538      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  3539      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  3540      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  3541                                                                  ERCNETP
  3542      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3543                                                                  ERCNETP
  3544     GO TO 99999-RETURN.                                          ERCNETP
  3545                                                                  ERCNETP
  3546 12001-CONTINUE-NCL.                                              ERCNETP
  3547                                                                  ERCNETP
  3548     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3549        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3550        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3551        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  3552                                                                  ERCNETP
  3553     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3554        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  3555        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3556        GO TO 12001-CHECK-CA.                                     ERCNETP
  3557                                                                  ERCNETP
  3558     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3559        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3560        NEXT SENTENCE                                             ERCNETP
  3561     ELSE                                                         ERCNETP
  3562        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  3563                                                                  ERCNETP
  3564      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3565      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  3566                                                                  ERCNETP
  3567      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3568                                                                  ERCNETP
  3569      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3570       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3571       ((N - ANGLEN) / I).                                        ERCNETP
  3572                                                                  ERCNETP
  3573      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3574                                                                  ERCNETP
  3575     GO TO 99999-RETURN.                                          ERCNETP
  3576                                                                  ERCNETP
  3577 12000-CONTINUE-NET.                                              ERCNETP
  3578                                                                  ERCNETP
  3579     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  3580        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  3581        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3582        NEXT SENTENCE                                             ERCNETP
  3583     ELSE                                                         ERCNETP
  3584        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  3585                                                                  ERCNETP
  3586      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  3587      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  3588                                                                  ERCNETP
  3589      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3590      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  3591      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
  3592       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  3593                                                                  ERCNETP
  3594      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  3595         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  3596                                                                  ERCNETP
  3597      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  3598                                                                  ERCNETP
  3599      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  3600         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  3601         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  3602                                                                  ERCNETP
  3603      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3604                                                                  ERCNETP
  3605     GO TO 99999-RETURN.                                          ERCNETP
  3606                                                                  ERCNETP
  3607 12001-CONTINUE-MINN.                                             ERCNETP
  3608                                                                  ERCNETP
  3609     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3610        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  3611        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3612        NEXT SENTENCE                                             ERCNETP
  3613     ELSE                                                         ERCNETP
  3614        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  3615                                                                  ERCNETP
  3616      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3617      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  3618                                                                  ERCNETP
  3619      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  3620       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  3621       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  3622                                                                  ERCNETP
  3623      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  3624       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  3625                                                                  ERCNETP
  3626     GO TO 99999-RETURN.                                          ERCNETP
  3627                                                                  ERCNETP
  3628 12001-CHECK-RI-GTL.                                              ERCNETP
  3629                                                                  ERCNETP
  3630     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3631        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  3632        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3633        NEXT SENTENCE                                             ERCNETP
  3634     ELSE                                                         ERCNETP
  3635        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  3636                                                                  ERCNETP
  3637      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3638*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  3639                                                                  ERCNETP
  3640      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  3641               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  3642      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  3643         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  3644                                                                  ERCNETP
  3645                                                                  ERCNETP
  3646     GO TO 99999-RETURN.                                          ERCNETP
  3647                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3648 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  3649                                                                  ERCNETP
  3650     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3651        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  3652        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  3653        NEXT SENTENCE                                             ERCNETP
  3654     ELSE                                                         ERCNETP
  3655        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  3656                                                                  ERCNETP
  3657     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3658                                                                  ERCNETP
  3659     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  3660        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  3661                        /                                         ERCNETP
  3662        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  3663     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  3664       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  3665                            /                                     ERCNETP
  3666       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  3667                                                                  ERCNETP
  3668     GO TO 99999-RETURN.                                          ERCNETP
  3669                                                                  ERCNETP
  3670 12001-CHECK-OR-GTL.                                              ERCNETP
  3671                                                                  ERCNETP
  3672     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3673        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  3674        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3675        NEXT SENTENCE                                             ERCNETP
  3676     ELSE                                                         ERCNETP
  3677        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  3678                                                                  ERCNETP
  3679     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3680     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3681                                                                  ERCNETP
  3682     IF M LESS THAN +64                                           ERCNETP
  3683        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  3684         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  3685                   /                                              ERCNETP
  3686         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  3687        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  3688     ELSE                                                         ERCNETP
  3689        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  3690        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  3691                  /                                               ERCNETP
  3692        (+1000 * I * ANGLEN)                                      ERCNETP
  3693        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  3694*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3695     GO TO 99999-RETURN.                                          ERCNETP
  3696                                                                  ERCNETP
  3697 12001-CHECK-GA-GTL.                                              ERCNETP
  3698                                                                  ERCNETP
  3699     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3700        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  3701        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3702*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  3703        NEXT SENTENCE                                             ERCNETP
  3704     ELSE                                                         ERCNETP
  3705        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3706                                                                  ERCNETP
  3707     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3708     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3709                                                                  ERCNETP
  3710     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  3711     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  3712      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  3713     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3714                                                                  ERCNETP
  3715     GO TO 99999-RETURN.                                          ERCNETP
  3716                                                                  ERCNETP
  3717 12001-CHECK-MA-GTL.                                              ERCNETP
  3718                                                                  ERCNETP
  3719     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3720        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  3721        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3722        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  3723        NEXT SENTENCE                                             ERCNETP
  3724     ELSE                                                         ERCNETP
  3725        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  3726                                                                  ERCNETP
  3727     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3728                                                                  ERCNETP
  3729     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
  3730      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  3731                                                                  ERCNETP
  3732     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  3733     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  3734                                                                  ERCNETP
  3735     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  3736     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  3737     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3738                                                                  ERCNETP
  3739     GO TO 99999-RETURN.                                          ERCNETP
  3740                                                                  ERCNETP
  3741 12001-CHECK-NV-NET.                                              ERCNETP
  3742
  3743     IF (CP-COMPANY-ID EQUAL 'CID')
  3744        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  3745        AND (CP-EARN-AS-NET-PAY)
  3746        CONTINUE
  3747     ELSE
  3748        GO TO 12001-CHECK-MN-NET
  3749     END-IF
  3750
  3751     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3752     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3753
  3754     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3755                   / (1 + I)
  3756
  3757     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3758
  3759     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3760
  3761     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3762        (CP-PREMIUM-RATE * K-I / 1000)
  3763
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3764     MOVE WK3                    TO CP-CALC-PREMIUM
  3765
  3766     GO TO 99999-RETURN
  3767
  3768      .
  3769 12001-CHECK-MN-NET.
  3770
  3771     IF (CP-COMPANY-ID EQUAL 'CID')
  3772        AND (CP-STATE-STD-ABBRV = 'MN')
  3773        AND (CP-EARN-AS-NET-PAY)
  3774        AND (NOT CP-LEVEL-LIFE)
  3775        AND (WS-DISCOUNT-OPTION = '1')
  3776        CONTINUE
  3777     ELSE
  3778        GO TO 12001-CHECK-NC-NET
  3779     END-IF
  3780
  3781     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3782     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3783
  3784     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3785                   / (1 + I)
  3786
  3787     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3788
  3789     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3790
  3791     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3792        (CP-PREMIUM-RATE / 1000) * (1 + I)
  3793
  3794     MOVE WK3                    TO CP-CALC-PREMIUM
  3795
  3796     GO TO 99999-RETURN
  3797
  3798      .
  3799 12001-CHECK-NC-NET.                                              ERCNETP
  3800                                                                  ERCNETP
  3801     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  3802        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3803        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3804        NEXT SENTENCE                                             ERCNETP
  3805     ELSE                                                         ERCNETP
  3806        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  3807                                                                  ERCNETP
  3808      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3809      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3810                                                                  ERCNETP
  3811      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  3812          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  3813          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  3814          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  3815                                                                  ERCNETP
  3816      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  3817          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  3818                                                                  ERCNETP
  3819      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  3820          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  3821          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3822          (ANGLEN * 2))                                           ERCNETP
  3823                                                                  ERCNETP
  3824      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  3825                                                                  ERCNETP
  3826      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  3827          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  3828              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  3829          COMPUTE WK3 ROUNDED =                                   ERCNETP
  3830              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  3831                                                                  ERCNETP
  3832     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3833                                                                  ERCNETP
  3834     GO TO 99999-RETURN.                                          ERCNETP
  3835                                                                  ERCNETP
  3836 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
  3837                                                                  ERCNETP
  3838     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND                          ERCNE
  3839        (CP-EARN-AS-NET-PAY) AND                                     ERCNE
  3840        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  3841        NEXT SENTENCE                                                ERCNE
  3842     ELSE                                                            ERCNE
  3843        GO TO 12001-CHECK-CA.                                        ERCNE
  3844                                                                  ERCNETP
  3845     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  3846     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  3847     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3848                                                                  ERCNETP
  3849     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3850        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3851        MOVE ZEROS               TO FACTOR                        ERCNETP
  3852                                    CP-CALC-PREMIUM               ERCNETP
  3853         GO TO 99999-RETURN.                                      ERCNETP
  3854                                                                  ERCNETP
  3855     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  3856        NEXT SENTENCE                                             ERCNETP
  3857     ELSE                                                         ERCNETP
  3858        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  3859                                                                  ERCNETP
  3860     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3861     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3862                                                                  ERCNETP
  3863     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  3864                                                                  ERCNETP
  3865     COMPUTE NC-R = 20 *                                          ERCNETP
  3866                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  3867                          / (ORIGINAL-TERM + 1).                  ERCNETP
  3868                                                                  ERCNETP
  3869     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  3870                                                                  ERCNETP
  3871     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  3872                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  3873                                                                  ERCNETP
  3874     IF CP-EXT-CHG-LF                                             ERCNETP
  3875         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  3876     ELSE                                                         ERCNETP
  3877         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  3878                                                                  ERCNETP
  3879     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3880             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  3881                                                                  ERCNETP
  3882     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  3883             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  3884                                                                  ERCNETP
  3885     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  3886                                                                  ERCNETP
  3887     GO TO 99999-RETURN.                                          ERCNETP
  3888                                                                  ERCNETP
  3889 12001-CHECK-CA.                                                  ERCNETP
  3890                                                                  ERCNETP
  3891     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  3892        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  3893        NEXT SENTENCE                                             ERCNETP
  3894     ELSE                                                         ERCNETP
  3895        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
  3896                                                                  ERCNETP
  3897     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  3898     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3899     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  3900     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  3901     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  3902     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  3903     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  3904         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  3905         ((1 + CA-J) / I) *                                       ERCNETP
  3906         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  3907         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  3908         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  3909                                                                  ERCNETP
  3910     GO TO 99999-RETURN.                                          ERCNETP
  3911                                                                  ERCNETP
  3912 12001-CHECK-GTL-IA.                                              ERCNETP
  3913                                                                  ERCNETP
  3914     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  3915        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  3916        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3917        NEXT SENTENCE                                             ERCNETP
  3918     ELSE                                                         ERCNETP
  3919        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  3920                                                                  ERCNETP
  3921***************************************************************   ERCNETP
  3922                                                                  ERCNETP
  3923     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  3924                                                                  ERCNETP
  3925     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  3926         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  3927     ELSE                                                         ERCNETP
  3928         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  3929             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  3930         ELSE                                                     ERCNETP
  3931             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
  3932                                                                  ERCNETP
  3933     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  3934     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  3935                                                                  ERCNETP
  3936     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  3937                          GTL-IA-SGN.                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3938                                                                  ERCNETP
  3939     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3940     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  3941                                                                  ERCNETP
  3942     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  3943         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  3944         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  3945                                                                  ERCNETP
  3946     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  3947           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  3948                             (ANGLEN - ANGLEN-M))) *                 CL**3
  3949           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  3950                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  3951                                                                     CL**3
  3952     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
  3953      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
  3954                                                                     CL**3
  3955     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  3956                                                                     CL**3
  3957     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  3958                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  3959     GO TO 99999-RETURN.                                          ERCNETP
  3960                                                                  ERCNETP
  3961                                                                  ERCNETP
  3962 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  3963                                                                  ERCNETP
  3964     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  3965        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  3966        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3967        (CP-TRUNCATED-LIFE) AND
  3968        (CP-STATE-STD-ABBRV = CP-STATE)
  3969        CONTINUE                                                  ERCNETP
  3970     ELSE                                                         ERCNETP
  3971        GO TO 12001-CHECK-CID-TX
  3972     END-IF
  3973
  3974     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  3975     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3976     IF WS-WORK-DIS-RATE = ZEROS
  3977        CONTINUE
  3978     ELSE
  3979        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3980        COMPUTE WK7 = (1 / I) *
  3981              (((WK4 ** M - 1) / (WK4 - 1)) -
  3982              ((WK4 ** M * SX - VX) /
  3983              (WK4 * (1 + I) - 1))) *
  3984              (CP-PREMIUM-RATE / 1000)
  3985        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  3986        COMPUTE WK8 = WK7 * 100 / ANGLEN
  3987        COMPUTE CP-CALC-PREMIUM =
  3988           WK8 *  ((WK4 * ANGLEN) / 100)
  3989     END-IF
  3990
  3991     GO TO 99999-RETURN                                           ERCNETP
  3992
  3993     .                                                            ERCNETP
  3994                                                                  ERCNETP
  3995 12001-CHECK-CID-TX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3996
  3997     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3998        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  3999        (CP-EARN-AS-NET-PAY) AND
  4000        (WS-WORK-DIS-RATE > ZEROS) AND
  4001        (CP-STATE-STD-ABBRV = CP-STATE)
  4002        CONTINUE
  4003     ELSE
  4004        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4005     END-IF
  4006* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4007     COMPUTE K-I = 1 + (1 * I)
  4008     COMPUTE ANGLEN EQUAL WK1 / I
  4009     COMPUTE ANGLEM EQUAL WK2 / I
  4010     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4011     IF WS-WORK-DIS-RATE = ZEROS
  4012        CONTINUE
  4013     ELSE
  4014        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4015        COMPUTE WK7 = (K-I / I) *
  4016              (((WK4 ** M - 1) / (WK4 - 1)) -
  4017*             ((WK4 ** M * SX - VX) /
  4018              ((WK4 ** M * SX) - VX) /
  4019*             (WK4 * (1 + I) - 1))) *
  4020              (WK4 * (1 + I) - 1)) *
  4021              (CP-PREMIUM-RATE / 1000)
  4022        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4023        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4024        COMPUTE CP-CALC-PREMIUM =
  4025           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4026     END-IF
  4027
  4028     GO TO 99999-RETURN
  4029
  4030     .
  4031 12001-CHECK-CID-LEV-MN-NEW.
  4032
  4033*    IF (CP-COMPANY-ID EQUAL 'CID')
  4034*       AND (CP-STATE-STD-ABBRV = 'MN')
  4035*       AND (CP-EARN-AS-NET-PAY)
  4036*       AND (CP-LEVEL-LIFE)
  4037*       AND (CP-CERT-EFF-DT > X'A4FF')
  4038*       CONTINUE
  4039*    ELSE
  4040*       GO TO 12001-CHECK-CID-LEV-MN
  4041*    END-IF
  4042*
  4043*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4044*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4045*    MOVE '1'                    TO DC-OPTION-CODE
  4046*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4047*
  4048*    IF DATE-CONVERSION-ERROR
  4049*       MOVE '2'                 TO CP-RETURN-CODE
  4050*       MOVE ZEROS               TO FACTOR
  4051*                                   CP-CALC-PREMIUM
  4052*       GO TO 99999-RETURN
  4053*    END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4054*
  4055*    COMPUTE I = CP-LOAN-APR / 100
  4056*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4057*
  4058*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4059*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4060*      * 12 / 360 * D)
  4061*
  4062*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4063*       * 12 / 360 * D
  4064*
  4065*    GO TO 99999-RETURN
  4066
  4067      .
  4068 12001-CHECK-CID-LEV-MN.                                          ERCNETP
  4069                                                                  ERCNETP
  4070     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4071        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4072        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4073        (CP-LEVEL-LIFE) AND
  4074        (CP-STATE-STD-ABBRV = CP-STATE)
  4075        CONTINUE                                                  ERCNETP
  4076     ELSE                                                         ERCNETP
  4077        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  4078     END-IF
  4079
  4080     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4081         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4082         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4083
  4084     GO TO 99999-RETURN                                           ERCNETP
  4085
  4086      .
  4087 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  4088                                                                  ERCNETP
  4089     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4090        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4091        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4092        (CP-LEVEL-LIFE) AND
  4093        (CP-STATE-STD-ABBRV = CP-STATE)
  4094        CONTINUE                                                  ERCNETP
  4095     ELSE                                                         ERCNETP
  4096        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  4097     END-IF
  4098
  4099     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4100     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4101     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4102     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4103     COMPUTE CP-CALC-PREMIUM =
  4104          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4105          (CP-PREMIUM-RATE / 1000)) /
  4106          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4107
  4108     GO TO 99999-RETURN                                           ERCNETP
  4109
  4110      .
  4111 12001-CHECK-CID-TRN-CA.                                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4112                                                                  ERCNETP
  4113     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4114        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4115        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4116        (CP-TRUNCATED-LIFE) AND
  4117        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4118        (WS-DISCOUNT-OPTION NOT = ' ')
  4119        CONTINUE                                                  ERCNETP
  4120     ELSE                                                         ERCNETP
  4121        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  4122     END-IF
  4123
  4124     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4125     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4126     IF WS-WORK-DIS-RATE = ZEROS
  4127        CONTINUE
  4128     ELSE
  4129        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4130        COMPUTE WK7 = (1 / I) *
  4131              (((WK4 ** M - 1) / (WK4 - 1)) -
  4132              ((WK4 ** M * SX - VX) /
  4133              (WK4 * (1 + I) - 1))) *
  4134              (CP-PREMIUM-RATE / 1000)
  4135        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4136        COMPUTE CP-CALC-PREMIUM =
  4137           WK4 *  WK7
  4138     END-IF
  4139
  4140     GO TO 99999-RETURN                                           ERCNETP
  4141
  4142      .
  4143 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  4144                                                                  ERCNETP
  4145     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4146        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4147                   OR
  4148        ((CP-STATE-STD-ABBRV = 'IN') AND
  4149        (CP-CERT-EFF-DT > X'9A7F'))
  4150                   OR
  4151        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4152        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4153        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4154        (CP-TRUNCATED-LIFE) AND
  4155        (CP-STATE-STD-ABBRV = CP-STATE)
  4156        CONTINUE                                                  ERCNETP
  4157     ELSE                                                         ERCNETP
  4158        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  4159     END-IF
  4160
  4161* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4162     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4163        MOVE 0                   TO K-I
  4164     ELSE
  4165        MOVE 2                   TO K-I
  4166     END-IF
  4167     COMPUTE CP-TERM-OR-EXT-DAYS =
  4168           CP-TERM-OR-EXT-DAYS + 30
  4169
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4170     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4171     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4172     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4173                   / (1 + I)
  4174     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4175     IF WS-WORK-DIS-RATE = ZEROS
  4176        CONTINUE
  4177     ELSE
  4178        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4179*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4180        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4181              (((WK4 ** M - 1) / (WK4 - 1)) -
  4182              ((WK4 ** M * SX - VX) /
  4183              (WK4 * (1 + I) - 1))) *
  4184              (CP-PREMIUM-RATE / 1000)
  4185        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4186*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4187        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4188        COMPUTE CP-CALC-PREMIUM =
  4189           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4190*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4191     END-IF
  4192
  4193     GO TO 99999-RETURN                                           ERCNETP
  4194
  4195     .                                                            ERCNETP
  4196 12001-CHECK-CID-MT.                                              ERCNETP
  4197                                                                  ERCNETP
  4198     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4199        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4200                                OR 'VT')
  4201                   OR
  4202        ((CP-STATE-STD-ABBRV = 'IN') AND
  4203        (CP-CERT-EFF-DT > X'9A7F'))
  4204                   OR
  4205        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4206        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4207        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4208        (CP-STATE-STD-ABBRV = CP-STATE)
  4209        CONTINUE                                                  ERCNETP
  4210     ELSE                                                         ERCNETP
  4211        GO TO 12001-CHECK-DCC-DD
  4212     END-IF
  4213
  4214     COMPUTE CP-TERM-OR-EXT-DAYS =
  4215           CP-TERM-OR-EXT-DAYS + 30
  4216
  4217* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4218     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4219        MOVE 0                   TO K-I
  4220     ELSE
  4221        IF CP-STATE-STD-ABBRV = 'NJ'
  4222           MOVE 1                TO K-I
  4223        ELSE
  4224           MOVE 2                TO K-I
  4225        END-IF
  4226     END-IF
  4227     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4228     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4229     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4230                   / (1 + I)
  4231     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4232     IF WS-WORK-DIS-RATE = ZEROS
  4233        CONTINUE
  4234     ELSE
  4235        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4236*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4237        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4238              (((WK4 ** N - 1) / (WK4 - 1)) -
  4239              ((WK4 ** N - SV) /
  4240              (WK4 * (1 + I) - 1))) *
  4241              (CP-PREMIUM-RATE / 1000)
  4242        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4243*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4244        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4245        COMPUTE CP-CALC-PREMIUM =
  4246           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4247*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4248     END-IF
  4249
  4250     GO TO 99999-RETURN                                           ERCNETP
  4251
  4252     .                                                            ERCNETP
  4253
  4254 12001-CHECK-DCC-DD.
  4255
  4256     IF (CP-COMPANY-ID EQUAL 'DCC')
  4257        AND (CP-EARN-AS-NET-PAY)
  4258        AND (CP-BEN-CATEGORY = 'D')
  4259        CONTINUE
  4260     ELSE
  4261        GO TO 12001-CHECK-DCC-NET
  4262     END-IF
  4263
  4264     COMPUTE CP-TERM-OR-EXT-DAYS =
  4265           CP-TERM-OR-EXT-DAYS + 30
  4266
  4267     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4268     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4269     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4270                                                                  ERCNETP
  4271     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4272           / (1 + I)
  4273
  4274     COMPUTE GR     = ANGLEN / ODF
  4275*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4276*      CP-RATE-DEV-PCT
  4277
  4278     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4279
  4280     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4281       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4282     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4283     MOVE WK3                    TO CP-CALC-PREMIUM
  4284
  4285     GO TO 99999-RETURN                                           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4286
  4287     .                                                            ERCNETP
  4288
  4289 12001-CHECK-DCC-NET.                                             ERCNETP
  4290                                                                  ERCNETP
  4291     IF (CP-COMPANY-ID EQUAL 'DCC')
  4292        AND (CP-EARN-AS-NET-PAY)
  4293        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4294             AND 'H' AND 'S' AND 'P')
  4295        CONTINUE                                                  ERCNETP
  4296     ELSE                                                         ERCNETP
  4297        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  4298     END-IF
  4299
  4300     COMPUTE CP-TERM-OR-EXT-DAYS =
  4301           CP-TERM-OR-EXT-DAYS + 30
  4302
  4303     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4304     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4305     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4306                                                                  ERCNETP
  4307     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4308           / (1 + I)
  4309
  4310     COMPUTE GR     = ANGLEN / ODF
  4311     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4312     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4313       CP-RATE-DEV-PCT
  4314     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4315*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4316
  4317     COMPUTE WK8 = CP-PREMIUM-RATE *
  4318        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4319     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4320     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4321     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4322       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4323     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4324     MOVE WK3                    TO CP-CALC-PREMIUM
  4325
  4326     GO TO 99999-RETURN                                           ERCNETP
  4327
  4328     .                                                            ERCNETP
  4329 12001-CHECK-DCC-PNET.                                            ERCNETP
  4330
  4331     IF (CP-COMPANY-ID EQUAL 'DCC')
  4332        AND (CP-EARN-AS-NET-PAY)
  4333        AND (CP-BENEFIT-CD (1:1) = 'P')
  4334        CONTINUE                                                  ERCNETP
  4335     ELSE                                                         ERCNETP
  4336        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  4337     END-IF
  4338
  4339     IF CP-NO-OF-PMTS NOT NUMERIC
  4340        MOVE +0                  TO CP-NO-OF-PMTS
  4341     END-IF
  4342     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4343        AND ' ' AND 'M'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4344        MOVE ' '                 TO CP-PMT-MODE
  4345     END-IF
  4346
  4347     EVALUATE CP-PMT-MODE
  4348        WHEN 'W'
  4349           MOVE +7               TO C-DAYS-IN-PMT-PER
  4350           MOVE +52              TO C-PMTS-PER-YEAR
  4351           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4352        WHEN 'B'
  4353           MOVE +14              TO C-DAYS-IN-PMT-PER
  4354           MOVE +26              TO C-PMTS-PER-YEAR
  4355           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4356        WHEN OTHER
  4357           MOVE +30              TO C-DAYS-IN-PMT-PER
  4358           MOVE +12              TO C-PMTS-PER-YEAR
  4359           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  4360     END-EVALUATE
  4361
  4362     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4363
  4364     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4365        C-DAYS-IN-PMT-PER)) / (1 + I)
  4366
  4367     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4368     COMPUTE ANGLEN-1 = ANGLEN / Y
  4369     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4370
  4371     IF CP-RATE-DEV-PCT NOT = ZEROS
  4372        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4373           CP-PREMIUM-RATE
  4374     END-IF
  4375
  4376     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4377
  4378     GO TO 99999-RETURN
  4379
  4380     .                                                            ERCNETP
  4381 12001-CHECK-DCC-MNET.                                            ERCNETP
  4382                                                                  ERCNETP
  4383     IF (CP-COMPANY-ID EQUAL 'DCC')
  4384        AND (CP-EARN-AS-NET-PAY)
  4385        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4386        CONTINUE                                                  ERCNETP
  4387     ELSE                                                         ERCNETP
  4388        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4389     END-IF
  4390
  4391*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4392*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4393*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4394                                                                  ERCNETP
  4395     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4396     MOVE WK3                    TO CP-CALC-PREMIUM
  4397
  4398     GO TO 99999-RETURN                                           ERCNETP
  4399
  4400     .                                                            ERCNETP
  4401 12001-CHECK-DCC-MNET-LF-BAL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4402                                                                  ERCNETP
  4403     IF (CP-COMPANY-ID EQUAL 'DCC')
  4404        AND (CP-EARN-AS-NET-PAY)
  4405        AND (CP-BENEFIT-CD (1:1) = 'N')
  4406        AND (CP-BEN-CATEGORY NOT = 'N')
  4407        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4408        CONTINUE                                                  ERCNETP
  4409     ELSE                                                         ERCNETP
  4410        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4411     END-IF
  4412
  4413     IF CP-RATE-DEV-PCT NOT = ZEROS
  4414        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4415           CP-PREMIUM-RATE
  4416     END-IF
  4417
  4418*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4419     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4420        / (1 + I)
  4421     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4422     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4423     COMPUTE WK2 = (1 + J) ** (M * -1)
  4424     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4425
  4426     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4427          ** ((M - 1) * -1))) / J)
  4428
  4429     COMPUTE ANGLEM = ((1 - ((1 + J)
  4430          ** (M * -1))) / J) / OD
  4431
  4432     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4433        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4434        / ANGLEM-1
  4435
  4436     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4437          ** ((N - M) * -1))) / I)
  4438
  4439     MOVE +0                     TO WK3
  4440     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4441        (WS-COUNTER > M)
  4442        COMPUTE ANGLEM = (1 - ((1 + J)
  4443          ** ((M - WS-COUNTER) * -1))) / J
  4444        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4445        COMPUTE WK5-CSL = (RA * ANGLEM)
  4446        + (CP-ALTERNATE-BENEFIT * WK2)
  4447        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4448     END-PERFORM
  4449
  4450     MOVE WK3                    TO CP-CALC-PREMIUM
  4451
  4452     GO TO 99999-RETURN                                           ERCNETP
  4453
  4454     .                                                            ERCNETP
  4455 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4456                                                                  ERCNETP
  4457     IF (CP-COMPANY-ID EQUAL 'DCC')
  4458        AND (CP-EARN-AS-NET-PAY)
  4459        AND (CP-BENEFIT-CD (1:1) = 'S')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4460        AND (CP-BEN-CATEGORY NOT = 'N')
  4461        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4462        CONTINUE                                                  ERCNETP
  4463     ELSE                                                         ERCNETP
  4464        GO TO 12001-CHECK-DCC-MNET-LF
  4465     END-IF
  4466
  4467     IF CP-RATE-DEV-PCT NOT = ZEROS
  4468        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4469           CP-PREMIUM-RATE
  4470     END-IF
  4471
  4472     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4473
  4474     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4475          ** ((M - 1) * -1))) / K)
  4476
  4477     COMPUTE ANGLEM = ((1 - ((1 + K)
  4478          ** (M * -1))) / K)
  4479
  4480     MOVE CP-MONTHLY-PAYMENT     TO RA
  4481
  4482     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4483        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4484        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4485        CP-PREMIUM-RATE / 1000
  4486
  4487     MOVE WK3                    TO CP-CALC-PREMIUM
  4488
  4489
  4490     GO TO 99999-RETURN                                           ERCNETP
  4491
  4492     .                                                            ERCNETP
  4493 12001-CHECK-DCC-MNET-LF.
  4494                                                                  ERCNETP
  4495     IF (CP-COMPANY-ID EQUAL 'DCC')
  4496        AND (CP-EARN-AS-NET-PAY)
  4497        AND (CP-BENEFIT-CD (1:1) = 'N')
  4498        AND (CP-BEN-CATEGORY NOT = 'N')
  4499        CONTINUE                                                  ERCNETP
  4500     ELSE                                                         ERCNETP
  4501        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4502     END-IF
  4503
  4504     IF CP-RATE-DEV-PCT NOT = ZEROS
  4505        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4506           CP-PREMIUM-RATE
  4507     END-IF
  4508
  4509*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4510     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4511        / (1 + I)
  4512     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4513     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4514     COMPUTE WK2 = (1 + J) ** (M * -1)
  4515     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4516
  4517
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4518     COMPUTE ANGLEM = ((1 - ((1 + J)
  4519          ** (M * -1))) / J) / OD
  4520     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4521
  4522     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4523          ** ((N - M) * -1))) / I)
  4524
  4525     MOVE +0                     TO WK3
  4526     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4527        (WS-COUNTER > M)
  4528        COMPUTE ANGLEM = (1 - ((1 + J)
  4529          ** ((M - WS-COUNTER + 1) * -1))) / J
  4530        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4531        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4532        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4533     END-PERFORM
  4534
  4535     MOVE WK3                    TO CP-CALC-PREMIUM
  4536
  4537     GO TO 99999-RETURN                                           ERCNETP
  4538
  4539     .                                                            ERCNETP
  4540 12001-CHECK-DCC-MNET-SUMLF.
  4541                                                                  ERCNETP
  4542     IF (CP-COMPANY-ID EQUAL 'DCC')
  4543        AND (CP-EARN-AS-NET-PAY)
  4544        AND (CP-BENEFIT-CD (1:1) = 'S')
  4545        AND (CP-BEN-CATEGORY NOT = 'N')
  4546        CONTINUE                                                  ERCNETP
  4547     ELSE                                                         ERCNETP
  4548        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4549     END-IF
  4550
  4551     IF CP-RATE-DEV-PCT NOT = ZEROS
  4552        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4553           CP-PREMIUM-RATE
  4554     END-IF
  4555
  4556     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4557     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4558        / (1 + K)
  4559
  4560     COMPUTE ANGLEN-M = (WK5 / I)
  4561     COMPUTE WK2 = (1 + K) ** (M * -1)
  4562     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4563     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4564
  4565
  4566     COMPUTE ANGLEM = ((1 - ((1 + K)
  4567          ** (M * -1))) / K) / Y
  4568     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4569
  4570     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4571        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4572        - 1)) / K) * RA
  4573     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4574        + (CP-DAYS-TO-1ST-PMT - +30)
  4575        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4576        +0 / 1000 * 12 / 12)
  4577     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4578        * (12 / 12)
  4579
  4580
  4581     MOVE WK3                    TO CP-CALC-PREMIUM
  4582
  4583     GO TO 99999-RETURN                                           ERCNETP
  4584
  4585     .                                                            ERCNETP
  4586 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4587                                                                  ERCNETP
  4588     IF (CP-COMPANY-ID EQUAL 'DCC')
  4589        AND (CP-EARN-AS-NET-PAY)
  4590        AND (CP-BENEFIT-CD (1:1) = 'N')
  4591        AND (CP-BEN-CATEGORY = 'N')
  4592        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4593        CONTINUE                                                  ERCNETP
  4594     ELSE                                                         ERCNETP
  4595        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4596     END-IF
  4597
  4598*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4599     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4600        / (1 + I)
  4601     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4602     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4603     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4604     COMPUTE WK2 = (1 + J) ** (M * -1)
  4605     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4606
  4607     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4608          ** ((M - 1) * -1))) / J)
  4609
  4610     COMPUTE ANGLEM = ((1 - ((1 + J)
  4611          ** (M * -1))) / J) / OD
  4612
  4613     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4614        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4615        / ANGLEM-1
  4616
  4617     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4618          ** ((N - M) * -1))) / I)
  4619
  4620     MOVE +0                     TO WK3
  4621     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4622        (WS-COUNTER > M)
  4623        COMPUTE ANGLEM = (1 - ((1 + J)
  4624          ** ((M - WS-COUNTER) * -1))) / J
  4625        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4626        COMPUTE WK5-CSL = (RA * ANGLEM)
  4627        + (CP-ALTERNATE-BENEFIT * WK2)
  4628        COMPUTE WK3 = WK3 +
  4629         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4630        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4631          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4632          (CP-DCC-AH-RATE / 1000)
  4633     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4634
  4635     MOVE WK3                    TO CP-CALC-PREMIUM
  4636
  4637     GO TO 99999-RETURN                                           ERCNETP
  4638
  4639     .                                                            ERCNETP
  4640 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4641                                                                  ERCNETP
  4642     IF (CP-COMPANY-ID EQUAL 'DCC')
  4643        AND (CP-EARN-AS-NET-PAY)
  4644        AND (CP-BENEFIT-CD (1:1) = 'S')
  4645        AND (CP-BEN-CATEGORY = 'N')
  4646        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4647        CONTINUE                                                  ERCNETP
  4648     ELSE                                                         ERCNETP
  4649        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4650     END-IF
  4651
  4652
  4653     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4654
  4655     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4656          ** ((M - 1) * -1))) / K)
  4657
  4658     COMPUTE ANGLEM = ((1 - ((1 + K)
  4659          ** (M * -1))) / K)
  4660
  4661     MOVE CP-MONTHLY-PAYMENT     TO RA
  4662
  4663     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4664        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4665        * CP-DCC-AH-RATE / 1000))
  4666        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4667        CP-DCC-LF-RATE / 1000
  4668
  4669     MOVE WK3                    TO CP-LF-PREM
  4670
  4671     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4672        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4673        * CP-DCC-AH-RATE / 1000
  4674
  4675     COMPUTE WK3 = WK3 + WK5-CSL
  4676
  4677
  4678     MOVE WK3                    TO CP-CALC-PREMIUM
  4679
  4680     GO TO 99999-RETURN                                           ERCNETP
  4681
  4682      .
  4683 12001-CHECK-DCC-MNET-TOT-N.
  4684                                                                  ERCNETP
  4685     IF (CP-COMPANY-ID EQUAL 'DCC')
  4686        AND (CP-EARN-AS-NET-PAY)
  4687        AND (CP-BENEFIT-CD (1:1) = 'N')
  4688        AND (CP-BEN-CATEGORY = 'N')
  4689        CONTINUE                                                  ERCNETP
  4690     ELSE                                                         ERCNETP
  4691        GO TO 12001-CHECK-DCC-MNET-TOT-S
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4692     END-IF
  4693
  4694*    I = APR/1200
  4695*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4696*    RA = PAYMENT AMOUNT
  4697*    WK5-CSL = THE BALANCE (PAY OFF )
  4698*    WK3 = THE ACCUMULATED PREMIUM
  4699*    WK2 = (1 + I) ^ (m * -1)
  4700*    OD  = GAMMA
  4701*
  4702*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4703     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4704        / (1 + I)
  4705     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4706     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  4707        (CP-DCC-AH-RATE / +1000)
  4708     COMPUTE WK2 = (1 + J) ** (M * -1)
  4709     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4710
  4711
  4712     COMPUTE ANGLEM = ((1 - ((1 + J)
  4713          ** (M * -1))) / J) / OD
  4714     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4715
  4716     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4717          ** ((N - M) * -1))) / I)
  4718
  4719     MOVE +0                     TO WK3
  4720     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4721        (WS-COUNTER > M)
  4722        COMPUTE ANGLEM = (1 - ((1 + J)
  4723          ** ((M - WS-COUNTER + 1) * -1))) / J
  4724        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4725        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4726        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  4727           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  4728     END-PERFORM
  4729
  4730     MOVE WK3                    TO CP-CALC-PREMIUM
  4731
  4732     GO TO 99999-RETURN                                           ERCNETP
  4733
  4734     .                                                            ERCNETP
  4735 12001-CHECK-DCC-MNET-TOT-S.
  4736                                                                  ERCNETP
  4737     IF (CP-COMPANY-ID EQUAL 'DCC')
  4738        AND (CP-EARN-AS-NET-PAY)
  4739        AND (CP-BENEFIT-CD (1:1) = 'S')
  4740        AND (CP-BEN-CATEGORY = 'N')
  4741        CONTINUE                                                  ERCNETP
  4742     ELSE                                                         ERCNETP
  4743        GO TO 12001-CONTINUE-NET
  4744     END-IF
  4745
  4746*    I = APR/1200
  4747*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  4748*    RA = PAYMENT AMOUNT
  4749*    WK5-CSL = THE BALANCE (PAY OFF )
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4750*    WK3 = THE ACCUMULATED PREMIUM
  4751*    WK2 = (1 + I) ^ (m * -1)
  4752*    OD  = GAMMA
  4753*
  4754     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  4755
  4756     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  4757        / (1 + J)
  4758
  4759     COMPUTE ANGLEM = ((1 - ((1 + J)
  4760          ** (M * -1))) / J) / OD
  4761
  4762     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4763          ** ((N - M) * -1))) / I)
  4764          * (1 + J) ** (-1 * M)
  4765
  4766     COMPUTE ANGLEN-M = ANGLEN-M / OD
  4767
  4768     MOVE CP-MONTHLY-PAYMENT     TO RA
  4769
  4770     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  4771        / +30)
  4772     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  4773        ** (WK1) - 1)) / J) * RA
  4774
  4775     COMPUTE WK5 = (((((M * (M + 1) / 2)
  4776        + (CP-DAYS-TO-1ST-PMT - +30)
  4777        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  4778        CP-DCC-AH-RATE / +1000 * 12 / 12)
  4779
  4780     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  4781        (12 / 12)
  4782
  4783     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  4784        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  4785        (CP-DCC-AH-RATE / +1000) * 12 / 12
  4786
  4787     COMPUTE WK3 = WK3 + WK5-CSL
  4788     MOVE WK3                    TO CP-CALC-PREMIUM
  4789
  4790     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4791     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4792        / (1 + K)
  4793
  4794     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4795          ** ((N - M) * -1))) / I)
  4796     COMPUTE WK2 = (1 + K) ** (M * -1)
  4797     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4798     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4799
  4800
  4801     COMPUTE ANGLEM = ((1 - ((1 + K)
  4802          ** (M * -1))) / K) / Y
  4803
  4804*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4805
  4806     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  4807        ((1 + K) ** (M + 1 / Y
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4808        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4809        - 1)) / K) * RA
  4810     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4811        + (CP-DAYS-TO-1ST-PMT - +30)
  4812        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4813        CP-DCC-AH-RATE / 1000 * 12 / 12)
  4814     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  4815        * (12 / 12)
  4816
  4817
  4818     MOVE WK3                    TO CP-LF-PREM
  4819
  4820
  4821
  4822     GO TO 99999-RETURN                                           ERCNETP
  4823
  4824     .                                                            ERCNETP
  4825 12001-CONTINUE-NET.                                              ERCNETP
  4826                                                                  ERCNETP
  4827     IF NET-STD                                                   ERCNETP
  4828        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  4829*          OR 'DCC'
  4830         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  4831         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  4832         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  4833         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)                   ERCNETP
  4834                               * ((1 + N) / (1 + M))              ERCNETP
  4835        ELSE                                                      ERCNETP
  4836         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  4837         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  4838         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  4839         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  4840                                                                  ERCNETP
  4841     IF NET-SMP                                                   ERCNETP
  4842         COMPUTE N2 = N * N                                       ERCNETP
  4843         COMPUTE N3 = N2 * N                                      ERCNETP
  4844         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  4845         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  4846         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  4847         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
  4848         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  4849                                                                  ERCNETP
  4850     IF NPO-PRUDENTIAL                                            ERCNETP
  4851       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  4852           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  4853               UNTIL WS-COUNTER = N                               ERCNETP
  4854       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  4855       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  4856                                                                  ERCNETP
  4857     MOVE WK3 TO FACTOR.                                          ERCNETP
  4858
  4859                                                                  ERCNETP
  4860     GO TO 99999-RETURN.                                          ERCNETP
  4861                                                                  ERCNETP
  4862 12100-PRU-CALC.                                                  ERCNETP
  4863     IF WS-COUNTER = 1                                            ERCNETP
  4864         COMPUTE PWK = (I + 1)                                    ERCNETP
  4865     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4866         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  4867                                                                  ERCNETP
  4868 12199-EXIT.                                                      ERCNETP
  4869      EXIT.                                                       ERCNETP
  4870                                                                  ERCNETP
  4871 99000-ERROR.                                                     ERCNETP
  4872     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  4873     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  4874                                                                  ERCNETP
  4875     GO TO 99999-EXIT.                                            ERCNETP
  4876                                                                  ERCNETP
  4877 99999-RETURN.                                                    ERCNETP
  4878     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  4879                                                                  ERCNETP
  4880 99999-EXIT.                                                      ERCNETP
  4881      EXIT.                                                       ERCNETP
  4882
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1660     Code:       38769
