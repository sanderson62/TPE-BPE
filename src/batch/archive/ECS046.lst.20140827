* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ECS046.cbl
* Options: int("ECS046.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS046.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS046.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS046.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         03/09/98
     2                                                                  ECS046
     3 PROGRAM-ID.                ECS046.                                  LV009
     4*              PROGRAM CONVERTED BY                               ECS046
     5*              COBOL CONVERSION AID PO 5785-ABJ                   ECS046
     6*              CONVERSION DATE 02/20/96 19:03:05.                 ECS046
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE          ECS046
     8*                           VMOD=2.014.                           ECS046
     9                                                                  ECS046
    10*AUTHOR.        LOGIC, INC.                                       ECS046
    11*               DALLAS, TEXAS.                                    ECS046
    12                                                                  ECS046
    13*DATE-COMPILED.                                                   ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ECS046.cbl
    14                                                                  ECS046
    15*SECURITY.   *****************************************************ECS046
    16*            *                                                   *ECS046
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ECS046
    18*            *                                                   *ECS046
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ECS046
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ECS046
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *ECS046
    22*            *                                                   *ECS046
    23*            *****************************************************ECS046
    24                                                                  ECS046
    25*REMARKS.                                                         ECS046
    26*            THIS PROGRAM WILL READ THE EP-EC FILE AND PRINT THE  ECS046
    27*            ACCOUNT PROFIT SUMMARY REPORT.                       ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ECS046.cbl
    29 ENVIRONMENT DIVISION.                                            ECS046
    30 INPUT-OUTPUT SECTION.                                            ECS046
    31 FILE-CONTROL.                                                    ECS046
    32                                                                  ECS046
    33     SELECT  SORT-WORK-A     ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.  ECS046
    34     SELECT  SORT-WORK-B     ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.  ECS046
    35     SELECT  WORK-FILE       ASSIGN TO SYS011-UT-FBA1-S-SYS011.   ECS046
    36     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.   ECS046
    37     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.   ECS046
    38     SELECT  ACC-MSTR        ASSIGN TO SYS015-FBA1-SYS015         ECS046
    39                             ACCESS        SEQUENTIAL             ECS046
    40                             ORGANIZATION  INDEXED                ECS046
    41                             FILE STATUS   ERACCT-FILE-STATUS     ECS046
    42                             RECORD KEY    AM-CONTROL-PRIMARY.    ECS046
    43     SELECT  COMP-FILE       ASSIGN TO SYS014-UT-FBA1-ERCOMP      ECS046
    44                             ORGANIZATION IS INDEXED              ECS046
    45                             ACCESS IS RANDOM                     ECS046
    46                             RECORD KEY IS CO-CONTROL-PRIMARY     ECS046
    47                             FILE STATUS IS ERCOMP-FILE-STATUS.   ECS046
    48     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.   ECS046
    49     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.   ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ECS046.cbl
    51 DATA DIVISION.                                                   ECS046
    52 FILE SECTION.                                                    ECS046
    53                                                                  ECS046
    54*    THE FOLLOWING SORT WORK FILE IS FOR SORTING REPORT-A RECORDS ECS046
    55*    SEE SWA-REC IN WORKING STORAGE FOR LAYOUT AND SORT CONTROL   ECS046
    56 SD  SORT-WORK-A.                                                    CL**9
    57                                                                  ECS046
    58 01  SWA-REC-OUT.                                                 ECS046
    59     12  SWA-CONTROL-OUT     PIC X(31).                           ECS046
    60     12  FILLER              PIC X(60).                           ECS046
    61     12  SWA-AMTS   COMP-3 OCCURS 2.                              ECS046
    62         16 SW-NP            PIC S9(9)V99.                        ECS046
    63         16 SW-EP            PIC S9(9)V99.                        ECS046
    64         16 SW-CI            PIC S9(9)V99.                        ECS046
    65         16 SW-EC            PIC S9(9)V99.                        ECS046
    66         16 SW-RT            PIC S9(9)V99.                        ECS046
    67         16 SW-PT            PIC S9(9)V99.                        ECS046
    68     12  SWA-SAVE-GROUPING   PIC X(6).                            ECS046
    69                                                                  ECS046
    70*    THE FOLLOWING SORT WORK FILE IS FOR SORTING REPORT-B RECORDS ECS046
    71*    SEE SWB-REC IN WORKING STORAGE FOR LAYOUT AND SORT CONTROL   ECS046
    72 SD  SORT-WORK-B.                                                    CL**9
    73                                                                  ECS046
    74 01  SWB-REC-OUT.                                                 ECS046
    75     12  SWB-CONTROL-OUT     PIC S9(9)V99  COMP-3.                ECS046
    76     12  FILLER              PIC X(80).                           ECS046
    77                                                                  ECS046
    78*    THE FOLLOWING WORK FILE IS USED TO STORE REPORT-B RECORDS    ECS046
    79*    UNTIL THEY CAN BE SORTED PRIOR TO BUILDING THE B REPORT.     ECS046
    80*    THESE RECORDS ARE CREATED IN THE PRINT-REPORT-A SECTION.     ECS046
    81*    SEE PARAGRAPH 3300- IN THE PROCEDURE DIVISION                ECS046
    82 FD  WORK-FILE                                                    ECS046
    83     RECORDING MODE F.                                               CL**9
    84                                                                  ECS046
    85 01  WORK-REC                PIC X(86).                           ECS046
    86                                                                  ECS046
    87 FD  PRNTR                                                        ECS046
*   88                             COPY ELCPRTFD.                       ECS046
    89******************************************************************04/15/98
    90*                                                                *ELCPRTFD
    91*                                                                *ELCPRTFD
    92*                            ELCPRTFD.                           *   LV003
    93*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    94*                            VMOD=2.006                          *ELCPRTFD
    95******************************************************************ELCPRTFD
    96     RECORDING MODE F                                             ELCPRTFD
    97     LABEL RECORDS OMITTED                                        ELCPRTFD
    98     BLOCK CONTAINS 0 RECORDS
    99     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   100 01  PRT.                                                         ELCPRTFD
   101     12  P-CTL               PIC  X.                                 CL**2
   102     12  P-DATA              PIC  X(132).                         ELCPRTFD
   103******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ECS046.cbl
   105 FD  EPEC-FILE                                                    ECS046
*  106                             COPY ECSEPCFD.                       ECS046
   107******************************************************************07/10/97
   108*                                                                *ECSEPCFD
   109*                            ECSEPCFD                            *   LV001
   110*                            VMOD=2.002                          *ECSEPCFD
   111*                                                                *ECSEPCFD
   112*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   113*                                                                *ECSEPCFD
   114******************************************************************ECSEPCFD
   115     RECORDING MODE F                                             ECSEPCFD
   116     LABEL RECORDS STANDARD                                       ECSEPCFD
   117     BLOCK CONTAINS 0 RECORDS
   118     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   119******************************************************************ECSEPCFD
   120                                                                  ECS046
*  121                             COPY ECSEPC01.                       ECS046
   122******************************************************************
   123*                                                                *
   124*                            ECSEPC01                            *
   125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   126*                            VMOD=2.008                          *
   127*                                                                *
   128*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   129*                                                                *
   130*   FILE TYPE = SEQUENTIAL                                       *
   131*   RECORD SIZE = 325  RECFORM = FIXED                           *
   132*                                                                *
   133*   KEY DATA =                                  START=5, LEN=31  *
   134*                                                                *
   135*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   136*                                                                *
   137******************************************************************
   138
   139 01  EP-RECORD.
   140     02 EP-FILE.
   141     12  EP-RECORD-ID                      PIC XX.
   142         88  VALID-EP-ID                      VALUE 'EP'.
   143
   144     12  EP-COMPANY-CD                     PIC X.
   145
   146     12  EP-REIN                           PIC X.
   147         88  EP-REIN-EXTRACT                  VALUE 'R'.
   148
   149     12  EP-CONTROL.
   150         16  EP-CNTRL-1.
   151             20  EP-COMPANY.
   152                 24  EP-CARRIER            PIC X.
   153                 24  EP-GROUPING.
   154                     28  EP-GROUP-PREFIX   PIC XXX.
   155                     28  EP-GROUP-PRIME    PIC XXX.
   156             20  EP-STATE                  PIC XX.
   157             20  EP-ACCOUNT.
   158                 24  EP-ACCT-PREFIX        PIC X(4).
   159                 24  EP-ACCT-PRIME         PIC X(6).
   160         16  EP-CNTRL-2.
   161             20  EP-DATES.
   162                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ECS046.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   163                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
   164
   165     12  EP-REI-CO.
   166         16  EP-REINCO                     PIC XXX.
   167         16  EP-REINCO-SUB                 PIC XXX.
   168
   169     12  EP-RCD-TYPE                       PIC X.
   170         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   171         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   172         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   173         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   174         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   175         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   176     12  EP-BEN-CODE                       PIC XX.
   177     12  FILLER                            PIC X.
   178
   179     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   180     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   181     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   182
   183     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   184     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   185     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   186
   187     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   188     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   189     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   190     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   191
   192     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   193     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   194     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   195
   196     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   197     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   198     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   199
   200     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
   201     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   202     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   203     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   204     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   205
   206     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   207     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   208     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   209
   210     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   211     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   212     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   213
   214     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   215         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   216         16  EP-NEW-DATA-IND               PIC X(01).
   217             88  EP-NEW-DATA                   VALUE 'Y'.
   218         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   219         16  FILLER                        PIC X(19).
   220
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ECS046.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   221     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
   222     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   223     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   224
   225     12  FILLER                            PIC XXX.
   226
   227     12  EP-UNDERWRITING-CODE              PIC X.
   228         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   229
   230     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
   231
   232     12  FILLER                            PIC X(30).
   233*    12  FILLER                            PIC X(34).
   234
   235     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   236     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   237     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   238     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   239     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   240     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   241
   242     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   243
   244     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   245     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   246
   247     12  EP-PURGE                          PIC X.
   248         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   249
   250     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   251
   252     02 EC-RECORD     REDEFINES     EP-FILE.
   253     12  EC-RECORD-ID                      PIC XX.
   254         88  VALID-EC-ID                      VALUE 'EC'.
   255
   256     12  EC-COMPANY-CD                     PIC X.
   257
   258     12  EC-REIN                           PIC X.
   259         88  EC-REIN-EXTRACT                  VALUE 'R'.
   260
   261     12  EC-CONTROL.
   262         16  EC-CARRIER                    PIC X.
   263         16  EC-GROUPING.
   264             20  EC-GROUP-PREFIX           PIC XXX.
   265             20  EC-GROUP-PRIME            PIC XXX.
   266         16  EC-STATE                      PIC XX.
   267         16  EC-ACCOUNT.
   268             20  EC-ACCT-PREFIX            PIC X(4).
   269             20  EC-ACCT-PRIME             PIC X(6).
   270         16  EC-DATES.
   271             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   272             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   273
   274     12  EC-REI-CO.
   275         16  EC-REINCO                     PIC XXX.
   276         16  EC-REINCO-SUB                 PIC XXX.
   277
   278     12  EC-RCD-TYPE                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ECS046.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   279         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
   280         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   281         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   282         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   283         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   284     12  EC-BEN-CODE                       PIC XX.
   285     12  EC-SEQ-NBR                        PIC X.
   286         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   287         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   288
   289     12  EC-AGENTS-DATA.
   290         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   291             20  EC-AGT-NO.
   292                 24  EC-AGT-PREFIX         PIC X(4).
   293                 24  EC-AGT-PRIME          PIC X(6).
   294             20  EC-AGT-TYPE               PIC X.
   295             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   296             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   297             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   298             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   299             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   300
   301     12  EC-UNDERWRITING-CODE              PIC X.
   302         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   303
   304     12  EC-AGENTS-DATA-II.
   305         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   306             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   307             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   308
   309     12  FILLER                            PIC X(7).
   310
   311     12  EC-PURGE                          PIC X.
   312         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   313
   314     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   315
   316******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ECS046.cbl
   318 FD  ACC-MSTR.                                                       CL**9
   319                                                                  ECS046
*  320                             COPY ERCACCT.                        ECS046
   321******************************************************************04/19/98
   322*                                                                *ERCACCT
   323*                                                                *ERCACCT
   324*                            ERCACCT                             *   LV031
   325*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   326*                            VMOD=2.031                          *ERCACCT
   327*                                                                *ERCACCT
   328*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   329*                                                                *ERCACCT
   330*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   331*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   332*                                                                *ERCACCT
   333*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   334*                                                                *ERCACCT
   335*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   336*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   337*                                                                *ERCACCT
   338*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   339*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   340*                                                                *ERCACCT
   341*   LOG = NO                                                     *ERCACCT
   342*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   343*                                                                *ERCACCT
   344*                                                                *ERCACCT
   345******************************************************************ERCACCT
   346*                   C H A N G E   L O G
   347*
   348* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   349*-----------------------------------------------------------------
   350*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   351* EFFECTIVE    NUMBER
   352*-----------------------------------------------------------------
   353* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   354* 092705    2005050300006  PEMA  ADD SPP LEASES
   355* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   356* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   357* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   358* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   359* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   360******************************************************************
   361                                                                  ERCACCT
   362 01  ACCOUNT-MASTER.                                              ERCACCT
   363     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   364         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   365                                                                  ERCACCT
   366     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   367         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   368         16  AM-MSTR-CNTRL.                                       ERCACCT
   369             20  AM-CONTROL-A.                                    ERCACCT
   370                 24  AM-CARRIER            PIC X.                 ERCACCT
   371                 24  AM-GROUPING.                                 ERCACCT
   372                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   373                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   374                 24  AM-STATE              PIC XX.                ERCACCT
   375                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   376                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   377                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   378             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   379                                           PIC X(19).             ERCACCT
   380             20  AM-CNTRL-B.                                      ERCACCT
   381                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   382                 24  FILLER                PIC X(4).              ERCACCT
   383             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   384                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   385                                                                  ERCACCT
   386     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   387         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   388         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   389         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   390         16  AM-VG-STATE                   PIC XX.                ERCACCT
   391         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   392         16  AM-VG-DATE.                                          ERCACCT
   393             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   394             20  FILLER                    PIC X(4).              ERCACCT
   395         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   396                                           PIC 9(11)      COMP-3. ERCACCT
   397     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   398         16  FILLER                        PIC X(10).
   399         16  AM-VG-KEY3.
   400             20  AM-VG3-ACCOUNT            PIC X(10).
   401             20  AM-VG3-EXP-DT             PIC XX.
   402         16  FILLER                        PIC X(4).
   403     12  AM-MAINT-INFORMATION.                                    ERCACCT
   404         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   405         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   406         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   407         16  FILLER                        PIC XX.                ERCACCT
   408                                                                  ERCACCT
   409     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   410     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   411                                                                  ERCACCT
   412     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   413         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   414         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   415                                                                  ERCACCT
   416     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   417     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   418                                                                  ERCACCT
   419     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   420     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   421                                                                  ERCACCT
   422     12  AM-NAME                           PIC X(30).             ERCACCT
   423     12  AM-PERSON                         PIC X(30).             ERCACCT
   424     12  AM-ADDRS                          PIC X(30).             ERCACCT
   425     12  AM-CITY.
   426         16  AM-ADDR-CITY                  PIC X(28).
   427         16  AM-ADDR-STATE                 PIC XX.
   428     12  AM-ZIP.                                                  ERCACCT
   429         16  AM-ZIP-PRIME.                                        ERCACCT
   430             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   431                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   432             20  FILLER                    PIC X(4).              ERCACCT
   433         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   434     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   435         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   436         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   437         16  FILLER                        PIC XXX.               ERCACCT
   438     12  AM-TEL-NO.                                               ERCACCT
   439         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   440         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   441         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   442     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   443         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   444         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   445                                                                  ERCACCT
   446     12  AM-COMM-STRUCTURE.                                       ERCACCT
   447         16  AM-DEFN-1.                                           ERCACCT
   448             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   449                 24  AM-AGT.                                      ERCACCT
   450                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   451                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   452                 24  AM-COM-TYP            PIC X.                 ERCACCT
   453                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   454                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   455                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   456                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   457                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   458                 24  AM-GL-CODES           PIC X.                 ERCACCT
   459                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   460                 24  FILLER                PIC X(01).             ERCACCT
   461         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   462             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   463                 24  FILLER                PIC X(11).             ERCACCT
   464                 24  AM-L-COMA             PIC XXX.               ERCACCT
   465                 24  AM-J-COMA             PIC XXX.               ERCACCT
   466                 24  AM-A-COMA             PIC XXX.               ERCACCT
   467                 24  FILLER                PIC X(6).              ERCACCT
   468                                                                  ERCACCT
   469     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   470         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   471                                                                  ERCACCT
   472     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   473                                                                  ERCACCT
   474     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   475         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   476         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   477     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   478         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   479         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   480     12  AM-GPCD                           PIC 99.                ERCACCT
   481     12  AM-IG                             PIC X.                 ERCACCT
   482         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   483         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   484     12  AM-STATUS                         PIC X.                 ERCACCT
   485         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   486         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   487         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   488         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   489         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   490         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   491     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   492     12  AM-ID-NO                          PIC X(11).             ERCACCT
   493                                                                  ERCACCT
   494     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   495     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   496     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   497     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   498     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   499     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   500     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   501     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   502     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   503                                                                  ERCACCT
   504     12  AM-USER-FIELDS.                                          ERCACCT
   505         16  AM-FLD-1                      PIC XX.                ERCACCT
   506         16  AM-FLD-2                      PIC XX.                ERCACCT
   507         16  AM-FLD-3                      PIC XX.                ERCACCT
   508         16  AM-FLD-4                      PIC XX.                ERCACCT
   509         16  AM-FLD-5                      PIC XX.                ERCACCT
   510                                                                  ERCACCT
   511     12  AM-1ST-PROD-DATE.                                        ERCACCT
   512         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   513         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   514         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   515     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   516     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   517         16  AM-PUR-YR                     PIC XX.                ERCACCT
   518         16  AM-PUR-MO                     PIC XX.                ERCACCT
   519         16  AM-PUR-DA                     PIC XX.                ERCACCT
   520     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   521     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   522     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   523     12  AM-INACTIVE-DATE.                                        ERCACCT
   524         16  AM-INA-MO                     PIC 99.                ERCACCT
   525         16  AM-INA-DA                     PIC 99.                ERCACCT
   526         16  AM-INA-YR                     PIC 99.                ERCACCT
   527     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   528                                                                  ERCACCT
   529     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   530     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   531                                                                  ERCACCT
   532     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   533         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   534         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   535         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   536         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   537                                                                  ERCACCT
   538     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   539         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   540         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   541                                                                  ERCACCT
   542     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   543                                                                  ERCACCT
   544     12  AM-OVER-SHORT.                                           ERCACCT
   545         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   546         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   547                                                                  ERCACCT
   548     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   549     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   550                                                                  ERCACCT
   551     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   552     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   553                                                                  ERCACCT
   554     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   555     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   556     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   557     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   558     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   559     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   560     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   561     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   562     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   563     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   564     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   565     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   566     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   567     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   568     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   569     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   570                                                                  ERCACCT
   571     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   572                                                                  ERCACCT
   573     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   574     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   575                                                                  ERCACCT
   576     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   577     12  AM-EARN-METHODS.                                         ERCACCT
   578         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   579             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   580             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   581             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   582             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   583         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   584             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   585             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   586             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   587             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   588         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   589             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   590             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   591             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   592             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   593             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   594             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   595                                                                  ERCACCT
   596     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   597     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   598     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   599                                                                  ERCACCT
   600     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   601     12  AM-RET-P-E                        PIC X.                 ERCACCT
   602     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   603     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   604     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   605     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   606         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   607         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   608     12  AM-RETRO-EARNINGS.                                       ERCACCT
   609         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   610         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   611         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   612     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   613         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   614         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   615     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   616         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   617         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   618         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   619     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   620     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   621                                                                  ERCACCT
   622     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   623         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   624         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   625         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   626         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   627         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   628                                                                  ERCACCT
   629     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   630                                                                  ERCACCT
   631     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   632                                                                  ERCACCT
   633     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   634         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   635                                                                  ERCACCT
   636     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   637         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   638         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   639                                                                  ERCACCT
   640     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   641         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   642                                                                  ERCACCT
   643     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   644         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   645         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   646                                                                  ERCACCT
   647     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   648                                                                  ERCACCT
   649     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   650     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   651     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   652     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   653     12  AM-DCC-UEF-STATE                  PIC XX.
   654     12  FILLER                            PIC XXX.
   655     12  AM-REPORT-CODE-3                  PIC X(10).
   656*    12  FILLER                            PIC X(22).             ERCACCT
   657                                                                  ERCACCT
   658     12  AM-RESERVE-DATE.                                         ERCACCT
   659         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   660         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   661         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   662                                                                  ERCACCT
   663     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   664     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   665         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   666         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   667         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   668         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   669                                                                  ERCACCT
   670     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   671         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   672         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   673         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   674         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   675                                                                  ERCACCT
   676     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   677         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   678             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   679             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   680             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   681             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   682             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   683             20  FILLER                    PIC XX.                ERCACCT
   684         16  FILLER                        PIC X(80).             ERCACCT
   685                                                                  ERCACCT
   686     12  AM-TRANSFER-DATA.                                        ERCACCT
   687         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   688             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   689             20  AM-TRNFROM-GROUPING.                             ERCACCT
   690                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   691                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   692             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   693             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   694                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   695                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   696             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   697         16  AM-TRANSFERRED-TO.                                   ERCACCT
   698             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   699             20  AM-TRNTO-GROUPING.                               ERCACCT
   700                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   701                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   702             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   703             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   704                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   705                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   706             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   707         16  FILLER                        PIC X(10).             ERCACCT
   708                                                                  ERCACCT
   709     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   710                                                                  ERCACCT
   711     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   712         16  AM-DEFN-1-SAVED.                                     ERCACCT
   713             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   714                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   715                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   716                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   717                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   718                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   719                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   720                 24  FILLER                PIC X.                 ERCACCT
   721                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   722                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   723                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   724         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   725             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   726                 24  FILLER                PIC X(11).             ERCACCT
   727                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   728                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   729                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   730                 24  FILLER                PIC X(6).              ERCACCT
   731                                                                  ERCACCT
   732     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   733         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   734            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   735            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   736            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   737                                                                  ERCACCT
   738     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   739     12  FILLER                            PIC X(120).            ERCACCT
   740                                                                  ERCACCT
   741     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   742         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   743         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   744             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   745             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   746                                                          COMP-3. ERCACCT
   747             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   748                                                          COMP-3. ERCACCT
   749         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   750             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   751             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   752                                                          COMP-3. ERCACCT
   753             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   754                                                          COMP-3. ERCACCT
   755                                                                  ERCACCT
   756     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   757         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   758         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   759         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   760         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   761             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   762                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   763                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   764             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   765                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   766                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   767             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   768                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   769                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   770         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   771             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   772                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   773                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   774                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   775             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   776                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   777                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   778             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   779                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   780                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   781                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   782     12  AM-COMMENTS.                                             ERCACCT
   783         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   784                                                                  ERCACCT
   785     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   786         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   787         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   788         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   789         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   790         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   791             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   792             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   793             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   794             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   795         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   796             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   797             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   798             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   799         16  FILLER                        PIC X(102).            ERCACCT
   800                                                                  ERCACCT
   801     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   802         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   803             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   804             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   805             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   806             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   807             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   808         16  FILLER                          PIC X(10).           ERCACCT
   809******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ECS046.cbl
   811 FD  COMP-FILE.                                                      CL**9
   812                                                                  ECS046
*  813                             COPY ERCCOMP.                        ECS046
   814******************************************************************
   815*                                                                *
   816*                                                                *
   817*                            ERCCOMP                             *
   818*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   819*                            VMOD=2.019                          *
   820*                                                                *
   821*   ONLINE CREDIT SYSTEM                                         *
   822*                                                                *
   823*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   824*                                                                *
   825*   FILE TYPE = VSAM,KSDS                                        *
   826*   RECORD SIZE = 700   RECFORM = FIXED                          *
   827*                                                                *
   828*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   829*       ALTERNATE PATH = NONE                                    *
   830*                                                                *
   831*   LOG = NO                                                     *
   832*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   833*                                                                *
   834******************************************************************
   835*                   C H A N G E   L O G
   836*
   837* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   838*-----------------------------------------------------------------
   839*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   840* EFFECTIVE    NUMBER
   841*-----------------------------------------------------------------
   842* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   843* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   844* 092205    2005050300006  PEMA  ADD LEASE FEE
   845* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   846* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   847* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   848* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   849* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   850* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   851******************************************************************
   852
   853 01  COMPENSATION-MASTER.
   854     12  CO-RECORD-ID                          PIC XX.
   855         88  VALID-CO-ID                          VALUE 'CO'.
   856
   857     12  CO-CONTROL-PRIMARY.
   858         16  CO-COMPANY-CD                     PIC X.
   859         16  CO-CONTROL.
   860             20  CO-CTL-1.
   861                 24  CO-CARR-GROUP.
   862                     28  CO-CARRIER            PIC X.
   863                     28  CO-GROUPING.
   864                         32  CO-GROUP-PREFIX   PIC XXX.
   865                         32  CO-GROUP-PRIME    PIC XXX.
   866                 24  CO-RESP-NO.
   867                     28  CO-RESP-PREFIX        PIC X(4).
   868                     28  CO-RESP-PRIME         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   869             20  CO-CTL-2.
   870                 24  CO-ACCOUNT.
   871                     28  CO-ACCT-PREFIX        PIC X(4).
   872                     28  CO-ACCT-PRIME         PIC X(6).
   873         16  CO-TYPE                           PIC X.
   874             88  CO-COMPANY-TYPE                  VALUE 'C'.
   875             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   876             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   877
   878     12  CO-MAINT-INFORMATION.
   879         16  CO-LAST-MAINT-DT                  PIC XX.
   880         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   881         16  CO-LAST-MAINT-USER                PIC X(4).
   882     12  FILLER                                PIC XX.
   883     12  CO-STMT-TYPE                          PIC XXX.
   884     12  CO-COMP-TYPE                          PIC X.
   885         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   886     12  CO-STMT-OWNER                         PIC X(4).
   887     12  CO-BALANCE-CONTROL                    PIC X.
   888         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   889         88  CO-NO-BALANCE                        VALUE 'N'.
   890
   891     12  CO-INTERNAL-CONTROL-1                 PIC X.
   892         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   893         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   894         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   895
   896     12  CO-INTERNAL-CONTROL-2                 PIC X.
   897         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   898         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   899
   900     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   901     12  CO-GA-DIRECT-DEP                      PIC X.
   902     12  CO-FUTURE-SPACE                       PIC X.
   903         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   904
   905     12  CO-ACCT-NAME                          PIC X(30).
   906     12  CO-MAIL-NAME                          PIC X(30).
   907     12  CO-ADDR-1                             PIC X(30).
   908     12  CO-ADDR-2                             PIC X(30).
   909     12  CO-ADDR-3.
   910         16  CO-ADDR-CITY                      PIC X(27).
   911         16  CO-ADDR-STATE                     PIC XX.
   912     12  CO-CSO-1099                           PIC X.
   913     12  CO-ZIP.
   914         16  CO-ZIP-PRIME.
   915             20  CO-ZIP-PRI-1ST                PIC X.
   916                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   917             20  FILLER                        PIC X(4).
   918         16  CO-ZIP-PLUS4                      PIC X(4).
   919     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   920         16  CO-CAN-POSTAL-1                   PIC XXX.
   921         16  CO-CAN-POSTAL-2                   PIC XXX.
   922         16  FILLER                            PIC XXX.
   923     12  CO-SOC-SEC                            PIC X(13).
   924     12  CO-TELEPHONE.
   925         16  CO-AREA-CODE                      PIC XXX.
   926         16  CO-PREFIX                         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   927         16  CO-PHONE                          PIC X(4).
   928
   929     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   930
   931     12  CO-AR-BAL-LEVEL                       PIC X.
   932         88  CO-AR-REF-LVL                        VALUE '1'.
   933         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   934         88  CO-AR-BILL-LVL                       VALUE '2'.
   935         88  CO-AR-AGT-LVL                        VALUE '3'.
   936         88  CO-AR-FR-LVL                         VALUE '4'.
   937
   938     12  CO-AR-NORMAL-PRINT                    PIC X.
   939         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   940         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   941
   942     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   943
   944     12  CO-AR-REPORTING                       PIC X.
   945         88  CO-AR-NET-REPORT                     VALUE 'N'.
   946         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   947
   948     12  CO-AR-PULL-CHECK                      PIC X.
   949         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   950         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   951
   952     12  CO-AR-BALANCE-PRINT                   PIC X.
   953         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   954
   955     12  CO-AR-LAST-RUN-CODE                   PIC X.
   956         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   957         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   958         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   959
   960     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   961
   962     12  CO-USER-CODE                          PIC X.
   963     12  CO-REPORT-GROUP-ID                    PIC X(12).
   964
   965******************************************************************
   966*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   967*    THE LAST MONTH END RUN.
   968******************************************************************
   969
   970     12  CO-LAST-ACTIVITY-DATE.
   971         16  CO-ACT-YEAR                       PIC 99.
   972         16  CO-ACT-MONTH                      PIC 99.
   973         16  CO-ACT-DAY                        PIC 99.
   974
   975     12  CO-LAST-STMT-DT.
   976         16  CO-LAST-STMT-YEAR                 PIC 99.
   977         16  CO-LAST-STMT-MONTH                PIC 99.
   978         16  CO-LAST-STMT-DAY                  PIC 99.
   979
   980     12  CO-MO-END-TOTALS.
   981         16  CO-MONTHLY-TOTALS.
   982             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   983             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   984             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   985             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   986             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   987
   988         16  CO-AGING-TOTALS.
   989             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   990             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   991             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   992             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   993
   994         16  CO-YTD-TOTALS.
   995             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   996             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   997
   998         16  CO-OVER-UNDER-TOTALS.
   999             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1000             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1001
  1002     12  CO-MISCELLANEOUS-TOTALS.
  1003         16  CO-FICA-TOTALS.
  1004             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1005             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1006
  1007         16  CO-CLAIM-TOTALS.
  1008             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1009             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1010
  1011******************************************************************
  1012*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1013*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1014******************************************************************
  1015
  1016     12  CO-CURRENT-TOTALS.
  1017         16  CO-CURRENT-LAST-STMT-DT.
  1018             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1019             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1020             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1021
  1022         16  CO-CURRENT-MONTHLY-TOTALS.
  1023             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1024             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1025             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1026             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1027             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1028
  1029         16  CO-CURRENT-AGING-TOTALS.
  1030             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1031             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1032             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1033             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1034
  1035         16  CO-CURRENT-YTD-TOTALS.
  1036             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1037             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1038
  1039     12  CO-PAID-COMM-TOTALS.
  1040         16  CO-YTD-PAID-COMMS.
  1041             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1042             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  1043
  1044     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1045         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1046         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1047
  1048     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1049         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1050         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1051         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1052         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1053         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1054         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1055         88  CO-FINAL-LETTER                  VALUE 'F'.
  1056         88  CO-RECONCILING                   VALUE 'R'.
  1057         88  CO-PHONE-CALL                    VALUE 'P'.
  1058         88  CO-LEGAL                         VALUE 'L'.
  1059         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1060         88  CO-WRITE-OFF                     VALUE 'W'.
  1061         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1062
  1063     12  CO-CSR-CODE                       PIC X(4).
  1064
  1065     12  CO-GA-STATUS-INFO.
  1066         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1067         16  CO-GA-TERMINATION-DT          PIC XX.
  1068         16  CO-GA-STATUS-CODE             PIC X.
  1069             88  CO-GA-ACTIVE                 VALUE 'A'.
  1070             88  CO-GA-INACTIVE               VALUE 'I'.
  1071             88  CO-GA-PENDING                VALUE 'P'.
  1072         16  CO-GA-COMMENTS.
  1073             20  CO-GA-COMMENT-1           PIC X(40).
  1074             20  CO-GA-COMMENT-2           PIC X(40).
  1075             20  CO-GA-COMMENT-3           PIC X(40).
  1076             20  CO-GA-COMMENT-4           PIC X(40).
  1077
  1078     12  CO-RPTCD2                         PIC X(10).
  1079     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1080         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1081         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1082
  1083     12  CO-TYPE-AGENT                     PIC X(01).
  1084         88  CO-CORPORATION                   VALUE 'C'.
  1085         88  CO-PARTNERSHIP                   VALUE 'P'.
  1086         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1087         88  CO-TRUST                         VALUE 'T'.
  1088         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1089
  1090     12  CO-FAXNO.
  1091         16  CO-FAX-AREA-CODE                  PIC XXX.
  1092         16  CO-FAX-PREFIX                     PIC XXX.
  1093         16  CO-FAX-PHONE                      PIC X(4).
  1094
  1095     12  CO-BANK-INFORMATION.
  1096         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1097         16  CO-BANK-TRANSIT-NON REDEFINES
  1098             CO-BANK-TRANSIT-NO                PIC 9(8).
  1099
  1100         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  1101     12  CO-MISC-DEDUCT-INFO REDEFINES
  1102                  CO-BANK-INFORMATION.
  1103         16  CO-MD-GL-ACCT                     PIC X(10).
  1104         16  CO-MD-DIV                         PIC XX.
  1105         16  CO-MD-CENTER                      PIC X(4).
  1106         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1107         16  CO-CREATE-AP-CHECK                PIC X.
  1108         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1109         16  FILLER                            PIC XXX.
  1110     12  CO-ACH-STATUS                         PIC X.
  1111         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1112         88  CO-ACH-PENDING                        VALUE 'P'.
  1113
  1114     12  CO-BILL-SW                            PIC X.
  1115     12  CO-CONTROL-NAME                       PIC X(30).
  1116     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1117     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1118     12  CO-CLP-STATE                          PIC XX.
  1119     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1120     12  CO-SPP-REFUND-EDIT                    PIC X.
  1121
  1122******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ECS046.cbl
  1124 FD  DISK-DATE                                                    ECS046
* 1125                             COPY ELCDTEFD.                       ECS046
  1126******************************************************************04/15/98
  1127*                                                                *ELCDTEFD
  1128*                                                                *ELCDTEFD
  1129*                            ELCDTEFD.                           *   LV002
  1130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1131*                            VMOD=2.007                          *   CL**2
  1132*                                                                *ELCDTEFD
  1133******************************************************************ELCDTEFD
  1134     BLOCK CONTAINS 0 RECORDS
  1135     RECORDING MODE F.                                            ELCDTEFD
  1136                                                                  ELCDTEFD
  1137 01  DATE-DISK.                                                   ELCDTEFD
  1138     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1139     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1140     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1141     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1142     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1143     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1144     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1145                                                                  ELCDTEFD
  1146 01  DATE-DISK-R.                                                 ELCDTEFD
  1147     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1148     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1149                                     PIC  X(32).                  ELCDTEFD
  1150                                                                  ELCDTEFD
  1151 01  DATE-DISK-T.                                                 ELCDTEFD
  1152     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1153     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1154                                     PIC  X(48).                  ELCDTEFD
  1155                                                                  ELCDTEFD
  1156 01  DATE-DISK-M.                                                 ELCDTEFD
  1157     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1158     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1159                                     PIC  X(48).                  ELCDTEFD
  1160                                                                  ELCDTEFD
  1161 01  DATE-DISK-P.                                                 ELCDTEFD
  1162     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1163     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1164     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1165     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1166         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1167                                     PIC  X.                      ELCDTEFD
  1168         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1169     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1170         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1171             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1172             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1173             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1174             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1175         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1176                                                                  ELCDTEFD
  1177 01  DATE-DISK-E.                                                 ELCDTEFD
  1178     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1179     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1180                                     PIC  X(4).                   ELCDTEFD
  1181                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1182 01  DATE-DISK-C.                                                 ELCDTEFD
  1183     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1184     12  DD-CARR1-SECPAY-SW          PIC  X.
  1185     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1186     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1187     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1188     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1189     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1190     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1191     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1192     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1193     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1194     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1195     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1196     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1197     12  DD-CARR2-SECPAY-SW          PIC  X.
  1198     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1199                                                                  ELCDTEFD
  1200 01  DATE-DISK-OPT.                                               ELCDTEFD
  1201     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1202     12  DD-TLR-DATA.                                             ELCDTEFD
  1203         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1204                                     PIC  X(03).                  ELCDTEFD
  1205     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1206         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1207                                     PIC  X(06).                  ELCDTEFD
  1208     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1209         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1210                                     PIC  X(07).                  ELCDTEFD
  1211         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1212     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1213                                     PIC  X(96).                  ELCDTEFD
  1214******************************************************************ELCDTEFD
  1215                                                                  ECS046
  1216 FD  FICH                                                         ECS046
* 1217                             COPY ELCFCHFD.                       ECS046
  1218******************************************************************04/15/98
  1219*                                                                *ELCFCHFD
  1220*                            ELCFCHFD.                           *   LV003
  1221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1222*                            VMOD=2.004                          *   CL**3
  1223*                                                                *ELCFCHFD
  1224******************************************************************ELCFCHFD
  1225     BLOCK CONTAINS 0 RECORDS
  1226     RECORDING MODE F.                                            ELCFCHFD
  1227                                                                  ELCFCHFD
  1228 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1229******************************************************************ELCFCHFD
  1230                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ECS046.cbl
  1232 WORKING-STORAGE SECTION.                                         ECS046
  1233 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.      ECS046
  1234 77  FILLER  PIC X(32) VALUE '********************************'.  ECS046
  1235 77  FILLER  PIC X(32) VALUE '     ECS046 WORKING STORAGE     '.  ECS046
  1236 77  FILLER  PIC X(32) VALUE '***********VMOD=2.014 **********'.  ECS046
  1237                                                                  ECS046
  1238 77  NO-OF-RECORDS-RELEASED    PIC S9(9)      COMP-3  VALUE +0.   ECS046
  1239 77  SA                        PIC S999       COMP.               ECS046
  1240 77  SB                        PIC S999       COMP.               ECS046
  1241 77  SC                        PIC S999       COMP.               ECS046
  1242 77  SE                        PIC S999       COMP.               ECS046
  1243 77  CL                        PIC S999       COMP.               ECS046
  1244 77  PAGE-CNT                  PIC S9(5)      COMP-3 VALUE +0.    ECS046
  1245 77  LINE-CNT                  PIC S999       COMP-3 VALUE +0.    ECS046
  1246 77  PGM-SUB                   PIC S999       COMP-3 VALUE +46.   ECS046
  1247 77  X                         PIC X.                             ECS046
  1248 77  WS-BREAK-SW               PIC X       VALUE SPACES.          ECS046
  1249 77  WS-EP-CODE                PIC X.                             ECS046
  1250 77  WS-FIN-RESP-AGT           PIC X(10).                         ECS046
  1251 77  SAVE-STATE                PIC XX.                            ECS046
  1252 77  SAVE-LF-BEN               PIC XX.                            ECS046
  1253 77  SAVE-EP-CODE              PIC X.                             ECS046
  1254                                                                  ECS046
  1255 01  WS-ABEND-STORAGE.                                            ECS046
  1256     12  WS-RETURN-CODE        PIC S9(4)  VALUE ZERO COMP.        ECS046
  1257     12  WS-ABEND-MESSAGE      PIC X(80)  VALUE SPACES.           ECS046
  1258     12  WS-ABEND-FILE-STATUS  PIC XX     VALUE ZERO.             ECS046
  1259     12  WS-ZERO               PIC S9     VALUE ZERO COMP-3.      ECS046
  1260                                                                  ECS046
  1261     12  ERACCT-FILE-STATUS    PIC XX     VALUE ZERO.             ECS046
  1262     12  ERCOMP-FILE-STATUS    PIC XX     VALUE ZERO.             ECS046
  1263                                                                  ECS046
  1264 01  WS-ACTIVE-PARM.                                              ECS046
  1265     12  WS-ACTIVE-INDIC       PIC X(6).                          ECS046
  1266     12  FILLER                PIC X(74).                         ECS046
  1267                                                                  ECS046
  1268 01  HOLD-COMP-KEY.                                               ECS046
  1269     12  HOLD-COMPANY-CD       PIC X.                             ECS046
  1270     12  HOLD-CARRIER          PIC X.                             ECS046
  1271     12  HOLD-GROUPING         PIC X(6).                          ECS046
  1272     12  HOLD-GA-NUMBER        PIC X(10).                         ECS046
  1273     12  HOLD-ACCT             PIC X(10).                         ECS046
  1274     12  HOLD-RECORD-TYPE      PIC X.                             ECS046
  1275                                                                  ECS046
  1276 01  MISC-FIELDS.                                                 ECS046
  1277     12  HOLD-GA-NAME          PIC X(30)  VALUE SPACES.           ECS046
  1278     12  HOLD-ACTIVE-DESC      PIC X(15)  VALUE                   ECS046
  1279             'ACTIVE ACCOUNTS'.                                   ECS046
  1280     12  HOLD-ALL-DESC         PIC X(15)  VALUE                   ECS046
  1281             'ALL ACCOUNTS   '.                                   ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ECS046.cbl
  1283*    THE FOLLOWING RECORD CONTAINS REPORT DATA FOR THE A REPORT.  ECS046
  1284*    NOT ALL THE INDIVIDUAL FIELDS IN THE CONTROL AREA ARE USED   ECS046
  1285*    DEPENDING ON THE TOTAL-OPTION FOR THE PROGRAM (SEE ECS046    ECS046
  1286*    TOTAL-OPTIONS IN THE PROGRAM OPTIONS FILE).  THOSE FIELDS    ECS046
  1287*    THAT AREN'T USED ARE PRIMED WITH BLANKS ON ALL RECORDS.      ECS046
  1288                                                                  ECS046
  1289 01  SWA-REC.                                                     ECS046
  1290     12  SWA-CONTROL.                                             ECS046
  1291         16  SWA-CONTROL-1.                                       ECS046
  1292             20  SWA-BUS-TYPE        PIC XX.                      ECS046
  1293             20  SWA-CARR            PIC X.                       ECS046
  1294             20  SWA-GROUP           PIC X(6).                    ECS046
  1295             20  SWA-GA-OR-RPT-CD    PIC X(10).                   ECS046
  1296             20  SWA-STATE           PIC XX.                      ECS046
  1297         16  SWA-CONTROL-R REDEFINES SWA-CONTROL-1.               ECS046
  1298             20  SWA-RPT-CD-1        PIC X(10).                   ECS046
  1299             20  SWA-RPT-CD-2        PIC X(11).                   ECS046
  1300         16  SWA-ACCT                PIC X(10).                   ECS046
  1301     12  SWA-NAME                    PIC X(30).                   ECS046
  1302     12  SWA-CITY                    PIC X(30).                   ECS046
  1303     12  SWA-AMOUNTS COMP-3 OCCURS 2.                             ECS046
  1304*  OCCURRENCE 1 = LIFE, 2 = A&H                                   ECS046
  1305         16 SWA-NET-PREM             PIC S9(9)V99.                ECS046
  1306         16 SWA-EARN-PREM            PIC S9(9)V99.                ECS046
  1307         16 SWA-CLMS-INCUR           PIC S9(9)V99.                ECS046
  1308         16 SWA-EARN-COMP            PIC S9(9)V99.                ECS046
  1309         16 SWA-RETENTION            PIC S9(9)V99.                ECS046
  1310         16 SWA-PREM-TAX             PIC S9(9)V99.                ECS046
  1311     12  SWA-SAVE-GROUP              PIC X(6).                    ECS046
  1312                                                                  ECS046
  1313*    THE FOLLOWING RECORD CONTAINS REPORT DATA FOR THE B REPORT.  ECS046
  1314*    NOT ALL THE INDIVIDUAL FIELDS IN THE RECORD FOLLOWING THE    ECS046
  1315*    AMOUNT FIELDS HAVE DATA, DEPENDING ON THE TOTAL OPTIONS FOR  ECS046
  1316*    THIS PROGRAM.  THE SORT CONTROL FIELD (SWB-SORT-AMT) CONTAINSECS046
  1317*    THE AMOUNT THAT DETERMINES THE SEQUENCE OF THE B REPORT (SEE ECS046
  1318*    THE FORMAT-OPTION IN THE PROGRAM OPTIONS FILE).              ECS046
  1319                                                                  ECS046
  1320 01  SWB-REC.                                                     ECS046
  1321     12  SWB-CONTROL.                                             ECS046
  1322         16  SWB-SORT-AMT           PIC S9(9)V99  COMP-3.         ECS046
  1323     12  SWB-LOSS-RATIO             PIC S9(4)V99  COMP-3.         ECS046
  1324     12  SWB-NET-PREM               PIC S9(9)V99  COMP-3.         ECS046
  1325     12  SWB-TOT-CHARGES            PIC S9(3)V99  COMP-3.         ECS046
  1326     12  SWB-PREM-PROFIT            PIC S9(8)V99  COMP-3.         ECS046
  1327     12  SWB-BUS-TYPE               PIC XX.                       ECS046
  1328     12  SWB-CARR                   PIC X.                        ECS046
  1329     12  SWB-GROUP                  PIC X(6).                     ECS046
  1330     12  SWB-STATE                  PIC XX.                       ECS046
  1331     12  SWB-GA-OR-RPT-CD           PIC X(10).                    ECS046
  1332     12  SWB-ACCT                   PIC X(10).                    ECS046
  1333     12  SWB-NAME                   PIC X(30).                    ECS046
  1334                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ECS046.cbl
  1336 01  WS-ACCT-CONTROL.                                             ECS046
  1337     12  WS-MSTR-CNTRL              PIC X(25) VALUE LOW-VALUES.   ECS046
  1338     12  WS-EFFECT                  PIC 9(11) COMP-3 VALUE 0.        CL**8
  1339                                                                  ECS046
  1340 01  WS-SAVE-CONTROL.                                             ECS046
  1341     12  WS-SAVE-CNTRL-1.                                         ECS046
  1342         16 WS-SAVE-CARR            PIC X.                        ECS046
  1343         16 WS-SAVE-GROUP           PIC X(6).                     ECS046
  1344         16 WS-SAVE-STATE           PIC XX.                       ECS046
  1345         16 WS-SAVE-ACCT            PIC X(10).                    ECS046
  1346     12  WS-SAVE-EXP-DATE           PIC 9(11)  COMP-3.               CL**2
  1347     12  WS-SAVE-EFF-DATE           PIC 9(11)  COMP-3.               CL**2
  1348                                                                  ECS046
  1349 01  SAVE-SWA-CONTROL.                                            ECS046
  1350     12  SAVE-SWA-CONTROL-1.                                      ECS046
  1351         16  SAVE-SWA-BUS-TYPE      PIC XX.                       ECS046
  1352         16  SAVE-SWA-CARR          PIC X.                        ECS046
  1353         16  SAVE-SWA-GROUP         PIC X(6).                     ECS046
  1354         16  SAVE-SWA-GA-OR-RPT-CD  PIC X(10).                    ECS046
  1355         16  SAVE-SWA-STATE         PIC XX.                       ECS046
  1356      12 SAVE-SWA-CONTROL-R REDEFINES SAVE-SWA-CONTROL-1.         ECS046
  1357         16  SAVE-SWA-RPT-CD-1      PIC X(10).                    ECS046
  1358         16  SAVE-SWA-RPT-CD-2      PIC X(11).                    ECS046
  1359      12  SAVE-SWA-ACCT             PIC X(10).                    ECS046
  1360                                                                  ECS046
  1361 01  MISC-AMTS    COMP-3.                                         ECS046
  1362     12 WS-RETENTION-PCT            PIC S9V9(5).                  ECS046
  1363     12 WS-TAX-RATE                 PIC S9V9(4).                  ECS046
  1364     12 WS-DA-EARN-PREM             PIC S9(9)V99.                 ECS046
  1365     12 WS-LF-SURPLUS               PIC S9(9)V99.                 ECS046
  1366     12 WS-LF-PREM-PROFIT           PIC S9(9)V99.                 ECS046
  1367     12 WS-LF-UW-INCOME             PIC S9(9)V99.                 ECS046
  1368     12 WS-AH-SURPLUS               PIC S9(9)V99.                 ECS046
  1369     12 WS-AH-PREM-PROFIT           PIC S9(9)V99.                 ECS046
  1370     12 WS-AH-UW-INCOME             PIC S9(9)V99.                 ECS046
  1371     12 WS-LOSS-RATIO               PIC S9(4)V9(4).               ECS046
  1372     12 WS-COMP-RATIO               PIC S9(3)V9(4).               ECS046
  1373     12 WS-TOT-CHARGES              PIC S9(3)V9(4).               ECS046
  1374     12 WS-SEQUENCE                 PIC S9(5)     VALUE +0.       ECS046
  1375                                                                  ECS046
  1376 01  BEG-DATE                PIC 9(11).                              CL**2
  1377 01  BEG-DATE-R REDEFINES BEG-DATE.                                  CL**2
  1378     12 FILLER               PIC 999.                             ECS046
  1379     12  BD-CCYY             PIC 9(04).                           ECS046
  1380     12  BD-CCYR REDEFINES BD-CCYY.                               ECS046
  1381         16  BD-CC           PIC 99.                              ECS046
  1382         16  BD-YR           PIC 99.                              ECS046
  1383     12  BD-MO               PIC 99.                              ECS046
  1384     12  BD-DA               PIC 99.                              ECS046
  1385                                                                  ECS046
  1386 01  RUN-DT                  PIC 9(11).                              CL**2
  1387 01  RUN-DT-R REDEFINES RUN-DT.                                      CL**2
  1388     12  FILLER              PIC 999.                             ECS046
  1389     12  RD-CCYY             PIC 9(04).                           ECS046
  1390     12  RD-CCYR REDEFINES RD-CCYY.                               ECS046
  1391         16  RD-CC           PIC 99.                              ECS046
  1392         16  RD-YR           PIC 99.                              ECS046
  1393     12  RD-MO               PIC 99.                              ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ECS046.cbl
  1394     12  RD-DA               PIC 99.                              ECS046
  1395                                                                  ECS046
  1396 01  WS-SAVE-EXP-DATE-R      PIC 9(11).                              CL**3
  1397 01  WS-SAVE-EXP-DATE-R-N REDEFINES WS-SAVE-EXP-DATE-R.              CL**5
  1398     12  FILLER                 PIC 999.                          ECS046
  1399     12  WS-SAVE-EXP-CCYY       PIC 9(04).                        ECS046
  1400     12  WS-SAVE-EXP-CCYR REDEFINES WS-SAVE-EXP-CCYY.             ECS046
  1401         16  WS-SAVE-EXP-CC     PIC 99.                           ECS046
  1402         16  WS-SAVE-EXP-YR     PIC 99.                           ECS046
  1403     12  WS-SAVE-EXP-MO         PIC 99.                           ECS046
  1404     12  WS-SAVE-EXP-DA         PIC 99.                           ECS046
  1405                                                                  ECS046
  1406 01  WS-SAVE-EFF-DATE-R      PIC 9(11).                              CL**3
  1407 01  WS-SAVE-EFF-DATE-R-N  REDEFINES WS-SAVE-EFF-DATE-R.             CL**3
  1408     12  FILLER              PIC 999.                             ECS046
  1409     12  WS-SAVE-EFF-CCYY    PIC 9(04).                           ECS046
  1410     12  WS-SAVE-EFF-CCYR REDEFINES WS-SAVE-EFF-CCYY.             ECS046
  1411         16  WS-SAVE-EFF-CC  PIC 99.                              ECS046
  1412         16  WS-SAVE-EFF-YR  PIC 99.                              ECS046
  1413     12  WS-SAVE-EFF-MO      PIC 99.                              ECS046
  1414     12  WS-SAVE-EFF-DA      PIC 99.                              ECS046
  1415                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ECS046.cbl
  1417*                                                                 ECS046
  1418* THE DETAIL AND AGENTS ACCUMULATORS ARE USED AS FOLLOWS          ECS046
  1419*                                                                 ECS046
  1420*    OCCURRENCE 1 = LIFE BEGINNING DATA                           ECS046
  1421*    OCCURRENCE 2 = A&H BEGINNING DATA                            ECS046
  1422*    OCCURRENCE 3 = LIFE CURRENT DATA                             ECS046
  1423*    OCCURRENCE 4 = A&H CURRENT DATA                              ECS046
  1424*                                                                 ECS046
  1425 01  DETAIL-ACCUMULATORS     COMP-3.                              ECS046
  1426     12  DETAIL-ACCUMS   OCCURS 4.                                ECS046
  1427         16  DA-NET-PREM            PIC S9(9)V99.                 ECS046
  1428         16  DA-EARN-PREM           PIC S9(9)V99.                 ECS046
  1429         16  DA-CLAIM-AMT           PIC S9(9)V99.                 ECS046
  1430         16  DA-LOSS-RSRV           PIC S9(9)V99.                 ECS046
  1431         16  DA-EARN-COMP           PIC S9(9)V99.                 ECS046
  1432         16  DA-RETENTION           PIC S9(9)V99.                 ECS046
  1433         16  DA-PREM-TAX            PIC S9(9)V99.                 ECS046
  1434*                                                                 ECS046
  1435* THE BREAK ACCUMULATORS ARE USED AS FOLLOWS                      ECS046
  1436*                                                                 ECS046
  1437*    A SET CONSISTS OF 2 ACCUMULATORS FOR EACH ITEM.              ECS046
  1438*        OCCURRENCE 1 = LIFE TOTAL PERIOD                         ECS046
  1439*        OCCURRENCE 2 = A&H TOTAL PERIOD                          ECS046
  1440*                                                                 ECS046
  1441*    THERE ARE 6 SETS                                             ECS046
  1442*        SET 1 = LEVEL 1 (STATE TOTALS)                           ECS046
  1443*        SET 2 = LEVEL 2 (REPORT CODE OR G.A. TOTALS)             ECS046
  1444*        SET 3 = LEVEL 3 (GROUP TOTALS)                           ECS046
  1445*        SET 4 = LEVEL 4 (CARRIER TOTALS)                         ECS046
  1446*        SET 5 = LEVEL 5 (BUSINESS TYPE TOTALS)                   ECS046
  1447*        SET 6 = LEVEL 6 (FINAL TOTALS)                           ECS046
  1448*                                                                 ECS046
  1449 01  BREAK-ACCUMULATORS      COMP-3.                              ECS046
  1450     12  BREAK-ACCUMS    OCCURS 2.                                ECS046
  1451         16  BREAK-ACCUMS-SL    OCCURS 6.                         ECS046
  1452             20  BA-NET-PREM     PIC S9(9)V99.                    ECS046
  1453             20  BA-EARN-PREM    PIC S9(9)V99.                    ECS046
  1454             20  BA-CLMS-INCUR   PIC S9(9)V99.                    ECS046
  1455             20  BA-EARN-COMP    PIC S9(9)V99.                    ECS046
  1456             20  BA-RETENTION    PIC S9(9)V99.                    ECS046
  1457             20  BA-PREM-PROFIT  PIC S9(9)V99.                    ECS046
  1458             20  BA-PREM-TAX     PIC S9(9)V99.                    ECS046
  1459                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ECS046.cbl
  1461 01  HEAD-1.                                                      ECS046
  1462     12  FILLER          PIC X(52)   VALUE SPACES.                ECS046
  1463     12  FILLER          PIC X(22)   VALUE                        ECS046
  1464                                     'ACCOUNT PROFIT SUMMARY'.    ECS046
  1465     12  FILLER          PIC X(4)    VALUE SPACES.                ECS046
  1466     12  HD-RPT-TYPE     PIC X(25)   VALUE SPACES.                ECS046
  1467     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1468     12  HD-STATUS-DESC  PIC X(15)   VALUE SPACES.                ECS046
  1469*    12  FILLER          PIC X(5)    VALUE SPACES.                ECS046
  1470     12  FILLER          PIC X(6)    VALUE 'ECS046'.              ECS046
  1471     12  H1-REPORT-SUF   PIC X       VALUE SPACES.                ECS046
  1472                                                                  ECS046
  1473 01  HEAD-2.                                                      ECS046
  1474     12  FILLER          PIC X(48)   VALUE SPACES.                ECS046
  1475     12  HD-COMP         PIC X(30)   VALUE SPACES.                ECS046
  1476     12  FILLER          PIC X(41)   VALUE SPACES.                ECS046
  1477     12  HD-RUN-DATE     PIC X(8)    VALUE SPACES.                ECS046
  1478                                                                  ECS046
  1479 01  HEAD-3.                                                      ECS046
  1480     12  FILLER          PIC X(53)   VALUE SPACES.                ECS046
  1481     12  HD-ALPHA-DATE   PIC X(18)   VALUE SPACES.                ECS046
  1482     12  FILLER          PIC X(48)   VALUE SPACES.                ECS046
  1483     12  FILLER          PIC X(5)    VALUE 'PAGE'.                ECS046
  1484     12  HD-PAGE-NO      PIC ZZZ9.                                ECS046
  1485                                                                  ECS046
  1486 01  HEAD-CARR.                                                   ECS046
  1487     12  FILLER          PIC X(13)   VALUE 'CARRIER    -'.        ECS046
  1488     12  HC-CARRIER      PIC X       VALUE SPACES.                ECS046
  1489     12  FILLER          PIC XX      VALUE SPACES.                ECS046
  1490     12  HC-CARRIER-NAME PIC X(30)   VALUE SPACES.                ECS046
  1491                                                                  ECS046
  1492 01  HEAD-BUS-TYPE.                                               ECS046
  1493     12  FILLER          PIC X(13)   VALUE 'BUS. TYPE  -'.        ECS046
  1494     12  HB-BUS-TYPE     PIC XX      VALUE SPACES.                ECS046
  1495     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1496     12  HB-BUS-DESC     PIC X(24)   VALUE SPACES.                ECS046
  1497                                                                  ECS046
  1498 01  HEAD-RPT-CODE.                                               ECS046
  1499     12  HR-CAPTION      PIC X(10)   VALUE SPACES.                ECS046
  1500     12  FILLER          PIC XXX     VALUE ' -'.                  ECS046
  1501     12  HR-RPT-CODE     PIC X(10)   VALUE SPACES.                ECS046
  1502                                                                  ECS046
  1503 01  HEAD-RPT2-CODE.                                              ECS046
  1504     12  HR2-CAPTION     PIC X(10)   VALUE SPACES.                ECS046
  1505     12  FILLER          PIC XXX     VALUE ' -'.                  ECS046
  1506     12  HR2-RPT-CODE1   PIC X(10)   VALUE SPACES.                ECS046
  1507     12  FILLER          PIC XXX     VALUE ' -'.                  ECS046
  1508     12  HR2-RPT-CODE2   PIC X(10)   VALUE SPACES.                ECS046
  1509                                                                  ECS046
  1510 01  HEAD-GROUP.                                                  ECS046
  1511     12  FILLER          PIC X(13)   VALUE 'GROUP      -'.        ECS046
  1512     12  HG-GROUP        PIC X(6)    VALUE SPACES.                ECS046
  1513                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ECS046.cbl
  1515 01  HEAD-G-A.                                                    ECS046
  1516     12  FILLER          PIC X(13)   VALUE 'GENL AGENT -'.        ECS046
  1517     12  HGA-AGENT       PIC X(10)   VALUE SPACES.                ECS046
  1518     12  FILLER          PIC X(5)    VALUE SPACES.                ECS046
  1519     12  HGA-GA-NAME     PIC X(30)   VALUE SPACES.                ECS046
  1520                                                                  ECS046
  1521 01  HEAD-STATE.                                                  ECS046
  1522     12  FILLER          PIC X(13)   VALUE 'STATE      -'.        ECS046
  1523     12  HS-STATE        PIC XX      VALUE SPACES.                ECS046
  1524                                                                  ECS046
  1525 01  HEAD-ACCT.                                                   ECS046
  1526     12  FILLER          PIC X(13)   VALUE 'ACCOUNT    -'.        ECS046
  1527     12  HA-ACCOUNT      PIC X(10)   VALUE SPACES.                ECS046
  1528     12  FILLER          PIC XX      VALUE SPACES.                ECS046
  1529     12  HA-ACCT-NAME    PIC X(30)   VALUE SPACES.                ECS046
  1530     12  FILLER          PIC XX      VALUE SPACES.                ECS046
  1531     12  HA-ACCT-CITY    PIC X(30)   VALUE SPACES.                ECS046
  1532                                                                  ECS046
  1533 01  HD-BRK-TYPE.                                                 ECS046
  1534     12  HD-RPT-CAPTION  PIC X(10)   VALUE SPACES.                ECS046
  1535     12  FILLER          PIC X(7)    VALUE ' TOTALS'.             ECS046
  1536                                                                  ECS046
  1537 01  HEAD-4A.                                                     ECS046
  1538     12  FILLER          PIC X(50)   VALUE                        ECS046
  1539         '          NET       EARNED     CLAIMS       EARNED'.    ECS046
  1540     12  HEAD-4A-FIL1    PIC X(27)   VALUE SPACES.                ECS046
  1541     12  FILLER          PIC X(12)   VALUE                        ECS046
  1542         'PREMIUM     '.                                          ECS046
  1543     12  HEAD-4A-FIL2    PIC X(8)    VALUE 'PREMIUM '.            ECS046
  1544     12  FILLER          PIC X(33)   VALUE                        ECS046
  1545         'UNDERWRITE  LOSS   COMP    TOTAL '.                     ECS046
  1546                                                                  ECS046
  1547 01  HEAD-4A-DESC.                                                ECS046
  1548     12  FIL1-DESC       PIC X(27)   VALUE                        ECS046
  1549             '                RETRO      '.                       ECS046
  1550     12  FIL2-DESC       PIC X(8)    VALUE                        ECS046
  1551             'MINIMUM '.                                          ECS046
  1552                                                                  ECS046
  1553 01  HEAD-5A.                                                     ECS046
  1554     12  FILLER          PIC X(50)   VALUE                        ECS046
  1555         '        PREMIUM     PREMIUM   INCURRED       COMP'.     ECS046
  1556     12  FILLER          PIC X(27)   VALUE                        ECS046
  1557         '    SURPLUS   RETENTION'.                               ECS046
  1558     12  FILLER          PIC X(12)   VALUE                        ECS046
  1559         'PROFIT      '.                                          ECS046
  1560     12  HEAD-5A-FILL1   PIC X(6)    VALUE  ' TAXES'.             ECS046
  1561     12  FILLER          PIC X(35)   VALUE                        ECS046
  1562         '    INCOME    RATIO  RATIO  CHARGES'.                   ECS046
  1563                                                                  ECS046
  1564 01  HEAD-5A-DESC.                                                ECS046
  1565     12  FILLER          PIC X(6)    VALUE                        ECS046
  1566         'MARGIN'.                                                ECS046
  1567                                                                  ECS046
  1568 01  HEAD-4B.                                                     ECS046
  1569     12  FILLER          PIC X(50)   VALUE                        ECS046
  1570         '        LOSS          NET      TOTAL      PREMIUM'.     ECS046
  1571     12  FILLER          PIC X(12).                               ECS046
  1572     12  H4B-BUS         PIC XXX.                                 ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ECS046.cbl
  1573     12  FILLER          PIC X(10).                               ECS046
  1574     12  H4B-GENERAL     PIC X(7).                                ECS046
  1575     12  FILLER          PIC X(50).                               ECS046
  1576                                                                  ECS046
  1577 01  HEAD-5B.                                                     ECS046
  1578     12  FILLER          PIC X(50)   VALUE                        ECS046
  1579         ' SEQ    RATIO       PREMIUM   CHARGES     PROFIT'.      ECS046
  1580     12  FILLER          PIC X(9)    VALUE SPACES.                ECS046
  1581     12  H5B-CTL-HDA     PIC X(15).                               ECS046
  1582     12  H5B-CTL-HDB     PIC X(16).                               ECS046
  1583     12  FILLER          PIC X(44)   VALUE                        ECS046
  1584         ' ACCOUNT     ACCOUNT NAME'.                             ECS046
  1585                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ECS046.cbl
  1587 01  DTL-NO-ACCT.                                                 ECS046
  1588     12  DNA-CARR        PIC X       VALUE SPACES.                ECS046
  1589     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1590     12  DNA-GROUP       PIC X(6)    VALUE SPACES.                ECS046
  1591     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1592     12  DNA-ST          PIC XX      VALUE SPACES.                ECS046
  1593     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1594     12  DNA-ACCT        PIC X(10)   VALUE SPACES.                ECS046
  1595     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1596     12  DNA-FMO         PIC XX      VALUE SPACES.                ECS046
  1597     12  DNA-FS1         PIC X       VALUE '-'.                   ECS046
  1598     12  DNA-FDA         PIC XX      VALUE SPACES.                ECS046
  1599     12  DNA-FS2         PIC X       VALUE '-'.                   ECS046
  1600     12  DNA-FYR         PIC XX      VALUE SPACES.                ECS046
  1601     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1602     12  DNA-TMO         PIC XX      VALUE SPACES.                ECS046
  1603     12  DNA-TS1         PIC X       VALUE '-'.                   ECS046
  1604     12  DNA-TDA         PIC XX      VALUE SPACES.                ECS046
  1605     12  DNA-TS2         PIC X       VALUE '-'.                   ECS046
  1606     12  DNA-TYR         PIC XX      VALUE SPACES.                ECS046
  1607     12  FILLER          PIC X(4)    VALUE SPACES.                ECS046
  1608     12  DNA-MESSAGE     PIC X(40)   VALUE SPACES.                ECS046
  1609                                                                  ECS046
  1610 01  DTL-LINE-A.                                                  ECS046
  1611     12  DLA-BEN-DESC    PIC XXX.                                 ECS046
  1612     12  FILLER          PIC X           VALUE SPACES.            ECS046
  1613     12  DLA-NET-PREM    PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1614     12  DLA-EARN-PREM   PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1615     12  DLA-CLMS-INCUR  PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1616     12  DLA-EARN-COMP   PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1617     12  DLA-SURPLUS     PIC  ZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1618     12  DLA-RETENTION   PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1619     12  DLA-PREM-PROFIT PIC  ZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1620     12  DLA-PREM-TAX    PIC  ZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1621     12  DLA-UW-INCOME   PIC  ZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1622     12  DLA-LOSS-RATIO  PIC ZZZ9.99-.                            ECS046
  1623     12  DLA-LOSS-RATIO-RD REDEFINES DLA-LOSS-RATIO  PIC X(8).    ECS046
  1624     12  DLA-COMP-RATIO  PIC  Z9.99-.                             ECS046
  1625     12  FILLER          PIC X           VALUE SPACES.            ECS046
  1626     12  DLA-TOT-CHARGES PIC ZZ9.99-.                             ECS046
  1627     12  DLA-TOT-CHARGES-RD REDEFINES DLA-TOT-CHARGES  PIC X(7).  ECS046
  1628     12  FILLER          PIC XXX         VALUE SPACES.            ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ECS046.cbl
  1630 01  DTL-LINE-B.                                                  ECS046
  1631     12  DLB-SEQ-NO      PIC ZZZZ9.                               ECS046
  1632     12  FILLER          PIC X           VALUE SPACES.            ECS046
  1633     12  DLB-LOSS-RATIO  PIC ZZZ9.99-.                            ECS046
  1634     12  FILLER          PIC XX          VALUE SPACES.            ECS046
  1635     12  DLB-NET-PREM    PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1636     12  FILLER          PIC XX          VALUE SPACES.            ECS046
  1637     12  DLB-TOT-CHARGES PIC ZZ9.99-.                             ECS046
  1638     12  FILLER          PIC X           VALUE SPACES.            ECS046
  1639     12  DLB-PREM-PROFIT PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1640     12  DLB-DESC.                                                ECS046
  1641         16  FILLER          PIC X(13).                           ECS046
  1642         16  DLB-BUS-TYPE    PIC XX.                              ECS046
  1643         16  FILLER          PIC X(4).                            ECS046
  1644         16  DLB-CARRIER     PIC X.                               ECS046
  1645         16  FILLER          PIC X(4).                            ECS046
  1646         16  DLB-GROUP       PIC X(6).                            ECS046
  1647         16  FILLER          PIC X(4).                            ECS046
  1648         16  DLB-STATE       PIC XX.                              ECS046
  1649         16  FILLER          PIC X(4).                            ECS046
  1650     12  DLB-DESC2  REDEFINES  DLB-DESC.                          ECS046
  1651         16  FILLER          PIC X(10).                           ECS046
  1652         16  DLB2-CARRIER    PIC X.                               ECS046
  1653         16  FILLER          PIC X(4).                            ECS046
  1654         16  DLB2-GROUP      PIC X(6).                            ECS046
  1655         16  FILLER          PIC XXX.                             ECS046
  1656         16  DLB2-GA-OR-RPT-CD PIC X(10).                         ECS046
  1657         16  FILLER          PIC X(6).                            ECS046
  1658     12  DLB-ACCOUNT         PIC X(10)       VALUE SPACES.        ECS046
  1659     12  FILLER              PIC XX          VALUE SPACES.        ECS046
  1660     12  DLB-ACCT-NAME       PIC X(30)       VALUE SPACES.        ECS046
  1661                                                                  ECS046
* 1662                             COPY ELCDTECX.                       ECS046
  1663******************************************************************06/05/98
  1664*                                                                *ELCDTECX
  1665*                            ELCDTECX.                           *   LV005
  1666*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1667*                            VMOD=2.015                          *ELCDTECX
  1668*                                                                *ELCDTECX
  1669*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1670*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1671*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1672*                                                                *ELCDTECX
  1673******************************************************************ELCDTECX
  1674******************************************************************
  1675*                   C H A N G E   L O G
  1676*
  1677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1678*-----------------------------------------------------------------
  1679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1680* EFFECTIVE    NUMBER
  1681*-----------------------------------------------------------------
  1682* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1683*                                  BENEFIT CODES FROM 300 TO 900
  1684* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1685* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1686******************************************************************
  1687 01  DATE-CARD.                                                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1688     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1689     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1690     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1691     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1692     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1693     12  EP-SW                       PIC  X.                      ELCDTECX
  1694         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1695     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1696         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1697     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1698     12  RUN-CENTURY.                                             ELCDTECX
  1699         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1700     12  FILLER                      PIC  X.                         CL**4
  1701     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1702     12  FILLER                      PIC  XXX.                    ELCDTECX
  1703     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1704                                                                  ELCDTECX
  1705 01  FILLER                          PIC  X(7)                       CL**6
  1706                                          VALUE 'OPTIONS'.        ELCDTECX
  1707 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1708     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1709     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1710     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1711         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1712         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1713     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1714     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1715     12  FILLER                      PIC  X.                      ELCDTECX
  1716     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1717     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1718     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1719     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1720     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1721     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1722     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1723     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1724     12  FILLER                      PIC  X.                      ELCDTECX
  1725     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1726     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1727     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1728     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1729     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1730     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1731     12  FILLER                      PIC  X.                      ELCDTECX
  1732     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1733     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1734     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1735     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1736     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1737     12  DTE-R78                     PIC  X.                      ELCDTECX
  1738     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1739     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1740     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1741     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1742     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1743     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1744     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1745                                     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1746         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1747                                                 ' '.             ELCDTECX
  1748         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1749         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1750     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1751         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1752         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1753     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1754     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1755                                     PIC  9.                         CL**4
  1756     12  DTE-SYSTEM.                                              ELCDTECX
  1757         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1758         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1759         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1760         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1761         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1762         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1763         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1764         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1765         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1766         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1767         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1768         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1769         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1770         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1771         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1772         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1773         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1774         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1775         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1776         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1777         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1778         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1779         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1780         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1781         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1782         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1783     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1784         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1785                                     PIC  X.                      ELCDTECX
  1786     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1787                                                                  ELCDTECX
  1788 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1789     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1790     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1791     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1792*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1793     12  FILLER                      PIC  X.                      ELCDTECX
  1794     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1795     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1796     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1797     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1798     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1799     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1800     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1801                                                                  ELCDTECX
  1802     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1803     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1804     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1805     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1806                                                                  ELCDTECX
  1807     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1808     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1809     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1810     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1811                                                                  ELCDTECX
  1812     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1813     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1814                                                                  ELCDTECX
  1815     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1816     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1817                                                                  ELCDTECX
  1818     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1819                                                                  ELCDTECX
  1820 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1821     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1822     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1823     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1824     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1825     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1826     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1827     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1828                                                                  ELCDTECX
  1829 01  FILLER                          PIC  X(12)                   ELCDTECX
  1830                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1831 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1832     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1833         16  CNT-ID                  PIC  X.                      ELCDTECX
  1834         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1835                                                                  ELCDTECX
  1836 01  FILLER                          PIC  X(11)                   ELCDTECX
  1837                                          VALUE 'STATE NAMES'.    ELCDTECX
  1838 01  STATE-NAMES.                                                 ELCDTECX
  1839     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1840         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1841         16  STATE-PIC1.                                          ELCDTECX
  1842             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1843             20  FILLER              PIC  XXX.                    ELCDTECX
  1844             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1845             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1846             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1847             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1848                                                                  ELCDTECX
  1849 01  FILLER                          PIC  X(13)                   ELCDTECX
  1850                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1851 01  CARRIER-NAMES.                                               ELCDTECX
  1852     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1853         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1854         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1855         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1856         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1857         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1858         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1859*        16  FILLER                  PIC  X.                      ELCDTECX
  1860         16  CARRIER-SEC-PAY         PIC  X.
  1861             88  SEC-PAY-CARRIER          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1862                                                                  ELCDTECX
  1863 01  FILLER                          PIC  X(9)                       CL**6
  1864                                          VALUE 'INS TYPES'.      ELCDTECX
  1865 01  CLAS-INS-TYPES.                                              ELCDTECX
  1866*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1867     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1868         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1869         16  CLAS-I-AB3.                                          ELCDTECX
  1870             20  FILLER              PIC  X.                      ELCDTECX
  1871             20  CLAS-I-AB2.                                      ELCDTECX
  1872                 24  FILLER          PIC  X.                      ELCDTECX
  1873                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1874         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1875             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1876             20  FILLER              PIC  X.                         CL**4
  1877         16  CLAS-I-AB10.                                         ELCDTECX
  1878             20  FILLER              PIC  X(9).                   ELCDTECX
  1879             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1880         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1881         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1882         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1883         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1884             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1885         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1886         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1887         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1888         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1889         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1890         16  FILLER                  PIC  X(05).
  1891                                                                  ELCDTECX
  1892 01  FILLER                          PIC  X(16)                   ELCDTECX
  1893                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1894 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1895     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1896                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1897         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1898         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1899         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1900         16  CLAS-MORT-DESC.                                      ELCDTECX
  1901             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1902             20  FILLER              PIC  XX.                        CL**5
  1903             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1904             20  FILLER              PIC  X.                         CL**5
  1905             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1906             20  FILLER              PIC  X.                         CL**5
  1907             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1908             20  FILLER              PIC  X.                         CL**5
  1909             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1910             20  FILLER              PIC  X(5).                      CL**6
  1911                                                                  ELCDTECX
  1912 01  FILLER                          PIC  X(15)                   ELCDTECX
  1913                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1914 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1915     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1916         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1917         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1918         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1919         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1920         16  FILLER                  PIC  X(4).                      CL**6
  1921                                                                  ELCDTECX
  1922 01  FILLER                          PIC  X(7)                       CL**6
  1923                                     VALUE 'INDEXES'.             ELCDTECX
  1924 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1925     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1926     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1927     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1928     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1929     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1930     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1931     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1932     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1933     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1934     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1935     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1936     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1937     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1938     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1939     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1940     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1941     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1942                                                                  ELCDTECX
  1943 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1944     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1945     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1946     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1947     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1948     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1949     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1950     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1951     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1952     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1953     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1954     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1955                                                                  ELCDTECX
  1956 01  FILLER                          PIC  X(13)                   ELCDTECX
  1957                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1958 01  CLAS-MISC.                                                   ELCDTECX
  1959     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1960         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1961         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1962         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1963     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1964     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1965     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1966     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1967     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1968     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1969     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1970     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1971     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1972     12  STATE-L                     PIC  XX.                     ELCDTECX
  1973     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1974     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1975     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1976         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1977         16  DTE-F-2                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1978     12  DTE-ABEND-WORK.                                          ELCDTECX
  1979         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1980         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1981                                                                  ELCDTECX
  1982 01  FILLER                          PIC  X(12)                   ELCDTECX
  1983                                     VALUE 'WORKING DATE'.        ELCDTECX
  1984 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1985     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1986         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1987         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1988         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1989     12  WS-CURRENT-DATE.                                         ELCDTECX
  1990         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1991         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1992         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1993         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1994         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1995     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1996         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1997         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1998                                                                  ELCDTECX
  1999 01  FILLER                          PIC  X(12)                   ELCDTECX
  2000                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2001 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2002     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2003         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2004         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2005         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2006                                                                  ELCDTECX
  2007 01  FILLER                          PIC  X(10)                   ELCDTECX
  2008                                     VALUE 'STATE TLRS'.          ELCDTECX
  2009 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2010     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2011         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2012         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2013                                                                  ELCDTECX
  2014 01  FILLER                          PIC  X(13)                   ELCDTECX
  2015                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2016 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2017     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2018         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2019                                                                  ELCDTECX
  2020 01  FILLER                          PIC  X(13)                   ELCDTECX
  2021                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2022 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2023     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2024     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2025     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2026                                     PIC  X.                         CL**5
  2027     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2028     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2029     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2030     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2031     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2032     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2033     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2034     12  FILLER                      PIC  X(75).                  ELCDTECX
  2035******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ECS046.cbl
  2036*01  MISC-CARR-PCT-DATA.                                          00001521
  2037*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2038*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2039*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2040*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2041*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2042*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2043******************************************************************ELCDTECX
  2044                                                                  ECS046
* 2045                             COPY ELCDTEVR.                       ECS046
  2046***************************************************************** 04/15/98
  2047*                                                                *ELCDTEVR
  2048*                                                                *ELCDTEVR
  2049*                            ELCDTEVR.                           *   LV003
  2050*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2051*                            VMOD=2.001                          *   CL**2
  2052*                                                                *ELCDTEVR
  2053*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2054*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2055*                                                                *ELCDTEVR
  2056******************************************************************ELCDTEVR
  2057 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2058     05  WS-RUN-DATE.                                             ELCDTEVR
  2059         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2060         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2061         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2062             15  RUN-CC              PIC  99.                     ELCDTEVR
  2063             15  RUN-YR              PIC  99.                     ELCDTEVR
  2064         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2065         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2066     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2067            WS-RUN-DATE              PIC 9(11).                      CL**2
  2068     05  WS-EP-DT.                                                ELCDTEVR
  2069         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2070         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2071         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2072             15  EP-CC               PIC  99.                     ELCDTEVR
  2073             15  EP-YR               PIC  99.                     ELCDTEVR
  2074         10  EP-MO                   PIC  99.                     ELCDTEVR
  2075         10  EP-DA                   PIC  99.                     ELCDTEVR
  2076     05  WS-EP-DT-N REDEFINES                                        CL**2
  2077            WS-EP-DT                 PIC 9(11).                      CL**2
  2078     05  WS-DTE-CONV-DT.                                             CL**4
  2079         10  FILLER                  PIC  9(03).                     CL**4
  2080         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2081         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2082             15  DTE-CONV-CC         PIC  99.                        CL**4
  2083             15  DTE-CONV-YR         PIC  99.                        CL**4
  2084         10  DTE-CONV-MO             PIC  99.                        CL**4
  2085         10  DTE-CONV-DA             PIC  99.                        CL**4
  2086     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2087            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2088 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2089     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2090         10  FILLER                            PIC 999.           ELCDTEVR
  2091         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2092         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2093             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2094             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2095         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2096         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2097     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2098            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2099     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2100         10  FILLER                            PIC 999.           ELCDTEVR
  2101         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2102         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2103         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2104         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2105     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2106            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2107 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2108     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2109         10  FILLER                            PIC 999.           ELCDTEVR
  2110         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2111         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2112             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2113             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2114         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2115         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2116     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2117            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2118     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2119         10  FILLER                            PIC 999.           ELCDTEVR
  2120         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2121         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2122             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2123             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2124         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2125         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2126     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2127            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2128     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2129         10  FILLER                            PIC 999.           ELCDTEVR
  2130         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2131         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2132             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2133             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2134         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2135         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2136     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2137            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2138 01  WS-RATE-RECORD.                                              ELCDTEVR
  2139         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2140             10  FILLER                        PIC 999.           ELCDTEVR
  2141             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2142             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2143                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2144                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2145             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2146             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2147         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2148                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  2149                                                                  ECS046
* 2150                             COPY ELCEPCVR.                       ECS046
  2151******************************************************************05/15/98
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ECS046.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2152*                                                                *ELCEPCVR
  2153*                                                                *ELCEPCVR
  2154*                            ELCEPCVR                            *   LV003
  2155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2156*                            VMOD=2.001                          *ELCEPCVR
  2157*                                                                *ELCEPCVR
  2158*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2159*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2160*                                                                *ELCEPCVR
  2161******************************************************************ELCEPCVR
  2162 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2163     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2164         10  FILLER            PIC 999.                           ELCEPCVR
  2165         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2166         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2167             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2168             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2169         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2170         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2171     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2172            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2173     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2174         10  FILLER            PIC 999.                              CL**5
  2175         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2176         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2177             15  EC-EXP-CC     PIC 99.                               CL**5
  2178             15  EC-EXP-YR     PIC 99.                               CL**5
  2179         10  EC-EXP-MO         PIC 99.                               CL**5
  2180         10  EC-EXP-DA         PIC 99.                               CL**5
  2181     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2182            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2183     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2184         10  FILLER            PIC 999.                           ELCEPCVR
  2185         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2186         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2187             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2188             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  2189         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2190         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  2191     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2192            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2193     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2194         10  FILLER            PIC 999.                              CL**5
  2195         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2196         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2197             15  EC-EFF-CC     PIC 99.                               CL**5
  2198             15  EC-EFF-YR     PIC 99.                               CL**5
  2199         10  EC-EFF-MO         PIC 99.                               CL**5
  2200         10  EC-EFF-DA         PIC 99.                               CL**5
  2201     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2202            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2203     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2204         10  FILLER            PIC 999.                           ELCEPCVR
  2205         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2206         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2207             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  2208             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2209         10  EP-COV-MO         PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ECS046.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2210         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2211     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2212            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2213     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2214         10  FILLER            PIC 999.                           ELCEPCVR
  2215         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  2216         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2217             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2218             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2219         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2220         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2221     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2222            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2223     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2224         10  FILLER            PIC 999.                           ELCEPCVR
  2225         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2226         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2227             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2228             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2229         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2230         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2231     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2232            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2233     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2234         10  FILLER            PIC 999.                           ELCEPCVR
  2235         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2236         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2237             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2238             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2239         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2240         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2241     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2242            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2243     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2244         10  FILLER            PIC 999.                           ELCEPCVR
  2245         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2246         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  2247             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2248             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  2249         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2250         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2251     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2252            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2253                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ECS046.cbl
  2255 PROCEDURE DIVISION.                                              ECS046
  2256                                                                  ECS046
  2257 0100-START.                                                      ECS046
* 2258                             COPY ELCDTERX.                       ECS046
  2259******************************************************************04/15/98
  2260*                                                                *ELCDTERX
  2261*                                                                *ELCDTERX
  2262*                            ELCDTERX.                           *   LV002
  2263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2264*                            VMOD=2.007                          *ELCDTERX
  2265*                                                                *ELCDTERX
  2266*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2267*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2268*      = ELCDTEFD)                                               *ELCDTERX
  2269*                                                                *ELCDTERX
  2270******************************************************************ELCDTERX
  2271                                                                  ELCDTERX
  2272     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2273                                                                  ELCDTERX
  2274     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2275     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2276     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2277                                                                  ELCDTERX
  2278     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2279                                                                  ELCDTERX
  2280******************************************************************ELCDTERX
  2281*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2282*          WARNING MESSAGES.                                      ELCDTERX
  2283******************************************************************ELCDTERX
  2284     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2285         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2286                                                                  ELCDTERX
  2287     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2288                                                                  ELCDTERX
  2289     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2290                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2291                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2292                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2293                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2294                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2295                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2296                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2297                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2298                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2299                                                                  ELCDTERX
  2300     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2301                                                                  ELCDTERX
  2302     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2303                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2304                                                                  ELCDTERX
  2305     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2306     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2307     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2308     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2309                                                                  ELCDTERX
  2310     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2311         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  2312     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2313         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2314                                                                  ELCDTERX
  2315     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2316         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2317     ELSE                                                         ELCDTERX
  2318         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2319                                                                  ELCDTERX
  2320 0005-READ--CARD.                                                 ELCDTERX
  2321     READ DISK-DATE                                               ELCDTERX
  2322         AT END CLOSE DISK-DATE                                   ELCDTERX
  2323             GO TO 0060-READ--TEST.                               ELCDTERX
  2324                                                                  ELCDTERX
  2325     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2326                                                                  ELCDTERX
  2327     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2328         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2329         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2330         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2331         GO TO 0005-READ--CARD.                                   ELCDTERX
  2332                                                                  ELCDTERX
  2333     IF DD-ID = 'CLAD'                                            ELCDTERX
  2334         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2335         GO TO 0005-READ--CARD.                                   ELCDTERX
  2336                                                                  ELCDTERX
  2337     IF DD-ID = 'CLAX'                                            ELCDTERX
  2338         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2339         GO TO 0005-READ--CARD.                                   ELCDTERX
  2340                                                                  ELCDTERX
  2341     IF DD-ID = 'CLAF'                                            ELCDTERX
  2342         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2343         GO TO 0005-READ--CARD.                                   ELCDTERX
  2344                                                                  ELCDTERX
  2345     IF DD-ID = 'CLAC'                                            ELCDTERX
  2346         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2347                                                                  ELCDTERX
  2348     IF DD-ID = 'CARR'                                            ELCDTERX
  2349         GO TO 0015-READ--CARR.                                   ELCDTERX
  2350                                                                  ELCDTERX
  2351     IF DD-ID = 'STAT'                                            ELCDTERX
  2352         GO TO 0020-READ--STAT.                                   ELCDTERX
  2353                                                                  ELCDTERX
  2354     IF DD-ID = 'BUSC'                                            ELCDTERX
  2355         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2356                                                                  ELCDTERX
  2357     IF DD-ID = 'MORT'                                            ELCDTERX
  2358         GO TO 0030-READ--MORT.                                   ELCDTERX
  2359                                                                  ELCDTERX
  2360     IF DD-ID = 'CLAI'                                            ELCDTERX
  2361         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2362                                                                  ELCDTERX
  2363     IF DD-ID = 'COLC'                                            ELCDTERX
  2364         GO TO 0065-READ--COLC.                                   ELCDTERX
  2365                                                                  ELCDTERX
  2366     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2367        DD-IDA = 'CL'                                             ELCDTERX
  2368         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2369                                                                  ELCDTERX
  2370     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2371        DD-IDA = 'PO'                                             ELCDTERX
  2372         GO TO 0050-READ--POXX.                                   ELCDTERX
  2373                                                                  ELCDTERX
  2374     IF DD-ID = 'OPCA'                                            ELCDTERX
  2375         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2376                                                                  ELCDTERX
  2377     IF DD-ID = 'OPST'                                            ELCDTERX
  2378         GO TO 0072-READ--OPST.                                   ELCDTERX
  2379                                                                  ELCDTERX
  2380     IF DD-ID = 'OPBS'                                            ELCDTERX
  2381         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2382                                                                  ELCDTERX
  2383     IF DD-ID = 'OPMS'                                            ELCDTERX
  2384         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2385                                                                  ELCDTERX
  2386     GO TO 0005-READ--CARD.                                       ELCDTERX
  2387                                                                  ELCDTERX
  2388 0010-READ--CLAC.                                                 ELCDTERX
  2389     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2390     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2391     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2392     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2393     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2394     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2395     GO TO 0005-READ--CARD.                                       ELCDTERX
  2396                                                                  ELCDTERX
  2397 0015-READ--CARR.                                                 ELCDTERX
  2398     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2399     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2400        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2401        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2402        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2403        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2404        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2405        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2406        MOVE DD-CARR1-SECPAY-SW
  2407                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2408     END-IF
  2409                                                                  ELCDTERX
  2410     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2411     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2412        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2413        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2414        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2415        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2416        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2417        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2418        MOVE DD-CARR2-SECPAY-SW
  2419                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2420     END-IF
  2421                                                                  ELCDTERX
  2422                                                                  ELCDTERX
  2423     GO TO 0005-READ--CARD.                                       ELCDTERX
  2424                                                                  ELCDTERX
  2425 0020-READ--STAT.                                                 ELCDTERX
  2426     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2427     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2428        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2429         GO TO 0005-READ--CARD.                                   ELCDTERX
  2430                                                                  ELCDTERX
  2431     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2432     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2433     GO TO 0020-READ--STAT.                                       ELCDTERX
  2434                                                                  ELCDTERX
  2435 0025-READ--BUSC.                                                 ELCDTERX
  2436     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2437     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2438        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2439         GO TO 0005-READ--CARD.                                   ELCDTERX
  2440                                                                  ELCDTERX
  2441     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2442     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2443     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2444                                                                  ELCDTERX
  2445 0030-READ--MORT.                                                 ELCDTERX
  2446     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2447     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2448        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2449         GO TO 0005-READ--CARD.                                   ELCDTERX
  2450                                                                  ELCDTERX
  2451     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2452     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2453     GO TO 0030-READ--MORT.                                       ELCDTERX
  2454                                                                  ELCDTERX
  2455 0035-READ--CLXX.                                                 ELCDTERX
  2456     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2457          GO TO 0005-READ--CARD.                                  ELCDTERX
  2458                                                                  ELCDTERX
  2459     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2460         DISPLAY '***********************************************'ELCDTERX
  2461         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2462         DISPLAY '***********************************************'ELCDTERX
  2463         GO TO 0055-READ--STOP.                                   ELCDTERX
  2464                                                                  ELCDTERX
  2465     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2466        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2467         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2468                                                                  ELCDTERX
  2469     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2470        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2471         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2472                                                                  ELCDTERX
  2473*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2474     GO TO 0005-READ--CARD.                                       ELCDTERX
  2475                                                                  ELCDTERX
  2476 0040-READ--CLAI.                                                 ELCDTERX
  2477     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2478     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2479        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2480         GO TO 0005-READ--CARD.                                   ELCDTERX
  2481                                                                  ELCDTERX
  2482     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2483     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2484     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2485                                                                  ELCDTERX
  2486 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2487     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2488     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2489                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2490     PERFORM ABEND-PGM.                                           ELCDTERX
  2491                                                                  ELCDTERX
  2492 0050-READ--POXX.                                                 ELCDTERX
  2493     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2494         GO TO 0005-READ--CARD.                                   ELCDTERX
  2495                                                                  ELCDTERX
  2496     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2497         DISPLAY '***********************************************'ELCDTERX
  2498         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2499         DISPLAY '***********************************************'ELCDTERX
  2500         GO TO 0055-READ--STOP.                                   ELCDTERX
  2501                                                                  ELCDTERX
  2502     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2503     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2504     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2505     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2506                                                                  ELCDTERX
  2507     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2508         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2509     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2510         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2511                                                                  ELCDTERX
  2512     GO TO 0005-READ--CARD.                                       ELCDTERX
  2513                                                                  ELCDTERX
  2514 0055-READ--STOP.                                                 ELCDTERX
  2515     GOBACK.                                                      ELCDTERX
  2516                                                                  ELCDTERX
  2517 0060-READ--TEST.                                                 ELCDTERX
  2518     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2519        CLAX-ID         = SPACE  OR                               ELCDTERX
  2520        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2521         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2522                                                                  ELCDTERX
  2523     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2524     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2525                                                                  ELCDTERX
  2526 0065-READ--COLC.                                                 ELCDTERX
  2527     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2528     GO TO 0005-READ--CARD.                                       ELCDTERX
  2529                                                                  ELCDTERX
  2530 0070-READ--OPCA.                                                 ELCDTERX
  2531                                                                  ELCDTERX
  2532     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2533                                                                  ELCDTERX
  2534     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2535             OR                                                   ELCDTERX
  2536         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2537         GO TO 0005-READ--CARD.                                   ELCDTERX
  2538                                                                  ELCDTERX
  2539     ADD 1                       TO INDEXCA.                      ELCDTERX
  2540     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2541                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2542     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2543                                                                  ELCDTERX
  2544 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2545                                                                  ELCDTERX
  2546     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2547                                                                  ELCDTERX
  2548     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2549             OR                                                   ELCDTERX
  2550         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2551         GO TO 0005-READ--CARD.                                   ELCDTERX
  2552                                                                  ELCDTERX
  2553     ADD 1                       TO INDEXST.                      ELCDTERX
  2554     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2555                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2556     GO TO 0072-READ--OPST.                                       ELCDTERX
  2557                                                                  ELCDTERX
  2558 0074-READ--OPBS.                                                 ELCDTERX
  2559                                                                  ELCDTERX
  2560     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2561                                                                  ELCDTERX
  2562     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2563             OR                                                   ELCDTERX
  2564         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2565         GO TO 0005-READ--CARD.                                   ELCDTERX
  2566                                                                  ELCDTERX
  2567     ADD 1                       TO INDEXBS.                      ELCDTERX
  2568     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2569     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2570                                                                  ELCDTERX
  2571 0079-READ--EXIT.                                                 ELCDTERX
  2572*    EXIT.                                                        ELCDTERX
  2573******************************************************************ELCDTERX
  2574                                                                  ECS046
  2575     MOVE WS-CURRENT-DATE        TO HD-RUN-DATE.                  ECS046
  2576     MOVE ALPH-DATE              TO HD-ALPHA-DATE.                ECS046
  2577     MOVE COMPANY-NAME           TO HD-COMP.                      ECS046
  2578     MOVE RUN-DATE               TO BEG-DATE                      ECS046
  2579                                    RUN-DT.                       ECS046
  2580 0200-BUILD-SELECT-DATES.                                         ECS046
  2581     IF DTE-PGM-OPT = '1'                                         ECS046
  2582*                           SET BEGIN DATE FOR YTD REPORT         ECS046
  2583         SUBTRACT 1 FROM BD-CCYY                                  ECS046
  2584         MOVE 12                 TO BD-MO                         ECS046
  2585         MOVE 31                 TO BD-DA.                        ECS046
  2586                                                                  ECS046
  2587     IF DTE-PGM-OPT = '2'                                         ECS046
  2588*                           SET BEGIN DATE FOR 12 MO. REPORT      ECS046
  2589         SUBTRACT 1 FROM BD-CCYY.                                 ECS046
  2590                                                                  ECS046
  2591     IF DTE-PGM-OPT = '3'                                         ECS046
  2592*                           SET BEGIN DATE FOR ITD REPORT         ECS046
  2593         MOVE ZEROS              TO BEG-DATE.                     ECS046
  2594                                                                  ECS046
  2595     IF DTE-PGM-OPT = 4                                           ECS046
  2596*                         SET BEGIN DATE FOR CURRENT MONTH REPORT ECS046
  2597         MOVE 31                 TO BD-DA                         ECS046
  2598         IF BD-MO = 01                                            ECS046
  2599             SUBTRACT 1 FROM BD-CCYY                              ECS046
  2600             MOVE 12             TO BD-MO                         ECS046
  2601           ELSE                                                   ECS046
  2602             SUBTRACT 1 FROM BD-MO.                               ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ECS046.cbl
  2603                                                                  ECS046
  2604 0500-SORT-CONTROL.                                               ECS046
  2605     SORT SORT-WORK-A ON ASCENDING                                ECS046
  2606                         SWA-CONTROL-OUT                          ECS046
  2607         INPUT PROCEDURE   1000-BUILD-EXTRACTS                    ECS046
  2608         OUTPUT PROCEDURE  3000-PRINT-REPORT-A.                   ECS046
  2609                                                                  ECS046
  2610     IF SORT-RETURN NOT = ZERO AND 4                              ECS046
  2611         MOVE SORT-RETURN                  TO WS-RETURN-CODE      ECS046
  2612         MOVE 'UNSUCCESSFUL SORT - SORT 1' TO WS-ABEND-MESSAGE    ECS046
  2613         GO TO ABEND-PGM.                                         ECS046
  2614                                                                  ECS046
  2615     IF DTE-FMT-OPT NOT = 1                                       ECS046
  2616         SORT SORT-WORK-B                                         ECS046
  2617             DESCENDING        SWB-CONTROL-OUT                    ECS046
  2618             USING WORK-FILE                                      ECS046
  2619             OUTPUT PROCEDURE  5000-PRINT-REPORT-B                ECS046
  2620         IF SORT-RETURN NOT = ZERO AND 4                          ECS046
  2621             MOVE SORT-RETURN        TO WS-RETURN-CODE            ECS046
  2622             MOVE 'UNSUCCESSFUL SORT - SORT 2'                    ECS046
  2623                                     TO WS-ABEND-MESSAGE          ECS046
  2624             GO TO ABEND-PGM.                                     ECS046
  2625                                                                  ECS046
  2626     GOBACK.                                                      ECS046
  2627                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ECS046.cbl
  2629 1000-BUILD-EXTRACTS SECTION.                                     ECS046
  2630                                                                  ECS046
  2631 1100-BEGIN-PROCESSING.                                           ECS046
  2632     OPEN INPUT ACC-MSTR                                          ECS046
  2633                EPEC-FILE                                         ECS046
  2634         OUTPUT PRNTR.                                            ECS046
  2635                                                                  ECS046
  2636     IF ERACCT-FILE-STATUS   = '00' OR '97'                       ECS046
  2637         NEXT SENTENCE                                            ECS046
  2638     ELSE                                                         ECS046
  2639         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS          ECS046
  2640         MOVE 'OPEN ERROR - ERACCT' TO WS-ABEND-MESSAGE           ECS046
  2641         GO TO ABEND-PGM.                                         ECS046
  2642                                                                  ECS046
  2643     IF DTE-CLIENT  =  'MON'                                      ECS046
  2644         MOVE FIL1-DESC          TO  HEAD-4A-FIL1                 ECS046
  2645         MOVE FIL2-DESC          TO  HEAD-4A-FIL2                 ECS046
  2646         MOVE HEAD-5A-DESC       TO  HEAD-5A-FILL1.               ECS046
  2647                                                                  ECS046
  2648     PERFORM 2400-ZERO-DETAIL-ACCUMULATORS                        ECS046
  2649         VARYING SA FROM 1 BY 1 UNTIL SA GREATER 4.               ECS046
  2650                                                                  ECS046
  2651     PERFORM 2100-READ-EXTRACT THRU 2140-EXIT.                    ECS046
  2652     PERFORM 2200-READ-ACCT    THRU 2240-EXIT.                    ECS046
  2653                                                                  ECS046
  2654     MOVE AM-COMPANY-CD          TO  HOLD-COMPANY-CD.             ECS046
  2655     MOVE EP-CONTROL             TO WS-SAVE-CONTROL.              ECS046
  2656     GO TO 1800-CHECK-ACCT-MSTR.                                  ECS046
  2657                                                                  ECS046
  2658 1200-CHECK-CONTROL.                                              ECS046
  2659                                                                  ECS046
  2660* ALL PURGE RECORDS FROM THE EPEC FILE ARE INCLUDED.              ECS046
  2661* THOSE WITH A DATE GREATER THAN THE PERIOD BEGIN DATE            ECS046
  2662* ARE ADDED TO THE PERIOD ENDING DATE TOTALS.                     ECS046
  2663* THOSE WITH A DATE LESS THAN OR EQUAL TO THE PERIOD ENDING DATE  ECS046
  2664* ARE ADDED TO THE PERIOD BEGINNING AND ENDING DATE TOTALS.       ECS046
  2665                                                                  ECS046
  2666     IF EP-PURGE = 'P'                                            ECS046
  2667         IF WS-EP-RUN-DTE GREATER BEG-DATE                        ECS046
  2668             MOVE 'Q'            TO EP-PURGE                      ECS046
  2669             GO TO 1250-TEST-ACCUM                                ECS046
  2670         ELSE                                                     ECS046
  2671             GO TO 1250-TEST-ACCUM.                               ECS046
  2672                                                                  ECS046
  2673     IF EP-RUN-YR = BD-YR AND                                     ECS046
  2674        EP-RUN-MO = BD-MO                                         ECS046
  2675         MOVE '1'                TO EP-PURGE                      ECS046
  2676         GO TO 1250-TEST-ACCUM.                                   ECS046
  2677                                                                  ECS046
  2678     MOVE '2'                    TO EP-PURGE.                     ECS046
  2679                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ECS046.cbl
  2681 1250-TEST-ACCUM.                                                 ECS046
  2682     IF EP-RECORD-ID = 'EP'                                       ECS046
  2683         IF EP-PURGE = ('1' OR 'P')                               ECS046
  2684             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                    ECS046
  2685                 MOVE +1         TO SA                            ECS046
  2686                 PERFORM 1300-EP-ADD THRU 1350-EXIT               ECS046
  2687             ELSE                                                 ECS046
  2688                 MOVE +2         TO SA                            ECS046
  2689                 PERFORM 1300-EP-ADD THRU 1350-EXIT.              ECS046
  2690                                                                  ECS046
  2691     IF EP-RECORD-ID = 'EP'                                       ECS046
  2692         IF EP-PURGE = ('2' OR 'P' OR 'Q')                        ECS046
  2693             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                    ECS046
  2694                 MOVE +3         TO SA                            ECS046
  2695                 PERFORM 1300-EP-ADD THRU 1350-EXIT               ECS046
  2696             ELSE                                                 ECS046
  2697                 MOVE +4         TO SA                            ECS046
  2698                 PERFORM 1300-EP-ADD THRU 1350-EXIT.              ECS046
  2699                                                                  ECS046
  2700     IF EP-RECORD-ID = 'EC'                                       ECS046
  2701         IF EP-PURGE = ('1' OR 'P')                               ECS046
  2702             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                    ECS046
  2703                 MOVE +1         TO SA                            ECS046
  2704                 PERFORM 1400-EC-ADD THRU 1440-EXIT               ECS046
  2705             ELSE                                                 ECS046
  2706                 MOVE +2         TO SA                            ECS046
  2707                 PERFORM 1400-EC-ADD THRU 1440-EXIT.              ECS046
  2708                                                                  ECS046
  2709     IF EP-RECORD-ID = 'EC'                                       ECS046
  2710         IF EP-PURGE = ('2' OR 'P' OR 'Q')                        ECS046
  2711             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                    ECS046
  2712                 MOVE +3         TO SA                            ECS046
  2713                 PERFORM 1400-EC-ADD THRU 1440-EXIT               ECS046
  2714             ELSE                                                 ECS046
  2715                 MOVE +4         TO SA                            ECS046
  2716                 PERFORM 1400-EC-ADD THRU 1440-EXIT.              ECS046
  2717                                                                  ECS046
  2718     GO TO 1500-GET-NEXT-EXTRACT.                                 ECS046
  2719                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ECS046.cbl
  2721 1300-EP-ADD.                                                     ECS046
  2722                                                                  ECS046
  2723* TOTALS FOR EARNED PREMIUM RECORDS ARE ACCUMULATED IN A          ECS046
  2724* TOTAL TABLE FOR THE GIVEN ACCOUNT                               ECS046
  2725                                                                  ECS046
  2726     ADD EP-ISS-PRM              TO DA-NET-PREM (SA).             ECS046
  2727     SUBTRACT EP-CNC-PRM         FROM DA-NET-PREM (SA).           ECS046
  2728     ADD EP-CLM-AMT              TO DA-CLAIM-AMT (SA).            ECS046
  2729     ADD EP-CLM-DU               TO DA-LOSS-RSRV (SA).            ECS046
  2730     ADD EP-CLM-IBNR             TO DA-LOSS-RSRV (SA).            ECS046
  2731     ADD EP-LOSS-RESV            TO DA-LOSS-RSRV (SA).            ECS046
  2732     ADD EP-CLAIM-ADJ            TO DA-CLAIM-AMT (SA).            ECS046
  2733     MOVE ZERO                   TO WS-DA-EARN-PREM.              ECS046
  2734                                                                  ECS046
  2735     IF WS-EP-CODE = 'P'                                          ECS046
  2736         MOVE EP-PRM-PR          TO WS-DA-EARN-PREM               ECS046
  2737     ELSE                                                         ECS046
  2738     IF WS-EP-CODE = 'M'                                          ECS046
  2739         COMPUTE WS-DA-EARN-PREM ROUNDED =                        ECS046
  2740                (EP-PRM-PR + EP-PRM-78) * .5                      ECS046
  2741     ELSE                                                         ECS046
  2742     IF WS-EP-CODE = '1'                                          ECS046
  2743         COMPUTE WS-DA-EARN-PREM ROUNDED =                        ECS046
  2744              (EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333)         ECS046
  2745     ELSE                                                         ECS046
  2746     IF WS-EP-CODE = '2'                                          ECS046
  2747         COMPUTE WS-DA-EARN-PREM ROUNDED =                        ECS046
  2748              (EP-PRM-PR * +.80) + (EP-PRM-78 * +.20)             ECS046
  2749     ELSE                                                         ECS046
  2750         MOVE EP-PRM-78          TO WS-DA-EARN-PREM.              ECS046
  2751                                                                  ECS046
  2752     COMPUTE DA-EARN-PREM (SA) ROUNDED = DA-EARN-PREM (SA) +      ECS046
  2753                                         WS-DA-EARN-PREM.         ECS046
  2754                                                                  ECS046
  2755     COMPUTE DA-RETENTION (SA) ROUNDED = DA-RETENTION (SA) +      ECS046
  2756                       (WS-RETENTION-PCT * WS-DA-EARN-PREM).      ECS046
  2757                                                                  ECS046
  2758     COMPUTE DA-PREM-TAX (SA) ROUNDED = DA-PREM-TAX (SA) +        ECS046
  2759                          (WS-TAX-RATE * WS-DA-EARN-PREM).        ECS046
  2760                                                                  ECS046
  2761 1350-EXIT.                                                       ECS046
  2762      EXIT.                                                       ECS046
  2763                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ECS046.cbl
  2765 1400-EC-ADD.                                                     ECS046
  2766                                                                  ECS046
  2767* TOTALS FOR EARNED COMMISSION RECORDS ARE ACCUMULATED IN A       ECS046
  2768* TOTAL TABLE FOR THE GIVEN ACCOUNT                               ECS046
  2769                                                                  ECS046
  2770     PERFORM 1420-ACCT-EC-ADD THRU 1430-EXIT                      ECS046
  2771         VARYING CL FROM 1 BY 1 UNTIL CL GREATER 5.               ECS046
  2772                                                                  ECS046
  2773     GO TO 1440-EXIT.                                             ECS046
  2774                                                                  ECS046
  2775 1420-ACCT-EC-ADD.                                                ECS046
  2776     IF EC-AGT-TYPE (CL) = 'C' OR 'D' OR 'O' OR 'P'               ECS046
  2777         NEXT SENTENCE                                            ECS046
  2778      ELSE                                                        ECS046
  2779          GO TO 1430-EXIT.                                        ECS046
  2780                                                                  ECS046
  2781     IF WS-EP-CODE = 'P'                                          ECS046
  2782         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2783                                             EC-COMM-PR (CL)      ECS046
  2784     ELSE                                                         ECS046
  2785     IF WS-EP-CODE = 'M'                                          ECS046
  2786         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2787                                             ((EC-COMM-PR (CL) +  ECS046
  2788                                           EC-COMM-78 (CL)) * .5) ECS046
  2789     ELSE                                                         ECS046
  2790     IF WS-EP-CODE = '1'                                          ECS046
  2791         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2792                                   ((EC-COMM-PR (CL) * +.6667) +  ECS046
  2793                                    (EC-COMM-78 (CL) * +.3333))   ECS046
  2794     ELSE                                                         ECS046
  2795     IF WS-EP-CODE = '2'                                          ECS046
  2796         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2797                                     ((EC-COMM-PR (CL) * +.80) +  ECS046
  2798                                      (EC-COMM-78 (CL) * +.20))   ECS046
  2799     ELSE                                                         ECS046
  2800         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2801                                             EC-COMM-78 (CL).     ECS046
  2802                                                                  ECS046
  2803 1430-EXIT.                                                       ECS046
  2804      EXIT.                                                       ECS046
  2805                                                                  ECS046
  2806 1440-EXIT.                                                       ECS046
  2807      EXIT.                                                       ECS046
  2808                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ECS046.cbl
  2810 1500-GET-NEXT-EXTRACT.                                           ECS046
  2811     PERFORM 2100-READ-EXTRACT THRU 2140-EXIT.                    ECS046
  2812                                                                  ECS046
  2813     IF EP-CONTROL = WS-SAVE-CONTROL                              ECS046
  2814         GO TO 1200-CHECK-CONTROL.                                ECS046
  2815                                                                  ECS046
  2816* CONTROL BREAKS OCCUR AT THE ACCOUNT LEVEL, FOR TOT-OPT 1 AND 2  ECS046
  2817* ALLOW DATE RANGE LEVEL BREAK ( TOT-OPT 3 THRU 6)                ECS046
  2818                                                                  ECS046
  2819     IF DTE-TOT-OPT = 1  OR  2                                    ECS046
  2820         IF EP-CNTRL-1 = WS-SAVE-CNTRL-1                          ECS046
  2821             MOVE EP-CONTROL         TO WS-SAVE-CONTROL           ECS046
  2822             GO TO 1200-CHECK-CONTROL.                            ECS046
  2823                                                                  ECS046
  2824     MOVE AM-ACCOUNT             TO SWA-ACCT.                     ECS046
  2825     MOVE AM-NAME                TO SWA-NAME.                     ECS046
  2826     MOVE AM-CITY                TO SWA-CITY.                     ECS046
  2827                                                                  ECS046
  2828* DEPENDING ON THE TOTAL OPTION, SORT CONTROL FIELDS ARE PRIMED   ECS046
  2829                                                                  ECS046
  2830     IF DTE-TOT-OPT = 1                                           ECS046
  2831         MOVE SPACES             TO SWA-BUS-TYPE                  ECS046
  2832         MOVE AM-CARRIER         TO SWA-CARR                      ECS046
  2833         MOVE AM-GROUPING        TO SWA-GROUP                     ECS046
  2834         MOVE AM-STATE           TO SWA-STATE                     ECS046
  2835         MOVE SPACES             TO SWA-GA-OR-RPT-CD.             ECS046
  2836                                                                  ECS046
  2837     IF DTE-TOT-OPT = 2                                           ECS046
  2838         MOVE AM-GPCD            TO SWA-BUS-TYPE                  ECS046
  2839         MOVE AM-CARRIER         TO SWA-CARR                      ECS046
  2840         MOVE AM-GROUPING        TO SWA-GROUP                     ECS046
  2841         MOVE AM-STATE           TO SWA-STATE                     ECS046
  2842         MOVE SPACES             TO SWA-GA-OR-RPT-CD.             ECS046
  2843                                                                  ECS046
  2844* IF A GIVEN ACCOUNT DOESN'T HAVE ALTERNATE REPORT CODES,         ECS046
  2845* THAT ACCOUNT DOESN'T APPEAR ON THE REPORT FOR TOTAL OPTIONS     ECS046
  2846* 3 AND 4.                                                        ECS046
  2847                                                                  ECS046
  2848     IF DTE-TOT-OPT = 3                                           ECS046
  2849         IF AM-REPORT-CODE-1 = SPACES OR LOW-VALUES               ECS046
  2850             GO TO 1600-PERFORM-ZERO-ACCUM                        ECS046
  2851         ELSE                                                     ECS046
  2852             MOVE SPACES           TO SWA-BUS-TYPE                ECS046
  2853                                      SWA-CARR                    ECS046
  2854                                      SWA-GROUP                   ECS046
  2855                                      SWA-STATE                   ECS046
  2856             MOVE AM-REPORT-CODE-1 TO SWA-GA-OR-RPT-CD.           ECS046
  2857                                                                  ECS046
  2858     IF DTE-TOT-OPT = 4                                           ECS046
  2859         IF AM-REPORT-CODE-2 = SPACES OR LOW-VALUES               ECS046
  2860             GO TO 1600-PERFORM-ZERO-ACCUM                        ECS046
  2861         ELSE                                                     ECS046
  2862             MOVE SPACES           TO SWA-BUS-TYPE                ECS046
  2863             MOVE AM-CARRIER       TO SWA-CARR                    ECS046
  2864             MOVE AM-GROUPING      TO SWA-GROUP                   ECS046
  2865             MOVE SPACES           TO SWA-STATE                   ECS046
  2866             MOVE AM-REPORT-CODE-2 TO SWA-GA-OR-RPT-CD.           ECS046
  2867                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ECS046.cbl
  2868     IF DTE-TOT-OPT = 6                                           ECS046
  2869         IF AM-REPORT-CODE-1 = SPACES OR LOW-VALUES               ECS046
  2870             GO TO 1600-PERFORM-ZERO-ACCUM                        ECS046
  2871         ELSE                                                     ECS046
  2872             MOVE AM-REPORT-CODE-1 TO SWA-RPT-CD-1                ECS046
  2873             MOVE AM-REPORT-CODE-2 TO SWA-RPT-CD-2.               ECS046
  2874                                                                  ECS046
  2875* IF A GIVEN ACCOUNT DOESN'T HAVE A FINANCIAL RESPONSIBLE G-A,    ECS046
  2876* THAT ACCOUNT DOESN'T APPEAR ON THE REPORT FOR TOTAL OPTION 5.   ECS046
  2877                                                                  ECS046
  2878     IF DTE-TOT-OPT = 5                                           ECS046
  2879         IF WS-FIN-RESP-AGT = SPACES  OR  ZEROS                   ECS046
  2880             GO TO 1600-PERFORM-ZERO-ACCUM                        ECS046
  2881         ELSE                                                     ECS046
  2882             MOVE SPACES           TO SWA-BUS-TYPE                ECS046
  2883             MOVE AM-CARRIER       TO SWA-CARR                    ECS046
  2884             MOVE AM-GROUPING      TO SWA-SAVE-GROUP              ECS046
  2885             MOVE SPACES           TO SWA-GROUP                   ECS046
  2886                                      SWA-STATE                   ECS046
  2887             MOVE WS-FIN-RESP-AGT  TO SWA-GA-OR-RPT-CD.           ECS046
  2888                                                                  ECS046
  2889     COMPUTE SWA-NET-PREM (1) = DA-NET-PREM (3) - DA-NET-PREM (1).ECS046
  2890     COMPUTE SWA-EARN-PREM (1) =                                  ECS046
  2891                             DA-EARN-PREM (3) - DA-EARN-PREM (1). ECS046
  2892     COMPUTE SWA-CLMS-INCUR (1) =                                 ECS046
  2893                          (DA-CLAIM-AMT (3) - DA-CLAIM-AMT (1)) + ECS046
  2894                          (DA-LOSS-RSRV (3) - DA-LOSS-RSRV (1)).  ECS046
  2895     COMPUTE SWA-EARN-COMP (1) =                                  ECS046
  2896                             DA-EARN-COMP (3) - DA-EARN-COMP (1). ECS046
  2897     COMPUTE SWA-RETENTION (1) =                                  ECS046
  2898                             DA-RETENTION (3) - DA-RETENTION (1). ECS046
  2899     COMPUTE SWA-PREM-TAX (1) = DA-PREM-TAX (3) - DA-PREM-TAX (1).ECS046
  2900                                                                  ECS046
  2901     COMPUTE SWA-NET-PREM (2) = DA-NET-PREM (4) - DA-NET-PREM (2).ECS046
  2902     COMPUTE SWA-EARN-PREM (2) =                                  ECS046
  2903                             DA-EARN-PREM (4) - DA-EARN-PREM (2). ECS046
  2904     COMPUTE SWA-CLMS-INCUR (2) =                                 ECS046
  2905                          (DA-CLAIM-AMT (4) - DA-CLAIM-AMT (2)) + ECS046
  2906                          (DA-LOSS-RSRV (4) - DA-LOSS-RSRV (2)).  ECS046
  2907     COMPUTE SWA-EARN-COMP (2) =                                  ECS046
  2908                             DA-EARN-COMP (4) - DA-EARN-COMP (2). ECS046
  2909     COMPUTE SWA-RETENTION (2) =                                  ECS046
  2910                             DA-RETENTION (4) - DA-RETENTION (2). ECS046
  2911     COMPUTE SWA-PREM-TAX (2) = DA-PREM-TAX (4) - DA-PREM-TAX (2).ECS046
  2912                                                                  ECS046
  2913     RELEASE SWA-REC-OUT FROM SWA-REC.                            ECS046
  2914                                                                  ECS046
  2915     ADD +1 TO NO-OF-RECORDS-RELEASED.                            ECS046
  2916                                                                  ECS046
  2917 1600-PERFORM-ZERO-ACCUM.                                         ECS046
  2918     PERFORM 2400-ZERO-DETAIL-ACCUMULATORS                        ECS046
  2919         VARYING SA FROM 1 BY 1 UNTIL SA GREATER 4.               ECS046
  2920                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ECS046.cbl
  2922 1700-PROCESS-NEXT-EPEC.                                          ECS046
  2923     IF EP-CONTROL = HIGH-VALUES                                  ECS046
  2924         GO TO 1990-EXIT.                                         ECS046
  2925                                                                  ECS046
  2926     MOVE EP-CONTROL             TO WS-SAVE-CONTROL.              ECS046
  2927                                                                  ECS046
  2928 1800-CHECK-ACCT-MSTR.                                            ECS046
  2929     IF WS-ACCT-CONTROL LESS WS-SAVE-CONTROL                      ECS046
  2930         PERFORM 2200-READ-ACCT THRU 2240-EXIT                    ECS046
  2931         GO TO 1800-CHECK-ACCT-MSTR.                              ECS046
  2932                                                                  ECS046
  2933 1820-NO-ACCT-MSTR.                                               ECS046
  2934     IF WS-ACCT-CONTROL GREATER WS-SAVE-CONTROL                   ECS046
  2935         PERFORM 2300-NO-ACCT-MSG                                 ECS046
  2936         PERFORM 2100-READ-EXTRACT THRU 2140-EXIT                 ECS046
  2937           GO TO 1700-PROCESS-NEXT-EPEC.                          ECS046
  2938                                                                  ECS046
  2939 1840-ACCT-MSTR-MATCHED.                                          ECS046
  2940                                                                  ECS046
  2941     IF DTE-CLIENT  =  'MON'                                      ECS046
  2942         IF WS-ACTIVE-INDIC  =  'ACTIVE'                          ECS046
  2943             IF AM-STATUS  =  '1'                                 ECS046
  2944                 PERFORM 2100-READ-EXTRACT THRU 2140-EXIT         ECS046
  2945                 GO TO 1700-PROCESS-NEXT-EPEC.                    ECS046
  2946                                                                  ECS046
  2947     IF DTE-CLIENT = 'CSO'                                        ECS046
  2948         IF AM-STATUS NOT = 'A'  AND  '0'                         ECS046
  2949             PERFORM 2100-READ-EXTRACT THRU 2140-EXIT             ECS046
  2950             GO TO 1700-PROCESS-NEXT-EPEC.                        ECS046
  2951                                                                  ECS046
  2952 1950-SAVE-ACCT-DATA.                                             ECS046
  2953                                                                  ECS046
  2954     MOVE SPACES                 TO WS-FIN-RESP-AGT.              ECS046
  2955                                                                  ECS046
  2956* RETENTION AND TAX PERCENTS ARE FOUND IN THE ACCOUNT MASTER      ECS046
  2957                                                                  ECS046
  2958     IF AM-LF-RET NOT NUMERIC                                     ECS046
  2959         MOVE ZERO               TO AM-LF-RET.                    ECS046
  2960                                                                  ECS046
  2961     IF AM-AH-RET NOT NUMERIC                                     ECS046
  2962         MOVE ZERO               TO AM-AH-RET.                    ECS046
  2963                                                                  ECS046
  2964     IF AM-REI-LF-TAX NOT NUMERIC                                 ECS046
  2965         MOVE ZERO               TO AM-REI-LF-TAX.                ECS046
  2966                                                                  ECS046
  2967     IF AM-REI-AH-TAX NOT NUMERIC                                 ECS046
  2968         MOVE ZERO               TO AM-REI-AH-TAX.                ECS046
  2969                                                                  ECS046
  2970     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                            ECS046
  2971         MOVE AM-LF-RET          TO WS-RETENTION-PCT              ECS046
  2972         MOVE AM-REI-LF-TAX      TO WS-TAX-RATE                   ECS046
  2973     ELSE                                                         ECS046
  2974         MOVE AM-AH-RET          TO WS-RETENTION-PCT              ECS046
  2975         MOVE AM-REI-AH-TAX      TO WS-TAX-RATE.                  ECS046
  2976                                                                  ECS046
  2977     MOVE +0                     TO CL.                           ECS046
  2978                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ECS046.cbl
  2980 1970-PROCESS-COMM-STRUCT.                                        ECS046
  2981                                                                  ECS046
  2982* THIS ROUTINE LOCATES G-A'S IN THE COMMISSION STRUCTURE OF THE   ECS046
  2983* ACCOUNT MASTER AND SUBTRACTS THE G-A'S COMMISSION PERCENT FROM  ECS046
  2984* THE ACCOUNT RETENTION, IF NECESSARY.  THIS ROUTINE ALSO LOCATES ECS046
  2985* THE FINANCIALLY RESPONSIBLE G-A FOR THIS ACCOUNT (THE FIRST     ECS046
  2986* G-A IN THE COMMISSION STRUCTURE).  THE FINANCIALLY RESPONSIBLE  ECS046
  2987* G-A IS USED FOR TOTAL OPTION 5.                                 ECS046
  2988                                                                  ECS046
  2989     IF DTE-CLIENT  =  'MON'                                      ECS046
  2990         NEXT SENTENCE                                            ECS046
  2991     ELSE                                                         ECS046
  2992         GO TO 1975-BYPASS-MON-CODE.                              ECS046
  2993                                                                  ECS046
  2994     MOVE +9                     TO  CL.                          ECS046
  2995                                                                  ECS046
  2996     IF AM-RETRO-LV-INDIC (CL)  =  'Y'                            ECS046
  2997         IF AM-J-COM (CL)  NOT NUMERIC                            ECS046
  2998             MOVE ZERO           TO  AM-J-COM (CL).               ECS046
  2999                                                                  ECS046
  3000     IF AM-L-COM (CL)  NOT NUMERIC                                ECS046
  3001         MOVE ZERO               TO  AM-L-COM (CL).               ECS046
  3002                                                                  ECS046
  3003     IF AM-A-COM (CL)  NOT NUMERIC                                ECS046
  3004         MOVE ZERO               TO  AM-A-COM (CL).               ECS046
  3005                                                                  ECS046
  3006     IF EP-RCD-TYPE  =  LIFE-OVERRIDE-L1                          ECS046
  3007         IF CLAS-I-JOINT (CLAS-INDEXL)  =  'J'                    ECS046
  3008             SUBTRACT AM-J-COM (CL)  FROM  WS-RETENTION-PCT       ECS046
  3009         ELSE                                                     ECS046
  3010             SUBTRACT AM-L-COM (CL)  FROM  WS-RETENTION-PCT       ECS046
  3011     ELSE                                                         ECS046
  3012         SUBTRACT AM-A-COM (CL)  FROM  WS-RETENTION-PCT.          ECS046
  3013                                                                  ECS046
  3014     IF AM-RET-Y-N  =  'N'  OR  ' '                               ECS046
  3015         MOVE ZEROS              TO  WS-RETENTION-PCT.            ECS046
  3016                                                                  ECS046
  3017     ADD +.06                    TO  WS-TAX-RATE.                 ECS046
  3018                                                                  ECS046
  3019     GO TO 1980-EXIT.                                             ECS046
  3020                                                                  ECS046
  3021 1975-BYPASS-MON-CODE.                                            ECS046
  3022     ADD +1 TO CL.                                                ECS046
  3023                                                                  ECS046
  3024     IF CL GREATER +10                                            ECS046
  3025         GO TO 1980-EXIT.                                         ECS046
  3026                                                                  ECS046
  3027     IF AM-COM-TYP (CL) = 'O' OR 'P'                              ECS046
  3028         NEXT SENTENCE                                            ECS046
  3029     ELSE                                                         ECS046
  3030         GO TO 1970-PROCESS-COMM-STRUCT.                          ECS046
  3031                                                                  ECS046
  3032     IF AM-J-COM (CL) NOT NUMERIC                                 ECS046
  3033         MOVE ZERO               TO AM-J-COM (CL).                ECS046
  3034                                                                  ECS046
  3035     IF AM-L-COM (CL) NOT NUMERIC                                 ECS046
  3036         MOVE ZERO               TO AM-L-COM (CL).                ECS046
  3037                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ECS046.cbl
  3038     IF AM-A-COM (CL) NOT NUMERIC                                 ECS046
  3039         MOVE ZERO               TO AM-A-COM (CL).                ECS046
  3040                                                                  ECS046
  3041     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                            ECS046
  3042         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECS046
  3043             SUBTRACT AM-J-COM (CL) FROM WS-RETENTION-PCT         ECS046
  3044         ELSE                                                     ECS046
  3045             SUBTRACT AM-L-COM (CL) FROM WS-RETENTION-PCT         ECS046
  3046     ELSE                                                         ECS046
  3047         SUBTRACT AM-A-COM (CL) FROM WS-RETENTION-PCT.            ECS046
  3048                                                                  ECS046
  3049     GO TO 1970-PROCESS-COMM-STRUCT.                              ECS046
  3050                                                                  ECS046
  3051 1980-EXIT.                                                       ECS046
  3052     MOVE SPACES                 TO WS-FIN-RESP-AGT.              ECS046
  3053                                                                  ECS046
  3054     IF DTE-CLIENT = 'MON'                                        ECS046
  3055         MOVE AM-AGT (9)         TO WS-FIN-RESP-AGT               ECS046
  3056     ELSE                                                         ECS046
  3057         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P'                 ECS046
  3058             MOVE AM-AGT (AM-REMIT-TO)  TO WS-FIN-RESP-AGT.       ECS046
  3059                                                                  ECS046
  3060     IF WS-RETENTION-PCT LESS ZERO                                ECS046
  3061         MOVE ZERO               TO WS-RETENTION-PCT.             ECS046
  3062                                                                  ECS046
  3063     IF DTE-CLIENT = 'CSO'                                        ECS046
  3064         MOVE ZERO               TO WS-RETENTION-PCT.             ECS046
  3065                                                                  ECS046
  3066     GO TO 1200-CHECK-CONTROL.                                    ECS046
  3067                                                                  ECS046
  3068 1990-EXIT.                                                       ECS046
  3069     CLOSE ACC-MSTR                                               ECS046
  3070           EPEC-FILE.                                             ECS046
  3071                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ECS046.cbl
  3073 2000-PERFORMED-INPUT-ROUTINES SECTION.                           ECS046
  3074                                                                  ECS046
  3075 2100-READ-EXTRACT.                                               ECS046
  3076                                                                  ECS046
  3077     READ EPEC-FILE AT END                                        ECS046
  3078         MOVE HIGH-VALUES        TO EP-CONTROL                    ECS046
  3079         GO TO 2140-EXIT.                                         ECS046
  3080                                                                  ECS046
  3081     IF EP-RECORD-ID NOT = 'EP' AND 'EC'                          ECS046
  3082         GO TO 2100-READ-EXTRACT.                                 ECS046
  3083                                                                  ECS046
* 3084     COPY ELCEPCM1.                                               ECS046
  3085******************************************************************05/15/98
  3086*                                                                *ELCEPCM1
  3087*                                                                *ELCEPCM1
  3088*                            ELCEPCM1                            *   LV007
  3089*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3090*                            VMOD=2.001                          *ELCEPCM1
  3091*                                                                *ELCEPCM1
  3092*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEPCM1
  3093*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCM1
  3094*                                                                *ELCEPCM1
  3095******************************************************************ELCEPCM1
  3096                                                                     CL**7
  3097     MOVE EP-EXP-DTE         TO  WS-EP-EXP-DTE-N                     CL**7
  3098                                 WS-EC-EXP-DTE-N.                    CL**7
  3099     MOVE EP-EFF-DTE         TO  WS-EP-EFF-DTE-N                     CL**7
  3100                                 WS-EC-EFF-DTE-N.                    CL**7
  3101     MOVE EP-RUN-DTE         TO  WS-EP-RUN-DTE-N                     CL**7
  3102                                 WS-EC-RUN-DTE-N.                    CL**7
  3103                                                                     CL**7
  3104     IF VALID-EP-ID                                                  CL**7
  3105         MOVE EP-HI-COV-DT   TO  WS-EP-HI-COV-DT-N                   CL**7
  3106         MOVE EP-HI-CERT     TO  WS-EP-HI-CERT-N                     CL**7
  3107         MOVE EP-LO-CERT     TO  WS-EP-LO-CERT-N.                    CL**7
  3108                                                                     CL**7
  3109                                                                  ECS046
  3110* REINSURANCE RECORDS IN THE EPEC FILE ARE BYPASSED.              ECS046
  3111     IF EP-REIN = 'R'                                             ECS046
  3112         GO TO 2100-READ-EXTRACT.                                 ECS046
  3113                                                                  ECS046
  3114     IF WS-EP-RUN-DTE GREATER RUN-DT                              ECS046
  3115         GO TO 2100-READ-EXTRACT.                                 ECS046
  3116                                                                  ECS046
  3117     IF EP-PURGE = 'P'  OR                                        ECS046
  3118       (EP-RUN-YR = RD-YR AND EP-RUN-MO = RD-MO)  OR              ECS046
  3119       (EP-RUN-YR = BD-YR AND EP-RUN-MO = BD-MO)                  ECS046
  3120        NEXT SENTENCE                                             ECS046
  3121     ELSE                                                         ECS046
  3122         GO TO 2100-READ-EXTRACT.                                 ECS046
  3123                                                                  ECS046
  3124     IF EP-STATE EQUAL SAVE-STATE                                 ECS046
  3125        GO TO 2105-BENE-SEARCH.                                   ECS046
  3126                                                                  ECS046
  3127     MOVE SPACES                 TO SAVE-LF-BEN.                  ECS046
  3128     MOVE CLAS-STARTS            TO CLAS-INDEXS.                  ECS046
  3129                                                                  ECS046
  3130 2110-STATE-LOOK-UP.                                              ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ECS046.cbl
  3131                                                                  ECS046
  3132* THE GIVEN STATE THAT THE ACCOUNT IS LOCATED IN IS FOUND         ECS046
  3133* IN THE STATE TABLE IN THE DATE CARD WORKING STORAGE AREA        ECS046
  3134* TO DETERMINE IF THE STATE CODE IS FOR WYOMING.  THIS            ECS046
  3135* IS DONE BECAUSE ALL WYOMING ACCOUNTS MUST USE THE PRO-RATA      ECS046
  3136* METHOD FOR DETERMINING EARNED PREMIUM.                          ECS046
  3137                                                                  ECS046
  3138     IF EP-STATE = STATE-SUB (CLAS-INDEXS)                        ECS046
  3139        MOVE EP-STATE    TO SAVE-STATE                            ECS046
  3140     ELSE                                                         ECS046
  3141         ADD +1 TO CLAS-INDEXS                                    ECS046
  3142         IF CLAS-INDEXS NOT GREATER CLAS-MAXS                     ECS046
  3143             GO TO 2110-STATE-LOOK-UP                             ECS046
  3144         ELSE                                                     ECS046
  3145             DISPLAY ' INVALID STATE CODE -' AM-STATE             ECS046
  3146             MOVE    ' INVALID STATE CODE -' TO WS-ABEND-MESSAGE  ECS046
  3147             MOVE 0402           TO WS-RETURN-CODE                ECS046
  3148             GO TO ABEND-PGM.                                     ECS046
  3149                                                                  ECS046
  3150 2105-BENE-SEARCH.                                                ECS046
  3151                                                                  ECS046
  3152     IF EP-RCD-TYPE = AH-OVERRIDE-L1                              ECS046
  3153         GO TO 2120-EP-EARN-AH.                                   ECS046
  3154                                                                  ECS046
  3155     IF EP-BEN-CODE EQUAL SAVE-LF-BEN                             ECS046
  3156         MOVE SAVE-EP-CODE       TO WS-EP-CODE                    ECS046
  3157         GO TO 2140-EXIT.                                         ECS046
  3158                                                                  ECS046
  3159     MOVE CLAS-STARTL            TO CLAS-INDEXL.                  ECS046
  3160                                                                  ECS046
  3161 2110-FIND-BENE.                                                  ECS046
  3162                                                                  ECS046
  3163     IF CLAS-INDEXL GREATER CLAS-MAXL OR                          ECS046
  3164        CLAS-INDEXL = ZERO                                        ECS046
  3165         DISPLAY ' INVALID LIFE BENEFIT TYPE -' EP-BEN-CODE       ECS046
  3166         MOVE   ' INVALID LIFE BENEFIT TYPE -' TO WS-ABEND-MESSAGEECS046
  3167         MOVE 0401               TO WS-RETURN-CODE                ECS046
  3168         GO TO ABEND-PGM.                                         ECS046
  3169                                                                  ECS046
  3170     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)                ECS046
  3171         ADD +1 TO CLAS-INDEXL                                    ECS046
  3172         GO TO 2110-FIND-BENE.                                    ECS046
  3173                                                                  ECS046
  3174     MOVE EP-BEN-CODE             TO SAVE-LF-BEN.                 ECS046
  3175     MOVE CLAS-I-EP (CLAS-INDEXL) TO WS-EP-CODE                   ECS046
  3176                                     SAVE-EP-CODE.                ECS046
  3177                                                                  ECS046
  3178     IF STATE-ABBR (CLAS-INDEXS) = 'WY'                           ECS046
  3179         MOVE 'P'                 TO WS-EP-CODE                   ECS046
  3180                                     SAVE-EP-CODE.                ECS046
  3181                                                                  ECS046
  3182     IF DTE-CLIENT  =  'MON'                                      ECS046
  3183         IF WS-EP-CODE  NOT =  'P'                                ECS046
  3184             MOVE 'R'            TO  WS-EP-CODE.                  ECS046
  3185                                                                  ECS046
  3186     GO TO 2140-EXIT.                                             ECS046
  3187                                                                  ECS046
  3188 2120-EP-EARN-AH.                                                 ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ECS046.cbl
  3189                                                                  ECS046
  3190* THIS REPORT DEFAULTS TO THE MEAN EARNING METHOD FOR A & H.      ECS046
  3191                                                                  ECS046
  3192     MOVE SPACES                 TO  SAVE-LF-BEN.                 ECS046
  3193                                                                  ECS046
  3194     IF DTE-CLIENT  =  'MON'                                      ECS046
  3195         MOVE 'R'                TO  WS-EP-CODE                   ECS046
  3196     ELSE                                                         ECS046
  3197         MOVE 'M'                TO  WS-EP-CODE.                  ECS046
  3198                                                                  ECS046
  3199 2140-EXIT.                                                       ECS046
  3200     EXIT.                                                        ECS046
  3201                                                                  ECS046
  3202 2200-READ-ACCT.                                                  ECS046
  3203     READ ACC-MSTR AT END                                         ECS046
  3204             MOVE ZEROS          TO AM-MSTR-CNTRL                    CL**9
  3205                                    AM-EFFECT-DT.                 ECS046
  3206                                                                  ECS046
  3207     MOVE AM-MSTR-CNTRL          TO WS-MSTR-CNTRL.                ECS046
  3208     MOVE AM-EFFECT-DT           TO WS-EFFECT.                    ECS046
  3209                                                                  ECS046
  3210 2240-EXIT.                                                       ECS046
  3211      EXIT.                                                       ECS046
  3212                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ECS046.cbl
  3214 2300-NO-ACCT-MSG.                                                ECS046
  3215     IF DTE-CLIENT  =  'MON'                                      ECS046
  3216         IF WS-ACTIVE-INDIC  =  'ACTIVE'                          ECS046
  3217             MOVE HOLD-ACTIVE-DESC                                ECS046
  3218                                 TO  HD-STATUS-DESC               ECS046
  3219         ELSE                                                     ECS046
  3220             MOVE HOLD-ALL-DESC  TO  HD-STATUS-DESC               ECS046
  3221     ELSE                                                         ECS046
  3222         MOVE SPACES             TO  HD-STATUS-DESC.              ECS046
  3223                                                                  ECS046
  3224     IF LINE-CNT GREATER +55                                      ECS046
  3225         MOVE ZERO               TO LINE-CNT                      ECS046
  3226         MOVE '1'                TO X                             ECS046
  3227         MOVE HEAD-1             TO P-DATA                        ECS046
  3228         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3229         MOVE ' '                TO X                             ECS046
  3230         MOVE HEAD-2             TO P-DATA                        ECS046
  3231         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3232         MOVE ' '                TO X                             ECS046
  3233         MOVE HEAD-3             TO P-DATA                        ECS046
  3234         PERFORM 4600-PRINT-ROUTINE.                              ECS046
  3235                                                                  ECS046
  3236     MOVE WS-SAVE-CARR           TO DNA-CARR.                     ECS046
  3237     MOVE WS-SAVE-GROUP          TO DNA-GROUP.                    ECS046
  3238     MOVE WS-SAVE-STATE          TO DNA-ST.                       ECS046
  3239     MOVE WS-SAVE-ACCT           TO DNA-ACCT.                     ECS046
  3240     MOVE WS-SAVE-EXP-DATE       TO WS-SAVE-EXP-DATE-R.           ECS046
  3241     MOVE WS-SAVE-EXP-YR         TO DNA-TYR.                      ECS046
  3242     MOVE WS-SAVE-EXP-MO         TO DNA-TMO.                      ECS046
  3243     MOVE WS-SAVE-EXP-DA         TO DNA-TDA.                      ECS046
  3244     MOVE WS-SAVE-EFF-DATE       TO WS-SAVE-EFF-DATE-R.           ECS046
  3245     MOVE WS-SAVE-EFF-YR         TO DNA-FYR.                      ECS046
  3246     MOVE WS-SAVE-EFF-MO         TO DNA-FMO.                      ECS046
  3247     MOVE WS-SAVE-EFF-DA         TO DNA-FDA.                      ECS046
  3248     MOVE ' NO MATCHING ACCOUNT MASTER' TO DNA-MESSAGE.           ECS046
  3249     MOVE ' '                    TO X.                            ECS046
  3250     MOVE DTL-NO-ACCT            TO P-DATA.                       ECS046
  3251     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3252                                                                  ECS046
  3253 2400-ZERO-DETAIL-ACCUMULATORS.                                   ECS046
  3254     MOVE +0                     TO DA-NET-PREM  (SA)             ECS046
  3255                                    DA-EARN-PREM (SA)             ECS046
  3256                                    DA-CLAIM-AMT (SA)             ECS046
  3257                                    DA-LOSS-RSRV (SA)             ECS046
  3258                                    DA-EARN-COMP (SA)             ECS046
  3259                                    DA-RETENTION (SA)             ECS046
  3260                                    DA-PREM-TAX  (SA).            ECS046
  3261                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ECS046.cbl
  3263 3000-PRINT-REPORT-A   SECTION.                                   ECS046
  3264                                                                  ECS046
  3265     OPEN INPUT  COMP-FILE                                        ECS046
  3266          OUTPUT WORK-FILE.                                       ECS046
  3267                                                                  ECS046
  3268     IF NO-OF-RECORDS-RELEASED = +0                               ECS046
  3269         GO TO 3990-PRINT-RPT-A-EXIT.                             ECS046
  3270                                                                  ECS046
  3271     MOVE ZERO                   TO NO-OF-RECORDS-RELEASED.       ECS046
  3272                                                                  ECS046
  3273     MOVE +1                     TO SB.                           ECS046
  3274     PERFORM 4400-ZERO-BREAK-ACCUMULATORS                         ECS046
  3275         VARYING SE FROM 1 BY 1 UNTIL SE GREATER 6.               ECS046
  3276                                                                  ECS046
  3277     MOVE +2                     TO SB.                           ECS046
  3278     PERFORM 4400-ZERO-BREAK-ACCUMULATORS                         ECS046
  3279         VARYING SE FROM 1 BY 1 UNTIL SE GREATER 6.               ECS046
  3280                                                                  ECS046
  3281     PERFORM 3100-RETURN-SORT-WORK-A.                             ECS046
  3282                                                                  ECS046
  3283     MOVE SWA-REC-OUT            TO SWA-REC.                      ECS046
  3284     MOVE SWA-CONTROL            TO SAVE-SWA-CONTROL.             ECS046
  3285                                                                  ECS046
  3286     PERFORM 3500-GET-GA-NAME THRU 3500-EXIT.                     ECS046
  3287                                                                  ECS046
  3288     IF DTE-PGM-OPT = 1                                           ECS046
  3289         MOVE '- YEAR TO DATE'   TO HD-RPT-TYPE.                  ECS046
  3290                                                                  ECS046
  3291     IF DTE-PGM-OPT = 2                                           ECS046
  3292         MOVE '- LAST 12 MONTHS' TO HD-RPT-TYPE.                  ECS046
  3293                                                                  ECS046
  3294     IF DTE-PGM-OPT = 3                                           ECS046
  3295         MOVE '- INCEPTION TO DATE' TO HD-RPT-TYPE.               ECS046
  3296                                                                  ECS046
  3297     IF DTE-PGM-OPT = 4                                           ECS046
  3298         MOVE '- CURRENT MONTH'  TO HD-RPT-TYPE.                  ECS046
  3299                                                                  ECS046
  3300     IF DTE-TOT-OPT = 3                                           ECS046
  3301         MOVE CLAS-REPORT-CD1-CAPTION TO HD-RPT-CAPTION.          ECS046
  3302                                                                  ECS046
  3303     IF DTE-TOT-OPT = 4                                           ECS046
  3304         MOVE CLAS-REPORT-CD2-CAPTION TO HD-RPT-CAPTION.          ECS046
  3305                                                                  ECS046
  3306     MOVE 'A'                    TO H1-REPORT-SUF.                ECS046
  3307     PERFORM 4500-PRINT-HEADINGS THRU 4580-DTL-HDRS.              ECS046
  3308                                                                  ECS046
  3309                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ECS046.cbl
  3311 3100-RETURN-SORT-WORK-A.                                         ECS046
  3312     RETURN SORT-WORK-A                                           ECS046
  3313                AT END  MOVE HIGH-VALUES   TO SWA-CONTROL-OUT.    ECS046
  3314                                                                  ECS046
  3315 3150-CHECK-FOR-CTL-BREAK.                                        ECS046
  3316                                                                  ECS046
  3317     IF SWA-CONTROL-OUT = SWA-CONTROL                             ECS046
  3318       COMPUTE SWA-NET-PREM (1) = SWA-NET-PREM (1) + SW-NP (1)    ECS046
  3319       COMPUTE SWA-EARN-PREM (1) = SWA-EARN-PREM (1) + SW-EP (1)  ECS046
  3320       COMPUTE SWA-CLMS-INCUR (1) = SWA-CLMS-INCUR (1) + SW-CI (1)ECS046
  3321       COMPUTE SWA-EARN-COMP (1) = SWA-EARN-COMP (1) + SW-EC (1)  ECS046
  3322       COMPUTE SWA-RETENTION (1) = SWA-RETENTION (1) + SW-RT (1)  ECS046
  3323       COMPUTE SWA-PREM-TAX (1) = SWA-PREM-TAX (1) + SW-PT (1)    ECS046
  3324       COMPUTE SWA-NET-PREM (2) = SWA-NET-PREM (2) + SW-NP (2)    ECS046
  3325       COMPUTE SWA-EARN-PREM (2) = SWA-EARN-PREM (2) + SW-EP (2)  ECS046
  3326       COMPUTE SWA-CLMS-INCUR (2) = SWA-CLMS-INCUR (2) + SW-CI (2)ECS046
  3327       COMPUTE SWA-EARN-COMP (2) = SWA-EARN-COMP (2) + SW-EC (2)  ECS046
  3328       COMPUTE SWA-RETENTION (2) = SWA-RETENTION (2) + SW-RT (2)  ECS046
  3329       COMPUTE SWA-PREM-TAX (2) = SWA-PREM-TAX (2) + SW-PT (2)    ECS046
  3330           GO TO 3100-RETURN-SORT-WORK-A.                         ECS046
  3331                                                                  ECS046
  3332     IF SWA-CONTROL-1 NOT = SAVE-SWA-CONTROL-1                    ECS046
  3333         PERFORM 4200-SWA-CONTROL-BREAK                           ECS046
  3334         PERFORM 3500-GET-GA-NAME THRU 3500-EXIT.                 ECS046
  3335                                                                  ECS046
  3336     MOVE SWA-CONTROL            TO SAVE-SWA-CONTROL.             ECS046
  3337                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ECS046.cbl
  3339 3200-BUILD-DTL-LINE-A.                                           ECS046
  3340     IF WS-BREAK-SW = 'Y'                                         ECS046
  3341         MOVE ZERO               TO LINE-CNT                      ECS046
  3342         MOVE 'N'                TO WS-BREAK-SW                   ECS046
  3343         PERFORM 4510-BUS-TYPE-HDR THRU 4580-DTL-HDRS.            ECS046
  3344                                                                  ECS046
  3345     IF LINE-CNT GREATER +48                                      ECS046
  3346         MOVE ZERO               TO LINE-CNT                      ECS046
  3347         PERFORM 4500-PRINT-HEADINGS THRU 4580-DTL-HDRS.          ECS046
  3348                                                                  ECS046
  3349     MOVE ' '                    TO X.                            ECS046
  3350     MOVE ALL '-'                TO P-DATA.                       ECS046
  3351     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3352                                                                  ECS046
  3353     MOVE SWA-ACCT               TO HA-ACCOUNT.                   ECS046
  3354     MOVE SWA-NAME               TO HA-ACCT-NAME.                 ECS046
  3355     MOVE SWA-CITY               TO HA-ACCT-CITY.                 ECS046
  3356     MOVE ' '                    TO X.                            ECS046
  3357     MOVE HEAD-ACCT              TO P-DATA.                       ECS046
  3358     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3359                                                                  ECS046
  3360     MOVE LIFE-OVERRIDE-L2       TO DLA-BEN-DESC.                 ECS046
  3361                                                                  ECS046
  3362     COMPUTE  DLA-NET-PREM ROUNDED   = SWA-NET-PREM   (1).        ECS046
  3363     COMPUTE  DLA-EARN-PREM ROUNDED  = SWA-EARN-PREM  (1).        ECS046
  3364     COMPUTE  DLA-CLMS-INCUR ROUNDED = SWA-CLMS-INCUR (1).        ECS046
  3365     COMPUTE  DLA-EARN-COMP ROUNDED  = SWA-EARN-COMP  (1).        ECS046
  3366     COMPUTE WS-LF-SURPLUS ROUNDED   = SWA-EARN-PREM  (1) -       ECS046
  3367                  (SWA-CLMS-INCUR (1) + SWA-EARN-COMP (1)).       ECS046
  3368     COMPUTE  DLA-SURPLUS ROUNDED    = WS-LF-SURPLUS.             ECS046
  3369     COMPUTE  DLA-RETENTION ROUNDED  = SWA-RETENTION  (1).        ECS046
  3370                                                                  ECS046
  3371     IF SWA-RETENTION (1) = ZERO     OR                           ECS046
  3372        SWA-RETENTION (1) GREATER WS-LF-SURPLUS                   ECS046
  3373         MOVE WS-LF-SURPLUS      TO WS-LF-PREM-PROFIT             ECS046
  3374     ELSE                                                         ECS046
  3375         MOVE SWA-RETENTION (1)  TO WS-LF-PREM-PROFIT.            ECS046
  3376                                                                  ECS046
  3377     COMPUTE  DLA-PREM-PROFIT ROUNDED = WS-LF-PREM-PROFIT.        ECS046
  3378     COMPUTE  DLA-PREM-TAX ROUNDED    = SWA-PREM-TAX (1).         ECS046
  3379     COMPUTE WS-LF-UW-INCOME ROUNDED  =                           ECS046
  3380                WS-LF-PREM-PROFIT - SWA-PREM-TAX (1).             ECS046
  3381     COMPUTE  DLA-UW-INCOME ROUNDED   = WS-LF-UW-INCOME.          ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ECS046.cbl
  3383     IF SWA-EARN-PREM (1) = ZERO                                  ECS046
  3384         MOVE '*******'          TO DLA-LOSS-RATIO-RD             ECS046
  3385                                    DLA-TOT-CHARGES-RD            ECS046
  3386         MOVE ZERO               TO DLA-COMP-RATIO                ECS046
  3387     ELSE                                                         ECS046
  3388         COMPUTE WS-LOSS-RATIO ROUNDED   =                        ECS046
  3389                   (SWA-CLMS-INCUR (1) / SWA-EARN-PREM (1)) * +100ECS046
  3390         COMPUTE DLA-LOSS-RATIO ROUNDED  = WS-LOSS-RATIO          ECS046
  3391         COMPUTE WS-COMP-RATIO ROUNDED   =                        ECS046
  3392                    (SWA-EARN-COMP (1) / SWA-EARN-PREM (1)) * +100ECS046
  3393         COMPUTE DLA-COMP-RATIO ROUNDED  = WS-COMP-RATIO          ECS046
  3394         COMPUTE WS-TOT-CHARGES ROUNDED  =                        ECS046
  3395              (+1 - (WS-LF-UW-INCOME / SWA-EARN-PREM (1))) * +100 ECS046
  3396         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3397                                                                  ECS046
  3398     MOVE '0'                    TO X.                            ECS046
  3399     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3400     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3401     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3402                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ECS046.cbl
  3404     MOVE AH-OVERRIDE-L2         TO DLA-BEN-DESC.                 ECS046
  3405     COMPUTE  DLA-NET-PREM ROUNDED   = SWA-NET-PREM   (2).        ECS046
  3406     COMPUTE  DLA-EARN-PREM ROUNDED  = SWA-EARN-PREM  (2).        ECS046
  3407     COMPUTE  DLA-CLMS-INCUR ROUNDED = SWA-CLMS-INCUR (2).        ECS046
  3408     COMPUTE  DLA-EARN-COMP ROUNDED  = SWA-EARN-COMP  (2).        ECS046
  3409     COMPUTE WS-AH-SURPLUS ROUNDED   = SWA-EARN-PREM  (2) -       ECS046
  3410                  (SWA-CLMS-INCUR (2) + SWA-EARN-COMP (2)).       ECS046
  3411     COMPUTE  DLA-SURPLUS ROUNDED    = WS-AH-SURPLUS.             ECS046
  3412     COMPUTE  DLA-RETENTION ROUNDED  = SWA-RETENTION  (2).        ECS046
  3413                                                                  ECS046
  3414     IF SWA-RETENTION (2) = ZERO     OR                           ECS046
  3415        SWA-RETENTION (2) GREATER WS-AH-SURPLUS                   ECS046
  3416         MOVE WS-AH-SURPLUS      TO WS-AH-PREM-PROFIT             ECS046
  3417     ELSE                                                         ECS046
  3418         MOVE SWA-RETENTION (2)  TO WS-AH-PREM-PROFIT.            ECS046
  3419                                                                  ECS046
  3420     COMPUTE  DLA-PREM-PROFIT ROUNDED = WS-AH-PREM-PROFIT.        ECS046
  3421     COMPUTE  DLA-PREM-TAX ROUNDED    = SWA-PREM-TAX (2).         ECS046
  3422     COMPUTE WS-AH-UW-INCOME =                                    ECS046
  3423                WS-AH-PREM-PROFIT - SWA-PREM-TAX (2).             ECS046
  3424     COMPUTE  DLA-UW-INCOME ROUNDED   = WS-AH-UW-INCOME.          ECS046
  3425                                                                  ECS046
  3426     IF SWA-EARN-PREM (2) = ZERO                                  ECS046
  3427         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3428                                    DLA-COMP-RATIO                ECS046
  3429                                    DLA-TOT-CHARGES               ECS046
  3430     ELSE                                                         ECS046
  3431         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3432                   (SWA-CLMS-INCUR (2) / SWA-EARN-PREM (2)) * +100ECS046
  3433         COMPUTE DLA-LOSS-RATIO ROUNDED = WS-LOSS-RATIO           ECS046
  3434         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3435                    (SWA-EARN-COMP (2) / SWA-EARN-PREM (2)) * +100ECS046
  3436         COMPUTE DLA-COMP-RATIO ROUNDED = WS-COMP-RATIO           ECS046
  3437         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3438              (+1 - (WS-AH-UW-INCOME / SWA-EARN-PREM (2))) * +100 ECS046
  3439         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3440                                                                  ECS046
  3441     MOVE ' '                    TO X.                            ECS046
  3442     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3443     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3444     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3445                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ECS046.cbl
  3447     MOVE 'TOT'                  TO DLA-BEN-DESC.                 ECS046
  3448     COMPUTE DLA-NET-PREM ROUNDED =                               ECS046
  3449                SWA-NET-PREM (1) + SWA-NET-PREM (2).              ECS046
  3450     COMPUTE DLA-EARN-PREM ROUNDED =                              ECS046
  3451                SWA-EARN-PREM (1) + SWA-EARN-PREM (2).            ECS046
  3452     COMPUTE DLA-CLMS-INCUR ROUNDED =                             ECS046
  3453                SWA-CLMS-INCUR (1) + SWA-CLMS-INCUR (2).          ECS046
  3454     COMPUTE DLA-EARN-COMP ROUNDED =                              ECS046
  3455                SWA-EARN-COMP (1) + SWA-EARN-COMP (2).            ECS046
  3456     COMPUTE DLA-SURPLUS ROUNDED = WS-AH-SURPLUS + WS-LF-SURPLUS. ECS046
  3457     COMPUTE DLA-RETENTION ROUNDED =                              ECS046
  3458                SWA-RETENTION (1) + SWA-RETENTION (2).            ECS046
  3459     COMPUTE DLA-PREM-PROFIT ROUNDED =                            ECS046
  3460                WS-LF-PREM-PROFIT + WS-AH-PREM-PROFIT.            ECS046
  3461     COMPUTE DLA-PREM-TAX ROUNDED =                               ECS046
  3462                SWA-PREM-TAX (1) + SWA-PREM-TAX (2).              ECS046
  3463     COMPUTE DLA-UW-INCOME ROUNDED =                              ECS046
  3464                WS-LF-UW-INCOME + WS-AH-UW-INCOME.                ECS046
  3465                                                                  ECS046
  3466     IF SWA-EARN-PREM (1) = ZERO AND SWA-EARN-PREM (2) = ZERO     ECS046
  3467         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3468                                    DLA-COMP-RATIO                ECS046
  3469                                    DLA-TOT-CHARGES               ECS046
  3470     ELSE                                                         ECS046
  3471         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3472                ((SWA-CLMS-INCUR (1) + SWA-CLMS-INCUR (2)) /      ECS046
  3473                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3474         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3475                ((SWA-EARN-COMP (1) + SWA-EARN-COMP (2)) /        ECS046
  3476                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3477         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3478           (+1 - (WS-LF-UW-INCOME + WS-AH-UW-INCOME) /            ECS046
  3479                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3480         COMPUTE DLA-LOSS-RATIO ROUNDED  = WS-LOSS-RATIO          ECS046
  3481         COMPUTE DLA-COMP-RATIO ROUNDED  = WS-COMP-RATIO          ECS046
  3482         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3483                                                                  ECS046
  3484     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3485     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3486     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3487                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ECS046.cbl
  3489 3300-BUILD-SORT-WORK-B.                                          ECS046
  3490     IF DTE-FMT-OPT = 1                                           ECS046
  3491         GO TO 3400-ACCUMULATE-BREAK-TOTALS.                      ECS046
  3492                                                                  ECS046
  3493     IF SWA-EARN-PREM (1) = ZERO AND                              ECS046
  3494        SWA-EARN-PREM (2) = ZERO                                  ECS046
  3495         MOVE ZERO               TO SWB-LOSS-RATIO                ECS046
  3496                                    SWB-TOT-CHARGES               ECS046
  3497     ELSE                                                         ECS046
  3498         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3499                ((SWA-CLMS-INCUR (1) + SWA-CLMS-INCUR (2)) /      ECS046
  3500                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3501         COMPUTE SWB-LOSS-RATIO ROUNDED = WS-LOSS-RATIO           ECS046
  3502         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3503                 (+1 - (WS-LF-UW-INCOME + WS-AH-UW-INCOME) /      ECS046
  3504                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3505         COMPUTE SWB-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3506                                                                  ECS046
  3507     COMPUTE SWB-NET-PREM ROUNDED =                               ECS046
  3508                SWA-NET-PREM (1) + SWA-NET-PREM (2).              ECS046
  3509     COMPUTE SWB-PREM-PROFIT ROUNDED =                            ECS046
  3510                WS-LF-PREM-PROFIT + WS-AH-PREM-PROFIT.            ECS046
  3511                                                                  ECS046
  3512     IF DTE-FMT-OPT = 2                                           ECS046
  3513         MOVE SWB-LOSS-RATIO     TO SWB-SORT-AMT.                 ECS046
  3514                                                                  ECS046
  3515     IF DTE-FMT-OPT = 3                                           ECS046
  3516         MOVE SWB-TOT-CHARGES    TO SWB-SORT-AMT.                 ECS046
  3517                                                                  ECS046
  3518     IF DTE-FMT-OPT = 4                                           ECS046
  3519         MOVE SWB-NET-PREM       TO SWB-SORT-AMT.                 ECS046
  3520                                                                  ECS046
  3521     IF DTE-FMT-OPT = 5                                           ECS046
  3522         MOVE SWB-PREM-PROFIT    TO SWB-SORT-AMT.                 ECS046
  3523                                                                  ECS046
  3524     MOVE SWA-BUS-TYPE           TO SWB-BUS-TYPE.                 ECS046
  3525     MOVE SWA-CARR               TO SWB-CARR.                     ECS046
  3526     MOVE SWA-GROUP              TO SWB-GROUP.                    ECS046
  3527     MOVE SWA-STATE              TO SWB-STATE.                    ECS046
  3528     MOVE SWA-GA-OR-RPT-CD       TO SWB-GA-OR-RPT-CD.             ECS046
  3529     MOVE SWA-ACCT               TO SWB-ACCT.                     ECS046
  3530     MOVE SWA-NAME               TO SWB-NAME.                     ECS046
  3531                                                                  ECS046
  3532     WRITE WORK-REC    FROM SWB-REC.                              ECS046
  3533     ADD +1 TO NO-OF-RECORDS-RELEASED.                            ECS046
  3534                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ECS046.cbl
  3536 3400-ACCUMULATE-BREAK-TOTALS.                                    ECS046
  3537     PERFORM 4100-ACCUMULATE                                      ECS046
  3538         VARYING SC FROM 1 BY 1 UNTIL SC GREATER 6.               ECS046
  3539                                                                  ECS046
  3540     MOVE SWA-REC-OUT            TO SWA-REC.                      ECS046
  3541                                                                  ECS046
  3542     IF SWA-CONTROL = HIGH-VALUES                                 ECS046
  3543         PERFORM 4200-SWA-CONTROL-BREAK                           ECS046
  3544         GO TO 3990-PRINT-RPT-A-EXIT.                             ECS046
  3545                                                                  ECS046
  3546     GO TO 3100-RETURN-SORT-WORK-A.                               ECS046
  3547                                                                  ECS046
  3548 3500-GET-GA-NAME.                                                ECS046
  3549     MOVE SWA-CARR               TO  HOLD-CARRIER.                ECS046
  3550     MOVE SWA-SAVE-GROUP         TO  HOLD-GROUPING.               ECS046
  3551     MOVE SWA-GA-OR-RPT-CD       TO  HOLD-GA-NUMBER.              ECS046
  3552     MOVE LOW-VALUES             TO  HOLD-ACCT.                   ECS046
  3553     MOVE SWA-GA-OR-RPT-CD       TO  HOLD-ACCT.                   ECS046
  3554     MOVE 'G'                    TO  HOLD-RECORD-TYPE.            ECS046
  3555     MOVE HOLD-COMP-KEY          TO  CO-CONTROL-PRIMARY.          ECS046
  3556                                                                  ECS046
  3557     READ COMP-FILE.                                              ECS046
  3558                                                                  ECS046
  3559     IF ERCOMP-FILE-STATUS  =  '00'                               ECS046
  3560         NEXT SENTENCE                                            ECS046
  3561     ELSE                                                         ECS046
  3562         MOVE 'NOT FOUND'        TO  CO-MAIL-NAME  CO-ACCT-NAME.  ECS046
  3563                                                                  ECS046
  3564     IF DTE-CLIENT = 'MON'                                        ECS046
  3565         MOVE CO-MAIL-NAME       TO  HOLD-GA-NAME                 ECS046
  3566     ELSE                                                         ECS046
  3567         MOVE CO-ACCT-NAME       TO  HOLD-GA-NAME.                ECS046
  3568                                                                  ECS046
  3569 3500-EXIT.                                                       ECS046
  3570     EXIT.                                                        ECS046
  3571                                                                  ECS046
  3572 3990-PRINT-RPT-A-EXIT.                                           ECS046
  3573     CLOSE COMP-FILE  WORK-FILE.                                  ECS046
  3574                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ECS046.cbl
  3576 4000-PERFORMED-RPT-A-ROUTINES SECTION.                           ECS046
  3577                                                                  ECS046
  3578 4100-ACCUMULATE.                                                 ECS046
  3579     ADD SWA-NET-PREM   (1)      TO BA-NET-PREM    (1, SC).       ECS046
  3580     ADD SWA-EARN-PREM  (1)      TO BA-EARN-PREM   (1, SC).       ECS046
  3581     ADD SWA-CLMS-INCUR (1)      TO BA-CLMS-INCUR  (1, SC).       ECS046
  3582     ADD SWA-EARN-COMP  (1)      TO BA-EARN-COMP   (1, SC).       ECS046
  3583     ADD SWA-RETENTION  (1)      TO BA-RETENTION   (1, SC).       ECS046
  3584     ADD SWA-PREM-TAX   (1)      TO BA-PREM-TAX    (1, SC).       ECS046
  3585     ADD WS-LF-PREM-PROFIT       TO BA-PREM-PROFIT (1, SC)        ECS046
  3586     ADD SWA-NET-PREM   (2)      TO BA-NET-PREM    (2, SC).       ECS046
  3587     ADD SWA-EARN-PREM  (2)      TO BA-EARN-PREM   (2, SC).       ECS046
  3588     ADD SWA-CLMS-INCUR (2)      TO BA-CLMS-INCUR  (2, SC).       ECS046
  3589     ADD SWA-EARN-COMP  (2)      TO BA-EARN-COMP   (2, SC).       ECS046
  3590     ADD SWA-RETENTION  (2)      TO BA-RETENTION   (2, SC).       ECS046
  3591     ADD SWA-PREM-TAX   (2)      TO BA-PREM-TAX    (2, SC).       ECS046
  3592     ADD WS-AH-PREM-PROFIT       TO BA-PREM-PROFIT (2, SC).       ECS046
  3593                                                                  ECS046
  3594 4200-SWA-CONTROL-BREAK.                                          ECS046
  3595     MOVE ZERO                   TO LINE-CNT.                     ECS046
  3596     PERFORM 4500-PRINT-HEADINGS.                                 ECS046
  3597                                                                  ECS046
  3598     IF DTE-TOT-OPT = 1                                           ECS046
  3599         PERFORM 4210-STATE-BREAK                                 ECS046
  3600         PERFORM 4240-GROUP-BREAK                                 ECS046
  3601         PERFORM 4250-CARRIER-BREAK.                              ECS046
  3602                                                                  ECS046
  3603     IF DTE-TOT-OPT = 2                                           ECS046
  3604         PERFORM 4210-STATE-BREAK                                 ECS046
  3605         PERFORM 4240-GROUP-BREAK                                 ECS046
  3606         PERFORM 4250-CARRIER-BREAK                               ECS046
  3607         PERFORM 4260-BUS-TYPE-BREAK.                             ECS046
  3608                                                                  ECS046
  3609     IF DTE-TOT-OPT = 3                                           ECS046
  3610         PERFORM 4220-RPT-CODE-BREAK.                             ECS046
  3611                                                                  ECS046
  3612     IF DTE-TOT-OPT = 4                                           ECS046
  3613         PERFORM 4220-RPT-CODE-BREAK                              ECS046
  3614         PERFORM 4240-GROUP-BREAK                                 ECS046
  3615         PERFORM 4250-CARRIER-BREAK.                              ECS046
  3616                                                                  ECS046
  3617     IF DTE-TOT-OPT = 5                                           ECS046
  3618         PERFORM 4230-GNL-AGT-BREAK                               ECS046
  3619         PERFORM 4250-CARRIER-BREAK.                              ECS046
  3620                                                                  ECS046
  3621     IF DTE-TOT-OPT = 6                                           ECS046
  3622         PERFORM 4225-RPT2-CODE-BREAK.                            ECS046
  3623                                                                  ECS046
  3624     IF SWA-CONTROL = HIGH-VALUES                                 ECS046
  3625         MOVE 'F'              TO WS-BREAK-SW                     ECS046
  3626         PERFORM 4270-FINAL-TOT-BREAK.                            ECS046
  3627                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ECS046.cbl
  3629 4210-STATE-BREAK.                                                ECS046
  3630     IF SWA-STATE    = SAVE-SWA-STATE AND                         ECS046
  3631        SWA-GROUP    = SAVE-SWA-GROUP AND                         ECS046
  3632        SWA-CARR     = SAVE-SWA-CARR  AND                         ECS046
  3633        SWA-BUS-TYPE = SAVE-SWA-BUS-TYPE                          ECS046
  3634         NEXT SENTENCE                                            ECS046
  3635     ELSE                                                         ECS046
  3636         PERFORM 4510-BUS-TYPE-HDR THRU 4540-STATE-HDR            ECS046
  3637         MOVE '0'                TO X                             ECS046
  3638         MOVE 'STATE TOTALS'     TO P-DATA                        ECS046
  3639         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3640         PERFORM 4580-DTL-HDRS                                    ECS046
  3641         MOVE +1                 TO SC                            ECS046
  3642         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3643                                                                  ECS046
  3644 4220-RPT-CODE-BREAK.                                             ECS046
  3645     IF SWA-GA-OR-RPT-CD = SAVE-SWA-GA-OR-RPT-CD AND              ECS046
  3646        SWA-GROUP        = SAVE-SWA-GROUP        AND              ECS046
  3647        SWA-CARR         = SAVE-SWA-CARR                          ECS046
  3648         NEXT SENTENCE                                            ECS046
  3649     ELSE                                                         ECS046
  3650         PERFORM 4520-CARR-HDR THRU 4570-G-A-HDR                  ECS046
  3651         MOVE '0'                TO X                             ECS046
  3652         MOVE HD-BRK-TYPE        TO P-DATA                        ECS046
  3653         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3654         PERFORM 4580-DTL-HDRS                                    ECS046
  3655         MOVE +2                 TO SC                            ECS046
  3656         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3657                                                                  ECS046
  3658 4225-RPT2-CODE-BREAK.                                            ECS046
  3659     IF SWA-RPT-CD-1 = SAVE-SWA-RPT-CD-1 AND                      ECS046
  3660        SWA-RPT-CD-2 = SAVE-SWA-RPT-CD-2                          ECS046
  3661         NEXT SENTENCE                                            ECS046
  3662     ELSE                                                         ECS046
  3663         PERFORM 4575-RPT-CD1-2-HDR                               ECS046
  3664         MOVE '0'                TO X                             ECS046
  3665         MOVE HD-BRK-TYPE        TO P-DATA                        ECS046
  3666         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3667         PERFORM 4580-DTL-HDRS                                    ECS046
  3668         MOVE +2                 TO SC                            ECS046
  3669         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3670                                                                  ECS046
  3671 4230-GNL-AGT-BREAK.                                              ECS046
  3672     IF SWA-GA-OR-RPT-CD = SAVE-SWA-GA-OR-RPT-CD AND              ECS046
  3673        SWA-CARR         = SAVE-SWA-CARR                          ECS046
  3674         NEXT SENTENCE                                            ECS046
  3675     ELSE                                                         ECS046
  3676         PERFORM 4520-CARR-HDR                                    ECS046
  3677         PERFORM 4570-G-A-HDR                                     ECS046
  3678         MOVE '0'                TO X                             ECS046
  3679         MOVE 'GENERAL AGENT TOTALS' TO P-DATA                    ECS046
  3680         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3681         PERFORM 4580-DTL-HDRS                                    ECS046
  3682         MOVE +2                 TO SC                            ECS046
  3683         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3684                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ECS046.cbl
  3686 4240-GROUP-BREAK.                                                ECS046
  3687     IF SWA-GROUP    = SAVE-SWA-GROUP AND                         ECS046
  3688        SWA-CARR     = SAVE-SWA-CARR  AND                         ECS046
  3689        SWA-BUS-TYPE = SAVE-SWA-BUS-TYPE                          ECS046
  3690         NEXT SENTENCE                                            ECS046
  3691     ELSE                                                         ECS046
  3692         PERFORM 4510-BUS-TYPE-HDR THRU 4530-GROUP-HDR            ECS046
  3693         MOVE '0'                TO X                             ECS046
  3694         MOVE 'GROUP TOTALS'     TO P-DATA                        ECS046
  3695         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3696         PERFORM 4580-DTL-HDRS                                    ECS046
  3697         MOVE +3                 TO SC                            ECS046
  3698         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3699                                                                  ECS046
  3700 4250-CARRIER-BREAK.                                              ECS046
  3701     IF SWA-CARR     = SAVE-SWA-CARR AND                          ECS046
  3702        SWA-BUS-TYPE = SAVE-SWA-BUS-TYPE                          ECS046
  3703         NEXT SENTENCE                                            ECS046
  3704     ELSE                                                         ECS046
  3705         PERFORM 4510-BUS-TYPE-HDR THRU 4520-CARR-HDR             ECS046
  3706         MOVE '0'                TO X                             ECS046
  3707         MOVE 'CARRIER TOTALS'   TO P-DATA                        ECS046
  3708         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3709         PERFORM 4580-DTL-HDRS                                    ECS046
  3710         MOVE +4                 TO SC                            ECS046
  3711         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3712                                                                  ECS046
  3713 4260-BUS-TYPE-BREAK.                                             ECS046
  3714     IF SWA-BUS-TYPE = SAVE-SWA-BUS-TYPE                          ECS046
  3715         NEXT SENTENCE                                            ECS046
  3716     ELSE                                                         ECS046
  3717         PERFORM 4510-BUS-TYPE-HDR                                ECS046
  3718         MOVE '0'                TO X                             ECS046
  3719         MOVE 'BUSINESS TYPE TOTALS'   TO P-DATA                  ECS046
  3720         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3721         PERFORM 4580-DTL-HDRS                                    ECS046
  3722         MOVE +5                 TO SC                            ECS046
  3723         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3724                                                                  ECS046
  3725 4270-FINAL-TOT-BREAK.                                            ECS046
  3726     MOVE '0'                    TO X.                            ECS046
  3727     MOVE 'FINAL TOTALS'         TO P-DATA.                       ECS046
  3728     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3729     PERFORM 4580-DTL-HDRS.                                       ECS046
  3730     MOVE +6                     TO SC.                           ECS046
  3731     PERFORM 4280-PRINT-TOTAL-LINES.                              ECS046
  3732                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ECS046.cbl
  3734 4280-PRINT-TOTAL-LINES.                                          ECS046
  3735     MOVE LIFE-OVERRIDE-L2       TO DLA-BEN-DESC.                 ECS046
  3736     COMPUTE DLA-NET-PREM ROUNDED   = BA-NET-PREM (1, SC).        ECS046
  3737     COMPUTE DLA-EARN-PREM ROUNDED  = BA-EARN-PREM (1, SC).       ECS046
  3738     COMPUTE DLA-CLMS-INCUR ROUNDED = BA-CLMS-INCUR (1, SC).      ECS046
  3739     COMPUTE DLA-EARN-COMP ROUNDED  = BA-EARN-COMP (1, SC).       ECS046
  3740     COMPUTE WS-LF-SURPLUS = BA-EARN-PREM (1, SC) -               ECS046
  3741                  (BA-CLMS-INCUR (1, SC) + BA-EARN-COMP (1, SC)). ECS046
  3742     COMPUTE DLA-SURPLUS ROUNDED    = WS-LF-SURPLUS.              ECS046
  3743     COMPUTE DLA-RETENTION ROUNDED  = BA-RETENTION (1, SC).       ECS046
  3744     COMPUTE DLA-PREM-PROFIT ROUNDED = BA-PREM-PROFIT (1, SC).    ECS046
  3745     COMPUTE DLA-PREM-TAX ROUNDED    = BA-PREM-TAX (1, SC).       ECS046
  3746     COMPUTE WS-LF-UW-INCOME =                                    ECS046
  3747                BA-PREM-PROFIT (1, SC) - BA-PREM-TAX (1, SC).     ECS046
  3748     COMPUTE DLA-UW-INCOME ROUNDED = WS-LF-UW-INCOME.             ECS046
  3749                                                                  ECS046
  3750     IF BA-EARN-PREM (1, SC) = ZERO                               ECS046
  3751         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3752                                    DLA-COMP-RATIO                ECS046
  3753                                    DLA-TOT-CHARGES               ECS046
  3754     ELSE                                                         ECS046
  3755         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3756          (BA-CLMS-INCUR (1, SC) / BA-EARN-PREM (1, SC)) * +100   ECS046
  3757         COMPUTE DLA-LOSS-RATIO ROUNDED = WS-LOSS-RATIO           ECS046
  3758         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3759          (BA-EARN-COMP (1, SC) / BA-EARN-PREM (1, SC)) * +100    ECS046
  3760         COMPUTE DLA-COMP-RATIO ROUNDED = WS-COMP-RATIO           ECS046
  3761         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3762          (+1 - (WS-LF-UW-INCOME / BA-EARN-PREM (1, SC))) * +100  ECS046
  3763         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3764                                                                  ECS046
  3765     MOVE '0'                    TO X.                            ECS046
  3766     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3767     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3768     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3769                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ECS046.cbl
  3771     MOVE   AH-OVERRIDE-L2       TO DLA-BEN-DESC.                 ECS046
  3772     COMPUTE DLA-NET-PREM ROUNDED    = BA-NET-PREM   (2, SC).     ECS046
  3773     COMPUTE DLA-EARN-PREM ROUNDED   = BA-EARN-PREM  (2, SC).     ECS046
  3774     COMPUTE DLA-CLMS-INCUR ROUNDED  = BA-CLMS-INCUR (2, SC).     ECS046
  3775     COMPUTE DLA-EARN-COMP ROUNDED   = BA-EARN-COMP  (2, SC).     ECS046
  3776     COMPUTE WS-AH-SURPLUS = BA-EARN-PREM  (2, SC) -              ECS046
  3777                            (BA-CLMS-INCUR (2, SC) +              ECS046
  3778                             BA-EARN-COMP  (2, SC)).              ECS046
  3779     COMPUTE DLA-SURPLUS ROUNDED     = WS-AH-SURPLUS.             ECS046
  3780     COMPUTE DLA-RETENTION ROUNDED   = BA-RETENTION   (2, SC).    ECS046
  3781     COMPUTE DLA-PREM-PROFIT ROUNDED = BA-PREM-PROFIT (2, SC).    ECS046
  3782     COMPUTE DLA-PREM-TAX ROUNDED    = BA-PREM-TAX    (2, SC).    ECS046
  3783     COMPUTE WS-AH-UW-INCOME = BA-PREM-PROFIT (2, SC) -           ECS046
  3784                               BA-PREM-TAX    (2, SC).            ECS046
  3785     COMPUTE DLA-UW-INCOME ROUNDED   = WS-AH-UW-INCOME.           ECS046
  3786                                                                  ECS046
  3787     IF BA-EARN-PREM (2, SC) = ZERO                               ECS046
  3788         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3789                                    DLA-COMP-RATIO                ECS046
  3790                                    DLA-TOT-CHARGES               ECS046
  3791     ELSE                                                         ECS046
  3792         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3793          (BA-CLMS-INCUR (2, SC) / BA-EARN-PREM (2, SC)) * +100   ECS046
  3794         COMPUTE DLA-LOSS-RATIO ROUNDED = WS-LOSS-RATIO           ECS046
  3795         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3796          (BA-EARN-COMP (2, SC) / BA-EARN-PREM (2, SC)) * +100    ECS046
  3797         COMPUTE DLA-COMP-RATIO ROUNDED = WS-COMP-RATIO           ECS046
  3798         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3799          (+1 - (WS-AH-UW-INCOME / BA-EARN-PREM (2, SC))) * +100  ECS046
  3800         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3801                                                                  ECS046
  3802     MOVE ' '                    TO X.                            ECS046
  3803     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3804     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3805     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3806                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ECS046.cbl
  3808     MOVE 'TOT'                  TO DLA-BEN-DESC.                 ECS046
  3809     COMPUTE DLA-NET-PREM ROUNDED =                               ECS046
  3810                BA-NET-PREM (1, SC) + BA-NET-PREM (2, SC).        ECS046
  3811     COMPUTE DLA-EARN-PREM ROUNDED =                              ECS046
  3812                BA-EARN-PREM (1, SC) + BA-EARN-PREM (2, SC).      ECS046
  3813     COMPUTE DLA-CLMS-INCUR ROUNDED =                             ECS046
  3814                BA-CLMS-INCUR (1, SC) + BA-CLMS-INCUR (2, SC).    ECS046
  3815     COMPUTE DLA-EARN-COMP ROUNDED =                              ECS046
  3816                BA-EARN-COMP (1, SC) + BA-EARN-COMP (2, SC).      ECS046
  3817     COMPUTE DLA-SURPLUS ROUNDED = WS-AH-SURPLUS + WS-LF-SURPLUS. ECS046
  3818     COMPUTE DLA-RETENTION ROUNDED =                              ECS046
  3819                BA-RETENTION (1, SC) + BA-RETENTION (2, SC).      ECS046
  3820     COMPUTE DLA-PREM-PROFIT ROUNDED =                            ECS046
  3821                BA-PREM-PROFIT (1, SC) + BA-PREM-PROFIT (2, SC).  ECS046
  3822     COMPUTE DLA-PREM-TAX ROUNDED =                               ECS046
  3823                BA-PREM-TAX (1, SC) + BA-PREM-TAX (2, SC).        ECS046
  3824     COMPUTE DLA-UW-INCOME ROUNDED =                              ECS046
  3825                WS-LF-UW-INCOME + WS-AH-UW-INCOME.                ECS046
  3826                                                                  ECS046
  3827     IF BA-EARN-PREM (1, SC) = ZERO     AND                       ECS046
  3828        BA-EARN-PREM (2, SC) = ZERO                               ECS046
  3829         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3830                                    DLA-COMP-RATIO                ECS046
  3831                                    DLA-TOT-CHARGES               ECS046
  3832     ELSE                                                         ECS046
  3833         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3834          ((BA-CLMS-INCUR (1, SC) + BA-CLMS-INCUR (2, SC)) /      ECS046
  3835           (BA-EARN-PREM (1, SC) + BA-EARN-PREM (2, SC))) * +100  ECS046
  3836         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3837          ((BA-EARN-COMP (1, SC) + BA-EARN-COMP (2, SC)) /        ECS046
  3838           (BA-EARN-PREM (1, SC) + BA-EARN-PREM (2, SC))) * +100  ECS046
  3839         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3840           (+1 - (WS-LF-UW-INCOME + WS-AH-UW-INCOME) /            ECS046
  3841           (BA-EARN-PREM (1, SC) + BA-EARN-PREM (2, SC))) * +100  ECS046
  3842         COMPUTE DLA-LOSS-RATIO ROUNDED  = WS-LOSS-RATIO          ECS046
  3843         COMPUTE DLA-COMP-RATIO ROUNDED  = WS-COMP-RATIO          ECS046
  3844         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3845                                                                  ECS046
  3846     MOVE ' '                    TO X.                            ECS046
  3847     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3848     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3849     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3850                                                                  ECS046
  3851     MOVE +1                     TO SB.                           ECS046
  3852     PERFORM 4400-ZERO-BREAK-ACCUMULATORS                         ECS046
  3853         VARYING SE FROM 1 BY 1 UNTIL SE GREATER SC.              ECS046
  3854                                                                  ECS046
  3855     MOVE +2                     TO SB.                           ECS046
  3856     PERFORM 4400-ZERO-BREAK-ACCUMULATORS                         ECS046
  3857         VARYING SE FROM 1 BY 1 UNTIL SE GREATER SC.              ECS046
  3858                                                                  ECS046
  3859     MOVE ZERO                   TO LINE-CNT.                     ECS046
  3860                                                                  ECS046
  3861     IF WS-BREAK-SW NOT = 'F'                                     ECS046
  3862         PERFORM 4500-PRINT-HEADINGS.                             ECS046
  3863                                                                  ECS046
  3864     MOVE 'Y'                    TO WS-BREAK-SW.                  ECS046
  3865                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ECS046.cbl
  3867 4400-ZERO-BREAK-ACCUMULATORS.                                    ECS046
  3868     MOVE +0                     TO BA-NET-PREM      (SB, SE)     ECS046
  3869                                    BA-EARN-PREM     (SB, SE)     ECS046
  3870                                    BA-CLMS-INCUR    (SB, SE)     ECS046
  3871                                    BA-EARN-COMP     (SB, SE)     ECS046
  3872                                    BA-RETENTION     (SB, SE)     ECS046
  3873                                    BA-PREM-PROFIT   (SB, SE)     ECS046
  3874                                    BA-PREM-TAX      (SB, SE).    ECS046
  3875                                                                  ECS046
  3876 4500-PRINT-HEADINGS.                                             ECS046
  3877     IF DTE-CLIENT  =  'MON'                                      ECS046
  3878         IF WS-ACTIVE-INDIC  =  'ACTIVE'                          ECS046
  3879             MOVE HOLD-ACTIVE-DESC                                ECS046
  3880                                 TO  HD-STATUS-DESC               ECS046
  3881         ELSE                                                     ECS046
  3882             MOVE HOLD-ALL-DESC  TO  HD-STATUS-DESC               ECS046
  3883     ELSE                                                         ECS046
  3884         MOVE SPACES             TO  HD-STATUS-DESC.              ECS046
  3885                                                                  ECS046
  3886     MOVE '1'                    TO X.                            ECS046
  3887     MOVE HEAD-1                 TO P-DATA.                       ECS046
  3888     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3889     MOVE ' '                    TO X.                            ECS046
  3890     MOVE HEAD-2                 TO P-DATA.                       ECS046
  3891     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3892     ADD +1                      TO PAGE-CNT.                     ECS046
  3893     MOVE PAGE-CNT               TO HD-PAGE-NO.                   ECS046
  3894     MOVE HEAD-3                 TO P-DATA.                       ECS046
  3895     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3896                                                                  ECS046
  3897 4510-BUS-TYPE-HDR.                                               ECS046
  3898     IF DTE-TOT-OPT = 2                                           ECS046
  3899         MOVE SAVE-SWA-BUS-TYPE  TO HB-BUS-TYPE                   ECS046
  3900         PERFORM 4595-GET-BUS-DESC THRU 4595-EXIT                 ECS046
  3901         MOVE HEAD-BUS-TYPE      TO P-DATA                        ECS046
  3902         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3903         MOVE SPACES             TO P-DATA.                       ECS046
  3904                                                                  ECS046
  3905 4520-CARR-HDR.                                                   ECS046
  3906     IF DTE-TOT-OPT = 1 OR 2 OR 4 OR 5                            ECS046
  3907         PERFORM 4590-GET-CARRIER-NAME THRU 4590-EXIT             ECS046
  3908         MOVE HEAD-CARR          TO P-DATA                        ECS046
  3909         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3910         MOVE SPACES             TO P-DATA.                       ECS046
  3911                                                                  ECS046
  3912 4530-GROUP-HDR.                                                  ECS046
  3913     IF DTE-TOT-OPT = 1 OR 2 OR 4                                 ECS046
  3914         MOVE SAVE-SWA-GROUP     TO HG-GROUP                      ECS046
  3915         MOVE HEAD-GROUP         TO P-DATA                        ECS046
  3916         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3917         MOVE SPACES             TO P-DATA.                       ECS046
  3918                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ECS046.cbl
  3920 4540-STATE-HDR.                                                  ECS046
  3921     IF DTE-TOT-OPT = 1 OR 2                                      ECS046
  3922         MOVE SAVE-SWA-STATE     TO HS-STATE                      ECS046
  3923         MOVE HEAD-STATE         TO P-DATA                        ECS046
  3924         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3925         MOVE SPACES             TO P-DATA.                       ECS046
  3926                                                                  ECS046
  3927 4550-RPT-CD1-HDR.                                                ECS046
  3928     IF DTE-TOT-OPT = 3                                           ECS046
  3929         MOVE CLAS-REPORT-CD1-CAPTION TO HR-CAPTION               ECS046
  3930         MOVE SAVE-SWA-GA-OR-RPT-CD   TO HR-RPT-CODE              ECS046
  3931         MOVE HEAD-RPT-CODE           TO P-DATA                   ECS046
  3932         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3933         MOVE SPACES                  TO P-DATA.                  ECS046
  3934                                                                  ECS046
  3935 4560-RPT-CD2-HDR.                                                ECS046
  3936     IF DTE-TOT-OPT = 4                                           ECS046
  3937         MOVE CLAS-REPORT-CD2-CAPTION TO HR-CAPTION               ECS046
  3938         MOVE SAVE-SWA-GA-OR-RPT-CD   TO HR-RPT-CODE              ECS046
  3939         MOVE HEAD-RPT-CODE           TO P-DATA                   ECS046
  3940         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3941         MOVE SPACES                  TO P-DATA.                  ECS046
  3942                                                                  ECS046
  3943 4570-G-A-HDR.                                                    ECS046
  3944     IF DTE-TOT-OPT = 5                                           ECS046
  3945         MOVE SAVE-SWA-GA-OR-RPT-CD TO HGA-AGENT                  ECS046
  3946         MOVE HOLD-GA-NAME          TO  HGA-GA-NAME               ECS046
  3947         MOVE HEAD-G-A              TO P-DATA                     ECS046
  3948         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3949         MOVE SPACES                TO P-DATA.                    ECS046
  3950                                                                  ECS046
  3951 4575-RPT-CD1-2-HDR.                                              ECS046
  3952     IF DTE-TOT-OPT = 6                                           ECS046
  3953         MOVE SAVE-SWA-RPT-CD-1       TO HR2-RPT-CODE1            ECS046
  3954         MOVE SAVE-SWA-RPT-CD-2       TO HR2-RPT-CODE2            ECS046
  3955         MOVE HEAD-RPT2-CODE          TO P-DATA                   ECS046
  3956         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3957         MOVE SPACES                  TO P-DATA.                  ECS046
  3958                                                                  ECS046
  3959 4580-DTL-HDRS.                                                   ECS046
  3960     MOVE '0'                    TO X.                            ECS046
  3961     MOVE HEAD-4A                TO P-DATA.                       ECS046
  3962     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3963     MOVE ' '                    TO X.                            ECS046
  3964     MOVE HEAD-5A                TO P-DATA.                       ECS046
  3965     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3966                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ECS046.cbl
  3968 4590-GET-CARRIER-NAME.                                           ECS046
  3969     IF SAVE-SWA-CARR = HC-CARRIER                                ECS046
  3970         GO TO 4590-EXIT.                                         ECS046
  3971                                                                  ECS046
  3972     MOVE SAVE-SWA-CARR          TO HC-CARRIER.                   ECS046
  3973     PERFORM 4591-SRCH VARYING CLAS-INDEXCN FROM 1 BY 1           ECS046
  3974         UNTIL CLAS-INDEXCN GREATER CLAS-MAXCN OR                 ECS046
  3975               SAVE-SWA-CARR = CARRIER-SUB (CLAS-INDEXCN).        ECS046
  3976                                                                  ECS046
  3977     IF CLAS-INDEXCN GREATER CLAS-MAXCN                           ECS046
  3978         MOVE SPACE                      TO HC-CARRIER-NAME       ECS046
  3979     ELSE                                                         ECS046
  3980         MOVE CARRIER-PIC (CLAS-INDEXCN) TO HC-CARRIER-NAME.      ECS046
  3981                                                                  ECS046
  3982 4590-EXIT.                                                       ECS046
  3983      EXIT.                                                       ECS046
  3984                                                                  ECS046
  3985 4591-SRCH.                                                       ECS046
  3986      EXIT.                                                       ECS046
  3987                                                                  ECS046
  3988 4595-GET-BUS-DESC.                                               ECS046
  3989     IF SAVE-SWA-BUS-TYPE = HB-BUS-TYPE                           ECS046
  3990         GO TO 4595-EXIT.                                         ECS046
  3991                                                                  ECS046
  3992     MOVE SAVE-SWA-BUS-TYPE      TO HB-BUS-TYPE.                  ECS046
  3993     PERFORM 4596-SRCH VARYING CLAS-INDEXB FROM 1 BY 1            ECS046
  3994         UNTIL CLAS-INDEXB GREATER CLAS-MAXB OR                   ECS046
  3995               SAVE-SWA-BUS-TYPE = CLAS-BUSC-CODE (CLAS-INDEXB).  ECS046
  3996                                                                  ECS046
  3997     IF CLAS-INDEXB GREATER CLAS-MAXB                             ECS046
  3998         MOVE SPACE                        TO HB-BUS-DESC         ECS046
  3999     ELSE                                                         ECS046
  4000         MOVE CLAS-BUSC-DESC (CLAS-INDEXB) TO HB-BUS-DESC.        ECS046
  4001                                                                  ECS046
  4002 4595-EXIT.                                                       ECS046
  4003      EXIT.                                                       ECS046
  4004                                                                  ECS046
  4005 4596-SRCH.                                                       ECS046
  4006      EXIT.                                                       ECS046
  4007                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ECS046.cbl
  4009 4600-PRINT-ROUTINE.                                              ECS046
* 4010                             COPY ELCPRT2.                        ECS046
  4011******************************************************************04/15/98
  4012*                                                                *ELCPRT2
  4013*                                                                *ELCPRT2
  4014*                            ELCPRT2                             *   LV005
  4015*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  4016*                            VMOD=2.002                          *   CL**5
  4017*                                                                *   CL**4
  4018******************************************************************   CL**4
  4019                                                                     CL**4
  4020     IF DTE-FICH NOT = SPACE AND                                     CL**4
  4021        FICH-OPEN    = SPACE                                         CL**4
  4022         MOVE 'X'                TO  FICH-OPEN                       CL**4
  4023         OPEN OUTPUT FICH.                                           CL**4
  4024                                                                     CL**4
  4025     IF DTE-FICH NOT = SPACE                                         CL**4
  4026         MOVE X                  TO  P-CTL                           CL**4
  4027         WRITE FICH-REC FROM PRT.                                    CL**4
  4028                                                                     CL**4
  4029     IF DTE-FICH = SPACE OR '2'                                      CL**4
  4030       MOVE X                    TO  P-CTL                           CL**4
  4031       IF P-CTL = ' '                                                CL**4
  4032         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  4033       ELSE                                                          CL**4
  4034         IF P-CTL = '0'                                              CL**4
  4035           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  4036         ELSE                                                        CL**4
  4037           IF P-CTL = '-'                                            CL**4
  4038             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  4039           ELSE                                                      CL**4
  4040             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  4041                                                                     CL**4
  4042******************************************************************   CL**4
  4043                                                                  ECS046
  4044     IF X = '0'                                                   ECS046
  4045         ADD +2                  TO LINE-CNT                      ECS046
  4046     ELSE                                                         ECS046
  4047         ADD +1                  TO LINE-CNT.                     ECS046
  4048                                                                  ECS046
  4049     MOVE SPACES                 TO P-DATA.                       ECS046
  4050                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ECS046.cbl
  4052 5000-PRINT-REPORT-B   SECTION.                                   ECS046
  4053                                                                  ECS046
  4054     IF NO-OF-RECORDS-RELEASED = +0                               ECS046
  4055         GO TO 5990-PRINT-RPT-B-EXIT.                             ECS046
  4056                                                                  ECS046
  4057     MOVE ZERO                   TO PAGE-CNT.                     ECS046
  4058                                                                  ECS046
  4059     IF DTE-FMT-OPT = 2                                           ECS046
  4060         MOVE '- LOSS RATIO SEQUENCE'    TO HD-RPT-TYPE.          ECS046
  4061                                                                  ECS046
  4062     IF DTE-FMT-OPT = 3                                           ECS046
  4063         MOVE '- TOTAL CHARGES SEQUENCE' TO HD-RPT-TYPE.          ECS046
  4064                                                                  ECS046
  4065     IF DTE-FMT-OPT = 4                                           ECS046
  4066         MOVE '- WRITTEN SEQUENCE'       TO HD-RPT-TYPE.          ECS046
  4067                                                                  ECS046
  4068     IF DTE-FMT-OPT = 5                                           ECS046
  4069         MOVE '- PROFIT SEQUENCE'        TO HD-RPT-TYPE.          ECS046
  4070                                                                  ECS046
  4071     MOVE 'B'                            TO H1-REPORT-SUF.        ECS046
  4072                                                                  ECS046
  4073     PERFORM 6500-PRINT-HEADINGS.                                 ECS046
  4074                                                                  ECS046
  4075 5100-RETURN-SORT-WORK-B.                                         ECS046
  4076     RETURN SORT-WORK-B  INTO SWB-REC  AT END                     ECS046
  4077         GO TO 5990-PRINT-RPT-B-EXIT.                             ECS046
  4078                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ECS046.cbl
  4080 5200-BUILD-DTL-LINE-B.                                           ECS046
  4081     IF LINE-CNT GREATER +54                                      ECS046
  4082         MOVE ZERO               TO LINE-CNT                      ECS046
  4083         PERFORM 6500-PRINT-HEADINGS.                             ECS046
  4084                                                                  ECS046
  4085     ADD +1                      TO WS-SEQUENCE.                  ECS046
  4086     MOVE WS-SEQUENCE            TO DLB-SEQ-NO.                   ECS046
  4087     MOVE SWB-LOSS-RATIO         TO DLB-LOSS-RATIO.               ECS046
  4088     COMPUTE DLB-NET-PREM ROUNDED = SWB-NET-PREM.                 ECS046
  4089     MOVE SWB-TOT-CHARGES        TO DLB-TOT-CHARGES.              ECS046
  4090     COMPUTE DLB-PREM-PROFIT ROUNDED = SWB-PREM-PROFIT.           ECS046
  4091                                                                  ECS046
  4092     MOVE SWB-ACCT               TO DLB-ACCOUNT.                  ECS046
  4093     MOVE SWB-NAME               TO DLB-ACCT-NAME.                ECS046
  4094                                                                  ECS046
  4095     IF DTE-TOT-OPT = 1                                           ECS046
  4096         MOVE SWB-CARR           TO DLB-CARRIER                   ECS046
  4097         MOVE SWB-GROUP          TO DLB-GROUP                     ECS046
  4098         MOVE SWB-STATE          TO DLB-STATE.                    ECS046
  4099                                                                  ECS046
  4100     IF DTE-TOT-OPT = 2                                           ECS046
  4101         MOVE SWB-BUS-TYPE       TO DLB-BUS-TYPE                  ECS046
  4102         MOVE SWB-CARR           TO DLB-CARRIER                   ECS046
  4103         MOVE SWB-GROUP          TO DLB-GROUP                     ECS046
  4104         MOVE SWB-STATE          TO DLB-STATE.                    ECS046
  4105                                                                  ECS046
  4106     IF DTE-TOT-OPT = 3                                           ECS046
  4107         MOVE SWB-GA-OR-RPT-CD   TO DLB2-GA-OR-RPT-CD.            ECS046
  4108                                                                  ECS046
  4109     IF DTE-TOT-OPT = 4                                           ECS046
  4110         MOVE SWB-CARR           TO DLB2-CARRIER                  ECS046
  4111         MOVE SWB-GROUP          TO DLB2-GROUP                    ECS046
  4112         MOVE SWB-GA-OR-RPT-CD   TO DLB2-GA-OR-RPT-CD.            ECS046
  4113                                                                  ECS046
  4114     IF DTE-TOT-OPT = 5                                           ECS046
  4115         MOVE SWB-CARR           TO DLB2-CARRIER                  ECS046
  4116         MOVE SWB-GA-OR-RPT-CD   TO DLB2-GA-OR-RPT-CD.            ECS046
  4117                                                                  ECS046
  4118     MOVE ' '                    TO X.                            ECS046
  4119     MOVE DTL-LINE-B             TO P-DATA.                       ECS046
  4120     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4121     MOVE SPACES                 TO DTL-LINE-B   P-DATA.          ECS046
  4122                                                                  ECS046
  4123     GO TO 5100-RETURN-SORT-WORK-B.                               ECS046
  4124                                                                  ECS046
  4125 5990-PRINT-RPT-B-EXIT.                                           ECS046
  4126     CLOSE PRNTR.                                                 ECS046
  4127                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ECS046.cbl
  4129 6000-PERFORMED-RPT-B-ROUTINES   SECTION.                         ECS046
  4130                                                                  ECS046
  4131 6500-PRINT-HEADINGS.                                             ECS046
  4132     IF DTE-CLIENT  =  'MON'                                      ECS046
  4133         IF WS-ACTIVE-INDIC  =  'ACTIVE'                          ECS046
  4134             MOVE HOLD-ACTIVE-DESC                                ECS046
  4135                                 TO  HD-STATUS-DESC               ECS046
  4136         ELSE                                                     ECS046
  4137             MOVE HOLD-ALL-DESC  TO  HD-STATUS-DESC               ECS046
  4138     ELSE                                                         ECS046
  4139         MOVE SPACES             TO  HD-STATUS-DESC.              ECS046
  4140                                                                  ECS046
  4141     MOVE '1'                    TO X.                            ECS046
  4142     MOVE HEAD-1                 TO P-DATA.                       ECS046
  4143     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4144     MOVE ' '                    TO X.                            ECS046
  4145     MOVE HEAD-2                 TO P-DATA.                       ECS046
  4146     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4147     ADD +1                      TO PAGE-CNT.                     ECS046
  4148     MOVE PAGE-CNT               TO HD-PAGE-NO.                   ECS046
  4149     MOVE HEAD-3                 TO P-DATA.                       ECS046
  4150     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4151     MOVE SPACES                 TO H4B-BUS                       ECS046
  4152                                    H4B-GENERAL.                  ECS046
  4153                                                                  ECS046
  4154     IF DTE-TOT-OPT = 1                                           ECS046
  4155         MOVE '         CARR'    TO H5B-CTL-HDA                   ECS046
  4156         MOVE 'GROUP    STATE'   TO H5B-CTL-HDB.                  ECS046
  4157                                                                  ECS046
  4158     IF DTE-TOT-OPT = 2                                           ECS046
  4159         MOVE 'BUS'              TO H4B-BUS                       ECS046
  4160         MOVE '   TYPE  CARR'    TO H5B-CTL-HDA                   ECS046
  4161         MOVE 'GROUP    STATE'   TO H5B-CTL-HDB.                  ECS046
  4162                                                                  ECS046
  4163     IF DTE-TOT-OPT = 3                                           ECS046
  4164         MOVE SPACES                  TO H5B-CTL-HDA              ECS046
  4165         MOVE CLAS-REPORT-CD1-CAPTION TO H5B-CTL-HDB.             ECS046
  4166                                                                  ECS046
  4167     IF DTE-TOT-OPT = 4                                           ECS046
  4168         MOVE 'CARR  GROUP'           TO H5B-CTL-HDA              ECS046
  4169         MOVE CLAS-REPORT-CD2-CAPTION TO H5B-CTL-HDB.             ECS046
  4170                                                                  ECS046
  4171     IF DTE-TOT-OPT = 5                                           ECS046
  4172         MOVE 'GENERAL'          TO H4B-GENERAL                   ECS046
  4173         MOVE 'CARR'             TO H5B-CTL-HDA                   ECS046
  4174         MOVE '  AGENT'          TO H5B-CTL-HDB.                  ECS046
  4175                                                                  ECS046
  4176     MOVE '0'                    TO X.                            ECS046
  4177     MOVE HEAD-4B                TO P-DATA.                       ECS046
  4178     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4179     MOVE ' '                    TO X.                            ECS046
  4180     MOVE HEAD-5B                TO P-DATA.                       ECS046
  4181     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4182     MOVE ' '                    TO X.                            ECS046
  4183     MOVE SPACES                 TO P-DATA.                       ECS046
  4184     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4185                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ECS046.cbl
  4187 9000-JOB-CLEANUP  SECTION.                                       ECS046
  4188                                                                  ECS046
  4189 9100-E-O-J.                                                      ECS046
  4190     CLOSE PRNTR.                                                 ECS046
  4191                                                                  ECS046
  4192 9200-CLOSE-FICH.                                                 ECS046
* 4193                             COPY ELCPRTC.                        ECS046
  4194******************************************************************04/15/98
  4195*                                                                *ELCPRTC
  4196*                                                                *ELCPRTC
  4197*                            ELCPRTC.                            *   LV003
  4198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4199*                            VMOD=2.002                          *   CL**2
  4200*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  4201*                                                                *ELCPRTC
  4202* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  4203******************************************************************ELCPRTC
  4204                                                                  ELCPRTC
  4205      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  4206          CLOSE FICH.                                             ELCPRTC
  4207                                                                  ELCPRTC
  4208******************************************************************ELCPRTC
  4209                                                                  ECS046
  4210 ABEND-PGM SECTION.                                               ECS046
* 4211                             COPY ELCABEND.                       ECS046
  4212***************************************************************** 04/14/98
  4213*                                                               * ELCABEND
  4214*                            ELCABEND.                          *    LV003
  4215*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4216*                            VMOD 2.002                              CL**2
  4217*                                                               * ELCABEND
  4218*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  4219*            AND THEN ABENDS.                                   * ELCABEND
  4220*                                                               * ELCABEND
  4221*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  4222*                                                               * ELCABEND
  4223***************************************************************** ELCABEND
  4224*APS-010.                                                         ELCABEND
  4225     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  4226     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  4227                                                                  ELCABEND
  4228     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  4229         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4230         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4231                                 UPON CONSOLE.                    ELCABEND
  4232                                                                  ELCABEND
  4233     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  4234         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4235         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4236                                 UPON CONSOLE.                    ELCABEND
  4237                                                                  ELCABEND
  4238     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4239     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4240                                 UPON CONSOLE.                    ELCABEND
  4241                                                                  ELCABEND
  4242     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  4243     CALL 'ABORTME'.
  4244                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ECS046.cbl (/apps/prod/cid1p/copy/ELCABEND)
  4245 APS-EXIT.                                                        ELCABEND
  4246     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       56456     Code:       17361
