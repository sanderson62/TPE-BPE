* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   1
* ECS056.cbl
* Options: int("ECS056.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS056.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS056.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS056.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ECS056.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 26-Nov-12 09:17.
     6*REMARKS.
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   2
* ECS056.cbl
    16* 062304    2004061600004  PEMA  ADD PROCESSING FOR CANCELED
    18* 110304    2004110200007  PEMA  ADD NI AND NU TO LIST OF AH
    19*                                GIANT BEN CODES
    20*                                ADD MS TO LIFE
    21* 072005    2005071100001  PEMA  CREATE CREDIT ON REFUNDS
    22* 080305    2005080300010  PEMA  ADD SUM REM PMTS FORMULA
    23* 071906    2006012700002  PEMA  ADD MI AND MU TO CASH CERT
    24* 061112    2012060600001  AJRA  ADD P TYPE
    25******************************************************************
    26 ENVIRONMENT DIVISION.
    27 INPUT-OUTPUT SECTION.
    28 FILE-CONTROL.
    29
    30     SELECT CERTS                ASSIGN TO SYS010.
    31     SELECT EXTRACT              ASSIGN TO SYS011
    32            ORGANIZATION IS LINE SEQUENTIAL.
    33     SELECT DEBUG-EXTRACT        ASSIGN TO SYS012
    34            ORGANIZATION IS LINE SEQUENTIAL.
    35     SELECT DISK-DATE            ASSIGN TO SYS019.
    36     SELECT PRINTX               ASSIGN TO SYS008.
    37     SELECT FICH                 ASSIGN TO SYS020.
    38
    39     SELECT ERPYAJ               ASSIGN TO ERPYAJ
    40            ORGANIZATION IS INDEXED
    41            ACCESS IS DYNAMIC
    42            RECORD KEY IS PY-CONTROL-PRIMARY
    43            FILE STATUS IS ERPYAJ-FILE-STATUS.
    44
    45     SELECT ERDUEP               ASSIGN TO ERDUEP
    46            ACCESS IS DYNAMIC
    47            ORGANIZATION IS INDEXED
    48            FILE STATUS IS ERDUEP-FILE-STATUS
    49            RECORD KEY IS DP-CONTROL-PRIMARY.
    50
    51 DATA DIVISION.
    52 FILE SECTION.
    53
    54
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   3
* ECS056.cbl
    56 FD  CERTS
*   57                                 COPY ECSCRIFD.
    58******************************************************************07/10/97
    59*                                                                *ECSCRIFD
    60*                            ECSCRIFD                            *   LV001
    61*                            VMOD 2.005                          *ECSCRIFD
    62*                                                                *ECSCRIFD
    63*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
    64*                                                                *ECSCRIFD
    65******************************************************************ECSCRIFD
    66     BLOCK CONTAINS 0 RECORDS
    67     RECORDING MODE F.                                            ECSCRIFD
    68                                                                  ECSCRIFD
    69 01  CERT-IN-RECORD.                                              ECSCRIFD
    70                                                                  ECSCRIFD
    71     12  FILLER                            PIC XXX.               ECSCRIFD
    72     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
    73     12  FILLER                            PIC X(66).             ECSCRIFD
    74     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
    75     12  FILLER                            PIC X(20).             ECSCRIFD
    76     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
    77     12  FILLER                            PIC X(14).             ECSCRIFD
    78     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
    79     12  FILLER                            PIC X(39).             ECSCRIFD
    80     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    81     12  FILLER                            PIC X(45).             ECSCRIFD
    82     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
    83     12  FILLER                            PIC X(35).             ECSCRIFD
    84     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    85     12  FILLER                            PIC X(41).             ECSCRIFD
    86     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
    87     12  FILLER                            PIC X(48).             ECSCRIFD
    88     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
    89     12  FILLER                            PIC X(9).              ECSCRIFD
    90     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
    91     12  FILLER                            PIC X(120).            ECSCRIFD
    92     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    93     12  FILLER                            PIC X(73).             ECSCRIFD
    94     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    95     12  FILLER                            PIC X(464).            ECSCRIFD
    96                                                                  ECSCRIFD
    97******************************************************************ECSCRIFD
*   98                                 COPY ECSCRT01.
    99******************************************************************
   100*                                                                *
   101*                            ECSCRT01                            *
   102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   103*                            VMOD=2.016                          *
   104*                                                                *
   105*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   106*                                                                *
   107*   FILE TYPE = SEQUENTIAL
   108*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   109*                                                                *
   110*   KEY DATA =                         START=4, LEN=36           *
   111*                                                                *
   112*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   113*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   4
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   114******************************************************************
   115******************************************************************
   116*                   C H A N G E   L O G
   117*
   118* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   119*-----------------------------------------------------------------
   120*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   121* EFFECTIVE    NUMBER
   122*-----------------------------------------------------------------
   123* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   124* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   125* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   126* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   127* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   128* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   129* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   130* 032612  CR2011110200001  PEMA  AHL CHANGES
   131******************************************************************
   132
   133 01  CERTIFICATE-RECORD.
   134     12  CR-RECORD-ID                      PIC XX.
   135         88  VALID-CR-ID                      VALUE 'CR'.
   136
   137     12  CR-COMPANY-CD                     PIC X.
   138
   139     12  CR-FULL-CONTROL.
   140         16  CR-CONTROL-1.
   141             20  CR-ACCT-CONTROL.
   142                 24  CR-CARRIER            PIC X.
   143                 24  CR-GROUPING.
   144                     28  CR-GROUP-PREFIX   PIC XXX.
   145                     28  CR-GROUP-PRIME    PIC XXX.
   146                 24  CR-STATE              PIC XX.
   147                 24  CR-ACCOUNT.
   148                     28  CR-ACCT-PREFIX    PIC X(4).
   149                     28  CR-ACCT-PRIME     PIC X(6).
   150             20  CR-DT                     PIC 9(11)  COMP-3.
   151         16  CR-CERT-NO.
   152             20  CR-CERT.
   153                 24  CR-CERT-PREFIX        PIC X(3).
   154                 24  CR-CERT-PRIME         PIC X(7).
   155             20  CR-CERT-SFX               PIC X.
   156
   157     12  CR-INSUREDS-PROFILE.
   158         16  CR-NAME.
   159             20  CR-LNAME                  PIC X(15).
   160             20  CR-FNAME.
   161                 24  CR-1ST-INITIAL        PIC X.
   162                 24  FILLER                PIC X(9).
   163             20  CR-INIT                   PIC X.
   164         16  CR-AGE                        PIC 99.
   165         16  CR-SEX                        PIC X.
   166             88  CR-SEX-MALE                  VALUE 'M'.
   167             88  CR-SEX-FEMALE                VALUE 'F'.
   168         16  CR-SOC-SEC                    PIC X(11).
   169         16  CR-JOINT-NAME.
   170             20  CR-JT-LNAME               PIC X(15).
   171             20  CR-JT-FNAME.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   5
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   172                 24  CR-JT-1ST-INIT        PIC X.
   173                 24  FILLER                PIC X(9).
   174             20  CR-JT-INIT                PIC X.
   175         16  CR-JOINT-AGE                  PIC 99.
   176
   177         16  cr-ahl-ah-claim-no            pic x(9).
   178         16  cr-ahl-ah-cert-seq            pic x(3).
   179         16  cr-hst-proc-lf                pic x.
   180         16  f                             pic x(7).
   181
   182     12  CR-LF-COVERAGE-DATA.
   183         16  CR-LFTYP                      PIC XX.
   184         16  CR-LF-TERM                    PIC S999       COMP-3.
   185         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   186         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   187         16  CR-LF-DEV-CODE                PIC XXX.
   188         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   189
   190         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   191         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   192         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   193         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   194
   195         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   196         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   197         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   198         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   199
   200         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   201         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   202
   203         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   204         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   205
   206         16  CR-LF-REFUND-TYPE             PIC X.
   207         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   208
   209         16  CR-LF-COMM-CHARGEBACK         PIC X.
   210             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   211
   212         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   213
   214         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   215         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   216         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   217
   218         16  cr-ahl-lf-claim-no            pic x(9).
   219         16  cr-ahl-lf-cert-seq            pic x(3).
   220         16  FILLER                        PIC XX.
   221
   222     12  CR-AH-COVERAGE-DATA.
   223         16  CR-AHTYP                      PIC XX.
   224         16  CR-AH-TERM                    PIC S999       COMP-3.
   225         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   226         16  CR-AH-DEV-CODE                PIC XXX.
   227         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   228
   229         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   6
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   230         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   231         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   232         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   233
   234         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   235         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   236
   237         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   238         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   239
   240         16  CR-AH-REFUND-TYPE             PIC X.
   241         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   242
   243         16  CR-AH-COMM-CHARGEBACK         PIC X.
   244             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   245
   246         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   247
   248         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   249         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   250         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   251
   252         16  FILLER                        PIC XX.
   253*        16  FILLER                        PIC X(8).
   254
   255     12  CR-LOAN-DATA.
   256         16  CR-LIVES                      PIC S9(7)      COMP-3.
   257         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   258                                           PIC S9(5)V99   COMP-3.
   259         16  CR-BILLED                     PIC S9(7)      COMP-3.
   260         16  CR-APR                        PIC S999V9(4)  COMP-3.
   261         16  CR-PMT-FREQ                   PIC 99.
   262         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   263         16  CR-RATING-CLASS               PIC XX.
   264         16  CR-POLICY-FORM-NO             PIC X(12).
   265         16  CR-GRPTYP                     PIC XX.
   266         16  CR-IND-GRP                    PIC X.
   267             88  CR-INDIVIDUAL                VALUE '1'.
   268             88  CR-GROUP                     VALUE '2'.
   269         16  CR-SKIP                       PIC 99.
   270             88  NO-MONTHS-SKIPPED            VALUE 00.
   271             88  SKIP-JULY                    VALUE 01.
   272             88  SKIP-AUGUST                  VALUE 02.
   273             88  SKIP-SEPTEMBER               VALUE 03.
   274             88  SKIP-JULY-AUG                VALUE 04.
   275             88  SKIP-AUG-SEPT                VALUE 05.
   276             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   277             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   278             88  SKIP-JUNE                    VALUE 08.
   279             88  SKIP-JUNE-JULY               VALUE 09.
   280             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   281             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   282         16  CR-RESIDENT-STATE             PIC XX.
   283         16  CR-RATE-CODE.
   284             20  CR-LF-CLASS-CD            PIC XX.
   285             20  CR-AH-CLASS-CD            PIC XX.
   286         16  CR-MORT.
   287             20  CR-TAB                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   7
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   288             20  CR-INT                    PIC 99.
   289             20  CR-GRP                    PIC X.
   290         16  CR-MEMBER-NO                  PIC X(12).
   291         16  CR-OLD-LOF                    PIC XXX.
   292*        16  CR-LOAN-OFFICER               PIC XXX.
   293         16  CR-REIN-TABLE                 PIC XXX.
   294         16  CR-REIN-SPEC                  PIC X.
   295         16  CR-LOAN-1ST-PMT-DT.
   296             20  CR-1ST-PMT-YR             PIC 99.
   297             20  CR-1ST-PMT-MO             PIC 99.
   298             20  CR-1ST-PMT-DA             PIC 99.
   299         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   300         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   301         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   302         16  CR-LAST-ADD-ON-DT             PIC XX.
   303
   304         16  CR-UNDERWRITING-CODE          PIC X.
   305             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   306
   307         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   308         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   309         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   310         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   311
   312     12  CR-STATUS-INFORMATION.
   313         16  CR-ENTRY-STATUS               PIC X.
   314             88  CR-NORMAL-ENTRY              VALUE '1'.
   315             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   316             88  CR-CONVERSION-ENTRY          VALUE '4'.
   317             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   318             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   319             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   320             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   321             88  CR-POLICY-IS-VOID            VALUE 'V'.
   322             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   323             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   324                                                    '5' '9' 'P'.
   325         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   326
   327         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   328         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   329         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   330
   331         16  CR-LF-STATUS-AT-DEATH         PIC X.
   332         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   333
   334         16  CR-LF-CURRENT-STATUS          PIC X.
   335             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   336             88  CR-LF-POLICY-PENDING         VALUE '2'.
   337             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   338             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   339             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   340             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   341             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   342             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   343             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   344             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   345             88  CR-LF-IS-DECLINED            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   8
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   346             88  CR-LF-IS-VOID                VALUE 'V'.
   347             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   348                                                    '4' '5' '9'.
   349
   350         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   351
   352         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   353         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   354
   355         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   356         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   357
   358         16  CR-AH-CURRENT-STATUS          PIC X.
   359             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   360             88  CR-AH-POLICY-PENDING         VALUE '2'.
   361             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   362             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   363             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   364             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   365             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   366             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   367             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   368             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   369             88  CR-AH-IS-DECLINED            VALUE 'D'.
   370             88  CR-AH-IS-VOID                VALUE 'V'.
   371             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   372                                                    '4' '5' '9'.
   373         16  CR-LOAN-OFFICER               PIC X(5).
   374         16  CR-CANCEL-REASON              PIC X.
   375         16  cr-xycor-lf-cov-code          pic x(4).
   376         16  cr-xycor-ah-cov-code          pic x(4).
   377         16  FILLER                        PIC X(6).
   378
   379     12  CR-DEATH-CLAIM-DATA.
   380         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   381
   382         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   383         16  CR-DTH-RPT-DT.
   384             20  CR-DTH-RPT-YR             PIC 99.
   385             20  CR-DTH-RPT-MO             PIC 99.
   386             20  CR-DTH-RPT-DA             PIC 99.
   387         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   388
   389         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   390         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   391         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   392         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   393         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   394
   395         16  CR-DTH-AGE                    PIC 99.
   396         16  CR-DTH-PAY-CD                 PIC X.
   397         16  CR-DEATH-CAUSE                PIC X(6).
   398
   399         16  FILLER                        PIC X(16).
   400
   401     12  CR-DISAB-CLAIM-DATA.
   402         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   403
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page   9
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   404         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   405         16  CR-DIS-RPT-DT.
   406             20  CR-DIS-RPT-YR             PIC 99.
   407             20  CR-DIS-RPT-MO             PIC 99.
   408             20  CR-DIS-RPT-DA             PIC 99.
   409         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   410         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   411
   412         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   413         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   414         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   415         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   416         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   417
   418         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   419         16  CR-DIS-PAY-CD                 PIC X.
   420         16  FILLER                        PIC XX.
   421
   422         16  CR-DISAB-INCURRED-DETAIL.
   423             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   424**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   425                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   426                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   427                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   428
   429         16  CR-DISAB-CAUSE                PIC X(6).
   430         16  FILLER                        PIC X(14).
   431
   432     12  CR-REMIT-TO                       PIC 99.
   433
   434     12  CR-COMPENSATION-LEVELS.
   435         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   436             20  CR-COM-AGT.
   437                 24  CR-COM-AGT-PREFIX     PIC X(4).
   438                 24  CR-COM-AGT-PRIME      PIC X(6).
   439             20  CR-AGT-TYPE               PIC X.
   440             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   441             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   442
   443     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   444     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   445     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   446     12  CR-CLP-STATE                      PIC XX.
   447     12  CR-POST-CARD-IND                  PIC X.
   448     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   449     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   450     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   451     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   452     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   453     12  FILLER                            PIC X(07).
   454
   455     12  CR-CSR-CODE                       PIC XXX.
   456
   457     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   458     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   459
   460     12  CR-MICROFILM-NUMBERS.
   461*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  10
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   462         16  FILLER                        PIC X(5).
   463     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   464
   465     12  CR-USER-CODE                      PIC X.
   466     12  CR-USER-FUTURE                    PIC X(9).
   467
   468     12  CR-BENEFICIARY.
   469         16  CR-BANK-NO                    PIC X(10).
   470         16  FILLER                        PIC X(15).
   471
   472     12  CR-ENTRY-BATCH                    PIC X(6).
   473     12  CR-LF-EXIT-BATCH                  PIC X(6).
   474     12  CR-AH-EXIT-BATCH                  PIC X(6).
   475
   476     12  CR-NOTE-SW                        PIC X.
   477
   478     12  CR-ORIGIN-INDICATOR               PIC X.
   479         88  CR-ENTERED-MANUALLY              VALUE '1'.
   480         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   481
   482     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   483     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   484     12  FILLER                            PIC X(33).
   485
   486******************************************************************
   487
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  11
* ECS056.cbl
   489 FD  EXTRACT
   490     BLOCK CONTAINS 0 RECORDS
   491     RECORDING MODE IS F.
   492
   493*         236 BYTES
   494 01  EXTRACT-RECORD.
   495     05  EXT-CAR                 PIC X.
   496     05  WS-TAB1                 PIC X.
   497     05  EXT-GROUP               PIC X(6).
   498     05  WS-TAB2                 PIC X.
   499     05  EXT-STATE               PIC XX.
   500     05  WS-TAB3                 PIC X.
   501     05  EXT-ACCOUNT             PIC X(10).
   502     05  WS-TAB4                 PIC X.
   503     05  EXT-EFF-DATE            PIC X(10).
   504     05  WS-TAB5                 PIC X.
   505     05  EXT-ENT-DATE            PIC X(10).
   506     05  WS-TAB6                 PIC X.
   507     05  EXT-VAL-DATE            PIC X(10).
   508     05  WS-TAB7                 PIC X.
   509     05  EXT-EARN-TERM           PIC 999.
   510     05  WS-TAB8                 PIC X.
   511     05  EXT-CERT-NO             PIC X(11).
   512     05  WS-TAB9                 PIC X.
   513     05  EXT-LF-BEN-CODE         PIC XX.
   514     05  WS-TAB10                PIC X.
   515     05  EXT-AH-BEN-CODE         PIC XX.
   516     05  WS-TAB11                PIC X.
   517     05  EXT-LF-TERM             PIC 999.
   518     05  WS-TAB12                PIC X.
   519     05  EXT-AH-TERM             PIC 999.
   520     05  WS-TAB13                PIC X.
   521     05  EXT-LF-EXP-DATE         PIC X(10).
   522     05  WS-TAB14                PIC X.
   523     05  EXT-AH-EXP-DATE         PIC X(10).
   524     05  WS-TAB15                PIC X.
   525     05  EXT-EXP-PREM            PIC -ZZ,ZZZ,ZZ9.99.
   526     05  WS-TAB16                PIC X.
   527     05  EXT-REC-PREM            PIC -ZZ,ZZZ,ZZ9.99.
   528     05  WS-TAB17                PIC X.
   529     05  EXT-BASE-COMM           PIC -ZZZ,ZZ9.99.
   530     05  WS-TAB18                PIC X.
   531     05  EXT-GA-COMM             PIC -ZZZ,ZZ9.99.
   532     05  WS-TAB19                PIC X.
   533     05  EXT-MISC1               PIC ZZZ,ZZZ,ZZ9.99.
   534     05  WS-TAB20                PIC X.
   535     05  EXT-MISC2               PIC ZZZ,ZZZ,ZZ9.99.
   536     05  WS-TAB21                PIC X.
   537     05  EXT-MISC3               PIC ZZZ,ZZZ,ZZ9.99.
   538     05  WS-TAB22                PIC X.
   539     05  EXT-MISC4               PIC ZZZ,ZZZ,ZZ9.99.
   540     05  WS-TAB23                PIC X.
   541     05  EXT-MISC5               PIC ZZZ,ZZZ,ZZ9.99.
   542
   543
   544 FD  DEBUG-EXTRACT
   545     BLOCK CONTAINS 0 RECORDS
   546     RECORDING MODE IS F.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  12
* ECS056.cbl
   547
   548*         236 BYTES
   549 01  DEBUG-EXTRACT-RECORD.
   550     05  DB-ACCOUNT              PIC X(10).
   551     05  DB-TAB1                 PIC X.
   552     05  DB-CERT-NO              PIC X(11).
   553     05  DB-TAB2                 PIC X.
   554     05  DB-EFF-DATE             PIC X(10).
   555     05  DB-TAB3                 PIC X.
   556     05  DB-ENT-DATE             PIC X(10).
   557     05  DB-TAB4                 PIC X.
   558     05  DB-VAL-DATE             PIC X(10).
   559     05  DB-TAB5                 PIC X.
   560     05  DB-PERIOD               PIC 999.
   561     05  DB-TAB6                 PIC X.
   562     05  DB-PAYMENT              PIC -ZZ,ZZZ,ZZ9.99.
   563     05  DB-TAB7                 PIC X.
   564     05  DB-PRINC                PIC -ZZZ,ZZ9.99.
   565     05  DB-TAB8                 PIC X.
   566     05  DB-INTEREST             PIC -Z,ZZ9.99.
   567     05  DB-TAB9                 PIC X.
   568     05  DB-LINS                 PIC -Z,ZZ9.99.
   569     05  DB-TAB10                PIC X.
   570     05  DB-DINS                 PIC -Z,ZZ9.99.
   571     05  DB-TAB11                PIC X.
   572     05  DB-BALANCE              PIC -ZZ,ZZZ,ZZ9.99.
   573     05  DB-TAB12                PIC X.
   574     05  DB-LF-BEN-CODE          PIC XX.
   575     05  DB-TAB13                PIC X.
   576     05  DB-AH-BEN-CODE          PIC XX.
   577     05  DB-TAB14                PIC X.
   578     05  DB-LF-TERM              PIC 999.
   579     05  DB-TAB15                PIC X.
   580     05  DB-AH-TERM              PIC 999.
   581     05  DB-TAB16                PIC X.
   582     05  DB-LF-EXP-DATE          PIC X(10).
   583     05  DB-TAB17                PIC X.
   584     05  DB-AH-EXP-DATE          PIC X(10).
   585
   586 FD  DISK-DATE
*  587                                 COPY ELCDTEFD.
   588******************************************************************04/15/98
   589*                                                                *ELCDTEFD
   590*                                                                *ELCDTEFD
   591*                            ELCDTEFD.                           *   LV002
   592*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   593*                            VMOD=2.007                          *   CL**2
   594*                                                                *ELCDTEFD
   595******************************************************************ELCDTEFD
   596     BLOCK CONTAINS 0 RECORDS
   597     RECORDING MODE F.                                            ELCDTEFD
   598                                                                  ELCDTEFD
   599 01  DATE-DISK.                                                   ELCDTEFD
   600     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   601     12  FILLER                      PIC  X(14).                  ELCDTEFD
   602     12  DD-CR1                      PIC  9.                      ELCDTEFD
   603     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   604     12  DD-CR2                      PIC  9.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  13
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   605     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   606     12  FILLER                      PIC  X(20).                  ELCDTEFD
   607                                                                  ELCDTEFD
   608 01  DATE-DISK-R.                                                 ELCDTEFD
   609     12  FILLER                      PIC  X(4).                   ELCDTEFD
   610     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   611                                     PIC  X(32).                  ELCDTEFD
   612                                                                  ELCDTEFD
   613 01  DATE-DISK-T.                                                 ELCDTEFD
   614     12  FILLER                      PIC  X(4).                   ELCDTEFD
   615     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   616                                     PIC  X(48).                  ELCDTEFD
   617                                                                  ELCDTEFD
   618 01  DATE-DISK-M.                                                 ELCDTEFD
   619     12  FILLER                      PIC  X(4).                   ELCDTEFD
   620     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   621                                     PIC  X(48).                  ELCDTEFD
   622                                                                  ELCDTEFD
   623 01  DATE-DISK-P.                                                 ELCDTEFD
   624     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   625     12  DD-IDX                      PIC  99.                     ELCDTEFD
   626     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   627     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   628         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   629                                     PIC  X.                      ELCDTEFD
   630         16  FILLER                  PIC  X(46).                  ELCDTEFD
   631     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   632         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   633             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   634             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   635             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   636             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   637         16  FILLER                  PIC  X(16).                  ELCDTEFD
   638                                                                  ELCDTEFD
   639 01  DATE-DISK-E.                                                 ELCDTEFD
   640     12  FILLER                      PIC  X(4).                   ELCDTEFD
   641     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   642                                     PIC  X(4).                   ELCDTEFD
   643                                                                  ELCDTEFD
   644 01  DATE-DISK-C.                                                 ELCDTEFD
   645     12  FILLER                      PIC  X(7).                   ELCDTEFD
   646     12  DD-CARR1-SECPAY-SW          PIC  X.
   647     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   648     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   649     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   650     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   651     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   652     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   653     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   654     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   655     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   656     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   657     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   658     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   659     12  DD-CARR2-SECPAY-SW          PIC  X.
   660     12  FILLER                      PIC  X(7).                   ELCDTEFD
   661                                                                  ELCDTEFD
   662 01  DATE-DISK-OPT.                                               ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  14
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   663     12  FILLER                      PIC  X(04).                  ELCDTEFD
   664     12  DD-TLR-DATA.                                             ELCDTEFD
   665         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   666                                     PIC  X(03).                  ELCDTEFD
   667     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   668         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   669                                     PIC  X(06).                  ELCDTEFD
   670     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   671         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   672                                     PIC  X(07).                  ELCDTEFD
   673         16  FILLER                  PIC  X(05).                  ELCDTEFD
   674     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   675                                     PIC  X(96).                  ELCDTEFD
   676******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  15
* ECS056.cbl
   678 FD  PRINTX
*  679                                 COPY ELCPRTFD.
   680******************************************************************04/15/98
   681*                                                                *ELCPRTFD
   682*                                                                *ELCPRTFD
   683*                            ELCPRTFD.                           *   LV003
   684*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   685*                            VMOD=2.006                          *ELCPRTFD
   686******************************************************************ELCPRTFD
   687     RECORDING MODE F                                             ELCPRTFD
   688     LABEL RECORDS OMITTED                                        ELCPRTFD
   689     BLOCK CONTAINS 0 RECORDS
   690     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   691 01  PRT.                                                         ELCPRTFD
   692     12  P-CTL               PIC  X.                                 CL**2
   693     12  P-DATA              PIC  X(132).                         ELCPRTFD
   694******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  16
* ECS056.cbl
   696 FD  FICH
*  697                                 COPY ELCFCHFD.
   698******************************************************************04/15/98
   699*                                                                *ELCFCHFD
   700*                            ELCFCHFD.                           *   LV003
   701*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   702*                            VMOD=2.004                          *   CL**3
   703*                                                                *ELCFCHFD
   704******************************************************************ELCFCHFD
   705     BLOCK CONTAINS 0 RECORDS
   706     RECORDING MODE F.                                            ELCFCHFD
   707                                                                  ELCFCHFD
   708 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   709******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  17
* ECS056.cbl
   711 FD  ERDUEP.
*  712                                 COPY ERCDUEP.
   713******************************************************************
   714*                                                                *
   715*                                                                *
   716*                            ERCDUEP                             *
   717*                            VMOD=2.001                          *
   718*                                                                *
   719*   ONLINE CREDIT SYSTEM                                         *
   720*                                                                *
   721*   FILE DESCRIPTION = DUE PREMIUM MASTER                        *
   722*                                                                *
   723*   FILE TYPE = VSAM,KSDS                                        *
   724*   RECORD SIZE = 512   RECFORM = FIXED                          *
   725*                                                                *
   726*   BASE CLUSTER NAME = ERDUEP                   RKP=2,LEN=26    *
   727*       ALTERNATE PATH = NONE                                    *
   728*                                                                *
   729*   LOG = NO                                                     *
   730*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   731*                                                                *
   732******************************************************************
   733
   734 01  DUE-PREMIUM-RECORD.
   735     12  DP-RECORD-ID                          PIC XX.
   736         88  VALID-DP-ID                          VALUE 'DP'.
   737
   738     12  DP-CONTROL-PRIMARY.
   739         16  DP-COMPANY-CD                     PIC X.
   740         16  DP-CONTROL.
   741             20  DP-ACCOUNT-CONTROL.
   742                 24  DP-CARRIER                PIC X.
   743                 24  DP-GROUPING               PIC X(6).
   744                 24  DP-STATE                  PIC XX.
   745                 24  DP-ACCOUNT                PIC X(10).
   746             20  DP-KEY-FILLER                 PIC X(6).
   747
   748     12  DP-MAINT-INFORMATION.
   749         16  DP-LAST-MONTH-END-DT              PIC XX.
   750         16  DP-LAST-MAINT-DT                  PIC XX.
   751         16  DP-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   752         16  DP-LAST-MAINT-USER                PIC X(4).
   753         16  FILLER                            PIC X(10).
   754
   755     12  DP-FUTURE-SPACE                       PIC X(5).
   756         88  DP-FUTURE-NOT-USED                   VALUE '     '.
   757
   758     12  DP-LAST-EOM-STMT-DT                   PIC XX.
   759
   760     12  DP-LAST-ACTIVITY-DATE.
   761         16  DP-ACT-YEAR                       PIC 99.
   762         16  DP-ACT-MONTH                      PIC 99.
   763         16  DP-ACT-DAY                        PIC 99.
   764
   765     12  DP-MO-END-TOTALS.
   766         16  DP-MONTHLY-TOTALS.
   767             20  DP-BAL-FWD                PIC S9(7)V99   COMP-3.
   768             20  DP-EXP-PREM               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  18
* ECS056.cbl (/apps/prod/cid1p/copy/ERCDUEP)
   769             20  DP-REC-PREM               PIC S9(7)V99   COMP-3.
   770             20  DP-ADJUSTMENTS            PIC S9(7)V99   COMP-3.
   771             20  DP-BASE-COMM              PIC S9(7)V99   COMP-3.
   772             20  DP-GA-COMM                PIC S9(7)V99   COMP-3.
   773             20  DP-END-BAL                PIC S9(7)V99   COMP-3.
   774
   775         16  DP-AGING-TOTALS.
   776             20  DP-CUR                    PIC S9(7)V99   COMP-3.
   777             20  DP-OV30                   PIC S9(7)V99   COMP-3.
   778             20  DP-OV60                   PIC S9(7)V99   COMP-3.
   779             20  DP-OV90                   PIC S9(7)V99   COMP-3.
   780
   781     12  FILLER                                PIC X(394).
   782
   783******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  19
* ECS056.cbl
   785 FD  ERPYAJ.
   786
*  787                                 COPY ERCPYAJ.
   788******************************************************************04/29/98
   789*                                                                *ERCPYAJ
   790*                            ERCPYAJ                             *   LV003
   791*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   792*                            VMOD=2.015                          *   CL**2
   793*                                                                *ERCPYAJ
   794*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *ERCPYAJ
   795*                                                                *ERCPYAJ
   796*                                                                *ERCPYAJ
   797*   FILE TYPE = VSAM,KSDS                                        *ERCPYAJ
   798*   RECORD SIZE = 200  RECFORM = FIXED                           *ERCPYAJ
   799*                                                                *ERCPYAJ
   800*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *ERCPYAJ
   801*       ALTERNATE PATHS = NONE                                   *ERCPYAJ
   802*                                                                *ERCPYAJ
   803*   LOG = YES                                                    *ERCPYAJ
   804*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPYAJ
   805******************************************************************ERCPYAJ
   806******************************************************************
   807*                   C H A N G E   L O G
   808*
   809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   810*-----------------------------------------------------------------
   811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   812* EFFECTIVE    NUMBER
   813*-----------------------------------------------------------------
   814* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
   815* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
   816******************************************************************
   817                                                                  ERCPYAJ
   818 01  PENDING-PAY-ADJ.                                             ERCPYAJ
   819     12  PY-RECORD-ID                     PIC XX.                 ERCPYAJ
   820         88  VALID-PY-ID                        VALUE 'PY'.       ERCPYAJ
   821                                                                  ERCPYAJ
   822     12  PY-CONTROL-PRIMARY.                                      ERCPYAJ
   823         16  PY-COMPANY-CD                PIC X.                  ERCPYAJ
   824         16  PY-CARRIER                   PIC X.                  ERCPYAJ
   825         16  PY-GROUPING                  PIC X(6).               ERCPYAJ
   826         16  PY-FIN-RESP                  PIC X(10).              ERCPYAJ
   827         16  PY-ACCOUNT                   PIC X(10).              ERCPYAJ
   828         16  PY-PRODUCER REDEFINES PY-ACCOUNT                     ERCPYAJ
   829                                          PIC X(10).              ERCPYAJ
   830         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCPYAJ
   831         16  PY-RECORD-TYPE               PIC X.                  ERCPYAJ
   832             88  PY-REMIT-RECEIVED            VALUE 'R'.          ERCPYAJ
   833             88  PY-DEPOSIT                   VALUE 'D'.          ERCPYAJ
   834             88  PY-CHARGE-TO-AGENT           VALUE 'C'.          ERCPYAJ
   835             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.          ERCPYAJ
   836             88  PY-ADJ-DEPOSIT               VALUE 'T'.          ERCPYAJ
   837             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.          ERCPYAJ
   838             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.          ERCPYAJ
   839             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.          ERCPYAJ
   840             88  PY-ADD-TO-BALANCE            VALUE 'Z'.          ERCPYAJ
   841             88  PY-FICA-ENTRY                VALUE 'F'.          ERCPYAJ
   842             88  PY-REMIT-IND-GROUPING        VALUE 'G'.          ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  20
* ECS056.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   843             88  PY-POLICY-FEE                VALUE 'W'.          ERCPYAJ
   844             88  PY-DUE-PREM-ADJ              VALUE 'P'.
   845                                                                  ERCPYAJ
   846     12  PY-PYMT-TYPE                     PIC X.                  ERCPYAJ
   847             88  PY-NEW-BUS-PYMT              VALUE 'B'.          ERCPYAJ
   848             88  PY-REINS-PYMT                VALUE 'R'.          ERCPYAJ
   849             88  PY-EXP-PYMT                  VALUE 'E'.          ERCPYAJ
   850                                                                  ERCPYAJ
   851     12  PY-BIL-INV                       PIC X(6).               ERCPYAJ
   852     12  PY-REF-NO                        PIC X(12).              ERCPYAJ
   853                                                                  ERCPYAJ
   854     12  PY-LAST-MAINT-DT                 PIC XX.                 ERCPYAJ
   855     12  PY-LAST-MAINT-BY                 PIC X(4).               ERCPYAJ
   856     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPYAJ
   857                                                                  ERCPYAJ
   858     12  PY-PYADJ-RECORD.                                         ERCPYAJ
   859         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.   ERCPYAJ
   860         16  PY-ENTRY-COMMENT             PIC X(30).              ERCPYAJ
   861         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.               000
   862             20  PY-GL-ACCOUNT            PIC X(10).                   000
   863             20  PY-GL-STATE              PIC X(02).                   000
   864             20  PY-GL-CANC-SW            PIC X(01).                   000
   865                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.                   000
   866                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.                   000
   867             20  PY-GL-COMMENT            PIC X(10).                   000
   868             20  FILLER      REDEFINES PY-GL-COMMENT.                  000
   869                 24  PY-GL-CHECK-NO       PIC 9(06).                   000
   870                 24  FILLER               PIC X(04).                   000
   871             20  FILLER                   PIC X(07).                   ERC
   872         16  PY-SAVE-ACCOUNT              PIC X(10).              ERCPYAJ
   873         16  PY-SAVE-TYPE                 PIC X(01).              ERCPYAJ
   874                                                                  ERCPYAJ
   875         16  PY-LETTERS.                                          ERCPYAJ
   876             20  PY-LETTER OCCURS 3 TIMES                         ERCPYAJ
   877                           INDEXED BY PY-LET-NDX                  ERCPYAJ
   878                                          PIC X(04).              ERCPYAJ
   879                                                                  ERCPYAJ
   880         16  PY-ERCOMP-TYPE               PIC X.
   881             88  PY-ACCOUNT-TYPE              VALUE 'A'.
   882             88  PY-GA-TYPE                   VALUE 'G'.
   883             88  PY-BANK-TYPE                 VALUE 'B'.
   884         16  FILLER                       PIC X(05).
   885                                                                  ERCPYAJ
   886     12  PY-RECORD-STATUS.                                        ERCPYAJ
   887         16  PY-CREDIT-SELECT-DT          PIC XX.                 ERCPYAJ
   888         16  PY-CREDIT-ACCEPT-DT          PIC XX.                 ERCPYAJ
   889         16  PY-BILLED-DATE               PIC XX.                 ERCPYAJ
   890         16  PY-REPORTED-DT               PIC XX.                 ERCPYAJ
   891         16  PY-PMT-APPLIED               PIC X.                  ERCPYAJ
   892             88  PY-ACCOUNT-PMT               VALUE 'A'.          ERCPYAJ
   893             88  PY-GA-PMT                    VALUE 'G'.          ERCPYAJ
   894             88  PY-OVWRITE-PMT               VALUE 'O'.          ERCPYAJ
   895             88  PY-NON-AR-PMT                VALUE 'N'.          ERCPYAJ
   896         16  FILLER                       PIC X(5).               ERCPYAJ
   897         16  PY-INPUT-DT                  PIC XX.                 ERCPYAJ
   898         16  PY-CHECK-NUMBER              PIC X(6).               ERCPYAJ
   899         16  PY-VOID-SW                   PIC X.                  ERCPYAJ
   900             88  PY-CHECK-VOIDED              VALUE 'V'.          ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  21
* ECS056.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   901         16  PY-CHECK-ORIGIN-SW           PIC X.                  ERCPYAJ
   902             88  PY-BILLING-CHECK             VALUE 'B'.          ERCPYAJ
   903             88  PY-REFUND-CHECK              VALUE 'R'.          ERCPYAJ
   904             88  PY-GA-CHECK                  VALUE 'G'.          ERCPYAJ
   905             88  PY-CHECK-WRITTEN             VALUE 'W'.          ERCPYAJ
   906             88  PY-CHECK-REVERSAL            VALUE 'V'.          ERCPYAJ
   907         16  PY-CHECK-WRITTEN-DT          PIC XX.                 ERCPYAJ
   908         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.         ERCPYAJ
   909         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.         ERCPYAJ
   910         16  PY-BILL-FLAG                 PIC X.                  ERCPYAJ
   911             88  PY-BILLED                    VALUE 'B'.          ERCPYAJ
   912         16  PY-AR-FLAG                   PIC X.                  ERCPYAJ
   913             88  PY-AR-CYCLE                  VALUE 'C'.          ERCPYAJ
   914             88  PY-AR-MONTH-END              VALUE 'M'.          ERCPYAJ
   915         16  PY-AR-DATE                   PIC XX.                 ERCPYAJ
   916                                                                  ERCPYAJ
   917     12  PY-GL-CODES.                                             ERCPYAJ
   918         16  PY-GL-DB                     PIC X(14).              ERCPYAJ
   919         16  PY-GL-CR                     PIC X(14).              ERCPYAJ
   920         16  PY-GL-FLAG                   PIC X.                  ERCPYAJ
   921         16  PY-GL-DATE                   PIC XX.                 ERCPYAJ
   922                                                                  ERCPYAJ
   923     12  PY-CANCEL-FEE-FLAG               PIC X(2).               ERCPYAJ
   924     12  FILLER                           PIC X(3).               ERCPYAJ
   925******************************************************************ERCPYAJ
   926
   927
   928 WORKING-STORAGE SECTION.
   929 77  FILLER  PIC X(32) VALUE '********************************'.
   930 77  FILLER  PIC X(32) VALUE '      ECS056  WORKING STORAGE   '.
   931 77  FILLER  PIC X(32) VALUE '********************************'.
   932
   933 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   934     88  END-OF-FILE                VALUE 'Y'.
   935     88  MORE-RECORDS               VALUE 'N'.
   936 77  IYR                         PIC S9(03) COMP-3 VALUE +0.
   937 77  VYR                         PIC S9(03) COMP-3 VALUE +0.
   938 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   939 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   940 77  SPACE-NP                    PIC X      VALUE '1'.
   941 77  SPACE-1                     PIC X      VALUE ' '.
   942 77  SPACE-2                     PIC X      VALUE '0'.
   943 77  SPACE-3                     PIC X      VALUE '-'.
   944 77  X                           PIC X      VALUE ' '.
   945 77  LNCTR                       PIC S999   VALUE +60 COMP-3.
   946 77  PGCTR                       PIC S9(5)  VALUE +0 COMP-3.
   947
   948 01  HD1.
   949     12  FILLER              PIC  X(44)      VALUE SPACES.
   950     12  FILLER              PIC  X(44)      VALUE
   951             '        DUE PREMIUM AND COMMISSION         '.
   952     12  FILLER              PIC  X(31)      VALUE SPACES.
   953     12  FILLER              PIC  X(08)      VALUE 'ECS056'.
   954
   955 01  HD2.
   956     12  FILLER              PIC  X(51)      VALUE SPACES.
   957     12  HD-CO               PIC  X(30).
   958     12  FILLER              PIC  X(38)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  22
* ECS056.cbl
   959     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   960
   961 01  HD3.
   962     12  FILLER              PIC  X(57)      VALUE SPACES.
   963     12  HD-DT               PIC  X(18).
   964     12  FILLER              PIC  X(44)      VALUE SPACES.
   965     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   966     12  HD-PG               PIC ZZ,ZZ9.
   967
   968 01  HD4.
   969     12  FILLER              PIC  X(44)      VALUE
   970             '-- ACCOUNT TOTALS  --      BEGINNING   EXPEC'.
   971     12  FILLER              PIC  X(44)      VALUE
   972             'TED   RECEIVED              ENDING          '.
   973     12  FILLER              PIC  X(44)      VALUE
   974             '                    DUE      NO OF          '.
   975
   976 01  HD5.
   977     12  FILLER              PIC  X(44)      VALUE
   978             '--CAR GROUP  ST  ACCOUNT--- BALANCE    PREMI'.
   979     12  FILLER              PIC  X(44)      VALUE
   980             'UMS   PREMIUMS  ADJUSTMENTS BALANCE      < 9'.
   981     12  FILLER              PIC  X(44)      VALUE
   982             '0        > 90   COMMISSION   MONTHS         '.
   983 01  DETAIL-LINE.
   984     05  FILLER                  PIC X(4).
   985     05  DTL1-CAR                PIC X.
   986     05  FILLER                  PIC X.
   987     05  DTL1-GRP                PIC X(6).
   988     05  FILLER                  PIC X.
   989     05  DTL1-ST                 PIC XX.
   990     05  FILLER                  PIC X.
   991     05  DTL1-ACCT               PIC X(10).
   992     05  FILLER                  PIC X.
   993     05  DTL1-BEG-BAL            PIC ZZZ,ZZ9.99.
   994     05  FILLER                  PIC X.
   995     05  DTL1-EXP-PREM           PIC ZZZ,ZZ9.99.
   996     05  FILLER                  PIC X.
   997     05  DTL1-REC-PREM           PIC ZZZ,ZZ9.99.
   998     05  FILLER                  PIC X.
   999     05  DTL1-ADJS               PIC ZZZ,ZZ9.99.
  1000     05  FILLER                  PIC X.
  1001     05  DTL1-END-BAL            PIC ZZZ,ZZ9.99.
  1002     05  FILLER                  PIC X.
  1003     05  DTL1-DUE-LT90           PIC ZZZ,ZZ9.99.
  1004     05  FILLER                  PIC X.
  1005     05  DTL1-DUE-GT90           PIC ZZZ,ZZ9.99.
  1006     05  FILLER                  PIC X.
  1007     05  DTL1-COMM               PIC ZZZ,ZZ9.99.
  1008     05  FILLER                  PIC X(4).
  1009     05  DTL1-NO-MOS             PIC ZZ9.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  23
* ECS056.cbl
  1011 01  WS-DUE-PREM-ADJ-TABLE.
  1012     05  WS-DUEP-ADJ OCCURS 500.
  1013         10  WS-DA-KEY           PIC X(33).
  1014         10  WS-DA-AMOUNT        PIC S9(7)V99 COMP-3.
  1015
  1016 01  WS-DUE-PREM-TABLE.
  1017     05  WS-RECORD.
  1018         10  WS-CAR              PIC X.
  1019         10  WS-GROUP            PIC X(6).
  1020         10  WS-STATE            PIC XX.
  1021         10  WS-ACCOUNT          PIC X(10).
  1022         10  WS-EFF-DATE         PIC X(10).
  1023         10  WS-CERT-NO          PIC X(11).
  1024         10  WS-LF-BEN-CODE      PIC XX.
  1025         10  WS-AH-BEN-CODE      PIC XX.
  1026         10  WS-LF-TERM          PIC ZZ9.
  1027         10  WS-AH-TERM          PIC ZZ9.
  1028         10  WS-LF-EXP-DATE      PIC X(10).
  1029         10  WS-AH-EXP-DATE      PIC X(10).
  1030         10  WS-LF-EXP-PREM      PIC S9(9)V99 COMP-3 VALUE +0.
  1031         10  WS-AH-EXP-PREM      PIC S9(9)V99 COMP-3 VALUE +0.
  1032         10  WS-EXP-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
  1033         10  WS-REC-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
  1034         10  WS-LF-BASE-COMM     PIC S9(7)V99 COMP-3 VALUE +0.
  1035         10  WS-AH-BASE-COMM     PIC S9(7)V99 COMP-3 VALUE +0.
  1036         10  WS-BASE-COMM        PIC S9(7)V99 COMP-3 VALUE +0.
  1037         10  WS-REC-BASE-COMM    PIC S9(7)V99 COMP-3 VALUE +0.
  1038         10  WS-LF-GA-COMM       PIC S9(7)V99 COMP-3 VALUE +0.
  1039         10  WS-AH-GA-COMM       PIC S9(7)V99 COMP-3 VALUE +0.
  1040         10  WS-GA-COMM          PIC S9(7)V99 COMP-3 VALUE +0.
  1041         10  WS-MISC1            PIC S9(7)V99 COMP-3 VALUE +0.
  1042         10  WS-MISC2            PIC S9(7)V99 COMP-3 VALUE +0.
  1043         10  WS-MISC3            PIC S9(7)V99 COMP-3 VALUE +0.
  1044         10  WS-MISC4            PIC S9(7)V99 COMP-3 VALUE +0.
  1045         10  WS-MISC5            PIC S9(7)V99 COMP-3 VALUE +0.
  1046
  1047 01  WS-MISC.
  1048     05  WS-INIT-EXTRACT         PIC X(236) VALUE LOW-VALUES.
  1049     05  WS-INIT-DB-EXTRACT      PIC X(236) VALUE LOW-VALUES.
  1050     05  WS-PYAJ-MATCH-KEY       PIC X(28) VALUE LOW-VALUES.
  1051     05  WS-ERPYAJ-KEY.
  1052         10  WS-PY-COMPANY-CD    PIC X.
  1053         10  WS-PY-CARRIER       PIC X.
  1054         10  WS-PY-GROUPING      PIC X(6).
  1055         10  WS-PY-FIN-RESP      PIC X(10).
  1056         10  WS-PY-ACCOUNT       PIC X(10).
  1057     05  ERDUEP-FILE-STATUS      PIC XX.
  1058     05  ERPYAJ-FILE-STATUS      PIC XX.
  1059     05  WS-HOLD-PRT             PIC X(133).
  1060     05  WS-DUEP-CONTROL         PIC X(19)    VALUE LOW-VALUES.
  1061     05  WS-HOLD-CONTROL.
  1062         10  WS-HOLD-CAR         PIC X.
  1063         10  WS-HOLD-GRP         PIC X(6).
  1064         10  WS-HOLD-ST          PIC XX.
  1065         10  WS-HOLD-ACCT        PIC X(10).
  1066     05  WS-WORK-TERM            PIC S999   COMP-3 VALUE +0.
  1067     05  INTERMED                PIC S9(9)V9(6)  COMP-3.
  1068     05  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  24
* ECS056.cbl
  1069     05  WS-DISPLAY-DATE         PIC ZZZ9(8).
  1070     05  WS-DISPLAY-TERM         PIC Z99.
  1071     05  WS-DISPLAY-RTERM        PIC Z99.99.
  1072     05  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
  1073     05  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
  1074     05  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
  1075     05  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
  1076     05  WS-BIN-LAST-MONTH-DT    PIC XX  VALUE LOW-VALUES.
  1077     05  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
  1078     05  WS-BIN-1ST-DT           PIC XX  VALUE LOW-VALUES.
  1079     05  WS-DAYS-TO-1ST          PIC S9(3) COMP-3 VALUE +0.
  1080     05  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
  1081     05  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
  1082     05  WS-BIN-LF-CAN-DATE      PIC XX  VALUE LOW-VALUES.
  1083     05  WS-BIN-AH-CAN-DATE      PIC XX  VALUE LOW-VALUES.
  1084     05  WS-LF-CAN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1085     05  WS-AH-CAN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1086     05  WS-LF-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1087     05  WS-LF-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  1088     05  WS-AH-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1089     05  WS-AH-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  1090     05  WS-LF-REF               PIC S9(7)V99 COMP-3 VALUE +0.
  1091     05  WS-AH-REF               PIC S9(7)V99 COMP-3 VALUE +0.
  1092     05  WS-LF-CAN-QUAL-SW       PIC X     VALUE 'N'.
  1093         88  CREDIT-LF-CANCEL              VALUE 'Y'.
  1094     05  WS-AH-CAN-QUAL-SW       PIC X     VALUE 'N'.
  1095         88  CREDIT-AH-CANCEL              VALUE 'Y'.
  1096     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
  1097     05  FILLER REDEFINES WS-END-YEAR.
  1098         10  WS-CCYY             PIC 9(7).
  1099         10  WS-MMDD             PIC 9(4).
  1100 01  WS-DEBUG-AREA.
  1101     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
  1102         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
  1103         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
  1104         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
  1105         88  DEBUG-LF-STATUTORY         VALUE '3'.
  1106         88  DEBUG-AH-STATUTORY         VALUE '4'.
  1107
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  25
* ECS056.cbl
  1109
  1110 01  TEXAS-REGS-WORK-AREAS.
  1111     12  TEX-FACT-1              PIC S9(7)V9(2)    COMP-3.
  1112     12  TEX-FACT-2              PIC S9(3)   COMP-3.
  1113     12  TEX-FACT-3              PIC S9(3)   COMP-3.
  1114     12  TEX-FACT-4              PIC S9(7)   COMP-3.
  1115     12  TEX-FACT-5              PIC S9(3)   COMP-3.
  1116     12  TEX-FACT-6              PIC S9(3)   COMP-3.
  1117     12  TEX-FACT-7              PIC S9(7)   COMP-3.
  1118     12  TEX-FACT-8              PIC S9V9(6) COMP-3.
  1119     12  TEX-FACT-9              PIC S9(4)V9(11)   COMP-3.
  1120
  1121 01  NET-PAY-INTERFACE.
  1122     05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
  1123     05  NP-ORIG                 PIC S9(3)         COMP-3.
  1124     05  NP-REM                  PIC S9(3)         COMP-3.
  1125     05  NP-OPT                  PIC X(01).
  1126     05  NP-CAP                  PIC S9(3)         COMP-3.
  1127     05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
  1128     05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
  1129     05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
  1130
  1131 01  WS-ABEND-AREA.
  1132     05  WS-ABEND-FILE-STATUS    PIC X(02).
  1133     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  1134     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  1135     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  1136
  1137 01  WORK-ABEND-CODE.
  1138     12  WAC-1                   PIC X.
  1139     12  WAC-2                   PIC X.
  1140     12  WAC-3-4.
  1141         16  WAC-3               PIC X.
  1142         16  WAC-4               PIC X.
  1143
  1144 01  DATE-AREAS.
  1145     05  WS-THIS-MONTH-DATE      PIC 9(11).
  1146     05  WS-LAST-MONTH-DATE      PIC 9(11).
  1147     05  WS-WORK-DATE            PIC 9(11).
  1148     05  FILLER REDEFINES WS-WORK-DATE.
  1149         10  FILLER              PIC XXX.
  1150         10  WS-WORK-CCYY        PIC 9(4).
  1151         10  WS-WORK-MMDD        PIC 9(4).
  1152     05  WS-ISSUE-DATE           PIC 9(11).
  1153     05  FILLER REDEFINES WS-ISSUE-DATE.
  1154         10  FILLER              PIC XXX.
  1155         10  WS-ISSUE-CCYY       PIC 9(4).
  1156         10  WS-ISSUE-MMDD       PIC 9(4).
  1157     05  WS-EXPIRE-DATE          PIC 9(11).
  1158     05  FILLER REDEFINES WS-EXPIRE-DATE.
  1159         10  FILLER              PIC XXX.
  1160         10  WS-EXPIRE-CCYY      PIC 9(4).
  1161         10  WS-EXPIRE-MMDD      PIC 9(4).
  1162     05  WS-ENTRY-DATE           PIC 9(11).
  1163     05  FILLER REDEFINES WS-ENTRY-DATE.
  1164         10  FILLER              PIC XXX.
  1165         10  WS-ENTRY-CCYY       PIC 9(4).
  1166         10  WS-ENTRY-MMDD       PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  26
* ECS056.cbl
  1167     05  WS-CANCEL-DATE          PIC 9(11).
  1168     05  FILLER REDEFINES WS-CANCEL-DATE.
  1169         10  FILLER              PIC XXX.
  1170         10  WS-CANCEL-CCYY      PIC 9(4).
  1171         10  WS-CANCEL-MMDD      PIC 9(4).
  1172     05  WS-CLAIM-DATE           PIC 9(11).
  1173     05  FILLER REDEFINES WS-CLAIM-DATE.
  1174         10  FILLER              PIC XXX.
  1175         10  WS-CLAIM-CCYY       PIC 9(4).
  1176         10  WS-CLAIM-MMDD       PIC 9(4).
  1177     05  WS-POSTING-DATE         PIC X(8).
  1178     05  WS-HI-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
  1179     05  WS-LO-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
  1180     05  WS-HI-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
  1181     05  WS-LO-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
  1182     05  WS-BIN-VAL-DATES OCCURS 50
  1183                                 PIC XX.
  1184
  1185 01  WS-MISC-AREA.
  1186     12  WS-DP-EXP-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
  1187     12  WS-DP-REC-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
  1188     12  WS-DP-GA-COMM           PIC S9(9)V99 COMP-3 VALUE +0.
  1189     12  WS-DP-BASE-COMM         PIC S9(9)V99 COMP-3 VALUE +0.
  1190     12  WS-DP-ADJ               PIC S9(9)V99 COMP-3 VALUE +0.
  1191*   1ST OCCURANCE           ACCOUNT TOTALS
  1192*   2ND                     STATE
  1193*   3RD                     GROUP
  1194*   4TH                     CARRIER
  1195*   5TH                     FINAL
  1196     12  WS-TOTAL-TABLE OCCURS 5.
  1197         16  WS-TOT-EXP-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
  1198         16  WS-TOT-REC-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
  1199         16  WS-TOT-GA-COMM      PIC S9(9)V99 COMP-3 VALUE +0.
  1200         16  WS-TOT-BASE-COMM    PIC S9(9)V99 COMP-3 VALUE +0.
  1201     12  WS-DISPLAY-FLD          PIC 9(9).9(5).
  1202     12  WS-LF-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
  1203     12  WS-AH-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
  1204     12  CERT-IN-CNT             PIC 9(9)     VALUE ZEROS.
  1205     12  WS-INT                  PIC S9(5)V999 COMP-3 VALUE +0.
  1206     12  WS-FINT                 PIC S9(5)V999 COMP-3 VALUE +0.
  1207     12  WS-LINS                 PIC S9(7)V99 COMP-3  VALUE +0.
  1208     12  WS-DINS                 PIC S9(7)V99 COMP-3  VALUE +0.
  1209     12  WS-FLINS                PIC S9(7)V99 COMP-3  VALUE +0.
  1210     12  WS-FDINS                PIC S9(7)V99 COMP-3  VALUE +0.
  1211     12  WS-I                    PIC SV9(9)   COMP-3  VALUE +0.
  1212     12  WS-J                    PIC SV9(9)   COMP-3  VALUE +0.
  1213     12  WS-Y                    PIC S99V9(9)   COMP-3  VALUE +0.
  1214     12  WS-K                    PIC SV9(9)   COMP-3  VALUE +0.
  1215     12  WS-VM                   PIC S9V9(9)  COMP-3  VALUE +0.
  1216     12  WS-P                    PIC S9(7)V99 COMP-3  VALUE +0.
  1217     12  WS-B                    PIC S9(7)V99 COMP-3  VALUE +0.
  1218     12  WS-R                    PIC S9(7)V99 COMP-3  VALUE +0.
  1219     12  WS-I1                   PIC S9(7)V99 COMP-3  VALUE +0.
  1220     12  X1                      PIC S999     COMP-3  VALUE +0.
  1221     12  WS-A                    PIC S999     COMP-3  VALUE +0.
  1222     12  WS-PYAJ-INDEX           PIC S999     COMP-3  VALUE +0.
  1223     12  WS-PYAJ-MAX             PIC S999     COMP-3  VALUE +0.
  1224     12  WS-ANGLEN               PIC S9(5)V9999 COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  27
* ECS056.cbl
  1225     12  WS-OD                   PIC S9(5)V9999 COMP-3  VALUE +0.
  1226     12  WS-AMT                  PIC S9(9)V99 COMP-3  VALUE +0.
  1227     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3  VALUE +0.
  1228     12  WS-ANGLEM               PIC S9(5)V9999 COMP-3  VALUE +0.
  1229     12  WS-ANGLEM-1             PIC S9(5)V9999 COMP-3  VALUE +0.
  1230     12  WS-ANGLEMJ              PIC S9(5)V9999 COMP-3  VALUE +0.
  1231     12  WS-ANGLEMK              PIC S9(5)V9999 COMP-3  VALUE +0.
  1232     12  WS-ANGLEN-M             PIC S9(5)V9999 COMP-3  VALUE +0.
  1233     12  LF-REM-TERM             PIC S999     COMP-3  VALUE +0.
  1234     12  AH-REM-TERM             PIC S999     COMP-3  VALUE +0.
  1235     12  LF-REM-TRM1             PIC S999V99  COMP-3  VALUE +0.
  1236     12  AH-REM-TRM1             PIC S999V99  COMP-3  VALUE +0.
  1237     12  LF-REM-TRM2             PIC S999V99  COMP-3  VALUE +0.
  1238     12  AH-REM-TRM2             PIC S999V99  COMP-3  VALUE +0.
  1239     12  REM-TERM                PIC S9(3)V99    COMP-3.
  1240     12  REM-TRM2                PIC S9(3)V99    COMP-3.
  1241     12  WS-LF-EARN-TERM         PIC S999            VALUE ZEROS.
  1242     12  WS-AH-EARN-TERM         PIC S999            VALUE ZEROS.
  1243     12  WS-EARN-TERM            PIC S999            VALUE ZEROS.
  1244     12  WS-GIANT-SW             PIC X           VALUE SPACES.
  1245         88  THIS-IS-A-GIANT-CERT                VALUE 'X'.
  1246
  1247
  1248 01  ABEND-FIELDS.
  1249     12  PGM-SUB                 PIC S999 COMP  VALUE +064.
  1250     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
  1251         88  FIRST-TIME                 VALUE 'Y'.
  1252
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  28
* ECS056.cbl
* 1254                                 COPY ELCCALC.
  1255******************************************************************04/15/98
  1256*                                                                *ELCCALC
  1257*                           ELCCALC.                            *    LV003
  1258*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1259*                            VMOD=2.025                          *   CL**3
  1260*                                                                *   CL**2
  1261*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  1262*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  1263*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  1264*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  1265*                                                                *   CL**2
  1266*  PASSED TO ELRTRM                                              *   CL**2
  1267*  -----------------                                             *   CL**2
  1268*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  1269*  ORIGINAL TERM                                                 *   CL**2
  1270*  BEGINNING DATE                                                *   CL**2
  1271*  ENDING DATE                                                   *   CL**2
  1272*  COMPANY I.D.                                                  *   CL**2
  1273*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  1274*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  1275*  FREE LOOK DAYS                                                *   CL**2
  1276*                                                                *   CL**2
  1277*  RETURNED FROM ELRTRM                                          *   CL**2
  1278*  ---------------------                                         *   CL**2
  1279*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  1280*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  1281*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  1282*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  1283*----------------------------------------------------------------*   CL**2
  1284*  PASSED TO ELRAMT                                              *   CL**2
  1285*  ----------------                                              *   CL**2
  1286*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  1287*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1288*  ORIGINAL AMOUNT                                               *   CL**2
  1289*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  1290*  A.P.R. - NET PAY ONLY                                         *   CL**2
  1291*  METHOD                                                            CL**2
  1292*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  1293*  COMPANY I.D.                                                  *   CL**2
  1294*  BENEFIT TYPE                                                  *   CL**2
  1295*                                                                *   CL**2
  1296*  RETURNED FROM ELRAMT                                          *   CL**2
  1297*  --------------------                                          *   CL**2
  1298*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  1299*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  1300*  REMAINING AMOUNT FACTOR                                           CL**2
  1301*----------------------------------------------------------------*   CL**2
  1302*  PASSED TO ELRESV                                              *   CL**2
  1303*  -----------------                                             *   CL**2
  1304*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  1305*  VALUATION DATE                                                *   CL**2
  1306*  PAID THRU DATE                                                *   CL**2
  1307*  BENEFIT                                                       *   CL**2
  1308*  INCURRED DATE                                                 *   CL**2
  1309*  REPORTED DATE                                                 *   CL**2
  1310*  ISSUE AGE                                                     *   CL**2
  1311*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  29
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1312*  CDT PERCENT                                                   *   CL**2
  1313*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  1314* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  1315* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  1316* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  1317*                                                                *   CL**2
  1318*  RETURNED FROM ELRESV                                          *   CL**2
  1319*  --------------------                                          *   CL**2
  1320*  CDT TABLE USED                                                *   CL**2
  1321*  CDT FACTOR USED                                               *   CL**2
  1322*  PAY TO CURRENT RESERVE                                        *   CL**2
  1323*  I.B.N.R. - A/H ONLY                                           *   CL**2
  1324*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  1325*----------------------------------------------------------------*   CL**2
  1326*  PASSED TO ELRATE                                              *   CL**2
  1327*  ----------------                                              *   CL**2
  1328*  CERT ISSUE DATE                                               *   CL**2
  1329*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1330*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1331*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  1332*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1333*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1334*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1335*  DEVIATION CODE                                                *   CL**2
  1336*  ISSUE AGE                                                     *   CL**2
  1337*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1338*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1339*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  1340*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1341*  A.P.R.                                                        *   CL**2
  1342*  METHOD                                                            CL**2
  1343*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1344*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1345*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1346*  BENEFIT CODE                                                  *   CL**2
  1347*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1348*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  1349*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  1350*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  1351*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  1352*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  1353*                                                                *   CL**2
  1354*  RETURNED FROM ELRATE                                          *   CL**2
  1355*  --------------------                                          *   CL**2
  1356*  CALCULATED PREMIUM                                            *   CL**2
  1357*  PREMIUM RATE                                                  *   CL**2
  1358*  MORTALITY CODE                                                *   CL**2
  1359*  MAX ATTAINED AGE                                              *   CL**2
  1360*  MAX AGE                                                       *   CL**2
  1361*  MAX TERM                                                      *   CL**2
  1362*  MAX MONTHLY BENEFIT                                           *   CL**2
  1363*  MAX TOTAL BENIFIT                                             *   CL**2
  1364*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  1365*----------------------------------------------------------------*   CL**2
  1366*  PASSED TO ELRFND                                              *   CL**2
  1367*  ----------------                                              *   CL**2
  1368*  CERT ISSUE DATE                                               *   CL**2
  1369*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  30
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1370*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1371*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1372*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1373*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1374*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1375*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1376*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1377*  DEVIATION CODE                                                *   CL**2
  1378*  ISSUE AGE                                                     *   CL**2
  1379*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1380*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1381*  PROCESS TYPE (CANCEL)                                         *   CL**2
  1382*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1383*  A.P.R.                                                        *   CL**2
  1384*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  1385*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  1386*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1387*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1388*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1389*  BENEFIT CODE                                                  *   CL**2
  1390*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1391*                                                                *   CL**2
  1392*  RETURNED FROM ELRFND                                          *   CL**2
  1393*  --------------------                                          *   CL**2
  1394*  CALCULATED REFUND                                             *   CL**2
  1395*----------------------------------------------------------------*   CL**2
  1396*  PASSED TO ELEARN                                              *   CL**2
  1397*  ----------------                                              *   CL**2
  1398*  CERT ISSUE DATE                                               *   CL**2
  1399*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1400*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1401*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1402*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1403*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1404*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1405*  DEVIATION CODE                                                *   CL**2
  1406*  ISSUE AGE                                                     *   CL**2
  1407*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1408*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1409*  A.P.R.                                                        *   CL**2
  1410*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1411*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1412*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1413*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1414*  BENEFIT CODE                                                  *   CL**2
  1415*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1416*                                                                *   CL**2
  1417*  RETURNED FROM ELEARN                                          *   CL**2
  1418*  --------------------                                          *   CL**2
  1419*  INDICATED  EARNINGS                                           *   CL**2
  1420*----------------------------------------------------------------*   CL**2
  1421*                 LENGTH = 450                                   *   CL**2
  1422*                                                                *   CL**2
  1423******************************************************************   CL**2
  1424******************************************************************
  1425*                   C H A N G E   L O G
  1426*
  1427* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  31
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1428*-----------------------------------------------------------------
  1429*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1430* EFFECTIVE    NUMBER
  1431*-----------------------------------------------------------------
  1432* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1433* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1434* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1435* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1436* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1437* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1438* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1439* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1440* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1441******************************************************************
  1442                                                                     CL**2
  1443 01  CALCULATION-PASS-AREA.                                          CL**2
  1444     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1445                                     COMP.                           CL**2
  1446                                                                     CL**2
  1447     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1448       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1449       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1450                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1451       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1452       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1453       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1454       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1455       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1456       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1457       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1458       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1459       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1460       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1461       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1462       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1463       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1464       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1465       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1466       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1467       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1468                                                                     CL**2
  1469     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1470       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1471***********************  INPUT AREAS ****************************    CL**2
  1472                                                                     CL**2
  1473     12  CP-CALCULATION-AREA.                                        CL**2
  1474         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1475         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1476         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1477         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1478         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1479           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1480                                                   'I' 'U'.          CL**2
  1481           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1482           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1483         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1484         16  CP-REPORTED-DT        PIC XX.                           CL**2
  1485         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  32
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1486         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1487         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1488                                     COMP-3.                         CL**2
  1489         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1490                                     COMP-3.                         CL**2
  1491         16  CP-CDT-METHOD         PIC X.                            CL**2
  1492           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1493           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1494           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1495         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1496           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1497           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1498         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1499                                     COMP-3.                         CL**2
  1500         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1501                                     COMP-3.                         CL**2
  1502         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1503                                     COMP-3.                         CL**2
  1504         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1505                                     COMP-3.                         CL**2
  1506         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1507                                     COMP-3.                         CL**2
  1508         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1509                                     COMP-3.                         CL**2
  1510         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1511                                     COMP-3.                         CL**2
  1512         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1513           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1514           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1515           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1516           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1517           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1518           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1519           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1520         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1521           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1522           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1523           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1524           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1525           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1526           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1527           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1528           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1529           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1530           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1531           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1532           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1533           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1534           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1535         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1536           88  CP-CLAIM                            VALUE '1'.        CL**2
  1537           88  CP-CANCEL                           VALUE '2'.        CL**2
  1538           88  CP-ISSUE                            VALUE '3'.        CL**2
  1539         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1540           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1541           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1542           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  1543           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  33
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1544           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1545           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1546           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1547           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1548           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1549           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1550           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1551           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1552           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1553           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1554           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1555           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1556           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1557           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1558                                                     'W' 'X'.        CL**2
  1559           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1560           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1561           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1562           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1563           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1564           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1565           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1566           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1567           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1568           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1569           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1570           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1571           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1572                                                                     CL**2
  1573         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1574                                     COMP-3.                         CL**2
  1575         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1576         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1577         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1578         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1579         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1580           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1581               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1582         16  CP-R78-OPTION         PIC X.                            CL**2
  1583           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1584           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1585                                                                     CL**2
  1586         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1587         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1588         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1589         16  CP-RATE-FILE          PIC X.                            CL**2
  1590         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1591                                     COMP-3.                         CL**2
  1592                                                                     CL**2
  1593         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1594         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1595                                                                     CL**2
  1596         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1597                                     COMP-3.
  1598         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1599                                   PIC S9(5)V99 COMP-3.
  1600         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  1601                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  34
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1602         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1603                                     COMP-3.                         CL**2
  1604         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1605                                     COMP-3.
  1606         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1607                                  PIC S9(7)V99 COMP-3.
  1608                                                                     CL**2
  1609         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1610         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1611         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1612           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1613           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1614           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1615           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1616         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1617         16  CP-CARRIER            PIC X.                            CL**2
  1618         16  CP-REIN-FLAG          PIC X.                            CL**2
  1619         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1620           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1621                      '2' '3' '4' '5'.                               CL**2
  1622           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1623           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1624           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1625           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1626           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1627           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1628           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1629           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1630         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1631         16  CP-RATING-METHOD      PIC X.                            CL**2
  1632           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1633           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1634           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1635           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1636           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1637           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1638           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1639           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1640           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1641         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1642                                     COMP-3.                         CL**2
  1643         16  CP-BEN-CATEGORY       PIC X.
  1644         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1645         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1646                                   PIC S99V9(5) COMP-3.
  1647         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1648         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1649                                   PIC S99V9(5) COMP-3.
  1650         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1651         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1652         16  CP-EXPIRE-DT          PIC XX.
  1653         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1654         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1655         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1656         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1657         16  CP-DDF-SPEC-CALC      PIC X.
  1658             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1659             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  35
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1660         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1661         16  CP-CANCEL-REASON      PIC X.
  1662         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1663         16  CP-PMT-MODE           PIC X.
  1664         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1665         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1666         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1667         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1668         16  FILLER                PIC X.
  1669                                                                     CL**2
  1670***************    OUTPUT FROM ELRESV   ************************     CL**2
  1671                                                                     CL**2
  1672         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1673                                                                     CL**2
  1674         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1675                                     COMP-3.                         CL**2
  1676         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1677                                     COMP-3.                         CL**2
  1678         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1679                                     COMP-3.                         CL**2
  1680         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1681                                     COMP-3.                         CL**2
  1682         16  FILLER                PIC X(09).                        CL**2
  1683***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1684                                                                     CL**2
  1685         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1686                                     COMP-3.                         CL**2
  1687         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1688                                     COMP-3.                         CL**2
  1689         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1690                                     COMP-3.                         CL**2
  1691         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1692                                     COMP-3.                         CL**2
  1693         16  FILLER                PIC X(12).                        CL**2
  1694                                                                     CL**2
  1695***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1696                                                                     CL**2
  1697         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1698                                     COMP-3.                         CL**2
  1699         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1700                                     COMP-3.                         CL**2
  1701         16  FILLER                PIC X(12).                        CL**2
  1702                                                                     CL**2
  1703***************    OUTPUT FROM ELRATE   *************************    CL**2
  1704                                                                     CL**2
  1705         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1706                                     COMP-3.                         CL**2
  1707         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1708                                     COMP-3.                         CL**2
  1709         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1710         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1711             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1712         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1713                                     COMP-3.                         CL**2
  1714         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1715         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1716         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1717                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  36
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1718         16  FILLER                PIC X(07).                        CL**2
  1719                                                                     CL**2
  1720***************    OUTPUT FROM ELRFND   *************************    CL**2
  1721                                                                     CL**2
  1722         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1723                                     COMP-3.                         CL**2
  1724         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1725           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1726           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1727           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1728           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1729           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1730           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1731           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1732           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1733           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1734           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1735           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1736           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1737           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1738           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1739         16  FILLER                PIC X(12).                        CL**2
  1740                                                                     CL**2
  1741***************    OUTPUT FROM ELEARN   *************************    CL**2
  1742                                                                     CL**2
  1743         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1744                                     COMP-3.                         CL**2
  1745         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1746                                     COMP-3.                         CL**2
  1747         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1748                                     COMP-3.                         CL**2
  1749         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1750                                     COMP-3.                         CL**2
  1751         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1752                                     COMP-3.                         CL**2
  1753         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1754                                     COMP-3.                         CL**2
  1755         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1756           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1757           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1758           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1759           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1760           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1761           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1762           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1763           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1764           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1765         16  FILLER                PIC X(12).                        CL**2
  1766                                                                     CL**2
  1767***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1768                                                                     CL**2
  1769         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1770                                     COMP-3.                         CL**2
  1771         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1772                                     COMP-3.                         CL**2
  1773         16  FILLER                PIC X(12).                        CL**2
  1774                                                                     CL**2
  1775***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  37
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1776         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1777                                     COMP-3.                         CL**2
  1778         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1779                                     COMP-3.                         CL**2
  1780         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1781                                     COMP-3.                         CL**2
  1782         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1783                                     COMP-3.                         CL**2
  1784         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1785                                     COMP-3.                         CL**2
  1786         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1787                                     COMP-3.                         CL**2
  1788         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1789             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1790             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1791             88  IO-ERROR                         VALUE 'E'.         CL**2
  1792                                                                     CL**2
  1793         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1794                                                                     CL**2
  1795         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1796                                                                     CL**2
  1797         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1798                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1799                                     COMP-3.                         CL**2
  1800                                                                     CL**2
  1801         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1802                                                                     CL**2
  1803         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1804                                     COMP-3.                         CL**2
  1805                                                                     CL**2
  1806         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1807                                     COMP-3.                         CL**2
  1808                                                                     CL**2
  1809         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1810                                     COMP-3.                         CL**2
  1811                                                                     CL**2
  1812         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1813                                     COMP-3.                         CL**2
  1814                                                                     CL**2
  1815         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1816                                     COMP-3.                         CL**2
  1817                                                                     CL**2
  1818         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1819                                     COMP-3.                         CL**2
  1820                                                                     CL**2
  1821         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1822                                     COMP-3.                         CL**2
  1823                                                                     CL**2
  1824         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1825             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1826                                                                     CL**2
  1827         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1828                                     COMP-3.                         CL**2
  1829         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1830                                     COMP-3.
  1831         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1832         16  FILLER                PIC X(15).                        CL**2
  1833******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  38
* ECS056.cbl
  1834/
* 1835                                 COPY ELCDATE.
  1836******************************************************************06/11/98
  1837*                                                                *ELCDATE
  1838*                                                                *ELCDATE
  1839*                            ELCDATE.                            *   LV023
  1840*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1841*                            VMOD=2.003                           ELCDATE
  1842*                                                                *ELCDATE
  1843*                                                                *ELCDATE
  1844*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1845*                 LENGTH = 200                                   *   CL*19
  1846******************************************************************ELCDATE
  1847                                                                  ELCDATE
  1848 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1849     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1850     12  DC-OPTION-CODE                PIC X.                        CL*15
  1851         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1852         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1853         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1854         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1855         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1856         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1857         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1858         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1859         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1860         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1861         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1862         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1863         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1864         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1865         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1866         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1867         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1868         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1869         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1870         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1871         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1872         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1873         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1874         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1875         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1876         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1877         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1878         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1879         88  THREE-CHARACTER-BIN                                  ELCDATE
  1880                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1881         88  GREGORIAN-TO-BIN                                        CL**2
  1882                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1883         88  BIN-TO-GREGORIAN                                        CL**2
  1884                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1885         88  JULIAN-TO-BINARY                                        CL**2
  1886                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1887     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1888         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1889         88  DATE-CONVERSION-ERROR                                ELCDATE
  1890                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1891         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  39
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1892         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1893         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1894         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1895         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1896         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1897         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1898         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1899         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1900         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1901     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1902         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1903     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1904         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1905         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1906         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1907     12  FILLER                        PIC X.                        CL*15
  1908     12  DC-CONVERSION-DATES.                                        CL*15
  1909         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1910         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1911         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1912         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1913                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1914             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1915             20  SLASH1-1              PIC X.                        CL*15
  1916             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1917             20  SLASH1-2              PIC X.                        CL*15
  1918             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1919         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1920         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1921                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1922             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1923             20  SLASH2-1              PIC X.                        CL*15
  1924             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1925             20  SLASH2-2              PIC X.                        CL*15
  1926             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1927         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1928         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1929                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1930             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1931             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1932             20  DC-YMD-DAY            PIC 99.                       CL*15
  1933         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1934         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1935                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1936             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1937             20  DC-MDY-DAY            PIC 99.                       CL*15
  1938             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1939         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1940             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1941             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1942             20  FILLER                PIC XX.                       CL*15
  1943             20  DC-ALPHA-CENTURY.                                   CL*15
  1944                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1945             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1946         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1947         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1948         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1949         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  40
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1950         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1951                                       PIC 9(05).                    CL*20
  1952         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1953             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1954             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1955         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1956         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1957         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1958     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1959         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1960         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1961             20  FILLER                PIC 9(3).                     CL*15
  1962             20  HOLD-CEN-1-CCYY.                                    CL*15
  1963                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1964                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1965             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1966             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1967         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1968             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1969             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1970             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1971                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1972                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1973             20  FILLER                PIC 9(3).                     CL*15
  1974         16  HOLD-CENTURY-1-X.                                       CL*15
  1975             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1976             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1977                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1978                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1979             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1980             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1981         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1982             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1983             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1984             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1985                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1986                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1987             20  FILLER                PIC XXX.                      CL*23
  1988         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1989         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1990         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1991         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1992             20  DC-JULIAN-1-CCYY.                                   CL*15
  1993                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1994                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1995             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1996         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1997         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1998             20  DC-JULIAN-2-CCYY.                                   CL*15
  1999                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2000                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2001             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2002         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2003             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2004             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2005             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2006             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2007             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  41
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2008                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  2009                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2010         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2011             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2012             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2013             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2014             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2015             20  DC-EDITB-CCYY.                                      CL*15
  2016                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2017                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2018         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2019         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2020                              DC-GREG-DATE-CYMD.                  ELCDATE
  2021             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2022             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2023             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2024             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2025         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2026         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2027                              DC-GREG-DATE-MDCY.                  ELCDATE
  2028             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2029             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2030             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2031             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2032    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2033        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2034    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2035    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  42
* ECS056.cbl
  2036/
* 2037                                 COPY ELCDTECX.
  2038******************************************************************06/05/98
  2039*                                                                *ELCDTECX
  2040*                            ELCDTECX.                           *   LV005
  2041*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2042*                            VMOD=2.015                          *ELCDTECX
  2043*                                                                *ELCDTECX
  2044*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  2045*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  2046*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  2047*                                                                *ELCDTECX
  2048******************************************************************ELCDTECX
  2049******************************************************************
  2050*                   C H A N G E   L O G
  2051*
  2052* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2053*-----------------------------------------------------------------
  2054*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2055* EFFECTIVE    NUMBER
  2056*-----------------------------------------------------------------
  2057* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  2058*                                  BENEFIT CODES FROM 300 TO 900
  2059* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  2060* 051304    2003080800002  SMVA  ADD REFUND METHOD
  2061******************************************************************
  2062 01  DATE-CARD.                                                   ELCDTECX
  2063     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  2064     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  2065     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  2066     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  2067     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  2068     12  EP-SW                       PIC  X.                      ELCDTECX
  2069         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  2070     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  2071         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  2072     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  2073     12  RUN-CENTURY.                                             ELCDTECX
  2074         16 RUN-CENTURY-N            PIC  99.                        CL**4
  2075     12  FILLER                      PIC  X.                         CL**4
  2076     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  2077     12  FILLER                      PIC  XXX.                    ELCDTECX
  2078     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  2079                                                                  ELCDTECX
  2080 01  FILLER                          PIC  X(7)                       CL**6
  2081                                          VALUE 'OPTIONS'.        ELCDTECX
  2082 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  2083     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  2084     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  2085     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  2086         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  2087         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  2088     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  2089     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  2090     12  FILLER                      PIC  X.                      ELCDTECX
  2091     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  2092     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  2093     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  43
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2094     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  2095     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  2096     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  2097     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  2098     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  2099     12  FILLER                      PIC  X.                      ELCDTECX
  2100     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  2101     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  2102     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2103     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2104     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2105     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2106     12  FILLER                      PIC  X.                      ELCDTECX
  2107     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2108     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2109     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2110     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2111     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2112     12  DTE-R78                     PIC  X.                      ELCDTECX
  2113     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2114     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2115     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2116     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2117     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2118     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2119     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2120                                     PIC  X.                      ELCDTECX
  2121         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2122                                                 ' '.             ELCDTECX
  2123         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2124         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2125     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2126         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2127         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2128     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2129     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2130                                     PIC  9.                         CL**4
  2131     12  DTE-SYSTEM.                                              ELCDTECX
  2132         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2133         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2134         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2135         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2136         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2137         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2138         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  2139         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  2140         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  2141         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  2142         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  2143         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  2144         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  2145         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  2146         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  2147         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  2148         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  2149         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  2150         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  2151         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  44
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2152         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  2153         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  2154         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  2155         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  2156         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  2157         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  2158     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  2159         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  2160                                     PIC  X.                      ELCDTECX
  2161     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  2162                                                                  ELCDTECX
  2163 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  2164     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  2165     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  2166     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  2167*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  2168     12  FILLER                      PIC  X.                      ELCDTECX
  2169     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  2170     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  2171     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  2172     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  2173     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  2174     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  2175     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  2176                                                                  ELCDTECX
  2177     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  2178     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  2179     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  2180     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  2181                                                                  ELCDTECX
  2182     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  2183     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  2184     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  2185     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  2186                                                                  ELCDTECX
  2187     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  2188     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  2189                                                                  ELCDTECX
  2190     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  2191     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  2192                                                                  ELCDTECX
  2193     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  2194                                                                  ELCDTECX
  2195 01  DATE-CARD-FACTORS.                                           ELCDTECX
  2196     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  2197     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  2198     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  2199     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  2200     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  2201     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  2202     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  2203                                                                  ELCDTECX
  2204 01  FILLER                          PIC  X(12)                   ELCDTECX
  2205                                          VALUE 'COMPANY NAME'.   ELCDTECX
  2206 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  2207     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  2208         16  CNT-ID                  PIC  X.                      ELCDTECX
  2209         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  45
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2210                                                                  ELCDTECX
  2211 01  FILLER                          PIC  X(11)                   ELCDTECX
  2212                                          VALUE 'STATE NAMES'.    ELCDTECX
  2213 01  STATE-NAMES.                                                 ELCDTECX
  2214     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  2215         16  STATE-SUB               PIC  XX.                     ELCDTECX
  2216         16  STATE-PIC1.                                          ELCDTECX
  2217             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  2218             20  FILLER              PIC  XXX.                    ELCDTECX
  2219             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  2220             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  2221             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  2222             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2223                                                                  ELCDTECX
  2224 01  FILLER                          PIC  X(13)                   ELCDTECX
  2225                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2226 01  CARRIER-NAMES.                                               ELCDTECX
  2227     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2228         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2229         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2230         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2231         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2232         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2233         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2234*        16  FILLER                  PIC  X.                      ELCDTECX
  2235         16  CARRIER-SEC-PAY         PIC  X.
  2236             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2237                                                                  ELCDTECX
  2238 01  FILLER                          PIC  X(9)                       CL**6
  2239                                          VALUE 'INS TYPES'.      ELCDTECX
  2240 01  CLAS-INS-TYPES.                                              ELCDTECX
  2241*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2242     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2243         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2244         16  CLAS-I-AB3.                                          ELCDTECX
  2245             20  FILLER              PIC  X.                      ELCDTECX
  2246             20  CLAS-I-AB2.                                      ELCDTECX
  2247                 24  FILLER          PIC  X.                      ELCDTECX
  2248                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2249         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2250             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2251             20  FILLER              PIC  X.                         CL**4
  2252         16  CLAS-I-AB10.                                         ELCDTECX
  2253             20  FILLER              PIC  X(9).                   ELCDTECX
  2254             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2255         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2256         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2257         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2258         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2259             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2260         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2261         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2262         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2263         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2264         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  2265         16  FILLER                  PIC  X(05).
  2266                                                                  ELCDTECX
  2267 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  46
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2268                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2269 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2270     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2271                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2272         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2273         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2274         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2275         16  CLAS-MORT-DESC.                                      ELCDTECX
  2276             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2277             20  FILLER              PIC  XX.                        CL**5
  2278             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2279             20  FILLER              PIC  X.                         CL**5
  2280             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2281             20  FILLER              PIC  X.                         CL**5
  2282             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2283             20  FILLER              PIC  X.                         CL**5
  2284             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2285             20  FILLER              PIC  X(5).                      CL**6
  2286                                                                  ELCDTECX
  2287 01  FILLER                          PIC  X(15)                   ELCDTECX
  2288                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2289 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2290     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2291         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2292         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2293         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2294         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2295         16  FILLER                  PIC  X(4).                      CL**6
  2296                                                                  ELCDTECX
  2297 01  FILLER                          PIC  X(7)                       CL**6
  2298                                     VALUE 'INDEXES'.             ELCDTECX
  2299 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2300     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2301     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2302     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2303     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2304     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2305     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2306     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2307     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2308     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2309     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2310     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2311     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2312     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2313     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2314     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2315     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2316     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2317                                                                  ELCDTECX
  2318 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2319     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2320     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2321     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2322     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2323     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2324     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2325     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  47
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2326     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2327     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2328     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2329     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2330                                                                  ELCDTECX
  2331 01  FILLER                          PIC  X(13)                   ELCDTECX
  2332                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2333 01  CLAS-MISC.                                                   ELCDTECX
  2334     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2335         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2336         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2337         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2338     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2339     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2340     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2341     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2342     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2343     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2344     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2345     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2346     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2347     12  STATE-L                     PIC  XX.                     ELCDTECX
  2348     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2349     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2350     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2351         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2352         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2353     12  DTE-ABEND-WORK.                                          ELCDTECX
  2354         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2355         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2356                                                                  ELCDTECX
  2357 01  FILLER                          PIC  X(12)                   ELCDTECX
  2358                                     VALUE 'WORKING DATE'.        ELCDTECX
  2359 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2360     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2361         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2362         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2363         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2364     12  WS-CURRENT-DATE.                                         ELCDTECX
  2365         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2366         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2367         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2368         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2369         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2370     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2371         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2372         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2373                                                                  ELCDTECX
  2374 01  FILLER                          PIC  X(12)                   ELCDTECX
  2375                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2376 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2377     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2378         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2379         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2380         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2381                                                                  ELCDTECX
  2382 01  FILLER                          PIC  X(10)                   ELCDTECX
  2383                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  48
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2384 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2385     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2386         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2387         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2388                                                                  ELCDTECX
  2389 01  FILLER                          PIC  X(13)                   ELCDTECX
  2390                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2391 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2392     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2393         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2394                                                                  ELCDTECX
  2395 01  FILLER                          PIC  X(13)                   ELCDTECX
  2396                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2397 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2398     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2399     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2400     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2401                                     PIC  X.                         CL**5
  2402     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2403     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2404     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2405     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2406     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2407     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2408     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2409     12  FILLER                      PIC  X(75).                  ELCDTECX
  2410******************************************************************ELCDTECX
  2411*01  MISC-CARR-PCT-DATA.                                          00001521
  2412*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2413*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2414*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2415*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2416*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2417*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2418******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  49
* ECS056.cbl
  2419/
* 2420                                 COPY ELCDTEVR.
  2421***************************************************************** 04/15/98
  2422*                                                                *ELCDTEVR
  2423*                                                                *ELCDTEVR
  2424*                            ELCDTEVR.                           *   LV003
  2425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2426*                            VMOD=2.001                          *   CL**2
  2427*                                                                *ELCDTEVR
  2428*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2429*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2430*                                                                *ELCDTEVR
  2431******************************************************************ELCDTEVR
  2432 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2433     05  WS-RUN-DATE.                                             ELCDTEVR
  2434         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2435         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2436         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2437             15  RUN-CC              PIC  99.                     ELCDTEVR
  2438             15  RUN-YR              PIC  99.                     ELCDTEVR
  2439         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2440         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2441     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2442            WS-RUN-DATE              PIC 9(11).                      CL**2
  2443     05  WS-EP-DT.                                                ELCDTEVR
  2444         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2445         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2446         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2447             15  EP-CC               PIC  99.                     ELCDTEVR
  2448             15  EP-YR               PIC  99.                     ELCDTEVR
  2449         10  EP-MO                   PIC  99.                     ELCDTEVR
  2450         10  EP-DA                   PIC  99.                     ELCDTEVR
  2451     05  WS-EP-DT-N REDEFINES                                        CL**2
  2452            WS-EP-DT                 PIC 9(11).                      CL**2
  2453     05  WS-DTE-CONV-DT.                                             CL**4
  2454         10  FILLER                  PIC  9(03).                     CL**4
  2455         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2456         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2457             15  DTE-CONV-CC         PIC  99.                        CL**4
  2458             15  DTE-CONV-YR         PIC  99.                        CL**4
  2459         10  DTE-CONV-MO             PIC  99.                        CL**4
  2460         10  DTE-CONV-DA             PIC  99.                        CL**4
  2461     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2462            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2463 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2464     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2465         10  FILLER                            PIC 999.           ELCDTEVR
  2466         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2467         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2468             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2469             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2470         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2471         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2472     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2473            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2474     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2475         10  FILLER                            PIC 999.           ELCDTEVR
  2476         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  50
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2477         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2478         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2479         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2480     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2481            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2482 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2483     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2484         10  FILLER                            PIC 999.           ELCDTEVR
  2485         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2486         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2487             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2488             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2489         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2490         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2491     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2492            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2493     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2494         10  FILLER                            PIC 999.           ELCDTEVR
  2495         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2496         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2497             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2498             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2499         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2500         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2501     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2502            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2503     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2504         10  FILLER                            PIC 999.           ELCDTEVR
  2505         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2506         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2507             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2508             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2509         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2510         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2511     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2512            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2513 01  WS-RATE-RECORD.                                              ELCDTEVR
  2514         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2515             10  FILLER                        PIC 999.           ELCDTEVR
  2516             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2517             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2518                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2519                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2520             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2521             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2522         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2523                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  51
* ECS056.cbl
  2524/
  2525 PROCEDURE DIVISION.
  2526
  2527 0001-DT-CRD-READ SECTION.
* 2528                                 COPY ELCDTERX.
  2529******************************************************************04/15/98
  2530*                                                                *ELCDTERX
  2531*                                                                *ELCDTERX
  2532*                            ELCDTERX.                           *   LV002
  2533*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2534*                            VMOD=2.007                          *ELCDTERX
  2535*                                                                *ELCDTERX
  2536*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2537*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2538*      = ELCDTEFD)                                               *ELCDTERX
  2539*                                                                *ELCDTERX
  2540******************************************************************ELCDTERX
  2541                                                                  ELCDTERX
  2542     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2543                                                                  ELCDTERX
  2544     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2545     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2546     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2547                                                                  ELCDTERX
  2548     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2549                                                                  ELCDTERX
  2550******************************************************************ELCDTERX
  2551*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2552*          WARNING MESSAGES.                                      ELCDTERX
  2553******************************************************************ELCDTERX
  2554     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2555         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2556                                                                  ELCDTERX
  2557     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2558                                                                  ELCDTERX
  2559     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2560                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2561                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2562                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2563                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2564                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2565                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2566                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2567                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2568                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2569                                                                  ELCDTERX
  2570     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2571                                                                  ELCDTERX
  2572     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2573                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2574                                                                  ELCDTERX
  2575     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2576     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2577     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2578     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2579                                                                  ELCDTERX
  2580     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2581         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  52
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2582     ELSE                                                         ELCDTERX
  2583         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2584                                                                  ELCDTERX
  2585     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2586         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2587     ELSE                                                         ELCDTERX
  2588         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2589                                                                  ELCDTERX
  2590 0005-READ--CARD.                                                 ELCDTERX
  2591     READ DISK-DATE                                               ELCDTERX
  2592         AT END CLOSE DISK-DATE                                   ELCDTERX
  2593             GO TO 0060-READ--TEST.                               ELCDTERX
  2594                                                                  ELCDTERX
  2595     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2596                                                                  ELCDTERX
  2597     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2598         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2599         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2600         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2601         GO TO 0005-READ--CARD.                                   ELCDTERX
  2602                                                                  ELCDTERX
  2603     IF DD-ID = 'CLAD'                                            ELCDTERX
  2604         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2605         GO TO 0005-READ--CARD.                                   ELCDTERX
  2606                                                                  ELCDTERX
  2607     IF DD-ID = 'CLAX'                                            ELCDTERX
  2608         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2609         GO TO 0005-READ--CARD.                                   ELCDTERX
  2610                                                                  ELCDTERX
  2611     IF DD-ID = 'CLAF'                                            ELCDTERX
  2612         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2613         GO TO 0005-READ--CARD.                                   ELCDTERX
  2614                                                                  ELCDTERX
  2615     IF DD-ID = 'CLAC'                                            ELCDTERX
  2616         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2617                                                                  ELCDTERX
  2618     IF DD-ID = 'CARR'                                            ELCDTERX
  2619         GO TO 0015-READ--CARR.                                   ELCDTERX
  2620                                                                  ELCDTERX
  2621     IF DD-ID = 'STAT'                                            ELCDTERX
  2622         GO TO 0020-READ--STAT.                                   ELCDTERX
  2623                                                                  ELCDTERX
  2624     IF DD-ID = 'BUSC'                                            ELCDTERX
  2625         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2626                                                                  ELCDTERX
  2627     IF DD-ID = 'MORT'                                            ELCDTERX
  2628         GO TO 0030-READ--MORT.                                   ELCDTERX
  2629                                                                  ELCDTERX
  2630     IF DD-ID = 'CLAI'                                            ELCDTERX
  2631         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2632                                                                  ELCDTERX
  2633     IF DD-ID = 'COLC'                                            ELCDTERX
  2634         GO TO 0065-READ--COLC.                                   ELCDTERX
  2635                                                                  ELCDTERX
  2636     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2637        DD-IDA = 'CL'                                             ELCDTERX
  2638         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2639                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  53
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2640     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2641        DD-IDA = 'PO'                                             ELCDTERX
  2642         GO TO 0050-READ--POXX.                                   ELCDTERX
  2643                                                                  ELCDTERX
  2644     IF DD-ID = 'OPCA'                                            ELCDTERX
  2645         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2646                                                                  ELCDTERX
  2647     IF DD-ID = 'OPST'                                            ELCDTERX
  2648         GO TO 0072-READ--OPST.                                   ELCDTERX
  2649                                                                  ELCDTERX
  2650     IF DD-ID = 'OPBS'                                            ELCDTERX
  2651         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2652                                                                  ELCDTERX
  2653     IF DD-ID = 'OPMS'                                            ELCDTERX
  2654         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2655                                                                  ELCDTERX
  2656     GO TO 0005-READ--CARD.                                       ELCDTERX
  2657                                                                  ELCDTERX
  2658 0010-READ--CLAC.                                                 ELCDTERX
  2659     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2660     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2661     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2662     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2663     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2664     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2665     GO TO 0005-READ--CARD.                                       ELCDTERX
  2666                                                                  ELCDTERX
  2667 0015-READ--CARR.                                                 ELCDTERX
  2668     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2669     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2670        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2671        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2672        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2673        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2674        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2675        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2676        MOVE DD-CARR1-SECPAY-SW
  2677                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2678     END-IF
  2679                                                                  ELCDTERX
  2680     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2681     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2682        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2683        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2684        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2685        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2686        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2687        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2688        MOVE DD-CARR2-SECPAY-SW
  2689                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2690     END-IF
  2691                                                                  ELCDTERX
  2692                                                                  ELCDTERX
  2693     GO TO 0005-READ--CARD.                                       ELCDTERX
  2694                                                                  ELCDTERX
  2695 0020-READ--STAT.                                                 ELCDTERX
  2696     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2697     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  54
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2698        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2699         GO TO 0005-READ--CARD.                                   ELCDTERX
  2700                                                                  ELCDTERX
  2701     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2702     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2703     GO TO 0020-READ--STAT.                                       ELCDTERX
  2704                                                                  ELCDTERX
  2705 0025-READ--BUSC.                                                 ELCDTERX
  2706     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2707     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2708        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2709         GO TO 0005-READ--CARD.                                   ELCDTERX
  2710                                                                  ELCDTERX
  2711     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2712     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2713     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2714                                                                  ELCDTERX
  2715 0030-READ--MORT.                                                 ELCDTERX
  2716     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2717     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2718        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2719         GO TO 0005-READ--CARD.                                   ELCDTERX
  2720                                                                  ELCDTERX
  2721     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2722     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2723     GO TO 0030-READ--MORT.                                       ELCDTERX
  2724                                                                  ELCDTERX
  2725 0035-READ--CLXX.                                                 ELCDTERX
  2726     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2727          GO TO 0005-READ--CARD.                                  ELCDTERX
  2728                                                                  ELCDTERX
  2729     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2730         DISPLAY '***********************************************'ELCDTERX
  2731         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2732         DISPLAY '***********************************************'ELCDTERX
  2733         GO TO 0055-READ--STOP.                                   ELCDTERX
  2734                                                                  ELCDTERX
  2735     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2736        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2737         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2738                                                                  ELCDTERX
  2739     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2740        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2741         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2742                                                                  ELCDTERX
  2743*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2744     GO TO 0005-READ--CARD.                                       ELCDTERX
  2745                                                                  ELCDTERX
  2746 0040-READ--CLAI.                                                 ELCDTERX
  2747     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2748     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2749        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2750         GO TO 0005-READ--CARD.                                   ELCDTERX
  2751                                                                  ELCDTERX
  2752     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2753     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2754     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2755                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  55
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2756 0045-READ--DUMP.                                                 ELCDTERX
  2757     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2758     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2759                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2760     PERFORM ABEND-PGM.                                           ELCDTERX
  2761                                                                  ELCDTERX
  2762 0050-READ--POXX.                                                 ELCDTERX
  2763     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2764         GO TO 0005-READ--CARD.                                   ELCDTERX
  2765                                                                  ELCDTERX
  2766     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2767         DISPLAY '***********************************************'ELCDTERX
  2768         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2769         DISPLAY '***********************************************'ELCDTERX
  2770         GO TO 0055-READ--STOP.                                   ELCDTERX
  2771                                                                  ELCDTERX
  2772     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2773     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2774     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2775     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2776                                                                  ELCDTERX
  2777     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2778         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2779     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2780         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2781                                                                  ELCDTERX
  2782     GO TO 0005-READ--CARD.                                       ELCDTERX
  2783                                                                  ELCDTERX
  2784 0055-READ--STOP.                                                 ELCDTERX
  2785     GOBACK.                                                      ELCDTERX
  2786                                                                  ELCDTERX
  2787 0060-READ--TEST.                                                 ELCDTERX
  2788     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2789        CLAX-ID         = SPACE  OR                               ELCDTERX
  2790        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2791         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2792                                                                  ELCDTERX
  2793     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2794     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2795                                                                  ELCDTERX
  2796 0065-READ--COLC.                                                 ELCDTERX
  2797     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2798     GO TO 0005-READ--CARD.                                       ELCDTERX
  2799                                                                  ELCDTERX
  2800 0070-READ--OPCA.                                                 ELCDTERX
  2801                                                                  ELCDTERX
  2802     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2803                                                                  ELCDTERX
  2804     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2805             OR                                                   ELCDTERX
  2806         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2807         GO TO 0005-READ--CARD.                                   ELCDTERX
  2808                                                                  ELCDTERX
  2809     ADD 1                       TO INDEXCA.                      ELCDTERX
  2810     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2811                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2812     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2813                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  56
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2814 0072-READ--OPST.                                                 ELCDTERX
  2815                                                                  ELCDTERX
  2816     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2817                                                                  ELCDTERX
  2818     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2819             OR                                                   ELCDTERX
  2820         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2821         GO TO 0005-READ--CARD.                                   ELCDTERX
  2822                                                                  ELCDTERX
  2823     ADD 1                       TO INDEXST.                      ELCDTERX
  2824     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2825                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2826     GO TO 0072-READ--OPST.                                       ELCDTERX
  2827                                                                  ELCDTERX
  2828 0074-READ--OPBS.                                                 ELCDTERX
  2829                                                                  ELCDTERX
  2830     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2831                                                                  ELCDTERX
  2832     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2833             OR                                                   ELCDTERX
  2834         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2835         GO TO 0005-READ--CARD.                                   ELCDTERX
  2836                                                                  ELCDTERX
  2837     ADD 1                       TO INDEXBS.                      ELCDTERX
  2838     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2839     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2840                                                                  ELCDTERX
  2841 0079-READ--EXIT.                                                 ELCDTERX
  2842*    EXIT.                                                        ELCDTERX
  2843******************************************************************ELCDTERX
  2844
  2845     MOVE COMPANY-NAME           TO  HD-CO
  2846     MOVE ALPH-DATE              TO  HD-DT
  2847     MOVE WS-CURRENT-DATE        TO  HD-RUN-DT
  2848     MOVE RUN-DATE               TO WS-THIS-MONTH-DATE
  2849
  2850     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  2851
  2852     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  2853
  2854     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  2855
  2856     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  2857
  2858     GOBACK
  2859     .
  2860
  2861 0010-INITIALIZE.
  2862
  2863     MOVE +0                     TO WS-EXP-PREM
  2864                                    WS-REC-PREM
  2865                                    WS-GA-COMM
  2866                                    WS-BASE-COMM
  2867                                    WS-REC-BASE-COMM
  2868
  2869     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  2870        (WS-A > +5)
  2871        MOVE +0                  TO WS-TOT-EXP-PREM (WS-A)
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  57
* ECS056.cbl
  2872                                    WS-TOT-REC-PREM (WS-A)
  2873                                    WS-TOT-GA-COMM (WS-A)
  2874     END-PERFORM
  2875     MOVE LOW-VALUES             TO WS-ERPYAJ-KEY
  2876
  2877     PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
  2878        (WS-PYAJ-INDEX > +500)
  2879        MOVE LOW-VALUES          TO WS-DA-KEY (WS-PYAJ-INDEX)
  2880        MOVE +0                  TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
  2881     END-PERFORM
  2882
  2883     MOVE +0                     TO WS-PYAJ-INDEX
  2884     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
  2885     MOVE -1                     TO DC-ELAPSED-MONTHS
  2886     MOVE '1'                    TO DC-END-OF-MONTH
  2887     MOVE +0                     TO DC-ELAPSED-DAYS
  2888     MOVE '6'                    TO DC-OPTION-CODE
  2889     PERFORM 8510-DATE-CONVERSION
  2890                                 THRU 8590-EXIT
  2891     IF NO-CONVERSION-ERROR
  2892        MOVE DC-GREG-DATE-CYMD   TO WS-LAST-MONTH-DATE
  2893        MOVE DC-BIN-DATE-2       TO WS-BIN-LAST-MONTH-DT
  2894        DISPLAY ' LAST MONTH IS ' WS-LAST-MONTH-DATE
  2895     ELSE
  2896        DISPLAY ' ERROR IN LAST MONTH DATE CONVERSION '
  2897     END-IF
  2898
  2899     MOVE RUN-DATE               TO WS-WORK-DATE
  2900     MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
  2901     MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
  2902
  2903     .
  2904
  2905 0010-EXIT.
  2906     EXIT.
  2907
  2908 0020-OPEN-FILES.
  2909
  2910     OPEN INPUT CERTS
  2911                ERPYAJ
  2912         OUTPUT EXTRACT PRINTX DEBUG-EXTRACT
  2913         I-O ERDUEP
  2914
  2915     IF ERDUEP-FILE-STATUS = '00' OR '97'
  2916        CONTINUE
  2917     ELSE
  2918        DISPLAY ' ERROR ON ERDUEP OPEN  '
  2919           ERDUEP-FILE-STATUS
  2920        MOVE ' ERROR ON ERDUEP OPEN  '
  2921                                 TO WS-ABEND-MESSAGE
  2922        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2923        PERFORM ABEND-PGM
  2924     END-IF
  2925
  2926     IF ERPYAJ-FILE-STATUS = '00' OR '97'
  2927        CONTINUE
  2928     ELSE
  2929        DISPLAY ' ERROR ON ERPYAJ OPEN  '
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  58
* ECS056.cbl
  2930           ERPYAJ-FILE-STATUS
  2931        MOVE ' ERROR ON ERPYAJ OPEN  '
  2932                                 TO WS-ABEND-MESSAGE
  2933        MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2934        PERFORM ABEND-PGM
  2935     END-IF
  2936
  2937     MOVE SPACES                 TO EXTRACT-RECORD
  2938     MOVE ';'                    TO WS-TAB1  WS-TAB2  WS-TAB3
  2939                                    WS-TAB4  WS-TAB5  WS-TAB6
  2940                                    WS-TAB7  WS-TAB8  WS-TAB9
  2941                                    WS-TAB10 WS-TAB11 WS-TAB12
  2942                                    WS-TAB13 WS-TAB14 WS-TAB15
  2943                                    WS-TAB16 WS-TAB17 WS-TAB18
  2944                                    WS-TAB19 WS-TAB20 WS-TAB21
  2945                                    WS-TAB22 WS-TAB23
  2946
  2947     MOVE ZEROS                  TO EXT-MISC1
  2948                                    EXT-MISC2
  2949                                    EXT-MISC3
  2950                                    EXT-MISC4
  2951                                    EXT-MISC5
  2952
  2953     MOVE EXTRACT-RECORD         TO WS-INIT-EXTRACT
  2954
  2955     MOVE SPACES                 TO DEBUG-EXTRACT-RECORD
  2956     MOVE ';'                    TO DB-TAB1  DB-TAB2  DB-TAB3
  2957                                    DB-TAB4  DB-TAB5  DB-TAB6
  2958                                    DB-TAB7  DB-TAB8  DB-TAB9
  2959                                    DB-TAB10 DB-TAB11 DB-TAB12
  2960                                    DB-TAB13 DB-TAB14 DB-TAB15
  2961                                    DB-TAB16 DB-TAB17
  2962
  2963     MOVE DEBUG-EXTRACT-RECORD   TO WS-INIT-DB-EXTRACT
  2964
  2965     .
  2966 0020-EXIT.
  2967     EXIT.
  2968
  2969 0030-CLOSE-FILES.
  2970
  2971     DISPLAY ' MADE IT TO CLOSE FILES '
  2972     CLOSE CERTS PRINTX
  2973         EXTRACT ERDUEP DEBUG-EXTRACT
  2974
  2975     IF ERDUEP-FILE-STATUS = '00' OR '97'
  2976        CONTINUE
  2977     ELSE
  2978        DISPLAY ' ERROR ON ERDUEP CLOSE '
  2979           ERDUEP-FILE-STATUS
  2980        MOVE ' ERROR ON ERDUEP OPEN  '
  2981                                 TO WS-ABEND-MESSAGE
  2982        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2983        PERFORM ABEND-PGM
  2984     END-IF
  2985
  2986
  2987     .
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  59
* ECS056.cbl
  2988
  2989 0030-EXIT.
  2990     EXIT.
  2991
  2992 0042-START-ERPYAJ.
  2993
  2994     MOVE LOW-VALUES             TO PY-CONTROL-PRIMARY
  2995     MOVE DTE-CLASIC-COMPANY-CD  TO PY-COMPANY-CD
  2996
  2997     START ERPYAJ KEY IS NOT < PY-CONTROL-PRIMARY
  2998
  2999     IF ERPYAJ-FILE-STATUS = '10' OR '23'
  3000        SET END-OF-FILE          TO TRUE
  3001     ELSE
  3002        IF ERPYAJ-FILE-STATUS NOT = '00'
  3003           MOVE ' ERROR ON ERPYAJ START '
  3004                                 TO WS-ABEND-MESSAGE
  3005           MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3006           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3007           PERFORM ABEND-PGM
  3008        ELSE
  3009           DISPLAY ' GOOD START ON ERPYAJ '
  3010        END-IF
  3011     END-IF
  3012
  3013     .
  3014 0042-EXIT.
  3015     EXIT.
  3016
  3017 0043-READ-ERPYAJ.
  3018
  3019     READ ERPYAJ NEXT RECORD
  3020
  3021     IF (ERPYAJ-FILE-STATUS = '10' OR '23')
  3022        OR (PY-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
  3023        SET END-OF-FILE          TO TRUE
  3024     ELSE
  3025        IF ERPYAJ-FILE-STATUS NOT = '00'
  3026           MOVE ' ERROR ON ERPYAJ READ  '
  3027                                 TO WS-ABEND-MESSAGE
  3028           MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3029           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3030           PERFORM ABEND-PGM
  3031        ELSE
  3032           DISPLAY ' GOOD READ ON ERPYAJ ' PY-CONTROL-PRIMARY
  3033        END-IF
  3034     END-IF
  3035
  3036     .
  3037 0043-EXIT.
  3038     EXIT.
  3039
  3040 0045-PROCESS-ERPYAJ.
  3041
  3042     IF PY-RECORD-TYPE = 'P'
  3043        ADD +1                   TO WS-PYAJ-INDEX
  3044        MOVE PY-CONTROL-PRIMARY  TO WS-DA-KEY (WS-PYAJ-INDEX)
  3045        MOVE PY-ENTRY-AMT        TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  60
* ECS056.cbl
  3046*       DISPLAY ' FOUND A HIT '
  3047     END-IF
  3048
  3049     PERFORM 0043-READ-ERPYAJ    THRU 0043-EXIT
  3050
  3051     .
  3052 0045-EXIT.
  3053     EXIT.
  3054
  3055 0050-PROCESS-FILE.
  3056
  3057     PERFORM 0042-START-ERPYAJ   THRU 0042-EXIT
  3058     IF NOT END-OF-FILE
  3059        PERFORM 0043-READ-ERPYAJ THRU 0043-EXIT
  3060     END-IF
  3061
  3062     PERFORM 0045-PROCESS-ERPYAJ THRU 0045-EXIT UNTIL
  3063        END-OF-FILE
  3064     MOVE WS-PYAJ-INDEX          TO WS-PYAJ-MAX
  3065
  3066     CLOSE ERPYAJ
  3067
  3068     IF ERPYAJ-FILE-STATUS = '00' OR '97'
  3069        CONTINUE
  3070     ELSE
  3071        MOVE ' ERROR ON ERPYAJ CLOSE '
  3072                                 TO WS-ABEND-MESSAGE
  3073        MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3074        DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3075        PERFORM ABEND-PGM
  3076     END-IF
  3077
  3078     SET MORE-RECORDS            TO TRUE
  3079     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3080     MOVE CR-ACCT-CONTROL        TO WS-HOLD-CONTROL
  3081     PERFORM 0080-PROCESS-CERT   THRU 0080-EXIT UNTIL
  3082           END-OF-FILE
  3083
  3084     PERFORM 0150-UPDATE-DUEP    THRU 0150-EXIT
  3085     PERFORM 0300-ACCT-BREAK     THRU 0300-EXIT
  3086     PERFORM 0310-ST-BREAK       THRU 0310-EXIT
  3087     PERFORM 0320-GRP-BREAK      THRU 0320-EXIT
  3088     PERFORM 0330-CAR-BREAK      THRU 0330-EXIT
  3089     PERFORM 0340-FIN-BREAK      THRU 0340-EXIT
  3090
  3091     .
  3092
  3093 0050-EXIT.
  3094     EXIT.
  3095
  3096 0060-READ-CERT.
  3097
  3098     READ CERTS AT END
  3099         SET END-OF-FILE         TO TRUE
  3100     END-READ
  3101
  3102     IF NOT END-OF-FILE
  3103        ADD +1                   TO CERT-IN-CNT
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  61
* ECS056.cbl
  3104        MOVE ' '                 TO WS-GIANT-SW
  3105     END-IF
  3106     .
  3107
  3108 0060-EXIT.
  3109     EXIT.
  3110
  3111 0080-PROCESS-CERT.
  3112
  3113     IF CR-LFTYP NOT = '  ' AND ZEROS
  3114        PERFORM 0207-FIND-LIFE-TYPE
  3115                                 THRU 0207-EXIT
  3116     END-IF
  3117
  3118     IF CR-AHTYP NOT = '  ' AND ZEROS
  3119        PERFORM 0208-FIND-AH-TYPE
  3120                                 THRU 0208-EXIT
  3121     END-IF
  3122
  3123     IF (CR-LFTYP = 'MJ' OR 'MS'
  3124         OR 'NJ' OR 'NL'
  3125         OR 'PL' OR 'PJ'
  3126         OR 'SJ' OR 'SL')
  3127        OR (CR-AHTYP =
  3128               'MJ' OR 'MS' OR 'MI' OR 'MU'
  3129            OR 'NI' OR 'NJ' OR 'NL' OR 'NU'
  3130            OR 'PI' OR 'PJ' OR 'PL' OR 'PU'
  3131            OR 'SI' OR 'SJ' OR 'SL' OR 'SU'
  3132            OR 'MX' OR 'MY' OR 'MZ')
  3133        IF (CR-ENTRY-DATE = WS-THIS-MONTH-DATE)
  3134           OR (CR-LF-CANCEL-EXIT-DATE = WS-THIS-MONTH-DATE)
  3135           OR (CR-AH-CANCEL-EXIT-DATE = WS-THIS-MONTH-DATE)
  3136           SET THIS-IS-A-GIANT-CERT TO TRUE
  3137        ELSE
  3138           MOVE 'V'              TO CR-ENTRY-STATUS
  3139        END-IF
  3140     END-IF
  3141
  3142     IF CR-ACCT-CONTROL NOT = WS-HOLD-CONTROL
  3143        PERFORM 0250-BREAK-RTN   THRU 0250-EXIT
  3144     END-IF
  3145
  3146     MOVE CR-ACCT-CONTROL        TO WS-HOLD-CONTROL
  3147     MOVE CR-DT                  TO WS-ISSUE-DATE
  3148
  3149     IF (CR-ENTRY-STATUS = '9' OR 'D' OR 'V')
  3150                 OR
  3151        ((CR-LFTYP (1:1) NOT = 'M' AND 'N' AND 'P' AND 'S')
  3152        AND (CR-AHTYP (1:1) NOT = 'M' AND 'N' AND 'P' AND 'S'))
  3153        CONTINUE
  3154     ELSE
  3155        IF CR-ENTRY-STATUS NOT = '5'
  3156           PERFORM 0200-CALC-UEP THRU 0200-EXIT
  3157           PERFORM 0090-FIND-ADJ THRU 0090-EXIT
  3158        END-IF
  3159     END-IF
  3160
  3161     IF (WS-EXP-PREM NOT = +0)
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  62
* ECS056.cbl
  3162        OR (WS-REC-PREM NOT = +0)
  3163        OR (WS-GA-COMM NOT = +0)
  3164        PERFORM 0100-WRITE-EXTRACT
  3165                                 THRU 0100-EXIT
  3166     END-IF
  3167
  3168     MOVE +0                     TO WS-EXP-PREM
  3169                                    WS-REC-PREM
  3170                                    WS-GA-COMM
  3171                                    WS-BASE-COMM
  3172                                    WS-REC-BASE-COMM
  3173
  3174     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3175
  3176     .
  3177
  3178 0080-EXIT.
  3179     EXIT.
  3180
  3181 0090-FIND-ADJ.
  3182
  3183     MOVE CR-COMPANY-CD          TO WS-PYAJ-MATCH-KEY (1:1)
  3184     MOVE CR-CARRIER             TO WS-PYAJ-MATCH-KEY (2:1)
  3185     MOVE CR-GROUPING            TO WS-PYAJ-MATCH-KEY (3:6)
  3186     IF CR-REMIT-TO NOT NUMERIC
  3187        MOVE ZEROS               TO CR-REMIT-TO
  3188     END-IF
  3189     IF CR-REMIT-TO = ZEROS
  3190        MOVE 01                  TO CR-REMIT-TO
  3191     END-IF
  3192     MOVE CR-COM-AGT (CR-REMIT-TO)
  3193                                 TO WS-PYAJ-MATCH-KEY (9:10)
  3194     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  3195        (WS-A > +10)
  3196        OR (CR-AGT-TYPE (WS-A) = 'D' OR 'C')
  3197     END-PERFORM
  3198
  3199     IF WS-A < +11
  3200        MOVE CR-COM-AGT (WS-A)   TO WS-PYAJ-MATCH-KEY (19:10)
  3201     ELSE
  3202        MOVE CR-ACCOUNT          TO WS-PYAJ-MATCH-KEY (19:10)
  3203     END-IF
  3204*    MOVE +0                     TO WS-DP-ADJ
  3205*    DISPLAY ' CERT KEY TO MATCH ' WS-PYAJ-MATCH-KEY
  3206     PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
  3207        (WS-PYAJ-INDEX > WS-PYAJ-MAX)
  3208        IF WS-DA-KEY (WS-PYAJ-INDEX) (1:28) = WS-PYAJ-MATCH-KEY
  3209           COMPUTE WS-DP-ADJ
  3210              = WS-DP-ADJ + WS-DA-AMOUNT (WS-PYAJ-INDEX)
  3211           MOVE LOW-VALUES       TO WS-DA-KEY (WS-PYAJ-INDEX)
  3212        END-IF
  3213     END-PERFORM
  3214
  3215     .
  3216 0090-EXIT.
  3217     EXIT.
  3218
  3219
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  63
* ECS056.cbl
  3220 0100-WRITE-EXTRACT.
  3221
  3222     MOVE WS-INIT-EXTRACT        TO EXTRACT-RECORD
  3223
  3224     COMPUTE WS-TOT-EXP-PREM (1) = WS-TOT-EXP-PREM (1)
  3225        + WS-EXP-PREM
  3226
  3227     COMPUTE WS-TOT-REC-PREM (1) = WS-TOT-REC-PREM (1)
  3228        + WS-REC-PREM
  3229
  3230     COMPUTE WS-TOT-BASE-COMM (1) = WS-TOT-BASE-COMM (1)
  3231        + WS-BASE-COMM
  3232
  3233     COMPUTE WS-TOT-GA-COMM (1) = WS-TOT-GA-COMM (1)
  3234        + WS-GA-COMM
  3235
  3236     MOVE CR-CARRIER             TO EXT-CAR
  3237     MOVE CR-GROUPING            TO EXT-GROUP
  3238     MOVE CR-STATE               TO EXT-STATE
  3239     MOVE CR-ACCOUNT             TO EXT-ACCOUNT
  3240     MOVE CR-DT                  TO WS-ISSUE-DATE
  3241     MOVE WS-ISSUE-MMDD (1:2)    TO EXT-EFF-DATE (1:2)
  3242     MOVE '-'                    TO EXT-EFF-DATE (3:1)
  3243                                    EXT-EFF-DATE (6:1)
  3244     MOVE WS-ISSUE-MMDD (3:2)    TO EXT-EFF-DATE (4:2)
  3245     MOVE WS-ISSUE-CCYY          TO EXT-EFF-DATE (7:4)
  3246     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  3247     MOVE WS-ENTRY-MMDD (1:2)    TO EXT-ENT-DATE (1:2)
  3248     MOVE '-'                    TO EXT-ENT-DATE (3:1)
  3249                                    EXT-ENT-DATE (6:1)
  3250     MOVE WS-ENTRY-MMDD (3:2)    TO EXT-ENT-DATE (4:2)
  3251     MOVE WS-ENTRY-CCYY          TO EXT-ENT-DATE (7:4)
  3252     MOVE RUN-DATE               TO WS-ENTRY-DATE
  3253     MOVE WS-ENTRY-MMDD (1:2)    TO EXT-VAL-DATE (1:2)
  3254     MOVE '-'                    TO EXT-VAL-DATE (3:1)
  3255                                    EXT-VAL-DATE (6:1)
  3256     MOVE WS-ENTRY-MMDD (3:2)    TO EXT-VAL-DATE (4:2)
  3257     MOVE WS-ENTRY-CCYY          TO EXT-VAL-DATE (7:4)
  3258
  3259     MOVE WS-EARN-TERM           TO EXT-EARN-TERM
  3260     MOVE CR-CERT-NO             TO EXT-CERT-NO
  3261     MOVE CR-LFTYP               TO EXT-LF-BEN-CODE
  3262     MOVE CR-AHTYP               TO EXT-AH-BEN-CODE
  3263     MOVE CR-LF-TERM             TO EXT-LF-TERM
  3264     MOVE CR-AH-TERM             TO EXT-AH-TERM
  3265     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  3266     MOVE WS-EXPIRE-MMDD (1:2)   TO EXT-LF-EXP-DATE (1:2)
  3267     MOVE '-'                    TO EXT-LF-EXP-DATE (3:1)
  3268                                    EXT-LF-EXP-DATE (6:1)
  3269     MOVE WS-EXPIRE-MMDD (3:2)   TO EXT-LF-EXP-DATE (4:2)
  3270     MOVE WS-EXPIRE-CCYY         TO EXT-LF-EXP-DATE (7:4)
  3271
  3272     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  3273     MOVE WS-EXPIRE-MMDD (1:2)   TO EXT-AH-EXP-DATE (1:2)
  3274     MOVE '-'                    TO EXT-AH-EXP-DATE (3:1)
  3275                                    EXT-AH-EXP-DATE (6:1)
  3276     MOVE WS-EXPIRE-MMDD (3:2)   TO EXT-AH-EXP-DATE (4:2)
  3277     MOVE WS-EXPIRE-CCYY         TO EXT-AH-EXP-DATE (7:4)
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  64
* ECS056.cbl
  3278     MOVE WS-EXP-PREM            TO EXT-EXP-PREM
  3279     MOVE WS-REC-PREM            TO EXT-REC-PREM
  3280     MOVE WS-BASE-COMM           TO EXT-BASE-COMM
  3281
  3282*    IF WS-BASE-COMM > ZEROS
  3283*       MOVE WS-BASE-COMM        TO EXT-BASE-COMM
  3284*    ELSE
  3285*       MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
  3286*    END-IF
  3287
  3288     MOVE WS-GA-COMM             TO EXT-GA-COMM
  3289
  3290     WRITE EXTRACT-RECORD
  3291     PERFORM 0125-ACCUM-DUEP     THRU 0125-EXIT
  3292
  3293     .
  3294
  3295 0100-EXIT.
  3296     EXIT.
  3297 0125-ACCUM-DUEP.
  3298
  3299     IF (WS-DUEP-CONTROL NOT = LOW-VALUES)
  3300        AND (WS-DUEP-CONTROL NOT = CR-ACCT-CONTROL)
  3301        PERFORM 0150-UPDATE-DUEP  THRU 0150-EXIT
  3302        MOVE +0                  TO WS-DP-REC-PREM
  3303                                    WS-DP-EXP-PREM
  3304                                    WS-DP-GA-COMM
  3305                                    WS-DP-BASE-COMM
  3306                                    WS-DP-ADJ
  3307     END-IF
  3308
  3309     MOVE CR-ACCT-CONTROL        TO WS-DUEP-CONTROL
  3310
  3311     COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM + WS-REC-PREM
  3312     COMPUTE WS-DP-EXP-PREM = WS-DP-EXP-PREM + WS-EXP-PREM
  3313     COMPUTE WS-DP-GA-COMM = WS-DP-GA-COMM + WS-GA-COMM
  3314     COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-BASE-COMM
  3315
  3316
  3317
  3318     .
  3319 0125-EXIT.
  3320     EXIT.
  3321
  3322 0150-UPDATE-DUEP.
  3323
  3324     MOVE DTE-CLASIC-COMPANY-CD  TO DP-COMPANY-CD
  3325     MOVE WS-DUEP-CONTROL        TO DP-ACCOUNT-CONTROL
  3326     MOVE LOW-VALUES             TO DP-KEY-FILLER
  3327     READ ERDUEP
  3328     IF ERDUEP-FILE-STATUS = '00'
  3329*       COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
  3330        MOVE WS-DP-REC-PREM      TO DP-REC-PREM
  3331        MOVE WS-DP-EXP-PREM      TO DP-EXP-PREM
  3332        MOVE WS-DP-GA-COMM       TO DP-GA-COMM
  3333        MOVE WS-DP-BASE-COMM     TO DP-BASE-COMM
  3334        MOVE WS-DP-ADJ           TO DP-ADJUSTMENTS
  3335        IF DP-LAST-MONTH-END-DT NOT = BIN-RUN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  65
* ECS056.cbl
  3336*  NEED TO THINK ABOUT THE AGEING STUFF RIGHT HERE
  3337           MOVE DP-END-BAL       TO DP-BAL-FWD
  3338           MOVE BIN-RUN-DATE     TO DP-LAST-MONTH-END-DT
  3339        END-IF
  3340        COMPUTE DP-END-BAL = DP-BAL-FWD + DP-EXP-PREM
  3341           - DP-REC-PREM + DP-ADJUSTMENTS
  3342        REWRITE DUE-PREMIUM-RECORD
  3343     ELSE
  3344        IF ERDUEP-FILE-STATUS = '23'
  3345           MOVE DTE-CLASIC-COMPANY-CD
  3346                                 TO DP-COMPANY-CD
  3347           MOVE WS-DUEP-CONTROL  TO DP-ACCOUNT-CONTROL
  3348           MOVE +0               TO DP-BAL-FWD
  3349                                    DP-ADJUSTMENTS
  3350                                    DP-END-BAL
  3351           MOVE WS-DP-REC-PREM   TO DP-REC-PREM
  3352           MOVE WS-DP-EXP-PREM   TO DP-EXP-PREM
  3353           MOVE WS-DP-GA-COMM    TO DP-GA-COMM
  3354           MOVE WS-DP-BASE-COMM  TO DP-BASE-COMM
  3355           MOVE WS-DP-ADJ        TO DP-ADJUSTMENTS
  3356           COMPUTE DP-END-BAL = DP-BAL-FWD + DP-EXP-PREM
  3357              - DP-REC-PREM + DP-ADJUSTMENTS
  3358           MOVE BIN-RUN-DATE     TO DP-LAST-MONTH-END-DT
  3359           WRITE DUE-PREMIUM-RECORD
  3360        END-IF
  3361     END-IF
  3362
  3363
  3364     .
  3365 0150-EXIT.
  3366     EXIT.
  3367
  3368
  3369 0200-CALC-UEP.
  3370
  3371     MOVE LOW-VALUES             TO WS-BIN-AH-END-DATE
  3372                                    WS-BIN-LF-END-DATE
  3373
  3374     IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3375        CONTINUE
  3376     ELSE
  3377        PERFORM VARYING CLAS-INDEXS FROM +1 BY +1 UNTIL
  3378            (CLAS-INDEXS = CLAS-MAXS) OR
  3379            CR-STATE = STATE-SUB (CLAS-INDEXS)
  3380        END-PERFORM
  3381        IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3382           CONTINUE
  3383        ELSE
  3384           DISPLAY 'STATE ' CR-STATE ' NOT IN TABLE'
  3385           MOVE 0302 TO WS-RETURN-CODE
  3386           PERFORM ABEND-PGM
  3387        END-IF
  3388     END-IF
  3389
  3390     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  3391     MOVE 'L'                    TO DC-OPTION-CODE
  3392     PERFORM 8510-DATE-CONVERSION
  3393                                 THRU 8590-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  66
* ECS056.cbl
  3394     MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  3395                                    WS-BIN-CR-DT
  3396
  3397     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  3398        MOVE ZEROS               TO CR-LOAN-1ST-PMT-DT
  3399     END-IF
  3400
  3401     MOVE LOW-VALUES             TO CP-FIRST-PAY-DATE
  3402
  3403     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  3404        MOVE CR-LOAN-1ST-PMT-DT  TO DC-GREG-DATE-1-YMD
  3405        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  3406                                    DC-ELAPSED-DAYS
  3407        MOVE '3'                 TO DC-OPTION-CODE
  3408        PERFORM 8510-DATE-CONVERSION
  3409                                 THRU 8590-EXIT
  3410        IF NO-CONVERSION-ERROR
  3411           MOVE DC-BIN-DATE-1   TO CP-FIRST-PAY-DATE
  3412                                   WS-BIN-1ST-DT
  3413        ELSE
  3414           MOVE ZEROS           TO CR-LOAN-1ST-PMT-DT
  3415        END-IF
  3416      END-IF
  3417
  3418     IF CP-FIRST-PAY-DATE  LESS THAN  CP-CERT-EFF-DT
  3419        MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT
  3420     END-IF
  3421
  3422     IF CR-LOAN-1ST-PMT-DT = ZEROS
  3423        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  3424        MOVE +1                  TO DC-ELAPSED-MONTHS
  3425        MOVE ZEROS               TO DC-ELAPSED-DAYS
  3426        MOVE '6'                 TO DC-OPTION-CODE
  3427        PERFORM 8510-DATE-CONVERSION
  3428                                 THRU 8590-EXIT
  3429        MOVE DC-BIN-DATE-2       TO CP-FIRST-PAY-DATE
  3430                                    WS-BIN-1ST-DT
  3431        MOVE DC-GREG-DATE-1-YMD  TO CR-LOAN-1ST-PMT-DT
  3432     END-IF
  3433
  3434     MOVE WS-BIN-CR-DT           TO DC-BIN-DATE-1
  3435     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-2
  3436     MOVE '1'                    TO DC-OPTION-CODE
  3437     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  3438                                    DC-ELAPSED-DAYS
  3439     PERFORM 8510-DATE-CONVERSION
  3440                                 THRU 8590-EXIT
  3441     IF NO-CONVERSION-ERROR
  3442        MOVE DC-ELAPSED-DAYS     TO WS-DAYS-TO-1ST
  3443     ELSE
  3444        MOVE +30                 TO WS-DAYS-TO-1ST
  3445     END-IF
  3446
  3447     MOVE CR-LF-EXPIRE-DATE      TO WS-WORK-DATE
  3448
  3449     MOVE LOW-VALUES             TO WS-BIN-LF-CAN-DATE
  3450     MOVE +0                     TO WS-LF-CAN-TERM
  3451     MOVE 'N'                    TO WS-LF-CAN-QUAL-SW
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  67
* ECS056.cbl
  3452
  3453     IF CR-LF-CANC-DT NOT = ZEROS
  3454        MOVE CR-LF-CANC-DT       TO DC-GREG-DATE-CYMD
  3455        MOVE 'L'                 TO DC-OPTION-CODE
  3456        PERFORM 8510-DATE-CONVERSION
  3457                                 THRU 8590-EXIT
  3458        IF NO-CONVERSION-ERROR
  3459           MOVE DC-BIN-DATE-1    TO WS-BIN-LF-CAN-DATE
  3460        ELSE
  3461           MOVE LOW-VALUES       TO WS-BIN-LF-CAN-DATE
  3462        END-IF
  3463        MOVE BIN-RUN-DATE        TO DC-BIN-DATE-2
  3464        MOVE '1'                 TO DC-OPTION-CODE
  3465        MOVE +0                  TO DC-ELAPSED-MONTHS
  3466                                    DC-ELAPSED-DAYS
  3467        PERFORM 8510-DATE-CONVERSION
  3468                                 THRU 8590-EXIT
  3469        IF NO-CONVERSION-ERROR
  3470           MOVE DC-ELAPSED-MONTHS
  3471                                 TO WS-LF-CAN-TERM
  3472           IF (WS-LF-CAN-TERM > +0)
  3473              AND (WS-BIN-LF-CAN-DATE > WS-BIN-1ST-DT)
  3474              SUBTRACT +1        FROM WS-LF-CAN-TERM
  3475           END-IF
  3476           IF (WS-LF-CAN-TERM > +0)
  3477              AND (WS-THIS-MONTH-DATE = CR-LF-CANCEL-EXIT-DATE)
  3478              SET CREDIT-LF-CANCEL TO TRUE
  3479           END-IF
  3480        END-IF
  3481     END-IF
  3482
  3483*    IF (CR-LF-CANC-DT NOT = ZEROS) AND
  3484*       (CR-LF-CANC-DT < WS-WORK-DATE)
  3485*       MOVE CR-LF-CANC-DT           TO WS-WORK-DATE
  3486*    END-IF
  3487
  3488     IF (CR-LF-CANCEL-EXIT-DATE NOT = ZEROS)
  3489        AND (CR-LF-CANCEL-EXIT-DATE < WS-WORK-DATE)
  3490        MOVE CR-LF-CANCEL-EXIT-DATE
  3491                                 TO WS-WORK-DATE
  3492     END-IF
  3493
  3494     IF (CR-LF-CLAIM-EXIT-DATE NOT = ZEROS) AND
  3495        (CR-LF-CLAIM-EXIT-DATE < WS-WORK-DATE)
  3496        MOVE CR-LF-CLAIM-EXIT-DATE   TO WS-WORK-DATE
  3497     END-IF
  3498
  3499     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3500     MOVE 'L'                    TO DC-OPTION-CODE
  3501     PERFORM 8510-DATE-CONVERSION
  3502                                 THRU 8590-EXIT
  3503     IF NO-CONVERSION-ERROR
  3504        MOVE DC-BIN-DATE-1       TO WS-BIN-LF-END-DATE
  3505     ELSE
  3506        DISPLAY ' NO LIFE COVERAGE ?? ' CR-ACCT-CONTROL
  3507           '   ' CR-CERT-NO
  3508     END-IF
  3509
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  68
* ECS056.cbl
  3510     MOVE CR-AH-EXPIRE-DATE          TO WS-WORK-DATE
  3511
  3512     MOVE LOW-VALUES             TO WS-BIN-AH-CAN-DATE
  3513     MOVE +0                     TO WS-AH-CAN-TERM
  3514     MOVE 'N'                    TO WS-AH-CAN-QUAL-SW
  3515
  3516     IF CR-AH-CANC-DT NOT = ZEROS
  3517        MOVE CR-AH-CANC-DT       TO DC-GREG-DATE-CYMD
  3518        MOVE 'L'                 TO DC-OPTION-CODE
  3519        PERFORM 8510-DATE-CONVERSION
  3520                                 THRU 8590-EXIT
  3521        IF NO-CONVERSION-ERROR
  3522           MOVE DC-BIN-DATE-1    TO WS-BIN-AH-CAN-DATE
  3523        ELSE
  3524           MOVE LOW-VALUES       TO WS-BIN-AH-CAN-DATE
  3525        END-IF
  3526        MOVE BIN-RUN-DATE        TO DC-BIN-DATE-2
  3527        MOVE '1'                 TO DC-OPTION-CODE
  3528        MOVE +0                  TO DC-ELAPSED-MONTHS
  3529                                    DC-ELAPSED-DAYS
  3530        PERFORM 8510-DATE-CONVERSION
  3531                                 THRU 8590-EXIT
  3532        IF NO-CONVERSION-ERROR
  3533           MOVE DC-ELAPSED-MONTHS
  3534                                 TO WS-AH-CAN-TERM
  3535           IF (WS-AH-CAN-TERM > +0)
  3536              AND (WS-BIN-AH-CAN-DATE > WS-BIN-1ST-DT)
  3537              SUBTRACT +1        FROM WS-AH-CAN-TERM
  3538           END-IF
  3539           IF (WS-AH-CAN-TERM > +0)
  3540              AND (WS-THIS-MONTH-DATE = CR-AH-CANCEL-EXIT-DATE)
  3541              SET CREDIT-AH-CANCEL TO TRUE
  3542           END-IF
  3543        END-IF
  3544     END-IF
  3545
  3546*    IF (CR-AH-CANC-DT NOT = ZEROS) AND
  3547*       (CR-AH-CANC-DT < WS-WORK-DATE)
  3548*       MOVE CR-AH-CANC-DT           TO WS-WORK-DATE
  3549*    END-IF
  3550
  3551     IF (CR-AH-CANCEL-EXIT-DATE NOT = ZEROS)
  3552        AND (CR-AH-CANCEL-EXIT-DATE < WS-WORK-DATE)
  3553        MOVE CR-AH-CANCEL-EXIT-DATE
  3554                                 TO WS-WORK-DATE
  3555     END-IF
  3556
  3557     IF (CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS) AND
  3558        (CR-AH-SETTLEMENT-EXIT-DATE < WS-WORK-DATE)
  3559        MOVE CR-AH-SETTLEMENT-EXIT-DATE
  3560                                     TO WS-WORK-DATE
  3561     END-IF
  3562
  3563     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3564     MOVE 'L'                    TO DC-OPTION-CODE
  3565     PERFORM 8510-DATE-CONVERSION
  3566                                 THRU 8590-EXIT
  3567     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  69
* ECS056.cbl
  3568        MOVE DC-BIN-DATE-1       TO WS-BIN-AH-END-DATE
  3569     ELSE
  3570        DISPLAY ' NO AH COVERAGE ' CR-ACCT-CONTROL
  3571           '   ' CR-CERT-NO
  3572     END-IF
  3573
  3574     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  3575     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  3576     MOVE '3'                        TO CP-PROCESS-TYPE
  3577     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  3578     MOVE DTE-CLIENT                 TO CP-COMPANY-ID
  3579     MOVE SPACES                     TO CP-ACCT-FLD-5
  3580     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD
  3581
  3582*    IF (WS-BIN-LF-END-DATE NOT > BIN-RUN-DATE)
  3583*       AND (NOT THIS-IS-A-GIANT-CERT)
  3584*       AND (NOT CREDIT-LF-CANCEL)
  3585*       MOVE ZEROS               TO CR-LFPRM
  3586*                                   CR-LFTYP
  3587*                                   CR-LF-TERM
  3588*                                   CR-LFPRM-RATE
  3589*    END-IF
  3590
  3591     IF (WS-BIN-LF-END-DATE NOT > WS-BIN-LAST-MONTH-DT)
  3592        AND (NOT THIS-IS-A-GIANT-CERT)
  3593        MOVE ZEROS               TO CR-LFPRM
  3594                                    CR-LFTYP
  3595                                    CR-LF-TERM
  3596                                    CR-LFPRM-RATE
  3597     END-IF
  3598
  3599*    IF (WS-BIN-AH-END-DATE NOT > BIN-RUN-DATE)
  3600*       AND (NOT THIS-IS-A-GIANT-CERT)
  3601*       AND (NOT CREDIT-AH-CANCEL)
  3602*       MOVE ZEROS               TO CR-AHPRM
  3603*                                   CR-AHTYP
  3604*                                   CR-AH-TERM
  3605*                                   CR-AHPRM-RATE
  3606*    END-IF
  3607
  3608     IF (WS-BIN-AH-END-DATE NOT > WS-BIN-LAST-MONTH-DT)
  3609        AND (NOT THIS-IS-A-GIANT-CERT)
  3610        MOVE ZEROS               TO CR-AHPRM
  3611                                    CR-AHTYP
  3612                                    CR-AH-TERM
  3613                                    CR-AHPRM-RATE
  3614     END-IF
  3615
  3616     IF CR-LF-TERM > CR-AH-TERM
  3617        MOVE CR-LF-TERM          TO WS-WORK-TERM
  3618     ELSE
  3619        MOVE CR-AH-TERM          TO WS-WORK-TERM
  3620     END-IF
  3621
  3622     IF (CR-LFTYP = '00' OR '  ')
  3623        AND (CR-AHTYP = '00' OR '  ')
  3624        CONTINUE
  3625     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  70
* ECS056.cbl
  3626        PERFORM 0205-CALC-REM-TERMS
  3627                                 THRU 0205-EXIT
  3628        IF LF-REM-TERM > AH-REM-TERM
  3629           MOVE LF-REM-TERM      TO REM-TERM
  3630        ELSE
  3631           MOVE AH-REM-TERM      TO REM-TERM
  3632        END-IF
  3633
  3634        PERFORM 0210-CALC-UEP    THRU 0210-EXIT
  3635     END-IF
  3636
  3637
  3638     .
  3639
  3640 0200-EXIT.
  3641     EXIT.
  3642
  3643 0205-CALC-REM-TERMS.
  3644
  3645     MOVE +0                     TO LF-REM-TERM
  3646                                    AH-REM-TERM
  3647                                    REM-TERM
  3648
  3649     IF CR-LFTYP NOT = '  ' AND ZEROS
  3650        PERFORM 0207-FIND-LIFE-TYPE
  3651                                 THRU 0207-EXIT
  3652        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  3653           CONTINUE
  3654        ELSE
  3655           PERFORM 0220-CALC-LF-REM-TERM
  3656                                 THRU 0220-EXIT
  3657        END-IF
  3658     END-IF
  3659
  3660     IF CR-AHTYP NOT = '  ' AND ZEROS
  3661        PERFORM 0208-FIND-AH-TYPE
  3662                                 THRU 0208-EXIT
  3663        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  3664           CONTINUE
  3665        ELSE
  3666           PERFORM 0225-CALC-AH-REM-TERM
  3667                                 THRU 0225-EXIT
  3668        END-IF
  3669     END-IF
  3670
  3671
  3672     .
  3673 0205-EXIT.
  3674    EXIT.
  3675
  3676 0207-FIND-LIFE-TYPE.
  3677
  3678     IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3679        CONTINUE
  3680     ELSE
  3681        PERFORM VARYING CLAS-INDEXL FROM +1 BY +1 UNTIL
  3682         (CLAS-INDEXL = CLAS-MAXL) OR
  3683         (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  71
* ECS056.cbl
  3684        END-PERFORM
  3685        IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3686           CONTINUE
  3687        ELSE
  3688           DISPLAY 'LIFE BENEFIT ' CR-LFTYP ' NOT IN TABLE'
  3689           DISPLAY 'RETURN CODE - 0401'
  3690           MOVE 0401 TO WS-RETURN-CODE
  3691           PERFORM ABEND-PGM
  3692        END-IF
  3693     END-IF
  3694
  3695     .
  3696 0207-EXIT.
  3697     EXIT.
  3698
  3699 0208-FIND-AH-TYPE.
  3700
  3701     IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3702        CONTINUE
  3703     ELSE
  3704        PERFORM VARYING CLAS-INDEXA FROM +1 BY +1 UNTIL
  3705            (CLAS-INDEXA = CLAS-MAXA) OR
  3706            (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
  3707        END-PERFORM
  3708        IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3709           CONTINUE
  3710        ELSE
  3711           DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
  3712           DISPLAY 'RETURN CODE - 0401'
  3713           MOVE 0401 TO WS-RETURN-CODE
  3714           PERFORM ABEND-PGM
  3715        END-IF
  3716     END-IF
  3717
  3718     .
  3719 0208-EXIT.
  3720     EXIT.
  3721
  3722 0210-CALC-UEP.
  3723
  3724     MOVE ZEROS                  TO WS-REM-AMT
  3725     IF THIS-IS-A-GIANT-CERT
  3726        PERFORM 0215-CALC-RECEIVE
  3727                                 THRU 0215-EXIT
  3728     ELSE
  3729        MOVE +0            TO WS-BASE-COMM
  3730                              WS-GA-COMM
  3731        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3732           (X1 > +10)
  3733           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3734              COMPUTE WS-BASE-COMM = WS-BASE-COMM
  3735              + (CR-LFPRM * CR-LCOM-L (X1))
  3736              + (CR-LFPRM-ALT * CR-LCOM-L (X1))
  3737              + (CR-AHPRM * CR-LCOM-AH (X1))
  3738           END-IF
  3739           IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  3740              COMPUTE WS-GA-COMM = WS-GA-COMM +
  3741                 (CR-LFPRM * CR-LCOM-L (X1)) +
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  72
* ECS056.cbl
  3742                 (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
  3743                 (CR-AHPRM * CR-LCOM-AH (X1))
  3744           END-IF
  3745        END-PERFORM
  3746        IF (CR-LFTYP (1:1) = 'M')
  3747           OR (CR-AHTYP (1:1) = 'M')
  3748*          COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
  3749           COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
  3750           COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
  3751           IF (CREDIT-LF-CANCEL)
  3752              OR (CREDIT-AH-CANCEL)
  3753              PERFORM 0212-CALC-CANCEL-CREDIT
  3754                                 THRU 0212-EXIT
  3755           ELSE
  3756             IF RUN-DATE = CR-ENTRY-DATE
  3757              COMPUTE WS-EXP-PREM = WS-EXP-PREM
  3758                 * WS-EARN-TERM
  3759              COMPUTE WS-BASE-COMM = WS-BASE-COMM
  3760                 * WS-EARN-TERM
  3761              COMPUTE WS-GA-COMM   = WS-GA-COMM
  3762                 * WS-EARN-TERM
  3763             END-IF
  3764             COMPUTE WS-EXP-PREM =
  3765              (WS-EXP-PREM - WS-BASE-COMM)
  3766           END-IF
  3767        ELSE
  3768           IF (CR-LFTYP (1:1) = 'S')
  3769              OR (CR-AHTYP (1:1) = 'S')
  3770              PERFORM 0240-CALC-SRP
  3771                                 THRU 0240-EXIT
  3772           ELSE
  3773              PERFORM 0230-CALC-UEP
  3774                                 THRU 0230-EXIT
  3775           END-IF
  3776        END-IF
  3777     END-IF
  3778
  3779     .
  3780
  3781 0210-EXIT.
  3782     EXIT.
  3783
  3784 0212-CALC-CANCEL-CREDIT.
  3785
  3786     MOVE ZEROS                  TO WS-EXP-PREM
  3787                                    WS-LF-EXP-PREM
  3788                                    WS-AH-EXP-PREM
  3789                                    WS-LF-BASE-COMM
  3790                                    WS-AH-BASE-COMM
  3791                                    WS-LF-GA-COMM
  3792                                    WS-AH-GA-COMM
  3793
  3794
  3795     IF CREDIT-LF-CANCEL
  3796        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3797           (X1 > +10)
  3798           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3799              COMPUTE WS-LF-BASE-COMM = WS-LF-BASE-COMM
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  73
* ECS056.cbl
  3800              + (CR-LFPRM * CR-LCOM-L (X1))
  3801              + (CR-LFPRM-ALT * CR-LCOM-L (X1))
  3802           END-IF
  3803           IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  3804              COMPUTE WS-LF-GA-COMM = WS-LF-GA-COMM +
  3805                 (CR-LFPRM * CR-LCOM-L (X1)) +
  3806                 (CR-LFPRM-ALT * CR-LCOM-L (X1))
  3807           END-IF
  3808        END-PERFORM
  3809        COMPUTE WS-LF-EXP-PREM = CR-LFPRM * WS-LF-CAN-TERM
  3810        COMPUTE WS-LF-BASE-COMM = WS-LF-BASE-COMM * WS-LF-CAN-TERM
  3811        COMPUTE WS-LF-GA-COMM = WS-LF-GA-COMM * WS-LF-CAN-TERM
  3812     END-IF
  3813
  3814     IF CREDIT-AH-CANCEL
  3815        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3816           (X1 > +10)
  3817           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3818              COMPUTE WS-AH-BASE-COMM = WS-AH-BASE-COMM
  3819              + (CR-AHPRM * CR-LCOM-AH (X1))
  3820           END-IF
  3821           IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  3822              COMPUTE WS-AH-GA-COMM = WS-AH-GA-COMM +
  3823                 (CR-AHPRM * CR-LCOM-AH (X1))
  3824           END-IF
  3825        END-PERFORM
  3826        COMPUTE WS-AH-EXP-PREM = CR-AHPRM * WS-AH-CAN-TERM
  3827        COMPUTE WS-AH-BASE-COMM = WS-AH-BASE-COMM * WS-AH-CAN-TERM
  3828        COMPUTE WS-AH-GA-COMM = WS-AH-GA-COMM * WS-AH-CAN-TERM
  3829     END-IF
  3830
  3831     COMPUTE WS-EXP-PREM = WS-LF-EXP-PREM + WS-AH-EXP-PREM
  3832     COMPUTE WS-BASE-COMM = WS-LF-BASE-COMM + WS-AH-BASE-COMM
  3833     COMPUTE WS-GA-COMM = WS-LF-GA-COMM + WS-AH-GA-COMM
  3834     COMPUTE WS-EXP-PREM = (WS-EXP-PREM - WS-BASE-COMM) * -1
  3835
  3836     .
  3837 0212-EXIT.
  3838     EXIT.
  3839
  3840
  3841 0215-CALC-RECEIVE.
  3842
  3843     MOVE +0                     TO WS-GA-COMM
  3844                                    WS-REC-BASE-COMM
  3845
  3846     IF WS-THIS-MONTH-DATE = CR-ENTRY-DATE
  3847        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3848           (X1 > +10)
  3849           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3850              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM +
  3851                 (CR-LFPRM * CR-LCOM-L (X1)) +
  3852                 (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
  3853                 (CR-AHPRM * CR-LCOM-AH (X1))
  3854           END-IF
  3855        END-PERFORM
  3856        COMPUTE WS-REC-PREM = (CR-LFPRM + CR-LFPRM-ALT + CR-AHPRM)
  3857     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  74
* ECS056.cbl
  3858
  3859     IF WS-THIS-MONTH-DATE = CR-LF-CANCEL-EXIT-DATE
  3860        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3861           (X1 > +10)
  3862           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3863              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM -
  3864                 (CR-LFRFND * CR-LCOM-L (X1))
  3865           END-IF
  3866        END-PERFORM
  3867        COMPUTE WS-REC-PREM = WS-REC-PREM - CR-LFRFND
  3868     END-IF
  3869
  3870     IF WS-THIS-MONTH-DATE = CR-AH-CANCEL-EXIT-DATE
  3871        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3872           (X1 > +10)
  3873           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3874              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM -
  3875                 (CR-AHRFND * CR-LCOM-AH (X1))
  3876           END-IF
  3877        END-PERFORM
  3878        COMPUTE WS-REC-PREM = WS-REC-PREM - CR-AHRFND
  3879     END-IF
  3880
  3881     COMPUTE WS-REC-PREM = WS-REC-PREM - WS-REC-BASE-COMM
  3882*    COMPUTE WS-REC-PREM = (CR-LFPRM + CR-LFPRM-ALT + CR-AHPRM)
  3883*       - WS-REC-BASE-COMM
  3884
  3885     .
  3886
  3887 0215-EXIT.
  3888     EXIT.
  3889
  3890 0220-CALC-LF-REM-TERM.
  3891
  3892     MOVE ZEROS                  TO LF-REM-TERM
  3893     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-1
  3894     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-2
  3895
  3896     IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  3897        MOVE ZEROS               TO WS-LF-EARN-TERM
  3898     ELSE
  3899        MOVE '1'                 TO DC-OPTION-CODE
  3900        PERFORM 8510-DATE-CONVERSION
  3901                                 THRU 8590-EXIT
  3902        IF NO-CONVERSION-ERROR
  3903           MOVE DC-ELAPSED-MONTHS
  3904                                 TO WS-LF-EARN-TERM
  3905           IF DC-ODD-DAYS-OVER > +0
  3906              ADD +1             TO WS-LF-EARN-TERM
  3907           END-IF
  3908        ELSE
  3909           DISPLAY ' PROBLEM WITH LIFE EARN TERM '
  3910              CR-ACCT-CONTROL '   ' CR-CERT-NO
  3911        END-IF
  3912     END-IF
  3913
  3914     IF CR-LF-TERM NOT = ZEROS
  3915        COMPUTE LF-REM-TERM = CR-LF-TERM - WS-LF-EARN-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  75
* ECS056.cbl
  3916     END-IF
  3917
  3918*    IF WS-BIN-LF-END-DATE = LOW-VALUES
  3919*       MOVE ZEROS               TO LF-REM-TERM
  3920*    ELSE
  3921*       MOVE BIN-RUN-DATE        TO DC-BIN-DATE-1
  3922*       MOVE WS-BIN-LF-END-DATE  TO DC-BIN-DATE-2
  3923*       MOVE '1'                 TO DC-OPTION-CODE
  3924*       IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  3925*          MOVE +1               TO LF-REM-TERM
  3926*       ELSE
  3927*          PERFORM 8510-DATE-CONVERSION
  3928*                                THRU 8590-EXIT
  3929*          IF NO-CONVERSION-ERROR
  3930*             MOVE DC-ELAPSED-MONTHS
  3931*                                TO LF-REM-TERM
  3932*             IF DC-ODD-DAYS-OVER > +0
  3933*                ADD +1          TO LF-REM-TERM
  3934*             END-IF
  3935*          ELSE
  3936*             DISPLAY ' ERROR WITH LIFE REM TERM '
  3937*               CR-ACCT-CONTROL '  ' CR-CERT-NO
  3938*             MOVE ZEROS         TO LF-REM-TERM
  3939*          END-IF
  3940*       END-IF
  3941*    END-IF
  3942
  3943*    IF LF-REM-TERM > CR-LF-TERM
  3944*       MOVE CR-LF-TERM          TO LF-REM-TERM
  3945*       DISPLAY ' LF REM TERM > LF TERM ' CR-ACCT-CONTROL
  3946*          '   ' CR-CERT-NO
  3947*    END-IF
  3948
  3949*    MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  3950
  3951*    MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3952*                                TO CP-BENEFIT-TYPE
  3953*    MOVE CLAS-I-BAL (CLAS-INDEXL)
  3954*                                TO CP-SPECIAL-CALC-CD
  3955*    MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  3956*                                   CP-LOAN-TERM
  3957
  3958*    IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  3959*       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  3960*       ADD +1                   TO CP-ORIGINAL-TERM
  3961*                                   CP-LOAN-TERM
  3962*    END-IF
  3963
  3964*    IF CP-TERM-IS-DAYS
  3965*       MOVE CR-LF-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
  3966*    ELSE
  3967*       MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  3968*    END-IF
  3969
  3970*    MOVE DTE-REM-TRM-CALC-OPTION
  3971*    MOVE '3'                    TO CP-REM-TRM-CALC-OPTION
  3972
  3973*    PERFORM 0510-GET-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  76
* ECS056.cbl
  3974*                                THRU 0510-EXIT
  3975
  3976*    IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  3977*         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  3978*       MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
  3979*       COMPUTE CP-REMAINING-TERM-1 =
  3980*                      CP-REMAINING-TERM-1 - 1
  3981*       COMPUTE CP-REMAINING-TERM-2 =
  3982*                      CP-REMAINING-TERM-2 - 1
  3983*    END-IF
  3984
  3985*    IF CP-REMAINING-TERM-1 NEGATIVE
  3986*        MOVE ZEROS              TO CP-REMAINING-TERM-1
  3987*    END-IF
  3988
  3989*    IF CP-REMAINING-TERM-2 NEGATIVE
  3990*        MOVE ZEROS              TO CP-REMAINING-TERM-2
  3991*    END-IF
  3992
  3993*    MOVE CP-REMAINING-TERM-1    TO LF-REM-TRM1
  3994*    MOVE CP-REMAINING-TERM-2    TO LF-REM-TRM2
  3995*    DISPLAY ' LF CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
  3996*       ' REM2 ' LF-REM-TRM2
  3997
  3998     .
  3999
  4000 0220-EXIT.
  4001     EXIT.
  4002
  4003 0225-CALC-AH-REM-TERM.
  4004
  4005     MOVE +0                     TO AH-REM-TERM
  4006     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-1
  4007     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-2
  4008
  4009     IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  4010        MOVE ZEROS               TO WS-AH-EARN-TERM
  4011     ELSE
  4012        MOVE '1'                 TO DC-OPTION-CODE
  4013        PERFORM 8510-DATE-CONVERSION
  4014                                 THRU 8590-EXIT
  4015        IF NO-CONVERSION-ERROR
  4016           MOVE DC-ELAPSED-MONTHS
  4017                                 TO WS-AH-EARN-TERM
  4018           IF DC-ODD-DAYS-OVER > +0
  4019              ADD +1             TO WS-AH-EARN-TERM
  4020           END-IF
  4021        ELSE
  4022           DISPLAY ' PROBLEM WITH  AH  EARN TERM '
  4023              CR-ACCT-CONTROL '   ' CR-CERT-NO
  4024        END-IF
  4025     END-IF
  4026
  4027     IF CR-AH-TERM NOT = ZEROS
  4028        COMPUTE AH-REM-TERM = CR-AH-TERM - WS-AH-EARN-TERM
  4029     END-IF
  4030
  4031*    IF WS-BIN-AH-END-DATE = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  77
* ECS056.cbl
  4032*       MOVE ZEROS               TO AH-REM-TERM
  4033*    ELSE
  4034*       MOVE BIN-RUN-DATE        TO DC-BIN-DATE-1
  4035*       MOVE WS-BIN-AH-END-DATE  TO DC-BIN-DATE-2
  4036*       IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  4037*          MOVE +1               TO AH-REM-TERM
  4038*       ELSE
  4039*          MOVE '1'              TO DC-OPTION-CODE
  4040*          PERFORM 8510-DATE-CONVERSION
  4041*                                THRU 8590-EXIT
  4042*          IF NO-CONVERSION-ERROR
  4043*             MOVE DC-ELAPSED-MONTHS
  4044*                                TO AH-REM-TERM
  4045*             IF DC-ODD-DAYS-OVER > +0
  4046*                ADD +1          TO AH-REM-TERM
  4047*             END-IF
  4048*          ELSE
  4049*             DISPLAY ' ERROR WITH  AH  REM TERM '
  4050*               CR-ACCT-CONTROL '  ' CR-CERT-NO
  4051*             MOVE ZEROS         TO AH-REM-TERM
  4052*          END-IF
  4053*       END-IF
  4054*    END-IF
  4055
  4056*    IF AH-REM-TERM > CR-AH-TERM
  4057*       MOVE CR-AH-TERM          TO AH-REM-TERM
  4058*       DISPLAY ' AH REM TERM > AH TERM ' CR-ACCT-CONTROL
  4059*          '   ' CR-CERT-NO
  4060*    END-IF
  4061
  4062*    MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  4063
  4064*    MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  4065*                                TO CP-BENEFIT-TYPE
  4066*    MOVE CLAS-I-BAL (CLAS-INDEXA)
  4067*                                TO CP-SPECIAL-CALC-CD
  4068*    MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  4069*                                   CP-LOAN-TERM
  4070
  4071*    MOVE DTE-REM-TRM-CALC-OPTION
  4072*    MOVE '3'                    TO CP-REM-TRM-CALC-OPTION
  4073
  4074*    PERFORM 0510-GET-REMAINING-TERM
  4075*                                THRU 0510-EXIT
  4076
  4077*    IF CP-REMAINING-TERM-1 NEGATIVE
  4078*        MOVE ZEROS              TO CP-REMAINING-TERM-1
  4079*    END-IF
  4080
  4081*    IF CP-REMAINING-TERM-2 NEGATIVE
  4082*        MOVE ZEROS              TO CP-REMAINING-TERM-2
  4083*    END-IF
  4084
  4085*    MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
  4086*    MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
  4087*    DISPLAY ' AH CERT ' CR-CERT-NO ' TERM ' CR-AH-TERM
  4088*       ' REM2 ' AH-REM-TRM2
  4089*
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  78
* ECS056.cbl
  4090     .
  4091
  4092 0225-EXIT.
  4093     EXIT.
  4094
  4095 0230-CALC-UEP.
  4096
  4097*     DISPLAY ' MADE IT TO 0230 ' CR-CERT-NO
  4098
  4099     COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
  4100
  4101     MOVE WS-EARN-TERM           TO WS-DISPLAY-FLD
  4102     IF CR-CERT-NO = '0004052380 '
  4103        DISPLAY ' EARN TRM ' WS-DISPLAY-FLD
  4104     END-IF
  4105     IF CR-LOAN-TERM NOT NUMERIC
  4106        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4107     END-IF
  4108     IF CR-LOAN-TERM = ZEROS
  4109        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4110     END-IF
  4111     IF CR-LOAN-TERM = ZEROS
  4112        MOVE CR-AH-TERM          TO CR-LOAN-TERM
  4113     END-IF
  4114*    COMPUTE WS-I = CR-APR / +1200
  4115
  4116*    MOVE WS-I                   TO WS-DISPLAY-FLD
  4117*    DISPLAY ' WS I ' WS-DISPLAY-FLD
  4118*
  4119*    COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4120*       + (CR-AHPRM-RATE / +1000))
  4121
  4122*    MOVE WS-J                   TO WS-DISPLAY-FLD
  4123*    DISPLAY ' WS J ' WS-DISPLAY-FLD
  4124
  4125*    COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
  4126
  4127*    MOVE WS-VM                  TO WS-DISPLAY-FLD
  4128*    DISPLAY ' WS VM ' WS-DISPLAY-FLD
  4129*
  4130*    COMPUTE WS-ANGLEMJ = (1 - ((1 + WS-J)
  4131*       ** (WS-WORK-TERM * -1))) / WS-J
  4132
  4133*    MOVE WS-ANGLEMJ             TO WS-DISPLAY-FLD
  4134*    DISPLAY ' WS ANGLEMJ ' WS-DISPLAY-FLD
  4135*    COMPUTE WS-ANGLEN = (1 - ((1 + WS-I)
  4136*       ** (CR-LOAN-TERM * -1))) / WS-I
  4137
  4138*    MOVE WS-ANGLEN              TO WS-DISPLAY-FLD
  4139*    DISPLAY ' WS ANGLEN  ' WS-DISPLAY-FLD
  4140*    COMPUTE WS-ANGLEM = (1 - ((1 + WS-I)
  4141*       ** (WS-WORK-TERM * -1))) / WS-I
  4142
  4143*    MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4144*    DISPLAY ' WS ANGLEM  ' WS-DISPLAY-FLD
  4145*    COMPUTE WS-ANGLEN-M = (1 - ((1 + WS-I)
  4146*       ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
  4147
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  79
* ECS056.cbl
  4148*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4149*    DISPLAY ' WS ANGLEN - M ' WS-DISPLAY-FLD
  4150
  4151*    IF CR-LFAMT = ZEROS
  4152*       COMPUTE CR-LFAMT = CR-AHAMT * WS-WORK-TERM
  4153*    END-IF
  4154
  4155*    COMPUTE WS-P = CR-LFAMT / WS-ANGLEN
  4156*    MOVE WS-P                   TO WS-DISPLAY-FLD
  4157*    DISPLAY ' WS P       ' WS-DISPLAY-FLD
  4158*    COMPUTE WS-B = WS-P * WS-ANGLEN-M
  4159*    MOVE WS-B                   TO WS-DISPLAY-FLD
  4160*    DISPLAY ' WS B       ' WS-DISPLAY-FLD
  4161*    COMPUTE WS-R = (CR-LFAMT - (WS-B * WS-VM))
  4162*       / WS-ANGLEMJ
  4163*    MOVE WS-R                   TO WS-DISPLAY-FLD
  4164*    DISPLAY ' WS R       ' WS-DISPLAY-FLD
  4165
  4166*    MOVE CR-LFAMT               TO WS-AMT
  4167
  4168*    MOVE CR-LFPRM-RATE          TO WS-DISPLAY-FLD
  4169*    DISPLAY ' LF RATE ' WS-DISPLAY-FLD
  4170*    MOVE CR-AHPRM-RATE          TO WS-DISPLAY-FLD
  4171*    DISPLAY ' AH RATE ' WS-DISPLAY-FLD
  4172
  4173*    MOVE +0                     TO WS-LF-PRM
  4174*                                   WS-AH-PRM
  4175*    PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4176*       (WS-A > WS-EARN-TERM)
  4177*       IF WS-A = +1
  4178*          COMPUTE WS-I1 ROUNDED = (WS-AMT * (WS-I / +30
  4179*             * (CR-PMT-EXTENSION-DAYS + +30)) * +100) / +100
  4180*       ELSE
  4181*          COMPUTE WS-I1 ROUNDED = (WS-AMT * WS-I * +100)
  4182*             / +100
  4183*       END-IF
  4184*       MOVE WS-I1               TO WS-DISPLAY-FLD
  4185*       DISPLAY ' ' WS-A '  WS-I1  ' WS-DISPLAY-FLD
  4186*       DISPLAY ' RUN DATE ' RUN-DATE
  4187*       DISPLAY ' ENTRY DATE ' CR-ENTRY-DATE
  4188*       IF RUN-DATE = CR-ENTRY-DATE
  4189*          COMPUTE WS-LF-PRM = WS-LF-PRM
  4190*             + (WS-AMT / +1000 * CR-LFPRM-RATE)
  4191*          COMPUTE WS-AH-PRM = WS-AH-PRM
  4192*             + (WS-AMT / +1000 * CR-AHPRM-RATE)
  4193*          COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4194*          COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4195*       ELSE
  4196*          COMPUTE WS-LF-PRM = WS-AMT / +1000 * CR-LFPRM-RATE
  4197*          COMPUTE WS-AH-PRM = WS-AMT / +1000 * CR-AHPRM-RATE
  4198*       END-IF
  4199*       MOVE WS-AMT              TO WS-DISPLAY-FLD
  4200*       DISPLAY ' WS-AMT B4    ' WS-AMT
  4201*       COMPUTE WS-AMT ROUNDED = (.05 + (WS-AMT - (WS-R
  4202*          - WS-I1 - (WS-LF-PRM + WS-AH-PRM))) * +100)
  4203*          / +100
  4204*       MOVE WS-AMT              TO WS-DISPLAY-FLD
  4205*       DISPLAY ' WS-AMT AFTER ' WS-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  80
* ECS056.cbl
  4206*       IF WS-AMT < +0
  4207*          COMPUTE WS-P = WS-P + WS-AMT
  4208*          MOVE ZEROS            TO WS-AMT
  4209*       END-IF
  4210*       IF WS-A = CR-LOAN-TERM
  4211*          IF WS-AMT > ZEROS
  4212*             IF WS-R > WS-AMT
  4213*                COMPUTE WS-R = WS-R - WS-AMT
  4214*                MOVE ZEROS      TO WS-AMT
  4215*             ELSE
  4216*                MOVE CR-LFAMT-ALT TO WS-R
  4217*                MOVE ZEROS      TO WS-AMT
  4218*             END-IF
  4219*          END-IF
  4220*       END-IF
  4221*    END-PERFORM
  4222
  4223*    COMPUTE WS-EXP-PREM = (WS-LF-PRM + WS-AH-PRM)
  4224
  4225*    DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
  4226*    DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
  4227*    DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
  4228*    DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
  4229*       - WS-BASE-COMM
  4230
  4231
  4232*    MOVE CR-LFPRM-RATE          TO WS-DISPLAY-FLD
  4233*    DISPLAY ' LFRATE   ' WS-DISPLAY-FLD
  4234*    MOVE CR-AHPRM-RATE          TO WS-DISPLAY-FLD
  4235*    DISPLAY ' AHRATE   ' WS-DISPLAY-FLD
  4236*    MOVE CR-APR                 TO WS-DISPLAY-FLD
  4237*    DISPLAY ' APR      ' WS-DISPLAY-FLD
  4238     COMPUTE WS-I = CR-APR / +1200
  4239*    MOVE WS-I                   TO WS-DISPLAY-FLD
  4240*    DISPLAY ' WS I     ' WS-DISPLAY-FLD
  4241
  4242     COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4243        + (CR-AHPRM-RATE / +1000))
  4244*    MOVE WS-J                   TO WS-DISPLAY-FLD
  4245*    DISPLAY ' WS J     ' WS-DISPLAY-FLD
  4246     COMPUTE WS-K = WS-I + (CR-LFPRM-RATE / +1000)
  4247
  4248*    I = APR/1200
  4249*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4250*    RA = PAYMENT AMOUNT
  4251*    WK5-CSL = THE BALANCE (PAY OFF )
  4252*    WK3 = THE ACCUMULATED PREMIUM
  4253*    WK2 = (1 + I) ^ (m * -1)
  4254*
  4255*
  4256     COMPUTE WS-OD = (1 + (WS-DAYS-TO-1ST * WS-I / 30))
  4257        / (1 + WS-I)
  4258
  4259*    MOVE WS-DAYS-TO-1ST         TO WS-DISPLAY-FLD
  4260*    DISPLAY ' DYS 2 1ST' WS-DISPLAY-FLD
  4261*    MOVE WS-OD                  TO WS-DISPLAY-FLD
  4262*    DISPLAY ' WS OD    ' WS-DISPLAY-FLD
  4263     COMPUTE WS-ANGLEN-M = ((1 - ((1 + WS-I)
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  81
* ECS056.cbl
  4264        ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I)
  4265        / WS-OD
  4266     COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
  4267*    MOVE WS-VM                  TO WS-DISPLAY-FLD
  4268*    DISPLAY ' WS VM    ' WS-DISPLAY-FLD
  4269     COMPUTE WS-ANGLEN-M = WS-ANGLEN-M * WS-VM
  4270*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4271*    DISPLAY ' WS AN-M  ' WS-DISPLAY-FLD
  4272     COMPUTE WS-ANGLEMJ = ((1 - ((1 + WS-J)
  4273        ** (WS-WORK-TERM * -1))) / WS-J) / WS-OD
  4274*    MOVE WS-ANGLEMJ             TO WS-DISPLAY-FLD
  4275*    DISPLAY ' WS AMJ   ' WS-DISPLAY-FLD
  4276     COMPUTE WS-ANGLEM = ((1 - ((1 + WS-I)
  4277        ** (WS-WORK-TERM * -1))) / WS-I) / WS-OD
  4278     MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4279*     DISPLAY ' WS Anglem 230 ' WS-DISPLAY-FLD
  4280     COMPUTE WS-ANGLEM-1 = (1 - ((1 + WS-J)
  4281        ** ((WS-WORK-TERM - 1) * -1))) / WS-J
  4282
  4283
  4284     IF CR-LFAMT = ZEROS
  4285        COMPUTE CR-LFAMT = CR-AHAMT * WS-ANGLEM
  4286     END-IF
  4287
  4288     IF CR-LFAMT-ALT > +0
  4289        COMPUTE WS-P = (CR-LFAMT * WS-OD - (CR-LFAMT-ALT *
  4290           (1 + WS-K) ** (WS-WORK-TERM * -1))) / WS-ANGLEM-1
  4291     ELSE
  4292        COMPUTE WS-P = CR-LFAMT / (WS-ANGLEMJ + WS-ANGLEN-M)
  4293     END-IF
  4294*    MOVE WS-P                   TO WS-DISPLAY-FLD
  4295*    DISPLAY ' WS P     ' WS-DISPLAY-FLD
  4296     COMPUTE WS-ANGLEN-M = (1 - ((1 + WS-I)
  4297        ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
  4298*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4299*    DISPLAY ' WS AN-M  ' WS-DISPLAY-FLD
  4300     MOVE +0                     TO WS-LF-PRM
  4301                                    WS-AH-PRM
  4302                                    WS-LF-REF
  4303                                    WS-AH-REF
  4304                                    WS-LF-MIN-TERM
  4305                                    WS-LF-MAX-TERM
  4306                                    WS-AH-MIN-TERM
  4307                                    WS-AH-MAX-TERM
  4308     IF WS-LF-CAN-TERM > +0
  4309        COMPUTE WS-LF-MIN-TERM = WS-EARN-TERM - WS-LF-CAN-TERM
  4310        COMPUTE WS-LF-MAX-TERM = WS-LF-MIN-TERM + WS-LF-CAN-TERM
  4311           - +1
  4312     END-IF
  4313
  4314     IF WS-AH-CAN-TERM > +0
  4315        COMPUTE WS-AH-MIN-TERM = WS-EARN-TERM - WS-AH-CAN-TERM
  4316        COMPUTE WS-AH-MAX-TERM = WS-AH-MIN-TERM + WS-AH-CAN-TERM
  4317           - +1
  4318     END-IF
  4319
  4320     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4321        (WS-A > WS-EARN-TERM)
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  82
* ECS056.cbl
  4322        IF CR-LFAMT-ALT > +0
  4323           COMPUTE WS-ANGLEM = (1 - ((1 + WS-J)
  4324             ** ((WS-WORK-TERM - WS-A) * -1))) / WS-J
  4325           COMPUTE WS-AMT = (WS-P * WS-ANGLEM) +
  4326             (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4327             ** (WS-WORK-TERM - WS-A + 1)))
  4328        ELSE
  4329
  4330           COMPUTE WS-ANGLEM = (1 - ((1 + WS-J)
  4331             ** ((WS-WORK-TERM - WS-A + 1) * -1))) / WS-J
  4332           COMPUTE WS-VM = (1 / (1 + WS-J))
  4333             ** (WS-WORK-TERM - WS-A + 1)
  4334           COMPUTE WS-AMT = WS-P *
  4335             (WS-ANGLEM + (WS-ANGLEN-M * WS-VM))
  4336        END-IF
  4337        MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4338*        DISPLAY ' WS Anglem 230b ' WS-DISPLAY-FLD
  4339
  4340*       IF WS-A = +1
  4341*          MOVE WS-VM               TO WS-DISPLAY-FLD
  4342*          DISPLAY ' WS VM    ' WS-DISPLAY-FLD
  4343*          MOVE WS-ANGLEM           TO WS-DISPLAY-FLD
  4344*          DISPLAY ' WS AM    ' WS-DISPLAY-FLD
  4345*          MOVE WS-AMT TO WS-DISPLAY-FLD
  4346*          DISPLAY ' AMT FIRST ' WS-DISPLAY-FLD
  4347*       END-IF
  4348        IF RUN-DATE = CR-ENTRY-DATE
  4349           COMPUTE WS-LF-PRM = WS-LF-PRM
  4350              + (WS-AMT / +1000 * CR-LFPRM-RATE)
  4351           IF CR-LFAMT-ALT > +0
  4352              COMPUTE WS-AH-PRM = WS-AH-PRM +
  4353                (WS-AMT - (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4354                ** (WS-WORK-TERM - WS-A + 1)))) *
  4355                (CR-AHPRM-RATE / 1000)
  4356           ELSE
  4357              COMPUTE WS-AH-PRM = WS-AH-PRM
  4358                + (WS-AMT / +1000 * CR-AHPRM-RATE)
  4359           END-IF
  4360*          MOVE WS-LF-PRM           TO WS-DISPLAY-FLD
  4361*          DISPLAY ' WS LFPRM ' WS-DISPLAY-FLD
  4362           COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4363           COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4364        ELSE
  4365           COMPUTE WS-LF-PRM = WS-AMT * CR-LFPRM-RATE / +1000
  4366           IF CR-LFAMT-ALT > +0
  4367              COMPUTE WS-AH-PRM =
  4368                (WS-AMT - (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4369                ** (WS-WORK-TERM - WS-A + 1)))) *
  4370                (CR-AHPRM-RATE / 1000)
  4371           ELSE
  4372              COMPUTE WS-AH-PRM = WS-AMT * CR-AHPRM-RATE / +1000
  4373           END-IF
  4374        END-IF
  4375        IF (CREDIT-LF-CANCEL)
  4376           AND (WS-LF-CAN-TERM > +0)
  4377           AND (WS-A NOT < WS-LF-MIN-TERM)
  4378           AND (WS-A NOT > WS-LF-MAX-TERM)
  4379           MOVE WS-A             TO WS-DISPLAY-FLD
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  83
* ECS056.cbl
  4380           DISPLAY ' FOUND LF ADJUST ' CR-ACCT-CONTROL
  4381              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4382           MOVE WS-LF-PRM        TO WS-DISPLAY-FLD
  4383           DISPLAY '  LF REFUND ' WS-DISPLAY-FLD
  4384           COMPUTE WS-LF-REF = WS-LF-REF + WS-LF-PRM
  4385        END-IF
  4386        IF (CREDIT-AH-CANCEL)
  4387           AND (WS-AH-CAN-TERM > +0)
  4388           AND (WS-A NOT < WS-AH-MIN-TERM)
  4389           AND (WS-A NOT > WS-AH-MAX-TERM)
  4390           MOVE WS-A             TO WS-DISPLAY-FLD
  4391           DISPLAY ' FOUND AH ADJUST ' CR-ACCT-CONTROL
  4392              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4393           MOVE WS-AH-PRM        TO WS-DISPLAY-FLD
  4394           DISPLAY '  AH REFUND ' WS-DISPLAY-FLD
  4395           COMPUTE WS-AH-REF = WS-AH-REF + WS-AH-PRM
  4396        END-IF
  4397     END-PERFORM
  4398
  4399     IF (WS-LF-REF > +0)
  4400        OR (WS-AH-REF > +0)
  4401        COMPUTE WS-EXP-PREM = (WS-LF-REF + WS-AH-REF) * -1
  4402     ELSE
  4403        COMPUTE WS-EXP-PREM = (WS-LF-PRM + WS-AH-PRM)
  4404     END-IF
  4405
  4406     MOVE +0                     TO WS-BASE-COMM
  4407                                    WS-GA-COMM
  4408     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  4409        (X1 > +10)
  4410        IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  4411           COMPUTE WS-BASE-COMM = WS-BASE-COMM
  4412*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4413*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4414           + (WS-LF-PRM / (1 - CR-LCOM-L (X1))
  4415              * CR-LCOM-L (X1))
  4416           + (WS-AH-PRM / (1 - CR-LCOM-AH (X1))
  4417              * CR-LCOM-AH (X1))
  4418
  4419
  4420
  4421
  4422        END-IF
  4423        IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  4424           COMPUTE WS-GA-COMM = WS-GA-COMM
  4425*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4426*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4427           + (WS-LF-PRM / (1 - CR-LCOM-L (X1))
  4428              * CR-LCOM-L (X1))
  4429           + (WS-AH-PRM / (1 - CR-LCOM-AH (X1))
  4430              * CR-LCOM-AH (X1))
  4431        END-IF
  4432     END-PERFORM
  4433     .
  4434
  4435 0230-EXIT.
  4436     EXIT.
  4437
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  84
* ECS056.cbl
  4438 0240-CALC-SRP.
  4439
  4440     DISPLAY ' MADE IT TO 0240 ' CR-CERT-NO
  4441
  4442     COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
  4443
  4444     IF CR-LOAN-TERM NOT NUMERIC
  4445        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4446     END-IF
  4447     IF CR-LOAN-TERM = ZEROS
  4448        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4449     END-IF
  4450     IF CR-LOAN-TERM = ZEROS
  4451        MOVE CR-AH-TERM          TO CR-LOAN-TERM
  4452     END-IF
  4453
  4454     COMPUTE WS-I = CR-APR / +1200
  4455
  4456     COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4457        + (CR-AHPRM-RATE / +1000))
  4458
  4459     COMPUTE WS-K = WS-I + (CR-LFPRM-RATE / +1000)
  4460
  4461     COMPUTE WS-Y = (1 + (WS-DAYS-TO-1ST * WS-K / 30))
  4462        / (1 + WS-K)
  4463
  4464     COMPUTE WS-ANGLEMK = ((1 - ((1 + WS-K)
  4465        ** (WS-WORK-TERM * -1))) / WS-K)
  4466
  4467     IF CR-LFAMT = ZEROS
  4468*        COMPUTE CR-LFAMT = CR-AHAMT * WS-ANGLEM
  4469         COMPUTE CR-LFAMT = CR-AHAMT * WS-ANGLEMK
  4470     END-IF
  4471     MOVE CR-LFAMT               TO WS-AMT
  4472
  4473     MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4474*     DISPLAY ' WS Anglem 240 ' WS-DISPLAY-FLD
  4475     MOVE WS-ANGLEMk             TO WS-DISPLAY-FLD
  4476*     DISPLAY ' WS Anglemk 240 ' WS-DISPLAY-FLD
  4477
  4478     COMPUTE WS-P = WS-AMT / ((WS-ANGLEMK / WS-Y)
  4479        - ((((WS-WORK-TERM - WS-ANGLEMK) / WS-K)
  4480        * CR-AHPRM-RATE / 1000)
  4481        + WS-ANGLEMK / WS-Y * (WS-DAYS-TO-1ST - 30) / 30
  4482        * CR-AHPRM-RATE / 1000))
  4483
  4484     MOVE +0                     TO WS-LF-PRM
  4485                                    WS-AH-PRM
  4486                                    WS-LF-REF
  4487                                    WS-AH-REF
  4488                                    WS-LF-MIN-TERM
  4489                                    WS-LF-MAX-TERM
  4490                                    WS-AH-MIN-TERM
  4491                                    WS-AH-MAX-TERM
  4492                                    WS-LINS WS-DINS
  4493                                    WS-FLINS WS-FDINS
  4494                                    WS-INT   WS-FINT
  4495     IF WS-LF-CAN-TERM > +0
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  85
* ECS056.cbl
  4496        COMPUTE WS-LF-MIN-TERM = WS-EARN-TERM - WS-LF-CAN-TERM
  4497        COMPUTE WS-LF-MAX-TERM = WS-LF-MIN-TERM + WS-LF-CAN-TERM
  4498           - +1
  4499     END-IF
  4500
  4501     IF WS-AH-CAN-TERM > +0
  4502        COMPUTE WS-AH-MIN-TERM = WS-EARN-TERM - WS-AH-CAN-TERM
  4503        COMPUTE WS-AH-MAX-TERM = WS-AH-MIN-TERM + WS-AH-CAN-TERM
  4504           - +1
  4505     END-IF
  4506
  4507***  THE BELOW 3 FIELDS ARE FOR CALCULATING THE FEES AND INT
  4508***  FOR THE TIME BETWEEN THE EFF DATE AND 1ST PMT DATE ONLY
  4509
  4510     COMPUTE WS-FINT = WS-AMT * (1 + WS-I *
  4511        (WS-DAYS-TO-1ST - 30) / 30) - WS-AMT
  4512
  4513     COMPUTE WS-FLINS = WS-AMT * CR-LFPRM-RATE / 1000
  4514        * (WS-DAYS-TO-1ST - 30) / 30
  4515
  4516     COMPUTE WS-FDINS = WS-P * WS-WORK-TERM * CR-AHPRM-RATE
  4517        / 1000 * (WS-DAYS-TO-1ST - 30) / 30
  4518
  4519     IF CR-ACCOUNT = '0005500363'
  4520*    IF CR-CERT-NO = '0126880300 ' OR '0018664366 '
  4521     MOVE WS-INIT-DB-EXTRACT     TO DEBUG-EXTRACT-RECORD
  4522     MOVE CR-ACCOUNT             TO DB-ACCOUNT
  4523     MOVE CR-CERT-NO             TO DB-CERT-NO
  4524
  4525     MOVE CR-DT                  TO WS-ISSUE-DATE
  4526     MOVE WS-ISSUE-MMDD (1:2)    TO DB-EFF-DATE (1:2)
  4527     MOVE '-'                    TO DB-EFF-DATE (3:1)
  4528                                    DB-EFF-DATE (6:1)
  4529     MOVE WS-ISSUE-MMDD (3:2)    TO DB-EFF-DATE (4:2)
  4530     MOVE WS-ISSUE-CCYY          TO DB-EFF-DATE (7:4)
  4531     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  4532     MOVE WS-ENTRY-MMDD (1:2)    TO DB-ENT-DATE (1:2)
  4533     MOVE '-'                    TO DB-ENT-DATE (3:1)
  4534                                    DB-ENT-DATE (6:1)
  4535     MOVE WS-ENTRY-MMDD (3:2)    TO DB-ENT-DATE (4:2)
  4536     MOVE WS-ENTRY-CCYY          TO DB-ENT-DATE (7:4)
  4537     MOVE RUN-DATE               TO WS-ENTRY-DATE
  4538     MOVE WS-ENTRY-MMDD (1:2)    TO DB-VAL-DATE (1:2)
  4539     MOVE '-'                    TO DB-VAL-DATE (3:1)
  4540                                    DB-VAL-DATE (6:1)
  4541     MOVE WS-ENTRY-MMDD (3:2)    TO DB-VAL-DATE (4:2)
  4542     MOVE WS-ENTRY-CCYY          TO DB-VAL-DATE (7:4)
  4543     MOVE ZEROS                  TO DB-PERIOD
  4544     MOVE WS-P                   TO DB-PAYMENT
  4545     MOVE ZEROS                  TO DB-PRINC
  4546     MOVE WS-FINT                TO DB-INTEREST
  4547     MOVE WS-FLINS               TO DB-LINS
  4548     MOVE WS-FDINS               TO DB-DINS
  4549     MOVE WS-AMT                 TO DB-BALANCE
  4550     MOVE CR-LFTYP               TO DB-LF-BEN-CODE
  4551     MOVE CR-AHTYP               TO DB-AH-BEN-CODE
  4552     MOVE CR-LF-TERM             TO DB-LF-TERM
  4553     MOVE CR-AH-TERM             TO DB-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  86
* ECS056.cbl
  4554     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4555     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-LF-EXP-DATE (1:2)
  4556     MOVE '-'                    TO DB-LF-EXP-DATE (3:1)
  4557                                    DB-LF-EXP-DATE (6:1)
  4558     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-LF-EXP-DATE (4:2)
  4559     MOVE WS-EXPIRE-CCYY         TO DB-LF-EXP-DATE (7:4)
  4560
  4561     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4562     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-AH-EXP-DATE (1:2)
  4563     MOVE '-'                    TO DB-AH-EXP-DATE (3:1)
  4564                                    DB-AH-EXP-DATE (6:1)
  4565     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-AH-EXP-DATE (4:2)
  4566     MOVE WS-EXPIRE-CCYY         TO DB-AH-EXP-DATE (7:4)
  4567     WRITE DEBUG-EXTRACT-RECORD
  4568     END-IF
  4569
  4570     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4571        (WS-A > WS-EARN-TERM)
  4572
  4573        IF RUN-DATE = CR-ENTRY-DATE
  4574           COMPUTE WS-LINS = WS-LINS + WS-FLINS
  4575              + (WS-AMT / 1000 * CR-LFPRM-RATE)
  4576           COMPUTE WS-DINS = WS-DINS + WS-FDINS
  4577              + (WS-WORK-TERM - WS-A + 1) * WS-P
  4578              * CR-AHPRM-RATE / 1000
  4579           COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4580           COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4581        ELSE
  4582           COMPUTE WS-LINS = WS-FLINS
  4583              + (WS-AMT / 1000 * CR-LFPRM-RATE)
  4584           COMPUTE WS-DINS = WS-FDINS
  4585              + (WS-WORK-TERM - WS-A + 1) * WS-P
  4586              * CR-AHPRM-RATE / 1000
  4587        END-IF
  4588
  4589        COMPUTE WS-INT = WS-AMT * WS-I
  4590        COMPUTE WS-INT = WS-INT + WS-FINT
  4591
  4592        IF WS-A = +1
  4593           COMPUTE WS-AMT = WS-AMT - WS-P + WS-LINS
  4594              + WS-DINS + WS-INT
  4595        ELSE
  4596           COMPUTE WS-AMT = WS-AMT -
  4597             (WS-P - WS-INT - WS-LINS - WS-DINS)
  4598        END-IF
  4599
  4600
  4601        IF (CREDIT-LF-CANCEL)
  4602           AND (WS-LF-CAN-TERM > +0)
  4603           AND (WS-A NOT < WS-LF-MIN-TERM)
  4604           AND (WS-A NOT > WS-LF-MAX-TERM)
  4605           MOVE WS-A             TO WS-DISPLAY-FLD
  4606           DISPLAY ' FOUND LF ADJUST ' CR-ACCT-CONTROL
  4607              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4608           MOVE WS-LINS          TO WS-DISPLAY-FLD
  4609           DISPLAY '  LF REFUND ' WS-DISPLAY-FLD
  4610           COMPUTE WS-LF-REF = WS-LF-REF + WS-LINS
  4611        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  87
* ECS056.cbl
  4612        IF (CREDIT-AH-CANCEL)
  4613           AND (WS-AH-CAN-TERM > +0)
  4614           AND (WS-A NOT < WS-AH-MIN-TERM)
  4615           AND (WS-A NOT > WS-AH-MAX-TERM)
  4616           MOVE WS-A             TO WS-DISPLAY-FLD
  4617           DISPLAY ' FOUND AH ADJUST ' CR-ACCT-CONTROL
  4618              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4619           MOVE WS-DINS          TO WS-DISPLAY-FLD
  4620           DISPLAY '  AH REFUND ' WS-DISPLAY-FLD
  4621           COMPUTE WS-AH-REF = WS-AH-REF + WS-DINS
  4622        END-IF
  4623
  4624
  4625
  4626        MOVE +0                  TO WS-FLINS
  4627                                    WS-FDINS
  4628                                    WS-FINT
  4629
  4630
  4631     IF CR-ACCOUNT = '0005500363'
  4632*    IF CR-CERT-NO = '0126880300 ' OR '0018664366 '
  4633     MOVE WS-INIT-DB-EXTRACT     TO DEBUG-EXTRACT-RECORD
  4634     MOVE CR-ACCOUNT             TO DB-ACCOUNT
  4635     MOVE CR-CERT-NO             TO DB-CERT-NO
  4636
  4637     MOVE CR-DT                  TO WS-ISSUE-DATE
  4638     MOVE WS-ISSUE-MMDD (1:2)    TO DB-EFF-DATE (1:2)
  4639     MOVE '-'                    TO DB-EFF-DATE (3:1)
  4640                                    DB-EFF-DATE (6:1)
  4641     MOVE WS-ISSUE-MMDD (3:2)    TO DB-EFF-DATE (4:2)
  4642     MOVE WS-ISSUE-CCYY          TO DB-EFF-DATE (7:4)
  4643     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  4644     MOVE WS-ENTRY-MMDD (1:2)    TO DB-ENT-DATE (1:2)
  4645     MOVE '-'                    TO DB-ENT-DATE (3:1)
  4646                                    DB-ENT-DATE (6:1)
  4647     MOVE WS-ENTRY-MMDD (3:2)    TO DB-ENT-DATE (4:2)
  4648     MOVE WS-ENTRY-CCYY          TO DB-ENT-DATE (7:4)
  4649     MOVE RUN-DATE               TO WS-ENTRY-DATE
  4650     MOVE WS-ENTRY-MMDD (1:2)    TO DB-VAL-DATE (1:2)
  4651     MOVE '-'                    TO DB-VAL-DATE (3:1)
  4652                                    DB-VAL-DATE (6:1)
  4653     MOVE WS-ENTRY-MMDD (3:2)    TO DB-VAL-DATE (4:2)
  4654     MOVE WS-ENTRY-CCYY          TO DB-VAL-DATE (7:4)
  4655     MOVE WS-A                   TO DB-PERIOD
  4656     MOVE WS-P                   TO DB-PAYMENT
  4657     COMPUTE DB-PRINC = WS-P - WS-INT - WS-LINS - WS-DINS
  4658     MOVE WS-INT                 TO DB-INTEREST
  4659     MOVE WS-LINS                TO DB-LINS
  4660     MOVE WS-DINS                TO DB-DINS
  4661     MOVE WS-AMT                 TO DB-BALANCE
  4662     MOVE CR-LFTYP               TO DB-LF-BEN-CODE
  4663     MOVE CR-AHTYP               TO DB-AH-BEN-CODE
  4664     MOVE CR-LF-TERM             TO DB-LF-TERM
  4665     MOVE CR-AH-TERM             TO DB-AH-TERM
  4666     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4667     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-LF-EXP-DATE (1:2)
  4668     MOVE '-'                    TO DB-LF-EXP-DATE (3:1)
  4669                                    DB-LF-EXP-DATE (6:1)
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  88
* ECS056.cbl
  4670     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-LF-EXP-DATE (4:2)
  4671     MOVE WS-EXPIRE-CCYY         TO DB-LF-EXP-DATE (7:4)
  4672
  4673     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4674     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-AH-EXP-DATE (1:2)
  4675     MOVE '-'                    TO DB-AH-EXP-DATE (3:1)
  4676                                    DB-AH-EXP-DATE (6:1)
  4677     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-AH-EXP-DATE (4:2)
  4678     MOVE WS-EXPIRE-CCYY         TO DB-AH-EXP-DATE (7:4)
  4679
  4680     WRITE DEBUG-EXTRACT-RECORD
  4681     END-IF
  4682     END-PERFORM
  4683
  4684     IF (WS-LF-REF > +0)
  4685        OR (WS-AH-REF > +0)
  4686        COMPUTE WS-EXP-PREM = (WS-LF-REF + WS-AH-REF) * -1
  4687     ELSE
  4688        COMPUTE WS-EXP-PREM = (WS-LINS + WS-DINS)
  4689     END-IF
  4690
  4691     MOVE +0                     TO WS-BASE-COMM
  4692                                    WS-GA-COMM
  4693     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  4694        (X1 > +10)
  4695        IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  4696           COMPUTE WS-BASE-COMM = WS-BASE-COMM
  4697*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4698*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4699           + (WS-LINS / (1 - CR-LCOM-L (X1))
  4700              * CR-LCOM-L (X1))
  4701           + (WS-DINS / (1 - CR-LCOM-AH (X1))
  4702              * CR-LCOM-AH (X1))
  4703
  4704
  4705
  4706
  4707        END-IF
  4708        IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  4709           COMPUTE WS-GA-COMM = WS-GA-COMM
  4710*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4711*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4712           + (WS-LINS / (1 - CR-LCOM-L (X1))
  4713              * CR-LCOM-L (X1))
  4714           + (WS-DINS / (1 - CR-LCOM-AH (X1))
  4715              * CR-LCOM-AH (X1))
  4716        END-IF
  4717     END-PERFORM
  4718     .
  4719
  4720 0240-EXIT.
  4721     EXIT.
  4722
  4723 0250-BREAK-RTN.
  4724
  4725*    DISPLAY ' MADE IT TO 0250      BREAK '
  4726     IF WS-HOLD-CAR NOT = CR-CARRIER
  4727        PERFORM 0300-ACCT-BREAK  THRU 0300-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  89
* ECS056.cbl
  4728        PERFORM 0310-ST-BREAK    THRU 0310-EXIT
  4729        PERFORM 0320-GRP-BREAK   THRU 0320-EXIT
  4730        PERFORM 0330-CAR-BREAK   THRU 0330-EXIT
  4731     ELSE
  4732        IF WS-HOLD-GRP NOT = CR-GROUPING
  4733           PERFORM 0300-ACCT-BREAK
  4734                                 THRU 0300-EXIT
  4735           PERFORM 0310-ST-BREAK THRU 0310-EXIT
  4736           PERFORM 0320-GRP-BREAK
  4737                                 THRU 0320-EXIT
  4738        ELSE
  4739           IF WS-HOLD-ST NOT = CR-STATE
  4740              PERFORM 0300-ACCT-BREAK
  4741                                 THRU 0300-EXIT
  4742              PERFORM 0310-ST-BREAK
  4743                                 THRU 0310-EXIT
  4744           ELSE
  4745              IF WS-HOLD-ACCT NOT = CR-ACCOUNT
  4746                 PERFORM 0300-ACCT-BREAK
  4747                                 THRU 0300-EXIT
  4748              END-IF
  4749           END-IF
  4750        END-IF
  4751     END-IF
  4752     .
  4753 0250-EXIT.
  4754     EXIT.
  4755
  4756 0300-ACCT-BREAK.
  4757
  4758*    DISPLAY ' MADE IT TO 0300 ACCT BREAK '
  4759     IF (WS-TOT-EXP-PREM (1) = ZEROS)
  4760        AND (WS-TOT-REC-PREM (1) = ZEROS)
  4761        AND (WS-TOT-GA-COMM (1) = ZEROS)
  4762        CONTINUE
  4763     ELSE
  4764        MOVE SPACES              TO DETAIL-LINE
  4765        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4766        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4767        MOVE WS-HOLD-ST          TO DTL1-ST
  4768        MOVE WS-HOLD-ACCT        TO DTL1-ACCT
  4769        MOVE WS-TOT-EXP-PREM (1) TO DTL1-EXP-PREM
  4770        MOVE WS-TOT-REC-PREM (1) TO DTL1-REC-PREM
  4771        MOVE WS-TOT-GA-COMM (1)  TO DTL1-COMM
  4772        MOVE DETAIL-LINE         TO P-DATA
  4773        MOVE SPACE-1             TO P-CTL
  4774        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4775
  4776        COMPUTE WS-TOT-EXP-PREM (2) = WS-TOT-EXP-PREM (2)
  4777           + WS-TOT-EXP-PREM (1)
  4778        COMPUTE WS-TOT-REC-PREM (2) = WS-TOT-REC-PREM (2)
  4779           + WS-TOT-REC-PREM (1)
  4780        COMPUTE WS-TOT-GA-COMM (2) = WS-TOT-GA-COMM (2)
  4781           + WS-TOT-GA-COMM (1)
  4782     END-IF
  4783     MOVE +0                     TO WS-TOT-EXP-PREM (1)
  4784                                    WS-TOT-REC-PREM (1)
  4785                                    WS-TOT-GA-COMM  (1)
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  90
* ECS056.cbl
  4786
  4787     .
  4788 0300-EXIT.
  4789     EXIT.
  4790
  4791 0310-ST-BREAK.
  4792
  4793*    DISPLAY ' MADE IT TO 0310  ST  BREAK '
  4794     IF (WS-TOT-EXP-PREM (2) = ZEROS)
  4795        AND (WS-TOT-REC-PREM (2) = ZEROS)
  4796        AND (WS-TOT-GA-COMM (2) = ZEROS)
  4797        CONTINUE
  4798     ELSE
  4799        MOVE SPACES              TO DETAIL-LINE
  4800        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4801        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4802        MOVE WS-HOLD-ST          TO DTL1-ST
  4803        MOVE SPACES              TO DTL1-ACCT
  4804        MOVE WS-TOT-EXP-PREM (2) TO DTL1-EXP-PREM
  4805        MOVE WS-TOT-REC-PREM (2) TO DTL1-REC-PREM
  4806        MOVE WS-TOT-GA-COMM (2)  TO DTL1-COMM
  4807        MOVE DETAIL-LINE         TO P-DATA
  4808        MOVE SPACE-2             TO P-CTL
  4809        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4810
  4811        COMPUTE WS-TOT-EXP-PREM (3) = WS-TOT-EXP-PREM (3)
  4812           + WS-TOT-EXP-PREM (2)
  4813        COMPUTE WS-TOT-REC-PREM (3) = WS-TOT-REC-PREM (3)
  4814           + WS-TOT-REC-PREM (2)
  4815        COMPUTE WS-TOT-GA-COMM (3) = WS-TOT-GA-COMM (3)
  4816           + WS-TOT-GA-COMM (2)
  4817     END-IF
  4818
  4819     MOVE +0                     TO WS-TOT-EXP-PREM (2)
  4820                                    WS-TOT-REC-PREM (2)
  4821                                    WS-TOT-GA-COMM  (2)
  4822
  4823     .
  4824 0310-EXIT.
  4825     EXIT.
  4826
  4827 0320-GRP-BREAK.
  4828
  4829*    DISPLAY ' MADE IT TO 0320 GRP  BREAK '
  4830     IF (WS-TOT-EXP-PREM (3) = ZEROS)
  4831        AND (WS-TOT-REC-PREM (3) = ZEROS)
  4832        AND (WS-TOT-GA-COMM (3) = ZEROS)
  4833        CONTINUE
  4834     ELSE
  4835        MOVE SPACES              TO DETAIL-LINE
  4836        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4837        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4838        MOVE SPACES              TO DTL1-ST
  4839        MOVE SPACES              TO DTL1-ACCT
  4840        MOVE WS-TOT-EXP-PREM (3) TO DTL1-EXP-PREM
  4841        MOVE WS-TOT-REC-PREM (3) TO DTL1-REC-PREM
  4842        MOVE WS-TOT-GA-COMM (3)  TO DTL1-COMM
  4843        MOVE DETAIL-LINE         TO P-DATA
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  91
* ECS056.cbl
  4844        MOVE SPACE-2             TO P-CTL
  4845        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4846
  4847        COMPUTE WS-TOT-EXP-PREM (4) = WS-TOT-EXP-PREM (4)
  4848           + WS-TOT-EXP-PREM (3)
  4849        COMPUTE WS-TOT-REC-PREM (4) = WS-TOT-REC-PREM (4)
  4850           + WS-TOT-REC-PREM (3)
  4851        COMPUTE WS-TOT-GA-COMM (4) = WS-TOT-GA-COMM (4)
  4852           + WS-TOT-GA-COMM (3)
  4853     END-IF
  4854
  4855     MOVE +0                     TO WS-TOT-EXP-PREM (3)
  4856                                    WS-TOT-REC-PREM (3)
  4857                                    WS-TOT-GA-COMM  (3)
  4858
  4859     .
  4860 0320-EXIT.
  4861     EXIT.
  4862
  4863 0330-CAR-BREAK.
  4864
  4865     DISPLAY ' MADE IT TO 0330 CAR  BREAK '
  4866     IF (WS-TOT-EXP-PREM (4) = ZEROS)
  4867        AND (WS-TOT-REC-PREM (4) = ZEROS)
  4868        AND (WS-TOT-GA-COMM (4) = ZEROS)
  4869        CONTINUE
  4870     ELSE
  4871        MOVE SPACES              TO DETAIL-LINE
  4872        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4873        MOVE SPACES              TO DTL1-GRP
  4874        MOVE SPACES              TO DTL1-ST
  4875        MOVE SPACES              TO DTL1-ACCT
  4876        MOVE WS-TOT-EXP-PREM (4) TO DTL1-EXP-PREM
  4877        MOVE WS-TOT-REC-PREM (4) TO DTL1-REC-PREM
  4878        MOVE WS-TOT-GA-COMM (4)  TO DTL1-COMM
  4879        MOVE DETAIL-LINE         TO P-DATA
  4880        MOVE SPACE-2             TO P-CTL
  4881        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4882
  4883        COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  4884           + WS-TOT-EXP-PREM (4)
  4885        COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  4886           + WS-TOT-REC-PREM (4)
  4887        COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  4888           + WS-TOT-GA-COMM (4)
  4889     END-IF
  4890
  4891     MOVE +0                     TO WS-TOT-EXP-PREM (4)
  4892                                    WS-TOT-REC-PREM (4)
  4893                                    WS-TOT-GA-COMM  (4)
  4894
  4895     .
  4896 0330-EXIT.
  4897     EXIT.
  4898
  4899 0340-FIN-BREAK.
  4900
  4901     DISPLAY ' MADE IT TO 0340 FIN  BREAK '
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  92
* ECS056.cbl
  4902     IF (WS-TOT-EXP-PREM (5) = ZEROS)
  4903        AND (WS-TOT-REC-PREM (5) = ZEROS)
  4904        AND (WS-TOT-GA-COMM (5) = ZEROS)
  4905        CONTINUE
  4906     ELSE
  4907        MOVE SPACES              TO DETAIL-LINE
  4908        MOVE SPACES              TO DTL1-CAR
  4909        MOVE SPACES              TO DTL1-GRP
  4910        MOVE SPACES              TO DTL1-ST
  4911        MOVE SPACES              TO DTL1-ACCT
  4912        MOVE ' GRAND TOTALS '    TO DETAIL-LINE (1:14)
  4913        MOVE WS-TOT-EXP-PREM (5) TO DTL1-EXP-PREM
  4914        MOVE WS-TOT-REC-PREM (5) TO DTL1-REC-PREM
  4915        MOVE WS-TOT-GA-COMM (5)  TO DTL1-COMM
  4916        MOVE DETAIL-LINE         TO P-DATA
  4917        MOVE SPACE-2             TO P-CTL
  4918        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4919
  4920*       COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  4921*          + WS-TOT-EXP-PREM (4)
  4922*       COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  4923*          + WS-TOT-REC-PREM (4)
  4924*       COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  4925*          + WS-TOT-GA-COMM (4)
  4926     END-IF
  4927
  4928     .
  4929 0340-EXIT.
  4930     EXIT.
  4931
  4932
  4933
  4934 0510-GET-REMAINING-TERM.
  4935
  4936     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA
  4937
  4938     .
  4939
  4940 0510-EXIT.
  4941     EXIT.
  4942
  4943 8600-HD-RTN.
  4944
  4945     MOVE +0                     TO LNCTR
  4946     MOVE HD1                    TO  P-DATA
  4947     MOVE SPACE-NP               TO  P-CTL
  4948
  4949     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4950
  4951     ADD +1                      TO  PGCTR
  4952
  4953     MOVE PGCTR                  TO  HD-PG
  4954     MOVE HD2                    TO  P-DATA
  4955     MOVE SPACE-1                TO  P-CTL
  4956
  4957     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4958
  4959     MOVE HD3                    TO  P-DATA
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  93
* ECS056.cbl
  4960     MOVE SPACE-1                TO  P-CTL
  4961
  4962     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4963
  4964     MOVE SPACE-2                TO  P-CTL
  4965     MOVE HD4                    TO  P-DATA
  4966
  4967     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4968
  4969     MOVE HD5                    TO  P-DATA
  4970     MOVE SPACE-1                TO  P-CTL
  4971     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4972
  4973     MOVE SPACES                 TO  P-DATA
  4974     MOVE SPACE-1                TO  P-CTL
  4975     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4976
  4977     MOVE +10                    TO  LNCTR
  4978*    MOVE SPACE-2                TO  P-CTL
  4979
  4980     .
  4981 8699-EXIT.
  4982     EXIT.
  4983
  4984 8800-PRT-RTN.
  4985
  4986     IF LNCTR > +56
  4987        MOVE PRT                 TO WS-HOLD-PRT
  4988        PERFORM 8600-HD-RTN      THRU 8699-EXIT
  4989        MOVE WS-HOLD-PRT         TO PRT
  4990     END-IF
  4991
  4992     MOVE P-CTL                  TO X
  4993     IF P-CTL = SPACE-1
  4994        ADD +1                   TO LNCTR
  4995     ELSE
  4996        IF P-CTL = SPACE-2
  4997           ADD +2                TO LNCTR
  4998        ELSE
  4999           IF P-CTL = SPACE-3
  5000              ADD +3             TO LNCTR
  5001           END-IF
  5002        END-IF
  5003     END-IF
  5004
  5005     .
  5006 8850-COPY-PRT-RTN.
* 5007                                 COPY ELCPRT2.
  5008******************************************************************04/15/98
  5009*                                                                *ELCPRT2
  5010*                                                                *ELCPRT2
  5011*                            ELCPRT2                             *   LV005
  5012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  5013*                            VMOD=2.002                          *   CL**5
  5014*                                                                *   CL**4
  5015******************************************************************   CL**4
  5016                                                                     CL**4
  5017     IF DTE-FICH NOT = SPACE AND                                     CL**4
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  94
* ECS056.cbl (/apps/prod/cid1p/copy/ELCPRT2)
  5018        FICH-OPEN    = SPACE                                         CL**4
  5019         MOVE 'X'                TO  FICH-OPEN                       CL**4
  5020         OPEN OUTPUT FICH.                                           CL**4
  5021                                                                     CL**4
  5022     IF DTE-FICH NOT = SPACE                                         CL**4
  5023         MOVE X                  TO  P-CTL                           CL**4
  5024         WRITE FICH-REC FROM PRT.                                    CL**4
  5025                                                                     CL**4
  5026     IF DTE-FICH = SPACE OR '2'                                      CL**4
  5027       MOVE X                    TO  P-CTL                           CL**4
  5028       IF P-CTL = ' '                                                CL**4
  5029         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  5030       ELSE                                                          CL**4
  5031         IF P-CTL = '0'                                              CL**4
  5032           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  5033         ELSE                                                        CL**4
  5034           IF P-CTL = '-'                                            CL**4
  5035             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  5036           ELSE                                                      CL**4
  5037             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  5038                                                                     CL**4
  5039******************************************************************   CL**4
  5040
  5041 8800-EXIT.
  5042     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Nov-12 09:17 Page  95
* ECS056.cbl
  5044 8510-DATE-CONVERSION.
  5045
  5046     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  5047
  5048     .
  5049
  5050 8590-EXIT.
  5051     EXIT.
  5052
  5053
  5054
  5055
  5056 ABEND-PGM.
* 5057                                 COPY ELCABEND.
  5058***************************************************************** 04/14/98
  5059*                                                               * ELCABEND
  5060*                            ELCABEND.                          *    LV003
  5061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5062*                            VMOD 2.002                              CL**2
  5063*                                                               * ELCABEND
  5064*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  5065*            AND THEN ABENDS.                                   * ELCABEND
  5066*                                                               * ELCABEND
  5067*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  5068*                                                               * ELCABEND
  5069***************************************************************** ELCABEND
  5070*APS-010.                                                         ELCABEND
  5071     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  5072     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  5073                                                                  ELCABEND
  5074     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  5075         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5076         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5077                                 UPON CONSOLE.                    ELCABEND
  5078                                                                  ELCABEND
  5079     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  5080         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5081         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5082                                 UPON CONSOLE.                    ELCABEND
  5083                                                                  ELCABEND
  5084     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5085     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5086                                 UPON CONSOLE.                    ELCABEND
  5087                                                                  ELCABEND
  5088     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  5089     CALL 'ABORTME'.
  5090                                                                  ELCABEND
  5091 APS-EXIT.                                                        ELCABEND
  5092     EXIT.                                                        ELCABEND
  5093
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       73648     Code:       18945
