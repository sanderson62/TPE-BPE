* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS043SL.cbl
* Options: int("ECS043SL.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS043SL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS043SL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ECS043SL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2****************************************************************
     3 IDENTIFICATION DIVISION.
     4
     5 PROGRAM-ID. ECS043SL.
     6*AUTHOR.     Cowtown.
     7
     8*SECURITY.   *****************************************************
     9*            *                                                   *
    10*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    11*            *                                                   *
    12*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    13*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS043SL.cbl
    14*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    15*            *                                                   *
    16*            *****************************************************
    17
    18*REMARKS.    THIS PROGRAM WILL READ THE EP-EC FILE AND PRINT
    19*            EARNED REVIEW STATEMENTS for Service LIfe.
    20
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 060402    2002060300014  SMVA  MOVE PAGE # FROM BOTTOM TO TOP
    30* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY - PRTN043
    31* 090908    2008090300001  AJRA  FIX RETRO CALC FOR COMMISSION
    32*                                FIX DIVIDE BY ZERO
    33* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    34* 011315 CR2014072900001   PEMA  CLONE ECS043 TO MAKE MEP REPORT
    35******************************************************************
    36
    37
    38 ENVIRONMENT DIVISION.
    39 INPUT-OUTPUT SECTION.
    40 FILE-CONTROL.
    41
    42     SELECT  SORT-WORK       ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.
    43     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.
    44     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.
    45     SELECT  eracct          ASSIGN TO ERACCTT
    46                             ACCESS IS SEQUENTIAL
    47                             ORGANIZATION IS INDEXED
    48                             FILE STATUS IS ERACCT-FILE-STATUS
    49                             RECORD KEY IS AM-CONTROL-PRIMARY.
    50     SELECT  ERPLAN-IN       ASSIGN TO ERPLAN
    51                             ORGANIZATION IS INDEXED
    52                             ACCESS IS DYNAMIC
    53                             FILE STATUS IS ERPLAN-FILE-STATUS
    54                             RECORD KEY IS PL-CONTROL-PRIMARY.
    55     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    56     SELECT  INDEX-FILE      ASSIGN TO SYS011
    57        organization line sequential.
    58     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    59
    60 DATA DIVISION.
    61 FILE SECTION.
    62
    63 SD  SORT-WORK.
    64
    65 01  SW-REC-OUT.
    66     05  sw-retro-group          pic x(6).
    67     05  SW-ACCT-KEY.
    68         10  SW-CARRIER          PIC X.
    69         10  SW-GROUP            PIC X(6).
    70         10  SW-STATE            PIC XX.
    71         10  SW-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS043SL.cbl
    72     05  SW-EXP-DTE              PIC 9(8).
    73     05  sw-acct-profile.
    74         10  sw-acct-name        pic x(30).
    75         10  sw-acct-addr1       pic x(30).
    76         10  sw-acct-city-state  pic x(30).
    77         10  sw-acct-zip         pic x(9).
    78         10  sw-acct-rptcd1      pic x(10).
    79         10  sw-acct-rptcd2      pic x(10).
    80         10  sw-acct-rptcd3      pic x(10).
    81     05  sw-accums               PIC X(840).
    82
    83 FD  PRNTR
    84     RECORDING MODE F
    85     LABEL RECORDS OMITTED
    86     BLOCK CONTAINS 0 RECORDS
    87     RECORD CONTAINS 133 CHARACTERS.
    88 01  PRT.
    89     12  P-CTL               PIC  X.
    90     12  P-DATA              PIC  X(150).
    91
    92
    93 FD  EPEC-FILE
*   94                             COPY ECSEPCFD.
    95******************************************************************07/10/97
    96*                                                                *ECSEPCFD
    97*                            ECSEPCFD                            *   LV001
    98*                            VMOD=2.002                          *ECSEPCFD
    99*                                                                *ECSEPCFD
   100*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   101*                                                                *ECSEPCFD
   102******************************************************************ECSEPCFD
   103     RECORDING MODE F                                             ECSEPCFD
   104     LABEL RECORDS STANDARD                                       ECSEPCFD
   105     BLOCK CONTAINS 0 RECORDS
   106     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   107******************************************************************ECSEPCFD
*  108                             COPY ECSEPC01.
   109******************************************************************
   110*                                                                *
   111*                            ECSEPC01                            *
   112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   113*                            VMOD=2.008                          *
   114*                                                                *
   115*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   116*                                                                *
   117*   FILE TYPE = SEQUENTIAL                                       *
   118*   RECORD SIZE = 325  RECFORM = FIXED                           *
   119*                                                                *
   120*   KEY DATA =                                  START=5, LEN=31  *
   121*                                                                *
   122*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   123*                                                                *
   124******************************************************************
   125
   126 01  EP-RECORD.
   127     02 EP-FILE.
   128     12  EP-RECORD-ID                      PIC XX.
   129         88  VALID-EP-ID                      VALUE 'EP'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS043SL.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   130
   131     12  EP-COMPANY-CD                     PIC X.
   132
   133     12  EP-REIN                           PIC X.
   134         88  EP-REIN-EXTRACT                  VALUE 'R'.
   135
   136     12  EP-CONTROL.
   137         16  EP-CNTRL-1.
   138             20  EP-COMPANY.
   139                 24  EP-CARRIER            PIC X.
   140                 24  EP-GROUPING.
   141                     28  EP-GROUP-PREFIX   PIC XXX.
   142                     28  EP-GROUP-PRIME    PIC XXX.
   143             20  EP-STATE                  PIC XX.
   144             20  EP-ACCOUNT.
   145                 24  EP-ACCT-PREFIX        PIC X(4).
   146                 24  EP-ACCT-PRIME         PIC X(6).
   147         16  EP-CNTRL-2.
   148             20  EP-DATES.
   149                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
   150                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
   151
   152     12  EP-REI-CO.
   153         16  EP-REINCO                     PIC XXX.
   154         16  EP-REINCO-SUB                 PIC XXX.
   155
   156     12  EP-RCD-TYPE                       PIC X.
   157         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   158         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   159         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   160         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   161         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   162         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   163     12  EP-BEN-CODE                       PIC XX.
   164     12  FILLER                            PIC X.
   165
   166     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   167     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   168     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   169
   170     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   171     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   172     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   173
   174     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   175     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   176     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   177     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   178
   179     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   180     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   181     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   182
   183     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   184     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   185     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   186
   187     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS043SL.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   188     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   189     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   190     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   191     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   192
   193     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   194     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   195     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   196
   197     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   198     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   199     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   200
   201     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   202         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   203         16  EP-NEW-DATA-IND               PIC X(01).
   204             88  EP-NEW-DATA                   VALUE 'Y'.
   205         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   206         16  FILLER                        PIC X(19).
   207
   208     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
   209     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   210     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   211
   212     12  FILLER                            PIC XXX.
   213
   214     12  EP-UNDERWRITING-CODE              PIC X.
   215         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   216
   217     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
   218
   219     12  FILLER                            PIC X(29).
   220*    12  FILLER                            PIC X(34).
   221
   222     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   223     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   224     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   225     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   226     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   227     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   228
   229     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   230
   231     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   232     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   233
   234     12  EP-PURGE                          PIC X.
   235         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   236
   237     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   238
   239     02 EC-RECORD     REDEFINES     EP-FILE.
   240     12  EC-RECORD-ID                      PIC XX.
   241         88  VALID-EC-ID                      VALUE 'EC'.
   242
   243     12  EC-COMPANY-CD                     PIC X.
   244
   245     12  EC-REIN                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS043SL.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   246         88  EC-REIN-EXTRACT                  VALUE 'R'.
   247
   248     12  EC-CONTROL.
   249         16  EC-CARRIER                    PIC X.
   250         16  EC-GROUPING.
   251             20  EC-GROUP-PREFIX           PIC XXX.
   252             20  EC-GROUP-PRIME            PIC XXX.
   253         16  EC-STATE                      PIC XX.
   254         16  EC-ACCOUNT.
   255             20  EC-ACCT-PREFIX            PIC X(4).
   256             20  EC-ACCT-PRIME             PIC X(6).
   257         16  EC-DATES.
   258             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   259             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   260
   261     12  EC-REI-CO.
   262         16  EC-REINCO                     PIC XXX.
   263         16  EC-REINCO-SUB                 PIC XXX.
   264
   265     12  EC-RCD-TYPE                       PIC X.
   266         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
   267         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   268         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   269         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   270         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   271     12  EC-BEN-CODE                       PIC XX.
   272     12  EC-SEQ-NBR                        PIC X.
   273         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   274         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   275
   276     12  EC-AGENTS-DATA.
   277         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   278             20  EC-AGT-NO.
   279                 24  EC-AGT-PREFIX         PIC X(4).
   280                 24  EC-AGT-PRIME          PIC X(6).
   281             20  EC-AGT-TYPE               PIC X.
   282             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   283             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   284             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   285             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   286             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   287
   288     12  EC-UNDERWRITING-CODE              PIC X.
   289         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   290
   291     12  EC-AGENTS-DATA-II.
   292         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   293             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   294             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   295
   296     12  FILLER                            PIC X(7).
   297
   298     12  EC-PURGE                          PIC X.
   299         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   300
   301     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   302
   303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS043SL.cbl
   304
   305 FD  eracct.
*  306                             COPY ERCACCT.
   307******************************************************************04/19/98
   308*                                                                *ERCACCT
   309*                                                                *ERCACCT
   310*                            ERCACCT                             *   LV031
   311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   312*                            VMOD=2.031                          *ERCACCT
   313*                                                                *ERCACCT
   314*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   315*                                                                *ERCACCT
   316*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   317*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   318*                                                                *ERCACCT
   319*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   320*                                                                *ERCACCT
   321*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   322*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   323*                                                                *ERCACCT
   324*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   325*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   326*                                                                *ERCACCT
   327*   LOG = NO                                                     *ERCACCT
   328*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   329*                                                                *ERCACCT
   330*                                                                *ERCACCT
   331******************************************************************ERCACCT
   332*                   C H A N G E   L O G
   333*
   334* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   335*-----------------------------------------------------------------
   336*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   337* EFFECTIVE    NUMBER
   338*-----------------------------------------------------------------
   339* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   340* 092705    2005050300006  PEMA  ADD SPP LEASES
   341* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   342* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   343* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   344* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   345* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   346******************************************************************
   347                                                                  ERCACCT
   348 01  ACCOUNT-MASTER.                                              ERCACCT
   349     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   350         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   351                                                                  ERCACCT
   352     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   353         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   354         16  AM-MSTR-CNTRL.                                       ERCACCT
   355             20  AM-CONTROL-A.                                    ERCACCT
   356                 24  AM-CARRIER            PIC X.                 ERCACCT
   357                 24  AM-GROUPING.                                 ERCACCT
   358                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   359                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   360                 24  AM-STATE              PIC XX.                ERCACCT
   361                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCACCT)
   362                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   363                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   364             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   365                                           PIC X(19).             ERCACCT
   366             20  AM-CNTRL-B.                                      ERCACCT
   367                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   368                 24  FILLER                PIC X(4).              ERCACCT
   369             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   370                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   371                                                                  ERCACCT
   372     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   373         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   374         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   375         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   376         16  AM-VG-STATE                   PIC XX.                ERCACCT
   377         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   378         16  AM-VG-DATE.                                          ERCACCT
   379             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   380             20  FILLER                    PIC X(4).              ERCACCT
   381         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   382                                           PIC 9(11)      COMP-3. ERCACCT
   383     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   384         16  FILLER                        PIC X(10).
   385         16  AM-VG-KEY3.
   386             20  AM-VG3-ACCOUNT            PIC X(10).
   387             20  AM-VG3-EXP-DT             PIC XX.
   388         16  FILLER                        PIC X(4).
   389     12  AM-MAINT-INFORMATION.                                    ERCACCT
   390         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   391         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   392         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   393         16  FILLER                        PIC XX.                ERCACCT
   394                                                                  ERCACCT
   395     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   396     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   397                                                                  ERCACCT
   398     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   399         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   400         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   401                                                                  ERCACCT
   402     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   403     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   404                                                                  ERCACCT
   405     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   406     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   407                                                                  ERCACCT
   408     12  AM-NAME                           PIC X(30).             ERCACCT
   409     12  AM-PERSON                         PIC X(30).             ERCACCT
   410     12  AM-ADDRS                          PIC X(30).             ERCACCT
   411     12  AM-CITY.
   412         16  AM-ADDR-CITY                  PIC X(28).
   413         16  AM-ADDR-STATE                 PIC XX.
   414     12  AM-ZIP.                                                  ERCACCT
   415         16  AM-ZIP-PRIME.                                        ERCACCT
   416             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   417                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   418             20  FILLER                    PIC X(4).              ERCACCT
   419         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCACCT)
   420     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   421         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   422         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   423         16  FILLER                        PIC XXX.               ERCACCT
   424     12  AM-TEL-NO.                                               ERCACCT
   425         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   426         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   427         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   428     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   429         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   430         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   431                                                                  ERCACCT
   432     12  AM-COMM-STRUCTURE.                                       ERCACCT
   433         16  AM-DEFN-1.                                           ERCACCT
   434             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   435                 24  AM-AGT.                                      ERCACCT
   436                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   437                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   438                 24  AM-COM-TYP            PIC X.                 ERCACCT
   439                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   440                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   441                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   442                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   443                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   444                 24  AM-GL-CODES           PIC X.                 ERCACCT
   445                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   446                 24  FILLER                PIC X(01).             ERCACCT
   447         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   448             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   449                 24  FILLER                PIC X(11).             ERCACCT
   450                 24  AM-L-COMA             PIC XXX.               ERCACCT
   451                 24  AM-J-COMA             PIC XXX.               ERCACCT
   452                 24  AM-A-COMA             PIC XXX.               ERCACCT
   453                 24  FILLER                PIC X(6).              ERCACCT
   454                                                                  ERCACCT
   455     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   456         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   457                                                                  ERCACCT
   458     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   459                                                                  ERCACCT
   460     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   461         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   462         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   463     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   464         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   465         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   466     12  AM-GPCD                           PIC 99.                ERCACCT
   467     12  AM-IG                             PIC X.                 ERCACCT
   468         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   469         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   470     12  AM-STATUS                         PIC X.                 ERCACCT
   471         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   472         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   473         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   474         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   475         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   476         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   477     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCACCT)
   478     12  AM-ID-NO                          PIC X(11).             ERCACCT
   479                                                                  ERCACCT
   480     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   481     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   482     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   483     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   484     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   485     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   486     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   487     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   488     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   489                                                                  ERCACCT
   490     12  AM-USER-FIELDS.                                          ERCACCT
   491         16  AM-FLD-1                      PIC XX.                ERCACCT
   492         16  AM-FLD-2                      PIC XX.                ERCACCT
   493         16  AM-FLD-3                      PIC XX.                ERCACCT
   494         16  AM-FLD-4                      PIC XX.                ERCACCT
   495         16  AM-FLD-5                      PIC XX.                ERCACCT
   496                                                                  ERCACCT
   497     12  AM-1ST-PROD-DATE.                                        ERCACCT
   498         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   499         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   500         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   501     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   502     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   503         16  AM-PUR-YR                     PIC XX.                ERCACCT
   504         16  AM-PUR-MO                     PIC XX.                ERCACCT
   505         16  AM-PUR-DA                     PIC XX.                ERCACCT
   506     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   507     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   508     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   509     12  AM-INACTIVE-DATE.                                        ERCACCT
   510         16  AM-INA-MO                     PIC 99.                ERCACCT
   511         16  AM-INA-DA                     PIC 99.                ERCACCT
   512         16  AM-INA-YR                     PIC 99.                ERCACCT
   513     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   514                                                                  ERCACCT
   515     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   516     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   517                                                                  ERCACCT
   518     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   519         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   520         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   521         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   522         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   523                                                                  ERCACCT
   524     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   525         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   526         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   527                                                                  ERCACCT
   528     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   529                                                                  ERCACCT
   530     12  AM-OVER-SHORT.                                           ERCACCT
   531         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   532         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   533                                                                  ERCACCT
   534     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   535     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCACCT)
   536                                                                  ERCACCT
   537     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   538     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   539                                                                  ERCACCT
   540     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   541     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   542     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   543     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   544     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   545     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   546     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   547     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   548     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   549     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   550     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   551     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   552     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   553     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   554     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   555     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   556                                                                  ERCACCT
   557     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   558                                                                  ERCACCT
   559     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   560     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   561                                                                  ERCACCT
   562     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   563     12  AM-EARN-METHODS.                                         ERCACCT
   564         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   565             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   566             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   567             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   568             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   569         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   570             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   571             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   572             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   573             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   574         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   575             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   576             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   577             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   578             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   579             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   580             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   581                                                                  ERCACCT
   582     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   583     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   584     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   585                                                                  ERCACCT
   586     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   587     12  AM-RET-P-E                        PIC X.                 ERCACCT
   588     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   589     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   590     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   591     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   592         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   593         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCACCT)
   594     12  AM-RETRO-EARNINGS.                                       ERCACCT
   595         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   596         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   597         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   598     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   599         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   600         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   601     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   602         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   603         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   604         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   605     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   606     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   607                                                                  ERCACCT
   608     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   609         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   610         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   611         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   612         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   613         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   614                                                                  ERCACCT
   615     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   616                                                                  ERCACCT
   617     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   618                                                                  ERCACCT
   619     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   620         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   621                                                                  ERCACCT
   622     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   623         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   624         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   625                                                                  ERCACCT
   626     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   627         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   628                                                                  ERCACCT
   629     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   630         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   631         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   632                                                                  ERCACCT
   633     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   634                                                                  ERCACCT
   635     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   636     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   637     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   638     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   639     12  AM-DCC-UEF-STATE                  PIC XX.
   640     12  FILLER                            PIC XXX.
   641     12  AM-REPORT-CODE-3                  PIC X(10).
   642*    12  FILLER                            PIC X(22).             ERCACCT
   643                                                                  ERCACCT
   644     12  AM-RESERVE-DATE.                                         ERCACCT
   645         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   646         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   647         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   648                                                                  ERCACCT
   649     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   650     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   651         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCACCT)
   652         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   653         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   654         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   655                                                                  ERCACCT
   656     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   657         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   658         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   659         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   660         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   661                                                                  ERCACCT
   662     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   663         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   664             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   665             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   666             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   667             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   668             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   669             20  FILLER                    PIC XX.                ERCACCT
   670         16  FILLER                        PIC X(80).             ERCACCT
   671                                                                  ERCACCT
   672     12  AM-TRANSFER-DATA.                                        ERCACCT
   673         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   674             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   675             20  AM-TRNFROM-GROUPING.                             ERCACCT
   676                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   677                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   678             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   679             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   680                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   681                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   682             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   683         16  AM-TRANSFERRED-TO.                                   ERCACCT
   684             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   685             20  AM-TRNTO-GROUPING.                               ERCACCT
   686                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   687                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   688             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   689             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   690                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   691                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   692             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   693         16  FILLER                        PIC X(10).             ERCACCT
   694                                                                  ERCACCT
   695     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   696                                                                  ERCACCT
   697     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   698         16  AM-DEFN-1-SAVED.                                     ERCACCT
   699             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   700                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   701                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   702                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   703                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   704                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   705                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   706                 24  FILLER                PIC X.                 ERCACCT
   707                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   708                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   709                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCACCT)
   710         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   711             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   712                 24  FILLER                PIC X(11).             ERCACCT
   713                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   714                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   715                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   716                 24  FILLER                PIC X(6).              ERCACCT
   717                                                                  ERCACCT
   718     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   719         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   720            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   721            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   722            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   723                                                                  ERCACCT
   724     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   725     12  FILLER                            PIC X(120).            ERCACCT
   726                                                                  ERCACCT
   727     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   728         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   729         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   730             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   731             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   732                                                          COMP-3. ERCACCT
   733             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   734                                                          COMP-3. ERCACCT
   735         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   736             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   737             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   738                                                          COMP-3. ERCACCT
   739             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   740                                                          COMP-3. ERCACCT
   741                                                                  ERCACCT
   742     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   743         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   744         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   745         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   746         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   747             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   748                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   749                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   750             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   751                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   752                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   753             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   754                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   755                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   756         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   757             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   758                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   759                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   760                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   761             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   762                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   763                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   764             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   765                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   766                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   767                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCACCT)
   768     12  AM-COMMENTS.                                             ERCACCT
   769         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   770                                                                  ERCACCT
   771     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   772         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   773         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   774         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   775         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   776         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   777             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   778             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   779             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   780             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   781         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   782             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   783             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   784             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   785         16  FILLER                        PIC X(102).            ERCACCT
   786                                                                  ERCACCT
   787     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   788         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   789             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   790             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   791             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   792             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   793             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   794         16  FILLER                          PIC X(10).           ERCACCT
   795******************************************************************ERCACCT
   796
   797 FD  ERPLAN-IN.
*  798                             COPY ERCPLAN.
   799******************************************************************04/29/98
   800*                                                                *ERCPLAN
   801*                                                                *ERCPLAN
   802*                            ERCPLAN                             *   LV003
   803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   804*                            VMOD=2.003                          *   CL**2
   805*                                                                *ERCPLAN
   806*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
   807*                                                                *ERCPLAN
   808*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
   809*   PLAN MASTER                                                  *ERCPLAN
   810*                                                                *ERCPLAN
   811*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
   812*                                                                *ERCPLAN
   813*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
   814*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
   815*                                                                *ERCPLAN
   816*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
   817*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
   818*                                                                *ERCPLAN
   819*   LOG = NO                                                     *ERCPLAN
   820*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
   821*                                                                *ERCPLAN
   822*                                                                *ERCPLAN
   823******************************************************************ERCPLAN
   824                                                                  ERCPLAN
   825 01  PLAN-MASTER.                                                 ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCPLAN)
   826     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
   827         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
   828                                                                  ERCPLAN
   829     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
   830         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
   831         16  PL-MSTR-CNTRL.                                       ERCPLAN
   832             20  PL-CONTROL-A.                                    ERCPLAN
   833                 24  PL-CARRIER            PIC X.                 ERCPLAN
   834                 24  PL-GROUPING           PIC X(6).              ERCPLAN
   835                 24  PL-STATE              PIC XX.                ERCPLAN
   836                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
   837             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
   838             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
   839             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
   840                                                                  ERCPLAN
   841     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
   842         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
   843         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
   844         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
   845         16  PL-VG-STATE                   PIC XX.                ERCPLAN
   846         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
   847         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
   848         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
   849         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
   850                                                                  ERCPLAN
   851     12  PL-MAINT-INFORMATION.                                    ERCPLAN
   852         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
   853         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
   854         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
   855         16  FILLER                        PIC XX.                ERCPLAN
   856                                                                  ERCPLAN
   857     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
   858         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
   859         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
   860             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
   861             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
   862             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
   863             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
   864                                                                  ERCPLAN
   865     12  FILLER                            PIC X(30).             ERCPLAN
   866                                                                  ERCPLAN
   867     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
   868         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
   869         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
   870         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
   871     12  FILLER                            PIC X(24).             ERCPLAN
   872     12  PL-TOLERANCES.                                           ERCPLAN
   873         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
   874         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
   875         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
   876         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
   877         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
   878         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
   879     12  PL-OVER-SHORT.                                           ERCPLAN
   880         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
   881         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
   882     12  FILLER                            PIC X(24).             ERCPLAN
   883     12  PLAN-MISC.                                               ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS043SL.cbl (/apps/prod/cid1p/copy/ERCPLAN)
   884         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
   885         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   886         16  PL-IG                         PIC X.                 ERCPLAN
   887         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
   888         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
   889         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
   890         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
   891         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
   892         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
   893         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
   894         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   895                                                                  ERCPLAN
   896         16  FILLER                        PIC X(99).             ERCPLAN
   897******************************************************************ERCPLAN
   898
   899 FD  DISK-DATE
*  900                             COPY ELCDTEFD.
   901******************************************************************04/15/98
   902*                                                                *ELCDTEFD
   903*                                                                *ELCDTEFD
   904*                            ELCDTEFD.                           *   LV002
   905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   906*                            VMOD=2.007                          *   CL**2
   907*                                                                *ELCDTEFD
   908******************************************************************ELCDTEFD
   909     BLOCK CONTAINS 0 RECORDS
   910     RECORDING MODE F.                                            ELCDTEFD
   911                                                                  ELCDTEFD
   912 01  DATE-DISK.                                                   ELCDTEFD
   913     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   914     12  FILLER                      PIC  X(14).                  ELCDTEFD
   915     12  DD-CR1                      PIC  9.                      ELCDTEFD
   916     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   917     12  DD-CR2                      PIC  9.                      ELCDTEFD
   918     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   919     12  FILLER                      PIC  X(20).                  ELCDTEFD
   920                                                                  ELCDTEFD
   921 01  DATE-DISK-R.                                                 ELCDTEFD
   922     12  FILLER                      PIC  X(4).                   ELCDTEFD
   923     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   924                                     PIC  X(32).                  ELCDTEFD
   925                                                                  ELCDTEFD
   926 01  DATE-DISK-T.                                                 ELCDTEFD
   927     12  FILLER                      PIC  X(4).                   ELCDTEFD
   928     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   929                                     PIC  X(48).                  ELCDTEFD
   930                                                                  ELCDTEFD
   931 01  DATE-DISK-M.                                                 ELCDTEFD
   932     12  FILLER                      PIC  X(4).                   ELCDTEFD
   933     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   934                                     PIC  X(48).                  ELCDTEFD
   935                                                                  ELCDTEFD
   936 01  DATE-DISK-P.                                                 ELCDTEFD
   937     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   938     12  DD-IDX                      PIC  99.                     ELCDTEFD
   939     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   940     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   941         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   942                                     PIC  X.                      ELCDTEFD
   943         16  FILLER                  PIC  X(46).                  ELCDTEFD
   944     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   945         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   946             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   947             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   948             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   949             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   950         16  FILLER                  PIC  X(16).                  ELCDTEFD
   951                                                                  ELCDTEFD
   952 01  DATE-DISK-E.                                                 ELCDTEFD
   953     12  FILLER                      PIC  X(4).                   ELCDTEFD
   954     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   955                                     PIC  X(4).                   ELCDTEFD
   956                                                                  ELCDTEFD
   957 01  DATE-DISK-C.                                                 ELCDTEFD
   958     12  FILLER                      PIC  X(7).                   ELCDTEFD
   959     12  DD-CARR1-SECPAY-SW          PIC  X.
   960     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   961     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   962     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   963     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   964     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   965     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   966     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   967     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   968     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   969     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   970     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   971     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   972     12  DD-CARR2-SECPAY-SW          PIC  X.
   973     12  FILLER                      PIC  X(7).                   ELCDTEFD
   974                                                                  ELCDTEFD
   975 01  DATE-DISK-OPT.                                               ELCDTEFD
   976     12  FILLER                      PIC  X(04).                  ELCDTEFD
   977     12  DD-TLR-DATA.                                             ELCDTEFD
   978         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   979                                     PIC  X(03).                  ELCDTEFD
   980     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   981         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   982                                     PIC  X(06).                  ELCDTEFD
   983     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   984         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   985                                     PIC  X(07).                  ELCDTEFD
   986         16  FILLER                  PIC  X(05).                  ELCDTEFD
   987     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   988                                     PIC  X(96).                  ELCDTEFD
   989******************************************************************ELCDTEFD
   990
   991 FD  INDEX-FILE
   992     BLOCK CONTAINS 0 RECORDS
   993     RECORDING MODE F.
   994 01  INDEX-FILE-REC              PIC X(70).
   995
   996 FD  FICH
   997     BLOCK CONTAINS 0 RECORDS
   998     RECORDING MODE F.
   999
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS043SL.cbl
  1000 01  FICH-REC                            PIC   X(151).
  1001
  1002
  1003 WORKING-STORAGE SECTION.
  1004
* 1005 EXEC SQL
* 1006    INCLUDE SQLCA
* 1007 END-EXEC
  1008 01 SQLCA.
  1009     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
  1010     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
  1011     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
  1012     05  SQLERRM.
  1013         49  SQLERRML    PIC S9(4) COMP-5.
  1014         49  SQLERRMC    PIC X(70).
  1015     05  SQLERRP         PIC X(8).
  1016     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
  1017     05  SQLWARN.
  1018         10  SQLWARN0    PIC X.
  1019         10  SQLWARN1    PIC X.
  1020         10  SQLWARN2    PIC X.
  1021         10  SQLWARN3    PIC X.
  1022         10  SQLWARN4    PIC X.
  1023         10  SQLWARN5    PIC X.
  1024         10  SQLWARN6    PIC X.
  1025         10  SQLWARN7    PIC X.
  1026     05  SQLEXT.
  1027         10  SQLWARN8    PIC X.
  1028         10  SQLWARN9    PIC X.
  1029         10  SQLWARN10   PIC X.
  1030         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
  1031     05  SQLSTATE    PIC X(5).
  1032
  1033 77  FILLER  PIC X(32) VALUE '********************************'.
  1034 77  FILLER  PIC X(32) VALUE '   ECS043SL WORKING STORAGE     '.
  1035 77  FILLER  PIC X(32) VALUE '***********VMOD=2.020 **********'.
  1036
  1037 77  ws-work-factor              pic s9(3)v9(8) comp-3 value +0.
  1038 77  ws-retro-rpt-cd-3           pic x(10).
  1039 77  ws-ret-grp-sw               pic x value ' '.
  1040     88  active-group              value 'Y'.
  1041 77  ws-recs-in                  pic 9(5) value zeros.
  1042 77  ws-eof-sw                   pic x  value ' '.
  1043     88  end-of-input              value 'Y'.
  1044 77  ws-eracct-sw                pic x value ' '.
  1045     88  end-of-eracct             value 'Y'.
  1046 77  NO-OF-RECORDS-RELEASED  PIC S9(9)      COMP-3  VALUE +0.
  1047 77  NDX                     PIC S999            COMP.
  1048 77  SA                      PIC S999            COMP.
  1049 77  SB                      PIC S999            COMP.
  1050 77  SC                      PIC S999            COMP.
  1051 77  SE                      PIC S999            COMP.
  1052 77  SF                      PIC S999            COMP.
  1053 77  SG                      PIC S999            COMP.
  1054 77  SH                      PIC S999            COMP.
  1055 77  CL                      PIC S999            COMP.
  1056 77  AL                      PIC S999            COMP.
  1057 77  AN                      PIC S999            COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS043SL.cbl
  1058 77  WS-SEQ-NBR              PIC S9              COMP   VALUE +0.
  1059 77  PAGE-CNT                PIC S9(5)           COMP-3 VALUE +0.
  1060 77  LINE-CNT                PIC S999            COMP-3 VALUE +99.
  1061 77  PGM-SUB                 PIC S999            COMP-3 VALUE +43.
  1062 77  X                       PIC X.
  1063 77  BREAK-1-SWITCH          PIC X       VALUE SPACES.
  1064 77  WS-EP-CODE              PIC X.
  1065 77  WS-OB-CODE              PIC X.
  1066 77  ws-work-ep              pic s9(9)v99 comp-3 value +0.
  1067 77  SAVE-DA-UP              PIC S9(9)V99.
  1068 77  SAVE-DA-UC              PIC S9(9)V99.
  1069 77  SAVE-DA-GA-UC           PIC S9(9)V99.
  1070 77  SAVE-DA-PCT-E-PREM      PIC S9(9)V99.
  1071 77  SAVE-DA-PCT-UP          PIC S9(9)V99.
  1072 77  SAVE-BEG-DATE           PIC 9(11)     VALUE ZERO.
  1073 77  WS-RETRO-FLAG           PIC X.
  1074 77  i9                      pic s999 value +0 comp-3.
  1075 77  o9                      pic s999 value +0 comp-3.
  1076 77  i0                      pic s999 value +0 comp-3.
  1077 77  i1                      pic s999 value +0 comp-3.
  1078 77  a1                      pic s999 value +0 comp-3.
  1079 77  d1                      pic s999 value +0 comp-3.
  1080 77  d1m                     pic s999 value +0 comp-3.
  1081 77  ws-rel-recs             pic 9(7) value zeros.
  1082 77  ws-rel-drs              pic 9(7) value zeros.
  1083 77  ws-work-loss-ratio      pic s9(5)v9(5) comp-3 value +0.
  1084
  1085 01  SPACE-LINE                PIC X(132)  VALUE SPACES.
  1086
  1087
  1088
  1089 EXEC SQL
  1090    BEGIN DECLARE SECTION
  1091 END-EXEC
  1092
  1093 01  svr                         pic x(32).
  1094 01  usr                         pic x(32).
  1095 01  pass                        pic x(32).
  1096 01  usr-pass                    pic x(64).
  1097 01  ws-disp-code                pic s9(11).
  1098
  1099 01  table-data.
  1100     12  tb-retro-group          pic x(10).
  1101     12  tb-retro-status         PIC 9(7).
  1102     12  tb-report-code-3        pic x(16).
  1103     12  tb-retro-name           pic x(50).
  1104     12  tb-retro-eff-dte        pic x(30).
  1105     12  tb-retro-next-rpt-mo    pic 99.
  1106
  1107 EXEC SQL
  1108    END DECLARE SECTION
  1109 END-EXEC
  1110
  1111 01  ws-retro-group-table.
  1112     05  ws-retro-table occurs 300 indexed by r1
  1113       ascending key is ws-retro-group.
  1114         10  ws-retro-group      pic x(10).
  1115         10  ws-status           pic 9(5).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS043SL.cbl
  1116         10  ws-report-code-3    pic x(10).
  1117         10  ws-retro-name       pic x(50).
  1118         10  ws-retro-eff-dte    pic x(10).
  1119         10  ws-retro-next-rpt-mo pic 99.
  1120
  1121
  1122 01  index-record.
  1123     05  ir-page-no              pic 9(5)   value zeros.
  1124     05  ir-pool-code            pic x(6)   value spaces.
  1125     05  ir-rptcd1               pic x(10)  value spaces.
  1126     05  ir-rptcd2               pic x(10)  value spaces.
  1127     05  ir-rptcd3               pic x(10)  value spaces.
  1128     05  ir-carrier              pic x      value spaces.
  1129     05  ir-group                pic x(6)   value spaces.
  1130     05  ir-state                pic xx     value spaces.
  1131     05  ir-account              pic x(10)  value spaces.
  1132
  1133 01  WS-ABEND-STORAGE.
  1134     12  WS-RETURN-CODE        PIC S9(4)   VALUE ZERO COMP.
  1135     12  WS-ABEND-MESSAGE      PIC X(80)   VALUE SPACES.
  1136     12  WS-ABEND-FILE-STATUS  PIC XX      VALUE ZERO.
  1137     12  WS-ZERO               PIC S9      VALUE ZERO COMP-3.
  1138
  1139     12  WS-ABEND-CODE         PIC 9(4).
  1140     12  WORK-ABEND-CODE       REDEFINES     WS-ABEND-CODE.
  1141         16  W-ABEND-CODE-1    PIC XX.
  1142         16  W-ABEND-CODE-2    PIC XX.
  1143     12  ERACCT-FILE-STATUS   PIC XX.
  1144     12  ERPLAN-FILE-STATUS    PIC XX.
  1145
  1146 01  WORK-MSG.
  1147     05  FILLER              PIC X    VALUE SPACE.
  1148     05  W-MM                PIC XX.
  1149     05  FILLER              PIC X    VALUE '/'.
  1150     05  W-DD                PIC XX.
  1151     05  FILLER              PIC X    VALUE '/'.
  1152     05  W-CCYY              PIC X(4).
  1153     05  FILLER        PIC X(9)  VALUE ' TO DATE '.
  1154
  1155 01  WS-ACCT-CONTROL.
  1156     12  WS-MSTR-CNTRL       PIC X(25)   VALUE LOW-VALUES.
  1157     12  WS-EFFECT           PIC 9(11)  COMP-3  VALUE ZEROS.
  1158
  1159 01  WS-SAVE-CONTROL.
  1160     12  WS-SAVE-CARR        PIC X.
  1161     12  WS-SAVE-COMP        PIC XXXXXX.
  1162     12  WS-SAVE-STATE       PIC XX.
  1163     12  WS-SAVE-ACCT        PIC X(10).
  1164     12  WS-SAVE-EXP-DATE    PIC 9(11)  COMP-3.
  1165     12  WS-SAVE-EFF-DATE    PIC 9(11)  COMP-3.
  1166
  1167 01  WS-SAVE-CTL.
  1168     12  WS-SAVE-GA          PIC X(10).
  1169     12  WS-SAVE-CAR         PIC X.
  1170     12  WS-SAVE-CMP         PIC XXXXXX.
  1171     12  WS-SAVE-ST          PIC XX.
  1172     12  WS-SAVE-ACC         PIC X(10).
  1173     12  WS-SAVE-EXP         PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS043SL.cbl
  1174
  1175 01  WS-PLAN-CONTROL.
  1176     12  WS-PL-COMPANY-CD    PIC X          VALUE SPACE.
  1177     12  WS-PL-CONTROL-A.
  1178         16  WS-PL-CARRIER       PIC X      VALUE SPACE.
  1179         16  WS-PL-GROUPING      PIC X(6)   VALUE SPACES.
  1180         16  WS-PL-STATE         PIC XX     VALUE SPACES.
  1181         16  WS-PL-ACCOUNT       PIC X(10)  VALUE SPACES.
  1182     12  WS-PL-BENEFIT-TYPE  PIC X          VALUE SPACE.
  1183     12  WS-PL-BENEFIT-CODE  PIC XX         VALUE SPACE.
  1184     12  WS-PL-REVISION-NO   PIC X(3)       VALUE SPACES.
  1185
  1186 01  MISC.
  1187     12  ws-curr-date            pic 9(8).
  1188     12  ws-last-month-end       pic 9(8).
  1189     12  ws-last-month-end-x redefines ws-last-month-end.
  1190         16  ws-lme-ccyy         pic 9(4).
  1191         16  ws-lme-mm           pic 99.
  1192         16  ws-lme-dd           pic 99.
  1193     12  ws-last-year-end        pic 9(8).
  1194     12  ws-last-year-end-x redefines ws-last-year-end.
  1195         16  ws-lye-ccyy         pic 9(4).
  1196         16  ws-lye-mm           pic 99.
  1197         16  ws-lye-dd           pic 99.
  1198     12  RETENT-FACT         PIC S9V9(5)   VALUE +0.
  1199     12  ERP-PERCENT         PIC S9V9(5)   VALUE +0.
  1200     12  EXP-FACTOR          PIC S9V9(5)   VALUE +0.
  1201     12  LIFE-RETENT         PIC S9V9(5)     COMP-3  VALUE +0.
  1202     12  AH-RETENT           PIC S9V9(5)     COMP-3  VALUE +0.
  1203     12  SAVE-RETRO-LIMIT    PIC S9(7)       COMP-3.
  1204     12  ANNUALIZED-PREM     PIC S9(9)V99    COMP-3.
  1205     12  WS-MIN-LOSS         PIC S9(5)V99    COMP-3.
  1206     12  HEAD-SW             PIC X         VALUE SPACE.
  1207     12  NBR-OF-MTHS         PIC 99        VALUE 12.
  1208     12  SAVE-GA-FLAG        PIC X.
  1209     12  SAVE-RET-Y-N        PIC X.
  1210     12  SAVE-RET-TYP        PIC X.
  1211     12  SAVE-PREM-P-E       PIC X.
  1212     12  SAVE-CLMS-P-I       PIC X.
  1213     12  WS-EXCLUSION-SWITCH PIC X             VALUE SPACE.
  1214         88  EXCLUDING-BENEFIT  VALUE '*'.
  1215
  1216 01  BEG-DATE                PIC 9(11).
  1217 01  BEG-DATE-R REDEFINES BEG-DATE.
  1218     12 FILLER               PIC 999.
  1219     12  BD-CCYY             PIC 9(04).
  1220     12  BD-CCYR REDEFINES BD-CCYY.
  1221         16  BD-CC           PIC 99.
  1222         16  BD-YR           PIC 99.
  1223     12  BD-MO               PIC 99.
  1224     12  BD-DA               PIC 99.
  1225
  1226 01  RUN-DT                  PIC 9(11).
  1227 01  RUN-DT-R REDEFINES RUN-DT.
  1228     12  FILLER              PIC 999.
  1229     12  RD-CCYY             PIC 9(04).
  1230     12  RD-CCYR REDEFINES RD-CCYY.
  1231         16  RD-CC           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS043SL.cbl
  1232         16  RD-YR           PIC 99.
  1233     12  RD-MO               PIC 99.
  1234     12  RD-DA               PIC 99.
  1235
  1236 01  WORK-DATE           PIC 9(11).
  1237 01  WORK-DATE-R  REDEFINES  WORK-DATE.
  1238     12  FILLER          PIC 999.
  1239     12  WK-CCYY         PIC 9(04).
  1240     12  WK-CCYR REDEFINES WK-CCYY.
  1241         16  WK-CC       PIC 99.
  1242         16  WK-YR       PIC 99.
  1243     12  WK-MO           PIC 99.
  1244     12  WK-DA           PIC 99.
  1245
  1246 01  ZONE-GROUP.
  1247     03  ZON                 PIC XXX       VALUE 'ZON'.
  1248     03  Z-G                 PIC XXX.
  1249
  1250***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  1251***                                                            ***
  1252***   Occurrence 1   detail (account date range)               ***
  1253***              2   account level totals                      ***
  1254***              3   Retro Group level totals                  ***
  1255***              4   Final report totals                       ***
  1256***                                                            ***
  1257***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  1258
  1259 01  ws-accum-work-area.
  1260    02  ws-accum-record occurs 4.
  1261     05  ws-cur-accums occurs 2.
  1262         10  cur-gross-prem      pic s9(11)v99 comp-3.
  1263         10  cur-cancel-prem     pic s9(11)v99 comp-3.
  1264         10  cur-net-prem        pic s9(11)v99 comp-3.
  1265         10  cur-uep             pic s9(11)v99 comp-3.
  1266         10  cur-earn-prem       pic s9(11)v99 comp-3.
  1267         10  cur-inv-income      pic s9(11)v99 comp-3.
  1268         10  cur-tot-income      pic s9(11)v99 comp-3.
  1269         10  cur-acct-comms      pic s9(11)v99 comp-3.
  1270         10  cur-ow-comms        pic s9(11)v99 comp-3.
  1271         10  cur-ret-fees        pic s9(11)v99 comp-3.
  1272         10  cur-clm-pmts        pic s9(11)v99 comp-3.
  1273         10  cur-prem-tax        pic s9(11)v99 comp-3.
  1274         10  cur-other-expenses  pic s9(11)v99 comp-3.
  1275         10  cur-tot-expenses    pic s9(11)v99 comp-3.
  1276         10  cur-net-cash-flow   pic s9(11)v99 comp-3.
  1277         10  cur-mort-resv       pic s9(11)v99 comp-3.
  1278         10  cur-clm-resv        pic s9(11)v99 comp-3.
  1279         10  cur-net-mep-comm    pic s9(11)v99 comp-3.
  1280         10  cur-retro-pmts      pic s9(11)v99 comp-3.
  1281         10  cur-mep-due         pic s9(11)v99 comp-3.
  1282
  1283     05  ws-lme-accums occurs 2.
  1284         10  lme-gross-prem      pic s9(11)v99 comp-3.
  1285         10  lme-cancel-prem     pic s9(11)v99 comp-3.
  1286         10  lme-net-prem        pic s9(11)v99 comp-3.
  1287         10  lme-uep             pic s9(11)v99 comp-3.
  1288         10  lme-earn-prem       pic s9(11)v99 comp-3.
  1289         10  lme-inv-income      pic s9(11)v99 comp-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS043SL.cbl
  1290         10  lme-tot-income      pic s9(11)v99 comp-3.
  1291         10  lme-acct-comms      pic s9(11)v99 comp-3.
  1292         10  lme-ow-comms        pic s9(11)v99 comp-3.
  1293         10  lme-ret-fees        pic s9(11)v99 comp-3.
  1294         10  lme-clm-pmts        pic s9(11)v99 comp-3.
  1295         10  lme-prem-tax        pic s9(11)v99 comp-3.
  1296         10  lme-other-expenses  pic s9(11)v99 comp-3.
  1297         10  lme-tot-expenses    pic s9(11)v99 comp-3.
  1298         10  lme-net-cash-flow   pic s9(11)v99 comp-3.
  1299         10  lme-mort-resv       pic s9(11)v99 comp-3.
  1300         10  lme-clm-resv        pic s9(11)v99 comp-3.
  1301         10  lme-net-mep-comm    pic s9(11)v99 comp-3.
  1302         10  lme-retro-pmts      pic s9(11)v99 comp-3.
  1303         10  lme-mep-due         pic s9(11)v99 comp-3.
  1304
  1305     05  ws-lye-accums occurs 2.
  1306         10  lye-gross-prem      pic s9(11)v99 comp-3.
  1307         10  lye-cancel-prem     pic s9(11)v99 comp-3.
  1308         10  lye-net-prem        pic s9(11)v99 comp-3.
  1309         10  lye-uep             pic s9(11)v99 comp-3.
  1310         10  lye-earn-prem       pic s9(11)v99 comp-3.
  1311         10  lye-inv-income      pic s9(11)v99 comp-3.
  1312         10  lye-tot-income      pic s9(11)v99 comp-3.
  1313         10  lye-acct-comms      pic s9(11)v99 comp-3.
  1314         10  lye-ow-comms        pic s9(11)v99 comp-3.
  1315         10  lye-ret-fees        pic s9(11)v99 comp-3.
  1316         10  lye-clm-pmts        pic s9(11)v99 comp-3.
  1317         10  lye-prem-tax        pic s9(11)v99 comp-3.
  1318         10  lye-other-expenses  pic s9(11)v99 comp-3.
  1319         10  lye-tot-expenses    pic s9(11)v99 comp-3.
  1320         10  lye-net-cash-flow   pic s9(11)v99 comp-3.
  1321         10  lye-mort-resv       pic s9(11)v99 comp-3.
  1322         10  lye-clm-resv        pic s9(11)v99 comp-3.
  1323         10  lye-net-mep-comm    pic s9(11)v99 comp-3.
  1324         10  lye-retro-pmts      pic s9(11)v99 comp-3.
  1325         10  lye-mep-due         pic s9(11)v99 comp-3.
  1326
  1327 01  filler.
  1328     05  ws-acct-table.
  1329         10  ws-hold-dr-records occurs 30
  1330                                 pic x(972).
  1331
  1332 01  filler.
  1333     05  ws-gross            pic s9(11)v99 comp-3.
  1334     05  ws-cancel           pic s9(11)v99 comp-3.
  1335     05  ws-uep              pic s9(11)v99 comp-3.
  1336     05  ws-clm-pmts         pic s9(11)v99 comp-3.
  1337     05  ws-acct-comms       pic s9(11)v99 comp-3.
  1338     05  ws-ow-comms         pic s9(11)v99 comp-3.
  1339     05  ws-tot-comms        pic s9(11)v99 comp-3.
  1340
  1341 01  COMPARE-DATE-TABLE.
  1342*    05  COMPARE-DTS OCCURS 13 TIMES.
  1343     05  COMPARE-DTS OCCURS 16.
  1344         10  COMPARE-DT.
  1345             15  COMP-CCYY       PIC 9(04).
  1346             15  COMP-CCYR REDEFINES COMP-CCYY.
  1347                 20  COMP-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS043SL.cbl
  1348                 20  COMP-YR     PIC 99.
  1349             15  COMP-MO         PIC 99.
  1350
  1351 01  COMPARE-DATE9TABLE REDEFINES COMPARE-DATE-TABLE.
  1352*    05  COMPARE9DTS OCCURS 13 TIMES.
  1353     05  COMPARE9DTS OCCURS 16.
  1354         10  COMPARE9DT          PIC 9(06).
  1355
  1356 01  TWO-YEARS-AGO               PIC 9(06)  VALUE ZEROS.
  1357 01  TWO-YEAR-ENDS-AGO           PIC 9(06)  VALUE ZEROS.
  1358 01  YEAR-END-DT                 PIC 9(06)  VALUE ZEROS.
  1359
  1360 01  ws-prev-epec-key.
  1361     05  ws-prev-full-key.
  1362         10  ws-prev-retro-group pic x(6).
  1363         10  ws-prev-acct-dr-key.
  1364             15  ws-prev-acct-key.
  1365                 20  ws-prev-carrier  pic x.
  1366                 20  ws-prev-grouping pic x(6).
  1367                 20  ws-prev-state    pic xx.
  1368                 20  ws-prev-account  pic x(10).
  1369             15  ws-prev-exp-dte      pic 9(8).
  1370
  1371 01  ws-comp-epec-key.
  1372     05  ws-comp-full-key.
  1373         10  ws-comp-retro-group pic x(6).
  1374         10  ws-comp-acct-dr-key.
  1375             15  ws-comp-acct-key.
  1376                 20  ws-comp-carrier  pic x.
  1377                 20  ws-comp-grouping pic x(6).
  1378                 20  ws-comp-state    pic xx.
  1379                 20  ws-comp-account  pic x(10).
  1380             15  ws-comp-exp-dte      pic 9(8).
  1381
  1382 01  filler.
  1383     05  ws-acct-name            pic x(30).
  1384     05  ws-acct-addr1           pic x(30).
  1385     05  ws-acct-addr2           pic x(30).
  1386     05  ws-acct-city-state      pic x(30).
  1387     05  ws-acct-zip             pic x(9).
  1388     05  ws-acct-ret-grp         pic x(6).
  1389     05  ws-acct-rptcd1          pic x(10).
  1390     05  ws-acct-rptcd2          pic x(10).
  1391     05  ws-acct-rptcd3          pic x(10).
  1392
  1393 01  HEAD-1.
  1394     12  H1-NAME         PIC X(30)   VALUE SPACES.
  1395     12  FILLER          PIC X(30)   VALUE SPACES.
  1396     12  FILLER          PIC X(30)   VALUE 'CREDIT INSURANCE EARNE
  1397-        'D REVIEW'.
  1398     12  FILLER          PIC X(46)   VALUE SPACES.
  1399     12  FILLER          PIC X(8)    VALUE 'ECS043SL'.
  1400
  1401 01  HEAD-2.
  1402     12  H2-ADDR         PIC X(30)   VALUE SPACES.
  1403     12  FILLER          PIC X(30)   VALUE SPACES.
  1404     12  HD-COMP         PIC X(30)   VALUE SPACES.
  1405     12  FILLER          PIC X(46)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS043SL.cbl
  1406     12  HD-RD           PIC X(8)    VALUE SPACES.
  1407
  1408 01  HEAD-3.
  1409     12  H3-ADDR         PIC X(40)   VALUE SPACES.
  1410*    12  FILLER          PIC X       VALUE SPACES.
  1411*    12  H3-ZIP          PIC X(9)    VALUE SPACES.
  1412     12  FILLER          PIC X(24)   VALUE SPACES.
  1413     12  HD-AD           PIC X(18)   VALUE SPACES.
  1414     12  FILLER          PIC X(54)   VALUE SPACES.
  1415     12  FILLER          PIC X(05)   VALUE
  1416         'PAGE '.
  1417     12  H3-PAGE         PIC ZZZZ9.
  1418
  1419 01  HEAD-4.
  1420     12  H4-STACCT       PIC X(12)   VALUE 'ST ACCOUNT  '.
  1421     12  filler          pic x(95)   value spaces.
  1422     12  filler          pic x(17)   value 'Effective Date:  '.
  1423     12  h4-eff-dte      pic x(10)   value spaces.
  1424
  1425 01  HEAD-5.
  1426     12  H5-ST           PIC XX      VALUE SPACES.
  1427     12  FILLER          PIC X       VALUE SPACES.
  1428     12  H5-ACCT         PIC X(10)   VALUE SPACES.
  1429     12  FILLER          PIC X       VALUE SPACES.
  1430     12  H5-FMO          PIC XX      VALUE SPACES.
  1431     12  H5-FS1          PIC X       VALUE '-'.
  1432     12  H5-FDA          PIC XX      VALUE SPACES.
  1433     12  H5-FS2          PIC X       VALUE ' '.
  1434     12  h5-group        pic x(10)   value spaces.
  1435     12  H5-FYR          PIC XX      VALUE SPACES.
  1436     12  h5-name         pic x(50)   value spaces.
  1437     12  filler          pic x(21)   value spaces.
  1438     12  filler          pic x(21)   value
  1439        '  Next Anniversary:  '.
  1440     12  h5-anniv-dte    pic x(5)    value spaces.
  1441*    12  FILLER          PIC X       VALUE SPACES.
  1442*    12  H5-TMO          PIC XX      VALUE SPACES.
  1443*    12  H5-TS1          PIC X       VALUE ' '.
  1444*    12  H5-TDA          PIC XX      VALUE SPACES.
  1445*    12  H5-TS2          PIC X       VALUE ' '.
  1446*    12  H5-TYR          PIC XX      VALUE SPACES.
  1447*    12  FILLER          PIC X(4)    VALUE SPACES.
  1448*    12  H5-GROUP        PIC X(50)   VALUE SPACES.
  1449*    12  H5-MESSAGE      PIC X       VALUE SPACES.
  1450*    12  END-CHARACTER   PIC X       VALUE ' '.
  1451
  1452 01  head-6.
  1453     05  f                       pic x(49) value spaces.
  1454     05  f                       pic x(13) value 'Current Month'.
  1455     05  F                       pic x(26) value spaces.
  1456     05  f                       pic x(12) value 'Year To Date'.
  1457     05  F                       pic x(24) value spaces.
  1458     05  f                    pic x(17) value 'Inception To Date'.
  1459
  1460 01  head-7.
  1461     05  f                       pic x(146) value '
  1462-    '                                Life                A&H
  1463-    '          Life                A&H               Life
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS043SL.cbl
  1464-    '        A&H'.
  1465
  1466 01  head-8.
  1467     05  f                       pic x(16) value
  1468         ' R e v e n u e s'.
  1469
  1470 01  head-9.
  1471     05  f                       pic x(16) value
  1472         ' E x p e n s e s'.
  1473
  1474 01  head-10.
  1475     05  f                       pic x(24) value
  1476         ' N e t  C a s h  F l o w'.
  1477
  1478 01  DETAIL-DESC-LINE.
  1479     05  det-misc-desc   pic x(30).
  1480 01  DETAIL-LINE.
  1481     05  det-desc        pic x(25).
  1482     05  f               pic x(04).
  1483     05  det-mtd-lf      pic zzz,zzz,zz9-.
  1484     05  f               pic x(5).
  1485     05  det-mtd-ah      pic zzz,zzz,zz9-.
  1486     05  f               pic x(7).
  1487     05  det-ytd-lf      pic zzz,zzz,zz9-.
  1488     05  f               pic x(7).
  1489     05  det-ytd-ah      pic zzz,zzz,zz9-.
  1490     05  f               pic x(6).
  1491     05  det-itd-lf      pic zzz,zzz,zz9-.
  1492     05  f               pic x(6).
  1493     05  det-itd-ah      pic zzz,zzz,zz9-.
  1494     05  f               pic x(6).
  1495     05  det-itd-tot     pic zzz,zzz,zz9-.
  1496
  1497 01  MEP-DETAIL-LINE.
  1498     05  mep-desc        pic x(25).
  1499     05  f               pic x(04).
  1500     05  mep-mtd-lf      pic zzz,zzz,zz9- blank when zero.
  1501     05  f               pic x(5).
  1502     05  mep-mtd-ah      pic zzz,zzz,zz9- blank when zero.
  1503     05  f               pic x(7).
  1504     05  mep-ytd-lf      pic zzz,zzz,zz9- blank when zero.
  1505     05  f               pic x(7).
  1506     05  mep-ytd-ah      pic zzz,zzz,zz9- blank when zero.
  1507     05  f               pic x(6).
  1508     05  mep-itd-lf      pic zzz,zzz,ZZ9- blank when zero.
  1509     05  f               pic x(6).
  1510     05  mep-itd-ah      pic zzz,zzz,ZZ9- blank when zero.
  1511     05  f               pic x(6).
  1512     05  mep-itd-tot     pic zzz,zzz,ZZ9-.
  1513
  1514 01  ilr-DETAIL-LINE.
  1515     05  ilr-desc        pic x(25).
  1516     05  f               pic x(05).
  1517     05  ilr-mtd-lf      pic zzz,zz9.99-.
  1518     05  f               pic x(6).
  1519     05  ilr-mtd-ah      pic zzz,zz9.99-.
  1520     05  f               pic x(8).
  1521     05  ilr-ytd-lf      pic zzz,zz9.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS043SL.cbl
  1522     05  f               pic x(8).
  1523     05  ilr-ytd-ah      pic zzz,zz9.99-.
  1524     05  f               pic x(7).
  1525     05  ilr-itd-lf      pic zzz,ZZ9.99-.
  1526     05  f               pic x(7).
  1527     05  ilr-itd-ah      pic zzz,ZZ9.99-.
  1528     05  f               pic x(7).
  1529     05  ilr-itd-tot     pic zzz,ZZ9.99-.
  1530
* 1531                                 COPY ELCDATE.
  1532******************************************************************06/11/98
  1533*                                                                *ELCDATE
  1534*                                                                *ELCDATE
  1535*                            ELCDATE.                            *   LV023
  1536*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1537*                            VMOD=2.003                           ELCDATE
  1538*                                                                *ELCDATE
  1539*                                                                *ELCDATE
  1540*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1541*                 LENGTH = 200                                   *   CL*19
  1542******************************************************************ELCDATE
  1543                                                                  ELCDATE
  1544 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1545     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1546     12  DC-OPTION-CODE                PIC X.                        CL*15
  1547         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1548         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1549         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1550         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1551         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1552         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1553         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1554         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1555         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1556         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1557         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1558         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1559         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1560         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1561         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1562         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1563         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1564         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1565         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1566         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1567         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1568         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1569         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1570         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1571         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1572         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1573         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1574         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1575         88  THREE-CHARACTER-BIN                                  ELCDATE
  1576                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1577         88  GREGORIAN-TO-BIN                                        CL**2
  1578                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1579         88  BIN-TO-GREGORIAN                                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1580                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1581         88  JULIAN-TO-BINARY                                        CL**2
  1582                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1583     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1584         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1585         88  DATE-CONVERSION-ERROR                                ELCDATE
  1586                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1587         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1588         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1589         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1590         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1591         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1592         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1593         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1594         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1595         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1596         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1597     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1598         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1599     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1600         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1601         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1602         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1603     12  FILLER                        PIC X.                        CL*15
  1604     12  DC-CONVERSION-DATES.                                        CL*15
  1605         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1606         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1607         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1608         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1609                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1610             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1611             20  SLASH1-1              PIC X.                        CL*15
  1612             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1613             20  SLASH1-2              PIC X.                        CL*15
  1614             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1615         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1616         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1617                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1618             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1619             20  SLASH2-1              PIC X.                        CL*15
  1620             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1621             20  SLASH2-2              PIC X.                        CL*15
  1622             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1623         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1624         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1625                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1626             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1627             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1628             20  DC-YMD-DAY            PIC 99.                       CL*15
  1629         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1630         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1631                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1632             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1633             20  DC-MDY-DAY            PIC 99.                       CL*15
  1634             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1635         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1636             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1637             20  DC-ALPHA-DAY          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1638             20  FILLER                PIC XX.                       CL*15
  1639             20  DC-ALPHA-CENTURY.                                   CL*15
  1640                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1641             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1642         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1643         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1644         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1645         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1646         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1647                                       PIC 9(05).                    CL*20
  1648         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1649             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1650             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1651         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1652         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1653         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1654     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1655         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1656         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1657             20  FILLER                PIC 9(3).                     CL*15
  1658             20  HOLD-CEN-1-CCYY.                                    CL*15
  1659                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1660                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1661             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1662             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1663         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1664             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1665             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1666             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1667                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1668                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1669             20  FILLER                PIC 9(3).                     CL*15
  1670         16  HOLD-CENTURY-1-X.                                       CL*15
  1671             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1672             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1673                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1674                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1675             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1676             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1677         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1678             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1679             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1680             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1681                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1682                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1683             20  FILLER                PIC XXX.                      CL*23
  1684         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1685         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1686         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1687         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1688             20  DC-JULIAN-1-CCYY.                                   CL*15
  1689                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1690                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1691             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1692         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1693         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1694             20  DC-JULIAN-2-CCYY.                                   CL*15
  1695                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1696                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1697             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1698         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1699             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1700             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1701             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1702             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1703             20  DC-EDITA-CCYY.                                      CL*15
  1704                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1705                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1706         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1707             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1708             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1709             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1710             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1711             20  DC-EDITB-CCYY.                                      CL*15
  1712                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1713                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1714         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1715         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1716                              DC-GREG-DATE-CYMD.                  ELCDATE
  1717             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1718             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1719             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1720             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1721         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1722         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1723                              DC-GREG-DATE-MDCY.                  ELCDATE
  1724             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1725             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1726             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1727             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1728    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1729        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1730    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1731    12  FILLER                         PIC X(28).                    CL*26
* 1732                                 COPY ELCDTECX.
  1733******************************************************************06/05/98
  1734*                                                                *ELCDTECX
  1735*                            ELCDTECX.                           *   LV005
  1736*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1737*                            VMOD=2.015                          *ELCDTECX
  1738*                                                                *ELCDTECX
  1739*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1740*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1741*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1742*                                                                *ELCDTECX
  1743******************************************************************ELCDTECX
  1744******************************************************************
  1745*                   C H A N G E   L O G
  1746*
  1747* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1748*-----------------------------------------------------------------
  1749*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1750* EFFECTIVE    NUMBER
  1751*-----------------------------------------------------------------
  1752* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1753*                                  BENEFIT CODES FROM 300 TO 900
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1754* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1755* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1756* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1757******************************************************************
  1758 01  DATE-CARD.                                                   ELCDTECX
  1759     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1760     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1761     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1762     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1763     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1764     12  EP-SW                       PIC  X.                      ELCDTECX
  1765         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1766     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1767         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1768     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1769     12  RUN-CENTURY.                                             ELCDTECX
  1770         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1771     12  FILLER                      PIC  X.                         CL**4
  1772     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1773     12  FILLER                      PIC  XXX.                    ELCDTECX
  1774     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1775                                                                  ELCDTECX
  1776 01  FILLER                          PIC  X(7)                       CL**6
  1777                                          VALUE 'OPTIONS'.        ELCDTECX
  1778 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1779     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1780     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1781     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1782         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1783         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1784     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1785     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1786     12  FILLER                      PIC  X.                      ELCDTECX
  1787     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1788     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1789     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1790     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1791     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1792     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1793     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1794     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1795     12  FILLER                      PIC  X.                      ELCDTECX
  1796     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1797     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1798     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1799     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1800     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1801     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1802     12  FILLER                      PIC  X.                      ELCDTECX
  1803     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1804     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1805     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1806     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1807     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1808     12  DTE-R78                     PIC  X.                      ELCDTECX
  1809     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1810     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1811     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1812     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1813     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1814     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1815     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1816                                     PIC  X.                      ELCDTECX
  1817         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1818                                                 ' '.             ELCDTECX
  1819         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1820         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1821     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1822         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1823         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1824     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1825     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1826                                     PIC  9.                         CL**4
  1827     12  DTE-SYSTEM.                                              ELCDTECX
  1828         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1829         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1830         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1831         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1832         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1833         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1834         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1835         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1836         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1837         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1838         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1839         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1840         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1841         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1842         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1843         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1844         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1845         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1846         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1847         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1848         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1849         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1850         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1851         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1852         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1853         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1854     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1855         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1856                                     PIC  X.                      ELCDTECX
  1857     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1858                                                                  ELCDTECX
  1859 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1860     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1861     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1862     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1863*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1864     12  FILLER                      PIC  X.                      ELCDTECX
  1865     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1866     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1867     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1868     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1869     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1870     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1871     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1872                                                                  ELCDTECX
  1873     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1874     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1875     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1876     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1877                                                                  ELCDTECX
  1878     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1879     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1880     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1881     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1882                                                                  ELCDTECX
  1883     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1884     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1885                                                                  ELCDTECX
  1886     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1887     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1888                                                                  ELCDTECX
  1889     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1890                                                                  ELCDTECX
  1891 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1892     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1893     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1894     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1895     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1896     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1897     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1898     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1899                                                                  ELCDTECX
  1900 01  FILLER                          PIC  X(12)                   ELCDTECX
  1901                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1902 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1903     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1904         16  CNT-ID                  PIC  X.                      ELCDTECX
  1905         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1906                                                                  ELCDTECX
  1907 01  FILLER                          PIC  X(11)                   ELCDTECX
  1908                                          VALUE 'STATE NAMES'.    ELCDTECX
  1909 01  STATE-NAMES.                                                 ELCDTECX
  1910     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1911         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1912         16  STATE-PIC1.                                          ELCDTECX
  1913             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1914             20  FILLER              PIC  XXX.                    ELCDTECX
  1915             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1916             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1917             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1918             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1919                                                                  ELCDTECX
  1920 01  FILLER                          PIC  X(13)                   ELCDTECX
  1921                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1922 01  CARRIER-NAMES.                                               ELCDTECX
  1923     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1924         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1925         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1926         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1927         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1928         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1929         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1930*        16  FILLER                  PIC  X.                      ELCDTECX
  1931         16  CARRIER-SEC-PAY         PIC  X.
  1932             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1933                                                                  ELCDTECX
  1934 01  FILLER                          PIC  X(9)                       CL**6
  1935                                          VALUE 'INS TYPES'.      ELCDTECX
  1936 01  CLAS-INS-TYPES.                                              ELCDTECX
  1937*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1938     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1939         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1940         16  CLAS-I-AB3.                                          ELCDTECX
  1941             20  FILLER              PIC  X.                      ELCDTECX
  1942             20  CLAS-I-AB2.                                      ELCDTECX
  1943                 24  FILLER          PIC  X.                      ELCDTECX
  1944                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1945         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1946             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1947             20  FILLER              PIC  X.                         CL**4
  1948         16  CLAS-I-AB10.                                         ELCDTECX
  1949             20  FILLER              PIC  X(9).                   ELCDTECX
  1950             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1951         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1952         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1953         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1954         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1955             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1956         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1957         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1958         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1959         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1960         16  CLAS-I-REFUND-METHOD    PIC  X.
  1961         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1962         16  FILLER                  PIC  XXX.
  1963                                                                  ELCDTECX
  1964 01  FILLER                          PIC  X(16)                   ELCDTECX
  1965                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1966 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1967     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1968                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1969         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1970         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1971         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1972         16  CLAS-MORT-DESC.                                      ELCDTECX
  1973             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1974             20  FILLER              PIC  XX.                        CL**5
  1975             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1976             20  FILLER              PIC  X.                         CL**5
  1977             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1978             20  FILLER              PIC  X.                         CL**5
  1979             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1980             20  FILLER              PIC  X.                         CL**5
  1981             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1982             20  FILLER              PIC  X(5).                      CL**6
  1983                                                                  ELCDTECX
  1984 01  FILLER                          PIC  X(15)                   ELCDTECX
  1985                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1986 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1987     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1988         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1989         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1990         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1991         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1992         16  FILLER                  PIC  X(4).                      CL**6
  1993                                                                  ELCDTECX
  1994 01  FILLER                          PIC  X(7)                       CL**6
  1995                                     VALUE 'INDEXES'.             ELCDTECX
  1996 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1997     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1998     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1999     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2000     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2001     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2002     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2003     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2004     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2005     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2006     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2007     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2008     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2009     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2010     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2011     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2012     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2013     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2014                                                                  ELCDTECX
  2015 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2016     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2017     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2018     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2019     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2020     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2021     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2022     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2023     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2024     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2025     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2026     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2027                                                                  ELCDTECX
  2028 01  FILLER                          PIC  X(13)                   ELCDTECX
  2029                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2030 01  CLAS-MISC.                                                   ELCDTECX
  2031     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2032         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2033         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2034         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2035     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2036     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2037     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2038     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2039     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2040     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2041     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2042     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2043     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2044     12  STATE-L                     PIC  XX.                     ELCDTECX
  2045     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2046     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2047     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2048         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2049         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2050     12  DTE-ABEND-WORK.                                          ELCDTECX
  2051         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2052         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2053                                                                  ELCDTECX
  2054 01  FILLER                          PIC  X(12)                   ELCDTECX
  2055                                     VALUE 'WORKING DATE'.        ELCDTECX
  2056 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2057     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2058         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2059         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2060         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2061     12  WS-CURRENT-DATE.                                         ELCDTECX
  2062         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2063         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2064         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2065         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2066         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2067     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2068         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2069         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2070                                                                  ELCDTECX
  2071 01  FILLER                          PIC  X(12)                   ELCDTECX
  2072                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2073 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2074     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2075         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2076         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2077         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2078                                                                  ELCDTECX
  2079 01  FILLER                          PIC  X(10)                   ELCDTECX
  2080                                     VALUE 'STATE TLRS'.          ELCDTECX
  2081 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2082     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2083         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2084         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2085                                                                  ELCDTECX
  2086 01  FILLER                          PIC  X(13)                   ELCDTECX
  2087                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2088 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2089     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2090         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2091                                                                  ELCDTECX
  2092 01  FILLER                          PIC  X(13)                   ELCDTECX
  2093                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2094 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2095     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2096     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2097     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2098                                     PIC  X.                         CL**5
  2099     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2100     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2101     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2102     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2103     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2104     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2105     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2106     12  FILLER                      PIC  X(75).                  ELCDTECX
  2107******************************************************************ELCDTECX
  2108*01  MISC-CARR-PCT-DATA.                                          00001521
  2109*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2110*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2111*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2112*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2113*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2114*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2115******************************************************************ELCDTECX
* 2116                                 COPY ELCDTEVR.
  2117***************************************************************** 04/15/98
  2118*                                                                *ELCDTEVR
  2119*                                                                *ELCDTEVR
  2120*                            ELCDTEVR.                           *   LV003
  2121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2122*                            VMOD=2.001                          *   CL**2
  2123*                                                                *ELCDTEVR
  2124*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2125*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2126*                                                                *ELCDTEVR
  2127******************************************************************ELCDTEVR
  2128 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2129     05  WS-RUN-DATE.                                             ELCDTEVR
  2130         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2131         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2132         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2133             15  RUN-CC              PIC  99.                     ELCDTEVR
  2134             15  RUN-YR              PIC  99.                     ELCDTEVR
  2135         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2136         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2137     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2138            WS-RUN-DATE              PIC 9(11).                      CL**2
  2139     05  WS-EP-DT.                                                ELCDTEVR
  2140         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2141         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2142         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2143             15  EP-CC               PIC  99.                     ELCDTEVR
  2144             15  EP-YR               PIC  99.                     ELCDTEVR
  2145         10  EP-MO                   PIC  99.                     ELCDTEVR
  2146         10  EP-DA                   PIC  99.                     ELCDTEVR
  2147     05  WS-EP-DT-N REDEFINES                                        CL**2
  2148            WS-EP-DT                 PIC 9(11).                      CL**2
  2149     05  WS-DTE-CONV-DT.                                             CL**4
  2150         10  FILLER                  PIC  9(03).                     CL**4
  2151         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2152         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2153             15  DTE-CONV-CC         PIC  99.                        CL**4
  2154             15  DTE-CONV-YR         PIC  99.                        CL**4
  2155         10  DTE-CONV-MO             PIC  99.                        CL**4
  2156         10  DTE-CONV-DA             PIC  99.                        CL**4
  2157     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2158            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2159 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2160     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2161         10  FILLER                            PIC 999.           ELCDTEVR
  2162         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2163         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2164             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2165             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2166         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2167         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2168     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2169            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2170     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2171         10  FILLER                            PIC 999.           ELCDTEVR
  2172         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2173         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2174         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2175         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2176     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2177            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2178 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2179     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2180         10  FILLER                            PIC 999.           ELCDTEVR
  2181         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2182         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2183             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2184             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2185         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2186         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2187     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2188            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2189     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2190         10  FILLER                            PIC 999.           ELCDTEVR
  2191         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2192         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2193             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2194             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2195         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2196         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2197     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2198            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2199     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2200         10  FILLER                            PIC 999.           ELCDTEVR
  2201         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2202         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2203             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2204             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2205         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2206         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2207     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2208            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2209 01  WS-RATE-RECORD.                                              ELCDTEVR
  2210         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2211             10  FILLER                        PIC 999.           ELCDTEVR
  2212             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2213             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2214                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2215                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2216             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2217             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS043SL.cbl
  2218         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2219                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* 2220                                 COPY ELCACCTV.
  2221******************************************************************04/14/98
  2222*                                                                *ELCACCTV
  2223*                            ELCACCTV                            *   LV002
  2224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2225*                            VMOD=2.001                          *ELCACCTV
  2226*                                                                *ELCACCTV
  2227*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  2228*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  2229*                                                                *ELCACCTV
  2230*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  2231*                                                                *ELCACCTV
  2232******************************************************************ELCACCTV
  2233                                                                  ELCACCTV
  2234 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  2235                                                                  ELCACCTV
  2236     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  2237         10  FILLER            PIC 999.                           ELCACCTV
  2238         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  2239         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  2240             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  2241             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  2242         10  AM-EXP-MO         PIC 99.                               CL**5
  2243         10  AM-EXP-DA         PIC 99.                               CL**5
  2244     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  2245            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  2246     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  2247         10  FILLER                    PIC 999.                   ELCACCTV
  2248         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  2249         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  2250             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  2251             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  2252         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  2253         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  2254     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  2255            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  2256     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  2257         10  FILLER                    PIC 999.                   ELCACCTV
  2258         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  2259         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  2260             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  2261             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  2262         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  2263         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  2264     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  2265            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  2266     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  2267         10 FILLER                     PIC 999.                   ELCACCTV
  2268         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  2269         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  2270            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  2271            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  2272         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  2273         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  2274     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  2275            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2276     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  2277         10 FILLER                     PIC 999.                   ELCACCTV
  2278         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  2279         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  2280            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  2281            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  2282         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  2283         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  2284     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  2285            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  2286     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  2287         10  FILLER                    PIC 999.                   ELCACCTV
  2288         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  2289         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  2290             15  AM-AN-CC              PIC 99.                    ELCACCTV
  2291             15  AM-AN-YR              PIC 99.                    ELCACCTV
  2292         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  2293         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  2294     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  2295            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  2296     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  2297         10  FILLER                    PIC 999.                   ELCACCTV
  2298         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  2299         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  2300             15  AM-HI-CC              PIC 99.                    ELCACCTV
  2301             15  AM-HI-YR              PIC 99.                    ELCACCTV
  2302         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  2303         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  2304     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  2305            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  2306     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  2307         10  FILLER                    PIC 999.                   ELCACCTV
  2308         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  2309         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  2310             15  AM-LO-CC              PIC 99.                    ELCACCTV
  2311             15  AM-LO-YR              PIC 99.                    ELCACCTV
  2312         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  2313         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  2314     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  2315            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  2316     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  2317         10  FILLER                    PIC 999.                   ELCACCTV
  2318         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  2319         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  2320             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  2321             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  2322         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  2323         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  2324     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  2325            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* 2326                                 COPY ELCEPCVR.
  2327******************************************************************05/15/98
  2328*                                                                *ELCEPCVR
  2329*                                                                *ELCEPCVR
  2330*                            ELCEPCVR                            *   LV003
  2331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2332*                            VMOD=2.001                          *ELCEPCVR
  2333*                                                                *ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2334*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2335*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2336*                                                                *ELCEPCVR
  2337******************************************************************ELCEPCVR
  2338 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2339     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2340         10  FILLER            PIC 999.                           ELCEPCVR
  2341         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2342         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2343             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2344             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2345         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2346         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2347     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2348            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2349     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2350         10  FILLER            PIC 999.                              CL**5
  2351         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2352         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2353             15  EC-EXP-CC     PIC 99.                               CL**5
  2354             15  EC-EXP-YR     PIC 99.                               CL**5
  2355         10  EC-EXP-MO         PIC 99.                               CL**5
  2356         10  EC-EXP-DA         PIC 99.                               CL**5
  2357     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2358            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2359     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2360         10  FILLER            PIC 999.                           ELCEPCVR
  2361         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2362         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2363             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2364             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  2365         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2366         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  2367     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2368            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2369     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2370         10  FILLER            PIC 999.                              CL**5
  2371         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2372         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2373             15  EC-EFF-CC     PIC 99.                               CL**5
  2374             15  EC-EFF-YR     PIC 99.                               CL**5
  2375         10  EC-EFF-MO         PIC 99.                               CL**5
  2376         10  EC-EFF-DA         PIC 99.                               CL**5
  2377     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2378            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2379     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2380         10  FILLER            PIC 999.                           ELCEPCVR
  2381         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2382         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2383             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  2384             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2385         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  2386         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2387     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2388            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2389     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2390         10  FILLER            PIC 999.                           ELCEPCVR
  2391         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2392         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2393             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2394             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2395         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2396         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2397     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2398            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2399     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2400         10  FILLER            PIC 999.                           ELCEPCVR
  2401         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2402         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2403             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2404             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2405         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2406         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2407     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2408            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2409     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2410         10  FILLER            PIC 999.                           ELCEPCVR
  2411         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2412         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2413             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2414             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2415         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2416         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2417     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2418            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2419     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2420         10  FILLER            PIC 999.                           ELCEPCVR
  2421         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2422         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  2423             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2424             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  2425         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2426         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2427     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2428            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2429
  2430 PROCEDURE DIVISION.
* 2431                                 COPY ELCDTERX.
  2432******************************************************************04/15/98
  2433*                                                                *ELCDTERX
  2434*                                                                *ELCDTERX
  2435*                            ELCDTERX.                           *   LV002
  2436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2437*                            VMOD=2.007                          *ELCDTERX
  2438*                                                                *ELCDTERX
  2439*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2440*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2441*      = ELCDTEFD)                                               *ELCDTERX
  2442*                                                                *ELCDTERX
  2443******************************************************************ELCDTERX
  2444                                                                  ELCDTERX
  2445     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2446                                                                  ELCDTERX
  2447     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2448     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2449     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2450                                                                  ELCDTERX
  2451     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2452                                                                  ELCDTERX
  2453******************************************************************ELCDTERX
  2454*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2455*          WARNING MESSAGES.                                      ELCDTERX
  2456******************************************************************ELCDTERX
  2457     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2458         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2459                                                                  ELCDTERX
  2460     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2461                                                                  ELCDTERX
  2462     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2463                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2464                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2465                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2466                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2467                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2468                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2469                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2470                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2471                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2472                                                                  ELCDTERX
  2473     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2474                                                                  ELCDTERX
  2475     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2476                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2477                                                                  ELCDTERX
  2478     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2479     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2480     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2481     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2482                                                                  ELCDTERX
  2483     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2484         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  2485     ELSE                                                         ELCDTERX
  2486         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2487                                                                  ELCDTERX
  2488     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2489         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2490     ELSE                                                         ELCDTERX
  2491         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2492                                                                  ELCDTERX
  2493 0005-READ--CARD.                                                 ELCDTERX
  2494     READ DISK-DATE                                               ELCDTERX
  2495         AT END CLOSE DISK-DATE                                   ELCDTERX
  2496             GO TO 0060-READ--TEST.                               ELCDTERX
  2497                                                                  ELCDTERX
  2498     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2499                                                                  ELCDTERX
  2500     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2501         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2502         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2503         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2504         GO TO 0005-READ--CARD.                                   ELCDTERX
  2505                                                                  ELCDTERX
  2506     IF DD-ID = 'CLAD'                                            ELCDTERX
  2507         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2508         GO TO 0005-READ--CARD.                                   ELCDTERX
  2509                                                                  ELCDTERX
  2510     IF DD-ID = 'CLAX'                                            ELCDTERX
  2511         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2512         GO TO 0005-READ--CARD.                                   ELCDTERX
  2513                                                                  ELCDTERX
  2514     IF DD-ID = 'CLAF'                                            ELCDTERX
  2515         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2516         GO TO 0005-READ--CARD.                                   ELCDTERX
  2517                                                                  ELCDTERX
  2518     IF DD-ID = 'CLAC'                                            ELCDTERX
  2519         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2520                                                                  ELCDTERX
  2521     IF DD-ID = 'CARR'                                            ELCDTERX
  2522         GO TO 0015-READ--CARR.                                   ELCDTERX
  2523                                                                  ELCDTERX
  2524     IF DD-ID = 'STAT'                                            ELCDTERX
  2525         GO TO 0020-READ--STAT.                                   ELCDTERX
  2526                                                                  ELCDTERX
  2527     IF DD-ID = 'BUSC'                                            ELCDTERX
  2528         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2529                                                                  ELCDTERX
  2530     IF DD-ID = 'MORT'                                            ELCDTERX
  2531         GO TO 0030-READ--MORT.                                   ELCDTERX
  2532                                                                  ELCDTERX
  2533     IF DD-ID = 'CLAI'                                            ELCDTERX
  2534         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2535                                                                  ELCDTERX
  2536     IF DD-ID = 'COLC'                                            ELCDTERX
  2537         GO TO 0065-READ--COLC.                                   ELCDTERX
  2538                                                                  ELCDTERX
  2539     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2540        DD-IDA = 'CL'                                             ELCDTERX
  2541         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2542                                                                  ELCDTERX
  2543     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2544        DD-IDA = 'PO'                                             ELCDTERX
  2545         GO TO 0050-READ--POXX.                                   ELCDTERX
  2546                                                                  ELCDTERX
  2547     IF DD-ID = 'OPCA'                                            ELCDTERX
  2548         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2549                                                                  ELCDTERX
  2550     IF DD-ID = 'OPST'                                            ELCDTERX
  2551         GO TO 0072-READ--OPST.                                   ELCDTERX
  2552                                                                  ELCDTERX
  2553     IF DD-ID = 'OPBS'                                            ELCDTERX
  2554         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2555                                                                  ELCDTERX
  2556     IF DD-ID = 'OPMS'                                            ELCDTERX
  2557         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2558                                                                  ELCDTERX
  2559     GO TO 0005-READ--CARD.                                       ELCDTERX
  2560                                                                  ELCDTERX
  2561 0010-READ--CLAC.                                                 ELCDTERX
  2562     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2563     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2564     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2565     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2566     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2567     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2568     GO TO 0005-READ--CARD.                                       ELCDTERX
  2569                                                                  ELCDTERX
  2570 0015-READ--CARR.                                                 ELCDTERX
  2571     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2572     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2573        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2574        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2575        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2576        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2577        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2578        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2579        MOVE DD-CARR1-SECPAY-SW
  2580                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2581     END-IF
  2582                                                                  ELCDTERX
  2583     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2584     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2585        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2586        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2587        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2588        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2589        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2590        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2591        MOVE DD-CARR2-SECPAY-SW
  2592                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2593     END-IF
  2594                                                                  ELCDTERX
  2595                                                                  ELCDTERX
  2596     GO TO 0005-READ--CARD.                                       ELCDTERX
  2597                                                                  ELCDTERX
  2598 0020-READ--STAT.                                                 ELCDTERX
  2599     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2600     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2601        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2602         GO TO 0005-READ--CARD.                                   ELCDTERX
  2603                                                                  ELCDTERX
  2604     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2605     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2606     GO TO 0020-READ--STAT.                                       ELCDTERX
  2607                                                                  ELCDTERX
  2608 0025-READ--BUSC.                                                 ELCDTERX
  2609     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2610     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2611        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2612         GO TO 0005-READ--CARD.                                   ELCDTERX
  2613                                                                  ELCDTERX
  2614     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2615     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2616     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2617                                                                  ELCDTERX
  2618 0030-READ--MORT.                                                 ELCDTERX
  2619     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2620     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2621        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2622         GO TO 0005-READ--CARD.                                   ELCDTERX
  2623                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2624     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2625     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2626     GO TO 0030-READ--MORT.                                       ELCDTERX
  2627                                                                  ELCDTERX
  2628 0035-READ--CLXX.                                                 ELCDTERX
  2629     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2630          GO TO 0005-READ--CARD.                                  ELCDTERX
  2631                                                                  ELCDTERX
  2632     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2633         DISPLAY '***********************************************'ELCDTERX
  2634         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2635         DISPLAY '***********************************************'ELCDTERX
  2636         GO TO 0055-READ--STOP.                                   ELCDTERX
  2637                                                                  ELCDTERX
  2638     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2639        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2640         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2641                                                                  ELCDTERX
  2642     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2643        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2644         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2645                                                                  ELCDTERX
  2646*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2647     GO TO 0005-READ--CARD.                                       ELCDTERX
  2648                                                                  ELCDTERX
  2649 0040-READ--CLAI.                                                 ELCDTERX
  2650     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2651     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2652        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2653         GO TO 0005-READ--CARD.                                   ELCDTERX
  2654                                                                  ELCDTERX
  2655     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2656     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2657     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2658                                                                  ELCDTERX
  2659 0045-READ--DUMP.                                                 ELCDTERX
  2660     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2661     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2662                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2663     PERFORM ABEND-PGM.                                           ELCDTERX
  2664                                                                  ELCDTERX
  2665 0050-READ--POXX.                                                 ELCDTERX
  2666     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2667         GO TO 0005-READ--CARD.                                   ELCDTERX
  2668                                                                  ELCDTERX
  2669     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2670         DISPLAY '***********************************************'ELCDTERX
  2671         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2672         DISPLAY '***********************************************'ELCDTERX
  2673         GO TO 0055-READ--STOP.                                   ELCDTERX
  2674                                                                  ELCDTERX
  2675     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2676     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2677     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2678     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2679                                                                  ELCDTERX
  2680     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2681         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2682     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2683         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2684                                                                  ELCDTERX
  2685     GO TO 0005-READ--CARD.                                       ELCDTERX
  2686                                                                  ELCDTERX
  2687 0055-READ--STOP.                                                 ELCDTERX
  2688     GOBACK.                                                      ELCDTERX
  2689                                                                  ELCDTERX
  2690 0060-READ--TEST.                                                 ELCDTERX
  2691     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2692        CLAX-ID         = SPACE  OR                               ELCDTERX
  2693        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2694         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2695                                                                  ELCDTERX
  2696     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2697     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2698                                                                  ELCDTERX
  2699 0065-READ--COLC.                                                 ELCDTERX
  2700     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2701     GO TO 0005-READ--CARD.                                       ELCDTERX
  2702                                                                  ELCDTERX
  2703 0070-READ--OPCA.                                                 ELCDTERX
  2704                                                                  ELCDTERX
  2705     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2706                                                                  ELCDTERX
  2707     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2708             OR                                                   ELCDTERX
  2709         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2710         GO TO 0005-READ--CARD.                                   ELCDTERX
  2711                                                                  ELCDTERX
  2712     ADD 1                       TO INDEXCA.                      ELCDTERX
  2713     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2714                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2715     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2716                                                                  ELCDTERX
  2717 0072-READ--OPST.                                                 ELCDTERX
  2718                                                                  ELCDTERX
  2719     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2720                                                                  ELCDTERX
  2721     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2722             OR                                                   ELCDTERX
  2723         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2724         GO TO 0005-READ--CARD.                                   ELCDTERX
  2725                                                                  ELCDTERX
  2726     ADD 1                       TO INDEXST.                      ELCDTERX
  2727     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2728                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2729     GO TO 0072-READ--OPST.                                       ELCDTERX
  2730                                                                  ELCDTERX
  2731 0074-READ--OPBS.                                                 ELCDTERX
  2732                                                                  ELCDTERX
  2733     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2734                                                                  ELCDTERX
  2735     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2736             OR                                                   ELCDTERX
  2737         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2738         GO TO 0005-READ--CARD.                                   ELCDTERX
  2739                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2740     ADD 1                       TO INDEXBS.                      ELCDTERX
  2741     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2742     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2743                                                                  ELCDTERX
  2744 0079-READ--EXIT.                                                 ELCDTERX
  2745*    EXIT.                                                        ELCDTERX
  2746******************************************************************ELCDTERX
  2747
  2748     perform 1000-connect        thru 1000-exit
  2749     perform 1010-declare-cursor thru 1010-exit
  2750     perform 1020-open-cursor    thru 1020-exit
  2751     perform 1030-process-input  thru 1030-exit
  2752     perform 1050-disconnect     thru 1050-exit
  2753     perform varying i1 from +1 by +1
  2754        until (i1 > +300)
  2755        or (ws-retro-group (i1) = high-values)
  2756        display ' group status ' ws-retro-group (i1) ' '
  2757           ws-status (i1)
  2758     end-perform
  2759
  2760     perform 0010-open-files     thru 0010-exit
  2761
  2762     sort sort-work on ascending sw-retro-group sw-acct-key
  2763        input procedure
  2764           0000-sort-input       thru 0000-exit
  2765        output procedure
  2766           4000-sort-output      thru 4000-exit
  2767
  2768     perform 5000-close-files    thru 5000-exit
  2769     goback
  2770
  2771     .
  2772 0000-sort-input.
  2773
  2774     perform 0020-init           thru 0020-exit
  2775     perform 0100-process-input  thru 0100-exit until
  2776        end-of-input
  2777
  2778     perform 3300-release-rec    thru 3300-exit
  2779
  2780     display ' released recs ' ws-rel-recs
  2781     display ' released drs  ' ws-rel-drs
  2782
  2783     .
  2784 0000-exit.
  2785     exit.
  2786
  2787 0010-open-files.
  2788
  2789     OPEN INPUT
  2790             eracct
  2791             ERPLAN-IN
  2792             EPEC-FILE
  2793         OUTPUT
  2794             index-file
  2795             PRNTR
  2796
  2797     IF ERACCT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS043SL.cbl
  2798         NEXT SENTENCE
  2799       ELSE
  2800         MOVE '11'                TO W-ABEND-CODE-1
  2801         MOVE ERACCT-FILE-STATUS TO W-ABEND-CODE-2
  2802         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  2803         MOVE 'OPEN ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  2804         GO TO ABEND-PGM.
  2805
  2806     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  2807         NEXT SENTENCE
  2808       ELSE
  2809         MOVE '12'                TO W-ABEND-CODE-1
  2810         MOVE ERPLAN-FILE-STATUS  TO W-ABEND-CODE-2
  2811         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  2812         MOVE 'OPEN ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  2813         GO TO ABEND-PGM.
  2814
  2815     .
  2816 0010-exit.
  2817     exit.
  2818
  2819 0020-init.
  2820
  2821     move +1                     to i0
  2822
  2823     MOVE WS-CURRENT-DATE        TO HD-RD
  2824     MOVE ALPH-DATE              TO HD-AD
  2825     MOVE COMPANY-NAME           TO HD-COMP
  2826
  2827     MOVE RUN-DATE               TO RUN-DT
  2828                                    BEG-DATE
  2829
  2830     move run-date               to ws-curr-date
  2831
  2832     move bin-run-date           to dc-bin-date-1
  2833     move '6'                    to dc-option-code
  2834     move -1                     to dc-elapsed-months
  2835     move +0                     to dc-elapsed-days
  2836     move '1'                    to dc-end-of-month
  2837     perform 8500-date-convert   thru 8500-exit
  2838     if no-conversion-error
  2839        display ' last month end ' dc-greg-date-cymd
  2840        move dc-greg-date-cymd   to ws-last-month-end
  2841     else
  2842        display ' last month date error ' dc-error-code
  2843        perform abend-pgm
  2844     end-if
  2845
  2846     move ws-last-month-end      to ws-last-year-end
  2847     subtract 1 from ws-lye-ccyy
  2848     move 12                     to ws-lye-mm
  2849     move 31                     to ws-lye-dd
  2850
  2851     display ' current month end ' ws-curr-date
  2852     display ' last month end    ' ws-last-month-end
  2853     display ' last year end     ' ws-last-year-end
  2854
  2855     perform varying i0 from +1 by +1 until i0 > +4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS043SL.cbl
  2856        perform 0050-init-acct-accums
  2857                                 thru 0050-exit
  2858     end-perform
  2859
  2860     perform 0030-read-input     thru 0030-exit
  2861
  2862     move ep-carrier             to ws-prev-carrier
  2863     move ep-grouping            to ws-prev-grouping
  2864     move ep-state               to ws-prev-state
  2865     move ep-account             to ws-prev-account
  2866     move ep-exp-dte             to ws-prev-exp-dte
  2867
  2868     move low-values             to am-control-primary
  2869     move dte-clasic-company-cd  to am-company-cd
  2870     start eracct key >= am-control-primary
  2871     perform 0120-eracct-read-next
  2872                                 thru 0120-exit
  2873
  2874     .
  2875 0020-exit.
  2876     exit.
  2877
  2878 0030-read-input.
  2879
  2880     READ EPEC-FILE AT END
  2881        MOVE HIGH-VALUES         TO EP-CONTROL
  2882        set end-of-input to true
  2883     end-read
  2884
  2885*    if ep-carrier = '9'
  2886*       set end-of-input to true
  2887*    end-if
  2888
  2889     if end-of-input
  2890        go to 0030-exit
  2891     end-if
  2892
  2893     IF (EP-RECORD-ID NOT = 'EP' AND 'EC')
  2894                or
  2895        (ep-rein = 'R')
  2896                or
  2897        (ep-run-dte > run-dt)
  2898        GO TO 0030-read-input
  2899     end-if
  2900
  2901     move ep-cntrl-1             to ws-comp-acct-key
  2902     move ep-exp-dte             to ws-comp-exp-dte
  2903
  2904     .
  2905 0030-EXIT.
  2906     EXIT.
  2907
  2908 0050-init-acct-accums.
  2909
  2910     perform varying i1 from +1 by +1 until i1 > +2
  2911        move +0                  to cur-gross-prem     (i0 i1)
  2912        move +0                  to cur-cancel-prem    (i0 i1)
  2913        move +0                  to cur-net-prem       (i0 i1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS043SL.cbl
  2914        move +0                  to cur-uep            (i0 i1)
  2915        move +0                  to cur-earn-prem      (i0 i1)
  2916        move +0                  to cur-inv-income     (i0 i1)
  2917        move +0                  to cur-tot-income     (i0 i1)
  2918        move +0                  to cur-acct-comms     (i0 i1)
  2919        move +0                  to cur-ow-comms       (i0 i1)
  2920        move +0                  to cur-ret-fees       (i0 i1)
  2921        move +0                  to cur-clm-pmts       (i0 i1)
  2922        move +0                  to cur-prem-tax       (i0 i1)
  2923        move +0                  to cur-other-expenses (i0 i1)
  2924        move +0                  to cur-tot-expenses   (i0 i1)
  2925        move +0                  to cur-net-cash-flow  (i0 i1)
  2926        move +0                  to cur-mort-resv      (i0 i1)
  2927        move +0                  to cur-clm-resv       (i0 i1)
  2928        move +0                  to cur-net-mep-comm   (i0 i1)
  2929        move +0                  to cur-retro-pmts     (i0 i1)
  2930        move +0                  to cur-mep-due        (i0 i1)
  2931
  2932        move +0                  to lme-gross-prem     (i0 i1)
  2933        move +0                  to lme-cancel-prem    (i0 i1)
  2934        move +0                  to lme-net-prem       (i0 i1)
  2935        move +0                  to lme-uep            (i0 i1)
  2936        move +0                  to lme-earn-prem      (i0 i1)
  2937        move +0                  to lme-inv-income     (i0 i1)
  2938        move +0                  to lme-tot-income     (i0 i1)
  2939        move +0                  to lme-acct-comms     (i0 i1)
  2940        move +0                  to lme-ow-comms       (i0 i1)
  2941        move +0                  to lme-ret-fees       (i0 i1)
  2942        move +0                  to lme-clm-pmts       (i0 i1)
  2943        move +0                  to lme-prem-tax       (i0 i1)
  2944        move +0                  to lme-other-expenses (i0 i1)
  2945        move +0                  to lme-tot-expenses   (i0 i1)
  2946        move +0                  to lme-net-cash-flow  (i0 i1)
  2947        move +0                  to lme-mort-resv      (i0 i1)
  2948        move +0                  to lme-clm-resv       (i0 i1)
  2949        move +0                  to lme-net-mep-comm   (i0 i1)
  2950        move +0                  to lme-retro-pmts     (i0 i1)
  2951        move +0                  to lme-mep-due        (i0 i1)
  2952
  2953        move +0                  to lye-gross-prem     (i0 i1)
  2954        move +0                  to lye-cancel-prem    (i0 i1)
  2955        move +0                  to lye-net-prem       (i0 i1)
  2956        move +0                  to lye-uep            (i0 i1)
  2957        move +0                  to lye-earn-prem      (i0 i1)
  2958        move +0                  to lye-inv-income     (i0 i1)
  2959        move +0                  to lye-tot-income     (i0 i1)
  2960        move +0                  to lye-acct-comms     (i0 i1)
  2961        move +0                  to lye-ow-comms       (i0 i1)
  2962        move +0                  to lye-ret-fees       (i0 i1)
  2963        move +0                  to lye-clm-pmts       (i0 i1)
  2964        move +0                  to lye-prem-tax       (i0 i1)
  2965        move +0                  to lye-other-expenses (i0 i1)
  2966        move +0                  to lye-tot-expenses   (i0 i1)
  2967        move +0                  to lye-net-cash-flow  (i0 i1)
  2968        move +0                  to lye-mort-resv      (i0 i1)
  2969        move +0                  to lye-clm-resv       (i0 i1)
  2970        move +0                  to lye-net-mep-comm   (i0 i1)
  2971        move +0                  to lye-retro-pmts     (i0 i1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS043SL.cbl
  2972        move +0                  to lye-mep-due        (i0 i1)
  2973     end-perform
  2974
  2975     .
  2976 0050-exit.
  2977     exit.
  2978
  2979 0100-process-input.
  2980
  2981*    if ws-comp-acct-key not = ws-prev-acct-key
  2982*       perform 3500-release-drs thru 3500-exit
  2983*       move spaces              to ws-acct-table
  2984*       move +0                  to d1 d1m
  2985*    end-if
  2986
  2987     if ws-comp-acct-dr-key not = ws-prev-acct-dr-key
  2988        perform 3300-release-rec thru 3300-exit
  2989     end-if
  2990
  2991     perform 0110-match-to-acct  thru 0110-exit
  2992
  2993     if (am-ret-y-n = 'Y')
  2994        and (ws-retro-rpt-cd-3 = 'SVCLIFE')
  2995        and (not active-group)
  2996        display ' bypassing ' am-state ' ' am-account
  2997        ' ' am-ret-grp
  2998     end-if
  2999
  3000     if (am-ret-y-n = 'Y')
  3001        and (active-group)
  3002        and (ws-retro-rpt-cd-3 = 'SVCLIFE')
  3003        continue
  3004     else
  3005        go to 0100-continue
  3006     end-if
  3007
  3008     perform 0300-sync-benefit   thru 0300-exit
  3009
  3010     if ep-record-id = 'EP'
  3011        perform 0200-check-for-retro-pmts
  3012                                 thru 0200-exit
  3013     end-if
  3014
  3015     if (ep-run-dte = ws-curr-date)
  3016               or
  3017        (ep-purge = 'P')
  3018        perform 0999-accum-current
  3019                                 thru 0999-exit
  3020     end-if
  3021     if (ep-run-dte = ws-last-month-end)
  3022              or
  3023        ((ep-purge = 'P')
  3024        and (ep-run-dte < ws-last-month-end))
  3025        perform 2000-accum-last-month-end
  3026                                 thru 2000-exit
  3027     end-if
  3028
  3029     if (ep-run-dte = ws-last-year-end)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS043SL.cbl
  3030              or
  3031        ((ep-purge = 'P')
  3032        and (ep-run-dte < ws-last-year-end))
  3033        perform 3000-accum-last-year-end
  3034                                 thru 3000-exit
  3035     end-if
  3036
  3037     .
  3038 0100-continue.
  3039
  3040     perform 0030-read-input     thru 0030-exit
  3041
  3042     .
  3043 0100-exit.
  3044     exit.
  3045
  3046 0110-match-to-acct.
  3047
  3048     move spaces                 to ws-ret-grp-sw
  3049                                    ws-retro-rpt-cd-3
  3050
  3051     evaluate true
  3052        when ep-cntrl-1 > am-control-a
  3053           perform 0120-eracct-read-next
  3054                                 thru 0120-exit
  3055           go to 0110-match-to-acct
  3056        when ep-cntrl-1 < am-control-a
  3057           display ' no matching acct for EPEC '
  3058              ep-cntrl-1 ' ' ep-exp-dte
  3059           perform abend-pgm
  3060        when ep-exp-dte > am-expire-dt
  3061           perform 0120-eracct-read-next
  3062                                 thru 0120-exit
  3063           go to 0110-match-to-acct
  3064        when ep-exp-dte < am-expire-dt
  3065           display ' no matching acct expdt for EPEC '
  3066              ep-cntrl-1 ' ' ep-exp-dte
  3067           perform abend-pgm
  3068     end-evaluate
  3069
  3070     if am-ret-grp = low-values
  3071        move spaces              to am-ret-grp
  3072     end-if
  3073
  3074     move am-report-code-1       to ws-acct-rptcd1
  3075     move am-report-code-2       to ws-acct-rptcd2
  3076     move am-name                to ws-acct-name
  3077     move am-person              to ws-acct-addr1
  3078     move am-addrs               to ws-acct-addr2
  3079
  3080     move spaces                 to ws-acct-city-state
  3081     string
  3082        am-addr-city ' '
  3083        am-addr-state
  3084        delimited by '  '        into ws-acct-city-state
  3085     end-string
  3086
  3087     move am-zip                 to ws-acct-zip
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS043SL.cbl
  3088     move am-ret-grp             to ws-acct-ret-grp
  3089
  3090*    if am-ret-grp = 'MISAUT'
  3091*       set active-group to true
  3092*       move 'SVCLIFE'    to ws-retro-rpt-cd-3
  3093*    else
  3094     search all ws-retro-table at end
  3095        continue
  3096       when am-ret-grp = ws-retro-group (r1)
  3097        set active-group to true
  3098        move ws-report-code-3 (r1) to ws-retro-rpt-cd-3
  3099     end-search
  3100*    end-if
  3101     move ws-retro-rpt-cd-3      to ws-acct-rptcd3
  3102
  3103     .
  3104 0110-exit.
  3105     exit.
  3106
  3107 0120-eracct-read-next.
  3108
  3109     if end-of-eracct
  3110        display ' somehow got to 0120 after EOF '
  3111        perform abend-pgm
  3112     end-if
  3113
  3114     read eracct next record
  3115     if (eracct-file-status = '10' or '23')
  3116        or (am-company-cd not = dte-clasic-company-cd)
  3117        set end-of-eracct to true
  3118     else
  3119        if eracct-file-status not = '00'
  3120           display ' error-eracct-readnext ' eracct-file-status
  3121           perform abend-pgm
  3122        end-if
  3123     end-if
  3124
  3125     .
  3126 0120-exit.
  3127     exit.
  3128
  3129
  3130 0200-check-for-retro-pmts.
  3131
  3132     if ep-rcd-type = 'L' or 'P'
  3133        move +1                  to i1
  3134     else
  3135        move +2                  to i1
  3136     end-if
  3137
  3138     compute cur-retro-pmts (i0 i1) =
  3139        cur-retro-pmts (i0 i1) + ep-retro-payments
  3140
  3141     if ep-run-dte <= ws-last-month-end
  3142        compute lme-retro-pmts (i0 i1) =
  3143           lme-retro-pmts (i0 i1) + ep-retro-payments
  3144     end-if
  3145
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS043SL.cbl
  3146     if ep-run-dte <= ws-last-year-end
  3147        compute lye-retro-pmts (i0 i1) =
  3148           lye-retro-pmts (i0 i1) + ep-retro-payments
  3149     end-if
  3150
  3151     .
  3152 0200-exit.
  3153     exit.
  3154
  3155 0300-sync-benefit.
  3156
  3157     perform 0310-find-state     thru 0310-exit
  3158
  3159     if ep-rcd-type = 'L' OR 'P'
  3160        perform 0320-find-lf-ben thru 0320-exit
  3161     else
  3162        perform 0330-find-ah-ben thru 0330-exit
  3163     end-if
  3164
  3165     if state-abbr (clas-indexs) = 'WY'
  3166        move 'P'                 to ws-ep-code
  3167     end-if
  3168
  3169     .
  3170 0300-exit.
  3171     exit.
  3172
  3173 0310-find-state.
  3174
  3175     if ep-state = state-sub (clas-indexs)
  3176        continue
  3177     else
  3178        perform varying clas-indexs from clas-starts by +1
  3179           until (clas-indexs > clas-maxs)
  3180           or (ep-state = state-sub (clas-indexs))
  3181        end-perform
  3182     end-if
  3183
  3184     if clas-indexs > clas-maxs
  3185        display ' invalid state ' ep-state ' ' ep-account
  3186        perform abend-pgm
  3187     end-if
  3188
  3189     .
  3190 0310-exit.
  3191     exit.
  3192
  3193 0320-find-lf-ben.
  3194
  3195     if ep-ben-code = clas-i-ben (clas-indexl)
  3196        continue
  3197     else
  3198        perform varying clas-indexl from clas-startl by +1
  3199           until (clas-indexl > clas-maxl)
  3200           or (ep-ben-code = clas-i-ben (clas-indexl))
  3201        end-perform
  3202     end-if
  3203
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS043SL.cbl
  3204     if clas-indexl > clas-maxl
  3205        display ' invalid lf benefit code ' ep-ben-code ' '
  3206           ep-account
  3207        perform abend-pgm
  3208     end-if
  3209
  3210     move clas-i-ep (clas-indexl) to ws-ep-code
  3211
  3212     .
  3213 0320-exit.
  3214     exit.
  3215
  3216 0330-find-ah-ben.
  3217
  3218     if ep-ben-code = clas-i-ben (clas-indexa)
  3219        continue
  3220     else
  3221        perform varying clas-indexa from clas-starta by +1
  3222           until (clas-indexa > clas-maxa)
  3223           or (ep-ben-code = clas-i-ben (clas-indexa))
  3224        end-perform
  3225     end-if
  3226
  3227     if clas-indexa > clas-maxa
  3228        display ' invalid AH benefit code ' ep-ben-code ' '
  3229           ep-account
  3230        perform abend-pgm
  3231     end-if
  3232
  3233     move clas-i-ep (clas-indexa) to ws-ep-code
  3234
  3235     .
  3236 0330-exit.
  3237     exit.
  3238
  3239 0999-accum-current.
  3240
  3241     if ep-record-id = 'EP'
  3242        perform 1100-process-premium
  3243                                 thru 1100-exit
  3244     else
  3245        perform 1200-process-commission
  3246                                 thru 1200-exit
  3247     end-if
  3248
  3249     .
  3250 0999-exit.
  3251     exit.
  3252
  3253 1100-process-premium.
  3254
  3255     if ep-rcd-type = 'L' or 'P'
  3256        move +1                  to i1
  3257     else
  3258        move +2                  to i1
  3259     end-if
  3260
  3261     compute cur-gross-prem (i0 i1) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS043SL.cbl
  3262        cur-gross-prem (i0 i1) + ep-iss-prm
  3263     compute cur-cancel-prem (i0 i1) =
  3264        cur-cancel-prem (i0 i1) + ep-cnc-prm
  3265
  3266     evaluate true
  3267        when ws-ep-code = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  3268           move ep-prm-78     to ws-work-ep
  3269        when ws-ep-code = 'B' or 'K' or 'L'
  3270           move ep-prm-st     to ws-work-ep
  3271        when ws-ep-code = 'P'
  3272           move ep-prm-pr     to ws-work-ep
  3273        when ws-ep-code = 'M'
  3274           compute ws-work-ep rounded =
  3275              (ep-prm-78 + ep-prm-pr) * .50
  3276        when ws-ep-code = '1'
  3277           compute ws-work-ep rounded =
  3278              (ep-prm-78 * .3333) + (ep-prm-pr * .6666)
  3279        when ws-ep-code = '2'
  3280           compute ws-work-ep rounded =
  3281              (ep-prm-pr * .80) + (ep-prm-78 * .20)
  3282     end-evaluate
  3283
  3284     compute cur-uep (i0 i1) = cur-uep (i0 i1) +
  3285     (ep-iss-prm - ep-cnc-prm - ws-work-ep)
  3286     compute cur-earn-prem (i0 i1) =
  3287     cur-earn-prem (i0 i1) + ws-work-ep
  3288
  3289     display ' tax stuff ' am-account ' ' am-ret-st-tax-use
  3290
  3291     if am-ret-st-tax-use = 'Y'
  3292        move am-ret-p-e          to am-ret-st-tax-use
  3293     end-if
  3294
  3295     if am-ret-st-tax-use = ' ' or 'N'
  3296        continue
  3297     else
  3298*       if am-ret-st-tax-use = 'P'
  3299           compute cur-prem-tax (i0 i1) =
  3300              cur-prem-tax (i0 i1) + ep-prm-tax
  3301*        else
  3302*           if am-ret-st-tax-use = 'E'
  3303*              compute cur-prem-tax (i0 i1) =
  3304*                 cur-prem-tax (i0 i1) + ws-work-ep /
  3305*                 (ep-iss-prm - ep-cnc-prm) * ep-prm-tax
  3306**             compute ws-work-factor rounded =
  3307**                ws-work-ep / (ep-iss-prm - ep-cnc-prm)
  3308**             compute cur-prem-tax (i0 i1) rounded =
  3309**                cur-prem-tax (i0 i1) + (ws-work-factor *
  3310**                ep-prm-tax)
  3311*           end-if
  3312*        end-if
  3313     end-if
  3314
  3315     compute cur-mort-resv (i0 i1) =
  3316        cur-mort-resv (i0 i1) + ep-mort-resv
  3317     compute cur-clm-resv (i0 i1) = cur-clm-resv (i0 i1) +
  3318        (ep-clm-du + ep-clm-pv + ep-loss-resv + ep-clm-ibnr)
  3319     compute cur-clm-pmts (i0 i1) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS043SL.cbl
  3320        cur-clm-pmts (i0 i1) + ep-clm-amt
  3321
  3322     if i1 = +1
  3323        compute cur-ret-fees (i0 i1) rounded =
  3324           cur-ret-fees (i0 i1) + (ws-work-ep * am-lf-ret)
  3325     else
  3326        compute cur-ret-fees (i0 i1) rounded =
  3327           cur-ret-fees (i0 i1) + (ws-work-ep * am-ah-ret)
  3328     end-if
  3329
  3330     .
  3331 1100-exit.
  3332     exit.
  3333
  3334 1200-process-commission.
  3335
  3336     if ec-rcd-type = 'L' or 'P'
  3337        move +1                  to i1
  3338     else
  3339        move +2                  to i1
  3340     end-if
  3341
  3342     move +0                     to ws-work-ep
  3343     if am-ret-p-e = 'E' or ' '
  3344        perform varying a1 from +1 by +1 until a1 > +5
  3345           evaluate true
  3346              when ws-ep-code = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  3347                 move ec-comm-78(a1) to ws-work-ep
  3348              when ws-ep-code = 'B' or 'K' or 'L'
  3349                 move ec-comm-st(a1) to ws-work-ep
  3350              when ws-ep-code = 'P'
  3351                 move ec-comm-pr(a1) to ws-work-ep
  3352              when ws-ep-code = 'M'
  3353                 compute ws-work-ep rounded =
  3354                    (ec-comm-78(a1) + ec-comm-pr(a1)) * .50
  3355              when ws-ep-code = '1'
  3356                 compute ws-work-ep rounded =
  3357                    (ec-comm-78(a1) * .3333) +
  3358                    (ec-comm-pr(a1) * .6666)
  3359              when ws-ep-code = '2'
  3360                 compute ws-work-ep rounded =
  3361                    (ec-comm-pr(a1) * .80) +
  3362                    (ec-comm-78(a1) * .20)
  3363              when other
  3364                 display ' invalid ep code ' ws-ep-code ' '
  3365                    ep-account
  3366           end-evaluate
  3367           if ec-agt-type (a1) = 'C' or 'D'
  3368              compute cur-acct-comms (i0 i1) =
  3369                 cur-acct-comms (i0 i1) + ws-work-ep
  3370           else
  3371              if ec-agt-type (a1) = 'O' or 'P'
  3372                 compute cur-ow-comms (i0 i1) =
  3373                    cur-ow-comms (i0 i1) + ws-work-ep
  3374              end-if
  3375           end-if
  3376        end-perform
  3377     else
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS043SL.cbl
  3378        perform varying a1 from +1 by +1 until a1 > +5
  3379           if ec-agt-type (a1) = 'C' or 'D'
  3380              compute cur-acct-comms (i0 i1) =
  3381                 cur-acct-comms (i0 i1) + (ec-iss-comm (a1) -
  3382                 ec-cnc-comm (a1))
  3383           else
  3384              if ec-agt-type (a1) = 'O' or 'P'
  3385                 compute cur-ow-comms (i0 i1) =
  3386                    cur-ow-comms (i0 i1) + (ec-iss-comm (a1) -
  3387                    ec-cnc-comm (a1))
  3388              end-if
  3389           end-if
  3390        end-perform
  3391     end-if
  3392
  3393     .
  3394 1200-exit.
  3395     exit.
  3396
  3397 2000-accum-last-month-end.
  3398
  3399     if ep-record-id = 'EP'
  3400        perform 2100-process-premium
  3401                                 thru 2100-exit
  3402     else
  3403        perform 2200-process-commission
  3404                                 thru 2200-exit
  3405     end-if
  3406
  3407     .
  3408 2000-exit.
  3409     exit.
  3410
  3411 2100-process-premium.
  3412
  3413     if ep-rcd-type = 'L' or 'P'
  3414        move +1                  to i1
  3415     else
  3416        move +2                  to i1
  3417     end-if
  3418
  3419     compute lme-gross-prem (i0 i1) =
  3420        lme-gross-prem (i0 i1) + ep-iss-prm
  3421     compute lme-cancel-prem (i0 i1) =
  3422        lme-cancel-prem (i0 i1) + ep-cnc-prm
  3423
  3424     evaluate true
  3425        when ws-ep-code = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  3426           move ep-prm-78     to ws-work-ep
  3427        when ws-ep-code = 'B' or 'K' or 'L'
  3428           move ep-prm-st     to ws-work-ep
  3429        when ws-ep-code = 'P'
  3430           move ep-prm-pr     to ws-work-ep
  3431        when ws-ep-code = 'M'
  3432           compute ws-work-ep rounded =
  3433              (ep-prm-78 + ep-prm-pr) * .50
  3434        when ws-ep-code = '1'
  3435           compute ws-work-ep rounded =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS043SL.cbl
  3436              (ep-prm-78 * .3333) + (ep-prm-pr * .6666)
  3437        when ws-ep-code = '2'
  3438           compute ws-work-ep rounded =
  3439              (ep-prm-pr * .80) + (ep-prm-78 * .20)
  3440     end-evaluate
  3441
  3442     compute lme-uep (i0 i1) = lme-uep (i0 i1) +
  3443        (ep-iss-prm - ep-cnc-prm - ws-work-ep)
  3444     compute lme-earn-prem (i0 i1) =
  3445        lme-earn-prem (i0 i1) + ws-work-ep
  3446
  3447     if am-ret-st-tax-use = 'Y'
  3448        move am-ret-p-e          to am-ret-st-tax-use
  3449     end-if
  3450
  3451     if am-ret-st-tax-use = ' ' or 'N'
  3452        continue
  3453     else
  3454*       if am-ret-st-tax-use = 'P'
  3455           compute lme-prem-tax (i0 i1) =
  3456              lme-prem-tax (i0 i1) + ep-prm-tax
  3457*       else
  3458*          if am-ret-st-tax-use = 'E'
  3459*             compute lme-prem-tax (i0 i1) =
  3460*                lme-prem-tax (i0 i1) + ws-work-ep /
  3461*                (ep-iss-prm - ep-cnc-prm) * ep-prm-tax
  3462**            compute ws-work-factor rounded =
  3463**               ws-work-ep / (ep-iss-prm - ep-cnc-prm)
  3464**            compute lme-prem-tax (i0 i1) rounded =
  3465**               lme-prem-tax (i0 i1) + (ws-work-factor *
  3466**               ep-prm-tax)
  3467*          end-if
  3468*       end-if
  3469     end-if
  3470
  3471*    compute lme-prem-tax (i0 i1) =
  3472*       lme-prem-tax (i0 i1) + ep-prm-tax
  3473     compute lme-mort-resv (i0 i1) =
  3474        lme-mort-resv (i0 i1) + ep-mort-resv
  3475     compute lme-clm-resv (i0 i1) = lme-clm-resv (i0 i1) +
  3476        (ep-clm-du + ep-clm-pv + ep-loss-resv + ep-clm-ibnr)
  3477     compute lme-clm-pmts (i0 i1) =
  3478        lme-clm-pmts (i0 i1) + ep-clm-amt
  3479
  3480     if i1 = +1
  3481        compute lme-ret-fees (i0 i1) rounded =
  3482           lme-ret-fees (i0 i1) + (ws-work-ep * am-lf-ret)
  3483     else
  3484        compute lme-ret-fees (i0 i1) rounded =
  3485           lme-ret-fees (i0 i1) + (ws-work-ep * am-ah-ret)
  3486     end-if
  3487
  3488     .
  3489 2100-exit.
  3490     exit.
  3491
  3492 2200-process-commission.
  3493
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS043SL.cbl
  3494     if ec-rcd-type = 'L' or 'P'
  3495        move +1                  to i1
  3496     else
  3497        move +2                  to i1
  3498     end-if
  3499
  3500     move +0                     to ws-work-ep
  3501     if am-ret-p-e = 'E' or ' '
  3502        perform varying a1 from +1 by +1 until a1 > +5
  3503           evaluate true
  3504              when ws-ep-code = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  3505                 move ec-comm-78(a1) to ws-work-ep
  3506              when ws-ep-code = 'B' or 'K' or 'L'
  3507                 move ec-comm-st(a1) to ws-work-ep
  3508              when ws-ep-code = 'P'
  3509                 move ec-comm-pr(a1) to ws-work-ep
  3510              when ws-ep-code = 'M'
  3511                 compute ws-work-ep rounded =
  3512                    (ec-comm-78(a1) + ec-comm-pr(a1)) * .50
  3513              when ws-ep-code = '1'
  3514                 compute ws-work-ep rounded =
  3515                    (ec-comm-78(a1) * .3333) +
  3516                    (ec-comm-pr(a1) * .6666)
  3517              when ws-ep-code = '2'
  3518                 compute ws-work-ep rounded =
  3519                    (ec-comm-pr(a1) * .80) +
  3520                    (ec-comm-78(a1) * .20)
  3521              when other
  3522                 display ' invalid ep code ' ws-ep-code ' '
  3523                    ep-account
  3524           end-evaluate
  3525           if ec-agt-type (a1) = 'C' or 'D'
  3526              compute lme-acct-comms (i0 i1) =
  3527                 lme-acct-comms (i0 i1) + ws-work-ep
  3528           else
  3529              if ec-agt-type (a1) = 'O' or 'P'
  3530                 compute lme-ow-comms (i0 i1) =
  3531                    lme-ow-comms (i0 i1) + ws-work-ep
  3532              end-if
  3533           end-if
  3534        end-perform
  3535     else
  3536        perform varying a1 from +1 by +1 until a1 > +5
  3537           if ec-agt-type (a1) = 'C' or 'D'
  3538              compute lme-acct-comms (i0 i1) =
  3539                 lme-acct-comms (i0 i1) + (ec-iss-comm (a1) -
  3540                 ec-cnc-comm (a1))
  3541           else
  3542              if ec-agt-type (a1) = 'O' or 'P'
  3543                 compute lme-ow-comms (i0 i1) =
  3544                    lme-ow-comms (i0 i1) + (ec-iss-comm (a1) -
  3545                    ec-cnc-comm (a1))
  3546              end-if
  3547           end-if
  3548        end-perform
  3549     end-if
  3550
  3551     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS043SL.cbl
  3552 2200-exit.
  3553     exit.
  3554
  3555 3000-accum-last-year-end.
  3556
  3557     if ep-record-id = 'EP'
  3558        perform 3100-process-premium
  3559                                 thru 3100-exit
  3560     else
  3561        perform 3200-process-commission
  3562                                 thru 3200-exit
  3563     end-if
  3564
  3565     .
  3566 3000-exit.
  3567     exit.
  3568
  3569 3100-process-premium.
  3570
  3571     if ep-rcd-type = 'L' or 'P'
  3572        move +1                  to i1
  3573     else
  3574        move +2                  to i1
  3575     end-if
  3576
  3577     compute lye-gross-prem (i0 i1) =
  3578        lye-gross-prem (i0 i1) + ep-iss-prm
  3579     compute lye-cancel-prem (i0 i1) =
  3580        lye-cancel-prem (i0 i1) + ep-cnc-prm
  3581
  3582     evaluate true
  3583        when ws-ep-code = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  3584           move ep-prm-78     to ws-work-ep
  3585        when ws-ep-code = 'B' or 'K' or 'L'
  3586           move ep-prm-st     to ws-work-ep
  3587        when ws-ep-code = 'P'
  3588           move ep-prm-pr     to ws-work-ep
  3589        when ws-ep-code = 'M'
  3590           compute ws-work-ep rounded =
  3591              (ep-prm-78 + ep-prm-pr) * .50
  3592        when ws-ep-code = '1'
  3593           compute ws-work-ep rounded =
  3594              (ep-prm-78 * .3333) + (ep-prm-pr * .6666)
  3595        when ws-ep-code = '2'
  3596           compute ws-work-ep rounded =
  3597              (ep-prm-pr * .80) + (ep-prm-78 * .20)
  3598     end-evaluate
  3599
  3600     compute lye-uep (i0 i1) = lye-uep (i0 i1) +
  3601        (ep-iss-prm - ep-cnc-prm - ws-work-ep)
  3602     compute lye-earn-prem (i0 i1) =
  3603        lye-earn-prem (i0 i1) + ws-work-ep
  3604
  3605     if am-ret-st-tax-use = 'Y'
  3606        move am-ret-p-e          to am-ret-st-tax-use
  3607     end-if
  3608
  3609     if am-ret-st-tax-use = ' ' or 'N'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS043SL.cbl
  3610        continue
  3611     else
  3612*       if am-ret-st-tax-use = 'P'
  3613           compute lye-prem-tax (i0 i1) =
  3614              lye-prem-tax (i0 i1) + ep-prm-tax
  3615*       else
  3616*          if am-ret-st-tax-use = 'E'
  3617*             compute lye-prem-tax (i0 i1) =
  3618*                lye-prem-tax (i0 i1) + ws-work-ep /
  3619*                (ep-iss-prm - ep-cnc-prm) * ep-prm-tax
  3620**            compute ws-work-factor rounded =
  3621**               ws-work-ep / (ep-iss-prm - ep-cnc-prm)
  3622**            compute lye-prem-tax (i0 i1) rounded =
  3623**               lye-prem-tax (i0 i1) + (ws-work-factor *
  3624**               ep-prm-tax)
  3625*          end-if
  3626*       end-if
  3627     end-if
  3628
  3629*    compute lye-prem-tax (i0 i1) =
  3630*       lye-prem-tax (i0 i1) + ep-prm-tax
  3631     compute lye-mort-resv (i0 i1) =
  3632        lye-mort-resv (i0 i1) + ep-mort-resv
  3633     compute lye-clm-resv (i0 i1) = lye-clm-resv (i0 i1) +
  3634        (ep-clm-du + ep-clm-pv + ep-loss-resv + ep-clm-ibnr)
  3635     compute lye-clm-pmts (i0 i1) =
  3636        lye-clm-pmts (i0 i1) + ep-clm-amt
  3637
  3638     if i1 = +1
  3639        compute lye-ret-fees (i0 i1) rounded =
  3640           lye-ret-fees (i0 i1) + (ws-work-ep * am-lf-ret)
  3641     else
  3642        compute lye-ret-fees (i0 i1) rounded =
  3643           lye-ret-fees (i0 i1) + (ws-work-ep * am-ah-ret)
  3644     end-if
  3645
  3646     .
  3647 3100-exit.
  3648     exit.
  3649
  3650 3200-process-commission.
  3651
  3652     if ec-rcd-type = 'L' or 'P'
  3653        move +1                  to i1
  3654     else
  3655        move +2                  to i1
  3656     end-if
  3657
  3658     move +0                     to ws-work-ep
  3659     if am-ret-p-e = 'E' or ' '
  3660        perform varying a1 from +1 by +1 until a1 > +5
  3661           evaluate true
  3662              when ws-ep-code = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  3663                 move ec-comm-78(a1) to ws-work-ep
  3664              when ws-ep-code = 'B' or 'K' or 'L'
  3665                 move ec-comm-st(a1) to ws-work-ep
  3666              when ws-ep-code = 'P'
  3667                 move ec-comm-pr(a1) to ws-work-ep
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS043SL.cbl
  3668              when ws-ep-code = 'M'
  3669                 compute ws-work-ep rounded =
  3670                    (ec-comm-78(a1) + ec-comm-pr(a1)) * .50
  3671              when ws-ep-code = '1'
  3672                 compute ws-work-ep rounded =
  3673                    (ec-comm-78(a1) * .3333) +
  3674                    (ec-comm-pr(a1) * .6666)
  3675              when ws-ep-code = '2'
  3676                 compute ws-work-ep rounded =
  3677                    (ec-comm-pr(a1) * .80) +
  3678                    (ec-comm-78(a1) * .20)
  3679              when other
  3680                 display ' invalid ep code ' ws-ep-code ' '
  3681                    ep-account
  3682           end-evaluate
  3683           if ec-agt-type (a1) = 'C' or 'D'
  3684              compute lye-acct-comms (i0 i1) =
  3685                 lye-acct-comms (i0 i1) + ws-work-ep
  3686           else
  3687              if ec-agt-type (a1) = 'O' or 'P'
  3688                 compute lye-ow-comms (i0 i1) =
  3689                    lye-ow-comms (i0 i1) + ws-work-ep
  3690              end-if
  3691           end-if
  3692        end-perform
  3693     else
  3694        perform varying a1 from +1 by +1 until a1 > +5
  3695           if ec-agt-type (a1) = 'C' or 'D'
  3696              compute lye-acct-comms (i0 i1) =
  3697                 lye-acct-comms (i0 i1) + (ec-iss-comm (a1) -
  3698                 ec-cnc-comm (a1))
  3699           else
  3700              if ec-agt-type (a1) = 'O' or 'P'
  3701                 compute lye-ow-comms (i0 i1) =
  3702                    lye-ow-comms (i0 i1) + (ec-iss-comm (a1)
  3703                    - ec-cnc-comm (a1))
  3704              end-if
  3705           end-if
  3706        end-perform
  3707     end-if
  3708
  3709     .
  3710 3200-exit.
  3711     exit.
  3712
  3713 3300-release-rec.
  3714
  3715*    if (am-ret-y-n = 'Y')
  3716*       and (am-report-code-3 = 'SVCLIFE')
  3717*       continue
  3718*    else
  3719*       go to 3300-continue
  3720*    end-if
  3721
  3722     if zero = cur-gross-prem (1 1)
  3723           and cur-uep        (1 1)
  3724           and cur-acct-comms (1 1)
  3725           and cur-clm-pmts   (1 1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS043SL.cbl
  3726           and cur-clm-resv   (1 1)
  3727           and cur-gross-prem (1 2)
  3728           and cur-uep        (1 2)
  3729           and cur-acct-comms (1 2)
  3730           and cur-clm-pmts   (1 2)
  3731           and cur-clm-resv   (1 2)
  3732        go to 3300-continue
  3733     end-if
  3734
  3735     move ws-acct-ret-grp        to sw-retro-group
  3736     move ws-prev-acct-key       to sw-acct-key
  3737     move ws-acct-name           to sw-acct-name
  3738     move ws-acct-addr2          to sw-acct-addr1
  3739     move ws-acct-city-state     to sw-acct-city-state
  3740     move ws-acct-zip            to sw-acct-zip
  3741     move ws-acct-rptcd1         to sw-acct-rptcd1
  3742     move ws-acct-rptcd2         to sw-acct-rptcd2
  3743     move ws-acct-rptcd3         to sw-acct-rptcd3
  3744
  3745**             compute ws-work-factor rounded =
  3746**                ws-work-ep / (ep-iss-prm - ep-cnc-prm)
  3747**             compute cur-prem-tax (i0 i1) rounded =
  3748**                cur-prem-tax (i0 i1) + (ws-work-factor *
  3749**                ep-prm-tax)
  3750
  3751
  3752
  3753     if am-ret-st-tax-use = 'E'
  3754        compute ws-work-factor rounded = cur-earn-prem (1 1) /
  3755           (cur-gross-prem (1 1) - cur-cancel-prem (1 1))
  3756        compute cur-prem-tax (1 1) rounded =
  3757           ws-work-factor * cur-prem-tax (1 1)
  3758        compute ws-work-factor rounded = cur-earn-prem (1 2) /
  3759           (cur-gross-prem (1 2) - cur-cancel-prem (1 2))
  3760        compute cur-prem-tax (1 2) rounded =
  3761           ws-work-factor * cur-prem-tax (1 2)
  3762
  3763        compute ws-work-factor rounded = lme-earn-prem (1 1) /
  3764           (lme-gross-prem (1 1) - lme-cancel-prem (1 1))
  3765        compute lme-prem-tax (1 1) rounded =
  3766           ws-work-factor * lme-prem-tax (1 1)
  3767        compute ws-work-factor rounded = lme-earn-prem (1 2) /
  3768           (lme-gross-prem (1 2) - lme-cancel-prem (1 2))
  3769        compute lme-prem-tax (1 2) rounded =
  3770           ws-work-factor * lme-prem-tax (1 2)
  3771
  3772        compute ws-work-factor rounded = lye-earn-prem (1 1) /
  3773           (lye-gross-prem (1 1) - lye-cancel-prem (1 1))
  3774        compute lye-prem-tax (1 1) rounded =
  3775           ws-work-factor * lye-prem-tax (1 1)
  3776        compute ws-work-factor rounded = lye-earn-prem (1 2) /
  3777           (lye-gross-prem (1 2) - lye-cancel-prem (1 2))
  3778        compute lye-prem-tax (1 2) rounded =
  3779           ws-work-factor * lye-prem-tax (1 2)
  3780     end-if
  3781
  3782*       compute cur-prem-tax (1 1) = cur-earn-prem (1 1) /
  3783*          (cur-gross-prem (1 1) - cur-cancel-prem (1 1)) *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS043SL.cbl
  3784*          cur-prem-tax (1 1)
  3785*       compute cur-prem-tax (1 2) = cur-earn-prem (1 2) /
  3786*          (cur-gross-prem (1 2) - cur-cancel-prem (1 2)) *
  3787*          cur-prem-tax (1 2)
  3788*
  3789*       compute lme-prem-tax (1 1) = lme-earn-prem (1 1) /
  3790*          (lme-gross-prem (1 1) - lme-cancel-prem (1 1)) *
  3791*          lme-prem-tax (1 1)
  3792*       compute lme-prem-tax (1 2) = lme-earn-prem (1 2) /
  3793*          (lme-gross-prem (1 2) - lme-cancel-prem (1 2)) *
  3794*          lme-prem-tax (1 2)
  3795*
  3796*       compute lye-prem-tax (1 1) = lye-earn-prem (1 1) /
  3797*          (lye-gross-prem (1 1) - lye-cancel-prem (1 1)) *
  3798*          lye-prem-tax (1 1)
  3799*       compute lye-prem-tax (1 2) = lye-earn-prem (1 2) /
  3800*          (lye-gross-prem (1 2) - lye-cancel-prem (1 2)) *
  3801*          lye-prem-tax (1 2)
  3802*    end-if
  3803
  3804*    compute cur-ret-fees (1) = cur-earn-prem (1) * am-lf-ret
  3805*    compute cur-ret-fees (2) = cur-earn-prem (2) * am-ah-ret
  3806*    compute lme-ret-fees (1) = lme-earn-prem (1) * am-lf-ret
  3807*    compute lme-ret-fees (2) = lme-earn-prem (2) * am-ah-ret
  3808*    compute lye-ret-fees (1) = lye-earn-prem (1) * am-lf-ret
  3809*    compute lye-ret-fees (2) = lye-earn-prem (2) * am-ah-ret
  3810
  3811***  first occurrence is account date range detail
  3812
  3813     move ws-accum-record (1)    to sw-accums
  3814     display ' key ' sw-retro-group ' ' sw-acct-key
  3815     release sw-rec-out
  3816
  3817*    add +1 to d1
  3818*    move sw-rec-out             to ws-hold-dr-records (d1)
  3819*    move d1                     to d1m
  3820*    display ' just released ' sw-retro-group ' ' sw-acct-key
  3821*       ' ' SW-EXP-DTE ' ' d1m
  3822
  3823     add 1 to ws-rel-recs
  3824
  3825     .
  3826 3300-continue.
  3827
  3828     move ep-carrier             to ws-prev-carrier
  3829     move ep-grouping            to ws-prev-grouping
  3830     move ep-state               to ws-prev-state
  3831     move ep-account             to ws-prev-account
  3832     move ep-exp-dte             to ws-prev-exp-dte
  3833     move +1                     to i0
  3834     perform 0050-init-acct-accums
  3835                                 thru 0050-exit
  3836
  3837     .
  3838 3300-exit.
  3839     exit.
  3840
  3841 3500-release-drs.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS043SL.cbl
  3842
  3843     perform 3300-release-rec    thru 3300-exit
  3844
  3845     if am-ret-y-n not = ' '
  3846        perform varying d1 from +1 by +1 until d1 > d1m
  3847           move ws-hold-dr-records (d1)
  3848                                 to sw-rec-out
  3849           release sw-rec-out
  3850           add 1 to ws-rel-drs
  3851        end-perform
  3852     else
  3853        if d1m not = +0
  3854           display ' bypassing account ' ws-prev-carrier ' '
  3855              ws-prev-state ' ' ws-prev-account
  3856        end-if
  3857     end-if
  3858
  3859     .
  3860 3500-exit.
  3861     exit.
  3862
  3863
  3864 4000-sort-output.
  3865
  3866     perform 4100-init           thru 4100-exit
  3867     perform 4300-process-output thru 4300-exit until
  3868        end-of-input
  3869
  3870     perform 4330-final-totals   thru 4330-exit
  3871
  3872     .
  3873 4000-exit.
  3874     exit.
  3875
  3876 4100-init.
  3877
  3878     move ' '                    to ws-eof-sw
  3879     perform varying i0 from +1 by +1 until i0 > +4
  3880        perform 0050-init-acct-accums
  3881                                 thru 0050-exit
  3882     end-perform
  3883
  3884     perform 4200-return         thru 4200-exit
  3885     move sw-retro-group         to ws-prev-retro-group
  3886     move sw-acct-key            to ws-prev-acct-key
  3887
  3888     .
  3889 4100-exit.
  3890     exit.
  3891
  3892 4200-return.
  3893
  3894     return sort-work at end
  3895        set end-of-input to true
  3896     end-return
  3897
  3898     if not end-of-input
  3899        move sw-accums           to ws-accum-record (1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS043SL.cbl
  3900        display ' ret key ' sw-retro-group ' ' sw-acct-key
  3901     end-if
  3902
  3903     .
  3904 4200-exit.
  3905     exit.
  3906
  3907
  3908 4300-process-output.
  3909
  3910     if sw-retro-group not = ws-prev-retro-group
  3911        perform 4320-ret-grp-break
  3912                                 thru 4320-exit
  3913     end-if
  3914
  3915     if sw-acct-key not = ws-prev-acct-key
  3916        perform 4310-acct-break  thru 4310-exit
  3917     end-if
  3918
  3919*****   adding date range detail to account level totals
  3920
  3921     move +1                     to i9
  3922     move +2                     to o9
  3923     perform 4500-accum-levels   thru 4500-exit
  3924
  3925     move sw-retro-group         to ws-prev-retro-group
  3926     move sw-acct-key            to ws-prev-acct-key
  3927     move sw-acct-name           to ws-acct-name
  3928     move sw-acct-addr1          to ws-acct-addr1
  3929     move sw-acct-city-state     to ws-acct-city-state
  3930     move sw-acct-zip            to ws-acct-zip
  3931     move sw-acct-rptcd1         to ws-acct-rptcd1
  3932     move sw-acct-rptcd2         to ws-acct-rptcd2
  3933     move sw-acct-rptcd3         to ws-acct-rptcd3
  3934
  3935     perform 4200-return         thru 4200-exit
  3936
  3937     .
  3938 4300-exit.
  3939     exit.
  3940
  3941 4310-acct-break.
  3942
  3943***  print account tots
  3944     move +2                     to i0
  3945     perform 4400-print-totals   thru 4400-exit
  3946
  3947***  add acct tots to retro group tots
  3948     move +2                     to i9
  3949     move +3                     to o9
  3950     perform 4500-accum-levels   thru 4500-exit
  3951
  3952***  zero out the account accums
  3953     move +2                     to i0
  3954     perform 0050-init-acct-accums
  3955                                 thru 0050-exit
  3956     .
  3957 4310-exit.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS043SL.cbl
  3958     exit.
  3959
  3960 4320-ret-grp-break.
  3961
  3962     perform 4310-acct-break     thru 4310-exit
  3963***  print retro group tots
  3964     move +3                     to i0
  3965     perform 4400-print-totals   thru 4400-exit
  3966
  3967***  add retro group tots to final tots
  3968     move +3                     to i9
  3969     move +4                     to o9
  3970     perform 4500-accum-levels   thru 4500-exit
  3971
  3972***  zero out the retro group accums
  3973     move +3                     to i0
  3974     perform 0050-init-acct-accums
  3975                                 thru 0050-exit
  3976
  3977     .
  3978 4320-exit.
  3979     exit.
  3980
  3981 4330-final-totals.
  3982
  3983     perform 4310-acct-break     thru 4310-exit
  3984***  print retro group tots
  3985     move +3                     to i0
  3986     perform 4400-print-totals   thru 4400-exit
  3987
  3988***  add retro group tots to final tots
  3989     move +3                     to i9
  3990     move +4                     to o9
  3991     perform 4500-accum-levels   thru 4500-exit
  3992
  3993***  zero out the retro group accums
  3994     move +3                     to i0
  3995     perform 0050-init-acct-accums
  3996                                 thru 0050-exit
  3997
  3998     move +4                     to i0
  3999     perform 4400-print-totals   thru 4400-exit
  4000
  4001     .
  4002 4330-exit.
  4003     exit.
  4004
  4005 4400-print-totals.
  4006
  4007     move ws-prev-retro-group    to h5-group
  4008                                    ir-pool-code
  4009*    if ws-prev-retro-group = 'MISAUT'
  4010*       set active-group to true
  4011*       move 'MISAUT'            to h5-name
  4012*    else
  4013     search all ws-retro-table at end
  4014        continue
  4015       when ws-prev-retro-group = ws-retro-group (r1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS043SL.cbl
  4016        set active-group to true
  4017        move ws-retro-name (r1)
  4018                                 to h5-name
  4019        move ws-retro-eff-dte (r1)
  4020                                 to h4-eff-dte
  4021        move ws-retro-next-rpt-mo (r1)
  4022                                 to h5-anniv-dte
  4023        move '/01'               to h5-anniv-dte (3:3)
  4024     end-search
  4025*    end-if
  4026     if i0 = +3 or +4
  4027        move spaces              to h1-name
  4028                                    h2-addr
  4029                                    h3-addr
  4030*                                   h3-zip
  4031                                    h5-st
  4032                                    h5-acct
  4033     else
  4034        move ws-acct-name        to h1-name
  4035        move ws-acct-addr1       to h2-addr
  4036
  4037        move spaces              to h3-addr
  4038        if ws-acct-zip (6:4) not = spaces
  4039           string
  4040              ws-acct-city-state ' '
  4041              ws-acct-zip (1:5)  '-'
  4042              ws-acct-zip (6:4)
  4043              delimited by '  '     into h3-addr
  4044           end-string
  4045        else
  4046           string
  4047              ws-acct-city-state ' '
  4048              ws-acct-zip (1:5)
  4049              delimited by '  '     into h3-addr
  4050           end-string
  4051        end-if
  4052*       move ws-acct-city-state  to h3-addr
  4053*       move ws-acct-zip         to h3-zip
  4054        move 'ST ACCOUNT  '      to h4-stacct
  4055        move ws-prev-carrier     to ir-carrier
  4056        move ws-prev-grouping    to ir-group
  4057        move ws-prev-state       to h5-st
  4058                                    ir-state
  4059        move ws-prev-account     to h5-acct
  4060                                    ir-account
  4061        move ws-acct-rptcd1      to ir-rptcd1
  4062        move ws-acct-rptcd2      to ir-rptcd2
  4063        move ws-acct-rptcd3      to ir-rptcd3
  4064        move '-'                 to H5-FS1
  4065*       move ws-prev-retro-group to h5-group
  4066     end-if
  4067
  4068     if i0 = +3
  4069        move 'RETRO GROUP TOTALS ' TO H3-ADDR
  4070        move spaces                to H5-FS1
  4071                                      H4-STACCT
  4072     end-if
  4073     if i0 =  +4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS043SL.cbl
  4074        move spaces              to h5-group
  4075                                    h5-name
  4076                                    head-4
  4077                                    H5-FS1
  4078        move 'FINAL TOTALS '     to h3-addr
  4079     end-if
  4080
  4081***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4082***                                                            ***
  4083***   This code creates an index file that is used by the      ***
  4084***   RDS for report distribution.                             ***
  4085***                                                            ***
  4086***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4087
  4088     compute ir-page-no = ir-page-no + 1
  4089
  4090     evaluate true
  4091        when i0 = +4
  4092           move spaces to index-record (6:55)
  4093        when i0 = +3
  4094           move spaces to index-record (12:49)
  4095     end-evaluate
  4096
  4097     string
  4098        ir-page-no               ';'
  4099        ir-pool-code             ';'
  4100        ir-rptcd1                ';'
  4101        ir-rptcd2                ';'
  4102        ir-rptcd3                ';'
  4103        ir-carrier               ';'
  4104        ir-group                 ';'
  4105        ir-state                 ';'
  4106        ir-account               ';'
  4107        delimited by size into index-file-rec
  4108     end-string
  4109     write index-file-rec
  4110
  4111     perform 0590-heading-routine thru 0590-exit
  4112
  4113***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4114***                                                            ***
  4115***   B E G I N   R E V E N U E S                              ***
  4116***                                                            ***
  4117***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4118
  4119     compute cur-net-prem (i0 1) =
  4120        cur-gross-prem (i0 1) - cur-cancel-prem (i0 1)
  4121     compute cur-earn-prem (i0 1) =
  4122        cur-net-prem (i0 1) - cur-uep (i0 1)
  4123     compute cur-tot-income (i0 1) =
  4124        cur-earn-prem (i0 1) + cur-inv-income (i0 1)
  4125
  4126     compute cur-net-prem (i0 2) =
  4127        cur-gross-prem (i0 2) - cur-cancel-prem (i0 2)
  4128     compute cur-earn-prem (i0 2) =
  4129        cur-net-prem (i0 2) - cur-uep (i0 2)
  4130     compute cur-tot-income (i0 2) =
  4131        cur-earn-prem (i0 2) + cur-inv-income (i0 2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS043SL.cbl
  4132
  4133     compute lme-net-prem (i0 1) =
  4134        lme-gross-prem (i0 1) - lme-cancel-prem (i0 1)
  4135     compute lme-earn-prem (i0 1) =
  4136        lme-net-prem (i0 1) - lme-uep (i0 1)
  4137     compute lme-tot-income (i0 1) =
  4138        lme-earn-prem (i0 1) + lme-inv-income (i0 1)
  4139
  4140     compute lme-net-prem (i0 2) =
  4141        lme-gross-prem (i0 2) - lme-cancel-prem (i0 2)
  4142     compute lme-earn-prem (i0 2) =
  4143        lme-net-prem (i0 2) - lme-uep (i0 2)
  4144     compute lme-tot-income (i0 2) =
  4145        lme-earn-prem (i0 2) + lme-inv-income (i0 2)
  4146
  4147     compute lye-net-prem (i0 1) =
  4148        lye-gross-prem (i0 1) - lye-cancel-prem (i0 1)
  4149     compute lye-earn-prem (i0 1) =
  4150        lye-net-prem (i0 1) - lye-uep (i0 1)
  4151     compute lye-tot-income (i0 1) =
  4152        lye-earn-prem (i0 1) + lye-inv-income (i0 1)
  4153
  4154     compute lye-net-prem (i0 2) =
  4155        lye-gross-prem (i0 2) - lye-cancel-prem (i0 2)
  4156     compute lye-earn-prem (i0 2) =
  4157        lye-net-prem (i0 2) - lye-uep (i0 2)
  4158     compute lye-tot-income (i0 2) =
  4159        lye-earn-prem (i0 2) + lye-inv-income (i0 2)
  4160
  4161
  4162     move '      Gross Premium           '
  4163                                 to det-desc
  4164     compute det-mtd-lf =
  4165        cur-gross-prem (i0 1) - lme-gross-prem (i0 1)
  4166     compute det-mtd-ah =
  4167        cur-gross-prem (i0 2) - lme-gross-prem (i0 2)
  4168     compute det-ytd-lf =
  4169        cur-gross-prem (i0 1) - lye-gross-prem (i0 1)
  4170     compute det-ytd-ah =
  4171        cur-gross-prem (i0 2) - lye-gross-prem (i0 2)
  4172     move cur-gross-prem (i0 1)     to det-itd-lf
  4173     move cur-gross-prem (i0 2)     to det-itd-ah
  4174     compute det-itd-tot =
  4175        cur-gross-prem (i0 1) + cur-gross-prem (i0 2)
  4176     MOVE '0'                    TO X
  4177     MOVE detail-line            TO P-DATA
  4178     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4179
  4180     move '      Cancellations           '
  4181                                 to det-desc
  4182     compute det-mtd-lf =
  4183        cur-cancel-prem (i0 1) - lme-cancel-prem (i0 1)
  4184     compute det-mtd-ah =
  4185        cur-cancel-prem (i0 2) - lme-cancel-prem (i0 2)
  4186     compute det-ytd-lf =
  4187        cur-cancel-prem (i0 1) - lye-cancel-prem (i0 1)
  4188     compute det-ytd-ah =
  4189        cur-cancel-prem (i0 2) - lye-cancel-prem (i0 2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS043SL.cbl
  4190     move cur-cancel-prem (i0 1) to det-itd-lf
  4191     move cur-cancel-prem (i0 2) to det-itd-ah
  4192     compute det-itd-tot =
  4193        cur-cancel-prem (i0 1) + cur-cancel-prem (i0 2)
  4194     MOVE ' '                    TO X
  4195     MOVE detail-line            TO P-DATA
  4196     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4197
  4198     move 'Net Written Premium           '
  4199                                 to det-desc
  4200     compute det-mtd-lf =
  4201        cur-net-prem (i0 1) - lme-net-prem (i0 1)
  4202     compute det-mtd-ah =
  4203        cur-net-prem (i0 2) - lme-net-prem (i0 2)
  4204     compute det-ytd-lf =
  4205        cur-net-prem (i0 1) - lye-net-prem (i0 1)
  4206     compute det-ytd-ah =
  4207        cur-net-prem (i0 2) - lye-net-prem (i0 2)
  4208     move cur-net-prem (i0 1)    to det-itd-lf
  4209     move cur-net-prem (i0 2)    to det-itd-ah
  4210     compute det-itd-tot =
  4211        cur-net-prem (i0 1) + cur-net-prem (i0 2)
  4212     MOVE ' '                    TO X
  4213     MOVE detail-line            TO P-DATA
  4214     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4215
  4216     move '      Change in UEP           '
  4217                                 to det-desc
  4218     compute det-mtd-lf =
  4219        cur-uep (i0 1) - lme-uep (i0 1)
  4220     compute det-mtd-ah =
  4221        cur-uep (i0 2) - lme-uep (i0 2)
  4222     compute det-ytd-lf =
  4223        cur-uep (i0 1) - lye-uep (i0 1)
  4224     compute det-ytd-ah =
  4225        cur-uep (i0 2) - lye-uep (i0 2)
  4226     move cur-uep (i0 1)         to det-itd-lf
  4227     move cur-uep (i0 2)         to det-itd-ah
  4228     compute det-itd-tot =
  4229        cur-uep (i0 1) + cur-uep (i0 2)
  4230     MOVE ' '                    TO X
  4231     MOVE detail-line            TO P-DATA
  4232     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4233
  4234
  4235     move '     Earned Premium           '
  4236                                 to det-desc
  4237     compute det-mtd-lf =
  4238        cur-earn-prem (i0 1) - lme-earn-prem (i0 1)
  4239     compute det-mtd-ah =
  4240        cur-earn-prem (i0 2) - lme-earn-prem (i0 2)
  4241     compute det-ytd-lf =
  4242        cur-earn-prem (i0 1) - lye-earn-prem (i0 1)
  4243     compute det-ytd-ah =
  4244        cur-earn-prem (i0 2) - lye-earn-prem (i0 2)
  4245     move cur-earn-prem (i0 1)   to det-itd-lf
  4246     move cur-earn-prem (i0 2)   to det-itd-ah
  4247     compute det-itd-tot =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS043SL.cbl
  4248        cur-earn-prem (i0 1) + cur-earn-prem (i0 2)
  4249     MOVE ' '                    TO X
  4250     MOVE detail-line            TO P-DATA
  4251     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4252
  4253*    move '  Investment Income           '
  4254*                                to det-desc
  4255*    compute det-mtd-lf =
  4256*       cur-inv-income (i0 1) - lme-inv-income (i0 1)
  4257*    compute det-mtd-ah =
  4258*       cur-inv-income (i0 2) - lme-inv-income (i0 2)
  4259*    compute det-ytd-lf =
  4260*       cur-inv-income (i0 1) - lye-inv-income (i0 1)
  4261*    compute det-ytd-ah =
  4262*       cur-inv-income (i0 2) - lye-inv-income (i0 2)
  4263*    move cur-inv-income (i0 1)     to det-itd-lf
  4264*    move cur-inv-income (i0 2)     to det-itd-ah
  4265*    MOVE ' '                    TO X
  4266*    MOVE detail-line            TO P-DATA
  4267*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4268
  4269*    move '     Total Revenues           '
  4270*                                to det-desc
  4271*    compute det-mtd-lf =
  4272*       cur-tot-income (i0 1) - lme-tot-income (i0 1)
  4273*    compute det-mtd-ah =
  4274*       cur-tot-income (i0 2) - lme-tot-income (i0 2)
  4275*    compute det-ytd-lf =
  4276*       cur-tot-income (i0 1) - lye-tot-income (i0 1)
  4277*    compute det-ytd-ah =
  4278*       cur-tot-income (i0 2) - lye-tot-income (i0 2)
  4279*    move cur-tot-income (i0 1)     to det-itd-lf
  4280*    move cur-tot-income (i0 2)     to det-itd-ah
  4281*    MOVE ' '                    TO X
  4282*    MOVE detail-line            TO P-DATA
  4283*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4284
  4285***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4286***                                                            ***
  4287***   B E G I N   E X P E N S E S                              ***
  4288***                                                            ***
  4289***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4290
  4291     compute cur-tot-expenses (i0 1) =
  4292        cur-acct-comms (i0 1) + cur-ret-fees (i0 1) +
  4293        cur-clm-pmts (i0 1)
  4294        + cur-prem-tax (i0 1) + cur-other-expenses (i0 1)
  4295     compute cur-tot-expenses (i0 2) =
  4296        cur-acct-comms (i0 2) + cur-ret-fees (i0 2) +
  4297         cur-clm-pmts (i0 2)
  4298        + cur-prem-tax (i0 2) + cur-other-expenses (i0 2)
  4299
  4300     compute lme-tot-expenses (i0 1) =
  4301        lme-acct-comms (i0 1) + lme-ret-fees (i0 1) +
  4302         lme-clm-pmts (i0 1)
  4303        + lme-prem-tax (i0 1) + lme-other-expenses (i0 1)
  4304     compute lme-tot-expenses (i0 2) =
  4305        lme-acct-comms (i0 2) + lme-ret-fees (i0 2) +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS043SL.cbl
  4306         lme-clm-pmts (i0 2)
  4307        + lme-prem-tax (i0 2) + lme-other-expenses (i0 2)
  4308
  4309     compute lye-tot-expenses (i0 1) =
  4310        lye-acct-comms (i0 1) + lye-ret-fees (i0 1) +
  4311         lye-clm-pmts (i0 1)
  4312        + lye-prem-tax (i0 1) + lye-other-expenses (i0 1)
  4313     compute lye-tot-expenses (i0 2) =
  4314        lye-acct-comms (i0 2) + lye-ret-fees (i0 2) +
  4315         lye-clm-pmts (i0 2)
  4316        + lye-prem-tax (i0 2) + lye-other-expenses (i0 2)
  4317
  4318     compute cur-net-cash-flow (i0 1) =
  4319        cur-tot-income (i0 1) - cur-tot-expenses (i0 1)
  4320     compute cur-net-cash-flow (i0 2) =
  4321        cur-tot-income (i0 2) - cur-tot-expenses (i0 2)
  4322
  4323     compute lme-net-cash-flow (i0 1) =
  4324        lme-tot-income (i0 1) - lme-tot-expenses (i0 1)
  4325     compute lme-net-cash-flow (i0 2) =
  4326        lme-tot-income (i0 2) - lme-tot-expenses (i0 2)
  4327
  4328     compute lye-net-cash-flow (i0 1) =
  4329        lye-tot-income (i0 1) - lye-tot-expenses (i0 1)
  4330     compute lye-net-cash-flow (i0 2) =
  4331        lye-tot-income (i0 2) - lye-tot-expenses (i0 2)
  4332
  4333*    compute cur-net-mep-comm (i0 1) = cur-net-cash-flow (i0 1) -
  4334*       cur-mort-resv (i0 1) - cur-clm-resv (i0 1)
  4335*    compute cur-net-mep-comm (i0 2) = cur-net-cash-flow (i0 2) -
  4336*       cur-mort-resv (i0 2) - cur-clm-resv (i0 2)
  4337*    compute lme-net-mep-comm (i0 1) = lme-net-cash-flow (i0 1) -
  4338*       lme-mort-resv (i0 1) - lme-clm-resv (i0 1)
  4339*    compute lme-net-mep-comm (i0 2) = lme-net-cash-flow (i0 2) -
  4340*       lme-mort-resv (i0 2) - lme-clm-resv (i0 2)
  4341*    compute lye-net-mep-comm (i0 1) = lye-net-cash-flow (i0 1) -
  4342*       lye-mort-resv (i0 1) - lye-clm-resv (i0 1)
  4343*    compute lye-net-mep-comm (i0 2) = lye-net-cash-flow (i0 2) -
  4344*       lye-mort-resv (i0 2) - lye-clm-resv (i0 2)
  4345
  4346     compute cur-net-mep-comm (i0 1) =
  4347        cur-net-cash-flow (i0 1) - cur-clm-resv (i0 1)
  4348     compute cur-net-mep-comm (i0 2) =
  4349        cur-net-cash-flow (i0 2) - cur-clm-resv (i0 2)
  4350     compute lme-net-mep-comm (i0 1) =
  4351        lme-net-cash-flow (i0 1) - lme-clm-resv (i0 1)
  4352     compute lme-net-mep-comm (i0 2) =
  4353        lme-net-cash-flow (i0 2) - lme-clm-resv (i0 2)
  4354     compute lye-net-mep-comm (i0 1) =
  4355        lye-net-cash-flow (i0 1) - lye-clm-resv (i0 1)
  4356     compute lye-net-mep-comm (i0 2) =
  4357        lye-net-cash-flow (i0 2) - lye-clm-resv (i0 2)
  4358
  4359     compute cur-mep-due (i0 1) =
  4360        cur-net-mep-comm (i0 1) - cur-retro-pmts (i0 1)
  4361     compute cur-mep-due (i0 2) =
  4362        cur-net-mep-comm (i0 2) - cur-retro-pmts (i0 2)
  4363     compute lme-mep-due (i0 1) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS043SL.cbl
  4364        lme-net-mep-comm (i0 1) - lme-retro-pmts (i0 1)
  4365     compute lme-mep-due (i0 2) =
  4366        lme-net-mep-comm (i0 2) - lme-retro-pmts (i0 2)
  4367     compute lye-mep-due (i0 1) =
  4368        lye-net-mep-comm (i0 1) - lye-retro-pmts (i0 1)
  4369     compute lye-mep-due (i0 2) =
  4370        lye-net-mep-comm (i0 2) - lye-retro-pmts (i0 2)
  4371
  4372     MOVE '-'                    TO X
  4373     MOVE spaces                 TO P-DATA
  4374     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4375
  4376
  4377*    MOVE '0'                    TO X
  4378*    MOVE HEAD-9                 TO P-DATA
  4379*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4380
  4381     move '        Commissions           '
  4382                                 to det-desc
  4383     compute det-mtd-lf =
  4384        cur-acct-comms (i0 1) - lme-acct-comms (i0 1)
  4385     compute det-mtd-ah =
  4386        cur-acct-comms (i0 2) - lme-acct-comms (i0 2)
  4387     compute det-ytd-lf =
  4388        cur-acct-comms (i0 1) - lye-acct-comms (i0 1)
  4389     compute det-ytd-ah =
  4390        cur-acct-comms (i0 2) - lye-acct-comms (i0 2)
  4391     move cur-acct-comms (i0 1)  to det-itd-lf
  4392     move cur-acct-comms (i0 2)  to det-itd-ah
  4393     compute det-itd-tot =
  4394        cur-acct-comms (i0 1) + cur-acct-comms (i0 2)
  4395     MOVE '0'                    TO X
  4396     MOVE detail-line            TO P-DATA
  4397     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4398
  4399     move '     Retention Fees           '
  4400                                 to det-desc
  4401     compute det-mtd-lf =
  4402        cur-ret-fees (i0 1) - lme-ret-fees (i0 1)
  4403     compute det-mtd-ah =
  4404        cur-ret-fees (i0 2) - lme-ret-fees (i0 2)
  4405     compute det-ytd-lf =
  4406        cur-ret-fees (i0 1) - lye-ret-fees (i0 1)
  4407     compute det-ytd-ah =
  4408        cur-ret-fees (i0 2) - lye-ret-fees (i0 2)
  4409     move cur-ret-fees (i0 1)    to det-itd-lf
  4410     move cur-ret-fees (i0 2)    to det-itd-ah
  4411     compute det-itd-tot =
  4412        cur-ret-fees (i0 1) + cur-ret-fees (i0 2)
  4413     MOVE ' '                    TO X
  4414     MOVE detail-line            TO P-DATA
  4415     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4416
  4417     move '        Claims Paid           '
  4418                                 to det-desc
  4419     compute det-mtd-lf =
  4420        cur-clm-pmts (i0 1) - lme-clm-pmts (i0 1)
  4421     compute det-mtd-ah =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS043SL.cbl
  4422        cur-clm-pmts (i0 2) - lme-clm-pmts (i0 2)
  4423     compute det-ytd-lf =
  4424        cur-clm-pmts (i0 1) - lye-clm-pmts (i0 1)
  4425     compute det-ytd-ah =
  4426        cur-clm-pmts (i0 2) - lye-clm-pmts (i0 2)
  4427     move cur-clm-pmts (i0 1)    to det-itd-lf
  4428     move cur-clm-pmts (i0 2)    to det-itd-ah
  4429     compute det-itd-tot =
  4430        cur-clm-pmts (i0 1) + cur-clm-pmts (i0 2)
  4431     MOVE ' '                    TO X
  4432     MOVE detail-line            TO P-DATA
  4433     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4434
  4435     move '      Premium Taxes           '
  4436                                 to det-desc
  4437     compute det-mtd-lf =
  4438        cur-prem-tax (i0 1) - lme-prem-tax (i0 1)
  4439     compute det-mtd-ah =
  4440        cur-prem-tax (i0 2) - lme-prem-tax (i0 2)
  4441     compute det-ytd-lf =
  4442        cur-prem-tax (i0 1) - lye-prem-tax (i0 1)
  4443     compute det-ytd-ah =
  4444        cur-prem-tax (i0 2) - lye-prem-tax (i0 2)
  4445     move cur-prem-tax (i0 1)    to det-itd-lf
  4446     move cur-prem-tax (i0 2)    to det-itd-ah
  4447     compute det-itd-tot =
  4448        cur-prem-tax (i0 1) + cur-prem-tax (i0 2)
  4449     MOVE ' '                    TO X
  4450     MOVE detail-line            TO P-DATA
  4451     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4452
  4453     move '              Other           '
  4454                                 to det-desc
  4455     compute det-mtd-lf =
  4456        cur-other-expenses (i0 1) - lme-other-expenses (i0 1)
  4457     compute det-mtd-ah =
  4458        cur-other-expenses (i0 2) - lme-other-expenses (i0 2)
  4459     compute det-ytd-lf =
  4460        cur-other-expenses (i0 1) - lye-other-expenses (i0 1)
  4461     compute det-ytd-ah =
  4462        cur-other-expenses (i0 2) - lye-other-expenses (i0 2)
  4463     move cur-other-expenses (i0 1)
  4464                                 to det-itd-lf
  4465     move cur-other-expenses (i0 2)
  4466                                 to det-itd-ah
  4467     compute det-itd-tot =
  4468        cur-other-expenses (i0 1) + cur-other-expenses (i0 2)
  4469     MOVE ' '                    TO X
  4470     MOVE detail-line            TO P-DATA
  4471     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4472
  4473     move '     Total Expenses           '
  4474                                 to det-desc
  4475     compute det-mtd-lf =
  4476        cur-tot-expenses (i0 1) - lme-tot-expenses (i0 1)
  4477     compute det-mtd-ah =
  4478        cur-tot-expenses (i0 2) - lme-tot-expenses (i0 2)
  4479     compute det-ytd-lf =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS043SL.cbl
  4480        cur-tot-expenses (i0 1) - lye-tot-expenses (i0 1)
  4481     compute det-ytd-ah =
  4482        cur-tot-expenses (i0 2) - lye-tot-expenses (i0 2)
  4483     move cur-tot-expenses (i0 1) to det-itd-lf
  4484     move cur-tot-expenses (i0 2) to det-itd-ah
  4485     compute det-itd-tot =
  4486        cur-tot-expenses (i0 1) + cur-tot-expenses (i0 2)
  4487     MOVE ' '                    TO X
  4488     MOVE detail-line            TO P-DATA
  4489     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4490
  4491*    move ' N e t  C a s h  F l o w      '
  4492*                                to det-desc
  4493*    compute det-mtd-lf =
  4494*       cur-net-cash-flow (i0 1) - lme-net-cash-flow (i0 1)
  4495*    compute det-mtd-ah =
  4496*       cur-net-cash-flow (i0 2) - lme-net-cash-flow (i0 2)
  4497*    compute det-ytd-lf =
  4498*       cur-net-cash-flow (i0 1) - lye-net-cash-flow (i0 1)
  4499*    compute det-ytd-ah =
  4500*       cur-net-cash-flow (i0 2) - lye-net-cash-flow (i0 2)
  4501*    move cur-net-cash-flow (i0 1)     to det-itd-lf
  4502*    move cur-net-cash-flow (i0 2)     to det-itd-ah
  4503*    MOVE '0'                    TO X
  4504*    MOVE detail-line            TO P-DATA
  4505*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4506
  4507*    move 'Change In Mort Reserve        '
  4508*                                to det-desc
  4509*    compute det-mtd-lf =
  4510*       cur-mort-resv (i0 1) - lme-mort-resv (i0 1)
  4511*    compute det-mtd-ah =
  4512*       cur-mort-resv (i0 2) - lme-mort-resv (i0 2)
  4513*    compute det-ytd-lf =
  4514*       cur-mort-resv (i0 1) - lye-mort-resv (i0 1)
  4515*    compute det-ytd-ah =
  4516*       cur-mort-resv (i0 2) - lye-mort-resv (i0 2)
  4517*    move cur-mort-resv (i0 1)     to det-itd-lf
  4518*    move cur-mort-resv (i0 2)     to det-itd-ah
  4519*    MOVE '0'                    TO X
  4520*    MOVE detail-line            TO P-DATA
  4521*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4522
  4523     move '    Change In Claim           '
  4524                                 to det-misc-desc
  4525     MOVE '0'                    TO X
  4526     MOVE detail-desc-line       TO P-DATA
  4527     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4528     move '            Reserve           '
  4529                                 to det-desc
  4530     compute det-mtd-lf =
  4531        cur-clm-resv (i0 1) - lme-clm-resv (i0 1)
  4532     compute det-mtd-ah =
  4533        cur-clm-resv (i0 2) - lme-clm-resv (i0 2)
  4534     compute det-ytd-lf =
  4535        cur-clm-resv (i0 1) - lye-clm-resv (i0 1)
  4536     compute det-ytd-ah =
  4537        cur-clm-resv (i0 2) - lye-clm-resv (i0 2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS043SL.cbl
  4538     move cur-clm-resv (i0 1)    to det-itd-lf
  4539     move cur-clm-resv (i0 2)    to det-itd-ah
  4540     compute det-itd-tot =
  4541        cur-clm-resv (i0 1) + cur-clm-resv (i0 2)
  4542     MOVE ' '                    TO X
  4543     MOVE detail-line            TO P-DATA
  4544     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4545
  4546*    move '   System Generated           '
  4547*                                to det-misc-desc
  4548*    MOVE '0'                    TO X
  4549*    MOVE detail-desc-line       TO P-DATA
  4550*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4551*    move '   Retro Commission           '
  4552*                                to det-desc
  4553
  4554*    move ' Net MEP Commission           '
  4555*                                to det-desc
  4556
  4557
  4558     MOVE '-'                    TO X
  4559     MOVE spaces                 TO P-DATA
  4560     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4561     MOVE '0'                    TO X
  4562     MOVE spaces                 TO P-DATA
  4563     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4564
  4565     move spaces                 to det-desc
  4566     move '   System Generated           '
  4567                                 to det-desc
  4568     compute det-mtd-lf =
  4569        cur-net-mep-comm (i0 1) - lme-net-mep-comm (i0 1)
  4570     compute det-mtd-ah =
  4571        cur-net-mep-comm (i0 2) - lme-net-mep-comm (i0 2)
  4572     compute det-ytd-lf =
  4573        cur-net-mep-comm (i0 1) - lye-net-mep-comm (i0 1)
  4574     compute det-ytd-ah =
  4575        cur-net-mep-comm (i0 2) - lye-net-mep-comm (i0 2)
  4576     move cur-net-mep-comm (i0 1) to det-itd-lf
  4577     move cur-net-mep-comm (i0 2) to det-itd-ah
  4578     compute det-itd-tot =
  4579        cur-net-mep-comm (i0 1) + cur-net-mep-comm (i0 2)
  4580     MOVE '0'                    TO X
  4581     MOVE detail-line            TO P-DATA
  4582     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4583
  4584
  4585***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4586***                                                            ***
  4587***   They asked me to plug the itd mep commission due into    ***
  4588*** the mtd commission due and to compute the mtd prior mep    ***
  4589*** due as mep comm due + prior pmts - net mep comm.           ***
  4590***                                                            ***
  4591***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4592
  4593*    move '      Prior MEP Due           '
  4594*                                to det-desc
  4595*    move zeros                  to det-mtd-lf
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS043SL.cbl
  4596*                                   det-mtd-ah
  4597*                                   det-ytd-lf
  4598*                                   det-ytd-ah
  4599*                                   det-itd-lf
  4600*                                   det-itd-ah
  4601*    compute det-mtd-lf = cur-mep-due (i0 1) +
  4602*       (cur-retro-pmts (i0 1) - lme-retro-pmts (i0 1)) -
  4603*       (cur-net-mep-comm (i0 1) - lme-net-mep-comm (i0 1))
  4604*    compute det-mtd-ah = cur-mep-due (i0 2) +
  4605*       (cur-retro-pmts (i0 2) - lme-retro-pmts (i0 2)) -
  4606*       (cur-net-mep-comm (i0 2) - lme-net-mep-comm (i0 2))
  4607*
  4608*    MOVE '0'                    TO X
  4609*    MOVE detail-line            TO P-DATA
  4610*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4611
  4612***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4613***                                                            ***
  4614***   Since the retro payments are entered at the account      ***
  4615*** level in Logic but actually paid at the group level we     ***
  4616*** don't want to report the payments at the account level.    ***
  4617***                                                            ***
  4618***_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
  4619
  4620     if i0 = +1 or +2
  4621        MOVE '-'                 TO X
  4622        MOVE spaces              TO P-DATA
  4623        PERFORM 0610-PRT-RTN     THRU 0610-EXIT
  4624        move '0'                 to x
  4625        move spaces              to p-data
  4626        PERFORM 0610-PRT-RTN     THRU 0610-EXIT
  4627        go to 4400-bypass-prior
  4628     end-if
  4629
  4630     move 'Less prior payments           '
  4631*    move '   Prior Retro Paid           '
  4632                                 to mep-desc
  4633*    compute mep-mtd-lf =
  4634*       cur-retro-pmts (i0 1) - lme-retro-pmts (i0 1)
  4635*    compute mep-mtd-ah =
  4636*       cur-retro-pmts (i0 2) - lme-retro-pmts (i0 2)
  4637     move zeros                  to mep-mtd-lf
  4638                                    mep-mtd-ah
  4639                                    mep-ytd-lf
  4640                                    mep-ytd-ah
  4641                                    mep-itd-lf
  4642                                    mep-itd-ah
  4643*    compute mep-ytd-lf =
  4644*       cur-retro-pmts (i0 1) - lye-retro-pmts (i0 1)
  4645*    compute mep-ytd-ah =
  4646*       cur-retro-pmts (i0 2) - lye-retro-pmts (i0 2)
  4647*    move cur-retro-pmts (i0 1)  to mep-itd-lf
  4648*    move cur-retro-pmts (i0 2)  to mep-itd-ah
  4649     compute mep-itd-tot =
  4650        cur-retro-pmts (i0 1) + cur-retro-pmts (i0 2)
  4651     MOVE '0'                    TO X
  4652     MOVE mep-detail-line        TO P-DATA
  4653     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS043SL.cbl
  4654
  4655
  4656*    move '   System Generated           '
  4657*                                to det-misc-desc
  4658*    MOVE '0'                    TO X
  4659*    MOVE detail-desc-line       TO P-DATA
  4660*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4661*    move 'Retro Commission Due          '
  4662*                                to mep-desc
  4663
  4664*    move ' MEP Commission Due           '
  4665*                                to mep-desc
  4666*    compute mep-mtd-lf =
  4667*       cur-mep-due (i0 1) - lme-mep-due (i0 1)
  4668*    compute mep-mtd-ah =
  4669*       cur-mep-due (i0 2) - lme-mep-due (i0 2)
  4670*    compute mep-ytd-lf =
  4671*       cur-mep-due (i0 1) - lye-mep-due (i0 1)
  4672*    compute mep-ytd-ah =
  4673*       cur-mep-due (i0 2) - lye-mep-due (i0 2)
  4674
  4675     move '0'                    to x
  4676     move spaces                 to p-data
  4677     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4678     move ' '                    to x
  4679     move '          Estimated'  to p-data
  4680
  4681     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4682
  4683     move '   Cont. Commission'  to mep-desc
  4684     move zeros                  to mep-ytd-lf
  4685                                    mep-ytd-ah
  4686                                    mep-mtd-lf
  4687                                    mep-mtd-ah
  4688                                    mep-itd-lf
  4689                                    mep-itd-ah
  4690
  4691*    move cur-mep-due (i0 1)     to mep-itd-lf
  4692*    move cur-mep-due (i0 2)     to mep-itd-ah
  4693     compute mep-itd-tot =
  4694        cur-mep-due (i0 1) + cur-mep-due (i0 2)
  4695     MOVE ' '                    TO X
  4696     MOVE mep-detail-line        TO P-DATA
  4697     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4698
  4699     .
  4700 4400-bypass-prior.
  4701
  4702     move 'Incurred Loss Ratio           '
  4703                                 to ilr-desc
  4704
  4705     compute ws-work-loss-ratio rounded =
  4706        ((cur-clm-resv (i0 1) - lme-clm-resv (i0 1))
  4707        + (cur-clm-pmts (i0 1) - lme-clm-pmts (i0 1)))
  4708        / (cur-earn-prem (i0 1) - lme-earn-prem (i0 1)) * +100
  4709     move ws-work-loss-ratio     to ilr-mtd-lf
  4710
  4711     compute ws-work-loss-ratio rounded =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS043SL.cbl
  4712        ((cur-clm-resv (i0 2) - lme-clm-resv (i0 2))
  4713        + (cur-clm-pmts (i0 2) - lme-clm-pmts (i0 2)))
  4714        / (cur-earn-prem (i0 2) - lme-earn-prem (i0 2)) * +100
  4715     move ws-work-loss-ratio     to ilr-mtd-ah
  4716
  4717     compute ws-work-loss-ratio rounded =
  4718        ((cur-clm-resv (i0 1) - lye-clm-resv (i0 1))
  4719        + (cur-clm-pmts (i0 1) - lye-clm-pmts (i0 1)))
  4720        / (cur-earn-prem (i0 1) - lye-earn-prem (i0 1)) * +100
  4721     move ws-work-loss-ratio     to ilr-ytd-lf
  4722
  4723     compute ws-work-loss-ratio rounded =
  4724        ((cur-clm-resv (i0 2) - lye-clm-resv (i0 2))
  4725        + (cur-clm-pmts (i0 2) - lye-clm-pmts (i0 2)))
  4726        / (cur-earn-prem (i0 2) - lye-earn-prem (i0 2)) * +100
  4727     move ws-work-loss-ratio     to ilr-ytd-ah
  4728
  4729     compute ws-work-loss-ratio rounded =
  4730        (cur-clm-resv (i0 1) + cur-clm-pmts (i0 1)) /
  4731           cur-earn-prem (i0 1) * +100
  4732     move ws-work-loss-ratio     to ilr-itd-lf
  4733
  4734     compute ws-work-loss-ratio rounded =
  4735        (cur-clm-resv (i0 2) + cur-clm-pmts (i0 2)) /
  4736           cur-earn-prem (i0 2) * +100
  4737     move ws-work-loss-ratio     to ilr-itd-ah
  4738
  4739     compute ws-work-loss-ratio rounded =
  4740        (cur-clm-resv (i0 1) + cur-clm-resv (i0 2) +
  4741        cur-clm-pmts (i0 1) + cur-clm-pmts (i0 2)) /
  4742        (cur-earn-prem (i0 1) + cur-earn-prem (i0 2)) *  +100
  4743     move ws-work-loss-ratio     to ilr-itd-tot
  4744
  4745     MOVE '0'                    TO X
  4746     MOVE spaces                 TO P-DATA
  4747     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4748
  4749     MOVE '0'                    TO X
  4750     MOVE ilr-detail-line        TO P-DATA
  4751     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4752
  4753*    move '      Beginning UEP           '
  4754*                                to det-desc
  4755*    compute det-mtd-lf = lme-uep (i0 1)
  4756*    compute det-mtd-ah = lme-uep (i0 2)
  4757*    compute det-ytd-lf = lye-uep (i0 1)
  4758*    compute det-ytd-ah = lye-uep (i0 2)
  4759*    move +0                     to det-itd-lf
  4760*                                   det-itd-ah
  4761*    MOVE '0'                    TO X
  4762*    MOVE detail-line            TO P-DATA
  4763*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4764*
  4765*    move '         Ending UEP           '
  4766*                                to det-desc
  4767*    move cur-uep (i0 1)         to det-mtd-lf
  4768*                                   det-ytd-lf
  4769*                                   det-itd-lf
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS043SL.cbl
  4770*    move cur-uep (i0 2)         to det-mtd-ah
  4771*                                   det-ytd-ah
  4772*                                   det-itd-ah
  4773*    MOVE ' '                    TO X
  4774*    MOVE detail-line            TO P-DATA
  4775*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4776
  4777     .
  4778 4400-continue.
  4779
  4780     move sw-acct-key            to ws-prev-acct-key
  4781
  4782     .
  4783 4400-exit.
  4784     exit.
  4785
  4786 4500-accum-levels.
  4787
  4788     perform varying i1 from +1 by +1 until i1 > +2
  4789
  4790        compute cur-gross-prem (o9 i1) =
  4791           cur-gross-prem (o9 i1) + cur-gross-prem (i9 i1)
  4792        compute cur-cancel-prem (o9 i1) =
  4793           cur-cancel-prem (o9 i1) + cur-cancel-prem (i9 i1)
  4794        compute cur-net-prem (o9 i1) =
  4795           cur-net-prem (o9 i1) + cur-net-prem (i9 i1)
  4796        compute cur-uep (o9 i1) =
  4797           cur-uep (o9 i1) + cur-uep (i9 i1)
  4798        compute cur-earn-prem (o9 i1) =
  4799           cur-earn-prem (o9 i1) + cur-earn-prem (i9 i1)
  4800        compute cur-inv-income (o9 i1) =
  4801           cur-inv-income (o9 i1) + cur-inv-income (i9 i1)
  4802        compute cur-tot-income (o9 i1) =
  4803           cur-tot-income (o9 i1) + cur-tot-income (i9 i1)
  4804        compute cur-acct-comms (o9 i1) =
  4805           cur-acct-comms (o9 i1) + cur-acct-comms (i9 i1)
  4806        compute cur-ow-comms (o9 i1) =
  4807           cur-ow-comms (o9 i1) + cur-ow-comms (i9 i1)
  4808        compute cur-ret-fees (o9 i1) =
  4809           cur-ret-fees (o9 i1) + cur-ret-fees (i9 i1)
  4810        compute cur-clm-pmts (o9 i1) =
  4811           cur-clm-pmts (o9 i1) + cur-clm-pmts (i9 i1)
  4812        compute cur-prem-tax (o9 i1) =
  4813           cur-prem-tax (o9 i1) + cur-prem-tax (i9 i1)
  4814        compute cur-other-expenses (o9 i1) =
  4815           cur-other-expenses (o9 i1) + cur-other-expenses (i9 i1)
  4816        compute cur-tot-expenses (o9 i1) =
  4817           cur-tot-expenses (o9 i1) + cur-tot-expenses (i9 i1)
  4818        compute cur-net-cash-flow (o9 i1) =
  4819           cur-net-cash-flow (o9 i1) + cur-net-cash-flow (i9 i1)
  4820        compute cur-mort-resv (o9 i1) =
  4821           cur-mort-resv (o9 i1) + cur-mort-resv (i9 i1)
  4822        compute cur-clm-resv (o9 i1) =
  4823           cur-clm-resv (o9 i1) + cur-clm-resv (i9 i1)
  4824        compute cur-net-mep-comm (o9 i1) =
  4825           cur-net-mep-comm (o9 i1) + cur-net-mep-comm (i9 i1)
  4826        compute cur-retro-pmts (o9 i1) =
  4827           cur-retro-pmts (o9 i1) + cur-retro-pmts (i9 i1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS043SL.cbl
  4828        compute cur-mep-due (o9 i1) =
  4829           cur-mep-due (o9 i1) + cur-mep-due (i9 i1)
  4830
  4831        compute lme-gross-prem (o9 i1) =
  4832           lme-gross-prem (o9 i1) + lme-gross-prem (i9 i1)
  4833        compute lme-cancel-prem (o9 i1) =
  4834           lme-cancel-prem (o9 i1) + lme-cancel-prem (i9 i1)
  4835        compute lme-net-prem (o9 i1) =
  4836           lme-net-prem (o9 i1) + lme-net-prem (i9 i1)
  4837        compute lme-uep (o9 i1) =
  4838           lme-uep (o9 i1) + lme-uep (i9 i1)
  4839        compute lme-earn-prem (o9 i1) =
  4840           lme-earn-prem (o9 i1) + lme-earn-prem (i9 i1)
  4841        compute lme-inv-income (o9 i1) =
  4842           lme-inv-income (o9 i1) + lme-inv-income (i9 i1)
  4843        compute lme-tot-income (o9 i1) =
  4844           lme-tot-income (o9 i1) + lme-tot-income (i9 i1)
  4845        compute lme-acct-comms (o9 i1) =
  4846           lme-acct-comms (o9 i1) + lme-acct-comms (i9 i1)
  4847        compute lme-ow-comms (o9 i1) =
  4848           lme-ow-comms (o9 i1) + lme-ow-comms (i9 i1)
  4849        compute lme-ret-fees (o9 i1) =
  4850           lme-ret-fees (o9 i1) + lme-ret-fees (i9 i1)
  4851        compute lme-clm-pmts (o9 i1) =
  4852           lme-clm-pmts (o9 i1) + lme-clm-pmts (i9 i1)
  4853        compute lme-prem-tax (o9 i1) =
  4854           lme-prem-tax (o9 i1) + lme-prem-tax (i9 i1)
  4855        compute lme-other-expenses (o9 i1) =
  4856           lme-other-expenses (o9 i1) + lme-other-expenses (i9 i1)
  4857        compute lme-tot-expenses (o9 i1) =
  4858           lme-tot-expenses (o9 i1) + lme-tot-expenses (i9 i1)
  4859        compute lme-net-cash-flow (o9 i1) =
  4860           lme-net-cash-flow (o9 i1) + lme-net-cash-flow (i9 i1)
  4861        compute lme-mort-resv (o9 i1) =
  4862           lme-mort-resv (o9 i1) + lme-mort-resv (i9 i1)
  4863        compute lme-clm-resv (o9 i1) =
  4864           lme-clm-resv (o9 i1) + lme-clm-resv (i9 i1)
  4865        compute lme-net-mep-comm (o9 i1) =
  4866           lme-net-mep-comm (o9 i1) + lme-net-mep-comm (i9 i1)
  4867        compute lme-retro-pmts (o9 i1) =
  4868           lme-retro-pmts (o9 i1) + lme-retro-pmts (i9 i1)
  4869        compute lme-mep-due (o9 i1) =
  4870           lme-mep-due (o9 i1) + lme-mep-due (i9 i1)
  4871
  4872        compute lye-gross-prem (o9 i1) =
  4873           lye-gross-prem (o9 i1) + lye-gross-prem (i9 i1)
  4874        compute lye-cancel-prem (o9 i1) =
  4875           lye-cancel-prem (o9 i1) + lye-cancel-prem (i9 i1)
  4876        compute lye-net-prem (o9 i1) =
  4877           lye-net-prem (o9 i1) + lye-net-prem (i9 i1)
  4878        compute lye-uep (o9 i1) =
  4879           lye-uep (o9 i1) + lye-uep (i9 i1)
  4880        compute lye-earn-prem (o9 i1) =
  4881           lye-earn-prem (o9 i1) + lye-earn-prem (i9 i1)
  4882        compute lye-inv-income (o9 i1) =
  4883           lye-inv-income (o9 i1) + lye-inv-income (i9 i1)
  4884        compute lye-tot-income (o9 i1) =
  4885           lye-tot-income (o9 i1) + lye-tot-income (i9 i1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS043SL.cbl
  4886        compute lye-acct-comms (o9 i1) =
  4887           lye-acct-comms (o9 i1) + lye-acct-comms (i9 i1)
  4888        compute lye-ow-comms (o9 i1) =
  4889           lye-ow-comms (o9 i1) + lye-ow-comms (i9 i1)
  4890        compute lye-ret-fees (o9 i1) =
  4891           lye-ret-fees (o9 i1) + lye-ret-fees (i9 i1)
  4892        compute lye-clm-pmts (o9 i1) =
  4893           lye-clm-pmts (o9 i1) + lye-clm-pmts (i9 i1)
  4894        compute lye-prem-tax (o9 i1) =
  4895           lye-prem-tax (o9 i1) + lye-prem-tax (i9 i1)
  4896        compute lye-other-expenses (o9 i1) =
  4897           lye-other-expenses (o9 i1) + lye-other-expenses (i9 i1)
  4898        compute lye-tot-expenses (o9 i1) =
  4899           lye-tot-expenses (o9 i1) + lye-tot-expenses (i9 i1)
  4900        compute lye-net-cash-flow (o9 i1) =
  4901           lye-net-cash-flow (o9 i1) + lye-net-cash-flow (i9 i1)
  4902        compute lye-mort-resv (o9 i1) =
  4903           lye-mort-resv (o9 i1) + lye-mort-resv (i9 i1)
  4904        compute lye-clm-resv (o9 i1) =
  4905           lye-clm-resv (o9 i1) + lye-clm-resv (i9 i1)
  4906        compute lye-net-mep-comm (o9 i1) =
  4907           lye-net-mep-comm (o9 i1) + lye-net-mep-comm (i9 i1)
  4908        compute lye-retro-pmts (o9 i1) =
  4909           lye-retro-pmts (o9 i1) + lye-retro-pmts (i9 i1)
  4910        compute lye-mep-due (o9 i1) =
  4911           lye-mep-due (o9 i1) + lye-mep-due (i9 i1)
  4912     end-perform
  4913
  4914     .
  4915 4500-exit.
  4916     exit.
  4917
  4918 0590-HEADING-ROUTINE.
  4919
  4920     MOVE '1'                    TO X
  4921     MOVE HEAD-1                 TO P-DATA
  4922     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4923
  4924     MOVE ' '                    TO X
  4925     MOVE HEAD-2                 TO P-DATA
  4926     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4927
  4928     ADD +1                      TO PAGE-CNT
  4929     MOVE PAGE-CNT               TO H3-PAGE
  4930     MOVE HEAD-3                 TO P-DATA
  4931     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4932
  4933     MOVE '0'                    TO X
  4934     MOVE HEAD-4                 TO P-DATA
  4935     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4936
  4937     MOVE ' '                    TO X
  4938     MOVE HEAD-5                 TO P-DATA
  4939     PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4940
  4941     move '-'                    to x
  4942     move spaces                 to p-data
  4943     perform 0610-prt-rtn        thru 0610-exit
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS043SL.cbl
  4944
  4945     move '-'                    to x
  4946     move spaces                 to p-data
  4947     perform 0610-prt-rtn        thru 0610-exit
  4948
  4949     move '-'                    to x
  4950     move spaces                 to p-data
  4951     perform 0610-prt-rtn        thru 0610-exit
  4952
  4953*    MOVE ' '                    TO X
  4954*    MOVE HEAD-6                 TO P-DATA
  4955*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4956
  4957*    MOVE ' '                    TO X
  4958*    MOVE HEAD-7                 TO P-DATA
  4959*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4960
  4961*    MOVE ' '                    TO X
  4962*    MOVE HEAD-8                 TO P-DATA
  4963*    PERFORM 0610-PRT-RTN        THRU 0610-EXIT
  4964
  4965     .
  4966 0590-EXIT.
  4967     EXIT.
  4968
  4969 0610-PRT-RTN.
  4970
* 4971                                 COPY ELCPRT2.
  4972******************************************************************04/15/98
  4973*                                                                *ELCPRT2
  4974*                                                                *ELCPRT2
  4975*                            ELCPRT2                             *   LV005
  4976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  4977*                            VMOD=2.002                          *   CL**5
  4978*                                                                *   CL**4
  4979******************************************************************   CL**4
  4980                                                                     CL**4
  4981     IF DTE-FICH NOT = SPACE AND                                     CL**4
  4982        FICH-OPEN    = SPACE                                         CL**4
  4983         MOVE 'X'                TO  FICH-OPEN                       CL**4
  4984         OPEN OUTPUT FICH.                                           CL**4
  4985                                                                     CL**4
  4986     IF DTE-FICH NOT = SPACE                                         CL**4
  4987         MOVE X                  TO  P-CTL                           CL**4
  4988         WRITE FICH-REC FROM PRT.                                    CL**4
  4989                                                                     CL**4
  4990     IF DTE-FICH = SPACE OR '2'                                      CL**4
  4991       MOVE X                    TO  P-CTL                           CL**4
  4992       IF P-CTL = ' '                                                CL**4
  4993         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  4994       ELSE                                                          CL**4
  4995         IF P-CTL = '0'                                              CL**4
  4996           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  4997         ELSE                                                        CL**4
  4998           IF P-CTL = '-'                                            CL**4
  4999             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  5000           ELSE                                                      CL**4
  5001             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS043SL.cbl
  5002                                                                     CL**4
  5003******************************************************************   CL**4
  5004     .
  5005 0610-EXIT.
  5006     EXIT.
  5007
  5008 1000-connect.
  5009
  5010*    move 'NTSQLTST2_CSO_Retro'  to svr
  5011*    move 'sa'                   to usr
  5012*    move 'sql2008r2'            to pass
  5013
  5014     move 'NTCSO2_CSO_Retro'     to svr
  5015     move 'sa'                   to usr
  5016     move 'ntcso2'               to pass
  5017
  5018     display 'Begin connect to DB '
  5019     string
  5020         usr delimited space
  5021         "." delimited size
  5022         pass delimited space into usr-pass
  5023     end-string
  5024
  5025     display ' svr usr pass ' svr ' ' usr-pass
  5026
  5027     EXEC SQL
  5028        CONNECT TO :svr USER :usr-pass
  5029     END-EXEC
  5030
  5031     if sqlcode not = 0
  5032        display "Error: cannot connect "
  5033        display sqlcode
  5034        display sqlerrmc
  5035        perform abend-pgm
  5036     end-if
  5037
  5038     display " connect to DB successful "
  5039
  5040     .
  5041 1000-exit.
  5042     exit.
  5043
  5044 1010-declare-cursor.
  5045
  5046     display ' declare cursor '
  5047
  5048     EXEC SQL
  5049        declare retrostatus cursor for
  5050        select distinct PoolCode, Status, ReportCode3, RetroName,
  5051           EffectiveDate, NextReportMonth
  5052         from Retro
  5053           where Status = 3 or Status = 4 or Status = 5
  5054              or Status = 10 order by PoolCode
  5055     END-EXEC
  5056
  5057     if sqlcode not = 0
  5058        display "Error: cannot declare cursor "
  5059        display ' sql retrun code ' sqlcode
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS043SL.cbl
  5060        display ' sql err mess    ' sqlerrmc
  5061        perform 1050-disconnect  thru 1050-exit
  5062        perform abend-pgm
  5063     end-if
  5064
  5065     .
  5066 1010-exit.
  5067     exit.
  5068
  5069 1020-open-cursor.
  5070
  5071     display ' open cursor '
  5072
  5073     EXEC SQL
  5074        open retrostatus
  5075     END-EXEC
  5076
  5077     if sqlcode not = 0
  5078        display "Error: cannot open cursor "
  5079        display ' sql retrun code ' sqlcode
  5080        display ' sql err mess    ' sqlerrmc
  5081        perform 1050-disconnect  thru 1050-exit
  5082        perform abend-pgm
  5083     end-if
  5084
  5085     .
  5086 1020-exit.
  5087     exit.
  5088
  5089 1030-process-input.
  5090
  5091     move high-values            to ws-retro-group-table
  5092     move +0                     to i1
  5093     perform until sqlcode not = 0
  5094        EXEC SQL
  5095           fetch retrostatus into :tb-Retro-Group,
  5096                                  :tb-Retro-Status,
  5097                                  :tb-report-code-3,
  5098                                  :tb-retro-name,
  5099                                  :tb-retro-eff-dte,
  5100                                  :tb-retro-next-rpt-mo
  5101        END-EXEC
  5102        if sqlcode not = 0 and 100
  5103           display "Error: cannot fetch row "
  5104           display ' sql retrun code ' sqlcode
  5105           display ' sql err mess    ' sqlerrmc
  5106           perform 1050-disconnect thru 1050-exit
  5107           perform abend-pgm
  5108        end-if
  5109        if sqlcode = 0
  5110           add +1                to i1
  5111           move tb-retro-group   to ws-retro-group (i1)
  5112           move tb-retro-status  to ws-status (i1)
  5113           move tb-report-code-3 to ws-report-code-3 (i1)
  5114           move tb-retro-name    to ws-retro-name (i1)
  5115           move tb-retro-next-rpt-mo
  5116                                 to ws-retro-next-rpt-mo (i1)
  5117           display ' retro eff date ' tb-retro-eff-dte
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS043SL.cbl
  5118           string tb-retro-eff-dte (6:2) '/'
  5119                  tb-retro-eff-dte (9:2) '/'
  5120                  tb-retro-eff-dte (1:4) delimited by size
  5121                  into ws-retro-eff-dte (i1)
  5122           end-string
  5123           add 1                 to ws-recs-in
  5124        end-if
  5125     end-perform
  5126
  5127     if sqlcode = 100
  5128        display ' Normal end of record set '
  5129        display ' number of records        ' ws-recs-in
  5130     end-if
  5131
  5132     .
  5133 1030-exit.
  5134     exit.
  5135
  5136 1050-disconnect.
  5137
  5138     display ' Begin Disconnect '
  5139     EXEC SQL
  5140        disconnect
  5141     END-EXEC
  5142     if sqlcode not = 0
  5143        display "Error: disconnect "
  5144        display ' sql return code ' sqlcode
  5145        display ' sql err mess    ' sqlerrmc
  5146        perform abend-pgm
  5147     end-if
  5148
  5149     .
  5150 1050-exit.
  5151     exit.
  5152
  5153 5000-close-files.
  5154
  5155     close   eracct ERPLAN-IN EPEC-FILE PRNTR index-file
  5156
  5157     .
  5158 5000-exit.
  5159     exit.
  5160
  5161 8500-date-convert.
  5162
  5163     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  5164
  5165 8500-exit.
  5166     EXIT.
  5167
  5168 ABEND-PGM SECTION.
* 5169                             COPY ELCABEND.
  5170***************************************************************** 04/14/98
  5171*                                                               * ELCABEND
  5172*                            ELCABEND.                          *    LV003
  5173*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5174*                            VMOD 2.002                              CL**2
  5175*                                                               * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS043SL.cbl (/apps/prod/cid1p/copy/ELCABEND)
  5176*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  5177*            AND THEN ABENDS.                                   * ELCABEND
  5178*                                                               * ELCABEND
  5179*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  5180*                                                               * ELCABEND
  5181***************************************************************** ELCABEND
  5182*APS-010.                                                         ELCABEND
  5183     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  5184     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  5185                                                                  ELCABEND
  5186     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  5187         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5188         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5189                                 UPON CONSOLE.                    ELCABEND
  5190                                                                  ELCABEND
  5191     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  5192         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5193         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5194                                 UPON CONSOLE.                    ELCABEND
  5195                                                                  ELCABEND
  5196     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5197     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5198                                 UPON CONSOLE.                    ELCABEND
  5199                                                                  ELCABEND
  5200     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  5201     CALL 'ABORTME'.
  5202                                                                  ELCABEND
  5203 APS-EXIT.                                                        ELCABEND
  5204     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      181852     Code:       32324
