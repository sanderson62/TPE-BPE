* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ECS036.cbl
* Options: int("ECS036.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS036.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS036.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS036.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS036.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/28/95 11:10:55.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.014.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ECS036.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANSE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 120602    2002120500014  SMVA  MODIFY COPYBOOK MODULE PRTN036
    22* 012703                   SMVA  DATA SHOWING IN ECS036D RPT FROM
    23*                                PREVIOUS PASSES - CLEAR HD-6
    24* 112503                   SMVA  FIX PASS 4 INITIAL MISSING HEADER
    25* 012704    2004011500004  SMVA  REMOVE RMRO,UMB, & MFG FROM SYS050
    26*                                AND REMOVE ALL SYS051 PRINT
    27* 050504    2004042100005  SMVA  DROP CENTS FROM A&H BEN AMT FLD
    28* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
    29* 122804    2004101500005  PEMA  ADD ITD AND PYTD AND PL12
    30* 010306    2006010300002  PEMA  CORRECT PROBLEM WITH PYTD TOTALS
    31* 072709  CR2009042000001  AJRA  ADD PASS 6 FOR USER SELECT 2
    32* 082609  CR2009030400001  AJRA  ADD L12,YTD AND PYTD GRAND TOTALS
    33* 031511  CR2009082100002  AJRA  ADD PASS 7 FOR USER SELECT 5
    34******************************************************************
    35*REMARKS.
    36*        PRINTS MONTHLY PRODUCTION REPORTS FOR LAST 12 MONTHS -
    37*
    38*  PASS 1 - STATE OVERALL................................ECS036A
    39*  PASS 2 - CARRIER/COMPANY WITHIN BUSINESS TYPE.........ECS036B
    40*  PASS 3 - CARRIER/COMPANY WITHIN AGENCY................ECS036C
    41*  PASS 4 - REPORT CODE 1 OVERALL........................ECS036D
    42*  PASS 5 - REPORT CODE 2 WITHIN CARRIER & GROUPING......ECS036E
    43*                 (STATE BREAKS)
    44*  PASS 6 - USER SELECT 2 ...............................ECS036F
    45*  PASS 7 - USER SELECT 5/REPORT CODE 1 .................ECS036G
    46*
    47*     -- FORMAT OPTIONS --
    48*        1 = PRINT ALL ECS035 REPORTS
    49*        2 = PRINT ECS036A ONLY - STATE OVERALL
    50*        3 = PRINT ECS036B ONLY - CARR/CO WITHIN BUS TYPE
    51*        4 = PRINT ECS036C ONLY - CARR/CO WITHIN AGENCY
    52*        5 = PRINT ECS036D ONLY - REPORT CODE 1 OVERALL
    53*        6 = PRINT ECS036E ONLY - REPORT CODE 2 WITHIN CARR
    54*
    55*     -- REPORT CODE TOTAL OPTIONS --
    56*        1 = NO REPORT CODING
    57*        2 = REPORT CODE 1 ONLY
    58*        3 = REPORT CODE 2 ONLY
    59*        4 = BOTH REPORT CODES
    60*        5 = REPORT CODE 1 ONLY (DETAIL)
    61*        6 = REPORT CODE 2 ONLY (DETAIL)
    62*        7 = BOTH REPORT CODES  (DETAIL)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ECS036.cbl
    64 ENVIRONMENT DIVISION.
    65 CONFIGURATION SECTION.
    66
    67 INPUT-OUTPUT SECTION.
    68 FILE-CONTROL.
    69
    70     SELECT SORT-FILE    ASSIGN TO SYS001.
    71     SELECT EARNED-PREM  ASSIGN TO SYS012-UT-FBA1-S-SYS012.
    72     SELECT PRNT         ASSIGN TO SYS008-UR-1403-S-SYS008.
    73     SELECT DISK-DATE    ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    74     SELECT FICH         ASSIGN TO SYS020-UT-2400-S-SYS020.
    75     SELECT SELECT-FILE  ASSIGN TO SYS050-UT-1403-S-SYS050.
    76
    77 DATA DIVISION.
    78 FILE SECTION.
    79
    80 FD  SELECT-FILE
    81     RECORDING MODE F.
    82
    83 01  SELECT-RECORD.
    84     05  SELECT-CC               PIC X.
    85     05  SLCT-FLD-1              PIC X(11).
    86     05  SLCT-FLD-2              PIC X(10).
    87     05  SLCT-REC                PIC X(111).
    88
    89*
    90 SD  SORT-FILE.
    91
    92 01  SORT-FILE-REC.
    93     05 SORT-CONTROL-74          PIC X(40).
    94     05  SORT-DATE               PIC X(04).
    95     05  FILLER                  PIC X(98).
    96     05  SORT-AM-EXPIRE          PIC X(06).
    97     05  SORT-AM-HI-CERT         PIC X(06).
    98     05  SORT-HI-CERT            PIC X(06).
    99     05  FILLER                  PIC X(36).
   100
   101 FD  EARNED-PREM
   102     BLOCK CONTAINS 0 RECORDS
   103     RECORDING MODE F.
   104
   105 01  EP-EXTR                     PIC X(196).
   106*01  EP-EXTR                     PIC X(166).
   107
   108 FD  PRNT
*  109     COPY ELCPRTFD.
   110******************************************************************04/15/98
   111*                                                                *ELCPRTFD
   112*                                                                *ELCPRTFD
   113*                            ELCPRTFD.                           *   LV003
   114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   115*                            VMOD=2.006                          *ELCPRTFD
   116******************************************************************ELCPRTFD
   117     RECORDING MODE F                                             ELCPRTFD
   118     LABEL RECORDS OMITTED                                        ELCPRTFD
   119     BLOCK CONTAINS 0 RECORDS
   120     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   121 01  PRT.                                                         ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ECS036.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
   122     12  P-CTL               PIC  X.                                 CL**2
   123     12  P-DATA              PIC  X(132).                         ELCPRTFD
   124******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ECS036.cbl
   126 FD  DISK-DATE
*  127     COPY ELCDTEFD.
   128******************************************************************04/15/98
   129*                                                                *ELCDTEFD
   130*                                                                *ELCDTEFD
   131*                            ELCDTEFD.                           *   LV002
   132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   133*                            VMOD=2.007                          *   CL**2
   134*                                                                *ELCDTEFD
   135******************************************************************ELCDTEFD
   136     BLOCK CONTAINS 0 RECORDS
   137     RECORDING MODE F.                                            ELCDTEFD
   138                                                                  ELCDTEFD
   139 01  DATE-DISK.                                                   ELCDTEFD
   140     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   141     12  FILLER                      PIC  X(14).                  ELCDTEFD
   142     12  DD-CR1                      PIC  9.                      ELCDTEFD
   143     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   144     12  DD-CR2                      PIC  9.                      ELCDTEFD
   145     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   146     12  FILLER                      PIC  X(20).                  ELCDTEFD
   147                                                                  ELCDTEFD
   148 01  DATE-DISK-R.                                                 ELCDTEFD
   149     12  FILLER                      PIC  X(4).                   ELCDTEFD
   150     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   151                                     PIC  X(32).                  ELCDTEFD
   152                                                                  ELCDTEFD
   153 01  DATE-DISK-T.                                                 ELCDTEFD
   154     12  FILLER                      PIC  X(4).                   ELCDTEFD
   155     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   156                                     PIC  X(48).                  ELCDTEFD
   157                                                                  ELCDTEFD
   158 01  DATE-DISK-M.                                                 ELCDTEFD
   159     12  FILLER                      PIC  X(4).                   ELCDTEFD
   160     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   161                                     PIC  X(48).                  ELCDTEFD
   162                                                                  ELCDTEFD
   163 01  DATE-DISK-P.                                                 ELCDTEFD
   164     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   165     12  DD-IDX                      PIC  99.                     ELCDTEFD
   166     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   167     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   168         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   169                                     PIC  X.                      ELCDTEFD
   170         16  FILLER                  PIC  X(46).                  ELCDTEFD
   171     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   172         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   173             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   174             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   175             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   176             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   177         16  FILLER                  PIC  X(16).                  ELCDTEFD
   178                                                                  ELCDTEFD
   179 01  DATE-DISK-E.                                                 ELCDTEFD
   180     12  FILLER                      PIC  X(4).                   ELCDTEFD
   181     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   182                                     PIC  X(4).                   ELCDTEFD
   183                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   184 01  DATE-DISK-C.                                                 ELCDTEFD
   185     12  FILLER                      PIC  X(7).                   ELCDTEFD
   186     12  DD-CARR1-SECPAY-SW          PIC  X.
   187     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   188     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   189     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   190     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   191     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   192     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   193     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   194     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   195     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   196     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   197     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   198     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   199     12  DD-CARR2-SECPAY-SW          PIC  X.
   200     12  FILLER                      PIC  X(7).                   ELCDTEFD
   201                                                                  ELCDTEFD
   202 01  DATE-DISK-OPT.                                               ELCDTEFD
   203     12  FILLER                      PIC  X(04).                  ELCDTEFD
   204     12  DD-TLR-DATA.                                             ELCDTEFD
   205         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   206                                     PIC  X(03).                  ELCDTEFD
   207     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   208         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   209                                     PIC  X(06).                  ELCDTEFD
   210     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   211         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   212                                     PIC  X(07).                  ELCDTEFD
   213         16  FILLER                  PIC  X(05).                  ELCDTEFD
   214     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   215                                     PIC  X(96).                  ELCDTEFD
   216******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ECS036.cbl
   218 FD  FICH
*  219     COPY ELCFCHFD.
   220******************************************************************04/15/98
   221*                                                                *ELCFCHFD
   222*                            ELCFCHFD.                           *   LV003
   223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   224*                            VMOD=2.004                          *   CL**3
   225*                                                                *ELCFCHFD
   226******************************************************************ELCFCHFD
   227     BLOCK CONTAINS 0 RECORDS
   228     RECORDING MODE F.                                            ELCFCHFD
   229                                                                  ELCFCHFD
   230 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   231******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ECS036.cbl
   233 WORKING-STORAGE SECTION.
   234 77  FILLER  PIC X(32) VALUE '********************************'.
   235 77  FILLER  PIC X(32) VALUE '     ECS036 WORKING STORAGE     '.
   236 77  FILLER  PIC X(32) VALUE '******* VMOD=2.014 *************'.
   237
   238 77  SAVE-NAME                   PIC X(07)           VALUE SPACE.
   239 77  PRINT-SELECT-SW             PIC X(03)           VALUE 'NO '.
   240 77  CC-SW                       PIC X               VALUE SPACE.
   241 77  STATE-TOTAL-LINE            PIC X(30)           VALUE SPACE.
   242 77  SAVE-STATE                  PIC XX              VALUE SPACE.
   243 77  SKIP-HD-SW                  PIC X               VALUE SPACE.
   244 77  PASS-NUMBER                 PIC X               VALUE '1'.
   245 77  FIRST-TIME-SWITCH           PIC X               VALUE 'Y'.
   246     88  FIRST-TIME                                  VALUE 'Y'.
   247 77  LINE-CNT                    PIC S999  COMP-3    VALUE ZEROS.
   248 77  PAGE-CNT                    PIC S9(5) COMP-3    VALUE ZEROS.
   249 77  PGM-SUB                     PIC S999  COMP      VALUE +036.
   250 77  X                           PIC X.
   251 77  X1                          PIC S999  COMP      VALUE ZERO.
   252 77  DISP-X1                     PIC 999             VALUE ZEROS.
   253 77  Y1                          PIC S999  COMP      VALUE ZERO.
   254 77  EOF-EPX                     PIC X               VALUE SPACE.
   255 77  WRITE-AC-SW                 PIC X               VALUE SPACE.
   256 77  ST-SUB                      PIC 99              VALUE ZEROS.
   257 77  DT-SUB                      PIC S99   COMP      VALUE ZEROS.
   258 77  WORK-BUSC                   PIC XX.
   259 77  SET-CTR                     PIC S999  COMP-3    VALUE ZERO.
   260
   261 01  QTR-SW                      PIC X               VALUE SPACE.
   262     88  QTR-END                                     VALUE '1'.
   263
   264 01  QTR-COMP                    PIC X               VALUE SPACE.
   265     88  QTR-CO                                      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ECS036.cbl
   267 01  WS-EXTR-REC.
   268     05  EP-PASS-NO              PIC X.
   269     05  EP-CNTL.
   270         10  EP-CNTL-1.
   271             15  EP-CNTL-GA      PIC X(10).
   272             15  EP-CNTL-ACCT    PIC X(10).
   273         10  EP-CNTL-2.
   274             15  EP-CARR         PIC X.
   275             15  EP-GROUP        PIC X(6).
   276         10  FILLER              PIC X(12).
   277     05  EP-ALT-RPT-CNTL  REDEFINES  EP-CNTL.
   278         10  EP-A-RPT-CD-1       PIC X(10).
   279         10  EP-A-CARR           PIC X.
   280         10  EP-A-GROUP          PIC X(6).
   281         10  EP-A-RPT-CD-2       PIC X(10).
   282         10  EP-A-STATE          PIC XX.
   283         10  EP-A-ACCT           PIC X(10).
   284     05  EP-DTE                  PIC 9(07)  COMP-3.
   285     05  EP-CNTRS    COMP-3.
   286         10  EP-CERT             PIC S9(11)V99.
   287         10  EP-LBEN             PIC S9(11)V99.
   288         10  EP-LPRM             PIC S9(11)V99.
   289         10  EP-LCLM             PIC S9(11)V99.
   290         10  EP-ABEN             PIC S9(11)V99.
   291         10  EP-APRM             PIC S9(11)V99.
   292         10  EP-ACLM             PIC S9(11)V99.
   293         10  EP-TPRM             PIC S9(11)V99.
   294         10  EP-TCOM             PIC S9(11)V99.
   295     05  FILLER                  PIC X(4).
   296     05  EP-ACCT-STATUS          PIC X.
   297     05  EP-ACCT-NAME            PIC X(30).
   298     05  EP-ACC-EXPIRES          PIC 9(11)  COMP-3.
   299     05  EP-ACC-HI-CERT          PIC 9(11)  COMP-3.
   300     05  EP-MTH-HI-CERT          PIC 9(11)  COMP-3.
   301     05  EP-ISS-CNT              PIC S9(9) COMP-3.
   302     05  FILLER                  PIC X.
   303     05  EP-ACCT-CITY            PIC X(30).
   304
   305 01  PRINT-SWITCHES.
   306     05  P-ACC-SW                PIC X VALUE ' '.
   307     05  P-ST-SW                 PIC X VALUE ' '.
   308     05  P-GP-SW                 PIC X VALUE ' '.
   309     05  P-CA-SW                 PIC X VALUE ' '.
   310     05  P-RP-SW                 PIC X VALUE ' '.
   311     05  P-RP2-SW                PIC X VALUE ' '.
   312
   313 01  RUN-DT.
   314     05  RUN-DT-CCYY             PIC 9(04) VALUE ZEROS.
   315     05  RUN-DT-CCYR REDEFINES RUN-DT-CCYY.
   316         10  RUN-DT-CC           PIC 99.
   317         10  RUN-DT-YR           PIC 99.
   318     05  RUN-DT-MO               PIC 99  VALUE ZEROS.
   319
   320 01  RUN9DT REDEFINES RUN-DT     PIC 9(6).
   321
   322 01  WORK-ACCUM.
   323     05  CERT                    PIC S9(11)    COMP-3 VALUE ZEROS.
   324     05  ISS                     PIC S9(9)     COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ECS036.cbl
   325     05  LBEN                    PIC S9(12)V99 COMP-3 VALUE ZEROS.
   326     05  LPRM                    PIC S9(11)V99 COMP-3 VALUE ZEROS.
   327     05  LCLM                    PIC S9(12)V99 COMP-3 VALUE ZEROS.
   328     05  ABEN                    PIC S9(12)V99 COMP-3 VALUE ZEROS.
   329     05  APRM                    PIC S9(11)V99 COMP-3 VALUE ZEROS.
   330     05  ACLM                    PIC S9(12)V99 COMP-3 VALUE ZEROS.
   331     05  TPRM                    PIC S9(11)V99 COMP-3 VALUE ZEROS.
   332     05  TCOM                    PIC S9(11)V99 COMP-3 VALUE ZEROS.
   333
   334 01  REPT-ACCUM.
   335     05  RPCERT                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   336     05  RPLBEN                  PIC S9(12)V99 COMP-3 VALUE ZEROS.
   337     05  RPLPRM                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   338     05  RPLCLM                  PIC S9(12)V99 COMP-3 VALUE ZEROS.
   339     05  RPABEN                  PIC S9(12)V99 COMP-3 VALUE ZEROS.
   340     05  RPAPRM                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   341     05  RPACLM                  PIC S9(12)V99 COMP-3 VALUE ZEROS.
   342     05  RPTPRM                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   343     05  RPTCOM                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   344
   345 01  REPT2-ACCUM.
   346     05  RP2CERT                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
   347     05  RP2LBEN                 PIC S9(12)V99 COMP-3 VALUE ZEROS.
   348     05  RP2LPRM                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
   349     05  RP2LCLM                 PIC S9(12)V99 COMP-3 VALUE ZEROS.
   350     05  RP2ABEN                 PIC S9(12)V99 COMP-3 VALUE ZEROS.
   351     05  RP2APRM                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
   352     05  RP2ACLM                 PIC S9(12)V99 COMP-3 VALUE ZEROS.
   353     05  RP2TPRM                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
   354     05  RP2TCOM                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ECS036.cbl
   356 01  HD-1-STATE.
   357     05  FILLER                  PIC X(46)   VALUE SPACES.
   358     05  HD-1-ST                 PIC X(10)   VALUE ' MONTHLY'.
   359     05  FILLER                  PIC X(6)    VALUE 'STATE '.
   360     05  FILLER                  PIC X(17)
   361                                 VALUE 'PRODUCTION REPORT'.
   362     05  FILLER                  PIC X(05)   VALUE SPACES.
   363     05  HD-1-ST-SINGLE-FEE      PIC X(21)   VALUE SPACES.
   364     05  FILLER                  PIC X(14)   VALUE SPACES.
   365     05  FILLER                  PIC X(7)    VALUE 'ECS036A'.
   366
   367 01  HD-1-BUSINESS.
   368     05  FILLER                  PIC X(44)   VALUE SPACES.
   369     05  HD-1-BUS                PIC X(10)   VALUE ' MONTHLY'.
   370     05  FILLER                  PIC X(9)    VALUE 'BUSINESS'.
   371     05  FILLER                  PIC X(17)
   372                                 VALUE 'PRODUCTION REPORT'.
   373     05  FILLER                  PIC X(05)   VALUE SPACES.
   374     05  HD-1-BUS-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   375     05  FILLER                  PIC X(13)   VALUE SPACES.
   376     05  FILLER                  PIC X(7)    VALUE 'ECS036B'.
   377
   378 01  HD-1-AGENCY.
   379     05  FILLER                  PIC X(45)   VALUE SPACES.
   380     05  HD-1-AGCY               PIC X(10)   VALUE ' MONTHLY'.
   381     05  FILLER                  PIC X(7)    VALUE 'AGENCY'.
   382     05  FILLER                  PIC X(17)
   383                                 VALUE 'PRODUCTION REPORT'.
   384     05  FILLER                  PIC X(05)   VALUE SPACES.
   385     05  HD-1-AGCY-SINGLE-FEE    PIC X(21)   VALUE SPACES.
   386     05  FILLER                  PIC X(14)   VALUE SPACES.
   387     05  FILLER                  PIC X(7)    VALUE 'ECS036C'.
   388
   389 01  HD-1-RPT-CODE-1.
   390     05  HD-1-SLCT-FLD-1         PIC X(11)   VALUE 'RPT CODE 1 '.
   391     05  HD-1-SLCT-FLD-2         PIC X(10)   VALUE SPACES.
   392     05  HD-1-SLCT-REC-POS1      PIC X(01)   VALUE SPACE.
   393     05  FILLER                  PIC X(22)   VALUE SPACES.
   394     05  HD-1-RC-1               PIC X(9)    VALUE ' MONTHLY'.
   395     05  HD-1-RPT-CD-1           PIC X(10)   VALUE SPACES.
   396     05  FILLER                  PIC X(18)
   397                                 VALUE ' PRODUCTION REPORT'.
   398     05  FILLER                  PIC X(05)   VALUE SPACES.
   399     05  HD-1-RC1-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   400     05  FILLER                  PIC X(12)   VALUE SPACES.
   401     05  FILLER                  PIC X(6)    VALUE 'ECS036'.
   402     05  HD-1-DF                 PIC X       VALUE 'D'.
   403
   404 01  HD-1-RPT-CODE-2.
   405     05  FILLER                  PIC X(44)   VALUE SPACES.
   406     05  HD-1-RC-2               PIC X(9)    VALUE ' MONTHLY'.
   407     05  HD-1-RPT-CD-2           PIC X(10)   VALUE SPACES.
   408     05  FILLER                  PIC X(18)
   409                                 VALUE ' PRODUCTION REPORT'.
   410     05  FILLER                  PIC X(05)   VALUE SPACES.
   411     05  HD-1-RC2-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   412     05  FILLER                  PIC X(12)   VALUE SPACES.
   413     05  FILLER                  PIC X(7)    VALUE 'ECS036E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ECS036.cbl
   414
   415 01  HD-1-CARRIER.
   416     05  FILLER                  PIC X(45)   VALUE SPACES.
   417     05  HD-1-CAR                PIC X(10)   VALUE ' MONTHLY'.
   418     05  FILLER                  PIC X(8)    VALUE 'CARRIER'.
   419     05  FILLER                  PIC X(17)
   420                                 VALUE 'PRODUCTION REPORT'.
   421     05  FILLER                  PIC X(05)   VALUE SPACES.
   422     05  HD-1-CAR-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   423     05  FILLER                  PIC X(13)   VALUE SPACES.
   424     05  FILLER                  PIC X(6)    VALUE 'ECS036'.
   425     05  HD-1-CAR-SUF            PIC X       VALUE ' '.
   426
   427 01  HD-1-GROUPING.
   428     05  FILLER                  PIC X(45)   VALUE SPACES.
   429     05  HD-1-GRP                PIC X(8)    VALUE 'MONTHLY'.
   430     05  FILLER                  PIC X(9)    VALUE 'GROUPING'.
   431     05  FILLER                  PIC X(17)
   432                                 VALUE 'PRODUCTION REPORT'.
   433     05  FILLER                  PIC X(05)   VALUE SPACES.
   434     05  HD-1-GRP-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   435     05  FILLER                  PIC X(14)   VALUE SPACES.
   436     05  FILLER                  PIC X(6)    VALUE 'ECS036'.
   437     05  HD-1-GRP-SUF            PIC X       VALUE ' '.
   438
   439 01  HD-1-USER-SEL-2.
   440     05  HD-1-US2-FLD-1          PIC X(11)   VALUE 'USER SEL 2 '.
   441     05  HD-1-US2-FLD-2          PIC X(10)   VALUE SPACES.
   442     05  HD-1-US2-REC-POS1       PIC X(01)   VALUE SPACE.
   443     05  FILLER                  PIC X(22)   VALUE SPACES.
   444     05  HD-1-US2                PIC X(9)    VALUE ' MONTHLY'.
   445     05  HD-1-USERSEL2           PIC X(10)   VALUE 'USER SEL 2'.
   446     05  FILLER                  PIC X(18)
   447                                 VALUE ' PRODUCTION REPORT'.
   448     05  FILLER                  PIC X(05)   VALUE SPACES.
   449     05  HD-1-US2-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   450     05  FILLER                  PIC X(12)   VALUE SPACES.
   451     05  FILLER                  PIC X(7)    VALUE 'ECS036F'.
   452
   453 01  HD-1-USER-SEL-5.
   454     05  HD-1-US5-FLD-1          PIC X(11)   VALUE 'USER SEL 5 '.
   455     05  HD-1-US5-FLD-2          PIC X(10)   VALUE SPACES.
   456     05  HD-1-US5-REC-POS1       PIC X(01)   VALUE SPACE.
   457     05  FILLER                  PIC X(22)   VALUE SPACES.
   458     05  HD-1-US5                PIC X(9)    VALUE ' MONTHLY'.
   459     05  HD-1-USERSEL5           PIC X(10)   VALUE 'USER SEL 5'.
   460     05  FILLER                  PIC X(18)
   461                                 VALUE ' PRODUCTION REPORT'.
   462     05  FILLER                  PIC X(05)   VALUE SPACES.
   463     05  HD-1-US5-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   464     05  FILLER                  PIC X(12)   VALUE SPACES.
   465     05  FILLER                  PIC X(7)    VALUE 'ECS036G'.
   466
   467 01  HD-1-GRAND-TOTALS.
   468     05  FILLER                  PIC X(47)   VALUE SPACES.
   469     05  FILLER                  PIC X(17)
   470                                 VALUE 'PRODUCTION REPORT'.
   471     05  FILLER                  PIC X(13)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ECS036.cbl
   472                                 VALUE ' GRAND TOTALS'.
   473     05  FILLER                  PIC X(05)   VALUE SPACES.
   474     05  HD-1-GT-SINGLE-FEE      PIC X(21)   VALUE SPACES.
   475     05  FILLER                  PIC X(16)   VALUE SPACES.
   476     05  FILLER                  PIC X(6)    VALUE 'ECS036'.
   477     05  HD-1-GT                 PIC X.
   478
   479 01  HD-2.
   480     05  HD-2-SLCT-FLD-1         PIC X(11)   VALUE SPACES.
   481     05  HD-2-SLCT-FLD-2         PIC X(10)   VALUE SPACES.
   482     05  HD-2-SLCT-REC-POS1      PIC X(01)   VALUE SPACE.
   483     05  FILLER                  PIC X(25)   VALUE SPACES.
   484     05  HD-COMPANY-NAME         PIC X(30)   VALUE SPACES.
   485     05  FILLER                  PIC X(42)   VALUE SPACES.
   486     05  HD-IPL-DATE             PIC X(8)    VALUE SPACES.
   487
   488 01  HD-3.
   489     05  HD-3-SLCT-FLD-1         PIC X(11)   VALUE SPACES.
   490     05  HD-3-SLCT-FLD-2         PIC X(10)   VALUE SPACES.
   491     05  HD-3-SLCT-REC-POS1      PIC X(01)   VALUE SPACE.
   492     05  FILLER                  PIC X(31)   VALUE SPACES.
   493     05  HD-ALPHA-DATE           PIC X(18)   VALUE SPACES.
   494     05  FILLER                  PIC X(48)   VALUE SPACES.
   495     05  FILLER                  PIC X(5)    VALUE 'PAGE '.
   496     05  HD-PAGE                 PIC ZZ,ZZ9.
   497
   498 01  HD-4.
   499     05  FILLER                  PIC X(8)    VALUE 'CARRIER'.
   500     05  HD-4-CARRIER            PIC X       VALUE SPACES.
   501     05  FILLER-HD-4             PIC X(10)   VALUE ' GROUPING'.
   502     05  HD-4-GROUPING           PIC X(6)    VALUE SPACES.
   503
   504 01  HD-4G.
   505     05  FILLER                  PIC X(10)   VALUE 'REPT CD 1'.
   506     05  HD-4G-REPT-CD-2         PIC X(10)   VALUE SPACES.
   507
   508 01  HD-5.
   509     05  FILLER                  PIC X(8)    VALUE 'ACCOUNT'.
   510     05  HD-ACCOUNT              PIC X(10)   VALUE SPACES.
   511     05  FILLER                  PIC XX      VALUE SPACES.
   512*    05  HD-ACCT-NAME            PIC X(20)   VALUE SPACES.
   513     05  HD-ACCT-NAME            PIC X(30)   VALUE SPACES.
   514     05  FILLER                  PIC X(6)    VALUE SPACES.
   515*    05  HD-ACCT-ADDRESS         PIC X(20)   VALUE SPACES.
   516     05  HD-ACCT-ADDRESS         PIC X(30)   VALUE SPACES.
   517
   518 01  HD-5A.
   519     05  FILLER                  PIC X(8)    VALUE 'CITY   '.
   520     05  FILLER                  PIC X(12)   VALUE SPACES.
   521     05  HD-5A-CITY              PIC X(30)   VALUE SPACES.
   522     05  FILLER                  PIC X(26)   VALUE SPACES.
   523
   524 01  HD-6.
   525     05  FILLER-HD-6.
   526       07  FILLER-HD-6-1         PIC X(6)    VALUE 'STATE'.
   527       07  FILLER-HD-6-2         PIC X(8)    VALUE SPACES.
   528     05  HD-6-NSTATE             PIC XX      VALUE SPACES.
   529     05  FILLER                  PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ECS036.cbl
   530     05  HD-STATE                PIC X(30)   VALUE SPACES.
   531     05  FILLER                  PIC X(92)   VALUE SPACES.
   532
   533 01  HD-7.
   534     05  FILLER-HD-7             PIC X(20)   VALUE SPACES.
   535     05  HD-7-DESC               PIC X(10)   VALUE SPACES.
   536     05  FILLER-HD-7A            PIC X(13)   VALUE SPACES.
   537     05  HD-CARRIER              PIC X       VALUE SPACES.
   538
   539 01  HD-8.
   540     05  FILLER                  PIC X(132)
   541                                 VALUE 'GRAND TOTALS'.
   542
   543 01  HD-8A.
   544     05  HD-8A-RPT-CD-1-CAPTION  PIC X(10)   VALUE SPACES.
   545     05  FILLER                  PIC X       VALUE SPACES.
   546     05  HD-8A-RPT-CODE-1        PIC X(10)   VALUE SPACES.
   547     05  FILLER                  PIC X(111)  VALUE SPACES.
   548
   549 01  HD-8B.
   550     05  HD-8B-RPT-CD-2-CAPTION  PIC X(10)   VALUE SPACES.
   551     05  FILLER                  PIC X       VALUE SPACES.
   552     05  HD-8B-RPT-CODE-2        PIC X(10)   VALUE SPACES.
   553     05  FILLER                  PIC X(111)  VALUE SPACES.
   554
   555 01  HD-8C.
   556     05  HD-8C-US2-CAPTION       PIC X(10)   VALUE 'USER SEL 2'.
   557     05  FILLER                  PIC X       VALUE SPACES.
   558     05  HD-8C-USER-SEL-2        PIC X(10)   VALUE SPACES.
   559     05  FILLER                  PIC X(111)  VALUE SPACES.
   560
   561 01  HD-8D.
   562     05  HD-8D-US5-CAPTION       PIC X(10)   VALUE 'USER SEL 5'.
   563     05  FILLER                  PIC X       VALUE SPACES.
   564     05  HD-8D-USER-SEL-5        PIC X(10)   VALUE SPACES.
   565     05  FILLER                  PIC X(111)  VALUE SPACES.
   566
   567 01  HD-9.
   568     05  HD-9-1          PIC X(20)   VALUE '               NET  '.
   569     05  FILLER          PIC X(5)    VALUE SPACES.
   570     05  HD-9-LF-OVRD-1  PIC X(6).
   571     05  FILLER          PIC X(8)    VALUE SPACES.
   572     05  HD-9-LF-OVRD-2  PIC X(6).
   573     05  FILLER          PIC X(9)    VALUE SPACES.
   574     05  HD-9-LF-OVRD-3  PIC X(6).
   575     05  FILLER          PIC X(8)    VALUE SPACES.
   576     05  HD-9-AH-OVRD-1  PIC X(6).
   577     05  FILLER          PIC X(8)    VALUE SPACES.
   578     05  HD-9-AH-OVRD-2  PIC X(6).
   579     05  FILLER          PIC X(9)    VALUE SPACES.
   580     05  HD-9-AH-OVRD-3  PIC X(6).
   581     05  FILLER          PIC X(9)    VALUE SPACES.
   582     05  FILLER          PIC X(20)   VALUE 'TOTAL        TOTAL  '.
   583
   584 01  HD-10.
   585     05  HD-10-1         PIC X(21)  VALUE '             ACTIVITY'.
   586     05  FILLER          PIC X(19)   VALUE '   BENEFITS       P'.
   587     05  FILLER          PIC X(20)   VALUE 'REMIUM        CLAIMS'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ECS036.cbl
   588     05  FILLER          PIC X(20)   VALUE '       BENEFITS     '.
   589     05  FILLER          PIC X(20)   VALUE '  PREMIUM        CLA'.
   590     05  FILLER          PIC X(20)   VALUE 'IMS        PREMIUM  '.
   591     05  FILLER          PIC X(12)   VALUE '  COMMISSION'.
   592
   593 01  HD-9-A.
   594     12  HD-9-A-1        PIC X(34)   VALUE
   595             '       HI-CERT    CERT        NET '.
   596     12  FILLER          PIC X(6)    VALUE SPACES.
   597     12  HD-9A-LF-OVRD-1 PIC X(6).
   598     12  FILLER          PIC X(8)    VALUE SPACES.
   599     12  HD-9A-LF-OVRD-2 PIC X(6).
   600     12  FILLER          PIC X(9)    VALUE SPACES.
   601     12  HD-9A-LF-OVRD-3 PIC X(6).
   602     12  FILLER          PIC X(7)    VALUE SPACES.
   603     12  HD-9A-AH-OVRD-1 PIC X(6).
   604     12  FILLER          PIC X(9)    VALUE SPACES.
   605     12  HD-9A-AH-OVRD-2 PIC X(6).
   606     12  FILLER          PIC X(29)   VALUE
   607             '        TOTAL         TOTAL  '.
   608
   609 01  HD-10-A.
   610     12  HD-10-A-1       PIC X(36)   VALUE
   611             '         DATE    COUNT      ACTIVITY'.
   612     12  FILLER          PIC X(8)   VALUE
   613             '   BENEF'.
   614     12  FILLER          PIC X(44)   VALUE
   615             'ITS       PREMIUM        CLAIMS       PREMIU'.
   616     12  FILLER          PIC X(44)   VALUE
   617             'M        CLAIMS        PREMIUM    COMMISSION'.
   618
   619 01  DETAIL-LINE.
   620     05  DET-TITLE.
   621         10  DET-DATE.
   622             15  DET-MO          PIC XXX     VALUE SPACES.
   623             15  FILLER          PIC X       VALUE SPACES.
   624             15  DET-YR          PIC XX      VALUE SPACES.
   625             15  FILLER          PIC X       VALUE SPACES.
   626         10  DET-CERTS           PIC ZZZ,ZZZ,Z99-.
   627     05  DET-LBEN                PIC ZZZZZ,ZZZ,Z99-.
   628     05  DET-LPRM                PIC ZZ,ZZZ,ZZ9.99-.
   629     05  DET-LCLM                PIC ZZ,ZZZ,ZZ9.99-.
   630     05  DET-ABEN                PIC ZZZZZZ,ZZZ,Z99-.
   631     05  DET-APRM                PIC ZZ,ZZZ,ZZ9.99-.
   632     05  DET-ACLM                PIC ZZ,ZZZ,ZZ9.99-.
   633     05  DET-TPRM                PIC ZZZ,ZZZ,ZZ9.99-.
   634     05  DET-TCOM                PIC ZZZZZ,ZZ9.99-.
   635
   636 01  DETAIL-LINE-2.
   637     12  DET-TITLE-2.
   638         16  DET-DATE-2.
   639             20  DET-MO-2        PIC XXX     VALUE SPACES.
   640             20  FILLER          PIC X       VALUE SPACES.
   641             20  DET-YR-2        PIC XX      VALUE SPACES.
   642             20  FILLER          PIC X(2)    VALUE SPACES.
   643         16  DET-HIGH-CERT.
   644             20  DET-HI-MO       PIC XX.
   645             20  DET-HI-SLASH    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ECS036.cbl
   646             20  DET-HI-YR       PIC XX.
   647             20  FILLER          PIC X(1)    VALUE SPACES.
   648         16  DET-FILL REDEFINES
   649             DET-HIGH-CERT       PIC X(6).
   650         16  DET-ISS-COUNT-2     PIC ZZZZZ99-.
   651         16  DET-CERTS-2         PIC ZZZ,ZZZ,Z99-.
   652     12  DET-LBEN-2              PIC ZZZZZ,ZZZ,Z99-.
   653     12  DET-LPRM-2              PIC ZZ,ZZZ,ZZ9.99-.
   654     12  DET-LCLM-2              PIC ZZ,ZZZ,ZZ9.99-.
   655     12  DET-APRM-2              PIC ZZ,ZZZ,ZZ9.99-.
   656     12  DET-ACLM-2              PIC ZZ,ZZZ,ZZ9.99-.
   657     12  DET-TPRM-2              PIC ZZZ,ZZZ,ZZ9.99-.
   658     12  DET-TCOM-2              PIC ZZZZZ,ZZ9.99-.
   659
   660 01  DET-DATE-LINE.
   661     12  DET-DATE-DESC           PIC X(17)   VALUE SPACES.
   662     12  DET-DATE-MO             PIC XX.
   663     12  DET-DATE-SLASH-1        PIC X       VALUE '/'.
   664     12  DET-DATE-DA             PIC XX.
   665     12  DET-DATE-SLASH-2        PIC X       VALUE '/'.
   666     12  DET-DATE-YR             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ECS036.cbl
   668 01  ACCUMULATORS.
   669*    12  ACCOUNT-ACCUM    OCCURS 13 TIMES.
   670     12  ACCOUNT-ACCUM    OCCURS 15 TIMES.
   671         16  AC-CERT             PIC S9(9)         COMP-3.
   672         16  AC-ISS              PIC S9(9)         COMP-3.
   673         16  AC-LBEN             PIC S9(11)V99     COMP-3.
   674         16  AC-LPRM             PIC S9(9)V99      COMP-3.
   675         16  AC-LCLM             PIC S9(9)V99      COMP-3.
   676         16  AC-ABEN             PIC S9(9)V99      COMP-3.
   677         16  AC-APRM             PIC S9(9)V99      COMP-3.
   678         16  AC-ACLM             PIC S9(9)V99      COMP-3.
   679         16  AC-TPRM             PIC S9(9)V99      COMP-3.
   680         16  AC-TCOM             PIC S9(9)V99      COMP-3.
   681         16  AC-DATE             PIC 9(11) COMP-3 VALUE 0.
   682         16  AC-DATE-R.
   683             20  FILLER          PIC 999.
   684             20  AC-DATE-CC      PIC 99.
   685             20  AC-DATE-YR      PIC 99.
   686             20  AC-DATE-MO      PIC 99.
   687             20  AC-DATE-DA      PIC 99.
   688*    12  GROUPING-ACCUM   OCCURS 13 TIMES.
   689     12  GROUPING-ACCUM   OCCURS 15 TIMES.
   690         16  GP-CERT             PIC S9(9)         COMP-3.
   691         16  GP-ISS              PIC S9(9)         COMP-3.
   692         16  GP-LBEN             PIC S9(11)V99     COMP-3.
   693         16  GP-LPRM             PIC S9(9)V99      COMP-3.
   694         16  GP-LCLM             PIC S9(9)V99      COMP-3.
   695         16  GP-ABEN             PIC S9(9)V99      COMP-3.
   696         16  GP-APRM             PIC S9(9)V99      COMP-3.
   697         16  GP-ACLM             PIC S9(9)V99      COMP-3.
   698         16  GP-TPRM             PIC S9(9)V99      COMP-3.
   699         16  GP-TCOM             PIC S9(9)V99      COMP-3.
   700         16  GP-DATE             PIC 9(11) COMP-3 VALUE 0.
   701         16  GP-DATE-R.
   702             20  FILLER          PIC 999.
   703             20  GP-DATE-CC      PIC 99.
   704             20  GP-DATE-YR      PIC 99.
   705             20  GP-DATE-MO      PIC 99.
   706             20  GP-DATE-DA      PIC 99.
   707*    12  CARRIER-ACCUM    OCCURS 13 TIMES.
   708     12  CARRIER-ACCUM    OCCURS 15 TIMES.
   709         16  CA-CERT             PIC S9(9)         COMP-3.
   710         16  CA-ISS              PIC S9(9)         COMP-3.
   711         16  CA-LBEN             PIC S9(11)V99     COMP-3.
   712         16  CA-LPRM             PIC S9(9)V99      COMP-3.
   713         16  CA-LCLM             PIC S9(9)V99      COMP-3.
   714         16  CA-ABEN             PIC S9(9)V99      COMP-3.
   715         16  CA-APRM             PIC S9(9)V99      COMP-3.
   716         16  CA-ACLM             PIC S9(9)V99      COMP-3.
   717         16  CA-TPRM             PIC S9(9)V99      COMP-3.
   718         16  CA-TCOM             PIC S9(9)V99      COMP-3.
   719         16  CA-DATE             PIC 9(11) COMP-3 VALUE 0.
   720         16  CA-DATE-R.
   721             20  FILLER          PIC 999.
   722             20  CA-DATE-CC      PIC 99.
   723             20  CA-DATE-YR      PIC 99.
   724             20  CA-DATE-MO      PIC 99.
   725             20  CA-DATE-DA      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ECS036.cbl
   726*    12  STATE-ACCUM      OCCURS 13 TIMES.
   727     12  STATE-ACCUM      OCCURS 15 TIMES.
   728         16  ST-CERT             PIC S9(9)         COMP-3.
   729         16  ST-ISS              PIC S9(9)         COMP-3.
   730         16  ST-LBEN             PIC S9(11)V99     COMP-3.
   731         16  ST-LPRM             PIC S9(9)V99      COMP-3.
   732         16  ST-LCLM             PIC S9(9)V99      COMP-3.
   733         16  ST-ABEN             PIC S9(9)V99      COMP-3.
   734         16  ST-APRM             PIC S9(9)V99      COMP-3.
   735         16  ST-ACLM             PIC S9(9)V99      COMP-3.
   736         16  ST-TPRM             PIC S9(9)V99      COMP-3.
   737         16  ST-TCOM             PIC S9(9)V99      COMP-3.
   738         16  ST-DATE             PIC X(6).
   739*    12  REPTCD-ACCUM     OCCURS 13 TIMES.
   740     12  REPTCD-ACCUM     OCCURS 15 TIMES.
   741         16  RP-CERT             PIC S9(9)         COMP-3.
   742         16  RP-ISS              PIC S9(9)         COMP-3.
   743         16  RP-LBEN             PIC S9(11)V99     COMP-3.
   744         16  RP-LPRM             PIC S9(9)V99      COMP-3.
   745         16  RP-LCLM             PIC S9(9)V99      COMP-3.
   746         16  RP-ABEN             PIC S9(9)V99      COMP-3.
   747         16  RP-APRM             PIC S9(9)V99      COMP-3.
   748         16  RP-ACLM             PIC S9(9)V99      COMP-3.
   749         16  RP-TPRM             PIC S9(9)V99      COMP-3.
   750         16  RP-TCOM             PIC S9(9)V99      COMP-3.
   751         16  RP-DATE             PIC 9(11) COMP-3 VALUE 0.
   752         16  RP-DATE-R.
   753             20  FILLER          PIC 999.
   754             20  RP-DATE-CC      PIC 99.
   755             20  RP-DATE-YR      PIC 99.
   756             20  RP-DATE-MO      PIC 99.
   757             20  RP-DATE-DA      PIC 99.
   758     12  REPTCD2-ACCUM     OCCURS 15 TIMES.
   759         16  RP2-CERT             PIC S9(9)         COMP-3.
   760         16  RP2-ISS              PIC S9(9)         COMP-3.
   761         16  RP2-LBEN             PIC S9(11)V99     COMP-3.
   762         16  RP2-LPRM             PIC S9(9)V99      COMP-3.
   763         16  RP2-LCLM             PIC S9(9)V99      COMP-3.
   764         16  RP2-ABEN             PIC S9(9)V99      COMP-3.
   765         16  RP2-APRM             PIC S9(9)V99      COMP-3.
   766         16  RP2-ACLM             PIC S9(9)V99      COMP-3.
   767         16  RP2-TPRM             PIC S9(9)V99      COMP-3.
   768         16  RP2-TCOM             PIC S9(9)V99      COMP-3.
   769         16  RP2-DATE             PIC 9(11) COMP-3 VALUE 0.
   770         16  RP2-DATE-R.
   771             20  FILLER          PIC 999.
   772             20  RP2-DATE-CC      PIC 99.
   773             20  RP2-DATE-YR      PIC 99.
   774             20  RP2-DATE-MO      PIC 99.
   775             20  RP2-DATE-DA      PIC 99.
   776     12  GRAND-TOTALS.
   777         16  GR-CERT             PIC S9(9)       COMP-3 VALUE +0.
   778         16  GR-ISS              PIC S9(9)       COMP-3 VALUE +0.
   779         16  GR-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   780         16  GR-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   781         16  GR-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
   782         16  GR-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
   783         16  GR-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ECS036.cbl
   784         16  GR-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
   785         16  GR-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   786         16  GR-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
   787*    12  GRAND-ACCUM      OCCURS 13 TIMES.
   788     12  GRAND-ACCUM      OCCURS 15 TIMES.
   789         16  GT-CERT             PIC S9(9)         COMP-3.
   790         16  GT-ISS              PIC S9(9)         COMP-3.
   791         16  GT-LBEN             PIC S9(11)V99     COMP-3.
   792         16  GT-LPRM             PIC S9(9)V99      COMP-3.
   793         16  GT-LCLM             PIC S9(9)V99      COMP-3.
   794         16  GT-ABEN             PIC S9(9)V99      COMP-3.
   795         16  GT-APRM             PIC S9(9)V99      COMP-3.
   796         16  GT-ACLM             PIC S9(9)V99      COMP-3.
   797         16  GT-TPRM             PIC S9(9)V99      COMP-3.
   798         16  GT-TCOM             PIC S9(9)V99      COMP-3.
   799         16  GT-DATE             PIC 9(11) COMP-3 VALUE 0.
   800         16  GT-DATE-R.
   801             20  FILLER          PIC 999.
   802             20  GT-DATE-CC      PIC 99.
   803             20  GT-DATE-YR      PIC 99.
   804             20  GT-DATE-MO      PIC 99.
   805             20  GT-DATE-DA      PIC 99.
   806     12  LAST-12-ACCOUNT-ACCUM.
   807         16  L12AC-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   808         16  L12AC-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   809         16  L12AC-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   810         16  L12AC-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   811         16  L12AC-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   812         16  L12AC-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   813         16  L12AC-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   814         16  L12AC-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   815     12  YTD-ACCOUNT-ACCUM.
   816         16  YTDAC-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   817         16  YTDAC-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   818         16  YTDAC-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   819         16  YTDAC-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   820         16  YTDAC-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   821         16  YTDAC-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   822         16  YTDAC-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   823         16  YTDAC-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   824     12  LAST-12-GROUPING-ACCUM.
   825         16  L12GP-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   826         16  L12GP-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   827         16  L12GP-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   828         16  L12GP-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   829         16  L12GP-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   830         16  L12GP-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   831         16  L12GP-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   832         16  L12GP-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   833     12  LAST-12-CARRIER-ACCUM.
   834         16  L12CA-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   835         16  L12CA-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   836         16  L12CA-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   837         16  L12CA-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   838         16  L12CA-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   839         16  L12CA-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   840         16  L12CA-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   841         16  L12CA-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ECS036.cbl
   842     12  LAST-12-STATE-ACCUM.
   843         16  L12ST-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   844         16  L12ST-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   845         16  L12ST-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   846         16  L12ST-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   847         16  L12ST-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   848         16  L12ST-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   849         16  L12ST-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   850         16  L12ST-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   851     12  LAST-12-REPTCD-ACCUM.
   852         16  L12RP-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   853         16  L12RP-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   854         16  L12RP-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   855         16  L12RP-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   856         16  L12RP-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   857         16  L12RP-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   858         16  L12RP-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   859         16  L12RP-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   860     12  LAST-12-REPTCD2-ACCUM.
   861         16  L12RP2-LBEN         PIC S9(11)V99   COMP-3 VALUE +0.
   862         16  L12RP2-LPRM         PIC S9(9)V99    COMP-3 VALUE +0.
   863         16  L12RP2-LCLM         PIC S9(9)V99    COMP-3 VALUE +0.
   864         16  L12RP2-ABEN         PIC S9(9)V99    COMP-3 VALUE +0.
   865         16  L12RP2-APRM         PIC S9(9)V99    COMP-3 VALUE +0.
   866         16  L12RP2-ACLM         PIC S9(9)V99    COMP-3 VALUE +0.
   867         16  L12RP2-TPRM         PIC S9(9)V99    COMP-3 VALUE +0.
   868         16  L12RP2-TCOM         PIC S9(9)V99    COMP-3 VALUE +0.
   869     12  LAST-12-GRAND-ACCUM.
   870         16  L12GT-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   871         16  L12GT-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   872         16  L12GT-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   873         16  L12GT-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   874         16  L12GT-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   875         16  L12GT-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   876         16  L12GT-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   877         16  L12GT-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   878     12  YTD-GROUPING-ACCUM.
   879         16  YTDGP-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   880         16  YTDGP-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   881         16  YTDGP-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   882         16  YTDGP-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   883         16  YTDGP-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   884         16  YTDGP-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   885         16  YTDGP-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   886         16  YTDGP-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   887     12  YTD-CARRIER-ACCUM.
   888         16  YTDCA-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   889         16  YTDCA-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   890         16  YTDCA-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   891         16  YTDCA-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   892         16  YTDCA-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   893         16  YTDCA-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   894         16  YTDCA-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   895         16  YTDCA-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   896     12  YTD-STATE-ACCUM.
   897         16  YTDST-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   898         16  YTDST-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   899         16  YTDST-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ECS036.cbl
   900         16  YTDST-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   901         16  YTDST-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   902         16  YTDST-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   903         16  YTDST-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   904         16  YTDST-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   905     12  YTD-REPTCD-ACCUM.
   906         16  YTDRP-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   907         16  YTDRP-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   908         16  YTDRP-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   909         16  YTDRP-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   910         16  YTDRP-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   911         16  YTDRP-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   912         16  YTDRP-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   913         16  YTDRP-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   914     12  YTD-REPTCD2-ACCUM.
   915         16  YTDRP2-LBEN         PIC S9(11)V99   COMP-3 VALUE +0.
   916         16  YTDRP2-LPRM         PIC S9(9)V99    COMP-3 VALUE +0.
   917         16  YTDRP2-LCLM         PIC S9(9)V99    COMP-3 VALUE +0.
   918         16  YTDRP2-ABEN         PIC S9(9)V99    COMP-3 VALUE +0.
   919         16  YTDRP2-APRM         PIC S9(9)V99    COMP-3 VALUE +0.
   920         16  YTDRP2-ACLM         PIC S9(9)V99    COMP-3 VALUE +0.
   921         16  YTDRP2-TPRM         PIC S9(9)V99    COMP-3 VALUE +0.
   922         16  YTDRP2-TCOM         PIC S9(9)V99    COMP-3 VALUE +0.
   923     12  YTD-GRAND-ACCUM.
   924         16  YTDGT-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   925         16  YTDGT-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   926         16  YTDGT-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   927         16  YTDGT-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   928         16  YTDGT-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   929         16  YTDGT-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   930         16  YTDGT-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   931         16  YTDGT-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   932     12  ZERO-OCCURS-ACCUM.
   933         16  FILLER              PIC S9(9)      COMP-3  VALUE +0.
   934         16  FILLER              PIC S9(9)      COMP-3  VALUE +0.
   935         16  FILLER              PIC S9(11)V99  COMP-3  VALUE +0.
   936         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   937         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   938         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   939         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   940         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   941         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   942         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   943         16  FILLER              PIC X(6)       VALUE LOW-VALUES.
   944     12  ZERO-ACCUM.
   945         16  FILLER              PIC S9(11)V99  COMP-3  VALUE +0.
   946         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   947         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   948         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   949         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   950         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   951         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   952         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   953     12  ZERO-GRAND-TOTALS.
   954         16  FILLER              PIC S9(9)      COMP-3  VALUE +0.
   955         16  FILLER              PIC S9(9)      COMP-3  VALUE +0.
   956         16  FILLER              PIC S9(11)V99  COMP-3  VALUE +0.
   957         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ECS036.cbl
   958         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   959         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   960         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   961         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   962         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   963         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   964
   965
   966 01  PYTD-ACCOUNT-ACCUM.
   967     12  PYTDAC-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   968     12  PYTDAC-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   969     12  PYTDAC-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
   970     12  PYTDAC-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
   971     12  PYTDAC-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
   972     12  PYTDAC-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
   973     12  PYTDAC-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   974     12  PYTDAC-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
   975
   976 01  PYTD-GROUPING-ACCUM.
   977     12  PYTDGP-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   978     12  PYTDGP-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   979     12  PYTDGP-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
   980     12  PYTDGP-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
   981     12  PYTDGP-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
   982     12  PYTDGP-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
   983     12  PYTDGP-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   984     12  PYTDGP-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
   985
   986 01  PYTD-CARRIER-ACCUM.
   987     12  PYTDCA-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   988     12  PYTDCA-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   989     12  PYTDCA-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
   990     12  PYTDCA-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
   991     12  PYTDCA-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
   992     12  PYTDCA-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
   993     12  PYTDCA-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   994     12  PYTDCA-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
   995
   996 01  PYTD-STATE-ACCUM.
   997     12  PYTDST-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   998     12  PYTDST-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   999     12  PYTDST-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1000     12  PYTDST-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
  1001     12  PYTDST-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1002     12  PYTDST-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1003     12  PYTDST-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1004     12  PYTDST-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
  1005
  1006 01  PYTD-REPTCD-ACCUM.
  1007     12  PYTDRP-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
  1008     12  PYTDRP-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1009     12  PYTDRP-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1010     12  PYTDRP-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
  1011     12  PYTDRP-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1012     12  PYTDRP-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1013     12  PYTDRP-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1014     12  PYTDRP-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
  1015
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ECS036.cbl
  1016 01  PYTD-REPTCD2-ACCUM.
  1017     12  PYTDRP2-LBEN            PIC S9(11)V99   COMP-3 VALUE +0.
  1018     12  PYTDRP2-LPRM            PIC S9(9)V99    COMP-3 VALUE +0.
  1019     12  PYTDRP2-LCLM            PIC S9(9)V99    COMP-3 VALUE +0.
  1020     12  PYTDRP2-ABEN            PIC S9(9)V99    COMP-3 VALUE +0.
  1021     12  PYTDRP2-APRM            PIC S9(9)V99    COMP-3 VALUE +0.
  1022     12  PYTDRP2-ACLM            PIC S9(9)V99    COMP-3 VALUE +0.
  1023     12  PYTDRP2-TPRM            PIC S9(9)V99    COMP-3 VALUE +0.
  1024     12  PYTDRP2-TCOM            PIC S9(9)V99    COMP-3 VALUE +0.
  1025
  1026 01  PYTD-GRAND-ACCUM.
  1027     12  PYTDGT-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
  1028     12  PYTDGT-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1029     12  PYTDGT-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1030     12  PYTDGT-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
  1031     12  PYTDGT-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1032     12  PYTDGT-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1033     12  PYTDGT-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1034     12  PYTDGT-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
  1035
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ECS036.cbl
  1037 01  PRINT-DECISION-TABLE COMP-3.
  1038     05  PRINT-TABLE      OCCURS 12 TIMES.
  1039         10  PLBEN               PIC S9(9)V99.
  1040         10  PLPRM               PIC S9(9)V99.
  1041         10  PLCLM               PIC S9(9)V99.
  1042         10  PABEN               PIC S9(9)V99.
  1043         10  PAPRM               PIC S9(9)V99.
  1044         10  PACLM               PIC S9(9)V99.
  1045         10  PTCOM               PIC S9(9)V99.
  1046
  1047 01  PRINT-ZERO-TABLE  COMP-3.
  1048     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1049     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1050     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1051     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1052     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1053     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1054     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1055
  1056 01  WS.
  1057     12  WS-RETURN-CODE          PIC S9(4)    COMP   VALUE ZERO.
  1058     12  WS-ZERO                 PIC S9              VALUE ZERO.
  1059     12  WS-ABEND-MESSAGE        PIC X(80)           VALUE SPACES.
  1060     12  WS-ABEND-FILE-STATUS    PIC XX              VALUE ZERO.
  1061     12  WS-EP-ACC-EXPIRES       PIC 9(11).
  1062     12  WS-EP-ACC-EXPIRES-R REDEFINES WS-EP-ACC-EXPIRES.
  1063         16  FILLER              PIC 999.
  1064         16  EP-ACC-EXP-CC       PIC 99.
  1065         16  EP-ACC-EXP-YR       PIC 99.
  1066         16  EP-ACC-EXP-MO       PIC 99.
  1067         16  EP-ACC-EXP-DA       PIC 99.
  1068     12  WS-EP-ACC-HI-CERT       PIC 9(11).
  1069     12  WS-EP-ACC-HI-CERT-R REDEFINES WS-EP-ACC-HI-CERT.
  1070         16  FILLER              PIC 999.
  1071         16  EP-ACC-HI-CC        PIC 99.
  1072         16  EP-ACC-HI-YR        PIC 99.
  1073         16  EP-ACC-HI-MO        PIC 99.
  1074         16  EP-ACC-HI-DA        PIC 99.
  1075     12  WS-EP-MTH-HI-CERT       PIC 9(11).
  1076     12  WS-EP-MTH-HI-CERT-R REDEFINES WS-EP-MTH-HI-CERT.
  1077         16  FILLER              PIC 999.
  1078         16  EP-MTH-HI-CC        PIC 99.
  1079         16  EP-MTH-HI-YR        PIC 99.
  1080         16  EP-MTH-HI-MO        PIC 99.
  1081         16  EP-MTH-HI-DA        PIC 99.
  1082     12  WS-EP-DTE               PIC 9(07).
  1083     12  WS-EP-DTE-R REDEFINES WS-EP-DTE.
  1084         16  FILLER              PIC 9.
  1085         16  EP-RUN-CC           PIC 99.
  1086         16  EP-RUN-YR           PIC 99.
  1087         16  EP-RUN-MO           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ECS036.cbl
  1089 01  CONVERSION-DATE             PIC 9(08) VALUE ZEROS.
  1090 01  CONVERSION-DATE-R REDEFINES CONVERSION-DATE.
  1091     05  CONV-CC                 PIC XX.
  1092     05  CONV-YR                 PIC XX.
  1093     05  CONV-MO                 PIC XX.
  1094     05  CONV-DA                 PIC XX.
  1095
  1096 01  COMPARE-DATE-TABLE.
  1097*    05  COMPARE-DTS    OCCURS 13 TIMES.
  1098     05  COMPARE-DTS    OCCURS 15 TIMES.
  1099         10  COMPARE-DT.
  1100             15  COMP-CCYY       PIC 9(4).
  1101             15  COMP-CCYR REDEFINES COMP-CCYY.
  1102                 20  COMP-CC     PIC 99.
  1103                 20  COMP-YR     PIC 99.
  1104             15  COMP-MO         PIC 99.
  1105
  1106 01  COMPARE-DATE9TABLE REDEFINES COMPARE-DATE-TABLE.
  1107*    05  COMPARE9DTS    OCCURS 13 TIMES.
  1108     05  COMPARE9DTS    OCCURS 15 TIMES.
  1109         10  COMPARE9DT          PIC 9(06).
  1110
  1111 01  YEAR-END-DT                 PIC 9(06)  VALUE ZEROS.
  1112 01  TWO-YEAR-ENDS-AGO           PIC 9(06)  VALUE ZEROS.
  1113 01  TWO-YEARS-AGO               PIC 9(06)  VALUE ZEROS.
  1114 01  YEAR-OLD-DATE               PIC 9(06).
  1115
  1116 01  FISCAL-DATE         REDEFINES YEAR-OLD-DATE.
  1117     05  FISCAL-CCYY             PIC 9(04).
  1118     05  FISCAL-CCYR REDEFINES FISCAL-CCYY.
  1119         10  FISCAL-CC           PIC 99.
  1120         10  FISCAL-YR           PIC 99.
  1121     05  FISCAL-MO               PIC 99.
  1122
  1123 01  SAVE-EPX.
  1124     12  SAVE-CNTL.
  1125         16  S-EPX-CNTL-1.
  1126             20  S-EPX-CNTL-GA       PIC X(10).
  1127             20  S-EPX-CNTL-ACCT     PIC X(10).
  1128         16  S-EPX-CNTL-2.
  1129             20  S-EPX-CARR          PIC X.
  1130             20  S-EPX-GRP           PIC X(6).
  1131         16  FILLER                  PIC X(12).
  1132     12  SAVE-ALT-CNTL  REDEFINES  SAVE-CNTL.
  1133         16  S-EPX-A-RPT-CD-1        PIC X(10).
  1134         16  S-EPX-A-CARR            PIC X.
  1135         16  S-EPX-A-GROUP           PIC X(6).
  1136         16  S-EPX-A-RPT-CD-2        PIC X(10).
  1137         16  S-EPX-A-STATE           PIC XX.
  1138         16  S-EPX-A-ACCT            PIC X(10).
  1139
  1140 01  SAVE-ACCT-STATUS            PIC X(12).
  1141 01  SAVE-ACCT-NAME              PIC X(30).
  1142 01  SAVE-ACCT-CITY              PIC X(30).
  1143
  1144 01  SAVE-DATES.
  1145     05  SAVE-AM-EXPIRES         PIC 9(11).
  1146     05  SAVE-AM-EXPIRES-R REDEFINES SAVE-AM-EXPIRES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ECS036.cbl
  1147         12  FILLER              PIC 999.
  1148         12  SAVE-AM-EXP-CC      PIC 99.
  1149         12  SAVE-AM-EXP-YR      PIC 99.
  1150         12  SAVE-AM-EXP-MO      PIC 99.
  1151         12  SAVE-AM-EXP-DA      PIC 99.
  1152     05  SAVE-AM-HI-CERT         PIC 9(11).
  1153     05  SAVE-AM-HI-CERT-R REDEFINES SAVE-AM-HI-CERT.
  1154         12  FILLER              PIC 999.
  1155         12  SAVE-AM-HI-CC       PIC 99.
  1156         12  SAVE-AM-HI-YR       PIC 99.
  1157         12  SAVE-AM-HI-MO       PIC 99.
  1158         12  SAVE-AM-HI-DA       PIC 99.
  1159     05  SAVE-HER-HI-CERT        PIC 9(11).
  1160     05  SAVE-HER-HI-CERT-R REDEFINES SAVE-HER-HI-CERT.
  1161         12  FILLER              PIC 999.
  1162         12  SAVE-HER-HI-CC      PIC 99.
  1163         12  SAVE-HER-HI-YR      PIC 99.
  1164         12  SAVE-HER-HI-MO      PIC 99.
  1165         12  SAVE-HER-HI-DA      PIC 99.
  1166
  1167 01  EP-DATE.
  1168     05  E-CC                    PIC 99      VALUE ZEROS.
  1169     05  E-YR                    PIC 99      VALUE ZEROS.
  1170     05  E-MO                    PIC 99      VALUE ZEROS.
  1171
  1172 01  EP9DATE REDEFINES EP-DATE   PIC 9(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ECS036.cbl
  1174 01  WS-BIN-DATES.
  1175     12  BIN-AC-DATE             PIC XX      VALUE SPACES.
  1176     12  BIN-EP-HI-CERT          PIC XX      VALUE SPACES.
  1177     12  BIN-MTH-HI-CERT         PIC XX      VALUE SPACES.
  1178     12  BIN-GP-DATE             PIC XX      VALUE SPACES.
  1179     12  BIN-RP-DATE             PIC XX      VALUE SPACES.
  1180     12  BIN-CA-DATE             PIC XX      VALUE SPACES.
  1181     12  BIN-GT-DATE             PIC XX      VALUE SPACES.
  1182
* 1183 COPY ELCDATE.
  1184******************************************************************06/11/98
  1185*                                                                *ELCDATE
  1186*                                                                *ELCDATE
  1187*                            ELCDATE.                            *   LV023
  1188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1189*                            VMOD=2.003                           ELCDATE
  1190*                                                                *ELCDATE
  1191*                                                                *ELCDATE
  1192*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1193*                 LENGTH = 200                                   *   CL*19
  1194******************************************************************ELCDATE
  1195                                                                  ELCDATE
  1196 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1197     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1198     12  DC-OPTION-CODE                PIC X.                        CL*15
  1199         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1200         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1201         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1202         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1203         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1204         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1205         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1206         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1207         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1208         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1209         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1210         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1211         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1212         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1213         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1214         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1215         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1216         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1217         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1218         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1219         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1220         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1221         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1222         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1223         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1224         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1225         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1226         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1227         88  THREE-CHARACTER-BIN                                  ELCDATE
  1228                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1229         88  GREGORIAN-TO-BIN                                        CL**2
  1230                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1231         88  BIN-TO-GREGORIAN                                        CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1232                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1233         88  JULIAN-TO-BINARY                                        CL**2
  1234                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1235     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1236         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1237         88  DATE-CONVERSION-ERROR                                ELCDATE
  1238                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1239         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1240         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1241         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1242         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1243         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1244         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1245         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1246         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1247         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1248         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1249     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1250         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1251     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1252         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1253         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1254         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1255     12  FILLER                        PIC X.                        CL*15
  1256     12  DC-CONVERSION-DATES.                                        CL*15
  1257         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1258         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1259         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1260         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1261                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1262             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1263             20  SLASH1-1              PIC X.                        CL*15
  1264             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1265             20  SLASH1-2              PIC X.                        CL*15
  1266             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1267         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1268         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1269                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1270             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1271             20  SLASH2-1              PIC X.                        CL*15
  1272             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1273             20  SLASH2-2              PIC X.                        CL*15
  1274             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1275         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1276         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1277                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1278             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1279             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1280             20  DC-YMD-DAY            PIC 99.                       CL*15
  1281         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1282         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1283                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1284             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1285             20  DC-MDY-DAY            PIC 99.                       CL*15
  1286             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1287         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1288             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1289             20  DC-ALPHA-DAY          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1290             20  FILLER                PIC XX.                       CL*15
  1291             20  DC-ALPHA-CENTURY.                                   CL*15
  1292                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1293             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1294         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1295         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1296         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1297         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1298         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1299                                       PIC 9(05).                    CL*20
  1300         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1301             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1302             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1303         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1304         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1305         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1306     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1307         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1308         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1309             20  FILLER                PIC 9(3).                     CL*15
  1310             20  HOLD-CEN-1-CCYY.                                    CL*15
  1311                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1312                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1313             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1314             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1315         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1316             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1317             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1318             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1319                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1320                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1321             20  FILLER                PIC 9(3).                     CL*15
  1322         16  HOLD-CENTURY-1-X.                                       CL*15
  1323             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1324             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1325                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1326                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1327             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1328             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1329         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1330             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1331             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1332             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1333                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1334                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1335             20  FILLER                PIC XXX.                      CL*23
  1336         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1337         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1338         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1339         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1340             20  DC-JULIAN-1-CCYY.                                   CL*15
  1341                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1342                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1343             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1344         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1345         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1346             20  DC-JULIAN-2-CCYY.                                   CL*15
  1347                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1348                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1349             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1350         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1351             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1352             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1353             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1354             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1355             20  DC-EDITA-CCYY.                                      CL*15
  1356                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1357                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1358         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1359             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1360             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1361             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1362             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1363             20  DC-EDITB-CCYY.                                      CL*15
  1364                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1365                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1366         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1367         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1368                              DC-GREG-DATE-CYMD.                  ELCDATE
  1369             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1370             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1371             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1372             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1373         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1374         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1375                              DC-GREG-DATE-MDCY.                  ELCDATE
  1376             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1377             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1378             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1379             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1380    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1381        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1382    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1383    12  FILLER                         PIC X(28).                    CL*26
  1384
* 1385                                 COPY ELCDTECX.
  1386******************************************************************06/05/98
  1387*                                                                *ELCDTECX
  1388*                            ELCDTECX.                           *   LV005
  1389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1390*                            VMOD=2.015                          *ELCDTECX
  1391*                                                                *ELCDTECX
  1392*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1393*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1394*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1395*                                                                *ELCDTECX
  1396******************************************************************ELCDTECX
  1397******************************************************************
  1398*                   C H A N G E   L O G
  1399*
  1400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1401*-----------------------------------------------------------------
  1402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1403* EFFECTIVE    NUMBER
  1404*-----------------------------------------------------------------
  1405* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1406*                                  BENEFIT CODES FROM 300 TO 900
  1407* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1408* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1409******************************************************************
  1410 01  DATE-CARD.                                                   ELCDTECX
  1411     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1412     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1413     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1414     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1415     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1416     12  EP-SW                       PIC  X.                      ELCDTECX
  1417         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1418     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1419         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1420     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1421     12  RUN-CENTURY.                                             ELCDTECX
  1422         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1423     12  FILLER                      PIC  X.                         CL**4
  1424     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1425     12  FILLER                      PIC  XXX.                    ELCDTECX
  1426     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1427                                                                  ELCDTECX
  1428 01  FILLER                          PIC  X(7)                       CL**6
  1429                                          VALUE 'OPTIONS'.        ELCDTECX
  1430 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1431     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1432     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1433     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1434         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1435         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1436     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1437     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1438     12  FILLER                      PIC  X.                      ELCDTECX
  1439     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1440     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1441     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1442     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1443     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1444     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1445     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1446     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1447     12  FILLER                      PIC  X.                      ELCDTECX
  1448     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1449     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1450     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1451     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1452     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1453     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1454     12  FILLER                      PIC  X.                      ELCDTECX
  1455     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1456     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1457     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1458     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1459     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1460     12  DTE-R78                     PIC  X.                      ELCDTECX
  1461     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1462     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1463     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1464     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1465     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1466     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1467     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1468                                     PIC  X.                      ELCDTECX
  1469         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1470                                                 ' '.             ELCDTECX
  1471         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1472         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1473     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1474         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1475         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1476     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1477     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1478                                     PIC  9.                         CL**4
  1479     12  DTE-SYSTEM.                                              ELCDTECX
  1480         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1481         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1482         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1483         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1484         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1485         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1486         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1487         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1488         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1489         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1490         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1491         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1492         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1493         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1494         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1495         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1496         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1497         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1498         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1499         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1500         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1501         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1502         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1503         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1504         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1505         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1506     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1507         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1508                                     PIC  X.                      ELCDTECX
  1509     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1510                                                                  ELCDTECX
  1511 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1512     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1513     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1514     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1515*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1516     12  FILLER                      PIC  X.                      ELCDTECX
  1517     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1518     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1519     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1520     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1521     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1522     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1523     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1524                                                                  ELCDTECX
  1525     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1526     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1527     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1528     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1529                                                                  ELCDTECX
  1530     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1531     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1532     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1533     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1534                                                                  ELCDTECX
  1535     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1536     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1537                                                                  ELCDTECX
  1538     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1539     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1540                                                                  ELCDTECX
  1541     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1542                                                                  ELCDTECX
  1543 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1544     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1545     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1546     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1547     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1548     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1549     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1550     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1551                                                                  ELCDTECX
  1552 01  FILLER                          PIC  X(12)                   ELCDTECX
  1553                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1554 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1555     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1556         16  CNT-ID                  PIC  X.                      ELCDTECX
  1557         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1558                                                                  ELCDTECX
  1559 01  FILLER                          PIC  X(11)                   ELCDTECX
  1560                                          VALUE 'STATE NAMES'.    ELCDTECX
  1561 01  STATE-NAMES.                                                 ELCDTECX
  1562     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1563         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1564         16  STATE-PIC1.                                          ELCDTECX
  1565             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1566             20  FILLER              PIC  XXX.                    ELCDTECX
  1567             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1568             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1569             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1570             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1571                                                                  ELCDTECX
  1572 01  FILLER                          PIC  X(13)                   ELCDTECX
  1573                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1574 01  CARRIER-NAMES.                                               ELCDTECX
  1575     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1576         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1577         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1578         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1579         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1580         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1581         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1582*        16  FILLER                  PIC  X.                      ELCDTECX
  1583         16  CARRIER-SEC-PAY         PIC  X.
  1584             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1585                                                                  ELCDTECX
  1586 01  FILLER                          PIC  X(9)                       CL**6
  1587                                          VALUE 'INS TYPES'.      ELCDTECX
  1588 01  CLAS-INS-TYPES.                                              ELCDTECX
  1589*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1590     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1591         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1592         16  CLAS-I-AB3.                                          ELCDTECX
  1593             20  FILLER              PIC  X.                      ELCDTECX
  1594             20  CLAS-I-AB2.                                      ELCDTECX
  1595                 24  FILLER          PIC  X.                      ELCDTECX
  1596                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1597         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1598             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1599             20  FILLER              PIC  X.                         CL**4
  1600         16  CLAS-I-AB10.                                         ELCDTECX
  1601             20  FILLER              PIC  X(9).                   ELCDTECX
  1602             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1603         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1604         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1605         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1606         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1607             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1608         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1609         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1610         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1611         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1612         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1613         16  FILLER                  PIC  X(05).
  1614                                                                  ELCDTECX
  1615 01  FILLER                          PIC  X(16)                   ELCDTECX
  1616                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1617 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1618     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1619                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1620         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1621         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1622         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1623         16  CLAS-MORT-DESC.                                      ELCDTECX
  1624             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1625             20  FILLER              PIC  XX.                        CL**5
  1626             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1627             20  FILLER              PIC  X.                         CL**5
  1628             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1629             20  FILLER              PIC  X.                         CL**5
  1630             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1631             20  FILLER              PIC  X.                         CL**5
  1632             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1633             20  FILLER              PIC  X(5).                      CL**6
  1634                                                                  ELCDTECX
  1635 01  FILLER                          PIC  X(15)                   ELCDTECX
  1636                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1637 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1638     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1639         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1640         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1641         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1642         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1643         16  FILLER                  PIC  X(4).                      CL**6
  1644                                                                  ELCDTECX
  1645 01  FILLER                          PIC  X(7)                       CL**6
  1646                                     VALUE 'INDEXES'.             ELCDTECX
  1647 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1648     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1649     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1650     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1651     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1652     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1653     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1654     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1655     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1656     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1657     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1658     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1659     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1660     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1661     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1662     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1663     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1664     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1665                                                                  ELCDTECX
  1666 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1667     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1668     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1669     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1670     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1671     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1672     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1673     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1674     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1675     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1676     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1677     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1678                                                                  ELCDTECX
  1679 01  FILLER                          PIC  X(13)                   ELCDTECX
  1680                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1681 01  CLAS-MISC.                                                   ELCDTECX
  1682     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1683         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1684         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1685         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1686     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1687     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1688     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1689     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1690     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1691     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1692     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1693     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1694     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1695     12  STATE-L                     PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1696     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1697     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1698     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1699         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1700         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1701     12  DTE-ABEND-WORK.                                          ELCDTECX
  1702         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1703         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1704                                                                  ELCDTECX
  1705 01  FILLER                          PIC  X(12)                   ELCDTECX
  1706                                     VALUE 'WORKING DATE'.        ELCDTECX
  1707 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1708     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1709         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1710         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1711         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1712     12  WS-CURRENT-DATE.                                         ELCDTECX
  1713         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1714         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1715         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1716         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1717         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1718     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1719         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1720         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1721                                                                  ELCDTECX
  1722 01  FILLER                          PIC  X(12)                   ELCDTECX
  1723                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1724 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1725     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1726         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1727         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1728         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1729                                                                  ELCDTECX
  1730 01  FILLER                          PIC  X(10)                   ELCDTECX
  1731                                     VALUE 'STATE TLRS'.          ELCDTECX
  1732 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1733     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1734         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1735         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1736                                                                  ELCDTECX
  1737 01  FILLER                          PIC  X(13)                   ELCDTECX
  1738                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1739 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1740     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1741         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1742                                                                  ELCDTECX
  1743 01  FILLER                          PIC  X(13)                   ELCDTECX
  1744                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1745 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1746     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1747     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1748     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1749                                     PIC  X.                         CL**5
  1750     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1751     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1752     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1753     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1754     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1755     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1756     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1757     12  FILLER                      PIC  X(75).                  ELCDTECX
  1758******************************************************************ELCDTECX
  1759*01  MISC-CARR-PCT-DATA.                                          00001521
  1760*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1761*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1762*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1763*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1764*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1765*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1766******************************************************************ELCDTECX
  1767
* 1768                                 COPY ELCDTEVR.
  1769***************************************************************** 04/15/98
  1770*                                                                *ELCDTEVR
  1771*                                                                *ELCDTEVR
  1772*                            ELCDTEVR.                           *   LV003
  1773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1774*                            VMOD=2.001                          *   CL**2
  1775*                                                                *ELCDTEVR
  1776*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1777*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1778*                                                                *ELCDTEVR
  1779******************************************************************ELCDTEVR
  1780 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1781     05  WS-RUN-DATE.                                             ELCDTEVR
  1782         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1783         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1784         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1785             15  RUN-CC              PIC  99.                     ELCDTEVR
  1786             15  RUN-YR              PIC  99.                     ELCDTEVR
  1787         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1788         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1789     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1790            WS-RUN-DATE              PIC 9(11).                      CL**2
  1791     05  WS-EP-DT.                                                ELCDTEVR
  1792         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1793         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1794         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1795             15  EP-CC               PIC  99.                     ELCDTEVR
  1796             15  EP-YR               PIC  99.                     ELCDTEVR
  1797         10  EP-MO                   PIC  99.                     ELCDTEVR
  1798         10  EP-DA                   PIC  99.                     ELCDTEVR
  1799     05  WS-EP-DT-N REDEFINES                                        CL**2
  1800            WS-EP-DT                 PIC 9(11).                      CL**2
  1801     05  WS-DTE-CONV-DT.                                             CL**4
  1802         10  FILLER                  PIC  9(03).                     CL**4
  1803         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1804         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1805             15  DTE-CONV-CC         PIC  99.                        CL**4
  1806             15  DTE-CONV-YR         PIC  99.                        CL**4
  1807         10  DTE-CONV-MO             PIC  99.                        CL**4
  1808         10  DTE-CONV-DA             PIC  99.                        CL**4
  1809     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1810            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1811 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1812     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1813         10  FILLER                            PIC 999.           ELCDTEVR
  1814         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1815         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1816             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1817             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1818         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1819         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1820     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1821            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1822     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1823         10  FILLER                            PIC 999.           ELCDTEVR
  1824         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1825         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1826         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1827         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1828     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1829            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1830 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1831     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1832         10  FILLER                            PIC 999.           ELCDTEVR
  1833         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1834         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1835             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1836             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1837         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1838         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1839     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1840            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1841     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1842         10  FILLER                            PIC 999.           ELCDTEVR
  1843         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1844         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1845             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1846             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1847         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1848         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1849     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1850            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1851     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1852         10  FILLER                            PIC 999.           ELCDTEVR
  1853         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1854         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1855             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1856             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1857         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1858         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1859     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1860            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1861 01  WS-RATE-RECORD.                                              ELCDTEVR
  1862         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1863             10  FILLER                        PIC 999.           ELCDTEVR
  1864             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1865             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1866                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1867                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1868             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1869             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ECS036.cbl
  1870         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1871                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1872 LINKAGE SECTION.
  1873
  1874 01  PARM.
  1875     05  PARM-LENGTH BINARY  PICTURE IS S9(4).
  1876     05  PARM-VALUE  DISPLAY PICTURE IS X(100).
  1877
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ECS036.cbl
  1879 PROCEDURE DIVISION USING PARM.
  1880
  1881 0000-START-HERE.
* 1882                    COPY ELCDTERX.
  1883******************************************************************04/15/98
  1884*                                                                *ELCDTERX
  1885*                                                                *ELCDTERX
  1886*                            ELCDTERX.                           *   LV002
  1887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1888*                            VMOD=2.007                          *ELCDTERX
  1889*                                                                *ELCDTERX
  1890*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1891*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1892*      = ELCDTEFD)                                               *ELCDTERX
  1893*                                                                *ELCDTERX
  1894******************************************************************ELCDTERX
  1895                                                                  ELCDTERX
  1896     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1897                                                                  ELCDTERX
  1898     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1899     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1900     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1901                                                                  ELCDTERX
  1902     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1903                                                                  ELCDTERX
  1904******************************************************************ELCDTERX
  1905*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1906*          WARNING MESSAGES.                                      ELCDTERX
  1907******************************************************************ELCDTERX
  1908     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1909         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1910                                                                  ELCDTERX
  1911     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1912                                                                  ELCDTERX
  1913     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1914                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1915                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1916                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1917                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1918                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1919                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1920                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1921                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1922                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1923                                                                  ELCDTERX
  1924     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1925                                                                  ELCDTERX
  1926     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1927                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1928                                                                  ELCDTERX
  1929     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1930     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1931     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1932     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1933                                                                  ELCDTERX
  1934     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1935         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1936     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1937         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1938                                                                  ELCDTERX
  1939     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1940         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1941     ELSE                                                         ELCDTERX
  1942         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1943                                                                  ELCDTERX
  1944 0005-READ--CARD.                                                 ELCDTERX
  1945     READ DISK-DATE                                               ELCDTERX
  1946         AT END CLOSE DISK-DATE                                   ELCDTERX
  1947             GO TO 0060-READ--TEST.                               ELCDTERX
  1948                                                                  ELCDTERX
  1949     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1950                                                                  ELCDTERX
  1951     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1952         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1953         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1954         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1955         GO TO 0005-READ--CARD.                                   ELCDTERX
  1956                                                                  ELCDTERX
  1957     IF DD-ID = 'CLAD'                                            ELCDTERX
  1958         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1959         GO TO 0005-READ--CARD.                                   ELCDTERX
  1960                                                                  ELCDTERX
  1961     IF DD-ID = 'CLAX'                                            ELCDTERX
  1962         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1963         GO TO 0005-READ--CARD.                                   ELCDTERX
  1964                                                                  ELCDTERX
  1965     IF DD-ID = 'CLAF'                                            ELCDTERX
  1966         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1967         GO TO 0005-READ--CARD.                                   ELCDTERX
  1968                                                                  ELCDTERX
  1969     IF DD-ID = 'CLAC'                                            ELCDTERX
  1970         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1971                                                                  ELCDTERX
  1972     IF DD-ID = 'CARR'                                            ELCDTERX
  1973         GO TO 0015-READ--CARR.                                   ELCDTERX
  1974                                                                  ELCDTERX
  1975     IF DD-ID = 'STAT'                                            ELCDTERX
  1976         GO TO 0020-READ--STAT.                                   ELCDTERX
  1977                                                                  ELCDTERX
  1978     IF DD-ID = 'BUSC'                                            ELCDTERX
  1979         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1980                                                                  ELCDTERX
  1981     IF DD-ID = 'MORT'                                            ELCDTERX
  1982         GO TO 0030-READ--MORT.                                   ELCDTERX
  1983                                                                  ELCDTERX
  1984     IF DD-ID = 'CLAI'                                            ELCDTERX
  1985         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1986                                                                  ELCDTERX
  1987     IF DD-ID = 'COLC'                                            ELCDTERX
  1988         GO TO 0065-READ--COLC.                                   ELCDTERX
  1989                                                                  ELCDTERX
  1990     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1991        DD-IDA = 'CL'                                             ELCDTERX
  1992         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1993                                                                  ELCDTERX
  1994     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1995        DD-IDA = 'PO'                                             ELCDTERX
  1996         GO TO 0050-READ--POXX.                                   ELCDTERX
  1997                                                                  ELCDTERX
  1998     IF DD-ID = 'OPCA'                                            ELCDTERX
  1999         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2000                                                                  ELCDTERX
  2001     IF DD-ID = 'OPST'                                            ELCDTERX
  2002         GO TO 0072-READ--OPST.                                   ELCDTERX
  2003                                                                  ELCDTERX
  2004     IF DD-ID = 'OPBS'                                            ELCDTERX
  2005         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2006                                                                  ELCDTERX
  2007     IF DD-ID = 'OPMS'                                            ELCDTERX
  2008         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2009                                                                  ELCDTERX
  2010     GO TO 0005-READ--CARD.                                       ELCDTERX
  2011                                                                  ELCDTERX
  2012 0010-READ--CLAC.                                                 ELCDTERX
  2013     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2014     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2015     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2016     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2017     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2018     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2019     GO TO 0005-READ--CARD.                                       ELCDTERX
  2020                                                                  ELCDTERX
  2021 0015-READ--CARR.                                                 ELCDTERX
  2022     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2023     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2024        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2025        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2026        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2027        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2028        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2029        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2030        MOVE DD-CARR1-SECPAY-SW
  2031                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2032     END-IF
  2033                                                                  ELCDTERX
  2034     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2035     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2036        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2037        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2038        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2039        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2040        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2041        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2042        MOVE DD-CARR2-SECPAY-SW
  2043                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2044     END-IF
  2045                                                                  ELCDTERX
  2046                                                                  ELCDTERX
  2047     GO TO 0005-READ--CARD.                                       ELCDTERX
  2048                                                                  ELCDTERX
  2049 0020-READ--STAT.                                                 ELCDTERX
  2050     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2051     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2052        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2053         GO TO 0005-READ--CARD.                                   ELCDTERX
  2054                                                                  ELCDTERX
  2055     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2056     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2057     GO TO 0020-READ--STAT.                                       ELCDTERX
  2058                                                                  ELCDTERX
  2059 0025-READ--BUSC.                                                 ELCDTERX
  2060     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2061     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2062        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2063         GO TO 0005-READ--CARD.                                   ELCDTERX
  2064                                                                  ELCDTERX
  2065     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2066     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2067     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2068                                                                  ELCDTERX
  2069 0030-READ--MORT.                                                 ELCDTERX
  2070     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2071     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2072        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2073         GO TO 0005-READ--CARD.                                   ELCDTERX
  2074                                                                  ELCDTERX
  2075     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2076     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2077     GO TO 0030-READ--MORT.                                       ELCDTERX
  2078                                                                  ELCDTERX
  2079 0035-READ--CLXX.                                                 ELCDTERX
  2080     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2081          GO TO 0005-READ--CARD.                                  ELCDTERX
  2082                                                                  ELCDTERX
  2083     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2084         DISPLAY '***********************************************'ELCDTERX
  2085         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2086         DISPLAY '***********************************************'ELCDTERX
  2087         GO TO 0055-READ--STOP.                                   ELCDTERX
  2088                                                                  ELCDTERX
  2089     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2090        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2091         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2092                                                                  ELCDTERX
  2093     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2094        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2095         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2096                                                                  ELCDTERX
  2097*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2098     GO TO 0005-READ--CARD.                                       ELCDTERX
  2099                                                                  ELCDTERX
  2100 0040-READ--CLAI.                                                 ELCDTERX
  2101     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2102     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2103        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2104         GO TO 0005-READ--CARD.                                   ELCDTERX
  2105                                                                  ELCDTERX
  2106     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2107     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2108     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2109                                                                  ELCDTERX
  2110 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2111     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2112     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2113                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2114     PERFORM ABEND-PGM.                                           ELCDTERX
  2115                                                                  ELCDTERX
  2116 0050-READ--POXX.                                                 ELCDTERX
  2117     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2118         GO TO 0005-READ--CARD.                                   ELCDTERX
  2119                                                                  ELCDTERX
  2120     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2121         DISPLAY '***********************************************'ELCDTERX
  2122         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2123         DISPLAY '***********************************************'ELCDTERX
  2124         GO TO 0055-READ--STOP.                                   ELCDTERX
  2125                                                                  ELCDTERX
  2126     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2127     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2128     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2129     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2130                                                                  ELCDTERX
  2131     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2132         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2133     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2134         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2135                                                                  ELCDTERX
  2136     GO TO 0005-READ--CARD.                                       ELCDTERX
  2137                                                                  ELCDTERX
  2138 0055-READ--STOP.                                                 ELCDTERX
  2139     GOBACK.                                                      ELCDTERX
  2140                                                                  ELCDTERX
  2141 0060-READ--TEST.                                                 ELCDTERX
  2142     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2143        CLAX-ID         = SPACE  OR                               ELCDTERX
  2144        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2145         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2146                                                                  ELCDTERX
  2147     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2148     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2149                                                                  ELCDTERX
  2150 0065-READ--COLC.                                                 ELCDTERX
  2151     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2152     GO TO 0005-READ--CARD.                                       ELCDTERX
  2153                                                                  ELCDTERX
  2154 0070-READ--OPCA.                                                 ELCDTERX
  2155                                                                  ELCDTERX
  2156     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2157                                                                  ELCDTERX
  2158     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2159             OR                                                   ELCDTERX
  2160         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2161         GO TO 0005-READ--CARD.                                   ELCDTERX
  2162                                                                  ELCDTERX
  2163     ADD 1                       TO INDEXCA.                      ELCDTERX
  2164     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2165                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2166     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2167                                                                  ELCDTERX
  2168 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2169                                                                  ELCDTERX
  2170     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2171                                                                  ELCDTERX
  2172     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2173             OR                                                   ELCDTERX
  2174         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2175         GO TO 0005-READ--CARD.                                   ELCDTERX
  2176                                                                  ELCDTERX
  2177     ADD 1                       TO INDEXST.                      ELCDTERX
  2178     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2179                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2180     GO TO 0072-READ--OPST.                                       ELCDTERX
  2181                                                                  ELCDTERX
  2182 0074-READ--OPBS.                                                 ELCDTERX
  2183                                                                  ELCDTERX
  2184     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2185                                                                  ELCDTERX
  2186     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2187             OR                                                   ELCDTERX
  2188         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2189         GO TO 0005-READ--CARD.                                   ELCDTERX
  2190                                                                  ELCDTERX
  2191     ADD 1                       TO INDEXBS.                      ELCDTERX
  2192     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2193     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2194                                                                  ELCDTERX
  2195 0079-READ--EXIT.                                                 ELCDTERX
  2196*    EXIT.                                                        ELCDTERX
  2197******************************************************************ELCDTERX
  2198
  2199     MOVE 0                      TO SAVE-HER-HI-CERT.
  2200     MOVE LIFE-OVERRIDE-L6       TO  HD-9A-LF-OVRD-1
  2201                                     HD-9A-LF-OVRD-2
  2202                                     HD-9A-LF-OVRD-3
  2203                                     HD-9-LF-OVRD-1
  2204                                     HD-9-LF-OVRD-2
  2205                                     HD-9-LF-OVRD-3.
  2206     MOVE AH-OVERRIDE-L6         TO  HD-9A-AH-OVRD-1
  2207                                     HD-9A-AH-OVRD-2
  2208                                     HD-9-AH-OVRD-1
  2209                                     HD-9-AH-OVRD-2
  2210                                     HD-9-AH-OVRD-3.
  2211     MOVE CLAS-REPORT-CD1-CAPTION
  2212                                 TO HD-1-RPT-CD-1
  2213                                    HD-8A-RPT-CD-1-CAPTION.
  2214     MOVE CLAS-REPORT-CD2-CAPTION
  2215                                 TO HD-1-RPT-CD-2
  2216                                    HD-8B-RPT-CD-2-CAPTION.
  2217
  2218     MOVE DTE-CONV-DT            TO CONVERSION-DATE.
  2219     MOVE WS-CURRENT-DATE        TO HD-IPL-DATE.
  2220     MOVE COMPANY-NAME           TO HD-COMPANY-NAME.
  2221     MOVE ALPH-DATE              TO HD-ALPHA-DATE.
  2222
  2223     IF DTE-QTR-CO = '1'
  2224         MOVE '1'                TO QTR-COMP.
  2225     IF PARM-LENGTH > +0
  2226        IF PARM-VALUE = 'SPECIAL'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ECS036.cbl
  2227           MOVE 'SINGLE FEE EQUIVALENT'  TO
  2228                HD-1-ST-SINGLE-FEE
  2229                HD-1-RC1-SINGLE-FEE
  2230                HD-1-RC2-SINGLE-FEE
  2231                HD-1-GRP-SINGLE-FEE
  2232                HD-1-CAR-SINGLE-FEE
  2233                HD-1-BUS-SINGLE-FEE
  2234                HD-1-AGCY-SINGLE-FEE
  2235                HD-1-GT-SINGLE-FEE
  2236                HD-1-US2-SINGLE-FEE
  2237                HD-1-US5-SINGLE-FEE
  2238        END-IF
  2239     END-IF
  2240
  2241     .
  2242 0100-SORT-ROUTINE SECTION.
  2243
  2244     SORT SORT-FILE ASCENDING KEY SORT-CONTROL-74
  2245                       SORT-HI-CERT
  2246         USING EARNED-PREM
  2247         OUTPUT PROCEDURE 0200-PRINT-ROUTINE THRU 9099-EXIT.
  2248
  2249     IF SORT-RETURN NOT = ZEROS
  2250         MOVE '0101'             TO WS-RETURN-CODE
  2251         GO TO ABEND-PGM.
  2252
  2253     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ECS036.cbl
  2255 0200-PRINT-ROUTINE SECTION.
  2256
  2257     OPEN OUTPUT PRNT.
  2258     OPEN OUTPUT SELECT-FILE.
  2259
  2260 0210-CLEAR-CNTRS.
  2261     MOVE ZERO                   TO X1.
  2262     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  2263     MOVE ZERO                   TO X1.
  2264*    PERFORM 0230-ZERO-ACCUM-ACC 13 TIMES.
  2265     PERFORM 0230-ZERO-ACCUM-ACC 15 TIMES.
  2266     MOVE ZERO                   TO X1.
  2267*    PERFORM 0240-ZERO-ACCUM-GRP 13 TIMES.
  2268     PERFORM 0240-ZERO-ACCUM-GRP 15 TIMES.
  2269     MOVE ZERO                   TO X1.
  2270     PERFORM 0250-ZERO-ACCUM-CARR 15 TIMES.
  2271     MOVE ZERO                   TO X1.
  2272     PERFORM 0255-ZERO-ACCUM-STATE 15 TIMES.
  2273     MOVE ZERO                   TO X1.
  2274     PERFORM 0260-ZERO-ACCUM-REPT 15 TIMES.
  2275     MOVE ZERO                   TO X1.
  2276     PERFORM 0270-ZERO-ACCUM-GRAND 15 TIMES.
  2277     MOVE ZERO-GRAND-TOTALS      TO GRAND-TOTALS.
  2278     MOVE ZEROS                  TO EP-CNTL.
  2279     GO TO 0280-FIND-DATE-RANGE.
  2280
  2281 0220-ZERO-PRINT-TABLE.
  2282     ADD +1 TO X1.
  2283     MOVE PRINT-ZERO-TABLE       TO PRINT-TABLE (X1).
  2284
  2285 0230-ZERO-ACCUM-ACC.
  2286     ADD +1 TO X1.
  2287     MOVE ZERO-OCCURS-ACCUM      TO ACCOUNT-ACCUM (X1).
  2288
  2289 0240-ZERO-ACCUM-GRP.
  2290     ADD +1 TO X1.
  2291     MOVE ZERO-OCCURS-ACCUM      TO GROUPING-ACCUM (X1).
  2292
  2293 0250-ZERO-ACCUM-CARR.
  2294     ADD +1 TO X1.
  2295     MOVE ZERO-OCCURS-ACCUM      TO CARRIER-ACCUM (X1).
  2296
  2297 0255-ZERO-ACCUM-STATE.
  2298     ADD +1 TO X1.
  2299     MOVE ZERO-OCCURS-ACCUM      TO STATE-ACCUM (X1).
  2300
  2301 0256-ZERO-ACCUM-REPT2.
  2302     ADD +1 TO X1.
  2303     MOVE ZERO-OCCURS-ACCUM      TO REPTCD2-ACCUM (X1).
  2304
  2305 0260-ZERO-ACCUM-REPT.
  2306     ADD +1 TO X1.
  2307     MOVE ZERO-OCCURS-ACCUM      TO REPTCD-ACCUM (X1).
  2308
  2309 0270-ZERO-ACCUM-GRAND.
  2310     ADD +1 TO X1.
  2311     MOVE ZERO-OCCURS-ACCUM      TO GRAND-ACCUM (X1).
  2312
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ECS036.cbl
  2313 0280-FIND-DATE-RANGE.
  2314     IF QTR-CO
  2315         IF RUN-MO = 03 OR 06 OR 09 OR 12
  2316             MOVE '1'            TO QTR-SW.
  2317
  2318     MOVE RUN-MO                 TO RUN-DT-MO.
  2319     MOVE RUN-CCYY               TO RUN-DT-CCYY.
  2320     MOVE +1                     TO X1.
  2321     MOVE +0                     TO Y1.
  2322
  2323     IF QTR-CO AND QTR-END
  2324         MOVE 'QUARTERLY'        TO HD-1-AGCY HD-1-ST HD-1-GRP
  2325                                    HD-1-CAR HD-1-BUS HD-1-RC-1
  2326                                    HD-1-RC-2
  2327         COMPUTE COMPARE9DT (X1) = RUN9DT - 300
  2328     ELSE
  2329         COMPUTE COMPARE9DT (X1) = RUN9DT - 100.
  2330
  2331     COMPUTE YEAR-OLD-DATE = RUN9DT - 100.
  2332     COMPUTE TWO-YEARS-AGO = RUN9DT - 200
  2333
  2334     IF DTE-CLIENT = 'AFL'
  2335         MOVE 06                  TO FISCAL-MO
  2336         IF RUN-MO GREATER 06
  2337            MOVE RUN-CCYY       TO FISCAL-CCYY
  2338         ELSE
  2339            COMPUTE FISCAL-CCYY = RUN-CCYY - 1.
  2340
  2341 0290-BUILD-DATE-TABLE.
  2342
  2343     IF (COMP-MO (X1) = 12)
  2344        AND (TWO-YEAR-ENDS-AGO = ZEROS)
  2345        COMPUTE TWO-YEAR-ENDS-AGO = COMPARE9DT (X1) - 100
  2346        MOVE COMPARE9DT (X1)     TO YEAR-END-DT
  2347     END-IF
  2348
  2349     ADD +1 TO X1 Y1.
  2350
  2351     IF X1 GREATER +13
  2352        MOVE TWO-YEARS-AGO       TO COMPARE9DT (14)
  2353        MOVE TWO-YEAR-ENDS-AGO   TO COMPARE9DT (15)
  2354        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  2355           X1 > 15
  2356           MOVE X1               TO DISP-X1
  2357           DISPLAY ' COMPARE DATE ' DISP-X1 ' ' COMPARE9DT (X1)
  2358        END-PERFORM
  2359        DISPLAY ' YEAR END DATE ' YEAR-END-DT
  2360        GO TO 0310-READ-EARNED-PREM-EXTRACT
  2361     END-IF
  2362
  2363     IF QTR-CO AND QTR-END
  2364         COMPUTE COMPARE9DT (X1) = COMPARE9DT (Y1) + 0003
  2365     ELSE
  2366         COMPUTE COMPARE9DT (X1) = COMPARE9DT (Y1) + 0001.
  2367
  2368     IF COMP-MO (X1) GREATER 12
  2369         COMPUTE COMPARE9DT (X1) = COMPARE9DT (X1) + 0088.
  2370
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ECS036.cbl
  2371     GO TO 0290-BUILD-DATE-TABLE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ECS036.cbl
  2373 0310-READ-EARNED-PREM-EXTRACT.
  2374     RETURN SORT-FILE INTO WS-EXTR-REC
  2375                          AT END MOVE '1' TO EOF-EPX
  2376                                 GO TO 1500-PASS-NUMBER-CHANGE.
  2377     IF DTE-FMT-OPT = 2
  2378         IF EP-PASS-NO NOT = '1'
  2379             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2380
  2381     IF DTE-FMT-OPT = 3
  2382         IF EP-PASS-NO NOT = '2'
  2383             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2384
  2385     IF DTE-FMT-OPT = 4
  2386         IF EP-PASS-NO NOT = '3'
  2387             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2388
  2389     IF DTE-FMT-OPT = 5
  2390         IF EP-PASS-NO NOT = '4'
  2391             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2392
  2393     IF DTE-FMT-OPT = 6
  2394         IF EP-PASS-NO NOT = '5'
  2395             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2396
  2397     IF FIRST-TIME
  2398         MOVE EP-PASS-NO         TO PASS-NUMBER
  2399         MOVE 'N'                TO FIRST-TIME-SWITCH
  2400         GO TO 0340-ACCUMULATE.
  2401
  2402 0320-CHECK-EXTRACT-SEQ.
  2403     IF EP-PASS-NO NOT = PASS-NUMBER
  2404         GO TO 1500-PASS-NUMBER-CHANGE.
  2405
  2406     IF EP-CNTL LESS THAN SAVE-EPX
  2407         DISPLAY 'EARNED PREMIUM EXTRACT OUT OF SEQUENCE'
  2408         DISPLAY 'SAVE = ' SAVE-EPX
  2409         DISPLAY 'READ = ' EP-CNTL
  2410         MOVE '0610'             TO WS-RETURN-CODE
  2411         GO TO ABEND-PGM.
  2412
  2413 0330-COMPARE-RECORDS.
  2414     IF PASS-NUMBER = '1'
  2415         IF S-EPX-CNTL-1 NOT = EP-CNTL-1
  2416             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2417             GO TO 0340-ACCUMULATE.
  2418
  2419     IF PASS-NUMBER = '3'
  2420         IF S-EPX-CNTL-ACCT NOT = HIGH-VALUES
  2421             IF S-EPX-CNTL-ACCT = EP-CNTL-ACCT  AND
  2422                S-EPX-CNTL-2    = EP-CNTL-2
  2423                 NEXT SENTENCE
  2424             ELSE
  2425                 PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2426                 GO TO 0340-ACCUMULATE.
  2427
  2428     IF PASS-NUMBER = '4'
  2429         IF DTE-TOT-OPT = 1 OR 3 OR 6
  2430             GO TO 0310-READ-EARNED-PREM-EXTRACT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ECS036.cbl
  2431         ELSE
  2432             IF DTE-TOT-OPT = 5 OR 7
  2433                 IF EP-CNTL NOT = SAVE-CNTL
  2434                     PERFORM 0700-REPTCD-BREAK
  2435                         THRU 0790-ZERO-REPTCD.
  2436
  2437     IF PASS-NUMBER = '5'
  2438         IF DTE-TOT-OPT = 1 OR 2 OR 5
  2439             GO TO 0310-READ-EARNED-PREM-EXTRACT
  2440         ELSE
  2441             IF DTE-TOT-OPT = 6 OR 7
  2442                 IF EP-CNTL NOT = SAVE-CNTL
  2443                     PERFORM 0700-REPTCD-BREAK
  2444                         THRU 0790-ZERO-REPTCD.
  2445
  2446     IF PASS-NUMBER = '6'
  2447         IF DTE-TOT-OPT = 1 OR 3 OR 6
  2448             GO TO 0310-READ-EARNED-PREM-EXTRACT
  2449         ELSE
  2450             IF DTE-TOT-OPT = 5 OR 7
  2451                 IF EP-CNTL NOT = SAVE-CNTL
  2452                     PERFORM 0700-REPTCD-BREAK
  2453                         THRU 0790-ZERO-REPTCD.
  2454
  2455     IF PASS-NUMBER = '4'
  2456       IF S-EPX-A-RPT-CD-1 = EP-A-RPT-CD-1
  2457         GO TO 0340-ACCUMULATE
  2458        ELSE
  2459         MOVE '1'            TO  SKIP-HD-SW
  2460         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2461         GO TO 0340-ACCUMULATE.
  2462
  2463     IF PASS-NUMBER = '6'
  2464       IF S-EPX-A-RPT-CD-1 = EP-A-RPT-CD-1
  2465         GO TO 0340-ACCUMULATE
  2466        ELSE
  2467         MOVE '1'            TO  SKIP-HD-SW
  2468         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2469         GO TO 0340-ACCUMULATE.
  2470
  2471     IF PASS-NUMBER = '7'
  2472       IF S-EPX-A-RPT-CD-1 = EP-A-RPT-CD-1
  2473         IF S-EPX-A-RPT-CD-2 = EP-A-RPT-CD-2
  2474            IF EP-CNTL = SAVE-CNTL
  2475               GO TO 0340-ACCUMULATE
  2476            ELSE
  2477               MOVE ' '     TO  SKIP-HD-SW
  2478               PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2479               GO TO 0340-ACCUMULATE
  2480            END-IF
  2481         ELSE
  2482             MOVE ' '        TO  SKIP-HD-SW
  2483             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2484             MOVE '1'        TO  SKIP-HD-SW
  2485             PERFORM 1700-REPTCD2-BREAK THRU 1790-ZERO-REPTCD2
  2486             GO TO 0340-ACCUMULATE
  2487         END-IF
  2488       ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ECS036.cbl
  2489         MOVE ' '            TO  SKIP-HD-SW
  2490         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2491         MOVE '1'        TO  SKIP-HD-SW
  2492         PERFORM 1700-REPTCD2-BREAK THRU 1790-ZERO-REPTCD2
  2493         MOVE '2'            TO  SKIP-HD-SW
  2494         PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  2495         GO TO 0340-ACCUMULATE
  2496       END-IF
  2497     END-IF.
  2498
  2499
  2500     IF PASS-NUMBER = '5'
  2501     IF S-EPX-A-CARR NOT = EP-A-CARR
  2502         MOVE '1'            TO  SKIP-HD-SW
  2503         PERFORM 0600-CARRIER-BREAK THRU 0680-ZERO-CARRIER
  2504         GO TO 0340-ACCUMULATE.
  2505
  2506     IF PASS-NUMBER = '5'
  2507     IF S-EPX-A-GROUP NOT = EP-A-GROUP
  2508         MOVE '1'            TO  SKIP-HD-SW
  2509         PERFORM 0500-GROUPING-BREAK THRU 0580-ZERO-GROUPING
  2510         GO TO 0340-ACCUMULATE.
  2511
  2512     IF PASS-NUMBER = '5'
  2513         IF S-EPX-A-CARR     = EP-A-CARR  AND
  2514            S-EPX-A-GROUP    = EP-A-GROUP AND
  2515            S-EPX-A-RPT-CD-2 = EP-A-RPT-CD-2
  2516            IF S-EPX-A-STATE = EP-A-STATE
  2517             GO TO 0340-ACCUMULATE
  2518           ELSE
  2519             MOVE '1'            TO  SKIP-HD-SW
  2520             PERFORM 0375-STATE-BREAK THRU 0380-ZERO-STATE
  2521             MOVE ' '            TO  SKIP-HD-SW
  2522             GO TO 0340-ACCUMULATE
  2523         ELSE
  2524             MOVE '1'            TO  SKIP-HD-SW
  2525             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2526             GO TO 0340-ACCUMULATE.
  2527
  2528 0335-NOT-5.
  2529     IF S-EPX-CNTL-1 NOT = EP-CNTL-1
  2530         PERFORM 0600-CARRIER-BREAK THRU 0680-ZERO-CARRIER
  2531         GO TO 0340-ACCUMULATE.
  2532
  2533     IF S-EPX-CARR NOT = EP-CARR
  2534         PERFORM 0500-GROUPING-BREAK THRU 0580-ZERO-GROUPING
  2535         GO TO 0340-ACCUMULATE.
  2536
  2537     IF S-EPX-GRP NOT = EP-GROUP
  2538         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  2539
  2540 0340-ACCUMULATE.
  2541     MOVE +0                     TO X1.
  2542
  2543 0350-ACCUMULATE-B.
  2544     ADD +1 TO X1.
  2545
  2546     IF X1 GREATER 15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ECS036.cbl
  2547*    IF X1 GREATER 13
  2548*        DISPLAY 'DATE TABLE ERROR OR EP-RUN-DATE ERROR'
  2549*        DISPLAY 'EP-DATE ' EP-DTE
  2550*        DISPLAY 'RUN-DT  ' RUN-DT
  2551*        DISPLAY 'COMPARE-DATE-TABLE ' COMPARE-DATE-TABLE
  2552*        MOVE '0301'             TO WS-RETURN-CODE
  2553*        GO TO ABEND-PGM.
  2554         GO TO 0310-READ-EARNED-PREM-EXTRACT
  2555     END-IF
  2556
  2557     IF COMPARE9DT (X1) NOT = EP-DTE
  2558         GO TO 0350-ACCUMULATE-B.
  2559
  2560     IF EP-MTH-HI-CERT  GREATER  AC-DATE (X1)
  2561         MOVE EP-MTH-HI-CERT     TO  AC-DATE (X1)
  2562                                     AC-DATE-R(X1).
  2563
  2564     ADD EP-CERT                 TO  AC-CERT (X1)  RP-CERT (X1)
  2565                                     RP2-CERT (X1)
  2566                                     ST-CERT (X1).
  2567     ADD EP-ISS-CNT              TO  AC-ISS  (X1)  RP-ISS  (X1)
  2568                                     RP2-ISS (X1)
  2569                                     ST-ISS  (X1).
  2570     ADD EP-LBEN                 TO  AC-LBEN (X1)  RP-LBEN (X1)
  2571                                     RP2-LBEN (X1)
  2572                                     ST-LBEN (X1).
  2573     ADD EP-LPRM                 TO  AC-LPRM (X1)  RP-LPRM (X1)
  2574                                     RP2-LPRM (X1)
  2575                                     ST-LPRM (X1).
  2576     ADD EP-LCLM                 TO  AC-LCLM (X1)  RP-LCLM (X1)
  2577                                     RP2-LCLM (X1)
  2578                                     ST-LCLM (X1).
  2579     ADD EP-ABEN                 TO  AC-ABEN (X1)  RP-ABEN (X1)
  2580                                     RP2-ABEN (X1)
  2581                                     ST-ABEN (X1).
  2582     ADD EP-APRM                 TO  AC-APRM (X1)  RP-APRM (X1)
  2583                                     RP2-APRM (X1)
  2584                                     ST-APRM (X1).
  2585     ADD EP-ACLM                 TO  AC-ACLM (X1)  RP-ACLM (X1)
  2586                                     RP2-ACLM (X1)
  2587                                     ST-ACLM (X1).
  2588     ADD EP-TPRM                 TO  AC-TPRM (X1)  RP-TPRM (X1)
  2589                                     RP2-TPRM (X1)
  2590                                     ST-TPRM (X1).
  2591     ADD EP-TCOM                 TO  AC-TCOM (X1)  RP-TCOM (X1)
  2592                                     RP2-TCOM (X1)
  2593                                     ST-TCOM (X1).
  2594     MOVE EP-CNTL                TO SAVE-EPX.
  2595     EVALUATE EP-ACCT-STATUS
  2596        WHEN 'A'
  2597           MOVE 'ACTIVE'         TO SAVE-ACCT-STATUS
  2598        WHEN 'I'
  2599           MOVE 'INACTIVE'       TO SAVE-ACCT-STATUS
  2600        WHEN 'T'
  2601           MOVE 'TRANSFERRED'    TO SAVE-ACCT-STATUS
  2602        WHEN 'C'
  2603           MOVE 'CANCELLED'      TO SAVE-ACCT-STATUS
  2604        WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ECS036.cbl
  2605           MOVE 'UNKNOWN'        TO SAVE-ACCT-STATUS
  2606     END-EVALUATE
  2607
  2608     MOVE EP-ACCT-NAME           TO SAVE-ACCT-NAME.
  2609     MOVE EP-ACCT-CITY           TO SAVE-ACCT-CITY.
  2610     MOVE EP-ACC-EXPIRES         TO SAVE-AM-EXPIRES.
  2611     MOVE EP-ACC-HI-CERT         TO SAVE-AM-HI-CERT.
  2612
  2613     IF X1 < +15
  2614        GO TO 0350-ACCUMULATE-B
  2615     END-IF
  2616
  2617     GO TO 0310-READ-EARNED-PREM-EXTRACT
  2618
  2619     .
  2620 0375-STATE-BREAK.
  2621     MOVE +0                     TO X1.
  2622     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  2623     PERFORM 0800-PRINT-DECISION THRU 0899-EXIT.
  2624
  2625     MOVE 'TOTALS'               TO STATE-TOTAL-LINE.
  2626
  2627     IF P-ST-SW = '1'
  2628         MOVE ' '                TO P-ST-SW
  2629     ELSE
  2630         IF DTE-CLIENT  =  'NCL'
  2631             MOVE SPACES         TO  STATE-TOTAL-LINE
  2632             GO TO 0380-ZERO-STATE
  2633         ELSE
  2634             GO TO 0380-ZERO-STATE.
  2635
  2636     PERFORM 0900-HEAD-RTN  THRU 0999-EXIT.
  2637     MOVE +1                     TO X1.
  2638     MOVE +0                     TO Y1.
  2639
  2640 0375-STATE-BREAK-PRINT.
  2641     ADD +1 TO X1 Y1.
  2642
  2643     IF X1 GREATER THAN 13
  2644         GO TO 0375-PRINT-LAST-ST-12.
  2645
  2646     COMPUTE CERT = ST-CERT (X1) - ST-CERT (Y1).
  2647     COMPUTE ISS  = ST-ISS  (X1) - ST-ISS  (Y1).
  2648     COMPUTE LBEN = ST-LBEN (X1) - ST-LBEN (Y1).
  2649     COMPUTE LPRM = ST-LPRM (X1) - ST-LPRM (Y1).
  2650     COMPUTE LCLM = ST-LCLM (X1) - ST-LCLM (Y1).
  2651     COMPUTE ABEN = ST-ABEN (X1) - ST-ABEN (Y1).
  2652     COMPUTE APRM = ST-APRM (X1) - ST-APRM (Y1).
  2653     COMPUTE ACLM = ST-ACLM (X1) - ST-ACLM (Y1).
  2654     COMPUTE TCOM = ST-TCOM (X1) - ST-TCOM (Y1).
  2655     COMPUTE TPRM = LPRM + APRM.
  2656
  2657     MOVE COMP-YR (X1)           TO DET-YR.
  2658     MOVE COMP-MO (X1)           TO DET-MO.
  2659
  2660     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  2661
  2662     MOVE CERT                   TO DET-CERTS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ECS036.cbl
  2663     MOVE LBEN                   TO DET-LBEN.
  2664     MOVE LPRM                   TO DET-LPRM.
  2665     MOVE LCLM                   TO DET-LCLM.
  2666     MOVE ABEN                   TO DET-ABEN.
  2667     MOVE APRM                   TO DET-APRM.
  2668     MOVE ACLM                   TO DET-ACLM.
  2669     MOVE TPRM                   TO DET-TPRM.
  2670     MOVE TCOM                   TO DET-TCOM.
  2671
  2672     IF COMP-YR (X1) = CONV-YR AND
  2673        COMP-MO (X1) = CONV-MO
  2674         MOVE ZEROS TO DET-CERTS DET-LBEN DET-LPRM
  2675                       DET-ABEN  DET-APRM DET-LCLM
  2676                       DET-ACLM  DET-TPRM DET-TCOM
  2677     ELSE
  2678         PERFORM 0385-ADD-TO-OTHERS THRU 0385-EXIT.
  2679
  2680     MOVE DETAIL-LINE            TO P-DATA.
  2681
  2682     IF X1 = 2
  2683         MOVE '0'                TO X
  2684     ELSE
  2685         MOVE ' '                TO X.
  2686
  2687     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  2688     GO TO 0375-STATE-BREAK-PRINT.
  2689
  2690 0375-PRINT-LAST-ST-12.
  2691     MOVE L12ST-LBEN             TO DET-LBEN.
  2692     MOVE L12ST-LPRM             TO DET-LPRM.
  2693     MOVE L12ST-LCLM             TO DET-LCLM.
  2694     MOVE L12ST-ABEN             TO DET-ABEN.
  2695     MOVE L12ST-APRM             TO DET-APRM.
  2696     MOVE L12ST-ACLM             TO DET-ACLM.
  2697     MOVE L12ST-TPRM             TO DET-TPRM.
  2698     MOVE L12ST-TCOM             TO DET-TCOM.
  2699     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  2700
  2701     MOVE '0'                    TO X.
  2702     MOVE DETAIL-LINE            TO P-DATA.
  2703     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  2704
  2705*  PRINT PRIOR L12
  2706
  2707*    MOVE PL12ST-LBEN             TO DET-LBEN
  2708*    MOVE PL12ST-LPRM             TO DET-LPRM
  2709*    MOVE PL12ST-LCLM             TO DET-LCLM
  2710*    MOVE PL12ST-ABEN             TO DET-ABEN
  2711*    MOVE PL12ST-APRM             TO DET-APRM
  2712*    MOVE PL12ST-ACLM             TO DET-ACLM
  2713*    MOVE PL12ST-TPRM             TO DET-TPRM
  2714*    MOVE PL12ST-TCOM             TO DET-TCOM
  2715*    MOVE 'PRIOR L12         '   TO DET-TITLE
  2716*    MOVE ' '                    TO X
  2717*    MOVE DETAIL-LINE            TO P-DATA
  2718*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  2719     .
  2720 0375-PRINT-ST-YTD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ECS036.cbl
  2721     MOVE YTDST-LBEN             TO DET-LBEN.
  2722     MOVE YTDST-LPRM             TO DET-LPRM.
  2723     MOVE YTDST-LCLM             TO DET-LCLM.
  2724     MOVE YTDST-ABEN             TO DET-ABEN.
  2725     MOVE YTDST-APRM             TO DET-APRM.
  2726     MOVE YTDST-ACLM             TO DET-ACLM.
  2727     MOVE YTDST-TPRM             TO DET-TPRM.
  2728     MOVE YTDST-TCOM             TO DET-TCOM.
  2729     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  2730     MOVE ' '                    TO X.
  2731     MOVE DETAIL-LINE            TO P-DATA.
  2732     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  2733     MOVE SPACES                 TO DET-TITLE.
  2734
  2735*  PRINT PRIOR YTD
  2736
  2737     MOVE PYTDST-LBEN             TO DET-LBEN
  2738     MOVE PYTDST-LPRM             TO DET-LPRM
  2739     MOVE PYTDST-LCLM             TO DET-LCLM
  2740     MOVE PYTDST-ABEN             TO DET-ABEN
  2741     MOVE PYTDST-APRM             TO DET-APRM
  2742     MOVE PYTDST-ACLM             TO DET-ACLM
  2743     MOVE PYTDST-TPRM             TO DET-TPRM
  2744     MOVE PYTDST-TCOM             TO DET-TCOM
  2745     MOVE 'PRIOR YTD         '   TO DET-TITLE
  2746     MOVE ' '                    TO X
  2747     MOVE DETAIL-LINE            TO P-DATA
  2748     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  2749     MOVE SPACES                 TO DET-TITLE
  2750     .
  2751 0376-PRINT-ST-ITD.
  2752
  2753*    MOVE ITDST-LBEN             TO DET-LBEN
  2754*    MOVE ITDST-LPRM             TO DET-LPRM
  2755*    MOVE ITDST-LCLM             TO DET-LCLM
  2756*    MOVE ITDST-ABEN             TO DET-ABEN
  2757*    MOVE ITDST-APRM             TO DET-APRM
  2758*    MOVE ITDST-ACLM             TO DET-ACLM
  2759*    MOVE ITDST-TPRM             TO DET-TPRM
  2760*    MOVE ITDST-TCOM             TO DET-TCOM
  2761*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE
  2762*    MOVE ' '                    TO X
  2763*    MOVE DETAIL-LINE            TO P-DATA
  2764*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  2765
  2766     MOVE SPACES                 TO DET-TITLE
  2767
  2768     MOVE ZERO-ACCUM             TO LAST-12-STATE-ACCUM
  2769                                    YTD-STATE-ACCUM
  2770*                                   ITD-STATE-ACCUM
  2771                                    PYTD-STATE-ACCUM
  2772*                                   PL12-STATE-ACCUM
  2773     .
  2774 0380-ZERO-STATE.
  2775     MOVE +0                     TO X1.
  2776     PERFORM 0255-ZERO-ACCUM-STATE 15 TIMES.
  2777
  2778 0380-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ECS036.cbl
  2779     GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2780
  2781 0385-ADD-TO-OTHERS.
  2782
  2783*  THIS IS COMPARING THE HIGH CERT DATE
  2784     IF AC-DATE (X1)  GREATER  GP-DATE (Y1)
  2785         MOVE AC-DATE (X1)       TO  GP-DATE (Y1)
  2786                                     GP-DATE-R(Y1).
  2787
  2788     IF AC-DATE (X1)  GREATER  CA-DATE (Y1)
  2789         MOVE AC-DATE (X1)       TO  CA-DATE (Y1)
  2790                                     CA-DATE-R(Y1).
  2791
  2792     IF AC-DATE (X1)  GREATER  RP-DATE (Y1)
  2793         MOVE AC-DATE (X1)       TO  RP-DATE (Y1)
  2794                                     RP-DATE-R (Y1).
  2795
  2796
  2797     IF AC-DATE (X1)  GREATER  GT-DATE (Y1)
  2798         MOVE AC-DATE (X1)       TO  GT-DATE (Y1)
  2799                                     GT-DATE-R (Y1).
  2800
  2801     IF COMPARE9DT (X1) GREATER YEAR-OLD-DATE
  2802         ADD LBEN TO L12ST-LBEN
  2803         ADD LPRM TO L12ST-LPRM
  2804         ADD LCLM TO L12ST-LCLM
  2805         ADD ABEN TO L12ST-ABEN
  2806         ADD APRM TO L12ST-APRM
  2807         ADD ACLM TO L12ST-ACLM
  2808         ADD TPRM TO L12ST-TPRM
  2809         ADD TCOM TO L12ST-TCOM.
  2810
  2811     IF RUN-YR = COMP-YR (X1)
  2812         ADD LBEN TO YTDST-LBEN
  2813         ADD LPRM TO YTDST-LPRM
  2814                     YTDST-TPRM
  2815         ADD LCLM TO YTDST-LCLM
  2816         ADD TCOM TO YTDST-TCOM
  2817         ADD ABEN TO YTDST-ABEN
  2818         ADD APRM TO YTDST-APRM
  2819                     YTDST-TPRM
  2820         ADD ACLM TO YTDST-ACLM.
  2821
  2822*    IF X1 = 13
  2823*       COMPUTE ITDST-LBEN = ITDST-LBEN + ST-LBEN (X1)
  2824*       COMPUTE ITDST-LPRM = ITDST-LPRM + ST-LPRM (X1)
  2825*       COMPUTE ITDST-LCLM = ITDST-LCLM + ST-LCLM (X1)
  2826*       COMPUTE ITDST-ABEN = ITDST-ABEN + ST-ABEN (X1)
  2827*       COMPUTE ITDST-APRM = ITDST-APRM + ST-APRM (X1)
  2828*       COMPUTE ITDST-ACLM = ITDST-ACLM + ST-ACLM (X1)
  2829*       COMPUTE ITDST-TPRM = ITDST-TPRM + ST-TPRM (X1)
  2830*       COMPUTE ITDST-TCOM = ITDST-TCOM + ST-TCOM (X1)
  2831*    END-IF
  2832
  2833     IF X1 = 13
  2834        COMPUTE PYTDST-LBEN = PYTDST-LBEN +
  2835           (ST-LBEN (1) - ST-LBEN (15))
  2836        COMPUTE PYTDST-LPRM = PYTDST-LPRM +
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ECS036.cbl
  2837           (ST-LPRM (1) - ST-LPRM (15))
  2838        COMPUTE PYTDST-LCLM = PYTDST-LCLM +
  2839           (ST-LCLM (1) - ST-LCLM (15))
  2840        COMPUTE PYTDST-ABEN = PYTDST-ABEN +
  2841           (ST-ABEN (1) - ST-ABEN (15))
  2842        COMPUTE PYTDST-APRM = PYTDST-APRM +
  2843           (ST-APRM (1) - ST-ABEN (15))
  2844        COMPUTE PYTDST-ACLM = PYTDST-ACLM +
  2845           (ST-ACLM (1) - ST-ACLM (15))
  2846        COMPUTE PYTDST-TPRM = PYTDST-TPRM +
  2847           (ST-TPRM (1) - ST-TPRM (15))
  2848        COMPUTE PYTDST-TCOM = PYTDST-TCOM +
  2849           (ST-TCOM (1) - ST-TCOM (15))
  2850     END-IF
  2851
  2852*    IF X1 = 13
  2853*       COMPUTE PL12ST-LBEN = PL12ST-LBEN +
  2854*          (ST-LBEN (1) - ST-LBEN (14))
  2855*       COMPUTE PL12ST-LPRM = PL12ST-LPRM +
  2856*          (ST-LPRM (1) - ST-LPRM (14))
  2857*       COMPUTE PL12ST-LCLM = PL12ST-LCLM +
  2858*          (ST-LCLM (1) - ST-LCLM (14))
  2859*       COMPUTE PL12ST-ABEN = PL12ST-ABEN +
  2860*          (ST-ABEN (1) - ST-ABEN (14))
  2861*       COMPUTE PL12ST-APRM = PL12ST-APRM +
  2862*          (ST-APRM (1) - ST-ABEN (14))
  2863*       COMPUTE PL12ST-ACLM = PL12ST-ACLM +
  2864*          (ST-ACLM (1) - ST-ACLM (14))
  2865*       COMPUTE PL12ST-TPRM = PL12ST-TPRM +
  2866*          (ST-TPRM (1) - ST-TPRM (14))
  2867*       COMPUTE PL12ST-TCOM = PL12ST-TCOM +
  2868*          (ST-TCOM (1) - ST-TCOM (14))
  2869*    END-IF
  2870
  2871     .
  2872 0385-EXIT.
  2873      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ECS036.cbl
  2875 0400-ACCOUNT-BREAK.
  2876     IF PASS-NUMBER = '5'
  2877         PERFORM 0375-STATE-BREAK THRU 0380-ZERO-STATE.
  2878
  2879     MOVE +0                     TO X1.
  2880     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  2881     PERFORM 0800-PRINT-DECISION THRU 0899-EXIT.
  2882
  2883     IF P-ACC-SW = '1'
  2884         MOVE ' '                TO  P-ACC-SW
  2885     ELSE
  2886         GO TO 0495-ZERO-ACCOUNT.
  2887
  2888     IF PASS-NUMBER = '5'
  2889        IF DTE-CLIENT  =  'NCL'
  2890            MOVE S-EPX-A-STATE   TO SAVE-STATE
  2891        ELSE
  2892            MOVE S-EPX-A-STATE   TO SAVE-STATE
  2893            MOVE ' '             TO S-EPX-A-STATE.
  2894
  2895     PERFORM 0900-HEAD-RTN  THRU 0999-EXIT.
  2896
  2897     IF PASS-NUMBER = '5'
  2898         MOVE SAVE-STATE         TO S-EPX-A-STATE.
  2899
  2900     MOVE +1                     TO X1.
  2901     MOVE +0                     TO Y1.
  2902
  2903 0410-ACCOUNT-BREAK-PRINT.
  2904     ADD +1                      TO X1 Y1.
  2905
  2906     IF X1 GREATER THAN 13
  2907         GO TO 0460-PRINT-LAST-AC-12.
  2908
  2909     MOVE AC-DATE (X1)           TO  SAVE-HER-HI-CERT.
  2910
  2911     COMPUTE CERT = AC-CERT (X1) - AC-CERT (Y1).
  2912     COMPUTE ISS  = AC-ISS  (X1) - AC-ISS  (Y1).
  2913     COMPUTE LBEN = AC-LBEN (X1) - AC-LBEN (Y1).
  2914     COMPUTE LPRM = AC-LPRM (X1) - AC-LPRM (Y1).
  2915     COMPUTE LCLM = AC-LCLM (X1) - AC-LCLM (Y1).
  2916     COMPUTE ABEN = AC-ABEN (X1) - AC-ABEN (Y1).
  2917     COMPUTE APRM = AC-APRM (X1) - AC-APRM (Y1).
  2918     COMPUTE ACLM = AC-ACLM (X1) - AC-ACLM (Y1).
  2919     COMPUTE TCOM = AC-TCOM (X1) - AC-TCOM (Y1).
  2920     COMPUTE TPRM = LPRM + APRM.
  2921
  2922     IF DTE-CLIENT = 'HER'
  2923         MOVE COMP-YR (X1)       TO  DET-YR-2
  2924         MOVE COMP-MO (X1)       TO  DET-MO-2
  2925     ELSE
  2926         MOVE COMP-YR (X1)       TO  DET-YR
  2927         MOVE COMP-MO (X1)       TO  DET-MO.
  2928
  2929     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  2930
  2931     IF DTE-CLIENT = 'HER'
  2932         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ECS036.cbl
  2933     ELSE
  2934         GO TO 0420-CONTINUE.
  2935
  2936     IF (CERT = ZEROS
  2937        OR ISS EQUAL ZEROS)
  2938         MOVE SPACES             TO  DET-FILL
  2939     ELSE
  2940         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  2941         MOVE '/'                TO  DET-HI-SLASH
  2942         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  2943         MOVE 0                  TO  SAVE-HER-HI-CERT.
  2944
  2945     MOVE CERT                   TO  DET-CERTS-2.
  2946     MOVE ISS                    TO  DET-ISS-COUNT-2.
  2947     MOVE LBEN                   TO  DET-LBEN-2.
  2948     MOVE LPRM                   TO  DET-LPRM-2.
  2949     MOVE LCLM                   TO  DET-LCLM-2.
  2950     MOVE APRM                   TO  DET-APRM-2.
  2951     MOVE ACLM                   TO  DET-ACLM-2.
  2952     MOVE TPRM                   TO  DET-TPRM-2.
  2953     MOVE TCOM                   TO  DET-TCOM-2.
  2954
  2955     IF COMP-YR (X1) = CONV-YR AND
  2956        COMP-MO (X1) = CONV-MO
  2957         MOVE ZEROS              TO  DET-CERTS-2  DET-LBEN-2
  2958                                     DET-LPRM-2   DET-LCLM-2
  2959                                     DET-APRM-2   DET-ACLM-2
  2960                                     DET-TPRM-2   DET-TCOM-2
  2961                                     DET-ISS-COUNT-2
  2962     ELSE
  2963         PERFORM 0430-ADD-TO-OTHERS  THRU  0450-EXIT.
  2964
  2965     MOVE DETAIL-LINE-2          TO  P-DATA.
  2966
  2967     IF X1  =  2
  2968         MOVE '0'                TO  X
  2969     ELSE
  2970         MOVE ' '                TO  X.
  2971
  2972     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  2973
  2974     GO TO 0410-ACCOUNT-BREAK-PRINT.
  2975
  2976 0420-CONTINUE.
  2977     MOVE CERT                   TO DET-CERTS.
  2978     MOVE LBEN                   TO DET-LBEN.
  2979     MOVE LPRM                   TO DET-LPRM.
  2980     MOVE LCLM                   TO DET-LCLM.
  2981     MOVE ABEN                   TO DET-ABEN.
  2982     MOVE APRM                   TO DET-APRM.
  2983     MOVE ACLM                   TO DET-ACLM.
  2984     MOVE TPRM                   TO DET-TPRM.
  2985     MOVE TCOM                   TO DET-TCOM.
  2986
  2987     IF COMP-YR (X1) = CONV-YR AND
  2988        COMP-MO (X1) = CONV-MO
  2989         MOVE ZEROS TO DET-CERTS DET-LBEN DET-LPRM
  2990                       DET-ABEN DET-APRM DET-LCLM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ECS036.cbl
  2991                       DET-ACLM DET-TPRM DET-TCOM
  2992       ELSE
  2993         PERFORM 0430-ADD-TO-OTHERS THRU 0450-EXIT.
  2994
  2995     MOVE DETAIL-LINE            TO P-DATA.
  2996
  2997     IF X1 = 2
  2998         MOVE '0'                TO X
  2999     ELSE
  3000         MOVE ' '                TO X.
  3001
  3002     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3003     GO TO 0410-ACCOUNT-BREAK-PRINT.
  3004
  3005 0430-ADD-TO-OTHERS.
  3006     IF PASS-NUMBER = '3'
  3007         IF S-EPX-CNTL-ACCT NOT = HIGH-VALUES
  3008             GO TO 0440-ADD-CONTINUE.
  3009
  3010     IF BIN-AC-DATE   GREATER  BIN-GP-DATE
  3011         MOVE AC-DATE (X1)       TO  GP-DATE (Y1)
  3012                                     GP-DATE-R (Y1).
  3013
  3014     IF BIN-AC-DATE   GREATER  BIN-CA-DATE
  3015         MOVE AC-DATE (X1)       TO  CA-DATE (Y1)
  3016                                     CA-DATE-R (Y1).
  3017
  3018     IF BIN-AC-DATE   GREATER  BIN-RP-DATE
  3019         MOVE AC-DATE (X1)       TO  RP-DATE (Y1)
  3020                                     RP-DATE-R (Y1).
  3021
  3022     IF BIN-AC-DATE   GREATER  BIN-GT-DATE
  3023         MOVE AC-DATE (X1)       TO  GT-DATE (Y1)
  3024                                     GT-DATE-R (Y1).
  3025
  3026     ADD CERT TO GP-CERT (Y1) CA-CERT (Y1) GR-CERT GT-CERT (Y1).
  3027     ADD ISS  TO GP-ISS  (Y1) CA-ISS  (Y1) GR-ISS  GT-ISS  (Y1).
  3028     ADD LBEN TO GP-LBEN (Y1) CA-LBEN (Y1) GR-LBEN GT-LBEN (Y1).
  3029     ADD LPRM TO GP-LPRM (Y1) CA-LPRM (Y1) GR-LPRM GT-LPRM (Y1).
  3030     ADD LCLM TO GP-LCLM (Y1) CA-LCLM (Y1) GR-LCLM GT-LCLM (Y1).
  3031     ADD ABEN TO GP-ABEN (Y1) CA-ABEN (Y1) GR-ABEN GT-ABEN (Y1).
  3032     ADD APRM TO GP-APRM (Y1) CA-APRM (Y1) GR-APRM GT-APRM (Y1).
  3033     ADD ACLM TO GP-ACLM (Y1) CA-ACLM (Y1) GR-ACLM GT-ACLM (Y1).
  3034     ADD TPRM TO GP-TPRM (Y1) CA-TPRM (Y1) GR-TPRM GT-TPRM (Y1).
  3035     ADD TCOM TO GP-TCOM (Y1) CA-TCOM (Y1) GR-TCOM GT-TCOM (Y1).
  3036
  3037 0440-ADD-CONTINUE.
  3038     IF COMPARE9DT (X1) GREATER YEAR-OLD-DATE
  3039         ADD LBEN TO L12AC-LBEN
  3040         ADD LPRM TO L12AC-LPRM
  3041         ADD LCLM TO L12AC-LCLM
  3042         ADD ABEN TO L12AC-ABEN
  3043         ADD APRM TO L12AC-APRM
  3044         ADD ACLM TO L12AC-ACLM
  3045         ADD TPRM TO L12AC-TPRM
  3046         ADD TCOM TO L12AC-TCOM
  3047         IF PASS-NUMBER = '3'  AND
  3048            S-EPX-CNTL-ACCT NOT = HIGH-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ECS036.cbl
  3049             NEXT SENTENCE
  3050         ELSE
  3051             IF (PASS-NUMBER = '4' OR '5')  AND
  3052                (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3053                 NEXT SENTENCE
  3054             ELSE
  3055                 ADD LBEN TO L12GP-LBEN L12CA-LBEN
  3056                             L12GT-LBEN
  3057                 ADD LPRM TO L12GP-LPRM L12CA-LPRM
  3058                             L12GT-LPRM
  3059                 ADD LCLM TO L12GP-LCLM L12CA-LCLM
  3060                             L12GT-LCLM
  3061                 ADD ABEN TO L12GP-ABEN L12CA-ABEN
  3062                             L12GT-ABEN
  3063                 ADD APRM TO L12GP-APRM L12CA-APRM
  3064                             L12GT-APRM
  3065                 ADD ACLM TO L12GP-ACLM L12CA-ACLM
  3066                             L12GT-ACLM
  3067                 ADD TPRM TO L12GP-TPRM L12CA-TPRM
  3068                             L12GT-TPRM
  3069                 ADD TCOM TO L12GP-TCOM L12CA-TCOM .
  3070                 ADD TCOM TO L12GT-TCOM.
  3071
  3072     IF RUN-YR = COMP-YR (X1)
  3073         ADD LBEN TO YTDAC-LBEN
  3074         ADD LPRM TO YTDAC-LPRM
  3075                     YTDAC-TPRM
  3076         ADD LCLM TO YTDAC-LCLM
  3077         ADD TCOM TO YTDAC-TCOM
  3078         ADD ABEN TO YTDAC-ABEN
  3079         ADD APRM TO YTDAC-APRM
  3080                     YTDAC-TPRM
  3081         ADD ACLM TO YTDAC-ACLM
  3082         IF PASS-NUMBER = '3'  AND
  3083            S-EPX-CNTL-ACCT NOT = HIGH-VALUES
  3084             NEXT SENTENCE
  3085         ELSE
  3086             IF (PASS-NUMBER = '4' OR '5') AND
  3087                (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3088                 NEXT SENTENCE
  3089             ELSE
  3090                 ADD LBEN TO YTDGP-LBEN YTDCA-LBEN
  3091                             YTDGT-LBEN
  3092                 ADD LPRM TO YTDGP-LPRM YTDCA-LPRM
  3093                             YTDGP-TPRM YTDCA-TPRM
  3094                             YTDGT-LPRM YTDGT-TPRM
  3095                 ADD LCLM TO YTDGP-LCLM YTDCA-LCLM
  3096                             YTDGT-LCLM
  3097                 ADD TCOM TO YTDGP-TCOM YTDCA-TCOM
  3098                             YTDGT-TCOM
  3099                 ADD ABEN TO YTDGP-ABEN YTDCA-ABEN
  3100                             YTDGT-ABEN
  3101                 ADD APRM TO YTDGP-APRM YTDCA-APRM
  3102                             YTDGP-TPRM YTDCA-TPRM
  3103                             YTDGT-APRM YTDGT-TPRM
  3104                 ADD ACLM TO YTDGP-ACLM YTDCA-ACLM.
  3105                 ADD ACLM TO YTDGT-ACLM.
  3106
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ECS036.cbl
  3107*    IF X1 = 13
  3108*       COMPUTE ITDAC-LBEN = ITDAC-LBEN + AC-LBEN (X1)
  3109*       COMPUTE ITDAC-LPRM = ITDAC-LPRM + AC-LPRM (X1)
  3110*       COMPUTE ITDAC-LCLM = ITDAC-LCLM + AC-LCLM (X1)
  3111*       COMPUTE ITDAC-ABEN = ITDAC-ABEN + AC-ABEN (X1)
  3112*       COMPUTE ITDAC-APRM = ITDAC-APRM + AC-APRM (X1)
  3113*       COMPUTE ITDAC-ACLM = ITDAC-ACLM + AC-ACLM (X1)
  3114*       COMPUTE ITDAC-TPRM = ITDAC-TPRM + AC-TPRM (X1)
  3115*       COMPUTE ITDAC-TCOM = ITDAC-TCOM + AC-TCOM (X1)
  3116*       IF (PASS-NUMBER = '3')
  3117*          AND (S-EPX-CNTL-ACCT NOT = HIGH-VALUES)
  3118*          CONTINUE
  3119*       ELSE
  3120*          IF (PASS-NUMBER = '4' OR '5')
  3121*             AND (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3122*             CONTINUE
  3123*          ELSE
  3124*             ADD ITDAC-LBEN TO ITDGP-LBEN ITDCA-LBEN
  3125*             ADD ITDAC-LPRM TO ITDGP-LPRM ITDCA-LPRM
  3126*             ADD ITDAC-LCLM TO ITDGP-LCLM ITDCA-LCLM
  3127*             ADD ITDAC-ABEN TO ITDGP-ABEN ITDCA-ABEN
  3128*             ADD ITDAC-APRM TO ITDGP-APRM ITDCA-APRM
  3129*             ADD ITDAC-ACLM TO ITDGP-ACLM ITDCA-ACLM
  3130*             ADD ITDAC-TPRM TO ITDGP-TPRM ITDCA-TPRM
  3131*             ADD ITDAC-TCOM TO ITDGP-TCOM ITDCA-TCOM
  3132*          END-IF
  3133*       END-IF
  3134*    END-IF
  3135
  3136     IF X1 = 13
  3137        COMPUTE PYTDAC-LBEN = PYTDAC-LBEN +
  3138           (AC-LBEN (1) - AC-LBEN (15))
  3139        COMPUTE PYTDAC-LPRM = PYTDAC-LPRM +
  3140           (AC-LPRM (1) - AC-LPRM (15))
  3141        COMPUTE PYTDAC-LCLM = PYTDAC-LCLM +
  3142           (AC-LCLM (1) - AC-LCLM (15))
  3143        COMPUTE PYTDAC-ABEN = PYTDAC-ABEN +
  3144           (AC-ABEN (1) - AC-ABEN (15))
  3145        COMPUTE PYTDAC-APRM = PYTDAC-APRM +
  3146           (AC-APRM (1) - AC-APRM (15))
  3147        COMPUTE PYTDAC-ACLM = PYTDAC-ACLM +
  3148           (AC-ACLM (1) - AC-ACLM (15))
  3149        COMPUTE PYTDAC-TPRM = PYTDAC-TPRM +
  3150           (AC-TPRM (1) - AC-TPRM (15))
  3151        COMPUTE PYTDAC-TCOM = PYTDAC-TCOM +
  3152           (AC-TCOM (1) - AC-TCOM (15))
  3153        IF (PASS-NUMBER = '3')
  3154           AND (S-EPX-CNTL-ACCT NOT = HIGH-VALUES)
  3155           CONTINUE
  3156        ELSE
  3157           IF (PASS-NUMBER = '4' OR '5')
  3158              AND (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3159              CONTINUE
  3160           ELSE
  3161              ADD PYTDAC-LBEN TO PYTDGP-LBEN PYTDCA-LBEN
  3162                                 PYTDGT-LBEN
  3163              ADD PYTDAC-LPRM TO PYTDGP-LPRM PYTDCA-LPRM
  3164                                 PYTDGT-LPRM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ECS036.cbl
  3165              ADD PYTDAC-LCLM TO PYTDGP-LCLM PYTDCA-LCLM
  3166                                 PYTDGT-LCLM
  3167              ADD PYTDAC-ABEN TO PYTDGP-ABEN PYTDCA-ABEN
  3168                                 PYTDGT-ABEN
  3169              ADD PYTDAC-APRM TO PYTDGP-APRM PYTDCA-APRM
  3170                                 PYTDGT-APRM
  3171              ADD PYTDAC-ACLM TO PYTDGP-ACLM PYTDCA-ACLM
  3172                                 PYTDGT-ACLM
  3173              ADD PYTDAC-TPRM TO PYTDGP-TPRM PYTDCA-TPRM
  3174                                 PYTDGT-TPRM
  3175              ADD PYTDAC-TCOM TO PYTDGP-TCOM PYTDCA-TCOM
  3176                                 PYTDGT-TCOM
  3177           END-IF
  3178        END-IF
  3179     END-IF
  3180
  3181*    IF X1 = 13
  3182*       COMPUTE PL12AC-LBEN = PL12AC-LBEN +
  3183*          (AC-LBEN (1) - AC-LBEN (14))
  3184*       COMPUTE PL12AC-LPRM = PL12AC-LPRM +
  3185*          (AC-LPRM (1) - AC-LPRM (14))
  3186*       COMPUTE PL12AC-LCLM = PL12AC-LCLM +
  3187*          (AC-LCLM (1) - AC-LCLM (14))
  3188*       COMPUTE PL12AC-ABEN = PL12AC-ABEN +
  3189*          (AC-ABEN (1) - AC-ABEN (14))
  3190*       COMPUTE PL12AC-APRM = PL12AC-APRM +
  3191*          (AC-APRM (1) - AC-APRM (14))
  3192*       COMPUTE PL12AC-ACLM = PL12AC-ACLM +
  3193*          (AC-ACLM (1) - AC-ACLM (14))
  3194*       COMPUTE PL12AC-TPRM = PL12AC-TPRM +
  3195*          (AC-TPRM (1) - AC-TPRM (14))
  3196*       COMPUTE PL12AC-TCOM = PL12AC-TCOM +
  3197*          (AC-TCOM (1) - AC-TCOM (14))
  3198*       IF (PASS-NUMBER = '3')
  3199*          AND (S-EPX-CNTL-ACCT NOT = HIGH-VALUES)
  3200*          CONTINUE
  3201*       ELSE
  3202*          IF (PASS-NUMBER = '4' OR '5')
  3203*             AND (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3204*             CONTINUE
  3205*          ELSE
  3206*             ADD PL12AC-LBEN TO PL12GP-LBEN PL12CA-LBEN
  3207*             ADD PL12AC-LPRM TO PL12GP-LPRM PL12CA-LPRM
  3208*             ADD PL12AC-LCLM TO PL12GP-LCLM PL12CA-LCLM
  3209*             ADD PL12AC-ABEN TO PL12GP-ABEN PL12CA-ABEN
  3210*             ADD PL12AC-APRM TO PL12GP-APRM PL12CA-APRM
  3211*             ADD PL12AC-ACLM TO PL12GP-ACLM PL12CA-ACLM
  3212*             ADD PL12AC-TPRM TO PL12GP-TPRM PL12CA-TPRM
  3213*             ADD PL12AC-TCOM TO PL12GP-TCOM PL12CA-TCOM
  3214*          END-IF
  3215*       END-IF
  3216*    END-IF
  3217
  3218
  3219
  3220     .
  3221 0450-EXIT.
  3222      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ECS036.cbl
  3223
  3224 0460-PRINT-LAST-AC-12.
  3225     IF DTE-CLIENT = 'HER'
  3226         NEXT SENTENCE
  3227     ELSE
  3228         GO TO 0480-PRINT-LAST-AC-12.
  3229
  3230     MOVE L12AC-LBEN             TO  DET-LBEN-2.
  3231     MOVE L12AC-LPRM             TO  DET-LPRM-2.
  3232     MOVE L12AC-LCLM             TO  DET-LCLM-2.
  3233     MOVE L12AC-APRM             TO  DET-APRM-2.
  3234     MOVE L12AC-ACLM             TO  DET-ACLM-2.
  3235     MOVE L12AC-TPRM             TO  DET-TPRM-2.
  3236     MOVE L12AC-TCOM             TO  DET-TCOM-2.
  3237     MOVE 'LAST 12 MONTHS'       TO  DET-TITLE-2.
  3238     MOVE '0'                    TO  X.
  3239     MOVE DETAIL-LINE-2          TO  P-DATA.
  3240
  3241     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3242
  3243     MOVE ZERO-ACCUM             TO  LAST-12-ACCOUNT-ACCUM.
  3244
  3245 0470-PRINT-AC-YTD.
  3246     MOVE YTDAC-LBEN             TO  DET-LBEN-2.
  3247     MOVE YTDAC-LPRM             TO  DET-LPRM-2.
  3248     MOVE YTDAC-LCLM             TO  DET-LCLM-2.
  3249     MOVE YTDAC-APRM             TO  DET-APRM-2.
  3250     MOVE YTDAC-ACLM             TO  DET-ACLM-2.
  3251     MOVE YTDAC-TPRM             TO  DET-TPRM-2.
  3252     MOVE YTDAC-TCOM             TO  DET-TCOM-2.
  3253     MOVE 'YEAR TO DATE'         TO  DET-TITLE-2.
  3254     MOVE ' '                    TO  X.
  3255     MOVE DETAIL-LINE-2          TO  P-DATA.
  3256
  3257     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3258
  3259     MOVE SPACES                 TO  DET-TITLE-2.
  3260     MOVE ZERO-ACCUM             TO  YTD-ACCOUNT-ACCUM.
  3261
  3262     GO TO 0495-ZERO-ACCOUNT.
  3263
  3264 0480-PRINT-LAST-AC-12.
  3265
  3266     MOVE L12AC-LBEN             TO DET-LBEN.
  3267     MOVE L12AC-LPRM             TO DET-LPRM.
  3268     MOVE L12AC-LCLM             TO DET-LCLM.
  3269     MOVE L12AC-ABEN             TO DET-ABEN.
  3270     MOVE L12AC-APRM             TO DET-APRM.
  3271     MOVE L12AC-ACLM             TO DET-ACLM.
  3272     MOVE L12AC-TPRM             TO DET-TPRM.
  3273     MOVE L12AC-TCOM             TO DET-TCOM.
  3274     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  3275
  3276     IF DTE-CLIENT = 'AFL'
  3277         MOVE 'FISCAL TO DATE'   TO DET-TITLE.
  3278
  3279     MOVE '0'                    TO X.
  3280     MOVE DETAIL-LINE            TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ECS036.cbl
  3281     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3282     MOVE ZERO-ACCUM             TO LAST-12-ACCOUNT-ACCUM.
  3283
  3284********   PRINT PRIOR L12 MO
  3285
  3286*    MOVE PL12AC-LBEN            TO DET-LBEN
  3287*    MOVE PL12AC-LPRM            TO DET-LPRM
  3288*    MOVE PL12AC-LCLM            TO DET-LCLM
  3289*    MOVE PL12AC-ABEN            TO DET-ABEN
  3290*    MOVE PL12AC-APRM            TO DET-APRM
  3291*    MOVE PL12AC-ACLM            TO DET-ACLM
  3292*    MOVE PL12AC-TPRM            TO DET-TPRM
  3293*    MOVE PL12AC-TCOM            TO DET-TCOM
  3294*    MOVE 'PRIOR L12         '   TO DET-TITLE
  3295
  3296*    MOVE ' '                    TO X
  3297*    MOVE DETAIL-LINE            TO P-DATA
  3298*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  3299
  3300*    MOVE ZERO-ACCUM             TO PL12-ACCOUNT-ACCUM
  3301     .
  3302 0490-PRINT-AC-YTD.
  3303
  3304     MOVE YTDAC-LBEN             TO DET-LBEN.
  3305     MOVE YTDAC-LPRM             TO DET-LPRM.
  3306     MOVE YTDAC-LCLM             TO DET-LCLM.
  3307     MOVE YTDAC-ABEN             TO DET-ABEN.
  3308     MOVE YTDAC-APRM             TO DET-APRM.
  3309     MOVE YTDAC-ACLM             TO DET-ACLM.
  3310     MOVE YTDAC-TPRM             TO DET-TPRM.
  3311     MOVE YTDAC-TCOM             TO DET-TCOM.
  3312     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  3313     MOVE ' '                    TO X.
  3314     MOVE DETAIL-LINE            TO P-DATA.
  3315     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3316     MOVE SPACES                 TO DET-TITLE.
  3317
  3318********   PRINT PRIOR YTD
  3319
  3320     MOVE PYTDAC-LBEN            TO DET-LBEN
  3321     MOVE PYTDAC-LPRM            TO DET-LPRM
  3322     MOVE PYTDAC-LCLM            TO DET-LCLM
  3323     MOVE PYTDAC-ABEN            TO DET-ABEN
  3324     MOVE PYTDAC-APRM            TO DET-APRM
  3325     MOVE PYTDAC-ACLM            TO DET-ACLM
  3326     MOVE PYTDAC-TPRM            TO DET-TPRM
  3327     MOVE PYTDAC-TCOM            TO DET-TCOM
  3328     MOVE 'PRIOR YTD         '   TO DET-TITLE
  3329
  3330     MOVE ' '                    TO X
  3331     MOVE DETAIL-LINE            TO P-DATA
  3332     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  3333     MOVE SPACES                 TO DET-TITLE
  3334     .
  3335 0492-PRINT-ITD-AC.
  3336
  3337*    MOVE ITDAC-LBEN             TO DET-LBEN
  3338*    MOVE ITDAC-LPRM             TO DET-LPRM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ECS036.cbl
  3339*    MOVE ITDAC-LCLM             TO DET-LCLM
  3340*    MOVE ITDAC-ABEN             TO DET-ABEN
  3341*    MOVE ITDAC-APRM             TO DET-APRM
  3342*    MOVE ITDAC-ACLM             TO DET-ACLM
  3343*    MOVE ITDAC-TPRM             TO DET-TPRM
  3344*    MOVE ITDAC-TCOM             TO DET-TCOM
  3345*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE
  3346*    MOVE ' '                    TO X
  3347*    MOVE DETAIL-LINE            TO P-DATA
  3348*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  3349
  3350     MOVE SPACES                 TO DET-TITLE
  3351
  3352     IF DTE-CLIENT = 'MON'
  3353         IF PASS-NUMBER = '3'
  3354             IF SAVE-AM-EXPIRES = ZEROS AND
  3355                SAVE-AM-HI-CERT = ZEROS
  3356                 NEXT SENTENCE
  3357             ELSE
  3358                 MOVE 'HIGH CERT DATE'
  3359                                     TO  DET-DATE-DESC
  3360                 MOVE SAVE-AM-HI-MO  TO  DET-DATE-MO
  3361                 MOVE SAVE-AM-HI-DA  TO  DET-DATE-DA
  3362                 MOVE SAVE-AM-HI-YR  TO  DET-DATE-YR
  3363                 MOVE '/'            TO  DET-DATE-SLASH-1
  3364                                         DET-DATE-SLASH-2
  3365                 MOVE ' '            TO  X
  3366                 MOVE DET-DATE-LINE  TO  P-DATA
  3367                 PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  3368                 MOVE SPACES         TO  DET-DATE-LINE
  3369                 MOVE 'EXPIRATION DATE'
  3370                                     TO  DET-DATE-DESC
  3371                 MOVE SAVE-AM-EXP-MO TO  DET-DATE-MO
  3372                 MOVE SAVE-AM-EXP-DA TO  DET-DATE-DA
  3373                 MOVE SAVE-AM-EXP-YR TO  DET-DATE-YR
  3374                 MOVE '/'            TO  DET-DATE-SLASH-1
  3375                                         DET-DATE-SLASH-2
  3376                 MOVE ' '            TO  X
  3377                 MOVE DET-DATE-LINE  TO  P-DATA
  3378                 PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  3379                 MOVE SPACES         TO  DET-DATE-LINE.
  3380
  3381     MOVE ZERO-ACCUM             TO YTD-ACCOUNT-ACCUM
  3382                                    YTD-STATE-ACCUM
  3383                                    LAST-12-STATE-ACCUM
  3384*                                   ITD-ACCOUNT-ACCUM
  3385                                    PYTD-ACCOUNT-ACCUM
  3386*                                   PL12-ACCOUNT-ACCUM
  3387     MOVE +0                     TO X1.
  3388     PERFORM 0255-ZERO-ACCUM-STATE 15 TIMES.
  3389
  3390 0495-ZERO-ACCOUNT.
  3391     MOVE ' '                    TO SKIP-HD-SW.
  3392     MOVE +0                     TO X1.
  3393     PERFORM 0230-ZERO-ACCUM-ACC 15 TIMES.
  3394
  3395 0499-ACCOUNT-RETURN.
  3396     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ECS036.cbl
  3398 0500-GROUPING-BREAK.
  3399     PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  3400
  3401 0510-GROUPING-BREAK-1.
  3402     IF P-GP-SW = '1'
  3403         MOVE ' '                TO P-GP-SW
  3404     ELSE
  3405         GO TO 0580-ZERO-GROUPING.
  3406
  3407     PERFORM 1010-GP-HD.
  3408     MOVE +1                     TO X1.
  3409
  3410 0520-GROUPING-BREAK-2.
  3411     IF DTE-CLIENT = 'HER'
  3412         NEXT SENTENCE
  3413     ELSE
  3414         GO TO 0550-GROUPING-BREAK-2.
  3415
  3416     IF X1 GREATER 12
  3417         GO TO 0530-PRINT-LAST-GP-12.
  3418
  3419     MOVE GP-DATE (X1)           TO  SAVE-HER-HI-CERT.
  3420
  3421     IF (GP-CERT (X1) = ZEROS
  3422        OR GP-ISS (X1) EQUAL ZEROS)
  3423         MOVE SPACES             TO  DET-FILL
  3424     ELSE
  3425         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  3426         MOVE '/'                TO  DET-HI-SLASH
  3427         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  3428         MOVE 0                  TO  SAVE-HER-HI-CERT.
  3429
  3430     MOVE GP-CERT (X1)           TO  DET-CERTS-2.
  3431     MOVE GP-ISS  (X1)           TO  DET-ISS-COUNT-2.
  3432     MOVE GP-LBEN (X1)           TO  DET-LBEN-2.
  3433     MOVE GP-LPRM (X1)           TO  DET-LPRM-2.
  3434     MOVE GP-LCLM (X1)           TO  DET-LCLM-2.
  3435     MOVE GP-APRM (X1)           TO  DET-APRM-2.
  3436     MOVE GP-ACLM (X1)           TO  DET-ACLM-2.
  3437     MOVE GP-TPRM (X1)           TO  DET-TPRM-2.
  3438     MOVE GP-TCOM (X1)           TO  DET-TCOM-2.
  3439     ADD +1                      TO  X1.
  3440     MOVE COMP-YR (X1)           TO  DET-YR-2.
  3441     MOVE COMP-MO (X1)           TO  DET-MO-2.
  3442
  3443     PERFORM 1200-LOAD-ALPHA-MONTH  THRU  1299-EXIT.
  3444
  3445     MOVE DETAIL-LINE-2          TO  P-DATA.
  3446
  3447     IF X1 = 2
  3448         MOVE '0'                TO  X
  3449     ELSE
  3450         MOVE ' '                TO  X.
  3451
  3452     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3453
  3454     GO TO 0520-GROUPING-BREAK-2.
  3455
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ECS036.cbl
  3456 0530-PRINT-LAST-GP-12.
  3457     MOVE L12GP-LBEN             TO  DET-LBEN-2.
  3458     MOVE L12GP-LPRM             TO  DET-LPRM-2.
  3459     MOVE L12GP-LCLM             TO  DET-LCLM-2.
  3460     MOVE L12GP-APRM             TO  DET-APRM-2.
  3461     MOVE L12GP-ACLM             TO  DET-ACLM-2.
  3462     MOVE L12GP-TPRM             TO  DET-TPRM-2.
  3463     MOVE L12GP-TCOM             TO  DET-TCOM-2.
  3464     MOVE 'LAST 12 MONTHS'       TO  DET-TITLE-2.
  3465     MOVE '0'                    TO  X.
  3466     MOVE DETAIL-LINE-2          TO  P-DATA.
  3467
  3468     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3469
  3470     MOVE ZERO-ACCUM             TO  LAST-12-GROUPING-ACCUM.
  3471
  3472 0540-PRINT-GP-YTD.
  3473     MOVE YTDGP-LBEN             TO  DET-LBEN-2.
  3474     MOVE YTDGP-LPRM             TO  DET-LPRM-2.
  3475     MOVE YTDGP-LCLM             TO  DET-LCLM-2.
  3476     MOVE YTDGP-APRM             TO  DET-APRM-2.
  3477     MOVE YTDGP-ACLM             TO  DET-ACLM-2.
  3478     MOVE YTDGP-TPRM             TO  DET-TPRM-2.
  3479     MOVE YTDGP-TCOM             TO  DET-TCOM-2.
  3480     MOVE 'YEAR TO DATE'         TO  DET-TITLE-2.
  3481     MOVE ' '                    TO  X.
  3482     MOVE DETAIL-LINE-2          TO  P-DATA.
  3483
  3484     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3485
  3486     MOVE SPACES                 TO  DET-TITLE-2.
  3487     MOVE ZERO-ACCUM             TO  YTD-GROUPING-ACCUM.
  3488
  3489     GO TO 0580-ZERO-GROUPING.
  3490
  3491 0550-GROUPING-BREAK-2.
  3492     IF X1 GREATER 12
  3493         GO TO 0560-PRINT-LAST-GP-12.
  3494
  3495     MOVE GP-CERT (X1)           TO DET-CERTS.
  3496     MOVE GP-LBEN (X1)           TO DET-LBEN.
  3497     MOVE GP-LPRM (X1)           TO DET-LPRM.
  3498     MOVE GP-LCLM (X1)           TO DET-LCLM.
  3499     MOVE GP-ABEN (X1)           TO DET-ABEN.
  3500     MOVE GP-APRM (X1)           TO DET-APRM.
  3501     MOVE GP-ACLM (X1)           TO DET-ACLM.
  3502     MOVE GP-TPRM (X1)           TO DET-TPRM.
  3503     MOVE GP-TCOM (X1)           TO DET-TCOM.
  3504     ADD +1 TO X1.
  3505     MOVE COMP-YR (X1)           TO DET-YR.
  3506     MOVE COMP-MO (X1)           TO DET-MO.
  3507
  3508     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  3509
  3510     MOVE DETAIL-LINE            TO P-DATA.
  3511
  3512     IF X1 = 2
  3513         MOVE '0'                TO X
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ECS036.cbl
  3514     ELSE
  3515         MOVE ' '                TO X.
  3516
  3517     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3518     GO TO 0550-GROUPING-BREAK-2.
  3519
  3520 0560-PRINT-LAST-GP-12.
  3521     MOVE L12GP-LBEN             TO DET-LBEN.
  3522     MOVE L12GP-LPRM             TO DET-LPRM.
  3523     MOVE L12GP-LCLM             TO DET-LCLM.
  3524     MOVE L12GP-ABEN             TO DET-ABEN.
  3525     MOVE L12GP-APRM             TO DET-APRM.
  3526     MOVE L12GP-ACLM             TO DET-ACLM.
  3527     MOVE L12GP-TPRM             TO DET-TPRM.
  3528     MOVE L12GP-TCOM             TO DET-TCOM.
  3529     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  3530
  3531     IF DTE-CLIENT = 'AFL'
  3532         MOVE 'FISCAL TO DATE'   TO DET-TITLE.
  3533
  3534     MOVE '0'                    TO X.
  3535     MOVE DETAIL-LINE            TO P-DATA.
  3536     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3537     MOVE ZERO-ACCUM             TO LAST-12-GROUPING-ACCUM.
  3538
  3539*    MOVE PL12GP-LBEN             TO DET-LBEN.
  3540*    MOVE PL12GP-LPRM             TO DET-LPRM.
  3541*    MOVE PL12GP-LCLM             TO DET-LCLM.
  3542*    MOVE PL12GP-ABEN             TO DET-ABEN.
  3543*    MOVE PL12GP-APRM             TO DET-APRM.
  3544*    MOVE PL12GP-ACLM             TO DET-ACLM.
  3545*    MOVE PL12GP-TPRM             TO DET-TPRM.
  3546*    MOVE PL12GP-TCOM             TO DET-TCOM.
  3547*    MOVE 'PRIOR L12         '   TO DET-TITLE.
  3548*    MOVE ' '                    TO X.
  3549*    MOVE DETAIL-LINE            TO P-DATA.
  3550*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3551*    MOVE ZERO-ACCUM             TO PL12-GROUPING-ACCUM
  3552     .
  3553 0570-PRINT-GP-YTD.
  3554     MOVE YTDGP-LBEN             TO DET-LBEN.
  3555     MOVE YTDGP-LPRM             TO DET-LPRM.
  3556     MOVE YTDGP-LCLM             TO DET-LCLM.
  3557     MOVE YTDGP-ABEN             TO DET-ABEN.
  3558     MOVE YTDGP-APRM             TO DET-APRM.
  3559     MOVE YTDGP-ACLM             TO DET-ACLM.
  3560     MOVE YTDGP-TPRM             TO DET-TPRM.
  3561     MOVE YTDGP-TCOM             TO DET-TCOM.
  3562     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  3563     MOVE ' '                    TO X.
  3564     MOVE DETAIL-LINE            TO P-DATA.
  3565     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3566     MOVE SPACES                 TO DET-TITLE.
  3567     MOVE ZERO-ACCUM             TO YTD-GROUPING-ACCUM.
  3568
  3569     MOVE PYTDGP-LBEN             TO DET-LBEN.
  3570     MOVE PYTDGP-LPRM             TO DET-LPRM.
  3571     MOVE PYTDGP-LCLM             TO DET-LCLM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ECS036.cbl
  3572     MOVE PYTDGP-ABEN             TO DET-ABEN.
  3573     MOVE PYTDGP-APRM             TO DET-APRM.
  3574     MOVE PYTDGP-ACLM             TO DET-ACLM.
  3575     MOVE PYTDGP-TPRM             TO DET-TPRM.
  3576     MOVE PYTDGP-TCOM             TO DET-TCOM.
  3577     MOVE 'PRIOR YTD         '   TO DET-TITLE.
  3578     MOVE ' '                    TO X.
  3579     MOVE DETAIL-LINE            TO P-DATA.
  3580     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3581
  3582     MOVE ZERO-ACCUM             TO PYTD-GROUPING-ACCUM
  3583
  3584*    MOVE ITDGP-LBEN             TO DET-LBEN.
  3585*    MOVE ITDGP-LPRM             TO DET-LPRM.
  3586*    MOVE ITDGP-LCLM             TO DET-LCLM.
  3587*    MOVE ITDGP-ABEN             TO DET-ABEN.
  3588*    MOVE ITDGP-APRM             TO DET-APRM.
  3589*    MOVE ITDGP-ACLM             TO DET-ACLM.
  3590*    MOVE ITDGP-TPRM             TO DET-TPRM.
  3591*    MOVE ITDGP-TCOM             TO DET-TCOM.
  3592*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE.
  3593*    MOVE ' '                    TO X.
  3594*    MOVE DETAIL-LINE            TO P-DATA.
  3595*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3596
  3597     MOVE SPACES                 TO DET-TITLE.
  3598*    MOVE ZERO-ACCUM             TO ITD-GROUPING-ACCUM.
  3599
  3600 0580-ZERO-GROUPING.
  3601     MOVE +0                     TO X1.
  3602     PERFORM 0240-ZERO-ACCUM-GRP 15 TIMES.
  3603
  3604 0590-GROUPING-RETURN.
  3605     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ECS036.cbl
  3607 0600-CARRIER-BREAK.
  3608     PERFORM 0400-ACCOUNT-BREAK    THRU 0495-ZERO-ACCOUNT.
  3609 0605-CARRIER-BREAK-5.
  3610     PERFORM 0510-GROUPING-BREAK-1 THRU 0580-ZERO-GROUPING.
  3611
  3612 0610-CARRIER-BREAK-1.
  3613     IF P-CA-SW = '1'
  3614         MOVE ' '                TO P-CA-SW
  3615     ELSE
  3616         GO TO 0680-ZERO-CARRIER.
  3617
  3618     PERFORM 1020-CA-HD.
  3619     MOVE +1                     TO X1.
  3620
  3621 0620-CARRIER-BREAK-2.
  3622     IF DTE-CLIENT = 'HER'
  3623         NEXT SENTENCE
  3624     ELSE
  3625         GO TO 0650-CARRIER-BREAK-2.
  3626
  3627     IF X1 GREATER 12
  3628         GO TO 0630-PRINT-LAST-CA-12.
  3629
  3630     MOVE CA-DATE (X1)           TO  SAVE-HER-HI-CERT.
  3631
  3632     IF (CA-CERT (X1) = ZEROS
  3633        OR CA-ISS (X1) EQUAL ZEROS)
  3634         MOVE SPACES             TO  DET-FILL
  3635     ELSE
  3636         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  3637         MOVE '/'                TO  DET-HI-SLASH
  3638         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  3639         MOVE 0                  TO  SAVE-HER-HI-CERT.
  3640
  3641     MOVE CA-CERT (X1)           TO  DET-CERTS-2.
  3642     MOVE CA-ISS  (X1)           TO  DET-ISS-COUNT-2.
  3643     MOVE CA-LBEN (X1)           TO  DET-LBEN-2.
  3644     MOVE CA-LPRM (X1)           TO  DET-LPRM-2.
  3645     MOVE CA-LCLM (X1)           TO  DET-LCLM-2.
  3646     MOVE CA-APRM (X1)           TO  DET-APRM-2.
  3647     MOVE CA-ACLM (X1)           TO  DET-ACLM-2.
  3648     MOVE CA-TPRM (X1)           TO  DET-TPRM-2.
  3649     MOVE CA-TCOM (X1)           TO  DET-TCOM-2.
  3650     ADD +1                      TO  X1.
  3651     MOVE COMP-YR (X1)           TO  DET-YR-2.
  3652     MOVE COMP-MO (X1)           TO  DET-MO-2.
  3653
  3654     PERFORM 1200-LOAD-ALPHA-MONTH  THRU  1299-EXIT.
  3655
  3656     MOVE DETAIL-LINE-2          TO  P-DATA.
  3657
  3658     IF X1 = 2
  3659         MOVE '0'                TO  X
  3660     ELSE
  3661         MOVE ' '                TO  X.
  3662
  3663     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3664
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ECS036.cbl
  3665     GO TO 0620-CARRIER-BREAK-2.
  3666
  3667 0630-PRINT-LAST-CA-12.
  3668     MOVE L12CA-LBEN             TO  DET-LBEN-2.
  3669     MOVE L12CA-LPRM             TO  DET-LPRM-2.
  3670     MOVE L12CA-LCLM             TO  DET-LCLM-2.
  3671     MOVE L12CA-APRM             TO  DET-APRM-2.
  3672     MOVE L12CA-ACLM             TO  DET-ACLM-2.
  3673     MOVE L12CA-TPRM             TO  DET-TPRM-2.
  3674     MOVE L12CA-TCOM             TO  DET-TCOM-2.
  3675     MOVE 'LAST 12 MONTHS'       TO  DET-TITLE-2.
  3676     MOVE '0'                    TO  X.
  3677     MOVE DETAIL-LINE-2          TO  P-DATA.
  3678
  3679     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3680
  3681     MOVE ZERO-ACCUM             TO  LAST-12-CARRIER-ACCUM.
  3682
  3683 0640-PRINT-CA-YTD.
  3684     MOVE YTDCA-LBEN             TO  DET-LBEN-2.
  3685     MOVE YTDCA-LPRM             TO  DET-LPRM-2.
  3686     MOVE YTDCA-LCLM             TO  DET-LCLM-2.
  3687     MOVE YTDCA-APRM             TO  DET-APRM-2.
  3688     MOVE YTDCA-ACLM             TO  DET-ACLM-2.
  3689     MOVE YTDCA-TPRM             TO  DET-TPRM-2.
  3690     MOVE YTDCA-TCOM             TO  DET-TCOM-2.
  3691     MOVE 'YEAR TO DATE'         TO  DET-TITLE-2.
  3692     MOVE ' '                    TO  X.
  3693     MOVE DETAIL-LINE-2          TO  P-DATA.
  3694
  3695
  3696     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3697
  3698     MOVE SPACES                 TO  DET-TITLE-2.
  3699     MOVE ZERO-ACCUM             TO  YTD-CARRIER-ACCUM.
  3700
  3701     GO TO 0680-ZERO-CARRIER.
  3702
  3703 0650-CARRIER-BREAK-2.
  3704     IF X1 GREATER 12
  3705         GO TO 0660-PRINT-LAST-CA-12.
  3706
  3707     MOVE CA-CERT (X1)           TO DET-CERTS.
  3708     MOVE CA-LBEN (X1)           TO DET-LBEN.
  3709     MOVE CA-LPRM (X1)           TO DET-LPRM.
  3710     MOVE CA-LCLM (X1)           TO DET-LCLM.
  3711     MOVE CA-ABEN (X1)           TO DET-ABEN.
  3712     MOVE CA-APRM (X1)           TO DET-APRM.
  3713     MOVE CA-ACLM (X1)           TO DET-ACLM.
  3714     MOVE CA-TPRM (X1)           TO DET-TPRM.
  3715     MOVE CA-TCOM (X1)           TO DET-TCOM.
  3716     ADD +1 TO X1.
  3717     MOVE COMP-YR (X1)           TO DET-YR.
  3718     MOVE COMP-MO (X1)           TO DET-MO.
  3719
  3720     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  3721
  3722     MOVE DETAIL-LINE            TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ECS036.cbl
  3723
  3724     IF X1 = 2
  3725         MOVE '0'                TO X
  3726     ELSE
  3727         MOVE ' '                TO X.
  3728
  3729     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3730     GO TO 0650-CARRIER-BREAK-2.
  3731
  3732 0660-PRINT-LAST-CA-12.
  3733     MOVE L12CA-LBEN             TO DET-LBEN.
  3734     MOVE L12CA-LPRM             TO DET-LPRM.
  3735     MOVE L12CA-LCLM             TO DET-LCLM.
  3736     MOVE L12CA-ABEN             TO DET-ABEN.
  3737     MOVE L12CA-APRM             TO DET-APRM.
  3738     MOVE L12CA-ACLM             TO DET-ACLM.
  3739     MOVE L12CA-TPRM             TO DET-TPRM.
  3740     MOVE L12CA-TCOM             TO DET-TCOM.
  3741     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  3742
  3743     IF DTE-CLIENT = 'AFL'
  3744         MOVE 'FISCAL TO DATE'   TO DET-TITLE.
  3745
  3746     MOVE '0'                    TO X.
  3747     MOVE DETAIL-LINE            TO P-DATA.
  3748     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3749     MOVE ZERO-ACCUM             TO LAST-12-CARRIER-ACCUM.
  3750
  3751*    MOVE PL12CA-LBEN             TO DET-LBEN.
  3752*    MOVE PL12CA-LPRM             TO DET-LPRM.
  3753*    MOVE PL12CA-LCLM             TO DET-LCLM.
  3754*    MOVE PL12CA-ABEN             TO DET-ABEN.
  3755*    MOVE PL12CA-APRM             TO DET-APRM.
  3756*    MOVE PL12CA-ACLM             TO DET-ACLM.
  3757*    MOVE PL12CA-TPRM             TO DET-TPRM.
  3758*    MOVE PL12CA-TCOM             TO DET-TCOM.
  3759*    MOVE 'PRIOR L12         '   TO DET-TITLE.
  3760*    MOVE ' '                    TO X.
  3761*    MOVE DETAIL-LINE            TO P-DATA.
  3762*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3763*    MOVE ZERO-ACCUM             TO PL12-CARRIER-ACCUM.
  3764
  3765 0670-PRINT-CA-YTD.
  3766     MOVE YTDCA-LBEN             TO DET-LBEN.
  3767     MOVE YTDCA-LPRM             TO DET-LPRM.
  3768     MOVE YTDCA-LCLM             TO DET-LCLM.
  3769     MOVE YTDCA-ABEN             TO DET-ABEN.
  3770     MOVE YTDCA-APRM             TO DET-APRM.
  3771     MOVE YTDCA-ACLM             TO DET-ACLM.
  3772     MOVE YTDCA-TPRM             TO DET-TPRM.
  3773     MOVE YTDCA-TCOM             TO DET-TCOM.
  3774     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  3775     MOVE ' '                    TO X.
  3776     MOVE DETAIL-LINE            TO P-DATA.
  3777     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3778     MOVE SPACES                 TO DET-TITLE.
  3779     MOVE ZERO-ACCUM             TO YTD-CARRIER-ACCUM.
  3780
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ECS036.cbl
  3781     MOVE PYTDCA-LBEN             TO DET-LBEN.
  3782     MOVE PYTDCA-LPRM             TO DET-LPRM.
  3783     MOVE PYTDCA-LCLM             TO DET-LCLM.
  3784     MOVE PYTDCA-ABEN             TO DET-ABEN.
  3785     MOVE PYTDCA-APRM             TO DET-APRM.
  3786     MOVE PYTDCA-ACLM             TO DET-ACLM.
  3787     MOVE PYTDCA-TPRM             TO DET-TPRM.
  3788     MOVE PYTDCA-TCOM             TO DET-TCOM.
  3789     MOVE 'PRIOR YTD         '   TO DET-TITLE.
  3790     MOVE ' '                    TO X.
  3791     MOVE DETAIL-LINE            TO P-DATA.
  3792     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3793
  3794     MOVE ZERO-ACCUM             TO PYTD-CARRIER-ACCUM.
  3795
  3796*    MOVE ITDCA-LBEN             TO DET-LBEN.
  3797*    MOVE ITDCA-LPRM             TO DET-LPRM.
  3798*    MOVE ITDCA-LCLM             TO DET-LCLM.
  3799*    MOVE ITDCA-ABEN             TO DET-ABEN.
  3800*    MOVE ITDCA-APRM             TO DET-APRM.
  3801*    MOVE ITDCA-ACLM             TO DET-ACLM.
  3802*    MOVE ITDCA-TPRM             TO DET-TPRM.
  3803*    MOVE ITDCA-TCOM             TO DET-TCOM.
  3804*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE.
  3805*    MOVE ' '                    TO X.
  3806*    MOVE DETAIL-LINE            TO P-DATA.
  3807*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3808
  3809
  3810     MOVE SPACES                 TO DET-TITLE.
  3811*    MOVE ZERO-ACCUM             TO ITD-CARRIER-ACCUM.
  3812
  3813 0680-ZERO-CARRIER.
  3814     MOVE +0                     TO X1.
  3815     PERFORM 0250-ZERO-ACCUM-CARR 15 TIMES.
  3816
  3817 0690-CARRIER-RETURN.
  3818     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ECS036.cbl
  3820 0700-REPTCD-BREAK.
  3821     MOVE +0                     TO X1.
  3822     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  3823     PERFORM 0800-PRINT-DECISION THRU 0899-EXIT.
  3824
  3825     IF P-RP-SW = '1'
  3826         MOVE ' '                TO P-RP-SW
  3827     ELSE
  3828         GO TO 0790-ZERO-REPTCD.
  3829
  3830     PERFORM 0900-HEAD-RTN THRU 0999-EXIT.
  3831
  3832     MOVE +1                     TO X1.
  3833     MOVE +0                     TO Y1.
  3834
  3835 0710-REPTCD-BREAK-PRINT.
  3836     IF DTE-CLIENT = 'HER'
  3837         NEXT SENTENCE
  3838     ELSE
  3839         GO TO 0720-REPTCD-BREAK-POINT.
  3840
  3841     ADD +1 TO X1 Y1.
  3842
  3843     IF X1 GREATER THAN 13
  3844         GO TO 0750-PRINT-LAST-RP-12.
  3845
  3846     COMPUTE RPCERT = RP-CERT (X1) - RP-CERT (Y1).
  3847     COMPUTE RPLBEN = RP-LBEN (X1) - RP-LBEN (Y1).
  3848     COMPUTE RPLPRM = RP-LPRM (X1) - RP-LPRM (Y1).
  3849     COMPUTE RPLCLM = RP-LCLM (X1) - RP-LCLM (Y1).
  3850     COMPUTE RPABEN = RP-ABEN (X1) - RP-ABEN (Y1).
  3851     COMPUTE RPAPRM = RP-APRM (X1) - RP-APRM (Y1).
  3852     COMPUTE RPACLM = RP-ACLM (X1) - RP-ACLM (Y1).
  3853     COMPUTE RPTCOM = RP-TCOM (X1) - RP-TCOM (Y1).
  3854     COMPUTE RPTPRM = RPLPRM  + RPAPRM.
  3855
  3856     MOVE COMP-YR (X1)           TO  DET-YR-2.
  3857     MOVE COMP-MO (X1)           TO  DET-MO-2.
  3858
  3859     PERFORM 1200-LOAD-ALPHA-MONTH  THRU  1299-EXIT.
  3860
  3861     MOVE RP-DATE (X1)           TO  SAVE-HER-HI-CERT.
  3862
  3863     IF RP-CERT (X1) = ZEROS
  3864         MOVE SPACES             TO  DET-FILL
  3865     ELSE
  3866         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  3867         MOVE '/'                TO  DET-HI-SLASH
  3868         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  3869         MOVE 0                  TO  SAVE-HER-HI-CERT.
  3870
  3871     MOVE RPCERT                 TO  DET-CERTS-2.
  3872     MOVE RPLBEN                 TO  DET-LBEN-2.
  3873     MOVE RPLPRM                 TO  DET-LPRM-2.
  3874     MOVE RPLCLM                 TO  DET-LCLM-2.
  3875     MOVE RPAPRM                 TO  DET-APRM-2.
  3876     MOVE RPACLM                 TO  DET-ACLM-2.
  3877     MOVE RPTPRM                 TO  DET-TPRM-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ECS036.cbl
  3878     MOVE RPTCOM                 TO  DET-TCOM-2.
  3879
  3880     IF COMP-YR (X1) = CONV-YR
  3881       AND COMP-MO (X1) = CONV-MO
  3882         MOVE ZEROS              TO  DET-CERTS-2  DET-LBEN-2
  3883                                     DET-LPRM-2   DET-APRM-2
  3884                                     DET-LCLM-2   DET-ACLM-2
  3885                                     DET-TPRM-2   DET-TCOM-2
  3886                                     DET-ISS-COUNT-2
  3887     ELSE
  3888         PERFORM 0730-ADD-TO-L12-YTD  THRU  0740-EXIT.
  3889
  3890     MOVE DETAIL-LINE-2          TO  P-DATA.
  3891
  3892     IF X1 = 2
  3893         MOVE '0'                TO  X
  3894     ELSE
  3895         MOVE ' '                TO  X.
  3896
  3897     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3898
  3899     GO TO 0710-REPTCD-BREAK-PRINT.
  3900
  3901 0720-REPTCD-BREAK-POINT.
  3902     ADD +1 TO X1 Y1.
  3903
  3904     IF X1 GREATER THAN 13
  3905         GO TO 0750-PRINT-LAST-RP-12.
  3906
  3907     COMPUTE RPCERT = RP-CERT (X1) - RP-CERT (Y1).
  3908     COMPUTE RPLBEN = RP-LBEN (X1) - RP-LBEN (Y1).
  3909     COMPUTE RPLPRM = RP-LPRM (X1) - RP-LPRM (Y1).
  3910     COMPUTE RPLCLM = RP-LCLM (X1) - RP-LCLM (Y1).
  3911     COMPUTE RPABEN = RP-ABEN (X1) - RP-ABEN (Y1).
  3912     COMPUTE RPAPRM = RP-APRM (X1) - RP-APRM (Y1).
  3913     COMPUTE RPACLM = RP-ACLM (X1) - RP-ACLM (Y1).
  3914     COMPUTE RPTCOM = RP-TCOM (X1) - RP-TCOM (Y1).
  3915     COMPUTE RPTPRM = RPLPRM  + RPAPRM.
  3916     MOVE COMP-YR (X1)           TO DET-YR.
  3917     MOVE COMP-MO (X1)           TO DET-MO.
  3918     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  3919
  3920     MOVE RPCERT                 TO DET-CERTS.
  3921     MOVE RPLBEN                 TO DET-LBEN.
  3922     MOVE RPLPRM                 TO DET-LPRM.
  3923     MOVE RPLCLM                 TO DET-LCLM.
  3924     MOVE RPABEN                 TO DET-ABEN.
  3925     MOVE RPAPRM                 TO DET-APRM.
  3926     MOVE RPACLM                 TO DET-ACLM.
  3927     MOVE RPTPRM                 TO DET-TPRM.
  3928     MOVE RPTCOM                 TO DET-TCOM.
  3929
  3930     IF COMP-YR (X1) = CONV-YR AND
  3931        COMP-MO (X1) = CONV-MO
  3932         MOVE ZEROS TO DET-CERTS DET-LBEN DET-LPRM
  3933                       DET-ABEN DET-APRM DET-LCLM
  3934                       DET-ACLM DET-TPRM DET-TCOM
  3935        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ECS036.cbl
  3936          PERFORM 0730-ADD-TO-L12-YTD THRU 0740-EXIT.
  3937
  3938     MOVE DETAIL-LINE            TO P-DATA.
  3939
  3940     IF X1 = 2
  3941         MOVE '0'                TO X
  3942     ELSE
  3943         MOVE ' '                TO X.
  3944
  3945     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3946     GO TO 0720-REPTCD-BREAK-POINT.
  3947
  3948 0730-ADD-TO-L12-YTD.
  3949     IF COMPARE9DT (X1) GREATER YEAR-OLD-DATE
  3950         ADD RPLBEN TO L12RP-LBEN
  3951         ADD RPLPRM TO L12RP-LPRM
  3952         ADD RPLCLM TO L12RP-LCLM
  3953         ADD RPABEN TO L12RP-ABEN
  3954         ADD RPAPRM TO L12RP-APRM
  3955         ADD RPACLM TO L12RP-ACLM
  3956         ADD RPTPRM TO L12RP-TPRM
  3957         ADD RPTCOM TO L12RP-TCOM.
  3958
  3959     IF RUN-YR = COMP-YR (X1)
  3960         ADD RPLBEN TO YTDRP-LBEN
  3961         ADD RPLPRM TO YTDRP-LPRM
  3962                       YTDRP-TPRM
  3963         ADD RPLCLM TO YTDRP-LCLM
  3964         ADD RPTCOM TO YTDRP-TCOM
  3965         ADD RPABEN TO YTDRP-ABEN
  3966         ADD RPAPRM TO YTDRP-APRM
  3967                       YTDRP-TPRM
  3968         ADD RPACLM TO YTDRP-ACLM.
  3969
  3970*    IF X1 = 13
  3971*       COMPUTE ITDRP-LBEN = ITDRP-LBEN + RP-LBEN (X1)
  3972*       COMPUTE ITDRP-LPRM = ITDRP-LPRM + RP-LPRM (X1)
  3973*       COMPUTE ITDRP-LCLM = ITDRP-LCLM + RP-LCLM (X1)
  3974*       COMPUTE ITDRP-ABEN = ITDRP-ABEN + RP-ABEN (X1)
  3975*       COMPUTE ITDRP-APRM = ITDRP-APRM + RP-APRM (X1)
  3976*       COMPUTE ITDRP-ACLM = ITDRP-ACLM + RP-ACLM (X1)
  3977*       COMPUTE ITDRP-TPRM = ITDRP-TPRM + RP-TPRM (X1)
  3978*       COMPUTE ITDRP-TCOM = ITDRP-TCOM + RP-TCOM (X1)
  3979*    END-IF
  3980
  3981     IF X1 = 13
  3982        COMPUTE PYTDRP-LBEN = PYTDRP-LBEN +
  3983           (RP-LBEN (1) - RP-LBEN (15))
  3984        COMPUTE PYTDRP-LPRM = PYTDRP-LPRM +
  3985           (RP-LPRM (1) - RP-LPRM (15))
  3986        COMPUTE PYTDRP-LCLM = PYTDRP-LCLM +
  3987           (RP-LCLM (1) - RP-LCLM (15))
  3988        COMPUTE PYTDRP-ABEN = PYTDRP-ABEN +
  3989           (RP-ABEN (1) - RP-ABEN (15))
  3990        COMPUTE PYTDRP-APRM = PYTDRP-APRM +
  3991           (RP-APRM (1) - RP-APRM (15))
  3992        COMPUTE PYTDRP-ACLM = PYTDRP-ACLM +
  3993           (RP-ACLM (1) - RP-ACLM (15))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ECS036.cbl
  3994        COMPUTE PYTDRP-TPRM = PYTDRP-TPRM +
  3995           (RP-TPRM (1) - RP-TPRM (15))
  3996        COMPUTE PYTDRP-TCOM = PYTDRP-TCOM +
  3997           (RP-TCOM (1) - RP-TCOM (15))
  3998     END-IF
  3999
  4000*    IF X1 = 13
  4001*       COMPUTE PL12RP-LBEN = PL12RP-LBEN +
  4002*          (RP-LBEN (1) - RP-LBEN (14))
  4003*       COMPUTE PL12RP-LPRM = PL12RP-LPRM +
  4004*          (RP-LPRM (1) - RP-LPRM (14))
  4005*       COMPUTE PL12RP-LCLM = PL12RP-LCLM +
  4006*          (RP-LCLM (1) - RP-LCLM (14))
  4007*       COMPUTE PL12RP-ABEN = PL12RP-ABEN +
  4008*          (RP-ABEN (1) - RP-ABEN (14))
  4009*       COMPUTE PL12RP-APRM = PL12RP-APRM +
  4010*          (RP-APRM (1) - RP-APRM (14))
  4011*       COMPUTE PL12RP-ACLM = PL12RP-ACLM +
  4012*          (RP-ACLM (1) - RP-ACLM (14))
  4013*       COMPUTE PL12RP-TPRM = PL12RP-TPRM +
  4014*          (RP-TPRM (1) - RP-TPRM (14))
  4015*       COMPUTE PL12RP-TCOM = PL12RP-TCOM +
  4016*          (RP-TCOM (1) - RP-TCOM (14))
  4017*    END-IF
  4018
  4019     .
  4020 0740-EXIT.
  4021      EXIT.
  4022
  4023 0750-PRINT-LAST-RP-12.
  4024     IF DTE-CLIENT = 'HER'
  4025         NEXT SENTENCE
  4026     ELSE
  4027         GO TO 0770-PRINT-LAST-RP-12.
  4028
  4029     MOVE L12RP-LBEN             TO  DET-LBEN-2.
  4030     MOVE L12RP-LPRM             TO  DET-LPRM-2.
  4031     MOVE L12RP-LCLM             TO  DET-LCLM-2.
  4032     MOVE L12RP-APRM             TO  DET-APRM-2.
  4033     MOVE L12RP-ACLM             TO  DET-ACLM-2.
  4034     MOVE L12RP-TPRM             TO  DET-TPRM-2.
  4035     MOVE L12RP-TCOM             TO  DET-TCOM-2.
  4036     MOVE 'LAST 12 MONTHS'       TO  DET-TITLE-2.
  4037     MOVE '0'                    TO  X.
  4038     MOVE DETAIL-LINE-2          TO  P-DATA.
  4039
  4040     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4041
  4042     MOVE ZERO-ACCUM             TO  LAST-12-REPTCD-ACCUM.
  4043
  4044 0760-PRINT-RP-YTD.
  4045     MOVE YTDRP-LBEN             TO  DET-LBEN-2.
  4046     MOVE YTDRP-LPRM             TO  DET-LPRM-2.
  4047     MOVE YTDRP-LCLM             TO  DET-LCLM-2.
  4048     MOVE YTDRP-APRM             TO  DET-APRM-2.
  4049     MOVE YTDRP-ACLM             TO  DET-ACLM-2.
  4050     MOVE YTDRP-TPRM             TO  DET-TPRM-2.
  4051     MOVE YTDRP-TCOM             TO  DET-TCOM-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ECS036.cbl
  4052     MOVE 'YEAR TO DATE'         TO  DET-TITLE-2.
  4053     MOVE ' '                    TO  X.
  4054     MOVE DETAIL-LINE-2          TO  P-DATA.
  4055
  4056     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4057
  4058     MOVE SPACES                 TO  DET-TITLE-2.
  4059     MOVE ZERO-ACCUM             TO  YTD-REPTCD-ACCUM.
  4060
  4061     GO TO 0790-ZERO-REPTCD.
  4062
  4063 0770-PRINT-LAST-RP-12.
  4064     MOVE L12RP-LBEN             TO DET-LBEN.
  4065     MOVE L12RP-LPRM             TO DET-LPRM.
  4066     MOVE L12RP-LCLM             TO DET-LCLM.
  4067     MOVE L12RP-ABEN             TO DET-ABEN.
  4068     MOVE L12RP-APRM             TO DET-APRM.
  4069     MOVE L12RP-ACLM             TO DET-ACLM.
  4070     MOVE L12RP-TPRM             TO DET-TPRM.
  4071     MOVE L12RP-TCOM             TO DET-TCOM.
  4072     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  4073
  4074     IF DTE-CLIENT = 'AFL'
  4075         MOVE 'FISCAL TO DATE'   TO DET-TITLE.
  4076
  4077     MOVE '0'                    TO X.
  4078     MOVE DETAIL-LINE            TO P-DATA.
  4079     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4080     MOVE ZERO-ACCUM             TO LAST-12-REPTCD-ACCUM.
  4081
  4082*    MOVE PL12RP-LBEN             TO DET-LBEN
  4083*    MOVE PL12RP-LPRM             TO DET-LPRM
  4084*    MOVE PL12RP-LCLM             TO DET-LCLM
  4085*    MOVE PL12RP-ABEN             TO DET-ABEN
  4086*    MOVE PL12RP-APRM             TO DET-APRM
  4087*    MOVE PL12RP-ACLM             TO DET-ACLM
  4088*    MOVE PL12RP-TPRM             TO DET-TPRM
  4089*    MOVE PL12RP-TCOM             TO DET-TCOM
  4090*    MOVE 'PRIOR L12         '   TO DET-TITLE
  4091*    MOVE ' '                    TO X
  4092*    MOVE DETAIL-LINE            TO P-DATA
  4093*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4094
  4095     MOVE SPACES                 TO DET-TITLE
  4096*    MOVE ZERO-ACCUM             TO PL12-REPTCD-ACCUM
  4097     .
  4098 0780-PRINT-RP-YTD.
  4099     MOVE YTDRP-LBEN             TO DET-LBEN.
  4100     MOVE YTDRP-LPRM             TO DET-LPRM.
  4101     MOVE YTDRP-LCLM             TO DET-LCLM.
  4102     MOVE YTDRP-ABEN             TO DET-ABEN.
  4103     MOVE YTDRP-APRM             TO DET-APRM.
  4104     MOVE YTDRP-ACLM             TO DET-ACLM.
  4105     MOVE YTDRP-TPRM             TO DET-TPRM.
  4106     MOVE YTDRP-TCOM             TO DET-TCOM.
  4107     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  4108     MOVE ' '                    TO X.
  4109     MOVE DETAIL-LINE            TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ECS036.cbl
  4110     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4111     MOVE SPACES                 TO DET-TITLE.
  4112     MOVE ZERO-ACCUM             TO YTD-REPTCD-ACCUM.
  4113
  4114     MOVE PYTDRP-LBEN             TO DET-LBEN
  4115     MOVE PYTDRP-LPRM             TO DET-LPRM
  4116     MOVE PYTDRP-LCLM             TO DET-LCLM
  4117     MOVE PYTDRP-ABEN             TO DET-ABEN
  4118     MOVE PYTDRP-APRM             TO DET-APRM
  4119     MOVE PYTDRP-ACLM             TO DET-ACLM
  4120     MOVE PYTDRP-TPRM             TO DET-TPRM
  4121     MOVE PYTDRP-TCOM             TO DET-TCOM
  4122     MOVE 'PRIOR YTD         '   TO DET-TITLE
  4123     MOVE ' '                    TO X
  4124     MOVE DETAIL-LINE            TO P-DATA
  4125     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4126
  4127     MOVE SPACES                 TO DET-TITLE
  4128     MOVE ZERO-ACCUM             TO PYTD-REPTCD-ACCUM.
  4129 0782-PRINT-RP-ITD.
  4130
  4131*    MOVE ITDRP-LBEN             TO DET-LBEN
  4132*    MOVE ITDRP-LPRM             TO DET-LPRM
  4133*    MOVE ITDRP-LCLM             TO DET-LCLM
  4134*    MOVE ITDRP-ABEN             TO DET-ABEN
  4135*    MOVE ITDRP-APRM             TO DET-APRM
  4136*    MOVE ITDRP-ACLM             TO DET-ACLM
  4137*    MOVE ITDRP-TPRM             TO DET-TPRM
  4138*    MOVE ITDRP-TCOM             TO DET-TCOM
  4139*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE
  4140*    MOVE ' '                    TO X
  4141*    MOVE DETAIL-LINE            TO P-DATA
  4142*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4143
  4144*    MOVE ZERO-ACCUM             TO ITD-REPTCD-ACCUM
  4145     .
  4146 0790-ZERO-REPTCD.
  4147     MOVE +0                     TO X1.
  4148     PERFORM 0260-ZERO-ACCUM-REPT 15 TIMES.
  4149
  4150 0799-REPTCD-RETURN.
  4151     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ECS036.cbl
  4153 0800-PRINT-DECISION.
  4154     MOVE +1                     TO X1.
  4155     MOVE +0                     TO Y1.
  4156
  4157 0810-PRINT-DECISION-1.
  4158     ADD +1 TO X1 Y1.
  4159
  4160     IF X1 GREATER 13
  4161         MOVE +0                 TO X1
  4162         GO TO 0820-PRINT-DECISION-2.
  4163
  4164     COMPUTE LBEN = AC-LBEN (X1) - AC-LBEN (Y1).
  4165     COMPUTE LPRM = AC-LPRM (X1) - AC-LPRM (Y1).
  4166     COMPUTE LCLM = AC-LCLM (X1) - AC-LCLM (Y1).
  4167     COMPUTE ABEN = AC-ABEN (X1) - AC-ABEN (Y1).
  4168     COMPUTE APRM = AC-APRM (X1) - AC-APRM (Y1).
  4169     COMPUTE ACLM = AC-ACLM (X1) - AC-ACLM (Y1).
  4170     COMPUTE TCOM = AC-TCOM (X1) - AC-TCOM (Y1).
  4171
  4172     IF COMP-YR (X1) = CONV-YR AND
  4173        COMP-MO (X1) = CONV-MO
  4174         MOVE ZEROS TO LBEN LPRM LCLM ABEN APRM ACLM TCOM.
  4175
  4176     IF DTE-CLIENT  =  'NCL'
  4177         MOVE LBEN               TO PLBEN (Y1)
  4178         MOVE LPRM               TO PLPRM (Y1)
  4179         MOVE LCLM               TO PLCLM (Y1)
  4180         MOVE ABEN               TO PABEN (Y1)
  4181         MOVE APRM               TO PAPRM (Y1)
  4182         MOVE ACLM               TO PACLM (Y1)
  4183         MOVE TCOM               TO PTCOM (Y1)
  4184     ELSE
  4185         MOVE LBEN               TO PLBEN (X1)
  4186         MOVE LPRM               TO PLPRM (X1)
  4187         MOVE LCLM               TO PLCLM (X1)
  4188         MOVE ABEN               TO PABEN (X1)
  4189         MOVE APRM               TO PAPRM (X1)
  4190         MOVE ACLM               TO PACLM (X1)
  4191         MOVE TCOM               TO PTCOM (X1).
  4192
  4193     GO TO 0810-PRINT-DECISION-1.
  4194
  4195 0820-PRINT-DECISION-2.
  4196     ADD +1 TO X1.
  4197
  4198     IF X1 GREATER 12
  4199         GO TO 0899-EXIT.
  4200
  4201     IF (PRINT-ZERO-TABLE NOT = PRINT-TABLE (X1))
  4202        OR ((AC-LPRM (1) - AC-LPRM (15)) NOT = ZEROS)
  4203        OR ((AC-APRM (1) - AC-APRM (15)) NOT = ZEROS)
  4204        OR ((AC-LCLM (1) - AC-LCLM (15)) NOT = ZEROS)
  4205        OR ((AC-ACLM (1) - AC-ACLM (15)) NOT = ZEROS)
  4206         MOVE '1'             TO P-ACC-SW P-ST-SW P-GP-SW P-CA-SW
  4207                                 P-RP-SW
  4208                                 P-RP2-SW
  4209         GO TO 0899-EXIT.
  4210
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ECS036.cbl
  4211     GO TO 0820-PRINT-DECISION-2.
  4212
  4213 0899-EXIT.
  4214     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ECS036.cbl
  4216 0900-HEAD-RTN.
  4217     IF DTE-PGM-OPT NOT = 2
  4218         GO TO 0910-HEAD-RTN-A.
  4219
  4220     IF SET-CTR = +1
  4221         MOVE '-'                TO X
  4222         MOVE SPACES             TO P-DATA
  4223         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4224         MOVE SPACES             TO P-DATA
  4225         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4226         MOVE ZERO               TO SET-CTR
  4227         MOVE ' '                TO X
  4228         GO TO 0920-HEAD-RTN-B.
  4229
  4230     MOVE +1                     TO SET-CTR.
  4231
  4232 0910-HEAD-RTN-A.
  4233     ADD +1 TO PAGE-CNT.
  4234     MOVE PAGE-CNT               TO HD-PAGE.
  4235     MOVE '1'                    TO X.
  4236
  4237     IF PASS-NUMBER = '1'
  4238         MOVE 'A'                TO HD-1-GRP-SUF
  4239                                    HD-1-CAR-SUF
  4240                                    HD-1-GT
  4241         MOVE HD-1-STATE         TO P-DATA.
  4242
  4243     IF PASS-NUMBER = '2'
  4244         MOVE 'B'                TO HD-1-GRP-SUF
  4245                                    HD-1-CAR-SUF
  4246                                    HD-1-GT
  4247         MOVE HD-1-BUSINESS      TO P-DATA.
  4248
  4249     IF PASS-NUMBER = '3'
  4250         MOVE 'C'                TO HD-1-GRP-SUF
  4251                                    HD-1-CAR-SUF
  4252                                    HD-1-GT
  4253         MOVE HD-1-AGENCY        TO P-DATA.
  4254
  4255     IF PASS-NUMBER = '4'
  4256         MOVE 'RPT CODE 1 '      TO HD-1-SLCT-FLD-1
  4257         MOVE S-EPX-A-RPT-CD-1   TO HD-1-SLCT-FLD-2
  4258         MOVE 'Y'                TO HD-1-SLCT-REC-POS1
  4259         MOVE 'D'                TO HD-1-DF
  4260                                    HD-1-GRP-SUF
  4261                                    HD-1-CAR-SUF
  4262                                    HD-1-GT
  4263         MOVE HD-1-RPT-CODE-1    TO P-DATA
  4264         MOVE 'RPT CODE 1 '      TO HD-2-SLCT-FLD-1
  4265         MOVE S-EPX-A-RPT-CD-1   TO HD-2-SLCT-FLD-2
  4266         MOVE 'Y'                TO HD-2-SLCT-REC-POS1
  4267         MOVE 'RPT CODE 1 '      TO HD-3-SLCT-FLD-1
  4268         MOVE S-EPX-A-RPT-CD-1   TO HD-3-SLCT-FLD-2
  4269         MOVE 'Y'                TO HD-3-SLCT-REC-POS1.
  4270
  4271     IF PASS-NUMBER = '5'
  4272         MOVE 'E'                TO HD-1-GRP-SUF
  4273                                    HD-1-CAR-SUF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ECS036.cbl
  4274                                    HD-1-GT
  4275         MOVE HD-1-RPT-CODE-2    TO P-DATA.
  4276
  4277     IF PASS-NUMBER = '6'
  4278         MOVE 'USER SEL 2 '      TO HD-1-US2-FLD-1
  4279         MOVE S-EPX-A-RPT-CD-1   TO HD-1-US2-FLD-2
  4280         MOVE 'Y'                TO HD-1-US2-REC-POS1
  4281         MOVE 'F'                TO HD-1-GRP-SUF
  4282                                    HD-1-CAR-SUF
  4283                                    HD-1-GT
  4284         MOVE HD-1-USER-SEL-2    TO P-DATA
  4285         MOVE 'USER SEL 2 '      TO HD-2-SLCT-FLD-1
  4286         MOVE S-EPX-A-RPT-CD-1   TO HD-2-SLCT-FLD-2
  4287         MOVE 'Y'                TO HD-2-SLCT-REC-POS1
  4288         MOVE 'USER SEL 2 '      TO HD-3-SLCT-FLD-1
  4289         MOVE S-EPX-A-RPT-CD-1   TO HD-3-SLCT-FLD-2
  4290         MOVE 'Y'                TO HD-3-SLCT-REC-POS1.
  4291
  4292     IF PASS-NUMBER = '7'
  4293         MOVE 'USER SEL 5 '      TO HD-1-US5-FLD-1
  4294         MOVE S-EPX-A-RPT-CD-1   TO HD-1-US5-FLD-2
  4295         MOVE 'Y'                TO HD-1-US5-REC-POS1
  4296         MOVE 'G'                TO HD-1-GRP-SUF
  4297                                    HD-1-CAR-SUF
  4298                                    HD-1-GT
  4299         MOVE HD-1-USER-SEL-5    TO P-DATA
  4300         MOVE 'USER SEL 5 '      TO HD-2-SLCT-FLD-1
  4301         MOVE S-EPX-A-RPT-CD-1   TO HD-2-SLCT-FLD-2
  4302         MOVE 'Y'                TO HD-2-SLCT-REC-POS1
  4303         MOVE 'USER SEL 5 '      TO HD-3-SLCT-FLD-1
  4304         MOVE S-EPX-A-RPT-CD-1   TO HD-3-SLCT-FLD-2
  4305         MOVE 'Y'                TO HD-3-SLCT-REC-POS1.
  4306
  4307     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4308     MOVE ' '                    TO X.
  4309     MOVE HD-2                   TO P-DATA.
  4310     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4311     MOVE ' '                    TO X.
  4312     MOVE HD-3                   TO P-DATA.
  4313     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4314     MOVE '-'                    TO X.
  4315
  4316 0920-HEAD-RTN-B.
  4317     IF PASS-NUMBER = '1'
  4318         MOVE ' '                TO X
  4319         MOVE S-EPX-CNTL-1       TO STATE-L
  4320                                    HD-6-NSTATE
  4321         PERFORM 1400-STATE-LOOKUP THRU 1499-EXIT
  4322         IF STATE-L = SPACES
  4323             MOVE 'INVALID STATE'         TO HD-STATE
  4324             MOVE HD-6                    TO P-DATA
  4325             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4326          ELSE
  4327             MOVE STATE-PIC (CLAS-INDEXS) TO HD-STATE
  4328             MOVE HD-6                    TO P-DATA
  4329             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4330
  4331     IF PASS-NUMBER = '2'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ECS036.cbl
  4332         MOVE S-EPX-CNTL-1       TO HD-6-NSTATE
  4333         MOVE 'BUSINESS TYPE'    TO FILLER-HD-6
  4334         PERFORM 1510-BUSS-LOOKUP THRU 1599-EXIT
  4335         MOVE ' '                TO X
  4336         MOVE HD-6               TO P-DATA
  4337         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4338
  4339     IF PASS-NUMBER = '3'
  4340         MOVE SPACE              TO HD-6-NSTATE
  4341         MOVE 'AGENCY'           TO FILLER-HD-6
  4342         MOVE S-EPX-CNTL-GA      TO HD-STATE
  4343         MOVE ' '                TO X
  4344         MOVE HD-6               TO P-DATA
  4345         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4346         IF S-EPX-CNTL-ACCT NOT = HIGH-VALUES
  4347             MOVE S-EPX-CNTL-ACCT   TO HD-ACCOUNT
  4348             MOVE SAVE-ACCT-NAME    TO HD-ACCT-NAME
  4349             MOVE SAVE-ACCT-STATUS  TO HD-ACCT-ADDRESS
  4350             MOVE ' '               TO X
  4351             MOVE HD-5              TO P-DATA
  4352*            PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4353             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4354                 MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4355                 MOVE ' '               TO X
  4356                 MOVE HD-5A             TO P-DATA
  4357                 PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4358
  4359     IF PASS-NUMBER = '4'
  4360         MOVE S-EPX-A-RPT-CD-1   TO HD-8A-RPT-CODE-1
  4361         MOVE ' '                TO X
  4362         MOVE HD-8A              TO P-DATA
  4363         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4364********************************
  4365         IF SKIP-HD-SW = '1'
  4366             NEXT SENTENCE
  4367         ELSE
  4368         IF DTE-TOT-OPT = 5 OR 6 OR 7
  4369             MOVE S-EPX-A-CARR       TO HD-4-CARRIER
  4370             MOVE S-EPX-A-GROUP      TO HD-4-GROUPING
  4371             MOVE HD-4               TO P-DATA
  4372             MOVE ' '                TO X
  4373             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4374             MOVE SPACES             TO HD-6
  4375             MOVE 'STATE '           TO FILLER-HD-6-1
  4376             MOVE S-EPX-A-STATE      TO HD-6-NSTATE
  4377             MOVE HD-6               TO P-DATA
  4378             MOVE ' '                TO X
  4379             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4380             MOVE S-EPX-A-ACCT       TO HD-ACCOUNT
  4381             MOVE SAVE-ACCT-NAME     TO HD-ACCT-NAME
  4382             MOVE SAVE-ACCT-STATUS   TO HD-ACCT-ADDRESS
  4383             MOVE HD-5               TO P-DATA
  4384             MOVE ' '                TO X
  4385*            PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4386             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4387                 MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4388                 MOVE ' '               TO X
  4389                 MOVE HD-5A             TO P-DATA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ECS036.cbl
  4390                 PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4391********************************
  4392
  4393     IF PASS-NUMBER = '5'
  4394         MOVE S-EPX-A-CARR       TO HD-4-CARRIER
  4395         MOVE S-EPX-A-GROUP      TO HD-4-GROUPING
  4396         MOVE HD-4               TO P-DATA
  4397         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4398         MOVE 'STATE'            TO FILLER-HD-6
  4399         MOVE S-EPX-A-STATE      TO HD-6-NSTATE
  4400         MOVE STATE-TOTAL-LINE   TO FILLER-HD-6-2
  4401         MOVE SPACES             TO STATE-TOTAL-LINE
  4402                                    HD-STATE
  4403         MOVE HD-6               TO P-DATA
  4404         MOVE ' '                TO X
  4405         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4406         MOVE S-EPX-A-RPT-CD-2   TO HD-8B-RPT-CODE-2
  4407         MOVE ' '                TO X
  4408         MOVE HD-8B              TO P-DATA
  4409         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4410********************************
  4411         IF SKIP-HD-SW = '1'
  4412             NEXT SENTENCE
  4413         ELSE
  4414         IF DTE-TOT-OPT = 6 OR 7
  4415             MOVE S-EPX-A-ACCT       TO HD-ACCOUNT
  4416             MOVE SAVE-ACCT-NAME     TO HD-ACCT-NAME
  4417             MOVE SAVE-ACCT-STATUS   TO HD-ACCT-ADDRESS
  4418             MOVE HD-5               TO P-DATA
  4419*            PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4420             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4421                 MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4422                 MOVE ' '               TO X
  4423                 MOVE HD-5A             TO P-DATA
  4424                 PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4425********************************
  4426
  4427     IF PASS-NUMBER = '6'
  4428         MOVE S-EPX-A-RPT-CD-1   TO HD-8C-USER-SEL-2
  4429         MOVE ' '                TO X
  4430         MOVE HD-8C              TO P-DATA
  4431         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4432********************************
  4433         IF SKIP-HD-SW = '1'
  4434             NEXT SENTENCE
  4435         ELSE
  4436         IF DTE-TOT-OPT = 5 OR 6 OR 7
  4437             MOVE S-EPX-A-CARR       TO HD-4-CARRIER
  4438             MOVE S-EPX-A-GROUP      TO HD-4-GROUPING
  4439             MOVE HD-4               TO P-DATA
  4440             MOVE ' '                TO X
  4441             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4442             MOVE SPACES             TO HD-6
  4443             MOVE 'STATE '           TO FILLER-HD-6-1
  4444             MOVE S-EPX-A-STATE      TO HD-6-NSTATE
  4445             MOVE HD-6               TO P-DATA
  4446             MOVE ' '                TO X
  4447             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ECS036.cbl
  4448             MOVE S-EPX-A-ACCT       TO HD-ACCOUNT
  4449             MOVE SAVE-ACCT-NAME     TO HD-ACCT-NAME
  4450             MOVE SAVE-ACCT-STATUS   TO HD-ACCT-ADDRESS
  4451             MOVE HD-5               TO P-DATA
  4452             MOVE ' '                TO X
  4453*            PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4454             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4455                 MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4456                 MOVE ' '               TO X
  4457                 MOVE HD-5A             TO P-DATA
  4458                 PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4459
  4460
  4461     IF PASS-NUMBER = '7'
  4462         MOVE S-EPX-A-RPT-CD-1   TO HD-8D-USER-SEL-5
  4463         MOVE ' '                TO X
  4464         MOVE HD-8D              TO P-DATA
  4465         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4466         IF SKIP-HD-SW = '2'
  4467             NEXT SENTENCE
  4468         ELSE
  4469             MOVE S-EPX-A-RPT-CD-2   TO HD-4G-REPT-CD-2
  4470             MOVE HD-4G              TO P-DATA
  4471             MOVE ' '                TO X
  4472             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4473         END-IF
  4474         IF SKIP-HD-SW = '1'
  4475             NEXT SENTENCE
  4476         ELSE
  4477           IF DTE-TOT-OPT = 5 OR 6 OR 7
  4478             MOVE SPACES             TO HD-6
  4479             MOVE 'STATE '           TO FILLER-HD-6-1
  4480             MOVE S-EPX-A-STATE      TO HD-6-NSTATE
  4481             MOVE HD-6               TO P-DATA
  4482             MOVE ' '                TO X
  4483             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4484             MOVE S-EPX-A-ACCT       TO HD-ACCOUNT
  4485             MOVE SAVE-ACCT-NAME     TO HD-ACCT-NAME
  4486             MOVE SAVE-ACCT-STATUS   TO HD-ACCT-ADDRESS
  4487             MOVE HD-5               TO P-DATA
  4488             MOVE ' '                TO X
  4489             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4490             MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4491             MOVE ' '               TO X
  4492             MOVE HD-5A             TO P-DATA
  4493             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4494           END-IF
  4495         END-IF
  4496     END-IF.
  4497
  4498     IF PASS-NUMBER NOT = '1' AND '4' AND '5'
  4499        AND '6' AND '7'
  4500         MOVE S-EPX-CARR         TO HD-4-CARRIER
  4501         MOVE S-EPX-GRP          TO HD-4-GROUPING
  4502         MOVE HD-4               TO P-DATA
  4503         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4504
  4505     MOVE '0'                    TO X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* ECS036.cbl
  4506
  4507     IF DTE-CLIENT = 'HER'
  4508         MOVE HD-9-A             TO  P-DATA
  4509         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4510         MOVE ' '                TO  X
  4511         MOVE HD-10-A            TO  P-DATA
  4512         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4513     ELSE
  4514         MOVE HD-9               TO  P-DATA
  4515         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4516         MOVE ' '                TO  X
  4517         MOVE HD-10              TO  P-DATA
  4518         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4519
  4520 0999-EXIT.
  4521     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* ECS036.cbl
  4523 1000-GR-HD.
  4524     MOVE ZERO                   TO SET-CTR.
  4525     ADD +1 TO PAGE-CNT.
  4526     MOVE PAGE-CNT               TO HD-PAGE.
  4527     MOVE '1'                    TO X.
  4528     MOVE HD-1-GRAND-TOTALS      TO P-DATA.
  4529     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4530     MOVE ' '                    TO X.
  4531     MOVE HD-2                   TO P-DATA.
  4532     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4533     MOVE ' '                    TO X.
  4534     MOVE HD-3                   TO P-DATA.
  4535     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4536     MOVE '-'                    TO X.
  4537
  4538     IF DTE-CLIENT = 'HER'
  4539         MOVE HD-9-A             TO  P-DATA
  4540         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4541         MOVE ' '                TO  X
  4542         MOVE HD-10-A            TO  P-DATA
  4543         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4544     ELSE
  4545         MOVE SPACES             TO HD-9-1 HD-10-1
  4546         MOVE HD-9               TO  P-DATA
  4547         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4548         MOVE ' '                TO  X
  4549         MOVE HD-10              TO  P-DATA
  4550         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4551
  4552     MOVE '                NET '  TO  HD-9-1.
  4553     MOVE '             ACTIVITY'  TO  HD-10-1.
  4554     MOVE '       HI-CERT    CERT        NET '
  4555                                 TO  HD-9-A-1.
  4556     MOVE '         DATE    COUNT      ACTIVITY'
  4557                                 TO  HD-10-A-1.
  4558
  4559 1010-GP-HD.
  4560     MOVE ZERO                   TO SET-CTR.
  4561     ADD +1 TO PAGE-CNT.
  4562     MOVE PAGE-CNT               TO HD-PAGE.
  4563     MOVE '1'                    TO X.
  4564     MOVE HD-1-GROUPING          TO P-DATA.
  4565
  4566     IF PASS-NUMBER = '5'
  4567         MOVE HD-1-RPT-CODE-2    TO P-DATA.
  4568
  4569     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4570
  4571     MOVE ' '                    TO X.
  4572     MOVE HD-2                   TO P-DATA.
  4573     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4574     MOVE ' '                    TO X.
  4575     MOVE HD-3                   TO P-DATA.
  4576     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4577     MOVE '-'                    TO X.
  4578
  4579     IF PASS-NUMBER = '2'
  4580         MOVE 'TOTAL BUSINESS TYPE'  TO FILLER-HD-7
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* ECS036.cbl
  4581     ELSE
  4582     IF PASS-NUMBER = '5'
  4583         MOVE 'TOTAL GROUPING'       TO FILLER-HD-7
  4584     ELSE
  4585         MOVE 'TOTAL AGENCY'         TO FILLER-HD-7.
  4586
  4587     MOVE ' FOR CARRIER'         TO FILLER-HD-7A.
  4588     MOVE S-EPX-CNTL-1           TO HD-7-DESC.
  4589     MOVE S-EPX-CARR             TO HD-CARRIER.
  4590     IF PASS-NUMBER = '5'
  4591         MOVE S-EPX-A-GROUP      TO HD-7-DESC
  4592         MOVE S-EPX-A-CARR       TO HD-CARRIER.
  4593     MOVE HD-7                   TO P-DATA.
  4594     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4595     MOVE '0'                    TO X.
  4596
  4597     MOVE '                NET '  TO  HD-9-1.
  4598     MOVE '             ACTIVITY'  TO  HD-10-1.
  4599     MOVE '       HI-CERT    CERT        NET '
  4600                                 TO  HD-9-A-1.
  4601     MOVE '         DATE    COUNT      ACTIVITY'
  4602                                 TO  HD-10-A-1.
  4603
  4604     IF DTE-CLIENT = 'HER'
  4605         MOVE HD-9-A             TO  P-DATA
  4606         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4607         MOVE ' '                TO  X
  4608         MOVE HD-10-A            TO  P-DATA
  4609         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4610     ELSE
  4611         MOVE HD-9               TO  P-DATA
  4612         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4613         MOVE ' '                TO  X
  4614         MOVE HD-10              TO  P-DATA
  4615         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4616
  4617 1020-CA-HD.
  4618     MOVE ZERO                   TO SET-CTR.
  4619     ADD +1 TO PAGE-CNT.
  4620     MOVE PAGE-CNT               TO HD-PAGE.
  4621     MOVE '1'                    TO X.
  4622     MOVE HD-1-CARRIER           TO P-DATA.
  4623     IF PASS-NUMBER = '5'
  4624         MOVE HD-1-RPT-CODE-2    TO P-DATA.
  4625     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4626     MOVE ' '                    TO X.
  4627     MOVE HD-2                   TO P-DATA.
  4628     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4629     MOVE ' '                    TO X.
  4630     MOVE HD-3                   TO P-DATA.
  4631     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4632     MOVE '-'                    TO X.
  4633
  4634     IF PASS-NUMBER = '2'
  4635         MOVE 'TOTAL BUSINESS TYPE'  TO FILLER-HD-7
  4636     ELSE
  4637     IF PASS-NUMBER = '5'
  4638         MOVE 'TOTAL CARRIER'        TO FILLER-HD-7
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* ECS036.cbl
  4639     ELSE
  4640         MOVE 'TOTAL AGENCY'         TO FILLER-HD-7.
  4641
  4642     MOVE SPACE                  TO FILLER-HD-7A.
  4643     MOVE S-EPX-CNTL-1           TO HD-7-DESC.
  4644     IF PASS-NUMBER = '5'
  4645         MOVE S-EPX-A-CARR       TO HD-7-DESC.
  4646     MOVE SPACE                  TO HD-CARRIER.
  4647     MOVE HD-7                   TO P-DATA.
  4648     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4649     MOVE '0'                    TO X.
  4650
  4651     MOVE '                NET '  TO  HD-9-1.
  4652     MOVE '             ACTIVITY'  TO  HD-10-1.
  4653     MOVE '       HI-CERT    CERT        NET '
  4654                                 TO  HD-9-A-1.
  4655     MOVE '         DATE    COUNT      ACTIVITY'
  4656                                 TO  HD-10-A-1.
  4657
  4658     IF DTE-CLIENT = 'HER'
  4659         MOVE HD-9-A             TO  P-DATA
  4660         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4661         MOVE ' '                TO  X
  4662         MOVE HD-10-A            TO  P-DATA
  4663         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4664     ELSE
  4665         MOVE HD-9               TO  P-DATA
  4666         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4667         MOVE ' '                TO  X
  4668         MOVE HD-10              TO  P-DATA
  4669         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4670
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* ECS036.cbl
  4672 1100-WRITE-PRINT.
  4673*              COPY ELCPRT2.
* 4674               COPY PRTN036.
  4675*
  4676*
  4677*                    PRTN036
  4678*
  4679*  MOD BOOK NUMBER "LGC136" FOR ADDITIONAL INFO ON THIS MODULE.
  4680*
  4681******************************************************************
  4682*                   C H A N G E   L O G
  4683*
  4684* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4685*-----------------------------------------------------------------
  4686*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4687* EFFECTIVE    NUMBER
  4688*-----------------------------------------------------------------
  4689*         CR2000042100002  DANA  ADDED MIDWEST
  4690* 120602  CR2002120500014  SMVA  ADD KBA TO PRINT SELECT
  4691* 112503                   SMVA  FIX SELECT-RECORD INITIAL HEADER
  4692* 012704  CR2004011500004  SMVA  REMOVE RMRO,UMB & MFG FROM SELECT-PRINT
  4693*                                AND REMOVE ALL MFG2ND PRINT
  4694* 073004  CR2004072300002  SMVA  REMOVE RPT CD 1 HORNICK & RASSMITH
  4695*                                FROM SYS008 ONLY
  4696* 102704    2004101400003  PEMA  REMOVE IARO RMRO-N RMRO-S
  4697******************************************************************
  4698*
  4699*  THE "COPY" STMT. WAS CHANGED TO COPY "PRTN036" INTO ECS036.
  4700*
  4701*  CID WISHES TO PRINT ONLY SELECTED ACCOUNT REPORTS ON 1 COPY OF
  4702*    THE PAPER REPORT AND YET ALLOW ALL RECORDS PRINT ON A SECOND
  4703*    PAPER REPORT AND ON THE FICH REPORT.
  4704*
  4705*  CID WANTS 1 COPY EACH OF BOTH REPORT CODES, AND A SECOND COPY
  4706*  OF THE SELECTED ACCOUNTS FOR BOTH REPORT CODES.
  4707*
  4708*  THE CHANGES TO DO THIS HAVE BEEN ADDED IN THIS ROUTINE, AS
  4709*    WELL AS IN OTHER ROUTINES IN THIS PROGRAM.
  4710*
  4711*  SELECTED ACCOUNTS ARE WRITTEN TO SYS050 FOR PRINTING.
  4712*
  4713******************************************************************
  4714*                                                                *
  4715*                         ELCPRTN                                *
  4716*                         VMOD=2.002                             *
  4717*                                                                *
  4718******************************************************************
  4719
  4720     MOVE PRT TO SELECT-RECORD.
  4721
  4722     IF SLCT-REC (1:2) = 'Y '
  4723         MOVE SPACES TO P-DATA (1:22)
  4724     END-IF.
  4725
  4726     IF DTE-FICH NOT = SPACE AND
  4727        FICH-OPEN    = SPACE
  4728         MOVE 'X' TO FICH-OPEN
  4729         OPEN OUTPUT FICH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* ECS036.cbl (/apps/prod/cid1p/copy/PRTN036)
  4730
  4731     IF DTE-FICH NOT = SPACE
  4732         MOVE X TO P-CTL
  4733         WRITE FICH-REC FROM PRT.
  4734
  4735     IF SLCT-FLD-1 = 'RPT CODE 1 ' OR 'RPT CODE 2 '
  4736        NEXT SENTENCE
  4737      ELSE
  4738         GO TO 9025-CK-SELECT-PRT.
  4739
  4740     IF SLCT-FLD-1 = 'RPT CODE 1 '
  4741      IF SLCT-FLD-2 = 'LATIMER   '
  4742        MOVE 'YES' TO PRINT-SELECT-SW
  4743          GO TO 9025-CK-SELECT-PRT.
  4744
  4745
  4746     IF SLCT-FLD-1 = 'RPT CODE 1 '
  4747      IF SLCT-FLD-2 = 'HODGE     '
  4748        MOVE 'YES' TO PRINT-SELECT-SW
  4749          GO TO 9025-CK-SELECT-PRT.
  4750
  4751     IF SLCT-FLD-1 = 'RPT CODE 1 '
  4752      IF SLCT-FLD-2 = 'MIDWEST   '
  4753        MOVE 'YES' TO PRINT-SELECT-SW
  4754          GO TO 9025-CK-SELECT-PRT.
  4755
  4756     IF SLCT-FLD-1 = 'RPT CODE 1 '
  4757      IF SLCT-FLD-2 = 'KBA       '
  4758        MOVE 'YES' TO PRINT-SELECT-SW
  4759          GO TO 9025-CK-SELECT-PRT.
  4760
  4761 9015-CK-RPT-CODE-2.
  4762
  4763     IF SLCT-FLD-1 = 'RPT CODE 2 '
  4764      IF SLCT-FLD-2 = 'KENT      '
  4765        MOVE 'YES' TO PRINT-SELECT-SW
  4766         GO TO 9025-CK-SELECT-PRT.
  4767
  4768 9020-NO-MATCH.
  4769
  4770     MOVE 'NO ' TO PRINT-SELECT-SW.
  4771
  4772
  4773 9025-CK-SELECT-PRT.
  4774
  4775     IF  PRINT-SELECT-SW  =  'YES'
  4776          IF SLCT-REC (1:2) = 'Y '
  4777              MOVE SPACES TO SLCT-FLD-1
  4778              MOVE SPACES TO SLCT-FLD-2
  4779              MOVE SPACE  TO SLCT-REC (1:1)
  4780          END-IF
  4781
  4782          MOVE X TO SELECT-CC
  4783
  4784          EVALUATE SELECT-CC
  4785          WHEN ' '
  4786              WRITE SELECT-RECORD AFTER ADVANCING 1 LINE
  4787          WHEN '0'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* ECS036.cbl (/apps/prod/cid1p/copy/PRTN036)
  4788              WRITE SELECT-RECORD AFTER ADVANCING 2 LINE
  4789          WHEN '-'
  4790              WRITE SELECT-RECORD AFTER ADVANCING 3 LINE
  4791          WHEN OTHER
  4792              WRITE SELECT-RECORD AFTER ADVANCING PAGE
  4793          END-EVALUATE
  4794     END-IF
  4795
  4796     MOVE SPACES TO SELECT-RECORD.
  4797
  4798**
  4799**  BYPASS PRINTING THE "A", "B", AND "C" REPORTS.
  4800**
  4801     IF HD-1-GRP-SUF = 'A' OR 'B' OR 'C'
  4802         GO TO 9030-EXIT
  4803     END-IF.
  4804
  4805     IF HD-1-SLCT-FLD-1 = 'RPT CODE 1 '
  4806        AND (HD-1-SLCT-FLD-2 = 'HORNICK   '
  4807             OR 'RASSMITH  '
  4808             OR 'IARO      ' OR 'RMRO-N    '
  4809             OR 'RMRO-S    ')
  4810         GO TO 9030-EXIT
  4811     END-IF.
  4812
  4813     IF DTE-FICH = SPACE OR '2'
  4814         MOVE X                    TO  P-CTL
  4815         EVALUATE P-CTL
  4816         WHEN ' '
  4817             WRITE PRT AFTER ADVANCING 1 LINE
  4818         WHEN '0'
  4819             WRITE PRT AFTER ADVANCING 2 LINE
  4820         WHEN '-'
  4821             WRITE PRT AFTER ADVANCING 3 LINE
  4822         WHEN OTHER
  4823             WRITE PRT AFTER ADVANCING PAGE
  4824         END-EVALUATE
  4825     END-IF.
  4826
  4827
  4828 9030-EXIT.
  4829     EXIT.
  4830
  4831******************************************************************
  4832
  4833 1199-EXIT.
  4834     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  96
* ECS036.cbl
  4836 1200-LOAD-ALPHA-MONTH.
  4837     IF DTE-CLIENT = 'HER'
  4838         NEXT SENTENCE
  4839     ELSE
  4840         GO TO 1210-LOAD-ALPHA-MONTH.
  4841
  4842     IF DET-MO-2 = '01 '
  4843         MOVE 'JAN'              TO  DET-MO-2.
  4844
  4845     IF DET-MO-2 = '02 '
  4846         MOVE 'FEB'              TO  DET-MO-2.
  4847
  4848     IF DET-MO-2 = '03 '
  4849         MOVE 'MAR'              TO  DET-MO-2.
  4850
  4851     IF DET-MO-2 = '04 '
  4852         MOVE 'APR'              TO  DET-MO-2.
  4853
  4854     IF DET-MO-2 = '05 '
  4855         MOVE 'MAY'              TO  DET-MO-2.
  4856
  4857     IF DET-MO-2 = '06 '
  4858         MOVE 'JUN'              TO  DET-MO-2.
  4859
  4860     IF DET-MO-2 = '07 '
  4861         MOVE 'JUL'              TO  DET-MO-2.
  4862
  4863     IF DET-MO-2 = '08 '
  4864         MOVE 'AUG'              TO  DET-MO-2.
  4865
  4866     IF DET-MO-2 = '09 '
  4867         MOVE 'SEP'              TO  DET-MO-2.
  4868
  4869     IF DET-MO-2 = '10 '
  4870         MOVE 'OCT'              TO  DET-MO-2.
  4871
  4872     IF DET-MO-2 = '11 '
  4873         MOVE 'NOV'              TO  DET-MO-2.
  4874
  4875     IF DET-MO-2 = '12 '
  4876         MOVE 'DEC'              TO  DET-MO-2.
  4877
  4878     GO TO 1299-EXIT.
  4879
  4880 1210-LOAD-ALPHA-MONTH.
  4881     IF DET-MO = '01 ' MOVE 'JAN' TO DET-MO.
  4882     IF DET-MO = '02 ' MOVE 'FEB' TO DET-MO.
  4883     IF DET-MO = '03 ' MOVE 'MAR' TO DET-MO.
  4884     IF DET-MO = '04 ' MOVE 'APR' TO DET-MO.
  4885     IF DET-MO = '05 ' MOVE 'MAY' TO DET-MO.
  4886     IF DET-MO = '06 ' MOVE 'JUN' TO DET-MO.
  4887     IF DET-MO = '07 ' MOVE 'JUL' TO DET-MO.
  4888     IF DET-MO = '08 ' MOVE 'AUG' TO DET-MO.
  4889     IF DET-MO = '09 ' MOVE 'SEP' TO DET-MO.
  4890     IF DET-MO = '10 ' MOVE 'OCT' TO DET-MO.
  4891     IF DET-MO = '11 ' MOVE 'NOV' TO DET-MO.
  4892     IF DET-MO = '12 ' MOVE 'DEC' TO DET-MO.
  4893
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  97
* ECS036.cbl
  4894 1299-EXIT.
  4895      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  98
* ECS036.cbl
  4897 1300-PRINT-GRAND-TOTALS.
  4898     IF ZERO-GRAND-TOTALS = GRAND-TOTALS
  4899         GO TO 1399-EXIT.
  4900
  4901     PERFORM 1000-GR-HD.
  4902     MOVE +1                     TO X1.
  4903
  4904 1310-GRAND-TOTAL-1.
  4905     IF DTE-CLIENT = 'HER'
  4906         NEXT SENTENCE
  4907     ELSE
  4908         GO TO 1330-GRAND-TOTAL-1.
  4909
  4910     IF X1 GREATER 12
  4911         GO TO 1320-GRAND-TOTAL-2.
  4912
  4913     MOVE GT-DATE (X1)           TO  SAVE-HER-HI-CERT.
  4914
  4915     IF (GT-CERT (X1) = ZEROS
  4916        OR GT-ISS (X1) EQUAL ZEROS)
  4917         MOVE SPACES             TO  DET-FILL
  4918     ELSE
  4919         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  4920         MOVE '/'                TO  DET-HI-SLASH
  4921         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  4922         MOVE 0                  TO  SAVE-HER-HI-CERT.
  4923
  4924     MOVE GT-CERT (X1)           TO  DET-CERTS-2.
  4925     MOVE GT-ISS  (X1)           TO  DET-ISS-COUNT-2.
  4926     MOVE GT-LBEN (X1)           TO  DET-LBEN-2.
  4927     MOVE GT-LPRM (X1)           TO  DET-LPRM-2.
  4928     MOVE GT-LCLM (X1)           TO  DET-LCLM-2.
  4929     MOVE GT-APRM (X1)           TO  DET-APRM-2.
  4930     MOVE GT-ACLM (X1)           TO  DET-ACLM-2.
  4931     MOVE GT-TPRM (X1)           TO  DET-TPRM-2.
  4932     MOVE GT-TCOM (X1)           TO  DET-TCOM-2.
  4933
  4934     ADD +1                      TO  X1.
  4935
  4936     MOVE COMP-YR (X1)           TO  DET-YR-2.
  4937     MOVE COMP-MO (X1)           TO  DET-MO-2.
  4938
  4939     PERFORM 1200-LOAD-ALPHA-MONTH  THRU  1299-EXIT.
  4940
  4941     MOVE DETAIL-LINE-2          TO  P-DATA.
  4942
  4943     IF X1 = 2
  4944         MOVE '0'                TO  X
  4945     ELSE
  4946         MOVE ' '                TO  X.
  4947
  4948     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4949
  4950     GO TO 1310-GRAND-TOTAL-1.
  4951
  4952 1320-GRAND-TOTAL-2.
  4953     MOVE 'GRAND TOTALS'         TO  DET-TITLE-2.
  4954     MOVE '-'                    TO  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  99
* ECS036.cbl
  4955     MOVE GR-LBEN                TO  DET-LBEN-2.
  4956     MOVE GR-LPRM                TO  DET-LPRM-2.
  4957     MOVE GR-LCLM                TO  DET-LCLM-2.
  4958     MOVE GR-APRM                TO  DET-APRM-2.
  4959     MOVE GR-ACLM                TO  DET-ACLM-2.
  4960     MOVE GR-TPRM                TO  DET-TPRM-2.
  4961     MOVE GR-TCOM                TO  DET-TCOM-2.
  4962     MOVE DETAIL-LINE-2          TO  P-DATA.
  4963
  4964     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4965
  4966     MOVE SPACES                 TO  DET-TITLE-2.
  4967     MOVE ZERO-GRAND-TOTALS      TO  GRAND-TOTALS.
  4968
  4969     GO TO 1399-EXIT.
  4970
  4971 1330-GRAND-TOTAL-1.
  4972     IF X1 GREATER 12
  4973         GO TO 1340-GRAND-TOTAL-2.
  4974
  4975     MOVE GT-LBEN (X1)           TO DET-LBEN.
  4976     MOVE GT-LPRM (X1)           TO DET-LPRM.
  4977     MOVE GT-LCLM (X1)           TO DET-LCLM.
  4978     MOVE GT-ABEN (X1)           TO DET-ABEN.
  4979     MOVE GT-APRM (X1)           TO DET-APRM.
  4980     MOVE GT-ACLM (X1)           TO DET-ACLM.
  4981     MOVE GT-TPRM (X1)           TO DET-TPRM.
  4982     MOVE GT-TCOM (X1)           TO DET-TCOM.
  4983     ADD +1 TO X1.
  4984     MOVE COMP-YR (X1)           TO DET-YR.
  4985     MOVE COMP-MO (X1)           TO DET-MO.
  4986     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  4987     MOVE DETAIL-LINE            TO P-DATA.
  4988
  4989     IF X1 = 2
  4990         MOVE '0' TO X
  4991     ELSE
  4992         MOVE ' ' TO X.
  4993
  4994     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4995     GO TO 1330-GRAND-TOTAL-1.
  4996
  4997 1340-GRAND-TOTAL-2.
  4998     MOVE L12GT-LBEN             TO DET-LBEN.
  4999     MOVE L12GT-LPRM             TO DET-LPRM.
  5000     MOVE L12GT-LCLM             TO DET-LCLM.
  5001     MOVE L12GT-ABEN             TO DET-ABEN.
  5002     MOVE L12GT-APRM             TO DET-APRM.
  5003     MOVE L12GT-ACLM             TO DET-ACLM.
  5004     MOVE L12GT-TPRM             TO DET-TPRM.
  5005     MOVE L12GT-TCOM             TO DET-TCOM.
  5006     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  5007
  5008     MOVE '0'                    TO X.
  5009     MOVE DETAIL-LINE            TO P-DATA.
  5010     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5011     MOVE ZERO-ACCUM             TO LAST-12-GRAND-ACCUM.
  5012
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 100
* ECS036.cbl
  5013 1350-PRINT-GRAND-YTD.
  5014     MOVE YTDGT-LBEN             TO DET-LBEN.
  5015     MOVE YTDGT-LPRM             TO DET-LPRM.
  5016     MOVE YTDGT-LCLM             TO DET-LCLM.
  5017     MOVE YTDGT-ABEN             TO DET-ABEN.
  5018     MOVE YTDGT-APRM             TO DET-APRM.
  5019     MOVE YTDGT-ACLM             TO DET-ACLM.
  5020     MOVE YTDGT-TPRM             TO DET-TPRM.
  5021     MOVE YTDGT-TCOM             TO DET-TCOM.
  5022     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  5023     MOVE ' '                    TO X.
  5024     MOVE DETAIL-LINE            TO P-DATA.
  5025     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5026     MOVE SPACES                 TO DET-TITLE.
  5027     MOVE ZERO-ACCUM             TO YTD-GRAND-ACCUM.
  5028
  5029     MOVE PYTDGT-LBEN            TO DET-LBEN.
  5030     MOVE PYTDGT-LPRM            TO DET-LPRM.
  5031     MOVE PYTDGT-LCLM            TO DET-LCLM.
  5032     MOVE PYTDGT-ABEN            TO DET-ABEN.
  5033     MOVE PYTDGT-APRM            TO DET-APRM.
  5034     MOVE PYTDGT-ACLM            TO DET-ACLM.
  5035     MOVE PYTDGT-TPRM            TO DET-TPRM.
  5036     MOVE PYTDGT-TCOM            TO DET-TCOM.
  5037     MOVE 'PRIOR YTD         '   TO DET-TITLE.
  5038     MOVE ' '                    TO X.
  5039     MOVE DETAIL-LINE            TO P-DATA.
  5040     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5041     MOVE SPACES                 TO DET-TITLE.
  5042     MOVE ZERO-ACCUM             TO PYTD-GRAND-ACCUM
  5043
  5044*02722      MOVE 'GRAND TOTALS'         TO DET-TITLE.
  5045*02723      MOVE '-'                    TO X.
  5046*02724      MOVE GR-LBEN                TO DET-LBEN.
  5047*02725      MOVE GR-LPRM                TO DET-LPRM.
  5048*02726      MOVE GR-LCLM                TO DET-LCLM.
  5049*02727      MOVE GR-ABEN                TO DET-ABEN.
  5050*02728      MOVE GR-APRM                TO DET-APRM.
  5051*02729      MOVE GR-ACLM                TO DET-ACLM.
  5052*02730      MOVE GR-TPRM                TO DET-TPRM.
  5053*02731      MOVE GR-TCOM                TO DET-TCOM.
  5054*02732      MOVE DETAIL-LINE            TO P-DATA.
  5055*02733      PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5056     MOVE ZERO-GRAND-TOTALS      TO GRAND-TOTALS.
  5057
  5058 1399-EXIT.
  5059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 101
* ECS036.cbl
  5061 1400-STATE-LOOKUP.
* 5062                             COPY ECSSTLOK.
  5063******************************************************************07/10/97
  5064*                                                                *ECSSTLOK
  5065*                            ECSSTLOK                            *   LV001
  5066*                            VMOD=2.001                         * ECSSTLOK
  5067*                                                                *ECSSTLOK
  5068*  NO  CID  MODS  IN  COPYBOOK  ECSSTLOK                         *ECSSTLOK
  5069*                                                                *ECSSTLOK
  5070******************************************************************ECSSTLOK
  5071 STATE--START.                                                    ECSSTLOK
  5072     MOVE ZERO TO CLAS-INDEXS.                                    ECSSTLOK
  5073                                                                  ECSSTLOK
  5074 STATE--LOOP.                                                     ECSSTLOK
  5075     ADD 1 TO CLAS-INDEXS.                                        ECSSTLOK
  5076     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS                     ECSSTLOK
  5077         MOVE SPACE TO STATE-L                                    ECSSTLOK
  5078         GO TO STATE--EXIT.                                       ECSSTLOK
  5079                                                                  ECSSTLOK
  5080     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)                     ECSSTLOK
  5081         GO TO STATE--LOOP.                                       ECSSTLOK
  5082                                                                  ECSSTLOK
  5083 STATE--EXIT.                                                     ECSSTLOK
  5084     EXIT.
  5085******************************************************************ECSSTLOK
  5086 1499-EXIT.
  5087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 102
* ECS036.cbl
  5089 1500-PASS-NUMBER-CHANGE.
  5090     MOVE ZERO                   TO SET-CTR.
  5091
  5092     IF PASS-NUMBER = '4'
  5093         IF DTE-TOT-OPT = 1 OR 3 OR 6
  5094             NEXT SENTENCE
  5095         ELSE
  5096         IF DTE-TOT-OPT = 5 OR 7
  5097             PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  5098             MOVE '1'            TO SKIP-HD-SW
  5099             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5100         ELSE
  5101             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  5102
  5103     IF PASS-NUMBER = '5'
  5104         IF DTE-TOT-OPT = 1 OR 2 OR 5
  5105             NEXT SENTENCE
  5106         ELSE
  5107         IF DTE-TOT-OPT = 6 OR 7
  5108             PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  5109             MOVE '1'            TO SKIP-HD-SW
  5110             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5111           ELSE
  5112             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  5113
  5114     IF PASS-NUMBER = '6'
  5115         IF DTE-TOT-OPT = 1 OR 3 OR 6
  5116             NEXT SENTENCE
  5117         ELSE
  5118         IF DTE-TOT-OPT = 5 OR 7
  5119             PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  5120             MOVE '1'            TO SKIP-HD-SW
  5121             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5122         ELSE
  5123             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  5124
  5125     IF PASS-NUMBER = '7'
  5126         MOVE ' '                TO SKIP-HD-SW
  5127         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5128         MOVE '1'                TO SKIP-HD-SW
  5129         PERFORM 1700-REPTCD2-BREAK THRU 1790-ZERO-REPTCD2
  5130         MOVE '2'            TO  SKIP-HD-SW
  5131         PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  5132     END-IF.
  5133
  5134     IF PASS-NUMBER = '1'
  5135         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5136     ELSE
  5137         IF PASS-NUMBER = '4' OR '6' OR '7'
  5138             NEXT SENTENCE
  5139         ELSE
  5140         IF PASS-NUMBER = '5'
  5141             PERFORM 0605-CARRIER-BREAK-5 THRU 0680-ZERO-CARRIER
  5142         ELSE
  5143             PERFORM 0600-CARRIER-BREAK THRU 0680-ZERO-CARRIER.
  5144
  5145     PERFORM 1300-PRINT-GRAND-TOTALS THRU 1399-EXIT.
  5146
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 103
* ECS036.cbl
  5147     IF EOF-EPX = '1'
  5148         GO TO 9000-END-OF-JOB.
  5149
  5150     IF PASS-NUMBER = '7'
  5151         GO TO 9000-END-OF-JOB.
  5152
  5153     MOVE ZERO                   TO PAGE-CNT
  5154                                    X1.
  5155     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  5156     MOVE +0                     TO X1.
  5157     PERFORM 0230-ZERO-ACCUM-ACC 15 TIMES.
  5158     MOVE +0                     TO X1.
  5159     PERFORM 0240-ZERO-ACCUM-GRP 15 TIMES.
  5160     MOVE +0                     TO X1.
  5161     PERFORM 0250-ZERO-ACCUM-CARR 15 TIMES.
  5162     MOVE +0                     TO X1.
  5163     PERFORM 0255-ZERO-ACCUM-STATE 15 TIMES.
  5164     MOVE +0                     TO X1.
  5165     PERFORM 0256-ZERO-ACCUM-REPT2 15 TIMES.
  5166     MOVE +0                     TO X1.
  5167     PERFORM 0260-ZERO-ACCUM-REPT 15 TIMES.
  5168     MOVE +0                     TO X1.
  5169     PERFORM 0270-ZERO-ACCUM-GRAND 15 TIMES.
  5170     MOVE ZERO-GRAND-TOTALS      TO GRAND-TOTALS.
  5171     MOVE ZERO-ACCUM TO LAST-12-ACCOUNT-ACCUM YTD-ACCOUNT-ACCUM
  5172                    LAST-12-GROUPING-ACCUM  LAST-12-CARRIER-ACCUM
  5173                    LAST-12-REPTCD-ACCUM    LAST-12-STATE-ACCUM
  5174                    YTD-GROUPING-ACCUM      YTD-CARRIER-ACCUM
  5175                    YTD-REPTCD-ACCUM        YTD-STATE-ACCUM
  5176                    PYTD-GROUPING-ACCUM     PYTD-CARRIER-ACCUM
  5177                    PYTD-REPTCD-ACCUM       PYTD-STATE-ACCUM
  5178                    LAST-12-GRAND-ACCUM     YTD-GRAND-ACCUM
  5179                    PYTD-GRAND-ACCUM
  5180                    LAST-12-REPTCD2-ACCUM   YTD-REPTCD2-ACCUM
  5181                    PYTD-REPTCD2-ACCUM
  5182*                   PL12-GROUPING-ACCUM     PL12-CARRIER-ACCUM
  5183*                   PL12-REPTCD-ACCUM       PL12-STATE-ACCUM
  5184*                   ITD-GROUPING-ACCUM      ITD-CARRIER-ACCUM
  5185*                   ITD-REPTCD-ACCUM        ITD-STATE-ACCUM.
  5186     MOVE ZERO                   TO CERT
  5187                                    LBEN
  5188                                    LPRM
  5189                                    LCLM
  5190                                    ABEN
  5191                                    APRM
  5192                                    ACLM
  5193                                    TPRM
  5194                                    TCOM
  5195                                    ISS.
  5196
  5197     MOVE SPACE                  TO DET-TITLE.
  5198
  5199     MOVE EP-PASS-NO             TO PASS-NUMBER.
  5200
  5201     GO TO 0340-ACCUMULATE.
  5202
  5203 1510-BUSS-LOOKUP.
  5204     MOVE CLAS-STARTB            TO CLAS-INDEXB.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 104
* ECS036.cbl
  5205     MOVE S-EPX-CNTL-1           TO WORK-BUSC.
  5206
  5207 1520-BUSS-LOOP.
  5208     IF CLAS-INDEXB GREATER CLAS-MAXB
  5209         MOVE 'INVALID BUS TYPE' TO HD-STATE
  5210         GO TO 1599-EXIT.
  5211
  5212     IF WORK-BUSC = CLAS-BUSC-CODE (CLAS-INDEXB)
  5213         MOVE CLAS-BUSC-DESC (CLAS-INDEXB) TO HD-STATE
  5214         GO TO 1599-EXIT.
  5215
  5216     ADD +1 TO CLAS-INDEXB.
  5217     GO TO 1520-BUSS-LOOP.
  5218
  5219 1599-EXIT.
  5220     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 105
* ECS036.cbl
  5222 1700-REPTCD2-BREAK.
  5223     MOVE +0                     TO X1.
  5224     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  5225     PERFORM 0800-PRINT-DECISION THRU 0899-EXIT.
  5226
  5227     IF P-RP2-SW = '1'
  5228         MOVE ' '                TO P-RP2-SW
  5229     ELSE
  5230         GO TO 1790-ZERO-REPTCD2.
  5231
  5232     PERFORM 0900-HEAD-RTN THRU 0999-EXIT.
  5233
  5234     MOVE +1                     TO X1.
  5235     MOVE +0                     TO Y1.
  5236
  5237 1720-REPTCD2-BREAK-POINT.
  5238     ADD +1 TO X1 Y1.
  5239
  5240     IF X1 GREATER THAN 13
  5241         GO TO 1770-PRINT-LAST-RP2-12.
  5242
  5243     COMPUTE RP2CERT = RP2-CERT (X1) - RP2-CERT (Y1).
  5244     COMPUTE RP2LBEN = RP2-LBEN (X1) - RP2-LBEN (Y1).
  5245     COMPUTE RP2LPRM = RP2-LPRM (X1) - RP2-LPRM (Y1).
  5246     COMPUTE RP2LCLM = RP2-LCLM (X1) - RP2-LCLM (Y1).
  5247     COMPUTE RP2ABEN = RP2-ABEN (X1) - RP2-ABEN (Y1).
  5248     COMPUTE RP2APRM = RP2-APRM (X1) - RP2-APRM (Y1).
  5249     COMPUTE RP2ACLM = RP2-ACLM (X1) - RP2-ACLM (Y1).
  5250     COMPUTE RP2TCOM = RP2-TCOM (X1) - RP2-TCOM (Y1).
  5251     COMPUTE RP2TPRM = RP2LPRM  + RP2APRM.
  5252     MOVE COMP-YR (X1)           TO DET-YR.
  5253     MOVE COMP-MO (X1)           TO DET-MO.
  5254     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  5255
  5256     MOVE RP2CERT                TO DET-CERTS.
  5257     MOVE RP2LBEN                TO DET-LBEN.
  5258     MOVE RP2LPRM                TO DET-LPRM.
  5259     MOVE RP2LCLM                TO DET-LCLM.
  5260     MOVE RP2ABEN                TO DET-ABEN.
  5261     MOVE RP2APRM                TO DET-APRM.
  5262     MOVE RP2ACLM                TO DET-ACLM.
  5263     MOVE RP2TPRM                TO DET-TPRM.
  5264     MOVE RP2TCOM                TO DET-TCOM.
  5265
  5266     IF COMP-YR (X1) = CONV-YR AND
  5267        COMP-MO (X1) = CONV-MO
  5268         MOVE ZEROS TO DET-CERTS DET-LBEN DET-LPRM
  5269                       DET-ABEN DET-APRM DET-LCLM
  5270                       DET-ACLM DET-TPRM DET-TCOM
  5271        ELSE
  5272          PERFORM 1730-ADD-TO-L12-YTD THRU 1740-EXIT.
  5273
  5274     MOVE DETAIL-LINE            TO P-DATA.
  5275
  5276     IF X1 = 2
  5277         MOVE '0'                TO X
  5278     ELSE
  5279         MOVE ' '                TO X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 106
* ECS036.cbl
  5280
  5281     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5282     GO TO 1720-REPTCD2-BREAK-POINT.
  5283
  5284 1730-ADD-TO-L12-YTD.
  5285     IF COMPARE9DT (X1) GREATER YEAR-OLD-DATE
  5286         ADD RP2LBEN TO L12RP2-LBEN
  5287         ADD RP2LPRM TO L12RP2-LPRM
  5288         ADD RP2LCLM TO L12RP2-LCLM
  5289         ADD RP2ABEN TO L12RP2-ABEN
  5290         ADD RP2APRM TO L12RP2-APRM
  5291         ADD RP2ACLM TO L12RP2-ACLM
  5292         ADD RP2TPRM TO L12RP2-TPRM
  5293         ADD RP2TCOM TO L12RP2-TCOM.
  5294
  5295     IF RUN-YR = COMP-YR (X1)
  5296         ADD RP2LBEN TO YTDRP2-LBEN
  5297         ADD RP2LPRM TO YTDRP2-LPRM
  5298                        YTDRP2-TPRM
  5299         ADD RP2LCLM TO YTDRP2-LCLM
  5300         ADD RP2TCOM TO YTDRP2-TCOM
  5301         ADD RP2ABEN TO YTDRP2-ABEN
  5302         ADD RP2APRM TO YTDRP2-APRM
  5303                        YTDRP2-TPRM
  5304         ADD RP2ACLM TO YTDRP2-ACLM.
  5305
  5306     IF X1 = 13
  5307        COMPUTE PYTDRP2-LBEN = PYTDRP2-LBEN +
  5308           (RP2-LBEN (1) - RP2-LBEN (15))
  5309        COMPUTE PYTDRP2-LPRM = PYTDRP2-LPRM +
  5310           (RP2-LPRM (1) - RP2-LPRM (15))
  5311        COMPUTE PYTDRP2-LCLM = PYTDRP2-LCLM +
  5312           (RP2-LCLM (1) - RP2-LCLM (15))
  5313        COMPUTE PYTDRP2-ABEN = PYTDRP2-ABEN +
  5314           (RP2-ABEN (1) - RP2-ABEN (15))
  5315        COMPUTE PYTDRP2-APRM = PYTDRP2-APRM +
  5316           (RP2-APRM (1) - RP2-APRM (15))
  5317        COMPUTE PYTDRP2-ACLM = PYTDRP2-ACLM +
  5318           (RP2-ACLM (1) - RP2-ACLM (15))
  5319        COMPUTE PYTDRP2-TPRM = PYTDRP2-TPRM +
  5320           (RP2-TPRM (1) - RP2-TPRM (15))
  5321        COMPUTE PYTDRP2-TCOM = PYTDRP2-TCOM +
  5322           (RP2-TCOM (1) - RP2-TCOM (15))
  5323     END-IF
  5324
  5325     .
  5326 1740-EXIT.
  5327      EXIT.
  5328
  5329 1770-PRINT-LAST-RP2-12.
  5330     MOVE L12RP2-LBEN            TO DET-LBEN.
  5331     MOVE L12RP2-LPRM            TO DET-LPRM.
  5332     MOVE L12RP2-LCLM            TO DET-LCLM.
  5333     MOVE L12RP2-ABEN            TO DET-ABEN.
  5334     MOVE L12RP2-APRM            TO DET-APRM.
  5335     MOVE L12RP2-ACLM            TO DET-ACLM.
  5336     MOVE L12RP2-TPRM            TO DET-TPRM.
  5337     MOVE L12RP2-TCOM            TO DET-TCOM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 107
* ECS036.cbl
  5338     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  5339
  5340     MOVE '0'                    TO X.
  5341     MOVE DETAIL-LINE            TO P-DATA.
  5342     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5343     MOVE ZERO-ACCUM             TO LAST-12-REPTCD2-ACCUM.
  5344
  5345     MOVE SPACES                 TO DET-TITLE
  5346     .
  5347 1780-PRINT-RP2-YTD.
  5348     MOVE YTDRP2-LBEN            TO DET-LBEN.
  5349     MOVE YTDRP2-LPRM            TO DET-LPRM.
  5350     MOVE YTDRP2-LCLM            TO DET-LCLM.
  5351     MOVE YTDRP2-ABEN            TO DET-ABEN.
  5352     MOVE YTDRP2-APRM            TO DET-APRM.
  5353     MOVE YTDRP2-ACLM            TO DET-ACLM.
  5354     MOVE YTDRP2-TPRM            TO DET-TPRM.
  5355     MOVE YTDRP2-TCOM            TO DET-TCOM.
  5356     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  5357     MOVE ' '                    TO X.
  5358     MOVE DETAIL-LINE            TO P-DATA.
  5359     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5360     MOVE SPACES                 TO DET-TITLE.
  5361     MOVE ZERO-ACCUM             TO YTD-REPTCD2-ACCUM.
  5362
  5363     MOVE PYTDRP2-LBEN           TO DET-LBEN
  5364     MOVE PYTDRP2-LPRM           TO DET-LPRM
  5365     MOVE PYTDRP2-LCLM           TO DET-LCLM
  5366     MOVE PYTDRP2-ABEN           TO DET-ABEN
  5367     MOVE PYTDRP2-APRM           TO DET-APRM
  5368     MOVE PYTDRP2-ACLM           TO DET-ACLM
  5369     MOVE PYTDRP2-TPRM           TO DET-TPRM
  5370     MOVE PYTDRP2-TCOM           TO DET-TCOM
  5371     MOVE 'PRIOR YTD         '   TO DET-TITLE
  5372     MOVE ' '                    TO X
  5373     MOVE DETAIL-LINE            TO P-DATA
  5374     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  5375
  5376     MOVE SPACES                 TO DET-TITLE
  5377     MOVE ZERO-ACCUM             TO PYTD-REPTCD2-ACCUM.
  5378     .
  5379 1790-ZERO-REPTCD2.
  5380     MOVE +0                     TO X1.
  5381     PERFORM 0256-ZERO-ACCUM-REPT2 15 TIMES.
  5382
  5383 1799-REPTCD2-RETURN.
  5384     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 108
* ECS036.cbl
* 5386 COPY ELCDCS.
  5387****************************************************************  04/15/98
  5388*                                                              *  ELCDCS
  5389*                                                              *  ELCDCS
  5390*                            ELCDCS.                           *     LV003
  5391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5392*                            VMOD=2.002                        *     CL**3
  5393*                                                              *  ELCDCS
  5394*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  5395****************************************************************. ELCDCS
  5396                                                                  ELCDCS
  5397 8510-DATE-CONVERSION.                                            ELCDCS
  5398     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5399                                                                  ELCDCS
  5400 8590-EXIT.                                                       ELCDCS
  5401     EXIT.                                                        ELCDCS
  5402                                                                  ELCDCS
  5403 9000-END-OF-JOB.
* 5404                             COPY ELCPRTC.
  5405******************************************************************04/15/98
  5406*                                                                *ELCPRTC
  5407*                                                                *ELCPRTC
  5408*                            ELCPRTC.                            *   LV003
  5409*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5410*                            VMOD=2.002                          *   CL**2
  5411*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  5412*                                                                *ELCPRTC
  5413* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  5414******************************************************************ELCPRTC
  5415                                                                  ELCPRTC
  5416      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  5417          CLOSE FICH.                                             ELCPRTC
  5418                                                                  ELCPRTC
  5419******************************************************************ELCPRTC
  5420     CLOSE PRNT.
  5421     CLOSE SELECT-FILE.
  5422
  5423 9099-EXIT.
  5424     EXIT.
  5425
  5426 ABEND-PGM SECTION.
*                                      COPY ELCABEND.
  5427***************************************************************** 04/14/98
  5428*                                                               * ELCABEND
  5429*                            ELCABEND.                          *    LV003
  5430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5431*                            VMOD 2.002                              CL**2
  5432*                                                               * ELCABEND
  5433*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  5434*            AND THEN ABENDS.                                   * ELCABEND
  5435*                                                               * ELCABEND
  5436*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  5437*                                                               * ELCABEND
  5438***************************************************************** ELCABEND
  5439*APS-010.                                                         ELCABEND
  5440     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  5441     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  5442                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 109
* ECS036.cbl (/apps/prod/cid1p/copy/ELCABEND)
  5443     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  5444         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5445         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5446                                 UPON CONSOLE.                    ELCABEND
  5447                                                                  ELCABEND
  5448     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  5449         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5450         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5451                                 UPON CONSOLE.                    ELCABEND
  5452                                                                  ELCABEND
  5453     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5454     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5455                                 UPON CONSOLE.                    ELCABEND
  5456                                                                  ELCABEND
  5457     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  5458     CALL 'ABORTME'.
  5459                                                                  ELCABEND
  5460 APS-EXIT.                                                        ELCABEND
  5461     EXIT.                                                        ELCABEND
  5462
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       63452     Code:       32909
