* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL517 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/08/94 08:12:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.040.
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   2
* EL517.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    27*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    38* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    39*                                IS OPEN OR CNC DT < PD THRU
    40*                                ALSO ADD ALTERNATE KEY CLAUSE
    41* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    42* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    43* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    44* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    45* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    46* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    47* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    48* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    49* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    50* 061412  CR2011022800001  AJRA  NAPERSOFT
    51* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    54* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    55* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    56* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    57* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    58* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    59* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    60* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    61******************************************************************
    62
    63 ENVIRONMENT DIVISION.
    64
    65 INPUT-OUTPUT SECTION.
    66
    67 FILE-CONTROL.
    68
    69     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    70
    71     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   3
* EL517.cbl
    72                             ORGANIZATION IS INDEXED
    73                             ACCESS IS DYNAMIC
    74                             RECORD KEY IS CF-CONTROL-PRIMARY
    75                             FILE STATUS IS ELCNTL-FILE-STATUS.
    76
    77     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    78                             ORGANIZATION IS INDEXED
    79                             ACCESS IS SEQUENTIAL
    80                             RECORD KEY IS PB-CONTROL-PRIMARY
    81                             ALTERNATE RECORD KEY IS
    82                                 PB-CONTROL-BY-ACCOUNT
    83                             FILE STATUS IS ERPNDB-FILE-STATUS.
    84
    85     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    86                             ORGANIZATION IS INDEXED
    87                             ACCESS IS DYNAMIC
    88                             RECORD KEY IS RE-CONTROL-PRIMARY
    89                             FILE STATUS IS ERREIN-FILE-STATUS.
    90
    91     SELECT ELCERT
*                                  COPY ELCCERTS.
    92******************************************************************04/15/98
    93*                                                                *ELCCERTS
    94*                            ELCCERTS.                           *   LV002
    95*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    96*                            VMOD=2.001                          *ELCCERTS
    97*                                                                *ELCCERTS
    98*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    99*                                                                *ELCCERTS
   100*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
   101******************************************************************ELCCERTS
   102                                                                  ELCCERTS
   103         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   104         ORGANIZATION IS INDEXED                                  ELCCERTS
   105         ACCESS IS DYNAMIC                                        ELCCERTS
   106         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   107         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   108                                                                  ELCCERTS
   109
   110     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   111                             ORGANIZATION IS INDEXED
   112                             ACCESS IS DYNAMIC
   113                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   114                             FILE STATUS IS ELMSTR-FILE-STATUS.
   115
   116     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   117                             ORGANIZATION IS INDEXED
   118                             ACCESS IS DYNAMIC
   119                             RECORD KEY IS CT-CONTROL-PRIMARY
   120                             FILE STATUS IS ERCTBL-FILE-STATUS.
   121
   122     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   123                             ORGANIZATION IS INDEXED
   124                             ACCESS IS DYNAMIC
   125                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   126                             FILE STATUS IS ERACCT-FILE-STATUS.
   127
   128     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   4
* EL517.cbl
   129                             ORGANIZATION IS INDEXED
   130                             ACCESS IS DYNAMIC
   131                             RECORD KEY IS EM-CONTROL-PRIMARY
   132                             FILE STATUS IS ELCERR-FILE-STATUS.
   133
   134     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   135                             ORGANIZATION IS INDEXED
   136                             ACCESS IS DYNAMIC
   137                             RECORD KEY IS PM-CONTROL-PRIMARY
   138                             FILE STATUS IS ERPNDM-FILE-STATUS.
   139
   140     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   141                             ORGANIZATION IS INDEXED
   142                             ACCESS IS DYNAMIC
   143                             RECORD KEY IS MA-CONTROL-PRIMARY
   144                             FILE STATUS IS ERMAIL-FILE-STATUS.
   145
   146     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   147                             ORGANIZATION IS INDEXED
   148                             ACCESS IS DYNAMIC
   149                             RECORD KEY IS PL-CONTROL-PRIMARY
   150                             FILE STATUS IS ERPLAN-FILE-STATUS.
   151
   152     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   153                             ORGANIZATION IS INDEXED
   154                             ACCESS IS DYNAMIC
   155                             RECORD KEY IS FO-CONTROL-PRIMARY
   156                             FILE STATUS IS ERFORM-FILE-STATUS.
   157
   158     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   159
   160     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   161
   162     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   163                             ORGANIZATION IS INDEXED
   164                             ACCESS IS DYNAMIC
   165                             RECORD KEY IS RF-CONTROL-PRIMARY
   166                             FILE STATUS IS DTE-VSAM-FLAGS.
   167
   168     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   169                             ORGANIZATION IS INDEXED
   170                             ACCESS IS DYNAMIC
   171                             RECORD KEY IS ERRESS-PRIMARY-KEY
   172                             FILE STATUS IS ERRESS-FILE-STATUS.
   173
   174     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   175                             ORGANIZATION IS INDEXED
   176                             ACCESS IS DYNAMIC
   177                             RECORD KEY IS ERRESC-RECORD-KEY
   178                             FILE STATUS IS ERRESC-FILE-STATUS.
   179
   180     SELECT ERCOMP           ASSIGN TO             ERCOMP
   181                             ORGANIZATION IS INDEXED
   182                             ACCESS IS DYNAMIC
   183                             RECORD KEY IS CO-CONTROL-PRIMARY
   184                             FILE STATUS IS ERCOMP-FILE-STATUS.
   185
   186     SELECT ERLOFC           ASSIGN TO             ERLOFC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   5
* EL517.cbl
   187                             ORGANIZATION IS INDEXED
   188                             ACCESS IS DYNAMIC
   189                             RECORD KEY IS LO-CONTROL-PRIMARY
   190                             FILE STATUS IS ERLOFC-FILE-STATUS.
   191
   192     SELECT ERBXRF           ASSIGN TO             ERBXRF
   193                             ORGANIZATION IS INDEXED
   194                             ACCESS IS DYNAMIC
   195                             RECORD KEY IS BK-CONTROL-PRIMARY
   196                             FILE STATUS IS ERBXRF-FILE-STATUS.
   197
   198     SELECT ERAGTC           ASSIGN TO             ERAGTC
   199                             ORGANIZATION IS INDEXED
   200                             ACCESS IS DYNAMIC
   201                             RECORD KEY IS AG-CONTROL-PRIMARY
   202                             FILE STATUS IS ERAGTC-FILE-STATUS.
   203
   204     SELECT ELCRTT           ASSIGN TO             ELCRTT
   205                             ORGANIZATION IS INDEXED
   206                             ACCESS IS DYNAMIC
   207                             RECORD KEY IS CS-CONTROL-PRIMARY
   208                             FILE STATUS IS ELCRTT-FILE-STATUS.
   209
   210     SELECT ERPDEF           ASSIGN TO ERPDEF
   211                             ACCESS IS DYNAMIC
   212                             ORGANIZATION IS INDEXED
   213                             FILE STATUS IS ERPDEF-FILE-STATUS
   214                             RECORD KEY IS PD-CONTROL-PRIMARY.
   215
   216     SELECT ELSTAT           ASSIGN TO ELSTAT
   217                             ACCESS IS DYNAMIC
   218                             ORGANIZATION IS INDEXED
   219                             FILE STATUS IS ELSTAT-FILE-STATUS
   220                             RECORD KEY IS SF-CONTROL-PRIMARY.
   221
   222     SELECT ELCRTO           ASSIGN TO ELCRTO
   223                             ACCESS IS DYNAMIC
   224                             ORGANIZATION IS INDEXED
   225                             FILE STATUS IS ELCRTO-FILE-STATUS
   226                             RECORD KEY IS OC-CONTROL-PRIMARY.
   227
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   6
* EL517.cbl
   229 DATA DIVISION.
   230
   231 FILE SECTION.
   232
   233 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   234******************************************************************04/15/98
   235*                                                                *ELCDTEFD
   236*                                                                *ELCDTEFD
   237*                            ELCDTEFD.                           *   LV002
   238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   239*                            VMOD=2.007                          *   CL**2
   240*                                                                *ELCDTEFD
   241******************************************************************ELCDTEFD
   242     BLOCK CONTAINS 0 RECORDS
   243     RECORDING MODE F.                                            ELCDTEFD
   244                                                                  ELCDTEFD
   245 01  DATE-DISK.                                                   ELCDTEFD
   246     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   247     12  FILLER                      PIC  X(14).                  ELCDTEFD
   248     12  DD-CR1                      PIC  9.                      ELCDTEFD
   249     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   250     12  DD-CR2                      PIC  9.                      ELCDTEFD
   251     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   252     12  FILLER                      PIC  X(20).                  ELCDTEFD
   253                                                                  ELCDTEFD
   254 01  DATE-DISK-R.                                                 ELCDTEFD
   255     12  FILLER                      PIC  X(4).                   ELCDTEFD
   256     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   257                                     PIC  X(32).                  ELCDTEFD
   258                                                                  ELCDTEFD
   259 01  DATE-DISK-T.                                                 ELCDTEFD
   260     12  FILLER                      PIC  X(4).                   ELCDTEFD
   261     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   262                                     PIC  X(48).                  ELCDTEFD
   263                                                                  ELCDTEFD
   264 01  DATE-DISK-M.                                                 ELCDTEFD
   265     12  FILLER                      PIC  X(4).                   ELCDTEFD
   266     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   267                                     PIC  X(48).                  ELCDTEFD
   268                                                                  ELCDTEFD
   269 01  DATE-DISK-P.                                                 ELCDTEFD
   270     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   271     12  DD-IDX                      PIC  99.                     ELCDTEFD
   272     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   273     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   274         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   275                                     PIC  X.                      ELCDTEFD
   276         16  FILLER                  PIC  X(46).                  ELCDTEFD
   277     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   278         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   279             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   280             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   281             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   282             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   283         16  FILLER                  PIC  X(16).                  ELCDTEFD
   284                                                                  ELCDTEFD
   285 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   286     12  FILLER                      PIC  X(4).                   ELCDTEFD
   287     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   288                                     PIC  X(4).                   ELCDTEFD
   289                                                                  ELCDTEFD
   290 01  DATE-DISK-C.                                                 ELCDTEFD
   291     12  FILLER                      PIC  X(7).                   ELCDTEFD
   292     12  DD-CARR1-SECPAY-SW          PIC  X.
   293     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   294     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   295     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   296     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   297     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   298     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   299     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   300     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   301     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   302     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   303     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   304     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   305     12  DD-CARR2-SECPAY-SW          PIC  X.
   306     12  FILLER                      PIC  X(7).                   ELCDTEFD
   307                                                                  ELCDTEFD
   308 01  DATE-DISK-OPT.                                               ELCDTEFD
   309     12  FILLER                      PIC  X(04).                  ELCDTEFD
   310     12  DD-TLR-DATA.                                             ELCDTEFD
   311         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   312                                     PIC  X(03).                  ELCDTEFD
   313     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   314         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   315                                     PIC  X(06).                  ELCDTEFD
   316     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   317         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   318                                     PIC  X(07).                  ELCDTEFD
   319         16  FILLER                  PIC  X(05).                  ELCDTEFD
   320     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   321                                     PIC  X(96).                  ELCDTEFD
   322******************************************************************ELCDTEFD
   323
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   8
* EL517.cbl
   325 FD  ELCNTL.
*  326                                 COPY ELCCNTL.
   327******************************************************************
   328*                                                                *
   329*                                                                *
   330*                            ELCCNTL.                            *
   331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   332*                            VMOD=2.059                          *
   333*                                                                *
   334*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   335*                                                                *
   336*   FILE TYPE = VSAM,KSDS                                        *
   337*   RECORD SIZE = 750  RECFORM = FIXED                           *
   338*                                                                *
   339*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   340*       ALTERNATE INDEX = NONE                                   *
   341*                                                                *
   342*   LOG = YES                                                    *
   343*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   344******************************************************************
   345*                   C H A N G E   L O G
   346*
   347* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   348*-----------------------------------------------------------------
   349*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   350* EFFECTIVE    NUMBER
   351*-----------------------------------------------------------------
   352* 082503                   PEMA  ADD BENEFIT GROUP
   353* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   354* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   355* 092705    2005050300006  PEMA  ADD SPP LEASES
   356* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   357* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   358* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   359* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   360* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   361* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   362* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   363* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   364* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   365* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   366******************************************************************
   367*
   368 01  CONTROL-FILE.
   369     12  CF-RECORD-ID                       PIC XX.
   370         88  VALID-CF-ID                        VALUE 'CF'.
   371
   372     12  CF-CONTROL-PRIMARY.
   373         16  CF-COMPANY-ID                  PIC XXX.
   374         16  CF-RECORD-TYPE                 PIC X.
   375             88  CF-COMPANY-MASTER              VALUE '1'.
   376             88  CF-PROCESSOR-MASTER            VALUE '2'.
   377             88  CF-STATE-MASTER                VALUE '3'.
   378             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   379             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   380             88  CF-CARRIER-MASTER              VALUE '6'.
   381             88  CF-MORTALITY-MASTER            VALUE '7'.
   382             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page   9
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   383             88  CF-TERMINAL-MASTER             VALUE '9'.
   384             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   385             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   386             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   387             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   388             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   389             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   390             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   391             88  CF-REMINDERS-MASTER            VALUE 'R'.
   392             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   393         16  CF-ACCESS-CD-GENL              PIC X(4).
   394         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   395             20  CF-PROCESSOR               PIC X(4).
   396         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   397             20  CF-STATE-CODE              PIC XX.
   398             20  FILLER                     PIC XX.
   399         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   400             20  FILLER                     PIC XX.
   401             20  CF-HI-BEN-IN-REC           PIC XX.
   402         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   403             20  FILLER                     PIC XXX.
   404             20  CF-CARRIER-CNTL            PIC X.
   405         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   406             20  FILLER                     PIC XX.
   407             20  CF-HI-TYPE-IN-REC          PIC 99.
   408         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   409             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   410                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   411             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   412             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   413         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   414             20  FILLER                     PIC X.
   415             20  CF-CUSTOM-REPORT-NO        PIC 999.
   416         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   417             20  FILLER                     PIC XX.
   418             20  CF-MORTGAGE-PLAN           PIC XX.
   419         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   420
   421     12  CF-LAST-MAINT-DT                   PIC XX.
   422     12  CF-LAST-MAINT-BY                   PIC X(4).
   423     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   424
   425     12  CF-RECORD-BODY                     PIC X(728).
   426
   427
   428****************************************************************
   429*             COMPANY MASTER RECORD                            *
   430****************************************************************
   431
   432     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   433         16  CF-COMPANY-ADDRESS.
   434             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   435             20  CF-CL-IN-CARE-OF           PIC X(30).
   436             20  CF-CL-ADDR-LINE-1          PIC X(30).
   437             20  CF-CL-ADDR-LINE-2          PIC X(30).
   438             20  CF-CL-CITY-STATE           PIC X(30).
   439             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   440             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  10
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   441         16  CF-COMPANY-CD                  PIC X.
   442         16  CF-COMPANY-PASSWORD            PIC X(8).
   443         16  CF-SECURITY-OPTION             PIC X.
   444             88  ALL-SECURITY                   VALUE '1'.
   445             88  COMPANY-VERIFY                 VALUE '2'.
   446             88  PROCESSOR-VERIFY               VALUE '3'.
   447             88  NO-SECURITY                    VALUE '4'.
   448             88  ALL-BUT-TERM                   VALUE '5'.
   449         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   450             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   451         16  CF-LGX-INTERFACE-CNTL          PIC X.
   452             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   453         16  CF-INFORCE-LOCATION            PIC X.
   454             88  CERTS-ARE-ONLINE               VALUE '1'.
   455             88  CERTS-ARE-OFFLINE              VALUE '2'.
   456             88  NO-CERTS-AVAILABLE             VALUE '3'.
   457         16  CF-LOWER-CASE-LETTERS          PIC X.
   458         16  CF-CERT-ACCESS-CONTROL         PIC X.
   459             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   460             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   461             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   462             88  CF-ACCNT-CNTL                  VALUE '3'.
   463             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   464
   465         16  CF-FORMS-PRINTER-ID            PIC X(4).
   466         16  CF-CHECK-PRINTER-ID            PIC X(4).
   467
   468         16  CF-LGX-CREDIT-USER             PIC X.
   469             88  CO-IS-NOT-USER                 VALUE 'N'.
   470             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   471
   472         16 CF-CREDIT-CALC-CODES.
   473             20  CF-CR-REM-TERM-CALC PIC X.
   474               88  CR-EARN-AFTER-15TH           VALUE '1'.
   475               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   476               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   477               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   478               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   479               88  CR-EARN-AFTER-14TH           VALUE '6'.
   480               88  CR-EARN-AFTER-16TH           VALUE '7'.
   481             20  CF-CR-R78-METHOD           PIC X.
   482               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   483               88  DONT-USE-PLUS-ONE            VALUE '1'.
   484
   485         16  CF-CLAIM-CONTROL-COUNTS.
   486             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   487                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   488
   489             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   490                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   491
   492             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   493                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   494
   495             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   496                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   497
   498         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  11
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   499
   500         16  CF-CO-CALC-QUOTE-TOLERANCE.
   501             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   502             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   503             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   504             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   505                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   506                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   507             20  CF-CO-PREM-REJECT-SW       PIC X.
   508                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   509                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   510             20  CF-CO-REF-REJECT-SW        PIC X.
   511                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   512                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   513
   514         16  CF-CO-REPORTING-DT             PIC XX.
   515         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   516         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   517           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   518           88  CF-CO-MONTH-END                  VALUE '1'.
   519
   520         16  CF-LGX-CLAIM-USER              PIC X.
   521             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   522             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   523
   524         16  CF-CREDIT-EDIT-CONTROLS.
   525             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   526             20  CF-MIN-AGE                 PIC 99.
   527             20  CF-DEFAULT-AGE             PIC 99.
   528             20  CF-MIN-TERM                PIC S999      COMP-3.
   529             20  CF-MAX-TERM                PIC S999      COMP-3.
   530             20  CF-DEFAULT-SEX             PIC X.
   531             20  CF-JOINT-AGE-INPUT         PIC X.
   532                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   533             20  CF-BIRTH-DATE-INPUT        PIC X.
   534                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   535             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   536                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   537                 88  CF-ZERO-CARRIER            VALUE '1'.
   538                 88  CF-ZERO-GROUPING           VALUE '2'.
   539                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   540             20  CF-EDIT-SW                 PIC X.
   541                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   542             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   543             20  CF-CR-PR-METHOD            PIC X.
   544               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   545               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   546             20  FILLER                     PIC X.
   547
   548         16  CF-CREDIT-MISC-CONTROLS.
   549             20  CF-REIN-TABLE-SW           PIC X.
   550                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   551             20  CF-COMP-TABLE-SW           PIC X.
   552                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   553             20  CF-EXPERIENCE-RETENTION-AGE
   554                                            PIC S9        COMP-3.
   555             20  CF-CONVERSION-DT           PIC XX.
   556             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  12
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   557             20  CF-RUN-FREQUENCY-SW        PIC X.
   558                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   559                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   560
   561             20  CF-CR-CHECK-NO-CONTROL.
   562                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   563                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   564                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   565                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   566                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   567                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   568
   569                 24  CF-CR-CHECK-COUNT       REDEFINES
   570                     CF-CR-CHECK-COUNTER      PIC X(4).
   571
   572                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   573                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   574
   575                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   576                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   577                 24  CF-MAIL-PROCESSING       PIC X.
   578                     88  MAIL-PROCESSING          VALUE 'Y'.
   579
   580         16  CF-MISC-SYSTEM-CONTROL.
   581             20  CF-SYSTEM-C                 PIC X.
   582                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   583             20  CF-SYSTEM-D                 PIC X.
   584                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   585             20  CF-SOC-SEC-NO-SW            PIC X.
   586                 88  SOC-SEC-NO-USED             VALUE '1'.
   587             20  CF-MEMBER-NO-SW             PIC X.
   588                 88  MEMBER-NO-USED              VALUE '1'.
   589             20  CF-TAX-ID-NUMBER            PIC X(11).
   590             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   591             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   592                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   593                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   594                 88  CF-ALL-APPROVED             VALUE 'Y'.
   595                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   596             20  CF-SYSTEM-E                 PIC X.
   597                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   598
   599         16  CF-LGX-LIFE-USER               PIC X.
   600             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   601             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   602
   603         16  CF-CR-MONTH-END-DT             PIC XX.
   604
   605         16  CF-FILE-MAINT-DATES.
   606             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   607                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   608             20  CF-LAST-BATCH       REDEFINES
   609                 CF-LAST-BATCH-NO               PIC X(4).
   610             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   611             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   612             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   613             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   614             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  13
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   615             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   616             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   617             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   618             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   619             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   620
   621         16  CF-NEXT-COMPANY-ID             PIC XXX.
   622         16  FILLER                         PIC X.
   623
   624         16  CF-ALT-MORT-CODE               PIC X(4).
   625         16  CF-MEMBER-CAPTION              PIC X(10).
   626
   627         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   628             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   629             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   630             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   631             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   632             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   633
   634         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   635
   636         16  CF-LIFE-OVERRIDE-L1            PIC X.
   637         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   638         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   639         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   640
   641         16  CF-AH-OVERRIDE-L1              PIC X.
   642         16  CF-AH-OVERRIDE-L2              PIC XX.
   643         16  CF-AH-OVERRIDE-L6              PIC X(6).
   644         16  CF-AH-OVERRIDE-L12             PIC X(12).
   645
   646         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   647         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   648
   649         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   650         16  CF-AR-LAST-EL860-DT            PIC XX.
   651         16  CF-MP-MONTH-END-DT             PIC XX.
   652
   653         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   654         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   655             88  CF-CLAIM-PAID-TO               VALUE '1'.
   656
   657         16  CF-AR-MONTH-END-DT             PIC XX.
   658
   659         16  CF-CRDTCRD-USER                PIC X.
   660             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   661             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   662
   663         16  CF-CC-MONTH-END-DT             PIC XX.
   664
   665         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   666
   667         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   668             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   669             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   670             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   671         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   672         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  14
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   673         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   674         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   675             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   676             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   677         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   678         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   679         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   680             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   681         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   682
   683         16  CF-CL-ZIP-CODE.
   684             20  CF-CL-ZIP-PRIME.
   685                 24  CF-CL-ZIP-1ST          PIC X.
   686                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   687                 24  FILLER                 PIC X(4).
   688             20  CF-CL-ZIP-PLUS4            PIC X(4).
   689         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   690             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   691             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   692             20  FILLER                     PIC XXX.
   693
   694         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   695         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   696         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   697         16  CF-CO-OPTION-START-DATE        PIC XX.
   698         16  CF-REM-TRM-CALC-OPTION         PIC X.
   699           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   700                                                      '3' '4'.
   701           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   702           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   703           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   704           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   705           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   706           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   707
   708         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   709
   710         16  CF-PAYMENT-APPROVAL-LEVELS.
   711             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   712             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   713             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   714             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   715             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   716             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   717
   718         16  CF-END-USER-REPORTING-USER     PIC X.
   719             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   720             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   721
   722         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   723             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   724             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   725
   726         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   727
   728         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   729         16  FILLER                         PIC X.
   730
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  15
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   731         16  CF-CREDIT-ARCHIVE-CNTL.
   732             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   733             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   734             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   735
   736         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   737
   738         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   739             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   740             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   741
   742         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   743             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   744             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   745
   746         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   747
   748         16  CF-CO-ACH-ID-CODE              PIC  X.
   749             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   750             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   751             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   752         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   753         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   754         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   755         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   756         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   757         16  CF-CO-ACH-RECV-NO              PIC X(08).
   758         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   759         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   760         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   761                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   762         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   763                 CF-CO-ACH-TRACE-NO         PIC X(4).
   764
   765         16  CF-CO-OVER-SHORT.
   766             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   767             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   768
   769*         16  FILLER                         PIC X(102).
   770         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   771             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   772             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   773
   774         16  CF-AH-APPROVAL-DAYS.
   775             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   776             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   777             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   778             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   779
   780         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   781
   782         16  CF-APPROV-LEV-5.
   783             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
   784             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
   785             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
   786
   787         16  FILLER                         PIC X(68).
   788****************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  16
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   789*             PROCESSOR/USER RECORD                            *
   790****************************************************************
   791
   792     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   793         16  CF-PROCESSOR-NAME              PIC X(30).
   794         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   795         16  CF-PROCESSOR-TITLE             PIC X(26).
   796         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   797                 88  MESSAGE-YES                VALUE 'Y'.
   798                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   799
   800*****************************************************
   801****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   802****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   803****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   804****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   805*****************************************************
   806
   807         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   808             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   809             20  CF-APPLICATION-FORCE       PIC X.
   810             20  CF-INDIVIDUAL-APP.
   811                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   812                     28  CF-BROWSE-APP      PIC X.
   813                     28  CF-UPDATE-APP      PIC X.
   814
   815         16  CF-CURRENT-TERM-ON             PIC X(4).
   816         16  CF-PROCESSOR-LIMITS-CLAIMS.
   817             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   818             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   819             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   820             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   821             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   822             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   823             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   824         16  CF-PROCESSOR-CARRIER           PIC X.
   825             88  NO-CARRIER-SECURITY            VALUE ' '.
   826         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   827             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   828         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   829             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   830         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   831             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   832
   833         16  CF-PROC-SYS-ACCESS-SW.
   834             20  CF-PROC-CREDIT-CLAIMS-SW.
   835                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   836                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   837                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   838                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   839             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   840                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   841                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   842             20  CF-PROC-LIFE-GNRLDGR-SW.
   843                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   844                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   845                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   846                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  17
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   847             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   848                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   849                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   850         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   851             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   852             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   853         16  CF-PROCESSOR-PRINTER               PIC X(4).
   854
   855         16  CF-APPROVAL-LEVEL                  PIC X.
   856             88  APPROVAL-LEVEL-1                   VALUE '1'.
   857             88  APPROVAL-LEVEL-2                   VALUE '2'.
   858             88  APPROVAL-LEVEL-3                   VALUE '3'.
   859             88  APPROVAL-LEVEL-4                   VALUE '4'.
   860             88  APPROVAL-LEVEL-5                   VALUE '5'.
   861
   862         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   863
   864         16  CF-LANGUAGE-TYPE                   PIC X.
   865             88  CF-LANG-IS-ENG                     VALUE 'E'.
   866             88  CF-LANG-IS-FR                      VALUE 'F'.
   867
   868         16  CF-CSR-IND                         PIC X.
   869         16  FILLER                             PIC X(239).
   870
   871****************************************************************
   872*             PROCESSOR/REMINDERS RECORD                       *
   873****************************************************************
   874
   875     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   876         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   877             20  CF-START-REMIND-DT         PIC XX.
   878             20  CF-END-REMIND-DT           PIC XX.
   879             20  CF-REMINDER-TEXT           PIC X(50).
   880         16  FILLER                         PIC X(296).
   881
   882
   883****************************************************************
   884*             STATE MASTER RECORD                              *
   885****************************************************************
   886
   887     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   888         16  CF-STATE-ABBREVIATION          PIC XX.
   889         16  CF-STATE-NAME                  PIC X(25).
   890         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   891         16  CF-ST-CALC-QUOTE-TOLERANCE.
   892             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   893             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   894             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   895             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   896                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   897                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   898             20  CF-ST-PREM-REJECT-SW       PIC X.
   899                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   900                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   901             20  CF-ST-REF-REJECT-SW        PIC X.
   902                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   903                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   904         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  18
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   905         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   906         16  CF-ST-REFUND-RULES.
   907             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   908             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   909             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   910         16  CF-ST-FST-PMT-EXTENSION.
   911             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   912             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   913                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   914                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   915                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   916                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   917         16  CF-ST-STATE-CALL.
   918             20  CF-ST-CALL-UNEARNED        PIC X.
   919             20  CF-ST-CALL-RPT-CNTL        PIC X.
   920             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   921         16  CF-REPLACEMENT-LAW-SW          PIC X.
   922             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   923             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   924         16  CF-REPLACEMENT-LETTER          PIC X(4).
   925         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   926         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   927         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   928         16  CF-ST-SPLIT-PAYMENT            PIC X.
   929         16  FILLER                         PIC X.
   930         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   931             20  CF-ST-BENEFIT-CD           PIC XX.
   932             20  CF-ST-BENEFIT-KIND         PIC X.
   933                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   934                 88  CF-ST-AH-KIND              VALUE 'A'.
   935             20  CF-ST-REM-TERM-CALC        PIC X.
   936                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   937                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   938                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   939                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   940                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   941                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   942                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   943                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   944
   945             20  CF-ST-REFUND-CALC          PIC X.
   946                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   947                 88  ST-REFD-BY-R78             VALUE '1'.
   948                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   949                 88  ST-REFD-AS-CALIF           VALUE '3'.
   950                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   951                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   952                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   953                 88  ST-REFD-UTAH               VALUE '7'.
   954                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   955                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   956                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   957
   958             20  CF-ST-EARNING-CALC         PIC X.
   959                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   960                 88  ST-EARN-BY-R78             VALUE '1'.
   961                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   962                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  19
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   963                 88  ST-EARN-AS-TEXAS           VALUE '4'.
   964                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   965                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   966                 88  ST-EARN-MEAN               VALUE '8'.
   967                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   968
   969             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   970                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   971                 88  ST-OVRD-BY-R78             VALUE '1'.
   972                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   973                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   974                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   975                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   976                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   977                 88  ST-OVRD-MEAN               VALUE '8'.
   978                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   979             20  FILLER                     PIC X.
   980
   981         16  CF-ST-COMMISSION-CAPS.
   982             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   983             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   984             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   985             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   986         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   987                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   988
   989         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   990
   991         16  CF-ST-STATUTORY-INTEREST.
   992             20  CF-ST-STAT-DATE-FROM       PIC X.
   993                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   994                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   995             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   996             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   997             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   998             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   999             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1000
  1001         16  CF-ST-OVER-SHORT.
  1002             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1003             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1004
  1005         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1006
  1007         16  CF-ST-RT-CALC                  PIC X.
  1008
  1009         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1010         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1011         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1012         16  CF-ST-RF-LR-CALC               PIC X.
  1013         16  CF-ST-RF-LL-CALC               PIC X.
  1014         16  CF-ST-RF-LN-CALC               PIC X.
  1015         16  CF-ST-RF-AH-CALC               PIC X.
  1016         16  CF-ST-RF-CP-CALC               PIC X.
  1017*        16  FILLER                         PIC X(206).
  1018*CIDMOD         16  FILLER                         PIC X(192).
  1019         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1020             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  20
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1021         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1022         16  CF-ST-VFY-2ND-BENE             PIC X.
  1023         16  CF-ST-CAUSAL-STATE             PIC X.
  1024         16  FILLER                         PIC X(185).
  1025
  1026****************************************************************
  1027*             BENEFIT MASTER RECORD                            *
  1028****************************************************************
  1029
  1030     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1031         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1032             20  CF-BENEFIT-CODE            PIC XX.
  1033             20  CF-BENEFIT-NUMERIC  REDEFINES
  1034                 CF-BENEFIT-CODE            PIC XX.
  1035             20  CF-BENEFIT-ALPHA           PIC XXX.
  1036             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1037             20  CF-BENEFIT-COMMENT         PIC X(10).
  1038
  1039             20  CF-LF-COVERAGE-TYPE        PIC X.
  1040                 88  CF-REDUCING                VALUE 'R'.
  1041                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1042
  1043             20  CF-SPECIAL-CALC-CD         PIC X.
  1044                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1045                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1046                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1047                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1048                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1049                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1050                 88  CF-FARM-PLAN               VALUE 'F'.
  1051                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1052                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1053                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1054                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1055                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1056                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1057                 88  CF-PRUDENTIAL              VALUE 'P'.
  1058                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1059                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1060                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1061                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1062                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1063                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1064
  1065             20  CF-JOINT-INDICATOR         PIC X.
  1066                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1067
  1068*            20  FILLER                     PIC X(12).
  1069             20  cf-maximum-benefits        pic s999 comp-3.
  1070             20  FILLER                     PIC X(09).
  1071             20  CF-BENEFIT-CATEGORY        PIC X.
  1072             20  CF-LOAN-TYPE               PIC X(8).
  1073
  1074             20  CF-CO-REM-TERM-CALC        PIC X.
  1075                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1076                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1077                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1078                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  21
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1079                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1080
  1081             20  CF-CO-EARNINGS-CALC        PIC X.
  1082                 88  CO-EARN-BY-R78             VALUE '1'.
  1083                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1084                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1085                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1086                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1087                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1088                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1089                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1090
  1091             20  CF-CO-REFUND-CALC          PIC X.
  1092                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1093                 88  CO-REFD-BY-R78             VALUE '1'.
  1094                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1095                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1096                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1097                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1098                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1099                 88  CO-REFD-MEAN               VALUE '8'.
  1100                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1101                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1102                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1103
  1104             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1105                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1106                 88  CO-OVRD-BY-R78             VALUE '1'.
  1107                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1108                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1109                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1110                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1111                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1112                 88  CO-OVRD-MEAN               VALUE '8'.
  1113                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1114
  1115             20  CF-CO-BEN-I-G-CD           PIC X.
  1116                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1117                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1118                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1119
  1120         16  FILLER                         PIC X(304).
  1121
  1122
  1123****************************************************************
  1124*             CARRIER MASTER RECORD                            *
  1125****************************************************************
  1126
  1127     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1128         16  CF-ADDRESS-DATA.
  1129             20  CF-MAIL-TO-NAME            PIC X(30).
  1130             20  CF-IN-CARE-OF              PIC X(30).
  1131             20  CF-ADDRESS-LINE-1          PIC X(30).
  1132             20  CF-ADDRESS-LINE-2          PIC X(30).
  1133             20  CF-CITY-STATE              PIC X(30).
  1134             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1135             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1136
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  22
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1137         16  CF-CLAIM-NO-CONTROL.
  1138             20  CF-CLAIM-NO-METHOD         PIC X.
  1139                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1140                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1141                 88  CLAIM-NO-SEQ               VALUE '3'.
  1142                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1143             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1144                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1145                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1146                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1147
  1148         16  CF-CHECK-NO-CONTROL.
  1149             20  CF-CHECK-NO-METHOD         PIC X.
  1150                 88  CHECK-NO-MANUAL            VALUE '1'.
  1151                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1152                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1153                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1154             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1155                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1156
  1157         16  CF-DOMICILE-STATE              PIC XX.
  1158
  1159         16  CF-EXPENSE-CONTROLS.
  1160             20  CF-EXPENSE-METHOD          PIC X.
  1161                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1162                 88  DOLLARS-PER-PMT            VALUE '2'.
  1163                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1164                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1165             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1166             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1167
  1168         16  CF-CORRESPONDENCE-CONTROL.
  1169             20  CF-LETTER-RESEND-OPT       PIC X.
  1170                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1171                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1172             20  FILLER                     PIC X(4).
  1173
  1174         16  CF-RESERVE-CONTROLS.
  1175             20  CF-MANUAL-SW               PIC X.
  1176                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1177             20  CF-FUTURE-SW               PIC X.
  1178                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1179             20  CF-PTC-SW                  PIC X.
  1180                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1181             20  CF-IBNR-SW                 PIC X.
  1182                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1183             20  CF-PTC-LF-SW               PIC X.
  1184                 88  CF-LF-PTC-USED             VALUE '1'.
  1185             20  CF-CDT-ACCESS-METHOD       PIC X.
  1186                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1187                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1188                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1189             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1190
  1191         16  CF-CLAIM-CALC-METHOD           PIC X.
  1192             88  360-PLUS-MONTHS                VALUE '1'.
  1193             88  365-PLUS-MONTHS                VALUE '2'.
  1194             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  23
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1195             88  360-DAILY                      VALUE '4'.
  1196             88  365-DAILY                      VALUE '5'.
  1197
  1198         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1199         16  FILLER                         PIC X(11).
  1200
  1201         16  CF-LIMIT-AMOUNTS.
  1202             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1203             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1204             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1205             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1206             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1207             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1208             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1209             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1210             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1211             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1212
  1213         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1214         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1215         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1216
  1217         16  CF-ZIP-CODE.
  1218             20  CF-ZIP-PRIME.
  1219                 24  CF-ZIP-1ST             PIC X.
  1220                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1221                 24  FILLER                 PIC X(4).
  1222             20  CF-ZIP-PLUS4               PIC X(4).
  1223         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1224             20  CF-CAN-POSTAL-1            PIC XXX.
  1225             20  CF-CAN-POSTAL-2            PIC XXX.
  1226             20  FILLER                     PIC XXX.
  1227
  1228         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1229         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1230         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1231
  1232         16  CF-RATING-SWITCH               PIC X.
  1233             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1234             88  CF-NO-RATING                   VALUE 'N'.
  1235
  1236         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1237
  1238         16  CF-CARRIER-OVER-SHORT.
  1239             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1240             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1241
  1242         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1243         16  CF-SECPAY-SWITCH               PIC X.
  1244             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1245             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1246         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1247         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1248         16  FILLER                         PIC X(444).
  1249*        16  FILLER                         PIC X(452).
  1250
  1251
  1252****************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  24
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1253*             MORTALITY MASTER RECORD                          *
  1254****************************************************************
  1255
  1256     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1257         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1258                                INDEXED BY CF-MORT-NDX.
  1259             20  CF-MORT-TABLE              PIC X(5).
  1260             20  CF-MORT-TABLE-TYPE         PIC X.
  1261                 88  CF-MORT-JOINT              VALUE 'J'.
  1262                 88  CF-MORT-SINGLE             VALUE 'S'.
  1263                 88  CF-MORT-COMBINED           VALUE 'C'.
  1264                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1265                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1266             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1267             20  CF-MORT-AGE-METHOD         PIC XX.
  1268                 88  CF-AGE-LAST                VALUE 'AL'.
  1269                 88  CF-AGE-NEAR                VALUE 'AN'.
  1270             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1271             20  CF-MORT-ADJUSTMENT-DIRECTION
  1272                                            PIC X.
  1273                 88  CF-MINUS                   VALUE '-'.
  1274                 88  CF-PLUS                    VALUE '+'.
  1275             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1276             20  CF-MORT-JOINT-CODE         PIC X.
  1277                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1278             20  CF-MORT-PC-Q               PIC X.
  1279                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1280             20  CF-MORT-TABLE-CODE         PIC X(4).
  1281             20  CF-MORT-COMMENTS           PIC X(15).
  1282             20  FILLER                     PIC X(14).
  1283
  1284         16  FILLER                         PIC X(251).
  1285
  1286
  1287****************************************************************
  1288*             BUSSINESS TYPE MASTER RECORD                     *
  1289****************************************************************
  1290
  1291     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1292* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1293* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1294* AND RECORD 05 IS TYPES 81-99
  1295         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1296             20  CF-BUSINESS-TITLE          PIC  X(19).
  1297             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1298                                            PIC S9V9(4) COMP-3.
  1299             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1300             20  FILLER                     PIC  X.
  1301         16  FILLER                         PIC  X(248).
  1302
  1303
  1304****************************************************************
  1305*             TERMINAL MASTER RECORD                           *
  1306****************************************************************
  1307
  1308     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1309
  1310         16  CF-COMPANY-TERMINALS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  25
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1311             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1312                                  PIC X(4).
  1313         16  FILLER               PIC X(248).
  1314
  1315
  1316****************************************************************
  1317*             LIFE EDIT MASTER RECORD                          *
  1318****************************************************************
  1319
  1320     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1321         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1322             20  CF-LIFE-CODE-IN            PIC XX.
  1323             20  CF-LIFE-CODE-OUT           PIC XX.
  1324         16  FILLER                         PIC X(248).
  1325
  1326
  1327****************************************************************
  1328*             AH EDIT MASTER RECORD                            *
  1329****************************************************************
  1330
  1331     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1332         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1333             20  CF-AH-CODE-IN              PIC XXX.
  1334             20  CF-AH-CODE-OUT             PIC XX.
  1335         16  FILLER                         PIC X(248).
  1336
  1337
  1338****************************************************************
  1339*             CREDIBILITY TABLES                               *
  1340****************************************************************
  1341
  1342     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1343         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1344                             INDEXED BY CF-CRDB-NDX.
  1345             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1346             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1347             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1348         16  FILLER                         PIC  X(332).
  1349
  1350
  1351****************************************************************
  1352*             REPORT CUSTOMIZATION RECORD                      *
  1353****************************************************************
  1354
  1355     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1356         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1357             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1358             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1359             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1360**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1361****       A T-TRANSFER.                                   ****
  1362             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1363
  1364         16  FILLER                         PIC XX.
  1365
  1366         16  CF-CARRIER-CNTL-OPT.
  1367             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1368                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  26
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1369                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1370             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1371                                            PIC X.
  1372         16  CF-GROUP-CNTL-OPT.
  1373             20  CF-GROUP-OPT-SEQ           PIC 9.
  1374                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1375                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1376             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1377                                            PIC X(6).
  1378         16  CF-STATE-CNTL-OPT.
  1379             20  CF-STATE-OPT-SEQ           PIC 9.
  1380                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1381                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1382             20  CF-STATE-SELECT OCCURS 3 TIMES
  1383                                            PIC XX.
  1384         16  CF-ACCOUNT-CNTL-OPT.
  1385             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1386                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1387                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1388             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1389                                            PIC X(10).
  1390         16  CF-BUS-TYP-CNTL-OPT.
  1391             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1392                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1393                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1394             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1395                                            PIC XX.
  1396         16  CF-LF-TYP-CNTL-OPT.
  1397             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1398                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1399                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1400             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1401                                            PIC XX.
  1402         16  CF-AH-TYP-CNTL-OPT.
  1403             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1404                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1405                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1406             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1407                                            PIC XX.
  1408         16  CF-REPTCD1-CNTL-OPT.
  1409             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1410                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1411                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1412             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1413                                            PIC X(10).
  1414         16  CF-REPTCD2-CNTL-OPT.
  1415             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1416                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1417                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1418             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1419                                            PIC X(10).
  1420         16  CF-USER1-CNTL-OPT.
  1421             20  CF-USER1-OPT-SEQ           PIC 9.
  1422                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1423                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1424             20  CF-USER1-SELECT OCCURS 3 TIMES
  1425                                            PIC X(10).
  1426         16  CF-USER2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  27
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1427             20  CF-USER2-OPT-SEQ           PIC 9.
  1428                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1429                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1430             20  CF-USER2-SELECT OCCURS 3 TIMES
  1431                                            PIC X(10).
  1432         16  CF-USER3-CNTL-OPT.
  1433             20  CF-USER3-OPT-SEQ           PIC 9.
  1434                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1435                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1436             20  CF-USER3-SELECT OCCURS 3 TIMES
  1437                                            PIC X(10).
  1438         16  CF-USER4-CNTL-OPT.
  1439             20  CF-USER4-OPT-SEQ           PIC 9.
  1440                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1441                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1442             20  CF-USER4-SELECT OCCURS 3 TIMES
  1443                                            PIC X(10).
  1444         16  CF-USER5-CNTL-OPT.
  1445             20  CF-USER5-OPT-SEQ           PIC 9.
  1446                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1447                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1448             20  CF-USER5-SELECT OCCURS 3 TIMES
  1449                                            PIC X(10).
  1450         16  CF-REINS-CNTL-OPT.
  1451             20  CF-REINS-OPT-SEQ           PIC 9.
  1452                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1453                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1454             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1455                 24  CF-REINS-PRIME         PIC XXX.
  1456                 24  CF-REINS-SUB           PIC XXX.
  1457
  1458         16  CF-AGENT-CNTL-OPT.
  1459             20  CF-AGENT-OPT-SEQ           PIC 9.
  1460                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1461                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1462             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1463                                            PIC X(10).
  1464
  1465         16  FILLER                         PIC X(43).
  1466
  1467         16  CF-LOSS-RATIO-SELECT.
  1468             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1469             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1470         16  CF-ENTRY-DATE-SELECT.
  1471             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1472             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1473         16  CF-EFFECTIVE-DATE-SELECT.
  1474             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1475             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1476
  1477         16  CF-EXCEPTION-LIST-IND          PIC X.
  1478             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1479
  1480         16  FILLER                         PIC X(318).
  1481
  1482****************************************************************
  1483*                  EXCEPTION REPORTING RECORD                  *
  1484****************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  28
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1485
  1486     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1487         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1488             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1489
  1490         16  CF-COMBINED-LIFE-AH-OPT.
  1491             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1492             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1493             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1494             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1495
  1496         16  CF-LIFE-OPT.
  1497             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1498             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1499             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1500             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1501             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1502             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1503             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1504             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1505             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1506             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1507
  1508         16  CF-AH-OPT.
  1509             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1510             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1511             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1512             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1513             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1514             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1515             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1516             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1517             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1518             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1519
  1520         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1521             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1522             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1523             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1524
  1525         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1526
  1527         16  FILLER                         PIC X(673).
  1528
  1529
  1530****************************************************************
  1531*             MORTGAGE SYSTEM PLAN RECORD                      *
  1532****************************************************************
  1533
  1534     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1535         16  CF-PLAN-TYPE                   PIC X.
  1536             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1537             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1538             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1539         16  CF-PLAN-ABBREV                 PIC XXX.
  1540         16  CF-PLAN-DESCRIPT               PIC X(10).
  1541         16  CF-PLAN-NOTES                  PIC X(20).
  1542         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  29
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1543         16  CF-PLAN-UNDERWRITING.
  1544             20  CF-PLAN-TERM-DATA.
  1545                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1546                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1547             20  CF-PLAN-AGE-DATA.
  1548                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1549                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1550                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1551             20  CF-PLAN-BENEFIT-DATA.
  1552                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1553                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1554                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1555                                            PIC S9(7)V99  COMP-3.
  1556         16  CF-PLAN-POLICY-FORMS.
  1557             20  CF-POLICY-FORM             PIC X(12).
  1558             20  CF-MASTER-APPLICATION      PIC X(12).
  1559             20  CF-MASTER-POLICY           PIC X(12).
  1560         16  CF-PLAN-RATING.
  1561             20  CF-RATE-CODE               PIC X(5).
  1562             20  CF-SEX-RATING              PIC X.
  1563                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1564                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1565             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1566             20  CF-SUB-STD-TYPE            PIC X.
  1567                 88  CF-PCT-OF-PREM            VALUE '1'.
  1568                 88  CF-PCT-OF-BENE            VALUE '2'.
  1569         16  CF-PLAN-PREM-TOLERANCES.
  1570             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1571             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1572         16  CF-PLAN-PYMT-TOLERANCES.
  1573             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1574             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1575         16  CF-PLAN-MISC-DATA.
  1576             20  FILLER                     PIC X.
  1577             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1578             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1579         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1580         16  CF-PLAN-IND-GRP                PIC X.
  1581             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1582                                                     '1'.
  1583             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1584                                                     '2'.
  1585         16  CF-MIB-SEARCH-SW               PIC X.
  1586             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1587             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1588             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1589             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1590         16  CF-ALPHA-SEARCH-SW             PIC X.
  1591             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1592             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1593             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1594             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1595             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1596             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1597             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1598             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1599             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1600             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  30
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1601                                                     'A' 'B' 'C'
  1602                                                     'X' 'Y' 'Z'.
  1603         16  CF-EFF-DT-RULE-SW              PIC X.
  1604             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1605             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1606             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1607             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1608             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1609         16  FILLER                         PIC X(4).
  1610         16  CF-HEALTH-QUESTIONS            PIC X.
  1611             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1612         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1613         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1614         16  CF-PLAN-SNGL-JNT               PIC X.
  1615             88  CF-COMBINED-PLAN              VALUE 'C'.
  1616             88  CF-JNT-PLAN                   VALUE 'J'.
  1617             88  CF-SNGL-PLAN                  VALUE 'S'.
  1618         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1619         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1620         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1621         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1622         16  CF-RERATE-CNTL                 PIC  X.
  1623             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1624             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1625             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1626             88  CF-AUTO-RECALC                 VALUE '4'.
  1627         16  CF-BENEFIT-TYPE                PIC  X.
  1628             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1629             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1630         16  CF-POLICY-FEE                  PIC S999V99
  1631                                                    COMP-3.
  1632         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1633         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1634         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1635         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1636         16  FILLER                         PIC  X(32).
  1637         16  CF-TERMINATION-FORM            PIC  X(04).
  1638         16  FILLER                         PIC  X(08).
  1639         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1640                                                       COMP-3.
  1641         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1642         16  CF-ISSUE-LETTER                PIC  X(4).
  1643         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1644         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1645             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1646             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1647         16  CF-MP-REFUND-CALC              PIC X.
  1648             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1649             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1650             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1651             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1652             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1653             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1654             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1655             88  CF-MP-REFD-MEAN                VALUE '8'.
  1656         16  CF-ALT-RATE-CODE               PIC  X(5).
  1657
  1658
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  31
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1659         16  FILLER                         PIC X(498).
  1660****************************************************************
  1661*             MORTGAGE COMPANY MASTER RECORD                   *
  1662****************************************************************
  1663
  1664     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1665         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1666         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1667             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1668             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1669             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1670             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1671             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1672
  1673         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1674         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1675         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1676         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1677         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1678
  1679         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1680             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1681         16  CF-MP-RECON-USE-IND            PIC X(1).
  1682             88  CF-MP-USE-RECON             VALUE 'Y'.
  1683         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1684             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1685         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1686             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1687             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1688         16  FILLER                         PIC X(1).
  1689         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1690             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1691         16  CF-MORTG-MIB-VERSION           PIC X.
  1692             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1693             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1694             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1695         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1696             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1697                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1698             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1699                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1700             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1701                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1702             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1703                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1704             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1705                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1706             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1707                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1708         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1709         16  FILLER                         PIC X(7).
  1710         16  CF-MORTG-DESTINATION-SYMBOL.
  1711             20  CF-MORTG-MIB-COMM          PIC X(5).
  1712             20  CF-MORTG-MIB-TERM          PIC X(5).
  1713         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1714             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1715         16  FILLER                         PIC X(03).
  1716         16  CF-MP-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  32
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1717             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1718                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1719                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1720                                                ' ' LOW-VALUES.
  1721                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1722                                               VALUE '3'.
  1723         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1724         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1725         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1726             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1727                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1728             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1729                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1730             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1731                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1732             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1733                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1734             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1735                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1736             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1737                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1738         16  CF-MORTG-BILLING-AREA.
  1739             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1740                                            PIC X.
  1741         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1742         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1743         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1744         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1745             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1746             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1747         16  FILLER                         PIC X.
  1748         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1749             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1750             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1751         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1752         16  FILLER                         PIC X(8).
  1753         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1754         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1755         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1756         16  CF-ACH-COMPANY-ID.
  1757             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1758                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1759                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1760                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1761             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1762         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1763             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1764         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1765             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1766             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1767         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1768         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1769         16  FILLER                         PIC X(536).
  1770
  1771****************************************************************
  1772*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1773****************************************************************
  1774
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  33
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1775     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1776         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1777             20  CF-FEMALE-HEIGHT.
  1778                 24  CF-FEMALE-FT           PIC 99.
  1779                 24  CF-FEMALE-IN           PIC 99.
  1780             20  CF-FEMALE-MIN-WT           PIC 999.
  1781             20  CF-FEMALE-MAX-WT           PIC 999.
  1782         16  FILLER                         PIC X(428).
  1783
  1784     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1785         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1786             20  CF-MALE-HEIGHT.
  1787                 24  CF-MALE-FT             PIC 99.
  1788                 24  CF-MALE-IN             PIC 99.
  1789             20  CF-MALE-MIN-WT             PIC 999.
  1790             20  CF-MALE-MAX-WT             PIC 999.
  1791         16  FILLER                         PIC X(428).
  1792******************************************************************
  1793*             AUTOMATIC ACTIVITY RECORD                          *
  1794******************************************************************
  1795     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1796         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1797             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1798             20  CF-SYS-LETTER-ID           PIC X(04).
  1799             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1800             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1801             20  CF-SYS-RESET-SW            PIC X(01).
  1802             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1803             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1804
  1805         16  FILLER                         PIC X(50).
  1806
  1807         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1808             20  CF-USER-ACTIVE-SW          PIC X(01).
  1809             20  CF-USER-LETTER-ID          PIC X(04).
  1810             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1811             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1812             20  CF-USER-RESET-SW           PIC X(01).
  1813             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1814             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1815             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1816
  1817         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  34
* EL517.cbl
  1819 FD  ERPNDB.
* 1820                                  COPY ERCPNDB.
  1821******************************************************************
  1822*                                                                *
  1823*                                                                *
  1824*                            ERCPNDB.                            *
  1825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1826*                            VMOD=2.025                          *
  1827*                                                                *
  1828*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1829*                                                                *
  1830******************************************************************
  1831*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1832*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1833******************************************************************
  1834*                                                                *
  1835*                                                                *
  1836*   FILE TYPE = VSAM,KSDS                                        *
  1837*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1838*                                                                *
  1839*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1840*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1841*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1842*                                                 RKP=13,LEN=36  *
  1843*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1844*                                      AND CHG-SEQ.)             *
  1845*                                                RKP=49,LEN=11   *
  1846*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1847*                                      AND CHG-SEQ.)             *
  1848*                                                RKP=60,LEN=15   *
  1849*                                                                *
  1850*   LOG = NO                                                     *
  1851*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1852******************************************************************
  1853******************************************************************
  1854*                   C H A N G E   L O G
  1855*
  1856* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1857*-----------------------------------------------------------------
  1858*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1859* EFFECTIVE    NUMBER
  1860*-----------------------------------------------------------------
  1861* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1862* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1863* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1864* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1865* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1866* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1867* 032306                   PEMA  ADD BOW LOAN NUMBER
  1868* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1869* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1870* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1871* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1872* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1873* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1874* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1875* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1876******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1877
  1878 01  PENDING-BUSINESS.
  1879     12  PB-RECORD-ID                     PIC XX.
  1880         88  VALID-PB-ID                        VALUE 'PB'.
  1881
  1882     12  PB-CONTROL-PRIMARY.
  1883         16  PB-COMPANY-CD                PIC X.
  1884         16  PB-ENTRY-BATCH               PIC X(6).
  1885         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1886         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1887
  1888     12  PB-CONTROL-BY-ACCOUNT.
  1889         16  PB-COMPANY-CD-A1             PIC X.
  1890         16  PB-CARRIER                   PIC X.
  1891         16  PB-GROUPING.
  1892             20  PB-GROUPING-PREFIX       PIC XXX.
  1893             20  PB-GROUPING-PRIME        PIC XXX.
  1894         16  PB-STATE                     PIC XX.
  1895         16  PB-ACCOUNT.
  1896             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1897             20  PB-ACCOUNT-PRIME         PIC X(6).
  1898         16  PB-CERT-EFF-DT               PIC XX.
  1899         16  PB-CERT-NO.
  1900             20  PB-CERT-PRIME            PIC X(10).
  1901             20  PB-CERT-SFX              PIC X.
  1902         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1903
  1904         16  PB-RECORD-TYPE               PIC X.
  1905             88  PB-MAILING-DATA                VALUE '0'.
  1906             88  PB-ISSUE                       VALUE '1'.
  1907             88  PB-CANCELLATION                VALUE '2'.
  1908             88  PB-BATCH-TRAILER               VALUE '9'.
  1909
  1910     12  PB-CONTROL-BY-ORIG-BATCH.
  1911         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1912         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1913         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1914         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1915
  1916     12  PB-CONTROL-BY-CSR.
  1917         16  PB-CSR-COMPANY-CD            PIC X.
  1918         16  PB-CSR-ID                    PIC X(4).
  1919         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1920         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1921         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1922******************************************************************
  1923*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1924******************************************************************
  1925
  1926     12  PB-LAST-MAINT-DT                 PIC XX.
  1927     12  PB-LAST-MAINT-BY                 PIC X(4).
  1928     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1929
  1930     12  PB-RECORD-BODY                   PIC X(375).
  1931
  1932     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1933         16  PB-CERT-ORIGIN               PIC X.
  1934             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1935         16  PB-I-NAME.
  1936             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1937             20  PB-I-INSURED-FIRST-NAME.
  1938                 24  PB-I-INSURED-1ST-INIT PIC X.
  1939                 24  FILLER                PIC X(9).
  1940             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1941         16  PB-I-AGE                     PIC S99   COMP-3.
  1942         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1943         16  PB-I-BIRTHDAY                PIC XX.
  1944         16  PB-I-INSURED-SEX             PIC X.
  1945             88  PB-SEX-MALE     VALUE 'M'.
  1946             88  PB-SEX-FEMALE   VALUE 'F'.
  1947
  1948         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1949         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1950         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1951         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1952         16  PB-I-SKIP-CODE               PIC X.
  1953             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1954             88  PB-SKIP-JULY              VALUE '1'.
  1955             88  PB-SKIP-AUGUST            VALUE '2'.
  1956             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1957             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1958             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1959             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1960             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1961             88  PB-SKIP-JUNE              VALUE '8'.
  1962             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1963             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1964             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1965         16  PB-I-TERM-TYPE               PIC X.
  1966             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1967             88  PB-PAID-WEEKLY            VALUE 'W'.
  1968             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1969             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1970             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1971         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1972         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1973         16  PB-I-DATA-ENTRY-SW           PIC X.
  1974             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1975             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1976             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1977             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1978         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1979         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1980*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1981         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1982         16  FILLER                       PIC X.
  1983
  1984         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1985             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1986             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1987                                                   '90' THRU '99'.
  1988         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1989                                          PIC XX.
  1990         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1991         16  PB-I-AMOUNT-FINANCED REDEFINES
  1992                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1993         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1994         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1995                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1996         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1997         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1998         16  PB-I-CLP-AMOUNT REDEFINES
  1999                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2000         16  PB-I-LF-CALC-FLAG            PIC X.
  2001             88 PB-COMP-LF-PREM               VALUE '?'.
  2002         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2003         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2004         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2005         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2006         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2007         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2008         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2009         16  PB-I-LF-ABBR                 PIC XXX.
  2010         16  PB-I-LF-INPUT-CD             PIC XX.
  2011
  2012         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2013             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2014             88  PB-INVALID-AH               VALUE '  ' '00'
  2015                                                   '90' THRU '99'.
  2016         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2017         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2018         16  PB-I-AH-CALC-FLAG            PIC X.
  2019             88 PB-COMP-AH-PREM                  VALUE '?'.
  2020         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2021         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2022         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2023         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2024         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2025         16  PB-I-AH-ABBR                 PIC XXX.
  2026         16  PB-I-AH-INPUT-CD             PIC XXX.
  2027
  2028         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2029         16  PB-I-REIN-TABLE              PIC XXX.
  2030         16  PB-I-BUSINESS-TYPE           PIC 99.
  2031         16  PB-I-INDV-GRP-CD             PIC X.
  2032         16  PB-I-MORT-CODE.
  2033             20  PB-I-TABLE               PIC X.
  2034             20  PB-I-INTEREST            PIC XX.
  2035             20  PB-I-MORT-TYP            PIC X.
  2036         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2037         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2038         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2039         16  PB-I-INDV-GRP-OVRD           PIC X.
  2040         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2041         16  PB-I-SIG-SW                  PIC X.
  2042             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2043         16  PB-I-RATE-CLASS              PIC XX.
  2044         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2045         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2046         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2047         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2048         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2049         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2050         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2051         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2052         16  PB-I-OB-FLAG                 PIC X.
  2053             88  PB-I-OB                      VALUE 'B'.
  2054             88  PB-I-SUMMARY                 VALUE 'Z'.
  2055         16  PB-I-ENTRY-STATUS            PIC X.
  2056             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2057                                              'M' '5' '9' '2'.
  2058             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2059             88  PB-I-POLICY-PENDING          VALUE '2'.
  2060             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2061             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2062             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2063             88  PB-I-REIN-ONLY               VALUE '9'.
  2064             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2065             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2066             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2067             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2068         16  PB-I-INT-CODE                PIC X.
  2069             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2070             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2071         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2072         16  PB-I-SOC-SEC-NO              PIC X(11).
  2073         16  PB-I-MEMBER-NO               PIC X(12).
  2074         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2075*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2076         16  PB-I-OLD-LOF                 PIC XXX.
  2077         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2078         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2079         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2080         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2081         16  PB-I-LIFE-INDICATOR          PIC X.
  2082             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2083         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2084         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2085                                          PIC S9(5)V99    COMP-3.
  2086         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2087             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2088             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2089         16  PB-I-1ST-PMT-DT              PIC XX.
  2090         16  PB-I-JOINT-INSURED.
  2091             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2092             20 PB-I-JOINT-FIRST-NAME.
  2093                24  PB-I-JOINT-FIRST-INIT PIC X.
  2094                24  FILLER                PIC X(9).
  2095             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2096*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2097         16  PB-I-BENEFICIARY-NAME.
  2098             20  PB-I-BANK-NUMBER         PIC X(10).
  2099             20  FILLER                   PIC X(15).
  2100         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2101         16  PB-I-REFERENCE               PIC X(12).
  2102         16  FILLER REDEFINES PB-I-REFERENCE.
  2103             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2104             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2105             20  PB-I-CLP-STATE           PIC XX.
  2106         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2107             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2108             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2109             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2110         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2111         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2112         16  PB-I-RESIDENT-STATE          PIC XX.
  2113         16  PB-I-RATE-CODE               PIC X(4).
  2114         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2115         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2116         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2117         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2118         16  PB-I-BANK-NOCHRGB            PIC 99.
  2119         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2120         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2121
  2122     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2123         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2124             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2125         16  PB-C-CANCEL-ORIGIN           PIC X.
  2126             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2127         16  PB-C-LF-CANCEL-DT            PIC XX.
  2128         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2129         16  PB-C-LF-CALC-REQ             PIC X.
  2130             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2131         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2132         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2133         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2134             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2135         16  PB-C-AH-CANCEL-DT            PIC XX.
  2136         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2137         16  PB-C-AH-CALC-REQ             PIC X.
  2138             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2139         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2140         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2141         16  PB-C-LAST-NAME               PIC X(15).
  2142         16  PB-C-REFUND-SW               PIC X.
  2143             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2144             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2145         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2146         16  PB-C-PAYEE-CODE              PIC X(6).
  2147         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2148         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2149         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2150         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2151         16  PB-C-REFERENCE               PIC X(12).
  2152         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2153         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2154         16  PB-C-POST-CARD-IND           PIC X.
  2155         16  PB-C-CANCEL-REASON           PIC X.
  2156         16  PB-C-REF-INTERFACE-SW        PIC X.
  2157         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2158         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2159         16  FILLER                       PIC X(01).
  2160*        16  FILLER                       PIC X(18).
  2161         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2162*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2163         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2164         16  PB-CANCELED-CERT-DATA.
  2165             20  PB-CI-INSURED-NAME.
  2166                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2167                 24  PB-CI-INITIALS       PIC XX.
  2168             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2169             20  PB-CI-INSURED-SEX        PIC X.
  2170             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2171             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2172             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2173             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2174             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2175             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2176             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2177             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2178             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2179             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2180             20  PB-CI-RATE-CLASS         PIC XX.
  2181             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2182             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2183             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2184             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2185             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2186             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2187             20  PB-CI-LF-ABBR            PIC X(3).
  2188             20  PB-CI-AH-ABBR            PIC X(3).
  2189             20  PB-CI-OB-FLAG            PIC X.
  2190                 88  PB-CI-OB                VALUE 'B'.
  2191             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2192                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2193                                           'M' '4' '5' '9' '2'.
  2194                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2195                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2196                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2197                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2198                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2199                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2200                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2201                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2202                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2203                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2204                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2205                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2206             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2207                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2208                                           'M' '4' '5' '9' '2'.
  2209                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2210                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2211                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2212                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2213                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2214                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2215                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2216                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2217                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2218                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2219                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2220                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2221             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2222             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2223             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2224             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2225             20  PB-CI-INT-CODE           PIC X.
  2226                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2227                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2228             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2229             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2230             20  PB-CI-COMP-EXCP-SW       PIC X.
  2231                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2232                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2233             20  PB-CI-ENTRY-STATUS       PIC X.
  2234             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2235             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2236             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2237             20  PB-CI-DEATH-DT           PIC XX.
  2238             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2239             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2240             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2241             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2242             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2243             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2244             20  PB-CI-ENTRY-DT              PIC XX.
  2245             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2246             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2247             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2248             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2249             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2250             20  PB-CI-OLD-LOF               PIC XXX.
  2251*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2252             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2253             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2254             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2255             20  PB-CI-INDV-GRP-CD           PIC X.
  2256             20  PB-CI-BENEFICIARY-NAME.
  2257                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2258                 24  FILLER                  PIC X(15).
  2259             20  PB-CI-NOTE-SW               PIC X.
  2260             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2261             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2262             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2263             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2264             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2265             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2266             20  PB-CI-FIRST-NAME            PIC X(10).
  2267             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2268
  2269         16  FILLER                       PIC X(13).
  2270*032306  16  FILLER                       PIC X(27).
  2271*        16  FILLER                       PIC X(46).
  2272
  2273     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2274         16  FILLER                       PIC X(10).
  2275         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2276         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2277         16  PB-M-INSURED-MID-INIT        PIC X.
  2278         16  PB-M-INSURED-AGE             PIC 99.
  2279         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2280         16  PB-M-INSURED-SEX             PIC X.
  2281         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2282         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2283         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2284         16  PB-M-INSURED-CITY-STATE.
  2285             20  PB-M-INSURED-CITY        PIC X(28).
  2286             20  PB-M-INSURED-STATE       PIC XX.
  2287         16  PB-M-INSURED-ZIP-CODE.
  2288             20  PB-M-INSURED-ZIP-PRIME.
  2289                 24  PB-M-INSURED-ZIP-1   PIC X.
  2290                     88  PB-M-CANADIAN-POST-CODE
  2291                                             VALUE 'A' THRU 'Z'.
  2292                 24  FILLER               PIC X(4).
  2293             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2294         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2295                                        PB-M-INSURED-ZIP-CODE.
  2296             20  PM-M-INS-CAN-POST1       PIC XXX.
  2297             20  PM-M-INS-CAN-POST2       PIC XXX.
  2298             20  FILLER                   PIC XXX.
  2299         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2300         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2301         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2302         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2303         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2304         16  PB-M-CRED-BENE-CITYST.
  2305             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2306             20  PB-M-CRED-BENE-STATE     PIC XX.
  2307
  2308         16  FILLER                       PIC X(92).
  2309
  2310     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2311         16  FILLER                       PIC X(10).
  2312         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2313         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2314         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2315         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2316         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2317         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2318         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2319         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2320         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2321         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2322         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2323         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2324         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2325         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2326         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2327         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2328         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2329         16  PB-ACCOUNT-NAME              PIC X(30).
  2330         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2331         16  PB-REFERENCE                 PIC X(12).
  2332         16  PB-B-RECEIVED-DT             PIC XX.
  2333         16  FILLER                       PIC X(234).
  2334
  2335     12  PB-RECORD-STATUS.
  2336         16  PB-CREDIT-SELECT-DT          PIC XX.
  2337         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2338         16  PB-BILLED-DT                 PIC XX.
  2339         16  PB-BILLING-STATUS            PIC X.
  2340             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2341             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2342             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2343         16  PB-RECORD-BILL               PIC X.
  2344             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2345             88  PB-RECORD-RETURNED           VALUE 'R'.
  2346             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2347             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2348             88  PB-OVERRIDE-AH               VALUE 'A'.
  2349             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2350         16  PB-BATCH-ENTRY               PIC X.
  2351             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2352             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2353             88  PB-REISSUED-CERT             VALUE 'E'.
  2354             88  PB-MONTHLY-CERT              VALUE 'M'.
  2355             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2356             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2357             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2358         16  PB-FORCE-CODE                PIC X.
  2359             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2360             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2361             88  PB-CANCEL-FORCE              VALUE '8'.
  2362             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2363             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2364             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2365             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2366             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2367             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2368             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2369         16  PB-FATAL-FLAG                PIC X.
  2370             88  PB-FATAL-ERRORS              VALUE 'X'.
  2371         16  PB-FORCE-ER-CD               PIC X.
  2372             88  PB-FORCE-ERRORS              VALUE 'F'.
  2373             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2374         16  PB-WARN-ER-CD                PIC X.
  2375             88  PB-WARNING-ERRORS            VALUE 'W'.
  2376         16  FILLER                       PIC X.
  2377         16  PB-OUT-BAL-CD                PIC X.
  2378             88  PB-OUT-OF-BAL                VALUE 'O'.
  2379         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2380         16  PB-AH-OVERRIDE-L1            PIC X.
  2381         16  PB-INPUT-DT                  PIC XX.
  2382         16  PB-INPUT-BY                  PIC X(4).
  2383         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2384         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2385         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2386         16  PB-LF-EARNING-METHOD         PIC X.
  2387         16  PB-AH-EARNING-METHOD         PIC X.
  2388         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2389         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2390         16  PB-REIN-CD                   PIC XXX.
  2391         16  PB-LF-REFUND-TYPE            PIC X.
  2392         16  PB-AH-REFUND-TYPE            PIC X.
  2393         16  PB-ACCT-EFF-DT               PIC XX.
  2394         16  PB-ACCT-EXP-DT               PIC XX.
  2395         16  PB-COMPANY-ID                PIC X(3).
  2396         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2397         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2398         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2399         16  PB-SV-GROUPING               PIC X(6).
  2400         16  PB-SV-STATE                  PIC XX.
  2401         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2402         16  PB-GA-BILLING-INFO.
  2403             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2404                                          PIC XX.
  2405         16  PB-SV-REMIT-TO  REDEFINES
  2406             PB-GA-BILLING-INFO           PIC X(10).
  2407         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2408         16  PB-I-LOAN-OFFICER            PIC X(5).
  2409         16  PB-I-VIN                     PIC X(17).
  2410
  2411         16  FILLER                       PIC X(04).
  2412         16  IMNET-BYPASS-SW              PIC X.
  2413
  2414******************************************************************
  2415*                COMMON EDIT ERRORS                              *
  2416******************************************************************
  2417
  2418     12  PB-COMMON-ERRORS.
  2419         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2420                                           PIC S9(4)     COMP.
  2421
  2422******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  45
* EL517.cbl
  2424 FD  ERREIN.
* 2425                                  COPY ERCREIN.
  2426******************************************************************07/27/93
  2427*                                                                *ERCREIN
  2428*                            ERCREIN                             *   LV009
  2429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2430*                            VMOD=2.010                          *   CL**9
  2431*                                                                *ERCREIN
  2432*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2433*                                                                *ERCREIN
  2434*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2435*                                                                *ERCREIN
  2436*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2437*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2438*                                                                *ERCREIN
  2439*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2440*       ALTERNATE PATH = NONE                                    *ERCREIN
  2441*                                                                *ERCREIN
  2442*   LOG = NO                                                     *ERCREIN
  2443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2444*                                                                *ERCREIN
  2445******************************************************************ERCREIN
  2446*                   C H A N G E   L O G
  2447*
  2448* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2449*-----------------------------------------------------------------
  2450*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2451* EFFECTIVE    NUMBER
  2452*-----------------------------------------------------------------
  2453* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2454* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2455******************************************************************
  2456 01  REINSURANCE-RECORD.                                          ERCREIN
  2457     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2458         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2459                                                                  ERCREIN
  2460     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2461         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2462         16  RE-KEY.                                              ERCREIN
  2463             20  RE-CODE                   PIC X.                 ERCREIN
  2464                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2465                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2466             20  RE-TABLE                  PIC XXX.               ERCREIN
  2467             20  FILLER                    PIC XXX.               ERCREIN
  2468         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2469             20  FILLER                    PIC X.                 ERCREIN
  2470             20  RE-COMPANY.                                      ERCREIN
  2471                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2472                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2473                                                                  ERCREIN
  2474     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2475         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2476         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2477         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2478         16  FILLER                        PIC X(10).             ERCREIN
  2479                                                                  ERCREIN
  2480     12  RE-TABLE-DATA.                                           ERCREIN
  2481         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2482                                                                  ERCREIN
  2483         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2484             20  RE-REI-COMP-NO.                                  ERCREIN
  2485                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2486                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2487             20  RE-LF-QC                  PIC X.                 ERCREIN
  2488             20  RE-AH-QC                  PIC X.                 ERCREIN
  2489             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2490             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2491             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2492             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2493             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2494             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2495             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2496             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2497             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2498             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2499             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2500             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2501             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2502             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2503             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2504             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2505             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2506             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2507             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2508             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2509             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2510             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2511             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2512             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2513             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2514             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2515             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2516             20  RE-REMAINING              PIC X.                 ERCREIN
  2517             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2518             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2519             20  FILLER                    PIC X(19).                  000
  2520                                                                  ERCREIN
  2521         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2522         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2523         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2524         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2525             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2526                                                                  ERCREIN
  2527         16  FILLER                        PIC X(27).             ERCREIN
  2528                                                                  ERCREIN
  2529     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2530         16  RE-NAME                       PIC X(30).             ERCREIN
  2531         16  RE-LF-PE                      PIC X.                 ERCREIN
  2532         16  RE-AH-PE                      PIC X.                 ERCREIN
  2533         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2534         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2535         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2536         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2537         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2538         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2539         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2540         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2541         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2542         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2543         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2544         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2545         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2546         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2547         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2548         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2549         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2550         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2551                                                                  ERCREIN
  2552         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2553             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2554                                                                  ERCREIN
  2555         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2556             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2557                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2558                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2559                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2560                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2561             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2562                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2563                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2564                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2565                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2566                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2567                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2568                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2569                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2570             20  FILLER                    PIC XXX.               ERCREIN
  2571             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2572                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2573                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2574                                                                  ERCREIN
  2575         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2576             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2577                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2578                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2579                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2580                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2581             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2582                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2583                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2584                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2585                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2586                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2587                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2588                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2589                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2590             20  FILLER                    PIC XXX.               ERCREIN
  2591             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2592                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2593                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2594                                                                  ERCREIN
  2595         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2596                                                                  ERCREIN
  2597         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2598                                                                  ERCREIN
  2599         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2600         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2601         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2602         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2603         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2604         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2605         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2606         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2607         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2608             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2609             88  RE-CEDED                          VALUE 'C'.        CL**2
  2610             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2611             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2612                                                                  ERCREIN
  2613         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2614             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2615         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2616             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2617         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2618             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2619         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2620             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2621         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2622             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2623                                                                     CL**3
  2624         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2625                                                                     CL**5
  2626         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2627                                                                     CL**8
  2628         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2629                                                                     CL**8
  2630         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2631                                                                     CL**9
  2632         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2633             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2634             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2635
  2636         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2637             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2638                                                                     CL**9
  2639         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2640         16  FILLER                        PIC X(2281).              CL**9
  2641                                                                  ERCREIN
  2642         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2643                                                                  ERCREIN
  2644******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  49
* EL517.cbl
  2646 FD  ELCERT.
* 2647                                  COPY ELCCERT.
  2648******************************************************************04/15/98
  2649*                                                                *ELCCERT
  2650*                            ELCCERT.                            *   LV002
  2651*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2652*                            VMOD=2.013                          *   CL**2
  2653*                                                                *ELCCERT
  2654*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2655*                                                                *ELCCERT
  2656*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2657*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2658*                                                                *ELCCERT
  2659*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2660*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2661*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2662*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2663*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2664*                                                                *ELCCERT
  2665*   LOG = YES                                                    *ELCCERT
  2666*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2667******************************************************************
  2668*                   C H A N G E   L O G
  2669*
  2670* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2671*-----------------------------------------------------------------
  2672*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2673* EFFECTIVE    NUMBER
  2674*-----------------------------------------------------------------
  2675* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2676* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2677* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2678* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2679* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2680* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2681* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2682* 032612  CR2011110200001  PEMA  AHL CHANGES
  2683******************************************************************
  2684                                                                  ELCCERT
  2685 01  CERTIFICATE-MASTER.                                          ELCCERT
  2686     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2687         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2688                                                                  ELCCERT
  2689     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2690         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2691         16  CM-CARRIER                    PIC X.                 ELCCERT
  2692         16  CM-GROUPING.                                         ELCCERT
  2693             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2694             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2695         16  CM-STATE                      PIC XX.                ELCCERT
  2696         16  CM-ACCOUNT.                                          ELCCERT
  2697             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2698             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2699         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2700         16  CM-CERT-NO.                                          ELCCERT
  2701             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2702             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2703                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2704     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2705         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2706         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2707         16  CM-INSURED-INITIALS.                                 ELCCERT
  2708             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2709             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2710                                                                  ELCCERT
  2711     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2712         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2713         16  CM-SOC-SEC-NO.                                       ELCCERT
  2714             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2715             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2716             20  CM-SSN-LN3.                                      ELCCERT
  2717                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2718                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2719                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2720                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2721                                                                  ELCCERT
  2722     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2723         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2724         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2725                                                                  ELCCERT
  2726     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2727         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2728         16  CM-MEMBER-NO.                                        ELCCERT
  2729             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2730             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2731             20  CM-MEMB-LN4.                                     ELCCERT
  2732                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2733                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2734                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2735                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2736                                                                  ELCCERT
  2737     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2738         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2739             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2740             20  FILLER                    PIC X(9).              ELCCERT
  2741         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2742         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2743             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2744             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2745         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2746         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2747             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2748             20  CM-JT-FIRST-NAME.                                ELCCERT
  2749                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2750                 24  FILLER                PIC X(9).              ELCCERT
  2751             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2752                                                                  ELCCERT
  2753     12  CM-LIFE-DATA.                                            ELCCERT
  2754         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2755         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2756         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2757         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2758         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2759         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2760         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2761         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2762         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2763         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2764         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2765         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2766         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2767         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2768         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2769         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2770         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2771         16  FILLER                        PIC XX.                ELCCERT
  2772                                                                  ELCCERT
  2773     12  CM-AH-DATA.                                              ELCCERT
  2774         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2775         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2776         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2777         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2778         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2779         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2780         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2781         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2782         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2783         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2784         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2785         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2786             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2787         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2788         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2789         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2790         16  FILLER                        PIC X.                 ELCCERT
  2791                                                                  ELCCERT
  2792     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2793         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2794         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2795                                           PIC S9(5)V99  COMP-3.
  2796         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2797         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2798         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2799         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2800         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2801         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2802         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2803         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2804         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2805         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2806             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2807             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2808         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2809             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2810             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2811             20  FILLER                    PIC XX.                ELCCERT
  2812         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2813             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2814             20  FILLER                    PIC XXX.               ELCCERT
  2815         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2816         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2817             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2818         16  CM-POST-CARD-IND              PIC X.
  2819         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2820         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2821             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2822             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2823             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2824         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2825             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2826             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2827         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2828             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2829             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2830             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2831             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2832             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2833             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2834             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2835             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2836             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2837             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2838             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2839             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2840         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2841             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2842             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2843             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2844             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2845             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2846         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2847         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2848         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2849*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2850         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2851         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2852         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2853         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2854         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2855                                                                  ELCCERT
  2856     12  CM-STATUS-DATA.                                          ELCCERT
  2857         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2858         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2859                                                                  ELCCERT
  2860         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2861         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2862         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2863                                                                  ELCCERT
  2864         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2865         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2866         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2867                                                                  ELCCERT
  2868         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2869             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2870                                                'M' '4' '5' '9'.  ELCCERT
  2871             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2872             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2873             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2874             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2875             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2876             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2877             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2878             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2879             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2880             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2881             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2882             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2883                                                                  ELCCERT
  2884         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2885         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2886         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2887                                                                  ELCCERT
  2888         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2889         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2890         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2891                                                                  ELCCERT
  2892         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2893             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2894                                                'M' '4' '5' '9'.  ELCCERT
  2895             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2896             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2897             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2898             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2899             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2900             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2901             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2902             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2903             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2904             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2905             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2906             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2907                                                                  ELCCERT
  2908         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2909             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2910             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2911             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2912         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2913                                                                  ELCCERT
  2914         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2915         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2916         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2917         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2918                                                                  ELCCERT
  2919     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2920         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2921         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2922         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2923         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2924         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2925         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2926         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2927         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2928     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2929         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2930         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2931     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2932         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2933         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2934                                                                  ELCCERT
  2935*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2936     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2937     12  FILLER                            PIC X.
  2938                                                                  ELCCERT
  2939*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2940     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2941     12  FILLER                            PIC X.
  2942*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2943     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2944                                                                  ELCCERT
  2945     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2946         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2947         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2948         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2949         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2950         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2951     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2952         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2953         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2954         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2955         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2956         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2957         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2958         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2959         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2960                                                                  ELCCERT
  2961     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2962         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2963         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2964                                                                  ELCCERT
  2965     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2966     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2967     12  CM-CLP-STATE                      PIC XX.
  2968     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2969     12  CM-USER-RESERVED                  PIC XXX.
  2970     12  FILLER REDEFINES CM-USER-RESERVED.
  2971         16  CM-AH-CLASS-CD                PIC XX.
  2972         16  F                             PIC X.
  2973******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  55
* EL517.cbl
  2975 FD  ELMSTR.
* 2976                                  COPY ELCMSTR.
  2977******************************************************************04/15/98
  2978*                                                                *ELCMSTR
  2979*                            ELCMSTR.                            *   LV002
  2980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2981*                            VMOD=2.012                          *   CL**2
  2982*                                                                *ELCMSTR
  2983*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2984*                                                                *ELCMSTR
  2985*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2986*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2987*                                                                *ELCMSTR
  2988*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2989*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2990*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2991*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2992*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2993*                                                 RKP=75,LEN=21  *ELCMSTR
  2994*                                                                *ELCMSTR
  2995*   **** NOTE ****                                               *ELCMSTR
  2996*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2997*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2998*                                                                *ELCMSTR
  2999*   LOG = YES                                                    *ELCMSTR
  3000*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  3001******************************************************************
  3002*                   C H A N G E   L O G
  3003*
  3004* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3005*-----------------------------------------------------------------
  3006*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3007* EFFECTIVE    NUMBER
  3008*-----------------------------------------------------------------
  3009* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3010* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3011* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3012* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3013******************************************************************ELCMSTR
  3014 01  CLAIM-MASTER.                                                ELCMSTR
  3015     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  3016         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  3017                                                                  ELCMSTR
  3018     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3019         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3020         16  CL-CARRIER              PIC X.                       ELCMSTR
  3021         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3022         16  CL-CERT-NO.                                          ELCMSTR
  3023             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3024             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3025                                                                  ELCMSTR
  3026     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3027         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3028         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3029         16  CL-INSURED-NAME.                                     ELCMSTR
  3030             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3031             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3032                                                                  ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  56
* EL517.cbl (/apps/test/cid1s/copy/ELCMSTR)
  3033     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
  3034         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  3035         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3036             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3037             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3038             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3039                                                                  ELCMSTR
  3040     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3041         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3042         16  CL-CERT-NO-A4.                                       ELCMSTR
  3043             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3044             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3045                                                                  ELCMSTR
  3046     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3047         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3048         16  CL-CCN-A5.                                           ELCMSTR
  3049             20  CL-CCN.                                          ELCMSTR
  3050                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3051                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3052             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3053                                                                  ELCMSTR
  3054     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3055         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3056         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3057             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3058             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3059             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3060         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3061         16  FILLER                  PIC X(5).                    ELCMSTR
  3062                                                                  ELCMSTR
  3063     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3064         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3065         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3066             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3067             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3068         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3069*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3070*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3071*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3072*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3073*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3074         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3075             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3076             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3077             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3078         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3079         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3080         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3081         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3082         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3083         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3084         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3085         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3086         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3087         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3088         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3089             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3090             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  57
* EL517.cbl (/apps/test/cid1s/copy/ELCMSTR)
  3091             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
  3092         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  3093                                                                  ELCMSTR
  3094         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3095             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3096             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3097                                                                  ELCMSTR
  3098         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3099             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3100             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3101                                                                  ELCMSTR
  3102         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3103         16  FILLER REDEFINES CL-MICROFILM-NO.
  3104             20  CL-BENEFIT-PERIOD   PIC 99.
  3105             20  FILLER              PIC X(8).
  3106         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3107         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3108                                                                  ELCMSTR
  3109         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3110         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3111         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3112             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3113             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3114             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3115             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3116             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3117             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3118         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3119         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3120         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3121             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3122         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3123         16  FILLER                  PIC X.
  3124                                                                  ELCMSTR
  3125     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3126         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3127             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3128             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3129             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3130         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3131             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3132             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3133             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3134             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3135                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3136                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3137             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3138                                                                  ELCMSTR
  3139     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3140         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3141             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3142             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3143         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3144             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3145             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3146         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3147         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3148         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  58
* EL517.cbl (/apps/test/cid1s/copy/ELCMSTR)
  3149         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3150         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3151         16  CL-CRITICAL-PERIOD      PIC 99.
  3152*        16  FILLER                  PIC XX.                      ELCMSTR
  3153         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3154         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  3155         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3156         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3157             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3158             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3159             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3160             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3161             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3162             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3163             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3164             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3165             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3166         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3167         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3168         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3169         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3170         16  CL-DENIAL-TYPE          PIC X.
  3171             88  CL-TYPE-DENIAL          VALUE '1'.
  3172             88  CL-TYPE-RESCISSION      VALUE '2'.
  3173             88  CL-TYPE-REFORMATION     VALUE '3'.
  3174             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3175             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3176         16  filler                  pic x(5).
  3177*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3178*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3179*        16  CL-RTW-DT               PIC XX.
  3180                                                                  ELCMSTR
  3181     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3182         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3183             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3184             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3185             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3186         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3187         16  FILLER                  PIC XX.                      ELCMSTR
  3188         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3189         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3190             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3191                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3192             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3193                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3194             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3195                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3196             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3197                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3198             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3199                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3200             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3201                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3202             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3203                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3204                                                                  ELCMSTR
  3205     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3206         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  59
* EL517.cbl (/apps/test/cid1s/copy/ELCMSTR)
  3207         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3208                                                                  ELCMSTR
  3209     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3210                                                                  ELCMSTR
  3211     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  3212         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3213             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3214         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3215             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  3216                                                                  ELCMSTR
  3217     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3218                                                                  ELCMSTR
  3219     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3220         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3221         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3222         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3223         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3224                                                                  ELCMSTR
  3225     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3226         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3227         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3228         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3229         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3230                                                                  ELCMSTR
  3231     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3232     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3233     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3234                                                                  ELCMSTR
  3235     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3236     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3237     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3238     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3239                                                                  ELCMSTR
  3240     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3241     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3242         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3243         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3244         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3245     12  cl-insured-type             pic x.
  3246         88  cl-claim-on-primary         value 'P'.
  3247         88  cl-claim-on-co-borrower     value 'C'.
  3248     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  60
* EL517.cbl
  3250 FD  ERCTBL.
* 3251                                 COPY ERCCTBL.
  3252******************************************************************04/29/98
  3253*                                                                *ERCCTBL
  3254*                                                                *ERCCTBL
  3255*                            ERCCTBL                             *   LV002
  3256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3257*                            VMOD=2.003                              CL**2
  3258*                                                                *ERCCTBL
  3259*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3260*                                                                *ERCCTBL
  3261*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3262*                                                                *ERCCTBL
  3263*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3264*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3265*                                                                *ERCCTBL
  3266*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3267*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3268*                                                                *ERCCTBL
  3269*   LOG = NO                                                     *ERCCTBL
  3270*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3271*                                                                *ERCCTBL
  3272*                                                                *ERCCTBL
  3273******************************************************************ERCCTBL
  3274                                                                  ERCCTBL
  3275 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3276     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3277         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3278                                                                  ERCCTBL
  3279     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3280         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3281         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3282         16  CT-CNTRL-2.                                          ERCCTBL
  3283             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3284             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3285                                                                  ERCCTBL
  3286     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3287         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3288         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3289         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3290         16  FILLER                        PIC X(31).             ERCCTBL
  3291                                                                  ERCCTBL
  3292     12  CT-LIMITS.                                               ERCCTBL
  3293         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3294                                                                  ERCCTBL
  3295         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3296                                                                  ERCCTBL
  3297         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3298                                                                  ERCCTBL
  3299     12  CT-RATES.                                                ERCCTBL
  3300         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3301             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3302             20  CT-RT-R   REDEFINES                              ERCCTBL
  3303                 CT-RT                     PIC XXX.               ERCCTBL
  3304                                                                  ERCCTBL
  3305     12  FILLER                            PIC  X(42).            ERCCTBL
  3306                                                                  ERCCTBL
  3307******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  61
* EL517.cbl
  3308
  3309 FD  ERACCT.
* 3310                                 COPY ERCACCT.
  3311******************************************************************04/19/98
  3312*                                                                *ERCACCT
  3313*                                                                *ERCACCT
  3314*                            ERCACCT                             *   LV031
  3315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3316*                            VMOD=2.031                          *ERCACCT
  3317*                                                                *ERCACCT
  3318*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3319*                                                                *ERCACCT
  3320*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3321*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3322*                                                                *ERCACCT
  3323*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3324*                                                                *ERCACCT
  3325*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3326*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3327*                                                                *ERCACCT
  3328*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3329*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3330*                                                                *ERCACCT
  3331*   LOG = NO                                                     *ERCACCT
  3332*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3333*                                                                *ERCACCT
  3334*                                                                *ERCACCT
  3335******************************************************************ERCACCT
  3336*                   C H A N G E   L O G
  3337*
  3338* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3339*-----------------------------------------------------------------
  3340*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3341* EFFECTIVE    NUMBER
  3342*-----------------------------------------------------------------
  3343* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3344* 092705    2005050300006  PEMA  ADD SPP LEASES
  3345* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3346* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3347* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3348* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3349* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3350******************************************************************
  3351                                                                  ERCACCT
  3352 01  ACCOUNT-MASTER.                                              ERCACCT
  3353     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3354         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3355                                                                  ERCACCT
  3356     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3357         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3358         16  AM-MSTR-CNTRL.                                       ERCACCT
  3359             20  AM-CONTROL-A.                                    ERCACCT
  3360                 24  AM-CARRIER            PIC X.                 ERCACCT
  3361                 24  AM-GROUPING.                                 ERCACCT
  3362                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3363                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3364                 24  AM-STATE              PIC XX.                ERCACCT
  3365                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3366                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3367                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3368             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3369                                           PIC X(19).             ERCACCT
  3370             20  AM-CNTRL-B.                                      ERCACCT
  3371                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3372                 24  FILLER                PIC X(4).              ERCACCT
  3373             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3374                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3375                                                                  ERCACCT
  3376     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3377         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3378         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3379         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3380         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3381         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3382         16  AM-VG-DATE.                                          ERCACCT
  3383             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3384             20  FILLER                    PIC X(4).              ERCACCT
  3385         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3386                                           PIC 9(11)      COMP-3. ERCACCT
  3387     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3388         16  FILLER                        PIC X(10).
  3389         16  AM-VG-KEY3.
  3390             20  AM-VG3-ACCOUNT            PIC X(10).
  3391             20  AM-VG3-EXP-DT             PIC XX.
  3392         16  FILLER                        PIC X(4).
  3393     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3394         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3395         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3396         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3397         16  FILLER                        PIC XX.                ERCACCT
  3398                                                                  ERCACCT
  3399     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3400     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3401                                                                  ERCACCT
  3402     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3403         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3404         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3405                                                                  ERCACCT
  3406     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3407     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3408                                                                  ERCACCT
  3409     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3410     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3411                                                                  ERCACCT
  3412     12  AM-NAME                           PIC X(30).             ERCACCT
  3413     12  AM-PERSON                         PIC X(30).             ERCACCT
  3414     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3415     12  AM-CITY.
  3416         16  AM-ADDR-CITY                  PIC X(28).
  3417         16  AM-ADDR-STATE                 PIC XX.
  3418     12  AM-ZIP.                                                  ERCACCT
  3419         16  AM-ZIP-PRIME.                                        ERCACCT
  3420             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3421                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3422             20  FILLER                    PIC X(4).              ERCACCT
  3423         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3424     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3425         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3426         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3427         16  FILLER                        PIC XXX.               ERCACCT
  3428     12  AM-TEL-NO.                                               ERCACCT
  3429         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3430         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3431         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3432     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3433         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3434         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3435                                                                  ERCACCT
  3436     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3437         16  AM-DEFN-1.                                           ERCACCT
  3438             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3439                 24  AM-AGT.                                      ERCACCT
  3440                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3441                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3442                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3443                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3444                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3445                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3446                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3447                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3448                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3449                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3450                 24  FILLER                PIC X(01).             ERCACCT
  3451         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3452             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3453                 24  FILLER                PIC X(11).             ERCACCT
  3454                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3455                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3456                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3457                 24  FILLER                PIC X(6).              ERCACCT
  3458                                                                  ERCACCT
  3459     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3460         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3461                                                                  ERCACCT
  3462     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3463                                                                  ERCACCT
  3464     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3465         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3466         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3467     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3468         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3469         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3470     12  AM-GPCD                           PIC 99.                ERCACCT
  3471     12  AM-IG                             PIC X.                 ERCACCT
  3472         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3473         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3474     12  AM-STATUS                         PIC X.                 ERCACCT
  3475         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3476         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3477         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3478         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3479         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3480         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3481     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3482     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3483                                                                  ERCACCT
  3484     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3485     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3486     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3487     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3488     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3489     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3490     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3491     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3492     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3493                                                                  ERCACCT
  3494     12  AM-USER-FIELDS.                                          ERCACCT
  3495         16  AM-FLD-1                      PIC XX.                ERCACCT
  3496         16  AM-FLD-2                      PIC XX.                ERCACCT
  3497         16  AM-FLD-3                      PIC XX.                ERCACCT
  3498         16  AM-FLD-4                      PIC XX.                ERCACCT
  3499         16  AM-FLD-5                      PIC XX.                ERCACCT
  3500                                                                  ERCACCT
  3501     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3502         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3503         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3504         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3505     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3506     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3507         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3508         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3509         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3510     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3511     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3512     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3513     12  AM-INACTIVE-DATE.                                        ERCACCT
  3514         16  AM-INA-MO                     PIC 99.                ERCACCT
  3515         16  AM-INA-DA                     PIC 99.                ERCACCT
  3516         16  AM-INA-YR                     PIC 99.                ERCACCT
  3517     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3518                                                                  ERCACCT
  3519     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3520     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3521                                                                  ERCACCT
  3522     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3523         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3524         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3525         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3526         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3527                                                                  ERCACCT
  3528     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3529         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3530         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3531                                                                  ERCACCT
  3532     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3533                                                                  ERCACCT
  3534     12  AM-OVER-SHORT.                                           ERCACCT
  3535         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3536         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3537                                                                  ERCACCT
  3538     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3539     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3540                                                                  ERCACCT
  3541     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3542     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3543                                                                  ERCACCT
  3544     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3545     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3546     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3547     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3548     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3549     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3550     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3551     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3552     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3553     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3554     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3555     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3556     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3557     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3558     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3559     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3560                                                                  ERCACCT
  3561     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3562                                                                  ERCACCT
  3563     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3564     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3565                                                                  ERCACCT
  3566     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3567     12  AM-EARN-METHODS.                                         ERCACCT
  3568         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3569             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3570             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3571             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3572             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3573         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3574             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3575             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3576             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3577             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3578         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3579             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3580             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3581             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3582             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3583             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3584             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3585                                                                  ERCACCT
  3586     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3587     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3588     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3589                                                                  ERCACCT
  3590     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3591     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3592     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3593     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3594     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3595     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3596         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3597         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3598     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3599         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3600         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3601         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3602     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3603         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3604         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3605     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3606         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3607         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3608         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3609     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3610     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3611                                                                  ERCACCT
  3612     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3613         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3614         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3615         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3616         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3617         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3618                                                                  ERCACCT
  3619     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3620                                                                  ERCACCT
  3621     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3622                                                                  ERCACCT
  3623     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3624         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3625                                                                  ERCACCT
  3626     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3627         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3628         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3629                                                                  ERCACCT
  3630     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3631         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3632                                                                  ERCACCT
  3633     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3634         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3635         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3636                                                                  ERCACCT
  3637     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3638                                                                  ERCACCT
  3639     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3640     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3641     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3642     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3643     12  AM-DCC-UEF-STATE                  PIC XX.
  3644     12  FILLER                            PIC XXX.
  3645     12  AM-REPORT-CODE-3                  PIC X(10).
  3646*    12  FILLER                            PIC X(22).             ERCACCT
  3647                                                                  ERCACCT
  3648     12  AM-RESERVE-DATE.                                         ERCACCT
  3649         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3650         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3651         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3652                                                                  ERCACCT
  3653     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3654     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3655         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3656         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3657         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3658         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3659                                                                  ERCACCT
  3660     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3661         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3662         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3663         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3664         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3665                                                                  ERCACCT
  3666     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3667         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3668             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3669             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3670             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3671             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3672             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3673             20  FILLER                    PIC XX.                ERCACCT
  3674         16  FILLER                        PIC X(80).             ERCACCT
  3675                                                                  ERCACCT
  3676     12  AM-TRANSFER-DATA.                                        ERCACCT
  3677         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3678             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3679             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3680                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3681                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3682             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3683             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3684                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3685                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3686             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3687         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3688             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3689             20  AM-TRNTO-GROUPING.                               ERCACCT
  3690                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3691                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3692             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3693             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3694                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3695                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3696             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3697         16  FILLER                        PIC X(10).             ERCACCT
  3698                                                                  ERCACCT
  3699     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3700                                                                  ERCACCT
  3701     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3702         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3703             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3704                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3705                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3706                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3707                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3708                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3709                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3710                 24  FILLER                PIC X.                 ERCACCT
  3711                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3712                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3713                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3714         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3715             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3716                 24  FILLER                PIC X(11).             ERCACCT
  3717                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3718                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3719                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3720                 24  FILLER                PIC X(6).              ERCACCT
  3721                                                                  ERCACCT
  3722     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3723         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3724            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3725            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3726            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3727                                                                  ERCACCT
  3728     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3729     12  FILLER                            PIC X(120).            ERCACCT
  3730                                                                  ERCACCT
  3731     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3732         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3733         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3734             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3735             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3736                                                          COMP-3. ERCACCT
  3737             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3738                                                          COMP-3. ERCACCT
  3739         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3740             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3741             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3742                                                          COMP-3. ERCACCT
  3743             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3744                                                          COMP-3. ERCACCT
  3745                                                                  ERCACCT
  3746     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3747         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3748         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3749         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3750         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3751             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3752                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3753                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3754             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3755                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3756                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3757             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3758                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3759                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3760         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3761             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3762                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3763                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3764                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3765             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3766                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3767                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3768             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3769                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3770                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3771                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3772     12  AM-COMMENTS.                                             ERCACCT
  3773         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3774                                                                  ERCACCT
  3775     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3776         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3777         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3778         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3779         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3780         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3781             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3782             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3783             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3784             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3785         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3786             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3787             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3788             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3789         16  FILLER                        PIC X(102).            ERCACCT
  3790                                                                  ERCACCT
  3791     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3792         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3793             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3794             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3795             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3796             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3797             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3798         16  FILLER                          PIC X(10).           ERCACCT
  3799******************************************************************ERCACCT
  3800
  3801 FD  ELCERR.
* 3802                                 COPY ELCERRS.
  3803******************************************************************04/15/98
  3804*                                                                *ELCERRS
  3805*                                                                *ELCERRS
  3806*                            ELCERRS.                            *   LV002
  3807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3808*                            VMOD 2.002                          *   CL**2
  3809*                                                                *ELCERRS
  3810*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3811*                                                                *ELCERRS
  3812*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3813*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3814*                                                                *ELCERRS
  3815*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3816*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3817*                                                                *ELCERRS
  3818*   LOG = NO                                                     *ELCERRS
  3819*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3820******************************************************************ELCERRS
  3821 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3822     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3823         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3824                                                                  ELCERRS
  3825     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3826         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3827                                                                  ELCERRS
  3828     12  EM-ERROR-TEXT.                                           ELCERRS
  3829         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3830         16  FILLER                  PIC X(59).                   ELCERRS
  3831                                                                  ELCERRS
  3832     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3833         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3834         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3835         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3836         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3837                                                                  ELCERRS
  3838******************************************************************ELCERRS
  3839
  3840 FD  ERPNDM.
* 3841                                 COPY ERCPNDM.
  3842******************************************************************
  3843*                                                                *
  3844*                                                                *
  3845*                            ERCPNDM                             *
  3846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3847*                            VMOD=2.003                          *
  3848*                                                                *
  3849*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3850*                                                                *
  3851*   FILE TYPE = VSAM,KSDS                                        *
  3852*   RECORD SIZE = 374   RECFORM = FIX                            *
  3853*                                                                *
  3854*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3855*   ALTERNATE PATH    = NOT USED                                 *
  3856*                                                                *
  3857*   LOG = YES                                                    *
  3858*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3859******************************************************************
  3860*                   C H A N G E   L O G
  3861*
  3862* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3863*-----------------------------------------------------------------
  3864*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3865* EFFECTIVE    NUMBER
  3866*-----------------------------------------------------------------
  3867* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3868* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3869* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3870******************************************************************
  3871
  3872 01  PENDING-MAILING-DATA.
  3873     12  PM-RECORD-ID                      PIC XX.
  3874         88  VALID-MA-ID                       VALUE 'PM'.
  3875
  3876     12  PM-CONTROL-PRIMARY.
  3877         16  PM-COMPANY-CD                 PIC X.
  3878         16  PM-ENTRY-BATCH                PIC X(6).
  3879         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3880         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3881
  3882     12  FILLER                            PIC X(14).
  3883
  3884     12  PM-ACCESS-CONTROL.
  3885         16  PM-SOURCE-SYSTEM              PIC XX.
  3886             88  PM-FROM-CREDIT                VALUE 'CR'.
  3887             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3888             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3889             88  PM-FROM-OTHER                 VALUE 'OT'.
  3890         16  PM-RECORD-ADD-DT              PIC XX.
  3891         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3892         16  PM-LAST-MAINT-DT              PIC XX.
  3893         16  PM-LAST-MAINT-BY              PIC XXXX.
  3894         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3895
  3896     12  PM-PROFILE-INFO.
  3897         16  PM-QUALIFY-CODE-1             PIC XX.
  3898         16  PM-QUALIFY-CODE-2             PIC XX.
  3899         16  PM-QUALIFY-CODE-3             PIC XX.
  3900         16  PM-QUALIFY-CODE-4             PIC XX.
  3901         16  PM-QUALIFY-CODE-5             PIC XX.
  3902
  3903         16  PM-INSURED-LAST-NAME          PIC X(15).
  3904         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3905         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3906         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3907         16  PM-INSURED-BIRTH-DT           PIC XX.
  3908         16  PM-INSURED-SEX                PIC X.
  3909             88  PM-SEX-MALE                   VALUE 'M'.
  3910             88  PM-SEX-FEMALE                 VALUE 'F'.
  3911         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3912
  3913         16  PM-ADDRESS-CORRECTED          PIC X.
  3914         16  PM-JOINT-BIRTH-DT             PIC XX.
  3915*        16  FILLER                        PIC X(12).
  3916
  3917         16  PM-ADDRESS-LINE-1             PIC X(30).
  3918         16  PM-ADDRESS-LINE-2             PIC X(30).
  3919         16  PM-CITY-STATE.
  3920             20  PM-CITY                   PIC X(28).
  3921             20  PM-STATE                  PIC XX.
  3922         16  PM-ZIP.
  3923             20  PM-ZIP-CODE.
  3924                 24  PM-ZIP-1              PIC X.
  3925                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3926                 24  FILLER                PIC X(4).
  3927             20  PM-ZIP-PLUS4              PIC X(4).
  3928         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3929             20  PM-CAN-POST1              PIC XXX.
  3930             20  PM-CAN-POST2              PIC XXX.
  3931             20  FILLER                    PIC XXX.
  3932
  3933         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3934
  3935         16  FILLER                        PIC X(03).
  3936
  3937     12  PM-CRED-BENE-INFO.
  3938         16  PM-CRED-BENE-NAME             PIC X(25).
  3939         16  PM-CRED-BENE-ADDR             PIC X(30).
  3940         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3941         16  PM-CRED-BENE-CTYST.
  3942             20  PM-CRED-BENE-CITY         PIC X(28).
  3943             20  PM-CRED-BENE-STATE        PIC XX.
  3944         16  PM-CRED-BENE-ZIP.
  3945             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3946                 24  PM-CB-ZIP-1           PIC X.
  3947                     88  PM-CB-CANADIAN-POST-CODE
  3948                                  VALUE 'A' THRU 'Z'.
  3949                 24  FILLER                PIC X(4).
  3950             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3951         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3952             20  PM-CB-CAN-POST1           PIC XXX.
  3953             20  PM-CB-CAN-POST2           PIC XXX.
  3954             20  FILLER                    PIC XXX.
  3955     12  PM-POST-CARD-MAIL-DATA.
  3956         16  PM-MAIL-DATA OCCURS 7.
  3957             20  PM-MAIL-TYPE              PIC X.
  3958                 88  PM-12MO-MAILING           VALUE '1'.
  3959                 88  PM-EXP-MAILING            VALUE '2'.
  3960             20  PM-MAIL-STATUS            PIC X.
  3961                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3962                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3963                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3964             20  PM-MAIL-DATE              PIC XX.
  3965     12  FILLER                            PIC XX.
  3966     12  FILLER                            PIC X(12).
  3967*    12  FILLER                            PIC X(30).
  3968
  3969******************************************************************
  3970
  3971 FD  ERMAIL.
* 3972                                 COPY ERCMAIL.
  3973******************************************************************
  3974*                                                                *
  3975*                                                                *
  3976*                            ERCMAIL                             *
  3977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3978*                            VMOD=2.003                          *
  3979*                                                                *
  3980*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3981*                                                                *
  3982*   FILE TYPE = VSAM,KSDS                                        *
  3983*   RECORD SIZE = 374   RECFORM = FIX                            *
  3984*                                                                *
  3985*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3986*   ALTERNATE PATH    = NOT USED                                 *
  3987*                                                                *
  3988*   LOG = YES                                                    *
  3989*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3990******************************************************************
  3991*                   C H A N G E   L O G
  3992*
  3993* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3994*-----------------------------------------------------------------
  3995*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3996* EFFECTIVE    NUMBER
  3997*-----------------------------------------------------------------
  3998* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3999* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4000* 111108                   PEMA  ADD CRED BENE ADDR2
  4001******************************************************************
  4002
  4003 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4004     12  MA-RECORD-ID                      PIC XX.
  4005         88  VALID-MA-ID                       VALUE 'MA'.
  4006
  4007     12  MA-CONTROL-PRIMARY.
  4008         16  MA-COMPANY-CD                 PIC X.
  4009         16  MA-CARRIER                    PIC X.
  4010         16  MA-GROUPING.
  4011             20  MA-GROUPING-PREFIX        PIC XXX.
  4012             20  MA-GROUPING-PRIME         PIC XXX.
  4013         16  MA-STATE                      PIC XX.
  4014         16  MA-ACCOUNT.
  4015             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4016             20  MA-ACCOUNT-PRIME          PIC X(6).
  4017         16  MA-CERT-EFF-DT                PIC XX.
  4018         16  MA-CERT-NO.
  4019             20  MA-CERT-PRIME             PIC X(10).
  4020             20  MA-CERT-SFX               PIC X.
  4021
  4022     12  FILLER                            PIC XX.
  4023
  4024     12  MA-ACCESS-CONTROL.
  4025         16  MA-SOURCE-SYSTEM              PIC XX.
  4026             88  MA-FROM-CREDIT                VALUE 'CR'.
  4027             88  MA-FROM-VSI                   VALUE 'VS'.
  4028             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4029             88  MA-FROM-OTHER                 VALUE 'OT'.
  4030         16  MA-RECORD-ADD-DT              PIC XX.
  4031         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4032         16  MA-LAST-MAINT-DT              PIC XX.
  4033         16  MA-LAST-MAINT-BY              PIC XXXX.
  4034         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4035
  4036     12  MA-PROFILE-INFO.
  4037         16  MA-QUALIFY-CODE-1             PIC XX.
  4038         16  MA-QUALIFY-CODE-2             PIC XX.
  4039         16  MA-QUALIFY-CODE-3             PIC XX.
  4040         16  MA-QUALIFY-CODE-4             PIC XX.
  4041         16  MA-QUALIFY-CODE-5             PIC XX.
  4042
  4043         16  MA-INSURED-LAST-NAME          PIC X(15).
  4044         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4045         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4046         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4047         16  MA-INSURED-BIRTH-DT           PIC XX.
  4048         16  MA-INSURED-SEX                PIC X.
  4049             88  MA-SEX-MALE                   VALUE 'M'.
  4050             88  MA-SEX-FEMALE                 VALUE 'F'.
  4051         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4052
  4053         16  MA-ADDRESS-CORRECTED          PIC X.
  4054         16  MA-JOINT-BIRTH-DT             PIC XX.
  4055*        16  FILLER                        PIC X(12).
  4056
  4057         16  MA-ADDRESS-LINE-1             PIC X(30).
  4058         16  MA-ADDRESS-LINE-2             PIC X(30).
  4059         16  MA-CITY-STATE.
  4060             20  MA-CITY                   PIC X(28).
  4061             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4062         16  MA-ZIP.
  4063             20  MA-ZIP-CODE.
  4064                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4065                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4066                 24  FILLER                PIC X(4).
  4067             20  MA-ZIP-PLUS4              PIC X(4).
  4068         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4069             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4070             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4071             20  FILLER                    PIC X(3).
  4072
  4073         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4074
  4075         16  FILLER                        PIC XXX.
  4076*        16  FILLER                        PIC X(10).
  4077
  4078
  4079     12  MA-CRED-BENE-INFO.
  4080         16  MA-CRED-BENE-NAME                 PIC X(25).
  4081         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4082         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4083         16  MA-CRED-BENE-CTYST.
  4084             20  MA-CRED-BENE-CITY             PIC X(28).
  4085             20  MA-CRED-BENE-STATE            PIC XX.
  4086         16  MA-CRED-BENE-ZIP.
  4087             20  MA-CB-ZIP-CODE.
  4088                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4089                     88  MA-CB-CANADIAN-POST-CODE
  4090                                           VALUE 'A' THRU 'Z'.
  4091                 24  FILLER                    PIC X(4).
  4092             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4093         16  MA-CB-CANADIAN-POSTAL-CODE
  4094                            REDEFINES MA-CRED-BENE-ZIP.
  4095             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4096             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4097             20  FILLER                        PIC X(3).
  4098     12  MA-POST-CARD-MAIL-DATA.
  4099         16  MA-MAIL-DATA OCCURS 7.
  4100             20  MA-MAIL-TYPE              PIC X.
  4101                 88  MA-12MO-MAILING           VALUE '1'.
  4102                 88  MA-EXP-MAILING            VALUE '2'.
  4103             20  MA-MAIL-STATUS            PIC X.
  4104                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4105                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4106                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4107             20  MA-MAIL-DATE              PIC XX.
  4108     12  FILLER                            PIC XX.
  4109     12  FILLER                            PIC XX.
  4110*    12  FILLER                            PIC X(30).
  4111******************************************************************
  4112
  4113 FD  ERPLAN.
* 4114                                 COPY ERCPLAN.
  4115******************************************************************04/29/98
  4116*                                                                *ERCPLAN
  4117*                                                                *ERCPLAN
  4118*                            ERCPLAN                             *   LV003
  4119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4120*                            VMOD=2.003                          *   CL**2
  4121*                                                                *ERCPLAN
  4122*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4123*                                                                *ERCPLAN
  4124*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4125*   PLAN MASTER                                                  *ERCPLAN
  4126*                                                                *ERCPLAN
  4127*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4128*                                                                *ERCPLAN
  4129*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4130*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4131*                                                                *ERCPLAN
  4132*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4133*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4134*                                                                *ERCPLAN
  4135*   LOG = NO                                                     *ERCPLAN
  4136*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4137*                                                                *ERCPLAN
  4138*                                                                *ERCPLAN
  4139******************************************************************ERCPLAN
  4140                                                                  ERCPLAN
  4141 01  PLAN-MASTER.                                                 ERCPLAN
  4142     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4143         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4144                                                                  ERCPLAN
  4145     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4146         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4147         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4148             20  PL-CONTROL-A.                                    ERCPLAN
  4149                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4150                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4151                 24  PL-STATE              PIC XX.                ERCPLAN
  4152                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4153             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4154             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4155             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4156                                                                  ERCPLAN
  4157     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4158         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4159         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4160         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4161         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4162         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4163         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4164         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4165         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4166                                                                  ERCPLAN
  4167     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4168         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4169         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4170         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4171         16  FILLER                        PIC XX.                ERCPLAN
  4172                                                                  ERCPLAN
  4173     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4174         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4175         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4176             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4177             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4178             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4179             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4180                                                                  ERCPLAN
  4181     12  FILLER                            PIC X(30).             ERCPLAN
  4182                                                                  ERCPLAN
  4183     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4184         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4185         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4186         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4187     12  FILLER                            PIC X(24).             ERCPLAN
  4188     12  PL-TOLERANCES.                                           ERCPLAN
  4189         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4190         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4191         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4192         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4193         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4194         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4195     12  PL-OVER-SHORT.                                           ERCPLAN
  4196         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4197         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4198     12  FILLER                            PIC X(24).             ERCPLAN
  4199     12  PLAN-MISC.                                               ERCPLAN
  4200         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4201         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4202         16  PL-IG                         PIC X.                 ERCPLAN
  4203         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4204         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4205         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4206         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4207         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4208         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4209         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4210         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4211                                                                  ERCPLAN
  4212         16  FILLER                        PIC X(99).             ERCPLAN
  4213******************************************************************ERCPLAN
  4214 FD  ERFORM.
* 4215                                 COPY ERCFORM.
  4216******************************************************************04/29/98
  4217*                                                                *ERCFORM
  4218*                                                                *ERCFORM
  4219*                            ERCFORM.                            *   LV002
  4220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4221*                            VMOD=2.003                          *   CL**2
  4222*                                                                *ERCFORM
  4223*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4224*                                                                *ERCFORM
  4225*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4226*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4227*                                                                *ERCFORM
  4228*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4229*                                                                *ERCFORM
  4230*    LOG = YES                                                   *ERCFORM
  4231*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4232******************************************************************ERCFORM
  4233 01  FORM-MASTER.                                                 ERCFORM
  4234    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4235        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4236                                                                  ERCFORM
  4237    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4238        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4239        16  FO-STATE                 PIC X(02).                   ERCFORM
  4240        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4241        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4242                                                                  ERCFORM
  4243    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4244        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4245        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4246        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4247        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4248        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4249        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4250        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4251        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4252        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4253        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4254        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4255        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4256        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4257        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4258        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4259        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4260                                                                  ERCFORM
  4261    12  FILLER                       PIC X(29).                   ERCFORM
  4262                                                                  ERCFORM
  4263    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4264        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4265            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4266            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4267            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4268            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4269                                     PIC X.                       ERCFORM
  4270                                                                  ERCFORM
  4271    12  FILLER                       PIC X(30).                   ERCFORM
  4272                                                                  ERCFORM
  4273    12  FO-COMMENTS-AREA.                                         ERCFORM
  4274        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4275                                                                  ERCFORM
  4276    12  FILLER                       PIC X(20).                   ERCFORM
  4277                                                                  ERCFORM
  4278    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4279        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4280        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4281        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4282
  4283 FD  PRINT-FILE
* 4284                                 COPY ELCPRTFD.
  4285******************************************************************04/15/98
  4286*                                                                *ELCPRTFD
  4287*                                                                *ELCPRTFD
  4288*                            ELCPRTFD.                           *   LV003
  4289*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4290*                            VMOD=2.006                          *ELCPRTFD
  4291******************************************************************ELCPRTFD
  4292     RECORDING MODE F                                             ELCPRTFD
  4293     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4294     BLOCK CONTAINS 0 RECORDS
  4295     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4296 01  PRT.                                                         ELCPRTFD
  4297     12  P-CTL               PIC  X.                                 CL**2
  4298     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4299******************************************************************ELCPRTFD
  4300 FD  FICH
* 4301                                 COPY ELCFCHFD.
  4302******************************************************************04/15/98
  4303*                                                                *ELCFCHFD
  4304*                            ELCFCHFD.                           *   LV003
  4305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4306*                            VMOD=2.004                          *   CL**3
  4307*                                                                *ELCFCHFD
  4308******************************************************************ELCFCHFD
  4309     BLOCK CONTAINS 0 RECORDS
  4310     RECORDING MODE F.                                            ELCFCHFD
  4311                                                                  ELCFCHFD
  4312 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4313******************************************************************ELCFCHFD
  4314
  4315 FD  ELREPT.
* 4316                                 COPY ELCREPT.
  4317******************************************************************04/15/98
  4318*                                                                *ELCREPT
  4319*                                                                *ELCREPT
  4320*                            ELCREPT.                            *   LV002
  4321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4322*                            VMOD=2.002                          *   CL**2
  4323*                                                                *ELCREPT
  4324*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4325*                                                                *ELCREPT
  4326*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4327*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4328*                                                                *ELCREPT
  4329*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4330*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4331*                                                                *ELCREPT
  4332*   LOG = NO                                                     *ELCREPT
  4333*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4334******************************************************************ELCREPT
  4335 01  REPORT-SAVE-FILE.                                            ELCREPT
  4336     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4337         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4338                                                                  ELCREPT
  4339     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4340         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4341         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4342             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4343             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4344         16  RF-REPORT-ID.                                        ELCREPT
  4345             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4346                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4347                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4348             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4349         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4350     12  RF-REPORT-LINE-133.                                      ELCREPT
  4351         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4352         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4353         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4354             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4355             20  FILLER              PIC X(52).                   ELCREPT
  4356         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4357             20  FILLER              PIC X(53).                   ELCREPT
  4358             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4359     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4360         16  FILLER                  PIC X.                       ELCREPT
  4361         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4362         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4363         16  FILLER                  PIC X(115).                  ELCREPT
  4364         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4365******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  80
* EL517.cbl
  4367
  4368 FD  ERRESS.
* 4369                                 COPY ERCRESS.
  4370******************************************************************04/29/98
  4371*                                                                *ERCRESS
  4372*                            ERCRESS                             *   LV002
  4373*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4374*                            VMOD=2.002                          *   CL**2
  4375*                                                                *ERCRESS
  4376*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4377*                                                                *ERCRESS
  4378*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4379*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4380*                                                                *ERCRESS
  4381*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4382*                                                                *ERCRESS
  4383*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4384*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4385*                                                                *ERCRESS
  4386*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4387*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4388*                                                                *ERCRESS
  4389*   LOG = NO                                                     *ERCRESS
  4390*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4391*                                                                *ERCRESS
  4392*                                                                *ERCRESS
  4393******************************************************************ERCRESS
  4394                                                                  ERCRESS
  4395 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4396                                                                  ERCRESS
  4397     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4398         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4399         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4400         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4401         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4402*                                      YYYYMMDD                   ERCRESS
  4403*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4404                                                                  ERCRESS
  4405     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4406                                                                  ERCRESS
  4407         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4408         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4409         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4410         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4411                                                                  ERCRESS
  4412     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4413         88 RECALC                VALUE 'Y'.                      ERCRESS
  4414         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4415     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4416     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4417     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4418*                                      YYYYMMDD                   ERCRESS
  4419
  4420 FD  ERRESC.
* 4421                                 COPY ERCRESC.
  4422******************************************************************04/29/98
  4423*                                                                *ERCRESC
  4424*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4426*                            VMOD=2.003                          *   CL**2
  4427*                                                                *ERCRESC
  4428*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4429*                                                                *ERCRESC
  4430*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4431*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4432*                                                                *ERCRESC
  4433*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4434*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4435*                                                                *ERCRESC
  4436*   LOG = NO                                                     *ERCRESC
  4437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4438*                                                                *ERCRESC
  4439******************************************************************ERCRESC
  4440                                                                  ERCRESC
  4441 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4442                                                                  ERCRESC
  4443     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4444         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4445         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4446         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4447         15  RESC-STATE                PIC   XX.                  ERCRESC
  4448         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4449         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4450         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4451         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4452*                                           YYYYMMDD              ERCRESC
  4453     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4454                                                                  ERCRESC
  4455     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4456         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4457             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4458             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4459             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4460                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4461                                                                  ERCRESC
  4462     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4463     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4464     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4465*                                          YYYYMMDD               ERCRESC
  4466
  4467 FD  ERCOMP.
* 4468                                 COPY ERCCOMP.
  4469******************************************************************
  4470*                                                                *
  4471*                                                                *
  4472*                            ERCCOMP                             *
  4473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4474*                            VMOD=2.019                          *
  4475*                                                                *
  4476*   ONLINE CREDIT SYSTEM                                         *
  4477*                                                                *
  4478*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4479*                                                                *
  4480*   FILE TYPE = VSAM,KSDS                                        *
  4481*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4482*                                                                *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4483*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4484*       ALTERNATE PATH = NONE                                    *
  4485*                                                                *
  4486*   LOG = NO                                                     *
  4487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4488*                                                                *
  4489******************************************************************
  4490*                   C H A N G E   L O G
  4491*
  4492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4493*-----------------------------------------------------------------
  4494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4495* EFFECTIVE    NUMBER
  4496*-----------------------------------------------------------------
  4497* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4498* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4499* 092205    2005050300006  PEMA  ADD LEASE FEE
  4500* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4501* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4502* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4503* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4504* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4505* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4506******************************************************************
  4507
  4508 01  COMPENSATION-MASTER.
  4509     12  CO-RECORD-ID                          PIC XX.
  4510         88  VALID-CO-ID                          VALUE 'CO'.
  4511
  4512     12  CO-CONTROL-PRIMARY.
  4513         16  CO-COMPANY-CD                     PIC X.
  4514         16  CO-CONTROL.
  4515             20  CO-CTL-1.
  4516                 24  CO-CARR-GROUP.
  4517                     28  CO-CARRIER            PIC X.
  4518                     28  CO-GROUPING.
  4519                         32  CO-GROUP-PREFIX   PIC XXX.
  4520                         32  CO-GROUP-PRIME    PIC XXX.
  4521                 24  CO-RESP-NO.
  4522                     28  CO-RESP-PREFIX        PIC X(4).
  4523                     28  CO-RESP-PRIME         PIC X(6).
  4524             20  CO-CTL-2.
  4525                 24  CO-ACCOUNT.
  4526                     28  CO-ACCT-PREFIX        PIC X(4).
  4527                     28  CO-ACCT-PRIME         PIC X(6).
  4528         16  CO-TYPE                           PIC X.
  4529             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4530             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4531             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4532
  4533     12  CO-MAINT-INFORMATION.
  4534         16  CO-LAST-MAINT-DT                  PIC XX.
  4535         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4536         16  CO-LAST-MAINT-USER                PIC X(4).
  4537     12  FILLER                                PIC XX.
  4538     12  CO-STMT-TYPE                          PIC XXX.
  4539     12  CO-COMP-TYPE                          PIC X.
  4540         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4541     12  CO-STMT-OWNER                         PIC X(4).
  4542     12  CO-BALANCE-CONTROL                    PIC X.
  4543         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4544         88  CO-NO-BALANCE                        VALUE 'N'.
  4545
  4546     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4547         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4548         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4549         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4550
  4551     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4552         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4553         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4554
  4555     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4556     12  CO-GA-DIRECT-DEP                      PIC X.
  4557     12  CO-FUTURE-SPACE                       PIC X.
  4558         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4559
  4560     12  CO-ACCT-NAME                          PIC X(30).
  4561     12  CO-MAIL-NAME                          PIC X(30).
  4562     12  CO-ADDR-1                             PIC X(30).
  4563     12  CO-ADDR-2                             PIC X(30).
  4564     12  CO-ADDR-3.
  4565         16  CO-ADDR-CITY                      PIC X(27).
  4566         16  CO-ADDR-STATE                     PIC XX.
  4567     12  CO-CSO-1099                           PIC X.
  4568     12  CO-ZIP.
  4569         16  CO-ZIP-PRIME.
  4570             20  CO-ZIP-PRI-1ST                PIC X.
  4571                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4572             20  FILLER                        PIC X(4).
  4573         16  CO-ZIP-PLUS4                      PIC X(4).
  4574     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4575         16  CO-CAN-POSTAL-1                   PIC XXX.
  4576         16  CO-CAN-POSTAL-2                   PIC XXX.
  4577         16  FILLER                            PIC XXX.
  4578     12  CO-SOC-SEC                            PIC X(13).
  4579     12  CO-TELEPHONE.
  4580         16  CO-AREA-CODE                      PIC XXX.
  4581         16  CO-PREFIX                         PIC XXX.
  4582         16  CO-PHONE                          PIC X(4).
  4583
  4584     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4585
  4586     12  CO-AR-BAL-LEVEL                       PIC X.
  4587         88  CO-AR-REF-LVL                        VALUE '1'.
  4588         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4589         88  CO-AR-BILL-LVL                       VALUE '2'.
  4590         88  CO-AR-AGT-LVL                        VALUE '3'.
  4591         88  CO-AR-FR-LVL                         VALUE '4'.
  4592
  4593     12  CO-AR-NORMAL-PRINT                    PIC X.
  4594         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4595         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4596
  4597     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4598
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4599     12  CO-AR-REPORTING                       PIC X.
  4600         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4601         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4602
  4603     12  CO-AR-PULL-CHECK                      PIC X.
  4604         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4605         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4606
  4607     12  CO-AR-BALANCE-PRINT                   PIC X.
  4608         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4609
  4610     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4611         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4612         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4613         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4614
  4615     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4616
  4617     12  CO-USER-CODE                          PIC X.
  4618     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4619
  4620******************************************************************
  4621*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4622*    THE LAST MONTH END RUN.
  4623******************************************************************
  4624
  4625     12  CO-LAST-ACTIVITY-DATE.
  4626         16  CO-ACT-YEAR                       PIC 99.
  4627         16  CO-ACT-MONTH                      PIC 99.
  4628         16  CO-ACT-DAY                        PIC 99.
  4629
  4630     12  CO-LAST-STMT-DT.
  4631         16  CO-LAST-STMT-YEAR                 PIC 99.
  4632         16  CO-LAST-STMT-MONTH                PIC 99.
  4633         16  CO-LAST-STMT-DAY                  PIC 99.
  4634
  4635     12  CO-MO-END-TOTALS.
  4636         16  CO-MONTHLY-TOTALS.
  4637             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4638             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4639             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4640             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4641             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4642
  4643         16  CO-AGING-TOTALS.
  4644             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4645             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4646             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4647             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4648
  4649         16  CO-YTD-TOTALS.
  4650             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4651             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4652
  4653         16  CO-OVER-UNDER-TOTALS.
  4654             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4655             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4656
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4657     12  CO-MISCELLANEOUS-TOTALS.
  4658         16  CO-FICA-TOTALS.
  4659             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4660             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4661
  4662         16  CO-CLAIM-TOTALS.
  4663             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4664             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4665
  4666******************************************************************
  4667*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4668*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4669******************************************************************
  4670
  4671     12  CO-CURRENT-TOTALS.
  4672         16  CO-CURRENT-LAST-STMT-DT.
  4673             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4674             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4675             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4676
  4677         16  CO-CURRENT-MONTHLY-TOTALS.
  4678             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4679             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4680             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4681             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4682             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4683
  4684         16  CO-CURRENT-AGING-TOTALS.
  4685             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4686             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4687             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4688             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4689
  4690         16  CO-CURRENT-YTD-TOTALS.
  4691             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4692             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4693
  4694     12  CO-PAID-COMM-TOTALS.
  4695         16  CO-YTD-PAID-COMMS.
  4696             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4697             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4698
  4699     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4700         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4701         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4702
  4703     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4704         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4705         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4706         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4707         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4708         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4709         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4710         88  CO-FINAL-LETTER                  VALUE 'F'.
  4711         88  CO-RECONCILING                   VALUE 'R'.
  4712         88  CO-PHONE-CALL                    VALUE 'P'.
  4713         88  CO-LEGAL                         VALUE 'L'.
  4714         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4715         88  CO-WRITE-OFF                     VALUE 'W'.
  4716         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4717
  4718     12  CO-CSR-CODE                       PIC X(4).
  4719
  4720     12  CO-GA-STATUS-INFO.
  4721         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4722         16  CO-GA-TERMINATION-DT          PIC XX.
  4723         16  CO-GA-STATUS-CODE             PIC X.
  4724             88  CO-GA-ACTIVE                 VALUE 'A'.
  4725             88  CO-GA-INACTIVE               VALUE 'I'.
  4726             88  CO-GA-PENDING                VALUE 'P'.
  4727         16  CO-GA-COMMENTS.
  4728             20  CO-GA-COMMENT-1           PIC X(40).
  4729             20  CO-GA-COMMENT-2           PIC X(40).
  4730             20  CO-GA-COMMENT-3           PIC X(40).
  4731             20  CO-GA-COMMENT-4           PIC X(40).
  4732
  4733     12  CO-RPTCD2                         PIC X(10).
  4734     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4735         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4736         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4737
  4738     12  CO-TYPE-AGENT                     PIC X(01).
  4739         88  CO-CORPORATION                   VALUE 'C'.
  4740         88  CO-PARTNERSHIP                   VALUE 'P'.
  4741         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4742         88  CO-TRUST                         VALUE 'T'.
  4743         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4744
  4745     12  CO-FAXNO.
  4746         16  CO-FAX-AREA-CODE                  PIC XXX.
  4747         16  CO-FAX-PREFIX                     PIC XXX.
  4748         16  CO-FAX-PHONE                      PIC X(4).
  4749
  4750     12  CO-BANK-INFORMATION.
  4751         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4752         16  CO-BANK-TRANSIT-NON REDEFINES
  4753             CO-BANK-TRANSIT-NO                PIC 9(8).
  4754
  4755         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4756     12  CO-MISC-DEDUCT-INFO REDEFINES
  4757                  CO-BANK-INFORMATION.
  4758         16  CO-MD-GL-ACCT                     PIC X(10).
  4759         16  CO-MD-DIV                         PIC XX.
  4760         16  CO-MD-CENTER                      PIC X(4).
  4761         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4762         16  CO-CREATE-AP-CHECK                PIC X.
  4763         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4764         16  FILLER                            PIC XXX.
  4765     12  CO-ACH-STATUS                         PIC X.
  4766         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4767         88  CO-ACH-PENDING                        VALUE 'P'.
  4768
  4769     12  CO-BILL-SW                            PIC X.
  4770     12  CO-CONTROL-NAME                       PIC X(30).
  4771     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4772     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4773     12  CO-CLP-STATE                          PIC XX.
  4774     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4775     12  CO-SPP-REFUND-EDIT                    PIC X.
  4776
  4777******************************************************************
  4778
  4779 FD  ERLOFC.
* 4780                                 COPY ERCLOFC.
  4781******************************************************************12/04/92
  4782*                                                                *ERCLOFC
  4783*                                                                *ERCLOFC
  4784*                            ERCLOFC                             *   LV002
  4785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4786*                            VMOD=2.003                          *   CL**2
  4787*                                                                *ERCLOFC
  4788*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4789*                                                                *ERCLOFC
  4790*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4791*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4792*                                                                *ERCLOFC
  4793*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4794*                                                                *ERCLOFC
  4795*   LOG = YES                                                    *ERCLOFC
  4796*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4797*                                                                *ERCLOFC
  4798******************************************************************ERCLOFC
  4799                                                                  ERCLOFC
  4800 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4801     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4802         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4803                                                                  ERCLOFC
  4804     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4805         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4806         16  LO-CARRIER              PIC X.                       ERCLOFC
  4807         16  LO-GROUPING.                                         ERCLOFC
  4808             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4809             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4810         16  LO-STATE                PIC XX.                      ERCLOFC
  4811         16  LO-ACCOUNT.                                          ERCLOFC
  4812             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4813             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4814         16  LO-OFFICER-CODE         PIC X(5).
  4815                                                                  ERCLOFC
  4816     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4817                                                                  ERCLOFC
  4818     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4819     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4820     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4821                                                                  ERCLOFC
  4822     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4823             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4824             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4825     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4826             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4827             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4828                                                                  ERCLOFC
  4829     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4830     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4831     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4832                                                                  ERCLOFC
  4833     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4834     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4835                                                                  ERCLOFC
  4836     12  LO-OFFICER-INFO.                                         ERCLOFC
  4837         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4838             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4839             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4840             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4841             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4842             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4843             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4844             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4845             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4846     12  FILLER                      PIC X(198).
  4847******************************************************************ERCLOFC
  4848
  4849 FD  ERBXRF.
* 4850                                 COPY ERCBXRF.
  4851******************************************************************04/29/98
  4852*                                                                *ERCBXRF
  4853*                                                                *ERCBXRF
  4854*                            ERCBXRF                             *   LV002
  4855*                                                                *ERCBXRF
  4856*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4857*                                                                *ERCBXRF
  4858*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4859*                                                                *ERCBXRF
  4860*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4861*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4862*                                                                *ERCBXRF
  4863*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4864*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4865*                                                                *ERCBXRF
  4866*   LOG = NO                                                     *ERCBXRF
  4867*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4868*                                                                *ERCBXRF
  4869******************************************************************ERCBXRF
  4870                                                                  ERCBXRF
  4871 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4872     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4873         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4874                                                                  ERCBXRF
  4875     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4876         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4877         16  BK-CARRIER              PIC X.                       ERCBXRF
  4878         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4879         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4880                                                                  ERCBXRF
  4881     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4882         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4883         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4884         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4885         16  FILLER                  PIC X(9).                    ERCBXRF
  4886                                                                  ERCBXRF
  4887     12  FILLER                      PIC X(37).                   ERCBXRF
  4888                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4889     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4890                                                                  ERCBXRF
  4891     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4892                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4893         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4894         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4895         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4896         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4897         16  FILLER                  PIC X(20).                   ERCBXRF
  4898                                                                  ERCBXRF
  4899******************************************************************ERCBXRF
  4900
  4901 FD  ERAGTC.
* 4902                                 COPY ERCAGTC.
  4903******************************************************************
  4904*                                                                *
  4905*                                                                *
  4906*                            ERCAGTC                             *
  4907*                            VMOD=2.001                          *
  4908*                                                                *
  4909*   ONLINE CREDIT SYSTEM                                         *
  4910*                                                                *
  4911*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4912*                                                                *
  4913*   FILE TYPE = VSAM,KSDS                                        *
  4914*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4915*                                                                *
  4916*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4917*       ALTERNATE PATH = NONE                                    *
  4918*                                                                *
  4919*   LOG = NO                                                     *
  4920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4921*                                                                *
  4922******************************************************************
  4923*                   C H A N G E   L O G
  4924*
  4925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4926*-----------------------------------------------------------------
  4927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4928* EFFECTIVE    NUMBER
  4929*-----------------------------------------------------------------
  4930* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4931* 111004                         NEW FILE AND COPYBOOK
  4932* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4933******************************************************************
  4934
  4935 01  AGENT-COMMISSIONS.
  4936     12  AG-RECORD-ID                          PIC XX.
  4937         88  VALID-CO-ID                          VALUE 'AG'.
  4938
  4939     12  AG-CONTROL-PRIMARY.
  4940         16  AG-COMPANY-CD                     PIC X.
  4941         16  AG-CONTROL.
  4942             20  AG-CTL-1.
  4943                 24  AG-CARR-GROUP.
  4944                     28  AG-CARRIER            PIC X.
  4945                     28  AG-GROUPING           PIC X(6).
  4946                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4947             20  AG-CTL-2.
  4948                 24  AG-EXP-DT                 PIC XX.
  4949         16  AG-TYPE                           PIC X.
  4950             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4951             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4952
  4953     12  AG-MAINT-INFORMATION.
  4954         16  AG-LAST-MAINT-DT                  PIC XX.
  4955         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4956         16  AG-LAST-MAINT-USER                PIC X(4).
  4957         16  FILLER                            PIC X(10).
  4958
  4959     12  AG-EFF-DT                             PIC XX.
  4960     12  AG-COMM-STRUCTURE.
  4961         16  AG-AGT-COMMS OCCURS 10.
  4962             20  AG-AGT                PIC X(10).
  4963             20  AG-COM-TYP            PIC X.
  4964             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4965             20  AG-RECALC-LV-INDIC    PIC X.
  4966             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4967             20  AG-LRCALC-LV-INDIC    PIC X.
  4968             20  FILLER                PIC X(05).
  4969
  4970     12  FILLER                  PIC X(145).
  4971******************************************************************
  4972
  4973 FD  ELCRTT.
* 4974                                 COPY ELCCRTT.
  4975******************************************************************
  4976*                                                                *ELCCRTT
  4977*                            ELCCRTT.                            *
  4978*                                                                *ELCCRTT
  4979*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4980*                                                                *ELCCRTT
  4981*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4982*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4983*                                                                *ELCCRTT
  4984*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4985*                                                                *ELCCRTT
  4986*   LOG = YES                                                    *ELCCRTT
  4987*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4988******************************************************************
  4989*                   C H A N G E   L O G
  4990*
  4991* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4992*-----------------------------------------------------------------
  4993*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4994* EFFECTIVE    NUMBER
  4995*-----------------------------------------------------------------
  4996* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4997* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4998* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4999* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5000* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5001* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5002******************************************************************
  5003                                                                  ELCCRTT
  5004 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  91
* EL517.cbl (/apps/test/cid1s/copy/ELCCRTT)
  5005     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  5006         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  5007                                                                  ELCCRTT
  5008     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  5009         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  5010         16  CS-CARRIER                    PIC X.                 ELCCRTT
  5011         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  5012         16  CS-STATE                      PIC XX.                ELCCRTT
  5013         16  CS-ACCOUNT                    PIC X(10).
  5014         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  5015         16  CS-CERT-NO.                                          ELCCRTT
  5016             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  5017             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  5018         16  CS-TRAILER-TYPE               PIC X.
  5019             88  COMM-TRLR           VALUE 'A'.
  5020             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5021             88  CERT-DATA-TRLR      VALUE 'C'.
  5022                                                                  ELCCRTT
  5023     12  CS-DATA-AREA                      PIC X(516).
  5024
  5025     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5026         16  CS-BANK-COMMISSION-AREA.
  5027             20  CS-BANK-COMMS       OCCURS 10.
  5028                 24  CS-AGT                PIC X(10).
  5029                 24  CS-COM-TYP            PIC X.
  5030                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5031                 24  CS-RECALC-LV-INDIC    PIC X.
  5032                 24  FILLER                PIC X(10).
  5033
  5034         16  FILLER                        PIC X(256).
  5035
  5036     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5037****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5038
  5039         16  CS-MB-CLAIM-DATA OCCURS 24.
  5040             20  CS-CLAIM-NO               PIC X(7).
  5041             20  CS-CLAIM-TYPE             PIC X.
  5042                 88  CS-AH-CLM               VALUE 'A'.
  5043                 88  CS-IU-CLM               VALUE 'I'.
  5044                 88  CS-GP-CLM               VALUE 'G'.
  5045                 88  CS-LF-CLM               VALUE 'L'.
  5046                 88  CS-PR-CLM               VALUE 'P'.
  5047             20  CS-INSURED-TYPE           PIC X.
  5048                 88  CS-PRIM-INSURED          VALUE 'P'.
  5049                 88  CS-CO-BORROWER           VALUE 'C'.
  5050             20  CS-BENEFIT-PERIOD         PIC 99.
  5051             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5052             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5053             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5054         16  FILLER                        PIC X(12).
  5055
  5056     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5057         16  CS-VIN-NUMBER                 PIC X(17).
  5058         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5059         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5060         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5061         16  FILLER                        PIC X(496).
  5062
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  92
* EL517.cbl
  5063 FD  ERPDEF.
  5064
* 5065                                 COPY ERCPDEF.
  5066******************************************************************
  5067*                                                                *
  5068*                                                                *
  5069*                            ERCPDEF.                            *
  5070*                                                                *
  5071*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5072*                                                                *
  5073*    FILE TYPE = VSAM,KSDS                                       *
  5074*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5075*                                                                *
  5076*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5077*                                                                *
  5078*    LOG = YES                                                   *
  5079*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5080******************************************************************
  5081*                   C H A N G E   L O G
  5082*
  5083* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5084*-----------------------------------------------------------------
  5085*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5086* EFFECTIVE    NUMBER
  5087*-----------------------------------------------------------------
  5088* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5089******************************************************************
  5090 01  PRODUCT-MASTER.
  5091    12  PD-RECORD-ID                 PIC X(02).
  5092        88  VALID-PD-ID                  VALUE 'PD'.
  5093
  5094    12  PD-CONTROL-PRIMARY.
  5095        16  PD-COMPANY-CD            PIC X.
  5096        16  PD-STATE                 PIC XX.
  5097        16  PD-PRODUCT-CD            PIC XXX.
  5098        16  PD-FILLER                PIC X(7).
  5099        16  PD-BEN-TYPE              PIC X.
  5100        16  PD-BEN-CODE              PIC XX.
  5101        16  PD-PROD-EXP-DT           PIC XX.
  5102
  5103    12  FILLER                       PIC X(50).
  5104
  5105    12  PD-PRODUCT-DATA OCCURS 8.
  5106        16  PD-PROD-CODE             PIC X.
  5107            88  PD-PROD-LIFE           VALUE 'L'.
  5108            88  PD-PROD-PROP           VALUE 'P'.
  5109            88  PD-PROD-AH             VALUE 'A'.
  5110            88  PD-PROD-IU             VALUE 'I'.
  5111            88  PD-PROD-GAP            VALUE 'G'.
  5112            88  PD-PROD-FMLA           VALUE 'F'.
  5113        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5114        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5115        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5116        16  PD-MAX-TERM              PIC S999        COMP-3.
  5117        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5118        16  FILLER                   PIC X.
  5119        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5120        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  93
* EL517.cbl (/apps/test/cid1s/copy/ERCPDEF)
  5121        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5122        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5123        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5124        16  PD-REC-CRIT-PERIOD       PIC 99.
  5125        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5126            20  PD-RECURRING-YN      PIC X.
  5127            20  FILLER               PIC X.
  5128        16  PD-RTW-MOS               PIC 99.
  5129        16  PD-MAX-EXTENSION         PIC 99.
  5130        16  FILLER                   PIC XX.
  5131
  5132    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5133
  5134    12  PD-TERM-LIMITS OCCURS 15.
  5135        16  PD-LOW-TERM              PIC S999        COMP-3.
  5136        16  PD-HI-TERM               PIC S999        COMP-3.
  5137
  5138*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5139    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5140        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5141        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5142
  5143    12  PD-EARN-FACTORS.
  5144        16  FILLER OCCURS 15.
  5145            20  FILLER OCCURS 15.
  5146                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5147
  5148    12  PD-PRODUCT-DESC              PIC X(80).
  5149    12  PD-TRUNCATED                 PIC X.
  5150    12  FILLER                       PIC X(59).
  5151
  5152    12  PD-MAINT-INFORMATION.
  5153        16  PD-LAST-MAINT-DT         PIC X(02).
  5154        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5155        16  PD-LAST-MAINT-BY         PIC X(04).
  5156
  5157 FD  ELSTAT.
  5158
* 5159                                 COPY ELCSTATE.
  5160******************************************************************
  5161*                                                                *
  5162*                                                                *
  5163*                            ELCSTATE.                           *
  5164*                                                                *
  5165*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5166*                                                                *
  5167*   FILE TYPE = VSAM,KSDS                                        *
  5168*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5169*                                                                *
  5170*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5171*       ALTERNATE INDEX = NONE                                   *
  5172*                                                                *
  5173*   LOG = YES                                                    *
  5174*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5175******************************************************************
  5176*                   C H A N G E   L O G
  5177*
  5178* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5179*-----------------------------------------------------------------
  5180*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5181* EFFECTIVE    NUMBER
  5182*-----------------------------------------------------------------
  5183* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5184******************************************************************
  5185*
  5186 01  STATE-FILE.
  5187     12  SF-RECORD-ID                       PIC XX.
  5188         88  VALID-CF-ID                        VALUE 'SF'.
  5189
  5190     12  SF-CONTROL-PRIMARY.
  5191         16  SF-COMPANY-ID                  PIC XXX.
  5192         16  SF-CARRIER-CODE                PIC X.
  5193         16  SF-GROUPING                    PIC X(6).
  5194         16  SF-STATE-CODE                  PIC XX.
  5195         16  SF-EXPIRE-DATE                 PIC 9(8).
  5196
  5197****************************************************************
  5198*             STATE CONTROLS
  5199****************************************************************
  5200
  5201     12  SF-LAST-MAINT-DT                   PIC XX.
  5202     12  SF-LAST-MAINT-BY                   PIC X(4).
  5203     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5204
  5205     12  SF-STATE-RT-CONTROLS.
  5206         16  SF-ST-RT-CALC                  PIC X.
  5207
  5208     12  SF-ST-TAX-CONTROLS.
  5209         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5210         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5211         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5212
  5213     12  SF-ST-REFUND-OPTIONS.
  5214         16  SF-ST-RF-LR-CALC               PIC X.
  5215         16  SF-ST-RF-LL-CALC               PIC X.
  5216         16  SF-ST-RF-LN-CALC               PIC X.
  5217         16  SF-ST-RF-AH-CALC               PIC X.
  5218         16  SF-ST-RF-CP-CALC               PIC X.
  5219
  5220     12  SF-ST-UNEARN-PREM-OPTIONS.
  5221         16  SF-ST-LUEP-R78                 PIC X.
  5222         16  SF-ST-LUEP-PRO                 PIC X.
  5223         16  SF-ST-LUEP-ST                  PIC X.
  5224         16  SF-ST-LUEP-DOM                 PIC X.
  5225         16  SF-ST-AUEP-R78                 PIC X.
  5226         16  SF-ST-AUEP-PRO                 PIC X.
  5227         16  SF-ST-AUEP-ST                  PIC X.
  5228         16  SF-ST-AUEP-DOM                 PIC X.
  5229         16  SF-ST-CUEP-R78                 PIC X.
  5230         16  SF-ST-CUEP-PRO                 PIC X.
  5231         16  SF-ST-CUEP-ST                  PIC X.
  5232         16  SF-ST-CUEP-DOM                 PIC X.
  5233
  5234     12  SF-ST-EARN-PREM-OPTIONS.
  5235         16  SF-ST-LEP-R78                  PIC X.
  5236         16  SF-ST-LEP-PRO                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5237         16  SF-ST-LEP-ST                   PIC X.
  5238         16  SF-ST-LEP-DOM                  PIC X.
  5239         16  SF-ST-AEP-R78                  PIC X.
  5240         16  SF-ST-AEP-PRO                  PIC X.
  5241         16  SF-ST-AEP-ST                   PIC X.
  5242         16  SF-ST-AEP-DOM                  PIC X.
  5243         16  SF-ST-CEP-R78                  PIC X.
  5244         16  SF-ST-CEP-PRO                  PIC X.
  5245         16  SF-ST-CEP-ST                   PIC X.
  5246         16  SF-ST-CEP-DOM                  PIC X.
  5247
  5248     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5249
  5250 FD  ELCRTO.
  5251
* 5252                                 COPY ELCCRTO.
  5253******************************************************************
  5254*                                                                *
  5255*                            ELCCRTO.                            *
  5256*                                                                *
  5257*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5258*                                                                *
  5259*   FILE TYPE = VSAM,KSDS                                        *
  5260*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5261*                                                                *
  5262*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5263*                                                                *
  5264*   LOG = YES                                                    *
  5265*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5266******************************************************************
  5267*                   C H A N G E   L O G
  5268*
  5269* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5270*-----------------------------------------------------------------
  5271*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5272* EFFECTIVE    NUMBER
  5273*-----------------------------------------------------------------
  5274* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5275* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5276* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5277* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5278* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5279******************************************************************
  5280
  5281 01  ORIGINAL-CERTIFICATE.
  5282     12  OC-RECORD-ID                      PIC XX.
  5283         88  VALID-OC-ID                      VALUE 'OC'.
  5284
  5285     12  OC-CONTROL-PRIMARY.
  5286         16  OC-COMPANY-CD                 PIC X.
  5287         16  OC-CARRIER                    PIC X.
  5288         16  OC-GROUPING                   PIC X(6).
  5289         16  OC-STATE                      PIC XX.
  5290         16  OC-ACCOUNT                    PIC X(10).
  5291         16  OC-CERT-EFF-DT                PIC XX.
  5292         16  OC-CERT-NO.
  5293             20  OC-CERT-PRIME             PIC X(10).
  5294             20  OC-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5295         16  OC-RECORD-TYPE                PIC X.
  5296         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5297
  5298     12  OC-LAST-MAINT-DT                  PIC XX.
  5299     12  OC-LAST-MAINT-BY                  PIC X(4).
  5300     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5301
  5302     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5303     12  FILLER                            PIC X(49).
  5304
  5305     12  OC-ORIG-REC.
  5306         16  OC-INS-LAST-NAME              PIC X(15).
  5307         16  OC-INS-FIRST-NAME             PIC X(10).
  5308         16  OC-INS-MIDDLE-INIT            PIC X.
  5309         16  OC-INS-AGE                    PIC S999     COMP-3.
  5310         16  OC-JNT-LAST-NAME              PIC X(15).
  5311         16  OC-JNT-FIRST-NAME             PIC X(10).
  5312         16  OC-JNT-MIDDLE-INIT            PIC X.
  5313         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5314         16  OC-LF-BENCD                   PIC XX.
  5315         16  OC-LF-TERM                    PIC S999      COMP-3.
  5316         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5317         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5318         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5319         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5320         16  OC-LF-EXP-DT                  PIC XX.
  5321         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5322         16  OC-LF-CANCEL-DT               PIC XX.
  5323         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5324         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5325         16  OC-AH-BENCD                   PIC XX.
  5326         16  OC-AH-TERM                    PIC S999      COMP-3.
  5327         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5328         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5329         16  OC-AH-EXP-DT                  PIC XX.
  5330         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5331         16  OC-AH-CP                      PIC 99.
  5332         16  OC-AH-CANCEL-DT               PIC XX.
  5333         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5334         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5335         16  OC-CRED-BENE-NAME             PIC X(25).
  5336         16  OC-1ST-PMT-DT                 PIC XX.
  5337         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5338         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5339         16  OC-ISSUE-TRAN-IND             PIC X.
  5340         16  OC-CANCEL-TRAN-IND            PIC X.
  5341         16  FILLER                        PIC X(211).
  5342
  5343     12  FILLER                            PIC X(50).
  5344
  5345******************************************************************
  5346
  5347 WORKING-STORAGE SECTION.
  5348 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5349 77  FILLER   PIC X(32) VALUE '********************************'.
  5350 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5351 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5352
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  97
* EL517.cbl
  5353 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5354 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5355 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5356 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5357
  5358 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5359 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5360 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5361 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5362 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5363 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5364 77  X                      PIC X                  VALUE ' '.
  5365 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5366
  5367 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5368 01  TRAN-CX REDEFINES TRAN-CT.
  5369     12  FILLER             PIC XX.
  5370     12  TCX                PIC 999.
  5371 01  SEQ-NO                 PIC 9999               VALUE 0.
  5372 01  RPND                   PIC 9(5)               VALUE 0.
  5373 01  WPND                   PIC 9(5)               VALUE 0.
  5374 01  RREI                   PIC 9(5)               VALUE 0.
  5375 01  RCTB                   PIC 9(5)               VALUE 0.
  5376 01  RACC                   PIC 9(5)               VALUE 0.
  5377 01  RCER                   PIC 9(5)               VALUE 0.
  5378 01  RCNT                   PIC 9(5)               VALUE 0.
  5379 01  WCER                   PIC 9(5)               VALUE 0.
  5380 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5381 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5382 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5383 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5384 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5385 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5386 01  EMSG.
  5387     12  WS-FILE-ERROR-MESSAGE.
  5388         16  FILLER              PIC X(24)   VALUE
  5389             'ERROR OCCURED OPENING - '.
  5390         16  WS-FEM-FILE-NAME    PIC X(8).
  5391
  5392 01  CMSG.
  5393     12  WS-FILE-ERROR-MESSAGE.
  5394         16  FILLER              PIC X(24)   VALUE
  5395             'ERROR OCCURED CLOSING - '.
  5396         16  WS-CEM-FILE-NAME    PIC X(8).
  5397
  5398 01  RMSG.
  5399     12  WS-FILE-ERROR-MESSAGE.
  5400         16  FILLER              PIC X(24)   VALUE
  5401             'ERROR OCCURED READING - '.
  5402         16  WS-REM-FILE-NAME    PIC X(8).
  5403
  5404 01  HDG1.
  5405     12  FILLER                  PIC X(50)       VALUE ' '.
  5406     12  FILLER                  PIC X(28)       VALUE
  5407                   'PENDING BUSINESS FILE EDIT '.
  5408     12  ER-ONLY                 PIC X(47)       VALUE
  5409          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5410     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  98
* EL517.cbl
  5411
  5412 01  HDG2.
  5413     12  FILLER              PIC X(52)              VALUE SPACE.
  5414     12  H2-COMP             PIC X(30).
  5415     12  FILLER              PIC X(42)              VALUE SPACE.
  5416     12  H2-DATE             PIC X(8).
  5417
  5418 01  HDG3.
  5419     12  FILLER              PIC X(54)              VALUE SPACE.
  5420     12  H3-DATE             PIC X(18).
  5421     12  FILLER              PIC X(49)              VALUE SPACE.
  5422
  5423 01  SUM1.
  5424     12  FILLER              PIC XX                 VALUE ' '.
  5425     12  SUM-TOT             PIC ZZ,ZZZ.
  5426     12  FILLER              PIC X(3)               VALUE SPACE.
  5427     12  FILLER              PIC X(30)              VALUE
  5428          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page  99
* EL517.cbl
  5430
  5431 01  WX-AREA.
  5432     12  PH-COBOL            PIC X.
  5433     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5434
  5435 01  STATUS-SWITCH.
  5436     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5437     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5438     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5439     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5440     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5441     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5442     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5443     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5444     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5445     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5446     12  ERACCT-FILE-STATUS.
  5447         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5448         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5449     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5450     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5451     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5452     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5453     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5454     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5455     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5456     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5457     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5458     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5459     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5460
  5461     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5462     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5463     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5464     12  WS-SW-1                  PIC X  VALUE ' '.
  5465     12  WS-SW-2                  PIC X  VALUE ' '.
  5466
  5467     12  WS-COMPUTED-TOTALS      COMP-3.
  5468         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5469         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5470         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5471         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5472         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5473         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5474         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5475         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5476         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5477         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5478     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5479         88  CO-HAS-CLAIMS                     VALUE '2'.
  5480
  5481     12  EIBDATE                 PIC S9(7)     COMP-3.
  5482
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 100
* EL517.cbl
  5484
  5485* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5486     COPY ELC50W1.
  5487******************************************************************04/19/98
  5488*                                                                *ELC50W1
  5489*                                                                *ELC50W1
  5490*                             ELC50W1                            *   LV005
  5491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5492*                            VMOD=2.004                          *   CL**5
  5493*                                                                *ELC50W1
  5494*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5495*                                                                *ELC50W1
  5496*                                                                *ELC50W1
  5497******************************************************************ELC50W1
  5498                                                                  ELC50W1
  5499     12  WK-WORK-AREA.                                            ELC50W1
  5500         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5501         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5502         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5503         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5504         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5505         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5506         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5507         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5508         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5509         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5510         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5511         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5512         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5513         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5514         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5515         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5516             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5517             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5518             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5519             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5520             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5521             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5522         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5523         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5524             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5525             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5526             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5527         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5528             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5529         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5530         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5531     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5532         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5533         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5534         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5535         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5536         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5537         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5538         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5539         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5540     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5541         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5542         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5543         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5544             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5545         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5546
  5547         16  WK-CONV-GREG.
  5548             24  WCG-CENT             PIC XX.
  5549             24  WCG-REST             PIC X(4).
  5550         16  WORK-GREGORIAN-DATE.
  5551             24  WK-GREG-CENT         PIC XX.
  5552             24  WK-GREG-DATE-YYMMDD.
  5553                 28  WK-GREG-YYMM     PIC X(4).
  5554                 28  WK-GREG-DD       PIC XX.
  5555
  5556         16  WORK-SELECT-DATE.
  5557             24  WK-SELECT-CENT           PIC XX.
  5558             24  WK-SELECT-DATE-YYMMDD.
  5559                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5560                 28  FILLER               PIC XX.
  5561
  5562         16  WK-FORM-NO.
  5563             24  WK-FORM-BANK-ID       PIC X(5).
  5564             24  WK-FORM-UNDRWRTR      PIC X(1).
  5565             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5566
  5567         16  WK-MEMBER-NO.
  5568             24  WK-MEMBER-1-6        PIC X(6).
  5569             24  WK-MEMBER-7-12       PIC X(6).
  5570
  5571         16  WK-FULL-CERT-NO.
  5572             24  WK-CERT-POS-1-2      PIC X(2).
  5573             24  WK-CERT-POS-3        PIC X(1).
  5574             24  WK-CERT-POS-4        PIC X(1).
  5575             24  WK-CERT-POS-5-6      PIC X(2).
  5576             24  WK-CERT-POS-7        PIC X(1).
  5577             24  WK-CERT-POS-8-11     PIC X(4).
  5578
  5579         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5580             88  VALID-RATE-CODE     VALUE 'Y'.
  5581             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5582
  5583     12  WK-BATCH-NO.
  5584         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5585         16  FILLER                   PIC XXX       VALUE SPACES.
  5586
* 5587                                  COPY ELCEDITC.
  5588******************************************************************04/15/98
  5589*                                                                *ELCEDITC
  5590*                                                                *ELCEDITC
  5591*                            ELCEDITC                            *   LV002
  5592*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5593*                            VMOD=2.012                          *   CL**2
  5594*                                                                *ELCEDITC
  5595*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5596*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5597*                                                                *ELCEDITC
  5598******************************************************************ELCEDITC
  5599******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5600*                   C H A N G E   L O G
  5601*
  5602* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5603*-----------------------------------------------------------------
  5604*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5605* EFFECTIVE    NUMBER
  5606*-----------------------------------------------------------------
  5607* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5608******************************************************************
  5609                                                                  ELCEDITC
  5610     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5611         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5612         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5613         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5614         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5615         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5616         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5617         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5618         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5619         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5620         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5621               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5622               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5623               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5624               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5625                                                                  ELCEDITC
  5626         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5627               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5628               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5629               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5630               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5631               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5632               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5633               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5634               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5635               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5636               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5637                                                                  ELCEDITC
  5638         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5639               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5640               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5641               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5642               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5643               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5644               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5645               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5646               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5647                                                                  ELCEDITC
  5648         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5649                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5650                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5651                                                                  ELCEDITC
  5652         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5653                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5654                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5655                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5656                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5657                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5658                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5659                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5660                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5661                                                                  ELCEDITC
  5662         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5663               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5664               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5665                                                                  ELCEDITC
  5666         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5667         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5668         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5669         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5670         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5671                                                                  ELCEDITC
  5672         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5673               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5674               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5675               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5676               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5677                                                                  ELCEDITC
  5678         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5679               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5680               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5681               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5682               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5683                                                                  ELCEDITC
  5684         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5685                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5686                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5687                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5688                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5689                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5690                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5691                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5692                                                                  ELCEDITC
  5693         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5694                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5695                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5696                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5697                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5698                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5699                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5700                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5701                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5702                                                                  ELCEDITC
  5703         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5704                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5705                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5706                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5707                                                                  ELCEDITC
  5708         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5709                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5710                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5711                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5712                                                                  ELCEDITC
  5713         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5714         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5715         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5716         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5717                                                                  ELCEDITC
  5718         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5719         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5720                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5721                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5722                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5723                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5724                                                                  ELCEDITC
  5725         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5726               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5727               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5728               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5729               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5730               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5731                                                                  ELCEDITC
  5732         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5733               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5734               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5735               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5736               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5737               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5738                                                                  ELCEDITC
  5739         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5740                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5741                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5742                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5743                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5744                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5745                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5746                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5747                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5748                                                                  ELCEDITC
  5749         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5750                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5751                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5752                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5753                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5754                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5755                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5756                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5757                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5758                                                                  ELCEDITC
  5759         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5760         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5761         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5762         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5763         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5764         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5765         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5766         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5767         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5768         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5769         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5770         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5771                                                                  ELCEDITC
  5772         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5773                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5774                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5775                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5776                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5777                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5778                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5779                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5780                                                                  ELCEDITC
  5781         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5782                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5783                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5784                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5785                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5786                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5787                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5788                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5789                                                                  ELCEDITC
  5790         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5791                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5792                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5793                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5794                                                                  ELCEDITC
  5795         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5796         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5797         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5798         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5799         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5800         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5801         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5802         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5803         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5804                                                                  ELCEDITC
  5805         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5806         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5807         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5808         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5809         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5810         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5811         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5812         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5813         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5814         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5815         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5816         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5817         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5818         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5819         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5820                                                                  ELCEDITC
  5821         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5822             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5823                                             'M' '5' '9' '2'.     ELCEDITC
  5824             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5825             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5826             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5827             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5828             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5829             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5830             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5831             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 106
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5832             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5833             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5834                                                                  ELCEDITC
  5835         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5836             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5837                                             'M' '5' '9' '2'.     ELCEDITC
  5838             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5839             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5840             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5841             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5842             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5843             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5844             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5845             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5846             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5847             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5848                                                                  ELCEDITC
  5849         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5850         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5851         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5852         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5853         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5854                                                                  ELCEDITC
  5855*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5856*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5857         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5858                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5859                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5860                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5861                                                                  ELCEDITC
  5862         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5863         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5864         16  FILLER                    PIC X.                     ELCEDITC
  5865*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5866         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5867             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5868             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5869             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5870             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5871             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5872             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5873             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5874             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5875             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5876         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 107
* EL517.cbl
* 5878                                  COPY ELC50WS.
  5879*****************************************************************
  5880*                                                               *
  5881*                            ELC50WS.                           *
  5882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5883*                            VMOD=2.061.                        *
  5884*                                                               *
  5885*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5886*                                   EL517                       *
  5887*****************************************************************
  5888******************************************************************
  5889*                   C H A N G E   L O G
  5890*
  5891* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5892*-----------------------------------------------------------------
  5893*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5894* EFFECTIVE    NUMBER
  5895*-----------------------------------------------------------------
  5896* 123102                   PEMA  ADD DCC PROCESSING
  5897* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5898* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5899* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5900* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5901* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5902* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5903* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5904* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5905* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5906* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5907* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5908* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5909* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5910* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5911* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5912* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5913* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5914* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5915* 030309  CR2009021700001  PEMA  ADD ER-2883
  5916* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5917* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5918* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5919* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5920* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5921* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5922* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5923* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5924* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5925* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5926* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5927* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5928* 061412  CR2011022800001  AJRA  NAPERSOFT
  5929* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5930* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5931* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  5932* 101314  IR2013100100002  PEMA  ADD ERROR 1572
  5933* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  5934* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
  5935* 040914  IR2014040900001  AJRA  ADD ERROR 2896
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 108
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5936* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
  5937*-----------------------------------------------------------------
  5938
  5939 01  WORK-AREAS.
  5940
  5941*****************************************************************
  5942*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5943*****************************************************************
  5944
  5945     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5946     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5947     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5948     12  WS-NAME-EDIT-WORK-AREA.
  5949         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5950         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5951             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5952         16  WS-WORK-NAME.
  5953             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5954             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5955             20  FILLER           PIC X(10)     VALUE SPACES.
  5956         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5957             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5958
  5959*****************************************************************
  5960*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5961*****************************************************************
  5962
  5963     12  WS-ERRESC-KEY.
  5964         16 WS-ERRESC-SEARCH-KEY.
  5965             20  WS-ERRESC-COMPANY-CD PIC  X.
  5966             20  WS-ERRESC-CARRIER    PIC  X.
  5967             20  WS-ERRESC-GROUP      PIC X(6).
  5968             20  WS-ERRESC-STATE      PIC XX.
  5969             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5970         16 WS-ERRESC-RESIDUAL-KEY.
  5971             20  WS-ERRESC-AGENT      PIC X(10).
  5972             20  WS-ERRESC-RES-STATE  PIC XX.
  5973             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5974*                                          YYYYMMDD
  5975     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5976     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5977
  5978*RESIDENT STATE TAX MASTER(ERRESS)
  5979*
  5980     12  WS-ERRESS-KEY.
  5981         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5982         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5983         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5984         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5985*                                          YYYYMMDD
  5986
  5987     12  WS-CONTRACT-DATE              PIC 9(8).
  5988*                                          YYYYMMDD
  5989     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5990     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5991         16 WS-YEAR-YY                 PIC   9999.
  5992         16 FILLER                     PIC 9(4).
  5993*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 109
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5994     12  WS-SAVE-ERRESS-KEY            PIC X(9).
  5995     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5996     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5997     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5998
  5999     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  6000         88  DPRB-1ST-TIME                      VALUE ' '.
  6001
  6002*****************************************************************
  6003*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  6004*****************************************************************
  6005
  6006     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  6007     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  6008     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  6009     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  6010     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  6011     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  6012     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
  6013     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  6014     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  6015     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  6016     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  6017         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  6018         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  6019     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  6020         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  6021         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  6022     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  6023
  6024     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  6025     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  6026
  6027     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  6028     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  6029     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6030     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6031     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6032     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6033     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6034     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6035     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6036     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6037     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6038     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6039     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  6040     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  6041     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  6042     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  6043     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6044     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6045     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6046     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6047     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6048     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6049     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6050     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6051     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 110
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6052     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6053     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6054     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6055     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6056     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6057     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6058     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6059     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6060     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6061     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  6062     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  6063     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  6064     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  6065     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  6066     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  6067     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  6068     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  6069     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  6070     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  6071     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  6072     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6073     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6074     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6075     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6076     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6077     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6078     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6079     12  WS-2671-SW               PIC X         VALUE SPACE.
  6080     12  WS-2672-SW               PIC X         VALUE SPACE.
  6081     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6082         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6083     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6084         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6085     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6086
  6087     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6088         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6089         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6090         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6091         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6092
  6093     12  WS-CREDIT-EDIT-CONTROLS.
  6094         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6095         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6096         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6097         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6098         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6099         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6100
  6101     12  WS-AGE-FIELDS.
  6102         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6103         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6104         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6105         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6106
  6107     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6108         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6109         16  WS-SAVE-BENEFIT-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 111
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6110         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6111         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
  6112         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6113         16  FILLER                      PIC XX.
  6114
  6115     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
  6116     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6117     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6118     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6119     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6120     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6121     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6122     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6123     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6124     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6125
  6126     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6127     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6128     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6129     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6130     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6131     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6132     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6133     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6134         88  WS-REDUCING              VALUE 'R'.
  6135         88  WS-LEVEL                 VALUE 'L' 'P'.
  6136     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6137
  6138     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6139     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6140     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6141     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6142     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6143     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6144     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6145     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6146     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6147
  6148     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6149     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6150     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6151     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6152     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6153     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6154     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6155     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6156     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6157     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6158     12  WS-ACCT-SIG-SW.
  6159         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6160         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6161     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6162     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6163     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6164     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6165     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6166     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6167     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 112
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6168     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6169     12  WS-INITIALS.
  6170         16  WS-INIT-1            PIC X         VALUE SPACES.
  6171         16  WS-INIT-2            PIC X         VALUE SPACES.
  6172
  6173     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
  6174     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6175     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6176     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6177     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6178*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6179     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6180     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6181     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6182     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6183     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6184     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6185     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6186     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6187     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6188     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6189     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6190     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6191     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6192     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6193     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6194     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6195     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6196     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6197     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6198     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6199     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6200     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6201******** FLA
  6202     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6203     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6204     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6205     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6206     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6207********
  6208     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6209     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6210     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6211     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6212     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6213     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6214     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6215     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6216     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6217     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6218
  6219     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6220         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6221                                         '0' THRU '9'.
  6222
  6223     12  NUMBER-OF-MONTHS.
  6224         16  SK-MO OCCURS 12 TIMES PIC X.
  6225
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 113
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6226     12  WS-WORK-DATE.
  6227         16  WS-YEAR            PIC 99    VALUE 00.
  6228         16  WS-MONTH           PIC 99    VALUE 00.
  6229         16  WS-DAY             PIC 99    VALUE 00.
  6230
  6231     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
  6232     12  WS-WORK-CRIT-DEV       REDEFINES
  6233         WS-WORK-LF-CRIT-PER    PIC X(03).
  6234
  6235     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6236     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6237
  6238     12  WS-WORK-DATE-FROM.
  6239         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6240         16  FILLER             PIC X  VALUE SPACE.
  6241         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6242         16  FILLER             PIC X         VALUE SPACE.
  6243         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6244
  6245     12  WS-WORK-DATE-THRU.
  6246         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6247         16  FILLER             PIC X         VALUE SPACE.
  6248         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6249         16  FILLER             PIC X         VALUE SPACE.
  6250         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6251
  6252     12  WS-LF-INPUT-CD.
  6253         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6254         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6255
  6256     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6257     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6258         16  WS-AH-INPUT-CD-1   PIC X.
  6259         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6260
  6261     12  WS-SWITCHES.
  6262         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6263         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6264             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6265         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6266             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6267         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6268             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6269         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6270             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6271         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6272             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6273         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6274             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6275         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6276             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6277         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6278             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6279         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6280             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6281         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6282             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6283         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 114
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6284             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6285         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
  6286             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6287         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6288             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6289         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
  6290             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6291         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6292             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6293         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6294             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6295         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6296             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6297         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6298             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6299         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6300             88  AH-BENEFIT-FOUND         VALUE ' '.
  6301             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6302         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6303             88  LF-BENEFIT-FOUND         VALUE ' '.
  6304             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6305         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6306             88  NO-STATE-RECORD          VALUE '1'.
  6307         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6308             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6309         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6310             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6311         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6312             88  CERT-WAS-FOUND           VALUE ' '.
  6313             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6314         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6315             88  BROWSE-STARTED           VALUE 'Y'.
  6316         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6317             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6318         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6319             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6320         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6321             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6322         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6323             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6324         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6325             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6326         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6327             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6328         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6329             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6330             88  FIRST-TIME-THROUGH       VALUE '1'.
  6331             88  CTBL-NOT-FOUND           VALUE '2'.
  6332
  6333         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6334             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6335
  6336         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6337             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6338
  6339********FLA
  6340     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6341     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 115
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6342********
  6343     12  RC-SW-1                  PIC X           VALUE '0'.
  6344     12  RC-SW-2                  PIC X           VALUE '0'.
  6345     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6346     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6347     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
  6348     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6349     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6350     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6351     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6352     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6353     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6354     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6355     12  LIT-SPACES               PIC X           VALUE SPACES.
  6356     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6357     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6358     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6359     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6360     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6361     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6362     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6363         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6364         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6365     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6366         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6367
  6368 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6369     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6370     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6371 01  WS-CRI-SSN-WORK-AREA.
  6372     05  WS-CRI-SOC-SEC-NO.
  6373         10  WS-SS-REPT-CD       PIC X(5).
  6374         10  WS-SS-LAST-NAME     PIC X(5).
  6375         10  WS-SS-INITIAL       PIC X.
  6376
  6377     05  WS-CRI-REPORT-CODE.
  6378         10  FILLER              PIC X(5).
  6379         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6380
  6381     05  WS-CRI-LAST-NAME.
  6382         10  WS-CRI-NAME-MOVE    PIC X(5).
  6383         10  FILLER              PIC X(10).
  6384
  6385 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6386     '12345678012345070923456789'.
  6387 01  FILLER REDEFINES WS-NUM-TABLE.
  6388     05  WS-NUM OCCURS 26        PIC 9.
  6389 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6390 01  V1                          PIC S999 COMP-3.
  6391 01  V2                          PIC S999 COMP-3.
  6392 01  V3                          PIC S999 COMP-3.
  6393 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6394 01  FILLER REDEFINES WS-WORK-VIN.
  6395     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6396 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6397 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6398 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6399 01  WS-HEX-WORK.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 116
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6400     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6401     05  WS-HEX-BYTE             PIC X.
  6402 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6403 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6404
  6405 01  WS-WORK-HIN-ROW-B.
  6406     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6407
  6408 01  ws-benefit-cd-chg-sw      pic x value spaces.
  6409     88  benefit-code-chg           value 'Y'.
  6410 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6411 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6412     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6413 01  WS-ROW-D-TABLE.
  6414     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6415
  6416 01  WS-HIN-TABLE-B.
  6417     05  F                       PIC XX VALUE 'A2'.
  6418     05  F                       PIC XX VALUE 'B3'.
  6419     05  F                       PIC XX VALUE 'C4'.
  6420     05  F                       PIC XX VALUE 'D5'.
  6421     05  F                       PIC XX VALUE 'E6'.
  6422     05  F                       PIC XX VALUE 'F7'.
  6423     05  F                       PIC XX VALUE 'G8'.
  6424     05  F                       PIC XX VALUE 'H9'.
  6425     05  F                       PIC XX VALUE 'I1'.
  6426     05  F                       PIC XX VALUE 'J2'.
  6427     05  F                       PIC XX VALUE 'K3'.
  6428     05  F                       PIC XX VALUE 'L4'.
  6429     05  F                       PIC XX VALUE 'M5'.
  6430     05  F                       PIC XX VALUE 'N6'.
  6431     05  F                       PIC XX VALUE 'O0'.
  6432     05  F                       PIC XX VALUE 'P7'.
  6433     05  F                       PIC XX VALUE 'Q0'.
  6434     05  F                       PIC XX VALUE 'R8'.
  6435     05  F                       PIC XX VALUE 'S9'.
  6436     05  F                       PIC XX VALUE 'T2'.
  6437     05  F                       PIC XX VALUE 'U3'.
  6438     05  F                       PIC XX VALUE 'V4'.
  6439     05  F                       PIC XX VALUE 'W5'.
  6440     05  F                       PIC XX VALUE 'X6'.
  6441     05  F                       PIC XX VALUE 'Y7'.
  6442     05  F                       PIC XX VALUE 'Z8'.
  6443 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6444     05  WS-VAL-IN               PIC X.
  6445     05  WS-VAL-OUT              PIC 9.
  6446 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6447
  6448 01  WS-COMPARE-BINARY-DATES.
  6449     05  WS-971231                PIC XX VALUE X'92FF'.
  6450     05  WS-931231                PIC XX VALUE X'8CFF'.
  6451     05  WS-791231                PIC XX VALUE X'77FF'.
  6452     05  WS-771001                PIC XX VALUE X'74A1'.
  6453     05  WS-820301                PIC XX VALUE X'7B41'.
  6454     05  WS-831031                PIC XX VALUE X'7DBF'.
  6455     05  WS-831231                PIC XX VALUE X'7DFF'.
  6456     05  WS-810831                PIC XX VALUE X'7A7F'.
  6457     05  WS-830901                PIC XX VALUE X'7D81'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 117
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6458
  6459 01  FILE-ACCESS-IDS.
  6460     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6461     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6462     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6463     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6464     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6465     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
  6466     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6467     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6468     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6469     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6470     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6471     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6472     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6473     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6474     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6475     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6476     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6477
  6478 01  DD-IU-SW                    PIC X   VALUE ' '.
  6479     88  DD-IU-PRESENT                 VALUE 'Y'.
  6480
  6481 01  ACCESS-KEYS.
  6482     12  ELMSTR-KEY.
  6483         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6484         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6485     12  W-CLAIM-KEY.
  6486         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6487         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6488
  6489     12  ELCNTL-KEY.
  6490         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6491         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6492         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6493         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6494
  6495     12  ELCERT-KEY.
  6496         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6497         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6498         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6499         16  CERT-STATE           PIC XX      VALUE SPACES.
  6500         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6501         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6502         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6503
  6504     12  ELCERT2-KEY.
  6505         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6506         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6507
  6508     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6509
  6510     12  ELCERT-SAVE.
  6511         16  FILLER                      PIC XX    VALUE SPACES.
  6512
  6513         16  WCS-CONTROL-PRIMARY.
  6514             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6515             20  WCS-CARRIER             PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 118
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6516             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6517             20  WCS-STATE               PIC XX    VALUE SPACES.
  6518             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6519             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6520             20  WCS-CERT-NO.
  6521                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6522                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6523
  6524         16  CS-CONTROL-BY-NAME.
  6525             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6526             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6527             20  CS-INSURED-INITIALS.
  6528                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6529                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6530
  6531         16  CS-CONTROL-BY-SSN.
  6532             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6533             20  CS-SOC-SEC-NO.
  6534                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6535                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6536                 24  CS-SSN-LN3.
  6537                     28 CS-INSURED-INITIALS-A2   PIC XX
  6538                                     VALUE SPACES.
  6539                     28 CS-PART-LAST-NAME-A2     PIC X
  6540                                     VALUE SPACE.
  6541
  6542         16  CS-CONTROL-BY-CERT-NO.
  6543             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6544             20  CS-CERT-NO-A4           PIC X(11)
  6545                                     VALUE SPACES.
  6546
  6547         16  CS-CONTROL-BY-MEMB.
  6548             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6549             20  CS-MEMBER-NO.
  6550                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6551                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6552                 24  CS-MEMB-LN4.
  6553                     28 CS-INSURED-INITIALS-A5   PIC XX
  6554                                      VALUE SPACES.
  6555                     28 CS-PART-LAST-NAME-A5     PIC XX
  6556                                      VALUE SPACES.
  6557
  6558         16  FILLER              PIC X(360) VALUE SPACES.
  6559
  6560     12  ERACCT-KEY.
  6561         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6562         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6563         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6564         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6565         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6566         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6567
  6568     12  ERCOMP-KEY.
  6569         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6570         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6571         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6572         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6573         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 119
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6574         16  COMP-TYPE            PIC X     VALUE SPACES.
  6575
  6576     12  ERLOFC-KEY.
  6577         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6578         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6579         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6580         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6581         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
  6582         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6583
  6584     12  WS-ELCRTT-KEY.
  6585         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6586         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6587
  6588     12  ERBXRF-KEY.
  6589         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6590         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6591         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6592         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6593
  6594     12  ERAGTC-KEY.
  6595         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6596         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6597         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6598         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6599         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6600         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6601
  6602     12  ERPLAN-KEY.
  6603         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6604         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6605         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6606         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6607         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6608         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6609         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6610         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6611
  6612     12  ERFORM-KEY.
  6613         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6614         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6615         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6616         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6617
  6618     12  ERREIN-KEY.
  6619         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6620         16  REIN-TYPE            PIC X     VALUE SPACES.
  6621         16  REIN-TABLE-CO.
  6622             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6623             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6624             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6625         16  FILLER               PIC X(3)  VALUE SPACES.
  6626
  6627     12  ERCTBL-KEY.
  6628         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6629         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6630         16  CTBL-CNTRL-2.
  6631             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 120
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6632             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6633
  6634     12  ELCRTO-KEY.
  6635         16  ELCRTO-COMPANY-CD       PIC X.
  6636         16  ELCRTO-CARRIER          PIC X.
  6637         16  ELCRTO-GROUPING         PIC X(6).
  6638         16  ELCRTO-STATE            PIC XX.
  6639         16  ELCRTO-ACCOUNT          PIC X(10).
  6640         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6641         16  ELCRTO-CERT-NO.
  6642             20  ELCRTO-CERT-PRIME   PIC X(10).
  6643             20  ELCRTO-CERT-SFX     PIC X.
  6644         16  ELCRTO-RECORD-TYPE      PIC X.
  6645         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6646
  6647
  6648     12  WS-ACCESS.
  6649         16  FILLER               PIC XX    VALUE SPACES.
  6650         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6651
  6652     12  WS-CARR-ACCESS.
  6653         16  FILLER               PIC X(3)  VALUE SPACES.
  6654         16  WS-CARR              PIC X     VALUE SPACE.
  6655*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6656*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6657     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6658         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6659         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6660         88  WS-DMD-NO-RATING   VALUE 'N'.
  6661
  6662
  6663     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6664         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6665                                         'NJ' 'NL'
  6666                                         'PJ' 'PL'
  6667                                         'SJ' 'SL'.
  6668     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6669         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6670                                         'NI' 'NJ' 'NL' 'NU'
  6671                                         'PJ' 'PL' 'PI' 'PU'
  6672                                         'SI' 'SJ' 'SL' 'SU'
  6673                                         'MX' 'MY' 'MZ'.
  6674
  6675 01  ERPDEF-KEY-SAVE             PIC X(18).
  6676 01  ERPDEF-KEY.
  6677     12  ERPDEF-COMPANY-CD       PIC X.
  6678     12  ERPDEF-STATE            PIC XX.
  6679     12  ERPDEF-PROD-CD          PIC XXX.
  6680     12  F                       PIC X(7).
  6681     12  ERPDEF-BEN-TYPE         PIC X.
  6682     12  ERPDEF-BEN-CODE         PIC XX.
  6683     12  ERPDEF-EXP-DT           PIC XX.
  6684
  6685 01  ELSTAT-KEY-SAVE             PIC X(20).
  6686 01  ELSTAT-KEY.
  6687     12  ELSTAT-COMPANY-ID       PIC XXX.
  6688     12  ELSTAT-CARRIER          PIC X.
  6689     12  ELSTAT-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 121
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6690     12  ELSTAT-STATE            PIC XX.
  6691     12  ELSTAT-EXP-DT           PIC 9(8).
  6692
  6693 01  WS-ERROR-VALUES.
  6694     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6695     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6696     12  er-1572                     pic s9(4)   value +1572.
  6697     12  er-1573                     pic s9(4)   value +1573.
  6698     12  er-1574                     pic s9(4)   value +1574.
  6699     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6700     12  ER-1891                     PIC S9(4)   VALUE +1891.
  6701     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6702     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6703     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6704     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6705     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6706     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6707     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6708     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6709     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6710     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6711     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6712     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6713     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6714     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6715     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6716     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6717     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6718     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6719     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6720     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6721     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6722     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6723     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6724     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6725     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6726     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6727     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6728     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6729     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6730     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6731     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6732     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6733     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6734     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6735     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6736     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6737     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6738     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6739     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6740     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6741     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6742     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6743     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6744     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6745     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6746     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6747     12  ER-2610                     PIC S9(4)   VALUE +2610.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 122
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6748     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6749     12  ER-2612                     PIC S9(4)   VALUE +2612.
  6750     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6751     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6752     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6753     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6754     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6755     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6756     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6757     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6758     12  ER-2621                     PIC S9(4)   VALUE +2621.
  6759     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6760     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6761     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6762     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6763     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6764     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6765     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6766     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6767     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6768     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6769     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6770     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6771     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6772     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6773     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6774     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6775     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6776     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6777     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6778     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6779     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6780     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6781     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6782     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6783     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6784     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6785     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6786     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6787     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6788     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6789     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6790     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6791     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6792     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6793     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6794     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6795     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6796     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6797     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6798     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6799     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6800     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6801     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6802     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6803     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6804     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6805     12  ER-2668                     PIC S9(4)   VALUE +2668.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 123
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6806     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6807     12  ER-2670                     PIC S9(4)   VALUE +2670.
  6808     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6809     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6810     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6811     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6812     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6813     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6814     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6815     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6816     12  ER-2679                     PIC S9(4)   VALUE +2679.
  6817     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6818     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6819     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6820     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6821     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6822     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6823     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6824     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6825     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6826     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6827     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6828     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6829     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6830     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6831     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6832     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6833     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6834     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6835     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6836     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6837     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6838     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6839     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6840     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6841     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6842     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6843     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6844     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6845     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6846     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6847     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6848     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6849     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6850     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6851     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6852     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6853     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6854     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6855     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6856     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6857     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6858     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6859     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6860     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6861     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6862     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6863     12  ER-2736                     PIC S9(4)   VALUE +2736.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 124
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6864     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6865     12  ER-2738                     PIC S9(4)   VALUE +2738.
  6866     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6867     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6868     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6869     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6870     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6871     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6872     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6873     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6874     12  ER-2747                     PIC S9(4)   VALUE +2747.
  6875     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6876     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6877     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6878     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6879     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6880     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6881     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6882     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6883     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6884     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6885     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6886     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6887     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6888     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6889     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6890     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6891     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6892     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6893     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6894     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6895     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6896     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6897     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6898     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6899     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6900     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6901     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6902     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6903     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6904     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6905     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6906     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6907     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6908     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6909     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6910     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6911     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6912     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6913     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6914     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6915     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6916     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6917     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6918     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6919     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6920     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6921     12  ER-2799                     PIC S9(4)   VALUE +2799.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 125
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6922     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6923     12  ER-2879                     PIC S9(4)   VALUE +2879.
  6924     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6925     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6926     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6927     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6928     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6929     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6930     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6931     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6932     12  ER-2889                     PIC S9(4)   VALUE +2889.
  6933     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6934     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6935     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6936     12  ER-2896                     PIC S9(4)   VALUE +2896.
  6937     12  ER-2897                     PIC S9(4)   VALUE +2897.
  6938     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6939     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6940     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6941     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6942     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6943     12  ER-3049                     PIC S9(4)   VALUE +3049.
  6944     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6945     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6946     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6947     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6948     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6949     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6950     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6951     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6952     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6953     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6954     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6955     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6956     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6957     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6958     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6959     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6960     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6961     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6962     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6963     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6964     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6965     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6966     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6967     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6968     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6969     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6970     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6971     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6972     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6973     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6974     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6975     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6976     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6977     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6978     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6979     12  ER-8045                     PIC S9(4)   VALUE +8045.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 126
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6980     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6981     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6982     12  ER-8067                     PIC S9(4)   VALUE +8067.
  6983     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6984     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6985     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6986     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6987     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6988     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6989     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6990     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6991     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6992     12  ER-8078                     PIC S9(4)   VALUE +8078.
  6993     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6994     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6995     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6996     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6997     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6998     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6999     12  ER-8085                     PIC S9(4)   VALUE +8085.
  7000     12  ER-8086                     PIC S9(4)   VALUE +8086.
  7001     12  ER-8087                     PIC S9(4)   VALUE +8087.
  7002     12  ER-8088                     PIC S9(4)   VALUE +8088.
  7003     12  ER-8089                     PIC S9(4)   VALUE +8089.
  7004     12  ER-8090                     PIC S9(4)   VALUE +8090.
  7005     12  ER-8091                     PIC S9(4)   VALUE +8091.
  7006     12  ER-8092                     PIC S9(4)   VALUE +8092.
  7007     12  ER-8093                     PIC S9(4)   VALUE +8093.
  7008     12  ER-8094                     PIC S9(4)   VALUE +8094.
  7009     12  ER-8095                     PIC S9(4)   VALUE +8095.
  7010     12  ER-8096                     PIC S9(4)   VALUE +8096.
  7011     12  ER-8097                     PIC S9(4)   VALUE +8097.
  7012     12  ER-8098                     PIC S9(4)   VALUE +8098.
  7013     12  ER-8099                     PIC S9(4)   VALUE +8099.
  7014     12  ER-8109                     PIC S9(4)   VALUE +8109.
  7015     12  ER-8110                     PIC S9(4)   VALUE +8110.
  7016     12  ER-8111                     PIC S9(4)   VALUE +8111.
  7017     12  ER-8112                     PIC S9(4)   VALUE +8112.
  7018     12  ER-8113                     PIC S9(4)   VALUE +8113.
  7019     12  ER-8114                     PIC S9(4)   VALUE +8114.
  7020     12  ER-8116                     PIC S9(4)   VALUE +8116.
  7021     12  ER-8148                     PIC S9(4)   VALUE +8148.
  7022     12  ER-8152                     PIC S9(4)   VALUE +8152.
  7023     12  ER-8300                     PIC S9(4)   VALUE +8300.
  7024     12  ER-8301                     PIC S9(4)   VALUE +8301.
  7025     12  ER-8302                     PIC S9(4)   VALUE +8302.
  7026     12  ER-8303                     PIC S9(4)   VALUE +8303.
  7027     12  ER-8304                     PIC S9(4)   VALUE +8304.
  7028     12  ER-8310                     PIC S9(4)   VALUE +8310.
  7029     12  ER-8311                     PIC S9(4)   VALUE +8311.
  7030     12  ER-8312                     PIC S9(4)   VALUE +8312.
  7031     12  ER-8313                     PIC S9(4)   VALUE +8313.
  7032     12  ER-8314                     PIC S9(4)   VALUE +8314.
  7033     12  ER-8315                     PIC S9(4)   VALUE +8315.
  7034     12  ER-8316                     PIC S9(4)   VALUE +8316.
  7035     12  ER-8317                     PIC S9(4)   VALUE +8317.
  7036     12  ER-9236                     PIC S9(4)   VALUE +9236.
  7037     12  ER-9501                     PIC S9(4)   VALUE +9501.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 127
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  7038     12  ER-9503                     PIC S9(4)   VALUE +9503.
  7039     12  ER-9263                     PIC S9(4)   VALUE +9263.
  7040     12  ER-9999                     PIC S9(4)   VALUE +9999.
  7041******************************************************************
  7042***************   END OF ELC50WS     ****************************
  7043******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 128
* EL517.cbl
  7045 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 129
* EL517.cbl
  7047*DLB001
  7048 01  WS-DLB-MASTER-POLICY-FORM.
  7049     12  DMPF-PROCESS-TYPE         PIC X.
  7050         88  DMPF-OPEN-FILES                   VALUE 'O'.
  7051         88  DMPF-REG-PROCESS                  VALUE 'P'.
  7052         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  7053     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  7054     12  DMPF-RETURN-CODE          PIC XX.
  7055         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7056         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  7057         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  7058         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  7059         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7060         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  7061         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  7062
  7063*DLB002
  7064 01  WS-DLB-INTERNAL-POLICY-FORM.
  7065     12  DIPF-PROCESS-TYPE         PIC X.
  7066         88  DIPF-OPEN-FILES                   VALUE 'O'.
  7067         88  DIPF-REG-PROCESS                  VALUE 'P'.
  7068         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  7069     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  7070     12  DIPF-RETURN-CODE          PIC XX.
  7071         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7072         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  7073         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  7074         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  7075         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7076         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  7077         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  7078
  7079*DLB003
  7080 01  WS-DLB-VALID-BANK-ID.
  7081     12  DVBI-PROCESS-TYPE         PIC X.
  7082         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7083         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7084         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7085     12  DVBI-BANK-ID              PIC X(5).
  7086     12  DVBI-BANK-ID-TYPE         PIC X.
  7087         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7088         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7089         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7090         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7091         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7092     12  DVBI-RETURN-CODE          PIC XX.
  7093         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7094         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7095         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7096         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7097         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7098         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7099         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7100         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7101         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7102         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7103
  7104*DLB007
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 130
* EL517.cbl
  7105 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7106     12  DCUA-PROCESS-TYPE         PIC X.
  7107         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7108         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7109         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7110     12  DCUA-RES-STATE            PIC XX.
  7111     12  DCUA-BEN-TYPE             PIC XX.
  7112     12  DCUA-SYS-IDENT            PIC X.
  7113         88  DCUA-CLAIM                        VALUE 'C'.
  7114         88  DCUA-PREMIUM                      VALUE 'P'.
  7115     12  DCUA-COVERAGE-RULE        PIC X.
  7116     12  DCUA-CLIENT-ID            PIC X(10).
  7117     12  DCUA-EFF-DATE             PIC X(8).
  7118     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7119     12  DCUA-RETURN-CODE          PIC XX.
  7120         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7121         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7122         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7123     12  DCUA-CERT-NUMBER          PIC X(11).
  7124     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7125     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7126
  7127*DLB011
  7128 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7129     12  DPRB-PROCESS-TYPE         PIC X.
  7130         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7131         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7132         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7133     12  DPRB-RATE-CODE            PIC X(4).
  7134     12  DPRB-COVERAGE-CATEG       PIC X.
  7135     12  DPRB-RETURN-CODE          PIC XX.
  7136         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7137         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7138         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7139         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7140         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7141         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7142         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7143         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7144     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7145     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7146     12  DPRB-BEN-TYPE             PIC XX.
  7147
  7148*DLB017
  7149 01  WS-DLB-VALID-RATE-CODE.
  7150     12  DVRC-PROCESS-TYPE         PIC X.
  7151         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7152         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7153         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7154     12  DVRC-RATE-CODE            PIC X(4).
  7155     12  DVRC-RETURN-CODE          PIC XX.
  7156         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7157         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7158         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7159         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7160         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7161         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7162         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 131
* EL517.cbl
  7163
  7164*DLB019
  7165 01  WS-DLB-ORIG-COV-CAT.
  7166     12  DOCC-PROCESS-TYPE         PIC X.
  7167         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7168         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7169         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7170     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7171     12  DOCC-RETURN-CODE          PIC XX.
  7172     12  DOCC-ORIG-COV-CAT         PIC X.
  7173     12  DOCC-UNDERWRITER          PIC XX.
  7174     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7175     12  DOCC-CREDIT-IND           PIC X.
  7176     12  DOCC-PRODUCT-CD           PIC XX.
  7177     12  DOCC-TERM                 PIC XXX.
  7178
  7179*DLB021
  7180 01  WS-DLB-VALID-LOAN-OFFICER.
  7181     12  DVLO-LOAN-OFFICER         PIC X(3).
  7182     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7183         16  DVLO-BILL-TYPE        PIC X.
  7184         16  DVLO-BILL-SOURCE      PIC X.
  7185         16  DVLO-BATCH-TYPE       PIC X.
  7186     12  DVLO-RETURN-CODE          PIC XX.
  7187         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7188         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7189         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7190         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7191         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7192         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7193
  7194*DLB022
  7195 01  WS-DLB-VALID-STATE-CODE.
  7196     12  DVSC-PROCESS-TYPE         PIC X.
  7197         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7198         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7199         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7200     12  DVSC-STATE-CODE           PIC XX.
  7201     12  DVSC-RETURN-CODE          PIC XX.
  7202         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7203         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7204         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7205         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7206         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7207         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7208         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7209
  7210*DLB023
  7211 01  WS-DLB-VALID-CODE-VALUES.
  7212     12  DVCV-PROCESS-TYPE         PIC X.
  7213         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7214         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7215         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7216     12  DVCV-SYSTEM-ID            PIC XX.
  7217         88  DVCV-CLAIMS                       VALUE 'CL'.
  7218         88  DVCV-CREDIT                       VALUE 'CR'.
  7219     12  DVCV-RECORD-TYPE          PIC XX.
  7220         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 132
* EL517.cbl
  7221         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7222         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7223         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7224         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7225         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7226         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7227         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7228     12  DVCV-RECORD-KEY           PIC X(6).
  7229     12  DVCV-RETURN-CODE          PIC XX.
  7230         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7231         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7232         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7233         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7234         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7235         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7236         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7237         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7238         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7239         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7240     12  DVCV-CODE-DESC            PIC X(60).
  7241     12  DVCV-GEN-DESC-1           PIC X(20).
  7242     12  DVCV-GEN-DESC-2           PIC X(20).
  7243     12  DVCV-GEN-DESC-3           PIC X(20).
  7244
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 133
* EL517.cbl
  7246
  7247 01  PARMLIST.
  7248     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7249     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7250     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7251**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7252**
  7253**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7254     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7255
  7256 01  PLAN-RECORDS.
  7257     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7258     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7259
* 7260                                  COPY ELCDATE.
  7261******************************************************************06/11/98
  7262*                                                                *ELCDATE
  7263*                                                                *ELCDATE
  7264*                            ELCDATE.                            *   LV023
  7265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7266*                            VMOD=2.003                           ELCDATE
  7267*                                                                *ELCDATE
  7268*                                                                *ELCDATE
  7269*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7270*                 LENGTH = 200                                   *   CL*19
  7271******************************************************************ELCDATE
  7272                                                                  ELCDATE
  7273 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7274     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7275     12  DC-OPTION-CODE                PIC X.                        CL*15
  7276         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7277         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7278         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7279         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7280         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7281         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7282         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7283         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7284         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7285         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7286         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7287         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7288         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7289         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7290         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7291         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7292         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7293         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7294         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7295         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7296         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7297         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7298         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7299         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7300         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7301         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7302         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7303         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7304         88  THREE-CHARACTER-BIN                                  ELCDATE
  7305                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7306         88  GREGORIAN-TO-BIN                                        CL**2
  7307                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7308         88  BIN-TO-GREGORIAN                                        CL**2
  7309                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7310         88  JULIAN-TO-BINARY                                        CL**2
  7311                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7312     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7313         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7314         88  DATE-CONVERSION-ERROR                                ELCDATE
  7315                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7316         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7317         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7318         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7319         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7320         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7321         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7322         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7323         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7324         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7325         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7326     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7327         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7328     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7329         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7330         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7331         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7332     12  FILLER                        PIC X.                        CL*15
  7333     12  DC-CONVERSION-DATES.                                        CL*15
  7334         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7335         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7336         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7337         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7338                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7339             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7340             20  SLASH1-1              PIC X.                        CL*15
  7341             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7342             20  SLASH1-2              PIC X.                        CL*15
  7343             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7344         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7345         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7346                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7347             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7348             20  SLASH2-1              PIC X.                        CL*15
  7349             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7350             20  SLASH2-2              PIC X.                        CL*15
  7351             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7352         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7353         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7354                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7355             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7356             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7357             20  DC-YMD-DAY            PIC 99.                       CL*15
  7358         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7359         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7360                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7361             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 135
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7362             20  DC-MDY-DAY            PIC 99.                       CL*15
  7363             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7364         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7365             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7366             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7367             20  FILLER                PIC XX.                       CL*15
  7368             20  DC-ALPHA-CENTURY.                                   CL*15
  7369                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7370             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7371         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7372         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7373         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7374         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7375         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7376                                       PIC 9(05).                    CL*20
  7377         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7378             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7379             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7380         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7381         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7382         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7383     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7384         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7385         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7386             20  FILLER                PIC 9(3).                     CL*15
  7387             20  HOLD-CEN-1-CCYY.                                    CL*15
  7388                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7389                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7390             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7391             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7392         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7393             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7394             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7395             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7396                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7397                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7398             20  FILLER                PIC 9(3).                     CL*15
  7399         16  HOLD-CENTURY-1-X.                                       CL*15
  7400             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7401             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7402                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7403                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7404             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7405             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7406         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7407             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7408             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7409             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7410                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7411                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7412             20  FILLER                PIC XXX.                      CL*23
  7413         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7414         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7415         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7416         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7417             20  DC-JULIAN-1-CCYY.                                   CL*15
  7418                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7419                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 136
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7420             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7421         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7422         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7423             20  DC-JULIAN-2-CCYY.                                   CL*15
  7424                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7425                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7426             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7427         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7428             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7429             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7430             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7431             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7432             20  DC-EDITA-CCYY.                                      CL*15
  7433                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7434                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7435         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7436             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7437             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7438             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7439             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7440             20  DC-EDITB-CCYY.                                      CL*15
  7441                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7442                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7443         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7444         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7445                              DC-GREG-DATE-CYMD.                  ELCDATE
  7446             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7447             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7448             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7449             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7450         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7451         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7452                              DC-GREG-DATE-MDCY.                  ELCDATE
  7453             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7454             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7455             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7456             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7457    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7458        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7459    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7460    12  FILLER                         PIC X(28).                    CL*26
  7461
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 137
* EL517.cbl
* 7463                                  COPY ELCCALC.
  7464******************************************************************04/15/98
  7465*                                                                *ELCCALC
  7466*                           ELCCALC.                            *    LV003
  7467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7468*                            VMOD=2.025                          *   CL**3
  7469*                                                                *   CL**2
  7470*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7471*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7472*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7473*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7474*                                                                *   CL**2
  7475*  PASSED TO ELRTRM                                              *   CL**2
  7476*  -----------------                                             *   CL**2
  7477*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7478*  ORIGINAL TERM                                                 *   CL**2
  7479*  BEGINNING DATE                                                *   CL**2
  7480*  ENDING DATE                                                   *   CL**2
  7481*  COMPANY I.D.                                                  *   CL**2
  7482*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7483*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7484*  FREE LOOK DAYS                                                *   CL**2
  7485*                                                                *   CL**2
  7486*  RETURNED FROM ELRTRM                                          *   CL**2
  7487*  ---------------------                                         *   CL**2
  7488*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7489*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7490*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7491*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7492*----------------------------------------------------------------*   CL**2
  7493*  PASSED TO ELRAMT                                              *   CL**2
  7494*  ----------------                                              *   CL**2
  7495*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7496*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7497*  ORIGINAL AMOUNT                                               *   CL**2
  7498*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7499*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7500*  METHOD                                                            CL**2
  7501*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7502*  COMPANY I.D.                                                  *   CL**2
  7503*  BENEFIT TYPE                                                  *   CL**2
  7504*                                                                *   CL**2
  7505*  RETURNED FROM ELRAMT                                          *   CL**2
  7506*  --------------------                                          *   CL**2
  7507*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7508*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7509*  REMAINING AMOUNT FACTOR                                           CL**2
  7510*----------------------------------------------------------------*   CL**2
  7511*  PASSED TO ELRESV                                              *   CL**2
  7512*  -----------------                                             *   CL**2
  7513*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7514*  VALUATION DATE                                                *   CL**2
  7515*  PAID THRU DATE                                                *   CL**2
  7516*  BENEFIT                                                       *   CL**2
  7517*  INCURRED DATE                                                 *   CL**2
  7518*  REPORTED DATE                                                 *   CL**2
  7519*  ISSUE AGE                                                     *   CL**2
  7520*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7521*  CDT PERCENT                                                   *   CL**2
  7522*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7523* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7524* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7525* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7526*                                                                *   CL**2
  7527*  RETURNED FROM ELRESV                                          *   CL**2
  7528*  --------------------                                          *   CL**2
  7529*  CDT TABLE USED                                                *   CL**2
  7530*  CDT FACTOR USED                                               *   CL**2
  7531*  PAY TO CURRENT RESERVE                                        *   CL**2
  7532*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7533*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7534*----------------------------------------------------------------*   CL**2
  7535*  PASSED TO ELRATE                                              *   CL**2
  7536*  ----------------                                              *   CL**2
  7537*  CERT ISSUE DATE                                               *   CL**2
  7538*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7539*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7540*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7541*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7542*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7543*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7544*  DEVIATION CODE                                                *   CL**2
  7545*  ISSUE AGE                                                     *   CL**2
  7546*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7547*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7548*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7549*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7550*  A.P.R.                                                        *   CL**2
  7551*  METHOD                                                            CL**2
  7552*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7553*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7554*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7555*  BENEFIT CODE                                                  *   CL**2
  7556*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7557*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7558*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7559*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7560*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7561*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7562*                                                                *   CL**2
  7563*  RETURNED FROM ELRATE                                          *   CL**2
  7564*  --------------------                                          *   CL**2
  7565*  CALCULATED PREMIUM                                            *   CL**2
  7566*  PREMIUM RATE                                                  *   CL**2
  7567*  MORTALITY CODE                                                *   CL**2
  7568*  MAX ATTAINED AGE                                              *   CL**2
  7569*  MAX AGE                                                       *   CL**2
  7570*  MAX TERM                                                      *   CL**2
  7571*  MAX MONTHLY BENEFIT                                           *   CL**2
  7572*  MAX TOTAL BENIFIT                                             *   CL**2
  7573*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7574*----------------------------------------------------------------*   CL**2
  7575*  PASSED TO ELRFND                                              *   CL**2
  7576*  ----------------                                              *   CL**2
  7577*  CERT ISSUE DATE                                               *   CL**2
  7578*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7579*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7580*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7581*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7582*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7583*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7584*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7585*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7586*  DEVIATION CODE                                                *   CL**2
  7587*  ISSUE AGE                                                     *   CL**2
  7588*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7589*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7590*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7591*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7592*  A.P.R.                                                        *   CL**2
  7593*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7594*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7595*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7596*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7597*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7598*  BENEFIT CODE                                                  *   CL**2
  7599*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7600*                                                                *   CL**2
  7601*  RETURNED FROM ELRFND                                          *   CL**2
  7602*  --------------------                                          *   CL**2
  7603*  CALCULATED REFUND                                             *   CL**2
  7604*----------------------------------------------------------------*   CL**2
  7605*  PASSED TO ELEARN                                              *   CL**2
  7606*  ----------------                                              *   CL**2
  7607*  CERT ISSUE DATE                                               *   CL**2
  7608*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7609*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7610*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7611*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7612*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7613*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7614*  DEVIATION CODE                                                *   CL**2
  7615*  ISSUE AGE                                                     *   CL**2
  7616*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7617*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7618*  A.P.R.                                                        *   CL**2
  7619*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7620*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7621*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7622*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7623*  BENEFIT CODE                                                  *   CL**2
  7624*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7625*                                                                *   CL**2
  7626*  RETURNED FROM ELEARN                                          *   CL**2
  7627*  --------------------                                          *   CL**2
  7628*  INDICATED  EARNINGS                                           *   CL**2
  7629*----------------------------------------------------------------*   CL**2
  7630*                 LENGTH = 450                                   *   CL**2
  7631*                                                                *   CL**2
  7632******************************************************************   CL**2
  7633******************************************************************
  7634*                   C H A N G E   L O G
  7635*
  7636* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7637*-----------------------------------------------------------------
  7638*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7639* EFFECTIVE    NUMBER
  7640*-----------------------------------------------------------------
  7641* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7642* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7643* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7644* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7645* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7646* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7647* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7648* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7649* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7650******************************************************************
  7651                                                                     CL**2
  7652 01  CALCULATION-PASS-AREA.                                          CL**2
  7653     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7654                                     COMP.                           CL**2
  7655                                                                     CL**2
  7656     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7657       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7658       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7659                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7660       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7661       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7662       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7663       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7664       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7665       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7666       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7667       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7668       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7669       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7670       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7671       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7672       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7673       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7674       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7675       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7676       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7677                                                                     CL**2
  7678     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7679       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7680***********************  INPUT AREAS ****************************    CL**2
  7681                                                                     CL**2
  7682     12  CP-CALCULATION-AREA.                                        CL**2
  7683         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7684         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7685         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7686         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7687         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7688           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7689                                                   'I' 'U'.          CL**2
  7690           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7691           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7692         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7693         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7694         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7695         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7696         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7697                                     COMP-3.                         CL**2
  7698         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7699                                     COMP-3.                         CL**2
  7700         16  CP-CDT-METHOD         PIC X.                            CL**2
  7701           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7702           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7703           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7704         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7705           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7706           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7707         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7708                                     COMP-3.                         CL**2
  7709         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7710                                     COMP-3.                         CL**2
  7711         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7712                                     COMP-3.                         CL**2
  7713         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7714                                     COMP-3.                         CL**2
  7715         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7716                                     COMP-3.                         CL**2
  7717         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7718                                     COMP-3.                         CL**2
  7719         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7720                                     COMP-3.                         CL**2
  7721         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7722           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7723           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7724           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7725           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7726           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7727           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7728           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7729         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7730           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7731           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7732           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7733           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7734           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7735           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7736           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7737           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7738           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7739           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7740           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7741           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7742           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7743           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7744         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7745           88  CP-CLAIM                            VALUE '1'.        CL**2
  7746           88  CP-CANCEL                           VALUE '2'.        CL**2
  7747           88  CP-ISSUE                            VALUE '3'.        CL**2
  7748         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7749           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7750           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7751           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7752           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7753           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7754           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7755           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7756           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7757           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7758           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7759           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7760           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7761           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7762           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7763           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7764           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7765           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7766           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7767                                                     'W' 'X'.        CL**2
  7768           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7769           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7770           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7771           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7772           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7773           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7774           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7775           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7776           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7777           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7778           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7779           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7780           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7781                                                                     CL**2
  7782         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7783                                     COMP-3.                         CL**2
  7784         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7785         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7786         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7787         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7788         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7789           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7790               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7791         16  CP-R78-OPTION         PIC X.                            CL**2
  7792           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7793           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7794                                                                     CL**2
  7795         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7796         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7797         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7798         16  CP-RATE-FILE          PIC X.                            CL**2
  7799         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7800                                     COMP-3.                         CL**2
  7801                                                                     CL**2
  7802         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7803         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7804                                                                     CL**2
  7805         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7806                                     COMP-3.
  7807         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7808                                   PIC S9(5)V99 COMP-3.
  7809         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7810                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7811         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7812                                     COMP-3.                         CL**2
  7813         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7814                                     COMP-3.
  7815         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7816                                  PIC S9(7)V99 COMP-3.
  7817                                                                     CL**2
  7818         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7819         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7820         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7821           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7822           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7823           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7824           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7825         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7826         16  CP-CARRIER            PIC X.                            CL**2
  7827         16  CP-REIN-FLAG          PIC X.                            CL**2
  7828         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7829           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7830                      '2' '3' '4' '5'.                               CL**2
  7831           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7832           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7833           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7834           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7835           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7836           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7837           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7838           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7839         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7840         16  CP-RATING-METHOD      PIC X.                            CL**2
  7841           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7842           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7843           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7844           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7845           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7846           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7847           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7848           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7849           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7850         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7851                                     COMP-3.                         CL**2
  7852         16  CP-BEN-CATEGORY       PIC X.
  7853         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7854         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7855                                   PIC S99V9(5) COMP-3.
  7856         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7857         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7858                                   PIC S99V9(5) COMP-3.
  7859         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7860         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7861         16  CP-EXPIRE-DT          PIC XX.
  7862         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7863         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7864         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7865         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7866         16  CP-DDF-SPEC-CALC      PIC X.
  7867             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7868             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7869         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7870         16  CP-CANCEL-REASON      PIC X.
  7871         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7872         16  CP-PMT-MODE           PIC X.
  7873         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7874         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7875         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7876         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7877         16  FILLER                PIC X.
  7878                                                                     CL**2
  7879***************    OUTPUT FROM ELRESV   ************************     CL**2
  7880                                                                     CL**2
  7881         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7882                                                                     CL**2
  7883         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7884                                     COMP-3.                         CL**2
  7885         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7886                                     COMP-3.                         CL**2
  7887         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7888                                     COMP-3.                         CL**2
  7889         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7890                                     COMP-3.                         CL**2
  7891         16  FILLER                PIC X(09).                        CL**2
  7892***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7893                                                                     CL**2
  7894         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7895                                     COMP-3.                         CL**2
  7896         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7897                                     COMP-3.                         CL**2
  7898         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7899                                     COMP-3.                         CL**2
  7900         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7901                                     COMP-3.                         CL**2
  7902         16  FILLER                PIC X(12).                        CL**2
  7903                                                                     CL**2
  7904***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7905                                                                     CL**2
  7906         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7907                                     COMP-3.                         CL**2
  7908         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7909                                     COMP-3.                         CL**2
  7910         16  FILLER                PIC X(12).                        CL**2
  7911                                                                     CL**2
  7912***************    OUTPUT FROM ELRATE   *************************    CL**2
  7913                                                                     CL**2
  7914         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7915                                     COMP-3.                         CL**2
  7916         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7917                                     COMP-3.                         CL**2
  7918         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7919         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7920             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7921         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7922                                     COMP-3.                         CL**2
  7923         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7924         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7925         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7926                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 145
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7927         16  FILLER                PIC X(07).                        CL**2
  7928                                                                     CL**2
  7929***************    OUTPUT FROM ELRFND   *************************    CL**2
  7930                                                                     CL**2
  7931         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7932                                     COMP-3.                         CL**2
  7933         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7934           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7935           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7936           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7937           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7938           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7939           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7940           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7941           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7942           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7943           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7944           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7945           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7946           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7947           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7948         16  FILLER                PIC X(12).                        CL**2
  7949                                                                     CL**2
  7950***************    OUTPUT FROM ELEARN   *************************    CL**2
  7951                                                                     CL**2
  7952         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7953                                     COMP-3.                         CL**2
  7954         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7955                                     COMP-3.                         CL**2
  7956         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7957                                     COMP-3.                         CL**2
  7958         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7959                                     COMP-3.                         CL**2
  7960         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7961                                     COMP-3.                         CL**2
  7962         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7963                                     COMP-3.                         CL**2
  7964         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7965           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7966           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7967           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7968           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7969           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7970           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7971           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7972           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7973           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7974         16  FILLER                PIC X(12).                        CL**2
  7975                                                                     CL**2
  7976***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7977                                                                     CL**2
  7978         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7979                                     COMP-3.                         CL**2
  7980         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7981                                     COMP-3.                         CL**2
  7982         16  FILLER                PIC X(12).                        CL**2
  7983                                                                     CL**2
  7984***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 146
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7985         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7986                                     COMP-3.                         CL**2
  7987         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7988                                     COMP-3.                         CL**2
  7989         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7990                                     COMP-3.                         CL**2
  7991         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7992                                     COMP-3.                         CL**2
  7993         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7994                                     COMP-3.                         CL**2
  7995         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7996                                     COMP-3.                         CL**2
  7997         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7998             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7999             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  8000             88  IO-ERROR                         VALUE 'E'.         CL**2
  8001                                                                     CL**2
  8002         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  8003                                                                     CL**2
  8004         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  8005                                                                     CL**2
  8006         16  CP-RESERVE-REMAINING-TERM                               CL**2
  8007                                   PIC S9(4)V9    VALUE ZERO         CL**2
  8008                                     COMP-3.                         CL**2
  8009                                                                     CL**2
  8010         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  8011                                                                     CL**2
  8012         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  8013                                     COMP-3.                         CL**2
  8014                                                                     CL**2
  8015         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  8016                                     COMP-3.                         CL**2
  8017                                                                     CL**2
  8018         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  8019                                     COMP-3.                         CL**2
  8020                                                                     CL**2
  8021         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  8022                                     COMP-3.                         CL**2
  8023                                                                     CL**2
  8024         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  8025                                     COMP-3.                         CL**2
  8026                                                                     CL**2
  8027         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  8028                                     COMP-3.                         CL**2
  8029                                                                     CL**2
  8030         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  8031                                     COMP-3.                         CL**2
  8032                                                                     CL**2
  8033         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  8034             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  8035                                                                     CL**2
  8036         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  8037                                     COMP-3.                         CL**2
  8038         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  8039                                     COMP-3.
  8040         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  8041         16  FILLER                PIC X(15).                        CL**2
  8042******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 147
* EL517.cbl
  8043
* 8044                                  COPY ELCDTECX.
  8045******************************************************************06/05/98
  8046*                                                                *ELCDTECX
  8047*                            ELCDTECX.                           *   LV005
  8048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8049*                            VMOD=2.015                          *ELCDTECX
  8050*                                                                *ELCDTECX
  8051*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  8052*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  8053*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  8054*                                                                *ELCDTECX
  8055******************************************************************ELCDTECX
  8056******************************************************************
  8057*                   C H A N G E   L O G
  8058*
  8059* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8060*-----------------------------------------------------------------
  8061*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8062* EFFECTIVE    NUMBER
  8063*-----------------------------------------------------------------
  8064* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  8065*                                  BENEFIT CODES FROM 300 TO 900
  8066* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  8067* 051304    2003080800002  SMVA  ADD REFUND METHOD
  8068******************************************************************
  8069 01  DATE-CARD.                                                   ELCDTECX
  8070     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  8071     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  8072     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  8073     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  8074     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  8075     12  EP-SW                       PIC  X.                      ELCDTECX
  8076         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  8077     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  8078         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  8079     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  8080     12  RUN-CENTURY.                                             ELCDTECX
  8081         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8082     12  FILLER                      PIC  X.                         CL**4
  8083     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8084     12  FILLER                      PIC  XXX.                    ELCDTECX
  8085     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8086                                                                  ELCDTECX
  8087 01  FILLER                          PIC  X(7)                       CL**6
  8088                                          VALUE 'OPTIONS'.        ELCDTECX
  8089 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8090     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8091     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8092     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8093         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8094         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8095     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8096     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8097     12  FILLER                      PIC  X.                      ELCDTECX
  8098     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8099     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8100     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8101     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8102     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8103     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8104     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8105     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8106     12  FILLER                      PIC  X.                      ELCDTECX
  8107     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8108     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8109     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8110     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8111     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8112     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8113     12  FILLER                      PIC  X.                      ELCDTECX
  8114     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8115     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8116     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8117     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8118     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8119     12  DTE-R78                     PIC  X.                      ELCDTECX
  8120     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8121     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8122     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8123     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8124     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8125     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8126     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8127                                     PIC  X.                      ELCDTECX
  8128         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8129                                                 ' '.             ELCDTECX
  8130         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8131         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8132     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8133         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8134         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8135     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8136     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8137                                     PIC  9.                         CL**4
  8138     12  DTE-SYSTEM.                                              ELCDTECX
  8139         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8140         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8141         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8142         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8143         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8144         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8145         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8146         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8147         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8148         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8149         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8150         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8151         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8152         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8153         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8154         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8155         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8156         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8157         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8158         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8159         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8160         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8161         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8162         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8163         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8164         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8165     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8166         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8167                                     PIC  X.                      ELCDTECX
  8168     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8169                                                                  ELCDTECX
  8170 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8171     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8172     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8173     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8174*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8175     12  FILLER                      PIC  X.                      ELCDTECX
  8176     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8177     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8178     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8179     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8180     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8181     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8182     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8183                                                                  ELCDTECX
  8184     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8185     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8186     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8187     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8188                                                                  ELCDTECX
  8189     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8190     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8191     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8192     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8193                                                                  ELCDTECX
  8194     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8195     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8196                                                                  ELCDTECX
  8197     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8198     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8199                                                                  ELCDTECX
  8200     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8201                                                                  ELCDTECX
  8202 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8203     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8204     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8205     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8206     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8207     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8208     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8209     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8210                                                                  ELCDTECX
  8211 01  FILLER                          PIC  X(12)                   ELCDTECX
  8212                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8213 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8214     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8215         16  CNT-ID                  PIC  X.                      ELCDTECX
  8216         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8217                                                                  ELCDTECX
  8218 01  FILLER                          PIC  X(11)                   ELCDTECX
  8219                                          VALUE 'STATE NAMES'.    ELCDTECX
  8220 01  STATE-NAMES.                                                 ELCDTECX
  8221     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8222         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8223         16  STATE-PIC1.                                          ELCDTECX
  8224             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8225             20  FILLER              PIC  XXX.                    ELCDTECX
  8226             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8227             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8228             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8229             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8230                                                                  ELCDTECX
  8231 01  FILLER                          PIC  X(13)                   ELCDTECX
  8232                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8233 01  CARRIER-NAMES.                                               ELCDTECX
  8234     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8235         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8236         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8237         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8238         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8239         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8240         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8241*        16  FILLER                  PIC  X.                      ELCDTECX
  8242         16  CARRIER-SEC-PAY         PIC  X.
  8243             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8244                                                                  ELCDTECX
  8245 01  FILLER                          PIC  X(9)                       CL**6
  8246                                          VALUE 'INS TYPES'.      ELCDTECX
  8247 01  CLAS-INS-TYPES.                                              ELCDTECX
  8248*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8249     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8250         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8251         16  CLAS-I-AB3.                                          ELCDTECX
  8252             20  FILLER              PIC  X.                      ELCDTECX
  8253             20  CLAS-I-AB2.                                      ELCDTECX
  8254                 24  FILLER          PIC  X.                      ELCDTECX
  8255                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8256         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8257             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8258             20  FILLER              PIC  X.                         CL**4
  8259         16  CLAS-I-AB10.                                         ELCDTECX
  8260             20  FILLER              PIC  X(9).                   ELCDTECX
  8261             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8262         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8263         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8264         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8265         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8266             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8267         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8268         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8269         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8270         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8271         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8272         16  FILLER                  PIC  X(05).
  8273                                                                  ELCDTECX
  8274 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8275                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8276 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8277     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8278                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8279         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8280         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8281         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8282         16  CLAS-MORT-DESC.                                      ELCDTECX
  8283             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8284             20  FILLER              PIC  XX.                        CL**5
  8285             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8286             20  FILLER              PIC  X.                         CL**5
  8287             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8288             20  FILLER              PIC  X.                         CL**5
  8289             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8290             20  FILLER              PIC  X.                         CL**5
  8291             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8292             20  FILLER              PIC  X(5).                      CL**6
  8293                                                                  ELCDTECX
  8294 01  FILLER                          PIC  X(15)                   ELCDTECX
  8295                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8296 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8297     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8298         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8299         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8300         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8301         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8302         16  FILLER                  PIC  X(4).                      CL**6
  8303                                                                  ELCDTECX
  8304 01  FILLER                          PIC  X(7)                       CL**6
  8305                                     VALUE 'INDEXES'.             ELCDTECX
  8306 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8307     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8308     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8309     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8310     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8311     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8312     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8313     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8314     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8315     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8316     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8317     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8318     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8319     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8320     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8321     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8322     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8323     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8324                                                                  ELCDTECX
  8325 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8326     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8327     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8328     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8329     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8330     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8331     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8332     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8333     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8334     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8335     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8336     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8337                                                                  ELCDTECX
  8338 01  FILLER                          PIC  X(13)                   ELCDTECX
  8339                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8340 01  CLAS-MISC.                                                   ELCDTECX
  8341     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8342         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8343         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8344         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8345     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8346     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8347     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8348     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8349     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8350     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8351     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8352     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8353     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8354     12  STATE-L                     PIC  XX.                     ELCDTECX
  8355     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8356     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8357     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8358         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8359         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8360     12  DTE-ABEND-WORK.                                          ELCDTECX
  8361         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8362         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8363                                                                  ELCDTECX
  8364 01  FILLER                          PIC  X(12)                   ELCDTECX
  8365                                     VALUE 'WORKING DATE'.        ELCDTECX
  8366 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8367     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8368         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8369         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8370         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8371     12  WS-CURRENT-DATE.                                         ELCDTECX
  8372         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8373         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8374         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8375         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8376         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8377     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8378         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8379         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8380                                                                  ELCDTECX
  8381 01  FILLER                          PIC  X(12)                   ELCDTECX
  8382                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8383 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8384     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8385         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8386         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8387         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8388                                                                  ELCDTECX
  8389 01  FILLER                          PIC  X(10)                   ELCDTECX
  8390                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8391 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8392     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8393         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8394         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8395                                                                  ELCDTECX
  8396 01  FILLER                          PIC  X(13)                   ELCDTECX
  8397                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8398 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8399     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8400         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8401                                                                  ELCDTECX
  8402 01  FILLER                          PIC  X(13)                   ELCDTECX
  8403                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8404 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8405     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8406     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8407     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8408                                     PIC  X.                         CL**5
  8409     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8410     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8411     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8412     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8413     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8414     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8415     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8416     12  FILLER                      PIC  X(75).                  ELCDTECX
  8417******************************************************************ELCDTECX
  8418*01  MISC-CARR-PCT-DATA.                                          00001521
  8419*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8420*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8421*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8422*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8423*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8424*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8425******************************************************************ELCDTECX
  8426
* 8427                                  COPY ELCDTEVR.
  8428***************************************************************** 04/15/98
  8429*                                                                *ELCDTEVR
  8430*                                                                *ELCDTEVR
  8431*                            ELCDTEVR.                           *   LV003
  8432*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8433*                            VMOD=2.001                          *   CL**2
  8434*                                                                *ELCDTEVR
  8435*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8436*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8437*                                                                *ELCDTEVR
  8438******************************************************************ELCDTEVR
  8439 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8440     05  WS-RUN-DATE.                                             ELCDTEVR
  8441         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8442         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8443         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8444             15  RUN-CC              PIC  99.                     ELCDTEVR
  8445             15  RUN-YR              PIC  99.                     ELCDTEVR
  8446         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8447         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8448     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8449            WS-RUN-DATE              PIC 9(11).                      CL**2
  8450     05  WS-EP-DT.                                                ELCDTEVR
  8451         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8452         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8453         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8454             15  EP-CC               PIC  99.                     ELCDTEVR
  8455             15  EP-YR               PIC  99.                     ELCDTEVR
  8456         10  EP-MO                   PIC  99.                     ELCDTEVR
  8457         10  EP-DA                   PIC  99.                     ELCDTEVR
  8458     05  WS-EP-DT-N REDEFINES                                        CL**2
  8459            WS-EP-DT                 PIC 9(11).                      CL**2
  8460     05  WS-DTE-CONV-DT.                                             CL**4
  8461         10  FILLER                  PIC  9(03).                     CL**4
  8462         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8463         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8464             15  DTE-CONV-CC         PIC  99.                        CL**4
  8465             15  DTE-CONV-YR         PIC  99.                        CL**4
  8466         10  DTE-CONV-MO             PIC  99.                        CL**4
  8467         10  DTE-CONV-DA             PIC  99.                        CL**4
  8468     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8469            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8470 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8471     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8472         10  FILLER                            PIC 999.           ELCDTEVR
  8473         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8474         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8475             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8476             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8477         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8478         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8479     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8480            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8481     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8482         10  FILLER                            PIC 999.           ELCDTEVR
  8483         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8484         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8485         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8486         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8487     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8488            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8489 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8490     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8491         10  FILLER                            PIC 999.           ELCDTEVR
  8492         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8493         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8494             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8495             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8496         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8497         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8498     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8499            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8500     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8501         10  FILLER                            PIC 999.           ELCDTEVR
  8502         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8503         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8504             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8505             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8506         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8507         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8508     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8509            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8510     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8511         10  FILLER                            PIC 999.           ELCDTEVR
  8512         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8513         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8514             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8515             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8516         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8517         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8518     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8519            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8520 01  WS-RATE-RECORD.                                              ELCDTEVR
  8521         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8522             10  FILLER                        PIC 999.           ELCDTEVR
  8523             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8524             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8525                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8526                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8527             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8528             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8529         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8530                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8531
* 8532                                  COPY ELCREINV.
  8533******************************************************************04/18/98
  8534*                                                                *ELCREINV
  8535*                                                                *ELCREINV
  8536*                            ELCREINV                            *   LV003
  8537*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8538*                            VMOD=2.001                          *ELCREINV
  8539*                                                                *ELCREINV
  8540*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8541*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8542*                                                                *ELCREINV
  8543******************************************************************ELCREINV
  8544                                                                  ELCREINV
  8545 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8546     05  WS-RE-LO-DATE.                                              CL**3
  8547         10 FILLER                     PIC 999.                      CL**3
  8548         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8549         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8550            15 RE-LO-CC                PIC 99.                       CL**3
  8551            15 RE-LO-YR                PIC 99.                       CL**3
  8552         10 RE-LO-MO                   PIC 99.                       CL**3
  8553         10 RE-LO-DA                   PIC 99.                       CL**3
  8554     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8555            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8556     05  WS-RE-HI-DATE.                                              CL**3
  8557         10 FILLER                     PIC 999.                      CL**3
  8558         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8559         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8560            15 RE-HI-CC                PIC 99.                       CL**3
  8561            15 RE-HI-YR                PIC 99.                       CL**3
  8562         10 RE-HI-MO                   PIC 99.                       CL**3
  8563         10 RE-HI-DA                   PIC 99.                       CL**3
  8564     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8565            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8566     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8567         10 FILLER                     PIC 999.                   ELCREINV
  8568         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8569         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8570            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8571            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8572         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8573         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8574     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8575            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8576     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8577         10  FILLER                    PIC 999.                   ELCREINV
  8578         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8579         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8580             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8581             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8582         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8583         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8584     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8585            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8586     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8587         10  FILLER                    PIC 999.                   ELCREINV
  8588         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8589         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8590             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8591             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8592         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8593         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8594     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8595            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8596
* 8597                                  COPY ELCACCTV.
  8598******************************************************************04/14/98
  8599*                                                                *ELCACCTV
  8600*                            ELCACCTV                            *   LV002
  8601*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8602*                            VMOD=2.001                          *ELCACCTV
  8603*                                                                *ELCACCTV
  8604*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8605*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8606*                                                                *ELCACCTV
  8607*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8608*                                                                *ELCACCTV
  8609******************************************************************ELCACCTV
  8610                                                                  ELCACCTV
  8611 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8612                                                                  ELCACCTV
  8613     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8614         10  FILLER            PIC 999.                           ELCACCTV
  8615         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8616         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8617             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8618             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8619         10  AM-EXP-MO         PIC 99.                               CL**5
  8620         10  AM-EXP-DA         PIC 99.                               CL**5
  8621     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8622            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 157
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8623     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8624         10  FILLER                    PIC 999.                   ELCACCTV
  8625         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8626         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8627             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8628             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8629         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8630         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8631     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8632            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8633     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8634         10  FILLER                    PIC 999.                   ELCACCTV
  8635         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8636         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8637             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8638             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8639         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8640         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8641     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8642            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8643     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8644         10 FILLER                     PIC 999.                   ELCACCTV
  8645         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8646         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8647            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8648            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8649         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8650         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8651     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8652            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8653     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8654         10 FILLER                     PIC 999.                   ELCACCTV
  8655         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8656         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8657            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8658            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8659         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8660         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8661     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8662            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8663     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8664         10  FILLER                    PIC 999.                   ELCACCTV
  8665         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8666         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8667             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8668             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8669         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8670         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8671     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8672            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8673     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8674         10  FILLER                    PIC 999.                   ELCACCTV
  8675         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8676         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8677             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8678             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8679         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8680         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 158
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8681     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8682            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8683     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8684         10  FILLER                    PIC 999.                   ELCACCTV
  8685         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8686         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8687             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8688             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8689         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8690         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8691     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8692            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8693     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8694         10  FILLER                    PIC 999.                   ELCACCTV
  8695         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8696         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8697             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8698             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8699         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8700         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8701     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8702            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 159
* EL517.cbl
* 8704                                  COPY ELCDIFRD.
  8705******************************************************************04/15/98
  8706*                                                                *ELCDIFRD
  8707*                                                                *ELCDIFRD
  8708*                            ELCDIFRD.                           *   LV003
  8709*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8710*                            VMOD=2.004                          *   CL**3
  8711*                                                                *ELCDIFRD
  8712*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8713*                                                                *ELCDIFRD
  8714******************************************************************ELCDIFRD
  8715*                                                                 ELCDIFRD
  8716  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8717        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8718        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8719        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8720        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8721        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8722        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8723        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8724        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8725        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8726        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8727        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 160
* EL517.cbl
* 8729                                  COPY ELCERRWS.
  8730******************************************************************04/15/98
  8731*                                                                *ELCERRWS
  8732*                                                                *ELCERRWS
  8733*                            ELCERRWS                            *   LV002
  8734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8735*                            VMOD=2.005                          *   CL**2
  8736*                                                                *ELCERRWS
  8737*                                                                *ELCERRWS
  8738*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8739*                                                                *ELCERRWS
  8740******************************************************************ELCERRWS
  8741                                                                  ELCERRWS
  8742 01  W-ERROR-WORK.                                                ELCERRWS
  8743     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8744     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8745     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8746     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8747     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8748     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8749     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8750     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8751     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8752     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8753     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8754     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8755     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8756     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8757     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8758     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8759     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8760                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 161
* EL517.cbl
  8762
  8763 PROCEDURE DIVISION.
  8764
  8765 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8766******************************************************************04/15/98
  8767*                                                                *ELCDTERX
  8768*                                                                *ELCDTERX
  8769*                            ELCDTERX.                           *   LV002
  8770*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8771*                            VMOD=2.007                          *ELCDTERX
  8772*                                                                *ELCDTERX
  8773*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8774*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8775*      = ELCDTEFD)                                               *ELCDTERX
  8776*                                                                *ELCDTERX
  8777******************************************************************ELCDTERX
  8778                                                                  ELCDTERX
  8779     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8780                                                                  ELCDTERX
  8781     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8782     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8783     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8784                                                                  ELCDTERX
  8785     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8786                                                                  ELCDTERX
  8787******************************************************************ELCDTERX
  8788*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8789*          WARNING MESSAGES.                                      ELCDTERX
  8790******************************************************************ELCDTERX
  8791     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8792         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8793                                                                  ELCDTERX
  8794     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8795                                                                  ELCDTERX
  8796     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8797                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8798                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8799                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8800                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8801                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8802                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8803                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8804                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8805                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8806                                                                  ELCDTERX
  8807     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8808                                                                  ELCDTERX
  8809     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8810                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8811                                                                  ELCDTERX
  8812     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8813     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8814     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8815     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8816                                                                  ELCDTERX
  8817     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8818         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8819     ELSE                                                         ELCDTERX
  8820         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8821                                                                  ELCDTERX
  8822     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8823         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8824     ELSE                                                         ELCDTERX
  8825         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8826                                                                  ELCDTERX
  8827 0005-READ--CARD.                                                 ELCDTERX
  8828     READ DISK-DATE                                               ELCDTERX
  8829         AT END CLOSE DISK-DATE                                   ELCDTERX
  8830             GO TO 0060-READ--TEST.                               ELCDTERX
  8831                                                                  ELCDTERX
  8832     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8833                                                                  ELCDTERX
  8834     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8835         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8836         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8837         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8838         GO TO 0005-READ--CARD.                                   ELCDTERX
  8839                                                                  ELCDTERX
  8840     IF DD-ID = 'CLAD'                                            ELCDTERX
  8841         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8842         GO TO 0005-READ--CARD.                                   ELCDTERX
  8843                                                                  ELCDTERX
  8844     IF DD-ID = 'CLAX'                                            ELCDTERX
  8845         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8846         GO TO 0005-READ--CARD.                                   ELCDTERX
  8847                                                                  ELCDTERX
  8848     IF DD-ID = 'CLAF'                                            ELCDTERX
  8849         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8850         GO TO 0005-READ--CARD.                                   ELCDTERX
  8851                                                                  ELCDTERX
  8852     IF DD-ID = 'CLAC'                                            ELCDTERX
  8853         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8854                                                                  ELCDTERX
  8855     IF DD-ID = 'CARR'                                            ELCDTERX
  8856         GO TO 0015-READ--CARR.                                   ELCDTERX
  8857                                                                  ELCDTERX
  8858     IF DD-ID = 'STAT'                                            ELCDTERX
  8859         GO TO 0020-READ--STAT.                                   ELCDTERX
  8860                                                                  ELCDTERX
  8861     IF DD-ID = 'BUSC'                                            ELCDTERX
  8862         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8863                                                                  ELCDTERX
  8864     IF DD-ID = 'MORT'                                            ELCDTERX
  8865         GO TO 0030-READ--MORT.                                   ELCDTERX
  8866                                                                  ELCDTERX
  8867     IF DD-ID = 'CLAI'                                            ELCDTERX
  8868         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8869                                                                  ELCDTERX
  8870     IF DD-ID = 'COLC'                                            ELCDTERX
  8871         GO TO 0065-READ--COLC.                                   ELCDTERX
  8872                                                                  ELCDTERX
  8873     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8874        DD-IDA = 'CL'                                             ELCDTERX
  8875         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8876                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8877     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8878        DD-IDA = 'PO'                                             ELCDTERX
  8879         GO TO 0050-READ--POXX.                                   ELCDTERX
  8880                                                                  ELCDTERX
  8881     IF DD-ID = 'OPCA'                                            ELCDTERX
  8882         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8883                                                                  ELCDTERX
  8884     IF DD-ID = 'OPST'                                            ELCDTERX
  8885         GO TO 0072-READ--OPST.                                   ELCDTERX
  8886                                                                  ELCDTERX
  8887     IF DD-ID = 'OPBS'                                            ELCDTERX
  8888         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8889                                                                  ELCDTERX
  8890     IF DD-ID = 'OPMS'                                            ELCDTERX
  8891         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8892                                                                  ELCDTERX
  8893     GO TO 0005-READ--CARD.                                       ELCDTERX
  8894                                                                  ELCDTERX
  8895 0010-READ--CLAC.                                                 ELCDTERX
  8896     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8897     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8898     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8899     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8900     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8901     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8902     GO TO 0005-READ--CARD.                                       ELCDTERX
  8903                                                                  ELCDTERX
  8904 0015-READ--CARR.                                                 ELCDTERX
  8905     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8906     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8907        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8908        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8909        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8910        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8911        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8912        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8913        MOVE DD-CARR1-SECPAY-SW
  8914                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8915     END-IF
  8916                                                                  ELCDTERX
  8917     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8918     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8919        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8920        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8921        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8922        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8923        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8924        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8925        MOVE DD-CARR2-SECPAY-SW
  8926                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8927     END-IF
  8928                                                                  ELCDTERX
  8929                                                                  ELCDTERX
  8930     GO TO 0005-READ--CARD.                                       ELCDTERX
  8931                                                                  ELCDTERX
  8932 0020-READ--STAT.                                                 ELCDTERX
  8933     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8934     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8935        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8936         GO TO 0005-READ--CARD.                                   ELCDTERX
  8937                                                                  ELCDTERX
  8938     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8939     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8940     GO TO 0020-READ--STAT.                                       ELCDTERX
  8941                                                                  ELCDTERX
  8942 0025-READ--BUSC.                                                 ELCDTERX
  8943     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8944     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8945        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8946         GO TO 0005-READ--CARD.                                   ELCDTERX
  8947                                                                  ELCDTERX
  8948     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8949     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8950     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8951                                                                  ELCDTERX
  8952 0030-READ--MORT.                                                 ELCDTERX
  8953     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8954     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8955        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8956         GO TO 0005-READ--CARD.                                   ELCDTERX
  8957                                                                  ELCDTERX
  8958     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8959     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8960     GO TO 0030-READ--MORT.                                       ELCDTERX
  8961                                                                  ELCDTERX
  8962 0035-READ--CLXX.                                                 ELCDTERX
  8963     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8964          GO TO 0005-READ--CARD.                                  ELCDTERX
  8965                                                                  ELCDTERX
  8966     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8967         DISPLAY '***********************************************'ELCDTERX
  8968         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8969         DISPLAY '***********************************************'ELCDTERX
  8970         GO TO 0055-READ--STOP.                                   ELCDTERX
  8971                                                                  ELCDTERX
  8972     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8973        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8974         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8975                                                                  ELCDTERX
  8976     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8977        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8978         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8979                                                                  ELCDTERX
  8980*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8981     GO TO 0005-READ--CARD.                                       ELCDTERX
  8982                                                                  ELCDTERX
  8983 0040-READ--CLAI.                                                 ELCDTERX
  8984     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8985     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8986        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8987         GO TO 0005-READ--CARD.                                   ELCDTERX
  8988                                                                  ELCDTERX
  8989     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8990     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8991     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8992                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 165
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8993 0045-READ--DUMP.                                                 ELCDTERX
  8994     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8995     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8996                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8997     PERFORM ABEND-PGM.                                           ELCDTERX
  8998                                                                  ELCDTERX
  8999 0050-READ--POXX.                                                 ELCDTERX
  9000     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  9001         GO TO 0005-READ--CARD.                                   ELCDTERX
  9002                                                                  ELCDTERX
  9003     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  9004         DISPLAY '***********************************************'ELCDTERX
  9005         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  9006         DISPLAY '***********************************************'ELCDTERX
  9007         GO TO 0055-READ--STOP.                                   ELCDTERX
  9008                                                                  ELCDTERX
  9009     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  9010     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  9011     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  9012     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  9013                                                                  ELCDTERX
  9014     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  9015         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  9016     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  9017         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  9018                                                                  ELCDTERX
  9019     GO TO 0005-READ--CARD.                                       ELCDTERX
  9020                                                                  ELCDTERX
  9021 0055-READ--STOP.                                                 ELCDTERX
  9022     GOBACK.                                                      ELCDTERX
  9023                                                                  ELCDTERX
  9024 0060-READ--TEST.                                                 ELCDTERX
  9025     IF DATX-COD        = SPACE  OR                               ELCDTERX
  9026        CLAX-ID         = SPACE  OR                               ELCDTERX
  9027        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  9028         GO TO 0045-READ--DUMP.                                   ELCDTERX
  9029                                                                  ELCDTERX
  9030     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  9031     GO TO 0079-READ--EXIT.                                       ELCDTERX
  9032                                                                  ELCDTERX
  9033 0065-READ--COLC.                                                 ELCDTERX
  9034     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  9035     GO TO 0005-READ--CARD.                                       ELCDTERX
  9036                                                                  ELCDTERX
  9037 0070-READ--OPCA.                                                 ELCDTERX
  9038                                                                  ELCDTERX
  9039     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9040                                                                  ELCDTERX
  9041     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  9042             OR                                                   ELCDTERX
  9043         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  9044         GO TO 0005-READ--CARD.                                   ELCDTERX
  9045                                                                  ELCDTERX
  9046     ADD 1                       TO INDEXCA.                      ELCDTERX
  9047     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  9048                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  9049     GO TO 0070-READ--OPCA.                                       ELCDTERX
  9050                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 166
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  9051 0072-READ--OPST.                                                 ELCDTERX
  9052                                                                  ELCDTERX
  9053     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9054                                                                  ELCDTERX
  9055     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  9056             OR                                                   ELCDTERX
  9057         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9058         GO TO 0005-READ--CARD.                                   ELCDTERX
  9059                                                                  ELCDTERX
  9060     ADD 1                       TO INDEXST.                      ELCDTERX
  9061     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  9062                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  9063     GO TO 0072-READ--OPST.                                       ELCDTERX
  9064                                                                  ELCDTERX
  9065 0074-READ--OPBS.                                                 ELCDTERX
  9066                                                                  ELCDTERX
  9067     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9068                                                                  ELCDTERX
  9069     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  9070             OR                                                   ELCDTERX
  9071         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9072         GO TO 0005-READ--CARD.                                   ELCDTERX
  9073                                                                  ELCDTERX
  9074     ADD 1                       TO INDEXBS.                      ELCDTERX
  9075     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  9076     GO TO 0074-READ--OPBS.                                       ELCDTERX
  9077                                                                  ELCDTERX
  9078 0079-READ--EXIT.                                                 ELCDTERX
  9079*    EXIT.                                                        ELCDTERX
  9080******************************************************************ELCDTERX
  9081
  9082     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9083
  9084     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9085     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9086     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9087
  9088     MOVE 4                      TO DC-OPTION-CODE.
  9089     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9090     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9091     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9092     MOVE WORK-AREAS             TO HOLD-WORK.
  9093
  9094     IF DTE-PRC-OPT = '2'
  9095         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9096
  9097     OPEN INPUT ELCNTL.
  9098     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9099         NEXT SENTENCE
  9100       ELSE
  9101         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9102         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9103         MOVE EMSG               TO WS-ABEND-MESSAGE
  9104         GO TO ABEND-PGM.
  9105
  9106     OPEN  I-O ERPNDB.
  9107     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9108         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 167
* EL517.cbl
  9109       ELSE
  9110         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9111         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9112         MOVE EMSG               TO WS-ABEND-MESSAGE
  9113         GO TO ABEND-PGM.
  9114
  9115     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9116     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9117
  9118     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9119
  9120     IF ERPNDB-FILE-STATUS NOT = '00'
  9121         GO TO 9999-DONE.
  9122
  9123     OPEN INPUT ERREIN.
  9124     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9125         NEXT SENTENCE
  9126       ELSE
  9127         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9128         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9129         MOVE EMSG               TO WS-ABEND-MESSAGE
  9130         GO TO ABEND-PGM.
  9131
  9132     IF DTE-CLIENT = 'DCC'
  9133        OPEN INPUT ERPDEF ELSTAT
  9134        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9135           CONTINUE
  9136        ELSE
  9137           MOVE ERPDEF-FILE-STATUS
  9138                                 TO WS-ABEND-FILE-STATUS
  9139           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9140           MOVE EMSG             TO WS-ABEND-MESSAGE
  9141           GO TO ABEND-PGM
  9142        END-IF
  9143        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9144           CONTINUE
  9145        ELSE
  9146           MOVE ELSTAT-FILE-STATUS
  9147                                 TO WS-ABEND-FILE-STATUS
  9148           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9149           MOVE EMSG             TO WS-ABEND-MESSAGE
  9150           GO TO ABEND-PGM
  9151        END-IF
  9152     END-IF
  9153
  9154     OPEN I-O   ELCERT.
  9155******************************************************************
  9156*                                                                *
  9157*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9158*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9159*                                                                *
  9160*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9161*                                                                *
  9162*               EL631 - EL6311 - EL6312 - EL6313                 *
  9163*                                                                *
  9164******************************************************************
  9165
  9166     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 168
* EL517.cbl
  9167         NEXT SENTENCE
  9168       ELSE
  9169         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9170         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9171         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9172         GO TO ABEND-PGM.
  9173
  9174     OPEN INPUT ERCTBL.
  9175     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9176         NEXT SENTENCE
  9177       ELSE
  9178         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9179         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9180         MOVE EMSG               TO WS-ABEND-MESSAGE
  9181         GO TO ABEND-PGM.
  9182
  9183     OPEN INPUT ERACCT.
  9184     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9185         NEXT SENTENCE
  9186       ELSE
  9187         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9188         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9189         MOVE EMSG               TO WS-ABEND-MESSAGE
  9190         GO TO ABEND-PGM.
  9191
  9192     OPEN INPUT ERCOMP.
  9193     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9194         NEXT SENTENCE
  9195       ELSE
  9196         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9197         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9198         MOVE EMSG               TO WS-ABEND-MESSAGE
  9199         GO TO ABEND-PGM.
  9200
  9201     OPEN INPUT ERLOFC
  9202     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9203        CONTINUE
  9204     ELSE
  9205        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9206        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9207        MOVE EMSG                TO WS-ABEND-MESSAGE
  9208        GO TO ABEND-PGM
  9209     END-IF
  9210
  9211     OPEN INPUT ERBXRF.
  9212     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9213         NEXT SENTENCE
  9214       ELSE
  9215         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9216         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9217         MOVE EMSG               TO WS-ABEND-MESSAGE
  9218         GO TO ABEND-PGM.
  9219
  9220     OPEN INPUT ERAGTC.
  9221     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9222         NEXT SENTENCE
  9223       ELSE
  9224         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 169
* EL517.cbl
  9225         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9226         MOVE EMSG               TO WS-ABEND-MESSAGE
  9227         GO TO ABEND-PGM.
  9228
  9229     OPEN INPUT ERPLAN.
  9230     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9231        NEXT SENTENCE
  9232     ELSE
  9233        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9234        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9235        MOVE EMSG                TO WS-ABEND-MESSAGE
  9236        GO TO ABEND-PGM.
  9237
  9238     OPEN INPUT ERFORM.
  9239     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9240        OR '9%'
  9241        NEXT SENTENCE
  9242     ELSE
  9243        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9244        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9245        MOVE EMSG                TO WS-ABEND-MESSAGE
  9246        GO TO ABEND-PGM.
  9247
  9248     OPEN INPUT ELCERR.
  9249     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9250         NEXT SENTENCE
  9251       ELSE
  9252         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9253         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9254         MOVE EMSG               TO WS-ABEND-MESSAGE
  9255         GO TO ABEND-PGM.
  9256
  9257     MOVE 'R'                     TO CP-RATE-FILE.
  9258     MOVE 'O'                     TO CP-IO-FUNCTION.
  9259     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9260
  9261     IF IO-ERROR
  9262        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9263        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9264        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9265        GO TO ABEND-PGM.
  9266
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 170
* EL517.cbl
  9268*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9269*
  9270     IF DTE-CLIENT NOT = 'DMD'
  9271         GO TO 0100-READ-PENDING.
  9272
  9273     OPEN INPUT ERRESS ERRESC.
  9274
  9275     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9276         NEXT SENTENCE
  9277     ELSE
  9278         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9279         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9280         MOVE EMSG               TO WS-ABEND-MESSAGE
  9281         GO TO ABEND-PGM.
  9282
  9283     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9284         NEXT SENTENCE
  9285     ELSE
  9286         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9287         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9288         MOVE EMSG               TO WS-ABEND-MESSAGE
  9289         GO TO ABEND-PGM.
  9290
  9291     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9292     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9293     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9294     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9295         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9296         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9297         MOVE EMSG               TO WS-ABEND-MESSAGE
  9298         GO TO ABEND-PGM.
  9299
  9300     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9301     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9302     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9303     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9304         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9305         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9306         MOVE EMSG               TO WS-ABEND-MESSAGE
  9307         GO TO ABEND-PGM.
  9308
  9309     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9310     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9311     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9312     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9313         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9314         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9315         MOVE EMSG               TO WS-ABEND-MESSAGE
  9316         GO TO ABEND-PGM.
  9317
  9318     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9319     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9320     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9321     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9322         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9323         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9324         MOVE EMSG               TO WS-ABEND-MESSAGE
  9325         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 171
* EL517.cbl
  9326
  9327     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9328     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9329     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9330     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9331         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9332         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9333         MOVE EMSG               TO WS-ABEND-MESSAGE
  9334         GO TO ABEND-PGM.
  9335
  9336     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9337     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9338     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9339     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9340         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9341         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9342         MOVE EMSG               TO WS-ABEND-MESSAGE
  9343         GO TO ABEND-PGM.
  9344
  9345     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9346     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9347     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9348     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9349         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9350         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9351         MOVE EMSG               TO WS-ABEND-MESSAGE
  9352         GO TO ABEND-PGM.
  9353
  9354*
  9355*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9356*
  9357 0100-READ-PENDING.
  9358
  9359     MOVE HOLD-WORK TO WORK-AREAS.
  9360
  9361     MOVE ZEROS                  TO EMI-WARNING-CTR
  9362                                    EMI-FORCABLE-CTR
  9363                                    EMI-FATAL-CTR.
  9364 0101-READ-PENDING.
  9365     READ ERPNDB.
  9366     ADD 1 TO RPND.
  9367
  9368     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9369         GO TO 9999-DONE.
  9370
  9371     IF ERPNDB-FILE-STATUS NOT = '00'
  9372         GO TO 9999-DONE.
  9373
  9374     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9375     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9376     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9377
  9378     IF PB-BATCH-TRAILER
  9379         GO TO 9999-REWRITE-RECORD.
  9380
  9381     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9382        GO TO 0100-READ-PENDING.
  9383
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 172
* EL517.cbl
  9384     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9385        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9386        GO TO 0100-READ-PENDING.
  9387
  9388     IF WK-BATCH-PREFIX = '#CL'
  9389        GO TO 0100-READ-PENDING.
  9390
  9391     IF DTE-PRC-OPT = '2'
  9392         NEXT SENTENCE
  9393     ELSE
  9394         IF NOT PB-FATAL-ERRORS
  9395             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9396             GO TO 0100-READ-PENDING.
  9397
  9398     ADD 1 TO TRAN-CT.
  9399
  9401 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 173
* EL517.cbl
*                           COPY ELC50PD.
  9402******************************************************************04/22/98
  9403*                                                                *ELC50PD
  9404*                            ELC50PD                             *   LV012
  9405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9406*                            VMOD=2.188                          *   CL**7
  9407*                                                                *ELC50PD
  9408******************************************************************
  9409*                   C H A N G E   L O G
  9410*
  9411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9412*-----------------------------------------------------------------
  9413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9414* EFFECTIVE    NUMBER
  9415*-----------------------------------------------------------------
  9416* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9417* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9418* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9419*                             2709 AND 2718
  9420* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9421* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9422* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9423* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9424* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9425*                                IS OPEN OR CNC DT < PD THRU
  9426* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9427* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9428* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9429* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9430* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9431* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9432* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9433* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9434* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9435* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9436* 020906                   PEMA  EXPAND LOAN OFFICER
  9437* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9438* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9439* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9440* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9441* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9442* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9443* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9444* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9445* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9446* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9447* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9448* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9449* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9450* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9451* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9452* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9453* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9454* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9455* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9456* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9457* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9458* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 174
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9459* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9460* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9461* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9462*                                UPDATE VIN ON CERT TRAILER
  9463* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9464* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9465* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9466* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9467* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9468* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9469* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9470* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9471* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9472* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9473* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9474* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9475* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9476* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9477* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9478* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9479* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9480* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9481* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9482* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9483* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9484* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9485* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9486* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9487* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9488* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9489* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9490* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9491* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9492* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9493* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9494* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9495* 032912  CR2011110200001  PEMA  AHL CHANGES
  9496* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9497* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9498* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9499* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9500* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  9501* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9502* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9503* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9504* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9505* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9506* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9507* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9508* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  9509* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  9510* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  9511* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  9512* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  9513* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  9514* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  9515* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  9516* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 175
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9517* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  9518* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  9519******************************************************************ELC50PD
  9520************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9521******************************************************************ELC50PD
  9522                                                                  ELC50PD
  9523     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9524                                                                  ELC50PD
  9525     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9526                                    PB-FORCE-ER-CD                ELC50PD
  9527                                    PB-WARN-ER-CD                 ELC50PD
  9528                                    PB-OUT-BAL-CD.                ELC50PD
  9529                                                                  ELC50PD
  9530     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9531                                    WS-IG-OVRD-LF                 ELC50PD
  9532                                    WS-IG-OVRD-AM                 ELC50PD
  9533                                    WS-IG-OVRD                    ELC50PD
  9534                                    WS-IG-OVRD-AH-PL              ELC50PD
  9535                                    WS-IG-OVRD-LF-PL              ELC50PD
  9536                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9537                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9538                                                                  ELC50PD
  9539******************************************************************ELC50PD
  9540*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9541******************************************************************ELC50PD
  9542                                                                  ELC50PD
  9543     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9544     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9545                                                                  ELC50PD
  9546******************************************************************ELC50PD
  9547                                                                  ELC50PD
  9548     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9549     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9550*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9551     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9552     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9553                                                                  ELC50PD
  9554     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9555                                                                  ELC50PD
  9556 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9557                                                                  ELC50PD
  9558     ADD +1                      TO  SUB4.                        ELC50PD
  9559                                                                  ELC50PD
  9560     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9561         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9562                                                                  ELC50PD
  9563     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9564         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9565                                                                  ELC50PD
  9566     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9567                                                                  ELC50PD
  9568 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9569                                                                  ELC50PD
  9570     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9571        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9572                                         WS-AH-REM-TERM-CALC      ELC50PD
  9573                                         EC-CO-REM-TERM-CALC      ELC50PD
  9574        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 176
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9575        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9576        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
  9577                                         WS-TOL-AH-CLAIM          ELC50PD
  9578        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9579                                         WS-TOL-AH-PREM           ELC50PD
  9580                                         EC-CO-TOL-PREM           ELC50PD
  9581        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9582                                         WS-TOL-AH-REFUND         ELC50PD
  9583                                         EC-CO-TOL-REFUND         ELC50PD
  9584        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9585                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9586                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9587        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9588                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9589                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9590        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9591                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9592                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9593        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9594                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9595                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9596        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9597        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9598        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9599        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9600        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9601        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9602        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9603        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9604        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9605        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9606        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9607        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9608                                         EC-CO-MONTH-END-DT       ELC50PD
  9609        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9610          GO TO 0100-READ-ACCT.                                   ELC50PD
  9611                                                                  ELC50PD
  9612     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9613     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9614     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9615     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9616                                                                  ELC50PD
  9617     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9618     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9619     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9620         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9621                                   WK-CO-TOL-CLAIM                ELC50PD
  9622                                   WK-CO-TOL-REFUND               ELC50PD
  9623                                   WK-REFUND-OVS-AMT              ELC50PD
  9624                                   WK-REFUND-OVS-PCT              ELC50PD
  9625                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9626                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9627                                   WK-DEFAULT-APR                 ELC50PD
  9628                                   WK-CO-MAX-CAP                  ELC50PD
  9629        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9630                                   WK-CR-R78-METHOD               ELC50PD
  9631                                   WK-CO-REF-REJECT-SW            ELC50PD
  9632                                   WK-CO-PREM-REJECT-SW           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 177
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9633                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9634                                   WK-BIRTH-DATE-INPUT            ELC50PD
  9635                                   WK-JOINT-AGE-INPUT             ELC50PD
  9636        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9637        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9638        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9639        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9640          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9641                                                                  ELC50PD
  9642     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9643        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9644     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9645        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9646     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9647        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9648     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9649        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9650                                                                  ELC50PD
  9651     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9652     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9653     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9654     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9655     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9656     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9657     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9658     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9659     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9660     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9661     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9662     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9663                                                                  ELC50PD
  9664     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9665          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9666        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9667                                                                  ELC50PD
  9668     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9669          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9670        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9671                                                                  ELC50PD
  9672     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9673         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9674     ELSE                                                         ELC50PD
  9675         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9676                                                                  ELC50PD
  9677     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9678     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9679     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9680     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9681                                                                  ELC50PD
  9682     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9683                                                                  ELC50PD
  9684 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9685                                                                  ELC50PD
  9686     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9687     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9688                                                                  ELC50PD
  9689 0100-READ-ACCT.                                                  ELC50PD
  9690                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 178
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9691     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9692                                                                  ELC50PD
  9693     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9694        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9695                                                                  ELC50PD
  9696     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9697     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9698     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9699                                                                  ELC50PD
  9700     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9701        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9702        GO TO 0105-READ-ACCT
  9703     END-IF
  9704                                                                  ELC50PD
  9705     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9706        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9707           GO TO 0105-READ-ACCT.                                  ELC50PD
  9708                                                                  ELC50PD
  9709     IF PB-STATE NOT = SPACES                                     ELC50PD
  9710        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9711           GO TO 0105-READ-ACCT.                                  ELC50PD
  9712                                                                  ELC50PD
  9713     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9714        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9715           GO TO 0105-READ-ACCT.                                  ELC50PD
  9716                                                                  ELC50PD
  9717     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9718                                                                  ELC50PD
  9719     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9720        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9721        GO TO 0105-READ-ACCT.                                     ELC50PD
  9722                                                                  ELC50PD
  9723     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9724        GO TO 0105-READ-ACCT.                                     ELC50PD
  9725                                                                  ELC50PD
  9726     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9727                                                                  ELC50PD
  9728 0102-ACCT-GETMAIN.                                               ELC50PD
  9729     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9730     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9731                                                                  ELC50PD
  9732 0105-READ-ACCT.                                                  ELC50PD
  9733     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9734     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9735     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9736     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9737     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9738     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9739                                                                  ELC50PD
  9740     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9741                                                                  ELC50PD
  9742     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9743                                                                  ELC50PD
  9744 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9745
  9746     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9747                                                                  ELC50PD
  9748     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 179
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9749        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9750        GO TO 0199-ACCT-NOT-FOUND
  9751     END-IF
  9752     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9753        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9754           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9755                                                                  ELC50PD
  9756     IF PB-STATE NOT = SPACES                                     ELC50PD
  9757        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9758           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9759                                                                  ELC50PD
  9760     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9761        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9762           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9763                                                                  ELC50PD
  9764     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9765                                                                  ELC50PD
  9766     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9767        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9768        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9769                                                                  ELC50PD
  9770     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9771        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9772                                                                  ELC50PD
  9773 0180-ACCOUNT-FOUND.                                              ELC50PD
  9774
  9775     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9776     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9777     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9778     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9779                                                                  ELC50PD
  9780     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9781        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9782                                                                  ELC50PD
  9783     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9784        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9785                                                                  ELC50PD
  9786     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9787        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9788                                                                  ELC50PD
  9789     IF AM-CLP-TOL-PCT NOT NUMERIC
  9790        MOVE +0                  TO AM-CLP-TOL-PCT
  9791     END-IF
  9792     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9793        MOVE +0                  TO AM-SPP-LEASE-COMM
  9794     END-IF
  9795     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9796        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9797        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9798                                                                  ELC50PD
  9799     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9800        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9801        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9802                                                                  ELC50PD
  9803     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9804        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9805        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9806        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 180
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9807         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9808                                                                  ELC50PD
  9809     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9810     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9811     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9812     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9813     IF AM-CLP-TOL-PCT NOT = ZEROS
  9814        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9815     END-IF
  9816     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9817        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9818     END-IF
  9819
  9820
  9821
  9822
  9823*    IF PB-COMPANY-ID = 'DCC'
  9824*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9825*                                   WS-ADMIN-FEES
  9826*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9827*          (SUB5 > +10)
  9828*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9829*             AND (AM-A-COM (SUB5) NUMERIC)
  9830*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9831*                + (AM-A-COM (SUB5) * 1000)
  9832*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9833*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9834*                + (AM-A-COM (SUB5) * 1000)
  9835*             END-IF
  9836*             IF AM-COM-TYP (SUB5) = 'N'
  9837*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9838*                + (AM-A-COM (SUB5) * 1000)
  9839*             END-IF
  9840*          END-IF
  9841*       END-PERFORM
  9842*    END-IF
  9843
  9844     IF (PB-COMPANY-ID = 'DCC')
  9845        AND (PB-ISSUE)
  9846        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9847        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9848           (SUB5 > +10)
  9849           MOVE +0 TO WS-WK-RATE
  9850           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9851              IF (AM-A-COM (SUB5) NUMERIC)
  9852                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9853                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9854              ELSE
  9855                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9856                 IF PB-ISSUE
  9857                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9858                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9859                 ELSE
  9860                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9861                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9862                 END-IF
  9863                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9864                 MOVE ZEROS             TO WS-SUB1
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 181
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9865                                           WS-COMMISSION
  9866                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9867                 MOVE '0530'               TO CTBL-SW
  9868                 MOVE ' '                  TO WS-CTBL-READ-SW
  9869                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9870                 IF FIRST-TIME-THROUGH
  9871                    MOVE 'AA'              TO CTBL-BEN-CODE
  9872                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9873                 END-IF
  9874                 IF CTBL-TABLE-FOUND
  9875                    IF PB-ISSUE
  9876                       COMPUTE WS-COMM-CK-AMT =
  9877                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9878                    ELSE
  9879                       COMPUTE WS-COMM-CK-AMT =
  9880                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9881                    END-IF
  9882                    PERFORM 8800-GET-COMP-RATE
  9883                              THRU 8800-EXIT
  9884                 END-IF
  9885              END-IF
  9886              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9887                + (WS-WK-RATE * 1000)
  9888           END-IF
  9889        END-PERFORM
  9890     END-IF
  9891
  9892     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9893         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9894                                                                  ELC50PD
  9895     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9896         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9897     END-IF
  9898                                                                  ELC50PD
  9899     GO TO 0200-READ-CERT.                                        ELC50PD
  9900                                                                  ELC50PD
  9901 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9902                                                                  ELC50PD
  9903     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9904                                                                  ELC50PD
  9905     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9906        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9907        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9908     ELSE                                                         ELC50PD
  9909        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9910        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9911                                                                  ELC50PD
  9912     GO TO 9990-RETURN.                                           ELC50PD
  9913                                                                  ELC50PD
  9914 0200-READ-CERT.                                                  ELC50PD
  9915                                                                  ELC50PD
  9916     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9917     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9918     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9919     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9920     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9921     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9922     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 182
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9923                                                                  ELC50PD
  9924     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
  9925                                                                  ELC50PD
  9926     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9927        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9928                                                                  ELC50PD
  9929     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9930        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9931        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9932        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9933                                                                  ELC50PD
  9934     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9935         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9937         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9938                                                                  ELC50PD
  9939     IF PB-ISSUE                                                  ELC50PD
  9940        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9941           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9942              NEXT SENTENCE                                       ELC50PD
  9943            ELSE                                                  ELC50PD
  9944              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9945              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9946              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9947                                                                  ELC50PD
  9948     IF NOT PB-CANCELLATION                                       ELC50PD
  9949        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9950                                                                  ELC50PD
  9951     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9952     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9953     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9954     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9955     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9956     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9957                                                                  ELC50PD
  9958     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9959     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9960     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9961     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9962     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9963     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9964     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9965     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9966     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9967                                                                  ELC50PD
  9968     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9969     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9970     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9971     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9972     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9973     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9974     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9975                                                                  ELC50PD
  9976     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9977     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9978                                                                  ELC50PD
  9979     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9980                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 183
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9981     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9982                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
  9983                                                                  ELC50PD
  9984     IF CM-O-B-COVERAGE                                           ELC50PD
  9985         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9986                                                                  ELC50PD
  9987     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9988         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9989                                                                  ELC50PD
  9990     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9991         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9992                                                                  ELC50PD
  9993     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9994         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9995         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9996         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9997         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9998         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9999         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
 10000         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
 10001*The next line causes a problem with my change  I dont think it is needed
 10002*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
 10003                                                                  ELC50PD
 10004     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
 10005     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
 10006     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
 10007     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
 10008     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
 10009     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
 10010                                                                  ELC50PD
 10011     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
 10012     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
 10013     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
 10014     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
 10015                                                                  ELC50PD
 10016     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
 10017         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
 10018     ELSE                                                         ELC50PD
 10019         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
 10020                                                                  ELC50PD
 10021     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
 10022         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
 10023     ELSE                                                         ELC50PD
 10024         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
 10025                                                                  ELC50PD
 10026     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
 10027                                                                  ELC50PD
 10028     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
 10029           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
 10030                                                                  ELC50PD
 10031     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
 10032           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
 10033                                                                  ELC50PD
 10034     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
 10035           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
 10036                                                                  ELC50PD
 10037     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
 10038           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 184
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10039                                                                  ELC50PD
 10040     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
 10041           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
 10042                                                                  ELC50PD
 10043     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
 10044     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
 10045     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
 10046     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
 10047     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
 10048     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
 10049     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
 10050     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
 10051     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
 10052     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
 10053     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
 10054     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
 10055                                                                  ELC50PD
 10056     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
 10057         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
 10058                                                                  ELC50PD
 10059     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
 10060         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
 10061                                                                  ELC50PD
 10062     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
 10063                                                                  ELC50PD
 10064     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
 10065        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
 10066        IF CM-ADDL-CLP NOT NUMERIC
 10067           MOVE +0               TO CM-ADDL-CLP
 10068        END-IF
 10069        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
 10070        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10071           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
 10072        END-IF
 10073     END-IF
 10074
 10075     IF PB-COMPANY-ID = 'DCC'
 10076        MOVE +0                  TO WS-ADMIN-FEES
 10077                                    WS-CSO-ADMIN-FEE
 10078                                    WS-COMM-AND-MFEE
 10079                                    WS-1ST-YR-ALLOW
 10080        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
 10081           (SUB5 > +10)
 10082           MOVE +0 TO WS-WK-RATE
 10083           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
 10084              IF (AM-A-COM (SUB5) NUMERIC)
 10085                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
 10086                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
 10087              ELSE
 10088                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
 10089                 IF PB-ISSUE
 10090                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10091                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10092                 ELSE
 10093                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10094                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10095                 END-IF
 10096                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 185
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10097                 MOVE ZEROS             TO WS-SUB1
 10098                                           WS-COMMISSION
 10099                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
 10100                 MOVE '0530'               TO CTBL-SW
 10101                 MOVE ' '                  TO WS-CTBL-READ-SW
 10102                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10103                 IF FIRST-TIME-THROUGH
 10104                    MOVE 'AA'              TO CTBL-BEN-CODE
 10105                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10106                 END-IF
 10107                 IF CTBL-TABLE-FOUND
 10108                    IF PB-ISSUE
 10109                       COMPUTE WS-COMM-CK-AMT =
 10110                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10111                    ELSE
 10112                       COMPUTE WS-COMM-CK-AMT =
 10113                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10114                    END-IF
 10115                    PERFORM 8800-GET-COMP-RATE
 10116                              THRU 8800-EXIT
 10117                 END-IF
 10118              END-IF
 10119              IF AM-COM-TYP (SUB5) = 'I'
 10120                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10121                   + (WS-WK-RATE * 1000)
 10122              END-IF
 10123              IF AM-COM-TYP (SUB5) = 'N'
 10124                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10125                   + (WS-WK-RATE * 1000)
 10126              END-IF
 10127              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10128                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10129                   + (WS-WK-RATE * 1000)
 10130              END-IF
 10131              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10132                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10133                   + (WS-WK-RATE * 1000)
 10134              END-IF
 10135           END-IF
 10136        END-PERFORM
 10137     END-IF
 10138
 10139     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10140                                                                  ELC50PD
 10141 0298-UNLOCK-RETURN.                                              ELC50PD
 10142      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10143      GO TO 9990-RETURN.                                          ELC50PD
 10144                                                                  ELC50PD
 10145 0299-CERT-NOT-FOUND.                                             ELC50PD
 10146                                                                  ELC50PD
 10147     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10148                                                                  ELC50PD
 10149     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10150         IF WS-ERROR = ER-2799                                    ELC50PD
 10151             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10152                                                                  ELC50PD
 10153     IF NOT PB-CANCELLATION                                       ELC50PD
 10154         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 186
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10155                                                                  ELC50PD
 10156     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
 10157     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10158     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10159     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10160                                    PB-CI-LF-TERM                 ELC50PD
 10161                                    PB-C-LF-REM-TERM              ELC50PD
 10162                                    PB-CI-AH-TERM                 ELC50PD
 10163                                    PB-C-AH-REM-TERM              ELC50PD
 10164                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10165                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10166                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10167                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10168                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10169                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10170                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10171                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10172                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10173                                    PB-CI-LOAN-APR                ELC50PD
 10174                                    PB-CI-LOAN-TERM               ELC50PD
 10175                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10176                                    PB-CI-AH-COMMISSION           ELC50PD
 10177                                    PB-CI-CURR-SEQ                ELC50PD
 10178                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10179                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10180                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10181                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10182                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10183                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10184                                    PB-CI-LIVES                   ELC50PD
 10185                                    PB-CI-LF-CRIT-PER             ELC50PD
 10186                                    PB-CI-AH-CRIT-PER
 10187                                    PB-CI-ADDL-CLP
 10188                                    PB-CI-DDF-IU-RATE-UP.
 10189                                                                  ELC50PD
 10190     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10191                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10192                                    PB-CI-DEATH-DT                ELC50PD
 10193                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10194                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10195                                    PB-CI-ENTRY-DT                ELC50PD
 10196                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10197                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10198                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10199                                                                  ELC50PD
 10200     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10201        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10202        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10203                                                                  ELC50PD
 10204                                                                  ELC50PD
 10205 0300-CONTINUE-EDIT.                                              ELC50PD
 10206                                                                  ELC50PD
 10207     IF PB-ISSUE                                                  ELC50PD
 10208        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10209            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10210                                                                  ELC50PD
 10211     IF PB-ISSUE                                                  ELC50PD
 10212        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 187
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10213            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10214                                                                  ELC50PD
 10215     IF PB-ISSUE                                                  ELC50PD
 10216       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10217          (AM-NO-AH-ONLY)                                         ELC50PD
 10218           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10219               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10220                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10221                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10222                                                                  ELC50PD
 10223     IF PB-ISSUE                                                  ELC50PD
 10224        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10225        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10226        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10227     ELSE                                                         ELC50PD
 10228        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10229        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10230        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10231                                                                  ELC50PD
 10232     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10233                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10234                                    FORM-MASTER-SW                ELC50PD
 10235                                    WS-APP-CERT-SW.               ELC50PD
 10236                                                                  ELC50PD
 10237     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10238                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10239                                    WS-PL-REF-OVS-AMT             ELC50PD
 10240                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10241                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10242                                    WS-PL-REF-OVS-PCT             ELC50PD
 10243                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10244                                                                  ELC50PD
 10245     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10246       IF PB-ISSUE                                                ELC50PD
 10247         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10248             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10249             IF FORM-MASTER-FOUND                                 ELC50PD
 10250                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10251                                                                  ELC50PD
 10252     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10253        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10254                                                                  ELC50PD
 10255********************** MON CODE **********************            ELC50PD
 10256     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10257     IF PB-ISSUE                                                  ELC50PD
 10258     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10259        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10260             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10261               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
 10262******************************************************            ELC50PD
 10263                                                                  ELC50PD
 10264     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10265       IF PB-ISSUE                                                ELC50PD
 10266           IF FORM-MASTER-FOUND                                   ELC50PD
 10267             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10268                AM-DISMBR-COVERAGE                                ELC50PD
 10269                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10270                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 188
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10271                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10272                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
 10273                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10274                                                                  ELC50PD
 10275     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10276                                                                  ELC50PD
 10277     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10278         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10279         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10280         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10281         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10282         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10283           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10284             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10285         ELSE                                                     ELC50PD
 10286             NEXT SENTENCE                                        ELC50PD
 10287     ELSE                                                         ELC50PD
 10288         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10289                                                                  ELC50PD
 10290     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10291     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10292     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10293     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10294                                                                  ELC50PD
 10295     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10296     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10297                                                                  ELC50PD
 10298     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10299        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10300         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10301                                                                  ELC50PD
 10302     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10303                                                                  ELC50PD
 10304 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10305                                                                  ELC50PD
 10306     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10307                                                                  ELC50PD
 10308     IF NO-BENEFIT-FOUND                                          ELC50PD
 10309        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10310                                                                  ELC50PD
 10311     IF WS-BEN-CD = '99'                                          ELC50PD
 10312        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10313                                                                  ELC50PD
 10314     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10315         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10316             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10317                                                                  ELC50PD
 10318     MOVE +1                     TO SUB5.                         ELC50PD
 10319     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10320                                                                  ELC50PD
 10321* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10322* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10323     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10324         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10325                                                                  ELC50PD
 10326 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10327                                                                  ELC50PD
 10328     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 189
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10329        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10330           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10331                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10332           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10333                                                                  ELC50PD
 10334     IF SUB5 LESS THAN +20                                        ELC50PD
 10335        ADD +1                   TO SUB5                          ELC50PD
 10336        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10337                                                                  ELC50PD
 10338     MOVE +1                     TO SUB5.                         ELC50PD
 10339                                                                  ELC50PD
 10340     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10341        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10342                                                                  ELC50PD
 10343 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10344                                                                  ELC50PD
 10345     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10346        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10347           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10348                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10349           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10350                                                                  ELC50PD
 10351     IF SUB5 LESS THAN +30                                        ELC50PD
 10352        ADD +1                   TO SUB5                          ELC50PD
 10353        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10354                                                                  ELC50PD
 10355     MOVE +1                     TO SUB5.                         ELC50PD
 10356                                                                  ELC50PD
 10357 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10358                                                                  ELC50PD
 10359***************************************************************   ELC50PD
 10360*                                                             *   ELC50PD
 10361*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10362*                                                             *   ELC50PD
 10363*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10364*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10365*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10366*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10367*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10368*           BENEFIT CONTROLS.                                 *   ELC50PD
 10369*      99 = ALL BENEFITS                                      *   ELC50PD
 10370*                                                             *   ELC50PD
 10371***************************************************************   ELC50PD
 10372                                                                  ELC50PD
 10373     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10374                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10375                                                                  ELC50PD
 10376     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10377       AND                                                        ELC50PD
 10378        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10379        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10380                                                                  ELC50PD
 10381     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10382       AND                                                        ELC50PD
 10383        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10384        IF CF-REDUCING (SUB3)                                     ELC50PD
 10385           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10386              OR                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 190
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10387           ((AM-IG = '1') AND                                     ELC50PD
 10388           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10389              OR                                                  ELC50PD
 10390           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10391           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10392           (AM-IG NOT = '2'))                                     ELC50PD
 10393              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10394                                                                  ELC50PD
 10395     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10396       AND                                                        ELC50PD
 10397        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10398        IF CF-REDUCING (SUB3)                                     ELC50PD
 10399           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10400              OR                                                  ELC50PD
 10401           ((AM-IG = '2') AND                                     ELC50PD
 10402           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10403              OR                                                  ELC50PD
 10404           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10405           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10406           (AM-IG NOT = '1'))                                     ELC50PD
 10407              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10408                                                                  ELC50PD
 10409     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10410       AND                                                        ELC50PD
 10411        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10412        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10413           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10414              OR                                                  ELC50PD
 10415           ((AM-IG = '1') AND                                     ELC50PD
 10416           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10417              OR                                                  ELC50PD
 10418           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10419           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10420            (AM-IG NOT = '2'))                                    ELC50PD
 10421              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10422                                                                  ELC50PD
 10423     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10424       AND                                                        ELC50PD
 10425        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10426        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10427           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10428              OR                                                  ELC50PD
 10429           ((AM-IG = '2') AND                                     ELC50PD
 10430           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10431              OR                                                  ELC50PD
 10432           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10433           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10434           (AM-IG NOT = '1'))                                     ELC50PD
 10435              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10436                                                                  ELC50PD
 10437     IF SUB5 LESS THAN +20                                        ELC50PD
 10438        ADD +1                   TO SUB5                          ELC50PD
 10439        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10440                                                                  ELC50PD
 10441     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10442                                                                  ELC50PD
 10443     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10444        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 191
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10445                                                                  ELC50PD
 10446     MOVE +1                     TO SUB5.                         ELC50PD
 10447                                                                  ELC50PD
 10448 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10449                                                                  ELC50PD
 10450     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10451                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10452                                                                  ELC50PD
 10453     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10454       AND                                                        ELC50PD
 10455        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10456        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10457                                                                  ELC50PD
 10458     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10459       AND                                                        ELC50PD
 10460        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10461        IF CF-REDUCING (SUB3)                                     ELC50PD
 10462           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10463              OR                                                  ELC50PD
 10464           ((AM-IG = '1') AND                                     ELC50PD
 10465           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10466              OR                                                  ELC50PD
 10467           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10468           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10469           (AM-IG NOT = '2'))                                     ELC50PD
 10470              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10471                                                                  ELC50PD
 10472     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10473       AND                                                        ELC50PD
 10474        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10475        IF CF-REDUCING (SUB3)                                     ELC50PD
 10476           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10477              OR                                                  ELC50PD
 10478           ((AM-IG = '2') AND                                     ELC50PD
 10479           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10480              OR                                                  ELC50PD
 10481           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10482           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10483           (AM-IG NOT = '1'))                                     ELC50PD
 10484              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10485                                                                  ELC50PD
 10486     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10487       AND                                                        ELC50PD
 10488        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10489        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10490           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10491              OR                                                  ELC50PD
 10492           ((AM-IG = '1') AND                                     ELC50PD
 10493           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10494              OR                                                  ELC50PD
 10495           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10496           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10497            (AM-IG NOT = '2'))                                    ELC50PD
 10498              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10499                                                                  ELC50PD
 10500     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10501       AND                                                        ELC50PD
 10502        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 192
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10503        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10504           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10505              OR                                                  ELC50PD
 10506           ((AM-IG = '2') AND                                     ELC50PD
 10507           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10508              OR                                                  ELC50PD
 10509           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10510           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10511           (AM-IG NOT = '1'))                                     ELC50PD
 10512              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10513                                                                  ELC50PD
 10514     IF SUB5 LESS THAN +30                                        ELC50PD
 10515        ADD +1                   TO SUB5                          ELC50PD
 10516        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10517                                                                  ELC50PD
 10518     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10519                                                                  ELC50PD
 10520 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10521                                                                  ELC50PD
 10522     MOVE +99                    TO SUB5.                         ELC50PD
 10523                                                                  ELC50PD
 10524     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10525        IF PB-ISSUE                                               ELC50PD
 10526           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10527           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10528                                                                  ELC50PD
 10529     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10530                                                                  ELC50PD
 10531 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10532                                                                  ELC50PD
 10533     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10534        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10535                                                                  ELC50PD
 10536     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10537     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10538     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10539     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10540     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10541                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10542     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10543                                                                  ELC50PD
 10544 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10545                                                                  ELC50PD
 10546     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10547     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10548                                                                  ELC50PD
 10549 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10550                                                                  ELC50PD
 10551     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10552     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10553     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10554     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10555     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10556     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10557     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10558     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10559                                 TO PLAN-REVISION-NO.             ELC50PD
 10560                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 193
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10561     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10562     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
 10563                                                                  ELC50PD
 10564     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10565       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10566         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10567            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10568             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10569             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10570             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10571                                                                  ELC50PD
 10572     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10573        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10574                                                                  ELC50PD
 10575 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10576                                                                  ELC50PD
 10577     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10578        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10579        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10580        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10581        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10582        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10583        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10584        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10585        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10586          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10587                                                                  ELC50PD
 10588     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10589                                                                  ELC50PD
 10590     IF  PB-CANCELLATION                                          ELC50PD
 10591         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10592                                                                  ELC50PD
 10593     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10594        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10595           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10596           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10597              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10598              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10599           ELSE                                                   ELC50PD
 10600              NEXT SENTENCE                                       ELC50PD
 10601        ELSE                                                      ELC50PD
 10602           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10603              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10604                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10605                                                                  ELC50PD
 10606 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10607                                                                  ELC50PD
 10608     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10609                                                                  ELC50PD
 10610     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10611        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10612                                                                  ELC50PD
 10613     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10614        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10615        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10616                                                                  ELC50PD
 10617     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10618        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 194
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10619                                                                  ELC50PD
 10620     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
 10621        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10622                                                                  ELC50PD
 10623     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10624        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10625                                                                  ELC50PD
 10626     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10627        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10628                                                                  ELC50PD
 10629     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10630        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10631                                                                  ELC50PD
 10632     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10633                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10634        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10635                                                                  ELC50PD
 10636     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10637                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10638        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10639                                                                  ELC50PD
 10640     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10641                          PL-SALES-TAX > +0                       ELC50PD
 10642         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10643                                                                  ELC50PD
 10644     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10645        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10646                                    WS-IG-OVRD-AM.                ELC50PD
 10647                                                                  ELC50PD
 10648 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10649                                                                  ELC50PD
 10650     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10651                                                                  ELC50PD
 10652     IF PB-ISSUE                                                  ELC50PD
 10653        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10654     ELSE                                                         ELC50PD
 10655        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10656                                                                  ELC50PD
 10657     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10658     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10659     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10660     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10661     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10662                                         WS-LF-REFUND-CALC.       ELC50PD
 10663     if (ws-lf-earnings-calc = '5')
 10664        and (pb-i-loan-apr = zeros)
 10665        and (benefit-code-chg)
 10666        move +99.9999 to pb-i-loan-apr
 10667     end-if
 10668                                                                  ELC50PD
 10669     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10670        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10671                                                                  ELC50PD
 10672     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 10673        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10674
 10675     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10676                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 195
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10677     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10678     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
 10679     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10680     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10681     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10682     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10683                                                                  ELC50PD
 10684     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10685        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10686         NEXT SENTENCE                                            ELC50PD
 10687     ELSE                                                         ELC50PD
 10688         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10689            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10690               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10691                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10692                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10693                                                                  ELC50PD
 10694     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10695     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10696                                                                  ELC50PD
 10697     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10698                                                                  ELC50PD
 10699 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10700                                                                  ELC50PD
 10701     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10702     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10704                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 196
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10706                                                                  ELC50PD
 10707 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10708                                                                  ELC50PD
 10709     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10710                                    PLAN-MASTER-AH-SW.            ELC50PD
 10711                                                                  ELC50PD
 10712     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10713                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10714                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10715                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10716                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10717                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10718                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10719     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10720                                                                  ELC50PD
 10721                                                                  ELC50PD
 10722     if pb-issue
 10723        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10724           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10725        end-if
 10726        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10727           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10728           GO TO 0399-BENEFIT-NOT-FOUND
 10729        end-if
 10730     end-if
 10731                                                                  ELC50PD
 10732     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10733        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10734                                                                  ELC50PD
 10735     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10736                                                                  ELC50PD
 10737     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10738         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10739         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10740         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10741         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10742           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10743             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10744         ELSE                                                     ELC50PD
 10745             NEXT SENTENCE                                        ELC50PD
 10746     ELSE                                                         ELC50PD
 10747         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10748                                                                  ELC50PD
 10749     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10750     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10751     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10752     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10753                                                                  ELC50PD
 10754     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10755     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10756                                                                  ELC50PD
 10757     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10758        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10759          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10760                                                                  ELC50PD
 10761     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10762                                                                  ELC50PD
 10763 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 197
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10764                                                                  ELC50PD
 10765     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10766                                                                  ELC50PD
 10767     IF NO-BENEFIT-FOUND                                          ELC50PD
 10768         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10769                                                                  ELC50PD
 10770     IF WS-BEN-CD = '99'                                          ELC50PD
 10771        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10772                                                                  ELC50PD
 10773     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10774         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10775             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10776                                                                  ELC50PD
 10777     MOVE +1                     TO SUB5.                         ELC50PD
 10778     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10779                                                                  ELC50PD
 10780* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10781* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10782     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10783         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10784                                                                  ELC50PD
 10785 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10786                                                                  ELC50PD
 10787     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10788        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10789           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10790                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10791           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10792                                                                  ELC50PD
 10793     IF SUB5 LESS THAN +20                                        ELC50PD
 10794        ADD +1                   TO SUB5                          ELC50PD
 10795        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10796                                                                  ELC50PD
 10797     MOVE +1                     TO SUB5.                         ELC50PD
 10798                                                                  ELC50PD
 10799     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10800        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10801                                                                  ELC50PD
 10802 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10803                                                                  ELC50PD
 10804     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10805        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10806           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10807                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10808           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10809                                                                  ELC50PD
 10810     IF SUB5 LESS THAN +30                                        ELC50PD
 10811        ADD +1                   TO SUB5                          ELC50PD
 10812        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10813                                                                  ELC50PD
 10814     MOVE +1                     TO SUB5.                         ELC50PD
 10815                                                                  ELC50PD
 10816 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10817                                                                  ELC50PD
 10818***************************************************************   ELC50PD
 10819*                                                             *   ELC50PD
 10820*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10821*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 198
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10822*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10823*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10824*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10825*           BENEFIT CONTROLS.                                 *   ELC50PD
 10826*      99 = ALL BENEFITS.                                     *   ELC50PD
 10827*                                                             *   ELC50PD
 10828***************************************************************   ELC50PD
 10829                                                                  ELC50PD
 10830     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10831                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10832                                                                  ELC50PD
 10833     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10834       AND                                                        ELC50PD
 10835        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10836        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10837                                                                  ELC50PD
 10838     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10839       AND                                                        ELC50PD
 10840        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10841           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10842              OR                                                  ELC50PD
 10843           ((AM-IG = '1') AND                                     ELC50PD
 10844           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10845              OR                                                  ELC50PD
 10846           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10847           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10848           (AM-IG NOT = '2'))                                     ELC50PD
 10849              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10850                                                                  ELC50PD
 10851     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10852       AND                                                        ELC50PD
 10853        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10854           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10855              OR                                                  ELC50PD
 10856           ((AM-IG = '2') AND                                     ELC50PD
 10857           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10858              OR                                                  ELC50PD
 10859           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10860           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10861           (AM-IG NOT = '1'))                                     ELC50PD
 10862              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10863                                                                  ELC50PD
 10864     IF SUB5 LESS THAN +20                                        ELC50PD
 10865        ADD +1                   TO SUB5                          ELC50PD
 10866        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10867                                                                  ELC50PD
 10868     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10869        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10870                                                                  ELC50PD
 10871     MOVE +1                    TO SUB5.                          ELC50PD
 10872                                                                  ELC50PD
 10873 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10874                                                                  ELC50PD
 10875     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10876                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10877                                                                  ELC50PD
 10878     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10879       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 199
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10880        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10881        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10882                                                                  ELC50PD
 10883     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10884       AND                                                        ELC50PD
 10885        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10886           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10887              OR                                                  ELC50PD
 10888           ((AM-IG = '1') AND                                     ELC50PD
 10889           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10890              OR                                                  ELC50PD
 10891           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10892           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10893           (AM-IG NOT = '2'))                                     ELC50PD
 10894              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10895                                                                  ELC50PD
 10896     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10897       AND                                                        ELC50PD
 10898        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10899           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10900              OR                                                  ELC50PD
 10901           ((AM-IG = '2') AND                                     ELC50PD
 10902           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10903              OR                                                  ELC50PD
 10904           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10905           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10906           (AM-IG NOT = '1'))                                     ELC50PD
 10907              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10908                                                                  ELC50PD
 10909     IF SUB5 LESS THAN +30                                        ELC50PD
 10910        ADD +1                   TO SUB5                          ELC50PD
 10911        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10912                                                                  ELC50PD
 10913 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10914                                                                  ELC50PD
 10915     MOVE +99                    TO SUB5.                         ELC50PD
 10916                                                                  ELC50PD
 10917     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10918                                                                  ELC50PD
 10919     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10920        IF PB-ISSUE                                               ELC50PD
 10921           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10922           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10923                                                                  ELC50PD
 10924     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10925                                                                  ELC50PD
 10926 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10927                                                                  ELC50PD
 10928     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10929         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10930                                                                  ELC50PD
 10931     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10932     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10933     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10934     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10935     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10936                                    PLAN-MASTER-AH-SW.            ELC50PD
 10937*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 200
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10938     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10939                                                                  ELC50PD
 10940 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10941                                                                  ELC50PD
 10942     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10943     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10944                                                                  ELC50PD
 10945 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10946                                                                  ELC50PD
 10947     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10948     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10949     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10950     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10951     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10952     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10953     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10954     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10955                                 TO PLAN-REVISION-NO.             ELC50PD
 10956                                                                  ELC50PD
 10957     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10958     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10959                                                                  ELC50PD
 10960     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10961       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10962         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10963            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10964             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10965             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10966             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10967                                                                  ELC50PD
 10968     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10969        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10970                                                                  ELC50PD
 10971 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10972                                                                  ELC50PD
 10973     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10974        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10975        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10976        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10977        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10978        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10979        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10980        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10981        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10982          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10983                                                                  ELC50PD
 10984     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10985                                                                  ELC50PD
 10986     IF  PB-CANCELLATION                                          ELC50PD
 10987         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10988                                                                  ELC50PD
 10989     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10990       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10991          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10992          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10993             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10994             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10995          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 201
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10996             NEXT SENTENCE                                        ELC50PD
 10997       ELSE                                                       ELC50PD
 10998          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10999             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 11000                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 11001                                                                  ELC50PD
 11002 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 11003                                                                  ELC50PD
 11004     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 11005                                                                  ELC50PD
 11006     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 11007        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 11008                                                                  ELC50PD
 11009     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 11010        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 11011        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 11012                                                                  ELC50PD
 11013     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 11014        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 11015                                                                  ELC50PD
 11016     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 11017        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 11018                                                                  ELC50PD
 11019     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 11020        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 11021                                                                  ELC50PD
 11022     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 11023        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 11024                                                                  ELC50PD
 11025     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 11026        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 11027                                                                  ELC50PD
 11028     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 11029                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 11030        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 11031                                                                  ELC50PD
 11032     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 11033                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 11034        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 11035                                                                  ELC50PD
 11036     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 11037        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 11038        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 11039            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 11040                                                                  ELC50PD
 11041 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 11042                                                                  ELC50PD
 11043     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 11044                                                                  ELC50PD
 11045     IF PB-ISSUE                                                  ELC50PD
 11046        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 11047       ELSE                                                       ELC50PD
 11048        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 11049                                                                  ELC50PD
 11050     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 11051     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 11052     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 11053     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 202
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11054                                         WS-AH-REFUND-CALC.       ELC50PD
 11055                                                                  ELC50PD
 11056     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 11057        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 11058                                                                  ELC50PD
 11059     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 11060        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 11061
 11062     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 11063                                                                  ELC50PD
 11064     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 11065     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 11066     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 11067     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 11068     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 11069     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11070                                                                  ELC50PD
 11071     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 11072        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 11073         NEXT SENTENCE                                            ELC50PD
 11074     ELSE                                                         ELC50PD
 11075         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 11076            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 11077                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 11078                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 11079                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11080                                                                  ELC50PD
 11081     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 11082     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 11083                                                                  ELC50PD
 11084     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 11085                                                                  ELC50PD
 11086 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 11087                                                                  ELC50PD
 11088     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 11089     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 11090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11091                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 203
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11093                                                                  ELC50PD
 11094 0400-FIND-CARRIER.                                               ELC50PD
 11095                                                                  ELC50PD
 11096     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11097                                                                  ELC50PD
 11098     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11099     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11100     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11101     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11102                                                                  ELC50PD
 11103*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11104     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11105                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11106                                                                  ELC50PD
 11107     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11108     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11109                                                                  ELC50PD
 11110     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11111        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11112                                                                  ELC50PD
 11113 0400-BUILD-CARR-TOL.                                             ELC50PD
 11114                                                                  ELC50PD
 11115     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11116        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11117        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11118                                    WS-TOL-AH-PREM.               ELC50PD
 11119                                                                  ELC50PD
 11120     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11121        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11122        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11123                                    WS-TOL-AH-REFUND.             ELC50PD
 11124                                                                  ELC50PD
 11125     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11126        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11127        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11128                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11129                                                                  ELC50PD
 11130     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11131        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11132        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11133                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11134                                                                  ELC50PD
 11135     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11136        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11137        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11138                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11139                                                                  ELC50PD
 11140     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11141        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11142        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11143                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11144                                                                  ELC50PD
 11145     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11146         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11147                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11148                                                                  ELC50PD
 11149     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11150     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 204
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11151        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11152     END-IF
 11153     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11154        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11155     END-IF
 11156     IF WS-TOL-CLP-PCT = ZEROS
 11157        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11158     END-IF
 11159
 11160     IF WS-SPP-LEASE-COMM = ZEROS
 11161        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11162     END-IF
 11163
 11164     GO TO 0400-FIND-ERPDEF.
 11165                                                                  ELC50PD
 11166 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11167                                                                  ELC50PD
 11168     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11170                                                                  ELC50PD
 11171 0400-FIND-ERPDEF.
 11172
 11173     IF PB-COMPANY-ID = 'DCC'
 11174        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11175        CONTINUE
 11176     ELSE
 11177        GO TO 0400-FIND-ERCOMP
 11178     END-IF
 11179
 11180     MOVE ' '                    TO PDEF-MASTER-SW
 11181     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11182     MOVE PB-STATE               TO ERPDEF-STATE
 11183     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11184     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11185     IF PB-ISSUE
 11186        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11187     ELSE
 11188        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11189     END-IF
 11190     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11191     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11192     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11193     IF PDEF-MASTER-FOUND
 11194        MOVE 'N'                 TO PDEF-MASTER-SW
 11195        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11196        IF PDEF-MASTER-FOUND
 11197           IF (ERPDEF-KEY-SAVE (1:16) =
 11198                        PD-CONTROL-PRIMARY (1:16))
 11199              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11200              CONTINUE
 11201           ELSE
 11202              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11203              IF (ERPDEF-KEY-SAVE (1:16) =
 11204                        PD-CONTROL-PRIMARY (1:16))
 11205                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11206                 CONTINUE
 11207              ELSE
 11208                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 205
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11209              END-IF
 11210           END-IF
 11211        END-IF
 11212        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11213     END-IF
 11214     IF PDEF-MASTER-FOUND
 11215        IF PD-TRUNCATED = 'Y'
 11216           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11217        END-IF
 11218     END-IF
 11219
 11220     .
 11221 0400-FIND-ERCOMP.
 11222
 11223     IF PB-COMPANY-ID = 'DCC'
 11224        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11225           (WS-SUB1 > +10)
 11226           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11227                 OR 'A' OR 'N'
 11228              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11229              MOVE PB-CARRIER    TO COMP-CARRIER
 11230              MOVE PB-GROUPING   TO COMP-GROUPING
 11231              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11232              MOVE AM-AGT (WS-SUB1)
 11233                                 TO COMP-FIN-RESP
 11234              MOVE 'G'           TO COMP-TYPE
 11235              PERFORM 8582-READ-COMPENSATION-MASTER
 11236                                 THRU 8582-EXIT
 11237              IF COMP-MASTER-FOUND
 11238                 IF CO-GA-INACTIVE
 11239                    MOVE ER-2763 TO WS-ERROR
 11240                    PERFORM 9900-ERROR-FORMAT
 11241                                 THRU 9900-EXIT
 11242                    MOVE +11     TO WS-SUB1
 11243                 END-IF
 11244                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11245                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11246                    MOVE ER-2788 TO WS-ERROR
 11247                    PERFORM 9900-ERROR-FORMAT
 11248                                 THRU 9900-EXIT
 11249                    MOVE +11     TO WS-SUB1
 11250                 END-IF
 11251              END-IF
 11252           END-IF
 11253        END-PERFORM
 11254     END-IF
 11255
 11256     IF PB-COMPANY-ID = 'DCC'
 11257        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11258           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11259                                    WS-CLP-STATE
 11260        ELSE
 11261           MOVE SPACES           TO PB-I-CLP-STATE
 11262                                    WS-CLP-STATE
 11263        END-IF
 11264     END-IF
 11265
 11266     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 206
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11267        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11268        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11269        CONTINUE
 11270     ELSE
 11271        GO TO 0400-FIND-STATE-RECORD
 11272     END-IF
 11273
 11274     MOVE SPACES                 TO WS-CLP-STATE
 11275     MOVE +0                     TO WS-BANK-FEE
 11276                                    WS-BANK-LFEE
 11277                                    WS-BANK-NOCHRGB
 11278
 11279     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11280
 11281     IF (PB-ISSUE)
 11282        AND (PB-I-BANK-NUMBER NOT =
 11283            SPACES AND ZEROS AND LOW-VALUES)
 11284        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11285     ELSE
 11286        IF (PB-CANCELLATION)
 11287           AND (PB-CI-BANK-NUMBER NOT =
 11288                SPACES AND ZEROS AND LOW-VALUES)
 11289           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11290        END-IF
 11291     END-IF
 11292
 11293     IF COMP-FIN-RESP NOT = LOW-VALUES
 11294        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11295        MOVE PB-CARRIER          TO COMP-CARRIER
 11296        MOVE PB-GROUPING         TO COMP-GROUPING
 11297        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11298        MOVE 'B'                 TO COMP-TYPE
 11299        PERFORM 8582-READ-COMPENSATION-MASTER
 11300                                 THRU 8582-EXIT
 11301        IF COMP-MASTER-FOUND
 11302           IF CO-MAX-BANK-FEE NOT NUMERIC
 11303              MOVE +0            TO CO-MAX-BANK-FEE
 11304           END-IF
 11305           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11306              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11307           END-IF
 11308           IF CO-GA-INACTIVE
 11309              MOVE ER-2763       TO WS-ERROR
 11310              PERFORM 9900-ERROR-FORMAT
 11311                                 THRU 9900-EXIT
 11312           END-IF
 11313           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11314              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11315              MOVE ER-2788 TO WS-ERROR
 11316              PERFORM 9900-ERROR-FORMAT
 11317                                 THRU 9900-EXIT
 11318              MOVE +11     TO WS-SUB1
 11319           END-IF
 11320           IF WS-AH-BEN-CATEGORY = 'G'
 11321              MOVE CO-MAX-BANK-FEE
 11322                                 TO WS-BANK-FEE
 11323                                    PB-I-BANK-FEE
 11324           ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 207
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11325              MOVE CO-MAX-BANK-FEE-LEASE
 11326                                 TO WS-BANK-LFEE
 11327                                    PB-I-BANK-FEE
 11328           END-IF
 11329           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11330              AND (WS-AH-REFUND-CALC = 'G'))
 11331                        OR
 11332              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11333              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11334              CONTINUE
 11335           ELSE
 11336              MOVE ER-2789 TO WS-ERROR
 11337              PERFORM 9900-ERROR-FORMAT
 11338                                 THRU 9900-EXIT
 11339           END-IF
 11340           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11341                                    PB-I-CLP-STATE
 11342           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11343           MOVE CO-CARRIER       TO BXRF-CARRIER
 11344           MOVE CO-GROUPING      TO BXRF-GROUPING
 11345           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11346           MOVE BXRF-MAX-REC-LENGTH
 11347                                 TO BXRF-REC-LENGTH
 11348           PERFORM 8584-READ-BANK-CROSS-REF
 11349                                 THRU 8584-EXIT
 11350           IF BXRF-MASTER-FOUND
 11351              MOVE ' '           TO BANK-ACCT-SW
 11352              MOVE BK-BANK-POINTER-CNT
 11353                                 TO BK-BANK-POINTER-CNT
 11354              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11355                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11356                 OR (BANK-ACCT-FOUND)
 11357                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11358                    AND (BK-AM-EXP-DT (WS-SUB1)
 11359                                 > PB-CERT-EFF-DT)
 11360                    AND (BK-AM-EFF-DT (WS-SUB1)
 11361                                 NOT > PB-CERT-EFF-DT)
 11362                    SET BANK-ACCT-FOUND TO TRUE
 11363                 END-IF
 11364              END-PERFORM
 11365              IF NOT BANK-ACCT-FOUND
 11366                 MOVE ZEROS      TO WS-BANK-FEE
 11367                                    WS-BANK-LFEE
 11368                 MOVE ER-2869    TO WS-ERROR
 11369                 PERFORM 9900-ERROR-FORMAT
 11370                                 THRU 9900-EXIT
 11371              ELSE
 11372                 PERFORM 5000-PROCESS-REPS
 11373                                 THRU 5000-EXIT
 11374                 IF AGENT-MASTER-FOUND
 11375                    MOVE +0      TO WS-BANK-FEE
 11376                                    WS-BANK-LFEE
 11377*                   MOVE AG-SPP-FEES (1)
 11378*                                TO PB-I-BANK-FEE
 11379*                                   WS-BANK-FEE
 11380                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11381                       (WS-SUB1 > +10)
 11382                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 208
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11383                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11384                       END-IF
 11385                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11386                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11387                       END-IF
 11388                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11389                          AG-SPP-FEES (WS-SUB1)
 11390                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11391                          AG-SPP-LFEES (WS-SUB1)
 11392                    END-PERFORM
 11393                    IF WS-AH-BEN-CATEGORY = 'G'
 11394                       MOVE WS-BANK-FEE
 11395                                 TO PB-I-BANK-FEE
 11396                    ELSE
 11397                       MOVE WS-BANK-LFEE
 11398                                 TO PB-I-BANK-FEE
 11399                    END-IF
 11400                 END-IF
 11401              END-IF
 11402           END-IF
 11403        ELSE
 11404           MOVE ER-2879          TO WS-ERROR
 11405           PERFORM 9900-ERROR-FORMAT
 11406                                 THRU 9900-EXIT
 11407        END-IF
 11408     ELSE
 11409        MOVE ER-2879             TO WS-ERROR
 11410        PERFORM 9900-ERROR-FORMAT
 11411                                 THRU 9900-EXIT
 11412     END-IF
 11413
 11414     IF WS-AH-BEN-CATEGORY = 'G'
 11415        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11416        + WS-BANK-FEE
 11417     ELSE
 11418        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11419        + WS-BANK-LFEE
 11420     END-IF
 11421
 11422     .
 11423 0400-FIND-STATE-RECORD.                                          ELC50PD
 11424                                                                  ELC50PD
 11425     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11426         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11427         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11428         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11429         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11430         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11431             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11432         ELSE                                                     ELC50PD
 11433             NEXT SENTENCE                                        ELC50PD
 11434     ELSE                                                         ELC50PD
 11435         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11436                                                                  ELC50PD
 11437     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11438     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11439     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11440     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 209
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11441                                                                  ELC50PD
 11442     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11443     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11444                                                                  ELC50PD
 11445     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11446        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11447        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11448        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11449                                    WS-TOL-AH-CLAIM               ELC50PD
 11450                                    WS-MINIMUM-REFUND             ELC50PD
 11451                                    WS-TOL-LF-PREM                ELC50PD
 11452                                    WS-TOL-AH-PREM                ELC50PD
 11453                                    WS-TOL-LF-REFUND              ELC50PD
 11454                                    WS-TOL-AH-REFUND              ELC50PD
 11455                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11456                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11457                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11458                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11459                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11460                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11461                                    EC-ST-TOL-PREM                ELC50PD
 11462                                    EC-ST-TOL-REFUND              ELC50PD
 11463                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11464                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11465                                    WS-ST-LF-PREM-TAX
 11466                                    WS-ST-AH-PREM-TAX-I
 11467                                    WS-ST-AH-PREM-TAX-G
 11468                                    WS-BANK-FEE
 11469                                    WS-BANK-LFEE
 11470                                    WS-TOL-CLP-PCT
 11471                                    WS-SPP-LEASE-COMM
 11472        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11473                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11474                                    WS-LF-REM-TERM-CALC           ELC50PD
 11475                                    WS-LF-REFUND-CALC             ELC50PD
 11476                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11477                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11478                                    WS-AH-REM-TERM-CALC           ELC50PD
 11479                                    WS-AH-REFUND-CALC
 11480                                    WS-LF-BEN-CATEGORY
 11481                                    WS-AH-BEN-CATEGORY
 11482                                    WS-CLP-STATE
 11483                                    WS-ST-REFUND-CLAIM-FLAG
 11484                                    WS-ST-CAUSAL-STATE
 11485                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11486                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11487          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11488                                                                  ELC50PD
 11489     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11490                                                                  ELC50PD
 11491 0405-CONTINUE-EDIT.                                              ELC50PD
 11492
 11493     if pb-company-id = 'AHL'
 11494        continue
 11495     else
 11496        IF PB-CERT-PRIME NOT NUMERIC
 11497           MOVE ER-2722          TO WS-ERROR
 11498           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 210
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11499                                 THRU 9900-EXIT
 11500        end-if
 11501     END-IF
 11502
 11503*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11504*       MOVE +0                  TO SUB3
 11505*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11506*       IF SUB3 > +0
 11507*          MOVE ER-2722          TO WS-ERROR
 11508*          PERFORM 9900-ERROR-FORMAT
 11509*                                THRU 9900-EXIT
 11510*       END-IF
 11511*    END-IF
 11512
 11513
 11514*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11515*       IF PB-CERT-PRIME NOT NUMERIC
 11516*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11517*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11518*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11519*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11520*
 11521*          MOVE ER-2722          TO WS-ERROR
 11522*          PERFORM 9900-ERROR-FORMAT
 11523*                                THRU 9900-EXIT
 11524*       END-IF
 11525*    END-IF
 11526
 11527     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11528                                                                  ELC50PD
 11529     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11530        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11531                                    WS-TOL-AH-CLAIM.              ELC50PD
 11532                                                                  ELC50PD
 11533     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11534        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11535                                                                  ELC50PD
 11536     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11537        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11538                                                                  ELC50PD
 11539     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11540        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11541                                    WS-TOL-AH-PREM                ELC50PD
 11542        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11543                                                                  ELC50PD
 11544     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11545        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11546                                    WS-TOL-AH-REFUND              ELC50PD
 11547        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11548                                                                  ELC50PD
 11549     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11550        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11551        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11552                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11553                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11554                                                                  ELC50PD
 11555     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11556        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 211
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11557        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
 11558                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11559                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11560                                                                  ELC50PD
 11561     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11562        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11563        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11564                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11565                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11566                                                                  ELC50PD
 11567     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11568        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11569        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11570                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11571                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11572                                                                  ELC50PD
 11573     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11574     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11575                                                                  ELC50PD
 11576     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11577          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11578                                                                  ELC50PD
 11579     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11580     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11581
 11582     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11583                                                                  ELC50PD
 11584     IF CF-ST-LF-PREM-TAX NUMERIC
 11585        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11586     END-IF
 11587     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11588        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11589     END-IF
 11590     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11591        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11592     END-IF
 11593
 11594     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11595         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11596     END-IF.
 11597
 11598     IF CF-ST-CAUSAL-STATE > SPACES
 11599         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 11600     END-IF.
 11601
 11602     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11603        GO TO 0410-CHECK-AH.                                      ELC50PD
 11604                                                                  ELC50PD
 11605     IF CF-ST-RT-CALC NOT = SPACES
 11606        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11607                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11608     END-IF
 11609
 11610     IF WS-LF-COVERAGE-TYPE = 'R'
 11611        IF WS-LF-EARNINGS-CALC = '5'
 11612           IF CF-ST-RF-LN-CALC > '0'
 11613              MOVE CF-ST-RF-LN-CALC
 11614                                 TO WS-LF-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 212
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11615                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11616           END-IF
 11617        ELSE
 11618           IF CF-ST-RF-LR-CALC > '0'
 11619              MOVE CF-ST-RF-LR-CALC
 11620                                 TO WS-LF-REFUND-CALC
 11621                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11622           END-IF
 11623        END-IF
 11624     ELSE
 11625        IF CF-ST-RF-LL-CALC > '0'
 11626           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11627                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11628        END-IF
 11629     END-IF
 11630
 11631     IF CF-ST-RT-CALC NOT = SPACES
 11632        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11633                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11634     END-IF
 11635
 11636     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11637     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11638                                                                  ELC50PD
 11639     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11640                                                                  ELC50PD
 11641     IF NO-BENEFIT-FOUND                                          ELC50PD
 11642        GO TO 0410-CHECK-AH.                                      ELC50PD
 11643                                                                  ELC50PD
 11644     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11645        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11646                                 TO EC-ST-LF-REM-TERM-CALC
 11647                                    WS-LF-REM-TERM-CALC           ELC50PD
 11648     END-IF
 11649                                                                  ELC50PD
 11650     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11651        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11652                                 TO WS-LF-REFUND-CALC             ELC50PD
 11653                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11654     END-IF
 11655*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11656                                                                  ELC50PD
 11657     .                                                            ELC50PD
 11658 0410-CHECK-AH.                                                   ELC50PD
 11659                                                                  ELC50PD
 11660     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11661        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11662                                                                  ELC50PD
 11663     IF CF-ST-RT-CALC NOT = SPACES
 11664        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11665                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11666     END-IF
 11667
 11668     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11669        IF CF-ST-RF-CP-CALC > '0'
 11670           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11671                                    EC-ST-AH-REFUND-CALC
 11672        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 213
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11673     ELSE
 11674        IF CF-ST-RF-AH-CALC > '0'
 11675           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11676                                    EC-ST-AH-REFUND-CALC
 11677        END-IF
 11678     END-IF
 11679     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11680     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11681                                                                  ELC50PD
 11682     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11683                                                                  ELC50PD
 11684     IF NO-BENEFIT-FOUND                                          ELC50PD
 11685        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11686                                                                  ELC50PD
 11687     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11688        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11689                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11690                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11691     END-IF
 11692                                                                  ELC50PD
 11693     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11694        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11695                                 TO WS-AH-REFUND-CALC             ELC50PD
 11696                                    EC-ST-AH-REFUND-CALC
 11697     END-IF
 11698                                                                  ELC50PD
 11699*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11700                                                                  ELC50PD
 11701     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11702                                                                  ELC50PD
 11703 0499-STATE-NOT-FOUND.                                            ELC50PD
 11704                                                                  ELC50PD
 11705     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11706     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11707                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 214
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11709                                                                  ELC50PD
 11710 0500-SET-ACCOUNT.                                                ELC50PD
 11711
 11712*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11713
 11714     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11715        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11716        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11717        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11718        MOVE '3'                 TO CNTL-REC-TYPE
 11719        MOVE +0                  TO CNTL-SEQ-NO
 11720
 11721        MOVE '3'                 TO RC-SW-2
 11722        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11723
 11724        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11725           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11726           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11727           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11728                                    WS-ST-AH-PREM-TAX-I
 11729                                    WS-ST-AH-PREM-TAX-G
 11730        ELSE
 11731           IF CF-ST-LF-PREM-TAX NUMERIC
 11732              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11733           END-IF
 11734           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11735              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11736           END-IF
 11737           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11738              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11739           END-IF
 11740        END-IF
 11741        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11742     END-IF
 11743
 11744*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11745*  FOR DCC ONLY
 11746
 11747     IF PB-COMPANY-ID = 'DCC'
 11748
 11749     MOVE ' '                    TO STAT-MASTER-SW
 11750     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11751     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11752     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11753     MOVE PB-STATE               TO ELSTAT-STATE
 11754     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11755        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11756     END-IF
 11757
 11758     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11759     SET BIN-TO-GREG             TO TRUE
 11760     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11761     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11762     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11763
 11764     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11765     IF STAT-MASTER-FOUND
 11766        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 215
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11767        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11768        IF STAT-MASTER-FOUND
 11769           IF (ELSTAT-KEY-SAVE (1:12) =
 11770                        SF-CONTROL-PRIMARY (1:12))
 11771              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11772                 MOVE 'F'        TO STAT-MASTER-SW
 11773              ELSE
 11774                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11775                 IF (STAT-MASTER-FOUND)
 11776                    AND (ELSTAT-KEY-SAVE (1:12) =
 11777                        SF-CONTROL-PRIMARY (1:12))
 11778                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11779                    MOVE 'F'     TO STAT-MASTER-SW
 11780                 END-IF
 11781              END-IF
 11782           END-IF
 11783        END-IF
 11784     END-IF
 11785
 11786     IF STAT-MASTER-SW = 'F'
 11787        IF SF-ST-LF-PREM-TAX NUMERIC
 11788           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11789        END-IF
 11790        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11791           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11792        END-IF
 11793        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11794           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11795        END-IF
 11796     END-IF
 11797
 11798     END-IF
 11799
 11800     IF (PB-COMPANY-ID = 'DCC')
 11801        AND (PB-ISSUE)
 11802        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11803        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11804        AND (AM-GPCD = 06)
 11805        MOVE 'Y'                 TO WS-GOOD-HIN
 11806        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11807           MOVE PB-I-VIN         TO WS-WORK-VIN
 11808           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11809              (V1 > 16)
 11810              IF WS-WORK-VIN (V1:1) NUMERIC
 11811                 MOVE WS-WORK-VIN-N (V1)
 11812                                 TO WS-ROW-B-VAL (V1)
 11813              ELSE
 11814                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11815                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11816                    OR (V2 > 26)
 11817                 END-PERFORM
 11818                 IF V2 < 27
 11819                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11820                 ELSE
 11821                    MOVE 'N'     TO WS-GOOD-HIN
 11822                 END-IF
 11823              END-IF
 11824              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 216
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11825                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11826              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11827                 WS-ROW-D-VAL (V1)
 11828           END-PERFORM
 11829           MOVE ZEROS            TO WS-VIN-REMAINDER
 11830           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11831             REMAINDER WS-VIN-REMAINDER
 11832           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11833              CONTINUE
 11834           ELSE
 11835              MOVE 'N'           TO WS-GOOD-HIN
 11836           END-IF
 11837        ELSE
 11838           MOVE 'N'              TO WS-GOOD-HIN
 11839        END-IF
 11840        IF WS-GOOD-HIN NOT = 'Y'
 11841           MOVE ER-3826           TO WS-ERROR
 11842           PERFORM 9900-ERROR-FORMAT
 11843                                 THRU 9900-EXIT
 11844        END-IF
 11845     END-IF
 11846
 11847     IF (PB-COMPANY-ID = 'DCC')
 11848        AND (PB-ISSUE)
 11849        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11850        AND (AM-GPCD NOT = 06)
 11851        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11852          MOVE PB-I-VIN          TO WS-WORK-VIN
 11853          MOVE +8                TO V2
 11854          MOVE ZEROS             TO WS-VIN-TOTAL
 11855          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11856           (V1 > 17)
 11857             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11858                MOVE ER-3825     TO WS-ERROR
 11859                PERFORM 9900-ERROR-FORMAT
 11860                                 THRU 9900-EXIT
 11861             ELSE
 11862                IF V1 = 8
 11863                   MOVE 10       TO V2
 11864                END-IF
 11865                IF V1 = 9
 11866                   MOVE 0        TO V2
 11867                END-IF
 11868                IF V1 = 10
 11869                   MOVE 9        TO V2
 11870                END-IF
 11871                IF WS-WORK-VIN (V1:1) NUMERIC
 11872                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11873                    + (WS-WORK-VIN-N (V1) * V2)
 11874                ELSE
 11875                   MOVE WS-WORK-VIN (V1:1)
 11876                                 TO WS-HEX-BYTE
 11877                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11878                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11879                    + (WS-NUM (V3) * V2)
 11880                END-IF
 11881                COMPUTE V2 = V2 - 1
 11882             END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 217
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11883          END-PERFORM
 11884          MOVE ZEROS TO WS-VIN-REMAINDER
 11885          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11886             REMAINDER WS-VIN-REMAINDER
 11887          IF ((WS-WORK-VIN (9:1) = 'X')
 11888             AND (WS-VIN-REMAINDER = 10))
 11889                     OR
 11890             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11891             CONTINUE
 11892          ELSE
 11893             MOVE ER-3826        TO WS-ERROR
 11894             PERFORM 9900-ERROR-FORMAT
 11895                                 THRU 9900-EXIT
 11896          END-IF
 11897        ELSE
 11898          MOVE ER-3826           TO WS-ERROR
 11899          PERFORM 9900-ERROR-FORMAT
 11900                                 THRU 9900-EXIT
 11901        END-IF
 11902     END-IF
 11903
 11904
 11905
 11906******************************************************************ELC50PD
 11907******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11908******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11909******* METHODS.                                                  ELC50PD
 11910******************************************************************ELC50PD
 11911     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11912        IF PB-CANCELLATION                                        ELC50PD
 11913           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11914              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11915                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11916                IF FORM-MASTER-FOUND                              ELC50PD
 11917                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11918******************************************************************ELC50PD
 11919                                                                  ELC50PD
 11920     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11921     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11922                                                                  ELC50PD
 11923     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11924     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11925     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11926     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11927                                                                  ELC50PD
 11928                                                                  ELC50PD
 11929     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11930     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11931     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11932                                                                  ELC50PD
 11933     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11934         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11935                                                                  ELC50PD
 11936     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11937         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11938                                                                  ELC50PD
 11939     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11940         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 218
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11941                                                                  ELC50PD
 11942     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11943         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11944     ELSE                                                         ELC50PD
 11945         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11946                                                                  ELC50PD
 11947     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11948                                                                  ELC50PD
 11949     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11950         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11951                                                                  ELC50PD
 11952     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11953         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11954                                       WS-IG-OVRD                 ELC50PD
 11955     ELSE                                                         ELC50PD
 11956         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11957             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11958                                       WS-IG-OVRD                 ELC50PD
 11959         ELSE                                                     ELC50PD
 11960             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11961                                       WS-IG-OVRD.                ELC50PD
 11962                                                                  ELC50PD
 11963     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11964         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11965                                       WS-IG-OVRD                 ELC50PD
 11966     ELSE                                                         ELC50PD
 11967         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11968             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11969                                       WS-IG-OVRD                 ELC50PD
 11970         ELSE                                                     ELC50PD
 11971             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11972                                       WS-IG-OVRD.                ELC50PD
 11973                                                                  ELC50PD
 11974     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11975     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11976     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11977     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11978     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11979                                                                  ELC50PD
 11980     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11981     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11982     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11983     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11984                                                                  ELC50PD
 11985     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11986     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11987     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11988     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11989     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11990     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11991     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11992                                                                  ELC50PD
 11993     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11994        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11995     ELSE                                                         ELC50PD
 11996        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11997                                                                  ELC50PD
 11998     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 219
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11999        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 12000     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 12001        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 12002                                                                  ELC50PD
 12003        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 12004            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 12005                                        WS-LF-REFUND-CALC.        ELC50PD
 12006                                                                  ELC50PD
 12007        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 12008            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 12009                                        WS-LF-REFUND-CALC.        ELC50PD
 12010                                                                  ELC50PD
 12011     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 12012         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 12013            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12014                                    WS-LF-REFUND-CALC.            ELC50PD
 12015     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 12016         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 12017            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12018                                    WS-LF-REFUND-CALC.            ELC50PD
 12019     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12020         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 12021            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12022                                    WS-LF-REFUND-CALC.            ELC50PD
 12023     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12024         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 12025            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12026                                    WS-LF-REFUND-CALC.            ELC50PD
 12027     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 12028         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 12029            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12030                                    WS-LF-REFUND-CALC.            ELC50PD
 12031     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 12032         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 12033            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12034                                    WS-LF-REFUND-CALC.            ELC50PD
 12035     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12036         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 12037            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12038                                    WS-LF-REFUND-CALC.            ELC50PD
 12039     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12040         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 12041            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12042                                    WS-LF-REFUND-CALC.            ELC50PD
 12043                                                                  ELC50PD
 12044     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 12045        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12046                                    WS-AH-REFUND-CALC.            ELC50PD
 12047     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 12048        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12049                                    WS-AH-REFUND-CALC.            ELC50PD
 12050     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 12051        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12052                                    WS-AH-REFUND-CALC.            ELC50PD
 12053     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 12054        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12055                                    WS-AH-REFUND-CALC.            ELC50PD
 12056     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 220
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12057        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12058                                    WS-AH-REFUND-CALC.            ELC50PD
 12059     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 12060        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12061                                    WS-AH-REFUND-CALC.            ELC50PD
 12062     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 12063        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12064                                    WS-AH-REFUND-CALC.            ELC50PD
 12065                                                                  ELC50PD
 12066     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 12067        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 12068                                    WS-TOL-AH-PREM.               ELC50PD
 12069                                                                  ELC50PD
 12070     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 12071                  AM-OVR-SHT-AMT > 0                              ELC50PD
 12072        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 12073                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 12074                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 12075                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 12076                                                                  ELC50PD
 12077     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 12078                    AM-OVR-SHT-PCT > 0                            ELC50PD
 12079        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 12080                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 12081                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 12082                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 12083                                                                  ELC50PD
 12084     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 12085                  AM-TOL-REF-PCT > 0                              ELC50PD
 12086        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 12087                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 12088                                                                  ELC50PD
 12089     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 12090                  AM-TOL-REF NUMERIC                              ELC50PD
 12091        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 12092                                    EC-AM-LF-TOL-REFUND           ELC50PD
 12093                                    WS-TOL-AH-REFUND              ELC50PD
 12094                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 12095                                                                  ELC50PD
 12096     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 12097        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 12098                                    WS-TOL-AH-CLAIM.              ELC50PD
 12099                                                                  ELC50PD
 12100     IF AM-CLP-TOL-PCT NOT NUMERIC
 12101        MOVE +0                  TO AM-CLP-TOL-PCT
 12102     END-IF
 12103
 12104     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12105        MOVE +0                  TO AM-SPP-LEASE-COMM
 12106     END-IF
 12107
 12108     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12109        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12110                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12111                                                                  ELC50PD
 12112     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12113        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12114                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 221
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12115                                                                  ELC50PD
 12116     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12117        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12118                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12119                                                                  ELC50PD
 12120     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12121        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12122                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12123                                                                  ELC50PD
 12124     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12125        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12126                                                                  ELC50PD
 12127     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12128        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12129                                                                  ELC50PD
 12130     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12131        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12132     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12133        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12134     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12135        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12136     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12137        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12138     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12139        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12140     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12141        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12142                                                                  ELC50PD
 12143     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12144        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12145                                                                  ELC50PD
 12146     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12147        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12148                                                                  ELC50PD
 12149     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12150     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12151                                                                  ELC50PD
 12152     IF PB-CANCELLATION                                           ELC50PD
 12153        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12154                                                                  ELC50PD
 12155     MOVE +1 TO SUB1.                                             ELC50PD
 12156     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12157     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12158                                                                  ELC50PD
 12159     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12160       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12161         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12162        ELSE                                                      ELC50PD
 12163         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12164                                                                  ELC50PD
 12165  0525-FIND-ACCT-COMM.                                            ELC50PD
 12166     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12167        NEXT SENTENCE                                             ELC50PD
 12168      ELSE                                                        ELC50PD
 12169         ADD +1 TO SUB1                                           ELC50PD
 12170         IF SUB1 LESS +11                                         ELC50PD
 12171            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12172          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 222
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12173             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12174                                                                  ELC50PD
 12175     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12176     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12177                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12178***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12179     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12180         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12181                                                                  ELC50PD
 12182     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12183     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12184                                                                  ELC50PD
 12185                                                                  ELC50PD
 12186 0530-GET-AH-COMP.                                                ELC50PD
 12187     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12188        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12189           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12190                                                                  ELC50PD
 12191     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12192        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12193         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12194         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12195         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12196         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12197     ELSE                                                         ELC50PD
 12198          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12199          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12200          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12201          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12202                                    WS-COMMISSION                 ELC50PD
 12203          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12204          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12205          IF WS-COMMISSION > ZEROS                                ELC50PD
 12206             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12207             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12208          END-IF                                                  ELC50PD
 12209          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12210          IF CTBL-TABLE-FOUND                                     ELC50PD
 12211             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12212                                        PB-I-AH-TERM              ELC50PD
 12213             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12214             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12215             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12216          ELSE                                                    ELC50PD
 12217             IF FIRST-TIME-THROUGH                                ELC50PD
 12218                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12219             ELSE                                                 ELC50PD
 12220                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12221                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12222                                                                  ELC50PD
 12223 0540-NEXT-READ-STEP.                                             ELC50PD
 12224     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12225     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12226                                                                  ELC50PD
 12227 0540-GET-LF-COMP.                                                ELC50PD
 12228     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12229        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12230           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 223
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12231                                                                  ELC50PD
 12232     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12233        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12234           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12235           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12236           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12237           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12238           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12239        ELSE                                                      ELC50PD
 12240           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12241           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12242           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12243           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12244                                        WS-COMMISSION             ELC50PD
 12245           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12246           IF WS-COMMISSION > ZEROS                               ELC50PD
 12247              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12248              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12249           END-IF                                                 ELC50PD
 12250           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12251           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12252           IF CTBL-TABLE-FOUND                                    ELC50PD
 12253              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12254              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12255              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12256              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12257           ELSE                                                   ELC50PD
 12258              IF FIRST-TIME-THROUGH                               ELC50PD
 12259                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12260              ELSE                                                ELC50PD
 12261                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12262                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12263                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12264                                                                  ELC50PD
 12265     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12266        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12267           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12268           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12269           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12270           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12271           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12272        ELSE                                                      ELC50PD
 12273           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12274           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12275           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12276           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12277                                        WS-COMMISSION             ELC50PD
 12278           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12279           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12280              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12281              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12282           END-IF                                                 ELC50PD
 12283           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12284           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12285           IF CTBL-TABLE-FOUND                                    ELC50PD
 12286              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12287              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12288              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 224
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12289              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12290           ELSE                                                   ELC50PD
 12291              IF FIRST-TIME-THROUGH                               ELC50PD
 12292                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12293              ELSE                                                ELC50PD
 12294                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12295                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12296                                                                  ELC50PD
 12297*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12298                                                                  ELC50PD
 12299 0560-EDIT-CONTINUE.                                              ELC50PD
 12300
 12301     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12302                                    WS-AH-PMF-COMM
 12303*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12304*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12305
 12306     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12307        (SUB1 > +10)
 12308        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12309           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12310           MOVE '0530'           TO CTBL-SW
 12311           MOVE ' '              TO WS-CTBL-READ-SW
 12312           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12313           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12314           MOVE '0540'           TO CTBL-SW
 12315           MOVE ' '              TO WS-CTBL-READ-SW
 12316           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12317        END-IF
 12318     END-PERFORM
 12319
 12320     GO TO 0564-EDIT-CONTINUE
 12321
 12322     .
 12323 0561-CHECK-AH.
 12324
 12325     IF (NO-AH-COVERAGE)
 12326        OR (NO-AH-BENEFIT-MATCH)
 12327        CONTINUE
 12328     ELSE
 12329        IF (AM-A-COM (SUB1) NUMERIC)
 12330           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12331           IF (AM-COM-TYP (SUB1) = 'A')
 12332              AND (WS-AH-PMF-COMM = ZEROS)
 12333              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12334           END-IF
 12335           CONTINUE
 12336        ELSE
 12337           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12338           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12339           MOVE PB-AH-OVERRIDE-L1
 12340                                 TO CTBL-BEN-TYPE
 12341           MOVE ZEROS            TO WS-SUB1
 12342                                    WS-COMMISSION
 12343           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12344           PERFORM 8300-READ-CTBL-TABLE
 12345                                 THRU 8300-EXIT
 12346           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 225
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12347              IF (AM-COM-TYP (SUB1) = 'A')
 12348                 AND (WS-AH-PMF-COMM = ZEROS)
 12349                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12350                                        PB-I-AH-TERM
 12351                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12352                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12353              END-IF
 12354              CONTINUE
 12355           ELSE
 12356              IF FIRST-TIME-THROUGH
 12357                 GO TO 0561-CHECK-AH
 12358              ELSE
 12359                 MOVE ER-2609    TO WS-ERROR
 12360                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12361              END-IF
 12362           END-IF
 12363        END-IF
 12364     END-IF
 12365
 12366     .
 12367 0561-EXIT.
 12368     EXIT.
 12369
 12370 0563-CHECK-LF.
 12371
 12372     IF (NO-LIFE-COVERAGE)
 12373        OR (NO-LF-BENEFIT-MATCH)
 12374        CONTINUE
 12375     ELSE
 12376        IF WS-LF-JOINT-INDICATOR = 'J'
 12377           IF AM-J-COM (SUB1) NUMERIC
 12378              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12379              IF (AM-COM-TYP (SUB1) = 'A')
 12380                 AND (WS-LF-PMF-COMM = ZEROS)
 12381                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12382              END-IF
 12383              CONTINUE
 12384           ELSE
 12385              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12386              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12387              MOVE PB-LIFE-OVERRIDE-L1
 12388                                 TO CTBL-BEN-TYPE
 12389              MOVE ZEROS         TO WS-SUB1
 12390                                    WS-COMMISSION
 12391              MOVE AM-J-COMA (SUB1)
 12392                                 TO CTBL-TABLE
 12393              PERFORM 8300-READ-CTBL-TABLE
 12394                                 THRU 8300-EXIT
 12395              IF CTBL-TABLE-FOUND
 12396                 IF (AM-COM-TYP (SUB1) = 'A')
 12397                    AND (WS-LF-PMF-COMM = ZEROS)
 12398                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12399                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12400                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12401                 END-IF
 12402                 CONTINUE
 12403              ELSE
 12404                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 226
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12405                    GO TO 0563-CHECK-LF
 12406                 ELSE
 12407                    MOVE ER-2609 TO WS-ERROR
 12408                    PERFORM 9900-ERROR-FORMAT
 12409                                 THRU 9900-EXIT
 12410*                   GO TO 0560-EDIT-CONTINUE
 12411                 END-IF
 12412              END-IF
 12413           END-IF
 12414        ELSE
 12415           IF AM-L-COM (SUB1) NUMERIC
 12416              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12417              IF (AM-COM-TYP (SUB1) = 'A')
 12418                 AND (WS-LF-PMF-COMM = ZEROS)
 12419                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12420              END-IF
 12421              CONTINUE
 12422           ELSE
 12423              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12424              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12425              MOVE PB-LIFE-OVERRIDE-L1
 12426                                 TO CTBL-BEN-TYPE
 12427              MOVE ZEROS         TO WS-SUB1
 12428                                    WS-COMMISSION
 12429              MOVE AM-L-COMA (SUB1)
 12430                                 TO CTBL-TABLE
 12431              PERFORM 8300-READ-CTBL-TABLE
 12432                                 THRU 8300-EXIT
 12433              IF CTBL-TABLE-FOUND
 12434                 CONTINUE
 12435              ELSE
 12436                 IF FIRST-TIME-THROUGH
 12437                    GO TO 0563-CHECK-LF
 12438                 ELSE
 12439                    MOVE ER-2609 TO WS-ERROR
 12440                    PERFORM 9900-ERROR-FORMAT
 12441                                 THRU 9900-EXIT
 12442                 END-IF
 12443              END-IF
 12444           END-IF
 12445        END-IF
 12446     END-IF
 12447
 12448     .
 12449 0563-EXIT.
 12450     EXIT.
 12451
 12452 0564-EDIT-CONTINUE.
 12453                                                                  ELC50PD
 12454     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12455         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12456            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12457            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12458                                                                  ELC50PD
 12459*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12460*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12461*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12462*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 227
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12463*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12464*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12465*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12466*         ELSE                                                    ELC50PD
 12467*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12468*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12469
 12470     IF PB-I-BIRTHDAY > LOW-VALUES
 12471        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12472        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12473        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12474        PERFORM 8500-DATE-CONVERT
 12475                                 THRU 8500-EXIT
 12476        IF NO-CONVERSION-ERROR
 12477           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12478           IF PB-I-AGE > ZEROS
 12479              IF WS-WORK-AGE NOT = PB-I-AGE
 12480                 MOVE ER-9501    TO WS-ERROR
 12481                 PERFORM 9900-ERROR-FORMAT
 12482                                 THRU 9900-EXIT
 12483              END-IF
 12484           ELSE
 12485              MOVE WS-WORK-AGE   TO PB-I-AGE
 12486           END-IF
 12487        END-IF
 12488     END-IF
 12489
 12490     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12491                                   WS-INS-AGE-SET
 12492     IF PB-I-AGE = ZEROS                                          ELC50PD
 12493        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12494           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12495                                   WS-INS-AGE-SET
 12496           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12497                                                                  ELC50PD
 12498     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12499                                   WS-AH-EDIT-AGE.                ELC50PD
 12500                                                                  ELC50PD
 12501     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12502        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12503        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12504        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12505        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12506        IF NO-CONVERSION-ERROR
 12507           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12508           IF PB-I-JOINT-AGE > 0
 12509              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12510                 MOVE ER-9503    TO WS-ERROR
 12511                 PERFORM 9900-ERROR-FORMAT
 12512                                 THRU 9900-EXIT
 12513              END-IF
 12514           ELSE
 12515              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12516           END-IF
 12517        ELSE
 12518           MOVE ZEROS            TO PB-I-JOINT-AGE
 12519        END-IF
 12520     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 228
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12521
 12522     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12523        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12524                                                                  ELC50PD
 12525     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12526                                   WS-JNT-AGE-SET
 12527     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12528        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12529           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12530           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12531               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12532                                          WS-JNT-AGE-SET
 12533               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12534           END-IF
 12535        END-IF
 12536     END-IF
 12537                                                                  ELC50PD
 12538     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12539     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12540        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12541        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12542            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12543                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12544                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12545            ELSE                                                  ELC50PD
 12546                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12547                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12548                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12549                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12550                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12551                                                                  ELC50PD
 12552     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12553        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12554            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12555                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12556                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12557            ELSE                                                  ELC50PD
 12558                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12559                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12560                                           WS-EDIT-AGE
 12561                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12562                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12563                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12564                                                                  ELC50PD
 12565******************************************************************ELC50PD
 12566*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12567******************************************************************ELC50PD
 12568                                                                  ELC50PD
 12569     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12570        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12571        NEXT SENTENCE                                             ELC50PD
 12572     ELSE                                                         ELC50PD
 12573        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12574          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12575           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12576            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12577           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12578            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 229
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12579            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12580                                                                  ELC50PD
 12581     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12582        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12583         NEXT SENTENCE                                            ELC50PD
 12584     ELSE                                                         ELC50PD
 12585         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12586            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12587             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12588                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12589                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12590                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12591                                                                  ELC50PD
 12592     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12593        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12594           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12595           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12596               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12597                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12598                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12599                                                                  ELC50PD
 12600     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12601        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12602           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12603            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12604                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12605                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12606                                                                  ELC50PD
 12607     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12608        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12609           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12610              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12611              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12612              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12613                                                                  ELC50PD
 12614     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12615        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12616           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12617              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12618              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12619              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12620                                                                  ELC50PD
 12621     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12622         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12623            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12624              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12625              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12626
 12627     IF (WS-LF-JOINT-INDICATOR = 'J')
 12628        AND (WS-AH-JOINT-INDICATOR = 'J')
 12629        AND (PB-I-LF-TERM > 120)
 12630        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12631        MOVE ER-2783             TO WS-ERROR
 12632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12633     END-IF
 12634
 12635     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12636                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 230
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12637     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12638        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12640        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12641                                                                  ELC50PD
 12642     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12643        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12645        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12646                                                                  ELC50PD
 12647     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12648        NEXT SENTENCE                                             ELC50PD
 12649     ELSE                                                         ELC50PD
 12650        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12651                                                                  ELC50PD
 12652     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12653        IF WS-ERROR = ER-2666                                     ELC50PD
 12654           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12655           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12656
 12657     IF PB-COMPANY-ID = 'CID'
 12658        IF PB-STATE = 'UT' OR 'MO'
 12659           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12660                 OR '76' OR '77')
 12661                      OR
 12662               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12663                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12664                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12665                   OR '2K' OR '2L'))
 12666              AND PB-I-INDV-GRP-CD = 'I'
 12667              MOVE ER-2721             TO WS-ERROR
 12668              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12669           END-IF
 12670        END-IF
 12671     END-IF
 12672                                                                  ELC50PD
 12673     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12674     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12675        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12676     ELSE
 12677        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12678     END-IF
 12679
 12680*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12681*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12682     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12683                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12684                                                                  ELC50PD
 12685     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12686        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12687        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12688        PB-POLICY-IS-VOIDED                                       ELC50PD
 12689*       OR PB-MONTHLY-CERT
 12690         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12691                                                                  ELC50PD
 12692     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12693        IF WS-EDIT-AGE           > +65
 12694           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 231
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12695           PERFORM 9900-ERROR-FORMAT
 12696                                 THRU 9900-EXIT
 12697        ELSE
 12698           IF WS-EDIT-AGE        > +55
 12699              MOVE ER-2718       TO WS-ERROR
 12700              PERFORM 9900-ERROR-FORMAT
 12701                                 THRU 9900-EXIT
 12702           END-IF
 12703        END-IF
 12704
 12705     IF PB-COMPANY-ID = 'DCC'
 12706        IF WS-EDIT-AGE           > +65
 12707           MOVE ER-2709          TO WS-ERROR
 12708           PERFORM 9900-ERROR-FORMAT
 12709                                 THRU 9900-EXIT
 12710        END-IF
 12711     END-IF
 12712     .
 12713
 12714 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12715                                                                  ELC50PD
 12716     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12717        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12718                                    EC-AM-LF-MAX-TOT-BEN
 12719        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12720                                                                  ELC50PD
 12721     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12722                                                                  ELC50PD
 12723     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12724         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12725             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12726                                                                  ELC50PD
 12727     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12728        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12729        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12730        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12731                                                                  ELC50PD
 12732     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12733     MOVE +1                     TO SUB2.                         ELC50PD
 12734                                                                  ELC50PD
 12735     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12736        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12737           MOVE +5   TO SUB2                                      ELC50PD
 12738           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12739              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12740              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12741              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12742              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12743                                                                  ELC50PD
 12744     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12745                                                                  ELC50PD
 12746     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12747                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12748                                                                  ELC50PD
 12749 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12750                                                                  ELC50PD
 12751
 12752     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 232
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12753        PL-ATT-AGE > +0
 12754        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12755     END-IF
 12756
 12757
 12758
 12759*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12760*       PL-ATT-AGE > +0
 12761*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12762*       IF PB-I-BIRTHDAY > LOW-VALUES
 12763*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12764*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12765*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12766*          SET BIN-PLUS-ELAPSED  TO TRUE
 12767*          PERFORM 8500-DATE-CONVERT
 12768*                                THRU 8500-EXIT
 12769*          IF NO-CONVERSION-ERROR
 12770*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12771*             MOVE ER-2669       TO WS-ERROR
 12772*             PERFORM 9900-ERROR-FORMAT
 12773*                                THRU 9900-EXIT
 12774*          END-IF
 12775*       ELSE
 12776*          IF WS-ATT-AGE >= PL-ATT-AGE
 12777*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12778*             PERFORM 9900-ERROR-FORMAT
 12779*                                THRU 9900-EXIT
 12780*          END-IF
 12781*       END-IF
 12782*    END-IF
 12783
 12784     .
 12785 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12786                                                                  ELC50PD
 12787     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12788        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12789           IF SUB2 GREATER THAN +4                                ELC50PD
 12790              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12792              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12793                                                                  ELC50PD
 12794     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12795        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12796            SUB2 GREATER THAN +8                                  ELC50PD
 12797             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12798             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12799             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12800             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12801                                                                  ELC50PD
 12802     IF SUB2 > +8
 12803        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12804           AND (PB-I-SIG-SW = 'Y')
 12805           CONTINUE
 12806        ELSE
 12807           MOVE ER-2637          TO WS-ERROR
 12808           PERFORM 9900-ERROR-FORMAT
 12809                                 THRU 9900-EXIT
 12810        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 233
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12811        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12812     END-IF
 12813
 12814     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12815     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12816     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12817                                                                  ELC50PD
 12818     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12819        ADD +1  TO SUB2                                           ELC50PD
 12820        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12821                                                                  ELC50PD
 12822     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12823         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12824                                                                  ELC50PD
 12825     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12826        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12827        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12828           AND (PB-I-SIG-SW = 'Y')
 12829           CONTINUE
 12830        ELSE
 12831           MOVE ER-2637          TO WS-ERROR
 12832           PERFORM 9900-ERROR-FORMAT
 12833                                 THRU 9900-EXIT
 12834        END-IF
 12835     END-IF
 12836
 12837     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12838                                                                  ELC50PD
 12839                                                                  ELC50PD
 12840 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12841                                                                  ELC50PD
 12842     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12843        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12844         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12845                                                                  ELC50PD
 12846     IF APP-CERT-USED                                             ELC50PD
 12847         IF SUB2  LESS THAN  +5                                   ELC50PD
 12848             MOVE +5          TO SUB2                             ELC50PD
 12849             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12850                                                                  ELC50PD
 12851     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12852     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12853                                                                  ELC50PD
 12854     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12855                                                                  ELC50PD
 12856 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12857                                                                  ELC50PD
 12858     IF NOT APP-CERT-USED                                         ELC50PD
 12859         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12860                                                                  ELC50PD
 12861     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12862        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12863        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12864        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12865         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12866                                                                  ELC50PD
 12867     IF SUB2 GREATER THAN +4                                      ELC50PD
 12868         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 234
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12869            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12870            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12871            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12872             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12873             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12874             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12875         ELSE                                                     ELC50PD
 12876             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12877                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12878                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12879                                                                  ELC50PD
 12880     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12881       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12882          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12883           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12884           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12885           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12886                                                                  ELC50PD
 12887                                                                  ELC50PD
 12888 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12889                                                                  ELC50PD
 12890     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12891        IF PB-I-AH-BENEFIT-AMT > +1250
 12892           MOVE ER-2702          TO WS-ERROR
 12893           PERFORM 9900-ERROR-FORMAT
 12894                                 THRU 9900-EXIT
 12895        END-IF
 12896     END-IF
 12897
 12898     IF (PB-COMPANY-ID = 'DCC')
 12899        AND (PB-MONTHLY-CERT)
 12900        IF PB-I-AH-BENEFIT-AMT > +3000
 12901           MOVE ER-2881          TO WS-ERROR
 12902           PERFORM 9900-ERROR-FORMAT
 12903                                 THRU 9900-EXIT
 12904        END-IF
 12905     END-IF
 12906
 12907     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12908        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12909        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12910                                                                  ELC50PD
 12911     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12912                                                                  ELC50PD
 12913     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12914         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12915             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12916                                                                  ELC50PD
 12917     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12918        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12919        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12920        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12921                                                                  ELC50PD
 12922     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12923     MOVE +1                     TO SUB2.                         ELC50PD
 12924                                                                  ELC50PD
 12925     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12926        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 235
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12927           MOVE +5 TO SUB2                                        ELC50PD
 12928           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12929              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12930              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12931              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12932              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12933              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12934                                                                  ELC50PD
 12935     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12936                                                                  ELC50PD
 12937 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12938                                                                  ELC50PD
 12939     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12940        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12941        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12942     END-IF
 12943*       IF WS-ATT-AGE >= PL-ATT-AGE
 12944*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12945*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12946     .
 12947 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12948                                                                  ELC50PD
 12949     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12950        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12951           IF SUB2 GREATER THAN +4                                ELC50PD
 12952              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12953              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12954              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12955                                                                  ELC50PD
 12956     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12957        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12958            SUB2 GREATER THAN +8                                  ELC50PD
 12959             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12960             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12961             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12962             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12963                                                                  ELC50PD
 12964     IF SUB2 > +8
 12965        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12966           AND (PB-I-SIG-SW = 'Y')
 12967           CONTINUE
 12968        ELSE
 12969           MOVE ER-2638          TO WS-ERROR
 12970           PERFORM 9900-ERROR-FORMAT
 12971                                 THRU 9900-EXIT
 12972        END-IF
 12973        GO TO 3000-CONTINUE-EDIT
 12974     END-IF
 12975                                                                  ELC50PD
 12976     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12977        IF WS-ERROR = ER-2638                                     ELC50PD
 12978           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12979                                                                  ELC50PD
 12980     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12981     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12982     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12983     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12984                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 236
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12985     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12986        ADD +1                   TO SUB2                          ELC50PD
 12987        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12988                                                                  ELC50PD
 12989     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12990         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12991                                                                  ELC50PD
 12992     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12993        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12994        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12995                                 > PL-LM-AMT (SUB2))
 12996        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12997           AND (PB-I-SIG-SW = 'Y')
 12998           CONTINUE
 12999        ELSE
 13000           MOVE ER-2638          TO WS-ERROR
 13001           PERFORM 9900-ERROR-FORMAT
 13002                                 THRU 9900-EXIT
 13003        END-IF
 13004     END-IF
 13005                                                                  ELC50PD
 13006     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 13007         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 13008             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 13009                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 13010                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 13011                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 13012                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 13013                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 13014                                                                  ELC50PD
 13015     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 13016        IF WS-ERROR = ER-2638                                     ELC50PD
 13017            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 13018            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 13019            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 13020                                                                  ELC50PD
 13021     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 13022                                                                  ELC50PD
 13023 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 13024                                                                  ELC50PD
 13025     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 13026        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 13027        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 13028                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 13029         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 13030                                                                  ELC50PD
 13031     IF APP-CERT-USED                                             ELC50PD
 13032         IF SUB2  LESS THAN  +5                                   ELC50PD
 13033             MOVE +5             TO SUB2                          ELC50PD
 13034             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 13035                                                                  ELC50PD
 13036     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 13037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13038                                                                  ELC50PD
 13039     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 13040                                                                  ELC50PD
 13041 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 13042                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 237
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13043     IF NOT APP-CERT-USED                                         ELC50PD
 13044         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13045                                                                  ELC50PD
 13046     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 13047        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 13048        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 13049        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 13050         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13051                                                                  ELC50PD
 13052     IF SUB2 GREATER THAN +4                                      ELC50PD
 13053         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 13054            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 13055            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 13056            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 13057             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 13058             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13059             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 13060         ELSE                                                     ELC50PD
 13061             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 13062                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 13063                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 13064                                                                  ELC50PD
 13065     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 13066       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 13067          NOT PB-I-POLICY-DECLINED                                ELC50PD
 13068           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 13069           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 13070           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 13071                                                                  ELC50PD
 13072******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 238
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13074                                                                  ELC50PD
 13075 3000-CONTINUE-EDIT.                                              ELC50PD
 13076                                                                  ELC50PD
 13077     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 13078     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 13079     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 13080     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 13081     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 13082                                                                  ELC50PD
 13083     IF BROWSE-STARTED                                            ELC50PD
 13084        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 13085        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 13086                                                                  ELC50PD
 13087     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 13088        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 13089        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 13090        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 13091*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 13092        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13093        IF DATE-CONVERSION-ERROR                                  ELC50PD
 13094           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 13095           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13096        ELSE                                                      ELC50PD
 13097           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 13098              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 13099              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13100           ELSE                                                   ELC50PD
 13101              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13102              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13103                                                                  ELC50PD
 13104     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13105     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13106     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13107*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13108     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13109     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13110        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13111     ELSE                                                         ELC50PD
 13112        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13113           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13114           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13115        ELSE                                                      ELC50PD
 13116           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13117              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13118              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13119           ELSE                                                   ELC50PD
 13120             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13121                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13122                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13123                                                                  ELC50PD
 13124 3005-EDIT-CONTINUE.                                              ELC50PD
 13125                                                                  ELC50PD
 13126     IF PB-CANCELLATION                                           ELC50PD
 13127         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13128                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 239
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13130******************************************************************ELC50PD
 13131*                  E D I T   I S S U E                           *ELC50PD
 13132******************************************************************ELC50PD
 13133                                                                  ELC50PD
 13134 3020-EDIT-ISSUE.                                                 ELC50PD
 13135                                                                  ELC50PD
 13136      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13137      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13138      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13139      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13140      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13141                                                                  ELC50PD
 13142     IF PB-ISSUE-FORCE
 13143        OR PB-ISSUE-DATE-FORCED
 13144        OR PB-FORCE-OFF
 13145        OR PB-OVERCHARGE-FORCE
 13146        CONTINUE
 13147     ELSE
 13148        MOVE ER-2670             TO WS-ERROR
 13149        PERFORM 9900-ERROR-FORMAT
 13150                                 THRU 9900-EXIT
 13151     END-IF
 13152
 13153     .
 13154 3022-SET-POLICY-STATUS.                                          ELC50PD
 13155                                                                  ELC50PD
 13156     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13157                                                                  ELC50PD
 13158     IF (PB-REISSUED-CERT)
 13159             OR
 13160        ((PB-COMPANY-ID NOT = 'DCC')
 13161         AND (PB-MONTHLY-CERT))
 13162         MOVE '5'                TO PB-I-ENTRY-STATUS
 13163         MOVE 'E'                TO PB-BATCH-ENTRY
 13164     END-IF
 13165
 13166     IF PB-COMPANY-ID = 'DCC'
 13167        IF PB-MONTHLY-CERT
 13168           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13169        END-IF
 13170     END-IF
 13171     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13172         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13173     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13174         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13175     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13176         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13177     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13178         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13179     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13180         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13181                                                                  ELC50PD
 13182     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13183                                                                  ELC50PD
 13184     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13185         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13186         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13187         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 240
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13188                                                                  ELC50PD
 13189     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13190        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13191           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13192                                                                  ELC50PD
 13193     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13194        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13195           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13196                                                                  ELC50PD
 13197     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13198         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13199         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13200         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13201         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13202         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13203         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13204         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13205     END-IF
 13206                                                                  ELC50PD
 13207     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13208        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13209         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13210                                                                  ELC50PD
 13211     IF (ACCOUNT-MAST-FOUND)
 13212        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13213        IF PB-REISSUED-CERT
 13214           CONTINUE
 13215        ELSE
 13216           MOVE ER-2608          TO WS-ERROR
 13217           PERFORM 9900-ERROR-FORMAT
 13218                                 THRU 9900-EXIT
 13219         END-IF
 13220     END-IF
 13221                                                                  ELC50PD
 13222     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13223        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13224        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13225                                                                  ELC50PD
 13226**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13227 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13228     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13229        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13230                                                                  ELC50PD
 13231*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13232*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13233*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13234                                                                  ELC50PD
 13235     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13236     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13237     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13238     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13239**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13240                                                                  ELC50PD
 13241     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13242     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13243     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13244     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13245**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 241
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13246                                                                  ELC50PD
 13247     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13248        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13250                                                                  ELC50PD
 13251     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13252                                                                  ELC50PD
 13253     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13254                                      WK-FULL-CERT-NO.            ELC50PD
 13255     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13256                                                                  ELC50PD
 13257     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13258                                                                  ELC50PD
 13259     IF PB-VALID-LIFE                                             ELC50PD
 13260        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13261     ELSE                                                         ELC50PD
 13262        IF PB-VALID-AH                                            ELC50PD
 13263          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13264                                                                  ELC50PD
 13265                                                                  ELC50PD
 13266     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13267     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13268     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13269                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13270                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13271                                      DCUA-RETURN-CODE.           ELC50PD
 13272                                                                  ELC50PD
 13273****************************************************************  ELC50PD
 13274*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13275***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13276***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13277***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13278***   TO THIS RECORD.                                        ***  ELC50PD
 13279****************************************************************  ELC50PD
 13280     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13281     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13282     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13283        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13284                                                                  ELC50PD
 13285     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13286        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13287        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13289        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13290                                                                  ELC50PD
 13291     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13292        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13293        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13294        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13295        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13296                                                                  ELC50PD
 13297     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13298        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13299        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13301        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13302                                                                  ELC50PD
 13303     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 242
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13304        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13305        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13307        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13308                                                                  ELC50PD
 13309     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13310        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13311        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13313        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13314                                                                  ELC50PD
 13315     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13316        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13317        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13319        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13320                                                                  ELC50PD
 13321     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13322        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13323        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13324        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13325        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13326                                                                  ELC50PD
 13327     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13328        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13329        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13331        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13332                                                                  ELC50PD
 13333     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13334        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13335        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13337        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13338                                                                  ELC50PD
 13339     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13340        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13341        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13342        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13343        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13344                                                                  ELC50PD
 13345     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13346        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13347        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13349        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13350                                                                  ELC50PD
 13351     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13352        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13353        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13355        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13356                                                                  ELC50PD
 13357     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13358        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13359        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13361        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 243
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13362                                                                  ELC50PD
 13363     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13364        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13365        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13367        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13368                                                                  ELC50PD
 13369     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13370        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13371        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13373        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13374                                                                  ELC50PD
 13375     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13376     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13377     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13378     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13379                                                                  ELC50PD
 13380 3024-EDIT-DL7-CONT.                                              ELC50PD
 13381                                                                  ELC50PD
 13382     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13383     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13384     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13385        NEXT SENTENCE                                             ELC50PD
 13386     ELSE                                                         ELC50PD
 13387        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13389                                                                  ELC50PD
 13390******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13391******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13392     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13393        NEXT SENTENCE                                             ELC50PD
 13394     ELSE                                                         ELC50PD
 13395        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13397                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 244
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13399****************************************************************  ELC50PD
 13400*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13401****************************************************************  ELC50PD
 13402     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13403     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13404                                                                  ELC50PD
 13405     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13406     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13407        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13408                                                                  ELC50PD
 13409     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13410        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13412        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13413                                                                  ELC50PD
 13414     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13415        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13417        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13418                                                                  ELC50PD
 13419     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13420        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13422        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13423                                                                  ELC50PD
 13424     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13425        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13427        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13428                                                                  ELC50PD
 13429     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13430     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13431                                                                  ELC50PD
 13432 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 245
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13434****************************************************************  ELC50PD
 13435*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13436****************************************************************  ELC50PD
 13437                                                                  ELC50PD
 13438     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13439     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13440     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13441     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13442        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13443                                                                  ELC50PD
 13444     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13445        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13447        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13448                                                                  ELC50PD
 13449     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13450        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13452        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13453                                                                  ELC50PD
 13454     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13455        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13457        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13458                                                                  ELC50PD
 13459     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13460        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13462        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13463                                                                  ELC50PD
 13464     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13465        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13467        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13468                                                                  ELC50PD
 13469     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13470     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13471     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13472                                                                  ELC50PD
 13473 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 246
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13475                                                                  ELC50PD
 13476****************************************************************  ELC50PD
 13477*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13478****************************************************************  ELC50PD
 13479                                                                  ELC50PD
 13480     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13481     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13482     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13483     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13484     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13485        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13486                                                                  ELC50PD
 13487     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13488        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13490        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13491                                                                  ELC50PD
 13492     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13493        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13495        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13496                                                                  ELC50PD
 13497     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13498        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13500        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13501                                                                  ELC50PD
 13502     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13503     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13504     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13505                                                                  ELC50PD
 13506 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 247
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13508                                                                  ELC50PD
 13509****************************************************************  ELC50PD
 13510*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13511****************************************************************  ELC50PD
 13512                                                                  ELC50PD
 13513     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13514     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13515     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13516        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13518                                                                  ELC50PD
 13519     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13520     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13521     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13522     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13523     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13524     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13525        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13526                                                                  ELC50PD
 13527     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13528        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13530        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13531                                                                  ELC50PD
 13532     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13533        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13535        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13536                                                                  ELC50PD
 13537     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13538        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13540        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13541                                                                  ELC50PD
 13542     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13543        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13545        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13546                                                                  ELC50PD
 13547     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13548        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13549        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13550        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13551                                                                  ELC50PD
 13552     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13553        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13555        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13556                                                                  ELC50PD
 13557     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13558     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13559     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13560                                                                  ELC50PD
 13561 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 248
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13563                                                                  ELC50PD
 13564     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13565        NEXT SENTENCE                                             ELC50PD
 13566     ELSE                                                         ELC50PD
 13567        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13569                                                                  ELC50PD
 13570     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13571     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13572     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13573                                                                  ELC50PD
 13574     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13575        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13577        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13578                                                                  ELC50PD
 13579     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13580        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13582        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13583                                                                  ELC50PD
 13584     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13585        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13587        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13588                                                                  ELC50PD
 13589     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13590        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13592        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13593                                                                  ELC50PD
 13594     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13595        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13597        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13598                                                                  ELC50PD
 13599     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13600        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13602                                                                  ELC50PD
 13603 3024-EDIT-DL01-CONT.                                             ELC50PD
 13604******************************************************************ELC50PD
 13605***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13606******************************************************************ELC50PD
 13607                                                                  ELC50PD
 13608      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13609      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13610      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13611      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13612        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13613        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13614                                                                  ELC50PD
 13615      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13616                                                                  ELC50PD
 13617      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13618         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13620         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 249
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13621                                                                  ELC50PD
 13622      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13623         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13625         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13626                                                                  ELC50PD
 13627      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13628         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13630         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13631                                                                  ELC50PD
 13632       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13633       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13634       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13635                                                                  ELC50PD
 13636******************************************************************ELC50PD
 13637***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13638******************************************************************ELC50PD
 13639                                                                  ELC50PD
 13640 3024-CHECK-VALID-RATE.                                           ELC50PD
 13641                                                                  ELC50PD
 13642     IF VALID-RATE-CODE                                           ELC50PD
 13643        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13644        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13645        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13646        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13647     ELSE                                                         ELC50PD
 13648         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13649                                                                  ELC50PD
 13650      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13651         IF PB-VALID-LIFE                                         ELC50PD
 13652             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13653             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13654         ELSE                                                     ELC50PD
 13655             IF PB-VALID-AH                                       ELC50PD
 13656                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13657                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13658                                                                  ELC50PD
 13659      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13660         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13662         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13663                                                                  ELC50PD
 13664      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13665         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13666         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13667         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13668                                                                  ELC50PD
 13669      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13670         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13671         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13672         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13673                                                                  ELC50PD
 13674      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13675         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13676            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13677            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13678            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 250
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13679          ELSE                                                    ELC50PD
 13680         IF PB-VALID-LIFE                                         ELC50PD
 13681            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13682          ELSE                                                    ELC50PD
 13683            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13684         END-IF                                                   ELC50PD
 13685         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13686         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13687         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13688         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13689             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13690             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13691           ELSE                                                   ELC50PD
 13692             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13693             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13694             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13695                                                                  ELC50PD
 13696       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13697       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13698       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13699                                                                  ELC50PD
 13700**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13701                                                                  ELC50PD
 13702 3025-EDIT-REINSURANCE.                                           ELC50PD
 13703     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13704         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13705                                                                  ELC50PD
 13706     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13707     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13708     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13709                                      REIN-CODE-2                 ELC50PD
 13710                                      REIN-CODE-3.                ELC50PD
 13711     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13712                                                                  ELC50PD
 13713     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13714                                                                  ELC50PD
 13715     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13716     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13717                                                                  ELC50PD
 13718     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13719     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13720         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13721                                                                  ELC50PD
 13722     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13723     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13724                                   WS-NSP-ST-CD-LF.               ELC50PD
 13725     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13726                                   WS-NSP-ST-CD-AH.               ELC50PD
 13727                                                                  ELC50PD
 13728     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13729                                                                  ELC50PD
 13730 3026-NO-SPEC-TABLE.                                              ELC50PD
 13731                                                                  ELC50PD
 13732     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13734     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13735                                                                  ELC50PD
 13736 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 251
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13737                                                                  ELC50PD
 13738     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13739       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13740                                                                  ELC50PD
 13741     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13742          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13743          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13744           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13745                                                                  ELC50PD
 13746     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13747     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13748     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13749     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13750                                                                  ELC50PD
 13751     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13752     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13753                                                                  ELC50PD
 13754     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13755     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13756         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13757                                                                  ELC50PD
 13758     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13759     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13760                                   WS-NSP-ST-CD-LF.               ELC50PD
 13761     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13762                                   WS-NSP-ST-CD-AH.               ELC50PD
 13763                                                                  ELC50PD
 13764     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13765                                                                  ELC50PD
 13766 3028-NO-REIN-TABLE.                                              ELC50PD
 13767                                                                  ELC50PD
 13768     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13769     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13770     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13771                                                                  ELC50PD
 13772 3040-EDIT-CONTINUE.                                              ELC50PD
 13773                                                                  ELC50PD
 13774     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13775         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13776                                                                  ELC50PD
 13777     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13778         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13779                                                                  ELC50PD
 13780     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13781        AND (NOT PB-MONTHLY-CERT)
 13782        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13783            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13784            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13785                                                                  ELC50PD
 13786     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13787        AND (NOT PB-MONTHLY-CERT)
 13788        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13789            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13790            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13791                                                                  ELC50PD
 13792 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13793
 13794     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 252
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13795     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13796         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13797                                                                  ELC50PD
 13798******************************************************************ELC50PD
 13799*                                                                *ELC50PD
 13800*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13801*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13802*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13803*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13804*                                                                *ELC50PD
 13805******************************************************************ELC50PD
 13806                                                                  ELC50PD
 13807     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13808        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13809                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13810                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13811        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13812        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13813        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13814        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13815        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13816*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13817        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13818        IF NO-CONVERSION-ERROR                                    ELC50PD
 13819           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13820                                                                  ELC50PD
 13821******************************************************************ELC50PD
 13822*                                                                *ELC50PD
 13823*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13824*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13825*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13826*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13827*                                                                *ELC50PD
 13828******************************************************************ELC50PD
 13829                                                                  ELC50PD
 13830     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13831          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13832                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13833                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13834          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13835          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13836          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13837          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13838          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13839*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13840          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13841          IF NO-CONVERSION-ERROR                                  ELC50PD
 13842             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13843                                                                  ELC50PD
 13844******************************************************************ELC50PD
 13845*                                                                *ELC50PD
 13846*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13847*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13848*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13849*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13850*                                                                *ELC50PD
 13851******************************************************************ELC50PD
 13852                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 253
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13853     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13854        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13855           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13856              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13857              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13858           ELSE                                                   ELC50PD
 13859              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13860              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13861        ELSE                                                      ELC50PD
 13862           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13863              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13864              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13865           ELSE                                                   ELC50PD
 13866              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13867              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13868                                                                  ELC50PD
 13869     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13870        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13871        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13872        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13873        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13874                                    DC-ODD-DAYS-OVER              ELC50PD
 13875          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13876          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13877*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13878          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13879          IF NO-CONVERSION-ERROR                                  ELC50PD
 13880             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13881                                                                  ELC50PD
 13882******************************************************************ELC50PD
 13883*                                                                *ELC50PD
 13884*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13885*                                                                *ELC50PD
 13886******************************************************************ELC50PD
 13887                                                                  ELC50PD
 13888     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13889        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13890                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13891        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13892                                                                  ELC50PD
 13893     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13894         NEXT SENTENCE                                            ELC50PD
 13895     ELSE                                                         ELC50PD
 13896         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13897         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13898         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13899                                                                  ELC50PD
 13900     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13901     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13902     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13903*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13904     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13905                                    DC-ELAPSED-DAYS               ELC50PD
 13906                                    DC-ODD-DAYS-OVER.             ELC50PD
 13907                                                                  ELC50PD
 13908     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13909                                                                  ELC50PD
 13910     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 254
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13911        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13912                                                                  ELC50PD
 13913     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13914
 13915     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13916        AND (WS-LF-COVERAGE-TYPE = 'L')
 13917        IF (DC-ELAPSED-MONTHS > 1)
 13918                      OR
 13919           ((DC-ELAPSED-MONTHS = 1)
 13920           AND (DC-ODD-DAYS-OVER > 0))
 13921           MOVE ER-2882          TO WS-ERROR
 13922           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13923        END-IF
 13924     END-IF
 13925
 13926     if dc-elapsed-months > 0
 13927        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13928        + dc-odd-days-over
 13929     end-if
 13930
 13931     IF PB-EXT-DAYS-PROCESSING
 13932        CONTINUE
 13933     ELSE
 13934        IF DC-ELAPSED-MONTHS = +0
 13935           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13936        ELSE
 13937           IF (WS-LF-EARNINGS-CALC = '4')
 13938              AND (DC-ELAPSED-MONTHS > ZERO)
 13939              AND (DC-ELAPSED-DAYS > ZERO)
 13940              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13941           ELSE
 13942              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13943                                 THRU 6499-EXIT
 13944              MOVE WS-ODD-DAYS-OVER
 13945                                 TO PB-I-EXTENTION-DAYS
 13946           END-IF
 13947        END-IF
 13948     END-IF
 13949
 13950******************************************************************ELC50PD
 13951*                                                                *ELC50PD
 13952*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13953*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13954*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13955*            AND ANY ODD DAYS.                                   *ELC50PD
 13956*                                                                *ELC50PD
 13957******************************************************************ELC50PD
 13958                                                                  ELC50PD
 13959     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13960                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13961     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13962        IF DC-ELAPSED-DAYS > ZEROS
 13963           MOVE ER-2681          TO WS-ERROR
 13964           PERFORM 9900-ERROR-FORMAT
 13965                                 THRU 9900-EXIT
 13966        END-IF
 13967     END-IF
 13968                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 255
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13969     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13970        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13971           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13972           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13973                                                                  ELC50PD
 13974     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13975        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13976         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13977          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13978          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13979          IF WS-LF-EARNINGS-CALC = '4'
 13980             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13981             PB-I-PAY-FREQUENCY
 13982          END-IF
 13983          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13984                                    DC-ODD-DAYS-OVER              ELC50PD
 13985          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13986          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13987*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13988          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13989          IF NO-CONVERSION-ERROR                                  ELC50PD
 13990             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13991             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13992                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13993                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13994                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13995                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13996                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13997*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13998                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13999                  IF NO-CONVERSION-ERROR                          ELC50PD
 14000                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 14001                                                                  ELC50PD
 14002* okay, i had to move the new att age edit down here because the
 14003* expiration date could get recalculated and i need the exp date
 14004
 14005
 14006     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 14007        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 14008        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14009        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14010           AND ZEROS
 14011           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14012           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14013           SET ELAPSED-BETWEEN-BIN TO TRUE
 14014           PERFORM 8500-DATE-CONVERT
 14015                                 THRU 8500-EXIT
 14016           IF NO-CONVERSION-ERROR
 14017              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 14018                 MOVE ER-2669       TO WS-ERROR
 14019*                PERFORM 9900-ERROR-FORMAT
 14020*                                THRU 9900-EXIT
 14021              END-IF
 14022           END-IF
 14023        ELSE
 14024           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14025           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 14026              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 256
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14027*             PERFORM 9900-ERROR-FORMAT
 14028*                                THRU 9900-EXIT
 14029           ELSE
 14030              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 14031                 MOVE ER-1570    TO WS-ERROR
 14032                 PERFORM 9900-ERROR-FORMAT
 14033                                 THRU 9900-EXIT
 14034              END-IF
 14035           END-IF
 14036        END-IF
 14037
 14038        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14039           AND ZEROS
 14040           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14041           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14042           SET ELAPSED-BETWEEN-BIN TO TRUE
 14043           PERFORM 8500-DATE-CONVERT
 14044                                 THRU 8500-EXIT
 14045           IF NO-CONVERSION-ERROR
 14046              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 14047                 MOVE ER-2669       TO WS-ERROR
 14048*                PERFORM 9900-ERROR-FORMAT
 14049*                                THRU 9900-EXIT
 14050              END-IF
 14051           END-IF
 14052        ELSE
 14053           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14054             (PB-I-LF-TERM / 12)
 14055           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 14056              MOVE ER-2669       TO WS-ERROR
 14057*             PERFORM 9900-ERROR-FORMAT
 14058*                                THRU 9900-EXIT
 14059           ELSE
 14060              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 14061                 MOVE ER-1571    TO WS-ERROR
 14062                 PERFORM 9900-ERROR-FORMAT
 14063                                 THRU 9900-EXIT
 14064              END-IF
 14065           END-IF
 14066        END-IF
 14067        IF WS-ERROR = ER-2669
 14068           PERFORM 9900-ERROR-FORMAT
 14069                                 THRU 9900-EXIT
 14070        END-IF
 14071
 14072     END-IF
 14073
 14074     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 14075        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 14076         NOT NO-AH-COVERAGE                                       ELC50PD
 14077          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 14078             AND (PB-COMPANY-ID = 'DCC')
 14079             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 14080             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 14081          ELSE
 14082             IF WS-LF-EARNINGS-CALC = '4'
 14083                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 14084                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 257
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14085                PB-I-PAY-FREQUENCY
 14086             ELSE
 14087                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 14088                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 14089             END-IF
 14090          END-IF
 14091          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 14092                                         DC-ODD-DAYS-OVER         ELC50PD
 14093          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 14094          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 14095*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 14096          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 14097          IF NO-CONVERSION-ERROR                                  ELC50PD
 14098             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 14099
 14100     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14101        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14102        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14103        IF PB-I-BIRTHDAY > LOW-VALUES
 14104           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14105           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14106           SET ELAPSED-BETWEEN-BIN TO TRUE
 14107           PERFORM 8500-DATE-CONVERT
 14108                                 THRU 8500-EXIT
 14109           IF NO-CONVERSION-ERROR
 14110              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14111                 MOVE ER-3054       TO WS-ERROR
 14112*                PERFORM 9900-ERROR-FORMAT
 14113*                                THRU 9900-EXIT
 14114              END-IF
 14115           END-IF
 14116        ELSE
 14117           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14118           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14119              MOVE ER-3054       TO WS-ERROR
 14120*             PERFORM 9900-ERROR-FORMAT
 14121*                                THRU 9900-EXIT
 14122           END-IF
 14123        END-IF
 14124
 14125        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14126           AND ZEROS
 14127           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14128           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14129           SET ELAPSED-BETWEEN-BIN TO TRUE
 14130           PERFORM 8500-DATE-CONVERT
 14131                                 THRU 8500-EXIT
 14132           IF NO-CONVERSION-ERROR
 14133              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14134                 MOVE ER-3054       TO WS-ERROR
 14135*                PERFORM 9900-ERROR-FORMAT
 14136*                                THRU 9900-EXIT
 14137              END-IF
 14138           END-IF
 14139        ELSE
 14140           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14141             (PB-I-AH-TERM / 12)
 14142           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 258
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14143              MOVE ER-3054       TO WS-ERROR
 14144*             PERFORM 9900-ERROR-FORMAT
 14145*                                THRU 9900-EXIT
 14146           END-IF
 14147        END-IF
 14148        IF WS-ERROR = ER-3054
 14149           PERFORM 9900-ERROR-FORMAT
 14150                                 THRU 9900-EXIT
 14151        END-IF
 14152
 14153     END-IF
 14154
 14155     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14156                                                                  ELC50PD
 14157     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14158        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14159                                                                     CL**6
 14160     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14161       AND                                                        ELC50PD
 14162        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14163        NEXT SENTENCE                                             ELC50PD
 14164     ELSE                                                            CL**6
 14165        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14166                                                                     CL**6
 14167     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14168        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14169        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14170     ELSE                                                         ELC50PD
 14171        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14172        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14173                                                                  ELC50PD
 14174     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14175*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14176     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14177     IF (NO-CONVERSION-ERROR)
 14178        AND (DC-ELAPSED-MONTHS > +1)
 14179        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14180        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14181        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14182                                                                  ELC50PD
 14183 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14184                                                                  ELC50PD
 14185     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14186        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14187         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14188     ELSE                                                         ELC50PD
 14189         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14190                                                                  ELC50PD
 14191     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14192         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14193     ELSE                                                         ELC50PD
 14194        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14195           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14196           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14197           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14198                                                                  ELC50PD
 14199     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14200        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 259
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14201        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14202         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14203                                                                  ELC50PD
 14204     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14205                                                                  ELC50PD
 14206 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14207                                                                  ELC50PD
 14208     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14209                                                                  ELC50PD
 14210     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14211         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14212     ELSE                                                         ELC50PD
 14213         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14214            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14215            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14216                                                                  ELC50PD
 14217     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14218                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14219     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14220         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14221                                                                  ELC50PD
 14222     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14223         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14224         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14225                                                                  ELC50PD
 14226                                                                  ELC50PD
 14227 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14228                                                                  ELC50PD
 14229******************************************************************ELC50PD
 14230*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14231******************************************************************ELC50PD
 14232                                                                  ELC50PD
 14233     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14234        NEXT SENTENCE                                             ELC50PD
 14235     ELSE                                                         ELC50PD
 14236        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14237           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14238              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14239              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14240              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14241                  NEXT SENTENCE                                   ELC50PD
 14242           ELSE                                                   ELC50PD
 14243              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14244              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14245                                                                  ELC50PD
 14246     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14247         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14248            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14249            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14250            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14251             NEXT SENTENCE                                        ELC50PD
 14252          ELSE                                                    ELC50PD
 14253              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14254              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14255                                                                  ELC50PD
 14256     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14257        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14258                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 260
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14259     IF POLICY-HAS-AH                                             ELC50PD
 14260       AND                                                        ELC50PD
 14261        POLICY-HAS-LIFE                                           ELC50PD
 14262       AND                                                        ELC50PD
 14263        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14264       AND                                                        ELC50PD
 14265        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14266        NEXT SENTENCE                                             ELC50PD
 14267     ELSE                                                         ELC50PD
 14268        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14269                                                                  ELC50PD
 14270     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14271     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14272        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14273                                                                  ELC50PD
 14274     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14275        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14277                                                                  ELC50PD
 14278 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14279                                                                  ELC50PD
 14280     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14281         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14282            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14283
 14284*    IF PB-COMPANY-ID NOT = 'DCC'
 14285*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14286*          AND 'V' AND 'W' AND 'X'
 14287*          GO TO 3125-EDIT-PMT-FREQ
 14288*       END-IF
 14289*    ELSE
 14290*       IF WS-AH-DCC-TRUNC = 'T'
 14291*          CONTINUE
 14292*       ELSE
 14293*          GO TO 3125-EDIT-PMT-FREQ
 14294*       END-IF
 14295*    END-IF
 14296
 14297
 14298
 14299     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14300                    OR
 14301        ((PB-COMPANY-ID = 'DCC')
 14302        AND (WS-AH-DCC-TRUNC = 'T'))
 14303        CONTINUE
 14304     ELSE
 14305        GO TO 3125-EDIT-PMT-FREQ
 14306     END-IF
 14307
 14308     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14309         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14310                                                                  ELC50PD
 14311     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14312        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14313*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14314        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14315         NEXT SENTENCE                                            ELC50PD
 14316     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 261
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14317         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14319                                                                  ELC50PD
 14320     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14321        MOVE ER-3058             TO WS-ERROR
 14322        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14323     end-if
 14324                                                                  ELC50PD
 14325     IF WS-STATE-ABBREVIATION = 'NC'
 14326        IF PB-I-LOAN-TERM > +59
 14327           CONTINUE
 14328        ELSE
 14329           MOVE ER-2792          TO WS-ERROR
 14330           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14331        END-IF
 14332     END-IF
 14333                                                                  ELC50PD
 14334     .
 14335 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14336
 14337     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14338         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14339            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14340
 14341     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14342                    OR
 14343        ((PB-COMPANY-ID = 'DCC')
 14344        AND (WS-AH-DCC-TRUNC = 'T'))
 14345                    OR
 14346         (PB-COMPANY-ID = 'AHL')
 14347        CONTINUE
 14348     ELSE
 14349        IF (PB-I-LOAN-TERM > ZEROS)
 14350           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14351           MOVE ER-1575          TO WS-ERROR
 14352           PERFORM 9900-ERROR-FORMAT
 14353                                 THRU 9900-EXIT
 14354        END-IF
 14355     END-IF
 14356
 14357     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14358         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14359            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14360            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14361            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14362         ELSE                                                     ELC50PD
 14363            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14364                                                                  ELC50PD
 14365     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14366         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14367         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14368         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14369                                                                  ELC50PD
 14370     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14371         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14372         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14373         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14374                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 262
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14375     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14376         GIVING WS-TEX-FACT-2                                     ELC50PD
 14377             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14378                                                                  ELC50PD
 14379*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14380*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14381*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14382                                                                  ELC50PD
 14383                                                                  ELC50PD
 14384 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14385                                                                  ELC50PD
 14386     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14387        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14388           MOVE ER-2690          TO WS-ERROR
 14389           PERFORM 9900-ERROR-FORMAT
 14390                                 THRU 9900-EXIT
 14391        ELSE
 14392           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14393           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14394           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14395           MOVE PB-SV-STATE      TO LOFC-STATE
 14396           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14397           MOVE PB-I-LOAN-OFFICER
 14398                                 TO LOFC-CODE
 14399           PERFORM 8586-READ-LOAN-OFFICER
 14400                                 THRU 8586-EXIT
 14401           IF (NOT LOFC-MASTER-FOUND)
 14402              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14403              MOVE ER-3006       TO WS-ERROR
 14404              PERFORM 9900-ERROR-FORMAT
 14405                                 THRU 9900-EXIT
 14406           END-IF
 14407        END-IF
 14408     END-IF
 14409
 14410     .
 14411 3129-EDIT-APR.                                                   ELC50PD
 14412                                                                  ELC50PD
 14413     IF (WS-LF-BENEFIT-CD = ZERO)
 14414        OR (NO-LF-BENEFIT-MATCH)
 14415        IF PB-COMPANY-ID NOT = 'DCC'
 14416           GO TO 3130-EDIT-AGE
 14417*       ELSE
 14418*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14419*             GO TO 3130-EDIT-AGE
 14420*          END-IF
 14421        END-IF
 14422     END-IF
 14423                                                                  ELC50PD
 14424     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14425         AND (PB-I-RATE-CLASS NOT = 'L ')
 14426         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14427         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14428         GO TO 3129-APR-CONT.                                     ELC50PD
 14429                                                                  ELC50PD
 14430     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14431         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14432         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 263
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14433         GO TO 3129-APR-CONT.                                     ELC50PD
 14434                                                                  ELC50PD
 14435     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14436         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14437         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14438         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14439         GO TO 3129-APR-CONT.                                     ELC50PD
 14440                                                                  ELC50PD
 14441     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14442        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14443           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14444              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14445              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14446              GO TO 3130-EDIT-AGE.                                ELC50PD
 14447                                                                  ELC50PD
 14448     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14449        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14450        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14451        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14452        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14453        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14454         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14455                                                                  ELC50PD
 14456 3129-APR-CONT.                                                   ELC50PD
 14457     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14458         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14459         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14460                                                                  ELC50PD
 14461     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14462         WS-AH-BENEFIT-CD (1:1) = 'S')
 14463        AND (PB-COMPANY-ID = 'DCC')
 14464        AND (PB-I-LOAN-APR = ZERO)
 14465        MOVE ER-2657             TO WS-ERROR
 14466        PERFORM 9900-ERROR-FORMAT
 14467                                 THRU 9900-EXIT
 14468        GO TO 3130-EDIT-AGE
 14469     END-IF
 14470
 14471*    IF PB-I-LOAN-APR = ZERO
 14472*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14473*    END-IF
 14474                                                                  ELC50PD
 14475     if pb-i-loan-apr = +99.9999
 14476        move er-2656             to ws-error
 14477        PERFORM 9900-ERROR-FORMAT
 14478                                 THRU 9900-EXIT
 14479        GO TO 3130-EDIT-AGE
 14480     end-if
 14481
 14482*    IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14483*       MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14484*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14485*       GO TO 3130-EDIT-AGE.                                      ELC50PD
 14486                                                                  ELC50PD
 14487*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14488     if pb-i-loan-apr not = +99.9999
 14489        IF PB-I-LOAN-APR > +30.000
 14490           MOVE ER-2657          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 264
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14491           PERFORM 9900-ERROR-FORMAT
 14492                                 THRU 9900-EXIT
 14493        end-if
 14494     end-if
 14495
 14496     .
 14497 3130-EDIT-AGE.                                                   ELC50PD
 14498                                                                  ELC50PD
 14499******************************************************************ELC50PD
 14500*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14501******************************************************************ELC50PD
 14502                                                                  ELC50PD
 14503     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14504        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14505           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14506               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14507               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14508                                                                  ELC50PD
 14509     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14510        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14511           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14512               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14513               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14514                                                                  ELC50PD
 14515 3133-SEX-CODE.                                                   ELC50PD
 14516     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14517         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14518             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14519          ELSE                                                    ELC50PD
 14520             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14521             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14522                                                                  ELC50PD
 14523     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14524         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14525                                                                  ELC50PD
 14526     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14527         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14528                                                                  ELC50PD
 14529 3134-SIG-SW-EDIT.                                                ELC50PD
 14530     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14531         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14532                                                                  ELC50PD
 14533     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14534         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14535             NEXT SENTENCE                                        ELC50PD
 14536         ELSE                                                     ELC50PD
 14537             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14538             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14539     ELSE                                                         ELC50PD
 14540     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14541         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14542             NEXT SENTENCE                                        ELC50PD
 14543         ELSE                                                     ELC50PD
 14544             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14545             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14546     ELSE                                                         ELC50PD
 14547     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14548         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 265
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14549             NEXT SENTENCE                                        ELC50PD
 14550         ELSE                                                     ELC50PD
 14551             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14552             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14553     ELSE                                                         ELC50PD
 14554         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14555             NEXT SENTENCE                                        ELC50PD
 14556         ELSE                                                     ELC50PD
 14557             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14558             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14559                                                                  ELC50PD
 14560     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
 14561         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14562             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14563            PB-I-SIG-SW = 'N'                                     ELC50PD
 14564            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14565            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14566                                                                  ELC50PD
 14567 3135-NAME-EDIT.                                                  ELC50PD
 14568                                                                  ELC50PD
 14569     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14570        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14571        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14572           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14573                                 TO PB-I-JOINT-FIRST-NAME
 14574        END-PERFORM
 14575     END-IF
 14576
 14577     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14578        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14579        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14580           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14581                                 TO PB-I-JOINT-LAST-NAME
 14582        END-PERFORM
 14583     END-IF
 14584
 14585     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14586        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14587        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14588           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14589                                 TO PB-I-INSURED-FIRST-NAME
 14590        END-PERFORM
 14591     END-IF
 14592
 14593     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14594        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14595        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14596           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14597                                 TO PB-I-INSURED-LAST-NAME
 14598        END-PERFORM
 14599     END-IF
 14600
 14601     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14602       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14603       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14604           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14605           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14606                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 266
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14607 3136-EDIT-SEX.                                                   ELC50PD
 14608                                                                  ELC50PD
 14609******************************************************************ELC50PD
 14610*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14611******************************************************************ELC50PD
 14612                                                                  ELC50PD
 14613     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14614        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14615        NEXT SENTENCE                                             ELC50PD
 14616     ELSE                                                         ELC50PD
 14617        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14618           NEXT SENTENCE                                          ELC50PD
 14619        ELSE                                                      ELC50PD
 14620           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14621           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14622                                                                  ELC50PD
 14623 3137-EDIT-EFF-DATE.                                              ELC50PD
 14624                                                                  ELC50PD
 14625     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14626        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14627        PB-POLICY-IS-VOIDED                                       ELC50PD
 14628         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14629                                                                  ELC50PD
 14630     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14631                                    WS-2672-SW.                   ELC50PD
 14632                                                                  ELC50PD
 14633     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14634         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14635             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14636             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14637             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14638                                                                  ELC50PD
 14639     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14640         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14641                                                                  ELC50PD
 14642     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14643     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14644*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14645     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14646     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14647                                    DC-ELAPSED-DAYS.              ELC50PD
 14648     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14649                                                                  ELC50PD
 14650     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14651         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14652                                                                  ELC50PD
 14653     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14654         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14655         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14657     END-IF
 14658                                                                  ELC50PD
 14659     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14660        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14661        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14662        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14663        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14664                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 267
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14665     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14666      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14667         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14668         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14670         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14671                                    WS-2672-SW.                   ELC50PD
 14672                                                                  ELC50PD
 14673     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14674         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14675             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14676             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14677         ELSE                                                     ELC50PD
 14678             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14679             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14680                                                                  ELC50PD
 14681                                                                  ELC50PD
 14682 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14683                                                                  ELC50PD
 14684     if pb-company-id not = 'AHL'
 14685        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14686           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14687           MOVE ER-2787          TO WS-ERROR
 14688           PERFORM 9900-ERROR-FORMAT
 14689                                 THRU 9900-EXIT
 14690        END-IF
 14691     end-if
 14692
 14693     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14694        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14695                                 > 250000.00
 14696           MOVE ER-2719          TO WS-ERROR
 14697           PERFORM 9900-ERROR-FORMAT
 14698                                 THRU 9900-EXIT
 14699        END-IF
 14700     END-IF
 14701
 14702     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14703        PB-POLICY-IS-VOIDED                                       ELC50PD
 14704         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14705                                                                  ELC50PD
 14706     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14707        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14708         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14710                                                                  ELC50PD
 14711     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14712        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14713        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14714         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14715                                                                  ELC50PD
 14716     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14717        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14718        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14719         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14720                                                                  ELC50PD
 14721     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14722        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 268
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14723        MOVE ER-2631             TO WS-ERROR
 14724        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14725     END-IF
 14726                                                                  ELC50PD
 14727                                                                  ELC50PD
 14728******************************************************************ELC50PD
 14729*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14730******************************************************************ELC50PD
 14731                                                                  ELC50PD
 14732     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14733        NEXT SENTENCE                                             ELC50PD
 14734     ELSE                                                         ELC50PD
 14735        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14736           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14737           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14738                                                                  ELC50PD
 14739                                                                  ELC50PD
 14740******************************************************************ELC50PD
 14741*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14742******************************************************************ELC50PD
 14743                                                                  ELC50PD
 14744     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14745        CONTINUE                                                  ELC50PD
 14746     ELSE                                                         ELC50PD
 14747        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14748           IF (NOT PB-COMP-LF-PREM)
 14749              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14750              MOVE ER-2633       TO WS-ERROR
 14751              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14752           END-IF
 14753        END-IF
 14754     END-IF
 14755
 14756     .                                                            ELC50PD
 14757 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14758                                                                  ELC50PD
 14759     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14760        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14761        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14762         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14763                                                                  ELC50PD
 14764     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14765        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14766        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14767        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14768         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14769                                                                  ELC50PD
 14770     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14771        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14772        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14773         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14774                                                                  ELC50PD
 14775     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14776         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14777         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14778                                                                  ELC50PD
 14779******************************************************************ELC50PD
 14780*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 269
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14781******************************************************************ELC50PD
 14782                                                                  ELC50PD
 14783     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14784        NEXT SENTENCE                                             ELC50PD
 14785     ELSE                                                         ELC50PD
 14786        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14787           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14789                                                                  ELC50PD
 14790******************************************************************ELC50PD
 14791*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14792******************************************************************ELC50PD
 14793                                                                  ELC50PD
 14794     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14795        NEXT SENTENCE                                             ELC50PD
 14796     ELSE                                                         ELC50PD
 14797        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14798            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14799                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14800                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14801                                                                  ELC50PD
 14802                                                                  ELC50PD
 14803 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14804* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14805     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14806                                     WS-RES-MUNI-TAX              ELC50PD
 14807                                     PB-I-STATE-TAX               ELC50PD
 14808                                     PB-I-MUNI-TAX.               ELC50PD
 14809                                                                  ELC50PD
 14810     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14811                                                                  ELC50PD
 14812     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14813        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14814                                                                  ELC50PD
 14815     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14816        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14817                                                                  ELC50PD
 14818     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14819        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14820                                                                  ELC50PD
 14821     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14822                             OR 'RIC')                            ELC50PD
 14823        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14824                                                                  ELC50PD
 14825     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14826        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14827            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14828        ELSE                                                      ELC50PD
 14829           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14830               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14831                                                                  ELC50PD
 14832     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14833        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14834                                                                  ELC50PD
 14835     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14836        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14837                                                                  ELC50PD
 14838     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 270
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14839        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14840           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14841             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14842           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14843           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14844              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14845              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14846              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14847           ELSE                                                   ELC50PD
 14848              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14849                                                                  ELC50PD
 14850 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
 14851                                                                  ELC50PD
 14852* DMD RATING TEST                                                 ELC50PD
 14853     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14854         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14855         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14856         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14858         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14859         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14860                                                                  ELC50PD
 14861     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14862         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14863             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14864                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14865                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14866                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14867                                                                  ELC50PD
 14868     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14869         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14870             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14871                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14872                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14873                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14874                                                                  ELC50PD
 14875     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14876        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14877            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14878              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14879                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14880                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14881                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14882                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14883                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14884                                                                  ELC50PD
 14885     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14886        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14887            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14888               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14889               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14890               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14891                                                                  ELC50PD
 14892     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14893        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14894            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14895                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14896                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 271
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14897                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14898                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14899                                                                  ELC50PD
 14900     IF WS-ERROR = ER-2693                                        ELC50PD
 14901        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14902           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14903           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14904           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14905                                                                  ELC50PD
 14906     IF WS-ERROR = ER-2693                                        ELC50PD
 14907        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14908           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
 14909           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14910           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14911                                                                  ELC50PD
 14912     IF WS-ERROR = ER-2693                                        ELC50PD
 14913        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14914           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14915           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14916           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14917                                                                  ELC50PD
 14918     IF WS-ERROR = ER-2693                                        ELC50PD
 14919        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14920           IF WS-LEVEL                                            ELC50PD
 14921              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14922              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14923                                                                  ELC50PD
 14924     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14925         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14926         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14927       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14928             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14929             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14930         NEXT SENTENCE                                            ELC50PD
 14931     ELSE                                                         ELC50PD
 14932         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14933                                                                  ELC50PD
 14934     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14935        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14936           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14937           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14938           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14939                                                                  ELC50PD
 14940     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14941        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14942           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14943           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14944           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14945                                                                  ELC50PD
 14946     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14947                                                                  ELC50PD
 14948     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14949         NEXT SENTENCE                                            ELC50PD
 14950     ELSE                                                         ELC50PD
 14951         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14952             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14953                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14954                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 272
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14955                                                                  ELC50PD
 14956     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14957       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14958         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14959         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14960         IF WS-ERROR = ER-2675                                    ELC50PD
 14961            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14962            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14963            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14964         ELSE                                                     ELC50PD
 14965            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14966            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14967                                                                  ELC50PD
 14968                                                                  ELC50PD
 14969     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14970         NEXT SENTENCE                                            ELC50PD
 14971     ELSE                                                         ELC50PD
 14972       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14973            NEXT SENTENCE
 14974       ELSE
 14975         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14976             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14977                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14978                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14979                                                                  ELC50PD
 14980     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14981       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14982         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14983         IF WS-ERROR = ER-2676                                    ELC50PD
 14984            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14985            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14986            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14987         ELSE                                                     ELC50PD
 14988            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14989            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14990                                                                  ELC50PD
 14991     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14992         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14993            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14994     ELSE                                                         ELC50PD
 14995         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14996             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14997                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14998                                                                  ELC50PD
 14999     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 15000         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 15001            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 15002     ELSE                                                         ELC50PD
 15003         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 15004             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 15005                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 15006                                                                  ELC50PD
 15007     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 15008                                                                  ELC50PD
 15009     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 15010                                                                  ELC50PD
 15011                                                                  ELC50PD
 15012 3215-EDIT-RATES.                                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 273
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15013     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 15014         NEXT SENTENCE                                            ELC50PD
 15015     ELSE                                                         ELC50PD
 15016         GO TO 3999-END-EDIT.                                     ELC50PD
 15017                                                                  ELC50PD
 15018 3220-CHECK-LF-RATES.                                             ELC50PD
 15019                                                                  ELC50PD
 15020     IF PB-COMPANY-ID = 'DCC'
 15021        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15022        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15023        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15024           AND (NOT WS-LF-CASH))
 15025                           OR
 15026           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15027           AND (NOT WS-AH-CASH)))
 15028                       AND
 15029           (PB-I-ENTRY-STATUS NOT = '5')
 15030           MOVE 'M'              TO PB-BATCH-ENTRY
 15031                                    PB-I-ENTRY-STATUS
 15032        END-IF
 15033     END-IF
 15034
 15035
 15036
 15037     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 15038                                    PB-I-AH-PREM-CALC             ELC50PD
 15039                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 15040                                    PB-I-LF-ALT-RATE              ELC50PD
 15041                                    PB-I-LF-REI-RATE              ELC50PD
 15042                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 15043                                    PB-I-AH-REI-RATE
 15044                                    PB-I-TOT-FEES-CALC.
 15045                                                                  ELC50PD
 15046     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15047        NEXT SENTENCE                                             ELC50PD
 15048     ELSE                                                         ELC50PD
 15049        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 15050                                    PB-I-AH-RATE.                 ELC50PD
 15051                                                                  ELC50PD
 15052     IF PB-I-TOT-FEES NOT NUMERIC
 15053        MOVE ZEROS               TO PB-I-TOT-FEES
 15054     END-IF
 15055
 15056     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 15057         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 15058                                                                  ELC50PD
 15059     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 15060         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 15061                                                                  ELC50PD
 15062     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 15063        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 15064     END-IF
 15065                                                                  ELC50PD
 15066     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 15067        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 15068     END-IF
 15069                                                                  ELC50PD
 15070     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 274
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15071        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 15072            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 15073     ELSE                                                         ELC50PD
 15074            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 15075                                                                  ELC50PD
 15076     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 15077         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 15078                                                                  ELC50PD
 15079     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 15080         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 15081                                                                  ELC50PD
 15082     MOVE SPACES                 TO CP-BEN-CATEGORY
 15083     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 15084        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 15085        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 15086             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 15087        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 15088             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 15089        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 15090             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 15091        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 15092           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 15093           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 15094        ELSE                                                      ELC50PD
 15095           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 15096              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 15097               AM-MAX-TOT-BEN                                     ELC50PD
 15098               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 15099           ELSE                                                   ELC50PD
 15100              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 15101                 AM-MAX-TOT-BEN) AND                              ELC50PD
 15102                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 15103                 AM-MAX-TOT-BEN)                                  ELC50PD
 15104                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 15105              ELSE                                                ELC50PD
 15106                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 15107                                                                  ELC50PD
 15108     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 15109         NEXT SENTENCE                                            ELC50PD
 15110     ELSE                                                         ELC50PD
 15111         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15112                                                                  ELC50PD
 15113*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15114                                                                  ELC50PD
 15115     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15116        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15117              OR                                                  ELC50PD
 15118           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15119           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15120           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15121           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15122                                                                  ELC50PD
 15123     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15124           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15125                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15126                                                                  ELC50PD
 15127     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15128         MOVE ER-2687             TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 275
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15130         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15131         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15132         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15133                                                                  ELC50PD
 15134     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15135        IF PB-I-LIVES = ZERO                                      ELC50PD
 15136           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15137           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15138                                                                  ELC50PD
 15139     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15140                                                                  ELC50PD
 15141     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15142     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15143     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15144     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15145     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15146     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15147     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15148     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15149     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15150     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15151                                                                  ELC50PD
 15152******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15153     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15154         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15155            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15156             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15157                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15158*******                                                           ELC50PD
 15159                                                                  ELC50PD
 15160     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15161     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15162     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15163     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15164     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15165     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15166                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15167     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15168         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15169                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15170     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15171     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15172     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15173     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15174     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15175     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15176     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15177     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15178     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15179                                    CP-REMAINING-TERM             ELC50PD
 15180                                    CP-LOAN-TERM.                 ELC50PD
 15181                                                                  ELC50PD
 15182     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15183         NEXT SENTENCE                                            ELC50PD
 15184     ELSE                                                         ELC50PD
 15185         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15186             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 276
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15187                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15188                                                                  ELC50PD
 15189     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15190        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15191           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15192                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15193                                                                  ELC50PD
 15194     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15195         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15196            CP-EARN-AS-NET-PAY                                    ELC50PD
 15197             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15198                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15199                                                                  ELC50PD
 15200     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15201        or ((pb-company-id = 'AHL')
 15202           and (pb-i-loan-term > pb-i-lf-term))
 15203        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15204                                                                  ELC50PD
 15205     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15206        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15207                                                                  ELC50PD
 15208     IF CP-TERM-IS-DAYS                                           ELC50PD
 15209         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15210     ELSE                                                         ELC50PD
 15211         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15212
 15213     IF PB-COMPANY-ID = 'DCC'
 15214        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15215        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15216        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15217        IF WS-LF-BEN-CATEGORY = 'D'
 15218           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15219           MOVE PB-I-LIFE-COMMISSION
 15220                                 TO CP-DCC-ACT-COMM
 15221           MOVE WS-LF-BEN-CATEGORY
 15222                                 TO CP-BEN-CATEGORY
 15223        END-IF
 15224        IF (CP-BENEFIT-CD (1:1) = 'P')
 15225           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15226           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15227           add pb-i-ah-premium-amt to cp-original-premium
 15228        END-IF
 15229     END-IF
 15230
 15231     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15232         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15233         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15234         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15235                                                                  ELC50PD
 15236     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15237        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15238                                                                  ELC50PD
 15239     IF (CP-SPECIAL-CALC-CD = 'H')
 15240        OR (PB-COMPANY-ID = 'DCC')
 15241         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15242                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15243         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15244                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 277
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15245
 15246     IF (PB-COMPANY-ID = 'CID')
 15247        AND (WS-LF-EARNINGS-CALC = 'B')
 15248        AND (CP-STATE-STD-ABBRV = 'MN')
 15249        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15250                                 TO CP-ALTERNATE-BENEFIT
 15251        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15252     END-IF
 15253
 15254     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15255     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15256     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15257                                                                  ELC50PD
 15258     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15259        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15260        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15261        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15262                                                                  ELC50PD
 15263     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15264        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15265           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15266              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15267              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15268                                                                  ELC50PD
 15269
 15270******************************************************************ELC50PD
 15271*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15272*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15273******************************************************************ELC50PD
 15274                                                                  ELC50PD
 15275* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15276                                                                  00031343
 15277     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15278          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15279                                                                  00031346
 15280*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15281*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15282*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15283*        MOVE ER-2709        TO WS-ERROR                          00031349
 15284*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15285*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15286                                                                  00031352
 15287*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15288*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15289*        MOVE ER-2718        TO WS-ERROR                          00031349
 15290*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15291*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15292                                                                  00031352
 15293* CALC A & H AGE AT EXPIRATION.                                   00031353
 15294                                                                  00031354
 15295     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15296          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15297                                                                  00031357
 15298*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15299*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15300*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15301*        MOVE ER-2709        TO WS-ERROR                          00031349
 15302*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 278
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15303*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15304                                                                  00031352
 15305*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15306*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15307*        MOVE ER-2718        TO WS-ERROR                          00031360
 15308*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15309*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15310
 15311     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15312        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15313                                                                  ELC50PD
 15314     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
 15315        GO TO 3221-CHECK-ERROR-RATE-OPEN
 15316     end-if
 15317                                                                  ELC50PD
 15318     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15319        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15320                                                                  ELC50PD
 15321     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15322         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15323         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15324         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15325                                                                  ELC50PD
 15326                                                                  00031363
 15327******************************************************************ELC50PD
 15328*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15329******************************************************************ELC50PD
 15330                                                                  ELC50PD
 15331 PREMIUM-EDITING-IS-BYPASSED.
 15332
 15333     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15334        AND (CP-R-MAX-ATT-AGE > +0)
 15335        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15336        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15337           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15338           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15339           MOVE '1'              TO DC-OPTION-CODE
 15340           PERFORM 8500-DATE-CONVERT
 15341                                 THRU 8500-EXIT
 15342           IF NO-CONVERSION-ERROR
 15343              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15344                 MOVE ER-2661       TO WS-ERROR
 15345*                PERFORM 9900-ERROR-FORMAT
 15346*                                THRU 9900-EXIT
 15347              END-IF
 15348           END-IF
 15349        ELSE
 15350           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15351           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15352              MOVE ER-2661       TO WS-ERROR
 15353*             PERFORM 9900-ERROR-FORMAT
 15354*                                THRU 9900-EXIT
 15355           ELSE
 15356              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15357                 MOVE ER-1570    TO WS-ERROR
 15358                 PERFORM 9900-ERROR-FORMAT
 15359                                 THRU 9900-EXIT
 15360              END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 279
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15361           END-IF
 15362        END-IF
 15363
 15364        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15365           MOVE PB-I-JOINT-BIRTHDAY
 15366                                 TO DC-BIN-DATE-1
 15367           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15368           MOVE '1'              TO DC-OPTION-CODE
 15369           PERFORM 8500-DATE-CONVERT
 15370                                 THRU 8500-EXIT
 15371           IF NO-CONVERSION-ERROR
 15372              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15373                 MOVE ER-2661       TO WS-ERROR
 15374*                PERFORM 9900-ERROR-FORMAT
 15375*                                THRU 9900-EXIT
 15376              END-IF
 15377           ELSE
 15378              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15379           END-IF
 15380        ELSE
 15381           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15382             (PB-I-LF-TERM / 12)
 15383           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15384              MOVE ER-2661       TO WS-ERROR
 15385*             PERFORM 9900-ERROR-FORMAT
 15386*                                THRU 9900-EXIT
 15387           ELSE
 15388              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15389                 MOVE ER-1571    TO WS-ERROR
 15390                 PERFORM 9900-ERROR-FORMAT
 15391                                 THRU 9900-EXIT
 15392              END-IF
 15393           END-IF
 15394        END-IF
 15395        IF WS-ERROR = ER-2661
 15396           PERFORM 9900-ERROR-FORMAT
 15397                                 THRU 9900-EXIT
 15398        END-IF
 15399     END-IF
 15400
 15401*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15402*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15403*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15404                                                                  ELC50PD
 15405     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15406        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15408                                                                  ELC50PD
 15409     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15410        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15412                                                                  ELC50PD
 15413     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15414        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15415        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15416                                                                  ELC50PD
 15417 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15418                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 280
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15419     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15420         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15421                                                                  ELC50PD
 15422     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15423        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15424     END-IF
 15425
 15426     .
 15427 3221-CONTINUE.                                                   ELC50PD
 15428     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15429                                    WS-DCC-AH-RATE
 15430
 15431     IF PB-COMPANY-ID = 'DCC'
 15432        IF WS-LF-BEN-CATEGORY = 'D'
 15433           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15434              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15435        END-IF
 15436     END-IF
 15437
 15438     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15439
 15440*   X'A4FF' = 12/31/2009
 15441     IF (PB-COMPANY-ID = 'CID')
 15442        AND (WS-LF-EARNINGS-CALC = 'B')
 15443        AND (CP-STATE-STD-ABBRV = 'MN')
 15444        AND (PB-CERT-EFF-DT > X'A4FF')
 15445        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15446     END-IF
 15447
 15448     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15449                                                                  ELC50PD
 15450     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15451     IF (PB-COMPANY-ID = 'DCC')
 15452        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15453        AND (PB-I-POLICY-IS-MONTHLY)
 15454        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15455        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15456     END-IF
 15457     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15458     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15459     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15460     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15461
 15462     IF (PB-COMPANY-ID = 'DCC')
 15463        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15464        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15465        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15466        MOVE ER-2786             TO WS-ERROR
 15467        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15468     END-IF
 15469                                                                  ELC50PD
 15470     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15471                                                                  ELC50PD
 15472******************************************************************ELC50PD
 15473*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15474******************************************************************ELC50PD
 15475     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15476        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 281
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15477                                                                  ELC50PD
 15478     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15479        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15480     ELSE                                                         ELC50PD
 15481       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15482          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15483          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15484                                                                  ELC50PD
 15485 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15486                                                                  ELC50PD
 15487     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15488        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15489        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15490         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15491                                                                  ELC50PD
 15492     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15493         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15494             AND PB-COMPANY-ID NOT = 'DCC')
 15495                   OR
 15496
 15497              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15498              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15499              AND PB-COMPANY-ID NOT = 'DCC')
 15500             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15501             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15502             GO TO 3225-RATING-CONT                               ELC50PD
 15503         ELSE                                                     ELC50PD
 15504             GO TO 3225-RATING-CONT.                              ELC50PD
 15505
 15506     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15507        AND (AM-GPCD = 01 OR 06 OR 15)
 15508        MOVE ER-2798             TO WS-ERROR
 15509        PERFORM 9900-ERROR-FORMAT
 15510                                 THRU 9900-EXIT
 15511*       GO TO 3225-RATING-CONT
 15512     END-IF
 15513
 15514     IF (PB-COMPANY-ID = 'CID')
 15515        AND (WS-LF-EARNINGS-CALC = 'B')
 15516        AND (CP-STATE-STD-ABBRV = 'MN')
 15517        AND (PB-CERT-EFF-DT > X'A4FF')
 15518        GO TO 3225-RATING-CONT
 15519     END-IF
 15520
 15521     IF PB-COMPANY-ID = 'DCC'
 15522        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15523           AND (PB-I-POLICY-IS-MONTHLY)
 15524           GO TO 3225-RATING-CONT
 15525        END-IF
 15526     END-IF
 15527
 15528     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15529        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15530        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15531        NEXT SENTENCE                                             ELC50PD
 15532     ELSE                                                         ELC50PD
 15533        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15534                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 282
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15535 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15536                                                                  ELC50PD
 15537     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15538                                                                  ELC50PD
 15539     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15540        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15541        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15542         NEXT SENTENCE                                            ELC50PD
 15543     ELSE                                                         ELC50PD
 15544         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15545                                                                  ELC50PD
 15546     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15547     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15548     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15549                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15550     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15551         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15552                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15553
 15554     IF PB-COMPANY-ID = 'DCC'
 15555        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15556     END-IF
 15557
 15558     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15559     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15560     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15561                                    CP-REMAINING-TERM             ELC50PD
 15562                                    CP-LOAN-TERM.                 ELC50PD
 15563     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15564        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15565                                    CP-REMAINING-TERM             ELC50PD
 15566                                    CP-LOAN-TERM.                 ELC50PD
 15567                                                                  ELC50PD
 15568     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15569     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15570                                                                  ELC50PD
 15571     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15572         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15573         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15574         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15575                                                                  ELC50PD
 15576     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15577     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15578                                                                  ELC50PD
 15579     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15580         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15581                                                                  ELC50PD
 15582     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15583                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15584                                                                  ELC50PD
 15585     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15586        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15587        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 15588        GO TO 3225-CONTINUE.                                      ELC50PD
 15589                                                                  ELC50PD
 15590     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15591        GO TO 3225-CONTINUE.                                      ELC50PD
 15592                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 283
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15593     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15594                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15595        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15596        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15598                                                                  ELC50PD
 15599 3225-CONTINUE.                                                   ELC50PD
 15600     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15601         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15603                                                                  ELC50PD
 15604     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15605        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
 15606        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15608                                                                  ELC50PD
 15609 3225-RATING-CONT.                                                ELC50PD
 15610                                                                  ELC50PD
 15611     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15612         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15613         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15614         IF (PB-COMPANY-ID = 'DCC')
 15615            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15616            CONTINUE
 15617         ELSE
 15618            MOVE ER-2687         TO WS-ERROR
 15619            PERFORM 9900-ERROR-FORMAT
 15620                                 THRU 9900-EXIT
 15621         END-IF
 15622         GO TO 3290-EDIT-LF-REIN-RATE
 15623     END-IF
 15624                                                                  ELC50PD
 15625* DMD RATING TEST                                                 ELC50PD
 15626     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15627         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15628         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15629         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15631         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15632                                                                  ELC50PD
 15633 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15634                                                                  ELC50PD
 15635     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15636     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15637*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15638     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15639     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15640                                                                  ELC50PD
 15641 C-POS-3230-MORT-CD.                                              ELC50PD
 15642     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15643        PB-SV-CARRIER = '2'                                       ELC50PD
 15644         NEXT SENTENCE                                            ELC50PD
 15645     ELSE                                                         ELC50PD
 15646         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15647                                                                  ELC50PD
 15648     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15649        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15650         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 284
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15651      ELSE                                                        ELC50PD
 15652         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15653                                                                  ELC50PD
 15654                                                                  ELC50PD
 15655 C-POS-3240-MORT-CD.                                              ELC50PD
 15656     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15657        PB-SV-CARRIER = '1'                                       ELC50PD
 15658         NEXT SENTENCE                                            ELC50PD
 15659     ELSE                                                         ELC50PD
 15660         GO TO 3230-CONTINUE.                                     ELC50PD
 15661                                                                  ELC50PD
 15662     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15663        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
 15664         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15665     ELSE                                                         ELC50PD
 15666         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15667                                                                  ELC50PD
 15668 3230-CONTINUE.                                                   ELC50PD
 15669
 15670     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15671        GO TO 3240-CONTINUE                                       00033065
 15672     END-IF
 15673
 15674     IF PB-CERT-EFF-DT > WS-971231
 15675        GO TO 3240-CONTINUE                                       00033065
 15676     END-IF
 15677
 15678     IF LF-BENEFIT-FOUND AND                                      00033066
 15679        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15680         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15681     ELSE                                                         00033069
 15682         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15683             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15684         ELSE                                                     00033072
 15685             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15686         END-IF
 15687     END-IF
 15688                                                                  00033074
 15689     .
 15690 3240-CONTINUE.                                                   ELC50PD
 15691
 15692     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15693         GO TO 3256-CONTINUE.                                     ELC50PD
 15694                                                                  ELC50PD
 15695     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15696         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15697     ELSE                                                         ELC50PD
 15698         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15699                                                                  ELC50PD
 15700 3256-CONTINUE.                                                   ELC50PD
 15701     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15702         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15703                                                                  ELC50PD
 15704     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15705         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15706     ELSE                                                         ELC50PD
 15707         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15708                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 285
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15709 3260-EDIT-CONTINUE.                                              ELC50PD
 15710     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15711                                                                  ELC50PD
 15712 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15713     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15714         GO TO 3290-RATING-CONT.                                  ELC50PD
 15715                                                                  ELC50PD
 15716     IF PB-COMPANY-ID = 'DCC'
 15717        GO TO 3290-RATING-CONT.
 15718
 15719     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15720     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15721     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
 15722     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15723     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15724                                                                  ELC50PD
 15725******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15726     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15727         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15728            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15729             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15730*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15731             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15732             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15733***  Y2K PROJ 7744                                                   CL*11
 15734             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15735                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15736***  Y2K PROJ 7744                                                   CL*11
 15737*******                                                           ELC50PD
 15738                                                                  ELC50PD
 15739     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15740     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15741     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15742     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15743                                   CP-RATE-DEV-PCT.               ELC50PD
 15744     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15745     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15746                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15747                                                                  ELC50PD
 15748************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15749     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15750         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15751            CP-EARN-AS-NET-PAY                                    ELC50PD
 15752             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15753                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15754************                                                      ELC50PD
 15755                                                                  ELC50PD
 15756     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15757         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15758                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15759     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15760     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15761     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15762     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15763     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15764     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15765     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15766     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 286
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15767                                   CP-REMAINING-TERM              ELC50PD
 15768                                   CP-LOAN-TERM.                  ELC50PD
 15769     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15770        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15771                                                                  ELC50PD
 15772     IF CP-TERM-IS-DAYS                                           ELC50PD
 15773         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15774     ELSE                                                         ELC50PD
 15775         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15776                                                                  ELC50PD
 15777
 15778     IF PB-COMPANY-ID = 'DCC'
 15779        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15780     END-IF
 15781
 15782     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15783          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15784                                                                  ELC50PD
 15785     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15786                                                                  ELC50PD
 15787     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15788     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15789                                                                  ELC50PD
 15790     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15791        IF PB-I-OB                                                ELC50PD
 15792           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15793           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15794           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15795        ELSE                                                      ELC50PD
 15796           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15797           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15798           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15799                                                                  ELC50PD
 15800     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15801                                                                  ELC50PD
 15802     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15803     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15804                                                                  ELC50PD
 15805     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15806         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15808                                                                  ELC50PD
 15809 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15810                                                                  ELC50PD
 15811     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15812        GO TO 3290-RATING-CONT.                                   ELC50PD
 15813                                                                  ELC50PD
 15814     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15815     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15816     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15817     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15818     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15819     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15820                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15821     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15822         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15823                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15824
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 287
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15825     IF PB-COMPANY-ID = 'DCC'
 15826        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15827     END-IF
 15828
 15829     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15830     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15831     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15832                                    CP-REMAINING-TERM             ELC50PD
 15833                                    CP-LOAN-TERM.                 ELC50PD
 15834     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15835        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15836                                    CP-REMAINING-TERM             ELC50PD
 15837                                    CP-LOAN-TERM.                 ELC50PD
 15838                                                                  ELC50PD
 15839     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15840     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15841                                                                  ELC50PD
 15842     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15843                                                                  ELC50PD
 15844     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15845         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15846         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15847                                                                  ELC50PD
 15848 3290-RATING-CONT.                                                ELC50PD
 15849                                                                  ELC50PD
 15850     IF PB-I-OB                                                   ELC50PD
 15851*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15852        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15853                                                                  ELC50PD
 15854 3299-EDIT-CONTINUE.                                              ELC50PD
 15855                                                                  ELC50PD
 15856     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15857         NEXT SENTENCE                                            ELC50PD
 15858     ELSE                                                         ELC50PD
 15859         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15860         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15861                                                                  ELC50PD
 15862 3300-CHECK-AH-RATES.                                             ELC50PD
 15863     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15864         NEXT SENTENCE                                            ELC50PD
 15865     ELSE                                                         ELC50PD
 15866         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15867                                                                  ELC50PD
 15868     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15869        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15870                (NO-DMD-RATING))                                  ELC50PD
 15871         IF (PB-COMPANY-ID = 'DCC')
 15872            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15873            CONTINUE
 15874         ELSE
 15875            MOVE ER-2687         TO WS-ERROR
 15876            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15877         END-IF
 15878         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15879         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15880     END-IF
 15881                                                                  ELC50PD
 15882     IF PB-I-OB                                                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 288
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15883        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15884                                                                  ELC50PD
 15885     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15886         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15888         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15889         GO TO 3999-END-EDIT.                                     ELC50PD
 15890                                                                  ELC50PD
 15891*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15892
 15893     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15894        IF PB-I-AH-CRIT-PER = ZERO
 15895           IF PB-COMPANY-ID = 'DCC'
 15896              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15897              CONTINUE
 15898           ELSE
 15899              MOVE ER-2618       TO WS-ERROR
 15900              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15901              GO TO 3999-END-EDIT
 15902           END-IF
 15903        END-IF
 15904     END-IF
 15905
 15906     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15907     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15908     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15909     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15910     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15911     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15912     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15913     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15914     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15915*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15916     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15917     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15918     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15919     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15920                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15921     IF PB-COMPANY-ID = 'CID'
 15922               OR
 15923        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15924         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15925                                         PB-I-AH-TERM.            ELC50PD
 15926     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15927        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15928           AND (PB-I-POLICY-IS-MONTHLY)
 15929           MOVE PB-I-LF-BENEFIT-AMT
 15930                                 TO CP-NET-BENEFIT-AMT
 15931           move pb-i-ah-premium-amt to cp-original-premium
 15932           add pb-i-lf-premium-amt to cp-original-premium
 15933        END-IF
 15934     END-IF
 15935
 15936     MOVE SPACES                 TO CP-BEN-CATEGORY
 15937
 15938     IF PB-COMPANY-ID = 'DCC'
 15939        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15940        EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 289
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15941           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15942              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15943              MOVE PB-I-LF-BENEFIT-AMT
 15944                                 TO CP-RATING-BENEFIT-AMT
 15945              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15946           WHEN WS-AH-BEN-CATEGORY = 'G'
 15947              MOVE PB-I-UNPAID-CASH-PRICE
 15948                                 TO CP-RATING-BENEFIT-AMT
 15949           WHEN WS-AH-BEN-CATEGORY = 'D'
 15950              MOVE WS-AH-PMF-COMM
 15951                                 TO CP-DCC-PMF-COMM
 15952              MOVE PB-I-AH-COMMISSION
 15953                                 TO CP-DCC-ACT-COMM
 15954        END-EVALUATE
 15955     END-IF
 15956
 15957     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15958     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15959     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15960     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15961     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15962     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15963     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15964                                    CP-REMAINING-TERM             ELC50PD
 15965                                    WS-WORK-TERM.                 ELC50PD
 15966     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15967                                                                  ELC50PD
 15968     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15969     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15970*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15971     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15972     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15973                                                                  ELC50PD
 15974     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15975     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15976         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15977         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15978         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15979                                                                  ELC50PD
 15980     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15981         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15982                                                                  ELC50PD
 15983     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15984                                                                  ELC50PD
 15985     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15986         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15987     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15988         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15989     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15990         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15991     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15992         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15993     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15994         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15995                                                                  ELC50PD
 15996     MOVE 1                      TO SUB2.                         ELC50PD
 15997     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15998     MOVE WS-MONTH               TO SUB1.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 290
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15999     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 16000     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 16001                                                                  ELC50PD
 16002 3310-GET-SKIP-MO.                                                ELC50PD
 16003     IF SUB1 = 13                                                 ELC50PD
 16004         MOVE 1                  TO SUB1.                         ELC50PD
 16005                                                                  ELC50PD
 16006     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 16007         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 16008                                                                  ELC50PD
 16009     ADD 1 TO SUB2                                                ELC50PD
 16010              SUB1.                                               ELC50PD
 16011                                                                  ELC50PD
 16012 3320-RATE-CONTINUE.                                              ELC50PD
 16013                                                                  ELC50PD
 16014     IF WS-WORK-TERM = ZERO                                       ELC50PD
 16015         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 16016                                                                  ELC50PD
 16017     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 16018                                    CP-LOAN-TERM.                 ELC50PD
 16019                                                                  ELC50PD
 16020     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 16021         NEXT SENTENCE                                            ELC50PD
 16022     ELSE                                                         ELC50PD
 16023         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 16024                                    PB-I-AH-REI-RATE.             ELC50PD
 16025                                                                  ELC50PD
 16026                                                                  ELC50PD
 16027     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16028        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 16029                                                                  ELC50PD
 16030     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 16031         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 16032         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 16033         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 16034         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 16035                                                                  ELC50PD
 16036     IF PB-COMPANY-ID = 'DCC'
 16037        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16038           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16039              PB-I-RATE-DEV-PCT-LF
 16040        END-IF
 16041        MOVE PB-I-LF-ALT-BENEFIT-AMT
 16042                                 TO CP-ALTERNATE-BENEFIT
 16043        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16044        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 16045        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 16046     END-IF
 16047
 16048     IF (PB-COMPANY-ID = 'CID')
 16049        AND (WS-LF-EARNINGS-CALC = 'B')
 16050        AND (CP-STATE-STD-ABBRV = 'MN')
 16051        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 16052     ELSE
 16053        MOVE ' '                 TO CP-AH-BALLOON-SW
 16054     END-IF
 16055
 16056     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 291
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16057     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16058     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16059                                                                  ELC50PD
 16060     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16061        IF PB-I-OB                                                ELC50PD
 16062           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 16063           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16064           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 16065        ELSE                                                      ELC50PD
 16066          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16067              NEXT SENTENCE
 16068          ELSE
 16069           MOVE ER-2642          TO WS-ERROR                      ELC50PD
 16070           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16071           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 16072                                                                  ELC50PD
 16073     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 16074        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 16075           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 16076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16077                                                                  ELC50PD
 16078     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16079        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 16080           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 16081              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 16082              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 16083                                                                  ELC50PD
 16084     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16085        NEXT SENTENCE                                             ELC50PD
 16086     ELSE                                                         ELC50PD
 16087       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 16088          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 16089          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 16090                                                                  ELC50PD
 16091     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16092         IF WS-ERROR = ER-2640                                    ELC50PD
 16093             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16094
 16095     IF ACCOUNT-AH-CHECKED
 16096        CONTINUE
 16097     ELSE
 16098        IF (CP-R-MAX-ATT-AGE NUMERIC)
 16099           AND (CP-R-MAX-ATT-AGE > +0)
 16100           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 16101           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 16102              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 16103              MOVE PB-I-AH-EXPIRE-DT
 16104                                 TO DC-BIN-DATE-2
 16105              MOVE '1'           TO DC-OPTION-CODE
 16106              PERFORM 8500-DATE-CONVERT
 16107                                 THRU 8500-EXIT
 16108              IF NO-CONVERSION-ERROR
 16109                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16110                    MOVE ER-2661       TO WS-ERROR
 16111*                   PERFORM 9900-ERROR-FORMAT
 16112*                                THRU 9900-EXIT
 16113                 END-IF
 16114              END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 292
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16115           ELSE
 16116              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16117              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16118                 MOVE ER-2661    TO WS-ERROR
 16119*                PERFORM 9900-ERROR-FORMAT
 16120*                                THRU 9900-EXIT
 16121              ELSE
 16122                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16123                    MOVE ER-1570 TO WS-ERROR
 16124                    PERFORM 9900-ERROR-FORMAT
 16125                                 THRU 9900-EXIT
 16126                 END-IF
 16127              END-IF
 16128           END-IF
 16129
 16130           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16131              MOVE PB-I-JOINT-BIRTHDAY
 16132                                    TO DC-BIN-DATE-1
 16133              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16134              MOVE '1'              TO DC-OPTION-CODE
 16135              PERFORM 8500-DATE-CONVERT
 16136                                    THRU 8500-EXIT
 16137              IF NO-CONVERSION-ERROR
 16138                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16139                    MOVE ER-2661       TO WS-ERROR
 16140*                   PERFORM 9900-ERROR-FORMAT
 16141*                                   THRU 9900-EXIT
 16142                 END-IF
 16143              END-IF
 16144           ELSE
 16145              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16146                (PB-I-AH-TERM / 12)
 16147              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16148                 MOVE ER-2661       TO WS-ERROR
 16149*                PERFORM 9900-ERROR-FORMAT
 16150*                                   THRU 9900-EXIT
 16151              ELSE
 16152                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16153                    MOVE ER-1571 TO WS-ERROR
 16154                    PERFORM 9900-ERROR-FORMAT
 16155                                 THRU 9900-EXIT
 16156                 END-IF
 16157              END-IF
 16158           END-IF
 16159           IF WS-ERROR = ER-2661
 16160              PERFORM 9900-ERROR-FORMAT
 16161                                    THRU 9900-EXIT
 16162           END-IF
 16163        END-IF
 16164     END-IF
 16165
 16166*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16167*       NEXT SENTENCE                                             ELC50PD
 16168*    ELSE                                                         ELC50PD
 16169*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16170*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16171*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16172                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 293
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16173     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16174        NEXT SENTENCE                                             ELC50PD
 16175     ELSE                                                         ELC50PD
 16176        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16177           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16178           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16179                                                                  ELC50PD
 16180     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16181        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16182         PB-POLICY-IS-VOIDED                                      ELC50PD
 16183        NEXT SENTENCE                                             ELC50PD
 16184     ELSE                                                         ELC50PD
 16185        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
 16186           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16188                                                                  ELC50PD
 16189     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16190         IF WS-ERROR = ER-2667                                    ELC50PD
 16191             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16192                                                                  ELC50PD
 16193     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16194        NEXT SENTENCE                                             ELC50PD
 16195     ELSE                                                         ELC50PD
 16196        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16197           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16198           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16199                                                                  ELC50PD
 16200     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16201         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16202                                                                  ELC50PD
 16203 3321-CONTINUE.                                                   ELC50PD
 16204     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16205     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16206
 16207     IF (PB-COMPANY-ID = 'DCC')
 16208        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16209        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16210                                    PB-I-LF-ALT-PREM-CALC
 16211        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16212        IF WS-AH-BEN-CATEGORY = 'G'
 16213           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16214           + PB-I-ADDL-CLP)
 16215           * (1 + WS-TOL-CLP-PCT)
 16216*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16217        ELSE
 16218           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16219           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16220*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16221        END-IF
 16222        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16223                                 TO PB-I-AH-PREM-CALC
 16224        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16225           MOVE ER-8152          TO WS-ERROR
 16226           PERFORM 9900-ERROR-FORMAT
 16227                                 THRU 9900-EXIT
 16228        ELSE
 16229           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16230                 PB-I-ADDL-CLP)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 294
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16231              MOVE ER-8148       TO WS-ERROR
 16232              PERFORM 9900-ERROR-FORMAT
 16233                                 THRU 9900-EXIT
 16234           END-IF
 16235        END-IF
 16236     END-IF
 16237     IF (PB-COMPANY-ID = 'DCC')
 16238        AND (PB-I-POLICY-IS-MONTHLY)
 16239        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16240        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16241        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16242           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16243        END-IF
 16244     END-IF
 16245
 16246     IF (PB-COMPANY-ID = 'DCC')
 16247        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16248        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16249        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16250        MOVE ER-2786             TO WS-ERROR
 16251        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16252     END-IF
 16253
 16254     MOVE +0                     TO PB-I-AH-CLP
 16255     IF PB-COMPANY-ID = 'DCC'
 16256        IF WS-AH-BEN-CATEGORY = 'D'
 16257           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16258              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16259        ELSE
 16260           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16261              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16262           END-IF
 16263        END-IF
 16264     END-IF
 16265
 16266     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16267                                                                  ELC50PD
 16268     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16269         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16270                                                                  ELC50PD
 16271     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16272         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16273                                                                  ELC50PD
 16274     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16275         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16276            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16277             NEXT SENTENCE                                        ELC50PD
 16278         ELSE                                                     ELC50PD
 16279             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16280                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16281                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16282             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16283                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16284                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16285                                                                  ELC50PD
 16286     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16287       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16288           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 295
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16289       ELSE
 16290         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16291         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16292                                                                  ELC50PD
 16293     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16294     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16295     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16296     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16297     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16298     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16299                                                                  ELC50PD
 16300     IF (PB-COMPANY-ID = 'DCC')
 16301        AND (WS-AH-BEN-CATEGORY = 'G')
 16302        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16303        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16304        IF CP-DEVIATION-CODE NOT = '000'
 16305           MOVE '000'            TO CP-DEVIATION-CODE
 16306           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16307           IF NO-CP-ERROR
 16308              COMPUTE PB-I-DDF-IU-RATE-UP =
 16309              PB-I-AH-CLP - CP-CALC-PREMIUM
 16310           ELSE
 16311              MOVE ER-3057        TO WS-ERROR
 16312              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16313           END-IF
 16314        END-IF
 16315     END-IF
 16316
 16317     .
 16318 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16319     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16320         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16321                                                                  ELC50PD
 16322     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16323     IF PB-COMPANY-ID = 'DCC'
 16324         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16325
 16326     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16327     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16328     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16329     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16330     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16331     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16332                                    CP-RATE-DEV-PCT.              ELC50PD
 16333*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16334     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16335     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16336     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16337     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16338                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16339     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16340         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16341                                         PB-I-AH-TERM.            ELC50PD
 16342     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16343     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16344     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16345     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16346     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 296
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16347     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16348                                    CP-REMAINING-TERM             ELC50PD
 16349                                    WS-WORK-TERM.                 ELC50PD
 16350     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16351
 16352     IF PB-COMPANY-ID = 'DCC'
 16353        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16354     END-IF
 16355
 16356     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16357         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16358            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16359                                                                  ELC50PD
 16360     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16361          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16362                                                                  ELC50PD
 16363     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16364                                                                  ELC50PD
 16365     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16366                                                                  ELC50PD
 16367     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16368                                                                  ELC50PD
 16369     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16370     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16371                                                                  ELC50PD
 16372     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16373         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16375         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16376                                                                  ELC50PD
 16377     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16378                                                                  ELC50PD
 16379     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16380     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16381                                                                  ELC50PD
 16382     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16383         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16385                                                                  ELC50PD
 16386                                                                  ELC50PD
 16387 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16388                                                                  ELC50PD
 16389     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16390         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16391             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16392             GO TO 3999-END-EDIT.                                 ELC50PD
 16393                                                                  ELC50PD
 16394     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16395                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16396                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16397                         OR 'AHL'
 16398         NEXT SENTENCE                                            ELC50PD
 16399     ELSE                                                         ELC50PD
 16400         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16401             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16402                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16403                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16404                                     PB-I-LF-PREM-CALC * .90      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 297
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16405                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16406                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16407                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16408                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16409                                                                  ELC50PD
 16410     IF PB-COMP-LF-PREM                                           ELC50PD
 16411        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16412        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16413                                                                  ELC50PD
 16414     IF PB-COMP-AH-PREM                                           ELC50PD
 16415        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16416                                                                  ELC50PD
 16417 3340-CHECK-DCC-TOT-FEES.
 16418
 16419     IF (PB-COMPANY-ID = 'DCC')
 16420        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16421        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16422        AND (PB-I-POLICY-IS-MONTHLY)
 16423        CONTINUE
 16424     ELSE
 16425        GO TO 3340-EDIT-LF-AH-TOL
 16426     END-IF
 16427
 16428     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16429     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16430
 16431     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16432        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16433           PB-I-RATE-DEV-PCT-LF
 16434     END-IF
 16435     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16436        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16437           PB-I-RATE-DEV-PCT-AH
 16438     END-IF
 16439     MOVE 'N'                    TO CP-BEN-CATEGORY
 16440
 16441     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16442                                                                  ELC50PD
 16443     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16444     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16445     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16446     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16447     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16448     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16449     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16450     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16451     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16452     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16453                                                                  ELC50PD
 16454     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16455     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16456     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16457     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16458     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16459     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16460                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16461     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16462         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 298
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16463                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16464     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16465     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16466     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16467     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16468     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16469     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16470     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16471     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16472     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16473                                    CP-REMAINING-TERM             ELC50PD
 16474                                    CP-LOAN-TERM.                 ELC50PD
 16475
 16476     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 16477        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 16478           PB-I-LF-PREMIUM-AMT
 16479     end-if
 16480                                                                  ELC50PD
 16481     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16482        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16483                                                                  ELC50PD
 16484     IF CP-TERM-IS-DAYS                                           ELC50PD
 16485         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16486     ELSE                                                         ELC50PD
 16487         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16488                                                                  ELC50PD
 16489
 16490     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16491
 16492     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16493         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16494                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16495         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16496
 16497     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16498     MOVE 'R'                    TO CP-RATE-FILE
 16499     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16500
 16501     IF NOT CP-ERROR-RATE-NOT-FOUND
 16502        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16503        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16504           AND (CP-BENEFIT-CD (1:1) = 'S')
 16505           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16506                                    PB-I-LF-PREMIUM-AMT
 16507        END-IF
 16508     ELSE
 16509        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16510     END-IF
 16511
 16512     .
 16513 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16514                                                                  ELC50PD
 16515***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16516***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16517***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16518***                                                               ELC50PD
 16519     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16520         PB-I-AH-PREMIUM-AMT                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 299
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16521          GIVING WS-CALC-WORK.                                    ELC50PD
 16522                                                                  ELC50PD
 16523     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16524        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16525         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16527                                                                  ELC50PD
 16528     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16529             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16530                 GIVING WS-UNSIGN-WRK1.                              CL**2
 16531                                                                     CL**2
 16532     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16533             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16534                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16535                                                                     CL**2
 16536     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16537                                + WS-UNSIGN-WRK4.                    CL**2
 16538                                                                     CL**2
 16539     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16540             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16541                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16542                                                                  ELC50PD
 16543******************************************************************ELC50PD
 16544*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16545******************************************************************ELC50PD
 16546                                                                  ELC50PD
 16547     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16548         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16549                                                                  ELC50PD
 16550     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16551         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16552                                                                  ELC50PD
 16553     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16554             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16555                                                                  ELC50PD
 16556 3342-CONTINUE.                                                   ELC50PD
 16557                                                                  ELC50PD
 16558     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16559         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16560         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16561            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16562              NEXT SENTENCE                                       ELC50PD
 16563         ELSE                                                     ELC50PD
 16564             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16565                                                                  ELC50PD
 16566     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16567         NEXT SENTENCE                                            ELC50PD
 16568     ELSE                                                         ELC50PD
 16569     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16570        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16571           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16572               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16573               PB-POLICY-IS-VOIDED)                               ELC50PD
 16574              NEXT SENTENCE                                       ELC50PD
 16575           ELSE                                                   ELC50PD
 16576              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16577                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16578                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 300
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16579                 GO TO 3344-CHECK-AH                              ELC50PD
 16580              ELSE                                                ELC50PD
 16581                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16582                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16583                 GO TO 3344-CHECK-AH.                             ELC50PD
 16584                                                                  ELC50PD
 16585***                                                               ELC50PD
 16586***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16587***                                                               ELC50PD
 16588                                                                  ELC50PD
 16589     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16590         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16591            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16592             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16593         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16594            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16595             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16596     ELSE                                                         ELC50PD
 16597         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 16598         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16599                                                                  ELC50PD
 16600***                                                               ELC50PD
 16601***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16602***                                                               ELC50PD
 16603                                                                  ELC50PD
 16604     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16605         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16606          WS-TOL-LF-PREM.                                         ELC50PD
 16607                                                                  ELC50PD
 16608     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16609         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16610          WS-TOL-LF-PREM.                                         ELC50PD
 16611                                                                  ELC50PD
 16612     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16613        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16614                                                                  ELC50PD
 16615     IF PB-REISSUED-CERT
 16616        or PB-POLICY-IS-DECLINED
 16617        or PB-POLICY-IS-VOIDED
 16618        continue
 16619     ELSE
 16620        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16621              > WS-TOL-LF-HIGH-PREM-AMT)
 16622           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16623              < WS-TOL-LF-LOW-PREM-AMT))
 16624                      or
 16625           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16626              > WS-TOL-LF-HIGH-PREM-PCT)
 16627           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16628              < WS-TOL-LF-LOW-PREM-PCT))
 16629           IF WS-PREM-REJECT-SW = SPACE
 16630              MOVE ER-2652       TO WS-ERROR
 16631              PERFORM 9900-ERROR-FORMAT
 16632                                 THRU 9900-EXIT
 16633           ELSE
 16634              MOVE ER-2650       TO WS-ERROR
 16635              PERFORM 9900-ERROR-FORMAT
 16636                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 301
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16637           end-if
 16638        end-if
 16639     end-if
 16640                                                                  ELC50PD
 16641*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16642*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16643*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16644*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16645                                                                  ELC50PD
 16646     IF WS-ERROR  =  ER-2650  OR  ER-2652
 16647        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16648                      OR
 16649           ((PB-COMPANY-ID = 'DCC')
 16650           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 16651           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16652           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16653        END-IF
 16654     END-IF
 16655                                                                  ELC50PD
 16656     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16657        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16658           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16659              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16660                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16661                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16662                 NEXT SENTENCE                                    ELC50PD
 16663              ELSE                                                ELC50PD
 16664                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16665                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16666                                                                  ELC50PD
 16667 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16668                                                                  ELC50PD
 16669      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16670          GO TO 3344-CHECK-AH.                                    ELC50PD
 16671                                                                  ELC50PD
 16672      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16673          GO TO 3344-CHECK-AH.                                    ELC50PD
 16674                                                                  ELC50PD
 16675      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16676                                     WS-UNSIGN-WRK6.              ELC50PD
 16677                                                                  ELC50PD
 16678      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16679          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16680                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16681                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16682                                                                  ELC50PD
 16683      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16684          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16685                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16686                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16687                                                                  ELC50PD
 16688      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16689          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16690              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16691                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16692                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16693              ELSE                                                ELC50PD
 16694                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 302
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16695                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16696                                                                  ELC50PD
 16697      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16698          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16699              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16700                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16701                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16702              ELSE                                                ELC50PD
 16703                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16704                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16705                                                                  ELC50PD
 16706 3344-CHECK-AH.                                                   ELC50PD
 16707                                                                  ELC50PD
 16708****************************************************************  ELC50PD
 16709***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16710***                                                               ELC50PD
 16711                                                                  ELC50PD
 16712     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16713         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16714             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16715         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16716             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16717     ELSE                                                         ELC50PD
 16718         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 16719         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16720                                                                  ELC50PD
 16721***                                                               ELC50PD
 16722***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16723***                                                               ELC50PD
 16724                                                                  ELC50PD
 16725     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16726         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16727                                                                  ELC50PD
 16728     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16729         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16730                                                                  ELC50PD
 16731     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16732        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16733                                                                  ELC50PD
 16734     IF (PB-REISSUED-CERT)
 16735        OR (PB-POLICY-IS-DECLINED)
 16736        OR (PB-POLICY-IS-VOIDED)
 16737        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16738        CONTINUE
 16739     ELSE
 16740        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16741              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16742                          or
 16743           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16744              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16745           IF WS-PREM-REJECT-SW = SPACE
 16746              MOVE ER-3052       TO WS-ERROR
 16747              PERFORM 9900-ERROR-FORMAT
 16748                                 THRU 9900-EXIT
 16749           ELSE
 16750              MOVE ER-3050       TO WS-ERROR
 16751              PERFORM 9900-ERROR-FORMAT
 16752                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 303
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16753           END-IF
 16754        END-IF
 16755     END-IF
 16756
 16757     if (pb-company-id = 'DCC')
 16758        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 16759        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 16760        and (pb-i-policy-is-monthly)
 16761        compute ws-tol-ah-high-prem-amt =
 16762           pb-i-tot-fees-calc + ws-tol-ah-prem
 16763        compute ws-tol-ah-low-prem-amt =
 16764           pb-i-tot-fees-calc - ws-tol-ah-prem
 16765        if ws-tol-ah-prem-pct > zeros
 16766           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 16767              (1 + ws-tol-ah-prem-pct)
 16768           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 16769              (1 - ws-tol-ah-prem-pct)
 16770        else
 16771           move +9999999.99      to ws-tol-ah-high-prem-pct
 16772           move +0               to ws-tol-ah-low-prem-pct
 16773        end-if
 16774        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 16775            or
 16776           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 16777                          or
 16778           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 16779           or
 16780           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 16781            move er-3049         to ws-error
 16782           perform 9900-error-format
 16783                                 thru 9900-exit
 16784
 16785        end-if
 16786     end-if
 16787
 16788     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16789         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16790             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16791             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16792                                                                  ELC50PD
 16793     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16794        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16795           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16796              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16797                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16798                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16799                 NEXT SENTENCE                                    ELC50PD
 16800              ELSE                                                ELC50PD
 16801                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16802                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16803                                                                  ELC50PD
 16804     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16805        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16806           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16807                                                                  ELC50PD
 16808     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16809        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16810           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 304
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16811           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16812                                                                  ELC50PD
 16813 3345-EDIT-CONTINUE.                                              ELC50PD
 16814                                                                  ELC50PD
 16815*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16816*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16817*          IF PB-ISSUE                                            ELC50PD
 16818*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16819*          ELSE                                                   ELC50PD
 16820*              IF PB-CANCELLATION                                 ELC50PD
 16821*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16822                                                                  ELC50PD
 16823*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16824*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16825*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16826*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16827*        ELSE                                                     ELC50PD
 16828*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16829*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16830                                                                  ELC50PD
 16831     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16832        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16833           PB-REISSUED-CERT  OR                                   ELC50PD
 16834           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16835           PB-POLICY-IS-VOIDED                                    ELC50PD
 16836            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16837            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16838        ELSE                                                      ELC50PD
 16839            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16840            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16841                                                                  ELC50PD
 16842     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16843        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16844           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16845           PB-POLICY-IS-VOIDED                                    ELC50PD
 16846            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16847            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16848        ELSE                                                      ELC50PD
 16849            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16850                                      PB-I-ENTRY-STATUS.          ELC50PD
 16851                                                                  ELC50PD
 16852     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16853        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16854           PB-REISSUED-CERT  OR                                   ELC50PD
 16855           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16856           PB-POLICY-IS-VOIDED                                    ELC50PD
 16857            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16858            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16859        ELSE                                                      ELC50PD
 16860            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16861                                      PB-I-ENTRY-STATUS.          ELC50PD
 16862                                                                  ELC50PD
 16863     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16864        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16865        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16866
 16867     IF PB-COMPANY-ID = 'DCC'
 16868        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 305
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16869        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16870        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16871           AND (NOT WS-LF-CASH))
 16872                           OR
 16873           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16874           AND (NOT WS-AH-CASH)))
 16875                       AND
 16876           (PB-I-ENTRY-STATUS NOT = '5')
 16877           MOVE 'M'              TO PB-BATCH-ENTRY
 16878                                    PB-I-ENTRY-STATUS
 16879        END-IF
 16880     END-IF
 16881
 16882     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16883         GO TO 3999-END-EDIT.                                     ELC50PD
 16884                                                                  ELC50PD
 16885     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16886        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16887        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16888        PB-I-OB                                                   ELC50PD
 16889         GO TO 3999-END-EDIT.                                     ELC50PD
 16890                                                                  ELC50PD
 16891     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16892         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16893         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16894         GO TO 3999-END-EDIT.                                     ELC50PD
 16895                                                                  ELC50PD
 16896     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16897     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16898                                                                  ELC50PD
 16899     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16900         GO TO 3999-END-EDIT.                                     ELC50PD
 16901                                                                  ELC50PD
 16902     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16903                                      FORM-MASTER-AH-SW.          ELC50PD
 16904                                                                  ELC50PD
 16905     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16906         MOVE  +1                 TO SUB6                         ELC50PD
 16907         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16908                                                                  ELC50PD
 16909     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16910         MOVE  +1                 TO SUB6                         ELC50PD
 16911         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16912                                                                  ELC50PD
 16913     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16914        AH-FORM-MASTER-FOUND                                      ELC50PD
 16915         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16916     ELSE                                                         ELC50PD
 16917         GO TO 3999-END-EDIT.                                     ELC50PD
 16918                                                                  ELC50PD
 16919******************************************************************ELC50PD
 16920*                  3350-GET-ERFORM                               *ELC50PD
 16921*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16922*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16923******************************************************************ELC50PD
 16924                                                                  ELC50PD
 16925 3350-GET-ERFORM.                                                 ELC50PD
 16926                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 306
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16927     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16928         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16929                                                                  ELC50PD
 16930     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16931     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16932     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16933     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16934                                                                  ELC50PD
 16935     IF PB-CANCELLATION                                           ELC50PD
 16936         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16937            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16938            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16939              GO TO 3350-EXIT                                     ELC50PD
 16940         ELSE                                                     ELC50PD
 16941             NEXT SENTENCE                                        ELC50PD
 16942     ELSE                                                         ELC50PD
 16943         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16944            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16945            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16946              GO TO 3350-EXIT.                                    ELC50PD
 16947                                                                  ELC50PD
 16948 3350-ERFORM-GETMAIN.                                             ELC50PD
 16949                                                                  ELC50PD
 16950     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16951     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16952                                                                  ELC50PD
 16953 3350-ERFORM-READ.                                                ELC50PD
 16954                                                                  ELC50PD
 16955     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16956     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16957     IF PB-CANCELLATION                                           ELC50PD
 16958         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16959     ELSE                                                         ELC50PD
 16960         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16961     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16962                                                                  ELC50PD
 16963     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16964                                                                  ELC50PD
 16965     IF FORM-MASTER-FOUND                                         ELC50PD
 16966       IF PB-CANCELLATION                                         ELC50PD
 16967          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16968             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16969             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16970              GO  TO 3350-EXIT                                    ELC50PD
 16971          ELSE                                                    ELC50PD
 16972              NEXT SENTENCE                                       ELC50PD
 16973       ELSE                                                       ELC50PD
 16974          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16975             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16976             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16977              GO  TO 3350-EXIT.                                   ELC50PD
 16978                                                                  ELC50PD
 16979     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16980     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16981     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16982                                                                  ELC50PD
 16983 3350-EXIT.                                                       ELC50PD
 16984      EXIT.                                                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 307
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16985                                                                  ELC50PD
 16986******************************************************************ELC50PD
 16987*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16988*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16989*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16990******************************************************************ELC50PD
 16991                                                                  ELC50PD
 16992 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16993                                                                  ELC50PD
 16994     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
 16995        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16996         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16997         GO TO   3355-EXIT.                                       ELC50PD
 16998                                                                  ELC50PD
 16999     IF  SUB6    LESS THAN   +40                                  ELC50PD
 17000         ADD  +1      TO  SUB6                                    ELC50PD
 17001         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 17002                                                                  ELC50PD
 17003     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 17004     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 17005                                                                  ELC50PD
 17006 3355-EXIT.                                                       ELC50PD
 17007      EXIT.                                                       ELC50PD
 17008                                                                  ELC50PD
 17009******************************************************************ELC50PD
 17010*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 17011*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 17012*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 17013******************************************************************ELC50PD
 17014                                                                  ELC50PD
 17015 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 17016                                                                  ELC50PD
 17017     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 17018        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 17019         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 17020         GO TO  3356-EXIT.                                        ELC50PD
 17021                                                                  ELC50PD
 17022      IF  SUB6    LESS THAN     +40                               ELC50PD
 17023          ADD  +1      TO  SUB6                                   ELC50PD
 17024          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 17025                                                                  ELC50PD
 17026     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 17027     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 17028                                                                  ELC50PD
 17029 3356-EXIT.                                                       ELC50PD
 17030      EXIT.                                                       ELC50PD
 17031                                                                  ELC50PD
 17032******************************************************************ELC50PD
 17033*                  3357-BENEFIT-SEARCH                           *ELC50PD
 17034*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 17035*   CANCELLATIONS ONLY.                                          *ELC50PD
 17036******************************************************************ELC50PD
 17037 3357-BENEFIT-SEARCH.                                             ELC50PD
 17038     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 17039         MOVE +1                          TO SUB6                 ELC50PD
 17040         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 17041                                                                  ELC50PD
 17042     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 308
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17043         MOVE +1                          TO SUB6                 ELC50PD
 17044         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 17045                                                                  ELC50PD
 17046 3357-EXIT.                                                       ELC50PD
 17047     EXIT.                                                        ELC50PD
 17048                                                                  ELC50PD
 17049******************************************************************ELC50PD
 17050*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 17051*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17052*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17053*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17054******************************************************************ELC50PD
 17055 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 17056     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 17057       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 17058         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17059           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17060              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17061                     IS GREATER THAN SPACES                       ELC50PD
 17062                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17063                                          WS-LF-REFUND-CALC       ELC50PD
 17064                 GO TO 3358-EXIT.                                 ELC50PD
 17065                                                                  ELC50PD
 17066     IF SUB6 LESS THAN +40                                        ELC50PD
 17067         ADD +1                 TO SUB6                           ELC50PD
 17068         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 17069                                                                  ELC50PD
 17070 3358-EXIT.                                                       ELC50PD
 17071     EXIT.                                                        ELC50PD
 17072******************************************************************ELC50PD
 17073*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 17074*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17075*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17076*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17077******************************************************************ELC50PD
 17078 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 17079     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 17080       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 17081         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17082           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17083              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17084                      IS GREATER THAN SPACES                      ELC50PD
 17085                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17086                                          WS-AH-REFUND-CALC       ELC50PD
 17087                 GO TO 3359-EXIT.                                 ELC50PD
 17088                                                                  ELC50PD
 17089     IF SUB6 LESS THAN +40                                        ELC50PD
 17090         ADD +1                 TO SUB6                           ELC50PD
 17091         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 17092                                                                  ELC50PD
 17093 3359-EXIT.                                                       ELC50PD
 17094     EXIT.                                                        ELC50PD
 17095                                                                  ELC50PD
 17096******************************************************************ELC50PD
 17097*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 17098*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17099*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17100******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 309
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17101                                                                  ELC50PD
 17102 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 17103                                                                  ELC50PD
 17104     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 17105         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 17106                                                                  ELC50PD
 17107     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 17108         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 17109                                                                  ELC50PD
 17110 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
 17111                                                                  ELC50PD
 17112     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 17113       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 17114        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17115        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17116         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17117            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 17118            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17119         ELSE                                                     ELC50PD
 17120            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 17121            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17122                                                                  ELC50PD
 17123 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 17124                                                                  ELC50PD
 17125     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 17126                                                                  ELC50PD
 17127     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 17128         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17129         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 17130            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17131                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17132                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17133            ELSE                                                  ELC50PD
 17134                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17135                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17136                                                                  ELC50PD
 17137 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 17138                                                                  ELC50PD
 17139     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 17140         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 17141         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 17142            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17143                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17144                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 17145            ELSE                                                  ELC50PD
 17146                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17147                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17148                                                                  ELC50PD
 17149 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17150                                                                  ELC50PD
 17151     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17152         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17153         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17154           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17155               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17156               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17157           ELSE                                                   ELC50PD
 17158               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 310
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17159               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17160                                                                  ELC50PD
 17161     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17162                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17163                                                                  ELC50PD
 17164     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17165         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17166         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17167             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17168                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
 17169                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17170             ELSE                                                 ELC50PD
 17171                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17172                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17173                                                                  ELC50PD
 17174******************************************************************ELC50PD
 17175*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17176*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17177*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17178******************************************************************ELC50PD
 17179                                                                  ELC50PD
 17180 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17181                                                                  ELC50PD
 17182     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17183         GO TO 3999-END-EDIT.                                     ELC50PD
 17184                                                                  ELC50PD
 17185 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17186                                                                  ELC50PD
 17187     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17188       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17189        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17190        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17191         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17192            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17193            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17194         ELSE                                                     ELC50PD
 17195            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17196            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17197                                                                  ELC50PD
 17198 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17199                                                                  ELC50PD
 17200     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17201                                                                  ELC50PD
 17202     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17203         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17204         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17205            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17206                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17207                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17208            ELSE                                                  ELC50PD
 17209                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17210                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17211                                                                  ELC50PD
 17212 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17213                                                                  ELC50PD
 17214     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17215         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17216         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 311
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17217            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17218                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17219                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17220            ELSE                                                  ELC50PD
 17221                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17222                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17223                                                                  ELC50PD
 17224 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17225                                                                  ELC50PD
 17226     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
 17227         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17228         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17229             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17230                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17231                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17232             ELSE                                                 ELC50PD
 17233                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17234                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17235                                                                  ELC50PD
 17236     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17237         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17238         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17239             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17240                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17241                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17242             ELSE                                                 ELC50PD
 17243                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17244                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17245                                                                  ELC50PD
 17246     GO TO 3999-END-EDIT.                                         ELC50PD
 17247                                                                  ELC50PD
 17248******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 312
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17250******************************************************************ELC50PD
 17251*                  E D I T   C A N C E L                         *ELC50PD
 17252******************************************************************ELC50PD
 17253                                                                  ELC50PD
 17254 3700-EDIT-CANCEL.                                                ELC50PD
 17255     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17256         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17257                                         WS-RES-MUNI-TAX          ELC50PD
 17258                                         PB-CI-STATE-TAX          ELC50PD
 17259                                         PB-CI-MUNI-TAX           ELC50PD
 17260         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17261                                                                  ELC50PD
 17262*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17263*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17264*          IF PB-CANCELLATION                                     ELC50PD
 17265*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17266*          ELSE                                                   ELC50PD
 17267*             IF PB-ISSUE                                         ELC50PD
 17268*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17269                                                                  ELC50PD
 17270     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17271        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17272     END-IF
 17273
 17274*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17275*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17276                                                                  ELC50PD
 17277     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17278        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17280        GO TO 3999-END-EDIT.                                      ELC50PD
 17281                                                                  ELC50PD
 17282     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17283        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17285        GO TO 3999-END-EDIT.                                      ELC50PD
 17286                                                                  ELC50PD
 17287     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17288        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17290                                                                  ELC50PD
 17291***************************************************************   ELC50PD
 17292*                                                             *   ELC50PD
 17293*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17294*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17295*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17296*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17297*                                                             *   ELC50PD
 17298***************************************************************   ELC50PD
 17299                                                                  ELC50PD
 17300     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17301                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17302                                                                  ELC50PD
 17303     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17304        NEXT SENTENCE                                             ELC50PD
 17305     ELSE                                                         ELC50PD
 17306        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17307           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 313
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17308           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17309               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17310               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17311               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17312                                                                  ELC50PD
 17313     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17314        NEXT SENTENCE                                             ELC50PD
 17315     ELSE                                                         ELC50PD
 17316        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17317           AND                                                    ELC50PD
 17318           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17319               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17320               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17321               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17322                                                                  ELC50PD
 17323     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17324        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17325                                                                  ELC50PD
 17326     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17327     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17328     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17329     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17330     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17331     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17332                                                                  ELC50PD
 17333     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17334                                      PB-C-AH-REF-CALC.           ELC50PD
 17335     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17336                                                                  ELC50PD
 17337******************************************************************ELC50PD
 17338*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17339*             TO VALIDATE COVERAGE.                              *ELC50PD
 17340******************************************************************ELC50PD
 17341                                                                  ELC50PD
 17342     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17343        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17344          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17345      ELSE                                                        ELC50PD
 17346          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17347                                                                  ELC50PD
 17348     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17349        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17350          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17351      ELSE                                                        ELC50PD
 17352          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17353                                                                  ELC50PD
 17354     EVALUATE TRUE                                                ELC50PD
 17355         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17356              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17357              PB-FORCE-OFF                                        ELC50PD
 17358                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17359                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17360                  END-IF                                          ELC50PD
 17361         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17362               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17363              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17364                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17365         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 314
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17366              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17367                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17368              ELSE                                                ELC50PD
 17369                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17370              END-IF                                              ELC50PD
 17371              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17372     END-EVALUATE.                                                ELC50PD
 17373                                                                  ELC50PD
 17374                                                                  ELC50PD
 17375*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17376*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17377*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17378*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17379*        ELSE                                                     ELC50PD
 17380*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17381                                                                  ELC50PD
 17382     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17383     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17384        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17385     ELSE
 17386        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17387     END-IF
 17388     .
 17389 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17390                                                                  ELC50PD
 17391     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17392        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17393         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17394         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17395                                 TO DC-BIN-DATE-2                 ELC50PD
 17396         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17397*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17398         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17399         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17400            NEXT SENTENCE                                         ELC50PD
 17401          ELSE                                                    ELC50PD
 17402             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17403                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17404                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17405                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17406                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17407                 ELSE                                             ELC50PD
 17408                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17409                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17410                                                                  ELC50PD
 17411     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17412        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17413         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17414         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17415                                 TO DC-BIN-DATE-2                 ELC50PD
 17416         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17417*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17418         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17419         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17420            NEXT SENTENCE                                         ELC50PD
 17421          ELSE                                                    ELC50PD
 17422             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17423                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 315
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17424                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17425                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17426                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17427                 ELSE                                             ELC50PD
 17428                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17429                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17430                                                                  ELC50PD
 17431     IF WS-ERROR = ER-2752                                        ELC50PD
 17432        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17433         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17434         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17435         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17436         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17437         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17438         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17439         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17440         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17441         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17442         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17443         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17444         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17445         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17446         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17447            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17448            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17449            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17450                                                                  ELC50PD
 17451     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17452        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17453        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17454             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17455             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17456                                                                  ELC50PD
 17457     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17458        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17459        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17460              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17461              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17462                                                                  ELC50PD
 17463     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17464        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17465        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17466           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17467            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17468              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17469               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17470               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17471                                                                  ELC50PD
 17472     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17473         GO TO 3999-END-EDIT.                                     ELC50PD
 17474                                                                  ELC50PD
 17475     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17476        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17477           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17478            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17479            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17480                                 TO DC-BIN-DATE-2                 ELC50PD
 17481            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 316
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17482*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17483            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17484            IF DATE-CONVERSION-ERROR                              ELC50PD
 17485               NEXT SENTENCE                                      ELC50PD
 17486             ELSE                                                 ELC50PD
 17487                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17488                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17489                                                                  ELC50PD
 17490     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17491        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17492           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17493            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17494            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17495                                 TO DC-BIN-DATE-2                 ELC50PD
 17496            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17497                                    DC-ELAPSED-MONTHS             ELC50PD
 17498            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17499*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17500            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17501            IF DATE-CONVERSION-ERROR                              ELC50PD
 17502               NEXT SENTENCE                                      ELC50PD
 17503             ELSE                                                 ELC50PD
 17504                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17505                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17506                                                                  ELC50PD
 17507     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17508                                    DC-ELAPSED-MONTHS.            ELC50PD
 17509                                                                  ELC50PD
 17510     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17511        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17512          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17513          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17514          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17515          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17516          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17517          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17518        ELSE                                                      ELC50PD
 17519          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17520                                     PB-C-LIVES                   ELC50PD
 17521          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17522             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17523                                                                  ELC50PD
 17524     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17525         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17526     ELSE                                                         ELC50PD
 17527         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17528                                                                  ELC50PD
 17529     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17530        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17531            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17532            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17533                                                                  ELC50PD
 17534     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17535        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17536         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17537            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17538               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17539               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 317
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17540                                                                  ELC50PD
 17541     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17542        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17543         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17544            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17545               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17546               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17547                                                                  ELC50PD
 17548     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17549        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17550         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17551            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17552            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17553                                                                  ELC50PD
 17554     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17555        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17556         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17557            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17558            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17559                                                                  ELC50PD
 17560     IF LF-COVERAGE-CANCELLED
 17561        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17562        if pb-ci-lf-expire-dt = low-values or spaces
 17563           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17564           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 17565           MOVE PB-CI-EXTENTION-DAYS
 17566                                 TO DC-ELAPSED-DAYS
 17567           SET BIN-PLUS-ELAPSED  TO TRUE
 17568           PERFORM 8500-DATE-CONVERT
 17569                                 THRU 8500-EXIT
 17570           IF DATE-CONVERSION-ERROR
 17571              move low-values    to dc-bin-date-2
 17572           end-if
 17573        else
 17574           move pb-ci-lf-expire-dt
 17575                                 to dc-bin-date-2
 17576        end-if
 17577        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 17578           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17579                             OR  'FIA'
 17580              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 17581           ELSE
 17582              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17583              MOVE ER-2731       TO WS-ERROR
 17584              PERFORM 9900-ERROR-FORMAT
 17585                                 THRU 9900-EXIT
 17586           end-if
 17587        end-if
 17588     end-if
 17589
 17590*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17591*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17592*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17593*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17594*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17595*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17596*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17597*        IF DATE-CONVERSION-ERROR                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 318
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17598*           NEXT SENTENCE                                         ELC50PD
 17599*         ELSE                                                    ELC50PD
 17600*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17601*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17602*                            OR  'FIA'                            ELC50PD
 17603*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17604*              ELSE                                               ELC50PD
 17605*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17606*               MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17607*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17608     .
 17609 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17610
 17611     IF AH-COVERAGE-CANCELLED
 17612        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 17613        if pb-ci-AH-expire-dt = low-values or spaces
 17614           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17615           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 17616           MOVE PB-CI-EXTENTION-DAYS
 17617                                 TO DC-ELAPSED-DAYS
 17618           SET BIN-PLUS-ELAPSED  TO TRUE
 17619           PERFORM 8500-DATE-CONVERT
 17620                                 THRU 8500-EXIT
 17621           IF DATE-CONVERSION-ERROR
 17622              move low-values    to dc-bin-date-2
 17623           end-if
 17624        else
 17625           move pb-ci-ah-expire-dt
 17626                                 to dc-bin-date-2
 17627        end-if
 17628        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 17629           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17630                             OR  'FIA'
 17631              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 17632           ELSE
 17633              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17634              MOVE ER-2771       TO WS-ERROR
 17635              PERFORM 9900-ERROR-FORMAT
 17636                                 THRU 9900-EXIT
 17637           end-if
 17638        end-if
 17639     end-if
 17640
 17641*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17642*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17643*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17644*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17645*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17646**       MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17647*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17648*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17649*        IF DATE-CONVERSION-ERROR                                 ELC50PD
 17650*           NEXT SENTENCE                                         ELC50PD
 17651*         ELSE                                                    ELC50PD
 17652*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17653*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17654*                             OR 'FIA'                            ELC50PD
 17655*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 319
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17656*             ELSE                                                ELC50PD
 17657*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17658*              MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17659*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17660     .
 17661 3705-EDIT-CONTINUED.                                             ELC50PD
 17662                                                                  ELC50PD
 17663*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17664*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17665*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17666*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17667*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17668*                                                                 ELC50PD
 17669*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17670*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17671*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17672*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17673*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17674*        ELSE                                                     ELC50PD
 17675*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17676*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17677*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17678                                                                  ELC50PD
 17679     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17680       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17681         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17682           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17683              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17685                                                                  ELC50PD
 17686     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17687        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17688            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17689            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17690            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17691                                                                  ELC50PD
 17692     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17693            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17694            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17695                                                                  ELC50PD
 17696     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17697         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17698            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17699            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17700                                                                  ELC50PD
 17701 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17702                                                                  ELC50PD
 17703     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17704         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17705             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17706                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17707                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17708                                                                  ELC50PD
 17709     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17710         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17711             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17712                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17713                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 320
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17714                                                                  ELC50PD
 17715 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17716                                                                  ELC50PD
 17717*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17718*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17719*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17720*           (NOT PB-CI-OB)                                        ELC50PD
 17721*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17722*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17723*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17724*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17725*                                                                 ELC50PD
 17726*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17727*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17728*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17729*           (NOT PB-CI-OB)                                        ELC50PD
 17730*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17731*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17732*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17733*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17734                                                                  ELC50PD
 17735     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17736         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17737            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17738             NEXT SENTENCE                                        ELC50PD
 17739         ELSE                                                     ELC50PD
 17740           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17741              NEXT SENTENCE                                       ELC50PD
 17742           ELSE                                                   ELC50PD
 17743              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17744              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17745                                                                  ELC50PD
 17746     IF CANCEL-FUTURE-DT                                          ELC50PD
 17747         GO TO 3999-END-EDIT.                                     ELC50PD
 17748                                                                  ELC50PD
 17749 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17750                                                                  ELC50PD
 17751     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17752        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17753        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17754                                                                  ELC50PD
 17755     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17756     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17757     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17758     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17759     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17760     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17761     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17762     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17763     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17764     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17765     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17766     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17767
 17768     IF (PB-COMPANY-ID = 'CID')
 17769        AND (CP-STATE-STD-ABBRV = 'WI')
 17770        MOVE '7'                 TO CP-REM-TERM-METHOD
 17771        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 321
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17772     ELSE
 17773        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17774        MOVE WS-REM-TRM-CALC-OPTION
 17775                                 TO CP-REM-TRM-CALC-OPTION
 17776     END-IF
 17777
 17778**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17779     IF (PB-COMPANY-ID = 'CID')
 17780        AND (CP-STATE-STD-ABBRV = 'MO')
 17781        AND (PB-CERT-EFF-DT >= X'9B41')
 17782        AND (PB-CERT-EFF-DT <= X'A2FB')
 17783        MOVE '7'                 TO CP-REM-TERM-METHOD
 17784        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17785     END-IF
 17786
 17787     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17788                                    CP-LOAN-TERM.                 ELC50PD
 17789     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17790        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17791                                                                  ELC50PD
 17792     IF CP-TERM-IS-DAYS                                           ELC50PD
 17793         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17794     ELSE                                                         ELC50PD
 17795         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17796                                                                  ELC50PD
 17797     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17798                                                                  ELC50PD
 17799     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17800                                                                  ELC50PD
 17801     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17802        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17803        NEXT SENTENCE                                             ELC50PD
 17804      ELSE                                                        ELC50PD
 17805          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17806                                                                  ELC50PD
 17807 3720-GET-LF-REFUND.                                              ELC50PD
 17808                                                                  ELC50PD
 17809     IF PB-C-LF-CANCEL-VOIDED
 17810        GO TO 3730-GET-AH-REMAIN-TERM
 17811     end-if
 17812                                                                  ELC50PD
 17813     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17814         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17815         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17816         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17817                                                                  ELC50PD
 17818     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17819        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17820         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17822         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17823         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17824         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17825                                                                  ELC50PD
 17826*    if (ws-lf-earnings-calc = '6')
 17827*       or (pb-c-lf-refund-override = '6')
 17828*       move cp-remaining-term-1 to cp-remaining-term-2
 17829*    end-if
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 322
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17830     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17831                                                                     CL**2
 17832     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17833     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
 17834     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17835     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17836     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17837     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17838
 17839     IF (PB-COMPANY-ID = 'DCC')
 17840        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17841
 17842        IF PDEF-MASTER-FOUND
 17843           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17844              (V1 > +8)
 17845              OR (PD-PROD-CODE (V1) = 'L')
 17846           END-PERFORM
 17847           IF V1 < +9
 17848              MOVE PD-MAX-AMT (V1)
 17849                           TO CP-R-MAX-TOT-BEN
 17850                              EC-AM-LF-MAX-TOT-BEN
 17851           END-IF
 17852        ELSE
 17853
 17854        MOVE ' '                 TO PDEF-MASTER-SW
 17855        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17856        MOVE PB-STATE            TO ERPDEF-STATE
 17857        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17858        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17859        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17860        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17861        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17862        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17863        IF PDEF-MASTER-FOUND
 17864           MOVE 'N'              TO PDEF-MASTER-SW
 17865           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17866           IF PDEF-MASTER-FOUND
 17867              IF (ERPDEF-KEY-SAVE (1:16) =
 17868                           PD-CONTROL-PRIMARY (1:16))
 17869                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17870                 CONTINUE
 17871              ELSE
 17872                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17873                 IF (ERPDEF-KEY-SAVE (1:16) =
 17874                           PD-CONTROL-PRIMARY (1:16))
 17875                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17876                    CONTINUE
 17877                 ELSE
 17878                    MOVE 'N'     TO PDEF-MASTER-SW
 17879                 END-IF
 17880              END-IF
 17881
 17882              IF PDEF-MASTER-FOUND
 17883                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17884                    (V1 > +8)
 17885                    OR (PD-PROD-CODE (V1) = 'L')
 17886                 END-PERFORM
 17887                 IF V1 < +9
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 323
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17888                    MOVE PD-MAX-AMT (V1)
 17889                                 TO CP-R-MAX-TOT-BEN
 17890                                    EC-AM-LF-MAX-TOT-BEN
 17891                 END-IF
 17892              END-IF
 17893           END-IF
 17894           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17895        END-IF
 17896        END-IF
 17897     END-IF
 17898
 17899     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17900                                                                  ELC50PD
 17901     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17902                                                                  ELC50PD
 17903     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17904                                    PB-C-LF-REM-TERM.                CL**2
 17905                                                                     CL**2
 17906     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17907     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17908                                                                  ELC50PD
 17909     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17910        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17911           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17912           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17913                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17914                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17915           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17916              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17917              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17918           ELSE                                                   ELC50PD
 17919              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17920                                                                  ELC50PD
 17921     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17922                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17923                            OR '9' OR 'G'
 17924        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17925                                 TO CP-EARNING-METHOD.            ELC50PD
 17926                                                                  ELC50PD
 17927     if pb-company-id = 'AHL'
 17928        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17929        if cp-class-code = spaces
 17930           move zeros            to cp-class-code
 17931        end-if
 17932     ELSE
 17933        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17934     END-IF
 17935
 17936*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17937     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17938     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17939                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17940     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17941         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17942                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17943     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17944     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
 17945     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 324
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17946     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17947     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17948     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17949     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17950     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17951         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17952                                                                  ELC50PD
 17953****   N O T E   ****
 17954*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17955*      THE OH HARD CODING IN ELCRFNDP
 17956
 17957     IF PB-COMPANY-ID = 'CID'
 17958        IF CP-STATE-STD-ABBRV = 'OH'
 17959           MOVE WS-LF-EARNINGS-CALC
 17960                                 TO CP-EARNING-METHOD
 17961        END-IF
 17962     END-IF
 17963
 17964****   N O T E   ****
 17965
 17966     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17967         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17968            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17969                MOVE WS-DEFAULT-APR                               ELC50PD
 17970                                 TO  CP-LOAN-APR                  ELC50PD
 17971                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17972                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17973            ELSE                                                  ELC50PD
 17974                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17975                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17976
 17977*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17978
 17979     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17980                                                                  ELC50PD
 17981     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17982         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17983                                                                  ELC50PD
 17984     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17985        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17986        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17987        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17988                                                                  ELC50PD
 17989     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17990        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17992                                                                  ELC50PD
 17993     IF PB-COMPANY-ID = 'DCC'
 17994        AND PB-CI-ENTRY-STATUS = 'M'
 17995        MOVE +0                  TO PB-C-LF-REF-CALC
 17996     ELSE
 17997        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17998     END-IF
 17999                                                                  ELC50PD
 18000     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 18001         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 18002                                                                  ELC50PD
 18003*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 325
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18004*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 18005*                                   CP-REMAINING-TERM             ELC50PD
 18006*                                   CP-ORIGINAL-TERM.             ELC50PD
 18007                                                                  ELC50PD
 18008     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 18009     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 18010                                    CP-RATING-METHOD.             ELC50PD
 18011
 18012     IF PB-COMPANY-ID = 'CID'
 18013        IF (CP-STATE-STD-ABBRV = 'MN')
 18014           AND (PB-CERT-EFF-DT > X'A4FF')
 18015           AND (WS-LF-EARNINGS-CALC = 'B')
 18016           MOVE '5'              TO CP-EARNING-METHOD
 18017           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 18018        END-IF
 18019     END-IF
 18020
 18021     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 18022                                        CP-REMAINING-BENEFIT      ELC50PD
 18023                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 18024     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18025         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 18026                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 18027     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 18028     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 18029                                                                  ELC50PD
 18030     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18031                                                                  ELC50PD
 18032     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18033        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18034        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18035        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18036                                                                  ELC50PD
 18037     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18038        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18040                                                                  ELC50PD
 18041     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 18042                                                                  ELC50PD
 18043******************************************************************ELC50PD
 18044                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 326
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18046 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 18047     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 18048        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 18049         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18050                                                                  ELC50PD
 18051     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 18052         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 18053            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 18054             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 18055                                                                  ELC50PD
 18056     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 18057     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 18058     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 18059     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 18060     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 18061     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 18062     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 18063     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 18064     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 18065     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 18066     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 18067     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 18068
 18069     IF (PB-COMPANY-ID = 'CID')
 18070        AND (CP-STATE-STD-ABBRV = 'WI')
 18071        MOVE '7'                 TO CP-REM-TERM-METHOD
 18072        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18073     ELSE
 18074        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 18075        MOVE WS-REM-TRM-CALC-OPTION
 18076                                 TO CP-REM-TRM-CALC-OPTION
 18077     END-IF
 18078
 18079     IF (PB-COMPANY-ID = 'CID')
 18080        AND (CP-STATE-STD-ABBRV = 'MO')
 18081        AND (PB-CERT-EFF-DT >= X'9B41')
 18082        AND (PB-CERT-EFF-DT <= X'A2FB')
 18083        MOVE '7'                 TO CP-REM-TERM-METHOD
 18084        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18085     END-IF
 18086
 18087     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 18088                                    CP-LOAN-TERM.                 ELC50PD
 18089     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 18090         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 18091                                                                  ELC50PD
 18092     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 18093                                                                  ELC50PD
 18094     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 18095                                                                  ELC50PD
 18096     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 18097        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 18098        NEXT SENTENCE                                             ELC50PD
 18099      ELSE                                                        ELC50PD
 18100         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18101                                                                  ELC50PD
 18102 3740-GET-AH-REFUND.                                              ELC50PD
 18103                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 327
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18104     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 18105        GO TO 3780-UPDATE-CANCEL-CERT
 18106     END-IF
 18107                                                                  ELC50PD
 18108     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 18109         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 18110         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18111                                                                  ELC50PD
 18112     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 18113*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 18114     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 18115     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 18116     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 18117                                    PB-C-AH-REM-TERM.             ELC50PD
 18118     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 18119     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 18120                                                                  ELC50PD
 18121     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 18122        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 18123           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 18124           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 18125                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 18126           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 18127              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 18128              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 18129           ELSE                                                   ELC50PD
 18130              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 18131                                                                  ELC50PD
 18132     IF PB-COMPANY-ID = 'DCC'
 18133        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18134            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 18135           MOVE 'S'              TO CP-EARNING-METHOD
 18136        END-IF
 18137     END-IF
 18138
 18139     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 18140                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 18141                            OR '9' OR 'G' OR 'S'
 18142        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 18143                                 TO CP-EARNING-METHOD.            ELC50PD
 18144                                                                  ELC50PD
 18145     if pb-company-id = 'AHL'
 18146        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 18147        if cp-class-code = spaces
 18148           move zeros            to cp-class-code
 18149        end-if
 18150     ELSE
 18151        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 18152     END-IF
 18153*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 18154     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 18155     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 18156                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 18157     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18158         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 18159                                         PB-CI-AH-TERM.           ELC50PD
 18160     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 18161     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 328
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18162     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 18163     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 18164     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 18165     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 18166                                                                  ELC50PD
 18167     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 18168        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 18169                                AND 'CID' AND 'DCC' AND 'AHL')
 18170           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 18171              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 18172              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 18173              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18174           END-IF
 18175        END-IF
 18176        IF PB-COMPANY-ID = 'CID'
 18177           IF NO-LIFE-COVERAGE
 18178              IF CP-CRITICAL-PERIOD
 18179                 MOVE '2'       TO CP-EARNING-METHOD
 18180              ELSE
 18181                 MOVE '6'       TO CP-EARNING-METHOD
 18182              END-IF
 18183           ELSE
 18184              IF WS-LF-COVERAGE-TYPE = 'L'
 18185                 MOVE '2'       TO CP-EARNING-METHOD
 18186              ELSE
 18187                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 18188                    (WS-LF-EARNINGS-CALC = '5')
 18189                    IF CP-CRITICAL-PERIOD
 18190                       MOVE '2'  TO CP-EARNING-METHOD
 18191                    ELSE
 18192                       MOVE '6'  TO CP-EARNING-METHOD
 18193                    END-IF
 18194                 ELSE
 18195                    MOVE '1'     TO CP-EARNING-METHOD
 18196                 END-IF
 18197              END-IF
 18198           END-IF
 18199        END-IF
 18200     END-IF
 18201                                                                  ELC50PD
 18202*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 18203*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 18204*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 18205*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18206*          ELSE                                                   ELC50PD
 18207*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18208                                                                  ELC50PD
 18209     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18210         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18211                                                                  ELC50PD
 18212     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18213         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18214            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18215                MOVE WS-DEFAULT-APR                               ELC50PD
 18216                                 TO  CP-LOAN-APR                  ELC50PD
 18217                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18218                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18219            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 329
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18220                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18221                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18222
 18223     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18224
 18225
 18226     IF PB-COMPANY-ID = 'DCC'
 18227        AND CP-CANCEL-REASON = 'R'
 18228        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18229        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18230     END-IF
 18231
 18232     IF PB-COMPANY-ID = 'DCC'
 18233        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18234        AND (CP-EARNING-METHOD = 'D')
 18235        AND (CP-CANCEL-REASON NOT = 'R')
 18236        CONTINUE
 18237     ELSE
 18238        GO TO 3750-CONTINUE
 18239     END-IF
 18240
 18241     MOVE ' '                    TO DD-IU-SW
 18242     IF NOT PDEF-MASTER-FOUND
 18243        MOVE ' '                 TO PDEF-MASTER-SW
 18244        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18245        MOVE PB-STATE            TO ERPDEF-STATE
 18246        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18247        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18248        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18249        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18250        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18251        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18252        IF PDEF-MASTER-FOUND
 18253           MOVE 'N'              TO PDEF-MASTER-SW
 18254           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18255           IF PDEF-MASTER-FOUND
 18256              IF (ERPDEF-KEY-SAVE (1:16) =
 18257                           PD-CONTROL-PRIMARY (1:16))
 18258                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18259                 CONTINUE
 18260              ELSE
 18261                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18262                 IF (ERPDEF-KEY-SAVE (1:16) =
 18263                           PD-CONTROL-PRIMARY (1:16))
 18264                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18265                    CONTINUE
 18266                 ELSE
 18267                    MOVE ER-2740 TO WS-ERROR
 18268                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18269                    GO TO 3770-CHECK-REFUNDS
 18270                 END-IF
 18271              END-IF
 18272           END-IF
 18273           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18274        END-IF
 18275     END-IF
 18276
 18277     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 330
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18278        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18279           (V1 > +8)
 18280           OR (PD-PROD-CODE (V1) = 'I')
 18281        END-PERFORM
 18282        IF V1 < +9
 18283           SET DD-IU-PRESENT        TO TRUE
 18284        END-IF
 18285        IF WS-AH-DCC-TRUNC = 'T'
 18286           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18287        ELSE
 18288           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18289        END-IF
 18290        EVALUATE TRUE
 18291           WHEN WS-TERM > +168
 18292              MOVE 15               TO V1
 18293           WHEN WS-TERM > +156
 18294              MOVE 14               TO V1
 18295           WHEN WS-TERM > +144
 18296              MOVE 13               TO V1
 18297           WHEN WS-TERM > +132
 18298              MOVE 12               TO V1
 18299           WHEN WS-TERM > +120
 18300              MOVE 11               TO V1
 18301           WHEN WS-TERM > +108
 18302              MOVE 10               TO V1
 18303           WHEN WS-TERM > +96
 18304              MOVE 9                TO V1
 18305           WHEN WS-TERM > +84
 18306              MOVE 8                TO V1
 18307           WHEN WS-TERM > +72
 18308              MOVE 7                TO V1
 18309           WHEN WS-TERM > +60
 18310              MOVE 6                TO V1
 18311           WHEN WS-TERM > +48
 18312              MOVE 5                TO V1
 18313           WHEN WS-TERM > +36
 18314              MOVE 4                TO V1
 18315           WHEN WS-TERM > +24
 18316              MOVE 3                TO V1
 18317           WHEN WS-TERM > +12
 18318              MOVE 2                TO V1
 18319           WHEN OTHER
 18320              MOVE 1                TO V1
 18321        END-EVALUATE
 18322
 18323        EVALUATE TRUE
 18324*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18325*             < +13)
 18326*             AND (DD-IU-PRESENT)
 18327*             MOVE 2                TO V2
 18328*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18329*             MOVE 1                TO V2
 18330           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18331              MOVE 2                TO V2
 18332           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18333              MOVE 3                TO V2
 18334           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18335              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 331
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18336           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18337              MOVE 5                TO V2
 18338           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18339              MOVE 6                TO V2
 18340           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18341              MOVE 7                TO V2
 18342           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18343              MOVE 8                TO V2
 18344           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18345              MOVE 9                TO V2
 18346           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18347              MOVE 10               TO V2
 18348           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18349              MOVE 11               TO V2
 18350           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18351              MOVE 12               TO V2
 18352           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18353              MOVE 13               TO V2
 18354           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18355              MOVE 14               TO V2
 18356           WHEN OTHER
 18357              MOVE 15               TO V2
 18358        END-EVALUATE
 18359
 18360        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18361                                 TO CP-DDF-LO-FACT
 18362        MOVE PD-UEP-FACTOR (V1 V2)
 18363                                 TO CP-DDF-HI-FACT
 18364
 18365        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18366        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18367
 18368        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18369           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18370        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18371        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18372
 18373        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18374           + PD-1ST-YR-ADMIN-ALLOW
 18375
 18376        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18377*       IF PI-CLP-YN = 'Y'
 18378*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18379*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18380*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18381*       END-IF
 18382
 18383        IF DD-IU-PRESENT
 18384           MOVE 'I'              TO CP-EARNING-METHOD
 18385        END-IF
 18386        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18387                                     CP-CLP-RATE-UP
 18388        IF CP-IU-RATE-UP NOT = ZEROS
 18389           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18390              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18391           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18392              / (1 - WS-WORK-FACT)
 18393        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 332
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18394     END-IF
 18395
 18396     .
 18397 3750-CONTINUE.
 18398
 18399     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18400                                                                  ELC50PD
 18401     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18402         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18403                                                                  ELC50PD
 18404     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18405        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18406        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18408                                                                  ELC50PD
 18409     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18410        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18412
 18413     IF PB-COMPANY-ID = 'DCC'
 18414        AND PB-CI-ENTRY-STATUS = 'M'
 18415        MOVE +0                  TO PB-C-AH-REF-CALC
 18416     ELSE
 18417        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18418     END-IF
 18419
 18420     IF PB-COMPANY-ID = 'DCC'
 18421        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18422        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18423        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18424        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18425        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18426        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18427        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18428        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18429*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18430     END-IF
 18431
 18432     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 333
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18434                                                                  ELC50PD
 18435 3770-CHECK-REFUNDS.                                              ELC50PD
 18436                                                                  ELC50PD
 18437     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18438        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18439           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18440           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18441           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18442           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18443              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18444                                                                  ELC50PD
 18445     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18446        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18447           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18448           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18449           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18450           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18451              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18452                                                                  ELC50PD
 18453     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18454        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18455        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18456           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18457              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18458                                                                  ELC50PD
 18459     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18460        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18461        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18462           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18463              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18464                                                                  ELC50PD
 18465     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18466             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18467     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18468             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18469                                                                  ELC50PD
 18470     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18471         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18472                                                                  ELC50PD
 18473     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18474         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18475                                                                  ELC50PD
 18476     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18477                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 334
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18479                                                                  ELC50PD
 18480 3772-CONTINUE.                                                   ELC50PD
 18481                                                                  ELC50PD
 18482**********************************                                ELC50PD
 18483*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18484*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18485*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18486***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18487**********************************                                ELC50PD
 18488     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18489     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18490         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18491             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18492             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18493           ELSE                                                   ELC50PD
 18494             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18495             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18496**********************************                                ELC50PD
 18497                                                                  ELC50PD
 18498 3773-CONTINUE.                                                   ELC50PD
 18499                                                                  ELC50PD
 18500     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18501        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18502           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18503           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18504                                                                  ELC50PD
 18505     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18506        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18507           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18508           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18509                                                                  ELC50PD
 18510     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18511         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18512             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18513     ELSE                                                         ELC50PD
 18514         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18515                                                                  ELC50PD
 18516     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18517         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18518             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18519     ELSE                                                         ELC50PD
 18520         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18521                                                                  ELC50PD
 18522     IF (PB-COMPANY-ID = 'DCC')
 18523        AND (PB-CI-ENTRY-STATUS = 'M')
 18524        AND (PB-C-LF-CANCEL-AMT > +0)
 18525        MOVE ER-3843             TO WS-ERROR
 18526        PERFORM 9900-ERROR-FORMAT
 18527                                 THRU 9900-EXIT
 18528     END-IF
 18529     EVALUATE TRUE                                                ELC50PD
 18530        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18531           CONTINUE                                               ELC50PD
 18532        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18533                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18534           CONTINUE                                               ELC50PD
 18535        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18536                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 335
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18537           CONTINUE                                               ELC50PD
 18538        WHEN OTHER                                                ELC50PD
 18539           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18540              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18541           END-IF                                                 ELC50PD
 18542           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18543                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18544                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18545              CONTINUE                                            ELC50PD
 18546           ELSE                                                   ELC50PD
 18547              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18548                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18549              END-IF                                              ELC50PD
 18550              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18551                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18552                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18553                 CONTINUE                                         ELC50PD
 18554              ELSE                                                ELC50PD
 18555                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18556                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18557                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18558                 ELSE                                             ELC50PD
 18559                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18560                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18561                 END-IF                                           ELC50PD
 18562              END-IF                                              ELC50PD
 18563           END-IF                                                 ELC50PD
 18564     END-EVALUATE.                                                ELC50PD
 18565                                                                  ELC50PD
 18566     EVALUATE TRUE                                                ELC50PD
 18567        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18568           CONTINUE                                               ELC50PD
 18569        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18570                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18571           CONTINUE                                               ELC50PD
 18572        WHEN OTHER                                                ELC50PD
 18573           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18574               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18575              CONTINUE                                            ELC50PD
 18576           ELSE                                                   ELC50PD
 18577              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18578               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18579                CONTINUE                                          ELC50PD
 18580              ELSE                                                ELC50PD
 18581                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18582                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18583                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18584                 ELSE                                             ELC50PD
 18585                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18586                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18587                 END-IF                                           ELC50PD
 18588              END-IF                                              ELC50PD
 18589           END-IF                                                 ELC50PD
 18590     END-EVALUATE.                                                ELC50PD
 18591                                                                  ELC50PD
 18592     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18593         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18594             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 336
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18595     ELSE                                                         ELC50PD
 18596         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18597                                                                  ELC50PD
 18598     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18599         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18600             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18601     ELSE                                                         ELC50PD
 18602         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18603                                                                  ELC50PD
 18604     IF (PB-COMPANY-ID = 'DCC')
 18605        AND (PB-CI-ENTRY-STATUS = 'M')
 18606        AND (PB-C-AH-CANCEL-AMT > +0)
 18607        MOVE ER-3843             TO WS-ERROR
 18608        PERFORM 9900-ERROR-FORMAT
 18609                                 THRU 9900-EXIT
 18610     END-IF
 18611     EVALUATE TRUE                                                ELC50PD
 18612        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18613           CONTINUE                                               ELC50PD
 18614*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18615*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18616        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18617                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18618           CONTINUE                                               ELC50PD
 18619        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18620                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18621           CONTINUE                                               ELC50PD
 18622        WHEN OTHER                                                ELC50PD
 18623           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18624              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18625           END-IF                                                 ELC50PD
 18626           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18627               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18628                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18629              CONTINUE                                            ELC50PD
 18630           ELSE                                                   ELC50PD
 18631              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18632                 MOVE +9999999.99 TO                              ELC50PD
 18633                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18634              END-IF                                              ELC50PD
 18635              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18636                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18637                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18638                 CONTINUE                                         ELC50PD
 18639              ELSE                                                ELC50PD
 18640                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18641                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18642                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18643                 ELSE                                             ELC50PD
 18644                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18645                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18646                 END-IF                                           ELC50PD
 18647              END-IF                                              ELC50PD
 18648           END-IF                                                 ELC50PD
 18649     END-EVALUATE.                                                ELC50PD
 18650                                                                  ELC50PD
 18651     EVALUATE TRUE                                                ELC50PD
 18652        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 337
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18653           CONTINUE                                               ELC50PD
 18654*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18655*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18656        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18657                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18658           CONTINUE                                               ELC50PD
 18659        WHEN OTHER                                                ELC50PD
 18660           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18661               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18662              CONTINUE                                            ELC50PD
 18663           ELSE                                                   ELC50PD
 18664              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18665                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18666                 CONTINUE                                         ELC50PD
 18667              ELSE                                                ELC50PD
 18668                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18669                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18670                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18671                 ELSE                                             ELC50PD
 18672                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18673                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18674                 END-IF                                           ELC50PD
 18675              END-IF                                              ELC50PD
 18676           END-IF                                                 ELC50PD
 18677     END-EVALUATE.                                                ELC50PD
 18678                                                                  ELC50PD
 18679     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18680        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18681        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18682           AND  PB-C-LF-REF-CALC < +1.00
 18683           AND  PB-C-AH-REF-CALC < +1.00
 18684           CONTINUE
 18685        ELSE
 18686           IF (PB-COMPANY-ID = 'DCC')
 18687              AND (PB-CI-ENTRY-STATUS = 'M')
 18688              CONTINUE
 18689           ELSE
 18690              MOVE ER-2741       TO WS-ERROR
 18691              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18692           END-IF
 18693        END-IF
 18694     END-IF
 18695                                                                  ELC50PD
 18696     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18697        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18698        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18699        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18700        OR                                                        ELC50PD
 18701        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18702        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18703        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18704             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18705                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18706                NEXT SENTENCE                                     ELC50PD
 18707             ELSE                                                 ELC50PD
 18708                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18709                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18710                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 338
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18711     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18712        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18713        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18714        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18715        OR                                                        ELC50PD
 18716        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18717        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18718        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18719             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18720                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18721                NEXT SENTENCE                                     ELC50PD
 18722             ELSE                                                 ELC50PD
 18723                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18724                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18725                                                                  ELC50PD
 18726 3775-OVER-REF-CHK.                                               ELC50PD
 18727                                                                  ELC50PD
 18728     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18729        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18730                                                                  ELC50PD
 18731     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18732                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18733                                                                  ELC50PD
 18734     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18735        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18736                                 PB-C-LF-REF-CALC                 ELC50PD
 18737      ELSE                                                        ELC50PD
 18738        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18739                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18740                                                                  ELC50PD
 18741     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18742        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18744                                                                  ELC50PD
 18745     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18746                                                                  ELC50PD
 18747     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18748        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18749                                 PB-C-AH-REF-CALC                 ELC50PD
 18750      ELSE                                                        ELC50PD
 18751        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18752                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18753                                                                  ELC50PD
 18754     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18755        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18756        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18757                                                                  ELC50PD
 18758     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18759        NEXT SENTENCE                                             ELC50PD
 18760       ELSE                                                       ELC50PD
 18761         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18762            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18763            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18764                                                                  ELC50PD
 18765 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18766                                                                  ELC50PD
 18767     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18768        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 339
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18769        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18770                                                                  ELC50PD
 18771     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18772         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18774                                                                  ELC50PD
 18775     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18776         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18777                                                                  ELC50PD
 18778     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18779         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18780                                                                  ELC50PD
 18781     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18782       AND                                                        ELC50PD
 18783        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18784       AND                                                        ELC50PD
 18785        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18786       AND                                                        ELC50PD
 18787        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18788            NEXT SENTENCE                                         ELC50PD
 18789       ELSE                                                       ELC50PD
 18790        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18791          AND                                                     ELC50PD
 18792***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18793***       AND                                                     ELC50PD
 18794           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18795            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18796               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18797               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18798               GO TO 3999-END-EDIT                                ELC50PD
 18799            ELSE                                                  ELC50PD
 18800               GO TO 3999-END-EDIT                                ELC50PD
 18801        ELSE                                                      ELC50PD
 18802            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18803               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18804               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18805               GO TO 3785-CHECK-NH.
 18806*              GO TO 3999-END-EDIT.                               ELC50PD
 18807                                                                  ELC50PD
 18808 3780-UPDATE-CONT-1.                                              ELC50PD
 18809     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18810                                                                  ELC50PD
 18811     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18812         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18813                                                                  ELC50PD
 18814     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18815         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18816
 18817     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18818                                                                  ELC50PD
 18819     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18820       AND                                                        ELC50PD
 18821        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18822       AND                                                        ELC50PD
 18823        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18824       AND                                                        ELC50PD
 18825        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18826            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 340
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18827       ELSE                                                       ELC50PD
 18828        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18829          AND                                                     ELC50PD
 18830***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18831***       AND                                                     ELC50PD
 18832           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18833           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18834            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18835               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18836               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18837               GO TO 3999-END-EDIT                                ELC50PD
 18838            ELSE                                                  ELC50PD
 18839               GO TO 3999-END-EDIT                                ELC50PD
 18840            END-IF
 18841           ELSE
 18842             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18843                MOVE ER-2890 TO WS-ERROR
 18844                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18845                GO TO 3999-END-EDIT
 18846             ELSE
 18847                GO TO 3785-CHECK-NH
 18848             END-IF
 18849           END-IF
 18850          ELSE                                                    ELC50PD
 18851            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18852              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18853                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18854                   MOVE ER-2890 TO WS-ERROR
 18855                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18856                   GO TO 3999-END-EDIT
 18857                ELSE
 18858                   MOVE ER-2765 TO WS-ERROR
 18859                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18860                   GO TO 3785-CHECK-NH
 18861                END-IF
 18862              ELSE
 18863               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18864               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18865               GO TO 3785-CHECK-NH.
 18866*              GO TO 3999-END-EDIT.                               ELC50PD
 18867                                                                  ELC50PD
 18868 3780-UPDATE-CONT-2.                                              ELC50PD
 18869                                                                  ELC50PD
 18870     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18871        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18872           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18873           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18874                                                                  ELC50PD
 18875     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18876        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18877           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18878           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18879                                                                  ELC50PD
 18880     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18881        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18882        AND                                                       ELC50PD
 18883        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18884         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 341
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18885           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18886           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18887                                                                  ELC50PD
 18888     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18889       AND                                                        ELC50PD
 18890        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18891             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18893                                                                  ELC50PD
 18894     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18895       AND                                                        ELC50PD
 18896        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18897             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18899                                                                  ELC50PD
 18900     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18901         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18902             OR 'CID' OR 'DCC' OR 'AHL'
 18903             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18904         ELSE                                                     ELC50PD
 18905             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18906                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18907                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18908             ELSE                                                 ELC50PD
 18909                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18910                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18911                                                                  ELC50PD
 18912     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18913        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18914        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18915
 18916 3785-CHECK-NH.
 18917
 18918     IF PB-STATE NOT = 'NH'
 18919        GO TO 3999-END-EDIT
 18920     END-IF
 18921
 18922     MOVE ER-2796                TO WS-ERROR
 18923     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18924
 18925     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18926        OR (CM-NH-INTERFACE-SW = 'Y')
 18927        MOVE ER-2793             TO WS-ERROR
 18928        PERFORM 9900-ERROR-FORMAT
 18929                                 THRU 9900-EXIT
 18930     END-IF
 18931
 18932     MOVE +0                     TO WS-PAYMENT-AMT
 18933     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18934        GO TO 3999-END-EDIT
 18935     END-IF
 18936
 18937     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18938        GO TO 3999-END-EDIT
 18939     END-IF
 18940
 18941     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18942     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 342
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18943
 18944     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18945        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18946     END-IF
 18947     MOVE '1'                    TO DC-OPTION-CODE
 18948     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18949     IF NO-CONVERSION-ERROR
 18950        IF DC-ELAPSED-DAYS < +16
 18951           GO TO 3999-END-EDIT
 18952        END-IF
 18953     END-IF
 18954
 18955     MOVE +0                     TO DC-ELAPSED-DAYS
 18956     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18957     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18958     MOVE '1'                    TO DC-OPTION-CODE
 18959     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18960     IF NO-CONVERSION-ERROR
 18961        IF DC-ELAPSED-DAYS > +30
 18962           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18963        ELSE
 18964           GO TO 3999-END-EDIT
 18965        END-IF
 18966     ELSE
 18967        GO TO 3999-END-EDIT
 18968     END-IF
 18969
 18970     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18971        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18972           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18973
 18974     IF WS-PAYMENT-AMT < 600.00
 18975        GO TO 3999-END-EDIT
 18976     END-IF
 18977
 18978     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18979                                                                  ELC50PD
 18980     IF (ERMAIL-FOUND = ' ')
 18981         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18982         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18983        GO TO 3999-END-EDIT
 18984     END-IF
 18985
 18986     MOVE ER-2795                TO WS-ERROR
 18987     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18988                                                                  ELC50PD
 18989     GO TO 3999-END-EDIT.                                         ELC50PD
 18990******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 343
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18992 3990-FILES-NOT-OPEN.                                             ELC50PD
 18993                                                                  ELC50PD
 18994     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18996     GO TO 9990-RETURN.                                           ELC50PD
 18997                                                                  ELC50PD
 18998 3999-END-EDIT.                                                   ELC50PD
 18999
 19000                                                                  ELC50PD
 19001     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 19002                                                                  ELC50PD
 19003     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 19004         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 19005         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 19006             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 19007             GO TO 9990-RETURN                                    ELC50PD
 19008          ELSE                                                    ELC50PD
 19009             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 19010             GO TO 9990-RETURN.                                   ELC50PD
 19011                                                                  ELC50PD
 19012     IF PB-CANCELLATION                                           ELC50PD
 19013          GO TO 9990-RETURN.                                      ELC50PD
 19014                                                                  ELC50PD
 19015     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19016        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 19017                                                                  ELC50PD
 19018     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 19019                                                                  ELC50PD
 19020     IF CERT-WAS-FOUND                                            ELC50PD
 19021         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 19022             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 19023          ELSE                                                    ELC50PD
 19024            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 19025      ELSE                                                        ELC50PD
 19026         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 19027
 19028     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 19029        IF PB-COMPANY-ID = 'DCC' AND
 19030           (PB-CARRIER = '2' OR '4' OR '6')
 19031              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 19032        END-IF
 19033     END-IF.
 19034
 19035     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 19036         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 19037     END-IF.
 19038
 19039     move ' '                    to ws-ins-age-defaulted
 19040     perform 8150-read-elcrtt    thru 8150-exit
 19041     if ws-ins-age-defaulted = 'Y'
 19042        move er-1573             to ws-error
 19043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19044     end-if
 19045
 19046     if ws-jnt-age-defaulted = 'Y'
 19047        move er-1574             to ws-error
 19048        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19049     end-if
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 344
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19050
 19051     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 19052     IF ((PB-COMPANY-ID = 'DCC')
 19053        AND (WS-NO-SECURE-PAY))
 19054                  OR
 19055        (WS-LF-SPECIAL-CALC-CD = 'O'
 19056        OR WS-AH-SPECIAL-CALC-CD = 'O')
 19057        SET SKIP-ADDR-EDIT       TO TRUE
 19058     END-IF
 19059
 19060     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 19061        AND (NOT SKIP-ADDR-EDIT)
 19062        MOVE ER-2963             TO WS-ERROR
 19063        PERFORM 9900-ERROR-FORMAT
 19064                                 THRU 9900-EXIT
 19065        GO TO 9990-RETURN
 19066     END-IF
 19067
 19068     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 19069
 19070     IF ERPNDM-FOUND NOT = 'X'
 19071        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19072           OR (PM-CITY        = SPACES OR LOW-VALUES)
 19073           OR (PM-STATE       = SPACES OR LOW-VALUES)
 19074           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 19075           AND (NOT SKIP-ADDR-EDIT)
 19076           MOVE ER-2694          TO WS-ERROR
 19077           PERFORM 9900-ERROR-FORMAT
 19078                                 THRU 9900-EXIT
 19079        END-IF
 19080        MOVE ' '                 TO STATE-RECORD-ERROR
 19081        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19082        MOVE PM-STATE            TO CNTL-ACCESS
 19083        MOVE '3'                 TO CNTL-REC-TYPE
 19084        MOVE +0                  TO CNTL-SEQ-NO
 19085        MOVE '0'                 TO RC-SW-2
 19086        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19087        IF (NO-STATE-RECORD)
 19088           OR (CF-RECORD-TYPE NOT = '3')
 19089           OR (PM-STATE NOT = CF-STATE-CODE)
 19090           IF (PM-STATE = SPACES)
 19091              AND (SKIP-ADDR-EDIT)
 19092              CONTINUE
 19093           ELSE
 19094              MOVE ER-2963       TO WS-ERROR
 19095              PERFORM 9900-ERROR-FORMAT
 19096                                 THRU 9900-EXIT
 19097           END-IF
 19098        END-IF
 19099        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 19100           MOVE ER-2883          TO WS-ERROR
 19101           PERFORM 9900-ERROR-FORMAT
 19102                                 THRU 9900-EXIT
 19103        END-IF
 19104        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 19105           MOVE ' '                 TO STATE-RECORD-ERROR
 19106           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19107           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 345
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19108           MOVE '3'                 TO CNTL-REC-TYPE
 19109           MOVE +0                  TO CNTL-SEQ-NO
 19110           MOVE '0'                 TO RC-SW-2
 19111           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19112           IF NO-STATE-RECORD
 19113              OR (CF-RECORD-TYPE NOT = '3')
 19114              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 19115              MOVE ER-2964          TO WS-ERROR
 19116              PERFORM 9900-ERROR-FORMAT
 19117                                    THRU 9900-EXIT
 19118           END-IF
 19119        END-IF
 19120     ELSE
 19121        IF NOT SKIP-ADDR-EDIT
 19122           MOVE ER-2393          TO WS-ERROR
 19123           PERFORM 9900-ERROR-FORMAT
 19124                                 THRU 9900-EXIT
 19125        END-IF
 19126     END-IF
 19127                                                                  ELC50PD
 19128     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 19129                                                                  ELC50PD
 19130     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 19131        ERPNDM-FOUND = ' ')                                       ELC50PD
 19132        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 19133           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 19134           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 19135          OR                                                      ELC50PD
 19136           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 19137          OR                                                      ELC50PD
 19138           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 19139           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 19140           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 19141                                                                  ELC50PD
 19142
 19143     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 19144        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 19145                                                                  ELC50PD
 19146     IF PM-INSURED-LAST-NAME      = SPACES
 19147        AND PM-INSURED-FIRST-NAME = SPACES
 19148        AND PM-ADDRESS-LINE-1     = SPACES
 19149        AND PM-ADDRESS-LINE-2     = SPACES
 19150        AND PM-CITY-STATE         = SPACES
 19151        AND PM-CRED-BENE-NAME     = SPACES
 19152        AND PM-CRED-BENE-ADDR     = SPACES
 19153        AND PM-CRED-BENE-CTYST    = SPACES
 19154        GO TO 3999-UNLOCK-ERMAIL
 19155     END-IF
 19156                                                                  ELC50PD
 19157     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 19158                                                                  ELC50PD
 19159     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 19160     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 19161     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 19162     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 19163     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 19164     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 19165     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 346
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19166     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 19167                                                                  ELC50PD
 19168     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 19169     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 19170                                                                  ELC50PD
 19171     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19172        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 19173     ELSE                                                         ELC50PD
 19174        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 19175        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 19176        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 19177                                                                  ELC50PD
 19178
 19179     GO TO 9990-RETURN.                                           ELC50PD
 19180                                                                  ELC50PD
 19181 3999-UNLOCK-ERMAIL.                                              ELC50PD
 19182     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19183        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 19184                                                                  ELC50PD
 19185     GO TO 9990-RETURN.                                           ELC50PD
 19186******************************************************************ELC50PD
 19187                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 347
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19189 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 19190     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19191        GO TO 4299-EXIT.                                          ELC50PD
 19192                                                                  ELC50PD
 19193*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 19194
 19195     IF PB-C-NH-INT-ON-REFS > ZEROS
 19196        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 19197     END-IF
 19198     IF PB-C-REF-INTERFACE-SW = 'Y'
 19199        MOVE PB-C-REF-INTERFACE-SW
 19200                                 TO CM-NH-INTERFACE-SW
 19201     END-IF
 19202
 19203     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19204     IF ERMAIL-FOUND = 'X'
 19205        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19206        OR (MA-CITY        = SPACES OR LOW-VALUES)
 19207        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 19208        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 19209           MOVE ER-2694          TO WS-ERROR
 19210           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19211     END-IF
 19212
 19213     IF PB-C-POST-CARD-IND = 'Y'
 19214        MOVE +8                  TO SUB
 19215*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19216        IF ERMAIL-FOUND = ' '
 19217           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 19218              (SUB > +7)
 19219              OR (MA-MAIL-STATUS (SUB) = '1')
 19220           END-PERFORM
 19221        END-IF
 19222        IF (SUB > +7)
 19223           OR (ERMAIL-FOUND = 'X')
 19224           MOVE ER-3789          TO WS-ERROR
 19225           PERFORM 9900-ERROR-FORMAT
 19226                                 THRU 9900-EXIT
 19227        END-IF
 19228     ELSE
 19229        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19230     END-IF
 19231
 19232     IF ERMAIL-FOUND = ' '
 19233        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 19234     END-IF.
 19235
 19236     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19237                                                                  ELC50PD
 19238     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19239        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19240                                                                  ELC50PD
 19241     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19242         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19243     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19244         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19245                                                                  ELC50PD
 19246 4100-APPLY-LF-CANCEL.                                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 348
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19247                                                                  ELC50PD
 19248     MOVE +0                     TO WS-SUB.                       ELC50PD
 19249                                                                  ELC50PD
 19250 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19251                                                                  ELC50PD
 19252     ADD +1                       TO WS-SUB.                      ELC50PD
 19253                                                                  ELC50PD
 19254     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19255        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19256           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19257        ELSE                                                      ELC50PD
 19258           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19259                                                                  ELC50PD
 19260     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19261                                   ER-2729 OR                     ELC50PD
 19262                                   ER-2730 OR                     ELC50PD
 19263                                   ER-2731 OR                     ELC50PD
 19264                                   ER-2732 OR                     ELC50PD
 19265                                   ER-2737 OR                     ELC50PD
 19266                                   ER-2740 OR                     ELC50PD
 19267                                   ER-2743 OR                     ELC50PD
 19268                                   ER-2749 OR                     ELC50PD
 19269                                   ER-2750 OR                     ELC50PD
 19270                                   ER-2755 OR                     ELC50PD
 19271                                   ER-2757 OR                     ELC50PD
 19272                                   ER-2760 OR                     ELC50PD
 19273                                   ER-2772 OR                     ELC50PD
 19274                                   ER-2774 OR                     ELC50PD
 19275                                   ER-2776 OR                     ELC50PD
 19276                                   ER-2794                        ELC50PD
 19277        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19278                                                                  ELC50PD
 19279     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19280                                                                  ELC50PD
 19281 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19282                                                                  ELC50PD
 19283     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19284     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19285     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19286        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19287     END-IF
 19288     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19289                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19290     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19291         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19292                                                                  ELC50PD
 19293     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19294         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19295                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19296                                                                  ELC50PD
 19297     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19298                                                                  ELC50PD
 19299 4100-LF-CANCEL-CONT.                                             ELC50PD
 19300     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19301         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19302                                                                  ELC50PD
 19303     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19304         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 349
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19305                                                                  ELC50PD
 19306     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19307        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19308           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19309        ELSE                                                      ELC50PD
 19310           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19311                                                                  ELC50PD
 19312     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19313     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19314                                                                  ELC50PD
 19315     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19316         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19317                                                                  ELC50PD
 19318     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 19319        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19320         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19321         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19322                                                                  ELC50PD
 19323     IF PB-RECORD-RETURNED                                        ELC50PD
 19324        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19325      ELSE                                                        ELC50PD
 19326        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19327                                                                  ELC50PD
 19328 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19329                                                                  ELC50PD
 19330     MOVE +0                      TO WS-SUB.                      ELC50PD
 19331                                                                  ELC50PD
 19332 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19333                                                                  ELC50PD
 19334     ADD +1                       TO WS-SUB.                      ELC50PD
 19335                                                                  ELC50PD
 19336     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19337        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19338           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19339        ELSE                                                      ELC50PD
 19340           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19341                                                                  ELC50PD
 19342     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19343                                   ER-2729 OR                     ELC50PD
 19344                                   ER-2732 OR                     ELC50PD
 19345                                   ER-2737 OR                     ELC50PD
 19346                                   ER-2740 OR                     ELC50PD
 19347                                   ER-2744 OR                     ELC50PD
 19348                                   ER-2749 OR                     ELC50PD
 19349                                   ER-2750 OR                     ELC50PD
 19350                                   ER-2778 OR                     ELC50PD
 19351                                   ER-2757 OR                     ELC50PD
 19352                                   ER-2760 OR                     ELC50PD
 19353                                   ER-2771 OR                     ELC50PD
 19354                                   ER-2772 OR                     ELC50PD
 19355                                   ER-2773 OR                     ELC50PD
 19356                                   ER-2775 OR                     ELC50PD
 19357                                   ER-2777 OR                     ELC50PD
 19358                                   ER-2794                        ELC50PD
 19359        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19360                                                                  ELC50PD
 19361     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19362                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 350
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19363 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19364                                                                  ELC50PD
 19365     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19366     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19367     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19368     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19369                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19370     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19371         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19372                                                                  ELC50PD
 19373     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19374         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19375                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19376                                                                  ELC50PD
 19377     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19378         IF PB-RECORD-RETURNED                                    ELC50PD
 19379              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19380          ELSE                                                    ELC50PD
 19381              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19382                                                                  ELC50PD
 19383     GO TO 4299-EXIT.                                             ELC50PD
 19384                                                                  ELC50PD
 19385 4100-AH-CANCEL-CONT.                                             ELC50PD
 19386     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19387         GO TO 4299-EXIT.                                         ELC50PD
 19388                                                                  ELC50PD
 19389     if cm-credit-interface-sw-2 = ' '
 19390        if pb-fatal-errors or pb-unforced-errors
 19391           move '4'              to cm-credit-interface-sw-2
 19392        else
 19393           move '1'              to cm-credit-interface-sw-2
 19394        end-if
 19395     end-if
 19396
 19397     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19398         GO TO 4299-EXIT.                                         ELC50PD
 19399                                                                  ELC50PD
 19400     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19401        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19402           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19403        ELSE                                                      ELC50PD
 19404           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19405                                                                  ELC50PD
 19406     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19407     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19408                                                                  ELC50PD
 19409     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19410         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19411                                                                  ELC50PD
 19412     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19413         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19414         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19415                                                                  ELC50PD
 19416     IF PB-RECORD-RETURNED                                        ELC50PD
 19417        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19418      ELSE                                                        ELC50PD
 19419        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19420                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 351
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19421     GO TO 4299-EXIT.                                             ELC50PD
 19422                                                                  ELC50PD
 19423 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19424     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19425                                                                  ELC50PD
 19426     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19427        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19428                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19429     ELSE                                                         ELC50PD
 19430        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19431                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19432                                                                  ELC50PD
 19433     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19434        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19435                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19436     ELSE                                                         ELC50PD
 19437        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19438                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19439                                                                  ELC50PD
 19440     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19441        NEXT SENTENCE                                             ELC50PD
 19442     ELSE                                                         ELC50PD
 19443        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19444                                                                  ELC50PD
 19445     GO TO 4299-EXIT.                                             ELC50PD
 19446                                                                  ELC50PD
 19447 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19448     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19449                                                                  ELC50PD
 19450     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19451        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19452        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19453        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19454                                                                  ELC50PD
 19455     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19456                                                                  ELC50PD
 19457     IF PB-RECORD-RETURNED                                        ELC50PD
 19458        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19459       ELSE                                                       ELC50PD
 19460        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19461                                                                  ELC50PD
 19462 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19463       EXIT.                                                      ELC50PD
 19464                                                                  ELC50PD
 19465 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19466     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19467                                                                  ELC50PD
 19468     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19469        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19470        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19471        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19472                                                                  ELC50PD
 19473     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19474                                                                  ELC50PD
 19475     IF PB-RECORD-RETURNED                                        ELC50PD
 19476        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19477       ELSE                                                       ELC50PD
 19478        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 352
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19479                                                                  ELC50PD
 19480 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19481       EXIT.                                                      ELC50PD
 19482                                                                  ELC50PD
 19483 4299-EXIT.                                                       ELC50PD
 19484       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 353
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19486                                                                  ELC50PD
 19487 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19488     IF CERT-WAS-FOUND                                            ELC50PD
 19489         NEXT SENTENCE                                            ELC50PD
 19490       ELSE                                                       ELC50PD
 19491         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19492                                                                  ELC50PD
 19493     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19494         GO TO 4999-EXIT.                                         ELC50PD
 19495                                                                  ELC50PD
 19496     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19497         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19498                                                                  ELC50PD
 19499     IF CERT-ADDED-BATCH                                          ELC50PD
 19500        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19501            GO TO 4999-EXIT.                                      ELC50PD
 19502                                                                  ELC50PD
 19503 4520-BUILD-NEW-KEY.                                              ELC50PD
 19504* BUILD CONTROL PRIMARY                                           ELC50PD
 19505                                                                  ELC50PD
 19506     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19507                                       CM-COMPANY-CD-A1           ELC50PD
 19508                                       CM-COMPANY-CD-A2           ELC50PD
 19509                                       CM-COMPANY-CD-A4           ELC50PD
 19510                                       CM-COMPANY-CD-A5.          ELC50PD
 19511                                                                  ELC50PD
 19512     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19513     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19514     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19515     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19516     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19517     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19518     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19519                                                                  ELC50PD
 19520     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19521                                                                  ELC50PD
 19522     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19523     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19524     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19525     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19526                                                                  ELC50PD
 19527     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19528        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19529                                                                  ELC50PD
 19530     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19531         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19532         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19533         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19534         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19535     ELSE                                                         ELC50PD
 19536         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19537                                                                  ELC50PD
 19538     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19539         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19540         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19541         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19542         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19543         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 354
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19544                                                                  ELC50PD
 19545     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19546        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19547         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19548                                                                  ELC50PD
 19549     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19550        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19551            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19552                                           PB-I-MEMBER-NO         ELC50PD
 19553            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19554                                                                  ELC50PD
 19555     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19556        NEXT SENTENCE                                             ELC50PD
 19557     ELSE                                                         ELC50PD
 19558        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19559                                                                  ELC50PD
 19560******************************************************************ELC50PD
 19561*                                                                *ELC50PD
 19562*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19563*    FOR 'MON'.                                                  *ELC50PD
 19564*                                                                *ELC50PD
 19565******************************************************************ELC50PD
 19566                                                                  ELC50PD
 19567     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19568     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19569     MOVE +1                     TO WS-SUB1                       ELC50PD
 19570                                    WS-SUB2.                      ELC50PD
 19571                                                                  ELC50PD
 19572 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19573                                                                  ELC50PD
 19574     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19575        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19576        ADD +1                       TO WS-SUB2.                  ELC50PD
 19577                                                                  ELC50PD
 19578     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19579        ADD +1                       TO WS-SUB1                   ELC50PD
 19580        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19581                                                                  ELC50PD
 19582     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19583     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19584     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19585*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19586     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19587     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19588     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19589                                                                  ELC50PD
 19590     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19591                                                                  ELC50PD
 19592******************************************************************ELC50PD
 19593*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19594******************************************************************ELC50PD
 19595                                                                  ELC50PD
 19596 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19597                                                                  ELC50PD
 19598     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19599         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19600         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19601         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 355
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19602         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19603     ELSE                                                         ELC50PD
 19604         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19605                                                                  ELC50PD
 19606     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19607        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19608         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19609                                                                  ELC50PD
 19610 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19611                                                                  ELC50PD
 19612*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19613*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19614*    ELSE                                                         ELC50PD
 19615*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19616                                                                  ELC50PD
 19617     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19618        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19619        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19620                                                                  ELC50PD
 19621     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19622        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19623        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19624                                                                  ELC50PD
 19625     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19626     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19627                                                                  ELC50PD
 19628     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19629        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19630        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19631     ELSE                                                         ELC50PD
 19632        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19633        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19634                                                                  ELC50PD
 19635     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19636     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19637     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19638     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19639     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19640     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19641     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19642                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19643                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19644                                      CM-AH-ITD-AH-PMT            ELC50PD
 19645                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19646                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19647                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19648                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19649*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19650*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19651     if pb-i-loan-apr = +99.9999
 19652        move zeros                 to cm-loan-apr
 19653     else
 19654        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 19655     end-if
 19656     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19657     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19658     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19659     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 356
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19660     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19661     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19662     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19663     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
 19664     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19665     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19666     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19667                                                                  ELC50PD
 19668     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19669         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19670                                                                  ELC50PD
 19671     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19672         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19673                                                                  ELC50PD
 19674     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19675     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19676                                                                  ELC50PD
 19677     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19678         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19679         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19680                                                                  ELC50PD
 19681     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19682     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19683     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19684     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19685     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19686     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19687                                                                  ELC50PD
 19688     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19689        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19690     ELSE                                                         ELC50PD
 19691        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19692                                                                  ELC50PD
 19693     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19694        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19695        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19696     ELSE                                                         ELC50PD
 19697        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19698                                                                  ELC50PD
 19699     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19700     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19701     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19702     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19703     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19704     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19705     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19706     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19707     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19708                                                                  ELC50PD
 19709     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19710        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19711     ELSE                                                         ELC50PD
 19712        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19713                                                                  ELC50PD
 19714     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19715        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19716     ELSE                                                         ELC50PD
 19717        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 357
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19718                                                                  ELC50PD
 19719     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19720     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19721                                                                  ELC50PD
 19722     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19723                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19724                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19725                                                                  ELC50PD
 19726*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19727*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19728*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19729*                       'NCL'                                     ELC50PD
 19730     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19731                                                                  ELC50PD
 19732     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19733         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19734            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19735                                                                  ELC50PD
 19736     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19737         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19738            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19739                                                                  ELC50PD
 19740     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19741         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19742     ELSE                                                         ELC50PD
 19743         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19744         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19745                                                                  ELC50PD
 19746     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19747     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19748     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19749     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19750     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19751     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19752     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19753     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19754                                                                  ELC50PD
 19755     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19756         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19757     ELSE                                                         ELC50PD
 19758         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19759                                                                  ELC50PD
 19760     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19761     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19762                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19763                                                                  ELC50PD
 19764     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19765     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19766                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19767                                                                  ELC50PD
 19768     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19769                                                                  ELC50PD
 19770     IF PB-REISSUED-CERT                                          ELC50PD
 19771        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19772                                                                  ELC50PD
 19773     IF PB-MONTHLY-CERT                                           ELC50PD
 19774        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19775                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 358
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19776     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19777     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19778     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19779        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
 19780                                                                  ELC50PD
 19781     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19782        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19783                                                                  ELC50PD
 19784     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19785        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19786                                                                  ELC50PD
 19787     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19788        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19789                                                                  ELC50PD
 19790     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19791         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19792     ELSE                                                         ELC50PD
 19793         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19794                                                                  ELC50PD
 19795     IF PB-RECORD-RETURNED                                        ELC50PD
 19796        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19797      ELSE                                                        ELC50PD
 19798        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19799                                                                  ELC50PD
 19800     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19801        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19802                                                                  ELC50PD
 19803     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19804                                       CM-ENTRY-DT.               ELC50PD
 19805                                                                  ELC50PD
 19806 4999-EXIT.                                                       ELC50PD
 19807     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 359
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19809                                                                  ELC50PD
 19810 5000-PROCESS-REPS.
 19811
 19812     MOVE ' '                    TO AGTC-MASTER-SW
 19813     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19814     MOVE CO-TYPE                TO AGTC-TYPE
 19815     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19816     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19817
 19818     IF (AGTC-MASTER-SW NOT = 'N')
 19819        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19820        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19821        PERFORM 8583-READ-ERAGTC-NEXT
 19822                                 THRU 8583-EXIT
 19823     END-IF
 19824
 19825     IF AGTC-MASTER-SW = 'N'
 19826        CONTINUE
 19827     ELSE
 19828        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19829           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19830              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19831              MOVE 'Y'           TO AGTC-MASTER-SW
 19832           END-IF
 19833        END-IF
 19834     END-IF
 19835
 19836     .
 19837 5000-EXIT.
 19838     EXIT.
 19839
 19840
 19841 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19842     move ' ' to ws-benefit-cd-chg-sw
 19843     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19844        MOVE +1                  TO SUB                           ELC50PD
 19845        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19846        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19847        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19848        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19849        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19850                                                                  ELC50PD
 19851     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19852                                                                  ELC50PD
 19853     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19854     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19855*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19856     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19857     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19858     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19859     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19860                                                                  ELC50PD
 19861     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19862        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19863        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19864                                                                  ELC50PD
 19865     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19866     MOVE +1                     TO SUB.                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 360
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19867                                                                  ELC50PD
 19868 6370-SEARCH-LOOP.                                                ELC50PD
 19869     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19870         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19871                                                                  ELC50PD
 19872     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19873        if (pb-i-lf-benefit-cd not = zeros and spaces)
 19874           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 19875           set benefit-code-chg to true
 19876        end-if
 19877        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 19878        GO TO 6370-HER-NET-PAY-CHECK.
 19879                                                                  ELC50PD
 19880     ADD 1   TO SUB.                                              ELC50PD
 19881*    IF SUB GREATER 120                                           ELC50PD
 19882     IF SUB GREATER 200                                           ELC50PD
 19883         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19884                                                                  ELC50PD
 19885     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19886                                                                  ELC50PD
 19887 6370-NO-LF-FOUND.                                                ELC50PD
 19888                                                                  ELC50PD
 19889     if (pb-i-lf-benefit-cd not = zeros and spaces)
 19890        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 19891        set benefit-code-chg to true
 19892     end-if
 19893     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19894                                                                  ELC50PD
 19895 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19896                                                                  ELC50PD
 19897     IF PB-COMPANY-ID = 'CID'
 19898        IF PB-SV-STATE = 'CA' OR 'MN'
 19899           IF PB-I-LF-BENEFIT-CD = '02'
 19900              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19901           ELSE
 19902              IF PB-I-LF-BENEFIT-CD = '04'
 19903                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19904              END-IF
 19905           END-IF
 19906        END-IF
 19907     END-IF
 19908
 19909     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19910         GO TO 6370-EXIT.                                         ELC50PD
 19911                                                                  ELC50PD
 19912     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19913         GO TO 6370-EXIT.                                         ELC50PD
 19914                                                                  ELC50PD
 19915     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19916         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19917                                                                  ELC50PD
 19918     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19919         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19920                                                                  ELC50PD
 19921     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19922         GO TO 6370-EXIT.                                         ELC50PD
 19923                                                                  ELC50PD
 19924     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 361
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19925         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19926                                                                  ELC50PD
 19927     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19928         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19929                                                                  ELC50PD
 19930 6370-EXIT.                                                       ELC50PD
 19931     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 362
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19933                                                                  ELC50PD
 19934 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19935     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19936        MOVE +1                  TO SUB                           ELC50PD
 19937        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19938        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19939        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19940        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19941        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19942                                                                  ELC50PD
 19943     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19944                                                                  ELC50PD
 19945     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19946     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19947     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19948*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19949     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19950     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19951     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19952                                                                  ELC50PD
 19953     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19954        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19955        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19956                                                                  ELC50PD
 19957     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19958     MOVE +1 TO SUB.                                              ELC50PD
 19959                                                                  ELC50PD
 19960 6380-SEARCH-LOOP.                                                ELC50PD
 19961     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19962         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19963                                                                  ELC50PD
 19964     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19965         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19966         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19967                                                                  ELC50PD
 19968     ADD 1   TO SUB.                                              ELC50PD
 19969     IF SUB GREATER THAN 96                                       ELC50PD
 19970*    IF SUB GREATER THAN 300                                      ELC50PD
 19971         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19972                                                                  ELC50PD
 19973     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19974                                                                  ELC50PD
 19975 6380-NO-AH-FOUND.                                                ELC50PD
 19976                                                                  ELC50PD
 19977     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19978                                                                  ELC50PD
 19979     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19980         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19981     ELSE                                                         ELC50PD
 19982         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19983                                                                  ELC50PD
 19984 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19985                                                                  ELC50PD
 19986     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19987        NEXT SENTENCE                                             ELC50PD
 19988      ELSE                                                        ELC50PD
 19989        GO TO 6380-EXIT.                                          ELC50PD
 19990                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 363
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19991     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19992         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19993                                                                  ELC50PD
 19994                                                                  00041198
 19995     GO TO 6380-EXIT                                              00041198
 19996     .
 19997 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19998                                                                  00041203
 19999                                                                  ELC50PD
 20000     .                                                            ELC50PD
 20001 6380-EXIT.                                                       ELC50PD
 20002     EXIT.                                                        ELC50PD
 20003                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 364
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 20005                                                                  ELC50PD
 20006 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 20007                                                                  ELC50PD
 20008******************************************************************ELC50PD
 20009*                                                                *ELC50PD
 20010*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 20011*                                                                *ELC50PD
 20012*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 20013*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 20014*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 20015*    THE EXTENSION DAYS.                                         *ELC50PD
 20016*                                                                *ELC50PD
 20017******************************************************************ELC50PD
 20018                                                                  ELC50PD
 20019     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 20020     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 20021                                                                  ELC50PD
 20022******************************************************************ELC50PD
 20023*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 20024*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 20025******************************************************************ELC50PD
 20026                                                                  ELC50PD
 20027     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 20028        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 20029               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 20030     ELSE                                                         ELC50PD
 20031        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 20032                                                                  ELC50PD
 20033     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 20034           GO TO 6499-EXIT                                        ELC50PD
 20035     ELSE                                                         ELC50PD
 20036        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 20037           IF WS-WDF-MONTH = 02                                   ELC50PD
 20038              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 20039              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 20040              GO TO 6499-EXIT                                     ELC50PD
 20041           ELSE                                                   ELC50PD
 20042              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 20043                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 20044                 GO TO 6499-EXIT                                  ELC50PD
 20045               ELSE                                               ELC50PD
 20046                 GO TO 6499-EXIT                                  ELC50PD
 20047        ELSE                                                      ELC50PD
 20048           GO TO 6499-EXIT.                                       ELC50PD
 20049                                                                  ELC50PD
 20050 6412-CHECK-TO-DAY.                                               ELC50PD
 20051                                                                  ELC50PD
 20052        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 20053           IF WS-WDT-DAY = 28                                     ELC50PD
 20054              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 20055           ELSE                                                   ELC50PD
 20056              IF WS-WDT-DAY = 29                                  ELC50PD
 20057                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 20058              ELSE                                                ELC50PD
 20059                 NEXT SENTENCE                                    ELC50PD
 20060        ELSE                                                      ELC50PD
 20061           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 20062              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 365
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 20063                                                                  ELC50PD
 20064     GO TO 6499-EXIT.                                             ELC50PD
 20065                                                                  ELC50PD
 20066                                                                  ELC50PD
 20067 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 20068                                                                  ELC50PD
 20069     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 20070        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 20071                                                                  ELC50PD
 20072 6415-EXIT.                                                       ELC50PD
 20073     EXIT.                                                        ELC50PD
 20074                                                                  ELC50PD
 20075 6499-EXIT.                                                       ELC50PD
 20076      EXIT.                                                       ELC50PD
 20077                                                                  ELC50PD
 20078 6500-END.                                                        ELC50PD
 20079     EXIT.
 20080
 20081                                                                  ELC50PD
 20082******************************************************************ELC50PD
 20083************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 20084********************** ELC50PD END *******************************ELC50PD
 20085                                                                  ELC50PD
 20086*
 20087*
 20088**START***********************************************************
 20089*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 20090*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 20091******************************************************************
 20092*
 20093 6600-GET-STATE-MUNICIPAL-TAX.
 20094
 20095     IF PB-COMPANY-ID NOT = 'DMD'
 20096         GO TO 6640-EXIT.
 20097
 20098     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 20099     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 20100     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 20101
 20102*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20103     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20104     MOVE SPACES TO DC-ALPHA-CENTURY.
 20105     SET BIN-TO-GREG          TO TRUE.
 20106     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20107
 20108     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20109     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20110
 20111     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 20112     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 20113                                 WS-SAVE-ERRESS-KEY.
 20114
 20115*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 20116*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 20117
 20118     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 20119
 20120     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 366
* EL517.cbl
 20121         MOVE ER-8002        TO WS-ERROR
 20122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20123         GO TO 6640-EXIT.
 20124
 20125*GET RECORD WHERE POSITIONED
 20126
 20127 6600-READ-ERRESS-NEXT.
 20128     READ ERRESS NEXT RECORD.
 20129
 20130     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 20131         MOVE ER-8002        TO WS-ERROR
 20132         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20133         GO TO 6640-EXIT.
 20134
 20135*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 20136
 20137     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 20138        NEXT SENTENCE
 20139     ELSE
 20140        MOVE ER-8002        TO WS-ERROR
 20141        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20142        GO TO 6640-EXIT.
 20143
 20144     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 20145        NEXT SENTENCE
 20146     ELSE
 20147        GO TO 6600-READ-ERRESS-NEXT.
 20148
 20149*IS IT LIFE(1) OR IS IT P&C(2) ?????
 20150*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 20151
 20152     MOVE +2                     TO WS-SUB1.
 20153
 20154     IF PB-CANCELLATION
 20155        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 20156           MOVE +1               TO WS-SUB1.
 20157
 20158     IF PB-ISSUE
 20159        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 20160           MOVE +1               TO WS-SUB1.
 20161
 20162*
 20163*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 20164*
 20165     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 20166     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 20167     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 20168     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 20169
 20170
 20171*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 20172*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 20173*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 20174
 20175     ADD 1                    TO WS-YEAR-YY.
 20176
 20177     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 20178         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 367
* EL517.cbl
 20179                              TO WS-RES-STATE-TAX
 20180         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 20181                              TO WS-RES-MUNI-TAX
 20182     ELSE
 20183         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 20184                              TO WS-RES-STATE-TAX
 20185         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 20186                              TO WS-RES-MUNI-TAX.
 20187
 20188*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 20189
 20190     IF PB-CANCELLATION
 20191         GO TO 6640-CANCEL-TAX.
 20192
 20193     IF PB-I-LF-PREMIUM-AMT > ZEROS
 20194          COMPUTE PB-I-STATE-TAX ROUNDED =
 20195                                    PB-I-LF-PREMIUM-AMT
 20196                                  * WS-RES-STATE-TAX
 20197          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20198                                    PB-I-LF-PREMIUM-AMT
 20199                                  * WS-RES-MUNI-TAX
 20200     ELSE
 20201     IF PB-I-AH-PREMIUM-AMT > ZEROS
 20202          COMPUTE PB-I-STATE-TAX ROUNDED =
 20203                                    PB-I-AH-PREMIUM-AMT
 20204                                  * WS-RES-STATE-TAX
 20205          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20206                                    PB-I-AH-PREMIUM-AMT
 20207                                  * WS-RES-MUNI-TAX.
 20208
 20209     GO TO 6640-EXIT.
 20210
 20211 6640-CANCEL-TAX.
 20212     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 20213
 20214     IF PB-C-LF-CANCEL-AMT > ZEROS
 20215          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20216                                    PB-C-LF-CANCEL-AMT
 20217                                  * WS-RES-STATE-TAX
 20218          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20219                                    PB-C-LF-CANCEL-AMT
 20220                                  * WS-RES-MUNI-TAX
 20221     ELSE
 20222     IF PB-C-AH-CANCEL-AMT > ZEROS
 20223          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20224                                    PB-C-AH-CANCEL-AMT
 20225                                  * WS-RES-STATE-TAX
 20226          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20227                                    PB-C-AH-CANCEL-AMT
 20228                                  * WS-RES-MUNI-TAX.
 20229
 20230 6640-EXIT.
 20231     EXIT.
 20232
 20233 6650-GET-RES-STATE-COMM.
 20234
 20235     IF PB-COMPANY-ID NOT = 'DMD'
 20236         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 368
* EL517.cbl
 20237
 20238     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20239     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 20240     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 20241     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 20242     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20243     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 20244     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20245
 20246*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20247
 20248     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20249     MOVE SPACES              TO DC-ALPHA-CENTURY.
 20250     SET BIN-TO-GREG          TO TRUE.
 20251     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20252
 20253     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20254     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20255
 20256     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20257
 20258*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20259*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20260*VALUE OF PB-CERT-EFF-DT
 20261
 20262     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20263     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20264
 20265     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20266         GO TO 6700-COMM-EXIT.
 20267
 20268*GET RECORD WHERE POSITIONED
 20269
 20270 6650-READ-ERRESC-NEXT.
 20271     READ ERRESC NEXT RECORD.
 20272
 20273     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20274         GO TO 6700-COMM-EXIT.
 20275
 20276     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20277        NEXT SENTENCE
 20278     ELSE
 20279         GO TO 6700-COMM-EXIT.
 20280
 20281     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20282         NEXT SENTENCE
 20283       ELSE
 20284         GO TO 6650-READ-ERRESC-NEXT.
 20285
 20286*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20287*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20288
 20289     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20290         GO TO 6700-COMM-EXIT.
 20291
 20292* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20293
 20294     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 369
* EL517.cbl
 20295
 20296     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20297
 20298     IF WS-SUB1 > ZERO
 20299         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20300             PERFORM 6680-SET-COMMISSION
 20301         ELSE
 20302             PERFORM 6680-SET-TABLE-CODE.
 20303
 20304     GO TO 6700-COMM-EXIT.
 20305
 20306 6680-SET-TABLE-CODE.
 20307     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20308        MOVE ZEROS             TO WS-SUB1
 20309     ELSE
 20310* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20311* TO COMPUTE AH COMMISSION.
 20312        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20313        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20314        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20315        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20316        PERFORM 6680-READ-CTBL-TABLE
 20317        IF ERCTBL-FILE-STATUS NOT = '00'
 20318           MOVE ZEROS          TO WS-SUB1.
 20319
 20320 6680-READ-CTBL-TABLE.
 20321*
 20322* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20323* TO COMPUTE LIFE COMMISSION
 20324
 20325     IF CTBL-SW = '0540'
 20326        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20327        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20328        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20329
 20330     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20331
 20332     IF CTBL-TABLE-FOUND
 20333        IF CTBL-SW = '0530'
 20334             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20335                                        PB-I-AH-TERM
 20336             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20337             MOVE WS-WK-RATE        TO WS-COMMISSION
 20338                                       PB-I-AH-COMMISSION
 20339        ELSE
 20340             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20341             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20342             MOVE WS-WK-RATE        TO WS-COMMISSION
 20343                                       PB-I-LIFE-COMMISSION
 20344     ELSE
 20345        IF FIRST-TIME-THROUGH
 20346            GO TO 6680-READ-CTBL-TABLE
 20347        ELSE
 20348            MOVE ZEROS         TO WS-SUB1.
 20349
 20350 6680-SET-COMMISSION.
 20351     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20352           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 370
* EL517.cbl
 20353       ELSE
 20354           MOVE RESC-COMMISSION-PER (WS-SUB)
 20355                             TO WS-COMMISSION
 20356           IF CTBL-SW = '0540'
 20357               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20358           ELSE
 20359               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20360
 20361 6680-SEARCH-CATEGORY.
 20362     ADD +1                   TO WS-SUB.
 20363     IF WS-SUB > +12
 20364         GO TO 6680-EXIT.
 20365
 20366     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20367          MOVE WS-SUB         TO WS-SUB1
 20368          GO TO 6680-EXIT.
 20369
 20370     GO TO 6680-SEARCH-CATEGORY.
 20371
 20372 6680-EXIT.
 20373     EXIT.
 20374
 20375 6700-COMM-EXIT.
 20376     EXIT.
 20377**END*************************************************************
 20378*      CUSTOM CODING FOR CLIENT "DMD"
 20379******************************************************************
 20380*
 20381 7000-GET-RATE.
 20382     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20383
 20384 7000-EXIT.
 20385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 371
* EL517.cbl
 20387
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 372
* EL517.cbl
 20389 7100-FIND-BENEFIT-IN-STATE.
 20390     MOVE 'N'                    TO BEN-SEARCH-SW.
 20391
 20392     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20393         VARYING SUB3 FROM 1 BY 1 UNTIL
 20394            ((SUB3 GREATER 50) OR
 20395              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20396               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20397
 20398     IF SUB3 NOT = 51
 20399         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20400             MOVE 'Y'            TO BEN-SEARCH-SW.
 20401
 20402     GO TO 7199-EXIT.
 20403
 20404 7100-BENEFIT-DUMMY.
 20405
 20406 7100-DUMMY-EXIT.
 20407     EXIT.
 20408
 20409 7199-EXIT.
 20410     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 373
* EL517.cbl
 20412 7200-FIND-BENEFIT.
 20413     MOVE 'N'                    TO BEN-SEARCH-SW.
 20414
 20415     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20416         VARYING SUB3 FROM 1 BY 1 UNTIL
 20417            ((SUB3 GREATER 8) OR
 20418            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20419
 20420     IF SUB3 NOT = 9
 20421         MOVE 'Y'                TO BEN-SEARCH-SW.
 20422
 20423     GO TO 7200-EXIT.
 20424
 20425 7200-BENEFIT-DUMMY.
 20426
 20427     EXIT.
 20428 7200-DUMMY-EXIT.
 20429     EXIT.
 20430
 20431 7200-EXIT.
 20432     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 374
* EL517.cbl
 20434 7250-LOOK-FOR-RESCINDED-CLAIM.
 20435
 20436     IF ELMSTR-OPEN = ' '
 20437         OPEN INPUT ELMSTR
 20438         MOVE 'X'                TO ELMSTR-OPEN
 20439         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20440             NEXT SENTENCE
 20441         ELSE
 20442             MOVE ELMSTR-FILE-STATUS
 20443                                 TO WS-ABEND-FILE-STATUS
 20444             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20445             MOVE EMSG           TO WS-ABEND-MESSAGE
 20446             GO TO ABEND-PGM.
 20447
 20448     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20449                                    W-CL-COMP-CD.
 20450     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20451                                    W-CL-CERT-NO.
 20452     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20453     MOVE SPACES                 TO CL-CERT-A4-SFX.
 20454
 20455     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20456
 20457     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20458         GO TO 7250-EXIT.
 20459
 20460     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20461         GO TO 7250-CLAIMS-ERROR.
 20462
 20463 7250-NEXT-CLAIM.
 20464
 20465     READ ELMSTR NEXT.
 20466
 20467     IF ELMSTR-FILE-STATUS = '10'
 20468         GO TO 7250-EXIT.
 20469
 20470     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20471         GO TO 7250-CLAIMS-ERROR.
 20472
 20473     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20474        MSTR-CERT-NO(1:10) NOT = CL-CERT-NO-A4(1:10)
 20475         GO TO 7250-EXIT.
 20476
 20477     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20478        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20479        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20480        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20481        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20482         GO TO 7250-NEXT-CLAIM.
 20483
 20484     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20485        OR (CL-CLAIM-TYPE = 'I')
 20486        OR (CL-CLAIM-TYPE = 'G')
 20487          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20488              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20489              GO TO 7250-EXIT
 20490          END-IF
 20491     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 375
* EL517.cbl
 20492
 20493     GO TO 7250-NEXT-CLAIM.
 20494
 20495 7250-CLAIMS-ERROR.
 20496
 20497     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20498     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20499     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20500     GO TO ABEND-PGM.
 20501
 20502 7250-EXIT.
 20503     EXIT.
 20504 7300-CHECK-FOR-OPEN-CLMS.
 20505
 20506     IF ELMSTR-OPEN = ' '
 20507         OPEN INPUT ELMSTR
 20508         MOVE 'X'                TO ELMSTR-OPEN
 20509         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20510             NEXT SENTENCE
 20511         ELSE
 20512             MOVE ELMSTR-FILE-STATUS
 20513                                 TO WS-ABEND-FILE-STATUS
 20514             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20515             MOVE EMSG           TO WS-ABEND-MESSAGE
 20516             GO TO ABEND-PGM.
 20517
 20518     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20519                                    W-CL-COMP-CD.
 20520     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20521                                    W-CL-CERT-NO.
 20522     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20523     MOVE SPACES                 TO CL-CERT-A4-SFX.
 20524
 20525     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20526
 20527     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20528         GO TO 7300-EXIT.
 20529
 20530     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20531         GO TO 7300-CLAIMS-ERROR.
 20532
 20533     MOVE 'Y'                    TO W-BROWSE-SW.
 20534
 20535 7300-NEXT-CLAIM.
 20536
 20537     READ ELMSTR NEXT.
 20538
 20539     IF ELMSTR-FILE-STATUS = '10'
 20540         GO TO 7300-EXIT.
 20541
 20542     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20543         GO TO 7300-CLAIMS-ERROR.
 20544
 20545     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20546        MSTR-CERT-NO(1:10) NOT = CL-CERT-NO-A4(1:10)
 20547         GO TO 7300-EXIT.
 20548
 20549     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 376
* EL517.cbl
 20550        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20551        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20552        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20553        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20554         GO TO 7300-NEXT-CLAIM.
 20555
 20556     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20557        OR 'I' OR 'G'
 20558        IF CLAIM-IS-OPEN
 20559           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20560             AND PB-C-AH-CANCEL-DT > SPACES
 20561              MOVE ER-2896        TO WS-ERROR
 20562              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20563           END-IF
 20564           EVALUATE TRUE
 20565             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20566                 MOVE ER-2884      TO WS-ERROR
 20567             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20568                 MOVE ER-2887      TO WS-ERROR
 20569             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20570                 MOVE ER-2886      TO WS-ERROR
 20571             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20572                 MOVE ER-2888      TO WS-ERROR
 20573             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20574                 MOVE ER-2885      TO WS-ERROR
 20575             WHEN OTHER
 20576                 MOVE ER-2768      TO WS-ERROR
 20577           END-EVALUATE
 20578           IF PB-C-AH-CANCEL-VOIDED OR
 20579              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20580                NOT AH-COVERAGE-CANCELLED)
 20581               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20582               MOVE ER-2768      TO WS-ERROR
 20583           END-IF
 20584           PERFORM 9900-ERROR-FORMAT
 20585                                 THRU 9900-EXIT
 20586           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20587              PB-FORCE-CODE NOT EQUAL '8'
 20588               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20589           END-IF
 20590           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20591           GO TO 7300-NEXT-CLAIM
 20592        ELSE
 20593           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20594*****THIS IS A RESCISSION OR REFORMATION
 20595              IF AH-COVERAGE-CANCELLED
 20596                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20597                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20598                    MOVE 1                   TO DC-ELAPSED-DAYS
 20599                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20600                    SET BIN-PLUS-ELAPSED     TO TRUE
 20601                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20602                    IF NO-CONVERSION-ERROR
 20603                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20604                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20605                          MOVE ER-2897 TO WS-ERROR
 20606                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20607                          GO TO 7300-NEXT-CLAIM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 377
* EL517.cbl
 20608                       END-IF
 20609                    END-IF
 20610                 ELSE
 20611                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20612                     MOVE ER-2890 TO WS-ERROR
 20613                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20614                     GO TO 7300-NEXT-CLAIM
 20615                   END-IF
 20616                 END-IF
 20617              END-IF
 20618           ELSE
 20619              IF CL-DENIAL-TYPE = '1'  AND
 20620                 CL-TOTAL-PAID-AMT = 0
 20621                    GO TO 7300-NEXT-CLAIM
 20622              END-IF
 20623              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20624               AND PB-C-AH-CANCEL-DT > SPACES
 20625                 MOVE ER-2756       TO WS-ERROR
 20626                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20627                 GO TO 7300-NEXT-CLAIM
 20628              END-IF
 20629           END-IF
 20630        END-IF
 20631     ELSE
 20632        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20633           IF CLAIM-IS-OPEN
 20634              MOVE ER-2889    TO WS-ERROR
 20635              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20636              GO TO 7300-NEXT-CLAIM
 20637           ELSE
 20638              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20639*****THIS IS A RESCISSION OR REFORMATION
 20640                 IF (LF-COVERAGE-CANCELLED AND
 20641                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20642                       MOVE ER-2890 TO WS-ERROR
 20643                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20644                       GO TO 7300-NEXT-CLAIM
 20645                 END-IF
 20646              ELSE
 20647                 IF CL-DENIAL-TYPE = '1'  AND
 20648                    CL-TOTAL-PAID-AMT = 0
 20649                       GO TO 7300-NEXT-CLAIM
 20650                 END-IF
 20651                 IF (AH-COVERAGE-CANCELLED AND
 20652                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20653                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20654                    (LF-COVERAGE-CANCELLED AND
 20655                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20656                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20657                       MOVE ER-2965 TO WS-ERROR
 20658                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20659                       GO TO 7300-NEXT-CLAIM
 20660                 END-IF
 20661                 IF LF-COVERAGE-CANCELLED
 20662                  IF CL-TOTAL-PAID-AMT > 0
 20663                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20664                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20665                        MOVE ER-2891 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 378
* EL517.cbl
 20666                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20667                        GO TO 7300-NEXT-CLAIM
 20668                      END-IF
 20669                    ELSE
 20670****only show this error if cert num matches exactly
 20671                      IF PB-CERT-NO = CL-CERT-NO
 20672                         MOVE ER-2892 TO WS-ERROR
 20673                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20674                         GO TO 7300-NEXT-CLAIM
 20675                      END-IF
 20676                    END-IF
 20677                  END-IF
 20678                 END-IF
 20679              END-IF
 20680           END-IF
 20681        END-IF
 20682     END-IF
 20683
 20684     GO TO 7300-NEXT-CLAIM.
 20685
 20686 7300-CLAIMS-ERROR.
 20687
 20688     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20689     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20690     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20691     GO TO ABEND-PGM.
 20692
 20693 7300-EXIT.
 20694     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 379
* EL517.cbl
 20696
 20697 7400-GET-REMAIN-TERM.
 20698     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20699
 20700 7400-EXIT.
 20701     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 380
* EL517.cbl
 20703
 20704 7500-GET-REMAIN-AMOUNT.
 20705     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20706
 20707 7500-EXIT.
 20708     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 381
* EL517.cbl
 20710
 20711 7600-GET-REFUND.
 20712     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20713
 20714 7600-EXIT.
 20715     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 382
* EL517.cbl
 20717
 20718 7700-CALL-DL1.
 20719     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20720     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20721
 20722 7700-EXIT.
 20723     EXIT.
 20724
 20725 7710-CALL-DL2.
 20726     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20727     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20728
 20729 7710-EXIT.
 20730     EXIT.
 20731
 20732 7720-CALL-DL3.
 20733     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20734     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20735
 20736 7720-EXIT.
 20737     EXIT.
 20738
 20739 7730-CALL-DL7.
 20740     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20741     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20742
 20743 7730-EXIT.
 20744     EXIT.
 20745
 20746 7740-CALL-DL11.
 20747     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20748     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20749
 20750 7740-EXIT.
 20751     EXIT.
 20752
 20753 7750-CALL-DL17.
 20754     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20755     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20756
 20757 7750-EXIT.
 20758     EXIT.
 20759
 20760 7755-CALL-DL19.
 20761     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20762     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20763
 20764 7755-EXIT.
 20765     EXIT.
 20766
 20767 7760-CALL-DL21.
 20768     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20769
 20770 7760-EXIT.
 20771     EXIT.
 20772
 20773 7770-CALL-DL22.
 20774     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 383
* EL517.cbl
 20775     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20776
 20777 7770-EXIT.
 20778     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 384
* EL517.cbl
 20780
 20781 7800-REWRITE-CERT.
 20782     REWRITE CERTIFICATE-MASTER.
 20783     ADD 1 TO WCER.
 20784
 20785 7800-EXIT.
 20786      EXIT.
 20787     EXIT.
 20788
 20789 8000-WRITE-CERT.
 20790
 20791     WRITE CERTIFICATE-MASTER.
 20792     ADD 1 TO WCER.
 20793     IF ELCERT-FILE-STATUS NOT = '00'
 20794         GO TO 8000-FREE-MAIN.
 20795
 20796 8000-FREE-MAIN.
 20797
 20798 8000-EXIT.
 20799     EXIT.
 20800      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 385
* EL517.cbl
 20802
 20803 8100-READ-ERPNDM.
 20804     IF ERPNDM-OPEN = ' '
 20805        OPEN INPUT ERPNDM
 20806        MOVE 'X' TO ERPNDM-OPEN
 20807        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20808           NEXT SENTENCE
 20809        ELSE
 20810           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20811           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20812           MOVE EMSG TO WS-ABEND-MESSAGE
 20813           GO TO ABEND-PGM.
 20814
 20815     MOVE SPACES                 TO ERPNDM-FOUND.
 20816     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20817     READ ERPNDM.
 20818
 20819     IF ERPNDM-FILE-STATUS  = '00'
 20820        CONTINUE
 20821     ELSE
 20822        MOVE 'X'                 TO ERPNDM-FOUND
 20823        MOVE ER-2694             TO WS-ERROR
 20824        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20825        MOVE ER-2883             TO WS-ERROR
 20826        PERFORM 9900-ERROR-FORMAT
 20827                                 THRU 9900-EXIT
 20828     END-IF
 20829
 20830     .
 20831 8100-EXIT.
 20832     EXIT.
 20833
 20834 8110-READ-ERMAIL.
 20835     IF ERMAIL-OPEN = ' '
 20836        OPEN  I-O ERMAIL
 20837        MOVE 'X' TO ERMAIL-OPEN
 20838        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20839           NEXT SENTENCE
 20840        ELSE
 20841            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20842            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20843            MOVE EMSG TO WS-ABEND-MESSAGE
 20844            GO TO ABEND-PGM.
 20845
 20846     MOVE SPACES                 TO ERMAIL-FOUND.
 20847     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20848     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20849     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20850     MOVE PB-SV-STATE            TO MA-STATE.
 20851
 20852     READ ERMAIL.
 20853
 20854     IF ERMAIL-FILE-STATUS  = '00'
 20855         NEXT SENTENCE
 20856       ELSE
 20857        MOVE 'X'                 TO ERMAIL-FOUND.
 20858
 20859 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 386
* EL517.cbl
 20860     EXIT.
 20861
 20862 8120-REWRITE-ERMAIL.
 20863     REWRITE MAILING-DATA.
 20864
 20865 8120-EXIT.
 20866     EXIT.
 20867
 20868 8130-WRITE-ERMAIL.
 20869     WRITE MAILING-DATA.
 20870
 20871 8130-EXIT.
 20872     EXIT.
 20873
 20874 8140-UNLOCK-ERMAIL.
 20875     MOVE SPACES                 TO ERMAIL-FOUND.
 20876
 20877 8140-EXIT.
 20878     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 387
* EL517.cbl
 20880
 20881 8150-read-elcrtt.
 20882
 20883     IF ELCRTT-OPEN = ' '
 20884         OPEN input ELCRTT
 20885         MOVE 'X' TO ELCRTT-OPEN
 20886         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20887             continue
 20888         ELSE
 20889             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20890             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20891             MOVE EMSG               TO WS-ABEND-MESSAGE
 20892             GO TO ABEND-PGM
 20893         END-IF
 20894     END-IF
 20895
 20896     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20897     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20898     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20899
 20900     READ ELCRTT.
 20901
 20902     IF ELCRTT-FILE-STATUS  = '00'
 20903        move cs-ins-age-default-flag
 20904                                 to ws-ins-age-defaulted
 20905        move cs-jnt-age-default-flag
 20906                                 to ws-jnt-age-defaulted
 20907     END-IF
 20908
 20909     .
 20910 8150-exit.
 20911     exit.
 20912
 20913 8180-UPDATE-VIN-NUMBER.
 20914
 20915     IF ELCRTT-OPEN = ' '
 20916         OPEN I-O ELCRTT
 20917         MOVE 'X' TO ELCRTT-OPEN
 20918         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20919             NEXT SENTENCE
 20920         ELSE
 20921             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20922             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20923             MOVE EMSG               TO WS-ABEND-MESSAGE
 20924             GO TO ABEND-PGM
 20925         END-IF
 20926     END-IF.
 20927
 20928     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20929     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20930     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20931
 20932     READ ELCRTT.
 20933
 20934     IF ELCRTT-FILE-STATUS  = '00'
 20935        CONTINUE
 20936     ELSE
 20937        GO TO 8180-NOTFND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 388
* EL517.cbl
 20938     END-IF.
 20939
 20940     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20941         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20942         REWRITE CERTIFICATE-TRAILERS
 20943     END-IF.
 20944
 20945     GO TO 8180-EXIT.
 20946
 20947 8180-NOTFND.
 20948
 20949     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20950     MOVE 'CS'         TO CS-RECORD-ID.
 20951     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20952     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20953     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20954     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20955     WRITE CERTIFICATE-TRAILERS.
 20956
 20957 8180-EXIT.
 20958     EXIT.
 20959
 20960 8190-UPDATE-REFUND-CLAIM-FLAG.
 20961
 20962     IF ELCRTT-OPEN = ' '
 20963         OPEN I-O ELCRTT
 20964         MOVE 'X' TO ELCRTT-OPEN
 20965         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20966             NEXT SENTENCE
 20967         ELSE
 20968             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20969             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20970             MOVE EMSG               TO WS-ABEND-MESSAGE
 20971             GO TO ABEND-PGM
 20972         END-IF
 20973     END-IF.
 20974
 20975     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20976     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20977     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20978
 20979     READ ELCRTT.
 20980
 20981     IF ELCRTT-FILE-STATUS  = '00'
 20982        CONTINUE
 20983     ELSE
 20984        GO TO 8190-NOTFND
 20985     END-IF.
 20986
 20987     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20988     REWRITE CERTIFICATE-TRAILERS.
 20989
 20990     GO TO 8190-EXIT.
 20991
 20992 8190-NOTFND.
 20993
 20994     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20995     MOVE 'CS'         TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 389
* EL517.cbl
 20996     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20997     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20998     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20999     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21000     WRITE CERTIFICATE-TRAILERS.
 21001
 21002 8190-EXIT.
 21003     EXIT.
 21004
 21005 8195-UPDATE-AGE-FLAGS.
 21006     IF ELCRTT-OPEN = ' '
 21007         OPEN I-O ELCRTT
 21008         MOVE 'X' TO ELCRTT-OPEN
 21009         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21010             NEXT SENTENCE
 21011         ELSE
 21012             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21013             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21014             MOVE EMSG               TO WS-ABEND-MESSAGE
 21015             GO TO ABEND-PGM
 21016         END-IF
 21017     END-IF.
 21018
 21019     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21020     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 21021     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 21022
 21023     READ ELCRTT.
 21024
 21025     IF ELCRTT-FILE-STATUS  = '00'
 21026        CONTINUE
 21027     ELSE
 21028        GO TO 8195-NOTFND
 21029     END-IF.
 21030
 21031     IF WS-INS-AGE-SET = 'Y'
 21032        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21033     END-IF
 21034     IF WS-JNT-AGE-SET = 'Y'
 21035        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21036     END-IF
 21037
 21038     REWRITE CERTIFICATE-TRAILERS.
 21039
 21040     GO TO 8195-EXIT.
 21041
 21042 8195-NOTFND.
 21043
 21044     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21045     MOVE 'CS'         TO CS-RECORD-ID.
 21046     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21047     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21048     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21049     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21050     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21051     WRITE CERTIFICATE-TRAILERS.
 21052
 21053 8195-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 390
* EL517.cbl
 21054     EXIT.
 21055
 21056 8200-READ-REIN-TABLE.
 21057     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 21058     READ ERREIN.
 21059     ADD 1 TO RREI.
 21060
 21061     IF RE-CODE NOT = 'A'
 21062        PERFORM REIN-DATE-LOAD.
 21063
 21064     IF ERREIN-FILE-STATUS NOT = '00'
 21065          GO TO 8200-NOTFND.
 21066
 21067     GO TO 8200-EXIT.
 21068
 21069 8200-NOTFND.
 21070     MOVE 'N'                TO WS-REIN-READ-SW.
 21071
 21072 8200-EXIT.
 21073     EXIT.
 21074      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 391
* EL517.cbl
 21076
 21077 8300-READ-CTBL-TABLE.
 21078     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 21079     READ ERCTBL.
 21080     ADD 1 TO RCTB.
 21081
 21082     IF ERCTBL-FILE-STATUS NOT = '00'
 21083         GO TO 8300-NOTFND.
 21084
 21085     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21086
 21087     GO TO 8300-EXIT.
 21088
 21089 8300-NOTFND.
 21090     IF CTBL-SW = '0530'
 21091         MOVE 'AA'                     TO WS-AH-COMP-CD
 21092         MOVE '0550'                   TO CTBL-SW
 21093         MOVE '1'                      TO WS-CTBL-READ-SW
 21094         GO TO 8300-EXIT.
 21095
 21096     IF CTBL-SW = '0540'
 21097         MOVE 'AA'                     TO WS-LF-COMP-CD
 21098         MOVE '0550'                   TO CTBL-SW
 21099         MOVE '1'                      TO WS-CTBL-READ-SW
 21100         GO TO 8300-EXIT.
 21101
 21102     IF CTBL-SW = '0550'
 21103         MOVE '2'                      TO WS-CTBL-READ-SW
 21104         GO TO 8300-EXIT.
 21105
 21106 8300-EXIT.
 21107      EXIT.
 21108     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 392
* EL517.cbl
 21110
 21111 8400-GETMAIN-ERFORM.
 21112*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21113     EXIT.
 21114 8400-EXIT.
 21115     EXIT.
 21116
 21117 8450-READ-FORM-MASTER.
 21118
 21119     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 21120
 21121     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 21122
 21123     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21124        GO TO 8450-FORM-NOT-FOUND.
 21125
 21126     READ ERFORM NEXT.
 21127
 21128     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21129        GO TO 8450-FORM-NOT-FOUND.
 21130
 21131     MOVE 'Y'                    TO FORM-MASTER-SW.
 21132     GO TO 8450-EXIT.
 21133
 21134 8450-FORM-NOT-FOUND.
 21135
 21136     MOVE 'N'                    TO FORM-MASTER-SW.
 21137
 21138 8450-EXIT.
 21139     EXIT.
 21140
 21141 8500-DATE-CONVERT.
 21142     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 21143
 21144 8500-EXIT.
 21145     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 393
* EL517.cbl
 21147
 21148 8555-RELOAD-CONTROL-FILE.
 21149     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 21150
 21151 8555-EXIT.
 21152     EXIT.
 21153
 21154 8557-GETMAIN-ERPLAN.
 21155*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21156     EXIT.
 21157 8557-EXIT.
 21158     EXIT.
 21159
 21160 8560-GETMAIN.
 21161      MOVE 999 TO ERACCT-POINTER.
 21162
 21163 8560-EXIT.
 21164     EXIT.
 21165
 21166 8570-START-ACCOUNT-MASTER.
 21167     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21168
 21169 8570-EXIT.
 21170     EXIT.
 21171
 21172 8580-READ-ACCOUNT-MASTER.
 21173     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21174
 21175     IF WS-BROWSE-STARTED-SW = 'Y'
 21176         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 21177
 21178     IF ERACCT-FILE-STATUS = '23'
 21179         MOVE HIGH-VALUE TO ERACCT-KEY
 21180         GO TO 8580-EXIT.
 21181
 21182     IF ERACCT-FILE-STAT-1 = '9'
 21183         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21184         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21185         MOVE RMSG TO WS-ABEND-MESSAGE
 21186         GO TO ABEND-PGM.
 21187
 21188     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 21189
 21190     READ ERACCT NEXT.
 21191     ADD 1 TO RACC.
 21192
*21193     COPY ELCACCTI.
 21194******************************************************************04/14/98
 21195*                                                                *ELCACCTI
 21196*                            ELCACCTI                            *   LV003
 21197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21198*                            VMOD=2.001                          *ELCACCTI
 21199*                                                                *ELCACCTI
 21200*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 21201*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 21202*                                                                *ELCACCTI
 21203*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 21204*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 394
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 21205******************************************************************ELCACCTI
 21206     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 21207     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 21208     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 21209     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 21210     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 21211     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 21212     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 21213     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 21214     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 21215
 21216     IF ERACCT-FILE-STAT-1 = '9'
 21217         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21218         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21219         MOVE RMSG TO WS-ABEND-MESSAGE
 21220         GO TO ABEND-PGM.
 21221
 21222     IF ERACCT-FILE-STATUS NOT = '00'
 21223         MOVE HIGH-VALUE TO ERACCT-KEY
 21224         GO TO 8580-EXIT.
 21225
 21226     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 21227
 21228 8580-EXIT.
 21229     EXIT.
 21230
 21231 8582-READ-COMPENSATION-MASTER.
 21232     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 21233
 21234     READ ERCOMP
 21235
 21236     IF ERCOMP-FILE-STATUS NOT = '00'
 21237        GO TO 8582-COMP-NOT-FOUND
 21238     END-IF
 21239
 21240     MOVE 'Y'                    TO COMP-MASTER-SW.
 21241     GO TO 8582-EXIT
 21242     .
 21243 8582-COMP-NOT-FOUND.
 21244
 21245     MOVE 'N'                    TO COMP-MASTER-SW.
 21246
 21247 8582-EXIT.
 21248     EXIT.
 21249
 21250 8583-READ-ERAGTC.
 21251
 21252     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 21253
 21254     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 21255
 21256     IF ERAGTC-FILE-STATUS NOT = '00'
 21257        GO TO 8583-AGTC-NOT-FOUND
 21258     END-IF
 21259
 21260     .
 21261 8583-READ-ERAGTC-NEXT.
 21262
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 395
* EL517.cbl
 21263     READ ERAGTC NEXT RECORD
 21264
 21265     IF ERAGTC-FILE-STATUS NOT = '00'
 21266        GO TO 8583-AGTC-NOT-FOUND
 21267     END-IF
 21268
 21269*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 21270     GO TO 8583-EXIT
 21271     .
 21272 8583-AGTC-NOT-FOUND.
 21273
 21274     MOVE 'N'                    TO AGTC-MASTER-SW.
 21275
 21276 8583-EXIT.
 21277     EXIT.
 21278
 21279 8584-READ-BANK-CROSS-REF.
 21280     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 21281
 21282     READ ERBXRF
 21283
 21284     IF ERBXRF-FILE-STATUS NOT = '00'
 21285        GO TO 8584-BXRF-NOT-FOUND
 21286     END-IF
 21287
 21288     MOVE 'Y'                    TO BXRF-MASTER-SW.
 21289     GO TO 8584-EXIT
 21290     .
 21291 8584-BXRF-NOT-FOUND.
 21292
 21293     MOVE 'N'                    TO BXRF-MASTER-SW.
 21294
 21295 8584-EXIT.
 21296     EXIT.
 21297
 21298 8585-READ-PLAN-MASTER.
 21299
 21300     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 21301
 21302     READ ERPLAN.
 21303
 21304     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 21305        GO TO 8585-PLAN-NOT-FOUND.
 21306
 21307     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21308     GO TO 8585-EXIT.
 21309
 21310 8585-PLAN-NOT-FOUND.
 21311
 21312     MOVE 'N'                    TO PLAN-MASTER-SW.
 21313
 21314 8585-EXIT.
 21315     EXIT.
 21316
 21317 8586-READ-LOAN-OFFICER.
 21318
 21319     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 21320
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 396
* EL517.cbl
 21321     READ ERLOFC
 21322
 21323     IF ERLOFC-FILE-STATUS NOT = '00'
 21324        MOVE 'N'                 TO LOFC-MASTER-SW
 21325     ELSE
 21326        MOVE 'Y'                 TO LOFC-MASTER-SW
 21327     END-IF
 21328
 21329     .
 21330 8586-EXIT.
 21331     EXIT.
 21332
 21333
 21334 8587-START-ERPDEF.
 21335
 21336     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21337
 21338     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21339     IF ERPDEF-FILE-STATUS NOT = '00'
 21340        MOVE 'N'                 TO PDEF-MASTER-SW
 21341     ELSE
 21342        MOVE 'Y'                 TO PDEF-MASTER-SW
 21343     END-IF
 21344
 21345
 21346     .
 21347 8587-EXIT.
 21348     EXIT.
 21349
 21350 8588-READ-ERPDEF.
 21351
 21352     READ ERPDEF NEXT RECORD
 21353
 21354     IF ERPDEF-FILE-STATUS NOT = '00'
 21355        MOVE 'N'                 TO PDEF-MASTER-SW
 21356     ELSE
 21357        MOVE 'Y'                 TO PDEF-MASTER-SW
 21358     END-IF
 21359
 21360     .
 21361 8588-EXIT.
 21362     EXIT.
 21363
 21364 8589-ENDBR-ERPDEF.
 21365
 21366     .
 21367 8589-EXIT.
 21368     EXIT.
 21369
 21370 8590-READ-CERT-MASTER.
 21371     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21372     READ ELCERT.
 21373     ADD 1 TO RCER.
 21374
 21375     IF ELCERT-FILE-STATUS NOT = '00'
 21376         NEXT SENTENCE
 21377     ELSE
 21378         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 397
* EL517.cbl
 21379
 21380     MOVE '1'                     TO CERT-STATUS-SW.
 21381
 21382     IF PB-COMPANY-ID = 'UCL'
 21383         IF WS-ERROR = ER-2799
 21384             GO TO 8590-EXIT.
 21385
 21386     IF PB-CANCELLATION
 21387        MOVE ER-2726              TO  WS-ERROR
 21388        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21389        IF ACCOUNT-MAST-FOUND
 21390           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21391           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21392           GO TO 8590-EXIT
 21393        ELSE
 21394           GO TO 8590-EXIT.
 21395
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 398
* EL517.cbl
 21397
 21398 8590-EXIT.
 21399     EXIT.
 21400
 21401 8750-START-ELSTAT.
 21402
 21403     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21404
 21405     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21406     IF ELSTAT-FILE-STATUS NOT = '00'
 21407        MOVE 'N'                 TO STAT-MASTER-SW
 21408     ELSE
 21409        MOVE 'Y'                 TO STAT-MASTER-SW
 21410     END-IF
 21411
 21412     .
 21413 8750-EXIT.
 21414     EXIT.
 21415
 21416 8752-READ-ELSTAT.
 21417
 21418     READ ELSTAT NEXT RECORD
 21419
 21420     IF ELSTAT-FILE-STATUS NOT = '00'
 21421        MOVE 'N'                 TO STAT-MASTER-SW
 21422     ELSE
 21423        MOVE 'Y'                 TO STAT-MASTER-SW
 21424     END-IF
 21425
 21426     .
 21427 8752-EXIT.
 21428     EXIT.
 21429
 21430 8800-GET-COMP-RATE.
 21431     MOVE +1 TO IB.
 21432     IF WS-COMM-CK-AMT > CT-TBF (1)
 21433         ADD +9 TO IB
 21434         IF WS-COMM-CK-AMT > CT-TBF (2)
 21435             ADD +9 TO IB
 21436             IF WS-COMM-CK-AMT > CT-TBF (3)
 21437                MOVE ZEROS       TO WS-WK-RATE
 21438                GO TO 8800-EXIT.
 21439
 21440     IF PB-I-AGE > CT-AGE (1)
 21441         ADD +3 TO IB
 21442         IF PB-I-AGE > CT-AGE (2)
 21443             ADD +3 TO IB
 21444             IF PB-I-AGE > CT-AGE (3)
 21445                MOVE ZEROS       TO WS-WK-RATE
 21446                GO TO 8800-EXIT.
 21447
 21448     IF WS-WORK-TERM > CT-TRM (1)
 21449         ADD +1 TO IB
 21450         IF WS-WORK-TERM > CT-TRM (2)
 21451             ADD +1 TO IB
 21452             IF WS-WORK-TERM > CT-TRM (3)
 21453                MOVE ZEROS       TO WS-WK-RATE
 21454                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 399
* EL517.cbl
 21455
 21456     IF CT-RT (IB) NOT NUMERIC
 21457         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21458         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21459         GO TO 8800-GET-COMP-RATE.
 21460
 21461     MOVE CT-RT (IB) TO WS-WK-RATE.
 21462
 21463 8800-EXIT.
 21464     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 400
* EL517.cbl
 21466
 21467 8900-ADDRESS-FILE.
 21468     EXIT.
 21469 8900-ADDRESS-EXIT.
 21470     EXIT.
 21471
 21472 9000-READ-CONTROL.
 21473     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21474     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21475
 21476     IF ELCNTL-FILE-STATUS NOT = '00'
 21477         GO TO 9000-NOTFND.
 21478
 21479     READ ELCNTL NEXT.
 21480     ADD 1 TO RCNT.
 21481
 21482     IF ELCNTL-FILE-STATUS NOT = '00'
 21483         GO TO 9000-NOTFND.
 21484
 21485     IF CNTL-REC-TYPE = '1'
 21486         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21487         MOVE 1            TO ELCNTL-POINTER.
 21488
 21489     IF CNTL-REC-TYPE = '6'
 21490         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21491         MOVE 6            TO ELCNTL-POINTER.
 21492
 21493     GO TO 9000-EXIT.
 21494
 21495 9000-NOTFND.
 21496     IF RC-SW-1 = '1'
 21497         MOVE ER-2616             TO WS-ERROR
 21498         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21499         GO TO 9000-EXIT.
 21500
 21501     IF RC-SW-1 = '2'
 21502         MOVE ER-2602             TO WS-ERROR
 21503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21504         GO TO 9000-EXIT.
 21505
 21506     GO TO 9000-EXIT.
 21507
 21508 9000-EXIT.
 21509     EXIT.
 21510      EXIT.
 21511
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 401
* EL517.cbl
 21513 9100-READ-CONTROL.
 21514     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21515     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21516
 21517     IF ELCNTL-FILE-STATUS NOT = '00'
 21518         GO TO 9100-NOTFND.
 21519
 21520     READ ELCNTL NEXT.
 21521     ADD 1 TO RCNT.
 21522
 21523     IF ELCNTL-FILE-STATUS NOT = '00'
 21524         GO TO 9100-NOTFND.
 21525
 21526     IF CNTL-REC-TYPE = '3'
 21527         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21528         MOVE 3            TO ELCNTL-POINTER
 21529         GO TO 9100-EXIT.
 21530
 21531     IF CNTL-REC-TYPE = '4'
 21532         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21533         MOVE 4            TO ELCNTL-POINTER
 21534         GO TO 9100-EXIT.
 21535
 21536     IF CNTL-REC-TYPE = '5'
 21537         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21538         MOVE 5            TO ELCNTL-POINTER
 21539         GO TO 9100-EXIT.
 21540
 21541     IF CNTL-REC-TYPE = 'L'
 21542         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21543         MOVE 10           TO ELCNTL-POINTER
 21544         GO TO 9100-EXIT.
 21545
 21546     IF CNTL-REC-TYPE = 'A'
 21547         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21548         MOVE 11           TO ELCNTL-POINTER
 21549         GO TO 9100-EXIT.
 21550
 21551 9100-NOTFND.
 21552     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21553
 21554     IF RC-SW-2 = '1'
 21555        MOVE '1'                 TO LF-BENEFIT-ERROR
 21556        MOVE ER-2604             TO WS-ERROR
 21557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21558        GO TO 9100-EXIT.
 21559
 21560     IF RC-SW-2 = '2'
 21561        MOVE '1'                 TO AH-BENEFIT-ERROR
 21562        MOVE ER-2605             TO WS-ERROR
 21563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21564        GO TO 9100-EXIT.
 21565
 21566     IF RC-SW-2 = '3'
 21567        MOVE ER-2603             TO WS-ERROR
 21568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21569        GO TO 9100-EXIT.
 21570
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 402
* EL517.cbl
 21571     IF RC-SW-2 = '4'
 21572         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21573         GO TO 9100-EXIT.
 21574
 21575     IF RC-SW-2 = '5'
 21576         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21577         IF WS-AH-INPUT-CD-1 = SPACE
 21578             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21579         ELSE
 21580             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21581
 21582 9100-EXIT.
 21583     EXIT.
 21584      EXIT.
 21585
 21586 9200-CONTROL-GETMAIN.
 21587*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21588     EXIT.
 21589 9200-EXIT.
 21590     EXIT.
 21591
 21592 9250-UNLOCK-RETURN.
 21593*  DUMMIED IN THE BATCH EL517 ....
 21594     EXIT.
 21595 9250-UNLOCK-EXIT.
 21596     EXIT.
 21597      EXIT.
 21598
 21599 9300-ACCUM-BATCH-TOTALS.
 21600         IF PB-ISSUE
 21601             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21602             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21603             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21604             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21605             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21606             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21607             ADD 1                       TO WS-ISSUE-CNT
 21608         ELSE
 21609             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21610             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21611             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21612             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21613             ADD 1                       TO WS-CANCEL-CNT.
 21614
 21615 9400-EXIT.
 21616     EXIT.
 21617
 21618 9990-RETURN.
 21619*    END BROUSE OF ACCOUNT FILE
 21620     EXIT.
 21621
 21622 9990-EXIT.
 21623     EXIT.
 21624
 21625
 21626****Check for CRTO record, add one if not found.
 21627 9991-CHECK-FOR-ELCRTO.
 21628     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 403
* EL517.cbl
 21629         OPEN I-O ELCRTO
 21630         MOVE 'X' TO ELCRTO-OPEN
 21631         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21632             NEXT SENTENCE
 21633         ELSE
 21634             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21635             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21636             MOVE EMSG               TO WS-ABEND-MESSAGE
 21637             GO TO ABEND-PGM
 21638         END-IF
 21639     END-IF.
 21640     IF ELCRTT-OPEN = ' '
 21641         OPEN I-O ELCRTT
 21642         MOVE 'X' TO ELCRTT-OPEN
 21643         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21644             NEXT SENTENCE
 21645         ELSE
 21646             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21647             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21648             MOVE EMSG               TO WS-ABEND-MESSAGE
 21649             GO TO ABEND-PGM
 21650         END-IF
 21651     END-IF.
 21652     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21653     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21654     MOVE +0                     TO ELCRTO-SEQ-NO
 21655     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21656
 21657     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21658
 21659     IF ELCRTO-FILE-STATUS NOT = '00'
 21660         GO TO 9991-CRTO-NOT-FOUND
 21661     END-IF.
 21662
 21663     READ ELCRTO NEXT.
 21664     IF ELCRTO-FILE-STATUS = '00'
 21665        AND (OC-CONTROL-PRIMARY (1:33) =
 21666                 PB-CONTROL-BY-ACCOUNT (1:33))
 21667        AND (OC-RECORD-TYPE = 'I')
 21668           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21669               GO TO 9991-CHECK-INDICATORS
 21670           ELSE
 21671               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21672               GO TO 9991-CRTO-ADD-REC
 21673           END-IF
 21674     END-IF.
 21675
 21676 9991-CRTO-NOT-FOUND.
 21677
 21678     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21679     MOVE 'OC'                TO OC-RECORD-ID
 21680     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21681                              TO OC-CONTROL-PRIMARY (1:33)
 21682     MOVE +4096               TO OC-KEY-SEQ-NO.
 21683
 21684 9991-CRTO-ADD-REC.
 21685
 21686     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 404
* EL517.cbl
 21687     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21688     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21689     MOVE 'I'                 TO OC-RECORD-TYPE
 21690     IF PB-ISSUE
 21691         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21692         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21693         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21694         MOVE PB-I-AGE               TO OC-INS-AGE
 21695         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21696         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21697         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21698         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21699         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21700         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21701         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21702         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21703         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21704         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21705         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21706         IF PB-I-JOINT-COMMISSION > +0
 21707             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21708         ELSE
 21709             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21710         END-IF
 21711         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21712         MOVE +0                     TO OC-LF-CANCEL-AMT
 21713                                        OC-LF-ITD-CANCEL-AMT
 21714         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21715         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21716         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21717         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21718         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21719         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21720         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21721         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21722         MOVE +0                     TO OC-AH-CANCEL-AMT
 21723                                        OC-AH-ITD-CANCEL-AMT
 21724         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21725         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21726         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21727     ELSE
 21728         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21729         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21730         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21731         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21732         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21733         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21734         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21735         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21736         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21737          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21738             MOVE SPACES             TO OC-LF-BENCD
 21739             MOVE ZEROS              TO OC-LF-TERM
 21740                                        OC-LF-BEN-AMT
 21741                                        OC-LF-PRM-AMT
 21742                                        OC-LF-ALT-BEN-AMT
 21743                                        OC-LF-ALT-PRM-AMT
 21744                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 405
* EL517.cbl
 21745                                        OC-LF-CANCEL-AMT
 21746             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21747             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21748         ELSE
 21749             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21750             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21751             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21752             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21753             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21754             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21755             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21756             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21757             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21758             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21759         END-IF
 21760         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21761         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21762          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21763             MOVE SPACES             TO OC-AH-BENCD
 21764             MOVE ZEROS              TO OC-AH-TERM
 21765                                        OC-AH-BEN-AMT
 21766                                        OC-AH-PRM-AMT
 21767                                        OC-AH-COMM-PCT
 21768                                        OC-AH-CANCEL-AMT
 21769                                        OC-AH-CP
 21770             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21771             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21772         ELSE
 21773             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21774             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21775             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21776             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21777             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21778             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21779             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21780             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21781             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21782         END-IF
 21783         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21784         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21785         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21786         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21787     END-IF
 21788     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21789
 21790     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21791     IF ERMAIL-FOUND = ' '
 21792         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21793     END-IF.
 21794
 21795     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21796     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21797     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21798
 21799     READ ELCRTT
 21800
 21801     IF ELCRTT-FILE-STATUS  = '00'
 21802         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 406
* EL517.cbl
 21803         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21804     END-IF.
 21805
 21806     WRITE ORIGINAL-CERTIFICATE.
 21807
 21808     GO TO 9991-EXIT.
 21809
 21810 9991-CHECK-INDICATORS.
 21811
 21812     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21813         GO TO 9991-EXIT
 21814     END-IF.
 21815
 21816     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21817         GO TO 9991-EXIT
 21818     END-IF.
 21819
 21820     IF PB-ISSUE
 21821        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21822        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21823        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21824        MOVE PB-I-AGE               TO OC-INS-AGE
 21825        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21826        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21827        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21828        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21829        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21830        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21831        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21832        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21833        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21834        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21835        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21836        IF PB-I-JOINT-COMMISSION > +0
 21837            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21838        ELSE
 21839            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21840        END-IF
 21841        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21842        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21843        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21844        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21845        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21846        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21847        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21848        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21849        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21850
 21851        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21852        IF ERMAIL-FOUND = ' '
 21853           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21854        END-IF
 21855
 21856        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21857        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21858        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21859        READ ELCRTT
 21860        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 407
* EL517.cbl
 21861           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21862           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21863        END-IF
 21864
 21865     ELSE
 21866        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21867           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21868           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21869           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21870        END-IF
 21871        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21872           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21873           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21874           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21875        END-IF
 21876        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21877     END-IF
 21878
 21879     REWRITE ORIGINAL-CERTIFICATE.
 21880
 21881 9991-EXIT.
 21882     EXIT.
 21883
 21884
 21885 9999-SET-PNDB-ERROR-FLAGS.
 21886
 21887     IF PB-BATCH-TRAILER
 21888        GO TO 9999-REWRITE-RECORD.
 21889
 21890     IF PB-COMMON-ERRORS = LOW-VALUES
 21891        GO TO 9999-SET-ERROR-FLAGS.
 21892
 21893 9999-FORMAT-ERRORS.
 21894
 21895     MOVE +0                     TO SUB1.
 21896
 21897 9999-ERROR-LOOP.
 21898
 21899     ADD +1                      TO SUB1.
 21900
 21901     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21902        GO TO 9999-SET-ERROR-FLAGS.
 21903
 21904     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21905
 21906     READ ELCERR.
 21907
 21908     IF ELCERR-FILE-STATUS NOT = '00'
 21909        ADD +1                       TO EMI-FATAL-CTR
 21910        GO TO  9999-ERROR-LOOP.
 21911
*21912                                 COPY ELCERRPD.
 21913******************************************************************04/15/98
 21914*                                                                *ELCERRPD
 21915*                                                                *ELCERRPD
 21916*                            ELCERRPD                            *   LV002
 21917*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21918*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 408
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21919*                                                                *ELCERRPD
 21920*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21921*                                                                *ELCERRPD
 21922******************************************************************ELCERRPD
 21923                                                                  ELCERRPD
 21924     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21925         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21926                                                                  ELCERRPD
 21927     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21928                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21929        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21930            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21931                                                                  ELCERRPD
 21932     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21933        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21934            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21935                                                                  ELCERRPD
 21936     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21937        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21938            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21939                                                                  ELCERRPD
 21940     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21941        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21942            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21943                                                                  ELCERRPD
 21944     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21945        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21946            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21947                                                                  ELCERRPD
 21948     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21949        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21950            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21951                                                                  ELCERRPD
 21952     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21953        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21954            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21955                                                                  ELCERRPD
 21956     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21957        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21958            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21959                                                                  ELCERRPD
 21960     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21961        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21962            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21963                                                                  ELCERRPD
 21964     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21965        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21966            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21967                                                                  ELCERRPD
 21968     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21969             OR                                                   ELCERRPD
 21970         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21971                                                                  ELCERRPD
 21972         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21973             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21974                                                                  ELCERRPD
 21975     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21976         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 409
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21977             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21978
 21979     IF E-CLIENT-ID = CLIENT-DCC
 21980        IF EM-MESSAGE-NUMBER = 2719
 21981           MOVE 'W'              TO EM-ERROR-SEVERITY
 21982        END-IF
 21983     END-IF
 21984
 21985     .
 21986
 21987     IF EM-ERROR-SEVERITY = 'W'
 21988        ADD +1                   TO EMI-WARNING-CTR
 21989        GO TO  9999-ERROR-LOOP.
 21990
 21991     IF EM-ERROR-SEVERITY = 'F'
 21992        ADD +1                   TO EMI-FORCABLE-CTR
 21993        GO TO  9999-ERROR-LOOP.
 21994
 21995     IF EM-ERROR-SEVERITY = 'X'
 21996        ADD +1                   TO EMI-FATAL-CTR.
 21997
 21998     GO TO 9999-ERROR-LOOP.
 21999
 22000 9999-SET-ERROR-FLAGS.
 22001
 22002     IF EMI-FATAL-CTR NOT = ZEROS
 22003        MOVE 'X'                 TO PB-FATAL-FLAG
 22004        GO TO 9999-CONT-SET-ERROR-FLAGS.
 22005
 22006     IF EMI-FORCABLE-CTR NOT = ZEROS
 22007        IF PB-ISSUE
 22008           IF PB-ISSUE-FORCE
 22009              MOVE 'F'           TO PB-FORCE-ER-CD
 22010             ELSE
 22011              MOVE 'X'           TO PB-FORCE-ER-CD
 22012          ELSE
 22013           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22014              MOVE 'F'           TO PB-FORCE-ER-CD
 22015             ELSE
 22016              MOVE 'X'           TO PB-FORCE-ER-CD.
 22017
 22018 9999-CONT-SET-ERROR-FLAGS.
 22019
 22020     IF EMI-WARNING-CTR NOT = ZEROS
 22021        MOVE 'W'                 TO PB-WARN-ER-CD.
 22022
 22023     IF PB-UNFORCED-ERRORS OR
 22024        PB-FATAL-ERRORS    OR
 22025        PB-RECORD-ON-HOLD  OR
 22026        PB-RECORD-RETURNED
 22027*        OR
 22028*       PB-CANCELLATION
 22029          NEXT SENTENCE
 22030        ELSE
 22031          GO TO 9999-REWRITE-RECORD.
 22032
 22033     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22034     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 410
* EL517.cbl
 22035     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 22036     MOVE PB-SV-STATE            TO CERT-STATE.
 22037
 22038     READ ELCERT.
 22039
 22040     IF PB-ISSUE
 22041     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 22042        GO TO 9999-REWRITE-CERT-MASTER.
 22043
 22044     IF PB-ISSUE
 22045        IF PB-RECORD-RETURNED
 22046            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 22047        ELSE
 22048             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 22049
 22050     IF PB-CANCELLATION
 22051        IF PB-RECORD-RETURNED
 22052            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 22053        ELSE
 22054            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 22055               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 22056            ELSE
 22057               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 22058
 22059 9999-REWRITE-CERT-MASTER.
 22060
 22061     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22062        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22063        GO TO 9999-REWRITE-RECORD.
 22064
 22065     REWRITE CERTIFICATE-MASTER.
 22066     ADD 1 TO WCER.
 22067
 22068 9999-REWRITE-RECORD.
 22069     IF NOT PB-BATCH-TRAILER
 22070         IF PB-ISSUE
 22071             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 22072             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 22073             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 22074             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 22075             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 22076             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 22077             ADD 1                   TO WS-ISSUE-CNT
 22078         ELSE
 22079             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 22080             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 22081             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 22082             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 22083             ADD 1                   TO WS-CANCEL-CNT
 22084     ELSE
 22085         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 22086         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 22087         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 22088         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 22089         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 22090         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 22091         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 22092         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 411
* EL517.cbl
 22093         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 22094         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 22095         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 22096                                        WS-LF-ISS-ENTERED
 22097                                        WS-AH-ISS-COMPUTED
 22098                                        WS-AH-ISS-ENTERED
 22099                                        WS-LF-CAN-COMPUTED
 22100                                        WS-LF-CAN-ENTERED
 22101                                        WS-AH-CAN-COMPUTED
 22102                                        WS-AH-CAN-ENTERED
 22103                                        WS-ISSUE-CNT
 22104                                        WS-CANCEL-CNT
 22105         MOVE SPACE                  TO PB-FATAL-FLAG.
 22106
 22107     IF PB-BATCH-TRAILER
 22108         IF PB-B-LF-ISS-PRM-REMITTED =
 22109            PB-B-LF-ISS-PRM-ENTERED   AND
 22110            PB-B-LF-CAN-PRM-REMITTED =
 22111            PB-B-LF-CAN-PRM-ENTERED   AND
 22112            PB-B-AH-ISS-PRM-REMITTED =
 22113            PB-B-AH-ISS-PRM-ENTERED   AND
 22114            PB-B-AH-CAN-PRM-REMITTED =
 22115            PB-B-AH-CAN-PRM-ENTERED   AND
 22116            PB-B-ISSUE-CNT-REMITTED  =
 22117            PB-B-ISSUE-CNT-ENTERED    AND
 22118            PB-B-CANCEL-CNT-REMITTED =
 22119            PB-B-CANCEL-CNT-ENTERED
 22120             MOVE SPACE          TO PB-OUT-BAL-CD
 22121           ELSE
 22122             MOVE 'O'            TO PB-OUT-BAL-CD.
 22123
 22124     REWRITE PENDING-BUSINESS.
 22125
 22126     ADD 1 TO WPND.
 22127
 22128     GO TO 0100-READ-PENDING.
 22129
 22130 9999-EXIT.
 22131     EXIT.
 22132
 22133******************************************************************
 22134*                                                                *
 22135*            E R R O R   F O R M A T   R O U T I N E             *
 22136*                                                                *
 22137******************************************************************
 22138
 22139 9900-ERROR-FORMAT.
 22140
 22141     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 22142                   PB-COMMON-ERROR (2)  OR
 22143                   PB-COMMON-ERROR (3)  OR
 22144                   PB-COMMON-ERROR (4)  OR
 22145                   PB-COMMON-ERROR (5)  OR
 22146                   PB-COMMON-ERROR (6)  OR
 22147                   PB-COMMON-ERROR (7)  OR
 22148                   PB-COMMON-ERROR (8)  OR
 22149                   PB-COMMON-ERROR (9)  OR
 22150                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 412
* EL517.cbl
 22151        GO TO 9900-EXIT.
 22152
 22153     IF PB-NO-OF-ERRORS = +10
 22154        GO TO 9900-EXIT.
 22155
 22156     ADD +1                      TO PB-NO-OF-ERRORS.
 22157     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22158                                       (PB-NO-OF-ERRORS).
 22159
 22160
 22161 9900-EXIT.
 22162     EXIT.
 22163
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 413
* EL517.cbl
 22165 9999-DONE.
 22166*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 22167
 22168     IF DTE-CLIENT NOT EQUAL 'DMD'
 22169          GO TO 9999-DONE-CONT.
 22170
 22171     CLOSE ERRESS
 22172           ERRESC.
 22173
 22174     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 22175     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 22176     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 22177     IF DMPF-RETURN-CODE EQUAL 'Z3'
 22178         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22179         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 22180         MOVE CMSG               TO WS-ABEND-MESSAGE
 22181         GO TO ABEND-PGM.
 22182
 22183     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 22184     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 22185     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 22186     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22187         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22188         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 22189         MOVE CMSG               TO WS-ABEND-MESSAGE
 22190         GO TO ABEND-PGM.
 22191
 22192     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 22193     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 22194     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 22195     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22196         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22197         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 22198         MOVE CMSG               TO WS-ABEND-MESSAGE
 22199         GO TO ABEND-PGM.
 22200
 22201     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22202     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 22203     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22204     IF DCUA-RETURN-CODE EQUAL 'Z3'
 22205         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22206         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 22207         MOVE CMSG               TO WS-ABEND-MESSAGE
 22208         GO TO ABEND-PGM.
 22209
 22210     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 22211     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 22212     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 22213     IF DPRB-RETURN-CODE EQUAL 'Z3'
 22214         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22215         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 22216         MOVE CMSG               TO WS-ABEND-MESSAGE
 22217         GO TO ABEND-PGM.
 22218
 22219     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 22220     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 22221     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 22222     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 414
* EL517.cbl
 22223         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22224         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 22225         MOVE CMSG               TO WS-ABEND-MESSAGE
 22226         GO TO ABEND-PGM.
 22227
 22228     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 22229     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 22230     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 22231     IF DVSC-RETURN-CODE EQUAL 'Z3'
 22232         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22233         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 22234         MOVE CMSG               TO WS-ABEND-MESSAGE
 22235         GO TO ABEND-PGM.
 22236
 22237*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22238
 22239 9999-DONE-CONT.
 22240
 22241     IF ERPNDM-OPEN = 'X'
 22242        CLOSE ERPNDM.
 22243
 22244     IF ERMAIL-OPEN = 'X'
 22245        CLOSE ERMAIL.
 22246
 22247     IF ELMSTR-OPEN = 'X'
 22248        CLOSE ELMSTR.
 22249
 22250     IF ELCRTT-OPEN = 'X'
 22251        CLOSE ELCRTT
 22252     END-IF.
 22253
 22254     IF ELCRTO-OPEN = 'X'
 22255        CLOSE ELCRTO
 22256     END-IF.
 22257
 22258     CLOSE      ELCNTL
 22259                ELCERR
 22260                ERPNDB
 22261                ERREIN
 22262                ELCERT
 22263                ERCTBL
 22264                ERPLAN
 22265                ERACCT
 22266                ERBXRF
 22267                ERAGTC
 22268                ERCOMP.
 22269
 22270     IF DTE-CLIENT = 'DCC'
 22271        CLOSE ERPDEF ELSTAT
 22272        IF ERPDEF-FILE-STATUS NOT = '00'
 22273            MOVE ERPDEF-FILE-STATUS
 22274                                 TO WS-ABEND-FILE-STATUS
 22275            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 22276            MOVE CMSG            TO WS-ABEND-MESSAGE
 22277            GO TO ABEND-PGM
 22278        END-IF
 22279        IF ELSTAT-FILE-STATUS NOT = '00'
 22280            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 415
* EL517.cbl
 22281                                 TO WS-ABEND-FILE-STATUS
 22282            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 22283            MOVE CMSG            TO WS-ABEND-MESSAGE
 22284            GO TO ABEND-PGM
 22285        END-IF
 22286     END-IF
 22287
 22288     IF ELCNTL-FILE-STATUS NOT = '00'
 22289         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22290         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 22291         MOVE CMSG TO WS-ABEND-MESSAGE
 22292         GO TO ABEND-PGM.
 22293
 22294     IF ERPNDB-FILE-STATUS NOT = '00'
 22295         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22296         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 22297         MOVE CMSG TO WS-ABEND-MESSAGE
 22298         GO TO ABEND-PGM.
 22299
 22300     IF ERREIN-FILE-STATUS NOT = '00'
 22301         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22302         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 22303         MOVE CMSG TO WS-ABEND-MESSAGE
 22304         GO TO ABEND-PGM.
 22305
 22306     IF ELCERT-FILE-STATUS NOT = '00'
 22307         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22308         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 22309         MOVE CMSG TO WS-ABEND-MESSAGE
 22310         GO TO ABEND-PGM.
 22311
 22312     IF ERMAIL-OPEN   = 'X'
 22313       IF ERMAIL-FILE-STATUS NOT = '00'
 22314           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22315           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 22316           MOVE CMSG TO WS-ABEND-MESSAGE
 22317           GO TO ABEND-PGM.
 22318
 22319     IF ERPNDM-OPEN   = 'X'
 22320       IF ERPNDM-FILE-STATUS NOT = '00'
 22321            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22322            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22323            MOVE CMSG TO WS-ABEND-MESSAGE
 22324            GO TO ABEND-PGM.
 22325
 22326     IF ELCRTT-OPEN = 'X'
 22327         IF ELCRTT-FILE-STATUS NOT = '00'
 22328             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22329             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22330             MOVE CMSG TO WS-ABEND-MESSAGE
 22331             GO TO ABEND-PGM
 22332         END-IF
 22333     END-IF.
 22334
 22335     IF ELCRTO-OPEN = 'X'
 22336         IF ELCRTO-FILE-STATUS NOT = '00'
 22337             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22338             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 416
* EL517.cbl
 22339             MOVE CMSG TO WS-ABEND-MESSAGE
 22340             GO TO ABEND-PGM
 22341         END-IF
 22342     END-IF.
 22343
 22344     IF ERCTBL-FILE-STATUS NOT = '00'
 22345         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22346         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22347         MOVE CMSG TO WS-ABEND-MESSAGE
 22348         GO TO ABEND-PGM.
 22349
 22350     IF ERPLAN-FILE-STATUS NOT = '00'
 22351        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22352        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22353        MOVE CMSG TO WS-ABEND-MESSAGE
 22354        GO TO ABEND-PGM.
 22355
 22356     IF ERACCT-FILE-STATUS NOT = '00'
 22357         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22358         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22359         MOVE CMSG TO WS-ABEND-MESSAGE
 22360         GO TO ABEND-PGM.
 22361
 22362     IF ERCOMP-FILE-STATUS NOT = '00'
 22363         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22364         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22365         MOVE CMSG TO WS-ABEND-MESSAGE
 22366         GO TO ABEND-PGM.
 22367
 22368     IF ERBXRF-FILE-STATUS NOT = '00'
 22369         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22370         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22371         MOVE CMSG TO WS-ABEND-MESSAGE
 22372         GO TO ABEND-PGM.
 22373
 22374     IF ERAGTC-FILE-STATUS NOT = '00'
 22375         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22376         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22377         MOVE CMSG TO WS-ABEND-MESSAGE
 22378         GO TO ABEND-PGM.
 22379
 22380     IF ELCERR-FILE-STATUS NOT = '00'
 22381         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22382         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22383         MOVE CMSG TO WS-ABEND-MESSAGE
 22384         GO TO ABEND-PGM.
 22385
 22386     MOVE 'C'                     TO CP-IO-FUNCTION.
 22387     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22388
 22389     IF IO-ERROR
 22390        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22391        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22392        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22393        GO TO ABEND-PGM.
 22394
 22395     OPEN OUTPUT PRINT-FILE.
 22396
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 417
* EL517.cbl
 22397     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22398     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22399     MOVE ALPH-DATE              TO H3-DATE.
 22400     MOVE TRAN-CT                TO SUM-TOT.
 22401
 22402 7000-PRT-HDG.
 22403     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22404     PERFORM 7000-PRINT-LINE.
 22405     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22406     PERFORM 7000-PRINT-LINE.
 22407     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22408     PERFORM 7000-PRINT-LINE.
 22409     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22410     PERFORM 7000-PRINT-LINE.
 22411     GO TO 9999-END-JOB.
 22412
 22413 7000-HDG-XIT.
 22414     EXIT.
 22415
 22416 7000-PRINT-LINE.
*22417                     COPY ELCPRT2X.
 22418******************************************************************04/15/98
 22419*                                                                *ELCPRT2X
 22420*                                                                *ELCPRT2X
 22421*                            ELCPRT2X.                           *   LV002
 22422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22423*                            VMOD=2.002                          *   CL**2
 22424*                                                                *ELCPRT2X
 22425*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22426*                                                                *ELCPRT2X
 22427*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22428*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22429*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22430*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22431*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22432*                                                                *ELCPRT2X
 22433*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22434*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22435******************************************************************ELCPRT2X
 22436                                                                  ELCPRT2X
 22437     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22438         FICH-OPEN   = SPACE                                      ELCPRT2X
 22439         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22440         OPEN OUTPUT FICH.                                        ELCPRT2X
 22441                                                                  ELCPRT2X
 22442     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22443         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22444             OPEN I-O ELREPT                                      ELCPRT2X
 22445             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22446                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22447                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22448                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22449                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22450                 GO TO ABEND-PGM                                  ELCPRT2X
 22451             ELSE                                                 ELCPRT2X
 22452                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22453                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22454                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 418
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22455                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22456                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22457                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22458                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22459                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22460                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22461                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22462                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22463                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22464                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22465                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22466                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22467                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22468                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22469                                                                  ELCPRT2X
 22470     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22471        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22472         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22473         GO TO ABEND-PGM.                                         ELCPRT2X
 22474                                                                  ELCPRT2X
 22475     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22476         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22477         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22478             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22479                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22480                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22481                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22482                     INVALID KEY                                  ELCPRT2X
 22483                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22484                         CLOSE ELREPT                             ELCPRT2X
 22485                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22486                                                                  ELCPRT2X
 22487     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22488         MOVE X                      TO  P-CTL                    ELCPRT2X
 22489         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22490                                                                  ELCPRT2X
 22491     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22492       MOVE X                        TO  P-CTL                    ELCPRT2X
 22493       IF P-CTL = ' '                                             ELCPRT2X
 22494         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22495       ELSE                                                       ELCPRT2X
 22496         IF P-CTL = '0'                                           ELCPRT2X
 22497           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22498         ELSE                                                     ELCPRT2X
 22499           IF P-CTL = '-'                                         ELCPRT2X
 22500             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22501           ELSE                                                   ELCPRT2X
 22502             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22503                                                                  ELCPRT2X
 22504     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22505                                                                  ELCPRT2X
 22506 DTE-REPORT-DELETE.                                               ELCPRT2X
 22507     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22508         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22509         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22510                                                                  ELCPRT2X
 22511     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22512           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 419
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22513                                                                  ELCPRT2X
 22514     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22515        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22516         DELETE ELREPT RECORD                                     ELCPRT2X
 22517         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22518                                                                  ELCPRT2X
 22519 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22520     EXIT.                                                        ELCPRT2X
 22521                                                                  ELCPRT2X
 22522 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22523     EXIT.                                                        ELCPRT2X
 22524******************************************************************ELCPRT2X
 22525
 22526 REIN-DATE-LOAD.
*22527     COPY ELCRENM1.
 22528******************************************************************04/15/98
 22529*                                                                *ELCRENM1
 22530*                                                                *ELCRENM1
 22531*                            ELCRENM1                            *   LV002
 22532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22533*                            VMOD=2.001                          *ELCRENM1
 22534*                                                                *ELCRENM1
 22535*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22536*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22537*                                                                *ELCRENM1
 22538******************************************************************ELCRENM1
 22539     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22540     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22541     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22542                                                                  ELCRENM1
 22543
 22544 7000-PRINT-LINE-XIT.
 22545      EXIT.
 22546
 22547 9999-END-JOB.
 22548     CLOSE PRINT-FILE.
*22549             COPY ELCPRTCX.
 22550******************************************************************04/15/98
 22551*                                                                *ELCPRTCX
 22552*                                                                *ELCPRTCX
 22553*                            ELCPRTCX.                           *   LV003
 22554*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22555*                            VMOD=2.003                          *   CL**3
 22556*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22557*                                                                *ELCPRTCX
 22558* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22559******************************************************************ELCPRTCX
 22560                                                                  ELCPRTCX
 22561      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22562          CLOSE FICH.                                             ELCPRTCX
 22563                                                                  ELCPRTCX
 22564      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22565          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22566          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22567          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22568          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22569          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22570          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 420
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22571          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22572          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22573              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22574              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22575              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22576                  UPON CONSOLE                                    ELCPRTCX
 22577              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22578                  UPON CONSOLE                                    ELCPRTCX
 22579            ELSE                                                  ELCPRTCX
 22580              DISPLAY '***************************************'   ELCPRTCX
 22581              DISPLAY '***************************************'   ELCPRTCX
 22582              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22583              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22584              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22585              DISPLAY '**                                   **'   ELCPRTCX
 22586              DISPLAY '***************************************'   ELCPRTCX
 22587              DISPLAY '***************************************'   ELCPRTCX
 22588              CLOSE ELREPT.                                       ELCPRTCX
 22589                                                                  ELCPRTCX
 22590      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22591          DISPLAY '***************************************'       ELCPRTCX
 22592          DISPLAY '***************************************'       ELCPRTCX
 22593          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22594          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22595          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22596          DISPLAY '**                                   **'       ELCPRTCX
 22597          DISPLAY '***************************************'       ELCPRTCX
 22598          DISPLAY '***************************************'       ELCPRTCX
 22599          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22600                                                                  ELCPRTCX
 22601      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22602          DISPLAY '***************************************'       ELCPRTCX
 22603          DISPLAY '***************************************'       ELCPRTCX
 22604          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22605          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22606          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22607          DISPLAY '**                                   **'       ELCPRTCX
 22608          DISPLAY '***************************************'       ELCPRTCX
 22609          DISPLAY '***************************************'       ELCPRTCX
 22610          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22611                                                                  ELCPRTCX
 22612                                                                  ELCPRTCX
 22613******************************************************************ELCPRTCX
 22614
 22615     GOBACK.
 22616
 22617 ABEND-PGM.
*                   COPY ELCABEND.
 22618***************************************************************** 04/14/98
 22619*                                                               * ELCABEND
 22620*                            ELCABEND.                          *    LV003
 22621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22622*                            VMOD 2.002                              CL**2
 22623*                                                               * ELCABEND
 22624*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22625*            AND THEN ABENDS.                                   * ELCABEND
 22626*                                                               * ELCABEND
 22627*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:47 Page 421
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22628*                                                               * ELCABEND
 22629***************************************************************** ELCABEND
 22630*APS-010.                                                         ELCABEND
 22631     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22632     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22633                                                                  ELCABEND
 22634     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22635         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22636         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22637                                 UPON CONSOLE.                    ELCABEND
 22638                                                                  ELCABEND
 22639     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22640         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22641         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22642                                 UPON CONSOLE.                    ELCABEND
 22643                                                                  ELCABEND
 22644     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22645     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22646                                 UPON CONSOLE.                    ELCABEND
 22647                                                                  ELCABEND
 22648     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22649     CALL 'ABORTME'.
 22650                                                                  ELCABEND
 22651 APS-EXIT.                                                        ELCABEND
 22652     EXIT.                                                        ELCABEND
 22653
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116680     Code:       91796
