* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ECS010.cbl
    83 ENVIRONMENT DIVISION.
    84 CONFIGURATION SECTION.
    85 SPECIAL-NAMES.
    86     C02 IS LCP-CH2
    87     C03 IS LCP-CH3
    88     C04 IS LCP-CH4
    89     C05 IS LCP-CH5
    90     C06 IS LCP-CH6
    91     C07 IS LCP-CH7
    92     C08 IS LCP-CH8
    93     C09 IS LCP-CH9
    94     C10 IS LCP-CH10
    95     C11 IS LCP-CH11
    96     C12 IS LCP-CH12
    97     S01 IS LCP-P01
    98     S02 IS LCP-P02.
    99
   100 INPUT-OUTPUT SECTION.
   101 FILE-CONTROL.
   102
   103     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   104
   105     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   106
   107     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   108                             ACCESS IS SEQUENTIAL
   109                             ORGANIZATION IS INDEXED
   110                             FILE STATUS IS ERACCTT-FILE-STATUS
   111                             RECORD KEY IS AM-CONTROL-PRIMARY.
   112
   113     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   114                             ACCESS IS DYNAMIC
   115                             ORGANIZATION IS INDEXED
   116                             FILE STATUS IS ERRTBL-FILE-STATUS
   117                             RECORD KEY IS RE-CONTROL-PRIMARY.
   118
   119     SELECT ERCTBL           ASSIGN TO ERCTBLT
   120                             ACCESS IS DYNAMIC
   121                             ORGANIZATION IS INDEXED
   122                             FILE STATUS IS ERCTBL-FILE-STATUS
   123                             RECORD KEY IS CT-CONTROL-PRIMARY.
   124
   125     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   126                             ORGANIZATION INDEXED
   127                             ACCESS DYNAMIC
   128                             RECORD KEY ME-CONTROL-PRIMARY
   129                             FILE STATUS ERMEBL-FILE-STATUS.
   130
   131     SELECT ERRESC-IN        ASSIGN TO ERRESC
   132                             ORGANIZATION IS INDEXED
   133                             ACCESS IS DYNAMIC
   134                             RECORD KEY IS ERRESC-RECORD-KEY
   135                             FILE STATUS IS ERRESC-FILE-STATUS.
   136
   137     SELECT ELCRTT           ASSIGN TO ELCRTT
   138                             ACCESS IS DYNAMIC
   139                             ORGANIZATION IS INDEXED
   140                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ECS010.cbl
   141                             RECORD KEY IS CS-CONTROL-PRIMARY.
   142
   143     SELECT ERAGTC           ASSIGN TO ERAGTC
   144                             ACCESS IS DYNAMIC
   145                             ORGANIZATION IS INDEXED
   146                             FILE STATUS IS ERAGTC-FILE-STATUS
   147                             RECORD KEY IS AG-CONTROL-PRIMARY.
   148
   149     SELECT ERPDEF           ASSIGN TO ERPDEF
   150                             ACCESS IS DYNAMIC
   151                             ORGANIZATION IS INDEXED
   152                             FILE STATUS IS ERPDEF-FILE-STATUS
   153                             RECORD KEY IS PD-CONTROL-PRIMARY.
   154
   155     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   156
   157     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   158
   159     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   160
   161     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   162
   163
   164     SELECT ME-ECS010-BALANCE
   165                             ASSIGN TO SYS012
   166                             ORGANIZATION IS LINE SEQUENTIAL.
   167
   168     SELECT ME50-ECS010-BALANCE
   169                             ASSIGN TO SYS013
   170                             ORGANIZATION IS LINE SEQUENTIAL.
   171
   172     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   173
   174     SELECT DISK-DATE        ASSIGN TO SYS019.
   175
   176     SELECT PRINT-COPY       ASSIGN TO SYS008.
   177
   178     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   179
   180     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ECS010.cbl
   182 DATA DIVISION.
   183 FILE SECTION.
   184
   185 FD  PENDING-EXTRACT
   186     BLOCK CONTAINS 0 RECORDS
   187     RECORDING MODE F.
   188
*  189                             COPY ERCEXTD.
   190******************************************************************04/29/98
   191*                                                                *ERCEXTD
   192*                                                                *ERCEXTD
   193*                            ERCEXTD                             *   LV002
   194*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   195*                            VMOD=2.002                          *   CL**2
   196*                                                                *ERCEXTD
   197*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   198*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   199*                                                                *ERCEXTD
   200*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   201*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   202*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   203*                                                                *ERCEXTD
   204*         RECORD                                                 *ERCEXTD
   205*          TYPE          PROGRAM USING                           *ERCEXTD
   206*        --------        --------------------------------        *ERCEXTD
   207*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   208*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   209*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   210*                                                                *ERCEXTD
   211* -------------------------------------------------------------- *ERCEXTD
   212*                                                                *ERCEXTD
   213*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   214*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   215*                                                                *ERCEXTD
   216*   FILENAME = EREXTD                                            *ERCEXTD
   217*                                                                *ERCEXTD
   218******************************************************************ERCEXTD
   219                                                                  ERCEXTD
   220 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   221     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   222         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   223                                                                  ERCEXTD
   224     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   225         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   226         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   227         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   228                                                                  ERCEXTD
   229     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   230                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ECS010.cbl
   232 FD  CERT-MASTER-IN
*  233                             COPY ECSCRIFD.
   234******************************************************************07/10/97
   235*                                                                *ECSCRIFD
   236*                            ECSCRIFD                            *   LV001
   237*                            VMOD 2.005                          *ECSCRIFD
   238*                                                                *ECSCRIFD
   239*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   240*                                                                *ECSCRIFD
   241******************************************************************ECSCRIFD
   242     BLOCK CONTAINS 0 RECORDS
   243     RECORDING MODE F.                                            ECSCRIFD
   244                                                                  ECSCRIFD
   245 01  CERT-IN-RECORD.                                              ECSCRIFD
   246                                                                  ECSCRIFD
   247     12  FILLER                            PIC XXX.               ECSCRIFD
   248     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   249     12  FILLER                            PIC X(66).             ECSCRIFD
   250     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   251     12  FILLER                            PIC X(20).             ECSCRIFD
   252     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   253     12  FILLER                            PIC X(14).             ECSCRIFD
   254     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   255     12  FILLER                            PIC X(39).             ECSCRIFD
   256     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   257     12  FILLER                            PIC X(45).             ECSCRIFD
   258     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   259     12  FILLER                            PIC X(35).             ECSCRIFD
   260     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   261     12  FILLER                            PIC X(41).             ECSCRIFD
   262     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   263     12  FILLER                            PIC X(48).             ECSCRIFD
   264     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   265     12  FILLER                            PIC X(9).              ECSCRIFD
   266     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   267     12  FILLER                            PIC X(120).            ECSCRIFD
   268     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   269     12  FILLER                            PIC X(73).             ECSCRIFD
   270     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   271     12  FILLER                            PIC X(464).            ECSCRIFD
   272                                                                  ECSCRIFD
   273******************************************************************ECSCRIFD
   274
   275 01  CI-RECORD.
   276     12  FILLER          PIC  X(03).
   277     12  CI-ACCOUNT-CONTROL.
   278         16  CI-CARRIER      PIC  X(01).
   279         16  CI-GROUPING     PIC  X(06).
   280         16  CI-STATE        PIC  X(02).
   281         16  CI-ACCOUNT      PIC  X(10).
   282     12  FILLER          PIC  X(06).
   283     12  CI-CERT-NO.
   284         16  CI-CERT     PIC X(10).
   285         16  CI-CERT-SFX PIC X.
   286     12  FILLER          PIC  X(1017).
   287
   288******************************************************
   289*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ECS010.cbl
   290*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   291*   COMMERCIAL FEDERAL BANK
   292******************************************************
   293 01  CF-RECORD.
   294     12  FILLER          PIC X(759).
   295     12  CF-THIRD-AGENT  PIC X(10).
   296     12  FILLER          PIC X(7).
   297     12  CF-FOURTH-AGENT PIC X(10).
   298     12  FILLER          PIC X(270).
   299
   300******************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ECS010.cbl
   302 FD  ERACCTT-IN.
   303
*  304                             COPY ERCACCT.
   305******************************************************************04/19/98
   306*                                                                *ERCACCT
   307*                                                                *ERCACCT
   308*                            ERCACCT                             *   LV031
   309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   310*                            VMOD=2.031                          *ERCACCT
   311*                                                                *ERCACCT
   312*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   313*                                                                *ERCACCT
   314*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   315*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   316*                                                                *ERCACCT
   317*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   318*                                                                *ERCACCT
   319*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   320*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   321*                                                                *ERCACCT
   322*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   323*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   324*                                                                *ERCACCT
   325*   LOG = NO                                                     *ERCACCT
   326*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   327*                                                                *ERCACCT
   328*                                                                *ERCACCT
   329******************************************************************ERCACCT
   330*                   C H A N G E   L O G
   331*
   332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   333*-----------------------------------------------------------------
   334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   335* EFFECTIVE    NUMBER
   336*-----------------------------------------------------------------
   337* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   338* 092705    2005050300006  PEMA  ADD SPP LEASES
   339* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   340* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   341* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   342* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   343* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   344******************************************************************
   345                                                                  ERCACCT
   346 01  ACCOUNT-MASTER.                                              ERCACCT
   347     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   348         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   349                                                                  ERCACCT
   350     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   351         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   352         16  AM-MSTR-CNTRL.                                       ERCACCT
   353             20  AM-CONTROL-A.                                    ERCACCT
   354                 24  AM-CARRIER            PIC X.                 ERCACCT
   355                 24  AM-GROUPING.                                 ERCACCT
   356                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   357                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   358                 24  AM-STATE              PIC XX.                ERCACCT
   359                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   360                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   361                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   362             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   363                                           PIC X(19).             ERCACCT
   364             20  AM-CNTRL-B.                                      ERCACCT
   365                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   366                 24  FILLER                PIC X(4).              ERCACCT
   367             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   368                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   369                                                                  ERCACCT
   370     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   371         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   372         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   373         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   374         16  AM-VG-STATE                   PIC XX.                ERCACCT
   375         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   376         16  AM-VG-DATE.                                          ERCACCT
   377             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   378             20  FILLER                    PIC X(4).              ERCACCT
   379         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   380                                           PIC 9(11)      COMP-3. ERCACCT
   381     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   382         16  FILLER                        PIC X(10).
   383         16  AM-VG-KEY3.
   384             20  AM-VG3-ACCOUNT            PIC X(10).
   385             20  AM-VG3-EXP-DT             PIC XX.
   386         16  FILLER                        PIC X(4).
   387     12  AM-MAINT-INFORMATION.                                    ERCACCT
   388         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   389         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   390         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   391         16  FILLER                        PIC XX.                ERCACCT
   392                                                                  ERCACCT
   393     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   394     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   395                                                                  ERCACCT
   396     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   397         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   398         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   399                                                                  ERCACCT
   400     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   401     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   402                                                                  ERCACCT
   403     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   404     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   405                                                                  ERCACCT
   406     12  AM-NAME                           PIC X(30).             ERCACCT
   407     12  AM-PERSON                         PIC X(30).             ERCACCT
   408     12  AM-ADDRS                          PIC X(30).             ERCACCT
   409     12  AM-CITY.
   410         16  AM-ADDR-CITY                  PIC X(28).
   411         16  AM-ADDR-STATE                 PIC XX.
   412     12  AM-ZIP.                                                  ERCACCT
   413         16  AM-ZIP-PRIME.                                        ERCACCT
   414             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   415                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   416             20  FILLER                    PIC X(4).              ERCACCT
   417         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   418     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   419         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   420         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   421         16  FILLER                        PIC XXX.               ERCACCT
   422     12  AM-TEL-NO.                                               ERCACCT
   423         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   424         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   425         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   426     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   427         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   428         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   429                                                                  ERCACCT
   430     12  AM-COMM-STRUCTURE.                                       ERCACCT
   431         16  AM-DEFN-1.                                           ERCACCT
   432             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   433                 24  AM-AGT.                                      ERCACCT
   434                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   435                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   436                 24  AM-COM-TYP            PIC X.                 ERCACCT
   437                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   438                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   439                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   440                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   441                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   442                 24  AM-GL-CODES           PIC X.                 ERCACCT
   443                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   444                 24  FILLER                PIC X(01).             ERCACCT
   445         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   446             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   447                 24  FILLER                PIC X(11).             ERCACCT
   448                 24  AM-L-COMA             PIC XXX.               ERCACCT
   449                 24  AM-J-COMA             PIC XXX.               ERCACCT
   450                 24  AM-A-COMA             PIC XXX.               ERCACCT
   451                 24  FILLER                PIC X(6).              ERCACCT
   452                                                                  ERCACCT
   453     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   454         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   455                                                                  ERCACCT
   456     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   457                                                                  ERCACCT
   458     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   459         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   460         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   461     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   462         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   463         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   464     12  AM-GPCD                           PIC 99.                ERCACCT
   465     12  AM-IG                             PIC X.                 ERCACCT
   466         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   467         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   468     12  AM-STATUS                         PIC X.                 ERCACCT
   469         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   470         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   471         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   472         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   473         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   474         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   475     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   476     12  AM-ID-NO                          PIC X(11).             ERCACCT
   477                                                                  ERCACCT
   478     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   479     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   480     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   481     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   482     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   483     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   484     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   485     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   486     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   487                                                                  ERCACCT
   488     12  AM-USER-FIELDS.                                          ERCACCT
   489         16  AM-FLD-1                      PIC XX.                ERCACCT
   490         16  AM-FLD-2                      PIC XX.                ERCACCT
   491         16  AM-FLD-3                      PIC XX.                ERCACCT
   492         16  AM-FLD-4                      PIC XX.                ERCACCT
   493         16  AM-FLD-5                      PIC XX.                ERCACCT
   494                                                                  ERCACCT
   495     12  AM-1ST-PROD-DATE.                                        ERCACCT
   496         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   497         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   498         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   499     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   500     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   501         16  AM-PUR-YR                     PIC XX.                ERCACCT
   502         16  AM-PUR-MO                     PIC XX.                ERCACCT
   503         16  AM-PUR-DA                     PIC XX.                ERCACCT
   504     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   505     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   506     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   507     12  AM-INACTIVE-DATE.                                        ERCACCT
   508         16  AM-INA-MO                     PIC 99.                ERCACCT
   509         16  AM-INA-DA                     PIC 99.                ERCACCT
   510         16  AM-INA-YR                     PIC 99.                ERCACCT
   511     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   512                                                                  ERCACCT
   513     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   514     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   515                                                                  ERCACCT
   516     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   517         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   518         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   519         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   520         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   521                                                                  ERCACCT
   522     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   523         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   524         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   525                                                                  ERCACCT
   526     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   527                                                                  ERCACCT
   528     12  AM-OVER-SHORT.                                           ERCACCT
   529         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   530         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   531                                                                  ERCACCT
   532     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   533     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   534                                                                  ERCACCT
   535     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   536     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   537                                                                  ERCACCT
   538     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   539     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   540     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   541     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   542     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   543     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   544     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   545     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   546     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   547     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   548     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   549     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   550     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   551     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   552     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   553     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   554                                                                  ERCACCT
   555     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   556                                                                  ERCACCT
   557     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   558     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   559                                                                  ERCACCT
   560     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   561     12  AM-EARN-METHODS.                                         ERCACCT
   562         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   563             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   564             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   565             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   566             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   567         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   568             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   569             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   570             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   571             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   572         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   573             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   574             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   575             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   576             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   577             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   578             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   579                                                                  ERCACCT
   580     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   581     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   582     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   583                                                                  ERCACCT
   584     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   585     12  AM-RET-P-E                        PIC X.                 ERCACCT
   586     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   587     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   588     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   589     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   590         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   591         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   592     12  AM-RETRO-EARNINGS.                                       ERCACCT
   593         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   594         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   595         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   596     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   597         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   598         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   599     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   600         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   601         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   602         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   603     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   604     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   605                                                                  ERCACCT
   606     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   607         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   608         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   609         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   610         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   611         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   612                                                                  ERCACCT
   613     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   614                                                                  ERCACCT
   615     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   616                                                                  ERCACCT
   617     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   618         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   619                                                                  ERCACCT
   620     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   621         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   622         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   623                                                                  ERCACCT
   624     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   625         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   626                                                                  ERCACCT
   627     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   628         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   629         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   630                                                                  ERCACCT
   631     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   632                                                                  ERCACCT
   633     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   634     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   635     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   636     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   637     12  AM-DCC-UEF-STATE                  PIC XX.
   638     12  FILLER                            PIC XXX.
   639     12  AM-REPORT-CODE-3                  PIC X(10).
   640*    12  FILLER                            PIC X(22).             ERCACCT
   641                                                                  ERCACCT
   642     12  AM-RESERVE-DATE.                                         ERCACCT
   643         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   644         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   645         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   646                                                                  ERCACCT
   647     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   648     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   649         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   650         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   651         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   652         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   653                                                                  ERCACCT
   654     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   655         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   656         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   657         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   658         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   659                                                                  ERCACCT
   660     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   661         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   662             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   663             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   664             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   665             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   666             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   667             20  FILLER                    PIC XX.                ERCACCT
   668         16  FILLER                        PIC X(80).             ERCACCT
   669                                                                  ERCACCT
   670     12  AM-TRANSFER-DATA.                                        ERCACCT
   671         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   672             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   673             20  AM-TRNFROM-GROUPING.                             ERCACCT
   674                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   675                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   676             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   677             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   678                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   679                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   680             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   681         16  AM-TRANSFERRED-TO.                                   ERCACCT
   682             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   683             20  AM-TRNTO-GROUPING.                               ERCACCT
   684                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   685                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   686             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   687             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   688                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   689                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   690             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   691         16  FILLER                        PIC X(10).             ERCACCT
   692                                                                  ERCACCT
   693     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   694                                                                  ERCACCT
   695     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   696         16  AM-DEFN-1-SAVED.                                     ERCACCT
   697             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   698                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   699                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   700                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   701                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   702                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   703                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   704                 24  FILLER                PIC X.                 ERCACCT
   705                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   706                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   707                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   708         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   709             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   710                 24  FILLER                PIC X(11).             ERCACCT
   711                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   712                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   713                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   714                 24  FILLER                PIC X(6).              ERCACCT
   715                                                                  ERCACCT
   716     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   717         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   718            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   719            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   720            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   721                                                                  ERCACCT
   722     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   723     12  FILLER                            PIC X(120).            ERCACCT
   724                                                                  ERCACCT
   725     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   726         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   727         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   728             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   729             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   730                                                          COMP-3. ERCACCT
   731             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   732                                                          COMP-3. ERCACCT
   733         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   734             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   735             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   736                                                          COMP-3. ERCACCT
   737             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   738                                                          COMP-3. ERCACCT
   739                                                                  ERCACCT
   740     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   741         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   742         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   743         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   744         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   745             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   746                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   747                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   748             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   749                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   750                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   751             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   752                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   753                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   754         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   755             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   756                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   757                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   758                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   759             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   760                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   761                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   762             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   763                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   764                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   765                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   766     12  AM-COMMENTS.                                             ERCACCT
   767         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   768                                                                  ERCACCT
   769     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   770         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   771         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   772         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   773         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   774         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   775             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   776             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   777             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   778             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   779         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   780             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   781             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   782             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   783         16  FILLER                        PIC X(102).            ERCACCT
   784                                                                  ERCACCT
   785     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   786         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   787             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   788             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   789             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   790             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   791             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   792         16  FILLER                          PIC X(10).           ERCACCT
   793******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ECS010.cbl
   795 FD  ERRTBL-IN.
   796
*  797                             COPY ERCREIN.
   798******************************************************************07/27/93
   799*                                                                *ERCREIN
   800*                            ERCREIN                             *   LV009
   801*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   802*                            VMOD=2.010                          *   CL**9
   803*                                                                *ERCREIN
   804*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   805*                                                                *ERCREIN
   806*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   807*                                                                *ERCREIN
   808*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   809*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   810*                                                                *ERCREIN
   811*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   812*       ALTERNATE PATH = NONE                                    *ERCREIN
   813*                                                                *ERCREIN
   814*   LOG = NO                                                     *ERCREIN
   815*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   816*                                                                *ERCREIN
   817******************************************************************ERCREIN
   818*                   C H A N G E   L O G
   819*
   820* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   821*-----------------------------------------------------------------
   822*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   823* EFFECTIVE    NUMBER
   824*-----------------------------------------------------------------
   825* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   826* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   827******************************************************************
   828 01  REINSURANCE-RECORD.                                          ERCREIN
   829     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   830         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   831                                                                  ERCREIN
   832     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   833         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   834         16  RE-KEY.                                              ERCREIN
   835             20  RE-CODE                   PIC X.                 ERCREIN
   836                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   837                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   838             20  RE-TABLE                  PIC XXX.               ERCREIN
   839             20  FILLER                    PIC XXX.               ERCREIN
   840         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   841             20  FILLER                    PIC X.                 ERCREIN
   842             20  RE-COMPANY.                                      ERCREIN
   843                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   844                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   845                                                                  ERCREIN
   846     12  RE-MAINT-INFORMATION.                                    ERCREIN
   847         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   848         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   849         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   850         16  FILLER                        PIC X(10).             ERCREIN
   851                                                                  ERCREIN
   852     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   853         16  RE-100-COMP                   PIC 99.                ERCREIN
   854                                                                  ERCREIN
   855         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   856             20  RE-REI-COMP-NO.                                  ERCREIN
   857                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   858                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   859             20  RE-LF-QC                  PIC X.                 ERCREIN
   860             20  RE-AH-QC                  PIC X.                 ERCREIN
   861             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   862             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   863             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   864             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   865             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   866             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   867             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   868             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   869             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   870             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   871             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   872             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   873             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   874             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   875             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   876             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   877             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   878             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   879             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   880             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   881             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   882             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   883             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   884             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   886             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   887             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   888             20  RE-REMAINING              PIC X.                 ERCREIN
   889             20  RE-LF-RUNOFF-SW           PIC X.                      000
   890             20  RE-AH-RUNOFF-SW           PIC X.                      000
   891             20  FILLER                    PIC X(19).                  000
   892                                                                  ERCREIN
   893         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   894         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   895         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   896         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   897             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   898                                                                  ERCREIN
   899         16  FILLER                        PIC X(27).             ERCREIN
   900                                                                  ERCREIN
   901     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   902         16  RE-NAME                       PIC X(30).             ERCREIN
   903         16  RE-LF-PE                      PIC X.                 ERCREIN
   904         16  RE-AH-PE                      PIC X.                 ERCREIN
   905         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   906         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   907         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   908         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   909         16  RE-PRT-ST                     PIC X.                 ERCREIN
   910         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   911         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   912         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   913         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   914         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   915         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   916         16  RE-LF-COMM                    PIC X.                 ERCREIN
   917         16  RE-AH-COMM                    PIC X.                 ERCREIN
   918         16  RE-LF-TAX                     PIC X.                 ERCREIN
   919         16  RE-AH-TAX                     PIC X.                 ERCREIN
   920         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   921         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   922         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   923                                                                  ERCREIN
   924         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   925             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   926                                                                  ERCREIN
   927         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   928             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   929                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   930                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   931                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   932                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   933             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   934                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   935                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   936                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   937                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   938                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   939                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   940                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   941                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   942             20  FILLER                    PIC XXX.               ERCREIN
   943             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   944                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   945                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   946                                                                  ERCREIN
   947         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   948             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   949                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   950                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   951                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   952                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   953             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   954                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   955                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   956                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   957                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   958                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   959                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   960                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   961                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   962             20  FILLER                    PIC XXX.               ERCREIN
   963             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   964                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   965                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   966                                                                  ERCREIN
   967         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   968                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   969         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   970                                                                  ERCREIN
   971         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   972         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   973         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   974         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   975         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   976         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   977         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   978         16  RE-MORT-SW                    PIC X.                 ERCREIN
   979         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   980             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   981             88  RE-CEDED                          VALUE 'C'.        CL**2
   982             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   983             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   984                                                                  ERCREIN
   985         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   986             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   987         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   988             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   989         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   990             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   991         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   992             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   993         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   994             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   995                                                                     CL**3
   996         16  RE-PRT-CRSV                   PIC X.                    CL**5
   997                                                                     CL**5
   998         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   999                                                                     CL**8
  1000         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1001                                                                     CL**8
  1002         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1003                                                                     CL**9
  1004         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1005             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1006             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1007
  1008         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1009             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1010                                                                     CL**9
  1011         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1012         16  FILLER                        PIC X(2281).              CL**9
  1013                                                                  ERCREIN
  1014         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1015                                                                  ERCREIN
  1016******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ECS010.cbl
  1018 FD  ERCTBL.
  1019
* 1020                             COPY ERCCTBL.
  1021******************************************************************04/29/98
  1022*                                                                *ERCCTBL
  1023*                                                                *ERCCTBL
  1024*                            ERCCTBL                             *   LV002
  1025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1026*                            VMOD=2.003                              CL**2
  1027*                                                                *ERCCTBL
  1028*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1029*                                                                *ERCCTBL
  1030*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1031*                                                                *ERCCTBL
  1032*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1033*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1034*                                                                *ERCCTBL
  1035*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1036*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1037*                                                                *ERCCTBL
  1038*   LOG = NO                                                     *ERCCTBL
  1039*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1040*                                                                *ERCCTBL
  1041*                                                                *ERCCTBL
  1042******************************************************************ERCCTBL
  1043                                                                  ERCCTBL
  1044 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1045     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1046         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1047                                                                  ERCCTBL
  1048     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1049         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1050         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1051         16  CT-CNTRL-2.                                          ERCCTBL
  1052             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1053             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1054                                                                  ERCCTBL
  1055     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1056         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1057         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1058         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1059         16  FILLER                        PIC X(31).             ERCCTBL
  1060                                                                  ERCCTBL
  1061     12  CT-LIMITS.                                               ERCCTBL
  1062         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1063                                                                  ERCCTBL
  1064         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1065                                                                  ERCCTBL
  1066         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1067                                                                  ERCCTBL
  1068     12  CT-RATES.                                                ERCCTBL
  1069         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1070             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1071             20  CT-RT-R   REDEFINES                              ERCCTBL
  1072                 CT-RT                     PIC XXX.               ERCCTBL
  1073                                                                  ERCCTBL
  1074     12  FILLER                            PIC  X(42).            ERCCTBL
  1075                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ECS010.cbl
  1076******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ECS010.cbl
  1078 FD  ERMEBL-INOUT.
  1079
* 1080                             COPY ERCMEBL.
  1081******************************************************************04/29/98
  1082*                                                                 ERCMEBL
  1083*                                                                 ERCMEBL
  1084*                            ERCMEBL                             *   LV004
  1085*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1086*                            VMOD 2.004                          *   CL**2
  1087*                                                                *ERCMEBL
  1088*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1089*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1090*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1091*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1092*                                                                *ERCMEBL
  1093*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1094*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1095*                                                                *ERCMEBL
  1096*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1097*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1098*                                                                *ERCMEBL
  1099******************************************************************ERCMEBL
  1100                                                                  ERCMEBL
  1101 01  MONTH-END-BALANCES.                                          ERCMEBL
  1102     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1103     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1104         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1105         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1106     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1107     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1108     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1109     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1110     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1111     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1112     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1113     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1117     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1118     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1119     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1120     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1121     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1122     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1123     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1124     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1125     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1126     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1127     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1128     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1129     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1130     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1131     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1132     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1133     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1134     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1135     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1136     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1137     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1138     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1139     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1140     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1141     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1142     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1143     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1144     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1145     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1146     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1147     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1148     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1149     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1150     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1151     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1152     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1153     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1154     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1155     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1156     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1157     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1158     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1159     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1160     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1161     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1162     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1163     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1164     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1165     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1166     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1167     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1168     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1169     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1170     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1171     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1172     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1173     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1174     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1175     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1176     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1177     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1178     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1179     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1180     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1181     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1182     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1183     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1184     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1185     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1186     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1187     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1188     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1189     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1190     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1191     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1192     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1193     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1194     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1195     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1196     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1197     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1198     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1199     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1200     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1201     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1202     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1203     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1204     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1205     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1206     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1207     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1208     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1209     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1210     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1211     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1212     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1213     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1214     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1215     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1216     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1217     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1218     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1219     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1220     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1221     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1222     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1223     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1224     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1225     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1226     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1227     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1235     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1236     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1237     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1238     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1239     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1240     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1241     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1242     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1243     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1244     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1245     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1246     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1247     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1248     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1249     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1250     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1251     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1252     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1253     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1254     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1255     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1256     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1257     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1258     12  FILLER                  PIC  X(88).                         CL**2
  1259******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ECS010.cbl
  1261 FD  CERT-MASTER-OUT
* 1262                             COPY ECSCROFD.
  1263******************************************************************07/10/97
  1264*                                                                *ECSCROFD
  1265*                            ECSCROFD                            *   LV001
  1266*                            VMOD=2.002                          *ECSCROFD
  1267*                                                                *ECSCROFD
  1268*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1269*                                                                *ECSCROFD
  1270******************************************************************ECSCROFD
  1271     RECORDING MODE F                                             ECSCROFD
  1272     LABEL RECORDS STANDARD                                       ECSCROFD
  1273     BLOCK CONTAINS 0 RECORDS
  1274     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1275 01  CERT-OUT-RECORD.                                             ECSCROFD
  1276     12  FILLER                            PIC  XXX.              ECSCROFD
  1277     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1278     12  FILLER                            PIC  X(1017).          ECSCROFD
  1279                                                                  ECSCROFD
  1280******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ECS010.cbl
  1282 FD  DETAIL-EXTR
  1283     BLOCK CONTAINS 0 RECORDS
  1284     RECORDING MODE F.
  1285
* 1286                             COPY ECSEXT01.
  1287******************************************************************04/29/98
  1288*                                                                *ECSEXT01
  1289*                            ECSEXT01                            *   LV015
  1290*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1291*                            VMOD=2.015                          *ECSEXT01
  1292*                                                                *ECSEXT01
  1293*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1294*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1295*                                                                *ECSEXT01
  1296*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1297*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1298*                                                                *ECSEXT01
  1299*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1300*                                                                *ECSEXT01
  1301******************************************************************ECSEXT01
  1302******************************************************************
  1303*                   C H A N G E   L O G
  1304*
  1305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1306*-----------------------------------------------------------------
  1307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1308* EFFECTIVE    NUMBER
  1309*-----------------------------------------------------------------
  1310* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1311* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1312* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1313* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1314* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1315* 032612  CR2011110200001  PEMA  AHL CHANGES
  1316******************************************************************
  1317                                                                  ECSEXT01
  1318 01  DETAIL-EXTRACT.                                              ECSEXT01
  1319     02 DETAIL-FILE.                                              ECSEXT01
  1320     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1321         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1322                                                                  ECSEXT01
  1323     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1324                                                                  ECSEXT01
  1325     12  DE-REIN                           PIC X.                 ECSEXT01
  1326                                                                  ECSEXT01
  1327     12  DE-CONTROL.                                              ECSEXT01
  1328         16  DE-CNTRL1.                                           ECSEXT01
  1329             20  DE-CARRIER                PIC X.                 ECSEXT01
  1330             20  DE-GROUPING.                                     ECSEXT01
  1331                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1332                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1333             20  DE-STATE                  PIC XX.                ECSEXT01
  1334             20  DE-ACCOUNT.                                      ECSEXT01
  1335                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1336                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1337         16  DE-CNTRL2.                                           ECSEXT01
  1338             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1339             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1340                 24 DE-CERT-NO.                                   ECSEXT01
  1341                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1342                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1343                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1344                                                                  ECSEXT01
  1345     12  DE-TRANS                          PIC X.                 ECSEXT01
  1346         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1347         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1348         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1349         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1350         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1351         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1352         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1353         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1354         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1355         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1356                                                                  ECSEXT01
  1357     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1358     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1359                                                                  ECSEXT01
  1360     12  DE-NAME.                                                 ECSEXT01
  1361         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1362         16  DE-FNAME.                                            ECSEXT01
  1363             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1364             20  FILLER                    PIC X(9).              ECSEXT01
  1365         16  DE-INIT                       PIC X.                 ECSEXT01
  1366     12  DE-AGE                            PIC 99.                ECSEXT01
  1367     12  DE-SEX                            PIC X.                 ECSEXT01
  1368     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1369                                                                  ECSEXT01
  1370     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1371     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1372     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1373     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1374     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1375     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1376     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1377     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1378     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1379                                                                  ECSEXT01
  1380     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1381     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1382     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1383     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1384                                                                  ECSEXT01
  1385     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1386     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1387     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1388     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1389     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1390                                                                  ECSEXT01
  1391     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1392     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1393     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1394     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1395                                                                  ECSEXT01
  1396     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1397     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1398                                           PIC S9(5)V99   COMP-3.
  1399     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1400     12  FILLER REDEFINES DE-NUM-BILLED.
  1401         16  DE-CLP-STATE                  PIC XX.
  1402         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1403     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1404     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1405                                                                  ECSEXT01
  1406     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1407     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1408     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1409     12  DE-IG                             PIC X.                 ECSEXT01
  1410     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1411*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1412     12  DE-MEMBER-NO.                                            ECSEXT01
  1413         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1414         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1415         16  FILLER                        PIC X(03).             ECSEXT01
  1416     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1417                                                                  ECSEXT01
  1418     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1419         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1420                                                                  ECSEXT01
  1421     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1422     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1423                                                                  ECSEXT01
  1424     12  DE-REI-AREA.                                             ECSEXT01
  1425         16  DE-REI-COMP.                                         ECSEXT01
  1426             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1427             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1428         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1429         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1430         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1431         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1432         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1433         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1434         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1435                                                                  ECSEXT01
  1436     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1437     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1438         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1439         16  F                             PIC X.
  1440*    12  FILLER                            PIC X(5).              ECSEXT01
  1441                                                                  ECSEXT01
  1442     12  DE-BILLED-AREA.                                          ECSEXT01
  1443         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1444             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1445                                                                  ECSEXT01
  1446         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1447             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1448             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1449             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1450             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1451             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1452             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1453                                                                  ECSEXT01
  1454         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1455             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1456                                                                  ECSEXT01
  1457         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1458         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1459         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1460         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1461                                                                  ECSEXT01
  1462         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1463*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1464*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1465                                                                  ECSEXT01
  1466     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1467         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1468         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1469         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1470                                                                  ECSEXT01
  1471     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1472         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1473         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1474     12  DE-CANCEL-REASON                  PIC X.
  1475                                                                  ECSEXT01
  1476     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1477     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1478                                                                  ECSEXT01
  1479     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1480         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1481             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1482         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1483             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1484                                                                  ECSEXT01
  1485     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1486         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1487                                                                  ECSEXT01
  1488     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1489     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1490         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1491         16  FILLER                        PIC X.
  1492                                                                  ECSEXT01
  1493****************************************************************  ECSEXT01
  1494**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1495****************************************************************  ECSEXT01
  1496     12  DE-COMM-LEVELS.                                          ECSEXT01
  1497         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1498             20  DE-AGT.                                          ECSEXT01
  1499                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1500                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1501             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1502             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1503             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1504                                                                  ECSEXT01
  1505     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1506****************************************************************  ECSEXT01
  1507*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1508****************************************************************  ECSEXT01
  1509     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1510     12  FILLER                            PIC X(334).            ECSEXT01
  1511     12  DE-TYPE                           PIC X.                 ECSEXT01
  1512         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1513         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1514         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1515         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1516         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1517         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1518                                                                  ECSEXT01
  1519     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1520     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1521                                                                  ECSEXT01
  1522     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1523     12  DE-REPORTED.                                             ECSEXT01
  1524         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1525         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1526         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1527     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1528     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1529                                                                  ECSEXT01
  1530     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1531     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1532     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1533     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1534     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1535     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1536         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1537         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1538         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1539         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1540         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1541         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1542         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1543                                                                  ECSEXT01
  1544     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1545                                                                  ECSEXT01
  1546     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1547     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1548     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1549     12  FILLER                            PIC XX.                ECSEXT01
  1550     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1551                                                                  ECSEXT01
  1552     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1553     12  DE-BENEFICIARY                    PIC X(10).
  1554     12  filler redefines de-beneficiary.
  1555         16  de-birth-date                 pic 9(11)  comp-3.
  1556         16  f                             pic x(4).
  1557     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1558     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1559     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1560     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1561     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1562     12  DE-CLM-CLASS                      PIC XX.
  1563     12  DE-CLM-DEV                        PIC XXX.
  1564     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1565     12  de-xycor-cert-seq                 pic x(3).
  1566     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1567     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1568     12  DE-XYCOR-STATUS                   PIC X.
  1569     12  FILLER                            PIC X(4).              ECSEXT01
  1570                                                                  ECSEXT01
  1571     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1572                                                                  ECSEXT01
  1573****************************************************************  ECSEXT01
  1574*******               RESERVE EXTRACT                      *****  ECSEXT01
  1575****************************************************************  ECSEXT01
  1576     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1577     12  FILLER                            PIC X(334).            ECSEXT01
  1578                                                                  ECSEXT01
  1579     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1580         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1581         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1582                                                                  ECSEXT01
  1583     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1584     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1585     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1586                                                                  ECSEXT01
  1587     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1588                                                                  ECSEXT01
  1589     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1590     12  DE-RSV-REPORTED.                                         ECSEXT01
  1591         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1592         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1593         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1594     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1595                                                                  ECSEXT01
  1596     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1597     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1598     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1599                                                                  ECSEXT01
  1600     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1601     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1602     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1603                                                                  ECSEXT01
  1604     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1605                                                                  ECSEXT01
  1606     12  DE-RATE-CLASS                     PIC XX.
  1607     12  DE-DEV-CODE                       PIC XXX.
  1608     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1609     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1610     12  FILLER                            PIC X(58).             ECSEXT01
  1611                                                                  ECSEXT01
  1612     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1613******************************************************************ECSEXT01
  1614
  1615 FD  NEW-DETAIL-EXTR
  1616     BLOCK CONTAINS 0 RECORDS
  1617     RECORDING MODE F.
  1618
* 1619                                 COPY ECSEXX01.
  1620******************************************************************
  1621*                                                                *
  1622*                            ECSEXX01                            *
  1623*                            VMOD=2.015                          *
  1624*                                                                *
  1625*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1626*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1627*                                                                *
  1628*   FILE TYPE = SEQUENTIAL                                       *
  1629*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1630*                                                                *
  1631*   KEY DATA =                                   START=5, LEN=36 *
  1632*                                                                *
  1633******************************************************************
  1634******************************************************************
  1635*                   C H A N G E   L O G
  1636*
  1637* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1638*-----------------------------------------------------------------
  1639*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1640* EFFECTIVE    NUMBER
  1641*-----------------------------------------------------------------
  1642*                                    TEMPORARY
  1643******************************************************************
  1644
  1645 01  NEW-DETAIL-EXTRACT.
  1646     02 NEW-DETAIL-FILE.
  1647     12  DX-RECORD-ID                      PIC XX.
  1648         88  VALID-DX-ID                      VALUE 'DX'.
  1649
  1650     12  DX-COMPANY-CD                     PIC X.
  1651
  1652     12  DX-REIN                           PIC X.
  1653
  1654     12  DX-CONTROL.
  1655         16  DX-CNTRL1.
  1656             20  DX-CARRIER                PIC X.
  1657             20  DX-GROUPING.
  1658                 24  DX-GROUP-PREFIX       PIC XXX.
  1659                 24  DX-GROUP-PRIME        PIC XXX.
  1660             20  DX-STATE                  PIC XX.
  1661             20  DX-ACCOUNT.
  1662                 24  DX-ACCT-PREFIX        PIC X(4).
  1663                 24  DX-ACCT-PRIME         PIC X(6).
  1664         16  DX-CNTRL2.
  1665             20  DX-EFF                    PIC 9(11)  COMP-3.
  1666             20  DX-CERT.
  1667                 24 DX-CERT-NO.
  1668                     28  DX-CRT-PREFIX     PIC XXX.
  1669                     28  DX-CRT-PRIME      PIC X(7).
  1670                 24  DX-CRT-SUF            PIC X.
  1671
  1672     12  DX-TRANS                          PIC X.
  1673         88  DX-ISSUE                         VALUE 'I'.
  1674         88  DX-RC-ISSUE                      VALUE '8'.
  1675         88  DX-CANCEL                        VALUE 'C'.
  1676         88  DX-RC-CANCEL                     VALUE '7'.
  1677         88  DX-CLAIM                         VALUE 'X'.
  1678         88  DX-RESTORE                       VALUE 'R'.
  1679         88  DX-RESERVE                       VALUE 'Y'.
  1680         88  DX-RR-RC-ISS                     VALUE 'J'.
  1681         88  DX-RR-RC-CNC                     VALUE 'K'.
  1682         88  DX-RR-RC-CLM                     VALUE 'L'.
  1683
  1684     12  DX-REPORT-CODX-1                  PIC X(10).
  1685     12  DX-REPORT-CODX-2                  PIC X(10).
  1686
  1687     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1688         16  DX-LNAME                      PIC X(15).
  1689         16  DX-FNAME.
  1690             20  DX-1ST-INIT-FNAME         PIC X.
  1691             20  FILLER                    PIC X(9).
  1692         16  DX-INIT                       PIC X.
  1693     12  DX-AGE                            PIC 99.
  1694     12  DX-SEX                            PIC X.
  1695     12  DX-SOC-SEC-NO                     PIC X(11).
  1696
  1697     12  DX-LF-TYPE                        PIC XX.
  1698     12  DX-LF-TERM                        PIC 999        COMP-3.
  1699     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1700     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1701     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1702     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1703     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1704     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1705     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1706
  1707     12  DX-LF-STAT-CDE                    PIC X.
  1708     12  DX-LF-PREV-STAT                   PIC X.
  1709     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1710     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1711
  1712     12  DX-AH-TYPE                        PIC XX.
  1713     12  DX-AH-TERM                        PIC 999        COMP-3.
  1714     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1715     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1716     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1717
  1718     12  DX-AH-STAT-CDE                    PIC X.
  1719     12  DX-AH-PREV-STAT                   PIC X.
  1720     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1721     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1722
  1723     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1724     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1725                                           PIC S9(5)V99   COMP-3.
  1726     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1727     12  FILLER REDEFINES DX-NUM-BILLED.
  1728         16  DX-CLP-STATE                  PIC XX.
  1729         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1730     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1731     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1732
  1733     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1734     12  DX-PMT-FREQ                       PIC 99.
  1735     12  DX-ACC-GPCD                       PIC XX.
  1736     12  DX-IG                             PIC X.
  1737     12  DX-REMIT-TO                       PIC XX.
  1738*    12  DX-MEMBER-NO                      PIC X(12).
  1739     12  DX-MEMBER-NO.
  1740         16  DX-MASTER-POLICY              PIC X(06).
  1741         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1742         16  FILLER                        PIC X(03).
  1743     12  DX-LN-OFFICER                     PIC XXX.
  1744
  1745     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1746         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1747
  1748     12  DX-ENTRY-STATUS                   PIC X.
  1749     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1750
  1751     12  DX-REI-AREA.
  1752         16  DX-REI-COMP.
  1753             20  DX-REINCO                 PIC XXX.
  1754             20  DX-REINCO-SUB             PIC XXX.
  1755         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1756         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1757         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1758         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1759         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1760         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1761         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1762
  1763     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1764     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1765         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1766         16  F                             PIC X.
  1767*    12  FILLER                            PIC X(5).
  1768
  1769     12  DX-BILLED-AREA.
  1770         16  DX-GL-INTERFACE-CODES.
  1771             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1772
  1773         16  DX-BILL-SW                    PIC X.
  1774             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1775             88  DX-RECORD-RETURNED           VALUE 'R'.
  1776             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1777             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1778             88  DX-OVERRIDX-AH               VALUE 'A'.
  1779             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1780
  1781         16  DX-REFUND-SW                  PIC X.
  1782             88  DX-REFUND-CREATED            VALUE 'Y'.
  1783
  1784         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1785         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1786         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1787         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1788
  1789         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1790*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1791*            88  DX-BILLED-GA                 VALUE 'B'.
  1792
  1793     12  DX-BILL-STATUS                    PIC X.
  1794         88  DX-NO-PRE-BILL                   VALUE ' '.
  1795         88  DX-BILLED                        VALUE 'B'.
  1796         88  DX-REVERSE                       VALUE 'R'.
  1797
  1798     12  DX-REVERSE-REASONS.
  1799         16  DX-REVERSE-REASON-1           PIC X.
  1800         16  DX-REVERSE-REASON-2           PIC X.
  1801     12  DX-CANCEL-REASON                  PIC X.
  1802
  1803     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1804     12  DX-RECALC-TYPE                    PIC X.
  1805
  1806     12  DX-CHARGEBACK-CODES.
  1807         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1808             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1809         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1810             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1811
  1812     12  DX-UNDERWRITING-CODE              PIC X.
  1813         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1814
  1815     12  DX-NCL-POOL-CODE                  PIC XXX.
  1816     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1817         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1818         16  FILLER                        PIC X.
  1819
  1820****************************************************************
  1821**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1822****************************************************************
  1823     12  DX-COMM-LEVELS.
  1824         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1825             20  DX-AGT.
  1826                 24  DX-AGT-PREFIX         PIC X(4).
  1827                 24  DX-AGT-PRIME          PIC X(6).
  1828             20  DX-AGT-TYPE               PIC X.
  1829             20  DX-L-PC                   PIC S999V99    COMP-3.
  1830             20  DX-A-PC                   PIC S999V99    COMP-3.
  1831
  1832     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1833****************************************************************
  1834*******                 CLAIM EXTRACT                      *****
  1835****************************************************************
  1836     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1837     12  FILLER                            PIC X(334).
  1838     12  DX-TYPE                           PIC X.
  1839         88  DX-DTH                           VALUE '1'.
  1840         88  DX-AH                            VALUE '2'.
  1841         88  DX-OB-DTH                        VALUE '3'.
  1842         88  DX-OB-AH                         VALUE '4'.
  1843         88  DX-DEATH                         VALUES '1' '3'.
  1844         88  DX-DISABILITY                    VALUES '2' '4'.
  1845
  1846     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1847     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1848
  1849     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1850     12  DX-REPORTED.
  1851         16  DX-RPT-YR                     PIC 99.
  1852         16  DX-RPT-MO                     PIC 99.
  1853         16  DX-RPT-DA                     PIC 99.
  1854     12  DX-PAY                            PIC 9(11)      COMP-3.
  1855     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1856
  1857     12  DX-CNUM                           PIC X(7).
  1858     12  DX-CHECK                          PIC X(7).
  1859     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1860     12  DX-DAYS-DISAB                     PIC 999.
  1861     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1862     12  DX-PAY-CODE                       PIC X.
  1863         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1864         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1865         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1866         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1867         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1868         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1869         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1870
  1871     12  DX-CLM-ERR                        PIC XX.
  1872
  1873     12  DX-ACC-NAME                       PIC X(30).
  1874     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1875     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1876     12  FILLER                            PIC XX.
  1877     12  DX-LOAN-OFFICER                   PIC XXX.
  1878
  1879     12  DX-LOAN-TYPE                      PIC X(02).
  1880     12  DX-BENEFICIARY                    PIC X(10).
  1881     12  filler redefines DX-beneficiary.
  1882         16  DX-birth-date                 pic 9(11)  comp-3.
  1883         16  f                             pic x(4).
  1884     12  DX-LOAN-CLASS                     PIC X(02).
  1885     12  DX-LOSS-CODE                      PIC X(06).
  1886     12  DX-ASSOCIATES                     PIC X(01).
  1887     12  DX-LEGAL-STATE                    PIC X(02).
  1888     12  DX-CLM-CAUSE                      PIC X(6).
  1889     12  DX-CLM-CLASS                      PIC XX.
  1890     12  DX-CLM-DEV                        PIC XXX.
  1891     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1892     12  DX-xycor-cert-seq                 pic x(3).
  1893     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1894     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1895     12  DX-XYCOR-STATUS                   PIC X.
  1896     12  FILLER                            PIC X(4).
  1897
  1898     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1899
  1900****************************************************************
  1901*******               RESERVE EXTRACT                      *****
  1902****************************************************************
  1903     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1904     12  FILLER                            PIC X(334).
  1905
  1906     12  DX-RESERVE-TYPE                   PIC X.
  1907         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1908         88  DX-AH-RSV                        VALUE '2' '4'.
  1909
  1910     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1911     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1912     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1913
  1914     12  DX-CLMNO                          PIC X(7).
  1915
  1916     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1917     12  DX-RSV-REPORTED.
  1918         16  DX-RSV-RPT-YR                 PIC 99.
  1919         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1920         16  DX-RSV-RPT-DA                 PIC 99.
  1921     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1922
  1923     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1924     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1925     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1926
  1927     12  DX-RSV-ACC-NAME                   PIC X(30).
  1928     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1929     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1930
  1931     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1932
  1933     12  DX-RATE-CLASS                     PIC XX.
  1934     12  DX-DEV-CODE                       PIC XXX.
  1935     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1936     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1937     12  FILLER                            PIC X(58).
  1938
  1939     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1940******************************************************************
  1941
  1942 FD  SUMMARY-EXTR
  1943     BLOCK CONTAINS 0 RECORDS
  1944     RECORDING MODE F.
  1945
* 1946                             COPY ECSEPC01.
  1947******************************************************************
  1948*                                                                *
  1949*                            ECSEPC01                            *
  1950*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1951*                            VMOD=2.008                          *
  1952*                                                                *
  1953*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1954*                                                                *
  1955*   FILE TYPE = SEQUENTIAL                                       *
  1956*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1957*                                                                *
  1958*   KEY DATA =                                  START=5, LEN=31  *
  1959*                                                                *
  1960*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1961*                                                                *
  1962******************************************************************
  1963
  1964 01  EP-RECORD.
  1965     02 EP-FILE.
  1966     12  EP-RECORD-ID                      PIC XX.
  1967         88  VALID-EP-ID                      VALUE 'EP'.
  1968
  1969     12  EP-COMPANY-CD                     PIC X.
  1970
  1971     12  EP-REIN                           PIC X.
  1972         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1973
  1974     12  EP-CONTROL.
  1975         16  EP-CNTRL-1.
  1976             20  EP-COMPANY.
  1977                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1978                 24  EP-GROUPING.
  1979                     28  EP-GROUP-PREFIX   PIC XXX.
  1980                     28  EP-GROUP-PRIME    PIC XXX.
  1981             20  EP-STATE                  PIC XX.
  1982             20  EP-ACCOUNT.
  1983                 24  EP-ACCT-PREFIX        PIC X(4).
  1984                 24  EP-ACCT-PRIME         PIC X(6).
  1985         16  EP-CNTRL-2.
  1986             20  EP-DATES.
  1987                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1988                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1989
  1990     12  EP-REI-CO.
  1991         16  EP-REINCO                     PIC XXX.
  1992         16  EP-REINCO-SUB                 PIC XXX.
  1993
  1994     12  EP-RCD-TYPE                       PIC X.
  1995         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1996         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1997         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1998         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1999         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2000         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2001     12  EP-BEN-CODE                       PIC XX.
  2002     12  FILLER                            PIC X.
  2003
  2004     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2005     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2006     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2007
  2008     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2009     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2010     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2011
  2012     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2013     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2014     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2015     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2016
  2017     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2018     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2019     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2020
  2021     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2022     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2023     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2024
  2025     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2026     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2027     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2028     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2029     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2030
  2031     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2032     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2033     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2034
  2035     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2036     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2037     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2038
  2039     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2040         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2041         16  EP-NEW-DATA-IND               PIC X(01).
  2042             88  EP-NEW-DATA                   VALUE 'Y'.
  2043         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2044         16  FILLER                        PIC X(19).
  2045
  2046     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2047     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2048     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2049
  2050     12  FILLER                            PIC XXX.
  2051
  2052     12  EP-UNDERWRITING-CODE              PIC X.
  2053         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2054
  2055     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
  2056
  2057     12  FILLER                            PIC X(30).
  2058*    12  FILLER                            PIC X(34).
  2059
  2060     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2061     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2062     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2063     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2064     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2065     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2066
  2067     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2068
  2069     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2070     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2071
  2072     12  EP-PURGE                          PIC X.
  2073         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2074
  2075     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2076
  2077     02 EC-RECORD     REDEFINES     EP-FILE.
  2078     12  EC-RECORD-ID                      PIC XX.
  2079         88  VALID-EC-ID                      VALUE 'EC'.
  2080
  2081     12  EC-COMPANY-CD                     PIC X.
  2082
  2083     12  EC-REIN                           PIC X.
  2084         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2085
  2086     12  EC-CONTROL.
  2087         16  EC-CARRIER                    PIC X.
  2088         16  EC-GROUPING.
  2089             20  EC-GROUP-PREFIX           PIC XXX.
  2090             20  EC-GROUP-PRIME            PIC XXX.
  2091         16  EC-STATE                      PIC XX.
  2092         16  EC-ACCOUNT.
  2093             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2094             20  EC-ACCT-PRIME             PIC X(6).
  2095         16  EC-DATES.
  2096             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2097             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2098
  2099     12  EC-REI-CO.
  2100         16  EC-REINCO                     PIC XXX.
  2101         16  EC-REINCO-SUB                 PIC XXX.
  2102
  2103     12  EC-RCD-TYPE                       PIC X.
  2104         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2105         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2106         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2107         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2108         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2109     12  EC-BEN-CODE                       PIC XX.
  2110     12  EC-SEQ-NBR                        PIC X.
  2111         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2112         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2113
  2114     12  EC-AGENTS-DATA.
  2115         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2116             20  EC-AGT-NO.
  2117                 24  EC-AGT-PREFIX         PIC X(4).
  2118                 24  EC-AGT-PRIME          PIC X(6).
  2119             20  EC-AGT-TYPE               PIC X.
  2120             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2121             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2122             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2123             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2124             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2125
  2126     12  EC-UNDERWRITING-CODE              PIC X.
  2127         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2128
  2129     12  EC-AGENTS-DATA-II.
  2130         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2131             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2132             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2133
  2134     12  FILLER                            PIC X(7).
  2135
  2136     12  EC-PURGE                          PIC X.
  2137         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2138
  2139     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2140
  2141******************************************************************
  2142
  2143 FD  ERRESC-IN.
* 2144                             COPY ERCRESC.
  2145******************************************************************04/29/98
  2146*                                                                *ERCRESC
  2147*                            ERCRESC                             *   LV002
  2148*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2149*                            VMOD=2.003                          *   CL**2
  2150*                                                                *ERCRESC
  2151*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2152*                                                                *ERCRESC
  2153*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2154*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2155*                                                                *ERCRESC
  2156*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2157*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2158*                                                                *ERCRESC
  2159*   LOG = NO                                                     *ERCRESC
  2160*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2161*                                                                *ERCRESC
  2162******************************************************************ERCRESC
  2163                                                                  ERCRESC
  2164 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2165                                                                  ERCRESC
  2166     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2167         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2168         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2169         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2170         15  RESC-STATE                PIC   XX.                  ERCRESC
  2171         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2172         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2173         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2174         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2175*                                           YYYYMMDD              ERCRESC
  2176     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2177                                                                  ERCRESC
  2178     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2179         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2180             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2181             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2182             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2183                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2184                                                                  ERCRESC
  2185     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2186     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2187     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2188*                                          YYYYMMDD               ERCRESC
  2189 FD  ELCRTT.
  2190
* 2191                             COPY ELCCRTT.
  2192******************************************************************
  2193*                                                                *ELCCRTT
  2194*                            ELCCRTT.                            *
  2195*                                                                *ELCCRTT
  2196*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2197*                                                                *ELCCRTT
  2198*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2199*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2200*                                                                *ELCCRTT
  2201*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2202*                                                                *ELCCRTT
  2203*   LOG = YES                                                    *ELCCRTT
  2204*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2205******************************************************************
  2206*                   C H A N G E   L O G
  2207*
  2208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2209*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2211* EFFECTIVE    NUMBER
  2212*-----------------------------------------------------------------
  2213* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2214* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2215* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2216******************************************************************
  2217                                                                  ELCCRTT
  2218 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2219     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2220         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2221                                                                  ELCCRTT
  2222     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2223         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2224         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2225         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2226         16  CS-STATE                      PIC XX.                ELCCRTT
  2227         16  CS-ACCOUNT                    PIC X(10).
  2228         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2229         16  CS-CERT-NO.                                          ELCCRTT
  2230             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2231             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2232         16  CS-TRAILER-TYPE               PIC X.
  2233             88  COMM-TRLR           VALUE 'A'.
  2234             88  FUTURE-TRLR         VALUE 'B'.
  2235             88  CERT-DATA-TRLR      VALUE 'C'.
  2236                                                                  ELCCRTT
  2237     12  CS-DATA-AREA                      PIC X(516).
  2238
  2239     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2240         16  CS-BANK-COMMISSION-AREA.
  2241             20  CS-BANK-COMMS       OCCURS 10.
  2242                 24  CS-AGT                PIC X(10).
  2243                 24  CS-COM-TYP            PIC X.
  2244                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2245                 24  CS-RECALC-LV-INDIC    PIC X.
  2246                 24  FILLER                PIC X(10).
  2247
  2248         16  FILLER                        PIC X(256).
  2249
  2250     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2251         16  CS-VIN-NUMBER                 PIC X(17).
  2252         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2253         16  FILLER                        PIC X(498).
  2254
  2255******************************************************************ELCCRTT
  2256
  2257 FD  ERAGTC.
  2258
* 2259                             COPY ERCAGTC.
  2260******************************************************************
  2261*                                                                *
  2262*                                                                *
  2263*                            ERCAGTC                             *
  2264*                            VMOD=2.001                          *
  2265*                                                                *
  2266*   ONLINE CREDIT SYSTEM                                         *
  2267*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2268*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2269*                                                                *
  2270*   FILE TYPE = VSAM,KSDS                                        *
  2271*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2272*                                                                *
  2273*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2274*       ALTERNATE PATH = NONE                                    *
  2275*                                                                *
  2276*   LOG = NO                                                     *
  2277*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2278*                                                                *
  2279******************************************************************
  2280*                   C H A N G E   L O G
  2281*
  2282* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2283*-----------------------------------------------------------------
  2284*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2285* EFFECTIVE    NUMBER
  2286*-----------------------------------------------------------------
  2287* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2288* 111004                         NEW FILE AND COPYBOOK
  2289* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2290******************************************************************
  2291
  2292 01  AGENT-COMMISSIONS.
  2293     12  AG-RECORD-ID                          PIC XX.
  2294         88  VALID-CO-ID                          VALUE 'AG'.
  2295
  2296     12  AG-CONTROL-PRIMARY.
  2297         16  AG-COMPANY-CD                     PIC X.
  2298         16  AG-CONTROL.
  2299             20  AG-CTL-1.
  2300                 24  AG-CARR-GROUP.
  2301                     28  AG-CARRIER            PIC X.
  2302                     28  AG-GROUPING           PIC X(6).
  2303                 24  AG-BANK                   PIC X(10).
  2304             20  AG-CTL-2.
  2305                 24  AG-EXP-DT                 PIC XX.
  2306         16  AG-TYPE                           PIC X.
  2307             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2308             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2309
  2310     12  AG-MAINT-INFORMATION.
  2311         16  AG-LAST-MAINT-DT                  PIC XX.
  2312         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2313         16  AG-LAST-MAINT-USER                PIC X(4).
  2314         16  FILLER                            PIC X(10).
  2315
  2316     12  AG-EFF-DT                             PIC XX.
  2317     12  AG-COMM-STRUCTURE.
  2318         16  AG-AGT-COMMS OCCURS 10.
  2319             20  AG-AGT                PIC X(10).
  2320             20  AG-COM-TYP            PIC X.
  2321             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2322             20  AG-RECALC-LV-INDIC    PIC X.
  2323             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2324             20  AG-LRCALC-LV-INDIC    PIC X.
  2325             20  FILLER                PIC X(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2326
  2327     12  FILLER                  PIC X(145).
  2328******************************************************************
  2329
  2330 FD  ERPDEF.
  2331
* 2332                             COPY ERCPDEF.
  2333******************************************************************
  2334*                                                                *
  2335*                                                                *
  2336*                            ERCPDEF.                            *
  2337*                                                                *
  2338*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2339*                                                                *
  2340*    FILE TYPE = VSAM,KSDS                                       *
  2341*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2342*                                                                *
  2343*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2344*                                                                *
  2345*    LOG = YES                                                   *
  2346*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2347******************************************************************
  2348 01  PRODUCT-MASTER.
  2349    12  PD-RECORD-ID                 PIC X(02).
  2350        88  VALID-PD-ID                  VALUE 'PD'.
  2351
  2352    12  PD-CONTROL-PRIMARY.
  2353        16  PD-COMPANY-CD            PIC X.
  2354        16  PD-STATE                 PIC XX.
  2355        16  PD-PRODUCT-CD            PIC XXX.
  2356        16  PD-FILLER                PIC X(7).
  2357        16  PD-BEN-TYPE              PIC X.
  2358        16  PD-BEN-CODE              PIC XX.
  2359        16  PD-PROD-EXP-DT           PIC XX.
  2360
  2361    12  FILLER                       PIC X(50).
  2362
  2363    12  PD-PRODUCT-DATA OCCURS 8.
  2364        16  PD-PROD-CODE             PIC X.
  2365            88  PD-PROD-LIFE           VALUE 'L'.
  2366            88  PD-PROD-PROP           VALUE 'P'.
  2367            88  PD-PROD-AH             VALUE 'A'.
  2368            88  PD-PROD-IU             VALUE 'I'.
  2369            88  PD-PROD-GAP            VALUE 'G'.
  2370        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2371        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2372        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2373        16  PD-MAX-TERM              PIC S999        COMP-3.
  2374        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2375        16  FILLER                   PIC X.
  2376        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2377        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2378        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2379        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2380        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2381        16  PD-REC-CRIT-PERIOD       PIC X.
  2382        16  PD-RTW-MOS               PIC 99.
  2383        16  FILLER                   PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  2384
  2385    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2386
  2387    12  PD-TERM-LIMITS OCCURS 15.
  2388        16  PD-LOW-TERM              PIC S999        COMP-3.
  2389        16  PD-HI-TERM               PIC S999        COMP-3.
  2390
  2391*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2392    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2393        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2394        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2395
  2396    12  PD-EARN-FACTORS.
  2397        16  FILLER OCCURS 15.
  2398            20  FILLER OCCURS 15.
  2399                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2400
  2401    12  PD-PRODUCT-DESC              PIC X(80).
  2402    12  PD-TRUNCATED                 PIC X.
  2403    12  FILLER                       PIC X(59).
  2404
  2405    12  PD-MAINT-INFORMATION.
  2406        16  PD-LAST-MAINT-DT         PIC X(02).
  2407        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2408        16  PD-LAST-MAINT-BY         PIC X(04).
  2409
  2410 FD  ME-ECS010-BALANCE
  2411     RECORDING MODE IS F
  2412     BLOCK CONTAINS 0 RECORDS.
  2413 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2414
  2415 FD  ME50-ECS010-BALANCE
  2416     RECORDING MODE IS F
  2417     BLOCK CONTAINS 0 RECORDS.
  2418 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2419
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ECS010.cbl
  2421 FD  DISK-DATE
* 2422                             COPY ELCDTEFD.
  2423******************************************************************04/15/98
  2424*                                                                *ELCDTEFD
  2425*                                                                *ELCDTEFD
  2426*                            ELCDTEFD.                           *   LV002
  2427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2428*                            VMOD=2.007                          *   CL**2
  2429*                                                                *ELCDTEFD
  2430******************************************************************ELCDTEFD
  2431     BLOCK CONTAINS 0 RECORDS
  2432     RECORDING MODE F.                                            ELCDTEFD
  2433                                                                  ELCDTEFD
  2434 01  DATE-DISK.                                                   ELCDTEFD
  2435     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2436     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2437     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2438     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2439     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2440     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2441     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2442                                                                  ELCDTEFD
  2443 01  DATE-DISK-R.                                                 ELCDTEFD
  2444     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2445     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2446                                     PIC  X(32).                  ELCDTEFD
  2447                                                                  ELCDTEFD
  2448 01  DATE-DISK-T.                                                 ELCDTEFD
  2449     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2450     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2451                                     PIC  X(48).                  ELCDTEFD
  2452                                                                  ELCDTEFD
  2453 01  DATE-DISK-M.                                                 ELCDTEFD
  2454     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2455     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2456                                     PIC  X(48).                  ELCDTEFD
  2457                                                                  ELCDTEFD
  2458 01  DATE-DISK-P.                                                 ELCDTEFD
  2459     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2460     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2461     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2462     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2463         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2464                                     PIC  X.                      ELCDTEFD
  2465         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2466     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2467         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2468             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2469             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2470             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2471             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2472         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2473                                                                  ELCDTEFD
  2474 01  DATE-DISK-E.                                                 ELCDTEFD
  2475     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2476     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2477                                     PIC  X(4).                   ELCDTEFD
  2478                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2479 01  DATE-DISK-C.                                                 ELCDTEFD
  2480     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2481     12  DD-CARR1-SECPAY-SW          PIC  X.
  2482     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2483     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2484     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2485     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2486     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2487     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2488     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2489     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2490     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2491     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2492     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2493     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2494     12  DD-CARR2-SECPAY-SW          PIC  X.
  2495     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2496                                                                  ELCDTEFD
  2497 01  DATE-DISK-OPT.                                               ELCDTEFD
  2498     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2499     12  DD-TLR-DATA.                                             ELCDTEFD
  2500         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2501                                     PIC  X(03).                  ELCDTEFD
  2502     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2503         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2504                                     PIC  X(06).                  ELCDTEFD
  2505     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2506         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2507                                     PIC  X(07).                  ELCDTEFD
  2508         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2509     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2510                                     PIC  X(96).                  ELCDTEFD
  2511******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ECS010.cbl
  2513 FD  PRINT-COPY
* 2514                             COPY ELCPRTFD.
  2515******************************************************************04/15/98
  2516*                                                                *ELCPRTFD
  2517*                                                                *ELCPRTFD
  2518*                            ELCPRTFD.                           *   LV003
  2519*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2520*                            VMOD=2.006                          *ELCPRTFD
  2521******************************************************************ELCPRTFD
  2522     RECORDING MODE F                                             ELCPRTFD
  2523     LABEL RECORDS OMITTED                                        ELCPRTFD
  2524     BLOCK CONTAINS 0 RECORDS
  2525     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2526 01  PRT.                                                         ELCPRTFD
  2527     12  P-CTL               PIC  X.                                 CL**2
  2528     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2529******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ECS010.cbl
  2531 FD  MISMATCH-REPORT
  2532     RECORDING MODE F.
  2533
  2534 01  MISMATCH-RPT.
  2535     12  MR-CTL              PIC X.
  2536     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ECS010.cbl
  2538 FD  FICH
* 2539                             COPY ELCFCHFD.
  2540******************************************************************04/15/98
  2541*                                                                *ELCFCHFD
  2542*                            ELCFCHFD.                           *   LV003
  2543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2544*                            VMOD=2.004                          *   CL**3
  2545*                                                                *ELCFCHFD
  2546******************************************************************ELCFCHFD
  2547     BLOCK CONTAINS 0 RECORDS
  2548     RECORDING MODE F.                                            ELCFCHFD
  2549                                                                  ELCFCHFD
  2550 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2551******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ECS010.cbl
  2553 FD  DISPLAY-PRT
  2554     RECORDING MODE IS F
  2555     LABEL RECORDS ARE STANDARD
  2556     BLOCK CONTAINS 0 RECORDS
  2557     RECORD CONTAINS 133 CHARACTERS.
  2558
  2559 01  DISPLAY-REC.
  2560     05  DISPLAY-CC           PIC X.
  2561     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ECS010.cbl
  2563 WORKING-STORAGE SECTION.
  2564 77  LCP-ASA                       PIC X.
  2565 77  FILLER  PIC X(32)  VALUE '********************************'.
  2566 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2567 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2568
  2569 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2570 77  ws-dcc-cnc-flag         pic x  value ' '.
  2571 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2572 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2573 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2574 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2575 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2576 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2577 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2578 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2579 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2580 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2581 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2582 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2583 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2584 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2585 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2586 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2587 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2588 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2589 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2590 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2591 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2592 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2593 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2594 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2595 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2596 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2597 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2598 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2599 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2600 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2601 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2602 77  X                       PIC X.
  2603 77  DD-FLG                  PIC X               VALUE SPACE.
  2604 77  AGT-SW                  PIC X               VALUE SPACE.
  2605 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2606 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2607 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2608 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2609 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2610 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2611 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2612 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2613 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2614 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2615 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2616 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2617 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2618 77  SV-TRD-CERT             PIC X(11).
  2619 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2620 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ECS010.cbl
  2621 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2622*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2623*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2624 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2625 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2626 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2627 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2628 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2629 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2630 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2631 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2632 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2633 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2634 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2635 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2636 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2637 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2638 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2639 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2640 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2641 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2642 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2643 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2644 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2645 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2646 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2647 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2648 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2649 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2650 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2651 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2652 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2653 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2654 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2655 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2656 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2657 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2658 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2659 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2660 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2661 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2662 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2663 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2664 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2665 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2666 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2667 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2668 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2669 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2670 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2671 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2672 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2673 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2674 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2675 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2676 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2677 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2678 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ECS010.cbl
  2679 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2680 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2681 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2682 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2683 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2684 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2685 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2686 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2687 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2688 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2689 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2690 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2691 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2692 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2693 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2694 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2695 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2696 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2697 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2698 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2699 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2700 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2701 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2702 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2703 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2704 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2705 77  D1                      PIC S999 COMP-3 VALUE +0.
  2706 77  P1                      PIC S999 COMP-3 VALUE +0.
  2707 77  P2                      PIC S999 COMP-3 VALUE +0.
  2708 77  DD-IU-SW                    PIC X   VALUE ' '.
  2709     88  DD-IU-PRESENT                 VALUE 'Y'.
  2710 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2711 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2712 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2713 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2714 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2715 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2716 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2717 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2718 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2719 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2720
  2721 01  MONTH-END-DATA.
  2722     12  ME-START-DATE.
  2723         16  ME-START-MO         PIC 99.
  2724         16  FILLER              PIC X.
  2725         16  ME-START-DA         PIC 99.
  2726         16  FILLER              PIC X.
  2727         16  ME-START-YR         PIC 99.
  2728     12  ME-CNDS-DATE            PIC 9(6).
  2729     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2730         16  ME-CNDS-MO          PIC 99.
  2731         16  ME-CNDS-DA          PIC 99.
  2732         16  ME-CNDS-YR          PIC 99.
  2733     12  ME-START-TIME           PIC 9(6).
  2734     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2735         88  ME-DO-UPDATE        VALUE 'Y'.
  2736         88  ME-NO-UPDATE        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ECS010.cbl
  2737     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2738
  2739 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2740 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2741     'Life Claims Paid'.
  2742
  2743 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2744     'A&H Claims Paid'.
  2745
  2746 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2747     'Output Certificate Master Records Prior Month'.
  2748
  2749 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2750     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2751
  2752 01  WS-ME-BALANCE-REC.
  2753     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2754     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2755     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2756     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2757     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2758     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2759     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2760
  2761 01  WS-ME50-BALANCE-REC.
  2762     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2763     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2764     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2765     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2766     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2767     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2768     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2769     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2770     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2771
  2772 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2773 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2774 01  WS-BANK-COMMISSIONS.
  2775     12  WS-BANK-COMMS           OCCURS 10.
  2776         16  WS-BNK-AGT          PIC X(10).
  2777         16  WS-BNK-TYPE         PIC X.
  2778         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2779         16  WS-BNK-RECALC       PIC X.
  2780         16  FILLER              PIC X(10).
  2781
  2782 01  PENDING-MATCH-CONTROL.
  2783     12  PENDING-ACCOUNT-CONTROL.
  2784         16  PEND-MATCH-CARRIER    PIC X.
  2785         16  PEND-MATCH-GROUPING   PIC X(6).
  2786         16  PEND-MATCH-STATE      PIC XX.
  2787         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2788     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2789     12  PEND-MATCH-CERT-NO.
  2790         16  PEND-MATCH-CERT       PIC X(10).
  2791         16  PEND-MATCH-CERT-SFX   PIC X.
  2792 01  PENDING-RECORD-TYPE           PIC X.
  2793     88  ISSUE-TRANSACTION            VALUE '1'.
  2794     88  CANCEL-TRANSACTION           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ECS010.cbl
  2795     88  CLAIM-TRANSACTION            VALUE '3'.
  2796     88  RESERVE-TRANSACTION          VALUE '4'.
  2797     88  UPDATE-TRANSACTION           VALUE '5'.
  2798
  2799 01  CLM-INCUR-REIN-DATE.
  2800     12  CIRD-CCYY.
  2801         16  CIRD-CC         PIC 99.
  2802         16  CIRD-YR         PIC 99.
  2803     12  CIRD-MO             PIC 99.
  2804
  2805 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2806
  2807 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2808
  2809 01  REIN-BILLING-TABLE.
  2810     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2811         16  RB-COMPANY      PIC X(6).
  2812         16  RB-COUNT        PIC S9(5)   COMP-3.
  2813
  2814 01  B-SUB                   PIC S9(4)   COMP.
  2815
  2816 01  BINARY-COUNTERS     COMP      SYNC.
  2817     12  IA                  PIC S999            VALUE +0.
  2818     12  IB                  PIC S999            VALUE +0.
  2819     12  SUB                 PIC S999            VALUE +0.
  2820     12  SUBM                PIC S999            VALUE +0.
  2821     12  SUB3                PIC S999            VALUE +0.
  2822     12  SUB4                PIC S999            VALUE +0.
  2823     12  SUB5                PIC S999            VALUE +0.
  2824     12  SUB6                PIC S999            VALUE +0.
  2825     12  SUB7                PIC S999            VALUE +0.
  2826     12  SUB8                PIC S999            VALUE +0.
  2827     12  SUB9                PIC S999            VALUE +0.
  2828     12  SUB10               PIC S999            VALUE +0.
  2829     12  SUB11               PIC S999            VALUE +0.
  2830     12  SUB12               PIC S999            VALUE +0.
  2831     12  SUB13               PIC S999            VALUE +0.
  2832     12  SUB14               PIC S999            VALUE +0.
  2833     12  SUB15               PIC S999            VALUE +0.
  2834     12  SUB16               PIC S999            VALUE +0.
  2835     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2836 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2837
  2838 01  WS.
  2839     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2840     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2841     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2842     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2843
  2844     12  WS-ABEND-CODE         PIC 9(4).
  2845     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2846         16  ABEND-CODE-1    PIC XX.
  2847         16  ABEND-CODE-2.
  2848             20  AC2-ONE     PIC X.
  2849             20  AC2-TWO     PIC X.
  2850
  2851     12  CTBL-SEARCH.
  2852         16  CTBL-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ECS010.cbl
  2853         16  CTBL-TABLE-CD   PIC XXX.
  2854         16  CTBL-BEN-TYPE   PIC X.
  2855         16  CTBL-BEN-CODE   PIC XX.
  2856     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2857     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2858     12  WS-COMM-TERM        PIC S999            COMP-3.
  2859     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2860         88  CTBL-ERROR         VALUE '*'.
  2861
  2862     12  REIN-SPEC.
  2863         16  REIN-SPEC-A     PIC X.
  2864         16  REIN-SPEC-B     PIC X.
  2865         16  REIN-SPEC-C     PIC X.
  2866
  2867     12  WS-CHECK-NUMBER.
  2868         16  WS-CHECK-NO     PIC X(4).
  2869         16  FILLER          PIC XXX.
  2870
  2871     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2872         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2873         88  AH-EARN-NET                         VALUE 'N'.
  2874
  2875     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2876     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2877
  2878 01  DCC-DDF-WORK-AREA.
  2879     05  F OCCURS 800.
  2880         10  DD-STATE                 PIC XX.
  2881         10  DD-PRODUCT-CD            PIC XXX.
  2882         10  DD-FILLER                PIC X(7).
  2883         10  DD-BEN-TYPE              PIC X.
  2884         10  DD-BEN-CODE              PIC XX.
  2885         10  DD-PROD-EXP-DT           PIC XX.
  2886         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2887         10  DD-PROD-DATA OCCURS 8.
  2888             15  DD-PROD-CODE         PIC X.
  2889             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2890         10  DD-EARN-FACTORS.
  2891             15  F OCCURS 15.
  2892                 20  F OCCURS 15.
  2893                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2894         10  DD-TRUNCATED        PIC X.
  2895
  2896 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2897 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2898 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2899 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2900 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2901 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2902 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2903 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2904
  2905 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2906 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2907 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2908 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2909
  2910 01  WS-LEVELS-CHARGEBACK-SWITCHES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ECS010.cbl
  2911     12  WS-LF-CHARGEBACK-LEVELS.
  2912         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2913     12  WS-AH-CHARGEBACK-LEVELS.
  2914         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2915 01  WS-DCC-DDF-CB.
  2916     12  WS-DCC-DDF-CB-LEVELS.
  2917         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2918*****************************************************************
  2919*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2920*****************************************************************
  2921*RESIDENT STATE TAXES MASTER(ERRESC)
  2922*
  2923 01  WORK-AREAS.
  2924     12  WS-ERRESC-KEY.
  2925         16 WS-ERRESC-SEARCH-KEY.
  2926             20  WS-ERRESC-COMPANY-CD PIC  X.
  2927             20  WS-ERRESC-CARRIER    PIC  X.
  2928             20  WS-ERRESC-GROUP      PIC X(6).
  2929             20  WS-ERRESC-STATE      PIC XX.
  2930             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2931         16 WS-ERRESC-RESIDUAL-KEY.
  2932             20  WS-ERRESC-AGENT      PIC X(10).
  2933             20  WS-ERRESC-RES-STATE  PIC XX.
  2934             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2935*                                          YYYYMMDD
  2936     12  WS-YYYYMMDD-DT               PIC 9(8).
  2937     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2938     12  WS-SUB                       PIC    99  COMP-3.
  2939     12  WS-SUB1                      PIC    99  COMP-3.
  2940*****************************************************************
  2941*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2942*****************************************************************
  2943
  2944 01  COMM-WORK-AREAS.
  2945     12  FILLER              PIC  X(17)
  2946         VALUE 'COMMON WORK AREAS'.
  2947     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2948     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2949     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2950     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2951     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2952     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2953     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2954     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2955     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2956     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2957     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2958     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2959     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2960     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2961     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2962     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2963     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2964     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2965     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2966
  2967     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2968                                         COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ECS010.cbl
  2969     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2970                                         COMP-3 VALUE ZEROS.
  2971     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2972                                         COMP-3 VALUE ZEROS.
  2973     12  W-EDIT-FIELD        PIC ----------9.
  2974     12  W-EDIT-FIELD2       PIC ----------9.99.
  2975     12  W-EDIT-7            PIC Z(06)9.
  2976     12  W-FACTOR            PIC S9(09)V9(08)
  2977                                         COMP-3 VALUE ZEROS.
  2978     12  W-IBNR-1            PIC S9(07)V9(02)
  2979                                         COMP-3 VALUE ZEROS.
  2980     12  W-IBNR-2            PIC S9(07)V9(02)
  2981                                         COMP-3 VALUE ZEROS.
  2982     12  W-ISS-BEN           PIC S9(11)V9(02)
  2983                                         COMP-3 VALUE ZEROS.
  2984     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2985                                         COMP-3 VALUE ZEROS.
  2986     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2987     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  2988     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2989     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2990     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2991     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2992     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2993     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2994     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2995     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2996     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2997     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2998     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2999     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3000     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3001     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3002                                         COMP-3 VALUE ZEROS.
  3003     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3004     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3005     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3006     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3007     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3008     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3009     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3010     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3011     12  W-POLICY-INACTIVE-CTR
  3012                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3013     12  W-POLICY-REISSUE-CTR
  3014                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3015     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3016     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3017     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3018                                         COMP-3 VALUE ZEROS.
  3019     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3020     12  W-WK-IBNR           PIC S9(07)V9(02)
  3021                                         COMP-3 VALUE ZEROS.
  3022
  3023     12  W-CLAIM-TYPE        PIC  X(01).
  3024         88  W-A-H                              VALUE 'A'.
  3025         88  W-LIFE                             VALUE 'L'.
  3026     12  W-CUTOFF-DATE       PIC  9(08).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ECS010.cbl
  3027     12  W-DIS-DT            PIC  XX.
  3028     12  W-DIS-PTO-DT        PIC  XX.
  3029     12  WK-LEVEL.
  3030         16  WK-AGT          PIC X(10).
  3031         16  WK-A-TYPE       PIC X.
  3032         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3033         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3034         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3035         16  FILLER          PIC X(6).
  3036     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3037         16  FILLER          PIC X(11).
  3038         16  WK-L-RTX        PIC X(3).
  3039         16  WK-J-RTX        PIC X(3).
  3040         16  WK-A-RTX        PIC X(3).
  3041         16  FILLER          PIC X(6).
  3042     12  WK-NEW-RATES.
  3043         16  WK-N-R      OCCURS 10.
  3044             20  WK-N-AGT    PIC X(10).
  3045             20  WK-N-TYPE   PIC X.
  3046             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3047             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3048     12  W-LIFE-YEARS-ZERO.
  3049         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3050         16  FILLER          PIC  X(01)         VALUE SPACES.
  3051         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3052         16  FILLER          PIC  X(01)         VALUE SPACES.
  3053         16  FILLER          PIC  X(01)         VALUE SPACES.
  3054         16  FILLER          PIC  X(01)         VALUE SPACES.
  3055         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3056         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3057         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3058         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3059         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3060         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3061         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3062         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3063         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3064         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3065         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3066         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3067         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3068         16  FILLER          PIC S9(09)V9(02) COMP-3
  3069                                                VALUE ZEROS.
  3070         16  FILLER          PIC S9(09)V9(02) COMP-3
  3071                                                VALUE ZEROS.
  3072         16  FILLER          PIC S9(09)V9(02) COMP-3
  3073                                                VALUE ZEROS.
  3074         16  FILLER          PIC S9(09)V9(02) COMP-3
  3075                                                VALUE ZEROS.
  3076         16  FILLER          PIC S9(11)V9(02) COMP-3
  3077                                                VALUE ZEROS.
  3078
  3079     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3080         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3081     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  3082         88  W-REIN-PROCESS                     VALUE 'Y'.
  3083         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  3084     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ECS010.cbl
  3085         88  W-SELECTION-ON                     VALUE 'Y'.
  3086         88  W-SELECTION-OFF                    VALUE SPACES.
  3087     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3088         88  W-RTRM-0                           VALUE 'Y'.
  3089         88  W-RTRM-NOT-0                       VALUE SPACES.
  3090     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3091     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3092         88  W-TABLE-USED                       VALUE 'Y'.
  3093         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3094     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3095         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3096
  3097     12  W-VAL-ERRORS.
  3098         16  FILLER          PIC  X(40)
  3099             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3100         16  FILLER          PIC  X(40)
  3101             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3102         16  FILLER          PIC  X(40)
  3103             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3104         16  FILLER          PIC  X(40)
  3105             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3106         16  FILLER          PIC  X(40)
  3107             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3108         16  FILLER          PIC  X(40)
  3109             VALUE 'RUN DATE EPEC - A&H - '.
  3110         16  FILLER          PIC  X(40)
  3111             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3112         16  FILLER          PIC  X(40)
  3113             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3114         16  FILLER          PIC  X(40)
  3115             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3116     12  FILLER REDEFINES W-VAL-ERRORS.
  3117         16  W-VAL-ERROR OCCURS 9 TIMES
  3118                             PIC  X(40).
  3119
  3120     12  W-WORK-DATE         PIC  X(02).
  3121     12  SAVE-WK-NEW-RATES.
  3122         16  FILLER          PIC X(170).
  3123
  3124***   The following data area is for NCL only
  3125*    12  W-WORK-OB-DATA OCCURS 300.
  3126*    12  W-WORK-OB-DATA OCCURS 220.
  3127     12  W-WORK-OB-DATA OCCURS 900.
  3128         16  WS-OB-REIN-CO       PIC X(06).
  3129         16  WS-OB-LF-AH         PIC X.
  3130         16  WS-OB-BENEFIT-CODE  PIC XX.
  3131         16  WS-OB-EARNED OCCURS 3.
  3132             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3133
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ECS010.cbl
  3135 01  EPEC-WORK-AREAS.
  3136     12  WE-REIN-CO          PIC X(6).
  3137     12  WE-LF-AH            PIC X.
  3138     12  WE-BEN-TYPE         PIC XX.
  3139     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3140     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3141     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3142     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3143     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3144     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3145     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3146     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3147     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3148     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3149     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3150     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3151     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3152     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3153     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3154     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3155     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3156     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3157     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3158     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3159     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3160     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3161     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3162     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3163     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3164     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3165     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3166     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3167     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3168     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3169     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3170     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3171     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3172     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3173     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3174     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3175     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3176     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3177     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3178     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3179     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3180     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3181     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3182     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3183     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3184     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3185     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3186     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3187     12  WX-SETTLEMENT-EXIT-DATE
  3188                             PIC  9(11)      COMP-3.
  3189     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3190     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3191     12  WX-STATUS-AT-SETTLEMENT
  3192                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ECS010.cbl
  3193     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3194
  3195 01  EPEC-WORK.
  3196     12  EW-REIN-CO          PIC X(6).
  3197     12  EW-SUB-KEY.
  3198         16  EW-LF-AH        PIC X.
  3199         16  EW-BEN-TYPE     PIC XX.
  3200     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3201     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3202     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3203     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3204     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3205     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3206     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3207     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3208     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3209     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3210     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3211     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3212     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3213     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3214     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3215     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3216     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3217     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3218     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3219     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3220     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3221     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3222     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3223     12  EW-AGENTS       OCCURS 10.
  3224         16  EW-AGT-NO       PIC X(10).
  3225         16  EW-AGT-TYPE     PIC X.
  3226         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3227         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3228         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3229         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3230         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3231         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3232         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3233     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3234     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3235     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3236     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3237     12  EW-AGE              PIC S9(9)       COMP-3.
  3238     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3239     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3240     12  EW-LEVEL-USED       PIC X.
  3241
  3242 01  EPEC-TOTALS.
  3243     12  EPEC-LEVELS     OCCURS 900.
  3244*    12  EPEC-LEVELS     OCCURS 220.
  3245*    12  EPEC-LEVELS     OCCURS 300.
  3246         16  EPEC-REIN-CO          PIC X(6).
  3247         16  EPEC-SUB-KEY.
  3248             24  EPEC-LF-AH        PIC X.
  3249             24  EPEC-BEN-TYPE     PIC XX.
  3250*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ECS010.cbl
  3251         16  FILLER                PIC X(699).
  3252     12  EPEC-LEVELS-END           PIC X(6).
  3253
  3254 01  EPEC-UNDERWRITTEN-TOTALS.
  3255     12  EPEC-LEVELS-II  OCCURS 900.
  3256*    12  EPEC-LEVELS-II  OCCURS 220.
  3257*    12  EPEC-LEVELS-II  OCCURS 300.
  3258         16  EPEC-REIN-CO-II       PIC X(6).
  3259         16  EPEC-SUB-KEY-II.
  3260             24  EPEC-LF-AH-II     PIC X.
  3261             24  EPEC-BEN-TYPE-II  PIC XX.
  3262*        16  FILLER                PIC X(694).
  3263         16  FILLER                PIC X(699).
  3264     12  EPEC-LEVELS-END-II        PIC X(6).
  3265
  3266
  3267 01  FILLER                      PIC  X(11)
  3268                                 VALUE 'OPT RSV TBL'.
  3269*
  3270* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3271*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3272*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3273*      EPEC-OPT-GRP  (108)
  3274*
  3275*      300 X 108 = 32400.
  3276*
  3277 01  EPEC-OPT-DATA-TABLE.
  3278*    12  FILLER                  PIC X(32400).
  3279*    12  FILLER                  PIC X(23760).
  3280     12  FILLER                  PIC X(97200).
  3281
  3282 01  FILLER                      PIC  X(16)
  3283                                 VALUE 'OPT RSV TBL UNDW'.
  3284 01  EPEC-UNDW-OPT-DATA-TABLE.
  3285*    12  FILLER                  PIC X(32400).
  3286*    12  FILLER                  PIC X(23760).
  3287     12  FILLER                  PIC X(97200).
  3288
  3289 01  FILLER                      PIC  X(16)
  3290                                 VALUE 'OPT RSV TBL WORK'.
  3291 01  EPEC-OPT-WORK-TABLE.
  3292*    12  EPEC-OPT-GRP        OCCURS 300.
  3293*    12  EPEC-OPT-GRP        OCCURS 220.
  3294     12  EPEC-OPT-GRP        OCCURS 900.
  3295         16  EPEC-REIN-CO-OPT
  3296                             PIC  X(06).
  3297         16  EPEC-SUB-KEY-OPT.
  3298             24  EPEC-LF-AH-OPT
  3299                             PIC  X(01).
  3300             24  EPEC-BEN-TYPE-OPT
  3301                             PIC  X(02).
  3302         16  EPEC-OPT-DATA.
  3303             20  EPEC-REIN-ONLY-IND
  3304                             PIC  X(01).
  3305                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3306             20  EPEC-LINE-NOT-USED-IND
  3307                             PIC  X(01).
  3308                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ECS010.cbl
  3309             20  EPEC-LIFE-CTR-USED-IND
  3310                             PIC  X(01).
  3311                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3312                 88  EPEC-LIFE-CTR-NOT-USED
  3313                                           VALUE ' '.
  3314             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3315                             PIC S9(09)       COMP-3.
  3316             20  EPEC-EARNED-PREMIUM-AH
  3317                             PIC S9(09)V9(02) COMP-3.
  3318             20  EPEC-CLAIMS-MADE-PAID
  3319                             PIC S9(09)V9(02) COMP-3.
  3320             20  EPEC-CLM-EXP
  3321                             PIC S9(09)V9(02) COMP-3.
  3322             20  EPEC-LIFE-IBNR
  3323                             PIC S9(09)V9(02) COMP-3.
  3324             20  EPEC-REIN-ISS-BEN
  3325                             PIC S9(11)V9(02) COMP-3.
  3326
  3327 01  FILLER                  PIC X(09)
  3328                                 VALUE 'EOM TABLE'.
  3329
  3330 01  EOM-DATE-TABLE.
  3331     12  EOM-DATE            OCCURS 13
  3332                             PIC 9(08).
  3333
  3334 01  EPEC-SUBS.
  3335     12  EPEC-SUB-LEVELS OCCURS 31.
  3336         16  EPEC-SUB-REIN   PIC X(6).
  3337         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3338         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3339     12  EPEC-SUBS-END       PIC X(6).
  3340
  3341 01  SAVE-REIN-WORK.
  3342     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3343     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3344     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3345     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3346     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3347
  3348 01  SAVE-REIN-TABLE.
  3349     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3350         16  SR-TIME         PIC 9(6).
  3351         16  SR-ENTRY.
  3352             20  FILLER      PIC XX.
  3353             20  SR-CONTROL  PIC X(8).
  3354             20  FILLER      PIC X(3990).
  3355
  3356
* 3357                             COPY ECSRITAB.
  3358******************************************************************04/29/98
  3359*                                                                *ECSRITAB
  3360*                            ECSRITAB                            *   LV015
  3361*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3362*                            VMOD=2.015                          *ECSRITAB
  3363*                                                                *ECSRITAB
  3364*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3365*                                                                *ECSRITAB
  3366******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3367 01  REIN-WORK-AREAS.                                             ECSRITAB
  3368     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3369     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3370     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3371     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3372     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3373     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3374     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3375     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3376     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3377     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3378     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3379         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3380             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3381             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3382             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3383     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3384     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3385     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3386     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3387     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3388     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3389     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3390     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3391     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3392     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3393     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3394     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3395     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3396     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3397     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3398     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3399     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3400     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3401     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3402     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3403     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3404     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3405     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3406                                                                  ECSRITAB
  3407 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3408     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3409         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3410         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3411             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3412             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3413         16  REIN-WORK-FLDS.                                      ECSRITAB
  3414             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3415             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3416             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3417             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3418             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3419             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3420             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3421             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3422             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3423             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3424             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3425             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3426             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3427             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3428             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3429             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3430             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3431             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3432             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3433             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3434             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3435             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3436             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3437             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3438             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3439             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3440             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3441             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3442     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3443                                                                  ECSRITAB
  3444     12  RWF-FIELDS.                                              ECSRITAB
  3445         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3446         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3447         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3448         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3449         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3450         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3451         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3452         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3453         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3454         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3455         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3456         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3457         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3458         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3459         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3460         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3461         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3462         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3463         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3464         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3465         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3466         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3467         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3468         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3469         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3470         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3471         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3472         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3473                                                                  ECSRITAB
  3474     12  WT-COMP-INFO.                                            ECSRITAB
  3475         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3476         16  WT-LF-QC                PIC X.                       ECSRITAB
  3477         16  WT-AH-QC                PIC X.                       ECSRITAB
  3478         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3479         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3480         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3481         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3482         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3483         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3484         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3485         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3486         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3487         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3488         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3489         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3490         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3491         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3492         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3493         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3494         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3495         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3496         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3497         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3498         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3499         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3500         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3501         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3502         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3503         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3504         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3505         16  WT-REMAINING            PIC X.                       ECSRITAB
  3506         16  FILLER                  PIC X(21).                   ECSRITAB
  3507                                                                  ECSRITAB
  3508 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3509     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3510     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3511     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3512     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3513     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3514     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3515     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3516     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3517     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3518     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3519     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3520     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3521     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3522     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3523     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3524     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3525     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3526     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3527     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3528     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3529     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3530     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3531     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3532     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3533                                                                  ECSRITAB
  3534     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3535         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3536     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3537         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3538     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3539         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3540     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3541         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3542     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3543         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3544     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3545         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3546                                                                  ECSRITAB
  3547     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3548         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3549         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3550         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3551         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3552         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3553         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3554         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3555         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3556         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3557         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3558         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3559         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3560         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3561         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3562         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3563         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3564         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3565         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3566         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3567         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3568         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3569         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3570         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3571     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3572     12  REIN-SEARCH.                                             ECSRITAB
  3573         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3574         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3575         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3576         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3577     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3578     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3579     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3580     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3581     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3582     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3583     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3584     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3585     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3586     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3587     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3588     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3589     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3590     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3591     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3592     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3593     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3594     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3595     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3596     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3597     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3598     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3599     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3600     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3601     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3602                                                                  ECSRITAB
  3603 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3604* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3605     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3606         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3607         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3608         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3609         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3610         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3611         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3612         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3613         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3614         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3615                                                                  ECSRITAB
  3616 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3617     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3618         16  RC2-REIN-CO.                                         ECSRITAB
  3619             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3620             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3621         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3622         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3623         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3624         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3625         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3626         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3627                                                                  ECSRITAB
  3628 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3629     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3630         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3631         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3632     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3633                                                                  ECSRITAB
  3634 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3635     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3636         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3637         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3638         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3639 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3640     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3641         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3642                                                                  ECSRITAB
  3643 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3644******************************************************************ECSRITAB
  3645
* 3646                             COPY ELCPSEVR.
  3647******************************************************************04/16/98
  3648*                                                                *ELCPSEVR
  3649*                                                                *ELCPSEVR
  3650*                            ELCPSEVR                            *   LV003
  3651*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3652*                            VMOD=2.001                          *ELCPSEVR
  3653*                                                                *ELCPSEVR
  3654*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3655*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3656*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3657******************************************************************ELCPSEVR
  3658                                                                  ELCPSEVR
  3659 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3660     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3661         10  FILLER               PIC 999.                        ELCPSEVR
  3662         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3663         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3664             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3665             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3666         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3667         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3668     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3669            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3670     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3671         10  FILLER              PIC 999.                         ELCPSEVR
  3672         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3673         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3674             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3675             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3676         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3677         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3678     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3679            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3680 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3681     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3682                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3683         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3684             15  FILLER              PIC 999.                     ELCPSEVR
  3685             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3686             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3687                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3688                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3689             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3690             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3691         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3692                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3693         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3694             15  FILLER              PIC 999.                     ELCPSEVR
  3695             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3696             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3697                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3698                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3699             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3700             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3701         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3702                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3703         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3704             15  FILLER              PIC 999.                     ELCPSEVR
  3705             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3706             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3707                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3708                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3709             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3710             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3711         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3712                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3713     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3714         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3715         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3716         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3717             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3718             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3719         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3720         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3721     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3722            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3723
* 3724                             COPY ELCEPCVR.
  3725******************************************************************05/15/98
  3726*                                                                *ELCEPCVR
  3727*                                                                *ELCEPCVR
  3728*                            ELCEPCVR                            *   LV003
  3729*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3730*                            VMOD=2.001                          *ELCEPCVR
  3731*                                                                *ELCEPCVR
  3732*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3733*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3734*                                                                *ELCEPCVR
  3735******************************************************************ELCEPCVR
  3736 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3737     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3738         10  FILLER            PIC 999.                           ELCEPCVR
  3739         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3740         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3741             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3742             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3743         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3744         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3745     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3746            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3747     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3748         10  FILLER            PIC 999.                              CL**5
  3749         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3750         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3751             15  EC-EXP-CC     PIC 99.                               CL**5
  3752             15  EC-EXP-YR     PIC 99.                               CL**5
  3753         10  EC-EXP-MO         PIC 99.                               CL**5
  3754         10  EC-EXP-DA         PIC 99.                               CL**5
  3755     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3756            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3757     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3758         10  FILLER            PIC 999.                           ELCEPCVR
  3759         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3760         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3761             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3762             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3763         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3764         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3765     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3766            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3767     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3768         10  FILLER            PIC 999.                              CL**5
  3769         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3770         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3771             15  EC-EFF-CC     PIC 99.                               CL**5
  3772             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3773         10  EC-EFF-MO         PIC 99.                               CL**5
  3774         10  EC-EFF-DA         PIC 99.                               CL**5
  3775     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3776            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3777     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3778         10  FILLER            PIC 999.                           ELCEPCVR
  3779         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3780         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3781             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3782             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3783         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3784         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3785     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3786            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3787     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3788         10  FILLER            PIC 999.                           ELCEPCVR
  3789         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3790         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3791             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3792             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3793         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3794         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3795     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3796            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3797     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3798         10  FILLER            PIC 999.                           ELCEPCVR
  3799         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3800         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3801             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3802             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3803         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3804         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3805     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3806            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3807     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3808         10  FILLER            PIC 999.                           ELCEPCVR
  3809         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3810         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3811             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3812             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3813         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3814         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3815     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3816            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3817     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3818         10  FILLER            PIC 999.                           ELCEPCVR
  3819         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3820         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3821             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3822             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3823         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3824         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3825     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3826            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3827
* 3828                             COPY ELCREINV.
  3829******************************************************************04/18/98
  3830*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3831*                                                                *ELCREINV
  3832*                            ELCREINV                            *   LV003
  3833*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3834*                            VMOD=2.001                          *ELCREINV
  3835*                                                                *ELCREINV
  3836*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3837*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3838*                                                                *ELCREINV
  3839******************************************************************ELCREINV
  3840                                                                  ELCREINV
  3841 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3842     05  WS-RE-LO-DATE.                                              CL**3
  3843         10 FILLER                     PIC 999.                      CL**3
  3844         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3845         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3846            15 RE-LO-CC                PIC 99.                       CL**3
  3847            15 RE-LO-YR                PIC 99.                       CL**3
  3848         10 RE-LO-MO                   PIC 99.                       CL**3
  3849         10 RE-LO-DA                   PIC 99.                       CL**3
  3850     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3851            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3852     05  WS-RE-HI-DATE.                                              CL**3
  3853         10 FILLER                     PIC 999.                      CL**3
  3854         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3855         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3856            15 RE-HI-CC                PIC 99.                       CL**3
  3857            15 RE-HI-YR                PIC 99.                       CL**3
  3858         10 RE-HI-MO                   PIC 99.                       CL**3
  3859         10 RE-HI-DA                   PIC 99.                       CL**3
  3860     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3861            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3862     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3863         10 FILLER                     PIC 999.                   ELCREINV
  3864         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3865         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3866            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3867            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3868         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3869         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3870     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3871            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3872     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3873         10  FILLER                    PIC 999.                   ELCREINV
  3874         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3875         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3876             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3877             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3878         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3879         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3880     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3881            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3882     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3883         10  FILLER                    PIC 999.                   ELCREINV
  3884         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3885         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3886             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3887             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3888         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3889         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3890     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3891            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3892
  3893 01  RC-REIN-HOLD-AREAS.
  3894     12  RC-REIN-LEVELS  OCCURS 30.
  3895         16  RC-REIN-COMP    PIC X(6).
  3896         16  RC-OLD-ISS      PIC X.
  3897         16  RC-NEW-ISS      PIC X.
  3898         16  RC-OLD-CNC      PIC X.
  3899         16  RC-NEW-CNC      PIC X.
  3900         16  RC-OLD-LF-CLM   PIC X.
  3901         16  RC-OLD-AH-CLM   PIC X.
  3902         16  RC-NEW-LF-CLM   PIC X.
  3903         16  RC-NEW-AH-CLM   PIC X.
  3904         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3905         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3906         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3907         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3908         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3909         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3910         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3911         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3912         16  RC-REIN-REM-SW  PIC X.
  3913     12  RC-REIN-LEVELS-END  PIC X(6).
  3914
  3915 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3916     12  TPC-COUNTERS    OCCURS 6.
  3917         16  TPL-ISS-PRM     PIC S9(9)V99.
  3918         16  TPA-ISS-PRM     PIC S9(9)V99.
  3919         16  TPL-CNC-PRM     PIC S9(9)V99.
  3920         16  TPA-CNC-PRM     PIC S9(9)V99.
  3921         16  TPL-ACCT-COM    PIC S9(9)V99.
  3922         16  TPA-ACCT-COM    PIC S9(9)V99.
  3923         16  TPL-CLAIMS      PIC S9(9)V99.
  3924         16  TPA-CLAIMS      PIC S9(9)V99.
  3925
  3926 01  HLD-DTS SYNC.
  3927     12  EOM-RUN-DATE        PIC 9(08).
  3928     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3929         16  EOM-CCYY.
  3930             20  EOM-CC      PIC 99.
  3931             20  EOM-YR      PIC 99.
  3932         16  EOM-MO          PIC 99.
  3933         16  EOM-DA          PIC 99.
  3934
  3935****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3936****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3937     12  OB-RUN-DATES OCCURS 2.
  3938         16  OB-CCYY         PIC 9(4).
  3939         16  OB-MO           PIC 99.
  3940         16  OB-DA           PIC 99.
  3941
  3942     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3943         88  OB-DATE-1-USED     VALUE '*'.
  3944     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3945         88  OB-DATE-2-USED     VALUE '*'.
  3946     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ECS010.cbl
  3947         88  OB-DATE-3-USED     VALUE '*'.
  3948     12  EARNING-START-DATE  PIC 9(08).
  3949     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3950         16  E-ERN-START-CC  PIC 99.
  3951         16  E-ERN-START-YR  PIC 99.
  3952         16  E-ERN-START-MO  PIC 99.
  3953         16  E-ERN-START-DA  PIC 99.
  3954     12  EARNING-STOP-DATE   PIC 9(08).
  3955     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3956         16  E-ERN-STOP-CC   PIC 99.
  3957         16  E-ERN-STOP-YR   PIC 99.
  3958         16  E-ERN-STOP-MO   PIC 99.
  3959         16  E-ERN-STOP-DA   PIC 99.
  3960     12  STOP-LF-DATE        PIC 9(08).
  3961     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3962         16  STOP-LF-CC      PIC 99.
  3963         16  STOP-LF-YR      PIC 99.
  3964         16  STOP-LF-MO      PIC 99.
  3965         16  STOP-LF-DA      PIC 99.
  3966     12  STOP-AH-DATE        PIC 9(08).
  3967     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3968         16  STOP-AH-CC      PIC 99.
  3969         16  STOP-AH-YR      PIC 99.
  3970         16  STOP-AH-MO      PIC 99.
  3971         16  STOP-AH-DA      PIC 99.
  3972     12  BIN-VALUATION-DT    PIC XX.
  3973     12  BIN-EOM-RUN-DATE    PIC XX.
  3974     12  LAST-YRS-DATE       PIC 9(08).
  3975     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3976         16  LYD-CCYY        PIC 9(04).
  3977         16  LYD-CCYR REDEFINES LYD-CCYY.
  3978             20  LYD-CC      PIC 99.
  3979             20  LYD-YR      PIC 99.
  3980         16  LYD-MO          PIC 99.
  3981         16  LYD-DA          PIC 99.
  3982     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3983     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3984         16  VAL-CC          PIC 99.
  3985         16  VAL-YR          PIC 99.
  3986         16  VAL-MO          PIC 99.
  3987         16  VAL-DA          PIC 99.
  3988     12  INCURRED-DATE       PIC 9(08).
  3989     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3990         16  DTO-CC          PIC 99.
  3991         16  DTO-YR          PIC 99.
  3992         16  DTO-MO          PIC 99.
  3993         16  DTO-DA          PIC 99.
  3994     12  REPORTED-DATE.
  3995         16  RPT-YR          PIC 99.
  3996         16  RPT-MO          PIC 99.
  3997         16  RPT-DA          PIC 99.
  3998     12  PAYMENT-DATE        PIC 9(08).
  3999     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4000         16  PAY-CC          PIC 99.
  4001         16  PAY-YR          PIC 99.
  4002         16  PAY-MO          PIC 99.
  4003         16  PAY-DA          PIC 99.
  4004     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ECS010.cbl
  4005     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4006         16  PAYTO-CC        PIC 99.
  4007         16  PAYTO-YR        PIC 99.
  4008         16  PAYTO-MO        PIC 99.
  4009         16  PAYTO-DA        PIC 99.
  4010
  4011 01  AH-RES-STATE-TABLE.
  4012     12  FILLER              PIC X(42)       VALUE
  4013             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4014     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4015
  4016 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4017     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4018
  4019 01  BILLING-COUNTERS    COMP-3.
  4020     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4021     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4022     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4023     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4024     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4025     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4026     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4027     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4028     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4029     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4030     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4031     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4032     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4033     12  BC-COMM             PIC S9(5)           VALUE +0.
  4034     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4035     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4036     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4037     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4038     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4039     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4040     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4041     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4042     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4043     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4044
  4045 01  FLAGS SYNC.
  4046     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4047         88  CHECK-BILLED                        VALUE 'Y'.
  4048     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4049         88  EOF-ON-TRANS                        VALUE '*'.
  4050     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4051         88  EOF-ON-CERT                         VALUE '*'.
  4052     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4053         88  PROCESSING-COMPLETED                VALUE '*'.
  4054     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4055         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4056     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4057         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4058     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4059         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4060     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4061         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4062     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ECS010.cbl
  4063         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4064     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4065         88  A-H-FULLY-EARNED                    VALUE '*'.
  4066     12  CNCL-FLG            PIC X               VALUE SPACE.
  4067     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4068         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4069         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4070     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4071         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4072     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4073         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4074     12  EP-FLG              PIC X               VALUE SPACE.
  4075     12  END-FLG             PIC X               VALUE SPACE.
  4076     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4077     12  PRIOR-CERT-IN-CNTRL.
  4078         16  PCIC-FIRST      PIC x(19)  value low-values.
  4079         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4080         16  pcic-cert-no    pic x(11)  value low-values.
  4081     12  ACCT-FLG            PIC X               VALUE SPACE.
  4082     12  STATE-FLG           PIC X               VALUE SPACE.
  4083     12  COMP-FLG            PIC X               VALUE SPACE.
  4084     12  CARR-FLG            PIC X               VALUE SPACE.
  4085     12  FINAL-FLG           PIC X               VALUE SPACE.
  4086     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4087     12  REIN-FLG            PIC X               VALUE SPACE.
  4088     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4089     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4090
  4091 01  TEXAS-REG-WORK-AREAS   SYNC.
  4092     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4093     12  TEX-FACT-2          PIC S999        COMP-3.
  4094     12  TEX-FACT-3          PIC S999        COMP-3.
  4095     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4096     12  TEX-FACT-5          PIC S999        COMP-3.
  4097     12  TEX-FACT-6          PIC S999        COMP-3.
  4098     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4099     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4100     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4101
  4102 01  NET-PAY-INTERFACE.
  4103     12  NP-APR              PIC S999V9(4)   COMP-3.
  4104     12  NP-ORIG             PIC S999        COMP-3.
  4105     12  NP-REM              PIC S999        COMP-3.
  4106     12  NP-OPT              PIC X.
  4107     12  NP-CAP              PIC S999        COMP-3.
  4108     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4109     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4110     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4111     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4112     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4113     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4114     12  NP-ACCOUNT          PIC X(10).
  4115
  4116 01  HOLDERS SYNC.
  4117     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4118     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4119     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4120     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ECS010.cbl
  4121     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4122     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4123     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4124     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4125     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4126     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4127     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4128     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4129     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4130     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4131     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4132     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4133     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4134     12  REM-TRM1            PIC S999V99  COMP-3.
  4135     12  REM-TRM2            PIC S999V99  COMP-3.
  4136     12  REM-TRM3            PIC S999V99  COMP-3.
  4137     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4138     12  TEM-TRM1            PIC S999V99  COMP-3.
  4139     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4140     12  ORIG-TERM           PIC S999V99  COMP-3.
  4141     12  HLD-CONTROL.
  4142         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4143         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4144         16  HLD-STATE       PIC XX              VALUE SPACES.
  4145         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4146     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4147
  4148 01  DISPLAY-IBNR-LINE.
  4149     05  FILLER                  PIC X       VALUE SPACES.
  4150     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4151     05  FILLER                  PIC XX      VALUE SPACES.
  4152     05  DIL-TYPE                PIC X       VALUE SPACES.
  4153     05  FILLER                  PIC X       VALUE SPACES.
  4154     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4155     05  FILLER                  PIC XXX     VALUE SPACES.
  4156     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4157
  4158 01  DISPLAY-HD-1.
  4159     05  FILLER      PIC X       VALUE SPACES.
  4160     05  FILLER      PIC X(50)   VALUE SPACES.
  4161     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4162     05  FILLER      PIC X(51)   VALUE SPACES.
  4163     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4164
  4165 01  DISPLAY-HD-2.
  4166     05  FILLER                 PIC X       VALUE SPACE.
  4167     05  FILLER                 PIC X(57)   VALUE SPACES.
  4168     05  DIS-DATE               PIC X(8).
  4169     05  FILLER                 PIC X(66)   VALUE SPACES.
  4170
  4171 01  DISPLAY-LINE.
  4172     05  DL-FULL.
  4173         10  FILLER           PIC X       VALUE SPACE.
  4174         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4175         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4176
  4177 01  PRT-HDNGS SYNC.
  4178     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ECS010.cbl
  4179         16  FILLER      PIC X       VALUE '1'.
  4180         16  FILLER      PIC X(53)   VALUE SPACES.
  4181         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4182         16  FILLER      PIC X(48)   VALUE SPACES.
  4183         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4184     12  TR-HD-2.
  4185         16  FILLER      PIC X       VALUE SPACE.
  4186         16  FILLER      PIC X(47)   VALUE SPACES.
  4187         16  TRHDNM      PIC X(30).
  4188         16  FILLER      PIC X(42)   VALUE SPACES.
  4189         16  TR-RN-DT    PIC X(8).
  4190     12  TR-HD-3.
  4191         16  FILLER      PIC X       VALUE SPACE.
  4192         16  FILLER      PIC X(53)   VALUE SPACES.
  4193         16  TR-MODAYR   PIC X(18).
  4194         16  FILLER      PIC X       VALUE SPACE.
  4195         16  TR-YRASK    PIC X       VALUE SPACE.
  4196         16  FILLER      PIC X(46)   VALUE SPACES.
  4197         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4198         16  TR-PG       PIC ZZ,ZZ9.
  4199     12  TR-HD-4.
  4200         16  FILLER      PIC X       VALUE SPACE.
  4201         16  TR-AGCY     PIC X(30).
  4202     12  TR-HD-5.
  4203         16  FILLER      PIC X       VALUE SPACE.
  4204         16  TR-CARR     PIC X.
  4205         16  FILLER      PIC X       VALUE '-'.
  4206         16  TR-GROUP    PIC X(6).
  4207         16  FILLER      PIC X       VALUE '-'.
  4208         16  TR-ST-NO    PIC X(2).
  4209         16  FILLER      PIC X       VALUE '-'.
  4210         16  TR-AG-NO    PIC X(10).
  4211         16  FILLER      PIC X(23)   VALUE SPACES.
  4212         16  TR5-RP-TYP.
  4213             20  FILLER  PIC X(20)   VALUE
  4214                     '* * * * TRANSACTION '.
  4215             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4216     12  TR-HD-6.
  4217         16  FILLER      PIC X       VALUE SPACE.
  4218         16  TR-CE-MO    PIC XX.
  4219         16  FILLER      PIC X       VALUE '-'.
  4220         16  TR-CE-DA    PIC XX.
  4221         16  FILLER      PIC X       VALUE '-'.
  4222         16  TR-CE-YR    PIC XX.
  4223         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4224         16  TR-CX.
  4225             20  TR-CX-MO PIC XX.
  4226             20  HSHR1    PIC X.
  4227             20  TR-CX-DA PIC XX.
  4228             20  HSHR2    PIC X.
  4229             20  TR-CX-YR PIC XX.
  4230     12  TR-HD-7.
  4231         16  FILLER  PIC X      VALUE '0'.
  4232         16  FILLER  PIC X(24)  VALUE SPACES.
  4233         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4234         16  TR-7-LF PIC X(6).
  4235         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4236         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ECS010.cbl
  4237         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4238         16  TR-7-AH PIC X(6).
  4239         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4240         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4241     12  TR-HD-8.
  4242         16  FILLER  PIC X      VALUE SPACE.
  4243         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4244         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4245         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4246         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4247         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4248     12  TR-HD-9.
  4249         16  FILLER  PIC X      VALUE SPACE.
  4250         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4251         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4252         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4253         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4254         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4255         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4256     12  TR-TTL-HD.
  4257         16  FILLER      PIC X       VALUE '0'.
  4258         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4259         16  FILLER      PIC XX      VALUE SPACES.
  4260         16  TTL-HD-DS   PIC X(60)   VALUE
  4261             'ECS010 CONTROL TOTALS'.
  4262
  4263 01  TR-DTL.
  4264     12  FILLER                  PIC X           VALUE SPACE.
  4265     12  TR-DTL1.
  4266         16  TRD-CERT            PIC X(11).
  4267         16  TRD-ISDT.
  4268             20  FILLER          PIC X           VALUE SPACE.
  4269             20  TRD-ISMO        PIC XX.
  4270             20  TRD-IS-S1       PIC X           VALUE '/'.
  4271             20  TRD-ISDA        PIC XX.
  4272             20  TRD-IS-S2       PIC X           VALUE '/'.
  4273             20  TRD-ISYR        PIC XX.
  4274             20  FILLER          PIC X           VALUE SPACE.
  4275         16  TRD-AGE             PIC XX.
  4276     12  TR-DTL2.
  4277         16  FILLER              PIC X           VALUE SPACE.
  4278         16  TRD-LFTYP           PIC XXX.
  4279         16  FILLER              PIC X           VALUE SPACE.
  4280         16  TRD-LFTRM           PIC ZZ9.
  4281         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4282         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4283         16  TRD-LFACTDT.
  4284             20  FILLER          PIC X           VALUE SPACE.
  4285             20  TRD-LFACTMO     PIC XX.
  4286             20  TRD-LF-S1       PIC X           VALUE '/'.
  4287             20  TRD-LFACTDA     PIC XX.
  4288             20  TRD-LF-S2       PIC X           VALUE '/'.
  4289             20  TRD-LFACTYR     PIC XX.
  4290             20  FILLER          PIC X           VALUE SPACE.
  4291         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4292         16  FILLER              PIC X           VALUE SPACE.
  4293         16  TRD-LF-STATUS       PIC X.
  4294         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ECS010.cbl
  4295         16  TRD-AHTYP           PIC XXX.
  4296         16  FILLER              PIC X           VALUE SPACE.
  4297         16  TRD-AHTRM           PIC ZZ9.
  4298         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4299         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4300         16  TRD-AHACTDT.
  4301             20  FILLER          PIC X           VALUE SPACE.
  4302             20  TRD-AHACTMO     PIC XX.
  4303             20  TRD-AH-S1       PIC X           VALUE '/'.
  4304             20  TRD-AHACTDA     PIC XX.
  4305             20  TRD-AH-S2       PIC X           VALUE '/'.
  4306             20  TRD-AHACTYR     PIC XX.
  4307             20  FILLER          PIC X           VALUE SPACE.
  4308         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4309         16  FILLER              PIC X           VALUE SPACE.
  4310         16  TRD-AH-STATUS       PIC X.
  4311     12  TR-DTL3 REDEFINES TR-DTL2.
  4312         16  FILLER              PIC X(20).
  4313         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4314         16  FILLER              PIC X.
  4315         16  TRD-IBNRX           PIC X(4).
  4316         16  FILLER              PIC X(2).
  4317         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4318         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4319                                 PIC X(11).
  4320         16  FILLER              PIC X.
  4321         16  TRD-PAYCURX         PIC X(8).
  4322         16  FILLER              PIC X(2).
  4323         16  TRD-FUTRSV-DATA.
  4324             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4325             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4326                                 PIC X(11).
  4327             20  FILLER          PIC X.
  4328             20  TRD-FUTRSVX     PIC X(6).
  4329         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4330             20  TRD-BENEFIT-X   PIC X(10).
  4331             20  TRD-BENEFIT-CODE
  4332                                 PIC X(02).
  4333             20  FILLER          PIC X(06).
  4334         16  FILLER              PIC X(4).
  4335         16  TRD-RSV-DESC        PIC X(6).
  4336         16  TRD-RSV-ACTION      PIC X(21).
  4337
  4338 01  DET-PR-UREC.
  4339     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4340     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4341     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4342     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4343     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4344     12  DET-SEX             PIC X.
  4345     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4346     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4347     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4348     12  DET-PR-MEM          PIC X(12).
  4349     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4350     12  DET-PR-SS           PIC X(11).
  4351     12  FILLER              PIC XXX      VALUE SPACES.
  4352     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ECS010.cbl
  4353
  4354 01  DET-PR-UREC-2.
  4355     12  FILLER              PIC X        VALUE SPACE.
  4356     12  DET-LF-DESC         PIC XX.
  4357     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4358     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4359     12  FILLER              PIC X(4)     VALUE ' TO '.
  4360     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4361     12  FILLER              PIC X        VALUE SPACE.
  4362     12  DET-AH-DESC         PIC XX.
  4363     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4364     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4365     12  FILLER              PIC X(4)     VALUE ' TO '.
  4366     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4367     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4368     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4369     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4370     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4371     12  FILLER              PIC X(5)     VALUE SPACES.
  4372     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4373
  4374 01  DET-PR-UREC-3.
  4375     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4376     12  DET-IND-GRP         PIC X.
  4377     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4378     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4379     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4380     12  DET-POL-FORM        PIC X(12).
  4381     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4382     12  DET-LOAN-OFFICER    PIC XXX.
  4383     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4384     12  DET-USER-CODE       PIC X.
  4385     12  FILLER              PIC X(8)     VALUE SPACES.
  4386     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4387
  4388 01  DET-PR-UREC-4.
  4389     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4390     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4391     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4392     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4393     12  FILLER              PIC X(37)    VALUE SPACES.
  4394     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4395
  4396 01  DET-PR-UREC-5.
  4397     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4398     12  DET-LF-BEN-CD       PIC XX.
  4399     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4400     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4401     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4402     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4403     12  FILLER              PIC X(30)    VALUE SPACES.
  4404     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4405
  4406 01  DET-PR-UREC-6.
  4407     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4408     12  DET-AH-BEN-CD       PIC XX.
  4409     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4410     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ECS010.cbl
  4411     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4412     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4413     12  FILLER              PIC X(30)    VALUE SPACES.
  4414     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4415
  4416 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4417     88  WS-CHANGE-REC              VALUE 'Y'.
  4418
  4419 01  TOTAL-PAGE-HD1.
  4420     12  FILLER              PIC X               VALUE SPACE.
  4421     12  TPH1-TYPE           PIC X(8).
  4422     12  TPH1-DESC.
  4423         16  TPH1-ST-CODE    PIC XX.
  4424         16  FILLER          PIC XXX.
  4425         16  TPH1-ST-DESC    PIC X(20).
  4426
  4427 01  TOTAL-PAGE-HD2.
  4428     12  FILLER              PIC X           VALUE SPACE.
  4429     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4430     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4431     12  FILLER              PIC X(9)        VALUE SPACES.
  4432     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4433     12  FILLER              PIC X(11)       VALUE SPACES.
  4434     12  FILLER              PIC X(3)        VALUE 'NET'.
  4435     12  FILLER              PIC X(11)       VALUE SPACES.
  4436     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4437     12  FILLER              PIC X(10)       VALUE SPACES.
  4438     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4439
  4440 01  TOTAL-PAGE-HD3.
  4441     12  FILLER              PIC X           VALUE SPACE.
  4442     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4443     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4444     12  FILLER              PIC X(10)       VALUE SPACES.
  4445     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4446     12  FILLER              PIC X(10)       VALUE SPACES.
  4447     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4448     12  FILLER              PIC X(7)        VALUE SPACES.
  4449     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4450     12  FILLER              PIC X(08)       VALUE SPACES.
  4451     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4452     12  FILLER              PIC X(11)       VALUE SPACES.
  4453     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4454
  4455 01  TOTAL-PAGE-DETAIL.
  4456     12  FILLER              PIC X(5).
  4457     12  TPD-DESC            PIC X(6).
  4458     12  FILLER              PIC X(3).
  4459     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4460     12  FILLER              PIC X(2).
  4461     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4462     12  FILLER              PIC X(2).
  4463     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4464     12  FILLER              PIC X(2).
  4465     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4466     12  FILLER              PIC X(2).
  4467     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4468     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ECS010.cbl
  4469     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4470     12  FILLER              PIC X(4).
  4471     12  TPD-LO-CERT         PIC X(6).
  4472     12  FILLER              PIC X(2).
  4473     12  TPD-HI-CERT         PIC X(6).
  4474*    12  FILLER              PIC X.
  4475*    12  TPD-LO-CERT         PIC X(8).
  4476*    12  FILLER              PIC X.
  4477*    12  TPD-HI-CERT         PIC X(8).
  4478
  4479 01  DUPE-CERT-TABLE.
  4480     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4481         16  DUPE-ENTRY      PIC X(36).
  4482         16  DUPE-STATUS     PIC X(01).
  4483         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4484         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4485
  4486 01  MISMATCH-HEADING-1.
  4487     12  FILLER              PIC X           VALUE '1'.
  4488     12  FILLER              PIC X(45)       VALUE SPACES.
  4489     12  FILLER              PIC X(42)       VALUE
  4490             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4491     12  FILLER              PIC X(35)       VALUE SPACES.
  4492     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4493
  4494 01  MISMATCH-HEADING-2.
  4495     12  FILLER              PIC X           VALUE '0'.
  4496     12  FILLER              PIC X(44)       VALUE
  4497             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4498     12  FILLER              PIC X(44)       VALUE
  4499             'YPE      CERT IN CONTROL                    '.
  4500     12  FILLER              PIC X(44)       VALUE
  4501             '        CERT OUT CONTROL           STATUS   '.
  4502
  4503 01  MISMATCH-DETAIL.
  4504     12  FILLER              PIC X           VALUE '0'.
  4505     12  FILLER              PIC X           VALUE SPACES.
  4506     12  DTL-MATCH-CONTROL   PIC X(36).
  4507     12  FILLER              PIC X(3)        VALUE SPACES.
  4508     12  DTL-REC-TYPE        PIC X.
  4509     12  FILLER              PIC X(2)        VALUE SPACES.
  4510     12  DTL-REC-TYPE-DESC   PIC X(3).
  4511     12  FILLER              PIC X(3)        VALUE SPACES.
  4512     12  DTL-CERT-IN-CONTROL
  4513                             PIC X(36).
  4514     12  FILLER              PIC X           VALUE SPACES.
  4515     12  DTL-CERT-OUT-CONTROL
  4516                             PIC X(36).
  4517     12  FILLER              PIC X           VALUE SPACES.
  4518     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4519     12  FILLER              PIC X(2)        VALUE SPACES.
  4520
  4521 01  MISMATCH-DETAIL-2.
  4522     12  FILLER              PIC X           VALUE ' '.
  4523     12  FILLER              PIC X           VALUE SPACES.
  4524     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4525             ' LIFE PREMIUM = '.
  4526     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* ECS010.cbl
  4527     12  FILLER              PIC X           VALUE SPACES.
  4528     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4529             'LIFE ALT PREM = '.
  4530     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4531     12  FILLER              PIC XX          VALUE SPACES.
  4532     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4533             'A/H PREMIUM = '.
  4534     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4535     12  FILLER              PIC X(39)       VALUE SPACES.
  4536
  4537 01  MISMATCH-DETAIL-3.
  4538     12  FILLER              PIC X           VALUE ' '.
  4539     12  FILLER              PIC X           VALUE SPACES.
  4540     12  FILLER              PIC X(16)       VALUE
  4541             ' LIFE  REFUND = '.
  4542     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4543     12  FILLER              PIC X           VALUE SPACES.
  4544     12  FILLER              PIC X(16)       VALUE
  4545             'A & H  REFUND = '.
  4546     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4547     12  FILLER              PIC X(72)       VALUE SPACES.
  4548
  4549 01  MISMATCH-DETAIL-4.
  4550     12  FILLER              PIC X           VALUE ' '.
  4551     12  FILLER              PIC X           VALUE SPACES.
  4552     12  FILLER              PIC X(16)       VALUE
  4553             ' LIFE  CLAIM  = '.
  4554     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4555     12  FILLER              PIC X           VALUE SPACES.
  4556     12  FILLER              PIC X(16)       VALUE
  4557             'A & H  CLAIM  = '.
  4558     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4559     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* ECS010.cbl
  4561*
  4562*
  4563* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* ECS010.cbl
  4565 01  PB-STARTS-HERE              PIC X(48)
  4566       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4567
* 4568                             COPY ERCPNDB.
  4569******************************************************************
  4570*                                                                *
  4571*                                                                *
  4572*                            ERCPNDB.                            *
  4573*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4574*                            VMOD=2.025                          *
  4575*                                                                *
  4576*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4577*                                                                *
  4578******************************************************************
  4579*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4580*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4581******************************************************************
  4582*                                                                *
  4583*                                                                *
  4584*   FILE TYPE = VSAM,KSDS                                        *
  4585*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4586*                                                                *
  4587*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4588*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4589*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4590*                                                 RKP=13,LEN=36  *
  4591*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4592*                                      AND CHG-SEQ.)             *
  4593*                                                RKP=49,LEN=11   *
  4594*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4595*                                      AND CHG-SEQ.)             *
  4596*                                                RKP=60,LEN=15   *
  4597*                                                                *
  4598*   LOG = NO                                                     *
  4599*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4600******************************************************************
  4601******************************************************************
  4602*                   C H A N G E   L O G
  4603*
  4604* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4605*-----------------------------------------------------------------
  4606*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4607* EFFECTIVE    NUMBER
  4608*-----------------------------------------------------------------
  4609* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4610* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4611* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4612* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4613* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4614* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4615* 032306                   PEMA  ADD BOW LOAN NUMBER
  4616* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4617* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4618* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4619* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4620* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4621* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4622* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4623* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4624******************************************************************
  4625
  4626 01  PENDING-BUSINESS.
  4627     12  PB-RECORD-ID                     PIC XX.
  4628         88  VALID-PB-ID                        VALUE 'PB'.
  4629
  4630     12  PB-CONTROL-PRIMARY.
  4631         16  PB-COMPANY-CD                PIC X.
  4632         16  PB-ENTRY-BATCH               PIC X(6).
  4633         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4634         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4635
  4636     12  PB-CONTROL-BY-ACCOUNT.
  4637         16  PB-COMPANY-CD-A1             PIC X.
  4638         16  PB-CARRIER                   PIC X.
  4639         16  PB-GROUPING.
  4640             20  PB-GROUPING-PREFIX       PIC XXX.
  4641             20  PB-GROUPING-PRIME        PIC XXX.
  4642         16  PB-STATE                     PIC XX.
  4643         16  PB-ACCOUNT.
  4644             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4645             20  PB-ACCOUNT-PRIME         PIC X(6).
  4646         16  PB-CERT-EFF-DT               PIC XX.
  4647         16  PB-CERT-NO.
  4648             20  PB-CERT-PRIME            PIC X(10).
  4649             20  PB-CERT-SFX              PIC X.
  4650         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4651
  4652         16  PB-RECORD-TYPE               PIC X.
  4653             88  PB-MAILING-DATA                VALUE '0'.
  4654             88  PB-ISSUE                       VALUE '1'.
  4655             88  PB-CANCELLATION                VALUE '2'.
  4656             88  PB-BATCH-TRAILER               VALUE '9'.
  4657
  4658     12  PB-CONTROL-BY-ORIG-BATCH.
  4659         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4660         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4661         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4662         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4663
  4664     12  PB-CONTROL-BY-CSR.
  4665         16  PB-CSR-COMPANY-CD            PIC X.
  4666         16  PB-CSR-ID                    PIC X(4).
  4667         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4668         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4669         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4670******************************************************************
  4671*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4672******************************************************************
  4673
  4674     12  PB-LAST-MAINT-DT                 PIC XX.
  4675     12  PB-LAST-MAINT-BY                 PIC X(4).
  4676     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4677
  4678     12  PB-RECORD-BODY                   PIC X(375).
  4679
  4680     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4681         16  PB-CERT-ORIGIN               PIC X.
  4682             88  CLASIC-CREATED-CERT         VALUE '1'.
  4683         16  PB-I-NAME.
  4684             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4685             20  PB-I-INSURED-FIRST-NAME.
  4686                 24  PB-I-INSURED-1ST-INIT PIC X.
  4687                 24  FILLER                PIC X(9).
  4688             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4689         16  PB-I-AGE                     PIC S99   COMP-3.
  4690         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4691         16  PB-I-BIRTHDAY                PIC XX.
  4692         16  PB-I-INSURED-SEX             PIC X.
  4693             88  PB-SEX-MALE     VALUE 'M'.
  4694             88  PB-SEX-FEMALE   VALUE 'F'.
  4695
  4696         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4697         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4698         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4699         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4700         16  PB-I-SKIP-CODE               PIC X.
  4701             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4702             88  PB-SKIP-JULY              VALUE '1'.
  4703             88  PB-SKIP-AUGUST            VALUE '2'.
  4704             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4705             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4706             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4707             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4708             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4709             88  PB-SKIP-JUNE              VALUE '8'.
  4710             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4711             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4712             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4713         16  PB-I-TERM-TYPE               PIC X.
  4714             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4715             88  PB-PAID-WEEKLY            VALUE 'W'.
  4716             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4717             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4718             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4719         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4720         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4721         16  PB-I-DATA-ENTRY-SW           PIC X.
  4722             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4723             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4724             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4725             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4726         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4727         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4728*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4729         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4730         16  FILLER                       PIC X.
  4731
  4732         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4733             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4734             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4735                                                   '90' THRU '99'.
  4736         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4737                                          PIC XX.
  4738         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4739         16  PB-I-AMOUNT-FINANCED REDEFINES
  4740                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4741         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4742         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4743                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4744         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4745         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4746         16  PB-I-CLP-AMOUNT REDEFINES
  4747                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4748         16  PB-I-LF-CALC-FLAG            PIC X.
  4749             88 PB-COMP-LF-PREM               VALUE '?'.
  4750         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4751         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4752         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4753         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4754         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4755         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4756         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4757         16  PB-I-LF-ABBR                 PIC XXX.
  4758         16  PB-I-LF-INPUT-CD             PIC XX.
  4759
  4760         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4761             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4762             88  PB-INVALID-AH               VALUE '  ' '00'
  4763                                                   '90' THRU '99'.
  4764         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4765         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4766         16  PB-I-AH-CALC-FLAG            PIC X.
  4767             88 PB-COMP-AH-PREM                  VALUE '?'.
  4768         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4769         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4770         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4771         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4772         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4773         16  PB-I-AH-ABBR                 PIC XXX.
  4774         16  PB-I-AH-INPUT-CD             PIC XXX.
  4775
  4776         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4777         16  PB-I-REIN-TABLE              PIC XXX.
  4778         16  PB-I-BUSINESS-TYPE           PIC 99.
  4779         16  PB-I-INDV-GRP-CD             PIC X.
  4780         16  PB-I-MORT-CODE.
  4781             20  PB-I-TABLE               PIC X.
  4782             20  PB-I-INTEREST            PIC XX.
  4783             20  PB-I-MORT-TYP            PIC X.
  4784         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4785         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4786         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4787         16  PB-I-INDV-GRP-OVRD           PIC X.
  4788         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4789         16  PB-I-SIG-SW                  PIC X.
  4790             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4791         16  PB-I-RATE-CLASS              PIC XX.
  4792         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4793         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4794         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4795         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4796         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4797         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4798         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4799         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4800         16  PB-I-OB-FLAG                 PIC X.
  4801             88  PB-I-OB                      VALUE 'B'.
  4802             88  PB-I-SUMMARY                 VALUE 'Z'.
  4803         16  PB-I-ENTRY-STATUS            PIC X.
  4804             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4805                                              'M' '5' '9' '2'.
  4806             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4807             88  PB-I-POLICY-PENDING          VALUE '2'.
  4808             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4809             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4810             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4811             88  PB-I-REIN-ONLY               VALUE '9'.
  4812             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4813             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4814             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4815             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4816         16  PB-I-INT-CODE                PIC X.
  4817             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4818             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4819         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4820         16  PB-I-SOC-SEC-NO              PIC X(11).
  4821         16  PB-I-MEMBER-NO               PIC X(12).
  4822         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4823*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4824         16  PB-I-OLD-LOF                 PIC XXX.
  4825         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4826         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4827         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4828         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4829         16  PB-I-LIFE-INDICATOR          PIC X.
  4830             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4831         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4832         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4833                                          PIC S9(5)V99    COMP-3.
  4834         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4835             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4836             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4837         16  PB-I-1ST-PMT-DT              PIC XX.
  4838         16  PB-I-JOINT-INSURED.
  4839             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4840             20 PB-I-JOINT-FIRST-NAME.
  4841                24  PB-I-JOINT-FIRST-INIT PIC X.
  4842                24  FILLER                PIC X(9).
  4843             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4844*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4845         16  PB-I-BENEFICIARY-NAME.
  4846             20  PB-I-BANK-NUMBER         PIC X(10).
  4847             20  FILLER                   PIC X(15).
  4848         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4849         16  PB-I-REFERENCE               PIC X(12).
  4850         16  FILLER REDEFINES PB-I-REFERENCE.
  4851             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4852             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4853             20  PB-I-CLP-STATE           PIC XX.
  4854         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4855             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4856             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4857             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4858         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4859         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4860         16  PB-I-RESIDENT-STATE          PIC XX.
  4861         16  PB-I-RATE-CODE               PIC X(4).
  4862         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4863         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4864         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4865         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4866         16  PB-I-BANK-NOCHRGB            PIC 99.
  4867         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4868         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4869
  4870     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4871         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4872             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4873         16  PB-C-CANCEL-ORIGIN           PIC X.
  4874             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4875         16  PB-C-LF-CANCEL-DT            PIC XX.
  4876         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4877         16  PB-C-LF-CALC-REQ             PIC X.
  4878             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4879         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4880         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4881         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4882             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4883         16  PB-C-AH-CANCEL-DT            PIC XX.
  4884         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4885         16  PB-C-AH-CALC-REQ             PIC X.
  4886             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4887         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4888         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4889         16  PB-C-LAST-NAME               PIC X(15).
  4890         16  PB-C-REFUND-SW               PIC X.
  4891             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4892             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4893         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4894         16  PB-C-PAYEE-CODE              PIC X(6).
  4895         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4896         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4897         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4898         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4899         16  PB-C-REFERENCE               PIC X(12).
  4900         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4901         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4902         16  PB-C-POST-CARD-IND           PIC X.
  4903         16  PB-C-CANCEL-REASON           PIC X.
  4904         16  PB-C-REF-INTERFACE-SW        PIC X.
  4905         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4906         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4907         16  FILLER                       PIC X(01).
  4908*        16  FILLER                       PIC X(18).
  4909         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4910*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4911         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4912         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4913             20  PB-CI-INSURED-NAME.
  4914                 24  PB-CI-LAST-NAME      PIC X(15).
  4915                 24  PB-CI-INITIALS       PIC XX.
  4916             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4917             20  PB-CI-INSURED-SEX        PIC X.
  4918             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4919             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4920             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4921             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4922             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4923             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4924             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4925             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4926             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4927             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4928             20  PB-CI-RATE-CLASS         PIC XX.
  4929             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4930             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4931             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4932             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4933             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4934             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4935             20  PB-CI-LF-ABBR            PIC X(3).
  4936             20  PB-CI-AH-ABBR            PIC X(3).
  4937             20  PB-CI-OB-FLAG            PIC X.
  4938                 88  PB-CI-OB                VALUE 'B'.
  4939             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4940                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4941                                           'M' '4' '5' '9' '2'.
  4942                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4943                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4944                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4945                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4946                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4947                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4948                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4949                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4950                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4951                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4952                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4953                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4954             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4955                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4956                                           'M' '4' '5' '9' '2'.
  4957                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4958                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4959                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4960                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4961                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4962                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4963                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4964                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4965                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4966                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4967                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4968                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4969             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4970             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4971             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4972             20  PB-CI-MEMBER-NO          PIC X(12).
  4973             20  PB-CI-INT-CODE           PIC X.
  4974                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4975                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4976             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4977             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4978             20  PB-CI-COMP-EXCP-SW       PIC X.
  4979                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4980                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4981             20  PB-CI-ENTRY-STATUS       PIC X.
  4982             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4983             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4984             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4985             20  PB-CI-DEATH-DT           PIC XX.
  4986             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4987             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4988             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4989             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4990             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4991             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4992             20  PB-CI-ENTRY-DT              PIC XX.
  4993             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4994             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4995             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4996             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4997             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4998             20  PB-CI-OLD-LOF               PIC XXX.
  4999*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5000             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5001             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5002             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5003             20  PB-CI-INDV-GRP-CD           PIC X.
  5004             20  PB-CI-BENEFICIARY-NAME.
  5005                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5006                 24  FILLER                  PIC X(15).
  5007             20  PB-CI-NOTE-SW               PIC X.
  5008             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5009             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5010             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5011             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5012             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5013             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5014             20  PB-CI-FIRST-NAME            PIC X(10).
  5015             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5016
  5017         16  FILLER                       PIC X(13).
  5018*032306  16  FILLER                       PIC X(27).
  5019*        16  FILLER                       PIC X(46).
  5020
  5021     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5022         16  FILLER                       PIC X(10).
  5023         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5024         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5025         16  PB-M-INSURED-MID-INIT        PIC X.
  5026         16  PB-M-INSURED-AGE             PIC 99.
  5027         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5028         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5029         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5030         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5031         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5032         16  PB-M-INSURED-CITY-STATE.
  5033             20  PB-M-INSURED-CITY        PIC X(28).
  5034             20  PB-M-INSURED-STATE       PIC XX.
  5035         16  PB-M-INSURED-ZIP-CODE.
  5036             20  PB-M-INSURED-ZIP-PRIME.
  5037                 24  PB-M-INSURED-ZIP-1   PIC X.
  5038                     88  PB-M-CANADIAN-POST-CODE
  5039                                             VALUE 'A' THRU 'Z'.
  5040                 24  FILLER               PIC X(4).
  5041             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5042         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5043                                        PB-M-INSURED-ZIP-CODE.
  5044             20  PM-M-INS-CAN-POST1       PIC XXX.
  5045             20  PM-M-INS-CAN-POST2       PIC XXX.
  5046             20  FILLER                   PIC XXX.
  5047         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5048         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5049         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5050         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5051         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5052         16  PB-M-CRED-BENE-CITYST.
  5053             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5054             20  PB-M-CRED-BENE-STATE     PIC XX.
  5055
  5056         16  FILLER                       PIC X(92).
  5057
  5058     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5059         16  FILLER                       PIC X(10).
  5060         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5061         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5062         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5063         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5064         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5065         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5066         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5067         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5068         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5069         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5070         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5071         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5072         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5073         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5074         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5075         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5076         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5077         16  PB-ACCOUNT-NAME              PIC X(30).
  5078         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5079         16  PB-REFERENCE                 PIC X(12).
  5080         16  PB-B-RECEIVED-DT             PIC XX.
  5081         16  FILLER                       PIC X(234).
  5082
  5083     12  PB-RECORD-STATUS.
  5084         16  PB-CREDIT-SELECT-DT          PIC XX.
  5085         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5086         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5087         16  PB-BILLING-STATUS            PIC X.
  5088             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5089             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5090             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5091         16  PB-RECORD-BILL               PIC X.
  5092             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5093             88  PB-RECORD-RETURNED           VALUE 'R'.
  5094             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5095             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5096             88  PB-OVERRIDE-AH               VALUE 'A'.
  5097             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5098         16  PB-BATCH-ENTRY               PIC X.
  5099             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5100             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5101             88  PB-REISSUED-CERT             VALUE 'E'.
  5102             88  PB-MONTHLY-CERT              VALUE 'M'.
  5103             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5104             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5105             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5106         16  PB-FORCE-CODE                PIC X.
  5107             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5108             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5109             88  PB-CANCEL-FORCE              VALUE '8'.
  5110             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5111             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5112             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5113             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5114             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5115             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5116             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5117         16  PB-FATAL-FLAG                PIC X.
  5118             88  PB-FATAL-ERRORS              VALUE 'X'.
  5119         16  PB-FORCE-ER-CD               PIC X.
  5120             88  PB-FORCE-ERRORS              VALUE 'F'.
  5121             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5122         16  PB-WARN-ER-CD                PIC X.
  5123             88  PB-WARNING-ERRORS            VALUE 'W'.
  5124         16  FILLER                       PIC X.
  5125         16  PB-OUT-BAL-CD                PIC X.
  5126             88  PB-OUT-OF-BAL                VALUE 'O'.
  5127         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5128         16  PB-AH-OVERRIDE-L1            PIC X.
  5129         16  PB-INPUT-DT                  PIC XX.
  5130         16  PB-INPUT-BY                  PIC X(4).
  5131         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5132         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5133         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5134         16  PB-LF-EARNING-METHOD         PIC X.
  5135         16  PB-AH-EARNING-METHOD         PIC X.
  5136         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5137         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5138         16  PB-REIN-CD                   PIC XXX.
  5139         16  PB-LF-REFUND-TYPE            PIC X.
  5140         16  PB-AH-REFUND-TYPE            PIC X.
  5141         16  PB-ACCT-EFF-DT               PIC XX.
  5142         16  PB-ACCT-EXP-DT               PIC XX.
  5143         16  PB-COMPANY-ID                PIC X(3).
  5144         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5145         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5146         16  PB-SV-CARRIER                PIC X.
  5147         16  PB-SV-GROUPING               PIC X(6).
  5148         16  PB-SV-STATE                  PIC XX.
  5149         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5150         16  PB-GA-BILLING-INFO.
  5151             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5152                                          PIC XX.
  5153         16  PB-SV-REMIT-TO  REDEFINES
  5154             PB-GA-BILLING-INFO           PIC X(10).
  5155         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5156         16  PB-I-LOAN-OFFICER            PIC X(5).
  5157         16  PB-I-VIN                     PIC X(17).
  5158
  5159         16  FILLER                       PIC X(04).
  5160         16  IMNET-BYPASS-SW              PIC X.
  5161
  5162******************************************************************
  5163*                COMMON EDIT ERRORS                              *
  5164******************************************************************
  5165
  5166     12  PB-COMMON-ERRORS.
  5167         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5168                                           PIC S9(4)     COMP.
  5169
  5170******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 102
* ECS010.cbl
  5172 01  PC-STARTS-HERE              PIC X(48)
  5173       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5174
* 5175                             COPY ERCPNDC.
  5176******************************************************************04/29/98
  5177*                                                                *ERCPNDC
  5178*                                                                *ERCPNDC
  5179*                            ERCPNDC                             *   LV003
  5180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5181*                            VMOD=2.004                          *   CL**2
  5182*                                                                *ERCPNDC
  5183*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5184*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5185*                                                                *ERCPNDC
  5186*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5187*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5188*                                                                *ERCPNDC
  5189*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5190*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5191*                                                                *ERCPNDC
  5192*   LOG = YES                                                    *ERCPNDC
  5193*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5194******************************************************************ERCPNDC
  5195                                                                  ERCPNDC
  5196 01  PENDING-CLAIMS.                                              ERCPNDC
  5197     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5198         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5199                                                                  ERCPNDC
  5200     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5201         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5202         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5203         16  PC-GROUPING.                                         ERCPNDC
  5204             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5205             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5206         16  PC-STATE                     PIC XX.                 ERCPNDC
  5207         16  PC-ACCOUNT.                                          ERCPNDC
  5208             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5209             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5210         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5211         16  PC-CERT-NO.                                          ERCPNDC
  5212             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5213             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5214         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5215         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5216                                                                  ERCPNDC
  5217         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5218             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5219             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5220         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5221                                                                  ERCPNDC
  5222     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5223     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5224     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5225                                                                  ERCPNDC
  5226     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5227         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5228             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5229             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 103
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5230             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5231             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5232         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5233         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5234         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5235         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5236         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5237         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5238         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5239         16  FILLER                       PIC XX.                 ERCPNDC
  5240         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5241             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5242             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5243             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5244             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5245             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5246             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5247             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5248                                                                  ERCPNDC
  5249         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5250         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5251         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5252         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5253                                                                  ERCPNDC
  5254         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5255         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5256         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5257                                                                  ERCPNDC
  5258         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5259             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5260                                                                  ERCPNDC
  5261         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5262         16  FILLER                       PIC X(48).              ERCPNDC
  5263                                                                  ERCPNDC
  5264         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5265             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5266                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5267                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5268             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5269             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5270             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5271             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5272             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5273             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5274             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5275             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5276             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5277             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5278             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5279             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5280             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5281                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5282             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5283                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5284                                               '4' '5' '9' '2'.   ERCPNDC
  5285                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5286                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5287                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5288                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5289                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5290                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5291                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5292                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5293                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5294             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5295                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5296                                               '4' '5' '9' '2'.   ERCPNDC
  5297                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5298                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5299                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5300                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5301                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5302                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5303                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5304                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5305                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5306             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5307             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5308             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5309             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5310             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5311                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5312                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5313             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5314             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5315             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5316             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5317             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5318             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5319             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5320             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5321         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5322         16  PC-CC-CLP-STATE              PIC XX.
  5323         16  FILLER                       PIC X(14).              ERCPNDC
  5324         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5325         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5326         16  FILLER                       PIC X(34).              ERCPNDC
  5327                                                                  ERCPNDC
  5328     12  PC-RECORD-STATUS.                                        ERCPNDC
  5329         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5330         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5331         16  FILLER                       PIC XX.                 ERCPNDC
  5332         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5333             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5334         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5335             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5336             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5337                                                     '8'.         ERCPNDC
  5338         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5339             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5340             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5341         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5342             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5343         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5344         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5345         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5346         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5347             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5348         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5349         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5350                                                                  ERCPNDC
  5351     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5352         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5353             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5354         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5355             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5356                                                                  ERCPNDC
  5357     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5358         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5359                                                                  ERCPNDC
  5360     12  FILLER                           PIC X(25).              ERCPNDC
  5361                                                                  ERCPNDC
  5362******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 106
* ECS010.cbl
  5364 01  CC-STARTS-HERE              PIC X(48)
  5365       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5366
* 5367                             COPY ERCCRTC.
  5368******************************************************************04/29/98
  5369*                                                                *ERCCRTC
  5370*                                                                *ERCCRTC
  5371*                            ERCCRTC                             *   LV003
  5372*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5373*                            VMOD=2.005                          *   CL**3
  5374*                                                                *ERCCRTC
  5375*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5376*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5377*                       ISSUES AND CANCELS)                      *ERCCRTC
  5378*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5379*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5380*                                                                *ERCCRTC
  5381*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5382*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5383*                                                                *ERCCRTC
  5384*   LOG = YES                                                    *ERCCRTC
  5385*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5386******************************************************************ERCCRTC
  5387*                   C H A N G E   L O G
  5388*
  5389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5390*-----------------------------------------------------------------
  5391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5392* EFFECTIVE    NUMBER
  5393*-----------------------------------------------------------------
  5394* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5395******************************************************************
  5396 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5397     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5398         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5399                                                                  ERCCRTC
  5400     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5401         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5402         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5403         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5404         16  CC-STATE                     PIC XX.                 ERCCRTC
  5405         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5406         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5407         16  CC-CERT-NO.                                          ERCCRTC
  5408             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5409             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5410                                                                  ERCCRTC
  5411         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5412                                                                  ERCCRTC
  5413     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5414     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5415     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5416                                                                  ERCCRTC
  5417     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5418                                                                  ERCCRTC
  5419     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5420         16  FILLER                       PIC X(10).              ERCCRTC
  5421         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 107
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5422             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5423             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5424                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5425                 24  FILLER               PIC X(9).               ERCCRTC
  5426             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5427         16  CC-AGE                       PIC S99.                ERCCRTC
  5428         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5429         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5430         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5431             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5432             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5433         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5434             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5435             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5436                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5437                 24  FILLER               PIC X(9).               ERCCRTC
  5438             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5439         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5440         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5441         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5442         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5443         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5444         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5445         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5446         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5447         16  CC-OLD-LOF                   PIC XXX.
  5448*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5449         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5450         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5451         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5452         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5453         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5454         16  FILLER                       PIC X(3).               ERCCRTC
  5455         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5456         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5457         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5458         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5459         16  CC-LOAN-OFFICER              PIC X(5).
  5460         16  FILLER                       PIC XXX.                ERCCRTC
  5461     12  CC-RECORD-STATUS.                                        ERCCRTC
  5462         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5463         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5464     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5465         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5466         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5467         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5468         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5469     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5470     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5471         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5472             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5473         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5474             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5475     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5476         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5477         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5478         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5479         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5480                                                                  ERCCRTC
  5481     12  FILLER                           PIC X(05).              ERCCRTC
  5482******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 109
* ECS010.cbl
  5484 01  CR-STARTS-HERE              PIC X(48)
  5485       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5486
* 5487                             COPY ECSCRT01.
  5488******************************************************************
  5489*                                                                *
  5490*                            ECSCRT01                            *
  5491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5492*                            VMOD=2.016                          *
  5493*                                                                *
  5494*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5495*                                                                *
  5496*   FILE TYPE = SEQUENTIAL
  5497*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5498*                                                                *
  5499*   KEY DATA =                         START=4, LEN=36           *
  5500*                                                                *
  5501*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5502*                                                                *
  5503******************************************************************
  5504******************************************************************
  5505*                   C H A N G E   L O G
  5506*
  5507* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5508*-----------------------------------------------------------------
  5509*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5510* EFFECTIVE    NUMBER
  5511*-----------------------------------------------------------------
  5512* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5513* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5514* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5515* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5516* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5517* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5518* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5519* 032612  CR2011110200001  PEMA  AHL CHANGES
  5520******************************************************************
  5521
  5522 01  CERTIFICATE-RECORD.
  5523     12  CR-RECORD-ID                      PIC XX.
  5524         88  VALID-CR-ID                      VALUE 'CR'.
  5525
  5526     12  CR-COMPANY-CD                     PIC X.
  5527
  5528     12  CR-FULL-CONTROL.
  5529         16  CR-CONTROL-1.
  5530             20  CR-ACCT-CONTROL.
  5531                 24  CR-CARRIER            PIC X.
  5532                 24  CR-GROUPING.
  5533                     28  CR-GROUP-PREFIX   PIC XXX.
  5534                     28  CR-GROUP-PRIME    PIC XXX.
  5535                 24  CR-STATE              PIC XX.
  5536                 24  CR-ACCOUNT.
  5537                     28  CR-ACCT-PREFIX    PIC X(4).
  5538                     28  CR-ACCT-PRIME     PIC X(6).
  5539             20  CR-DT                     PIC 9(11)  COMP-3.
  5540         16  CR-CERT-NO.
  5541             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 110
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5542                 24  CR-CERT-PREFIX        PIC X(3).
  5543                 24  CR-CERT-PRIME         PIC X(7).
  5544             20  CR-CERT-SFX               PIC X.
  5545
  5546     12  CR-INSUREDS-PROFILE.
  5547         16  CR-NAME.
  5548             20  CR-LNAME                  PIC X(15).
  5549             20  CR-FNAME.
  5550                 24  CR-1ST-INITIAL        PIC X.
  5551                 24  FILLER                PIC X(9).
  5552             20  CR-INIT                   PIC X.
  5553         16  CR-AGE                        PIC 99.
  5554         16  CR-SEX                        PIC X.
  5555             88  CR-SEX-MALE                  VALUE 'M'.
  5556             88  CR-SEX-FEMALE                VALUE 'F'.
  5557         16  CR-SOC-SEC                    PIC X(11).
  5558         16  CR-JOINT-NAME.
  5559             20  CR-JT-LNAME               PIC X(15).
  5560             20  CR-JT-FNAME.
  5561                 24  CR-JT-1ST-INIT        PIC X.
  5562                 24  FILLER                PIC X(9).
  5563             20  CR-JT-INIT                PIC X.
  5564         16  CR-JOINT-AGE                  PIC 99.
  5565
  5566         16  cr-ahl-ah-claim-no            pic x(9).
  5567         16  cr-ahl-ah-cert-seq            pic x(3).
  5568         16  cr-hst-proc-lf                pic x.
  5569         16  f                             pic x(7).
  5570
  5571     12  CR-LF-COVERAGE-DATA.
  5572         16  CR-LFTYP                      PIC XX.
  5573         16  CR-LF-TERM                    PIC S999       COMP-3.
  5574         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5575         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5576         16  CR-LF-DEV-CODE                PIC XXX.
  5577         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5578
  5579         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5580         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5581         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5582         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5583
  5584         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5585         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5586         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5587         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5588
  5589         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5590         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5591
  5592         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5593         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5594
  5595         16  CR-LF-REFUND-TYPE             PIC X.
  5596         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5597
  5598         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5599             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5600
  5601         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5602
  5603         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5604         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5605         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5606
  5607         16  cr-ahl-lf-claim-no            pic x(9).
  5608         16  cr-ahl-lf-cert-seq            pic x(3).
  5609         16  FILLER                        PIC XX.
  5610
  5611     12  CR-AH-COVERAGE-DATA.
  5612         16  CR-AHTYP                      PIC XX.
  5613         16  CR-AH-TERM                    PIC S999       COMP-3.
  5614         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5615         16  CR-AH-DEV-CODE                PIC XXX.
  5616         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5617
  5618         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5619         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5620         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5621         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5622
  5623         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5624         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5625
  5626         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5627         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5628
  5629         16  CR-AH-REFUND-TYPE             PIC X.
  5630         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5631
  5632         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5633             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5634
  5635         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5636
  5637         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5638         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5639         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5640
  5641         16  FILLER                        PIC XX.
  5642*        16  FILLER                        PIC X(8).
  5643
  5644     12  CR-LOAN-DATA.
  5645         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5646         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5647                                           PIC S9(5)V99   COMP-3.
  5648         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5649         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5650         16  CR-PMT-FREQ                   PIC 99.
  5651         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5652         16  CR-RATING-CLASS               PIC XX.
  5653         16  CR-POLICY-FORM-NO             PIC X(12).
  5654         16  CR-GRPTYP                     PIC XX.
  5655         16  CR-IND-GRP                    PIC X.
  5656             88  CR-INDIVIDUAL                VALUE '1'.
  5657             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5658         16  CR-SKIP                       PIC 99.
  5659             88  NO-MONTHS-SKIPPED            VALUE 00.
  5660             88  SKIP-JULY                    VALUE 01.
  5661             88  SKIP-AUGUST                  VALUE 02.
  5662             88  SKIP-SEPTEMBER               VALUE 03.
  5663             88  SKIP-JULY-AUG                VALUE 04.
  5664             88  SKIP-AUG-SEPT                VALUE 05.
  5665             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5666             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5667             88  SKIP-JUNE                    VALUE 08.
  5668             88  SKIP-JUNE-JULY               VALUE 09.
  5669             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5670             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5671         16  CR-RESIDENT-STATE             PIC XX.
  5672         16  CR-RATE-CODE.
  5673             20  CR-LF-CLASS-CD            PIC XX.
  5674             20  CR-AH-CLASS-CD            PIC XX.
  5675         16  CR-MORT.
  5676             20  CR-TAB                    PIC X.
  5677             20  CR-INT                    PIC 99.
  5678             20  CR-GRP                    PIC X.
  5679         16  CR-MEMBER-NO                  PIC X(12).
  5680         16  CR-OLD-LOF                    PIC XXX.
  5681*        16  CR-LOAN-OFFICER               PIC XXX.
  5682         16  CR-REIN-TABLE                 PIC XXX.
  5683         16  CR-REIN-SPEC                  PIC X.
  5684         16  CR-LOAN-1ST-PMT-DT.
  5685             20  CR-1ST-PMT-YR             PIC 99.
  5686             20  CR-1ST-PMT-MO             PIC 99.
  5687             20  CR-1ST-PMT-DA             PIC 99.
  5688         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5689         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5690         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5691         16  CR-LAST-ADD-ON-DT             PIC XX.
  5692
  5693         16  CR-UNDERWRITING-CODE          PIC X.
  5694             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5695
  5696         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5697         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5698         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5699         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5700
  5701     12  CR-STATUS-INFORMATION.
  5702         16  CR-ENTRY-STATUS               PIC X.
  5703             88  CR-NORMAL-ENTRY              VALUE '1'.
  5704             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5705             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5706             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5707             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5708             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5709             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5710             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5711             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5712             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5713                                                    '5' '9' 'P'.
  5714         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5715
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5716         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5717         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5718         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5719
  5720         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5721         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5722
  5723         16  CR-LF-CURRENT-STATUS          PIC X.
  5724             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5725             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5726             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5727             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5728             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5729             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5730             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5731             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5732             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5733             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5734             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5735             88  CR-LF-IS-VOID                VALUE 'V'.
  5736             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5737                                                    '4' '5' '9'.
  5738
  5739         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5740
  5741         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5742         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5743
  5744         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5745         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5746
  5747         16  CR-AH-CURRENT-STATUS          PIC X.
  5748             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5749             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5750             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5751             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5752             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5753             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5754             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5755             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5756             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5757             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5758             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5759             88  CR-AH-IS-VOID                VALUE 'V'.
  5760             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5761                                                    '4' '5' '9'.
  5762         16  CR-LOAN-OFFICER               PIC X(5).
  5763         16  CR-CANCEL-REASON              PIC X.
  5764         16  cr-xycor-lf-cov-code          pic x(4).
  5765         16  cr-xycor-ah-cov-code          pic x(4).
  5766         16  FILLER                        PIC X(6).
  5767
  5768     12  CR-DEATH-CLAIM-DATA.
  5769         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5770
  5771         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5772         16  CR-DTH-RPT-DT.
  5773             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5774             20  CR-DTH-RPT-MO             PIC 99.
  5775             20  CR-DTH-RPT-DA             PIC 99.
  5776         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5777
  5778         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5779         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5780         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5781         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5782         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5783
  5784         16  CR-DTH-AGE                    PIC 99.
  5785         16  CR-DTH-PAY-CD                 PIC X.
  5786         16  CR-DEATH-CAUSE                PIC X(6).
  5787
  5788         16  FILLER                        PIC X(16).
  5789
  5790     12  CR-DISAB-CLAIM-DATA.
  5791         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5792
  5793         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5794         16  CR-DIS-RPT-DT.
  5795             20  CR-DIS-RPT-YR             PIC 99.
  5796             20  CR-DIS-RPT-MO             PIC 99.
  5797             20  CR-DIS-RPT-DA             PIC 99.
  5798         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5799         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5800
  5801         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5802         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5803         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5804         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5805         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5806
  5807         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5808         16  CR-DIS-PAY-CD                 PIC X.
  5809         16  FILLER                        PIC XX.
  5810
  5811         16  CR-DISAB-INCURRED-DETAIL.
  5812             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5813**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5814                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5815                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5816                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5817
  5818         16  CR-DISAB-CAUSE                PIC X(6).
  5819         16  FILLER                        PIC X(14).
  5820
  5821     12  CR-REMIT-TO                       PIC 99.
  5822
  5823     12  CR-COMPENSATION-LEVELS.
  5824         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5825             20  CR-COM-AGT.
  5826                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5827                 24  CR-COM-AGT-PRIME      PIC X(6).
  5828             20  CR-AGT-TYPE               PIC X.
  5829             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5830             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5831
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5832     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5833     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5834     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5835     12  CR-CLP-STATE                      PIC XX.
  5836     12  CR-POST-CARD-IND                  PIC X.
  5837     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5838     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5839     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5840     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5841     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5842     12  FILLER                            PIC X(07).
  5843
  5844     12  CR-CSR-CODE                       PIC XXX.
  5845
  5846     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5847     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5848
  5849     12  CR-MICROFILM-NUMBERS.
  5850*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5851         16  FILLER                        PIC X(5).
  5852     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5853
  5854     12  CR-USER-CODE                      PIC X.
  5855     12  CR-USER-FUTURE                    PIC X(9).
  5856
  5857     12  CR-BENEFICIARY.
  5858         16  CR-BANK-NO                    PIC X(10).
  5859         16  FILLER                        PIC X(15).
  5860
  5861     12  CR-ENTRY-BATCH                    PIC X(6).
  5862     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5863     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5864
  5865     12  CR-NOTE-SW                        PIC X.
  5866
  5867     12  CR-ORIGIN-INDICATOR               PIC X.
  5868         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5869         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5870
  5871     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5872     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5873     12  FILLER                            PIC X(33).
  5874
  5875******************************************************************
* 5876                             COPY ELCCRTVR.
  5877***************************************************************** 04/24/98
  5878*                                                                *ELCCRTVR
  5879*                                                                *ELCCRTVR
  5880*                            ELCCRTVR                            *   LV003
  5881*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5882*                            VMOD=2.001                          *ELCCRTVR
  5883*                                                                *ELCCRTVR
  5884*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5885*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5886*                                                                *ELCCRTVR
  5887******************************************************************ELCCRTVR
  5888                                                                  ELCCRTVR
  5889 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5890     05  WS-CR-DT.                                                ELCCRTVR
  5891         10  FILLER                PIC 999.                       ELCCRTVR
  5892         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5893         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5894             15  CR-CC             PIC 99.                        ELCCRTVR
  5895             15  CR-YR             PIC 99.                        ELCCRTVR
  5896         10  CR-MO                 PIC 99.                        ELCCRTVR
  5897         10  CR-DA                 PIC 99.                        ELCCRTVR
  5898     05  WS-CR-DT-N REDEFINES                                        CL**2
  5899            WS-CR-DT               PIC 9(11).                        CL**2
  5900     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5901         10  FILLER                    PIC 999.                   ELCCRTVR
  5902         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5903         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5904             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5905             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5906         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5907         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5908     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5909            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5910     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5911         10  FILLER                    PIC 999.                   ELCCRTVR
  5912         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5913         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5914             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5915             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5916         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5917         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5918     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5919            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5920     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5921         10  FILLER                    PIC 999.                   ELCCRTVR
  5922         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5923         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5924             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5925             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5926         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5927         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5928     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5929            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5930     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5931         10  FILLER                    PIC 999.                   ELCCRTVR
  5932         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5933         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5934             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5935             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5936         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5937         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5938     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5939            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5940     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5941         10  FILLER                    PIC 999.                   ELCCRTVR
  5942         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5943         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5944             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5945             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5946         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5947         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5948     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5949            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5950     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5951         10  FILLER                    PIC 999.                   ELCCRTVR
  5952         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5953         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5954             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5955             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5956         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5957         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5958     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5959            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5960     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5961         10  FILLER                    PIC 999.                   ELCCRTVR
  5962         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5963         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5964             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5965             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5966         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5967         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5968     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5969            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5970     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5971         10  FILLER                    PIC 999.                   ELCCRTVR
  5972         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5973         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5974             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5975             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5976         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5977         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5978     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5979            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5980     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5981         10  FILLER                    PIC 999.                   ELCCRTVR
  5982         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5983         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5984             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5985             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5986         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5987         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5988     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5989          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5990     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5991         10  FILLER                    PIC 999.                   ELCCRTVR
  5992         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5993         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5994             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5995             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5996         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5997         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5998     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  5999            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6000     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6001         10  FILLER                    PIC 999.                   ELCCRTVR
  6002         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6003         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6004             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6005             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6006         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6007         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6008     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6009            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6010     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6011         10  FILLER                    PIC 999.                   ELCCRTVR
  6012         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6013         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6014             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6015             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6016         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6017         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6018     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6019            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6020     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6021         10  FILLER                    PIC 999.                   ELCCRTVR
  6022         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6023         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6024             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6025             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6026         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6027         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6028     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6029            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6030     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6031         10  FILLER                    PIC 999.                   ELCCRTVR
  6032         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6033         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6034             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6035             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6036         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6037         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6038     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6039            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6040     05  COPY-NDX                      PIC 9.                        CL**6
  6041     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6042         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6043             15  FILLER                PIC 999.                   ELCCRTVR
  6044             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6045             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6046                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6047                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6048             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6049             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6050         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6051                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6052
  6053 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 119
* ECS010.cbl
* 6055                             COPY ELCDATE.
  6056******************************************************************06/11/98
  6057*                                                                *ELCDATE
  6058*                                                                *ELCDATE
  6059*                            ELCDATE.                            *   LV023
  6060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6061*                            VMOD=2.003                           ELCDATE
  6062*                                                                *ELCDATE
  6063*                                                                *ELCDATE
  6064*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6065*                 LENGTH = 200                                   *   CL*19
  6066******************************************************************ELCDATE
  6067                                                                  ELCDATE
  6068 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6069     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6070     12  DC-OPTION-CODE                PIC X.                        CL*15
  6071         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6072         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6073         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6074         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6075         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6076         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6077         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6078         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6079         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6080         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6081         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6082         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6083         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6084         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6085         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6086         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6087         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6088         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6089         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6090         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6091         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6092         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6093         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6094         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6095         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6096         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6097         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6098         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6099         88  THREE-CHARACTER-BIN                                  ELCDATE
  6100                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6101         88  GREGORIAN-TO-BIN                                        CL**2
  6102                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6103         88  BIN-TO-GREGORIAN                                        CL**2
  6104                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6105         88  JULIAN-TO-BINARY                                        CL**2
  6106                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6107     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6108         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6109         88  DATE-CONVERSION-ERROR                                ELCDATE
  6110                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6111         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6112         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 120
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6113         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6114         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6115         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6116         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6117         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6118         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6119         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6120         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6121     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6122         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6123     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6124         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6125         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6126         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6127     12  FILLER                        PIC X.                        CL*15
  6128     12  DC-CONVERSION-DATES.                                        CL*15
  6129         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6130         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6131         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6132         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6133                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6134             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6135             20  SLASH1-1              PIC X.                        CL*15
  6136             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6137             20  SLASH1-2              PIC X.                        CL*15
  6138             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6139         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6140         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6141                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6142             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6143             20  SLASH2-1              PIC X.                        CL*15
  6144             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6145             20  SLASH2-2              PIC X.                        CL*15
  6146             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6147         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6148         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6149                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6150             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6151             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6152             20  DC-YMD-DAY            PIC 99.                       CL*15
  6153         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6154         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6155                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6156             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6157             20  DC-MDY-DAY            PIC 99.                       CL*15
  6158             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6159         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6160             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6161             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6162             20  FILLER                PIC XX.                       CL*15
  6163             20  DC-ALPHA-CENTURY.                                   CL*15
  6164                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6165             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6166         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6167         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6168         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6169         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6170         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6171                                       PIC 9(05).                    CL*20
  6172         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6173             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6174             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6175         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6176         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6177         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6178     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6179         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6180         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6181             20  FILLER                PIC 9(3).                     CL*15
  6182             20  HOLD-CEN-1-CCYY.                                    CL*15
  6183                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6184                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6185             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6186             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6187         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6188             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6189             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6190             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6191                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6192                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6193             20  FILLER                PIC 9(3).                     CL*15
  6194         16  HOLD-CENTURY-1-X.                                       CL*15
  6195             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6196             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6197                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6198                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6199             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6200             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6201         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6202             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6203             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6204             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6205                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6206                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6207             20  FILLER                PIC XXX.                      CL*23
  6208         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6209         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6210         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6211         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6212             20  DC-JULIAN-1-CCYY.                                   CL*15
  6213                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6214                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6215             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6216         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6217         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6218             20  DC-JULIAN-2-CCYY.                                   CL*15
  6219                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6220                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6221             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6222         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6223             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6224             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6225             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6226             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6227             20  DC-EDITA-CCYY.                                      CL*15
  6228                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6229                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6230         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6231             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6232             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6233             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6234             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6235             20  DC-EDITB-CCYY.                                      CL*15
  6236                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6237                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6238         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6239         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6240                              DC-GREG-DATE-CYMD.                  ELCDATE
  6241             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6242             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6243             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6244             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6245         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6246         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6247                              DC-GREG-DATE-MDCY.                  ELCDATE
  6248             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6249             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6250             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6251             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6252    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6253        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6254    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6255    12  FILLER                         PIC X(28).                    CL*26
* 6256                             COPY ELCFUNDT.
  6257***************************************************************** 12/03/98
  6258*                                                               * ELCFUNDT
  6259*                            ELCFUNDT.                          *    LV004
  6260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6261*                            VMOD=2.001                         * ELCFUNDT
  6262*                                                               * ELCFUNDT
  6263*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6264*                                                               * ELCFUNDT
  6265***************************************************************** ELCFUNDT
  6266                                                                  ELCFUNDT
  6267                                                                  ELCFUNDT
  6268 01  FUNCTION-DATE.                                                  CL**2
  6269     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6270     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6271         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6272         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6273             15  WS-FN-CC          PIC 99.                           CL**3
  6274             15  WS-FN-YR          PIC 99.                           CL**3
  6275         10  WS-FN-MO              PIC 99.                           CL**3
  6276         10  WS-FN-DA              PIC 99.                           CL**3
  6277     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6278     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6279     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6280     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6281     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6282         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6283         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6284         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6285     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6286     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 123
* ECS010.cbl
  6287
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 124
* ECS010.cbl
  6289 01  CPA-STARTS-HERE             PIC X(48)
  6290       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6291                             COPY ELCCALC.
  6292******************************************************************04/15/98
  6293*                                                                *ELCCALC
  6294*                           ELCCALC.                            *    LV003
  6295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6296*                            VMOD=2.025                          *   CL**3
  6297*                                                                *   CL**2
  6298*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6299*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6300*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6301*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6302*                                                                *   CL**2
  6303*  PASSED TO ELRTRM                                              *   CL**2
  6304*  -----------------                                             *   CL**2
  6305*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6306*  ORIGINAL TERM                                                 *   CL**2
  6307*  BEGINNING DATE                                                *   CL**2
  6308*  ENDING DATE                                                   *   CL**2
  6309*  COMPANY I.D.                                                  *   CL**2
  6310*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6311*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6312*  FREE LOOK DAYS                                                *   CL**2
  6313*                                                                *   CL**2
  6314*  RETURNED FROM ELRTRM                                          *   CL**2
  6315*  ---------------------                                         *   CL**2
  6316*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6317*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6318*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6319*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6320*----------------------------------------------------------------*   CL**2
  6321*  PASSED TO ELRAMT                                              *   CL**2
  6322*  ----------------                                              *   CL**2
  6323*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6324*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6325*  ORIGINAL AMOUNT                                               *   CL**2
  6326*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6327*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6328*  METHOD                                                            CL**2
  6329*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6330*  COMPANY I.D.                                                  *   CL**2
  6331*  BENEFIT TYPE                                                  *   CL**2
  6332*                                                                *   CL**2
  6333*  RETURNED FROM ELRAMT                                          *   CL**2
  6334*  --------------------                                          *   CL**2
  6335*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6336*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6337*  REMAINING AMOUNT FACTOR                                           CL**2
  6338*----------------------------------------------------------------*   CL**2
  6339*  PASSED TO ELRESV                                              *   CL**2
  6340*  -----------------                                             *   CL**2
  6341*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6342*  VALUATION DATE                                                *   CL**2
  6343*  PAID THRU DATE                                                *   CL**2
  6344*  BENEFIT                                                       *   CL**2
  6345*  INCURRED DATE                                                 *   CL**2
  6346*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 125
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6347*  ISSUE AGE                                                     *   CL**2
  6348*  TERM                                                          *   CL**2
  6349*  CDT PERCENT                                                   *   CL**2
  6350*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6351* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6352* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6353* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6354*                                                                *   CL**2
  6355*  RETURNED FROM ELRESV                                          *   CL**2
  6356*  --------------------                                          *   CL**2
  6357*  CDT TABLE USED                                                *   CL**2
  6358*  CDT FACTOR USED                                               *   CL**2
  6359*  PAY TO CURRENT RESERVE                                        *   CL**2
  6360*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6361*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6362*----------------------------------------------------------------*   CL**2
  6363*  PASSED TO ELRATE                                              *   CL**2
  6364*  ----------------                                              *   CL**2
  6365*  CERT ISSUE DATE                                               *   CL**2
  6366*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6367*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6368*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6369*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6370*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6371*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6372*  DEVIATION CODE                                                *   CL**2
  6373*  ISSUE AGE                                                     *   CL**2
  6374*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6375*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6376*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6377*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6378*  A.P.R.                                                        *   CL**2
  6379*  METHOD                                                            CL**2
  6380*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6381*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6382*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6383*  BENEFIT CODE                                                  *   CL**2
  6384*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6385*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6386*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6387*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6388*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6389*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6390*                                                                *   CL**2
  6391*  RETURNED FROM ELRATE                                          *   CL**2
  6392*  --------------------                                          *   CL**2
  6393*  CALCULATED PREMIUM                                            *   CL**2
  6394*  PREMIUM RATE                                                  *   CL**2
  6395*  MORTALITY CODE                                                *   CL**2
  6396*  MAX ATTAINED AGE                                              *   CL**2
  6397*  MAX AGE                                                       *   CL**2
  6398*  MAX TERM                                                      *   CL**2
  6399*  MAX MONTHLY BENEFIT                                           *   CL**2
  6400*  MAX TOTAL BENIFIT                                             *   CL**2
  6401*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6402*----------------------------------------------------------------*   CL**2
  6403*  PASSED TO ELRFND                                              *   CL**2
  6404*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6405*  CERT ISSUE DATE                                               *   CL**2
  6406*  REFUND DATE                                                   *   CL**2
  6407*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6408*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6409*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6410*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6411*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6412*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6413*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6414*  DEVIATION CODE                                                *   CL**2
  6415*  ISSUE AGE                                                     *   CL**2
  6416*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6417*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6418*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6419*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6420*  A.P.R.                                                        *   CL**2
  6421*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6422*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6423*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6424*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6425*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6426*  BENEFIT CODE                                                  *   CL**2
  6427*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6428*                                                                *   CL**2
  6429*  RETURNED FROM ELRFND                                          *   CL**2
  6430*  --------------------                                          *   CL**2
  6431*  CALCULATED REFUND                                             *   CL**2
  6432*----------------------------------------------------------------*   CL**2
  6433*  PASSED TO ELEARN                                              *   CL**2
  6434*  ----------------                                              *   CL**2
  6435*  CERT ISSUE DATE                                               *   CL**2
  6436*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6437*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6438*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6439*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6440*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6441*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6442*  DEVIATION CODE                                                *   CL**2
  6443*  ISSUE AGE                                                     *   CL**2
  6444*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6445*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6446*  A.P.R.                                                        *   CL**2
  6447*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6448*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6449*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6450*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6451*  BENEFIT CODE                                                  *   CL**2
  6452*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6453*                                                                *   CL**2
  6454*  RETURNED FROM ELEARN                                          *   CL**2
  6455*  --------------------                                          *   CL**2
  6456*  INDICATED  EARNINGS                                           *   CL**2
  6457*----------------------------------------------------------------*   CL**2
  6458*                 LENGTH = 450                                   *   CL**2
  6459*                                                                *   CL**2
  6460******************************************************************   CL**2
  6461******************************************************************
  6462*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6463*
  6464* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6465*-----------------------------------------------------------------
  6466*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6467* EFFECTIVE    NUMBER
  6468*-----------------------------------------------------------------
  6469* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6470* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6471* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6472* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6473* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6474* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6475* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6476* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6477* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6478******************************************************************
  6479                                                                     CL**2
  6480 01  CALCULATION-PASS-AREA.                                          CL**2
  6481     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6482                                     COMP.                           CL**2
  6483                                                                     CL**2
  6484     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6485       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6486       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6487                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6488       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6489       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6490       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6491       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6492       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6493       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6494       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6495       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6496       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6497       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6498       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6499       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6500       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6501       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6502       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6503       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6504       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6505                                                                     CL**2
  6506     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6507       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6508***********************  INPUT AREAS ****************************    CL**2
  6509                                                                     CL**2
  6510     12  CP-CALCULATION-AREA.                                        CL**2
  6511         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6512         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6513         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6514         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6515         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6516           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6517                                                   'I' 'U'.          CL**2
  6518           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6519           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6520         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6521         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6522         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6523         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6524         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6525                                     COMP-3.                         CL**2
  6526         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6527                                     COMP-3.                         CL**2
  6528         16  CP-CDT-METHOD         PIC X.                            CL**2
  6529           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6530           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6531           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6532         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6533           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6534           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6535         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6536                                     COMP-3.                         CL**2
  6537         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6538                                     COMP-3.                         CL**2
  6539         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6540                                     COMP-3.                         CL**2
  6541         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6542                                     COMP-3.                         CL**2
  6543         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6544                                     COMP-3.                         CL**2
  6545         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6546                                     COMP-3.                         CL**2
  6547         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6548                                     COMP-3.                         CL**2
  6549         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6550           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6551           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6552           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6553           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6554           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6555           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6556           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6557         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6558           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6559           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6560           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6561           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6562           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6563           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6564           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6565           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6566           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6567           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6568           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6569           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6570           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6571           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6572         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6573           88  CP-CLAIM                            VALUE '1'.        CL**2
  6574           88  CP-CANCEL                           VALUE '2'.        CL**2
  6575           88  CP-ISSUE                            VALUE '3'.        CL**2
  6576         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6577           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6578           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6579           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6580           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6581           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6582           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6583           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6584           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6585           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6586           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6587           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6588           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6589           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6590           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6591           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6592           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6593           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6594           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6595                                                     'W' 'X'.        CL**2
  6596           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6597           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6598           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6599           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6600           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6601           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6602           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6603           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6604           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6605           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6606           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6607           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6608           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6609                                                                     CL**2
  6610         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6611                                     COMP-3.                         CL**2
  6612         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6613         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6614         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6615         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6616         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6617           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6618               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6619         16  CP-R78-OPTION         PIC X.                            CL**2
  6620           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6621           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6622                                                                     CL**2
  6623         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6624         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6625         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6626         16  CP-RATE-FILE          PIC X.                            CL**2
  6627         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6628                                     COMP-3.                         CL**2
  6629                                                                     CL**2
  6630         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6631         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6632                                                                     CL**2
  6633         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6634                                     COMP-3.
  6635         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6636                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6637         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6638                                     COMP-3.                         CL**2
  6639         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6640                                     COMP-3.                         CL**2
  6641         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6642                                     COMP-3.
  6643         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6644                                  PIC S9(7)V99 COMP-3.
  6645                                                                     CL**2
  6646         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6647         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6648         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6649           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6650           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6651           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6652           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6653         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6654         16  CP-CARRIER            PIC X.                            CL**2
  6655         16  CP-REIN-FLAG          PIC X.                            CL**2
  6656         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6657           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6658                      '2' '3' '4' '5'.                               CL**2
  6659           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6660           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6661           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6662           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6663           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6664           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6665           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6666           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6667         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6668         16  CP-RATING-METHOD      PIC X.                            CL**2
  6669           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6670           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6671           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6672           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6673           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6674           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6675           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6676           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6677           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6678         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6679                                     COMP-3.                         CL**2
  6680         16  CP-BEN-CATEGORY       PIC X.
  6681         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6682         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6683                                   PIC S99V9(5) COMP-3.
  6684         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6685         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6686                                   PIC S99V9(5) COMP-3.
  6687         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6688         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6689         16  CP-EXPIRE-DT          PIC XX.
  6690         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6691         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6692         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6693         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6694         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6695             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6696             88  CP-CALC-CLP              VALUE 'C'.
  6697         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6698         16  CP-CANCEL-REASON      PIC X.
  6699         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6700         16  CP-PMT-MODE           PIC X.
  6701         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6702         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6703         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6704         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6705         16  FILLER                PIC X.
  6706                                                                     CL**2
  6707***************    OUTPUT FROM ELRESV   ************************     CL**2
  6708                                                                     CL**2
  6709         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6710                                                                     CL**2
  6711         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6712                                     COMP-3.                         CL**2
  6713         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6714                                     COMP-3.                         CL**2
  6715         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6716                                     COMP-3.                         CL**2
  6717         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6718                                     COMP-3.                         CL**2
  6719         16  FILLER                PIC X(09).                        CL**2
  6720***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6721                                                                     CL**2
  6722         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6723                                     COMP-3.                         CL**2
  6724         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6725                                     COMP-3.                         CL**2
  6726         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6727                                     COMP-3.                         CL**2
  6728         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6729                                     COMP-3.                         CL**2
  6730         16  FILLER                PIC X(12).                        CL**2
  6731                                                                     CL**2
  6732***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6733                                                                     CL**2
  6734         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6735                                     COMP-3.                         CL**2
  6736         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6737                                     COMP-3.                         CL**2
  6738         16  FILLER                PIC X(12).                        CL**2
  6739                                                                     CL**2
  6740***************    OUTPUT FROM ELRATE   *************************    CL**2
  6741                                                                     CL**2
  6742         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6743                                     COMP-3.                         CL**2
  6744         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6745                                     COMP-3.                         CL**2
  6746         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6747         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6748             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6749         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6750                                     COMP-3.                         CL**2
  6751         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6752         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6753         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6754                                   PIC S9(7)V99 COMP-3.
  6755         16  FILLER                PIC X(07).                        CL**2
  6756                                                                     CL**2
  6757***************    OUTPUT FROM ELRFND   *************************    CL**2
  6758                                                                     CL**2
  6759         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6760                                     COMP-3.                         CL**2
  6761         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6762           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6763           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6764           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6765           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6766           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6767           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6768           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6769           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6770           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6771           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6772           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6773           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6774           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6775           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6776         16  FILLER                PIC X(12).                        CL**2
  6777                                                                     CL**2
  6778***************    OUTPUT FROM ELEARN   *************************    CL**2
  6779                                                                     CL**2
  6780         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6781                                     COMP-3.                         CL**2
  6782         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6783                                     COMP-3.                         CL**2
  6784         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6785                                     COMP-3.                         CL**2
  6786         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6787                                     COMP-3.                         CL**2
  6788         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6789                                     COMP-3.                         CL**2
  6790         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6791                                     COMP-3.                         CL**2
  6792         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6793           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6794           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6795           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6796           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6797           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6798           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6799           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6800           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6801           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6802         16  FILLER                PIC X(12).                        CL**2
  6803                                                                     CL**2
  6804***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6805                                                                     CL**2
  6806         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6807                                     COMP-3.                         CL**2
  6808         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6809                                     COMP-3.                         CL**2
  6810         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6811                                                                     CL**2
  6812***************   MISC WORK AREAS    *****************************   CL**2
  6813         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6814                                     COMP-3.                         CL**2
  6815         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6816                                     COMP-3.                         CL**2
  6817         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6818                                     COMP-3.                         CL**2
  6819         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6820                                     COMP-3.                         CL**2
  6821         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6822                                     COMP-3.                         CL**2
  6823         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6824                                     COMP-3.                         CL**2
  6825         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6826             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6827             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6828             88  IO-ERROR                         VALUE 'E'.         CL**2
  6829                                                                     CL**2
  6830         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6831                                                                     CL**2
  6832         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6833                                                                     CL**2
  6834         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6835                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6836                                     COMP-3.                         CL**2
  6837                                                                     CL**2
  6838         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6839                                                                     CL**2
  6840         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6841                                     COMP-3.                         CL**2
  6842                                                                     CL**2
  6843         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6844                                     COMP-3.                         CL**2
  6845                                                                     CL**2
  6846         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6847                                     COMP-3.                         CL**2
  6848                                                                     CL**2
  6849         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6850                                     COMP-3.                         CL**2
  6851                                                                     CL**2
  6852         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6853                                     COMP-3.                         CL**2
  6854                                                                     CL**2
  6855         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6856                                     COMP-3.                         CL**2
  6857                                                                     CL**2
  6858         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6859                                     COMP-3.                         CL**2
  6860                                                                     CL**2
  6861         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6862             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6863                                                                     CL**2
  6864         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6865                                     COMP-3.                         CL**2
  6866         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6867                                     COMP-3.
  6868         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 134
* ECS010.cbl
  6869         16  FILLER                PIC X(15).                        CL**2
  6870******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 135
* ECS010.cbl
* 6872                             COPY ELCDTECX.
  6873******************************************************************06/05/98
  6874*                                                                *ELCDTECX
  6875*                            ELCDTECX.                           *   LV005
  6876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6877*                            VMOD=2.015                          *ELCDTECX
  6878*                                                                *ELCDTECX
  6879*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6880*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6881*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6882*                                                                *ELCDTECX
  6883******************************************************************ELCDTECX
  6884******************************************************************
  6885*                   C H A N G E   L O G
  6886*
  6887* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6888*-----------------------------------------------------------------
  6889*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6890* EFFECTIVE    NUMBER
  6891*-----------------------------------------------------------------
  6892* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6893*                                  BENEFIT CODES FROM 300 TO 900
  6894* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6895* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6896******************************************************************
  6897 01  DATE-CARD.                                                   ELCDTECX
  6898     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6899     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6900     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6901     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6902     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6903     12  EP-SW                       PIC  X.                      ELCDTECX
  6904         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6905     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6906         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6907     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6908     12  RUN-CENTURY.                                             ELCDTECX
  6909         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6910     12  FILLER                      PIC  X.                         CL**4
  6911     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6912     12  FILLER                      PIC  XXX.                    ELCDTECX
  6913     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6914                                                                  ELCDTECX
  6915 01  FILLER                          PIC  X(7)                       CL**6
  6916                                          VALUE 'OPTIONS'.        ELCDTECX
  6917 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6918     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6919     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6920     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6921         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6922         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6923     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6924     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6925     12  FILLER                      PIC  X.                      ELCDTECX
  6926     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6927     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6928     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  6929     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 136
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6930     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6931     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6932     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6933     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6934     12  FILLER                      PIC  X.                      ELCDTECX
  6935     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6936     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6937     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6938     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6939     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6940     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6941     12  FILLER                      PIC  X.                      ELCDTECX
  6942     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6943     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6944     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6945     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6946     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6947     12  DTE-R78                     PIC  X.                      ELCDTECX
  6948     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6949     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6950     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6951     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6952     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6953     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6954     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6955                                     PIC  X.                      ELCDTECX
  6956         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6957                                                 ' '.             ELCDTECX
  6958         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6959         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6960     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6961         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6962         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6963     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6964     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6965                                     PIC  9.                         CL**4
  6966     12  DTE-SYSTEM.                                              ELCDTECX
  6967         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6968         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6969         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6970         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6971         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6972         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6973         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6974         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6975         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6976         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6977         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6978         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6979         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6980         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6981         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6982         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6983         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6984         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6985         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6986         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  6987         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 137
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6988         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6989         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6990         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6991         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6992         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6993     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6994         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6995                                     PIC  X.                      ELCDTECX
  6996     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6997                                                                  ELCDTECX
  6998 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  6999     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7000     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7001     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7002*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7003     12  FILLER                      PIC  X.                      ELCDTECX
  7004     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7005     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7006     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7007     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7008     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7009     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7010     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7011                                                                  ELCDTECX
  7012     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7013     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7014     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7015     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7016                                                                  ELCDTECX
  7017     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7018     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7019     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7020     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7021                                                                  ELCDTECX
  7022     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7023     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7024                                                                  ELCDTECX
  7025     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7026     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7027                                                                  ELCDTECX
  7028     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7029                                                                  ELCDTECX
  7030 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7031     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7032     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7033     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7034     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7035     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7036     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7037     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7038                                                                  ELCDTECX
  7039 01  FILLER                          PIC  X(12)                   ELCDTECX
  7040                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7041 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7042     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7043         16  CNT-ID                  PIC  X.                      ELCDTECX
  7044         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  7045                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7046 01  FILLER                          PIC  X(11)                   ELCDTECX
  7047                                          VALUE 'STATE NAMES'.    ELCDTECX
  7048 01  STATE-NAMES.                                                 ELCDTECX
  7049     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7050         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7051         16  STATE-PIC1.                                          ELCDTECX
  7052             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7053             20  FILLER              PIC  XXX.                    ELCDTECX
  7054             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7055             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7056             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7057             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7058                                                                  ELCDTECX
  7059 01  FILLER                          PIC  X(13)                   ELCDTECX
  7060                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7061 01  CARRIER-NAMES.                                               ELCDTECX
  7062     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7063         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7064         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7065         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7066         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7067         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7068         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7069*        16  FILLER                  PIC  X.                      ELCDTECX
  7070         16  CARRIER-SEC-PAY         PIC  X.
  7071             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7072                                                                  ELCDTECX
  7073 01  FILLER                          PIC  X(9)                       CL**6
  7074                                          VALUE 'INS TYPES'.      ELCDTECX
  7075 01  CLAS-INS-TYPES.                                              ELCDTECX
  7076*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7077     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7078         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7079         16  CLAS-I-AB3.                                          ELCDTECX
  7080             20  FILLER              PIC  X.                      ELCDTECX
  7081             20  CLAS-I-AB2.                                      ELCDTECX
  7082                 24  FILLER          PIC  X.                      ELCDTECX
  7083                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7084         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7085             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7086             20  FILLER              PIC  X.                         CL**4
  7087         16  CLAS-I-AB10.                                         ELCDTECX
  7088             20  FILLER              PIC  X(9).                   ELCDTECX
  7089             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7090         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7091         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7092         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7093         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7094             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7095         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7096         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7097         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7098         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7099         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  7100         16  FILLER                  PIC  X(05).
  7101                                                                  ELCDTECX
  7102 01  FILLER                          PIC  X(16)                   ELCDTECX
  7103                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7104 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7105     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7106                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7107         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7108         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7109         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7110         16  CLAS-MORT-DESC.                                      ELCDTECX
  7111             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7112             20  FILLER              PIC  XX.                        CL**5
  7113             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7114             20  FILLER              PIC  X.                         CL**5
  7115             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7116             20  FILLER              PIC  X.                         CL**5
  7117             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7118             20  FILLER              PIC  X.                         CL**5
  7119             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7120             20  FILLER              PIC  X(5).                      CL**6
  7121                                                                  ELCDTECX
  7122 01  FILLER                          PIC  X(15)                   ELCDTECX
  7123                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7124 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7125     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7126         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7127         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7128         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7129         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7130         16  FILLER                  PIC  X(4).                      CL**6
  7131                                                                  ELCDTECX
  7132 01  FILLER                          PIC  X(7)                       CL**6
  7133                                     VALUE 'INDEXES'.             ELCDTECX
  7134 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7135     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7136     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7137     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7138     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7139     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7140     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7141     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7142     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7143     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7144     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7145     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7146     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7147     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7148     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7149     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7150     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7151     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7152                                                                  ELCDTECX
  7153 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7154     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7155     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7156     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7157     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7158     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7159     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  7160     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7161     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7162     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7163     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7164     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7165                                                                  ELCDTECX
  7166 01  FILLER                          PIC  X(13)                   ELCDTECX
  7167                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7168 01  CLAS-MISC.                                                   ELCDTECX
  7169     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7170         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7171         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7172         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7173     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7174     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7175     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7176     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7177     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7178     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7179     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7180     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7181     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7182     12  STATE-L                     PIC  XX.                     ELCDTECX
  7183     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7184     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7185     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7186         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7187         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7188     12  DTE-ABEND-WORK.                                          ELCDTECX
  7189         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7190         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7191                                                                  ELCDTECX
  7192 01  FILLER                          PIC  X(12)                   ELCDTECX
  7193                                     VALUE 'WORKING DATE'.        ELCDTECX
  7194 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7195     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7196         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7197         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7198         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7199     12  WS-CURRENT-DATE.                                         ELCDTECX
  7200         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7201         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7202         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7203         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7204         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7205     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7206         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7207         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7208                                                                  ELCDTECX
  7209 01  FILLER                          PIC  X(12)                   ELCDTECX
  7210                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7211 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7212     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7213         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7214         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7215         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7216                                                                  ELCDTECX
  7217 01  FILLER                          PIC  X(10)                   ELCDTECX
  7218                                     VALUE 'STATE TLRS'.          ELCDTECX
  7219 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7220     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7221         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7222         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7223                                                                  ELCDTECX
  7224 01  FILLER                          PIC  X(13)                   ELCDTECX
  7225                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7226 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7227     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7228         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7229                                                                  ELCDTECX
  7230 01  FILLER                          PIC  X(13)                   ELCDTECX
  7231                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7232 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7233     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7234     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7235     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7236                                     PIC  X.                         CL**5
  7237     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7238     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7239     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7240     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7241     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7242     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7243     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7244     12  FILLER                      PIC  X(75).                  ELCDTECX
  7245******************************************************************ELCDTECX
  7246*01  MISC-CARR-PCT-DATA.                                          00001521
  7247*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7248*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7249*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7250*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7251*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7252*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7253******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 142
* ECS010.cbl
* 7255                             COPY ELCDTEVR.
  7256***************************************************************** 04/15/98
  7257*                                                                *ELCDTEVR
  7258*                                                                *ELCDTEVR
  7259*                            ELCDTEVR.                           *   LV003
  7260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7261*                            VMOD=2.001                          *   CL**2
  7262*                                                                *ELCDTEVR
  7263*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7264*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7265*                                                                *ELCDTEVR
  7266******************************************************************ELCDTEVR
  7267 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7268     05  WS-RUN-DATE.                                             ELCDTEVR
  7269         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7270         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7271         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7272             15  RUN-CC              PIC  99.                     ELCDTEVR
  7273             15  RUN-YR              PIC  99.                     ELCDTEVR
  7274         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7275         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7276     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7277            WS-RUN-DATE              PIC 9(11).                      CL**2
  7278     05  WS-EP-DT.                                                ELCDTEVR
  7279         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7280         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7281         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7282             15  EP-CC               PIC  99.                     ELCDTEVR
  7283             15  EP-YR               PIC  99.                     ELCDTEVR
  7284         10  EP-MO                   PIC  99.                     ELCDTEVR
  7285         10  EP-DA                   PIC  99.                     ELCDTEVR
  7286     05  WS-EP-DT-N REDEFINES                                        CL**2
  7287            WS-EP-DT                 PIC 9(11).                      CL**2
  7288     05  WS-DTE-CONV-DT.                                             CL**4
  7289         10  FILLER                  PIC  9(03).                     CL**4
  7290         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7291         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7292             15  DTE-CONV-CC         PIC  99.                        CL**4
  7293             15  DTE-CONV-YR         PIC  99.                        CL**4
  7294         10  DTE-CONV-MO             PIC  99.                        CL**4
  7295         10  DTE-CONV-DA             PIC  99.                        CL**4
  7296     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7297            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7298 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7299     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7300         10  FILLER                            PIC 999.           ELCDTEVR
  7301         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7302         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7303             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7304             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7305         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7306         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7307     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7308            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7309     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7310         10  FILLER                            PIC 999.           ELCDTEVR
  7311         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7312         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 143
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7313         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7314         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7315     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7316            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7317 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7318     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7319         10  FILLER                            PIC 999.           ELCDTEVR
  7320         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7321         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7322             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7323             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7324         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7325         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7326     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7327            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7328     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7329         10  FILLER                            PIC 999.           ELCDTEVR
  7330         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7331         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7332             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7333             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7334         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7335         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7336     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7337            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7338     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7339         10  FILLER                            PIC 999.           ELCDTEVR
  7340         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7341         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7342             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7343             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7344         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7345         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7346     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7347            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7348 01  WS-RATE-RECORD.                                              ELCDTEVR
  7349         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7350             10  FILLER                        PIC 999.           ELCDTEVR
  7351             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7352             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7353                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7354                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7355             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7356             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7357         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7358                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 144
* ECS010.cbl
* 7360                             COPY ELCACCTV.
  7361******************************************************************04/14/98
  7362*                                                                *ELCACCTV
  7363*                            ELCACCTV                            *   LV002
  7364*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7365*                            VMOD=2.001                          *ELCACCTV
  7366*                                                                *ELCACCTV
  7367*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7368*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7369*                                                                *ELCACCTV
  7370*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7371*                                                                *ELCACCTV
  7372******************************************************************ELCACCTV
  7373                                                                  ELCACCTV
  7374 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7375                                                                  ELCACCTV
  7376     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7377         10  FILLER            PIC 999.                           ELCACCTV
  7378         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7379         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7380             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7381             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7382         10  AM-EXP-MO         PIC 99.                               CL**5
  7383         10  AM-EXP-DA         PIC 99.                               CL**5
  7384     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7385            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7386     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7387         10  FILLER                    PIC 999.                   ELCACCTV
  7388         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7389         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7390             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7391             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7392         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7393         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7394     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7395            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7396     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7397         10  FILLER                    PIC 999.                   ELCACCTV
  7398         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7399         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7400             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7401             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7402         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7403         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7404     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7405            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7406     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7407         10 FILLER                     PIC 999.                   ELCACCTV
  7408         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7409         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7410            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7411            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7412         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7413         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7414     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7415            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7416     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7417         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 145
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7418         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7419         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7420            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7421            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7422         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7423         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7424     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7425            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7426     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7427         10  FILLER                    PIC 999.                   ELCACCTV
  7428         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7429         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7430             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7431             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7432         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7433         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7434     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7435            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7436     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7437         10  FILLER                    PIC 999.                   ELCACCTV
  7438         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7439         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7440             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7441             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7442         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7443         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7444     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7445            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7446     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7447         10  FILLER                    PIC 999.                   ELCACCTV
  7448         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7449         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7450             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7451             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7452         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7453         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7454     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7455            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7456     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7457         10  FILLER                    PIC 999.                   ELCACCTV
  7458         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7459         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7460             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7461             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7462         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7463         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7464     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7465            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 146
* ECS010.cbl
* 7467                             COPY ELCEXTVR.
  7468******************************************************************04/15/98
  7469*                                                                *ELCEXTVR
  7470*                                                                *ELCEXTVR
  7471*                             ELCEXTVR                           *   LV002
  7472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7473*                            VMOD=2.001                          *ELCEXTVR
  7474*                                                                *ELCEXTVR
  7475*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7476*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7477*                                                                *ELCEXTVR
  7478******************************************************************ELCEXTVR
  7479 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7480     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7481         10  FILLER              PIC 999.                         ELCEXTVR
  7482         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7483         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7484             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7485             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7486         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7487         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7488     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7489            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7490 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7491     05  WS-DE-EFF.                                               ELCEXTVR
  7492         10  FILLER              PIC 999.                         ELCEXTVR
  7493         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7494         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7495             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7496             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7497         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7498         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7499     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7500            WS-DE-EFF            PIC 9(11).                          CL**2
  7501     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7502         10  FILLER              PIC 999.                         ELCEXTVR
  7503         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7504         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7505             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7506             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7507         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7508         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7509     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7510            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7511     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7512         10  FILLER                 PIC 999.                      ELCEXTVR
  7513         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7514         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7515             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7516             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7517         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7518         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7519     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7520            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7521     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7522         10  FILLER                 PIC 999.                      ELCEXTVR
  7523         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7524         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 147
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7525             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7526             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7527         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7528         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7529     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7530            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7531     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7532         10  FILLER                 PIC 999.                      ELCEXTVR
  7533         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7534         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7535             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7536             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7537         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7538         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7539     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7540            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7541     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7542         10  FILLER                 PIC 999.                      ELCEXTVR
  7543         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7544         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7545             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7546             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7547         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7548         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7549     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7550            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7551     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7552         10  FILLER                 PIC 999.                      ELCEXTVR
  7553         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7554         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7555             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7556             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7557         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7558         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7559     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7560            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7561     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7562         10  FILLER                 PIC 999.                         CL**5
  7563         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7564         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7565             15  DE-CP-CC           PIC 99.                          CL**5
  7566             15  DE-CP-YR           PIC 99.                          CL**5
  7567         10  DE-CP-MO               PIC 99.                          CL**5
  7568         10  DE-CP-DA               PIC 99.                          CL**5
  7569     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7570            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7571     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7572         10  FILLER                 PIC 999.                         CL**5
  7573         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7574         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7575             15  DE-RP-CC           PIC 99.                          CL**5
  7576             15  DE-RP-YR           PIC 99.                          CL**5
  7577         10  DE-RP-MO                      PIC 99.                   CL**5
  7578         10  DE-RP-DA                      PIC 99.                   CL**5
  7579     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7580            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7581     05  WS-DE-INCUR.                                             ELCEXTVR
  7582         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7583         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7584         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7585             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7586             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7587         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7588         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7589     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7590            WS-DE-INCUR             PIC 9(11).                       CL**2
  7591     05  WS-DE-PAY.                                               ELCEXTVR
  7592         10  FILLER                 PIC 999.                      ELCEXTVR
  7593         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7594         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7595             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7596             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7597         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7598         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7599     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7600            WS-DE-PAY               PIC 9(11).                       CL**2
  7601     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7602         10  FILLER                 PIC 999.                      ELCEXTVR
  7603         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7604         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7605             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7606             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7607         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7608         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7609     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7610            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7611     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7612         10 FILLER                  PIC 999.                      ELCEXTVR
  7613         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7614         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7615            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7616            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7617         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7618         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7619     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7620            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7621     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7622         10 FILLER                  PIC 999.                      ELCEXTVR
  7623         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7624         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7625            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7626            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7627         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7628         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7629     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7630            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7631     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7632         10  FILLER                 PIC 999.                      ELCEXTVR
  7633         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7634         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7635             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7636             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7637         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7638         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7639     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7640            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7641     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7642         10  FILLER                 PIC 999.                      ELCEXTVR
  7643         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7644         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7645             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7646             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7647         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7648         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7649     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7650            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7651     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7652         10  FILLER                        PIC 999.               ELCEXTVR
  7653         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7654         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7655                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7656             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7657             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7658         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7659         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7660     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7661            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7662     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7663         10  FILLER                        PIC 999.               ELCEXTVR
  7664         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7665         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7666                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7667             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7668             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7669         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7670         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7671     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7672            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7673                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 150
* ECS010.cbl
  7675 PROCEDURE DIVISION.
  7676
  7677 0000-START.
  7678
  7679******************************************************************
  7680***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7681******************************************************************
  7682
  7683*0003-LOAD-DATE-CARD.
* 7684                             COPY ELCDTERX.
  7685******************************************************************04/15/98
  7686*                                                                *ELCDTERX
  7687*                                                                *ELCDTERX
  7688*                            ELCDTERX.                           *   LV002
  7689*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7690*                            VMOD=2.007                          *ELCDTERX
  7691*                                                                *ELCDTERX
  7692*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7693*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7694*      = ELCDTEFD)                                               *ELCDTERX
  7695*                                                                *ELCDTERX
  7696******************************************************************ELCDTERX
  7697                                                                  ELCDTERX
  7698     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7699                                                                  ELCDTERX
  7700     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7701     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7702     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7703                                                                  ELCDTERX
  7704     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7705                                                                  ELCDTERX
  7706******************************************************************ELCDTERX
  7707*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7708*          WARNING MESSAGES.                                      ELCDTERX
  7709******************************************************************ELCDTERX
  7710     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7711         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7712                                                                  ELCDTERX
  7713     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7714                                                                  ELCDTERX
  7715     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7716                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7717                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7718                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7719                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7720                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7721                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7722                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7723                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7724                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7725                                                                  ELCDTERX
  7726     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7727                                                                  ELCDTERX
  7728     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7729                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7730                                                                  ELCDTERX
  7731     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7732     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 151
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7733     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7734     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7735                                                                  ELCDTERX
  7736     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7737         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7738     ELSE                                                         ELCDTERX
  7739         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7740                                                                  ELCDTERX
  7741     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7742         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7743     ELSE                                                         ELCDTERX
  7744         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7745                                                                  ELCDTERX
  7746 0005-READ--CARD.                                                 ELCDTERX
  7747     READ DISK-DATE                                               ELCDTERX
  7748         AT END CLOSE DISK-DATE                                   ELCDTERX
  7749             GO TO 0060-READ--TEST.                               ELCDTERX
  7750                                                                  ELCDTERX
  7751     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7752                                                                  ELCDTERX
  7753     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7754         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7755         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7756         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7757         GO TO 0005-READ--CARD.                                   ELCDTERX
  7758                                                                  ELCDTERX
  7759     IF DD-ID = 'CLAD'                                            ELCDTERX
  7760         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7761         GO TO 0005-READ--CARD.                                   ELCDTERX
  7762                                                                  ELCDTERX
  7763     IF DD-ID = 'CLAX'                                            ELCDTERX
  7764         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7765         GO TO 0005-READ--CARD.                                   ELCDTERX
  7766                                                                  ELCDTERX
  7767     IF DD-ID = 'CLAF'                                            ELCDTERX
  7768         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7769         GO TO 0005-READ--CARD.                                   ELCDTERX
  7770                                                                  ELCDTERX
  7771     IF DD-ID = 'CLAC'                                            ELCDTERX
  7772         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7773                                                                  ELCDTERX
  7774     IF DD-ID = 'CARR'                                            ELCDTERX
  7775         GO TO 0015-READ--CARR.                                   ELCDTERX
  7776                                                                  ELCDTERX
  7777     IF DD-ID = 'STAT'                                            ELCDTERX
  7778         GO TO 0020-READ--STAT.                                   ELCDTERX
  7779                                                                  ELCDTERX
  7780     IF DD-ID = 'BUSC'                                            ELCDTERX
  7781         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7782                                                                  ELCDTERX
  7783     IF DD-ID = 'MORT'                                            ELCDTERX
  7784         GO TO 0030-READ--MORT.                                   ELCDTERX
  7785                                                                  ELCDTERX
  7786     IF DD-ID = 'CLAI'                                            ELCDTERX
  7787         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7788                                                                  ELCDTERX
  7789     IF DD-ID = 'COLC'                                            ELCDTERX
  7790         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7791                                                                  ELCDTERX
  7792     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7793        DD-IDA = 'CL'                                             ELCDTERX
  7794         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7795                                                                  ELCDTERX
  7796     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7797        DD-IDA = 'PO'                                             ELCDTERX
  7798         GO TO 0050-READ--POXX.                                   ELCDTERX
  7799                                                                  ELCDTERX
  7800     IF DD-ID = 'OPCA'                                            ELCDTERX
  7801         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7802                                                                  ELCDTERX
  7803     IF DD-ID = 'OPST'                                            ELCDTERX
  7804         GO TO 0072-READ--OPST.                                   ELCDTERX
  7805                                                                  ELCDTERX
  7806     IF DD-ID = 'OPBS'                                            ELCDTERX
  7807         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7808                                                                  ELCDTERX
  7809     IF DD-ID = 'OPMS'                                            ELCDTERX
  7810         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7811                                                                  ELCDTERX
  7812     GO TO 0005-READ--CARD.                                       ELCDTERX
  7813                                                                  ELCDTERX
  7814 0010-READ--CLAC.                                                 ELCDTERX
  7815     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7816     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7817     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7818     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7819     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7820     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7821     GO TO 0005-READ--CARD.                                       ELCDTERX
  7822                                                                  ELCDTERX
  7823 0015-READ--CARR.                                                 ELCDTERX
  7824     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7825     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7826        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7827        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7828        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7829        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7830        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7831        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7832        MOVE DD-CARR1-SECPAY-SW
  7833                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7834     END-IF
  7835                                                                  ELCDTERX
  7836     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7837     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7838        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7839        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7840        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7841        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7842        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7843        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7844        MOVE DD-CARR2-SECPAY-SW
  7845                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7846     END-IF
  7847                                                                  ELCDTERX
  7848                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7849     GO TO 0005-READ--CARD.                                       ELCDTERX
  7850                                                                  ELCDTERX
  7851 0020-READ--STAT.                                                 ELCDTERX
  7852     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7853     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7854        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7855         GO TO 0005-READ--CARD.                                   ELCDTERX
  7856                                                                  ELCDTERX
  7857     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7858     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7859     GO TO 0020-READ--STAT.                                       ELCDTERX
  7860                                                                  ELCDTERX
  7861 0025-READ--BUSC.                                                 ELCDTERX
  7862     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7863     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7864        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7865         GO TO 0005-READ--CARD.                                   ELCDTERX
  7866                                                                  ELCDTERX
  7867     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7868     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7869     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7870                                                                  ELCDTERX
  7871 0030-READ--MORT.                                                 ELCDTERX
  7872     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7873     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7874        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7875         GO TO 0005-READ--CARD.                                   ELCDTERX
  7876                                                                  ELCDTERX
  7877     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7878     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7879     GO TO 0030-READ--MORT.                                       ELCDTERX
  7880                                                                  ELCDTERX
  7881 0035-READ--CLXX.                                                 ELCDTERX
  7882     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7883          GO TO 0005-READ--CARD.                                  ELCDTERX
  7884                                                                  ELCDTERX
  7885     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7886         DISPLAY '***********************************************'ELCDTERX
  7887         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7888         DISPLAY '***********************************************'ELCDTERX
  7889         GO TO 0055-READ--STOP.                                   ELCDTERX
  7890                                                                  ELCDTERX
  7891     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7892        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7893         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7894                                                                  ELCDTERX
  7895     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7896        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7897         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7898                                                                  ELCDTERX
  7899*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7900     GO TO 0005-READ--CARD.                                       ELCDTERX
  7901                                                                  ELCDTERX
  7902 0040-READ--CLAI.                                                 ELCDTERX
  7903     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7904     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7905        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7906         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7907                                                                  ELCDTERX
  7908     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7909     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7910     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7911                                                                  ELCDTERX
  7912 0045-READ--DUMP.                                                 ELCDTERX
  7913     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7914     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7915                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7916     PERFORM ABEND-PGM.                                           ELCDTERX
  7917                                                                  ELCDTERX
  7918 0050-READ--POXX.                                                 ELCDTERX
  7919     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7920         GO TO 0005-READ--CARD.                                   ELCDTERX
  7921                                                                  ELCDTERX
  7922     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7923         DISPLAY '***********************************************'ELCDTERX
  7924         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7925         DISPLAY '***********************************************'ELCDTERX
  7926         GO TO 0055-READ--STOP.                                   ELCDTERX
  7927                                                                  ELCDTERX
  7928     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7929     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7930     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7931     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7932                                                                  ELCDTERX
  7933     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7934         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7935     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7936         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7937                                                                  ELCDTERX
  7938     GO TO 0005-READ--CARD.                                       ELCDTERX
  7939                                                                  ELCDTERX
  7940 0055-READ--STOP.                                                 ELCDTERX
  7941     GOBACK.                                                      ELCDTERX
  7942                                                                  ELCDTERX
  7943 0060-READ--TEST.                                                 ELCDTERX
  7944     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7945        CLAX-ID         = SPACE  OR                               ELCDTERX
  7946        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7947         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7948                                                                  ELCDTERX
  7949     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7950     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7951                                                                  ELCDTERX
  7952 0065-READ--COLC.                                                 ELCDTERX
  7953     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7954     GO TO 0005-READ--CARD.                                       ELCDTERX
  7955                                                                  ELCDTERX
  7956 0070-READ--OPCA.                                                 ELCDTERX
  7957                                                                  ELCDTERX
  7958     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7959                                                                  ELCDTERX
  7960     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7961             OR                                                   ELCDTERX
  7962         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7963         GO TO 0005-READ--CARD.                                   ELCDTERX
  7964                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7965     ADD 1                       TO INDEXCA.                      ELCDTERX
  7966     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7967                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7968     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7969                                                                  ELCDTERX
  7970 0072-READ--OPST.                                                 ELCDTERX
  7971                                                                  ELCDTERX
  7972     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7973                                                                  ELCDTERX
  7974     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7975             OR                                                   ELCDTERX
  7976         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7977         GO TO 0005-READ--CARD.                                   ELCDTERX
  7978                                                                  ELCDTERX
  7979     ADD 1                       TO INDEXST.                      ELCDTERX
  7980     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7981                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7982     GO TO 0072-READ--OPST.                                       ELCDTERX
  7983                                                                  ELCDTERX
  7984 0074-READ--OPBS.                                                 ELCDTERX
  7985                                                                  ELCDTERX
  7986     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7987                                                                  ELCDTERX
  7988     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7989             OR                                                   ELCDTERX
  7990         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7991         GO TO 0005-READ--CARD.                                   ELCDTERX
  7992                                                                  ELCDTERX
  7993     ADD 1                       TO INDEXBS.                      ELCDTERX
  7994     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7995     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7996                                                                  ELCDTERX
  7997 0079-READ--EXIT.                                                 ELCDTERX
  7998*    EXIT.                                                        ELCDTERX
  7999******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 156
* ECS010.cbl
  8001******************************************************************
  8002***           O P E N   F I L E S   R O U T I N E              ***
  8003******************************************************************
  8004
  8005     DISPLAY ' '.
  8006     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8007         'ECS010 ******'
  8008     DISPLAY ' '.
  8009
  8010     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8011     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8012     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8013     .
  8014 0080-OPEN-FILES.
  8015*    IF DTE-PGM-OPT = '1'
  8016*       open output detail-extr
  8017*    end-if
  8018     OPEN INPUT  PENDING-EXTRACT
  8019                 CERT-MASTER-IN
  8020                 ERACCTT-IN
  8021                 ERAGTC
  8022
  8023          I-O    ERMEBL-INOUT
  8024                 ELCRTT
  8025
  8026          OUTPUT SUMMARY-EXTR
  8027                 ME-ECS010-BALANCE
  8028                 ME50-ECS010-BALANCE
  8029                 DISPLAY-PRT
  8030                 MISMATCH-REPORT
  8031                 PRINT-COPY.
  8032     IF DTE-CLIENT = 'DCC'
  8033        OPEN INPUT ERPDEF
  8034     END-IF
  8035
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 157
* ECS010.cbl
  8037*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8038     IF DTE-CLIENT NOT = 'DMD'
  8039         NEXT SENTENCE
  8040     ELSE
  8041         OPEN INPUT ERRESC-IN
  8042            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8043                NEXT SENTENCE
  8044            ELSE
  8045                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8046                MOVE 'ERROR OPENING ERRESC FILE'
  8047                                        TO WS-ABEND-MESSAGE
  8048                GO TO ABEND-PGM.
  8049*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8050
  8051     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8052         NEXT SENTENCE
  8053       ELSE
  8054         MOVE '11'                    TO ABEND-CODE-1
  8055         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8056         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8057         GO TO ABEND-PGM.
  8058
  8059     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8060        CONTINUE
  8061     ELSE
  8062        DISPLAY ' OPEN ERROR ELCRTT '
  8063        MOVE '31'                TO ABEND-CODE-1
  8064        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8065        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8066        GO TO ABEND-PGM
  8067     END-IF
  8068
  8069     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8070        CONTINUE
  8071     ELSE
  8072        DISPLAY ' OPEN ERROR ERAGTC '
  8073        MOVE '41'                TO ABEND-CODE-1
  8074        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8075        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8076        GO TO ABEND-PGM
  8077     END-IF
  8078
  8079     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8080        CONTINUE
  8081     ELSE
  8082        DISPLAY ' OPEN ERROR ERPDEF '
  8083        MOVE '61'                TO ABEND-CODE-1
  8084        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8085        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8086        GO TO ABEND-PGM
  8087     END-IF
  8088
  8089     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8090         NEXT SENTENCE
  8091       ELSE
  8092         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8093
  8094           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 158
* ECS010.cbl
  8095              and (dte-pgm-opt = '1')
  8096              open output new-detail-extr
  8097           end-if
  8098
  8099     IF DTE-PGM-OPT = '1'
  8100         OPEN OUTPUT  CERT-MASTER-OUT
  8101                      DETAIL-EXTR
  8102     ELSE
  8103         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8104         MOVE '*'                     TO TRANS-EOF-FLAG.
  8105
  8106     MOVE 'R'                         TO CP-RATE-FILE.
  8107     MOVE 'O'                         TO CP-IO-FUNCTION.
  8108     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8109     IF IO-ERROR
  8110         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8111                                      TO WS-ABEND-MESSAGE
  8112         MOVE 0302                    TO WS-RETURN-CODE
  8113         GO TO ABEND-PGM.
  8114
  8115******************************************************************
  8116***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8117******************************************************************
  8118
  8119 0090-INITIALIZATION-ROUTINE.
  8120
  8121     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8122     MOVE WS-TIME                     TO ME-START-TIME.
  8123     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8124                                         TR-RN-DT.
  8125     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8126     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8127     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8128     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8129     MOVE COMPANY-NAME                TO TRHDNM.
  8130     MOVE ALPH-DATE                   TO TR-MODAYR.
  8131     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8132     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8133
  8134     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8135     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8136     COMPUTE LYD-MO = LYD-MO - 1.
  8137     IF LYD-MO = ZERO
  8138         MOVE 12                      TO LYD-MO
  8139         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8140
  8141     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8142
  8143
  8144     IF DTE-CLIENT = 'CID'
  8145         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8146         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8147     ELSE
  8148       IF DTE-CLIENT = 'AHL'
  8149         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8150         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8151       ELSE
  8152         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 159
* ECS010.cbl
  8153         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8154       END-IF
  8155     END-IF.
  8156
  8157     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8158         GO TO 0090-CONTINUE.
  8159
  8160     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8161     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8162     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8163     MOVE '6'                    TO DC-OPTION-CODE.
  8164     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8165
  8166     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8167         MOVE '**** WORK DATE CALC ERROR ****'
  8168                                 TO WS-ABEND-MESSAGE
  8169         MOVE '90'               TO ABEND-CODE-1
  8170         MOVE '0'                TO AC2-ONE
  8171         MOVE DC-ERROR-CODE      TO AC2-TWO
  8172         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8173         GO TO ABEND-PGM.
  8174
  8175     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8176
  8177     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8178     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8179
  8180     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8181             VARYING
  8182         SUBM FROM +2 BY +1
  8183             UNTIL
  8184         SUBM GREATER THAN +12.
  8185
  8186     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8187
  8188     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8189             VARYING
  8190         SUBM FROM +1 BY +1
  8191             UNTIL
  8192         SUBM GREATER THAN +13.
  8193
  8194     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8195*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8196     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8197                                    DC-ELAPSED-MONTHS.
  8198     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8199     MOVE 1                      TO DC-END-OF-MONTH.
  8200     MOVE '6'                    TO DC-OPTION-CODE.
  8201     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8202
  8203     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8204         MOVE '**** CUT OFF DATE ERROR ****'
  8205                                 TO WS-ABEND-MESSAGE
  8206         MOVE '90'               TO ABEND-CODE-1
  8207         MOVE '0'                TO AC2-ONE
  8208         MOVE DC-ERROR-CODE      TO AC2-TWO
  8209         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8210         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 160
* ECS010.cbl
  8211
  8212     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8213     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8214
  8215 0090-CONTINUE.
  8216
  8217     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8218     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8219     MOVE +0                     TO DC-ELAPSED-DAYS.
  8220     MOVE '6'                    TO DC-OPTION-CODE.
  8221     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8222
  8223     IF NO-CONVERSION-ERROR
  8224        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8225
  8226     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8227     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8228     MOVE +0                     TO DC-ELAPSED-DAYS.
  8229     MOVE '6'                    TO DC-OPTION-CODE.
  8230     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8231
  8232     IF NO-CONVERSION-ERROR
  8233        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8234
  8235     MOVE +0                     TO DC-ELAPSED-MONTHS
  8236                                    DC-ELAPSED-DAYS.
  8237
  8238     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8239     MOVE 'CR'                   TO CR-RECORD-ID.
  8240     MOVE ZEROS                  TO
  8241               CR-AGE                  CR-JOINT-AGE
  8242               CR-LFTYP                CR-AHTYP
  8243               CR-LF-TERM              CR-AH-TERM
  8244               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8245               CR-LF-TERM-IN-DAYS
  8246               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8247               CR-LFAMT                CR-AHAMT
  8248               CR-LFPRM                CR-AHPRM
  8249               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8250               CR-LFPRM-CALC           CR-AHPRM-CALC
  8251               CR-LFPRM-RATE           CR-AHPRM-RATE
  8252               CR-LFAMT-ALT
  8253               CR-LFPRM-ALT
  8254               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8255               CR-LFPRM-RATE-ALT
  8256               CR-LFRFND               CR-AHRFND
  8257               CR-LFRFND-CALC          CR-AHRFND-CALC
  8258               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8259               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8260               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8261               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8262               CR-LIVES                CR-APR
  8263               CR-BILLED
  8264               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8265               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8266               CR-PMT-FREQ             CR-LOAN-TERM
  8267               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8268               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 161
* ECS010.cbl
  8269               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8270               CR-LF-CANC-DT           CR-AH-CANC-DT
  8271               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8272               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8273               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8274               CR-DTH-DT               CR-DIS-DT
  8275               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8276               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8277                                       CR-DIS-PTO-DT
  8278               CR-DTHAMT               CR-DISAMT
  8279               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8280               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8281               CR-DTHEXP               CR-DISEXP
  8282               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8283               CR-DTH-AGE              CR-DAYS-DISAB
  8284               CR-DIS-INCUR-DT (1)
  8285***            CR-CLAIM-DEDUCT-WITHHELD
  8286               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8287               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8288               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8289               CR-MOB-NET-TOT-FEES
  8290               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8291               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8292
  8293     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8294                                       CR-DISAB-DETAIL-DATA (3)
  8295                                       CR-DISAB-DETAIL-DATA (4)
  8296                                       CR-DISAB-DETAIL-DATA (5).
  8297
  8298     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8299
  8300     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8301     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8302        IA > +10
  8303        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8304     END-PERFORM
  8305     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8306
  8307     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8308
  8309     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8310                          EPEC-TOTALS      EPEC-SUBS
  8311                          EPEC-UNDERWRITTEN-TOTALS.
  8312
  8313     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8314                          EPEC-LEVELS-END-II.
  8315     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8316                          DUPE-CERT-TABLE.
  8317
  8318     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8319     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8320     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8321                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8322     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8323                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8324
  8325     IF RUN-DATE NOT = EP-DT
  8326         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 162
* ECS010.cbl
  8327     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8328     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8329     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8330     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8331
  8332     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8333         MOVE +1000                   TO DUP-MAX.
  8334
  8335     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8336     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8337     IF ME-DO-UPDATE
  8338         READ ERMEBL-INOUT INVALID KEY
  8339                       CLOSE ERMEBL-INOUT
  8340                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8341
  8342     IF DTE-CLIENT = 'DCC'
  8343        MOVE 0 TO B-SUB
  8344        MOVE DTE-CLASIC-COMPANY-CD
  8345                                 TO PD-CONTROL-PRIMARY
  8346        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8347        IF ERPDEF-FILE-STATUS = '00'
  8348           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8349              READ ERPDEF NEXT RECORD
  8350              IF ERPDEF-FILE-STATUS = '00'
  8351                 ADD 1 TO B-SUB
  8352                 IF B-SUB > 800
  8353                    DISPLAY ' DDF UEP TABLE BLEW '
  8354                    GO TO ABEND-PGM
  8355                 END-IF
  8356                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8357                 MOVE PD-PRODUCT-CD
  8358                                 TO DD-PRODUCT-CD (B-SUB)
  8359                 MOVE PD-BEN-TYPE
  8360                                 TO DD-BEN-TYPE (B-SUB)
  8361                 MOVE PD-BEN-CODE
  8362                                 TO DD-BEN-CODE (B-SUB)
  8363                 MOVE PD-PROD-EXP-DT
  8364                                 TO DD-PROD-EXP-DT (B-SUB)
  8365                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8366                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8367                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8368                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8369                    P2 > +8
  8370                    MOVE PD-PROD-CODE (P2)
  8371                                 TO DD-PROD-CODE (B-SUB P2)
  8372                    MOVE PD-MAX-AMT (P2)
  8373                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8374                 END-PERFORM
  8375                 MOVE PD-EARN-FACTORS
  8376                                 TO DD-EARN-FACTORS (B-SUB)
  8377              END-IF
  8378           END-PERFORM
  8379        END-IF
  8380        CLOSE ERPDEF
  8381     END-IF
  8382
  8383     GO TO 0150-READ-ACCOUNT-MASTER.
  8384
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 163
* ECS010.cbl
  8385 0090-EXIT.
  8386     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 164
* ECS010.cbl
  8388 0095-GET-EOM-DATES.
  8389
  8390     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8391     MOVE '6'                    TO DC-OPTION-CODE.
  8392     MOVE 1                      TO DC-ELAPSED-MONTHS
  8393                                    DC-END-OF-MONTH.
  8394     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8395     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8396
  8397     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8398         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8399                                 TO WS-ABEND-MESSAGE
  8400         MOVE '90'               TO ABEND-CODE-1
  8401         MOVE '0'                TO AC2-ONE
  8402         MOVE DC-ERROR-CODE      TO AC2-TWO
  8403         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8404         GO TO ABEND-PGM.
  8405
  8406     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8407                                     DC-BIN-DATE-1.
  8408     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8409     MOVE ' '                    TO  DC-OPTION-CODE.
  8410     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8411
  8412     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8413         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8414                                 TO WS-ABEND-MESSAGE
  8415         MOVE '90'               TO ABEND-CODE-1
  8416         MOVE '0'                TO AC2-ONE
  8417         MOVE DC-ERROR-CODE      TO AC2-TWO
  8418         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8419         GO TO ABEND-PGM.
  8420
  8421     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8422
  8423 0095-EXIT.
  8424     EXIT.
  8425
  8426 0096-DISPLAY-EOM-DATES.
  8427
  8428     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8429
  8430 0096-EXIT.
  8431     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 165
* ECS010.cbl
  8433******************************************************************
  8434***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8435******************************************************************
  8436
  8437 0100-ACCT-MASTER-READ-ROUTINE.
  8438
  8439     IF EP-FLG = '1'
  8440        ADD +1                   TO BC-ACT-ACCTS
  8441        IF DTE-OPT-RESERVE-METHOD-AUTH
  8442           PERFORM 4700-CALC-OPT-IBNR
  8443                                 THRU 4700-EXIT
  8444        END-IF
  8445        PERFORM 4500-BUILD-EPEC-EXTRACT
  8446                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8447     END-IF
  8448
  8449     IF TRANSACTION-WAS-PROCESSED
  8450         MOVE '1'                     TO ACCT-FLG
  8451                                         STATE-FLG
  8452                                         COMP-FLG
  8453                                         CARR-FLG
  8454                                         FINAL-FLG.
  8455
  8456 0150-READ-ACCOUNT-MASTER.
  8457
  8458     READ ERACCTT-IN AT END
  8459         GO TO 9930-EOJ-3.
  8460
  8461     ADD +1                            TO ERACCTT-READS.
  8462
* 8463     COPY ELCACCTI.
  8464******************************************************************04/14/98
  8465*                                                                *ELCACCTI
  8466*                            ELCACCTI                            *   LV003
  8467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8468*                            VMOD=2.001                          *ELCACCTI
  8469*                                                                *ELCACCTI
  8470*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8471*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8472*                                                                *ELCACCTI
  8473*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8474*                                                                *ELCACCTI
  8475******************************************************************ELCACCTI
  8476     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8477     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8478     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8479     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8480     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8481     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8482     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8483     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8484     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8485
  8486     IF FIRST-ACCOUNT EQUAL +1
  8487        MOVE +0                  TO FIRST-ACCOUNT
  8488        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8489
  8490     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 166
* ECS010.cbl
  8491         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8492     ELSE
  8493     IF AM-GROUPING NOT = HLD-GROUPING
  8494         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8495     ELSE
  8496     IF AM-STATE NOT = HLD-STATE
  8497         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8498     ELSE
  8499     IF AM-ACCOUNT NOT = HLD-ACCT
  8500         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8501     ELSE
  8502     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8503
  8504     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8505        (AM-GROUPING NOT = HLD-GROUPING)
  8506         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8507
  8508 0190-PROCESS-NEW-ACCOUNT.
  8509
  8510     IF AM-CARRIER NOT = HLD-CARRIER
  8511         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8512
  8513     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8514     MOVE AM-CARRIER            TO TR-CARR.
  8515     MOVE AM-GROUPING           TO TR-GROUP.
  8516     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8517     MOVE AM-NAME               TO TR-AGCY.
  8518     MOVE AM-EFF-MO             TO TR-CE-MO.
  8519     MOVE AM-EFF-DA             TO TR-CE-DA.
  8520     MOVE AM-EFF-YR             TO TR-CE-YR.
  8521     MOVE AM-STATE              TO TR-ST-NO.
  8522     IF AM-EXPIRE-DT =  99999999999
  8523         MOVE 'CURRENT '        TO TR-CX
  8524     ELSE
  8525         MOVE AM-EXP-MO         TO TR-CX-MO
  8526         MOVE AM-EXP-DA         TO TR-CX-DA
  8527         MOVE AM-EXP-YR         TO TR-CX-YR
  8528         MOVE '-'               TO HSHR1  HSHR2.
  8529
  8530     ADD +1 TO BC-ACCTS.
  8531
  8532     IF AM-RECORD-ID = '**'
  8533         ADD +1 TO BC-NEW-ACCTS.
  8534     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8535         ADD +1 TO BC-ER-ACCTS.
  8536
  8537     MOVE ZEROS                 TO SV-LO-CERT
  8538                                   SV-HI-CERT.
  8539     MOVE SPACE                 TO TRANSACTION-FLAG
  8540                                   LST-TRD-CERT
  8541                                   LST-TRD-ISDT
  8542                                   OB-DATE-1-SWITCH
  8543                                   OB-DATE-2-SWITCH
  8544                                   OB-DATE-3-SWITCH.
  8545     MOVE +81                   TO LN-CNT.
  8546
  8547     IF DTE-CLIENT = 'DCC'
  8548        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 167
* ECS010.cbl
  8549        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8550           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8551              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8552           END-IF
  8553           IF AM-COMM-CHARGEBACK (SUB) = 99
  8554              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8555           END-IF
  8556        END-PERFORM
  8557     END-IF
  8558     .
  8559 0199-READ-ACCOUNT-X.
  8560     EXIT.
  8561
  8562 0199A-CARRIER-TABLE-LOOKUP.
  8563
  8564     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8565            VARYING CLAS-INDEXCN FROM 1 BY 1
  8566         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8567               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8568
  8569     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8570         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8571         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8572                                 TO WS-ABEND-MESSAGE
  8573         MOVE 4004               TO WS-ABEND-CODE
  8574         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8575         GO TO ABEND-PGM.
  8576
  8577 0199A-LOOKUP-XIT.
  8578     EXIT.
  8579 0199B-SEARCH-CARRIER-TABLE.
  8580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 168
* ECS010.cbl
  8582******************************************************************
  8583***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8584******************************************************************
  8585
  8586 0200-CERT-MASTER-READ-ROUTINE.
  8587
  8588     IF EOF-ON-CERT
  8589         GO TO 0299-READ-CERT-X.
  8590
  8591     IF FIRST-CERT EQUAL +1
  8592        MOVE +0                  TO FIRST-CERT
  8593        GO TO 0250-READ-CERT-MASTER.
  8594
  8595     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8596
  8597     PERFORM CERT-DATE-LOAD.
  8598
  8599     IF CR-IND-GRP = 'I'  OR  '1'
  8600         MOVE '1'                    TO CR-IND-GRP
  8601     ELSE
  8602         MOVE '2'                    TO CR-IND-GRP.
  8603
  8604     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8605         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8606     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8607         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8608
  8609************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8610     IF DTE-CLIENT NOT = 'NSL'
  8611         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8612                                      CR-AH-REI-RISK-PRM.
  8613******************************************************************
  8614
  8615**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8616****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8617     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8618         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8619
  8620     MOVE CR-STATE                   TO STATE-L.
  8621     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8622
  8623     IF CR-LFTYP NOT = ZERO
  8624         MOVE CR-LFTYP               TO CLAS-LOOK
  8625         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8626
  8627     IF CR-AHTYP NOT = ZERO
  8628         MOVE CR-AHTYP               TO CLAS-LOOK
  8629         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8630
  8631     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8632     MOVE 'L'                    TO DC-OPTION-CODE
  8633     MOVE +0                     TO DC-ELAPSED-MONTHS
  8634                                    DC-ELAPSED-DAYS
  8635     PERFORM 8000-DATE-CONVERT-ROUTINE
  8636                                 THRU 8099-DATE-CONVERT-X
  8637     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8638
  8639     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 169
* ECS010.cbl
  8640        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8641        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8642        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8643        PERFORM 0395-GET-CERT-TRLRS
  8644                                 THRU 0395-EXIT
  8645     END-IF
  8646
  8647     IF RUN-MO NOT = 01
  8648         GO TO 0250-READ-CERT-MASTER.
  8649
  8650     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8651                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8652
  8653     IF ((CR-LFTYP NOT = ZERO)  AND
  8654         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8655        ((CR-AHTYP NOT = ZERO)  AND
  8656         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8657           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8658
  8659     .
  8660 0250-READ-CERT-MASTER.
  8661
  8662     READ CERT-MASTER-IN
  8663               AT END GO TO 9920-EOJ-2.
  8664
  8665     ADD +1 TO CMIN-CNT.
  8666
  8667*     DISPLAY ' READ CERT ' CIR-CONTROL
  8668     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8669         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8670         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8671         DISPLAY 'SECOND - '  CIR-CONTROL
  8672         MOVE 0612                    TO WS-ABEND-CODE
  8673         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8674         GO TO ABEND-PGM.
  8675
  8676     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8677         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8678            pcic-dt ' ' pcic-cert-no
  8679         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8680            GO TO 0250-READ-CERT-MASTER
  8681         ELSE
  8682            MOVE 'DUPLICATE CERT ON FILE'
  8683                                      TO WS-ABEND-MESSAGE
  8684            MOVE 0302                 TO WS-ABEND-CODE
  8685            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8686            GO TO ABEND-PGM.
  8687
  8688******************************************************
  8689*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8690*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8691*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8692******************************************************
  8693     IF DTE-CLIENT = 'CID'
  8694        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8695           IF (CF-THIRD-AGENT  = '0000713100') OR
  8696              (CF-FOURTH-AGENT = '0000713100')
  8697              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 170
* ECS010.cbl
  8698           ELSE
  8699              GO TO 0250-READ-CERT-MASTER
  8700           END-IF
  8701        ELSE
  8702           IF COMPANY-NAME = '        PEOPLES TRUST'
  8703              IF CI-ACCOUNT = '0000845800'
  8704                 CONTINUE
  8705              ELSE
  8706                 GO TO 0250-READ-CERT-MASTER
  8707              END-IF
  8708           ELSE
  8709              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8710                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8711                    (CF-FOURTH-AGENT = '0000681700')
  8712                    CONTINUE
  8713                 ELSE
  8714                    GO TO 0250-READ-CERT-MASTER
  8715                 END-IF
  8716              ELSE
  8717                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8718                    IF CI-ACCOUNT = '0001107200'
  8719                       CONTINUE
  8720                    ELSE
  8721                       GO TO 0250-READ-CERT-MASTER
  8722                    END-IF
  8723                 END-IF
  8724              END-IF
  8725           END-IF
  8726        END-IF
  8727     END-IF
  8728
  8729******************************************************
  8730     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8731
  8732 0299-READ-CERT-X.
  8733     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 171
* ECS010.cbl
  8735******************************************************************
  8736***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8737******************************************************************
  8738
  8739 0300-READ-PENDING-TRANSACTIONS.
  8740
  8741     READ PENDING-EXTRACT
  8742                   AT END GO TO 9910-EOJ-1.
  8743
  8744     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8745
  8746     IF NOT ED-PENDING-BUSINESS  AND
  8747        NOT ED-PENDING-CLAIMS  AND
  8748        NOT ED-CERT-CHANGES
  8749           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8750                                               ED-RECORD-TYPE
  8751           MOVE 0301                        TO WS-ABEND-CODE
  8752           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8753           GO TO ABEND-PGM.
  8754
  8755     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8756
  8757     IF DTE-CLIENT = 'NCL'
  8758         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8759             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8760                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8761             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8762
  8763     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8764         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8765         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8766         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8767         MOVE 0603                    TO WS-ABEND-CODE
  8768         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8769         GO TO ABEND-PGM.
  8770
  8771     ADD +1 TO TR-CNT.
  8772
  8773     IF ISSUE-TRANSACTION   OR
  8774        CANCEL-TRANSACTION  OR
  8775        CLAIM-TRANSACTION   OR
  8776        RESERVE-TRANSACTION OR
  8777        UPDATE-TRANSACTION
  8778         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8779         GO TO 0330-MATCH-PENDING-TO-CERT.
  8780
  8781     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8782
  8783     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8784     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8785             PENDING-RECORD-TYPE ')'.
  8786
  8787     MOVE 0301                   TO WS-ABEND-CODE.
  8788     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8789     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 172
* ECS010.cbl
  8791 0310-SET-UP-MATCHING-KEY.
  8792
  8793     IF ED-PENDING-BUSINESS
  8794         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8795         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8796         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8797         MOVE PB-STATE           TO PEND-MATCH-STATE
  8798         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8799         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8800         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8801         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8802
  8803     IF ED-PENDING-CLAIMS
  8804         ADD +1                  TO W-PENDING-CLMS
  8805         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8806         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8807         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8808         MOVE PC-STATE           TO PEND-MATCH-STATE
  8809         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8810         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8811         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8812         IF PC-CLAIMS
  8813             MOVE '3'            TO PENDING-RECORD-TYPE
  8814         ELSE
  8815             IF PC-RESERVES
  8816                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8817
  8818     IF ED-CERT-CHANGES
  8819         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8820         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8821         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8822         MOVE CC-STATE           TO PEND-MATCH-STATE
  8823         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8824         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8825         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8826         MOVE '5'                TO PENDING-RECORD-TYPE.
  8827
  8828     MOVE ' '                    TO DC-OPTION-CODE.
  8829     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8830     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8831
  8832 0310-EXIT.
  8833     EXIT.
  8834
  8835******************************************************************
  8836***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8837******************************************************************
  8838
  8839 0330-MATCH-PENDING-TO-CERT.
  8840
  8841     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8842         GO TO 0390-CERT-MISMATCH-ERROR.
  8843
  8844     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8845*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8846       IF CLAIM-TRANSACTION
  8847*         DISPLAY ' CLAIM '
  8848         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 173
* ECS010.cbl
  8849            NOT PC-NON-CHARGEBLE-EXPENSE
  8850             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8851                                      OR
  8852                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8853                  GO TO 0390-CERT-MISMATCH-ERROR.
  8854
  8855     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8856       IF RESERVE-TRANSACTION
  8857*         DISPLAY ' RESV '
  8858         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8859                                  OR
  8860            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8861              GO TO 0390-CERT-MISMATCH-ERROR.
  8862
  8863     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8864         IF ISSUE-TRANSACTION
  8865*           DISPLAY ' ISSUE '
  8866             GO TO 0380-DUPLICATE-CERT-ERROR
  8867         ELSE
  8868             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8869
  8870     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8871         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8872         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8873                                               0299-READ-CERT-X
  8874         GO TO 0330-MATCH-PENDING-TO-CERT.
  8875
  8876     IF ISSUE-TRANSACTION
  8877         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8878     ELSE
  8879         GO TO 0390-CERT-MISMATCH-ERROR.
  8880
  8881 0350-MATCH-PENDING-TO-ACCOUNT.
  8882
  8883     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8884       ADD +1  TO ERROR-COUNT
  8885         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8886           TO  DL-FULL
  8887             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8888         MOVE    ' PENDING CONTROL = '
  8889           TO  DIS-LINE-REASON
  8890         MOVE  PENDING-MATCH-CONTROL
  8891           TO  DIS-LINE-REC
  8892             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8893         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8894           TO  DIS-LINE-REASON
  8895         MOVE  PENDING-MATCH-CONTROL
  8896           TO  DIS-LINE-REC
  8897             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8898         MOVE  SPACES
  8899           TO  DISPLAY-LINE
  8900             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8902         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8903         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8904         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8905         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8906         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8907         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 174
* ECS010.cbl
  8908         AM-MSTR-CNTRL AM-EFFECT-DT
  8909         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8910            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8911            GO TO 0300-READ-PENDING-TRANSACTIONS
  8912         ELSE
  8913            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8914                                      TO WS-ABEND-MESSAGE
  8915            MOVE 0302 TO WS-ABEND-CODE
  8916            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8917            GO TO ABEND-PGM.
  8918
  8919     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8920         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8921                                              0199-READ-ACCOUNT-X
  8922         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8923
  8924     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8925        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8926         GO TO 0500-APPLY-PENDING-BUSINESS.
  8927
  8928     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8929                                       0199-READ-ACCOUNT-X.
  8930     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8931
  8932
  8933 0370-ACCOUNT-MISMATCH-ERROR.
  8934
  8935     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8936     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8937     MOVE 'MISMATCH ACCOUNT ERROR'
  8938                               TO WS-ABEND-MESSAGE.
  8939     MOVE 0302 TO WS-ABEND-CODE.
  8940         DISPLAY '******************************'
  8941         DISPLAY '***** ERROR LOCATION 009 *****'
  8942         DISPLAY '******************************'
  8943     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8944     GO TO ABEND-PGM.
  8945
  8946
  8947 0380-DUPLICATE-CERT-ERROR.
  8948
  8949     IF PB-I-OB  OR  PB-I-SUMMARY
  8950         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8951
  8952     ADD +1 TO DUP-CNT.
  8953
  8954     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8955         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8956         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8957                                         PB-I-LF-ALT-PREMIUM-AMT
  8958         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8959         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8960         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8961
  8962     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8963     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8964
  8965*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 175
* ECS010.cbl
  8966*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8967*    GO TO ABEND-PGM.
  8968
  8969
  8970 0390-CERT-MISMATCH-ERROR.
  8971
  8972     IF ISSUE-TRANSACTION  OR
  8973        CANCEL-TRANSACTION  OR
  8974        CLAIM-TRANSACTION
  8975         ADD +1                  TO  MISMATCH-COUNT.
  8976
  8977     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  8978       ADD  +1  TO  ERROR-COUNT
  8979         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8980           TO  DL-FULL
  8981             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8982         MOVE    ' TRANS CONTROL = '
  8983           TO  DIS-LINE-REASON
  8984         MOVE  PENDING-MATCH-CONTROL
  8985           TO  DIS-LINE-REC
  8986             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8987         MOVE    ' TRANS TYPE    = '
  8988           TO  DIS-LINE-REASON
  8989         MOVE  PENDING-RECORD-TYPE
  8990           TO  DIS-LINE-REC
  8991             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8992         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8993           TO  DL-FULL
  8994             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8995         MOVE    ' CERT IN CTL   = '
  8996           TO  DIS-LINE-REASON
  8997         MOVE  CIR-CONTROL
  8998           TO  DIS-LINE-REC
  8999             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9000         MOVE    ' BYPASSED TRANS  = '
  9001           TO  DIS-LINE-REASON
  9002         MOVE  PENDING-MATCH-CONTROL
  9003           TO  DIS-LINE-REC
  9004             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9005         MOVE  SPACES
  9006           TO  DISPLAY-LINE
  9007             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9008         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9009
  9010     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9011     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9012
  9013     IF ISSUE-TRANSACTION
  9014         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9015     ELSE
  9016         IF CANCEL-TRANSACTION
  9017             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9018         ELSE
  9019             IF CLAIM-TRANSACTION
  9020                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9021             ELSE
  9022                 IF RESERVE-TRANSACTION
  9023                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 176
* ECS010.cbl
  9024                 ELSE
  9025                     IF UPDATE-TRANSACTION
  9026                         MOVE 'CHG'
  9027                                 TO  DTL-REC-TYPE-DESC.
  9028
  9029     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9030     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9031     MOVE 'DROPPED'              TO  DTL-STATUS.
  9032
  9033     IF ISSUE-TRANSACTION
  9034         MOVE PB-I-LF-PREMIUM-AMT
  9035                                 TO  MD2-LF-PREM
  9036         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9037                                 TO  MD2-LF-ALT-PREM
  9038         MOVE PB-I-AH-PREMIUM-AMT
  9039                                 TO  MD2-AH-PREM
  9040         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9041         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9042         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9043     ELSE
  9044         IF CANCEL-TRANSACTION
  9045             MOVE PB-C-LF-CANCEL-AMT
  9046                                 TO  MD3-LF-REFUND
  9047             MOVE PB-C-AH-CANCEL-AMT
  9048                                 TO  MD3-AH-REFUND
  9049             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9050             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9051         ELSE
  9052             IF CLAIM-TRANSACTION
  9053                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9054                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9055                     MOVE ZEROS             TO MD4-AH-CLAIM
  9056                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9057                 ELSE
  9058                     MOVE ZEROS             TO MD4-LF-CLAIM
  9059                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9060                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9061
  9062     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9063         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9064         MOVE MISMATCH-PAGE-NUMBER
  9065                                 TO  TR-PG
  9066         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9067         MOVE MR-CTL             TO  X
  9068         MOVE X TO LCP-ASA
  9069         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9070             THRU LCP-WRITE-END-MISMATCH-RPT
  9071         MOVE TR-HD-2            TO  MISMATCH-RPT
  9072         MOVE MR-CTL             TO  X
  9073         MOVE X TO LCP-ASA
  9074         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9075             THRU LCP-WRITE-END-MISMATCH-RPT
  9076         MOVE TR-HD-3            TO  MISMATCH-RPT
  9077         MOVE MR-CTL             TO  X
  9078         MOVE X TO LCP-ASA
  9079         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9080             THRU LCP-WRITE-END-MISMATCH-RPT
  9081         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 177
* ECS010.cbl
  9082         MOVE MR-CTL             TO  X
  9083         MOVE X TO LCP-ASA
  9084         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9085             THRU LCP-WRITE-END-MISMATCH-RPT
  9086         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9087
  9088     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9089     MOVE MR-CTL                 TO  X.
  9090     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9091
  9092     MOVE X TO LCP-ASA
  9093     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9094         THRU LCP-WRITE-END-MISMATCH-RPT.
  9095
  9096     IF ISSUE-TRANSACTION
  9097         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9098         MOVE MR-CTL             TO  X
  9099         ADD +1                  TO  MISMATCH-LINE-COUNT
  9100         MOVE X TO LCP-ASA
  9101         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9102             THRU LCP-WRITE-END-MISMATCH-RPT.
  9103
  9104     IF CANCEL-TRANSACTION
  9105         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9106         MOVE MR-CTL             TO  X
  9107         ADD +1                  TO  MISMATCH-LINE-COUNT
  9108         MOVE X TO LCP-ASA
  9109         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9110             THRU LCP-WRITE-END-MISMATCH-RPT.
  9111
  9112     IF CLAIM-TRANSACTION
  9113         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9114         MOVE MR-CTL             TO  X
  9115         ADD +1                  TO  MISMATCH-LINE-COUNT
  9116         MOVE X TO LCP-ASA
  9117         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9118             THRU LCP-WRITE-END-MISMATCH-RPT.
  9119
  9120     MOVE SPACES                 TO  MISMATCH-RPT.
  9121
  9122     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9123
  9124 0395-GET-CERT-TRLRS.
  9125
  9126     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9127     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9128     MOVE CR-CARRIER             TO CS-CARRIER
  9129     MOVE CR-GROUPING            TO CS-GROUPING
  9130     MOVE CR-STATE               TO CS-STATE
  9131     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9132     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9133     MOVE CR-CERT-NO             TO CS-CERT-NO
  9134     MOVE 'A'                    TO CS-TRAILER-TYPE
  9135
  9136     READ ELCRTT
  9137
  9138     IF ELCRTT-FILE-STATUS = '00'
  9139        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 178
* ECS010.cbl
  9140                                 TO WS-BANK-COMMISSIONS
  9141     ELSE
  9142        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9143           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9144           PERFORM ABEND-PGM
  9145        END-IF
  9146     END-IF
  9147
  9148     .
  9149 0395-EXIT.
  9150     EXIT.
  9151
  9152******************************************************************
  9153***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9154******************************************************************
  9155
  9156 0400-WRITE-CERT-RECORD.
  9157*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9158
  9159     IF CERTIFICATE-RECORD = LOW-VALUES
  9160         GO TO 0499-WRITE-CERT-X.
  9161
  9162     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9163         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9164         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9165            ' ' cr-dt ' ' cr-cert-no
  9166         ADD  +1  TO  ERROR-COUNT
  9167         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9168           TO  DL-FULL
  9169             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9170         MOVE    ' CERT. CONTROL = '
  9171           TO  DIS-LINE-REASON
  9172         MOVE  CR-FULL-CONTROL
  9173           TO  DIS-LINE-REC
  9174             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9175         MOVE  SPACES
  9176           TO  DISPLAY-LINE
  9177             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9178            if dte-pgm-opt = '1'
  9179               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9180               ADD +1 TO CMOT-CNT
  9181            end-if
  9182            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9183                                 thru 0299-READ-CERT-X
  9184               GO TO 0400-WRITE-CERT-RECORD.
  9185
  9186*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9187
  9188     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9189         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9190                                              0199-READ-ACCOUNT-X
  9191         GO TO 0400-WRITE-CERT-RECORD.
  9192
  9193     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9194        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9195         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9196                                              0199-READ-ACCOUNT-X
  9197         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 179
* ECS010.cbl
  9198
  9199*     DISPLAY ' BEFORE REIN '
  9200     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9201*     DISPLAY ' AFTER REIN '
  9202
  9203     IF CR-LFTYP = ZEROS  AND
  9204        CR-DTHEXP NOT = ZEROS
  9205         ADD +1                     TO W-LFTYP-99
  9206         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9207         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9208
  9209     IF CR-AHTYP = ZEROS  AND
  9210        CR-DISEXP NOT = ZEROS
  9211         ADD +1                     TO W-AHTYP-99
  9212         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9213         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9214
  9215*     DISPLAY ' BEFORE EP BUMP'
  9216     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9217*     DISPLAY ' AFTER EP BUMP'
  9218
  9219      if (dte-client = 'DCC')
  9220         and (ws-dcc-cnc-flag = 'Y')
  9221         write new-detail-extract
  9222      end-if
  9223
  9224     IF CR-LFTYP = '99'
  9225         MOVE '00'                  TO CR-LFTYP.
  9226     IF CR-AHTYP = '99'
  9227         MOVE '00'                  TO CR-AHTYP.
  9228
  9229*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9230*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9231
  9232     IF CR-NH-INT-ON-REF NOT NUMERIC
  9233         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9234     END-IF
  9235
  9236     IF  CR-POLICY-IS-ACTIVE
  9237         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9238         IF  CR-POLICY-IS-REISSUE
  9239             OR CR-POLICY-IS-MONTHLY
  9240             ADD +1              TO W-POLICY-REISSUE-CTR
  9241         ELSE
  9242             IF  CR-POLICY-IS-REIN-ONLY
  9243                 ADD +1          TO W-POLICY-REIN-CTR
  9244             ELSE
  9245                 NEXT SENTENCE
  9246     ELSE
  9247         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9248
  9249     IF DTE-PGM-OPT = '1'
  9250       IF REIN-IS-RISK-PREMIUM  AND
  9251          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9252         IF NOT CR-POLICY-IS-REISSUE  AND
  9253            NOT CR-POLICY-IS-DECLINED  AND
  9254            NOT CR-POLICY-IS-VOID
  9255            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 180
* ECS010.cbl
  9256             MOVE '*'            TO RISK-PREM-FLAG
  9257             PERFORM 3100-REINSURE-ISSUE THRU
  9258                     3199-REINSURE-ISSUE-X.
  9259
* 9260     COPY ELCCRTM2.
  9261******************************************************************04/16/98
  9262*                                                                *ELCCRTM2
  9263*                                                                *ELCCRTM2
  9264*                            ELCCRTM2                            *   LV004
  9265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9266*                            VMOD=2.001                          *ELCCRTM2
  9267*                                                                *ELCCRTM2
  9268*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9269*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9270*                                                                *ELCCRTM2
  9271******************************************************************ELCCRTM2
  9272     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9273     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9274     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9275     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9276     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9277     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9278                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9279     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9280     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9281     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9282     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9283                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9284     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9285     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9286     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9287     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9288     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9289                                                                     CL**4
  9290     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9291                UNTIL COPY-NDX > 5                                   CL**4
  9292           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9293                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9294     END-PERFORM.                                                 ELCCRTM2
  9295                                                                  ELCCRTM2
  9296
  9297     IF DTE-PGM-OPT = '1'
  9298         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9299         ADD +1 TO CMOT-CNT.
  9300
  9301     move zeros                  to ueclp-clp-fact
  9302     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9303                                    RISK-REIN-FLAG
  9304                                    RISK-PREM-FLAG
  9305                                    RC-COMM-FLG.
  9306
  9307 0499-WRITE-CERT-X.
  9308     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 181
* ECS010.cbl
  9310******************************************************************
  9311***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9312******************************************************************
  9313
  9314 0500-APPLY-PENDING-BUSINESS.
  9315
  9316     IF CANCEL-TRANSACTION
  9317*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9318         GO TO 0600-PROCESS-CANCELLATIONS.
  9319
  9320     IF CLAIM-TRANSACTION
  9321*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9322         GO TO 0700-PROCESS-CLAIMS.
  9323
  9324     IF RESERVE-TRANSACTION
  9325*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9326         GO TO 0800-PROCESS-RESERVES.
  9327
  9328     IF UPDATE-TRANSACTION
  9329*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9330         GO TO 0900-PROCESS-CERT-CHANGES.
  9331
  9332******************************************************************
  9333***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9334******************************************************************
  9335
  9336 0505-PROCESS-ISSUES.
  9337
  9338     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9339     PERFORM CERT-DATE-LOAD.
  9340
  9341     ADD +1                      TO  W-POL-ISSUES.
  9342
  9343     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9344     MOVE PB-CARRIER             TO  CR-CARRIER.
  9345     MOVE PB-GROUPING            TO  CR-GROUPING.
  9346     MOVE PB-STATE               TO  CR-STATE.
  9347     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9348     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9349                                     WS-CR-BIN-DATE
  9350     MOVE ' '                    TO  DC-OPTION-CODE.
  9351     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9352     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9353                                     WS-CR-DT-N.
  9354     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9355
  9356*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9357     MOVE PB-I-NAME              TO  CR-NAME.
  9358     MOVE PB-I-AGE               TO  CR-AGE.
  9359     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9360     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9361
  9362     IF PB-I-JOINT-COVERAGE
  9363         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9364         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9365     ELSE
  9366        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9367           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 182
* ECS010.cbl
  9368             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9369
  9370     IF PB-I-SUMMARY  OR
  9371        DTE-CLIENT = 'DMD'
  9372         MOVE PB-I-LIVES         TO  CR-LIVES.
  9373
  9374     IF PB-I-NUM-BILLED NOT NUMERIC
  9375        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9376
  9377     IF PB-I-STATE-TAX NOT NUMERIC
  9378        MOVE ZEROS               TO PB-I-STATE-TAX.
  9379
  9380     IF PB-I-MUNI-TAX NOT NUMERIC
  9381        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9382     IF PB-I-TOT-FEES NOT NUMERIC
  9383        MOVE ZEROS               TO PB-I-TOT-FEES
  9384     END-IF
  9385     IF PB-I-ADDL-CLP NOT NUMERIC
  9386        MOVE ZEROS               TO PB-I-ADDL-CLP
  9387     END-IF
  9388
  9389     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9390     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9391     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9392     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9393     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9394     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9395     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9396     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9397     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9398     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9399     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9400     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9401     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9402
  9403     IF PB-I-RATE-CLASS-OVRD = SPACES
  9404         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9405     ELSE
  9406         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9407
  9408     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9409     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9410
  9411     IF PB-I-INDV-GRP-OVRD = SPACES
  9412         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9413     ELSE
  9414         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9415
  9416     IF CR-IND-GRP = 'I'  OR  '1'
  9417         MOVE '1'                TO  CR-IND-GRP
  9418     ELSE
  9419         MOVE '2'                TO  CR-IND-GRP.
  9420
  9421     IF PB-I-SKIP-CODE = '1'
  9422         MOVE 01                 TO  CR-SKIP.
  9423     IF PB-I-SKIP-CODE = '2'
  9424         MOVE 02                 TO  CR-SKIP.
  9425     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 183
* ECS010.cbl
  9426         MOVE 03                 TO  CR-SKIP.
  9427     IF PB-I-SKIP-CODE = '4'
  9428         MOVE 04                 TO  CR-SKIP.
  9429     IF PB-I-SKIP-CODE = '5'
  9430         MOVE 05                 TO  CR-SKIP.
  9431     IF PB-I-SKIP-CODE = '6'
  9432         MOVE 06                 TO  CR-SKIP.
  9433     IF PB-I-SKIP-CODE = '7'
  9434         MOVE 07                 TO  CR-SKIP.
  9435     IF PB-I-SKIP-CODE = '8'
  9436         MOVE 08                 TO  CR-SKIP.
  9437     IF PB-I-SKIP-CODE = '9'
  9438         MOVE 09                 TO  CR-SKIP.
  9439     IF PB-I-SKIP-CODE = 'A'
  9440         MOVE 10                 TO  CR-SKIP.
  9441     IF PB-I-SKIP-CODE = 'X'
  9442         MOVE 11                 TO  CR-SKIP.
  9443
  9444     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9445     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9446     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9447
  9448     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9449         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9450                                        REIN-SPEC-A
  9451                                        REIN-SPEC-B
  9452                                        REIN-SPEC-C
  9453         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9454     ELSE
  9455         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9456
  9457     IF DTE-CLIENT = 'DCC'
  9458        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9459        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9460           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9461        END-IF
  9462     END-IF
  9463
  9464     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9465     MOVE ' '                    TO  DC-OPTION-CODE.
  9466     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9467     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9468
  9469     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9470
  9471     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9472         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9473     ELSE
  9474         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9475
  9476     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9477         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9478
  9479     IF PB-BATCH-ENTRY = SPACE  OR
  9480        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9481         MOVE '1'                TO  CR-ENTRY-STATUS
  9482     ELSE
  9483         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 184
* ECS010.cbl
  9484
  9485     IF PB-POLICY-IS-DECLINED
  9486         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9487
  9488     IF PB-POLICY-IS-VOIDED
  9489         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9490
  9491***  IF DTE-CLIENT NOT = 'CRI'
  9492***      IF PB-I-PREM-ACCTNG-ONLY
  9493***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9494
  9495     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9496                                     WS-CR-ENTRY-DATE-N.
  9497
  9498*    IF PB-I-MICROFILM-NO NUMERIC
  9499*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9500
  9501     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9502        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9503        OR 'AHL'
  9504         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9505     END-IF
  9506
  9507*************************************************
  9508***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9509***  WAS CONVERTED TO 1056 BYTES.             ***
  9510*************************************************
  9511     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9512     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9513
  9514     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9515
  9516     MOVE CR-STATE               TO STATE-L.
  9517
  9518     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9519
  9520     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9521
  9522***************************************************
  9523***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9524***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9525***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9526***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9527***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9528***************************************************
  9529     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9530         IF CR-LF-POLICY-IS-RESTORE
  9531             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9532             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9533         ELSE
  9534         IF CR-LF-POLICY-IS-REISSUE
  9535             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9536             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9537         ELSE
  9538         IF CR-LF-IS-REIN-ONLY
  9539             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9540             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9541         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 185
* ECS010.cbl
  9542         IF CR-LF-IS-DECLINED
  9543             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9544             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9545         ELSE
  9546         IF CR-LF-IS-VOID
  9547             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9548             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9549         ELSE
  9550         IF CR-LF-POLICY-IS-MONTHLY
  9551            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9552            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9553
  9554
  9555 0510-PROCESS-LIFE-ISSUE.
  9556
  9557     IF PB-INVALID-LIFE
  9558         GO TO 0520-PROCESS-A-H-ISSUE.
  9559
  9560     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9561     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9562     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9563
  9564     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9565     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9566     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9567     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9568     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9569     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9570
  9571     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9572     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9573     IF PB-I-LF-POLICY-FEE  NUMERIC
  9574         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9575     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9576     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9577
  9578     IF PB-I-LF-PREM-TAX NUMERIC
  9579        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9580     END-IF
  9581
  9582
  9583     IF PB-I-LF-REI-RATE NOT = ZEROS
  9584        IF DTE-CLIENT = 'DCC'
  9585           CONTINUE
  9586*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9587        ELSE
  9588           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9589           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9590                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9591        END-IF
  9592     END-IF
  9593
  9594     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9595         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9596         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9597         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9598         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9599         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 186
* ECS010.cbl
  9600             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9601                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9602
  9603     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9604     MOVE ' '                    TO  DC-OPTION-CODE.
  9605     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9606     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9607                                     WS-CR-LF-EXPIRE-DATE-N.
  9608
  9609     IF CR-ENTRY-STATUS = 'P'
  9610         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9611     ELSE
  9612         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9613
  9614     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9615     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9616     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9617     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9618     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9619
  9620     IF CR-LF-POLICY-IS-RESTORE
  9621         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9622     IF CR-LF-POLICY-IS-REISSUE
  9623         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9624     IF CR-LF-IS-REIN-ONLY
  9625         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9626
  9627     IF CR-LF-IS-DECLINED
  9628         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9629
  9630     IF CR-LF-IS-VOID
  9631         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9632     IF CR-LF-POLICY-IS-MONTHLY
  9633         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9634
  9635     ADD +1                      TO  W-LF-ISSUES.
  9636
  9637 0520-PROCESS-A-H-ISSUE.
  9638
  9639     IF PB-INVALID-AH
  9640         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9641
  9642     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9643     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9644     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9645
  9646     IF (NOT PB-I-JOINT-COVERAGE)
  9647        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9648        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9649        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9650     END-IF
  9651
  9652     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9653     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9654     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9655     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9656     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9657
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 187
* ECS010.cbl
  9658     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9659     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9660     IF PB-I-AH-POLICY-FEE  NUMERIC
  9661         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9662     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9663     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9664
  9665     IF PB-I-AH-PREM-TAX NUMERIC
  9666        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9667     END-IF
  9668
  9669     IF PB-I-AH-REI-RATE NOT = ZEROS
  9670        IF DTE-CLIENT = 'DCC'
  9671           CONTINUE
  9672        ELSE
  9673           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9674           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9675             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9676        END-IF
  9677     END-IF
  9678
  9679     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9680        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9681           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9682           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9683        END-IF
  9684        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9685     END-IF
  9686     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9687     MOVE ' '                    TO  DC-OPTION-CODE.
  9688     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9689     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9690                                     WS-CR-AH-EXPIRE-DATE-N.
  9691
  9692     IF CR-ENTRY-STATUS = 'P'
  9693         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9694     ELSE
  9695         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9696
  9697     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9698     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9699     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9700     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9701     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9702
  9703     IF CR-AH-POLICY-IS-RESTORE
  9704         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9705     IF CR-AH-POLICY-IS-REISSUE
  9706         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9707     IF CR-AH-IS-REIN-ONLY
  9708         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9709
  9710     IF CR-AH-IS-DECLINED
  9711         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9712
  9713     IF CR-AH-IS-VOID
  9714         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9715     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 188
* ECS010.cbl
  9716         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9717
  9718     ADD +1                      TO  W-AH-ISSUES.
  9719
  9720 0530-PROCESS-ISSUE-CONTINUED.
  9721
  9722     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9723     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9724     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9725     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9726
  9727     IF (DTE-CLIENT = 'DCC')
  9728        AND (CR-AHTYP NOT = '00' AND '  ')
  9729        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9730        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9731           PERFORM 0920-GET-BANK-FEES
  9732                                 THRU 0920-EXIT
  9733           PERFORM 0930-BUILD-CERT-TRLR
  9734                                 THRU 0930-EXIT
  9735           PERFORM 0395-GET-CERT-TRLRS
  9736                                 THRU 0395-EXIT
  9737     END-IF
  9738
  9739     IF DTE-CLIENT = 'DCC'
  9740        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9741           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9742        END-IF
  9743        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9744           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9745              (CR-LFPRM + CR-LFPRM-ALT) -
  9746              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9747        END-IF
  9748     END-IF
  9749
  9750     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9751        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9752        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9753     ELSE
  9754        IF DTE-CLIENT = 'DCC'
  9755           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9756              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9757              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9758           END-IF
  9759           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9760              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9761              (CR-AHPRM * CR-LCOM-AH (1))
  9762           END-IF
  9763        END-IF
  9764     END-IF
  9765
  9766     IF DTE-CLIENT = 'DCC'
  9767         IF PB-I-VIN > SPACES
  9768             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9769         END-IF
  9770     END-IF.
  9771
  9772     IF CR-ENTRY-STATUS = 'P'
  9773         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 189
* ECS010.cbl
  9774
  9775     IF CR-POLICY-IS-REISSUE  OR
  9776        CR-POLICY-IS-REIN-ONLY OR
  9777        CR-POLICY-IS-DECLINED OR
  9778        CR-POLICY-IS-VOID
  9779        OR CR-POLICY-IS-MONTHLY
  9780         GO TO 0590-END-ISSUE-PROCESSING.
  9781
  9782     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9783     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9784        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9785     END-IF
  9786     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9787
  9788     IF NOT PB-INVALID-LIFE
  9789         COMPUTE H-LFCM ROUNDED =
  9790                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9791         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9792         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9793
  9794     IF NOT PB-INVALID-AH
  9795        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9796           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9797              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9798              + CR-ADDL-CLP)
  9799           ELSE
  9800              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9801              - CR-ADDL-CLP
  9802           END-IF
  9803        ELSE
  9804           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9805        END-IF
  9806        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9807        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9808     END-IF
  9809
  9810     ADD +1 TO BC-G-ISS.
  9811     ADD +1 TO BC-COMM.
  9812     ADD CR-LFPRM TO BC-NET-WRIT.
  9813     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9814        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9815     END-IF
  9816     ADD CR-AHPRM TO BC-NET-WRIT.
  9817
  9818     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9819        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9820        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9821     ELSE
  9822        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9823        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9824           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9825        END-IF
  9826     END-IF
  9827
  9828     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9829         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9830     ELSE
  9831         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 190
* ECS010.cbl
  9832
  9833 0590-END-ISSUE-PROCESSING.
  9834
  9835     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9836
  9837     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9838
  9839     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9840        NOT CR-POLICY-IS-DECLINED  AND
  9841        NOT CR-POLICY-IS-VOID
  9842         MOVE 'Y' TO BILLED-SWITCH
  9843         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9844         IF DTE-CLIENT = 'DCC'
  9845            move detail-extract  to new-detail-extract
  9846            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9847               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9848                  cr-addl-clp
  9849            end-if
  9850            write new-detail-extract
  9851         end-if
  9852
  9853     IF NOT CR-POLICY-IS-REISSUE  AND
  9854        NOT CR-POLICY-IS-DECLINED  AND
  9855        NOT CR-POLICY-IS-VOID
  9856        AND NOT CR-POLICY-IS-MONTHLY
  9857         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9858
  9859     MOVE '*'                   TO TRANSACTION-FLAG.
  9860     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 191
* ECS010.cbl
  9862******************************************************************
  9863***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9864******************************************************************
  9865
  9866 0600-PROCESS-CANCELLATIONS.
  9867
  9868*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9869     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9870
  9871     IF AM-RECALC-COMM = ('Y' OR '1')
  9872        PERFORM 1600-RECALC-COMM-EXTR
  9873                                 THRU 1899-RECALC-COMM-EXTR-X
  9874        MOVE ' '                 TO RECALC-TYPE
  9875     END-IF
  9876
  9877     MOVE CR-LFRFND               TO LIFE-REFUND.
  9878     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9879     MOVE CR-AHRFND               TO A-H-REFUND.
  9880     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9881     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9882
  9883     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9884     IF CR-LFRFND NOT = ZEROS
  9885        IF CR-LFRFND-CALC = ZEROS
  9886           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9887                                    LIFE-REFUND-CALC
  9888        ELSE
  9889           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9890        END-IF
  9891     END-IF
  9892
  9893     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9894
  9895     IF CR-AHRFND-CALC = ZEROS
  9896        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9897                                    A-H-REFUND-CALC
  9898     ELSE
  9899        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9900     END-IF
  9901
  9902     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9903        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9904     ELSE
  9905        MOVE SPACES              TO CR-POST-CARD-IND
  9906     END-IF
  9907
  9908*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9909*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9910*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9911*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9912
  9913     IF PB-C-NH-INT-ON-REFS NUMERIC
  9914        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9915        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9916     END-IF
  9917     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9918
  9919     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 192
* ECS010.cbl
  9920        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9921
  9922     IF PB-CI-MUNI-TAX NOT NUMERIC
  9923        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9924
  9925     IF CR-CANCEL-STATE-TAX NUMERIC
  9926         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9927       ELSE
  9928         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9929
  9930     IF CR-CANCEL-MUNI-TAX NUMERIC
  9931         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9932       ELSE
  9933         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9934
  9935     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9936                                    MONTHS-DIFF-AH.
  9937
  9938     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9939
  9940 0630-PROCESS-LIFE-CANCEL.
  9941
  9942     IF CR-LFTYP = ZERO  OR
  9943        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9944         MOVE ZEROS               TO H-LFCM
  9945         GO TO 0650-PROCESS-A-H-CANCEL.
  9946
  9947     IF CR-LFRFND = +0
  9948        AND CR-DTHAMT > ZEROS
  9949        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
  9950        MOVE ZEROS               TO H-LFCM
  9951        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
  9952        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
  9953        GO TO 0650-PROCESS-A-H-CANCEL
  9954     END-IF
  9955
  9956     IF DTE-CLIENT = 'DCC'
  9957        IF PB-C-LF-RFND-CLP NUMERIC
  9958           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
  9959        END-IF
  9960     END-IF
  9961
  9962     IF PB-C-LF-PREM-TAX NUMERIC
  9963        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9964     END-IF
  9965     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9966     MOVE ' '                     TO  DC-OPTION-CODE.
  9967     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9968     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9969                                      WS-CR-LF-CANC-DT-N.
  9970
  9971
  9972     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9973     MOVE ' '                    TO DC-OPTION-CODE
  9974     PERFORM 8000-DATE-CONVERT-ROUTINE
  9975                                 THRU 8099-DATE-CONVERT-X
  9976     IF CR-LF-CNC-ENT-DT NOT NUMERIC
  9977        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 193
* ECS010.cbl
  9978     END-IF
  9979     IF NO-CONVERSION-ERROR
  9980        IF CR-LF-CNC-ENT-DT = ZEROS
  9981           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
  9982        END-IF
  9983     END-IF
  9984
  9985     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9986     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  9987     MOVE '1'                     TO  DC-OPTION-CODE.
  9988     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9989     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9990                                      DC-ODD-DAYS-OVER
  9991                                      DC-ELAPSED-DAYS.
  9992     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9993     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  9994
  9995     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  9996         ADD  +1                  TO  MONTHS-DIFF-LF.
  9997
  9998     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
  9999
 10000     MOVE  ZEROS                  TO  SUB.
 10001
 10002 0635-LIFE-CHARGEBACK-LOOP.
 10003
 10004     ADD    +1                    TO  SUB.
 10005
 10006     IF  SUB  GREATER THAN  +10
 10007         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10008
 10009*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10010*** WE FULLY EARN THE FEE
 10011     IF CR-CANCEL-REASON = 'R'
 10012        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10013           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10014           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10015           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10016        END-IF
 10017     END-IF
 10018
 10019     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10020         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10021         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10022
 10023     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10024         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10025
 10026     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10027         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10028
 10029     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10030
 10031
 10032 0640-CONTINUE-LIFE-CANCEL.
 10033
 10034     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10035        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 194
* ECS010.cbl
 10036
 10037     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10038
 10039     IF DTE-CLIENT = 'GIC'
 10040         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10041             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10042                                     LIFE-REFUND-CALC.
 10043
 10044*    IF DTE-CLIENT = 'TMS'
 10045     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10046
 10047     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10048         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10049     ELSE
 10050         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10051             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10052             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10053             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10054             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10055                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10056         ELSE
 10057             IF CR-LF-CURRENT-STATUS = '6'
 10058                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10059                 MOVE PB-C-LF-COMM-CHARGEBACK
 10060                                       TO CR-LF-COMM-CHARGEBACK
 10061                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10062                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10063
 10064*************************************************
 10065***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10066***  WAS CONVERTED TO 1056 BYTES.             ***
 10067*************************************************
 10068     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10069
 10070     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10071     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10072     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10073
 10074     COMPUTE H-LFCM ROUNDED =
 10075                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10076     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10077
 10078     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10079     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10080     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10081     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10082
 10083     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10084     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10085
 10086 0650-PROCESS-A-H-CANCEL.
 10087
 10088     IF CR-AHTYP = ZERO  OR
 10089        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10090         MOVE ZEROS               TO H-AHCM
 10091         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10092
 10093*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 195
* ECS010.cbl
 10094*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10095*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10096*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10097
 10098     IF DTE-CLIENT = 'DCC'
 10099        IF PB-C-AH-RFND-CLP NUMERIC
 10100           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10101        END-IF
 10102     END-IF
 10103
 10104     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10105     MOVE ' '                     TO  DC-OPTION-CODE.
 10106     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10107     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10108                                      WS-CR-AH-CANC-DT-N.
 10109
 10110     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10111     MOVE ' '                    TO DC-OPTION-CODE
 10112     PERFORM 8000-DATE-CONVERT-ROUTINE
 10113                                 THRU 8099-DATE-CONVERT-X
 10114     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10115        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10116     END-IF
 10117     IF NO-CONVERSION-ERROR
 10118        IF CR-AH-CNC-ENT-DT = ZEROS
 10119           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10120        END-IF
 10121     END-IF
 10122
 10123     IF PB-C-AH-PREM-TAX NUMERIC
 10124        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10125     END-IF
 10126     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10127     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10128     MOVE '1'                     TO  DC-OPTION-CODE.
 10129     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10130     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10131                                      DC-ODD-DAYS-OVER
 10132                                      DC-ELAPSED-DAYS.
 10133     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10134     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10135
 10136     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10137          ADD  +1                 TO  MONTHS-DIFF-AH.
 10138
 10139     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10140                                      WS-DCC-DDF-CB-LEVELS
 10141     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10142        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10143     END-IF
 10144*    IF DTE-CLIENT = 'DCC'
 10145*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10146*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10147*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10148*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10149*             OR (SUB > +10)
 10150*          END-PERFORM
 10151*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 196
* ECS010.cbl
 10152*             MOVE CR-BANK-NOCHRGB-MONTHS
 10153*                                TO AM-COMM-CHARGEBACK (SUB)
 10154*          END-IF
 10155*       END-IF
 10156*    END-IF
 10157
 10158
 10159     MOVE 'Y'                     TO WS-FIRST-K
 10160     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10161     MOVE  ZEROS                  TO  SUB.
 10162
 10163 0653-A-H-CHARGEBACK-LOOP.
 10164
 10165     ADD    +1                    TO  SUB.
 10166
 10167     IF  SUB  GREATER THAN  +10
 10168         GO TO  0655-CONTINUE-A-H-CANCEL.
 10169
 10170     IF CR-CANCEL-REASON = 'R'
 10171        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10172           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10173              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10174              GO TO  0653-A-H-CHARGEBACK-LOOP
 10175           END-IF
 10176           IF AM-COM-TYP (SUB) = 'J'
 10177              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10178              GO TO  0653-A-H-CHARGEBACK-LOOP
 10179           END-IF
 10180        END-IF
 10181     END-IF
 10182
 10183     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10184         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10185         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10186
 10187     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10188         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10189
 10190     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10191         OR ((DTE-CLIENT = 'DCC')
 10192             AND (CR-AHRFND = ZEROS))
 10193         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10194
 10195     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10196
 10197
 10198 0655-CONTINUE-A-H-CANCEL.
 10199
 10200     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10201        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10202
 10203     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10204
 10205     IF DTE-CLIENT = 'GIC'
 10206         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10207             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10208                                     A-H-REFUND-CALC.
 10209
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 197
* ECS010.cbl
 10210*    IF DTE-CLIENT = 'TMS'
 10211     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10212*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10213
 10214
 10215     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10216         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10217     ELSE
 10218         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10219             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10220             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10221             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10222             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10223                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10224         ELSE
 10225             IF CR-AH-CURRENT-STATUS = '7'
 10226                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10227                 MOVE PB-C-AH-COMM-CHARGEBACK
 10228                                       TO CR-AH-COMM-CHARGEBACK
 10229                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10230                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10231
 10232*************************************************
 10233***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10234***  WAS CONVERTED TO 1056 BYTES.             ***
 10235*************************************************
 10236     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10237
 10238     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10239     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10240     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10241
 10242     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10243        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10244        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10245           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10246           MOVE CNC-FACT TO UECLP-CLP-FACT
 10247        END-IF
 10248        IF CR-CANCEL-REASON = 'R'
 10249           MOVE +1               TO CNC-FACT
 10250        END-IF
 10251        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10252           (CR-AHPRM - (CR-LFPRM-ALT
 10253           + CR-ADDL-CLP)) * -1
 10254     ELSE
 10255        COMPUTE H-AHCM ROUNDED =
 10256          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10257     END-IF
 10258
 10259     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10260
 10261     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10262     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10263     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10264     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10265
 10266     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10267     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 198
* ECS010.cbl
 10268
 10269 0660-PROCESS-CANCEL-CONTINUE.
 10270
 10271     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10272
 10273     IF CR-POLICY-IS-REIN-ONLY
 10274        GO TO 0660-CONT.
 10275
 10276     MOVE 'Y'                    TO BILLED-SWITCH.
 10277     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10278
 10279     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10280     if dte-client = 'DCC'
 10281        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10282     end-if
 10283
 10284     IF CR-POLICY-IS-MONTHLY
 10285        GO TO 0660-CONT
 10286     END-IF
 10287
 10288     ADD +1                      TO BC-G-CNC.
 10289     ADD +1                      TO BC-COMM.
 10290     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10291     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10292     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10293     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10294     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10295     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10296
 10297     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10298         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10299     ELSE
 10300         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10301
 10302     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10303         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10304     ELSE
 10305         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10306
 10307
 10308 0660-CONT.
 10309
 10310     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10311     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10312
 10313     IF CR-LFRFND NEGATIVE
 10314       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10315           MOVE '*'                 TO REIN-VOID-LF-SW.
 10316     IF CR-AHRFND NEGATIVE
 10317       IF CR-AHRFND + A-H-REFUND = ZEROS
 10318           MOVE '*'                 TO REIN-VOID-AH-SW.
 10319
 10320     IF CR-LFRFND NOT = ZEROS
 10321       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10322           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10323     IF CR-AHRFND NOT = ZEROS
 10324       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10325           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 199
* ECS010.cbl
 10326
 10327     IF CR-DT = CR-LF-CANC-DT
 10328       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10329     IF CR-DT = CR-AH-CANC-DT
 10330       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10331
 10332     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10333
 10334     MOVE SPACES                    TO REIN-VOID-LF-SW
 10335                                       REIN-VOID-AH-SW
 10336                                       REIN-ADDL-LF-SW
 10337                                       REIN-ADDL-AH-SW.
 10338
 10339     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10340     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10341
 10342     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10343     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10344
 10345     IF (CR-LFTYP NOT = ZERO  AND
 10346        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10347        (CR-AHTYP NOT = ZERO  AND
 10348        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10349         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10350         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10351
 10352 0670-LIFE-CANCEL-VOID.
 10353
 10354     IF CR-LFTYP NOT = ZERO  AND
 10355        CR-LFRFND = ZERO  AND
 10356        PB-C-LF-CANCEL-AMT NEGATIVE
 10357         NEXT SENTENCE
 10358     ELSE
 10359         GO TO 0680-A-H-CANCEL-VOID.
 10360
 10361     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10362                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10363                                          CR-LF-CANC-DT
 10364                                          WS-CR-LF-CANC-DT-N
 10365                                          CR-LFRFND-CALC.
 10366
 10367     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10368
 10369     IF CR-LF-CANCEL-APPLIED
 10370         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10371         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10372     ELSE
 10373         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10374         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10375
 10376     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10377
 10378     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10379     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10380
 10381     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10382
 10383 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 200
* ECS010.cbl
 10384
 10385     IF CR-AHTYP NOT = ZERO  AND
 10386        CR-AHRFND = ZERO  AND
 10387        PB-C-AH-CANCEL-AMT NEGATIVE
 10388         NEXT SENTENCE
 10389     ELSE
 10390         GO TO 0690-END-CANCEL-PROCESSING.
 10391
 10392     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10393                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10394                                        CR-AH-CANC-DT
 10395                                        WS-CR-AH-CANC-DT-N
 10396                                        CR-AHRFND-CALC.
 10397
 10398     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10399
 10400     IF CR-AH-CANCEL-APPLIED
 10401         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10402         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10403     ELSE
 10404         MOVE CR-AH-STATUS-AT-CANCEL
 10405                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10406         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10407
 10408     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10409
 10410     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10411     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10412
 10413     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10414
 10415 0690-END-CANCEL-PROCESSING.
 10416
 10417     IF CR-LF-CANC-DT = ZEROS  AND
 10418        CR-AH-CANC-DT = ZEROS
 10419         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10420     END-IF
 10421
 10422     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10423         NEXT SENTENCE
 10424     ELSE
 10425         MOVE 'X'               TO REIN-RT-SW
 10426         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10427         MOVE ' '               TO REIN-RT-SW.
 10428
 10429     MOVE '*'                   TO TRANSACTION-FLAG.
 10430     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10431
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 201
* ECS010.cbl
 10433******************************************************************
 10434***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10435******************************************************************
 10436
 10437 0700-PROCESS-CLAIMS.
 10438
 10439     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10440        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10441         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10442             PENDING-MATCH-CONTROL
 10443         MOVE 0301 TO WS-ABEND-CODE
 10444         DISPLAY '******************************'
 10445         DISPLAY '***** ERROR LOCATION 011 *****'
 10446         DISPLAY '******************************'
 10447         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10448         GO TO ABEND-PGM.
 10449
 10450     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10451
 10452     ADD +1                       TO  W-LF-CLAIMS.
 10453
 10454     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10455     MOVE ' '                     TO  DC-OPTION-CODE.
 10456     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10457     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10458
 10459     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10460     MOVE ' '                     TO  DC-OPTION-CODE.
 10461     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10462     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10463
 10464     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10465     MOVE ' '                     TO  DC-OPTION-CODE.
 10466     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10467     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10468
 10469     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10470     MOVE ' '                     TO  DC-OPTION-CODE.
 10471     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10472     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10473
 10474     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10475
 10476**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10477****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10478****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10479****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10480****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10481****     ELSE
 10482****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10483
 10484     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10485         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10486
 10487******************************************************************
 10488***           P R O C E S S   D E A T H   C L A I M            ***
 10489******************************************************************
 10490
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 202
* ECS010.cbl
 10491     IF REIN-IS-RISK-PREMIUM
 10492       IF CR-DTH-DT = ZEROS
 10493           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10494           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10495           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10496
 10497     MOVE INCURRED-DATE            TO CR-DTH-DT
 10498                                      WS-CR-DTH-DT-N.
 10499
 10500     IF PC-CHARGEBLE-EXPENSE  OR
 10501        PC-NON-CHARGEBLE-EXPENSE
 10502         IF CR-LFTYP = '00'
 10503             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10504             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10505                     8399-LIFE-LOOKUP-X.
 10506
 10507     IF PC-CHARGEBLE-EXPENSE  OR
 10508        PC-NON-CHARGEBLE-EXPENSE
 10509         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10510         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10511         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10512         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10513         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10514         GO TO 0780-END-CLAIMS-PROCESSING.
 10515
 10516     ADD +1                       TO  CR-NUM-DTH-CLM.
 10517     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10518     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10519                                      WS-CR-DTH-PAY-DT-N.
 10520
 10521     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10522     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10523     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10524     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10525     IF CR-DTH-PAY-CD NOT = 'F'
 10526         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10527     INSPECT CR-DTH-PAY-CD
 10528         CONVERTING '12349' TO 'PFSXV'.
 10529     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10530
 10531     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10532         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10533       AND
 10534       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10535       OR
 10536        DTE-CLIENT = 'ACC' OR 'FDL')
 10537        NEXT SENTENCE
 10538     ELSE
 10539     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10540         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10541             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10542             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10543             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10544                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10545
 10546     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10547     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10548     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 203
* ECS010.cbl
 10549     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10550         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10551     ELSE
 10552         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10553     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10554
 10555     IF NOT CR-POLICY-IS-REIN-ONLY
 10556         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10557
 10558 0720-CANCEL-AH-COVERAGE.
 10559
 10560     IF CR-AHTYP = ZEROS  OR
 10561        NOT CR-AH-POLICY-IS-ACTIVE
 10562         GO TO 0740-DEATH-CLAIM-VOID.
 10563
 10564     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10565     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10566     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10567                                           WS-CR-AH-CANC-DT-N.
 10568     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10569                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10570
 10571     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10572     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10573     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10574     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10575     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10576     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10577     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10578     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10579
 10580 0740-DEATH-CLAIM-VOID.
 10581
 10582     IF CR-DTHAMT = ZERO  AND
 10583        PC-CLAIM-PAYMENT NEGATIVE
 10584         NEXT SENTENCE
 10585     ELSE
 10586         GO TO 0780-END-CLAIMS-PROCESSING.
 10587
 10588     MOVE '*'                           TO DEATH-VOID-FLAG.
 10589
 10590     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10591                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10592                                           CR-NUM-DTH-CLM
 10593                                           CR-DTH-RPT-DT
 10594                                           CR-DTH-PAY-DT
 10595                                           WS-CR-DTH-PAY-DT-N
 10596*                                          CR-DTHAMT-YTD
 10597*                                          CR-DTHAMT-LAST
 10598                                           CR-DTH-AGE.
 10599     MOVE ' '                           TO CR-DTH-PAY-CD.
 10600
 10601     IF CR-LF-DEATH-CLAIM-APPLIED
 10602         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10603         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10604     ELSE
 10605         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10606         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 204
* ECS010.cbl
 10607
 10608     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10609     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10610
 10611     IF CR-AH-DEATH-CLAIM-APPLIED
 10612         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10613         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10614         MOVE ZEROS                     TO CR-AH-CANC-DT
 10615                                           WS-CR-AH-CANC-DT-N
 10616                                           CR-AH-CANCEL-EXIT-DATE
 10617                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10618         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10619         MOVE CR-AH-TERM                TO TRD-AHTRM
 10620         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10621         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10622
 10623     GO TO 0780-END-CLAIMS-PROCESSING.
 10624
 10625******************************************************************
 10626***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10627******************************************************************
 10628
 10629 0750-PROCESS-DISABILITY-CLAIM.
 10630
 10631     ADD +1                       TO W-AH-CLAIMS.
 10632
 10633     MOVE INCURRED-DATE           TO CR-DIS-DT
 10634                                     WS-CR-DIS-DT-N.
 10635
 10636     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10637
 10638     IF REIN-AH-CLM-MONTHS = +1
 10639         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10640     ELSE
 10641       IF REIN-AH-CLM-MONTHS = +2
 10642           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10643       ELSE
 10644         IF REIN-AH-CLM-MONTHS = +3
 10645             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10646         ELSE
 10647           IF REIN-AH-CLM-MONTHS = +4
 10648               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10649           ELSE
 10650               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10651
 10652     IF PC-CHARGEBLE-EXPENSE  OR
 10653        PC-NON-CHARGEBLE-EXPENSE
 10654         IF CR-AHTYP = '00'
 10655             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10656             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10657                     8499-A-H-LOOKUP-X.
 10658
 10659     IF PC-CHARGEBLE-EXPENSE  OR
 10660        PC-NON-CHARGEBLE-EXPENSE
 10661         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10662         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10663         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10664         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 205
* ECS010.cbl
 10665         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10666         GO TO 0780-END-CLAIMS-PROCESSING.
 10667
 10668     ADD +1                       TO CR-NUM-DIS-CLM.
 10669
 10670     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10671     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10672                                      WS-CR-DIS-PAY-DT-N.
 10673     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10674                                      WS-CR-DIS-PTO-DT-N.
 10675
 10676     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10677     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10678     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10679
 10680     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10681     IF CR-DIS-PAY-CD NOT = 'S'
 10682         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10683     INSPECT CR-DIS-PAY-CD
 10684         CONVERTING '12349' TO 'PFSXV'.
 10685     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10686
 10687     IF PC-LUMP-SUM-PAYMENT
 10688         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10689           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10690           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10691           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10692                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10693
 10694     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10695     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10696     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10697     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10698     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10699
 10700     IF NOT CR-POLICY-IS-REIN-ONLY
 10701         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10702
 10703     IF NOT PC-LUMP-SUM-PAYMENT
 10704         GO TO 0780-END-CLAIMS-PROCESSING.
 10705
 10706 0770-CANCEL-LF-COVERAGE.
 10707
 10708     IF CR-LFTYP = ZEROS  OR
 10709        NOT CR-LF-POLICY-IS-ACTIVE
 10710         GO TO 0780-END-CLAIMS-PROCESSING.
 10711
 10712     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10713     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10714     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10715                                           WS-CR-LF-CANC-DT-N.
 10716     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10717                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10718
 10719     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10720     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10721     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10722     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 206
* ECS010.cbl
 10723     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10724     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10725     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10726     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10727
 10728 0780-END-CLAIMS-PROCESSING.
 10729
 10730     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10731         MOVE DTO-MO               TO TRD-LFACTMO
 10732         MOVE DTO-DA               TO TRD-LFACTDA
 10733         MOVE DTO-YR               TO TRD-LFACTYR
 10734         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10735     ELSE
 10736         MOVE PAY-MO               TO TRD-AHACTMO
 10737         MOVE PAY-DA               TO TRD-AHACTDA
 10738         MOVE PAY-YR               TO TRD-AHACTYR
 10739         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10740
 10741     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10742
 10743     IF NOT CR-POLICY-IS-REIN-ONLY
 10744         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10745         ADD +1                    TO BC-G-CLM.
 10746
 10747     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10748
 10749     IF DEATH-CLAIM-VOIDED
 10750         MOVE ZEROS                TO CR-DTH-DT
 10751                                      WS-CR-DTH-DT-N.
 10752     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10753
 10754     MOVE '*'                      TO TRANSACTION-FLAG.
 10755     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10756
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 207
* ECS010.cbl
 10758 0790-TABLE-DISAB-PERIODS.
 10759
 10760     MOVE +1                       TO SUB14.
 10761     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10762
 10763     MOVE +1                       TO SUB14.
 10764
 10765**************************************************************
 10766**                                                          **
 10767**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10768**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10769**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10770**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10771**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10772**                                                          **
 10773**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10774**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10775**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10776**                                                          **
 10777**************************************************************
 10778
 10779 0791-TABLE-AH-AMOUNT.
 10780
 10781     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10782         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10783
 10784     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10785         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10786                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10787         IF REIN-IS-RISK-PREMIUM
 10788             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10789             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10790             IF SUB14 = +1
 10791               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10792             ELSE
 10793             IF SUB14 = +2
 10794               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10795             ELSE
 10796             IF SUB14 = +3
 10797               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10798             ELSE
 10799             IF SUB14 = +4
 10800               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10801             ELSE
 10802               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10803
 10804
 10805     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10806         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10807         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10808                                        +  CR-INCUR-DISEXP (SUB14)
 10809         IF PC-CHARGEBLE-EXPENSE  OR
 10810            PC-NON-CHARGEBLE-EXPENSE
 10811             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10812             GO TO 0791-TABLE-AH-EXIT
 10813         ELSE
 10814             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10815             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 208
* ECS010.cbl
 10816
 10817     ADD +1                       TO SUB14.
 10818
 10819     GO TO 0791-TABLE-AH-AMOUNT.
 10820
 10821 0791-TABLE-AH-EXIT.
 10822     EXIT.
 10823
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 209
* ECS010.cbl
 10825**************************************************************
 10826**                                                          **
 10827** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10828** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10829**                                                          **
 10830** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10831** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10832** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10833** OCCURRENCE.                                              **
 10834**************************************************************
 10835 0792-MOVE-TABLE.
 10836
 10837     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10838                                  WS-CR-DIS-INCUR-DT-N (1).
 10839     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10840     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10841
 10842     MOVE +2                   TO SUB14.
 10843     MOVE +3                   TO SUB15.
 10844     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10845
 10846     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10847
 10848     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10849                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10850
 10851 0792-MOVE-TABLE-EXIT.
 10852     EXIT.
 10853
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 210
* ECS010.cbl
 10855**************************************************************
 10856**                                                          **
 10857**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10858** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10859** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10860** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10861** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10862**************************************************************
 10863
 10864 0794-REVIEW-TABLE.
 10865
 10866     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10867         GO TO 0794-REVIEW-TABLE-EXIT.
 10868
 10869     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10870         GO TO 0794-REVIEW-TABLE-EXIT.
 10871
 10872     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10873        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10874         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10875         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10876                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10877         MOVE SUB14            TO SUB15
 10878         ADD +1                TO SUB15
 10879         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10880         MOVE +1               TO SUB14
 10881         GO TO 0794-REVIEW-TABLE.
 10882
 10883     ADD +1                    TO SUB14.
 10884
 10885     GO TO 0794-REVIEW-TABLE.
 10886
 10887 0794-REVIEW-TABLE-EXIT.
 10888     EXIT.
 10889
 10890 0794A-BUMP-TBL.
 10891
 10892     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10893         GO TO 0794A-BUMP-TBL-EXIT.
 10894
 10895     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10896                             CR-DISAB-DETAIL-DATA (SUB14).
 10897
 10898     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10899                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10900                                  CR-INCUR-DISAMT (SUB15)
 10901                                  CR-INCUR-DISEXP (SUB15).
 10902
 10903     ADD +1                    TO SUB14
 10904                                  SUB15.
 10905     GO TO 0794A-BUMP-TBL.
 10906
 10907 0794A-BUMP-TBL-EXIT.
 10908     EXIT.
 10909
 10910 0795-DCC-NSP-LF.
 10911
 10912     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 211
* ECS010.cbl
 10913     MOVE 'L'                        TO DC-OPTION-CODE.
 10914     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10915     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10916     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10917     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10918     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10919     MOVE CR-APR                     TO CP-LOAN-APR.
 10920     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10921     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10922     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10923     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10924
 10925     MOVE '3'                        TO CP-PROCESS-TYPE.
 10926     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10927     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10928
 10929     IF CR-LFTYP = ZERO
 10930         GO TO 0795-EXIT
 10931     END-IF
 10932
 10933     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10934         GO TO 0795-EXIT
 10935     END-IF
 10936     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10937     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10938     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10939     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10940                                        CP-RATING-BENEFIT-AMT.
 10941     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10942     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10943     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10944     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10945     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10946     MOVE CR-STATE                   TO CP-STATE.
 10947     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10948
 10949     IF CP-STATE-STD-ABBRV = 'OR'
 10950         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10951
 10952     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10953
 10954     IF CP-ERROR-RATE-NOT-FOUND  OR
 10955        CP-ERROR-RATE-IS-ZERO
 10956         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10957                                     TO WS-ABEND-MESSAGE
 10958         MOVE 0302                   TO WS-ABEND-CODE
 10959         DISPLAY '******************************'
 10960         DISPLAY '***** ERROR LOCATION 018 *****'
 10961         DISPLAY '******************************'
 10962         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10963         GO TO ABEND-PGM.
 10964
 10965     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10966
 10967*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10968*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 10969
 10970     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 212
* ECS010.cbl
 10971                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10972
 10973     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 10974
 10975 0795-exit.
 10976     exit.
 10977
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 213
* ECS010.cbl
 10979******************************************************************
 10980***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 10981******************************************************************
 10982
 10983 0800-PROCESS-RESERVES.
 10984
 10985     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10986       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 10987           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 10988
 10989     if (dte-client = 'AHL')
 10990        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 10991        and (cr-ahtyp (1:1) = 'M')
 10992        and ((pc-future-reserve-amt > zeros)
 10993            or (pc-ptc-reserve-amt > zeros))
 10994        compute pc-ibnr-reserve-amt =
 10995           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 10996        display ' using 205 of ptc and future ' cr-cert-no
 10997     end-if
 10998
 10999     if (dte-client = 'AHL')
 11000        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11001        and (cr-lftyp (1:1) = 'M')
 11002        and (pc-ptc-reserve-amt > zeros)
 11003        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11004        display ' using 217 of ptc ' cr-cert-no
 11005     end-if
 11006
 11007     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11008
 11009     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11010     MOVE ' '                     TO  DC-OPTION-CODE.
 11011     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11012     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11013
 11014     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11015     MOVE ' '                     TO  DC-OPTION-CODE.
 11016     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11017     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11018
 11019     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11020     MOVE ' '                     TO  DC-OPTION-CODE.
 11021     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11022     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11023
 11024     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11025
 11026     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11027         ADD +1                     TO W-LF-RESERVES
 11028         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11029         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11030         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11031         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11032         MOVE INCURRED-DATE         TO CR-DTH-DT
 11033                                       WS-CR-DTH-DT-N
 11034         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11035
 11036     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 214
* ECS010.cbl
 11037         ADD +1                     TO W-AH-RESERVES
 11038         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11039         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11040         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11041         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11042         MOVE INCURRED-DATE         TO CR-DIS-DT
 11043                                       WS-CR-DIS-DT-N
 11044         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11045
 11046     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11047     MOVE 'IBNR'                    TO TRD-IBNRX.
 11048     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11049     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11050     COMPUTE TRD-FUTRSV EQUAL
 11051            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11052     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11053     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11054
 11055 0820-END-RESERVE-PROCESSING.
 11056
 11057     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11058
 11059     IF NOT CR-POLICY-IS-REIN-ONLY
 11060         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11061                                            2499-BLD-RESERVE-X
 11062         ADD +1 TO BC-G-CRS.
 11063
 11064     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11065
 11066     MOVE '*'                    TO TRANSACTION-FLAG.
 11067     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11068
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 215
* ECS010.cbl
 11070******************************************************************
 11071***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11072******************************************************************
 11073
 11074 0900-PROCESS-CERT-CHANGES.
 11075
 11076     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11077
 11078     IF CC-AGE NOT NUMERIC  OR
 11079        CC-AGE = CR-AGE
 11080         MOVE ZEROS TO CC-AGE.
 11081
 11082     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11083        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11084         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11085
 11086     IF CC-INSURED-SEX NOT = 'M'  AND
 11087        CC-INSURED-SEX NOT = 'F'
 11088         MOVE SPACES TO CC-INSURED-SEX.
 11089
 11090     IF CC-LOAN-APR NOT NUMERIC  OR
 11091        CC-LOAN-APR = CR-APR
 11092         MOVE ZEROS TO CC-LOAN-APR.
 11093
 11094     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11095        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11096         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11097
 11098     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11099        CC-IND-GRP-TYPE NOT = '2'
 11100         MOVE SPACES TO CC-IND-GRP-TYPE.
 11101
 11102     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11103****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11104         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11105
 11106     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11107        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11108         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11109
 11110     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11111        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11112        CR-LFTYP = ZEROS
 11113         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11114
 11115     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11116        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11117        CR-AHTYP = ZEROS
 11118         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11119
 11120     IF CR-BILLED NOT NUMERIC
 11121         MOVE ZEROS TO CR-BILLED.
 11122
 11123     IF CR-LIVES NOT NUMERIC
 11124         MOVE ZEROS TO CR-LIVES.
 11125
 11126     IF CC-LIVES NOT NUMERIC  OR
 11127        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 216
* ECS010.cbl
 11128         MOVE ZEROS TO CC-LIVES.
 11129
 11130     IF CC-BILLED NOT NUMERIC  OR
 11131        CC-BILLED = CR-BILLED
 11132         MOVE ZEROS TO CC-BILLED.
 11133
 11134     IF CC-INSURED-LAST-NAME NOT = SPACES
 11135         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11136     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11137         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11138     IF CC-INSURED-INITIAL2 NOT = SPACES
 11139         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11140     IF CC-JT-LAST-NAME NOT = SPACES
 11141         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11142     IF CC-JT-FIRST-NAME NOT = SPACES
 11143         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11144     IF CC-JT-INITIAL NOT = SPACES
 11145         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11146
 11147     IF CC-AGE NOT = ZEROS
 11148         MOVE CC-AGE                 TO CR-AGE
 11149                                        DET-AGE
 11150     ELSE
 11151         MOVE ZEROS                  TO DET-AGE.
 11152
 11153     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11154         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11155                                        DET-JT-AGE
 11156     ELSE
 11157         MOVE ZEROS                  TO DET-JT-AGE.
 11158
 11159     IF CC-INSURED-SEX NOT = SPACES
 11160         MOVE CC-INSURED-SEX         TO CR-SEX
 11161                                        DET-SEX
 11162     ELSE
 11163         MOVE SPACE                  TO DET-SEX.
 11164
 11165     IF CC-MEMBER-NO NOT = SPACES
 11166         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11167                                        DET-PR-MEM
 11168     ELSE
 11169         MOVE SPACES                 TO DET-PR-MEM.
 11170
 11171     IF CC-SOC-SEC-NO NOT = SPACES
 11172         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11173                                        DET-PR-SS
 11174     ELSE
 11175         MOVE SPACES                 TO DET-PR-SS.
 11176
 11177     IF CC-LOAN-APR NOT = ZEROS
 11178         MOVE CC-LOAN-APR            TO CR-APR
 11179                                        DET-PR-APR
 11180     ELSE
 11181         MOVE ZEROS                  TO DET-PR-APR.
 11182
 11183     IF CC-AGE NOT = ZERO  OR
 11184        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11185        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 217
* ECS010.cbl
 11186        CC-MEMBER-NO NOT = SPACES  OR
 11187        CC-SOC-SEC-NO NOT = SPACES  OR
 11188        CC-LOAN-APR NOT = ZERO
 11189         MOVE DET-PR-UREC            TO TR-DTL2
 11190         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11191         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11192
 11193     IF CC-LF-ORIG-TERM NOT = ZEROS
 11194         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11195         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11196                                        DET-N-LF-TERM
 11197     ELSE
 11198         MOVE ZEROS                  TO DET-O-LF-TERM
 11199                                        DET-N-LF-TERM.
 11200
 11201     IF CC-AH-ORIG-TERM NOT = ZEROS
 11202         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11203         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11204                                        DET-N-AH-TERM
 11205     ELSE
 11206         MOVE ZEROS                  TO DET-O-AH-TERM
 11207                                        DET-N-AH-TERM.
 11208
 11209     IF CC-LIVES NOT = ZEROS
 11210         MOVE CR-LIVES               TO DET-O-LIVES
 11211         MOVE CC-LIVES               TO CR-LIVES
 11212                                        DET-N-LIVES
 11213     ELSE
 11214         MOVE ZEROS                  TO DET-O-LIVES
 11215                                        DET-N-LIVES.
 11216
 11217     IF CC-BILLED NOT  = ZEROES
 11218         MOVE CC-BILLED              TO CR-BILLED.
 11219
 11220     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11221        CC-AH-ORIG-TERM NOT = ZERO  OR
 11222        CC-LIVES NOT = ZERO
 11223         MOVE DET-PR-UREC-2          TO TR-DTL2
 11224         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11225         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11226
 11227     IF CC-IND-GRP-TYPE NOT = SPACES
 11228         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11229                                        DET-IND-GRP
 11230     ELSE
 11231         MOVE SPACE                  TO DET-IND-GRP.
 11232
 11233     IF CC-PAY-FREQUENCY NOT = ZEROS
 11234         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11235                                        DET-PMT-FREQ
 11236     ELSE
 11237         MOVE ZEROS                  TO DET-PMT-FREQ.
 11238
 11239     IF CC-POLICY-FORM-NO NOT = SPACES
 11240         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11241                                        DET-POL-FORM
 11242     ELSE
 11243         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 218
* ECS010.cbl
 11244
 11245     IF CC-LOAN-OFFICER NOT = SPACES
 11246         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11247                                        DET-LOAN-OFFICER
 11248     ELSE
 11249         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11250
 11251     IF CC-USER-FIELD NOT = SPACES
 11252         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11253                                        DET-USER-CODE
 11254     ELSE
 11255         MOVE SPACE                  TO DET-USER-CODE.
 11256
 11257     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11258        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11259        CC-POLICY-FORM-NO NOT = SPACES  OR
 11260        CC-LOAN-OFFICER NOT = SPACES  OR
 11261        CC-USER-FIELD NOT = SPACES
 11262         MOVE DET-PR-UREC-3          TO TR-DTL2
 11263         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11264         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11265
 11266**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11267****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11268****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11269****                                    DET-CLM-DEDUCT
 11270**** ELSE
 11271****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11272
 11273     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11274         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11275                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11276                                        DET-CAN-DEDUCT
 11277     ELSE
 11278         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11279
 11280**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11281     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11282         MOVE DET-PR-UREC-4          TO TR-DTL2
 11283         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11284         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11285
 11286     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11287         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11288
 11289     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11290         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11291
 11292     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11293         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11294
 11295     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11296         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11297
 11298     IF CC-LF-BENEFIT-CD NOT = SPACES
 11299         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11300                                     DET-LF-BEN-CD
 11301     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 219
* ECS010.cbl
 11302         MOVE SPACES             TO DET-LF-BEN-CD.
 11303
 11304     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11305         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11306                                     DET-LF-PREM
 11307     ELSE
 11308         MOVE ZEROS              TO DET-LF-PREM.
 11309
 11310     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11311         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11312                                     DET-LF-BEN
 11313     ELSE
 11314         MOVE ZEROS              TO DET-LF-BEN.
 11315
 11316     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11317        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11318        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11319         MOVE DET-PR-UREC-5          TO TR-DTL2
 11320         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11321         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11322
 11323     IF CC-AH-BENEFIT-CD NOT = SPACES
 11324         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11325                                     DET-AH-BEN-CD
 11326     ELSE
 11327         MOVE SPACES             TO DET-AH-BEN-CD.
 11328
 11329     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11330         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11331                                     DET-AH-PREM
 11332     ELSE
 11333         MOVE ZEROS              TO DET-AH-PREM.
 11334
 11335     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11336         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11337                                     DET-AH-BEN
 11338     ELSE
 11339         MOVE ZEROS              TO DET-AH-BEN.
 11340
 11341     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11342        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11343        CC-AH-BENEFIT-AMT NOT = ZEROS
 11344         MOVE DET-PR-UREC-6          TO TR-DTL2
 11345         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11346         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11347
 11348 0910-END-CHANGE-PROCESSING.
 11349
 11350     IF CR-LNAME = ALL '*'
 11351         MOVE SPACES                 TO CR-LNAME.
 11352     IF CR-FNAME = ALL '*'
 11353         MOVE SPACES                 TO CR-FNAME.
 11354     IF CR-INIT = '*'
 11355         MOVE SPACES                 TO CR-INIT.
 11356     IF CR-SOC-SEC = ALL '*'
 11357         MOVE SPACES                 TO CR-SOC-SEC.
 11358     IF CR-JT-LNAME = ALL '*'
 11359         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 220
* ECS010.cbl
 11360     IF CR-JT-FNAME = ALL '*'
 11361         MOVE SPACES                 TO CR-JT-FNAME.
 11362     IF CR-JT-INIT = '*'
 11363         MOVE SPACES                 TO CR-JT-INIT.
 11364     IF CR-POLICY-FORM-NO = ALL '*'
 11365         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11366     IF CR-MEMBER-NO = ALL '*'
 11367         MOVE SPACES                 TO CR-MEMBER-NO.
 11368     IF CR-LOAN-OFFICER = ALL '*'
 11369         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11370     IF CR-USER-CODE = ALL '*'
 11371         MOVE SPACES                 TO CR-USER-CODE.
 11372
 11373     ADD +1 TO BC-G-CTN.
 11374     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 221
* ECS010.cbl
 11376 0920-GET-BANK-FEES.
 11377
 11378     IF CR-CERT-NO = '0008771354 '
 11379        DISPLAY ' MADE IT TO 0920 '
 11380     END-IF
 11381
 11382     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11383     MOVE CR-CARRIER             TO AG-CARRIER
 11384     MOVE CR-GROUPING            TO AG-GROUPING
 11385     MOVE CR-BANK-NO             TO AG-BANK
 11386     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11387     MOVE 'B'                    TO AG-TYPE
 11388
 11389*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11390*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11391*                                THRU 0925-EXIT
 11392*       GO TO 0920-EXIT
 11393*    END-IF
 11394
 11395     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11396
 11397     IF CR-CERT-NO = '0008771354 '
 11398        DISPLAY ' MADE IT AFTER START '
 11399     END-IF
 11400
 11401     .
 11402 0920-READ-ERAGTC.
 11403
 11404     IF ERAGTC-FILE-STATUS = '00'
 11405        READ ERAGTC NEXT RECORD
 11406     IF CR-CERT-NO = '0008771354 '
 11407        DISPLAY ' MADE ONE READ '
 11408     END-IF
 11409
 11410        IF ERAGTC-FILE-STATUS = '00'
 11411           IF (CR-CARRIER         = AG-CARRIER)
 11412              AND (CR-GROUPING    = AG-GROUPING)
 11413              AND (CR-BANK-NO     = AG-BANK)
 11414              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11415                 GO TO 0920-READ-ERAGTC
 11416              ELSE
 11417                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11418                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11419                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11420                                 THRU 0925-EXIT
 11421                    MOVE AG-CONTROL-PRIMARY
 11422                                 TO WS-PREV-BANK-COMM-KEY
 11423                    GO TO 0920-EXIT
 11424                 END-IF
 11425              END-IF
 11426           END-IF
 11427        END-IF
 11428     END-IF
 11429
 11430     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11431*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11432
 11433     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 222
* ECS010.cbl
 11434        AND (PB-I-BANK-FEE NOT = ZEROS)
 11435        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11436        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11437        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11438        MOVE ' '                 TO WS-BNK-RECALC (1)
 11439        MOVE +2                  TO IB
 11440     END-IF
 11441
 11442     .
 11443 0920-EXIT.
 11444     EXIT.
 11445
 11446 0925-BUILD-WORK-BNK-COMM.
 11447
 11448     IF CR-CERT-NO = '0008771354 '
 11449        DISPLAY ' MADE IT TO 0925 '
 11450     END-IF
 11451
 11452     MOVE +1                     TO IA IB
 11453
 11454*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11455*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11456*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11457*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11458*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11459*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11460*       ADD +1                   TO IB
 11461*    END-IF
 11462*    .
 11463*0925-BUILD-CONTINUE.
 11464
 11465     IF CR-CERT-NO = '00087735841'
 11466        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11467        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11468        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11469     END-IF
 11470
 11471*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11472     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11473        (IA > +10)
 11474        OR (IB > +10)
 11475        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11476           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11477           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11478*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11479           IF AG-SPP-FEES (IA) NOT NUMERIC
 11480              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11481           END-IF
 11482           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11483           MOVE AG-RECALC-LV-INDIC (IA)
 11484                                 TO WS-BNK-RECALC (IB)
 11485        ELSE
 11486           MOVE SPACES           TO WS-BNK-AGT (IB)
 11487                                    WS-BNK-TYPE (IB)
 11488                                    WS-BNK-RECALC (IB)
 11489           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11490        END-IF
 11491        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 223
* ECS010.cbl
 11492     END-PERFORM
 11493
 11494     .
 11495 0925-EXIT.
 11496     EXIT.
 11497
 11498 0930-BUILD-CERT-TRLR.
 11499
 11500     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11501     MOVE 'CS'                   TO CS-RECORD-ID
 11502     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11503     MOVE CR-CARRIER             TO CS-CARRIER
 11504     MOVE CR-GROUPING            TO CS-GROUPING
 11505     MOVE CR-STATE               TO CS-STATE
 11506     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11507     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11508     MOVE CR-CERT-NO             TO CS-CERT-NO
 11509     MOVE 'A'                    TO CS-TRAILER-TYPE
 11510
 11511     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11512
 11513     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11514        WRITE CERTIFICATE-TRAILERS
 11515        IF ELCRTT-FILE-STATUS = '00'
 11516           CONTINUE
 11517        ELSE
 11518           IF ELCRTT-FILE-STATUS = '22'
 11519              READ ELCRTT
 11520              IF ELCRTT-FILE-STATUS = '00'
 11521                 MOVE WS-BANK-COMMISSIONS
 11522                                 TO CS-BANK-COMMISSION-AREA
 11523                 REWRITE CERTIFICATE-TRAILERS
 11524                 IF ELCRTT-FILE-STATUS NOT = '00'
 11525                    DISPLAY ' BAD REWRITE ELCRTT '
 11526                                 ELCRTT-FILE-STATUS
 11527                    PERFORM ABEND-PGM
 11528                 END-IF
 11529              ELSE
 11530                 DISPLAY ' BAD READ    ELCRTT '
 11531                                  ELCRTT-FILE-STATUS
 11532                 PERFORM ABEND-PGM
 11533              END-IF
 11534           ELSE
 11535              DISPLAY ' BAD WRITE ELCRTT '
 11536                                 ELCRTT-FILE-STATUS
 11537              PERFORM ABEND-PGM
 11538           END-IF
 11539        END-IF
 11540     END-IF
 11541
 11542     .
 11543 0930-EXIT.
 11544     EXIT.
 11545
 11546 0950-BUILD-CERT-C-TRLR.
 11547
 11548     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11549     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 224
* ECS010.cbl
 11550     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11551     MOVE CR-CARRIER             TO CS-CARRIER.
 11552     MOVE CR-GROUPING            TO CS-GROUPING.
 11553     MOVE CR-STATE               TO CS-STATE.
 11554     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11555     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11556     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11557     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11558
 11559     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11560
 11561     WRITE CERTIFICATE-TRAILERS.
 11562     IF ELCRTT-FILE-STATUS = '00'
 11563        CONTINUE
 11564     ELSE
 11565        IF ELCRTT-FILE-STATUS = '22'
 11566           READ ELCRTT
 11567           IF ELCRTT-FILE-STATUS = '00'
 11568              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11569              REWRITE CERTIFICATE-TRAILERS
 11570              IF ELCRTT-FILE-STATUS NOT = '00'
 11571                 DISPLAY ' BAD REWRITE ELCRTT '
 11572                              ELCRTT-FILE-STATUS
 11573                 PERFORM ABEND-PGM
 11574              END-IF
 11575           ELSE
 11576              DISPLAY ' BAD READ    ELCRTT '
 11577                               ELCRTT-FILE-STATUS
 11578              PERFORM ABEND-PGM
 11579           END-IF
 11580        ELSE
 11581           DISPLAY ' BAD WRITE ELCRTT '
 11582                              ELCRTT-FILE-STATUS
 11583           PERFORM ABEND-PGM
 11584        END-IF
 11585     END-IF.
 11586
 11587     .
 11588 0950-EXIT.
 11589     EXIT.
 11590
 11591
 11592******************************************************************
 11593***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11594******************************************************************
 11595
 11596 1000-SET-COMMISSION-STRUCTURE.
 11597
 11598     MOVE +1                     TO IA
 11599                                    IB.
 11600
 11601 1100-GET-COMMISSION-LEVEL.
 11602
 11603     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11604
 11605     IF WK-AGT = '0000000000' OR SPACES
 11606         MOVE +0                 TO WK-L-RT
 11607                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 225
* ECS010.cbl
 11608                                    WK-A-RT
 11609         GO TO 1200-SET-COMMISSION-LEVEL.
 11610
 11611 1110-LIFE-COMMISSION.
 11612
 11613     IF CR-LFTYP = ZERO  OR
 11614       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11615         MOVE +0 TO WK-L-RT
 11616                    WK-J-RT
 11617         GO TO 1130-A-H-COMMISSION.
 11618
 11619     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11620         GO TO 1120-JOINT-LIFE-COMMISSION.
 11621
 11622     IF WK-L-RT NUMERIC
 11623        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11624         MOVE WK-L-RT                TO WS-COMMISSION
 11625         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11626         MOVE WS-COMMISSION          TO WK-L-RT
 11627         GO TO 1130-A-H-COMMISSION.
 11628
 11629     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11630     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11631     MOVE ZEROS                      TO WS-SUB1.
 11632     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11633
 11634     IF WS-SUB1 = ZEROS
 11635         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11636     ELSE
 11637         MOVE WK-RATE                TO WK-L-RT
 11638         GO TO 1130-A-H-COMMISSION.
 11639
 11640     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11641
 11642     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11643     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11644     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11645     MOVE WK-RATE                    TO WK-L-RT.
 11646
 11647     GO TO 1130-A-H-COMMISSION.
 11648
 11649 1120-JOINT-LIFE-COMMISSION.
 11650
 11651     IF WK-J-RT NUMERIC
 11652        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11653         MOVE WK-J-RT                TO WS-COMMISSION
 11654         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11655         MOVE WS-COMMISSION          TO WK-J-RT
 11656         GO TO 1130-A-H-COMMISSION.
 11657
 11658     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11659     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11660     MOVE ZEROS                      TO WS-SUB1.
 11661     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11662
 11663     IF WS-SUB1 = ZEROS
 11664         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11665     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 226
* ECS010.cbl
 11666         MOVE WK-RATE                TO WK-J-RT
 11667         GO TO 1130-A-H-COMMISSION.
 11668
 11669     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11670
 11671     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11672     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11673     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11674     MOVE WK-RATE                    TO WK-J-RT.
 11675
 11676 1130-A-H-COMMISSION.
 11677
 11678     IF CR-AHTYP = ZERO  OR
 11679       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11680         MOVE +0 TO WK-A-RT
 11681         GO TO 1200-SET-COMMISSION-LEVEL.
 11682
 11683     IF WK-A-RT NUMERIC
 11684        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11685         MOVE WK-A-RT                TO WS-COMMISSION
 11686         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11687         MOVE WS-COMMISSION          TO WK-A-RT
 11688         GO TO 1200-SET-COMMISSION-LEVEL.
 11689
 11690     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11691     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11692     MOVE ZEROS                      TO WS-SUB1.
 11693     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11694
 11695     IF WS-SUB1 = ZEROS
 11696         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11697     ELSE
 11698         MOVE WK-RATE                TO WK-A-RT
 11699         GO TO 1200-SET-COMMISSION-LEVEL.
 11700
 11701     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11702
 11703     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11704     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11705     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11706     MOVE WK-RATE                    TO WK-A-RT.
 11707
 11708 1200-SET-COMMISSION-LEVEL.
 11709
 11710     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11711     IF WK-AGT = '0000000000' OR SPACES
 11712         MOVE SPACE                   TO WK-N-TYPE (IA)
 11713     ELSE
 11714         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11715
 11716     IF CR-LFTYP = ZERO
 11717         MOVE +0                      TO WK-L-RT1  (IA)
 11718     ELSE
 11719         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11720             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11721         ELSE
 11722             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11723
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 227
* ECS010.cbl
 11724     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11725
 11726     IF RC-COMM-FLG = 'X'
 11727        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11728*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11729*             AND (IA = +5))
 11730            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11731            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11732            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11733            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11734
 11735     IF IA LESS THAN +10
 11736         ADD +1 TO IA
 11737         GO TO 1100-GET-COMMISSION-LEVEL.
 11738
 11739     GO TO 1499-SET-COMM-X.
 11740
 11741 1300-READ-ERCTBL-FILE.
 11742
 11743     IF CTBL-SEARCH = LAST-CTBL
 11744         GO TO 1399-READ-ERCTBL-X.
 11745
 11746     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11747
 11748     IF COMM-OPEN-SW = ' '
 11749         MOVE 'X'                        TO COMM-OPEN-SW
 11750         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11751         OPEN INPUT ERCTBL
 11752         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11753             NEXT SENTENCE
 11754            ELSE
 11755             MOVE '41'                   TO ABEND-CODE-1
 11756             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11757             DISPLAY '******************************'
 11758             DISPLAY '***** ERROR LOCATION 012 *****'
 11759             DISPLAY '******************************'
 11760             DISPLAY '******************************'
 11761             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11762             GO TO ABEND-PGM.
 11763
 11764     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11765                                            LAST-CTBL.
 11766     READ ERCTBL.
 11767
 11768     IF ERCTBL-FILE-STATUS = '23'
 11769         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11770                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11771                 ' CTBL: ' CTBL-SEARCH
 11772         MOVE '*'                TO CTBL-ERROR-SWITCH
 11773         MOVE '44'               TO ABEND-CODE-1
 11774         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11775         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11776         DISPLAY '******************************'
 11777         DISPLAY '***** ERROR LOCATION 013 *****'
 11778         DISPLAY '******************************'
 11779         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11780*        IF DTE-CLIENT NOT = 'NCL'
 11781         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 228
* ECS010.cbl
 11782           AND 'AHL'
 11783             GO TO ABEND-PGM
 11784         ELSE
 11785             NEXT SENTENCE
 11786     ELSE
 11787         IF ERCTBL-FILE-STATUS NOT = '00'
 11788             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11789             MOVE '44'               TO ABEND-CODE-1
 11790             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11791             DISPLAY '******************************'
 11792             DISPLAY '***** ERROR LOCATION 014 *****'
 11793             DISPLAY '******************************'
 11794             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11795             GO TO ABEND-PGM.
 11796
 11797     ADD +1                            TO ERCTBL-READS.
 11798
 11799 1399-READ-ERCTBL-X.
 11800     EXIT.
 11801
 11802 1400-GET-COMM-PERCENT.
 11803
 11804     IF CTBL-ERROR
 11805         MOVE ZEROS                      TO WK-RATE
 11806         GO TO 1489-GET-PERCENT-X.
 11807
 11808     MOVE +1 TO IB.
 11809     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11810        (CT-TBF (1) NOT EQUAL +9999999.99)
 11811         ADD +9 TO IB
 11812         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11813            (CT-TBF (2) NOT EQUAL +9999999.99)
 11814             ADD +9 TO IB.
 11815
 11816     IF CR-AGE GREATER CT-AGE (1)
 11817         ADD +3 TO IB
 11818         IF CR-AGE GREATER CT-AGE (2)
 11819             ADD +3 TO IB.
 11820
 11821     IF WS-COMM-TERM GREATER CT-TRM (1)
 11822         ADD +1 TO IB
 11823         IF WS-COMM-TERM GREATER CT-TRM (2)
 11824             ADD +1 TO IB.
 11825
 11826     IF CT-RT (IB) NOT NUMERIC
 11827         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11828         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11829         GO TO 1300-READ-ERCTBL-FILE.
 11830
 11831     MOVE CT-RT (IB) TO WK-RATE.
 11832
 11833 1489-GET-PERCENT-X.
 11834     EXIT.
 11835
 11836 1499-SET-COMM-X.
 11837     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 229
* ECS010.cbl
 11839******************************************************************
 11840***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11841******************************************************************
 11842
 11843 1500-GET-ACCT-LEVEL-LF-COMM.
 11844
 11845     MOVE ZEROS                      TO ACCT-COMM-LF
 11846                                        ACCT-COMM-AH.
 11847
 11848     MOVE +1                         TO IA.
 11849
 11850 1510-ACCT-LEVEL-LOOP.
 11851
 11852     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11853         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11854             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11855             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11856         ELSE
 11857             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11858                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11859
 11860     IF IA LESS THAN +10
 11861         ADD +1 TO IA
 11862         GO TO 1510-ACCT-LEVEL-LOOP.
 11863
 11864 1519-ACCT-LF-COMM-X.
 11865     EXIT.
 11866
 11867
 11868 1550-GET-ACCT-LEVEL-AH-COMM.
 11869
 11870     MOVE ZEROS                      TO ACCT-COMM-AH.
 11871
 11872     MOVE +1                         TO IA.
 11873
 11874 1555-ACCT-LEVEL-LOOP.
 11875
 11876     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11877         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11878             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11879
 11880     IF IA LESS THAN +10
 11881         ADD +1 TO IA
 11882         GO TO 1555-ACCT-LEVEL-LOOP.
 11883
 11884 1599-ACCT-AH-COMM-X.
 11885     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 230
* ECS010.cbl
 11887******************************************************************
 11888***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11889******************************************************************
 11890
 11891 1600-RECALC-COMM-EXTR.
 11892
 11893     IF RC-COMM-FLG = 'X'  OR
 11894        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11895        CR-POLICY-IS-DECLINED  OR
 11896        CR-POLICY-IS-VOID
 11897         GO TO 1899-RECALC-COMM-EXTR-X.
 11898
 11899     MOVE 'X'                           TO RC-COMM-FLG.
 11900
 11901     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11902         GO TO 1899-RECALC-COMM-EXTR-X.
 11903
 11904     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11905
 11906     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11907         GO TO 1899-RECALC-COMM-EXTR-X.
 11908
 11909     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11910
 11911     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11912         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11913             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11914
 11915     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11916         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11917                                           WK-NEW-RATES
 11918         GO TO 1899-RECALC-COMM-EXTR-X.
 11919
 11920     MOVE +1                            TO SUB8.
 11921     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11922
 11923 1610-CK-DUPLICATE-ENTRIES.
 11924     PERFORM 1620-CK-DUPL-ENTR-NEW
 11925         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11926             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11927
 11928 1619-CK-DUPLICATE-ENTRIES-XIT.
 11929     EXIT.
 11930
 11931 1620-CK-DUPL-ENTR-NEW.
 11932     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11933         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11934         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11935         MOVE +0                        TO CR-LCOM-L (SUB11)
 11936                                           CR-LCOM-AH (SUB11)
 11937         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11938         MOVE 11                        TO SUB12.
 11939
 11940 1629-CK-DUPL-ENTR-NEW-XIT.
 11941     EXIT.
 11942
 11943 1700-REVERSE-OLD-COMM-LOOP.
 11944     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 231
* ECS010.cbl
 11945     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11946
 11947     IF SUB8 LESS THAN +10
 11948         ADD +1 TO SUB8
 11949         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11950
 11951     MOVE 'O' TO RECALC-TYPE.
 11952
 11953     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11954
 11955     GO TO 1800-MOVE-NEW-COMM-RATES.
 11956
 11957 1710-DO-R-C-EXTRACTS.
 11958
 11959     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11960
 11961     PERFORM 1720-CHECK-COMM-LEVELS
 11962         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11963             VARYING SUB13 FROM +1 BY +1
 11964                 UNTIL SUB13 GREATER THAN 10.
 11965
 11966     MOVE '8'                           TO DE-TRANS.
 11967     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11968*****PERFORM EXTRACT-DATE-RELOAD.
 11969     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11970     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11971     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 11972     PERFORM EXTRACT-DATE-LOAD.
 11973     MOVE 'R'                           TO DE-REIN.
 11974     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11975     MOVE +1                            TO SUB1.
 11976     PERFORM 3110-REINSURE-ISSUE-LOOP
 11977         THRU 3119-REINSURE-ISSUE-LOOP-END.
 11978
 11979     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 11980         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 11981                                       2259-END-CANCEL-BUILD
 11982         PERFORM 1720-CHECK-COMM-LEVELS
 11983             THRU 1729-CHECK-COMM-LEVELS-EXIT
 11984                 VARYING SUB13 FROM +1 BY +1
 11985                     UNTIL SUB13 GREATER THAN 10
 11986         MOVE '7'                       TO DE-TRANS
 11987         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 11988*********PERFORM EXTRACT-DATE-RELOAD
 11989         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11990         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 11991         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 11992         PERFORM EXTRACT-DATE-LOAD
 11993         MOVE 'R'                       TO DE-REIN
 11994         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11995         MOVE +1                        TO SUB1
 11996         PERFORM 3210-REINSURE-CANCEL-LOOP
 11997             THRU 3219-REINSURE-CANCEL-LOOP-END.
 11998
 11999 1719-DO-R-C-EXTRACTS-X.
 12000     EXIT.
 12001
 12002 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 232
* ECS010.cbl
 12003
 12004     IF  DE-AGT (SUB13)       =  SPACES  AND
 12005         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12006         DE-L-PC (SUB13)      =  ZEROS   AND
 12007         DE-A-PC (SUB13)      =  ZEROS
 12008         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12009
 12010 1729-CHECK-COMM-LEVELS-EXIT.
 12011     EXIT.
 12012
 12013 1800-MOVE-NEW-COMM-RATES.
 12014     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12015     MOVE 'N'                           TO RECALC-TYPE.
 12016     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12017     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12018                                           CR-COMPENSATION-LEVELS.
 12019     IF DTE-CLIENT = 'DCC'
 12020        IF CR-LF-NSP-PRM NOT = ZEROS
 12021           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12022              (CR-LFPRM + CR-LFPRM-ALT) -
 12023              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12024        END-IF
 12025        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12026           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12027                                        NOT = 'G' AND 'L')
 12028           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12029           CR-AHPRM -
 12030           (CR-AHPRM * CR-LCOM-AH (1))
 12031        END-IF
 12032     END-IF
 12033     .
 12034
 12035 1899-RECALC-COMM-EXTR-X.
 12036     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 233
* ECS010.cbl
 12038******************************************************************
 12039***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12040******************************************************************
 12041
 12042 2000-INITIALIZE-DETAIL-EXTRACT.
 12043
 12044     MOVE SPACES                   TO DETAIL-EXTRACT.
 12045
 12046     MOVE 'DE'                     TO DE-RECORD-ID.
 12047     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12048     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12049
 12050     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12051     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12052
 12053     MOVE CR-NAME                  TO DE-NAME.
 12054     MOVE CR-AGE                   TO DE-AGE.
 12055     MOVE CR-SEX                   TO DE-SEX.
 12056     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12057
 12058     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12059     MOVE CR-LF-TERM               TO DE-LF-TERM
 12060     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12061     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12062     MOVE ZEROS                    TO DE-LF-CNBEN.
 12063     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12064     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12065     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12066     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12067     MOVE ZEROS                    TO DE-LF-RFND.
 12068
 12069     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12070     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12071                                      DE-LF-CANC-EXIT-DT.
 12072
 12073     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12074     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12075     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12076     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12077     MOVE ZEROS                    TO DE-AH-RFND.
 12078
 12079     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12080     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12081                                      DE-AH-CANC-EXIT-DT.
 12082     IF DTE-CLIENT = 'DCC'
 12083        IF CR-ENTRY-STATUS = 'M'
 12084           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12085        ELSE
 12086           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12087              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12088           END-IF
 12089        END-IF
 12090     END-IF
 12091
 12092     IF DTE-CLIENT = 'DCC'
 12093        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12094        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12095     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 234
* ECS010.cbl
 12096        IF (CR-LFTYP NOT = ZERO   AND
 12097           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12098           (CR-AHTYP NOT = ZERO  AND
 12099           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12100           MOVE CR-LIVES           TO DE-LIVES
 12101           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12102                                      DE-CANCEL-CNT-YTD
 12103        END-IF
 12104     END-IF
 12105
 12106     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12107     IF AM-ZIP-PRIME NUMERIC
 12108        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12109      ELSE
 12110        MOVE ZEROS                 TO DE-ZIP.
 12111     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12112
 12113     MOVE CR-APR                   TO DE-APR.
 12114     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12115     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12116     MOVE CR-IND-GRP               TO DE-IG.
 12117     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12118     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12119
 12120     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12121     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12122     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12123
 12124     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12125*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12126
 12127     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12128                                      DE-REI-AHAMT  DE-REI-AHPRM
 12129                                      DE-REI-LFRFND DE-REI-AHRFND
 12130                                      DE-REI-CNAMT.
 12131
 12132     MOVE +1                       TO SUB1.
 12133
 12134* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12135* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12136* CALC IT IN ECS017.
 12137     IF DTE-CLIENT = 'DCC'
 12138        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12139           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12140           IF CR-ACCOUNT = '05500500DD'
 12141              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12142                ' ' DE-REI-LFRFND
 12143           END-IF
 12144        END-IF
 12145        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12146                      OR
 12147           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12148            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12149           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12150           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12151        END-IF
 12152     END-IF
 12153
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 235
* ECS010.cbl
 12154
 12155     PERFORM EXTRACT-DATE-LOAD.
 12156
 12157     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12158                                      WS-DE-INCUR-N
 12159                                      WS-DE-PAY-N
 12160                                      WS-DE-PAID-TO-N
 12161                                      WS-DE-ACC-EXP-DTE-N
 12162                                      WS-DE-ACC-EFF-DTE-N
 12163                                      WS-DE-RSV-INCUR-N
 12164                                      WS-DE-RSV-PAYTO-N
 12165                                      WS-DE-ACC-EXP-DTE-RSV-N
 12166                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12167
 12168 2090-GL-CODE-LOOP.
 12169
 12170     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12171
 12172     IF SUB1 LESS THAN +10
 12173         ADD +1 TO SUB1
 12174         GO TO 2090-GL-CODE-LOOP.
 12175
 12176     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12177
 12178     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12179
 12180     IF (DTE-CLIENT = 'DCC')
 12181        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12182        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12183        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12184        AND (RECALC-TYPE = SPACES)
 12185        MOVE +1                  TO IA
 12186*       IF CR-ACCOUNT = '05500500DD'
 12187**      IF CR-CERT-NO = '0008773536 '
 12188*          DISPLAY ' MADE IT TO 2000 '
 12189*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12190*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12191*             (IB > +10)
 12192*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12193*                MOVE IB TO DIL-BEN-CODE
 12194*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12195*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12196*                DISPLAY DISPLAY-IBNR-LINE
 12197*             END-IF
 12198*          END-PERFORM
 12199*          DISPLAY ' TRLR AREA  '
 12200*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12201*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12202*             (IB > +10)
 12203*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12204*                MOVE IB TO DIL-BEN-CODE
 12205*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12206*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12207*                DISPLAY DISPLAY-IBNR-LINE
 12208*             END-IF
 12209*          END-PERFORM
 12210*       END-IF
 12211        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 236
* ECS010.cbl
 12212           IB > +10
 12213           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12214              CONTINUE
 12215           ELSE
 12216              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12217                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12218                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12219                 COMPUTE DE-A-PC (IB) =
 12220                        WS-BNK-SPP-FEES (IA) / +1000
 12221                 MOVE +0              TO DE-L-PC (IB)
 12222                 ADD +1               TO IA
 12223              END-IF
 12224*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12225*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12226*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12227*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12228*                MOVE +0              TO DE-L-PC (IB)
 12229*                ADD +1               TO IA
 12230*             END-IF
 12231           END-IF
 12232        END-PERFORM
 12233     END-IF
 12234
 12235
 12236
 12237     .
 12238 2099-INIT-DTL-X.
 12239     EXIT.
 12240
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 237
* ECS010.cbl
 12242******************************************************************
 12243***            B U I L D   I S S U E   E X T R A C T           ***
 12244******************************************************************
 12245
 12246 2100-BUILD-ISSUE-EXTRACT.
 12247
 12248     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12249
 12250     MOVE 'I'                      TO DE-TRANS.
 12251
 12252     IF CHECK-BILLED
 12253         MOVE 'N' TO BILLED-SWITCH
 12254     ELSE
 12255         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12256
 12257     MOVE +1                        TO SUB1.
 12258 2150-GA-BILL-LOOP.
 12259
 12260     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12261         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12262
 12263     IF SUB1 LESS THAN +5
 12264         ADD +1 TO SUB1
 12265         GO TO 2150-GA-BILL-LOOP.
 12266
 12267     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12268     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12269                                       DE-BILLED-LFRFND
 12270                                       DE-BILLED-AHPRM
 12271                                       DE-BILLED-AHRFND.
 12272
 12273     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12274         IF PB-LF-BILLED-AMTS = ZERO  AND
 12275            PB-AH-BILLED-AMTS = ZERO
 12276             MOVE ' '                    TO DE-BILL-STATUS
 12277         ELSE
 12278             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12279                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12280                 MOVE 'B'                TO DE-BILL-STATUS
 12281             ELSE
 12282                 MOVE 'R'                TO DE-BILL-STATUS
 12283                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12284                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12285     ELSE
 12286         MOVE 'B'                        TO DE-BILL-STATUS.
 12287
 12288 2190-WRITE-ISSUE-EXTRACT.
 12289
 12290     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12291
 12292 2199-BLD-ISSUE-X.
 12293     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 238
* ECS010.cbl
 12295******************************************************************
 12296***           B U I L D   C A N C E L   E X T R A C T          ***
 12297******************************************************************
 12298
 12299 2200-BUILD-CANCEL-EXTRACT.
 12300
 12301     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12302
 12303     MOVE 'C'                           TO DE-TRANS.
 12304
 12305     IF CR-LFTYP = ZERO
 12306         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12307
 12308     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12309         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12310             CR-LFRFND = +0
 12311              MOVE +0                   TO TEMP-5
 12312              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12313
 12314     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12315          IF CR-LFRFND = +0
 12316              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12317
 12318     MOVE +1 TO TEMP-5.
 12319     MOVE CR-LF-TERM             TO ORIG-TERM.
 12320     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12321     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12322     MOVE '1'                    TO W-VAL-SOURCE.
 12323     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12324
 12325     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12326         MOVE CR-LFAMT TO DE-LF-CNBEN
 12327         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12328
 12329     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12330         GO TO 2220-BLD-DE-CANCEL-SUM.
 12331
 12332     IF REM-TRM3 = CR-LF-TERM
 12333         MOVE CR-LFAMT TO DE-LF-CNBEN
 12334         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12335
 12336     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12337         GO TO 2210-BLD-DE-CANCEL-TEX.
 12338
 12339     IF DTE-CLIENT = 'NCL'
 12340         IF CR-DT LESS THAN 19910101
 12341             GO TO 2205-BLD-DE-CANCEL-BEN.
 12342
 12343     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12344         GO TO 2230-BLD-DE-CANCEL-NP.
 12345
 12346     IF DTE-CLIENT = 'FUL'
 12347         GO TO 2240-BLD-DE-CANCEL-FUL.
 12348
 12349*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12350     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12351        (CR-RATING-CLASS NOT = 'L ')
 12352         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 239
* ECS010.cbl
 12353            (CR-LF-TERM GREATER THAN 060)  AND
 12354            (CR-DT GREATER THAN 19831031)
 12355              GO TO 2230-BLD-DE-CANCEL-NP.
 12356
 12357     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12358         IF (CR-APR GREATER THAN ZERO)  AND
 12359            (CR-LF-TERM GREATER THAN 061)  AND
 12360            (CR-DT GREATER THAN 19830318)
 12361              GO TO 2230-BLD-DE-CANCEL-NP.
 12362
 12363     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12364         IF (CR-APR GREATER THAN ZERO)  AND
 12365            (CR-LF-TERM GREATER THAN 062)  AND
 12366            (CR-DT GREATER THAN 19810831)  AND
 12367            (CR-DT LESS THAN 19830901)
 12368              GO TO 2230-BLD-DE-CANCEL-NP.
 12369
 12370     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12371         IF (CR-APR GREATER THAN ZERO)  AND
 12372            (CR-LF-TERM GREATER THAN 060)  AND
 12373            (CR-DT GREATER THAN 19831231)
 12374              GO TO 2230-BLD-DE-CANCEL-NP.
 12375
 12376 2205-BLD-DE-CANCEL-BEN.
 12377
 12378     IF CR-LF-TERM EQUAL +0
 12379         MOVE +0          TO TEMP-5
 12380     ELSE
 12381         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12382
 12383     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12384
 12385     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12386
 12387 2210-BLD-DE-CANCEL-TEX.
 12388
 12389     DIVIDE CR-LFAMT BY CR-LF-TERM
 12390         GIVING TEX-FACT-1.
 12391     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12392         GIVING TEX-FACT-2
 12393             REMAINDER TEX-FACT-3.
 12394     IF TEX-FACT-3 NOT = ZERO
 12395         ADD +1 TO TEX-FACT-2.
 12396     COMPUTE DE-LF-CNBEN =
 12397         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12398
 12399     IF CR-LFAMT EQUAL +0
 12400         MOVE +0                  TO TEMP-5
 12401     ELSE
 12402         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12403
 12404     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12405
 12406 2220-BLD-DE-CANCEL-SUM.
 12407
 12408     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12409     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12410
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 240
* ECS010.cbl
 12411     IF CR-LFRFND NOT LESS CR-LFPRM
 12412         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12413          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12414
 12415     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12416     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12417     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12418         MOVE TEMP-7             TO DE-LF-CNBEN
 12419       ELSE
 12420         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12421         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12422
 12423     IF CR-LFAMT EQUAL +0
 12424         MOVE +0                  TO TEMP-5
 12425     ELSE
 12426         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12427
 12428     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12429         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12430
 12431 2230-BLD-DE-CANCEL-NP.
 12432
 12433     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12434     MOVE 'L'                        TO  DC-OPTION-CODE.
 12435     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12436     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12437
 12438     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12439       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12440       MOVE '3'                      TO  DC-OPTION-CODE
 12441       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12442       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12443     ELSE
 12444       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12445       MOVE '6'                      TO  DC-OPTION-CODE
 12446       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12447       MOVE +0                       TO  DC-ELAPSED-DAYS
 12448       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12449       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12450
 12451     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12452     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12453     MOVE CR-APR                     TO  CP-LOAN-APR.
 12454     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12455     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12456     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12457     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12458     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12459     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12460
 12461     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12462     IF (DTE-CLIENT = 'DCC')
 12463        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12464        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12465           ((CR-STATE = DD-STATE (D1))
 12466           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12467           AND ('A'           = DD-BEN-TYPE   (D1))
 12468           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 241
* ECS010.cbl
 12469           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12470                           OR
 12471           D1 > +800
 12472        END-PERFORM
 12473        IF D1 < +801
 12474           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12475              (P1 > +8)
 12476              OR (DD-PROD-CODE (D1 P1) = 'L')
 12477           END-PERFORM
 12478           IF P1 < +9
 12479              MOVE DD-MAX-BEN-AMT (D1 P1)
 12480                                 TO CP-R-MAX-TOT-BEN
 12481           END-IF
 12482        END-IF
 12483     END-IF
 12484
 12485     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12486
 12487     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12488         COMPUTE DE-LF-CNBEN =
 12489                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12490      ELSE
 12491          COMPUTE DE-LF-CNBEN ROUNDED =
 12492                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12493
 12494     IF CR-LFAMT EQUAL +0
 12495         MOVE +0                  TO TEMP-5
 12496     ELSE
 12497         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12498
 12499     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12500
 12501 2240-BLD-DE-CANCEL-FUL.
 12502
 12503     MOVE CR-APR                  TO NP-APR.
 12504     MOVE CR-LF-TERM              TO NP-ORIG.
 12505     MOVE REM-TRM3                TO NP-REM.
 12506     MOVE '2'                     TO NP-OPT.
 12507     MOVE CR-AHPRM                TO NP-AHPRM.
 12508     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12509     MOVE CR-LFAMT                TO NP-BENEFIT.
 12510
 12511*    CALL 'FULNETRM'
 12512*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12513*              NP-ACCOUNT NP-REMAINING.
 12514
 12515     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12516
 12517     IF CR-LFAMT EQUAL +0
 12518         MOVE +0                  TO TEMP-5
 12519     ELSE
 12520         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12521
 12522 2250-CONTINUE-CANCEL-BUILD.
 12523
 12524     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12525     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12526     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 242
* ECS010.cbl
 12527                                         WS-DE-LF-CANC-DTE-N.
 12528     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12529                                         WS-DE-LF-CANC-EXIT-DT-N.
 12530     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12531
 12532
 12533     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12534     IF (DTE-CLIENT = 'DCC')
 12535        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12536        AND (CR-AHTYP NOT = '00' AND '  ')
 12537        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12538        MOVE CR-AH-TERM          TO ORIG-TERM
 12539        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12540        MOVE '1'                 TO W-VAL-SOURCE
 12541        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12542        PERFORM 8500-REMAINING-TERM-ROUTINE
 12543                                 THRU 8599-REM-TERM-X
 12544        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12545        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12546     END-IF
 12547
 12548     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12549
 12550     IF DTE-CLIENT = 'DCC'
 12551        IF DE-AH-RFND = ZEROS
 12552           MOVE ZEROS                 TO DE-ADDL-CLP
 12553        END-IF
 12554     END-IF
 12555
 12556     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12557     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12558                                         WS-DE-AH-CANC-DTE-N.
 12559     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12560                                         WS-DE-AH-CANC-EXIT-DT-N.
 12561     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12562
 12563     IF PB-LAST-MAINT-BY = 'E570'
 12564         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12565
 12566     IF CHECK-BILLED
 12567         MOVE 'N' TO BILLED-SWITCH
 12568     ELSE
 12569         GO TO 2259-END-CANCEL-BUILD.
 12570
 12571     MOVE +1                        TO SUB1.
 12572 2255-GA-BILL-LOOP.
 12573
 12574     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12575         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12576
 12577     IF SUB1 LESS THAN +5
 12578         ADD +1 TO SUB1
 12579         GO TO 2255-GA-BILL-LOOP.
 12580
 12581     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12582     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12583     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12584                                       DE-BILLED-LFRFND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 243
* ECS010.cbl
 12585                                       DE-BILLED-AHPRM
 12586                                       DE-BILLED-AHRFND.
 12587
 12588     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12589         IF PB-LF-BILLED-AMTS = ZERO  AND
 12590            PB-AH-BILLED-AMTS = ZERO
 12591             MOVE ' '                    TO DE-BILL-STATUS
 12592         ELSE
 12593             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12594                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12595                 MOVE 'B'                TO DE-BILL-STATUS
 12596             ELSE
 12597                 MOVE 'R'                TO DE-BILL-STATUS
 12598                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12599                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12600     ELSE
 12601         MOVE 'B'                        TO DE-BILL-STATUS.
 12602
 12603 2259-END-CANCEL-BUILD.
 12604     EXIT.
 12605
 12606 2290-WRITE-CANCEL-EXTRACT.
 12607
 12608     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12609
 12610 2299-BLD-CANCEL-X.
 12611     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 244
* ECS010.cbl
 12613******************************************************************
 12614***            B U I L D   C L A I M   E X T R A C T           ***
 12615******************************************************************
 12616
 12617 2300-BUILD-CLAIM-EXTRACT.
 12618
 12619     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12620
 12621     MOVE 'X'                       TO DE-TRANS.
 12622
 12623     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12624
 12625     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12626     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12627
 12628     MOVE INCURRED-DATE             TO DE-INCUR
 12629                                       WS-DE-INCUR-N.
 12630     MOVE REPORTED-DATE             TO DE-REPORTED.
 12631     MOVE PAYMENT-DATE              TO DE-PAY
 12632                                       WS-DE-PAY-N.
 12633     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12634                                       WS-DE-PAID-TO-N.
 12635
 12636     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12637     MOVE PC-CHECK-NO               TO DE-CHECK.
 12638     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12639     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12640     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12641     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12642     INSPECT DE-PAY-CODE
 12643         CONVERTING '1234569' TO 'PFSXEEV'.
 12644
 12645     MOVE AM-NAME                   TO DE-ACC-NAME.
 12646     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12647                                       WS-DE-ACC-EXP-DTE-N.
 12648     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12649                                       WS-DE-ACC-EFF-DTE-N.
 12650     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12651     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12652
 12653     IF DE-DTH  OR  DE-OB-DTH
 12654         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12655     ELSE
 12656         IF CR-AH-LUMP-SUM-DISAB
 12657             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12658                                    TO DE-AH-PREV-STAT.
 12659
 12660     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12661         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12662
 12663 2390-WRITE-CLAIM-EXTRACT.
 12664
 12665     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12666
 12667 2399-BLD-CLAIM-X.
 12668     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 245
* ECS010.cbl
 12670******************************************************************
 12671***          B U I L D   R E S E R V E   E X T R A C T         ***
 12672******************************************************************
 12673
 12674 2400-BUILD-RESERVE-EXTRACT.
 12675
 12676     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12677
 12678     MOVE 'Y'                         TO DE-TRANS.
 12679     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12680
 12681     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12682     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12683     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12684     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12685     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12686     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12687
 12688     IF DTE-CLIENT  =  'NCL'
 12689        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12690            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12691
 12692     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12693
 12694     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12695                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12696
 12697     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12698                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12699
 12700     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12701                                         WS-DE-RSV-INCUR-N.
 12702     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12703     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12704                                         WS-DE-RSV-PAYTO-N.
 12705
 12706     MOVE ZEROS                       TO DE-REI-IBNR
 12707                                         DE-REI-PAYCUR
 12708                                         DE-REI-FUTRSV.
 12709
 12710     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12711
 12712     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12713         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12714
 12715 2490-WRITE-RESERVE-EXTRACT.
 12716
 12717     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12718
 12719 2499-BLD-RESERVE-X.
 12720     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 246
* ECS010.cbl
 12722******************************************************************
 12723***          W R I T E   D E T A I L   E X T R A C T S         ***
 12724******************************************************************
 12725
 12726 2500-WRITE-DETAIL-EXTRACTS.
 12727
 12728
 12729     MOVE  ZEROS            TO  SUB.
 12730
 12731     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12732         GO TO 2520-WRITE-CONTINUE.
 12733
 12734 2510-ZERO-CHARGEBACK-LOOP.
 12735
 12736     ADD  +1                TO  SUB.
 12737
 12738     IF  SUB    GREATER  THAN     +10
 12739         GO TO  2520-WRITE-CONTINUE.
 12740
 12741*    DISPLAY ' CERT NO ' CR-CERT-NO
 12742*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12743*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12744
 12745
 12746     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12747         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12748
 12749     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12750         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12751         OR (WS-DDF-AH-CB (SUB) = 'N')
 12752         MOVE  ZEROS             TO DE-A-PC (SUB)
 12753     END-IF
 12754
 12755     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12756
 12757 2520-WRITE-CONTINUE.
 12758
 12759     IF DTE-CLIENT NOT = 'HER'
 12760         GO TO 2590-WRITE-EXTRACTS.
 12761
 12762     IF DE-REINCO NOT = 'LNL'
 12763         GO TO 2590-WRITE-EXTRACTS.
 12764
 12765     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12766         GO TO 2590-WRITE-EXTRACTS.
 12767
 12768     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12769     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12770     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12771     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12772     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12773     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12774     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12775     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12776     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12777     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12778
 12779     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 247
* ECS010.cbl
 12780     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12781     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12782     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12783     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12784     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12785     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12786     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12787     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12788     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12789
 12790
 12791 2590-WRITE-EXTRACTS.
 12792
 12793     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12794                                     WS-DE-PROC-DT-N.
 12795
 12796     IF DTE-PGM-OPT = '1'
 12797         ADD +1                   TO DE-CNT
 12798*********PERFORM EXTRACT-DATE-RELOAD
 12799         WRITE DETAIL-EXTRACT.
 12800
 12801
 12802 2599-WRT-DETAIL-X.
 12803     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 248
* ECS010.cbl
 12805******************************************************************
 12806***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12807******************************************************************
 12808
 12809 3000-REINSURE-ROUTINE.
 12810
 12811     IF (CR-POLICY-IS-DECLINED) OR
 12812        (CR-POLICY-IS-VOID)
 12813        GO TO 3099-REINSURE-ROUTINE-X.
 12814
 12815     IF REIN-FLG = 'X'
 12816         GO TO 3099-REINSURE-ROUTINE-X.
 12817
 12818     MOVE 'X' TO REIN-FLG.
 12819
 12820     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12821
 12822     IF CR-REIN-TABLE = SPACES OR ZEROS
 12823         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12824
 12825******************************************************************
 12826***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12827******************************************************************
 12828
 12829 3010-RR-READ-REIN.
 12830
 12831     IF REIN-OPEN-SW = ' '
 12832         MOVE 'X'                       TO REIN-OPEN-SW
 12833         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12834         MOVE 'A'                       TO REIN-SRCH-CODE
 12835         OPEN INPUT ERRTBL-IN
 12836         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12837             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12838          ELSE
 12839             MOVE '21'                  TO ABEND-CODE-1
 12840             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12841             DISPLAY '******************************'
 12842             DISPLAY '***** ERROR LOCATION 015 *****'
 12843             DISPLAY '******************************'
 12844             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12845             GO TO ABEND-PGM.
 12846
 12847     IF CR-REIN-TABLE = REIN-SRCH
 12848         GO TO 3019-RR-READ-REIN-X.
 12849
 12850     MOVE +0                            TO REIN-SUB-1.
 12851     MOVE 999999                        TO REIN-LOW-TIME.
 12852     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12853
 12854 3011-RR-CHECK-REIN-SAVE-TABLE.
 12855
 12856     ADD +1                             TO REIN-SUB-1.
 12857     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12858        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12859         GO TO 3015-RR-READ-ERRTBL.
 12860
 12861     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12862         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 249
* ECS010.cbl
 12863         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12864         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12865         GO TO 3019-RR-READ-REIN-X.
 12866
 12867     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12868         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12869         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12870
 12871     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12872
 12873 3015-RR-READ-ERRTBL.
 12874
 12875     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12876
 12877     READ ERRTBL-IN.
 12878
 12879     IF ERRTBL-FILE-STATUS  = '23'
 12880         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12881                                           ' ' CR-FULL-CONTROL
 12882         MOVE '24'                      TO ABEND-CODE-1
 12883         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12884         DISPLAY '******************************'
 12885         DISPLAY '***** ERROR LOCATION 016 *****'
 12886         DISPLAY '******************************'
 12887         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12888         GO TO ABEND-PGM.
 12889
 12890     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12891         NEXT SENTENCE
 12892       ELSE
 12893         MOVE '24'                      TO ABEND-CODE-1
 12894         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12895         DISPLAY '******************************'
 12896         DISPLAY '***** ERROR LOCATION 017 *****'
 12897         DISPLAY '******************************'
 12898         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12899         GO TO ABEND-PGM.
 12900
 12901     ADD +1                            TO ERRTBL-READS.
 12902
 12903     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12904         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12905         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12906         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12907     ELSE
 12908         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12909         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12910         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12911         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12912
 12913 3019-RR-READ-REIN-X.
 12914     EXIT.
 12915
 12916 3020-CALCULATE-REINSURANCE.
 12917
 12918*    IF DTE-CLIENT = '???'  AND
 12919*       (CR-REIN-TABLE = 'SE1')
 12920*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 250
* ECS010.cbl
 12921*        IF CR-STATE NOT = STATE-L
 12922*            MOVE CR-STATE             TO STATE-L
 12923*            PERFORM 8200-STATE-CODE-LOOKUP
 12924*                         THRU 8299-STATE-LOOKUP-X.
 12925
 12926
 12927*    IF DTE-CLIENT = 'DCC'
 12928*       IF CR-LF-NSP-PRM NOT = ZEROS
 12929*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12930*             (CR-LFPRM + CR-LFPRM-ALT) -
 12931*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12932*       END-IF
 12933*       IF CR-AH-NSP-PRM NOT = ZEROS
 12934*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12935*          CR-AHPRM -
 12936*          (CR-AHPRM * CR-LCOM-AH (1))
 12937*       END-IF
 12938*    END-IF
 12939
 12940
 12941     IF RE-REMAINING (1) = 'I'
 12942         MOVE '*'                      TO RISK-REIN-FLAG
 12943     ELSE
 12944         GO TO 3029-CONTINUE-REIN-CALC.
 12945
 12946     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12947                                          REIN-CANCEL-AH-SW.
 12948     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12949                                          REIN-LCNC-EARN-TERM
 12950                                          REIN-LF-CLM-MONTHS
 12951                                          REIN-EARN-AH-TERM
 12952                                          REIN-ACNC-EARN-TERM
 12953                                          REIN-AH-PRIOR-CLMS-PAID
 12954                                          REIN-AH-CLM-MONTHS
 12955                                          REIN-AH-CLM-MTH-1
 12956                                          REIN-AH-CLM-MTH-2
 12957                                          REIN-AH-CLM-MTH-3
 12958                                          REIN-AH-CLM-MTH-4
 12959                                          REIN-AH-CLM-MTH-5.
 12960
 12961*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12962*    MOVE 'L'                          TO DC-OPTION-CODE.
 12963*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12964*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12965
 12966     IF CR-LFTYP = ZEROS  OR  SPACES
 12967         GO TO 3023-CONTINUE.
 12968
 12969     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12970
 12971     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 12972       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12973           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 12974
 12975     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 12976       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 12977           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 12978
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 251
* ECS010.cbl
 12979     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12980     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12981
 12982     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 12983         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 12984     ELSE
 12985         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 12986
 12987     IF CR-LF-CANC-DT NOT = ZEROS
 12988         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 12989         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12990         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 12991         IF CR-DT = CR-LF-CANC-DT
 12992             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 12993
 12994     IF CR-DTH-DT NOT = ZEROS
 12995         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 12996         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12997         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 12998
 12999     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13000
 13001
 13002 3023-CONTINUE.
 13003
 13004     IF CR-AHTYP = ZEROS  OR  SPACES
 13005        GO TO 3029-CONTINUE-REIN-CALC.
 13006
 13007     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13008
 13009     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13010       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13011           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13012
 13013     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13014       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13015           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13016
 13017     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13018     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13019
 13020     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13021         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13022     ELSE
 13023         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13024
 13025     IF CR-AH-CANC-DT NOT = ZEROS
 13026         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13027         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13028         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13029         IF CR-DT = CR-AH-CANC-DT
 13030             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13031
 13032     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13033         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13034         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13035         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13036
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 252
* ECS010.cbl
 13037     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13038         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13039         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13040         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13041
 13042     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13043         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13044         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13045         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13046
 13047     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13048         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13049         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13050         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13051
 13052     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13053         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13054         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13055         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13056
 13057     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13058
 13059
 13060     GO TO 3029-CONTINUE-REIN-CALC.
 13061
 13062
 13063 3025-CALC-ELAPSED-MONTHS.
 13064
 13065     MOVE 'L'                          TO DC-OPTION-CODE.
 13066     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13067     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13068     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13069     MOVE '1'                          TO DC-OPTION-CODE.
 13070     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13071     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13072                                          DC-ODD-DAYS-OVER
 13073                                          DC-ELAPSED-DAYS.
 13074     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13075
 13076 3026-CALC-EXIT.
 13077     EXIT.
 13078
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 253
* ECS010.cbl
 13080 3029-CONTINUE-REIN-CALC.
 13081
*13082                             COPY ECSRTPFM.
 13083******************************************************************07/10/97
 13084*                                                                *ECSRTPFM
 13085*                            ECSRTPFM                            *   LV001
 13086*                            VMOD=2.002                          *ECSRTPFM
 13087*                                                                *ECSRTPFM
 13088******************************************************************ECSRTPFM
 13089                                                                  ECSRTPFM
 13090     IF    CR-LFAMT  NUMERIC                                      00000072
 13091           NEXT SENTENCE                                          00000073
 13092        ELSE                                                      00000074
 13093           MOVE ZEROS TO CR-LFAMT.                                00000075
 13094                                                                  00000076
 13095     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13096           NEXT SENTENCE                                          00000078
 13097        ELSE                                                      00000079
 13098           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13099                                                                  00000081
 13100                                                                  00000082
 13101     IF    CR-LFPRM  NUMERIC                                      00000083
 13102           NEXT SENTENCE                                          00000084
 13103        ELSE                                                      00000085
 13104           MOVE ZEROS TO CR-LFPRM.                                00000086
 13105                                                                  00000087
 13106     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13107           NEXT SENTENCE                                          00000089
 13108        ELSE                                                      00000090
 13109           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13110                                                                  00000092
 13111                                                                  00000093
 13112     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13113           NEXT SENTENCE                                          00000095
 13114        ELSE                                                      00000096
 13115           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13116                                                                  00000098
 13117     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13118           NEXT SENTENCE                                          00000100
 13119        ELSE                                                      00000101
 13120           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13121                                                                  00000103
 13122     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13123           NEXT SENTENCE                                          00000105
 13124        ELSE                                                      00000106
 13125           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13126                                                                  00000108
 13127     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13128     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13129     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13130         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13131     ELSE                                                         ECSRTPFM
 13132         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13133     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13134                                                                  ECSRTPFM
 13135     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13136     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13137     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 254
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13138         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13139     ELSE                                                         ECSRTPFM
 13140         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13141     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13142                                                                  ECSRTPFM
 13143     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13144         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13145             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13146                                                                  ECSRTPFM
 13147
 13148     MOVE 'X'                  TO REIN-RT-SW.
 13149     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13150     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13151     MOVE ' '                  TO REIN-RT-SW.
 13152
 13153 3030-RE-CALCULATE-REINSURANCE.
 13154
 13155     IF AM-RECALC-REIN = 'Y'
 13156         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13157            CR-REIN-SPEC = SPACE  AND
 13158            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13159             PERFORM 3600-RC-REINSURANCE
 13160                 THRU 3799-RC-REINSURANCE-X.
 13161
 13162     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13163         VARYING SUB1 FROM 1 BY 1
 13164             UNTIL REIN-COMP (SUB1) = SPACES.
 13165
 13166     GO TO 3099-REINSURE-ROUTINE-X.
 13167
 13168 3040-REIN-REC-CNT.
 13169
 13170     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13171         GO TO 3049-RRC-XIT.
 13172
 13173     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13174         VARYING B-SUB FROM 1 BY 1
 13175             UNTIL B-SUB GREATER THAN 50.
 13176
 13177 3049-RRC-XIT.
 13178     EXIT.
 13179
 13180 3050-REIN-COMP-ADD.
 13181
 13182     IF RB-COMPANY (B-SUB) = SPACES
 13183         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13184     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13185         MOVE 1   TO RB-COUNT (B-SUB)
 13186         MOVE +50 TO B-SUB.
 13187
 13188 3059-RCA-XIT.
 13189     EXIT.
 13190
 13191 3099-REINSURE-ROUTINE-X.
 13192     EXIT.
 13193
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 255
* ECS010.cbl
 13195******************************************************************
 13196***                R E I N S U R E   I S S U E S               ***
 13197******************************************************************
 13198
 13199 3100-REINSURE-ISSUE.
 13200
 13201     IF  REIN-COMP (1) = SPACES
 13202         GO TO 3199-REINSURE-ISSUE-X.
 13203
 13204     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13205     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13206     MOVE 'I'      TO DE-TRANS.
 13207     MOVE 'R'      TO DE-REIN.
 13208*****PERFORM EXTRACT-DATE-RELOAD.
 13209     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13210     MOVE +1       TO SUB1.
 13211
 13212 3110-REINSURE-ISSUE-LOOP.
 13213
 13214     IF REIN-COMP (SUB1) = SPACES
 13215         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13216
 13217     IF UPDATING-RISK-PREMIUMS
 13218       IF REIN-REM-SW (SUB1) NOT = 'I'
 13219         ADD +1 TO SUB1
 13220         GO TO 3110-REINSURE-ISSUE-LOOP.
 13221
 13222     IF REIN-REM-SW (SUB1) = 'Z'
 13223         ADD +1 TO SUB1
 13224         GO TO 3110-REINSURE-ISSUE-LOOP.
 13225
 13226     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13227     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13228     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13229     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13230     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13231     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13232
 13233     IF REIN-REM-SW (SUB1) NOT = 'I'
 13234         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13235
 13236     IF RWF-LFPRM = ZEROS  AND
 13237        RWF-AHPRM = ZEROS
 13238         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13239
 13240     IF RWF-LFPRM NOT = ZEROS
 13241         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13242         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13243
 13244     IF RWF-AHPRM NOT = ZEROS
 13245         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13246         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13247
 13248 3115-CONTINUE-ISSUE-LOOP.
 13249
 13250     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13251     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13252
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 256
* ECS010.cbl
 13253     IF DE-REI-LFAMT NOT = ZERO
 13254        OR DE-REI-LFPRM NOT = ZERO
 13255        OR DE-REI-AHAMT NOT = ZERO
 13256        OR DE-REI-AHPRM NOT = ZERO
 13257         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13258                 2599-WRT-DETAIL-X
 13259         ADD +1 TO BC-R-ISS.
 13260
 13261     ADD +1 TO SUB1.
 13262     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13263     PERFORM EXTRACT-DATE-LOAD.
 13264
 13265     GO TO 3110-REINSURE-ISSUE-LOOP.
 13266
 13267 3119-REINSURE-ISSUE-LOOP-END.
 13268     EXIT.
 13269
 13270 3190-REINSURE-ISSUE-PRINT.
 13271
 13272     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13273     IF RW-ACCUM-LF NOT = ZERO
 13274         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13275         MOVE CR-LF-TERM               TO TRD-LFTRM
 13276         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13277         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13278     IF RW-ACCUM-AH NOT = ZERO
 13279         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13280         MOVE CR-AH-TERM               TO TRD-AHTRM
 13281         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13282         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13283     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13284         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13285
 13286 3199-REINSURE-ISSUE-X.
 13287     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 257
* ECS010.cbl
 13289******************************************************************
 13290***               R E I N S U R E   C A N C E L S              ***
 13291******************************************************************
 13292
 13293 3200-REINSURE-CANCEL.
 13294
 13295     IF REIN-COMP (1) = SPACES
 13296         GO TO 3299-REINSURE-CANCEL-X.
 13297
 13298     IF CR-LFRFND = ZERO
 13299        AND CR-AHRFND = ZERO
 13300         GO TO 3299-REINSURE-CANCEL-X.
 13301
 13302     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13303             VARYING SUB1 FROM +1 BY +1 UNTIL
 13304                       REIN-COMP (SUB1) = SPACES.
 13305
 13306     IF REIN-RT-SW = 'X'
 13307         GO TO 3299-REINSURE-CANCEL-X.
 13308
 13309     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13310     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13311     MOVE 'R'      TO DE-REIN.
 13312*****PERFORM EXTRACT-DATE-RELOAD.
 13313     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13314     MOVE +1       TO SUB1.
 13315
 13316 3210-REINSURE-CANCEL-LOOP.
 13317
 13318     IF REIN-COMP (SUB1) = SPACES
 13319         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13320
 13321     IF REIN-REM-SW (SUB1) = 'Z'
 13322         ADD +1        TO SUB1
 13323         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13324         PERFORM EXTRACT-DATE-LOAD
 13325         GO TO 3210-REINSURE-CANCEL-LOOP.
 13326
 13327     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13328     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13329
 13330     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13331     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13332     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13333     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13334     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13335     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13336     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13337     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13338     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13339
 13340     IF REIN-REM-SW (SUB1) NOT = 'I'
 13341         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13342
 13343     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13344        VOIDING-LF-CANCEL
 13345         NEXT SENTENCE
 13346     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 258
* ECS010.cbl
 13347         MOVE ZEROS             TO DE-REI-LFRFND.
 13348
 13349     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13350        VOIDING-AH-CANCEL
 13351         NEXT SENTENCE
 13352     ELSE
 13353         MOVE ZEROS             TO DE-REI-AHRFND.
 13354
 13355 3215-CONTINUE-CANCEL-LOOP.
 13356
 13357     IF RWF-LF-RUNOFF-SW = 'N'
 13358         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13359             MOVE ZEROS         TO DE-LF-TYPE
 13360                                   DE-REI-LFAMT
 13361                                   DE-REI-LFPRM
 13362                                   DE-REI-LFRFND
 13363                                   DE-REI-CNAMT.
 13364
 13365     IF RWF-AH-RUNOFF-SW = 'N'
 13366         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13367             MOVE ZEROS         TO DE-AH-TYPE
 13368                                   DE-REI-AHAMT
 13369                                   DE-REI-AHPRM
 13370                                   DE-REI-AHRFND.
 13371
 13372     IF DE-REI-LFAMT NOT = ZERO
 13373        OR DE-REI-LFPRM NOT = ZERO
 13374        OR DE-REI-AHAMT NOT = ZERO
 13375        OR DE-REI-AHPRM NOT = ZERO
 13376        OR DE-REI-LFRFND NOT = ZERO
 13377        OR DE-REI-AHRFND NOT = ZERO
 13378        OR DE-REI-CNAMT NOT = ZERO
 13379         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13380                                            2599-WRT-DETAIL-X
 13381         ADD +1 TO BC-R-CNC.
 13382
 13383     ADD +1 TO SUB1.
 13384     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13385     PERFORM EXTRACT-DATE-LOAD.
 13386     GO TO 3210-REINSURE-CANCEL-LOOP.
 13387
 13388 3219-REINSURE-CANCEL-LOOP-END.
 13389     EXIT.
 13390
 13391 3290-REINSURE-CANCEL-PRINT.
 13392
 13393     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13394     IF RW-ACCUM-LF NOT = ZERO
 13395         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13396         MOVE CR-LF-TERM               TO TRD-LFTRM
 13397         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13398         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13399     IF RW-ACCUM-AH NOT = ZERO
 13400         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13401         MOVE CR-AH-TERM               TO TRD-AHTRM
 13402         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13403         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13404     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 259
* ECS010.cbl
 13405         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13406
 13407 3299-REINSURE-CANCEL-X.
 13408     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 260
* ECS010.cbl
 13410******************************************************************
 13411***                R E I N S U R E   C L A I M S               ***
 13412******************************************************************
 13413
 13414 3300-REINSURE-CLAIM.
 13415
 13416*    IF DTE-CLIENT = '???'
 13417*       IF (REIN-RT-SW NOT = 'X')  AND
 13418*          (PC-PAYMENT-TYPE = '5' OR '6')
 13419*        GO TO 3399-REINSURE-CLAIM-X.
 13420
 13421     IF REIN-COMP (1) = SPACES
 13422         GO TO 3399-REINSURE-CLAIM-X.
 13423
 13424     IF REIN-RT-SW = 'X'
 13425         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13426         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13427         MOVE CR-DISAMT   TO RW-AHCLMWK
 13428         ADD  CR-DISEXP   TO RW-AHCLMWK
 13429     ELSE
 13430         IF PC-CLAIM-TYPE  = 1 OR 3
 13431             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13432             MOVE +0                  TO RW-AHCLMWK
 13433         ELSE
 13434             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13435             MOVE +0                  TO RW-LFCLMWK.
 13436
 13437     MOVE +0                          TO RW-LFCLM
 13438                                         RW-AHCLM.
 13439     IF RW-LFCLMWK = ZERO
 13440        AND RW-AHCLMWK = ZERO
 13441         GO TO 3399-REINSURE-CLAIM-X.
 13442
 13443     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13444         VARYING SUB1 FROM +1 BY +1
 13445             UNTIL REIN-COMP (SUB1) = SPACES.
 13446
 13447     IF REIN-RT-SW = 'X'
 13448         GO TO 3399-REINSURE-CLAIM-X.
 13449
 13450     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13451     MOVE ZEROS                TO RW-ACCUM-CLM.
 13452     MOVE 'R'                  TO DE-REIN.
 13453*****PERFORM EXTRACT-DATE-RELOAD.
 13454     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13455     MOVE +1                   TO SUB1.
 13456
 13457 3310-REINSURE-CLAIM-LOOP.
 13458
 13459     IF REIN-COMP (SUB1) = SPACES
 13460         GO TO 3390-REINSURE-CLAIM-PRINT.
 13461
 13462     IF REIN-REM-SW (SUB1) = 'Z'
 13463         ADD +1        TO SUB1
 13464         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13465         PERFORM EXTRACT-DATE-LOAD
 13466         GO TO 3310-REINSURE-CLAIM-LOOP.
 13467
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 261
* ECS010.cbl
 13468     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13469     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13470
 13471     IF PC-CLAIM-TYPE  = 1 OR 3
 13472         IF RWF-LF-RUNOFF-SW = 'N'
 13473           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13474               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13475
 13476     IF PC-CLAIM-TYPE  = 2 OR 4
 13477         IF RWF-AH-RUNOFF-SW = 'N'
 13478           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13479               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13480
 13481     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13482     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13483     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13484     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13485
 13486     IF PC-CLAIM-TYPE  = 1 OR 3
 13487         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13488         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13489     ELSE
 13490         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13491         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13492
 13493     IF PC-CLAIM-TYPE = 1 OR 3
 13494         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13495            AND DE-REI-CLAIM-AMT
 13496             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13497         ELSE
 13498             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13499     ELSE
 13500         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13501            AND DE-REI-CLAIM-AMT
 13502             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13503         ELSE
 13504             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13505
 13506 3320-REINSURE-CLAIM-LOOP-GO.
 13507
 13508     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13509     ADD +1                     TO BC-R-CLM.
 13510
 13511 3330-REINSURE-CLAIM-LOOP-ADD.
 13512
 13513     ADD +1                     TO SUB1.
 13514     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13515     PERFORM EXTRACT-DATE-LOAD.
 13516     GO TO 3310-REINSURE-CLAIM-LOOP.
 13517
 13518 3390-REINSURE-CLAIM-PRINT.
 13519
 13520     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13521     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13522         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13523         MOVE CR-LF-TERM               TO TRD-LFTRM
 13524         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13525         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 262
* ECS010.cbl
 13526     ELSE
 13527         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13528         MOVE CR-AH-TERM               TO TRD-AHTRM
 13529         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13530         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13531         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13532         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13533         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13534         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13535     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13536
 13537 3399-REINSURE-CLAIM-X.
 13538     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 263
* ECS010.cbl
 13540******************************************************************
 13541***              R E I N S U R E   R E S E R V E S             ***
 13542******************************************************************
 13543
 13544 3400-REINSURE-RESERVE.
 13545
 13546     IF REIN-COMP (1) = SPACES
 13547         GO TO 3499-REINSURE-RESERVE-X.
 13548
 13549     IF PC-CLAIM-TYPE = '1' OR '3'
 13550         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13551         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13552         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13553         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13554         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13555     ELSE
 13556         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13557         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13558         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13559         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13560         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13561
 13562     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13563                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13564     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13565         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13566          GO TO 3499-REINSURE-RESERVE-X.
 13567
 13568     IF DTE-CLIENT NOT = 'MIC'
 13569         GO TO 3405-REINSURE-RESERVE-CONT.
 13570
 13571     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13572         GO TO 3405-REINSURE-RESERVE-CONT.
 13573
 13574     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13575     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13576     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13577     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13578                                        CP-CLAIM-TYPE.
 13579     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13580     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13581     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13582     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13583     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13584     MOVE '3'                        TO CP-CDT-METHOD.
 13585     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13586     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13587                                        CP-RATING-BENEFIT-AMT.
 13588     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13589     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13590
 13591 3405-REINSURE-RESERVE-CONT.
 13592
 13593     PERFORM 3500-REINSURE-CALC-RESERVE
 13594         THRU 3599-REINSURE-CALC-RESERVE-X
 13595             VARYING SUB1 FROM +1 BY +1
 13596                 UNTIL REIN-COMP (SUB1) = SPACES.
 13597
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 264
* ECS010.cbl
 13598     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13599     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13600     MOVE 'R'            TO DE-REIN.
 13601*****PERFORM EXTRACT-DATE-RELOAD.
 13602     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13603     MOVE +1             TO SUB1.
 13604
 13605 3410-REINSURE-RESERVE-LOOP.
 13606
 13607     IF REIN-COMP (SUB1) = SPACES
 13608         GO TO 3490-REINSURE-RESERVE-PRINT.
 13609
 13610     IF REIN-REM-SW (SUB1) = 'Z'
 13611         ADD +1 TO SUB1
 13612         GO TO 3410-REINSURE-RESERVE-LOOP.
 13613
 13614     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13615     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13616
 13617     IF PC-CLAIM-TYPE  = 1 OR 3
 13618         IF RWF-LF-RUNOFF-SW = 'N'
 13619           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13620               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13621
 13622     IF PC-CLAIM-TYPE  = 2 OR 4
 13623         IF RWF-AH-RUNOFF-SW = 'N'
 13624           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13625               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13626
 13627     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13628     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13629     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13630     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13631
 13632     IF PC-CLAIM-TYPE = 1 OR 3
 13633         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13634         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13635         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13636     ELSE
 13637         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13638         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13639         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13640
 13641     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13642     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13643     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13644
 13645     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13646        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13647        OR DE-REI-FUTRSV
 13648         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13649                                            2599-WRT-DETAIL-X
 13650         ADD +1 TO BC-R-CRS.
 13651
 13652 3415-REINSURE-RESERVE-LOOP-ADD.
 13653
 13654     ADD +1 TO SUB1.
 13655     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 265
* ECS010.cbl
 13656     PERFORM EXTRACT-DATE-LOAD.
 13657     GO TO 3410-REINSURE-RESERVE-LOOP.
 13658
 13659 3490-REINSURE-RESERVE-PRINT.
 13660
 13661     IF RW-ACCUM-IBNR   = ZERO  AND
 13662        RW-ACCUM-PAYCUR = ZERO  AND
 13663        RW-ACCUM-FUTRSV = ZERO
 13664         GO TO 3499-REINSURE-RESERVE-X.
 13665
 13666     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13667     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13668     MOVE 'IBNR'                    TO TRD-IBNRX.
 13669     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13670     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13671     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13672     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13673
 13674     IF PC-CLAIM-TYPE = 1
 13675         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13676     ELSE
 13677         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13678     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13679
 13680     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13681
 13682 3499-REINSURE-RESERVE-X.
 13683     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 266
* ECS010.cbl
 13685******************************************************************
 13686***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13687******************************************************************
 13688
 13689 3500-REINSURE-CALC-RESERVE.
 13690
 13691     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13692     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13693                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13694
 13695     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13696        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13697          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13698       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13699
 13700     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13701        MOVE ZERO TO CO-SUB.
 13702
 13703     IF CO-SUB NOT = ZERO
 13704        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13705           IF PC-CLAIM-TYPE = '1' OR '3'
 13706             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13707                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13708
 13709     IF PC-CLAIM-TYPE  = 1 OR 3
 13710         IF RWF-LF-RUNOFF-SW = 'N'
 13711           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13712               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13713
 13714     IF CO-SUB NOT = ZERO
 13715        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13716           IF PC-CLAIM-TYPE = '2' OR '4'
 13717             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13718                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13719
 13720     IF PC-CLAIM-TYPE  = 2 OR 4
 13721         IF RWF-AH-RUNOFF-SW = 'N'
 13722           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13723               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13724
 13725     IF DTE-CLIENT NOT = 'MIC'
 13726         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13727
 13728     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13729         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13730
 13731     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13732
 13733     IF CR-AHTYP = ZERO  OR
 13734        CO-SUB = ZERO
 13735         GO TO 3505-REIN-CALC-RESERVE-CONT
 13736     ELSE
 13737         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13738             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13739
 13740     COMPUTE MAX-REM-TERM ROUNDED =
 13741                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13742
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 267
* ECS010.cbl
 13743     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13744         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13745
 13746     COMPUTE CP-ORIGINAL-TERM =
 13747                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13748
 13749     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13750
 13751     IF  CP-RETURN-CODE = ZERO
 13752         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13753
 13754 3505-REIN-CALC-RESERVE-CONT.
 13755
 13756     IF SUB1 = RE-100-COMP
 13757         GO TO 3520-REIN-REMAINDER-RSRV.
 13758
 13759     IF CR-LFAMT NOT = ZERO  AND
 13760        RWF-LFAMT NOT = ZERO
 13761         IF DTE-CLIENT NOT = 'MIC'
 13762             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13763                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13764             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13765                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13766             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13767                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13768         ELSE
 13769             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13770             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13771             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13772
 13773     IF CR-AHAMT NOT = ZERO  AND
 13774        RWF-AHAMT NOT = ZERO
 13775         IF DTE-CLIENT NOT = 'MIC'
 13776             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13777                         RWF-AHAMT) / CR-AHAMT
 13778             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13779                         RWF-AHAMT) / CR-AHAMT
 13780             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13781                         RWF-AHAMT) / CR-AHAMT
 13782         ELSE
 13783             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13784             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13785             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13786
 13787 3510-REINSURE-CALC-RESERVE-ADD.
 13788
 13789     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13790     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13791     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13792     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13793     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13794     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13795
 13796     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13797         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13798
 13799     IF CO-SUB = ZERO
 13800         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 268
* ECS010.cbl
 13801
 13802 3513-REIN-CHK-LF-RSRV-LIMIT.
 13803     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13804         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13805
 13806     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13807         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13808
 13809     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13810                                      (RWF-LFCLM +
 13811                                       RWF-DTH-PAYCUR +
 13812                                       RWF-DTH-FUTRSV).
 13813
 13814     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13815         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13816
 13817     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13818
 13819     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13820         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13821         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13822     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13823         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13824
 13825     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13826
 13827     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13828         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13829         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13830     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13831         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13832
 13833 3515-REIN-CHK-AH-RSRV-LIMIT.
 13834     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13835         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13836
 13837     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13838         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13839
 13840     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13841                                      (RWF-AHCLM +
 13842                                       RWF-DIS-PAYCUR +
 13843                                       RWF-DIS-FUTRSV).
 13844
 13845     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13846         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13847
 13848     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13849
 13850     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13851         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13852         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13853     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13854         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13855
 13856     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13857
 13858     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 269
* ECS010.cbl
 13859         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13860         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13861     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13862         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13863
 13864 3519-REINSURE-CALC-RESERVE-END.
 13865
 13866     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13867        OR RWF-DTH-FUTRSV
 13868         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13869
 13870     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13871        OR RWF-DIS-FUTRSV
 13872         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13873
 13874     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13875
 13876 3520-REIN-REMAINDER-RSRV.
 13877
 13878     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13879     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13880     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13881     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13882     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13883     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13884
 13885     PERFORM 3530-REIN-SUB-RSRV
 13886         THRU 3539-REIN-SUB-RSRV-X
 13887             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13888
 13889     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13890
 13891 3530-REIN-SUB-RSRV.
 13892
 13893     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13894     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13895     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13896     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13897     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13898     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13899
 13900 3539-REIN-SUB-RSRV-X.
 13901     EXIT.
 13902
 13903 3540-CONT-REIN-CALC-RESERVE.
 13904
 13905     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13906         MOVE 'X' TO REIN-BUS-FLAG.
 13907     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13908
 13909 3599-REINSURE-CALC-RESERVE-X.
 13910     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 270
* ECS010.cbl
 13912******************************************************************
 13913***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13914******************************************************************
 13915
 13916*REINSURANCE-CALCULATIONS.
*13917                             COPY ECSRIRTN.
 13918******************************************************************04/30/98
 13919*                                                                *ECSRIRTN
 13920*                            ECSRIRTN                            *   LV012
 13921*                            VMOD=2.025.                         *ECSRIRTN
 13922*                                                                *ECSRIRTN
 13923******************************************************************ECSRIRTN
 13924******************************************************************
 13925*                   C H A N G E   L O G
 13926*
 13927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13928*-----------------------------------------------------------------
 13929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13930* EFFECTIVE    NUMBER
 13931*-----------------------------------------------------------------
 13932* 062703                   PEMA  ADD DCC CLIENT ID TO
 13933*                                SPECIAL CEDED CLAIM CALC
 13934* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13935                                                                  ECSRIRTN
 13936 REINSURE-CALC.                                                   ECSRIRTN
 13937                                                                  ECSRIRTN
 13938     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13939     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13940     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13941     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13942                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13943                                                                  ECSRIRTN
 13944     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13945                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13946                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13947                                                                  ECSRIRTN
 13948     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13949                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13950                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13951                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13952                                                                  ECSRIRTN
 13953     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13954        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13955          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13956          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13957          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13958                                                                  ECSRIRTN
 13959     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13960        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13961         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13962                                                                  ECSRIRTN
 13963     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13964                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13965                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13966                                                                  ECSRIRTN
 13967     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13968         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13969                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 271
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13970     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13971         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13972                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 13973                                                                  ECSRIRTN
 13974     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 13975         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 13976                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13977                                                                  ECSRIRTN
 13978 CALC-CONTINUED.                                                  ECSRIRTN
 13979                                                                  ECSRIRTN
 13980     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 13981     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 13982                                                                  ECSRIRTN
 13983     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 13984         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 13985     ELSE                                                         ECSRIRTN
 13986         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 13987     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 13988                                                                  ECSRIRTN
 13989     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 13990     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 13991     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 13992         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 13993     ELSE                                                         ECSRIRTN
 13994         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 13995     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 13996                                                                  ECSRIRTN
 13997     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 13998         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 13999         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14000         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14001         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14002         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14003         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14004                                                                  ECSRIRTN
 14005     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14006         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14007                                                                  ECSRIRTN
 14008     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14009         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14010                                                                  ECSRIRTN
 14011     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14012         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14013                                                                  ECSRIRTN
 14014     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14015     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14016                                                                  ECSRIRTN
 14017     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14018         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14019                                                                  ECSRIRTN
 14020     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14021       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14022        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14023        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14024           NEXT SENTENCE                                          ECSRIRTN
 14025       ELSE                                                       ECSRIRTN
 14026           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
 14027                       REIN-AH-FLG (SUB1).                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 272
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14028                                                                  ECSRIRTN
 14029     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14030         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14031            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14032             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14033                                                                  ECSRIRTN
 14034     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14035         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14036            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14037             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14038                                                                  ECSRIRTN
 14039     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14040         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14041             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14042                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14043             ELSE                                                 ECSRIRTN
 14044                 NEXT SENTENCE                                    ECSRIRTN
 14045         ELSE                                                     ECSRIRTN
 14046             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14047                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14048                                                                  ECSRIRTN
 14049     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14050         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14051             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14052                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14053             ELSE                                                 ECSRIRTN
 14054                 NEXT SENTENCE                                    ECSRIRTN
 14055         ELSE                                                     ECSRIRTN
 14056             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14057                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14058                                                                  ECSRIRTN
 14059     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14060         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14061                                                                  ECSRIRTN
 14062     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14063         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14064         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14065                                                                  ECSRIRTN
 14066     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14067         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14068                                                                  ECSRIRTN
 14069     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14070         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14071         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14072                                                                  ECSRIRTN
 14073     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14074         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14075                                                                  ECSRIRTN
 14076     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14077         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14078                                                                  ECSRIRTN
 14079     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14080                                                                  ECSRIRTN
 14081 REINSURE-CK-LIFE.                                                ECSRIRTN
 14082                                                                  ECSRIRTN
 14083     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14084         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14085                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 273
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14086     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14087         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14088                                                                  ECSRIRTN
 14089     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14090         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14091             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14092                                                                  ECSRIRTN
 14093     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14094                                                                  ECSRIRTN
 14095     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14096         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14097             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14098         ELSE                                                     ECSRIRTN
 14099             NEXT SENTENCE                                        ECSRIRTN
 14100     ELSE                                                         ECSRIRTN
 14101         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14102             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14103                                                                  ECSRIRTN
 14104     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14105         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14106             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14107         ELSE                                                     ECSRIRTN
 14108             NEXT SENTENCE                                        ECSRIRTN
 14109     ELSE                                                         ECSRIRTN
 14110         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14111             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14112                                                                  ECSRIRTN
 14113     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14114         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14115             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14116                                                                  ECSRIRTN
 14117     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14118         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14119            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14120                                                                  ECSRIRTN
 14121     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14122         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14123             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14124                                                                  ECSRIRTN
 14125     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14126         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14127            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14128                                                                  ECSRIRTN
 14129     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14130         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14131             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14132                                                                  ECSRIRTN
 14133     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14134         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14135            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14136            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14137             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14138                                                                  ECSRIRTN
 14139     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14140         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14141            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14142             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14143                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 274
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14144     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14145         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14146             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14147                                                                  ECSRIRTN
 14148     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14149         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14150             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14151                                                                  ECSRIRTN
 14152     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14153        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14154           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14155            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14156                                                                  ECSRIRTN
 14157     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14158         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14159            CR-IND-GRP = '1'                                      ECSRIRTN
 14160             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14161                                                                  ECSRIRTN
 14162     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14163         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14164            CR-IND-GRP = '1'                                      ECSRIRTN
 14165             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14166                                                                  ECSRIRTN
 14167     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14168         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14169            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14170            CR-IND-GRP = '1'                                      ECSRIRTN
 14171             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14172                                                                  ECSRIRTN
 14173     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14174         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14175            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14176            CR-IND-GRP = '1'                                      ECSRIRTN
 14177             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14178                                                                  ECSRIRTN
 14179     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14180         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14181            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14182                                                                  ECSRIRTN
 14183     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14184        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14185                                                                  ECSRIRTN
 14186     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14187         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14188                                                                  ECSRIRTN
 14189     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14190         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14191                                                                  ECSRIRTN
 14192     IF CR-LF-TERM  NUMERIC                                       00002331
 14193        NEXT SENTENCE                                             00002332
 14194     ELSE                                                         00002333
 14195        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14196     END-IF
 14197                                                                  00002335
 14198     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14199         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14200                                                                  ECSRIRTN
 14201     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 275
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14202         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14203                                                                  ECSRIRTN
 14204     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14205                                                                  ECSRIRTN
 14206     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14207         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14208                                                                  ECSRIRTN
 14209     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14210         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14211                                                                  ECSRIRTN
 14212     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14213                                                                  ECSRIRTN
 14214 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14215     EXIT.                                                        ECSRIRTN
 14216                                                                  ECSRIRTN
 14217 REINSURE-CK-AH.                                                  ECSRIRTN
 14218                                                                  ECSRIRTN
 14219     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14220         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14221                                                                  ECSRIRTN
 14222     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14223         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14224                                                                  ECSRIRTN
 14225     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14226         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14227             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14228                                                                  ECSRIRTN
 14229     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14230                                                                  ECSRIRTN
 14231     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14232         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14233             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14234         ELSE                                                     ECSRIRTN
 14235             NEXT SENTENCE                                        ECSRIRTN
 14236     ELSE                                                         ECSRIRTN
 14237         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14238             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14239                                                                  ECSRIRTN
 14240     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14241         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14242             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14243                                                                  ECSRIRTN
 14244     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14245         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14246             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14247                                                                  ECSRIRTN
 14248     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14249         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14250             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14251                                                                  ECSRIRTN
 14252     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14253         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14254             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14255                                                                  ECSRIRTN
 14256     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14257         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14258            CR-IND-GRP = '1'                                      ECSRIRTN
 14259             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 276
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14260                                                                  ECSRIRTN
 14261     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14262         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14263             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14264                                                                  ECSRIRTN
 14265     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14266         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14267            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14268                                                                  ECSRIRTN
 14269     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14270         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14271            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14272                                                                  ECSRIRTN
 14273     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14274         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14275             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14276                                                                  ECSRIRTN
 14277     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14278        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14279                                                                  ECSRIRTN
 14280     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14281         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14282                                                                  ECSRIRTN
 14283     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14284         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14285                                                                  ECSRIRTN
 14286     IF CR-AH-TERM  NUMERIC                                       00002331
 14287        NEXT SENTENCE                                             00002332
 14288     ELSE                                                         00002333
 14289        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14290     END-IF
 14291                                                                  00002335
 14292     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14293         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14294                                                                  ECSRIRTN
 14295     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14296         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14297                                                                  ECSRIRTN
 14298     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14299                                                                  ECSRIRTN
 14300     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14301         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14302             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14303                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14304                                                                  ECSRIRTN
 14305     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14306         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14307             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14308                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14309                                                                  ECSRIRTN
 14310     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14311     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14312                                                                  ECSRIRTN
 14313     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14314         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14315                                                                  ECSRIRTN
 14316     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
 14317         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 277
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14318                                                                  ECSRIRTN
 14319     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14320                                                                  ECSRIRTN
 14321     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14322                                                                  ECSRIRTN
 14323     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14324         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14325                                                                  ECSRIRTN
 14326     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14327         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14328                                                                  ECSRIRTN
 14329     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14330                                                                  ECSRIRTN
 14331 REINSURE-CK-AH-X.                                                ECSRIRTN
 14332     EXIT.                                                        ECSRIRTN
 14333                                                                  ECSRIRTN
 14334 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14335                                                                  ECSRIRTN
 14336     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14337        RS-AH-BEN = ZERO                                          ECSRIRTN
 14338         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14339                                                                  ECSRIRTN
 14340     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14341        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14342         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14343                                                                  ECSRIRTN
 14344     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14345                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14346                                                                  ECSRIRTN
 14347     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14348         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14349             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14350                                     WT-AHBEN-HI.                 ECSRIRTN
 14351     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14352         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14353             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14354                                     WT-AHMOA-HI.                 ECSRIRTN
 14355                                                                  ECSRIRTN
 14356     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14357     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14358                                                                  ECSRIRTN
 14359     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14360         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14361                                                                  ECSRIRTN
 14362     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14363         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14364                                                                  ECSRIRTN
 14365     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14366                                                                  ECSRIRTN
 14367     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14368         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14369                                                                  ECSRIRTN
 14370     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14371         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14372                                       / RW-AHWRK                 ECSRIRTN
 14373       ELSE                                                       ECSRIRTN
 14374         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
 14375                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 278
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14376     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14377         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14378                                       / RS-LIFE-BEN              ECSRIRTN
 14379       ELSE                                                       ECSRIRTN
 14380         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14381                                                                  ECSRIRTN
 14382     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14383        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14384          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14385          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14386                                      / CR-AH-TERM.               ECSRIRTN
 14387                                                                  ECSRIRTN
 14388     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14389        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14390          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14391          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14392               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14393            ELSE                                                  ECSRIRTN
 14394                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14395                                                                  ECSRIRTN
 14396     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14397        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14398        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14399          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14400          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14401                                      / CR-AH-TERM                ECSRIRTN
 14402         ELSE                                                     ECSRIRTN
 14403          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14404          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14405               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14406            ELSE                                                  ECSRIRTN
 14407                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14408                                                                  ECSRIRTN
 14409 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14410     EXIT.                                                        ECSRIRTN
 14411                                                                  ECSRIRTN
 14412                                                                  ECSRIRTN
 14413 REIN-CALC-LIFE.                                                  ECSRIRTN
 14414                                                                  ECSRIRTN
 14415     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14416         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14417     ELSE                                                         ECSRIRTN
 14418         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14419                                                                  ECSRIRTN
 14420     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14421         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14422     ELSE                                                         ECSRIRTN
 14423         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14424           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14425               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14426           ELSE                                                   ECSRIRTN
 14427               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14428                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14429                                                                  ECSRIRTN
 14430 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14431                                                                  ECSRIRTN
 14432     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
 14433                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 279
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14434     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14435         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14436                                                                  ECSRIRTN
 14437     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14438         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14439         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14440                                                                  ECSRIRTN
 14441     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14442         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14443                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14444         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14445                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14446     ELSE                                                         ECSRIRTN
 14447         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14448             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14449             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14450                                                                  ECSRIRTN
 14451     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14452         (WT-LF-QC = '2' AND                                         CL**8
 14453          PGM-SUB = +50  AND                                         CL**8
 14454          DTE-CLIENT = 'LAP'))                                       CL**8
 14455          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14456     ELSE                                                         ECSRIRTN
 14457         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14458                                                                  ECSRIRTN
 14459     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14460         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14461         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14462         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14463                                                                  ECSRIRTN
 14464     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14465                                                                  ECSRIRTN
 14466 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14467                                                                  ECSRIRTN
 14468     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14469         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14470         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14471                                                                  ECSRIRTN
 14472     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14473     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14474     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14475                                       RW-LFPRM.                  ECSRIRTN
 14476                                                                  ECSRIRTN
 14477 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14478                                                                  ECSRIRTN
 14479     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14480                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14481                                                                  ECSRIRTN
 14482     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14483        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14484                                                                  ECSRIRTN
 14485     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14486        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14487         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14488     ELSE                                                         ECSRIRTN
 14489         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14490         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
 14491                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 280
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14492                                                                  ECSRIRTN
 14493 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14494     EXIT.                                                        ECSRIRTN
 14495                                                                  ECSRIRTN
 14496 REIN-CALC-AH.                                                    ECSRIRTN
 14497                                                                  ECSRIRTN
 14498     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14499         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14500             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14501                                 WT-AHBEN-HI.                     ECSRIRTN
 14502                                                                  ECSRIRTN
 14503     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14504         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14505             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14506                                 WT-AHMOA-HI.                     ECSRIRTN
 14507                                                                  ECSRIRTN
 14508     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14509     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14510                                                                  ECSRIRTN
 14511     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14512         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14513                                                                  ECSRIRTN
 14514     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14515         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14516                                                                  ECSRIRTN
 14517     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14518         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14519                                                                  ECSRIRTN
 14520     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14521         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14522     ELSE                                                         ECSRIRTN
 14523         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14524             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14525         ELSE                                                     ECSRIRTN
 14526             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14527             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14528                                                                  ECSRIRTN
 14529 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14530                                                                  ECSRIRTN
 14531     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14532         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14533                                                                  ECSRIRTN
 14534     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14535         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14536         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14537                                                                  ECSRIRTN
 14538     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14539         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14540                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14541         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14542                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14543     ELSE                                                         ECSRIRTN
 14544         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14545             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14546             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14547                                                                  ECSRIRTN
 14548     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
 14549         (WT-AH-QC = '2' AND                                         CL**8
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 281
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14550          PGM-SUB = +50  AND                                         CL**8
 14551          DTE-CLIENT = 'LAP'))                                       CL**8
 14552         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14553     ELSE                                                         ECSRIRTN
 14554         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14555                                                                  ECSRIRTN
 14556     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14557         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14558            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14559                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14560                                                                  ECSRIRTN
 14561     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14562         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14563         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14564         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14565                                                                  ECSRIRTN
 14566     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14567                                                                  ECSRIRTN
 14568 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14569                                                                  ECSRIRTN
 14570     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14571         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14572         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14573                                                                  ECSRIRTN
 14574     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14575     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14576     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14577                                    RW-AHPRM.                     ECSRIRTN
 14578                                                                  ECSRIRTN
 14579 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14580                                                                  ECSRIRTN
 14581     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14582                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14583                                                                  ECSRIRTN
 14584     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14585                                                                  ECSRIRTN
 14586     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14587        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14588         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14589     ELSE                                                         ECSRIRTN
 14590         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14591         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14592                                                                  ECSRIRTN
 14593                                                                  ECSRIRTN
 14594 REIN-CALC-AH-X.                                                  ECSRIRTN
 14595     EXIT.                                                        ECSRIRTN
 14596                                                                  ECSRIRTN
 14597 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14598                                                                  ECSRIRTN
 14599     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14600     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14601     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14602     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14603                                                                  ECSRIRTN
 14604     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14605         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14606                                                                  ECSRIRTN
 14607     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 282
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14608        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14609           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14610                                                                  ECSRIRTN
 14611     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14612        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14613           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14614                                                                  ECSRIRTN
 14615 REINSURE-CALC-X.                                                 ECSRIRTN
 14616                                                                  ECSRIRTN
 14617     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14618         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14619                                                                  ECSRIRTN
 14620     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14621                                                                  ECSRIRTN
 14622 REINSURE-SUBTRACT.                                               ECSRIRTN
 14623                                                                  ECSRIRTN
 14624     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14625     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14626     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14627     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14628                                                                  ECSRIRTN
 14629 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14630     EXIT.                                                        ECSRIRTN
 14631                                                                  ECSRIRTN
 14632 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14633                                                                  ECSRIRTN
 14634     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14635     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14636                                                                  ECSRIRTN
 14637     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14638         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14639                                                                  ECSRIRTN
 14640     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14641         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14642                                                                  ECSRIRTN
 14643     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14644         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14645             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14646                                                                  ECSRIRTN
 14647     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14648         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14649                                                                  ECSRIRTN
 14650     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14651         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14652         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14653                                                                  ECSRIRTN
 14654     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14655        MOVE ZERO                TO REIN-FACTOR
 14656     ELSE                                                         ECSRIRTN
 14657        IF DTE-CLIENT = 'GIC'  AND
 14658           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14659           MOVE +1.0             TO REIN-FACTOR
 14660        ELSE
 14661           IF DTE-CLIENT = 'DCC'
 14662              COMPUTE REIN-FACTOR = CR-LFRFND /
 14663                 (CR-LFPRM + CR-LFPRM-ALT)
 14664           ELSE
 14665              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 283
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14666                 (CR-LFPRM + CR-LFPRM-ALT)
 14667            END-IF
 14668         END-IF
 14669     END-IF
 14670                                                                  ECSRIRTN
 14671     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14672         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14673             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14674                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14675                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14676             ELSE                                                 ECSRIRTN
 14677                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14678                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14679                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14680                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14681         ELSE                                                     ECSRIRTN
 14682             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14683                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
 14684                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
 14685             ELSE                                                 ECSRIRTN
 14686*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14687*                   * REIN-CALCED-LIFE *
 14688*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14689                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14690                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14691                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14692                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14693                                                                  ECSRIRTN
 14694     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14695         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14696             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14697                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14698                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14699             ELSE                                                 ECSRIRTN
 14700                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14701                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14702                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14703                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14704                                                                  ECSRIRTN
 14705     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14706                                                                  ECSRIRTN
 14707                                                                  ECSRIRTN
 14708 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14709                                                                  ECSRIRTN
 14710     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14711       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14712         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14713         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14714                                                                  ECSRIRTN
 14715     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14716       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14717           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14718           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14719       ELSE                                                       ECSRIRTN
 14720           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
 14721               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14722                                                                  ECSRIRTN
 14723     IF FLAT-CANCEL-LF                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 284
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14724         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14725         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14726                                                                  ECSRIRTN
 14727     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14728         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14729         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14730                                                                  ECSRIRTN
 14731     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14732     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14733     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14734                                         RW-LFRFND.               ECSRIRTN
 14735                                                                  ECSRIRTN
 14736 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14737                                                                  ECSRIRTN
 14738     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14739                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14740                                                                  ECSRIRTN
 14741     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14742        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14743                                                                  ECSRIRTN
 14744     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14745        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14746         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14747     ELSE                                                         ECSRIRTN
 14748         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14749         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14750                                                                  ECSRIRTN
 14751                                                                  ECSRIRTN
 14752 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14753                                                                  ECSRIRTN
 14754     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14755         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14756                                                                  ECSRIRTN
 14757     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14758         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14759             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14760                                                                  ECSRIRTN
 14761     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14762         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14763         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14764             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14765                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14766         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14767                                                                  ECSRIRTN
 14768     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14769         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14770                                                                  ECSRIRTN
 14771     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14772         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14773         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14774                                                                  ECSRIRTN
 14775     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14776        MOVE ZERO                TO REIN-FACTOR
 14777     ELSE
 14778        IF DTE-CLIENT = 'GIC'  AND
 14779           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14780            MOVE +1.0            TO REIN-FACTOR
 14781        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 285
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14782           IF DTE-CLIENT = 'DCC'
 14783              COMPUTE REIN-FACTOR =
 14784                 CR-AHRFND / CR-AHPRM
 14785           ELSE
 14786              COMPUTE REIN-FACTOR ROUNDED =
 14787                                CR-AHRFND-CALC / CR-AHPRM
 14788           END-IF
 14789        END-IF
 14790     END-IF
 14791
 14792     IF CR-AHAMT NOT = ZERO
 14793        IF (DTE-CLIENT = 'DCC')
 14794           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14795           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14796        ELSE
 14797           IF WT-AH-QC = ('1' OR '4')
 14798              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
 14799                       RWF-AHAMT) / CR-AHAMT
 14800           ELSE
 14801              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14802              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14803                       RWF-AHAMT) / CR-AHAMT
 14804           END-IF
 14805        END-IF
 14806     ELSE
 14807        IF RWF-AH-LIMIT = ZERO
 14808           IF WT-AH-QC = ('1' OR '4')
 14809              COMPUTE RWF-AHRFND ROUNDED =
 14810                       CR-AHRFND * WT-AH-PCT
 14811           ELSE
 14812              COMPUTE RWF-AHRFND =
 14813                            REIN-FACTOR * REIN-CALCED-AH
 14814              COMPUTE RWF-AHRFND ROUNDED =
 14815                       RWF-AHRFND * WT-AH-PCT
 14816           END-IF
 14817        END-IF
 14818     END-IF
 14819
 14820     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14821                                                                  ECSRIRTN
 14822                                                                  ECSRIRTN
 14823 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14824                                                                  ECSRIRTN
 14825     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14826       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14827         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14828         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14829                                                                  ECSRIRTN
 14830     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14831       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14832           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14833           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14834       ELSE                                                       ECSRIRTN
 14835           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 14836               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14837                                                                  ECSRIRTN
 14838     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14839         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 286
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14840         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14841                                                                  ECSRIRTN
 14842     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14843         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14844         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14845                                                                  ECSRIRTN
 14846     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14847     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14848     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14849                                    RW-AHRFND.                    ECSRIRTN
 14850                                                                  ECSRIRTN
 14851 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14852                                                                  ECSRIRTN
 14853     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14854                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14855                                                                  ECSRIRTN
 14856     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14857                                                                  ECSRIRTN
 14858     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14859        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14860         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14861     ELSE                                                         ECSRIRTN
 14862         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14863         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14864                                                                  ECSRIRTN
 14865                                                                  ECSRIRTN
 14866 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14867                                                                  ECSRIRTN
 14868     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14869         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14870                                                                  ECSRIRTN
 14871     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14872         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14873                                                                  ECSRIRTN
 14874     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14875                                                                  ECSRIRTN
 14876 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14877                                                                  ECSRIRTN
 14878     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14879     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14880                                                                  ECSRIRTN
 14881     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14882         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14883             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14884                                                                  ECSRIRTN
 14885     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14886         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14887                                                                  ECSRIRTN
 14888     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14889         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14890                                                                  ECSRIRTN
 14891 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14892                                                                  ECSRIRTN
 14893     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14894         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14895                                                                  ECSRIRTN
 14896     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14897                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 287
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14898 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14899                                                                  ECSRIRTN
 14900     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14901     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14902                                                                  ECSRIRTN
 14903 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14904     EXIT.                                                        ECSRIRTN
 14905                                                                  ECSRIRTN
 14906 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14907                                                                  ECSRIRTN
 14908     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14909         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14910                                                                  ECSRIRTN
 14911 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14912     EXIT.                                                        ECSRIRTN
 14913                                                                  ECSRIRTN
 14914 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14915                                                                  ECSRIRTN
 14916     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14917     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14918                                                                  ECSRIRTN
 14919     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14920         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14921                                                                  ECSRIRTN
 14922     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14923        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14924          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14925          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14926          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14927                                                                  ECSRIRTN
 14928     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14929        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14930          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14931                                                                  ECSRIRTN
 14932     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14933                                  RWF-AHCLML.                     ECSRIRTN
 14934                                                                  ECSRIRTN
 14935     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14936         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14937                                                                  ECSRIRTN
 14938     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14939         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14940                                                                  ECSRIRTN
 14941     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14942         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14943             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14944                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14945                                                                  ECSRIRTN
 14946     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14947         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14948                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14949                                                                  ECSRIRTN
 14950     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14951         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 14952                                                                  ECSRIRTN
 14953     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14954         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14955             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 288
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14956                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14957             ELSE                                                 ECSRIRTN
 14958                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14959         ELSE                                                     ECSRIRTN
 14960             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14961                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14962                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14963             ELSE                                                 ECSRIRTN
 14964                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14965                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14966                                                                  ECSRIRTN
 14967     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14968         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14969                                                                  ECSRIRTN
 14970     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14971         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14972            OR 'DCC'
 14973             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 14974                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14975         ELSE                                                     ECSRIRTN
 14976             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 14977                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 14978                                                                  ECSRIRTN
 14979     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14980         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14981             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14982                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 14983                                                                  ECSRIRTN
 14984     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14985         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14986             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14987                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 14988                                                                  ECSRIRTN
 14989     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14990         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14991             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14992               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 14993                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14994                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14995                  ELSE                                            ECSRIRTN
 14996                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 14997                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14998              ELSE                                                ECSRIRTN
 14999                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15000                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15001                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15002                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15003                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15004                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15005                                                                  ECSRIRTN
 15006     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15007                                                                  ECSRIRTN
 15008     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15009                                                                  ECSRIRTN
 15010                                                                  ECSRIRTN
 15011 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15012                                                                  ECSRIRTN
 15013     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 289
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15014         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15015                                                                  ECSRIRTN
 15016     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15017         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15018     ELSE                                                         ECSRIRTN
 15019         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15020                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15021                                                                  ECSRIRTN
 15022     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15023         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15024                                                                  ECSRIRTN
 15025     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15026         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15027             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15028         ELSE                                                     ECSRIRTN
 15029             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15030     ELSE                                                         ECSRIRTN
 15031         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15032             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15033             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15034         ELSE                                                     ECSRIRTN
 15035             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15036             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15037                                                                  ECSRIRTN
 15038                                                                  ECSRIRTN
 15039 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15040                                                                  ECSRIRTN
 15041     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15042         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15043                                                                  ECSRIRTN
 15044     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15045         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15046                                                                  ECSRIRTN
 15047     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15048         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15049                                                                  ECSRIRTN
 15050     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15051     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15052                                                                  ECSRIRTN
 15053     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15054             VARYING                                              ECSRIRTN
 15055         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15056             UNTIL                                                ECSRIRTN
 15057         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15058                                                                  ECSRIRTN
 15059     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15060         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15061     ELSE                                                         ECSRIRTN
 15062         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15063                                                                  ECSRIRTN
 15064 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15065                                                                  ECSRIRTN
 15066     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15067         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15068                                                                  ECSRIRTN
 15069     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15070       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15071           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 290
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15072                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15073               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15074                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15075               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15076                                                                  ECSRIRTN
 15077     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15078       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15079           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15080                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15081           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15082                                                                  ECSRIRTN
 15083     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15084         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15085                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15086                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15087         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15088                                                                  ECSRIRTN
 15089     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15090         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15091                                                                  ECSRIRTN
 15092     IF INC-SUB = +1                                              ECSRIRTN
 15093         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15094     IF INC-SUB = +2                                              ECSRIRTN
 15095         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15096     IF INC-SUB = +3                                              ECSRIRTN
 15097         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15098     IF INC-SUB = +4                                              ECSRIRTN
 15099         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15100     IF INC-SUB = +5                                              ECSRIRTN
 15101         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15102                                                                  ECSRIRTN
 15103     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15104                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15105                                                                  ECSRIRTN
 15106     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15107         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15108                                                                  ECSRIRTN
 15109     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15110              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15111         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15112     ELSE                                                         ECSRIRTN
 15113         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15114                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15115                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15116                                                                  ECSRIRTN
 15117 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15118      EXIT.                                                       ECSRIRTN
 15119                                                                  ECSRIRTN
 15120 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15121                                                                  ECSRIRTN
 15122     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15123         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15124                                                                  ECSRIRTN
 15125     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15126         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15127             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15128                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15129                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 291
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15130     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15131         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15132             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15133                                                                  ECSRIRTN
 15134 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15135                                                                  ECSRIRTN
 15136     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15137         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15138         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15139             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15140                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15141         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15142         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15143                                                                  ECSRIRTN
 15144     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15145         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15146                                                                  ECSRIRTN
 15147     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15148         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15149             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15150                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15151             ELSE                                                 ECSRIRTN
 15152                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15153         ELSE                                                     ECSRIRTN
 15154             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15155                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15156                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15157             ELSE                                                 ECSRIRTN
 15158                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15159                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15160                                                                  ECSRIRTN
 15161     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15162         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15163                                                                  ECSRIRTN
 15164     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15165         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15166                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15167     ELSE                                                         ECSRIRTN
 15168         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15169             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15170                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15171                                                                  ECSRIRTN
 15172     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15173         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15174             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15175                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15176                                                                  ECSRIRTN
 15177     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15178         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15179             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15180               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15181                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15182                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15183                  ELSE                                            ECSRIRTN
 15184                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15185                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15186              ELSE                                                ECSRIRTN
 15187                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 292
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15188                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15189                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15190                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15191                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15192                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15193                                                                  ECSRIRTN
 15194                                                                  ECSRIRTN
 15195     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15196        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15197                               '220000' OR '230000')              ECSRIRTN
 15198           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15199               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15200                                                                  ECSRIRTN
 15201     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15202                                                                  ECSRIRTN
 15203     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15204                                                                  ECSRIRTN
 15205                                                                  ECSRIRTN
 15206 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15207                                                                  ECSRIRTN
 15208     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15209         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15210                                                                  ECSRIRTN
 15211     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15212         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15213         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15214                                                                  ECSRIRTN
 15215     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15216                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15217                                                                  ECSRIRTN
 15218     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15219         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15220                                                                  ECSRIRTN
 15221     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15222         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15223                                                                  ECSRIRTN
 15224     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15225                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15226         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15227                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15228         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15229     ELSE                                                         ECSRIRTN
 15230         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15231         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15232                                                                  ECSRIRTN
 15233                                                                  ECSRIRTN
 15234 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15235                                                                  ECSRIRTN
 15236     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15237         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15238                                                                  ECSRIRTN
 15239     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15240         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15241                                                                  ECSRIRTN
 15242     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15243                                                                  ECSRIRTN
 15244 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15245                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 293
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15246     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15247     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15248                                                                  ECSRIRTN
 15249     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15250         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15251             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15252                                                                  ECSRIRTN
 15253     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15254     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15255                                                                  ECSRIRTN
 15256     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15257         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15258                                                                  ECSRIRTN
 15259     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15260         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15261                                                                  ECSRIRTN
 15262 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15263                                                                  ECSRIRTN
 15264     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15265         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15266                                                                  ECSRIRTN
 15267     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15268                                                                  ECSRIRTN
 15269 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15270                                                                  ECSRIRTN
 15271     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15272     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15273                                                                  ECSRIRTN
 15274 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15275     EXIT.                                                        ECSRIRTN
 15276                                                                  ECSRIRTN
 15277 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15278                                                                  ECSRIRTN
 15279     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15280         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15281                                                                  ECSRIRTN
 15282 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15283     EXIT.                                                        ECSRIRTN
 15284                                                                  ECSRIRTN
 15285                                                                  ECSRIRTN
 15286 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15287                                                                  ECSRIRTN
 15288     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15289     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15290     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15291     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15292                                                                  ECSRIRTN
 15293     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15294         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15295         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15296         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15297         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15298         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15299         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 15300         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15301         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15302         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15303                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 294
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15304     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15305         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15306                                                                  ECSRIRTN
 15307     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15308                                                                  ECSRIRTN
 15309 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15310                                                                  ECSRIRTN
 15311     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15312                                                                  ECSRIRTN
 15313 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15314     EXIT.                                                        ECSRIRTN
 15315                                                                  ECSRIRTN
 15316 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15317                                                                  ECSRIRTN
 15318     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15319                                                                  ECSRIRTN
 15320     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15321         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15322                                                                  ECSRIRTN
 15323     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15324         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15325             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15326                                                                  ECSRIRTN
 15327     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15328         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15329         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15330         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15331     ELSE                                                         ECSRIRTN
 15332         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15333         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15334         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15335                                                                  ECSRIRTN
 15336     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15337                                                                  ECSRIRTN
 15338     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15339        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15340         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15341                                                                  ECSRIRTN
 15342     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15343         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15344                                                                  ECSRIRTN
 15345 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15346     EXIT.                                                        ECSRIRTN
 15347                                                                  ECSRIRTN
 15348 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15349                                                                  ECSRIRTN
 15350     CONTINUE.                                                    ECSRIRTN
 15351*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15352 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15353     EXIT.                                                        ECSRIRTN
 15354                                                                  ECSRIRTN
 15355 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15356                                                                  ECSRIRTN
 15357     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 15358         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15359                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15360                                                                  ECSRIRTN
 15361     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 295
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15362         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15363                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15364                                                                  ECSRIRTN
 15365     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15366                                                                  ECSRIRTN
 15367     START ERRTBL-IN                                              ECSRIRTN
 15368           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15369             INVALID KEY                                          ECSRIRTN
 15370               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15371                                                                  ECSRIRTN
 15372     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15373     MOVE 0 TO SUB1.                                              ECSRIRTN
 15374 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15375                                                                  ECSRIRTN
 15376     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15377                                                                  ECSRIRTN
 15378     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15379        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15380                                                                  ECSRIRTN
 15381     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15382        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15383        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15384                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15385        GO TO ABEND-PGM.                                          ECSRIRTN
 15386                                                                  ECSRIRTN
 15387     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15388        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15389                                                                  ECSRIRTN
 15390     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15391        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15392                                                                  ECSRIRTN
 15393     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15394        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15395                                                                  ECSRIRTN
 15396     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15397        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15398                                                                  ECSRIRTN
 15399     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15400        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15401                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15402        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15403                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15404        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15405                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15406     END-PERFORM.                                                 ECSRIRTN
 15407     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15408                                                                  ECSRIRTN
 15409     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15410        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15411                                                                  ECSRIRTN
 15412     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15413        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 296
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15414                                                                  ECSRIRTN
 15415     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15416        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15417                                                                  ECSRIRTN
 15418     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15419        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15420                                                                  ECSRIRTN
 15421     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15422        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15423        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15424        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15425        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15426        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15427        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15428          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15429                                                                  ECSRIRTN
 15430     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15431                                                                  ECSRIRTN
 15432     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15433        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15434        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15435        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15436        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15437                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15438        GO TO ABEND-PGM.                                          ECSRIRTN
 15439                                                                  ECSRIRTN
 15440     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15441                                                                  ECSRIRTN
 15442     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15443                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15444     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15445                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15446     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15447                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15448                                                                  ECSRIRTN
 15449     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15450         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15451     ELSE                                                         ECSRIRTN
 15452         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15453                                                                  ECSRIRTN
 15454     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15455     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15456     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15457     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15458                                                                  ECSRIRTN
 15459 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15460                                                                  ECSRIRTN
 15461     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15462        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15463                                                                  ECSRIRTN
 15464     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15465        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15466                                                                  ECSRIRTN
 15467     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15468        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15469                                                                  ECSRIRTN
 15470     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15471        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 297
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15472                                                                  ECSRIRTN
 15473     ADD +1 TO SUB1.                                              ECSRIRTN
 15474                                                                  ECSRIRTN
 15475     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15476        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15477        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15478                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15479        GO TO ABEND-PGM.                                          ECSRIRTN
 15480                                                                  ECSRIRTN
 15481     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15482     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15483     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15484     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15485     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15486     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15487     if re-state-exhibit-opt-f = 'Y'
 15488        move 'Y'         to rc2-ecs152-rpt (sub1)
 15489     else
 15490        move 'N'         to rc2-ecs152-rpt (sub1)
 15491     end-if
 15492                                                                  ECSRIRTN
 15493     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15494                                                                  ECSRIRTN
 15495 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15496     EXIT.                                                        ECSRIRTN
 15497                                                                  ECSRIRTN
 15498 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15499                                                                  ECSRIRTN
 15500     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15501                                                                  ECSRIRTN
 15502     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15503                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15504                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15505                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15506                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15507                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15508                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15509                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15510                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15511                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15512                                                                  ECSRIRTN
 15513 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15514     EXIT.                                                        ECSRIRTN
 15515                                                                  ECSRIRTN
 15516 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15517                                                                  ECSRIRTN
 15518     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15519                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15520     move spaces      to rc2-ecs152-rpt (co-sub)
 15521                                                                  ECSRIRTN
 15522     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15523                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15524                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15525                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 15526                                                                  ECSRIRTN
 15527 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15528     EXIT.                                                        ECSRIRTN
 15529******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 298
* ECS010.cbl
 15531******************************************************************
 15532***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15533******************************************************************
 15534
 15535 3600-RC-REINSURANCE.
 15536
 15537     IF DTE-PGM-OPT NOT = '1'
 15538         GO TO 3799-RC-REINSURANCE-X.
 15539
 15540     IF DTE-CLIENT = 'WSL'
 15541         IF CR-REIN-TABLE = '00A'
 15542             GO TO 3799-RC-REINSURANCE-X.
 15543
 15544     IF CR-REIN-TABLE = SPACES OR ZEROS
 15545         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15546
 15547 3610-CLEAR-RC-REIN.
 15548
 15549     MOVE SPACES TO RC-REIN-LEVELS (1).
 15550     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15551                    RC-REIN-LFPRM (1)
 15552                    RC-REIN-AHAMT (1)
 15553                    RC-REIN-AHPRM (1)
 15554                    RC-REIN-LFRFND (1)
 15555                    RC-REIN-AHRFND (1)
 15556                    RC-REIN-LFCLM (1)
 15557                    RC-REIN-AHCLM (1).
 15558
 15559     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15560         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15561
 15562     MOVE +1 TO SUB1.
 15563     MOVE +0 TO SUB2.
 15564
 15565     GO TO 3630-RC-REIN-LOOP-1.
 15566
 15567 3620-CLEAR-RC-LEVELS.
 15568
 15569     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15570
 15571
 15572 3630-RC-REIN-LOOP-1.
 15573
 15574     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15575         ADD +1 TO SUB2
 15576         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15577         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15578         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15579         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15580         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15581         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15582         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15583         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15584         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15585         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15586
 15587     ADD +1 TO SUB1.
 15588     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 299
* ECS010.cbl
 15589         GO TO 3630-RC-REIN-LOOP-1.
 15590
 15591     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15592
 15593     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15594     IF CR-REIN-TABLE = SPACES OR ZEROS
 15595         MOVE +1                     TO SUB1
 15596         GO TO 3710-RC-REIN-LOOP-2.
 15597
 15598     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15599
 15600 3640-NSP-REIN-RATING-ROUTINE.
 15601
 15602     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15603     MOVE 'L'                        TO DC-OPTION-CODE.
 15604     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15605     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15606     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15607     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15608     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15609     MOVE CR-APR                     TO CP-LOAN-APR.
 15610     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15611     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15612     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15613     MOVE ZEROS                      TO CP-CLASS-CODE.
 15614
 15615     IF DTE-CLIENT = 'TIC'
 15616        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15617            MOVE ZERO                TO CP-CLASS-CODE
 15618        ELSE
 15619            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15620
 15621     MOVE '3'                        TO CP-PROCESS-TYPE.
 15622     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15623     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15624
 15625 3650-NSP-REIN-LIFE.
 15626
 15627     IF CR-LFTYP = ZERO
 15628         GO TO 3660-NSP-REIN-AH.
 15629     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15630        OR (DTE-CLIENT = 'DCC')
 15631         GO TO 3660-NSP-REIN-AH.
 15632     IF DTE-CLIENT NOT = 'LBL'
 15633         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15634             GO TO 3660-NSP-REIN-AH.
 15635
 15636     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15637         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15638         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15639
 15640     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15641     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15642     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15643                                        CP-RATING-BENEFIT-AMT.
 15644     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15645     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15646     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 300
* ECS010.cbl
 15647     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15648     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15649     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15650     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15651
 15652     IF CP-STATE-STD-ABBRV = 'OR'
 15653         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15654
 15655     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15656
 15657     IF CP-ERROR-RATE-NOT-FOUND  OR
 15658        CP-ERROR-RATE-IS-ZERO
 15659         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15660                                     TO WS-ABEND-MESSAGE
 15661         MOVE 0302                   TO WS-ABEND-CODE
 15662         DISPLAY '******************************'
 15663         DISPLAY '***** ERROR LOCATION 018 *****'
 15664         DISPLAY '******************************'
 15665         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15666         GO TO ABEND-PGM.
 15667
 15668     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15669
 15670*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15671*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15672
 15673     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15674                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15675
 15676     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15677
 15678 3660-NSP-REIN-AH.
 15679
 15680     IF CR-AHTYP = ZERO
 15681         GO TO 3669-NSP-REIN-X.
 15682     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15683        OR (DTE-CLIENT = 'DCC')
 15684         GO TO 3669-NSP-REIN-X.
 15685     IF DTE-CLIENT NOT = 'LBL'
 15686         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15687             GO TO 3669-NSP-REIN-X.
 15688
 15689     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15690         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15691         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15692
 15693     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15694     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15695     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15696                                        CP-RATING-BENEFIT-AMT.
 15697     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15698     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15699     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15700     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15701     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15702     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15703     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15704
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 301
* ECS010.cbl
 15705     IF CP-STATE-STD-ABBRV = 'OR'
 15706         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15707
 15708     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15709
 15710     IF CP-ERROR-RATE-NOT-FOUND  OR
 15711        CP-ERROR-RATE-IS-ZERO
 15712         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15713                                     TO WS-ABEND-MESSAGE
 15714         MOVE 0302                   TO WS-ABEND-CODE
 15715         DISPLAY '******************************'
 15716         DISPLAY '***** ERROR LOCATION 019 *****'
 15717         DISPLAY '******************************'
 15718         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15719         GO TO ABEND-PGM.
 15720
 15721     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15722             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15723
 15724     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15725
 15726 3669-NSP-REIN-X.
 15727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 302
* ECS010.cbl
 15729******************************************************************
 15730***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15731******************************************************************
 15732
 15733 3700-RC-REIN-PERF-CALC.
 15734
*15735                             COPY ECSRTPFM.
 15736******************************************************************07/10/97
 15737*                                                                *ECSRTPFM
 15738*                            ECSRTPFM                            *   LV001
 15739*                            VMOD=2.002                          *ECSRTPFM
 15740*                                                                *ECSRTPFM
 15741******************************************************************ECSRTPFM
 15742                                                                  ECSRTPFM
 15743     IF    CR-LFAMT  NUMERIC                                      00000072
 15744           NEXT SENTENCE                                          00000073
 15745        ELSE                                                      00000074
 15746           MOVE ZEROS TO CR-LFAMT.                                00000075
 15747                                                                  00000076
 15748     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15749           NEXT SENTENCE                                          00000078
 15750        ELSE                                                      00000079
 15751           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15752                                                                  00000081
 15753                                                                  00000082
 15754     IF    CR-LFPRM  NUMERIC                                      00000083
 15755           NEXT SENTENCE                                          00000084
 15756        ELSE                                                      00000085
 15757           MOVE ZEROS TO CR-LFPRM.                                00000086
 15758                                                                  00000087
 15759     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15760           NEXT SENTENCE                                          00000089
 15761        ELSE                                                      00000090
 15762           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15763                                                                  00000092
 15764                                                                  00000093
 15765     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15766           NEXT SENTENCE                                          00000095
 15767        ELSE                                                      00000096
 15768           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15769                                                                  00000098
 15770     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15771           NEXT SENTENCE                                          00000100
 15772        ELSE                                                      00000101
 15773           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15774                                                                  00000103
 15775     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15776           NEXT SENTENCE                                          00000105
 15777        ELSE                                                      00000106
 15778           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15779                                                                  00000108
 15780     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15781     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15782     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15783         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15784     ELSE                                                         ECSRTPFM
 15785         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15786     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 303
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15787                                                                  ECSRTPFM
 15788     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15789     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15790     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15791         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15792     ELSE                                                         ECSRTPFM
 15793         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15794     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15795                                                                  ECSRTPFM
 15796     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15797         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15798             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15799                                                                  ECSRTPFM
 15800
 15801     IF CR-STATE NOT = STATE-L
 15802         MOVE CR-STATE               TO STATE-L
 15803         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15804
 15805     MOVE 'X'                     TO REIN-RT-SW.
 15806     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15807     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15808     MOVE ' '                     TO REIN-RT-SW.
 15809
 15810 3710-RC-REIN-LOOP-2.
 15811
 15812     IF REIN-COMP (SUB1) = SPACES
 15813         GO TO 3730-RC-REIN-EXTRACTS.
 15814
 15815     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15816        ADD +1 TO SUB1
 15817         GO TO 3710-RC-REIN-LOOP-2.
 15818
 15819     MOVE +1 TO SUB2.
 15820
 15821 3720-RC-REIN-LOOP-3.
 15822
 15823     IF RC-REIN-COMP (SUB2) = SPACES
 15824         ADD +1 TO SUB1
 15825         GO TO 3710-RC-REIN-LOOP-2.
 15826
 15827     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15828         ADD +1 TO SUB2
 15829         GO TO 3720-RC-REIN-LOOP-3.
 15830
 15831     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15832        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15833        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15834        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15835         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15836         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15837
 15838     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15839        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15840         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15841         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15842
 15843     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15844         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 304
* ECS010.cbl
 15845         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15846
 15847     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15848         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15849         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15850
 15851     ADD +1 TO SUB2.
 15852     GO TO 3720-RC-REIN-LOOP-3.
 15853
 15854 3730-RC-REIN-EXTRACTS.
 15855
 15856     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15857     MOVE 'R' TO DE-REIN.
 15858     MOVE 'J' TO DE-TRANS.
 15859*****PERFORM EXTRACT-DATE-RELOAD.
 15860     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15861     MOVE +1 TO SUB1.
 15862
 15863 3740-RC-REIN-OLD-ISSUE.
 15864
 15865     IF RC-REIN-COMP (SUB1) = SPACES
 15866         MOVE +1 TO SUB1
 15867         GO TO 3745-RC-REIN-NEW-ISSUE.
 15868
 15869     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15870         ADD +1 TO SUB1
 15871         GO TO 3740-RC-REIN-OLD-ISSUE.
 15872
 15873     IF RC-OLD-ISS (SUB1) = 'X'
 15874         ADD +1 TO SUB1
 15875         GO TO 3740-RC-REIN-OLD-ISSUE.
 15876
 15877     IF RC-REIN-LFAMT (SUB1) = ZERO
 15878        AND RC-REIN-LFPRM (SUB1) = ZERO
 15879        AND RC-REIN-AHAMT (SUB1) = ZERO
 15880        AND RC-REIN-AHPRM (SUB1) = ZERO
 15881         ADD +1 TO SUB1
 15882         GO TO 3740-RC-REIN-OLD-ISSUE.
 15883
 15884     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15885     PERFORM EXTRACT-DATE-LOAD.
 15886     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15887     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15888     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15889     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15890     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15891     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15892
 15893     ADD +1 TO BC-R-ISS.
 15894     ADD +1 TO SUB1.
 15895     GO TO 3740-RC-REIN-OLD-ISSUE.
 15896
 15897 3745-RC-REIN-NEW-ISSUE.
 15898
 15899     IF REIN-COMP (SUB1) = SPACES
 15900         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15901                                         2259-END-CANCEL-BUILD
 15902         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 305
* ECS010.cbl
 15903         MOVE 'K'      TO DE-TRANS
 15904*********PERFORM EXTRACT-DATE-RELOAD
 15905         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15906         MOVE +1       TO SUB1
 15907         GO TO 3750-RC-REIN-OLD-CANCEL.
 15908
 15909     IF REIN-REM-SW (SUB1) = 'Z'
 15910         ADD +1 TO SUB1
 15911         GO TO 3745-RC-REIN-NEW-ISSUE.
 15912
 15913     IF RC-NEW-ISS (SUB1) = 'X'
 15914         ADD +1 TO SUB1
 15915         GO TO 3745-RC-REIN-NEW-ISSUE.
 15916
 15917     IF REIN-LFAMT (SUB1) = ZERO
 15918        AND REIN-LFPRM (SUB1) = ZERO
 15919        AND REIN-AHAMT (SUB1) = ZERO
 15920        AND REIN-AHPRM (SUB1) = ZERO
 15921         ADD +1 TO SUB1
 15922         GO TO 3745-RC-REIN-NEW-ISSUE.
 15923
 15924     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15925     PERFORM EXTRACT-DATE-LOAD.
 15926     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15927     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15928     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15929     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15930     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15931     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15932
 15933     ADD +1 TO BC-R-ISS.
 15934     ADD +1 TO SUB1.
 15935     GO TO 3745-RC-REIN-NEW-ISSUE.
 15936
 15937 3750-RC-REIN-OLD-CANCEL.
 15938
 15939     IF RC-REIN-COMP (SUB1) = SPACES
 15940         MOVE +1 TO SUB1
 15941         GO TO 3755-RC-REIN-NEW-CANCEL.
 15942
 15943     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15944         ADD +1 TO SUB1
 15945         GO TO 3750-RC-REIN-OLD-CANCEL.
 15946
 15947     IF RC-OLD-CNC (SUB1) = 'X'
 15948         ADD +1 TO SUB1
 15949         GO TO 3750-RC-REIN-OLD-CANCEL.
 15950
 15951     IF RC-REIN-LFRFND (SUB1) = ZERO
 15952        AND RC-REIN-AHRFND (SUB1) = ZERO
 15953         ADD +1 TO SUB1
 15954         GO TO 3750-RC-REIN-OLD-CANCEL.
 15955
 15956     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15957     PERFORM EXTRACT-DATE-LOAD.
 15958     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15959     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15960     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 306
* ECS010.cbl
 15961     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15962
 15963     ADD +1 TO BC-R-CNC.
 15964     ADD +1 TO SUB1.
 15965     GO TO 3750-RC-REIN-OLD-CANCEL.
 15966
 15967 3755-RC-REIN-NEW-CANCEL.
 15968
 15969     IF REIN-COMP (SUB1) = SPACES
 15970         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15971         MOVE 'R' TO DE-REIN
 15972         MOVE 'L' TO DE-TRANS
 15973*********PERFORM EXTRACT-DATE-RELOAD
 15974         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15975         MOVE +1 TO SUB1
 15976         GO TO 3760-RC-REIN-OLD-CLAIM.
 15977
 15978     IF REIN-REM-SW (SUB1) = 'Z'
 15979         ADD +1 TO SUB1
 15980         GO TO 3755-RC-REIN-NEW-CANCEL.
 15981
 15982     IF RC-NEW-CNC (SUB1) = 'X'
 15983         ADD +1 TO SUB1
 15984         GO TO 3755-RC-REIN-NEW-CANCEL.
 15985
 15986     IF REIN-LFRFND (SUB1) = ZERO
 15987        AND REIN-AHRFND (SUB1) = ZERO
 15988         ADD +1 TO SUB1
 15989         GO TO 3755-RC-REIN-NEW-CANCEL.
 15990
 15991     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 15992     PERFORM EXTRACT-DATE-LOAD.
 15993     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 15994     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 15995     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 15996     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15997
 15998     ADD +1 TO BC-R-CNC.
 15999     ADD +1 TO SUB1.
 16000     GO TO 3755-RC-REIN-NEW-CANCEL.
 16001
 16002 3760-RC-REIN-OLD-CLAIM.
 16003
 16004     IF RC-REIN-COMP (SUB1) = SPACES
 16005         MOVE +1 TO SUB1
 16006         GO TO 3780-RC-REIN-NEW-CLAIM.
 16007
 16008     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16009         ADD +1 TO SUB1
 16010         GO TO 3760-RC-REIN-OLD-CLAIM.
 16011
 16012     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16013         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16014
 16015     IF RC-REIN-LFCLM (SUB1) = ZERO
 16016         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16017
 16018     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 307
* ECS010.cbl
 16019     PERFORM EXTRACT-DATE-LOAD.
 16020     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16021     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16022     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16023     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16024     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16025     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16026     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16027     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16028     MOVE CR-DTH-PAY-DT TO DE-PAY
 16029                           WS-DE-PAY-N.
 16030
 16031     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16032         MOVE '3' TO DE-TYPE
 16033     ELSE
 16034         MOVE '1' TO DE-TYPE.
 16035
 16036     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16037
 16038     ADD +1 TO BC-R-CLM.
 16039
 16040 3770-RC-REIN-OLD-AH-CLM.
 16041
 16042     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16043         ADD +1 TO SUB1
 16044         GO TO 3760-RC-REIN-OLD-CLAIM.
 16045
 16046     IF RC-REIN-AHCLM (SUB1) = ZERO
 16047         ADD +1 TO SUB1
 16048         GO TO 3760-RC-REIN-OLD-CLAIM.
 16049
 16050     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16051     PERFORM EXTRACT-DATE-LOAD.
 16052     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16053     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16054     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16055     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16056     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16057     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16058     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16059     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16060     MOVE CR-DIS-PAY-DT TO DE-PAY
 16061                           WS-DE-PAY-N.
 16062
 16063     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16064         MOVE '4' TO DE-TYPE
 16065     ELSE
 16066         MOVE '2' TO DE-TYPE.
 16067
 16068     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16069
 16070     ADD +1 TO BC-R-CLM.
 16071     ADD +1 TO SUB1.
 16072
 16073     GO TO 3760-RC-REIN-OLD-CLAIM.
 16074
 16075 3780-RC-REIN-NEW-CLAIM.
 16076
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 308
* ECS010.cbl
 16077     IF REIN-COMP (SUB1) = SPACES
 16078         GO TO 3799-RC-REINSURANCE-X.
 16079
 16080     IF REIN-REM-SW (SUB1) = 'Z'
 16081         ADD +1 TO SUB1
 16082         GO TO 3780-RC-REIN-NEW-CLAIM.
 16083
 16084     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16085         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16086
 16087     IF REIN-LFCLM (SUB1) = ZERO
 16088         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16089
 16090     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16091     PERFORM EXTRACT-DATE-LOAD.
 16092     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16093     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16094     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16095     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16096     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16097     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16098     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16099     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16100     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16101                               WS-DE-PAY-N.
 16102
 16103     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16104         MOVE '3' TO DE-TYPE
 16105     ELSE
 16106         MOVE '1' TO DE-TYPE.
 16107
 16108     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16109
 16110     ADD +1 TO BC-R-CLM.
 16111
 16112 3790-RC-REIN-NEW-AH-CLM.
 16113
 16114     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16115         ADD +1 TO SUB1
 16116         GO TO 3780-RC-REIN-NEW-CLAIM.
 16117
 16118     IF REIN-AHCLM (SUB1) = ZERO
 16119         ADD +1 TO SUB1
 16120         GO TO 3780-RC-REIN-NEW-CLAIM.
 16121
 16122     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16123     PERFORM EXTRACT-DATE-LOAD.
 16124     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16125     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16126     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16127     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16128     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16129     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16130     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16131     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16132     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16133                               WS-DE-PAY-N.
 16134
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 309
* ECS010.cbl
 16135     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16136         MOVE '4' TO DE-TYPE
 16137     ELSE
 16138         MOVE '2' TO DE-TYPE.
 16139
 16140     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16141
 16142     ADD +1 TO BC-R-CLM.
 16143     ADD +1 TO SUB1.
 16144
 16145     GO TO 3780-RC-REIN-NEW-CLAIM.
 16146
 16147 3799-RC-REINSURANCE-X.
 16148     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 310
* ECS010.cbl
 16150******************************************************************
 16151***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16152******************************************************************
 16153
 16154 4000-EP-BUMP-RTN.
 16155
 16156     IF AM-RECALC-COMM = ('Y' OR '1')
 16157        PERFORM 1600-RECALC-COMM-EXTR
 16158                                 THRU 1899-RECALC-COMM-EXTR-X
 16159        MOVE ' '                 TO RECALC-TYPE
 16160     END-IF
 16161
 16162     MOVE '1'    TO EP-FLG.
 16163     ADD +1      TO BC-G-CERTS.
 16164
 16165     MOVE CR-DT               TO HIGH-CERT.
 16166     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16167         MOVE CR-DT           TO LOW-CERT
 16168         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16169
 16170     IF CR-POLICY-IS-REIN-ONLY
 16171         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16172                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16173                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16174                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16175                              DTH-IBNR           DIS-IBNR
 16176                              DTH-PAYCUR         DIS-PAYCUR
 16177                              DTH-FUTRSV         DIS-FUTRSV
 16178         GO TO 4050-EP-DO-REINSURE.
 16179
 16180     MOVE CR-LFAMT       TO WE-LFAMT.
 16181     MOVE CR-LFPRM       TO WE-LFPRM.
 16182     IF CR-LFTYP NOT = ZEROS
 16183         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16184             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16185             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16186         ELSE
 16187             MOVE ZEROS               TO WE-LFAMT-ALT
 16188                                         WE-LFPRM-ALT.
 16189
 16190     MOVE SPACES         TO REIN-EP-FLG
 16191                            WE-REIN-CO.
 16192     MOVE CR-LFRFND      TO WE-LFRFND.
 16193     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16194     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16195     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16196     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16197     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16198     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16199     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16200
 16201     MOVE CR-AHPRM       TO WE-AHPRM.
 16202     MOVE CR-AHAMT       TO WE-AHAMT.
 16203     MOVE CR-AHRFND      TO WE-AHRFND.
 16204     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16205     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16206     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16207     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 311
* ECS010.cbl
 16208     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16209     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16210     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16211
 16212     IF CR-POLICY-IS-RESTORE  OR
 16213        CR-POLICY-IS-REISSUE
 16214        OR CR-POLICY-IS-MONTHLY
 16215         MOVE ZEROS      TO WE-LFPRM
 16216                            WE-LFPRM-ALT
 16217                            WE-AHPRM.
 16218
 16219     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16220                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16221                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16222                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16223                              DTH-IBNR           DIS-IBNR
 16224                              DTH-PAYCUR         DIS-PAYCUR
 16225                              DTH-FUTRSV         DIS-FUTRSV.
 16226
 16227*     DISPLAY ' B4 4100 '
 16228     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16229*     DISPLAY ' AFTER 4100 '
 16230
 16231     IF CR-POLICY-IS-DECLINED  OR
 16232        CR-POLICY-IS-VOID
 16233         GO TO 4099-EP-BUMP-RTN-X.
 16234
 16235 4050-EP-DO-REINSURE.
 16236
 16237     MOVE 'R' TO REIN-EP-FLG.
 16238     MOVE +1  TO SUB5.
 16239
 16240 4090-EP-DO-REINSURE-LOOP.
 16241
 16242*     DISPLAY ' 4090 '
 16243     IF REIN-COMP (SUB5) = SPACES
 16244         MOVE SPACE TO REIN-EP-FLG
 16245         GO TO 4099-EP-BUMP-RTN-X.
 16246
 16247     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16248        REIN-LF-AH-FLGS (SUB5) = SPACES
 16249         ADD +1 TO SUB5
 16250         GO TO 4090-EP-DO-REINSURE-LOOP.
 16251
 16252     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16253        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16254          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16255          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16256          (RCT-REIN-CO (CO-SUB) = SPACES).
 16257
 16258     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16259        (RCT-REIN-CO (CO-SUB) = SPACES)
 16260        MOVE ZERO TO CO-SUB.
 16261
 16262*     DISPLAY ' 4090 A '
 16263*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16264     ADD +1 TO BC-R-CERTS.
 16265     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 312
* ECS010.cbl
 16266     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16267     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16268
 16269     IF (DTE-CLIENT = 'DCC')
 16270        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16271*        DISPLAY ' B4 CEDE FACT '
 16272*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16273*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16274*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16275        COMPUTE WS-CEDE-FACT =
 16276           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16277*        DISPLAY ' AFTER CEDE FACT '
 16278        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16279           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16280                                     NOT = 'G' AND 'L')
 16281           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16282*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16283*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16284           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16285           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16286        END-IF
 16287     END-IF
 16288
 16289     MOVE RWF-LFPRM      TO WE-LFPRM.
 16290     MOVE RWF-LFAMT      TO WE-LFAMT.
 16291     MOVE RWF-LFRFND     TO WE-LFRFND.
 16292     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16293     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16294     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16295     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16296     MOVE +0             TO WE-LFAMT-ALT
 16297                            WE-LFPRM-ALT
 16298                            WE-DTHEXP
 16299                            WE-NUM-DTH-CLM.
 16300
 16301*     DISPLAY ' 4090 B '
 16302     IF (DTE-CLIENT EQUAL 'NSL') AND
 16303        (CR-REIN-TABLE EQUAL 'NAR')
 16304        CONTINUE
 16305     ELSE
 16306      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16307       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16308        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16309            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16310        COMPUTE WE-LFAMT ROUNDED EQUAL
 16311                           CR-LFAMT * WS-CEDE-FACT
 16312        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16313                           CR-LFAMT-ALT * WS-CEDE-FACT
 16314        IF (DTE-CLIENT = 'CID')
 16315           AND (CR-LF-NSP-PRM > +0)
 16316           AND (CR-ENTRY-DATE > 20031130)
 16317           AND (WT-LF-QC NOT = '1' AND '3')
 16318           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16319              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16320           MOVE +0            TO WE-LFPRM-ALT
 16321        ELSE
 16322          IF (DTE-CLIENT = 'CID')
 16323             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 313
* ECS010.cbl
 16324             AND (CR-ENTRY-DATE > 20030430)
 16325             AND (WT-LF-QC NOT = '1' AND '3')
 16326             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16327             MOVE +0            TO WE-LFPRM-ALT
 16328          ELSE
 16329             COMPUTE WE-LFPRM ROUNDED EQUAL
 16330                           CR-LFPRM * WS-CEDE-FACT
 16331             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16332                           CR-LFPRM-ALT * WS-CEDE-FACT
 16333          END-IF
 16334        END-IF
 16335        IF (DTE-CLIENT = 'CID')
 16336           AND (CR-LF-NSP-PRM > +0)
 16337           AND (CR-LFRFND-CALC > +0)
 16338           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16339           AND (WT-LF-QC NOT = '1' AND '4')
 16340           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16341              (CR-LFPRM + CR-LFPRM-ALT)
 16342           COMPUTE WE-LFRFND =
 16343              REIN-FACTOR * REIN-CALCED-LIFE
 16344           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16345              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16346*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16347*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16348*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16349        ELSE
 16350
 16351          IF (DTE-CLIENT = 'CID')
 16352           AND (CR-LF-NSP-PRM > +0)
 16353           AND (CR-LFRFND-CALC > +0)
 16354           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16355           AND (WT-LF-QC NOT = '1' AND '4')
 16356           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16357           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16358              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16359
 16360          END-IF
 16361        END-IF
 16362       ELSE
 16363         MOVE +0 TO WS-CEDE-FACT
 16364       END-IF
 16365      END-IF
 16366     END-IF
 16367
 16368*     DISPLAY ' 4090 C '
 16369     IF DTE-CLIENT = 'DCC'
 16370        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16371           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16372                                   NOT = 'G' AND 'L')
 16373           AND (CR-AHAMT NOT = ZEROS)
 16374*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16375           COMPUTE WS-CEDE-FACT =
 16376               RWF-AHAMT / CR-AHAMT
 16377           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16378*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16379*          / CR-AHPRM * CR-AHRFND
 16380           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16381           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 314
* ECS010.cbl
 16382        END-IF
 16383     END-IF
 16384
 16385     MOVE RWF-AHPRM      TO WE-AHPRM.
 16386
 16387     MOVE RWF-AHAMT      TO WE-AHAMT
 16388     MOVE RWF-AHRFND     TO WE-AHRFND.
 16389     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16390     MOVE +0             TO WE-DSPY-EXP
 16391                            WE-NUM-DIS-CLM.
 16392     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16393     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16394     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16395
 16396     IF  RWF-LF-RUNOFF-SW = 'N'
 16397             OR
 16398         RWF-AH-RUNOFF-SW = 'N'
 16399         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16400
 16401     IF  RWF-LF-RUNOFF-SW = 'N'
 16402         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16403     ELSE
 16404         MOVE 99999999             TO STOP-LF-DATE.
 16405
 16406     IF  RWF-AH-RUNOFF-SW = 'N'
 16407         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16408     ELSE
 16409         MOVE 99999999             TO STOP-AH-DATE.
 16410
 16411     IF CR-POLICY-IS-RESTORE  OR
 16412        CR-POLICY-IS-REISSUE
 16413        OR CR-POLICY-IS-MONTHLY
 16414         MOVE ZEROS      TO WE-LFPRM
 16415                            WE-LFPRM-ALT
 16416                            WE-AHPRM.
 16417
 16418*     DISPLAY ' B4 4100-EP-DO-LF '
 16419     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16420*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16421
 16422     IF CO-SUB NOT = ZERO
 16423       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16424         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16425             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16426
 16427     ADD +1 TO SUB5.
 16428     GO TO 4090-EP-DO-REINSURE-LOOP.
 16429
 16430 4099-EP-BUMP-RTN-X.
 16431     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 315
* ECS010.cbl
 16433******************************************************************
 16434***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16435******************************************************************
 16436
 16437 4100-EP-DO-LF.
 16438
 16439     MOVE +0                         TO ISS-BEN  EPR-R78
 16440                                        CNC-BEN  EPR-PRO
 16441                                        ISS-PRM  EPR-ST
 16442                                        ISS-PRMTAX
 16443                                        CNC-PRM  ACTIVE-COUNT.
 16444     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16445
 16446     IF CR-LFTYP = ZERO
 16447         GO TO 4200-EP-DO-AH.
 16448
 16449     IF REIN-EP-FLG = 'R'
 16450         IF REIN-LF-FLG (SUB5) = SPACE
 16451             GO TO 4200-EP-DO-AH.
 16452
 16453     IF CR-APR NOT NUMERIC
 16454         MOVE ZERO TO CR-APR.
 16455
 16456     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16457     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16458     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16459
 16460     IF CR-POLICY-IS-DECLINED  OR
 16461        CR-POLICY-IS-VOID
 16462         GO TO 4191-CONTINUE.
 16463
 16464     MOVE CR-LF-TERM             TO ORIG-TERM.
 16465     MOVE CLAS-INDEXL            TO W-NDX.
 16466
 16467     IF CR-DT GREATER EW-COV-DTE
 16468         MOVE CR-DT              TO EW-COV-DTE.
 16469
 16470     IF (NOT CR-POLICY-IS-RESTORE) AND
 16471        (NOT CR-POLICY-IS-REISSUE)
 16472        AND (NOT CR-POLICY-IS-MONTHLY)
 16473         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16474         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16475             ADD CR-LIVES TO EW-ISS-CNT
 16476             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16477                                    (ORIG-TERM * CR-LIVES)
 16478             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16479             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16480             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16481                                   (ORIG-TERM * ISS-BEN)
 16482         ELSE
 16483             IF (DTE-CLIENT = 'DCC')
 16484                AND (CR-LFTYP = 'DD')
 16485                CONTINUE
 16486             ELSE
 16487                ADD +1 TO EW-ISS-CNT
 16488             END-IF
 16489             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16490             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 316
* ECS010.cbl
 16491             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16492             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16493                                   (ORIG-TERM * ISS-BEN).
 16494
 16495     MOVE RUN-DATE        TO VALUATION-DT.
 16496     MOVE '2'             TO W-VAL-SOURCE.
 16497
 16498     IF REIN-EP-FLG = 'R'
 16499         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16500            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16501             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16502             MOVE '10'              TO W-VAL-SOURCE.
 16503
 16504     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16505
 16506     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16507        (REM-TRM3 GREATER ZERO)
 16508        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16509            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16510                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16511            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16512                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16513          ELSE
 16514            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16515            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16516
 16517     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16518
 16519     IF DTE-CLIENT = 'GIC'
 16520         IF REIN-EP-FLG NOT = 'R'  AND
 16521            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16522            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16523            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16524
 16525     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16526         GO TO 4105-EP-DO-LF-REIN-CHK.
 16527
 16528     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16529             AND
 16530         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16531             AND
 16532         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16533                 OR
 16534             CR-LF-CANC-DT EQUAL ZEROS)
 16535             AND
 16536         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16537                 OR
 16538             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16539         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16540         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16541                 VARYING
 16542             SUBM FROM +1 BY +1
 16543                 UNTIL
 16544             SUBM GREATER THAN +13.
 16545
 16546     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16547     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16548
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 317
* ECS010.cbl
 16549 4105-EP-DO-LF-REIN-CHK.
 16550
 16551     IF REIN-EP-FLG = 'R'  AND
 16552        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16553         NEXT SENTENCE
 16554     ELSE
 16555         GO TO 4110-EP-DO-LF-CLM.
 16556
 16557     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16558         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16559             GO TO 4130-EP-DO-LF-EP.
 16560
 16561     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16562         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16563             GO TO 4130-EP-DO-LF-EP.
 16564
 16565 4110-EP-DO-LF-CLM.
 16566
 16567     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16568         NEXT  SENTENCE
 16569       ELSE
 16570         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16571
 16572     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16573     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16574
 16575     IF CR-LF-STATUS-AT-DEATH = ' '
 16576         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16577             GO TO 4115-EP-DO-LF-CLM-EPR.
 16578
 16579     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16580     ADD +1             TO EW-CLM-CRT.
 16581
 16582 4115-EP-DO-LF-CLM-EPR.
 16583
 16584     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16585         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16586         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16587     END-IF
 16588     .
 16589 4120-EP-DO-LF-CNCL.
 16590
 16591     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16592        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16593         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16594             GO TO 4190-EP-DO-LF-COMM
 16595         ELSE
 16596             GO TO 4130-EP-DO-LF-EP.
 16597
 16598     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16599         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16600         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16601
 16602     IF CR-LFTYP NOT = 'DD'
 16603        ADD +1                    TO EW-CNC-CNT
 16604     END-IF
 16605
 16606     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 318
* ECS010.cbl
 16607
 16608     IF DTE-CLIENT = 'GIC'
 16609         IF REIN-EP-FLG NOT = 'R'  AND
 16610            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16611             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16612
 16613*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16614*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16615*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16616*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16617
 16618     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16619     MOVE 'L'                   TO  DC-OPTION-CODE.
 16620     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16621     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16622
 16623     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16624     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16625     MOVE '1'                     TO  DC-OPTION-CODE.
 16626     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16627     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16628     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16629                                      DC-ODD-DAYS-OVER
 16630                                      DC-ELAPSED-DAYS.
 16631     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16632     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16633
 16634     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16635         ADD  +1                  TO  MONTHS-DIFF-LF.
 16636
 16637     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16638
 16639     if (dte-client = 'AHL')
 16640        and (cr-lf-cancel-exit-date < 20120401)
 16641        go to 4120-continue-life-cancel
 16642     end-if
 16643
 16644     IF DTE-CLIENT = 'ACE'
 16645         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16646
 16647     MOVE  ZEROS                  TO  SUB.
 16648
 16649 4120-LIFE-CHARGEBACK-LOOP.
 16650
 16651     ADD    +1                    TO  SUB.
 16652
 16653     IF  SUB  GREATER THAN  +10
 16654         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16655
 16656     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16657         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16658         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16659
 16660     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16661         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16662
 16663     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16664         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 319
* ECS010.cbl
 16665
 16666     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16667
 16668
 16669 4120-CONTINUE-LIFE-CANCEL.
 16670
 16671     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16672     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16673
 16674     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16675         GO TO 4190-EP-DO-LF-COMM.
 16676
 16677     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16678         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16679         GO TO 4190-EP-DO-LF-COMM.
 16680
 16681     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16682     MOVE '3'           TO W-VAL-SOURCE.
 16683     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16684
 16685     IF REM-TRM3 = CR-LF-TERM
 16686         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16687         GO TO 4190-EP-DO-LF-COMM.
 16688
 16689     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16690         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16691
 16692     IF DTE-CLIENT = 'NCL'
 16693         IF CR-DT LESS THAN 19910101
 16694             GO TO 4121-EP-DO-LF-CNC-BEN.
 16695
 16696     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16697         GO TO 4126-EP-DO-LF-CNCL-NP.
 16698
 16699     IF DTE-CLIENT = 'FUL'
 16700         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16701
 16702*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16703     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16704        (CR-RATING-CLASS NOT = 'L ')
 16705         IF (CR-APR GREATER THAN ZERO)  AND
 16706            (CR-LF-TERM GREATER THAN 060)  AND
 16707            (CR-DT GREATER THAN 19831031)
 16708              GO TO 4126-EP-DO-LF-CNCL-NP.
 16709
 16710     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16711         IF (CR-APR GREATER THAN ZERO)  AND
 16712            (CR-LF-TERM GREATER THAN 061)  AND
 16713            (CR-DT GREATER THAN 19830318)
 16714              GO TO 4126-EP-DO-LF-CNCL-NP.
 16715
 16716     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16717         IF (CR-APR GREATER THAN ZERO)  AND
 16718            (CR-LF-TERM GREATER THAN 062)  AND
 16719            (CR-DT GREATER THAN 19810831)  AND
 16720            (CR-DT LESS THAN 19830901)
 16721              GO TO 4126-EP-DO-LF-CNCL-NP.
 16722
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 320
* ECS010.cbl
 16723     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16724         IF (CR-APR GREATER THAN ZERO)  AND
 16725            (CR-LF-TERM GREATER THAN 060)  AND
 16726            (CR-DT GREATER THAN 19831231)
 16727              GO TO 4126-EP-DO-LF-CNCL-NP.
 16728
 16729 4121-EP-DO-LF-CNC-BEN.
 16730
 16731     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16732
 16733     COMPUTE TEMP-3 ROUNDED EQUAL
 16734         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16735
 16736     MOVE TEMP-3                 TO CNC-BEN.
 16737
 16738     GO TO 4190-EP-DO-LF-COMM.
 16739
 16740 4122-EP-DO-LF-CNCL-TEX.
 16741
 16742     DIVIDE WE-LFAMT BY CR-LF-TERM
 16743         GIVING TEX-FACT-1.
 16744     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16745         GIVING TEX-FACT-2
 16746             REMAINDER TEX-FACT-3.
 16747     IF TEX-FACT-3 NOT = ZERO
 16748         ADD +1 TO TEX-FACT-2.
 16749
 16750     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16751
 16752     GO TO 4190-EP-DO-LF-COMM.
 16753
 16754 4124-EP-DO-LF-CNCL-SUM.
 16755
 16756     IF WE-LFRFND = ZERO
 16757         GO TO 4130-EP-DO-LF-EP.
 16758
 16759     MOVE WE-LFRFND TO CNC-PRM.
 16760
 16761     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16762
 16763     IF WE-LFRFND NOT LESS WE-LFPRM
 16764         MOVE WE-LFAMT TO CNC-BEN
 16765          GO TO 4130-EP-DO-LF-EP.
 16766
 16767
 16768     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16769
 16770     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16771         MOVE TEMP-7 TO CNC-BEN
 16772          GO TO 4130-EP-DO-LF-EP.
 16773
 16774     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16775     MOVE '4'           TO W-VAL-SOURCE.
 16776     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16777
 16778     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16779         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16780         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 321
* ECS010.cbl
 16781
 16782 4126-EP-DO-LF-CNCL-NP.
 16783
 16784     IF WE-LFAMT = ZERO
 16785        GO TO 4190-EP-DO-LF-COMM.
 16786
 16787     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16788     MOVE 'L'                        TO  DC-OPTION-CODE.
 16789     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16790     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16791
 16792     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16793       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16794       MOVE '3'                      TO  DC-OPTION-CODE
 16795       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16796       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16797     ELSE
 16798       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16799       MOVE '6'                      TO  DC-OPTION-CODE
 16800       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16801       MOVE +0                       TO  DC-ELAPSED-DAYS
 16802       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16803       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16804
 16805     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16806     MOVE CR-APR                     TO  CP-LOAN-APR.
 16807     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16808     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16809     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16810     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16811     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16812     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16813
 16814
 16815     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16816     IF (DTE-CLIENT = 'DCC')
 16817        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16818        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16819           ((CR-STATE = DD-STATE (D1))
 16820           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16821           AND ('A'           = DD-BEN-TYPE   (D1))
 16822           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 16823           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16824                           OR
 16825           D1 > +800
 16826        END-PERFORM
 16827        IF D1 < +801
 16828           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 16829              (P1 > +8)
 16830              OR (DD-PROD-CODE (D1 P1) = 'L')
 16831           END-PERFORM
 16832           IF P1 < +9
 16833              MOVE DD-MAX-BEN-AMT (D1 P1)
 16834                                 TO CP-R-MAX-TOT-BEN
 16835           END-IF
 16836        END-IF
 16837     END-IF
 16838
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 322
* ECS010.cbl
 16839     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16840
 16841     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16842       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16843       GO TO 4130-EP-DO-LF-EP
 16844     ELSE
 16845       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16846
 16847     GO TO 4190-EP-DO-LF-COMM.
 16848
 16849 4128-EP-DO-LF-CNCL-FUL.
 16850
 16851     IF WE-LFAMT = ZERO
 16852        GO TO 4190-EP-DO-LF-COMM.
 16853
 16854     MOVE CR-APR              TO NP-APR.
 16855     MOVE CR-LF-TERM          TO NP-ORIG.
 16856     MOVE REM-TRM3            TO NP-REM.
 16857     MOVE '2'                 TO NP-OPT.
 16858     MOVE CR-AHPRM            TO NP-AHPRM.
 16859     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16860     MOVE CR-LFAMT            TO NP-BENEFIT.
 16861
 16862*    CALL 'FULNETRM'
 16863*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16864*              NP-ACCOUNT NP-REMAINING.
 16865
 16866     MOVE NP-REMAINING TO CNC-BEN.
 16867
 16868     GO TO 4190-EP-DO-LF-COMM.
 16869
 16870 4130-EP-DO-LF-EP.
 16871
 16872     MOVE SPACE                  TO STATUTORY-SWITCH.
 16873
 16874     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16875     MOVE '5'           TO W-VAL-SOURCE.
 16876
 16877     IF REIN-EP-FLG = 'R'
 16878       IF REIN-REM-SW (SUB5) = 'I'
 16879           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16880           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16881           GO TO 4190-EP-DO-LF-COMM.
 16882
 16883     IF REIN-EP-FLG = 'R'
 16884         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16885            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16886             MOVE '*'               TO LIFE-EARNED-SWITCH
 16887             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16888             MOVE '10'              TO W-VAL-SOURCE.
 16889
 16890     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16891
 16892     IF REM-TRM2 GREATER CR-LF-TERM
 16893         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16894         GO TO 4190-EP-DO-LF-COMM.
 16895
 16896     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 323
* ECS010.cbl
 16897         GO TO 4180-EP-DO-LF-EP-SUM.
 16898
 16899     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16900         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16901             IF REM-TRM2 NOT GREATER THAN +0
 16902                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16903                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16904                 GO TO 4190-EP-DO-LF-COMM
 16905             ELSE
 16906                 NEXT SENTENCE
 16907         ELSE
 16908             IF W-BAL-REMTRM NOT GREATER +0
 16909                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16910                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16911                 GO TO 4190-EP-DO-LF-COMM
 16912             ELSE
 16913                 NEXT SENTENCE
 16914     ELSE
 16915        IF DTE-CLIENT = 'NCL'  AND
 16916           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16917            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16918        ELSE
 16919         IF REM-TRM2 NOT GREATER +0  OR
 16920            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16921             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16922             GO TO 4190-EP-DO-LF-COMM.
 16923
 16924     MOVE +1 TO ACTIVE-COUNT.
 16925
 16926     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16927         GO TO 4140-EP-DO-LF-EP-TEX.
 16928
 16929     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16930         GO TO 4150-EP-DO-LF-EP-NP.
 16931
 16932*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16933     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16934        (CR-RATING-CLASS NOT = 'L ')
 16935         IF (CR-APR GREATER THAN ZERO)  AND
 16936            (CR-LF-TERM GREATER THAN 060)  AND
 16937            (CR-DT GREATER THAN 19831031)
 16938             MOVE '*'             TO STATUTORY-SWITCH
 16939              GO TO 4150-EP-DO-LF-EP-NP.
 16940
 16941     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16942         IF (CR-APR GREATER THAN ZERO)  AND
 16943            (CR-LF-TERM GREATER THAN 061)  AND
 16944            (CR-DT GREATER THAN 19830318)
 16945             MOVE '*'             TO STATUTORY-SWITCH
 16946              GO TO 4150-EP-DO-LF-EP-NP.
 16947
 16948     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16949         IF (CR-APR GREATER THAN ZERO)  AND
 16950            (CR-LF-TERM GREATER THAN 062)  AND
 16951            (CR-DT GREATER THAN 19810831)  AND
 16952            (CR-DT LESS THAN 19830901)
 16953             MOVE '*'             TO STATUTORY-SWITCH
 16954              GO TO 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 324
* ECS010.cbl
 16955
 16956     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16957         IF (CR-APR GREATER THAN ZERO)  AND
 16958            (CR-LF-TERM GREATER THAN 060)  AND
 16959            (CR-DT GREATER THAN 19831231)
 16960             MOVE '*'             TO STATUTORY-SWITCH
 16961              GO TO 4150-EP-DO-LF-EP-NP.
 16962
 16963     GO TO 4160-EP-DO-LF-EP-R78.
 16964
 16965 4140-EP-DO-LF-EP-TEX.
 16966
 16967     IF CR-PMT-FREQ = 0
 16968       DISPLAY '*************************************'
 16969       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16970       DISPLAY '*************************************'
 16971       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 16972       DISPLAY '*************************************'
 16973       COMPUTE TEX-FACT-4 =
 16974          (CR-LF-TERM * CR-LF-TERM) +
 16975                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 16976     ELSE
 16977        COMPUTE TEX-FACT-4 =
 16978         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16979
 16980     IF CR-PMT-FREQ = 0
 16981       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 16982           GIVING TEX-FACT-5
 16983               REMAINDER TEX-FACT-6
 16984     ELSE
 16985        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16986            GIVING TEX-FACT-5
 16987                REMAINDER TEX-FACT-6.
 16988
 16989     IF CR-PMT-FREQ > 0
 16990        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 16991
 16992     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16993     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16994         (TEX-FACT-5 * CR-PMT-FREQ) +
 16995         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16996     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 16997
 16998     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 16999
 17000     GO TO 4170-EP-DO-LF-EP-PRO.
 17001
 17002 4150-EP-DO-LF-EP-NP.
 17003
 17004     IF WE-LFPRM = ZERO
 17005         GO TO 4160-EP-DO-LF-EP-R78.
 17006
 17007     IF DTE-CLIENT = 'CRI'
 17008       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17009             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17010           GO TO 4160-EP-DO-LF-EP-R78.
 17011
 17012     IF DTE-CLIENT = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 325
* ECS010.cbl
 17013        GO TO 4160-EP-DO-LF-EP-R78
 17014     END-IF
 17015
 17016     IF DTE-CLIENT = 'NCL'
 17017       IF CR-DT LESS THAN 19910101
 17018           GO TO 4160-EP-DO-LF-EP-R78.
 17019
 17020     IF REM-TRM1 = CR-LF-TERM
 17021         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17022         GO TO 4190-EP-DO-LF-COMM.
 17023
 17024     MOVE CR-APR TO NP-APR.
 17025     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17026     MOVE REM-TRM1 TO NP-REM.
 17027     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17028     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17029         MOVE CR-LOAN-TERM TO NP-ORIG.
 17030
 17031     MOVE 'R' TO NP-OPT.
 17032     CALL 'ECSNETRM'
 17033         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17034
 17035     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17036
 17037     IF STATUTORY-REQUIREMENT
 17038         MOVE EPR-R78                TO EPR-ST.
 17039
 17040 4160-EP-DO-LF-EP-R78.
 17041
 17042     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17043        (DTE-CLIENT EQUAL 'NCL')
 17044        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17045           (CR-MO EQUAL EOM-MO)
 17046           MOVE '*'            TO OB-DATE-1-SWITCH
 17047           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17048           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17049           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17050           COMPUTE WS-EPR-R78 (SUB3 1) =
 17051                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17052           GO TO 4190-EP-DO-LF-COMM
 17053        ELSE
 17054        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17055           (CR-MO EQUAL OB-MO (1))
 17056           MOVE '*'            TO OB-DATE-2-SWITCH
 17057           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17058           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17059           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17060           COMPUTE WS-EPR-R78 (SUB3 2) =
 17061                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17062           GO TO 4190-EP-DO-LF-COMM
 17063        ELSE
 17064        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17065           (CR-MO EQUAL OB-MO (2))
 17066           MOVE '*'            TO OB-DATE-3-SWITCH
 17067           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17068           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17069           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17070           COMPUTE WS-EPR-R78 (SUB3 3) =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 326
* ECS010.cbl
 17071                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17072           GO TO 4190-EP-DO-LF-COMM
 17073        ELSE
 17074           GO TO 4190-EP-DO-LF-COMM.
 17075
 17076     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17077
 17078     IF DTE-R78 = '1'
 17079         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17080     ELSE
 17081         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17082
 17083     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17084
 17085     IF REM-TRM1 GREATER THAN +0
 17086         COMPUTE TEMP-7 ROUNDED EQUAL
 17087             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17088     ELSE
 17089         MOVE WE-LFPRM                TO TEMP-7.
 17090
 17091     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17092         MOVE TEMP-7                 TO EPR-ST.
 17093
 17094     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17095         MOVE ZEROS                  TO TEMP-8
 17096         GO TO 4165-END-LF-EP-R78.
 17097
 17098     IF EPR-ST = ZEROS
 17099         MOVE TEMP-7                 TO EPR-ST.
 17100
 17101     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17102         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17103         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17104         IF DTE-R78 = '1'
 17105             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17106
 17107     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17108
 17109     COMPUTE TEMP-8 ROUNDED =
 17110               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17111
 17112 4165-END-LF-EP-R78.
 17113
 17114     IF EPR-R78 = ZEROS
 17115         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17116     ELSE
 17117         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17118
 17119 4170-EP-DO-LF-EP-PRO.
 17120
 17121     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17122         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17123     ELSE
 17124         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17125
 17126     IF REM-TRM1 GREATER THAN +0
 17127         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17128     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 327
* ECS010.cbl
 17129         MOVE WE-LFPRM                  TO TEMP-7.
 17130
 17131     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17132         MOVE ZEROS                     TO TEMP-8
 17133         GO TO 4175-END-LF-EP-PRO.
 17134
 17135     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17136         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17137             COMPUTE TEMP-5 ROUNDED =
 17138                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17139         ELSE
 17140             COMPUTE TEMP-5 ROUNDED =
 17141                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17142
 17143     COMPUTE TEMP-8 ROUNDED =
 17144                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17145
 17146     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17147
 17148 4175-END-LF-EP-PRO.
 17149
 17150     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17151
 17152     GO TO 4185-EP-DO-LF-STATUTORY.
 17153
 17154 4180-EP-DO-LF-EP-SUM.
 17155
 17156     IF REM-TRM1 NOT GREATER +0
 17157         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17158         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17159         GO TO 4190-EP-DO-LF-COMM.
 17160
 17161     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17162
 17163     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17164         MOVE ZEROS                 TO TEMP-7
 17165     ELSE
 17166         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17167                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17168
 17169     IF TEMP-7 NOT GREATER ZERO
 17170         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17171             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17172             GO TO 4190-EP-DO-LF-COMM
 17173         ELSE
 17174             MOVE ZEROS             TO TEMP-7.
 17175
 17176     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17177     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17178     IF DTE-R78 = '1'
 17179         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17180
 17181     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17182     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17183
 17184     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17185
 17186     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 328
* ECS010.cbl
 17187
 17188     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17189         GO TO 4185-EP-DO-LF-STATUTORY.
 17190
 17191     MOVE EPR-R78                  TO EPR-ST.
 17192
 17193     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17194         MOVE ZEROS                 TO TEMP-8
 17195     ELSE
 17196         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17197                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17198
 17199     IF TEMP-8 NOT GREATER ZERO
 17200         GO TO 4185-EP-DO-LF-STATUTORY.
 17201
 17202     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17203                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17204
 17205     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17206                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17207
 17208     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17209                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17210
 17211 4185-EP-DO-LF-STATUTORY.
 17212
 17213*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17214*07636          MOVE EPR-R78                TO EPR-ST.
 17215     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17216         MOVE EPR-PRO                TO EPR-ST.
 17217
 17218     IF DTE-CLIENT = 'AHL'
 17219        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17220           MOVE EPR-R78          TO EPR-ST
 17221        ELSE
 17222           MOVE EPR-PRO          TO EPR-ST
 17223        END-IF
 17224     END-IF
 17225
 17226     IF (DTE-CLIENT = 'CID')
 17227        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17228                   OR
 17229            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17230            AND (CR-DT > 20091231)))
 17231        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17232        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17233           GO TO 4187-EP-DO-LF-STAT-ROA
 17234     END-IF.
 17235
 17236     IF EPR-ST NOT = ZEROS
 17237         GO TO 4190-EP-DO-LF-COMM.
 17238
 17239     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17240         MOVE EPR-R78                TO EPR-ST
 17241     ELSE
 17242         MOVE EPR-PRO                TO EPR-ST.
 17243
 17244     GO TO 4190-EP-DO-LF-COMM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 329
* ECS010.cbl
 17245
 17246 4187-EP-DO-LF-STAT-ROA.
 17247     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17248     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17249     MOVE 'L'                        TO DC-OPTION-CODE.
 17250     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17251     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17252     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17253        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17254        MOVE '3'                     TO  DC-OPTION-CODE
 17255        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17256                              8099-DATE-CONVERT-X
 17257        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17258     ELSE
 17259        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17260        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17261        MOVE +0                      TO  DC-ELAPSED-DAYS
 17262        MOVE '6'                     TO  DC-OPTION-CODE
 17263        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17264                              8099-DATE-CONVERT-X
 17265        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17266     END-IF.
 17267     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17268     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17269     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17270     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17271     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17272     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17273     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17274     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17275     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17276     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17277                                        CP-LOAN-TERM.
 17278     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17279                                        CP-RATING-BENEFIT-AMT.
 17280     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17281     MOVE CR-APR                     TO CP-LOAN-APR.
 17282     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17283     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17284     MOVE '6'                        TO CP-EARNING-METHOD.
 17285     MOVE '3'                        TO CP-PROCESS-TYPE.
 17286     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17287     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17288         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17289     ELSE
 17290         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17291     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17292     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17293     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17294     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17295     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17296     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17297
 17298     IF CP-STATE-STD-ABBRV = 'OR'
 17299        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17300     END-IF
 17301
 17302     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 330
* ECS010.cbl
 17303        COMPUTE CP-ORIGINAL-BENEFIT =
 17304         (CR-LFAMT - CR-LFPRM)
 17305     END-IF
 17306
 17307     IF CP-TRUNCATED-LIFE
 17308        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17309     END-IF
 17310
 17311     IF CP-TERM-IS-DAYS
 17312        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17313     ELSE
 17314        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17315     END-IF
 17316
 17317     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17318
 17319     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17320
 17321 4190-EP-DO-LF-COMM.
 17322
 17323     MOVE +0 TO SUB1.
 17324     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17325         10 TIMES.
 17326
 17327     IF REIN-EP-FLG NOT = 'R'  OR
 17328        CR-POLICY-IS-REIN-ONLY
 17329         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17330         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17331         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17332         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17333
 17334     ADD ISS-BEN TO EW-ISS-BEN.
 17335     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17336     ADD CNC-BEN TO EW-CNC-BEN.
 17337     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17338     ADD ISS-PRM TO EW-ISS-PRM.
 17339     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17340     ADD CNC-PRM TO EW-CNC-PRM.
 17341     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17342
 17343     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17344     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17345     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17346
 17347     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17348        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17349     END-IF
 17350     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17351        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17352     END-IF
 17353
 17354     COMPUTE ISS-PRMTAX =
 17355        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17356        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17357
 17358     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17359
 17360     IF LIFE-FULLY-EARNED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 331
* ECS010.cbl
 17361         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17362                                            (ISS-PRM - EPR-R78)
 17363         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17364                                            (ISS-PRM - EPR-PRO)
 17365         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17366                                            (ISS-PRM - EPR-ST).
 17367
 17368     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17369         IF  REIN-EP-FLG NOT = 'R'
 17370                 OR
 17371             CR-POLICY-IS-REIN-ONLY
 17372             MOVE 'L'      TO W-CLAIM-TYPE
 17373             MOVE EPR-R78  TO W-OPT-R78
 17374             MOVE EPR-PRO  TO W-OPT-PRO
 17375             MOVE EPR-ST   TO W-OPT-ST
 17376             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17377             MOVE ZEROS    TO EW-CLM-IBNR
 17378         ELSE
 17379             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17380                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17381                 MOVE ZEROS      TO EW-CLM-IBNR
 17382             ELSE
 17383                 MOVE ZEROS      TO EW-CLM-IBNR
 17384     ELSE
 17385         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17386             ADD WE-DTH-IBNR
 17387                       TO EW-CLM-IBNR
 17388         ELSE
 17389             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17390                     AND
 17391                 CR-DT GREATER THAN LAST-YRS-DATE
 17392                 COMPUTE  EW-CLM-IBNR
 17393                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17394
 17395     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17396     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17397
 17398 4191-CONTINUE.
 17399
 17400     MOVE 'Y'          TO EW-LEVEL-USED.
 17401
 17402     IF CR-POLICY-UNDERWRITTEN
 17403         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17404         MOVE EPEC-OPT-WORK-TABLE
 17405                              TO EPEC-UNDW-OPT-DATA-TABLE
 17406     ELSE
 17407         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17408         MOVE EPEC-OPT-WORK-TABLE
 17409                              TO EPEC-OPT-DATA-TABLE.
 17410
 17411     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 332
* ECS010.cbl
 17413 4194-SLOT-INTO-EFFECTED-MONTHS.
 17414
 17415     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17416             AND
 17417         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17418             AND
 17419         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17420                 OR
 17421          CR-LF-CANC-DT EQUAL ZEROS)
 17422             AND
 17423         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17424                 OR
 17425          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17426         MOVE 'Y'                 TO W-TABLE-USED-SW
 17427         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17428             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17429                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17430                 + CR-LIVES
 17431         ELSE
 17432             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17433                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17434
 17435 4194-EXIT.
 17436     EXIT.
 17437
 17438 4196-CALC-REM-AMT.
 17439
 17440     IF CR-LFTYP = 'QD'
 17441        MOVE +15.0               TO CR-APR
 17442     END-IF
 17443
 17444     MOVE +0                     TO WS-REM-AMT
 17445     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17446        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17447           COMPUTE WS-REM-AMT =
 17448             CR-LFAMT + CR-LFAMT-ALT
 17449        ELSE
 17450           MOVE CR-LFAMT         TO WS-REM-AMT
 17451        END-IF
 17452        GO TO 4199-EXIT
 17453     END-IF
 17454
 17455     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17456
 17457     IF REM-TRM1 = CR-LF-TERM
 17458        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17459           COMPUTE WS-REM-AMT =
 17460             CR-LFAMT + CR-LFAMT-ALT
 17461        ELSE
 17462           MOVE CR-LFAMT         TO WS-REM-AMT
 17463        END-IF
 17464        GO TO 4199-EXIT
 17465     END-IF
 17466
 17467     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17468        GO TO 4198-ORDINARY-REM
 17469     END-IF
 17470
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 333
* ECS010.cbl
 17471     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17472        GO TO 4198-CALC-TEXAS-REM
 17473     END-IF
 17474
 17475     IF CR-LFTYP = 'QD'
 17476        MOVE +15.0               TO CR-APR
 17477        MOVE 'N'                 TO
 17478                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17479        GO TO 4198-CALC-NET-PAY-REM
 17480     END-IF
 17481
 17482     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17483        GO TO 4198-CALC-NET-PAY-REM
 17484     END-IF
 17485
 17486     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17487        (CR-RATING-CLASS NOT = 'L ')
 17488         IF (CR-LF-TERM GREATER THAN +60) AND
 17489            (CR-DT GREATER THAN 19831031) AND
 17490            (CR-APR GREATER THAN ZERO)
 17491             GO TO 4198-CALC-NET-PAY-REM
 17492        END-IF
 17493     END-IF
 17494
 17495     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17496         IF (CR-LF-TERM GREATER THAN +61) AND
 17497            (CR-DT  GREATER THAN 19830318) AND
 17498            (CR-APR GREATER THAN ZERO)
 17499             GO TO 4198-CALC-NET-PAY-REM
 17500        END-IF
 17501     END-IF
 17502
 17503     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17504         IF (CR-LF-TERM GREATER THAN +62) AND
 17505            (CR-DT  GREATER THAN 19810831) AND
 17506            (CR-DT  LESS THAN 19830901) AND
 17507            (CR-APR GREATER THAN ZERO)
 17508             GO TO 4198-CALC-NET-PAY-REM
 17509        END-IF
 17510     END-IF
 17511
 17512     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17513         IF (CR-LF-TERM GREATER THAN +60) AND
 17514            (CR-DT  GREATER THAN 19831231) AND
 17515            (CR-APR GREATER THAN ZERO)
 17516             GO TO 4198-CALC-NET-PAY-REM
 17517        END-IF
 17518     END-IF
 17519
 17520     .
 17521 4198-ORDINARY-REM.
 17522
 17523     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17524         COMPUTE WS-REM-AMT ROUNDED =
 17525                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17526     ELSE
 17527         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17528     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 334
* ECS010.cbl
 17529
 17530     GO TO 4199-EXIT
 17531
 17532     .
 17533 4198-CALC-TEXAS-REM.
 17534
 17535     DIVIDE CR-LFAMT BY CR-LF-TERM
 17536         GIVING TEX-FACT-1.
 17537     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17538         GIVING TEX-FACT-2
 17539         REMAINDER TEX-FACT-3.
 17540
 17541     IF TEX-FACT-3 NOT = ZERO
 17542         ADD +1                  TO TEX-FACT-2
 17543     END-IF
 17544
 17545     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17546         MOVE CR-LFAMT           TO WS-REM-AMT
 17547     ELSE
 17548         COMPUTE WS-REM-AMT ROUNDED =
 17549             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17550     END-IF
 17551
 17552     GO TO 4199-EXIT
 17553
 17554     .
 17555 4198-CALC-NET-PAY-REM.
 17556
 17557     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17558     MOVE 'L'                        TO DC-OPTION-CODE.
 17559     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17560     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17561
 17562     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17563        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17564        MOVE '3'                 TO  DC-OPTION-CODE
 17565        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17566                                  8099-DATE-CONVERT-X
 17567        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17568     ELSE
 17569        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17570        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17571        MOVE +0                  TO  DC-ELAPSED-DAYS
 17572        MOVE '6'                 TO  DC-OPTION-CODE
 17573        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17574                                  8099-DATE-CONVERT-X
 17575        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17576     END-IF
 17577
 17578     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17579        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17580     ELSE
 17581        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17582     END-IF
 17583     MOVE CR-APR                 TO  CP-LOAN-APR
 17584     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17585     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17586     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 335
* ECS010.cbl
 17587     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17588                                 TO CP-SPECIAL-CALC-CD
 17589     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17590                                 TO  CP-BENEFIT-TYPE
 17591     MOVE CLAS-I-EP (CLAS-INDEXL)
 17592                                 TO  CP-EARNING-METHOD
 17593
 17594     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17595     IF (DTE-CLIENT = 'DCC')
 17596        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17597        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17598           ((CR-STATE = DD-STATE (D1))
 17599           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17600           AND ('A'           = DD-BEN-TYPE   (D1))
 17601           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 17602           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17603                           OR
 17604           D1 > +800
 17605        END-PERFORM
 17606        IF D1 < +801
 17607           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17608              (P1 > +8)
 17609              OR (DD-PROD-CODE (D1 P1) = 'L')
 17610           END-PERFORM
 17611           IF P1 < +9
 17612              MOVE DD-MAX-BEN-AMT (D1 P1)
 17613                                 TO CP-R-MAX-TOT-BEN
 17614           END-IF
 17615        END-IF
 17616     END-IF
 17617
 17618     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17619
 17620     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17621
 17622     .
 17623 4199-EXIT.
 17624     EXIT.
 17625
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 336
* ECS010.cbl
 17627******************************************************************
 17628***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17629******************************************************************
 17630
 17631 4200-EP-DO-AH.
 17632
 17633     MOVE +0                         TO ISS-BEN  EPR-R78
 17634                                        CNC-BEN  EPR-PRO
 17635                                        ISS-PRM  EPR-ST
 17636                                        CNC-PRM
 17637                                        WX-CLM-AMT
 17638                                        WX-CLM-EXP
 17639                                        WX-CLM-CNT
 17640                                        WX-CLM-CRT
 17641                                        WX-ACTIVE-COUNT
 17642                                        ISS-PRMTAX
 17643                                        WX-CNC-CNT.
 17644     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17645
 17646     IF CR-AHTYP = ZERO
 17647         GO TO 4295-EP-DO-COUNT.
 17648
 17649     IF REIN-EP-FLG = 'R'
 17650         IF REIN-AH-FLG (SUB5) = SPACE
 17651             GO TO 4295-EP-DO-COUNT.
 17652
 17653     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17654     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17655     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17656
 17657     IF CR-POLICY-IS-DECLINED  OR
 17658        CR-POLICY-IS-VOID
 17659         GO TO 4290-CONTINUE.
 17660
 17661     MOVE CR-AH-TERM           TO ORIG-TERM.
 17662
 17663     IF CR-DT GREATER EW-COV-DTE
 17664         MOVE CR-DT            TO EW-COV-DTE.
 17665
 17666     IF NOT CR-POLICY-IS-RESTORE  AND
 17667        NOT CR-POLICY-IS-REISSUE
 17668        AND NOT CR-POLICY-IS-MONTHLY
 17669         MOVE WE-AHAMT         TO ISS-BEN
 17670         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17671         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17672         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17673         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17674                                   (ORIG-TERM * ISS-BEN).
 17675
 17676     MOVE CLAS-INDEXA     TO W-NDX.
 17677     MOVE RUN-DATE        TO VALUATION-DT
 17678     MOVE '6'             TO W-VAL-SOURCE.
 17679
 17680     IF REIN-EP-FLG = 'R'
 17681         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17682            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17683             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17684             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 337
* ECS010.cbl
 17685
 17686     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17687
 17688     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17689        (REM-TRM3 GREATER ZERO)
 17690        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17691            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17692                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17693            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17694                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17695          ELSE
 17696            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17697            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17698
 17699     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17700         GO TO 4210-BY-OPT-LOGIC.
 17701
 17702     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17703             AND
 17704         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17705             AND
 17706         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17707                 OR
 17708          CR-AH-CANC-DT EQUAL ZEROS)
 17709         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17710         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17711                 VARYING
 17712             SUBM FROM +1 BY +1
 17713                 UNTIL
 17714             SUBM GREATER THAN +13.
 17715
 17716     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17717     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17718
 17719 4210-BY-OPT-LOGIC.
 17720
 17721     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17722         ADD CR-LIVES TO EW-ISS-CNT
 17723         MOVE WE-AHPRM TO ISS-PRM
 17724         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17725                                (ORIG-TERM * CR-LIVES)
 17726         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17727         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17728         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17729                                   (ORIG-TERM * ISS-BEN)
 17730         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17731         GO TO 4225-CONTINUE.
 17732
 17733     IF (NOT CR-POLICY-IS-RESTORE) AND
 17734        (NOT CR-POLICY-IS-REISSUE)
 17735        AND (NOT CR-POLICY-IS-MONTHLY)
 17736        ADD +1 TO EW-ISS-CNT.
 17737
 17738     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17739
 17740     .
 17741 4225-CONTINUE.
 17742
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 338
* ECS010.cbl
 17743     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17744         NEXT  SENTENCE
 17745       ELSE
 17746         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17747
 17748     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17749     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17750     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17751     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17752     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17753     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17754
 17755     MOVE +0           TO SUB1.
 17756
 17757     IF DTE-CLIENT = 'DCC'
 17758        IF CR-AH-CANC-DT NOT = ZEROS
 17759           MOVE CR-AH-TERM       TO ORIG-TERM
 17760           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17761           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17762           MOVE '1'              TO W-VAL-SOURCE
 17763           PERFORM 8500-REMAINING-TERM-ROUTINE
 17764                                 THRU 8599-REM-TERM-X
 17765           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17766        END-IF
 17767     END-IF
 17768
 17769     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17770         10 TIMES.
 17771     MOVE +0                     TO SUB16
 17772     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17773        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17774
 17775     IF REIN-EP-FLG NOT = 'R'  OR
 17776        CR-POLICY-IS-REIN-ONLY
 17777         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17778         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17779         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17780         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17781
 17782     ADD ISS-BEN TO EW-ISS-BEN.
 17783     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17784     ADD CNC-BEN TO EW-CNC-BEN.
 17785     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17786     ADD ISS-PRM TO EW-ISS-PRM.
 17787     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17788     ADD CNC-PRM TO EW-CNC-PRM.
 17789     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17790
 17791     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17792     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17793     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17794
 17795     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17796        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17797     END-IF
 17798     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17799        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17800     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 339
* ECS010.cbl
 17801     COMPUTE ISS-PRMTAX =
 17802        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17803        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17804     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17805
 17806     IF A-H-FULLY-EARNED
 17807         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17808                                            (ISS-PRM - EPR-R78)
 17809         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17810                                            (ISS-PRM - EPR-PRO)
 17811         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17812                                            (ISS-PRM - EPR-ST).
 17813
 17814     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17815         IF  REIN-EP-FLG NOT = 'R'
 17816                 OR
 17817             CR-POLICY-IS-REIN-ONLY
 17818             MOVE 'A'      TO W-CLAIM-TYPE
 17819             MOVE EPR-R78  TO W-OPT-R78
 17820             MOVE EPR-PRO  TO W-OPT-PRO
 17821             MOVE EPR-ST   TO W-OPT-ST
 17822             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17823             MOVE ZEROS    TO EW-CLM-IBNR
 17824         ELSE
 17825             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17826                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17827                 MOVE ZEROS TO EW-CLM-IBNR
 17828             ELSE
 17829                 MOVE ZEROS TO EW-CLM-IBNR
 17830     ELSE
 17831         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17832             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17833         ELSE
 17834             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17835                 IF  CR-AH-POLICY-IS-ACTIVE
 17836                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17837                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17838                 ELSE
 17839                     NEXT SENTENCE
 17840             ELSE
 17841                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17842                     COMPUTE  EW-CLM-IBNR
 17843                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17844
 17845     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17846     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17847
 17848 4290-CONTINUE.
 17849*     DISPLAY ' 4290 '
 17850
 17851     MOVE 'Y'          TO EW-LEVEL-USED.
 17852
 17853     IF CR-POLICY-UNDERWRITTEN
 17854         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17855         MOVE EPEC-OPT-WORK-TABLE
 17856                              TO EPEC-UNDW-OPT-DATA-TABLE
 17857     ELSE
 17858         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 340
* ECS010.cbl
 17859         MOVE EPEC-OPT-WORK-TABLE
 17860                              TO EPEC-OPT-DATA-TABLE.
 17861
 17862
 17863 4295-EP-DO-COUNT.
 17864
 17865     IF REIN-EP-FLG = 'R'
 17866         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17867     ELSE
 17868         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17869
 17870     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 341
* ECS010.cbl
 17872 4296-SLOT-INTO-EFFECTED-MONTHS.
 17873
 17874     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17875             AND
 17876         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17877             AND
 17878         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17879                 OR
 17880          CR-AH-CANC-DT EQUAL ZEROS)
 17881         MOVE 'Y'                 TO W-TABLE-USED-SW
 17882         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17883             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17884                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17885                 + CR-LIVES
 17886         ELSE
 17887             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17888                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17889
 17890 4296-EXIT.
 17891     EXIT.
 17892
 17893 4299-EPBX.
 17894     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 342
* ECS010.cbl
 17896******************************************************************
 17897***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17898******************************************************************
 17899
 17900 4300-EP-COMM-LOOP.
 17901
 17902     IF DTE-CLIENT = 'DMD'
 17903         GO TO 4350-EP-COMM-LOOP-X.
 17904
 17905     ADD +1                         TO SUB1.
 17906     MOVE ZEROS                     TO SUB16.
 17907
 17908     IF CR-ADDL-CLP NOT NUMERIC
 17909        MOVE ZEROS               TO CR-ADDL-CLP
 17910     END-IF
 17911     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17912         GO TO 4350-EP-COMM-LOOP-X.
 17913
 17914 4300-AGENT-LOOP.
 17915
 17916     ADD +1                         TO SUB16.
 17917
 17918     IF SUB16 GREATER THAN WS-LOOP-MAX
 17919         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17920         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17921         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17922                                     TO WS-ABEND-MESSAGE
 17923         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17924         MOVE 4001                   TO WS-ABEND-CODE
 17925         GO TO ABEND-PGM.
 17926
 17927     IF EW-AGT-NO (SUB16) = SPACES
 17928         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 17929         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 17930     ELSE
 17931         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 17932            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 17933             NEXT SENTENCE
 17934         ELSE
 17935             GO TO 4300-AGENT-LOOP.
 17936
 17937     IF EW-LF-AH = AH-OVERRIDE-L1
 17938         GO TO 4350-EP-COMM-LOOP-A.
 17939
 17940     IF (DTE-CLIENT = 'DCC')
 17941        AND (REIN-EP-FLG = 'R')
 17942        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17943        AND (WE-LFPRM NOT = ZEROS)
 17944        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17945           COMPUTE ISS-WK ROUNDED =
 17946              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 17947        ELSE
 17948           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 17949               (CR-LFAMT + CR-LFAMT-ALT)
 17950           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 17951              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 17952        END-IF
 17953     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 343
* ECS010.cbl
 17954        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 17955                             OR 'J' OR 'N'
 17956           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 17957        ELSE
 17958           IF CR-AGT-TYPE (SUB1) = 'A'
 17959              COMPUTE ISS-WK ROUNDED =
 17960                   CR-LF-CLP * CR-LCOM-L (SUB1)
 17961           ELSE
 17962              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17963                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 17964                 COMPUTE ISS-WK ROUNDED =
 17965                      CR-LF-CLP * CR-LCOM-L (SUB1)
 17966              ELSE
 17967                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 17968                    * CR-LCOM-L (SUB1)
 17969              END-IF
 17970           END-IF
 17971        END-IF
 17972     END-IF
 17973
 17974     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 17975
 17976     MOVE ZEROS                  TO CNC-WK
 17977                                    CNC-FACT
 17978     IF DTE-CLIENT EQUAL 'XXX'
 17979         IF NOT CR-NO-LF-CHARGEBACK
 17980            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 17981            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 17982                                + CNC-WK
 17983            GO TO 4300-CONTINUE-LOOP.
 17984
 17985     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 17986        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 17987
 17988      IF (DTE-CLIENT = 'DCC')
 17989         AND (REIN-EP-FLG = 'R')
 17990         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17991         AND (WE-LFRFND NOT = ZEROS)
 17992         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17993            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17994            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 17995               CR-LCOM-L (SUB1)
 17996            IF CR-ACCOUNT = '05500500DD'
 17997               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 17998            END-IF
 17999         ELSE
 18000            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18001            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18002               * CR-LCOM-L (SUB1)
 18003         END-IF
 18004      ELSE
 18005        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18006                              OR 'L' OR 'J' OR 'K')
 18007           AND (CNC-PRM > +0)
 18008           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18009           IF CR-CANCEL-REASON = 'R'
 18010              MOVE 1             TO CNC-FACT
 18011           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 344
* ECS010.cbl
 18012           COMPUTE CNC-WK = CNC-FACT *
 18013              (CR-LCOM-L (SUB1) * +1000)
 18014*       ELSE
 18015*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18016*          AND (CNC-PRM > +0)
 18017*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18018*                                THRU 4380-EXIT
 18019*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18020*          COMPUTE CNC-WK = CNC-FACT *
 18021*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18022*       ELSE
 18023*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18024*              AND (CR-AHTYP NOT = '00' AND '  ')
 18025*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18026*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18027*             COMPUTE CNC-WK = CNC-FACT *
 18028*                (CR-AHPRM - (CR-LFPRM-ALT
 18029*                + CR-ADDL-CLP))
 18030         ELSE
 18031            IF (CR-AGT-TYPE (SUB1) = 'A')
 18032                      OR
 18033              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18034                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18035              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18036              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18037                CR-LCOM-L (SUB1)
 18038            ELSE
 18039               COMPUTE CNC-WK  ROUNDED =
 18040                 CNC-PRM * CR-LCOM-L (SUB1)
 18041            END-IF
 18042         END-IF
 18043*       END-IF
 18044      END-IF
 18045        COMPUTE EW-CNC-COM (SUB16) =
 18046                                  EW-CNC-COM (SUB16) + CNC-WK
 18047     END-IF
 18048
 18049     if (ws-dcc-cnc-flag = 'Y')
 18050        and (rein-ep-flg not = 'R')
 18051        move cnc-wk              to dx-l-pc (sub1)
 18052     end-if
 18053
 18054     .
 18055 4300-CONTINUE-LOOP.
 18056
 18057*     DISPLAY ' 4300 CONTINUE '
 18058     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18059               OR
 18060        ((ISS-WK - CNC-WK) = ZEROS)
 18061        MOVE ZEROS              TO COMM-WK
 18062     ELSE
 18063        COMPUTE EC-FACT ROUNDED =
 18064           EPR-R78 / (ISS-PRM - CNC-PRM)
 18065        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18066     END-IF
 18067
 18068     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18069
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 345
* ECS010.cbl
 18070     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18071               OR
 18072        ((ISS-WK - CNC-WK) = ZEROS)
 18073        MOVE ZEROS              TO COMM-WK
 18074     ELSE
 18075        COMPUTE EC-FACT ROUNDED =
 18076           EPR-PRO / (ISS-PRM - CNC-PRM)
 18077        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18078     END-IF
 18079     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18080
 18081     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18082               OR
 18083        ((ISS-WK - CNC-WK) = ZEROS)
 18084        MOVE ZEROS              TO COMM-WK
 18085     ELSE
 18086        COMPUTE EC-FACT ROUNDED =
 18087           EPR-ST / (ISS-PRM - CNC-PRM)
 18088        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18089     END-IF
 18090
 18091     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18092
 18093     IF LIFE-FULLY-EARNED
 18094         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18095                                                CR-LCOM-L (SUB1)
 18096         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18097                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18098         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18099                                                CR-LCOM-L (SUB1)
 18100         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18101                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18102
 18103     GO TO 4350-EP-COMM-LOOP-X.
 18104
 18105 4350-EP-COMM-LOOP-A.
 18106
 18107     IF (DTE-CLIENT = 'DCC')
 18108        AND (REIN-EP-FLG = 'R')
 18109        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18110        AND (WE-AHPRM NOT = ZEROS)
 18111
 18112        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18113           COMPUTE ISS-WK ROUNDED =
 18114              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18115        ELSE
 18116           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18117           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18118              * CR-LCOM-AH (SUB1)
 18119        END-IF
 18120     ELSE
 18121        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18122                                    OR 'J' OR 'N'
 18123           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18124        ELSE
 18125           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18126             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18127              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 346
* ECS010.cbl
 18128              + CR-ADDL-CLP)
 18129           ELSE
 18130              IF (CR-AGT-TYPE (SUB1) = 'M')
 18131                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18132                              = 'G' OR 'L')
 18133                 COMPUTE ISS-WK ROUNDED =
 18134                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18135              ELSE
 18136                 IF CR-AGT-TYPE (SUB1) = 'A'
 18137                    COMPUTE ISS-WK ROUNDED =
 18138                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18139                 ELSE
 18140                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18141                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18142                                     'D')
 18143                       COMPUTE ISS-WK ROUNDED =
 18144                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18145                    ELSE
 18146                       COMPUTE ISS-WK  ROUNDED =
 18147                         ISS-PRM * CR-LCOM-AH (SUB1)
 18148                    END-IF
 18149                 END-IF
 18150              END-IF
 18151           END-IF
 18152        END-IF
 18153     END-IF
 18154
 18155     COMPUTE EW-ISS-COM (SUB16) =
 18156             EW-ISS-COM (SUB16) + ISS-WK.
 18157
 18158     MOVE ZEROS                  TO CNC-WK
 18159     IF DTE-CLIENT EQUAL 'XXX'
 18160         IF NOT CR-NO-LF-CHARGEBACK
 18161           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18162           COMPUTE EW-CNC-COM (SUB16) =
 18163                   EW-CNC-COM (SUB16) + CNC-WK
 18164           GO TO 4300-CONTINUE-LOOP-AH.
 18165
 18166     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18167        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18168        EVALUATE TRUE
 18169           WHEN DTE-CLIENT = 'DCC'
 18170             AND (REIN-EP-FLG = 'R')
 18171             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18172             AND (WE-AHRFND NOT = ZEROS)
 18173             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18174                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18175                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18176                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18177             ELSE
 18178                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18179                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18180                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18181             END-IF
 18182           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18183             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18184             AND (CNC-PRM > +0)
 18185             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 347
* ECS010.cbl
 18186           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18187             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18188             AND (CNC-PRM > +0)
 18189             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18190           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18191                              OR 'L' OR 'J' OR 'K')
 18192             AND (CNC-PRM > +0)
 18193             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18194             IF CR-CANCEL-REASON = 'R'
 18195                MOVE 1             TO CNC-FACT
 18196             END-IF
 18197             COMPUTE CNC-WK = CNC-FACT *
 18198                (CR-LCOM-AH (SUB1) * +1000)
 18199
 18200           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18201             AND (CNC-PRM > +0)
 18202             AND (CNC-PRM = ISS-PRM)
 18203             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18204
 18205           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18206             AND (CNC-PRM > +0)
 18207             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18208           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18209              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18210                              = 'G' OR 'L')
 18211              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18212              COMPUTE CNC-WK = CNC-FACT *
 18213                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18214           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18215              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18216              IF (CR-CANCEL-REASON = 'R')
 18217                 AND (CNC-PRM > +0)
 18218                 MOVE +1      TO CNC-FACT
 18219              END-IF
 18220              COMPUTE CNC-WK = CNC-FACT *
 18221              (CR-AHPRM - (CR-LFPRM-ALT
 18222                 + CR-ADDL-CLP))
 18223           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18224                      OR
 18225              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18226               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18227               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18228               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18229                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18230            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18231                      CNC-PRM * CR-LCOM-AH (SUB1)
 18232        END-EVALUATE
 18233        COMPUTE EW-CNC-COM (SUB16) =
 18234           EW-CNC-COM (SUB16) + CNC-WK
 18235     END-IF
 18236
 18237     if (ws-dcc-cnc-flag = 'Y')
 18238        and (rein-ep-flg not = 'R')
 18239        move cnc-wk              to dx-a-pc (sub1)
 18240     end-if
 18241
 18242*      IF (DTE-CLIENT = 'DCC')
 18243*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 348
* ECS010.cbl
 18244*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18245*         AND (WE-AHRFND NOT = ZEROS)
 18246*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18247*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18248*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18249*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18250*         ELSE
 18251*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18252*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18253*            * CR-LCOM-AH (SUB1)
 18254*         END-IF
 18255*      ELSE
 18256*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18257*                              OR 'L' OR 'J' OR 'K')
 18258*           AND (CNC-PRM > +0)
 18259*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18260*           IF CR-CANCEL-REASON = 'R'
 18261*              MOVE 1             TO CNC-FACT
 18262*           END-IF
 18263*           COMPUTE CNC-WK = CNC-FACT *
 18264*              (CR-LCOM-AH (SUB1) * +1000)
 18265*        ELSE
 18266*          IF CR-AGT-TYPE (SUB1) = 'N'
 18267*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18268*                                 THRU 4380-EXIT
 18269**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18270**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18271**            IF CNC-PRM NOT = ISS-PRM
 18272**               COMPUTE CNC-WK = CNC-FACT *
 18273**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18274**            ELSE
 18275**               COMPUTE CNC-WK = CNC-FACT *
 18276**               (CR-LCOM-AH (SUB1) * +1000)
 18277**            END-IF
 18278*          ELSE
 18279*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18280*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18281*                              = 'G' OR 'L')
 18282*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18283*              COMPUTE CNC-WK = CNC-FACT *
 18284*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18285*           ELSE
 18286*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18287*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18288*                 IF CR-CANCEL-REASON = 'R'
 18289*                    MOVE +1      TO CNC-FACT
 18290*                 END-IF
 18291*                 COMPUTE CNC-WK = CNC-FACT *
 18292*                 (CR-AHPRM - (CR-LFPRM-ALT
 18293*                    + CR-ADDL-CLP))
 18294*              ELSE
 18295*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18296*                           OR
 18297*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18298*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18299*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18300*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18301*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 349
* ECS010.cbl
 18302*                 ELSE
 18303*                    COMPUTE CNC-WK  ROUNDED =
 18304*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18305*                 END-IF
 18306*              END-IF
 18307*           END-IF
 18308*          END-IF
 18309*        END-IF
 18310**       END-IF
 18311*      END-IF
 18312*        COMPUTE EW-CNC-COM (SUB16) =
 18313*           EW-CNC-COM (SUB16) + CNC-WK
 18314*     END-IF
 18315
 18316     .
 18317 4300-CONTINUE-LOOP-AH.
 18318
 18319     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18320        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18321        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18322        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18323        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18324           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18325        END-IF
 18326     END-IF
 18327
 18328*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18329     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18330                OR
 18331        ((ISS-WK - CNC-WK) = ZEROS)
 18332        MOVE ZEROS          TO COMM-WK
 18333     ELSE
 18334        COMPUTE EC-FACT ROUNDED =
 18335           EPR-R78 / (ISS-PRM - CNC-PRM)
 18336        IF WS-DDF-AH-CB (SUB1) = 'N'
 18337           MOVE ISS-WK           TO COMM-WK
 18338        ELSE
 18339           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18340        END-IF
 18341     END-IF
 18342
 18343     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18344
 18345     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18346                OR
 18347        ((ISS-WK - CNC-WK) = ZEROS)
 18348        MOVE ZEROS          TO COMM-WK
 18349     ELSE
 18350        COMPUTE EC-FACT ROUNDED =
 18351           EPR-PRO / (ISS-PRM - CNC-PRM)
 18352        IF WS-DDF-AH-CB (SUB1) = 'N'
 18353           MOVE ISS-WK           TO COMM-WK
 18354        ELSE
 18355           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18356        END-IF
 18357     END-IF
 18358
 18359     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 350
* ECS010.cbl
 18360
 18361     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18362                OR
 18363        ((ISS-WK - CNC-WK) = ZEROS)
 18364        MOVE ZEROS          TO COMM-WK
 18365     ELSE
 18366        EVALUATE TRUE
 18367           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18368              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18369                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18370                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18371           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18372             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18373              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18374           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18375              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18376              MOVE ISS-WK TO COMM-WK
 18377           WHEN OTHER
 18378              COMPUTE EC-FACT ROUNDED =
 18379                EPR-ST / (ISS-PRM - CNC-PRM)
 18380              COMPUTE COMM-WK ROUNDED = EC-FACT
 18381                 * (ISS-WK - CNC-WK)
 18382        END-EVALUATE
 18383     END-IF
 18384
 18385     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18386
 18387     IF A-H-FULLY-EARNED
 18388         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18389                                                CR-LCOM-AH (SUB1)
 18390         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18391                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18392         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18393                                                CR-LCOM-AH (SUB1)
 18394         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18395                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18396
 18397 4350-EP-COMM-LOOP-X.
 18398     EXIT.
 18399
 18400******************************************************************
 18401***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18402******************************************************************
 18403
 18404 4375-EP-BANK-COMM.
 18405*     DISPLAY ' 4375 '
 18406
 18407     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18408        GO TO 4375-EXIT
 18409     END-IF
 18410     .
 18411 4375-BANK-LOOP.
 18412
 18413     ADD +1                      TO SUB16
 18414
 18415     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18416        GO TO 4375-EXIT
 18417     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 351
* ECS010.cbl
 18418
 18419     IF SUB16 GREATER THAN WS-LOOP-MAX
 18420         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18421         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18422         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18423                                     TO WS-ABEND-MESSAGE
 18424         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18425         MOVE 4001                   TO WS-ABEND-CODE
 18426         PERFORM ABEND-PGM
 18427     END-IF
 18428
 18429     IF EW-AGT-NO (SUB16) = SPACES
 18430        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18431        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18432     ELSE
 18433        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18434           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18435           CONTINUE
 18436        ELSE
 18437           GO TO 4375-BANK-LOOP
 18438        END-IF
 18439     END-IF
 18440
 18441     IF CS-COM-TYP  (SUB1) = 'B'
 18442        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18443     END-IF
 18444
 18445     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18446
 18447     MOVE ZEROS                  TO CNC-WK
 18448                                    CNC-FACT
 18449
 18450     IF (CS-COM-TYP (SUB1) = 'B')
 18451        AND (CNC-PRM > +0)
 18452        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18453        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18454     END-IF
 18455
 18456     COMPUTE EW-CNC-COM (SUB16) =
 18457                  EW-CNC-COM (SUB16) + CNC-WK
 18458
 18459     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18460                OR
 18461        ((ISS-WK - CNC-WK) = ZEROS)
 18462        MOVE ZEROS          TO COMM-WK
 18463     ELSE
 18464        COMPUTE EC-FACT ROUNDED =
 18465           EPR-R78 / (ISS-PRM - CNC-PRM)
 18466        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18467     END-IF
 18468
 18469     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18470
 18471     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18472                OR
 18473        ((ISS-WK - CNC-WK) = ZEROS)
 18474        MOVE ZEROS          TO COMM-WK
 18475     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 352
* ECS010.cbl
 18476        COMPUTE EC-FACT ROUNDED =
 18477           EPR-PRO / (ISS-PRM - CNC-PRM)
 18478        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18479     END-IF
 18480
 18481     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18482
 18483     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18484                OR
 18485        ((ISS-WK - CNC-WK) = ZEROS)
 18486        MOVE ZEROS          TO COMM-WK
 18487     ELSE
 18488        COMPUTE EC-FACT ROUNDED =
 18489           EPR-ST / (ISS-PRM - CNC-PRM)
 18490        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18491     END-IF
 18492
 18493     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18494
 18495     IF A-H-FULLY-EARNED
 18496        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18497        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18498                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18499        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18500                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18501     END-IF
 18502
 18503     .
 18504 4375-EXIT.
 18505     EXIT.
 18506
 18507
 18508 4376-DCC-DDF-SPEC.
 18509
 18510     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18511                                 THRU 4910-EXIT
 18512
 18513     display ' acct - cert ' cr-account ' ' cr-cert-no
 18514     display ' orig term rem term ' orig-term ' ' rem-trm1
 18515     display ' agt type ' cr-agt-type (sub1)
 18516     COMPUTE CP-MONTH =
 18517        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18518     IF CP-MONTH = 0
 18519        MOVE 12 TO CP-MONTH
 18520     END-IF
 18521
 18522     EVALUATE TRUE
 18523        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18524           PERFORM 4380-REF-CSO-ADMIN-FEE
 18525                                 THRU 4380-EXIT
 18526        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18527           AND (CR-CANCEL-REASON = 'R')
 18528              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18529        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18530           EVALUATE TRUE
 18531              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18532                 OR (NOT DD-IU-PRESENT)
 18533                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 353
* ECS010.cbl
 18534                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18535                       / CR-AH-CLP
 18536                 end-if
 18537                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18538                    (CR-LCOM-AH (SUB1) * +1000)
 18539               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18540                  AND (DD-IU-PRESENT)
 18541                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18542                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18543                     WS-LO-UEF) * 3/12
 18544                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18545                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18546                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18547                    (CR-LCOM-AH (SUB1) * +1000)
 18548                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18549                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18550                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18551                     * (CP-MONTH - 3) / 9
 18552              WHEN (ORIG-TERM - REM-TRM1) > 12
 18553                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18554                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18555                    CP-MONTH / 12)
 18556           END-EVALUATE
 18557        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18558           EVALUATE TRUE
 18559              WHEN CR-CANCEL-REASON = 'R'
 18560                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18561                    + CR-ADDL-CLP))
 18562              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18563                 OR (NOT DD-IU-PRESENT)
 18564                   if ueclp-clp-fact = zeros
 18565                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18566                       / CR-AH-CLP
 18567                   end-if
 18568                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18569                       (CR-AHPRM - (CR-AH-CLP
 18570                       + CR-ADDL-CLP))
 18571              WHEN (ORIG-TERM - REM-TRM1) < 13
 18572                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18573                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18574                     WS-LO-UEF) * 3/12
 18575                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18576                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18577                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18578                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18579                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18580                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18581                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18582                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18583              WHEN (ORIG-TERM - REM-TRM1) > 12
 18584                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18585                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18586                    WS-LO-UEF) * CP-MONTH / 12)
 18587           END-EVALUATE
 18588     END-EVALUATE
 18589
 18590     .
 18591 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 354
* ECS010.cbl
 18592     EXIT.
 18593
 18594
 18595
 18596 4380-REF-CSO-ADMIN-FEE.
 18597
 18598*    IF CR-AH-CANC-DT NOT = ZEROS
 18599*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18600*       MOVE CR-AH-TERM          TO ORIG-TERM
 18601*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18602*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18603*       MOVE '1'                 TO W-VAL-SOURCE
 18604*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18605*                                THRU 8599-REM-TERM-X
 18606*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18607*    END-IF
 18608
 18609     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18610                                 THRU 4910-EXIT
 18611
 18612     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18613        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18614
 18615     MOVE ZEROS                  TO CNC-WK
 18616
 18617     EVALUATE TRUE
 18618        WHEN (REM-TRM1 = 0)
 18619           OR (CR-CANCEL-REASON = 'R')
 18620           DISPLAY ' REM TERM = 0 OR REPO'
 18621           MOVE 0                TO CNC-WK
 18622
 18623        WHEN REM-TRM1 = ORIG-TERM
 18624           DISPLAY ' REM TERM  = ORIG TERM '
 18625           MOVE ISS-WK           TO CNC-WK
 18626
 18627        WHEN (ORIG-TERM - REM-TRM1) < 4
 18628           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18629           COMPUTE CP-MONTH =
 18630              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18631           IF CP-MONTH = 0
 18632              MOVE 12 TO CP-MONTH
 18633           END-IF
 18634           DISPLAY ' CP MONTH ' CP-MONTH
 18635           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18636              (DD-1ST-YR-ALLOW (D1)
 18637              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18638              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18639           COMPUTE CNC-WK = W-FACTOR * 1
 18640
 18641**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18642
 18643        WHEN (ORIG-TERM - REM-TRM1) < 13
 18644           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18645           COMPUTE CP-MONTH =
 18646              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18647           IF CP-MONTH = 0
 18648              MOVE 12 TO CP-MONTH
 18649           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 355
* ECS010.cbl
 18650           DISPLAY ' CP MONTH ' CP-MONTH
 18651           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18652              DD-1ST-YR-ALLOW (D1))
 18653              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18654              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18655           COMPUTE CNC-WK = W-FACTOR * 1
 18656
 18657****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18658
 18659        WHEN OTHER
 18660           DISPLAY ' OTHER '
 18661           COMPUTE CP-MONTH =
 18662              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18663           IF CP-MONTH = 0
 18664              MOVE 12 TO CP-MONTH
 18665           END-IF
 18666           DISPLAY ' CP MONTH ' CP-MONTH
 18667           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18668              DD-1ST-YR-ALLOW (D1))
 18669              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18670              * CP-MONTH / 12)
 18671           COMPUTE CNC-WK = W-FACTOR * 1
 18672     END-EVALUATE
 18673
 18674     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18675        ' ' CNC-WK
 18676
 18677     .
 18678 4380-EXIT.
 18679     EXIT.
 18680
 18681******************************************************************
 18682******************************************************************
 18683******************************************************************
 18684******************************************************************
 18685******************************************************************
 18686******************************************************************
 18687******************************************************************
 18688******************************************************************
 18689******************************************************************
 18690******************************************************************
 18691***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18692******************************************************************
 18693
 18694 S-4100-EP-DO-LF.
 18695
 18696     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18697                                        EPR-PRO
 18698                                        EPR-ST.
 18699
 18700     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18701     MOVE 'L'                    TO DC-OPTION-CODE.
 18702     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18703
 18704     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18705     MOVE -1                     TO DC-ELAPSED-DAYS.
 18706     MOVE '6'                    TO DC-OPTION-CODE.
 18707     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 356
* ECS010.cbl
 18708
 18709     MOVE +0                     TO DC-ELAPSED-MONTHS
 18710                                    DC-ELAPSED-DAYS.
 18711
 18712     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18713     MOVE ' '                    TO DC-OPTION-CODE.
 18714     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18715
 18716     IF NO-CONVERSION-ERROR
 18717        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18718     ELSE
 18719         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18720                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18721                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18722         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18723                                     TO WS-ABEND-MESSAGE
 18724         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18725         MOVE 4001                   TO WS-ABEND-CODE
 18726         GO TO ABEND-PGM.
 18727
 18728     IF CR-LFTYP = ZERO
 18729         GO TO S-4200-EP-DO-AH.
 18730
 18731     IF REIN-LF-FLG (SUB5) = SPACE
 18732         GO TO S-4200-EP-DO-AH.
 18733
 18734     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18735     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18736     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18737
 18738     MOVE CR-LF-TERM             TO ORIG-TERM.
 18739     MOVE CLAS-INDEXL            TO W-NDX.
 18740
 18741 S-4120-EP-DO-LF-CNCL.
 18742
 18743     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18744        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18745         GO TO S-4130-EP-DO-LF-EP.
 18746
 18747     COMPUTE EARNED-BY-CANCEL =
 18748                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18749
 18750 S-4130-EP-DO-LF-EP.
 18751
 18752     MOVE SPACE                  TO STATUTORY-SWITCH.
 18753
 18754     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18755     MOVE '9'                    TO W-VAL-SOURCE.
 18756     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18757
 18758     IF REM-TRM2 GREATER CR-LF-TERM
 18759         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18760         GO TO S-4190-EP-DO-LF-COMM.
 18761
 18762     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18763         GO TO S-4180-EP-DO-LF-EP-SUM.
 18764
 18765     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 357
* ECS010.cbl
 18766         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18767             IF REM-TRM2 NOT GREATER THAN +0
 18768                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18769                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18770                 GO TO S-4190-EP-DO-LF-COMM
 18771             ELSE
 18772                 NEXT SENTENCE
 18773         ELSE
 18774             IF W-BAL-REMTRM NOT GREATER +0
 18775                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18776                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18777                 GO TO S-4190-EP-DO-LF-COMM
 18778             ELSE
 18779                 NEXT SENTENCE
 18780     ELSE
 18781        IF (DTE-CLIENT EQUAL 'NCL') AND
 18782           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18783             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18784        ELSE
 18785         IF REM-TRM2 NOT GREATER +0  OR
 18786            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18787             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18788             GO TO S-4190-EP-DO-LF-COMM.
 18789
 18790     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18791         GO TO S-4140-EP-DO-LF-EP-TEX.
 18792
 18793     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18794         GO TO S-4150-EP-DO-LF-EP-NP.
 18795
 18796*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18797     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18798        (CR-RATING-CLASS NOT = 'L ')
 18799         IF (CR-APR GREATER THAN ZERO)  AND
 18800            (CR-LF-TERM GREATER THAN 060)  AND
 18801            (CR-DT GREATER THAN 19831031)
 18802             MOVE '*'             TO STATUTORY-SWITCH
 18803              GO TO S-4150-EP-DO-LF-EP-NP.
 18804
 18805     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18806         IF (CR-APR GREATER THAN ZERO)  AND
 18807            (CR-LF-TERM GREATER THAN 061)  AND
 18808            (CR-DT GREATER THAN 19830318)
 18809             MOVE '*'             TO STATUTORY-SWITCH
 18810              GO TO S-4150-EP-DO-LF-EP-NP.
 18811
 18812     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18813         IF (CR-APR GREATER THAN ZERO)  AND
 18814            (CR-LF-TERM GREATER THAN 062)  AND
 18815            (CR-DT GREATER THAN 19810831)  AND
 18816            (CR-DT LESS THAN 19830901)
 18817             MOVE '*'             TO STATUTORY-SWITCH
 18818              GO TO S-4150-EP-DO-LF-EP-NP.
 18819
 18820     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18821         IF (CR-APR GREATER THAN ZERO)  AND
 18822            (CR-LF-TERM GREATER THAN 060)  AND
 18823            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 358
* ECS010.cbl
 18824             MOVE '*'             TO STATUTORY-SWITCH
 18825              GO TO S-4150-EP-DO-LF-EP-NP.
 18826
 18827     GO TO S-4160-EP-DO-LF-EP-R78.
 18828
 18829 S-4140-EP-DO-LF-EP-TEX.
 18830
 18831     COMPUTE TEX-FACT-4 =
 18832         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18833     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18834         GIVING TEX-FACT-5
 18835             REMAINDER TEX-FACT-6.
 18836     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18837     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18838         (TEX-FACT-5 * CR-PMT-FREQ) +
 18839         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18840     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18841
 18842     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18843
 18844     GO TO S-4170-EP-DO-LF-EP-PRO.
 18845
 18846 S-4150-EP-DO-LF-EP-NP.
 18847
 18848     IF WE-LFPRM = ZERO
 18849         GO TO S-4160-EP-DO-LF-EP-R78.
 18850
 18851     IF DTE-CLIENT = 'CRI'
 18852       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18853             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18854           GO TO S-4160-EP-DO-LF-EP-R78.
 18855
 18856     IF DTE-CLIENT = 'NCL'
 18857       IF CR-DT LESS THAN 19910101
 18858           GO TO S-4160-EP-DO-LF-EP-R78.
 18859
 18860     IF REM-TRM1 = CR-LF-TERM
 18861         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18862         GO TO S-4190-EP-DO-LF-COMM.
 18863
 18864     MOVE CR-APR TO NP-APR.
 18865     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18866     MOVE REM-TRM1 TO NP-REM.
 18867     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18868     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18869         MOVE CR-LOAN-TERM TO NP-ORIG.
 18870     MOVE 'R' TO NP-OPT.
 18871     CALL 'ECSNETRM'
 18872         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18873
 18874     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18875
 18876     IF STATUTORY-REQUIREMENT
 18877         MOVE EPR-R78                TO EPR-ST.
 18878
 18879 S-4160-EP-DO-LF-EP-R78.
 18880
 18881     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 359
* ECS010.cbl
 18882        (DTE-CLIENT EQUAL 'NCL')
 18883        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18884           (CR-MO EQUAL EOM-MO)
 18885           MOVE '*'            TO OB-DATE-1-SWITCH
 18886           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18887           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18888           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18889           COMPUTE WS-EPR-R78 (SUB3 1) =
 18890                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18891           GO TO S-4190-EP-DO-LF-COMM
 18892        ELSE
 18893        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18894           (CR-MO EQUAL OB-MO (1))
 18895           MOVE '*'            TO OB-DATE-2-SWITCH
 18896           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18897           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18898           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18899           COMPUTE WS-EPR-R78 (SUB3 2) =
 18900                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 18901           GO TO S-4190-EP-DO-LF-COMM
 18902        ELSE
 18903        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18904           (CR-MO EQUAL OB-MO (2))
 18905           MOVE '*'            TO OB-DATE-3-SWITCH
 18906           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18907           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18908           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18909           COMPUTE WS-EPR-R78 (SUB3 3) =
 18910                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 18911           GO TO S-4190-EP-DO-LF-COMM
 18912        ELSE
 18913           GO TO S-4190-EP-DO-LF-COMM.
 18914
 18915     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 18916
 18917     IF DTE-R78 = '1'
 18918         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 18919     ELSE
 18920         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18921
 18922     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18923
 18924     IF REM-TRM1 GREATER THAN +0
 18925         COMPUTE TEMP-7 ROUNDED EQUAL
 18926             WE-LFPRM - (WE-LFPRM * TEMP-4)
 18927     ELSE
 18928         MOVE WE-LFPRM                TO TEMP-7.
 18929
 18930     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 18931         MOVE TEMP-7                 TO EPR-ST.
 18932
 18933     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18934         MOVE ZEROS                  TO TEMP-8
 18935         GO TO S-4165-END-LF-EP-R78.
 18936
 18937     IF EPR-ST NOT = ZEROS
 18938         MOVE TEMP-7                 TO EPR-ST.
 18939
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 360
* ECS010.cbl
 18940     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18941         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 18942         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 18943         IF DTE-R78 = '1'
 18944             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 18945
 18946     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18947
 18948     COMPUTE TEMP-8 ROUNDED =
 18949               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 18950
 18951 S-4165-END-LF-EP-R78.
 18952
 18953     IF EPR-R78 = ZEROS
 18954         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 18955     ELSE
 18956         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 18957
 18958 S-4170-EP-DO-LF-EP-PRO.
 18959
 18960     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18961         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 18962     ELSE
 18963         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 18964
 18965     IF REM-TRM1 GREATER THAN +0
 18966         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 18967     ELSE
 18968         MOVE WE-LFPRM                  TO TEMP-7.
 18969
 18970     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18971         MOVE ZEROS                     TO TEMP-8
 18972         GO TO S-4175-END-LF-EP-PRO.
 18973
 18974     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18975         IF DTE-CLIENT = 'MIC' OR 'MCC'
 18976             COMPUTE TEMP-5 ROUNDED =
 18977                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 18978         ELSE
 18979             COMPUTE TEMP-5 ROUNDED =
 18980                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 18981
 18982     COMPUTE TEMP-8 ROUNDED =
 18983                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 18984
 18985     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 18986
 18987 S-4175-END-LF-EP-PRO.
 18988
 18989     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 18990
 18991     GO TO S-4185-EP-DO-LF-STATUTORY.
 18992
 18993 S-4180-EP-DO-LF-EP-SUM.
 18994
 18995     IF REM-TRM1 NOT GREATER +0
 18996         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 18997         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 361
* ECS010.cbl
 18998         GO TO S-4190-EP-DO-LF-COMM.
 18999
 19000     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19001         MOVE ZEROS                 TO TEMP-7
 19002     ELSE
 19003         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19004                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19005
 19006     IF TEMP-7 NOT GREATER ZERO
 19007         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19008             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19009             GO TO S-4190-EP-DO-LF-COMM
 19010         ELSE
 19011             MOVE ZEROS             TO TEMP-7.
 19012
 19013     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19014     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19015     IF DTE-R78 = '1'
 19016         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19017
 19018     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19019     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19020
 19021     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19022
 19023     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19024
 19025     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19026         GO TO S-4185-EP-DO-LF-STATUTORY.
 19027
 19028     MOVE EPR-R78                  TO EPR-ST.
 19029
 19030     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19031         MOVE ZEROS                 TO TEMP-8
 19032     ELSE
 19033         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19034                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19035
 19036     IF TEMP-8 NOT GREATER ZERO
 19037         GO TO S-4185-EP-DO-LF-STATUTORY.
 19038
 19039     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19040                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19041
 19042     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19043                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19044
 19045     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19046                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19047
 19048 S-4185-EP-DO-LF-STATUTORY.
 19049
 19050*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19051*08473          MOVE EPR-R78                TO EPR-ST.
 19052
 19053     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19054         MOVE EPR-PRO                TO EPR-ST.
 19055
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 362
* ECS010.cbl
 19056     IF (DTE-CLIENT = 'CID') AND
 19057        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19058        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19059        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19060           GO TO S-4187-EP-DO-LF-STAT-ROA
 19061     END-IF.
 19062
 19063     IF EPR-ST NOT = ZEROS
 19064         GO TO S-4190-EP-DO-LF-COMM.
 19065
 19066     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19067         MOVE EPR-R78                TO EPR-ST
 19068     ELSE
 19069         MOVE EPR-PRO                TO EPR-ST.
 19070
 19071     GO TO S-4190-EP-DO-LF-COMM.
 19072
 19073 S-4187-EP-DO-LF-STAT-ROA.
 19074     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19075     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19076     MOVE 'L'                        TO DC-OPTION-CODE.
 19077     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19078     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19079     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19080        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19081        MOVE '3'                 TO  DC-OPTION-CODE
 19082        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19083                              8099-DATE-CONVERT-X
 19084        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19085     ELSE
 19086        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19087        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19088        MOVE +0                  TO  DC-ELAPSED-DAYS
 19089        MOVE '6'                 TO  DC-OPTION-CODE
 19090        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19091                              8099-DATE-CONVERT-X
 19092        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19093     END-IF
 19094     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19095     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19096     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19097     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19098     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19099     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19100     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19101     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19102     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19103     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19104                                        CP-LOAN-TERM.
 19105     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19106                                        CP-RATING-BENEFIT-AMT.
 19107     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19108         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19109     ELSE
 19110         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19111     END-IF.
 19112     MOVE CR-APR                     TO CP-LOAN-APR.
 19113     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 363
* ECS010.cbl
 19114     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19115     MOVE '6'                        TO CP-EARNING-METHOD.
 19116     MOVE '3'                        TO CP-PROCESS-TYPE.
 19117     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19118     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19119         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19120     ELSE
 19121         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19122     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19123     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19124     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19125     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19126     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19127     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19128
 19129
 19130     IF CP-STATE-STD-ABBRV = 'OR'
 19131        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19132     END-IF
 19133
 19134     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19135        COMPUTE CP-ORIGINAL-BENEFIT =
 19136         (CR-LFAMT - CR-LFPRM)
 19137     END-IF
 19138
 19139     IF CP-TRUNCATED-LIFE
 19140        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19141     END-IF
 19142
 19143     IF CP-TERM-IS-DAYS
 19144        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19145     ELSE
 19146        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19147     END-IF
 19148
 19149     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19150
 19151     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19152
 19153 S-4190-EP-DO-LF-COMM.
 19154
 19155     IF EARNED-BY-CANCEL = ZEROS
 19156         GO TO S-4195-LF-COMM-CONTINUE.
 19157
 19158     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19159         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19160
 19161     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19162         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19163
 19164     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19165         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19166
 19167 S-4195-LF-COMM-CONTINUE.
 19168
 19169     MOVE +0 TO SUB1.
 19170     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19171         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 364
* ECS010.cbl
 19172
 19173     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19174     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19175     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19176
 19177     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19178     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19179     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19180
 19181     MOVE 'Y'          TO EW-LEVEL-USED.
 19182
 19183     IF CR-POLICY-UNDERWRITTEN
 19184         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19185
 19186     ELSE
 19187         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19188
 19189     GO TO S-4200-EP-DO-AH.
 19190
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 365
* ECS010.cbl
 19192******************************************************************
 19193***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19194******************************************************************
 19195
 19196 S-4200-EP-DO-AH.
 19197
 19198     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19199                                        EPR-PRO
 19200                                        EPR-ST.
 19201
 19202     IF CR-AHTYP = ZERO
 19203         GO TO S-4299-EPBX.
 19204
 19205     IF REIN-AH-FLG (SUB5) = SPACE
 19206         GO TO S-4299-EPBX.
 19207
 19208     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19209     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19210     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19211
 19212     MOVE CR-AH-TERM           TO ORIG-TERM.
 19213     MOVE CLAS-INDEXA          TO W-NDX.
 19214
 19215     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19216     MOVE '9'                    TO W-VAL-SOURCE.
 19217     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19218
 19219 S-4220-EP-DO-AH-CNCL.
 19220
 19221     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19222         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19223
 19224 S-4230-EP-DO-AH-EP.
 19225
 19226     IF REM-TRM2 GREATER CR-AH-TERM
 19227         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19228         GO TO S-4290-EP-DO-AH-COMM.
 19229
 19230     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19231         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19232
 19233 S-4235-CHECK-OB-AH-NCL.
 19234
 19235     IF (DTE-CLIENT EQUAL 'NCL') AND
 19236        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19237           MOVE WE-AHPRM         TO EPR-R78
 19238                                    EPR-PRO
 19239                                    EPR-ST
 19240        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19241           (CR-MO EQUAL EOM-MO)
 19242           MOVE '*'            TO OB-DATE-1-SWITCH
 19243           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19244           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19245           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19246           COMPUTE WS-EPR-R78 (SUB3 1) =
 19247                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19248            GO TO S-4290-EP-DO-AH-COMM
 19249        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 366
* ECS010.cbl
 19250        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19251           (CR-MO EQUAL OB-MO (1))
 19252           MOVE '*'            TO OB-DATE-2-SWITCH
 19253           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19254           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19255           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19256           COMPUTE WS-EPR-R78 (SUB3 2) =
 19257                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19258            GO TO S-4290-EP-DO-AH-COMM
 19259        ELSE
 19260        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19261           (CR-MO EQUAL OB-MO (2))
 19262           MOVE '*'            TO OB-DATE-3-SWITCH
 19263           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19264           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19265           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19266           COMPUTE WS-EPR-R78 (SUB3 3) =
 19267                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19268            GO TO S-4290-EP-DO-AH-COMM
 19269        ELSE
 19270            GO TO S-4290-EP-DO-AH-COMM.
 19271
 19272     IF REM-TRM2 NOT GREATER +0
 19273         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19274         GO TO S-4290-EP-DO-AH-COMM.
 19275
 19276     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19277         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19278         GO TO S-4290-EP-DO-AH-COMM.
 19279
 19280     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19281     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19282     IF DTE-R78 = '1'
 19283         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19284     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19285
 19286     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19287         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19288     ELSE
 19289         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19290
 19291     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19292     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19293
 19294     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19295     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19296
 19297     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19298
 19299*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19300*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19301
 19302     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19303
 19304     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19305        (CR-DT GREATER THAN  19921231)
 19306         IF CR-AH-TERM GREATER THAN  +61
 19307             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 367
* ECS010.cbl
 19308             MOVE '*' TO STATUTORY-SWITCH-AH
 19309             GO TO S-4245-EP-DO-AH-EP-AN
 19310         ELSE
 19311             GO TO S-4250-EP-DO-AH-STATUTORY.
 19312
 19313     IF AH-EARN-METHOD EQUAL 'N'
 19314         GO TO S-4240-EP-DO-AH-EP-NP.
 19315
 19316     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19317         MOVE 'A' TO AH-EARN-METHOD
 19318         GO TO S-4245-EP-DO-AH-EP-AN.
 19319
 19320     GO TO S-4250-EP-DO-AH-STATUTORY.
 19321
 19322 S-4240-EP-DO-AH-EP-NP.
 19323
 19324     IF WE-AHPRM = ZERO
 19325         GO TO S-4250-EP-DO-AH-STATUTORY.
 19326
 19327     IF CR-APR GREATER THAN +0
 19328         NEXT SENTENCE
 19329     ELSE
 19330         GO TO S-4250-EP-DO-AH-STATUTORY.
 19331
 19332     IF DTE-CLIENT = 'NCL'
 19333       IF CR-DT LESS THAN 19910101
 19334           GO TO S-4250-EP-DO-AH-STATUTORY.
 19335
 19336     IF REM-TRM1 = CR-AH-TERM
 19337         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19338         GO TO S-4290-EP-DO-AH-COMM.
 19339
 19340     MOVE CR-APR TO NP-APR.
 19341     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19342     MOVE REM-TRM1 TO NP-REM.
 19343     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19344     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19345         MOVE CR-LOAN-TERM TO NP-ORIG.
 19346     MOVE 'R' TO NP-OPT.
 19347     CALL 'ECSNETRM'
 19348         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19349
 19350     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19351
 19352     GO TO S-4250-EP-DO-AH-STATUTORY.
 19353
 19354 S-4245-EP-DO-AH-EP-AN.
 19355     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19356     MOVE 'L'                        TO DC-OPTION-CODE.
 19357     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19358     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19359     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19360     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19361     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19362     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19363     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19364     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19365     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 368
* ECS010.cbl
 19366     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19367                                        CP-RATING-BENEFIT-AMT.
 19368     IF CP-STATE-STD-ABBRV = 'OR'
 19369         COMPUTE CP-RATING-BENEFIT-AMT =
 19370                                  CR-AHAMT * REM-TRM1.
 19371     MOVE CR-APR                     TO CP-LOAN-APR.
 19372     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19373     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19374     MOVE '3'                        TO CP-PROCESS-TYPE.
 19375     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19376     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19377
 19378     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19379         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19380     ELSE
 19381         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19382
 19383     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19384     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19385     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19386     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19387     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19388     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19389
 19390     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19391
 19392     IF CP-ERROR-RATE-NOT-FOUND  OR
 19393        CP-ERROR-RATE-IS-ZERO  OR
 19394        CP-ERROR-IN-DATES
 19395         GO TO S-4250-EP-DO-AH-STATUTORY.
 19396
 19397     COMPUTE EPR-R78 ROUNDED =
 19398             (REM-TRM1 * WE-AHAMT / +100 *
 19399               CP-PREMIUM-RATE)
 19400              / CR-AHPRM-CALC * CR-AHPRM
 19401
 19402     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19403
 19404     IF STATUTORY-REQUIREMENT-AH
 19405         MOVE EPR-R78                TO EPR-ST
 19406         GO TO S-4290-EP-DO-AH-COMM.
 19407
 19408 S-4250-EP-DO-AH-STATUTORY.
 19409     IF (DTE-CLIENT EQUAL 'CID') AND
 19410        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19411         GO TO S-4267-EP-DO-AH-STAT-ROA
 19412     END-IF.
 19413
 19414 S-4250-EP-DO-AH-STATUTORY-VA.
 19415
 19416     MOVE EPR-R78                    TO EPR-ST.
 19417
 19418     MOVE +0                         TO SUB1.
 19419
 19420 S-4255-EP-AH-STAT-LOOP.
 19421     ADD +1 TO SUB1.
 19422
 19423     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 369
* ECS010.cbl
 19424         MOVE EPR-PRO                TO EPR-ST
 19425     ELSE
 19426         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19427             GO TO S-4255-EP-AH-STAT-LOOP.
 19428
 19429     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19430         CR-DT GREATER THAN 19831031)
 19431                    OR
 19432        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19433         CR-DT GREATER THAN 19820629)
 19434                    OR
 19435        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19436         CR-DT GREATER THAN 19830831)
 19437             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19438
 19439     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19440       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19441         IF CR-DT LESS THAN 19970101
 19442             MOVE EPR-R78            TO EPR-ST
 19443         ELSE
 19444             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19445
 19446     GO TO S-4290-EP-DO-AH-COMM.
 19447
 19448 S-4267-EP-DO-AH-STAT-ROA.
 19449     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19450     MOVE 'L'                        TO DC-OPTION-CODE.
 19451     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19452     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19453     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19454     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19455     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19456     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19457     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19458     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19459     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19460     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19461                                        CP-RATING-BENEFIT-AMT.
 19462     IF CP-STATE-STD-ABBRV = 'OR'
 19463         COMPUTE CP-RATING-BENEFIT-AMT =
 19464                                  CR-AHAMT * REM-TRM1.
 19465     MOVE CR-APR                     TO CP-LOAN-APR.
 19466     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19467     MOVE 'A'                        TO CP-EARNING-METHOD.
 19468     MOVE '3'                        TO CP-PROCESS-TYPE.
 19469     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19470     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19471     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19472         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19473     ELSE
 19474         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19475     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19476     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19477     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19478     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19479     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19480     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19481
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 370
* ECS010.cbl
 19482     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19483
 19484     IF CP-ERROR-RATE-NOT-FOUND  OR
 19485        CP-ERROR-RATE-IS-ZERO  OR
 19486        CP-ERROR-IN-DATES
 19487         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19488
 19489     COMPUTE EPR-ST ROUNDED =
 19490             (REM-TRM1 * WE-AHAMT / +100 *
 19491               CP-PREMIUM-RATE)
 19492              / CR-AHPRM-CALC * CR-AHPRM
 19493
 19494     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19495
 19496     GO TO S-4290-EP-DO-AH-COMM.
 19497
 19498 S-4290-EP-DO-AH-COMM.
 19499
 19500     IF EARNED-BY-CANCEL = ZEROS
 19501         GO TO S-4295-AH-COMM-CONTINUE.
 19502
 19503     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19504         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19505
 19506     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19507         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19508
 19509     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19510         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19511
 19512 S-4295-AH-COMM-CONTINUE.
 19513
 19514     MOVE +0           TO SUB1.
 19515     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19516         10 TIMES.
 19517
 19518     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19519     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19520     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19521
 19522     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19523     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19524     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19525
 19526     MOVE 'Y'          TO EW-LEVEL-USED.
 19527
 19528     IF CR-POLICY-UNDERWRITTEN
 19529         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19530     ELSE
 19531         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19532
 19533
 19534 S-4299-EPBX.
 19535     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 371
* ECS010.cbl
 19537******************************************************************
 19538***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19539******************************************************************
 19540
 19541 S-4300-EP-COMM-LOOP.
 19542
 19543     ADD +1 TO SUB1.
 19544     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19545         GO TO S-4399-EP-COMM-LOOP-X.
 19546
 19547     IF EW-LF-AH = AH-OVERRIDE-L1
 19548         GO TO S-4350-EP-COMM-LOOP-A.
 19549
 19550*    IF CR-AGT-TYPE (SUB1) = 'K'
 19551*       COMPUTE COMM-WK =
 19552     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19553     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19554     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19555                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19556
 19557     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19558     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19559     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19560                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19561
 19562     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19563     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19564
 19565     GO TO S-4399-EP-COMM-LOOP-X.
 19566
 19567 S-4350-EP-COMM-LOOP-A.
 19568
 19569     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19570     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19571     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19572                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19573
 19574     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19575     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19576     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19577                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19578
 19579     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19580     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19581
 19582 S-4399-EP-COMM-LOOP-X.
 19583     EXIT.
 19584
 19585******************************************************************
 19586******************************************************************
 19587******************************************************************
 19588******************************************************************
 19589******************************************************************
 19590******************************************************************
 19591******************************************************************
 19592******************************************************************
 19593******************************************************************
 19594******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 372
* ECS010.cbl
 19596******************************************************************
 19597***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19598******************************************************************
 19599
 19600 4400-EP-FIND-TAB-ENT.
 19601
 19602     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19603         GO TO 4490-EP-FIND-TAB-SUB.
 19604     MOVE +1 TO SUB9.
 19605
 19606 4450-EP-FIND-TAB-LOOP.
 19607
 19608     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19609         GO TO 4490-EP-FIND-TAB-SUB.
 19610     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19611         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19612         GO TO 4490-EP-FIND-TAB-SUB.
 19613
 19614     ADD +1 TO SUB9.
 19615     IF SUB9 GREATER THAN +31
 19616         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19617         MOVE 0201 TO WS-ABEND-CODE
 19618         DISPLAY '******************************'
 19619         DISPLAY '***** ERROR LOCATION 020 *****'
 19620         DISPLAY '******************************'
 19621         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19622         GO TO ABEND-PGM.
 19623
 19624     GO TO 4450-EP-FIND-TAB-LOOP.
 19625
 19626 4490-EP-FIND-TAB-SUB.
 19627
 19628     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19629         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19630             ADD +1 TO SUB10
 19631             MOVE SUB10 TO SUB3
 19632             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19633         ELSE
 19634             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19635
 19636     IF WE-LF-AH = AH-OVERRIDE-L1
 19637         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19638             ADD +1 TO SUB10
 19639             MOVE SUB10 TO SUB3
 19640             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19641         ELSE
 19642             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19643
 19644*    IF SUB3 GREATER THAN +220
 19645*    IF SUB3 GREATER THAN +300
 19646     IF SUB3 GREATER THAN +900
 19647         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19648         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19649         MOVE 0202 TO WS-ABEND-CODE
 19650         DISPLAY '******************************'
 19651         DISPLAY '***** ERROR LOCATION 021 *****'
 19652         DISPLAY '******************************'
 19653         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 373
* ECS010.cbl
 19654         GO TO ABEND-PGM.
 19655
 19656     IF CR-POLICY-UNDERWRITTEN
 19657         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19658         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19659                                     TO EPEC-OPT-WORK-TABLE
 19660     ELSE
 19661         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19662         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19663
 19664     MOVE WE-REIN-CO         TO EW-REIN-CO
 19665                                EPEC-REIN-CO (SUB3)
 19666                                EPEC-REIN-CO-II (SUB3).
 19667     MOVE WE-LF-AH           TO EW-LF-AH
 19668                                EPEC-LF-AH (SUB3)
 19669                                EPEC-LF-AH-II (SUB3).
 19670     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19671                                EPEC-BEN-TYPE (SUB3)
 19672                                EPEC-BEN-TYPE-II (SUB3).
 19673
 19674 4499-EP-FIND-TAB-ENT-X.
 19675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 374
* ECS010.cbl
 19677******************************************************************
 19678***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19679******************************************************************
 19680
 19681 4500-BUILD-EPEC-EXTRACT.
 19682
 19683     IF (DTE-CLIENT = 'DCC')
 19684*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19685        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19686     END-IF
 19687
 19688     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19689         VARYING SUB2 FROM +1 BY +1
 19690             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19691
 19692     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19693
 19694     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19695
 19696
 19697 4510-BUILD-EPEC-EXT.
 19698
 19699     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19700     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19701     IF EW-LEVEL-USED = 'Y'
 19702         MOVE SPACE                     TO W-UNDERWRITING-SW
 19703         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19704                 4518-BUILD-EPEC-RCD-X.
 19705
 19706     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19707     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19708     IF EW-LEVEL-USED = 'Y'
 19709         MOVE '*'                       TO W-UNDERWRITING-SW
 19710         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19711                 4518-BUILD-EPEC-RCD-X.
 19712
 19713     GO TO 4519-BUILD-EPEC-EXT-X.
 19714
 19715 4511-BUILD-EPEC-RECORD.
 19716
 19717     MOVE SPACES                        TO EP-RECORD.
 19718     MOVE 'EP'                          TO EP-RECORD-ID.
 19719     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19720     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19721     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19722     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19723                                           WS-EP-EFF-DTE-N.
 19724     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19725     IF EP-REI-CO NOT = SPACES
 19726         MOVE 'R'                       TO EP-REIN.
 19727     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19728     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19729
 19730     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19731     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19732     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19733
 19734     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 375
* ECS010.cbl
 19735     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19736     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19737
 19738     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19739     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19740     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19741     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19742
 19743     IF DTE-CLIENT NOT = 'NCL'
 19744         GO TO 4512-BUILD-EPEC-CONTINUE.
 19745
 19746     IF W-UNDERWRITTEN-DATA
 19747         GO TO 4512-BUILD-EPEC-CONTINUE.
 19748
 19749     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19750         GO TO 4512-BUILD-EPEC-CONTINUE.
 19751
 19752     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19753        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19754        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19755         NEXT SENTENCE
 19756     ELSE
 19757         GO TO 4512-BUILD-EPEC-CONTINUE.
 19758
 19759     IF OB-DATE-1-USED  OR
 19760        OB-DATE-2-USED  OR
 19761        OB-DATE-3-USED
 19762         NEXT SENTENCE
 19763     ELSE
 19764         GO TO 4512-BUILD-EPEC-CONTINUE.
 19765
 19766     IF OB-DATE-1-USED
 19767         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19768             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19769                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19770             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19771                                   EW-EPR-ST
 19772             GO TO 4512-BUILD-EPEC-CONTINUE
 19773         ELSE
 19774             GO TO 4512-BUILD-EPEC-CONTINUE.
 19775
 19776     IF OB-DATE-2-USED
 19777         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19778             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19779                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19780             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19781                                   EW-EPR-ST
 19782             GO TO 4512-BUILD-EPEC-CONTINUE
 19783         ELSE
 19784             GO TO 4512-BUILD-EPEC-CONTINUE.
 19785
 19786     IF OB-DATE-3-USED
 19787         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19788             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19789                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19790             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19791                                   EW-EPR-ST
 19792             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 376
* ECS010.cbl
 19793         ELSE
 19794             GO TO 4512-BUILD-EPEC-CONTINUE.
 19795
 19796 4512-BUILD-EPEC-CONTINUE.
 19797
 19798     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19799     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19800     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19801
 19802     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19803     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19804     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19805
 19806     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19807
 19808     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19809     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19810     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19811
 19812     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19813     MOVE ZEROS                         TO EP-CLM-PV.
 19814
 19815     if (dte-client = 'AHL')
 19816        and (ep-rcd-type = 'A')
 19817        and (ep-ben-code (1:1) = 'M')
 19818*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19819        continue
 19820     else
 19821        IF EP-RCD-TYPE = 'A' OR 'U'
 19822           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19823              PERFORM 4599A-CALC-IBNR
 19824                                 THRU 4599A-CALC-EXIT
 19825           end-if
 19826        end-if
 19827     end-if
 19828
 19829     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19830
 19831     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19832     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19833
 19834     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19835
 19836     IF EW-ISS-CNT = ZERO
 19837         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19838                                           EP-AVG-AGE
 19839       ELSE
 19840         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19841                                EW-ORIG-TERM / EW-ISS-CNT
 19842         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19843
 19844     IF EW-INFORCE-CNT = ZERO
 19845         MOVE ZERO                      TO EP-AVG-REM-TERM
 19846       ELSE
 19847         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19848                             EW-REM-TERM / EW-INFORCE-CNT.
 19849
 19850     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 377
* ECS010.cbl
 19851         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19852                                           EP-WEIGHTED-AGE
 19853       ELSE
 19854         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19855                                  EW-TERM-BEN / EW-ISS-BEN
 19856         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19857                                   EW-AGE-BEN / EW-ISS-BEN.
 19858
 19859     MOVE ZEROS                         TO
 19860         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19861         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19862
 19863     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19864                                           WS-EP-HI-COV-DT-N.
 19865     MOVE HIGH-CERT                     TO EP-HI-CERT
 19866                                           WS-EP-HI-CERT-N.
 19867     MOVE LOW-CERT                      TO EP-LO-CERT
 19868                                           WS-EP-LO-CERT-N.
 19869     IF DTE-PGM-OPT = '3'
 19870         MOVE 'P'                       TO EP-PURGE.
 19871
 19872     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19873         GO TO 4514-CONTINUE.
 19874
 19875     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19876
 19877     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19878         MOVE +1                 TO EP-LIFE-YEARS
 19879     ELSE
 19880         MOVE ZEROS              TO W-LIFE-YEARS
 19881         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19882                 VARYING
 19883             SUBM FROM +1 BY +1
 19884                 UNTIL
 19885             SUBM GREATER THAN +13
 19886         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19887             = W-LIFE-YEARS / 12
 19888             - (EPEC-LIFE-CTR (SUB2 1)
 19889             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19890         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19891         IF  EP-LIFE-YEARS LESS THAN +1
 19892             MOVE +1             TO EP-LIFE-YEARS.
 19893
 19894 4514-CONTINUE.
 19895
 19896     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 19897
 19898     MOVE SPACES                        TO EC-RECORD.
 19899     MOVE '1'                           TO WS-SEQ-NBR.
 19900     MOVE +0                            TO SUB3.
 19901     MOVE +0                            TO SUB4.
 19902     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 19903         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 19904         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 19905
 19906     GO TO 4518-BUILD-EPEC-RCD-X.
 19907
 19908 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 378
* ECS010.cbl
 19909
 19910     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 19911
 19912 4515-EXIT.
 19913     EXIT.
 19914
 19915 4518-BUILD-EPEC-RCD-X.
 19916     EXIT.
 19917
 19918 4519-BUILD-EPEC-EXT-X.
 19919     EXIT.
 19920
 19921 4520-BUILD-EPEC-LOAD-COMM.
 19922
 19923     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 19924
 19925     ADD +1 TO SUB3  SUB4.
 19926     MOVE ZEROS                  TO LEVELS-BUILT.
 19927
 19928 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 19929
 19930     IF SUB4 GREATER THAN WS-LOOP-MAX
 19931         IF AGT-SW = 'X'
 19932             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19933                 THRU 4900-WRT-SUMMARY-X
 19934             MOVE ' '            TO AGT-SW
 19935             MOVE WS-LOOP-MAX    TO  SUB4
 19936             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19937         ELSE
 19938             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 19939
 19940     IF LEVELS-BUILT EQUAL +5
 19941         IF AGT-SW = 'X'
 19942             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19943                 THRU 4900-WRT-SUMMARY-X
 19944             MOVE ' '            TO AGT-SW
 19945             MOVE ZEROS          TO LEVELS-BUILT
 19946             ADD 1 TO WS-SEQ-NBR
 19947             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 19948             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 19949                     4540-BUILD-CLEAR-X
 19950                 VARYING SUB3 FROM +1 BY +1
 19951                 UNTIL SUB3 GREATER THAN +5
 19952             MOVE +1             TO SUB3
 19953             GO TO 4531-BUILD-EPEC-LOAD-COMM
 19954         ELSE
 19955             MOVE +1             TO SUB3
 19956             MOVE ZEROS          TO LEVELS-BUILT
 19957             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 19958
 19959     IF SUB4 GREATER THAN WS-LOOP-MAX
 19960         IF AGT-SW = 'X'
 19961             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19962                 THRU 4900-WRT-SUMMARY-X
 19963             MOVE ' '                   TO AGT-SW
 19964             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19965         ELSE
 19966             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 379
* ECS010.cbl
 19967
 19968 4531-BUILD-EPEC-LOAD-COMM.
 19969
 19970     IF (EW-AGT-NO (SUB4) = SPACES)
 19971                  OR
 19972        ((EW-ISS-COM (SUB4) = ZEROS) AND
 19973         (EW-CNC-COM (SUB4) = ZEROS) AND
 19974         (EW-ECR-R78 (SUB4) = ZEROS) AND
 19975         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 19976         (EW-ECR-PRO (SUB4) = ZEROS) AND
 19977         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 19978         (EW-ECR-ST (SUB4) = ZEROS))
 19979         PERFORM 4540-BUILD-EPEC-CLEAR
 19980             THRU 4540-BUILD-CLEAR-X
 19981         ADD +1 TO SUB4
 19982         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 19983
 19984     MOVE 'X'                           TO AGT-SW.
 19985     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 19986     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 19987     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 19988     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 19989     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 19990     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 19991     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 19992     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 19993     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 19994
 19995     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 19996
 19997     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 19998
 19999 4539-BUILD-EPEC-LOAD-COMM-X.
 20000     EXIT.
 20001
 20002 4540-BUILD-EPEC-CLEAR.
 20003
 20004     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20005     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20006     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20007                                           EC-CNC-COMM (SUB3)
 20008                                           EC-COMM-78 (SUB3)
 20009                                           EC-COMM-PR (SUB3)
 20010                                           EC-COMM-ST (SUB3)
 20011                                           EC-COMM-78-ADJ (SUB3)
 20012                                           EC-COMM-PR-ADJ (SUB3).
 20013
 20014 4540-BUILD-CLEAR-X.
 20015     EXIT.
 20016
 20017 4541-CALC-IBNR.
 20018
 20019     MOVE +0                    TO TOT-AH-IBNR
 20020                                   TOT-AH-PRM
 20021                                   TOT-AH-PD-CLMS
 20022                                   TOT-AH-CLMRSV
 20023                                   TOT-LF-IBNR
 20024                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 380
* ECS010.cbl
 20025                                   TOT-LF-PD-CLMS
 20026                                   TOT-LF-CLMRSV
 20027
 20028     MOVE +0                    TO RTOT-AH-IBNR
 20029                                   RTOT-AH-PRM
 20030                                   RTOT-AH-PRMB
 20031                                   RTOT-AH-PD-CLMS
 20032                                   RTOT-AH-CLMRSV
 20033                                   RTOT-LF-IBNR
 20034                                   RTOT-LF-PRM
 20035                                   RTOT-LF-PD-CLMS
 20036                                   RTOT-LF-CLMRSV
 20037
 20038     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20039        (SUB2 > +900)
 20040        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20041*       IF W-UNDERWRITTEN-DATA
 20042*          MOVE EPEC-LEVELS-II (SUB2)
 20043*                                TO EPEC-WORK
 20044*       ELSE
 20045           MOVE EPEC-LEVELS (SUB2)
 20046                                 TO EPEC-WORK
 20047*       END-IF
 20048*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20049           IF EW-REIN-CO = SPACES
 20050              CONTINUE
 20051*             IF EW-LF-AH = 'L'
 20052*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20053*                   + EW-EPR-ST
 20054*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20055*                   + EW-CLM-AMT
 20056*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20057*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20058*             ELSE
 20059*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20060*                   + EW-EPR-ST
 20061*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20062*                   + EW-CLM-AMT
 20063*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20064*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20065           ELSE
 20066              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20067                 EW-LF-AH ' ' EW-BEN-TYPE
 20068              IF EW-LF-AH = 'L'
 20069                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20070                    + EW-EPR-ST
 20071                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20072                    + EW-CLM-AMT
 20073                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20074                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20075              ELSE
 20076                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20077                    + EW-EPR-ST
 20078                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20079                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20080                       + EW-EPR-ST
 20081                 END-IF
 20082                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 381
* ECS010.cbl
 20083                    + EW-CLM-AMT
 20084                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20085                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20086              END-IF
 20087           END-IF
 20088*       END-IF
 20089     END-PERFORM
 20090
 20091*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20092*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20093*    IF TOT-AH-IBNR < ZEROS
 20094*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20095*    END-IF
 20096*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20097*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20098*    IF TOT-LF-IBNR < ZEROS
 20099*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20100*    END-IF
 20101
 20102     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20103        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20104     IF RTOT-AH-IBNR < ZEROS
 20105        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20106     END-IF
 20107     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20108        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20109     IF RTOT-LF-IBNR < ZEROS
 20110        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20111     END-IF
 20112
 20113     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20114        (SUB2 > +900)
 20115        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20116*       IF W-UNDERWRITTEN-DATA
 20117*          MOVE EPEC-LEVELS-II (SUB2)
 20118*                                TO EPEC-WORK
 20119*       ELSE
 20120           MOVE EPEC-LEVELS (SUB2)
 20121                                 TO EPEC-WORK
 20122*       END-IF
 20123*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20124           IF EW-REIN-CO = SPACES
 20125              CONTINUE
 20126*             IF EW-LF-AH = 'L'
 20127*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20128*                   / TOT-LF-PRM
 20129*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20130*                   * RTOT-LF-IBNR
 20131**                  * TOT-LF-IBNR
 20132*             ELSE
 20133*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20134*                   / TOT-AH-PRM
 20135*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20136*                   * RTOT-AH-IBNR
 20137**                  * TOT-AH-IBNR
 20138*             END-IF
 20139           ELSE
 20140              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 382
* ECS010.cbl
 20141                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20142                    EW-EPR-ST ' ' RTOT-AH-PRM
 20143              IF EW-LF-AH = 'L'
 20144                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20145                    / RTOT-LF-PRM
 20146                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20147                    * RTOT-LF-IBNR
 20148              ELSE
 20149                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20150                    / RTOT-AH-PRMB
 20151                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20152                    * RTOT-AH-IBNR
 20153              END-IF
 20154              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20155                 move zeros to ew-clm-ibnr
 20156              end-if
 20157           END-IF
 20158*       END-IF
 20159*       IF W-UNDERWRITTEN-DATA
 20160*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20161*       ELSE
 20162           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20163*       END-IF
 20164     END-PERFORM
 20165
 20166     .
 20167 4541-EXIT.
 20168     EXIT.
 20169
 20170 4545-BUILD-BASE.
 20171
 20172     MOVE 'EC'                   TO EC-RECORD-ID.
 20173     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20174     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20175     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20176     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20177                                    WS-EC-EFF-DTE.
 20178     MOVE EW-REIN-CO             TO EC-REI-CO.
 20179     IF EC-REI-CO NOT = SPACES
 20180         MOVE 'R'                TO EC-REIN.
 20181     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20182     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20183     IF DTE-PGM-OPT = '3'
 20184         MOVE 'P'                TO EC-PURGE.
 20185     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20186
 20187 4545-BUILD-BASE-X.
 20188     EXIT.
 20189
 20190******************************************************************
 20191***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20192******************************************************************
 20193
 20194 4550-CLEAR-EPEC-TOTALS.
 20195
 20196     MOVE LOW-CERT             TO SV-LO-CERT.
 20197     MOVE HIGH-CERT            TO SV-HI-CERT.
 20198     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 383
* ECS010.cbl
 20199     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20200
 20201     MOVE +1                   TO SUB9.
 20202     MOVE +0                   TO SUB10.
 20203     MOVE ZERO                 TO EW-REIN-CO
 20204                                  EW-BEN-TYPE.
 20205     MOVE SPACE                TO EP-FLG
 20206                                  EW-LF-AH
 20207                                  EW-LEVEL-USED
 20208                                  W-TABLE-USED-SW.
 20209
 20210     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20211                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20212                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20213                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20214                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20215                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20216                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20217                                  EW-CLM-AMT     EW-COV-DTE
 20218                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20219                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20220                                  EW-CLM-CRT     EW-ISS-CNT
 20221                                  EW-CNC-CNT     EW-AGE
 20222                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20223                                  EW-AGE-BEN     EW-TERM-BEN
 20224                                  EW-ISS-PRM-TAX
 20225                                  EW-REM-TERM.
 20226
 20227     MOVE +1 TO SUB1.
 20228     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20229     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20230         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20231     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20232                                    EPEC-UNDW-OPT-DATA-TABLE.
 20233     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20234         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20235
 20236     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20237         VARYING SUB3 FROM +1 BY +1
 20238*        UNTIL SUB3 GREATER THAN +300.
 20239*        UNTIL SUB3 GREATER THAN +220.
 20240         UNTIL SUB3 GREATER THAN +900.
 20241
 20242     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20243
 20244 4555-CLEAR-EPEC-COMM.
 20245
 20246     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20247                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20248                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20249                EW-ECR-ST  (SUB1).
 20250     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20251                                    EW-AGT-TYPE (SUB1).
 20252
 20253     ADD +1 TO SUB1.
 20254
 20255 4560-CLEAR-EPEC-ALL.
 20256
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 384
* ECS010.cbl
 20257     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20258                                    EPEC-LEVELS-II (SUB1).
 20259     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20260
 20261 4570-CLEAR-EPEC-SUB-A.
 20262
 20263     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20264     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20265*        UNTIL SUB2 GREATER +300.
 20266         UNTIL SUB2 GREATER +900.
 20267
 20268 4580-CLEAR-EPEC-SUB-B.
 20269
 20270     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20271     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20272
 20273 4589-CLEAR-EPEC-TOTALS-X.
 20274     EXIT.
 20275
 20276 4590-INIT-OB.
 20277
 20278     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20279     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20280     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20281
 20282 4590-EXIT.
 20283     EXIT.
 20284
 20285 4599-BUILD-EPEC-EXTRACT-X.
 20286     EXIT.
 20287
 20288*********************************************************
 20289*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20290*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20291*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20292*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20293*  IN THE DATE CARD.                                    *
 20294*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20295*********************************************************
 20296
 20297 4599A-CALC-IBNR.
 20298
 20299     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20300        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20301                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20302         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20303                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20304                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20305
 20306     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20307         MOVE ZEROS                 TO EW-CLM-IBNR
 20308         GO TO 4599A-CALC-EXIT.
 20309
 20310     IF EP-REIN = 'R'
 20311         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20312
 20313     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20314
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 385
* ECS010.cbl
 20315 4599A-CALC-EXIT.
 20316      EXIT.
 20317 4599B-SEARCH.
 20318      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 386
* ECS010.cbl
 20320******************************************************************
 20321***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20322******************************************************************
 20323
 20324 4600-GET-OPT-IBNR.
 20325
 20326     IF  CR-POLICY-IS-ACTIVE
 20327         IF  CR-POLICY-IS-REISSUE
 20328             OR CR-POLICY-IS-MONTHLY
 20329             IF  W-LIFE
 20330                 GO TO 4600-EXIT
 20331             ELSE
 20332                 NEXT SENTENCE
 20333         ELSE
 20334             NEXT SENTENCE
 20335     ELSE
 20336         IF  W-LIFE
 20337             GO TO 4600-EXIT.
 20338
 20339     IF  W-LIFE
 20340         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20341     ELSE
 20342         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20343
 20344 4600-EXIT.
 20345     EXIT.
 20346
 20347 4620-DETERMINE-LIFE-IBNR.
 20348
 20349     IF  CR-LF-POLICY-IS-ACTIVE
 20350         ADD +1                  TO W-LF-ACTIVE
 20351         IF  CR-LF-POLICY-IS-REISSUE
 20352             OR CR-LF-POLICY-IS-MONTHLY
 20353             MOVE ZEROS          TO W-WK-IBNR
 20354             ADD +1              TO W-LF-REISSUE
 20355             GO TO 4620-EXIT
 20356         ELSE
 20357             NEXT SENTENCE
 20358     ELSE
 20359         ADD +1                  TO W-LF-INACTIVE
 20360         MOVE ZEROS              TO W-WK-IBNR
 20361         GO TO 4620-EXIT.
 20362
 20363     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20364         MOVE ZEROS              TO W-WK-IBNR
 20365         ADD +1                  TO W-LF-CALC-B
 20366         GO TO 4620-EXIT.
 20367
 20368     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20369                 AND
 20370             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20371                 AND
 20372             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20373             OR
 20374         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20375                 AND
 20376             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20377                 AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 387
* ECS010.cbl
 20378             REM-TRM2 NOT GREATER THAN ZERO)
 20379         MOVE ZEROS              TO W-WK-IBNR
 20380         ADD +1                  TO W-LF-BALLOON
 20381         GO TO 4620-EXIT
 20382     ELSE
 20383         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20384                 AND
 20385             REM-TRM2 NOT GREATER THAN ZERO)
 20386             ADD +1              TO W-LF-REMTERM-0
 20387             MOVE ZEROS          TO W-WK-IBNR
 20388             GO TO 4620-EXIT.
 20389
 20390     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20391
 20392     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20393         ADD +1                  TO W-LF-REMAMT-0
 20394         MOVE ZEROS              TO W-WK-IBNR
 20395         GO TO 4620-EXIT.
 20396
 20397     IF  AM-LIFE-IBNR-PCT NUMERIC
 20398             AND
 20399         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20400         COMPUTE W-WK-IBNR ROUNDED
 20401             = CP-REMAINING-AMT
 20402             / 1000
 20403             * AM-LIFE-IBNR-PCT
 20404     ELSE
 20405         COMPUTE W-WK-IBNR ROUNDED
 20406             = CP-REMAINING-AMT
 20407             / 1000
 20408             * COMPANY-IBNR-LIFE-FACTOR.
 20409
 20410     IF  CR-LF-IS-REIN-ONLY
 20411         ADD +1                  TO W-LF-REIN
 20412     ELSE
 20413         ADD +1                  TO W-LF-DATA-USED
 20414         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20415         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20416         IF  CR-LFTYP = '01'
 20417             ADD CP-REMAINING-AMT
 20418                                 TO W-01-REMAMT
 20419             ADD +1              TO W-01-DATA-USED
 20420         ELSE
 20421         IF  CR-LFTYP = '02'
 20422             ADD CP-REMAINING-AMT
 20423                                 TO W-02-REMAMT
 20424             ADD +1              TO W-02-DATA-USED
 20425         ELSE
 20426         IF  CR-LFTYP = '03'
 20427             ADD CP-REMAINING-AMT
 20428                                 TO W-03-REMAMT
 20429             ADD +1              TO W-03-DATA-USED
 20430         ELSE
 20431         IF  CR-LFTYP = '04'
 20432             ADD CP-REMAINING-AMT
 20433                                 TO W-04-REMAMT
 20434             ADD +1              TO W-04-DATA-USED
 20435         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 388
* ECS010.cbl
 20436         IF  CR-LFTYP = '05'
 20437             ADD CP-REMAINING-AMT
 20438                                 TO W-05-REMAMT
 20439             ADD +1              TO W-05-DATA-USED
 20440         ELSE
 20441         IF  CR-LFTYP = '06'
 20442             ADD CP-REMAINING-AMT
 20443                                 TO W-06-REMAMT
 20444             ADD +1              TO W-06-DATA-USED
 20445         ELSE
 20446         IF  CR-LFTYP = '30'
 20447             ADD CP-REMAINING-AMT
 20448                                 TO W-30-REMAMT
 20449             ADD +1              TO W-30-DATA-USED
 20450         ELSE
 20451         IF  CR-LFTYP = '31'
 20452             ADD CP-REMAINING-AMT
 20453                                 TO W-31-REMAMT
 20454             ADD +1              TO W-31-DATA-USED
 20455         ELSE
 20456             ADD CP-REMAINING-AMT
 20457                                 TO W-XX-REMAMT
 20458             ADD +1              TO W-XX-DATA-USED.
 20459
 20460     IF  CR-POLICY-IS-REIN-ONLY
 20461             OR
 20462         CR-LF-IS-REIN-ONLY
 20463         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20464         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20465         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20466     ELSE
 20467         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20468
 20469 4620-EXIT.
 20470     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 389
* ECS010.cbl
 20472 4640-GET-A-H-EARNED-PREMIUM.
 20473
 20474     IF  CR-AH-POLICY-IS-ACTIVE
 20475         ADD +1                  TO W-AH-ACTIVE
 20476         IF  CR-AH-POLICY-IS-REISSUE
 20477             OR CR-AH-POLICY-IS-MONTHLY
 20478             ADD +1              TO W-AH-REISSUE
 20479         ELSE
 20480             NEXT SENTENCE
 20481     ELSE
 20482         ADD +1                  TO W-AH-INACTIVE.
 20483
 20484     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20485         ADD +1                  TO W-AH-CALC-B
 20486         GO TO 4640-EXIT.
 20487
 20488     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20489         MOVE 'Y'                TO W-RTRM-0-SW
 20490     ELSE
 20491         MOVE SPACES             TO W-RTRM-0-SW.
 20492
 20493     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20494
 20495****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20496******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20497******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20498******        THAT CLAIM.
 20499
 20500     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20501
 20502     IF  CR-POLICY-IS-REIN-ONLY
 20503              OR
 20504         CR-AH-IS-REIN-ONLY
 20505         ADD +1                  TO W-AH-REIN
 20506         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20507         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20508         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20509         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20510         GO TO 4640-EXIT.
 20511
 20512     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20513                                    W-EPEC-EP-IN.
 20514     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20515                                    W-CLAIMS-MADE-PAID-IN.
 20516     ADD +1                      TO W-AH-DATA-USED.
 20517     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20518     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20519
 20520     IF  W-CLMAMT GREATER THAN ZEROS
 20521         ADD +1                  TO W-AH-CLAIM-CTR
 20522         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20523
 20524     IF  W-RTRM-0
 20525             AND
 20526         NOT CR-POLICY-IS-REIN-ONLY
 20527             AND
 20528         NOT CR-AH-IS-REIN-ONLY
 20529         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 390
* ECS010.cbl
 20530         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20531         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20532         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20533         ADD +1                  TO W-AH-REMTERM-0.
 20534
 20535 4640-EXIT.
 20536     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 391
* ECS010.cbl
 20538 4650-DETERMINE-CLM-AMT-AH.
 20539
 20540     MOVE ZEROS                  TO W-CLMAMT.
 20541
 20542     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20543             OR
 20544         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20545         GO TO 4650-EXIT.
 20546
 20547     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20548             AND
 20549         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20550         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20551         MOVE 'L'                    TO DC-OPTION-CODE
 20552         PERFORM 8000-DATE-CONVERT-ROUTINE
 20553             THRU 8099-DATE-CONVERT-X
 20554         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20555         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20556         MOVE 'L'                    TO DC-OPTION-CODE
 20557         PERFORM 8000-DATE-CONVERT-ROUTINE
 20558             THRU 8099-DATE-CONVERT-X
 20559         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20560         IF  DATE-CONVERSION-ERROR
 20561             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20562             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20563             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20564             MOVE 0303               TO WS-ABEND-CODE
 20565             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20566             GO TO ABEND-PGM
 20567         ELSE
 20568             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20569             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20570             MOVE '1'                TO DC-OPTION-CODE
 20571             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20572                                        DC-ELAPSED-DAYS
 20573             PERFORM 8000-DATE-CONVERT-ROUTINE
 20574                 THRU 8099-DATE-CONVERT-X
 20575             IF  DATE-CONVERSION-ERROR
 20576                 DISPLAY 'DIS TO PTO DATE ERROR '
 20577                     CR-FULL-CONTROL
 20578                 MOVE 'DIS TO PTO DATE ERROR '
 20579                                     TO WS-ABEND-MESSAGE
 20580                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20581                 MOVE 0303           TO WS-ABEND-CODE
 20582                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20583                 GO TO ABEND-PGM
 20584             ELSE
 20585                 COMPUTE W-CLMAMT ROUNDED
 20586                     = CR-AHAMT
 20587                     * (DC-ELAPSED-DAYS / 30)
 20588                 GO TO 4650-EXIT.
 20589
 20590     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20591             OR
 20592         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20593         GO TO 4650-EXIT.
 20594
 20595     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 392
* ECS010.cbl
 20596         = CR-AHAMT * 3.
 20597
 20598     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20599         MOVE CR-DISAMT          TO W-CLMAMT
 20600     ELSE
 20601         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20602
 20603     IF  NOT CR-POLICY-IS-REIN-ONLY
 20604              AND
 20605         NOT CR-AH-IS-REIN-ONLY
 20606         ADD +1          TO W-CLM-EXCEPT-CNT
 20607         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20608
 20609 4650-EXIT.
 20610     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 393
* ECS010.cbl
 20612 4660-DETERMINE-EARNED-PREMIUM.
 20613
 20614     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20615
 20616     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20617
 20618     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20619
 20620     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20621         MOVE ZEROS              TO W-EARNED-PREMIUM
 20622         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20623         MOVE '7'                TO W-VAL-SOURCE
 20624         PERFORM 8500-REMAINING-TERM-ROUTINE
 20625             THRU 8599-REM-TERM-X
 20626         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20627         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20628         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20629         MOVE EPR-R78            TO W-OPT-R78
 20630         MOVE EPR-PRO            TO W-OPT-PRO
 20631         MOVE EPR-ST             TO W-OPT-ST
 20632         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20633         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20634     ELSE
 20635         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20636
 20637     COMPUTE W-EARNED-PREMIUM ROUNDED
 20638         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20639
 20640     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20641         ADD +1                  TO W-EP-LESS-THAN-0
 20642         MOVE ZERO               TO W-EARNED-PREMIUM.
 20643
 20644 4660-EXIT.
 20645     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 394
* ECS010.cbl
 20647 4666-SAVE-AHCR-DATA.
 20648
 20649     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20650                                    WX-STATUS-AT-SETTLEMENT.
 20651
 20652     MOVE ZEROS                  TO WX-CANC-DT
 20653                                    WX-EOM-RUN-DATE
 20654                                    WX-SETTLEMENT-EXIT-DATE.
 20655
 20656     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20657         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20658         MOVE CR-AH-STATUS-AT-CANCEL
 20659                                 TO WX-STATUS-AT-CANCEL
 20660         MOVE ZEROS              TO CR-AH-CANC-DT
 20661                                    WS-CR-AH-CANC-DT-N
 20662         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20663
 20664     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20665         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20666                                 TO WX-SETTLEMENT-EXIT-DATE
 20667         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20668                                 TO WX-STATUS-AT-SETTLEMENT
 20669         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20670                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20671         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20672
 20673     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20674     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20675
 20676 4666-EXIT.
 20677     EXIT.
 20678
 20679 4668-RESTORE-AHCR-DATA.
 20680
 20681     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20682         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20683                                    WS-CR-AH-CANC-DT-N
 20684         MOVE WX-STATUS-AT-CANCEL
 20685                                 TO CR-AH-STATUS-AT-CANCEL.
 20686
 20687     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20688         MOVE WX-SETTLEMENT-EXIT-DATE
 20689                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20690                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20691         MOVE WX-STATUS-AT-SETTLEMENT
 20692                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20693
 20694     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20695
 20696 4668-EXIT.
 20697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 395
* ECS010.cbl
 20699 4670-CALC-EP.
 20700
 20701     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20702         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20703         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20704         GO TO 4670-EXIT.
 20705
 20706     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20707         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20708         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20709         GO TO 4670-EXIT.
 20710
 20711***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20712
 20713     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20714         COMPUTE W-EARNED-PREMIUM
 20715             = (W-OPT-PRO + W-OPT-R78) / +2
 20716         ADD W-EARNED-PREMIUM    TO W-M-EP
 20717     ELSE
 20718         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20719             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20720             ADD W-EARNED-PREMIUM
 20721                                 TO W-R-EP
 20722         ELSE
 20723             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20724                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20725                 ADD W-EARNED-PREMIUM
 20726                                 TO W-P-EP
 20727             ELSE
 20728                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20729                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20730                         = (W-OPT-PRO * +.6667)
 20731                         + (W-OPT-R78 * +.3333)
 20732                     ADD W-EARNED-PREMIUM
 20733                                 TO W-1-EP
 20734                 ELSE
 20735                     ADD +1      TO W-OTHERS-COUNT
 20736                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20737
 20738 4670-EXIT.
 20739     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 396
* ECS010.cbl
 20741 4680-CALC-REMAINING-AMT-LF.
 20742
 20743     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20744     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20745     MOVE CR-APR                 TO CP-LOAN-APR.
 20746     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20747
 20748     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20749         MOVE +1                 TO CR-PMT-FREQ.
 20750
 20751     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20752
 20753     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20754     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20755                                    CP-RATING-BENEFIT-AMT.
 20756     IF CP-STATE-STD-ABBRV = 'OR'
 20757         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20758     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20759     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20760     MOVE ZEROS                  TO CP-REMAINING-AMT
 20761                                    CP-REMAINING-AMT-PRV
 20762                                    CP-RETURN-CODE
 20763                                    CP-RETURN-CODE-2.
 20764
 20765     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20766     IF (DTE-CLIENT = 'DCC')
 20767        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 20768        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20769           ((CR-STATE = DD-STATE (D1))
 20770           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20771           AND ('A'           = DD-BEN-TYPE   (D1))
 20772           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 20773           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20774                           OR
 20775           D1 > +800
 20776        END-PERFORM
 20777        IF D1 < +801
 20778           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20779              (P1 > +8)
 20780              OR (DD-PROD-CODE (D1 P1) = 'L')
 20781           END-PERFORM
 20782           IF P1 < +9
 20783              MOVE DD-MAX-BEN-AMT (D1 P1)
 20784                                 TO CP-R-MAX-TOT-BEN
 20785           END-IF
 20786        END-IF
 20787     END-IF
 20788
 20789     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20790
 20791     IF  CP-RETURN-CODE NOT = ZERO
 20792         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20793                             TO WS-ABEND-MESSAGE
 20794         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20795         MOVE 2001           TO WS-ABEND-CODE
 20796         GO TO ABEND-PGM.
 20797
 20798 4680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 397
* ECS010.cbl
 20799     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 398
* ECS010.cbl
 20801******************************************************************
 20802***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20803******************************************************************
 20804
 20805 4700-CALC-OPT-IBNR.
 20806
 20807     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20808     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20809
 20810     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20811             VARYING
 20812         SUB2 FROM +1 BY +1
 20813             UNTIL
 20814*        SUB2 GREATER THAN 300.
 20815*        SUB2 GREATER THAN 220.
 20816         SUB2 GREATER THAN 900.
 20817
 20818     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20819                                 TO EPEC-OPT-WORK-TABLE.
 20820     MOVE '*'                    TO W-UNDERWRITING-SW.
 20821
 20822     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20823             VARYING
 20824         SUB2 FROM +1 BY +1
 20825             UNTIL
 20826*        SUB2 GREATER THAN 300.
 20827*        SUB2 GREATER THAN 220.
 20828         SUB2 GREATER THAN 900.
 20829
 20830 4700-EXIT.
 20831     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 399
* ECS010.cbl
 20833 4710-PROCESS-THRU-EPEC-TABLE.
 20834
 20835     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20836         GO TO 4710-EXIT.
 20837
 20838     IF  W-UNDERWRITTEN-DATA
 20839         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20840     ELSE
 20841         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20842
 20843     IF EW-LEVEL-USED NOT = 'Y'
 20844         GO TO 4710-EXIT.
 20845
 20846     IF  EW-REIN-CO GREATER THAN SPACES
 20847         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20848         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20849             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20850             IF  W-WK-IBNR GREATER THAN ZEROS
 20851                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20852                 GO TO 4710-EXIT
 20853             ELSE
 20854                 GO TO 4710-EXIT
 20855         ELSE
 20856             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20857                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20858                 GO TO 4710-EXIT
 20859             ELSE
 20860                 GO TO 4710-EXIT.
 20861
 20862     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20863
 20864     IF  EW-LF-AH EQUAL 'L'
 20865         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20866             GO TO 4710-EXIT
 20867         ELSE
 20868             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20869             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20870     ELSE
 20871         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20872                 GREATER THAN ZEROS
 20873             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20874             ADD W-WK-IBNR       TO W-AH-IBNR
 20875         ELSE
 20876             GO TO 4710-EXIT.
 20877
 20878     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20879     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20880     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20881
 20882     IF  W-UNDERWRITTEN-DATA
 20883         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 20884     ELSE
 20885         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 20886
 20887
 20888     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20889     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 20890
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 400
* ECS010.cbl
 20891 4710-EXIT.
 20892     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 401
* ECS010.cbl
 20894 4720-PROCESS-LIFE.
 20895
 20896     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 20897
 20898 4720-EXIT.
 20899     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 402
* ECS010.cbl
 20901 4730-PROCESS-A-H.
 20902
 20903     IF  AM-TARGET-LOSS-RATIO NUMERIC
 20904             AND
 20905         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 20906         MOVE AM-TARGET-LOSS-RATIO
 20907                                 TO W-TARGET-LOSS-RATIO
 20908     ELSE
 20909         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 20910             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 20911                                 TO W-TARGET-LOSS-RATIO
 20912             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 20913
 20914     IF  W-NOT-REIN-PROCESS
 20915         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 20916         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 20917
 20918     COMPUTE W-IBNR-1 ROUNDED
 20919         = EPEC-EARNED-PREMIUM-AH (SUB2)
 20920         * COMPANY-IBNR-AH-FACTOR
 20921         * W-TARGET-LOSS-RATIO.
 20922
 20923     COMPUTE W-IBNR-2 ROUNDED
 20924         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 20925         * W-TARGET-LOSS-RATIO)
 20926         - EPEC-CLAIMS-MADE-PAID (SUB2).
 20927
 20928     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 20929         MOVE W-IBNR-1           TO W-WK-IBNR
 20930         IF  W-NOT-REIN-PROCESS
 20931             ADD +1              TO W-AH-IBNR-1-CNT
 20932             ADD W-IBNR-1        TO W-AH-IBNR-1
 20933         ELSE
 20934             NEXT SENTENCE
 20935     ELSE
 20936         MOVE W-IBNR-2           TO W-WK-IBNR
 20937         IF  W-NOT-REIN-PROCESS
 20938             ADD +1              TO W-AH-IBNR-2-CNT
 20939             ADD W-IBNR-2        TO W-AH-IBNR-2.
 20940
 20941 4730-EXIT.
 20942     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 403
* ECS010.cbl
 20944 4735-GET-BUSINESS-ADJUSTMENT.
 20945
 20946     IF  CR-GRPTYP NOT NUMERIC
 20947         MOVE '99'               TO INDEXBS
 20948     ELSE
 20949         MOVE CR-GRPTYP          TO INDEXBS.
 20950
 20951     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 20952             AND
 20953         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20954             NOT EQUAL ZEROS
 20955             AND
 20956         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20957             NOT EQUAL +1.0000
 20958         MOVE INDEXBS           TO W-EDIT-7
 20959         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 20960             = W-TARGET-LOSS-RATIO
 20961             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 20962
 20963 4735-EXIT.
 20964     EXIT.
 20965
 20966 4740-CREATE-DETAIL-EXTR.
 20967
 20968     IF DTE-PGM-OPT NOT = '1'
 20969         GO TO 4740-EXIT.
 20970
 20971     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 20972         GO TO 4740-EXIT.
 20973
 20974     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 20975     MOVE ZEROS                  TO REPORTED-DATE
 20976                                    PAY-TO-DATE.
 20977
 20978     MOVE SPACES                 TO TR-DTL2.
 20979     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 20980
 20981     MOVE EOM-YR                 TO TRD-ISYR.
 20982     MOVE EOM-MO                 TO TRD-ISMO.
 20983     MOVE EOM-DA                 TO TRD-ISDA.
 20984     MOVE ZERO                   TO TRD-AGE.
 20985
 20986     IF  EW-LF-AH EQUAL 'L'
 20987         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 20988     ELSE
 20989         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 20990
 20991     MOVE SPACES                 TO TRD-PAYCURX
 20992                                    TRD-PAYCUR-SPACE
 20993                                    TRD-FUTRSV-SPACE
 20994                                    TRD-FUTRSVX.
 20995
 20996     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 20997     MOVE 'IBNR'                 TO TRD-IBNRX.
 20998     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 20999     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21000
 21001     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 404
* ECS010.cbl
 21002         IF  W-REIN-IN-PROCESS
 21003             MOVE ' ACCT/BEN REIN RSV UW'
 21004                                 TO TRD-RSV-ACTION
 21005         ELSE
 21006             MOVE ' ACCT/BEN RESERVES UW'
 21007                                 TO TRD-RSV-ACTION
 21008     ELSE
 21009         IF  W-REIN-IN-PROCESS
 21010             MOVE ' ACCT/BEN REIN RSV'
 21011                                 TO TRD-RSV-ACTION
 21012         ELSE
 21013             MOVE ' ACCT/BEN RESERVES'
 21014                                 TO TRD-RSV-ACTION.
 21015
 21016     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21017
 21018     MOVE SPACES                 TO DETAIL-EXTRACT.
 21019
 21020     IF  W-REIN-IN-PROCESS
 21021         MOVE EW-REIN-CO         TO DE-REI-COMP
 21022         MOVE 'R'                TO DE-REIN
 21023         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21024         MOVE ZEROS              TO DE-IBNR
 21025     ELSE
 21026         MOVE EW-CLM-IBNR        TO DE-IBNR
 21027         MOVE ZEROS              TO DE-REI-IBNR.
 21028
 21029     MOVE 'DE'                   TO DE-RECORD-ID.
 21030     MOVE 'Y'                    TO DE-TRANS.
 21031     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21032     MOVE '1'                    TO DE-ENTRY-STATUS.
 21033     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21034
 21035     MOVE EOM-RUN-DATE           TO DE-EFF
 21036                                    WS-DE-EFF-N
 21037                                    DE-ENTRY-DTE
 21038                                    WS-DE-ENTRY-DTE-N.
 21039     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21040                                    WS-DE-RSV-INCUR-N.
 21041
 21042     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21043     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21044     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21045                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21046     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21047                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21048
 21049     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21050     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21051     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21052     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21053     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21054*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21055     MOVE AM-IG                  TO DE-IG.
 21056
 21057     IF W-UNDERWRITTEN-DATA
 21058         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21059     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 405
* ECS010.cbl
 21060         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21061
 21062     IF  EW-LF-AH EQUAL 'L'
 21063         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21064         MOVE '1'                TO DE-RESERVE-TYPE
 21065         MOVE ZEROS              TO DE-AH-TYPE
 21066     ELSE
 21067         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21068         MOVE '2'                TO DE-RESERVE-TYPE
 21069         MOVE ZEROS              TO DE-LF-TYPE.
 21070
 21071     MOVE SPACES                 TO DE-NAME
 21072                                    DE-ACC-GPCD
 21073                                    DE-AH-STAT-CDE
 21074                                    DE-LF-STAT-CDE
 21075                                    DE-MEMBER-NO
 21076                                    DE-NAME
 21077                                    DE-SEX.
 21078     MOVE ZEROS                  TO DE-AGE
 21079                                    DE-AH-BEN
 21080                                    DE-AH-CANC-DTE
 21081                                    WS-DE-AH-CANC-DTE-N
 21082                                    DE-AH-CANC-EXIT-DT
 21083                                    WS-DE-AH-CANC-EXIT-DT-N
 21084                                    DE-AH-PRM
 21085                                    DE-AH-RFND
 21086                                    DE-AH-TERM
 21087                                    DE-APR
 21088                                    DE-CANCEL-CNT-ITD
 21089                                    DE-CANCEL-CNT-YTD
 21090                                    DE-FUTRSV
 21091                                    DE-LF-BEN
 21092                                    DE-LF-BEN-ALT
 21093                                    DE-LF-CANC-DTE
 21094                                    WS-DE-LF-CANC-DTE-N
 21095                                    DE-LF-CANC-EXIT-DT
 21096                                    WS-DE-LF-CANC-EXIT-DT-N
 21097                                    DE-LF-CNBEN
 21098                                    DE-LF-CNBEN-ALT
 21099                                    DE-LF-PRM
 21100                                    DE-LF-PRM-ALT
 21101                                    DE-LF-RFND
 21102                                    DE-LF-TERM
 21103                                    DE-LOAN-TERM
 21104                                    DE-LIVES
 21105                                    DE-PAYCUR
 21106                                    DE-PMT-FREQ
 21107                                    DE-REI-AHAMT
 21108                                    DE-REI-AHPRM
 21109                                    DE-REI-AHRFND
 21110                                    DE-REI-CNAMT
 21111                                    DE-REI-FUTRSV
 21112                                    DE-REI-LFAMT
 21113                                    DE-REI-LFPRM
 21114                                    DE-REI-LFRFND
 21115                                    DE-REI-PAYCUR
 21116                                    DE-RSV-REPORTED
 21117                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 406
* ECS010.cbl
 21118                                    WS-DE-RSV-PAYTO-N
 21119                                    DE-MOB-NET-TOT-FEES
 21120                                    DE-SOC-SEC-NO.
 21121
 21122     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21123
 21124     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21125         THRU 2599-WRT-DETAIL-X.
 21126     ADD +1                      TO BC-G-CRS.
 21127
 21128 4740-EXIT.
 21129     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 407
* ECS010.cbl
 21131 4750-UPDATE-REIN.
 21132
 21133     COMPUTE SUB3 = SUB2 + 1.
 21134
 21135     IF  W-UNDERWRITTEN-DATA
 21136         MOVE EPEC-SUB-KEY-II (SUB2)
 21137                                 TO W-SUB-KEY
 21138     ELSE
 21139         MOVE EPEC-SUB-KEY (SUB2)
 21140                                 TO W-SUB-KEY.
 21141
 21142     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21143             VARYING
 21144         SUB3 FROM SUB3 BY +1
 21145             UNTIL
 21146         SUB3 GREATER THAN +900
 21147*        SUB3 GREATER THAN +220
 21148*        SUB3 GREATER THAN +300
 21149             OR
 21150         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21151
 21152 4750-EXIT.
 21153     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 408
* ECS010.cbl
 21155 4755-MATCH-REIN-EPEC.
 21156
 21157     IF  W-UNDERWRITTEN-DATA
 21158         MOVE EPEC-LEVELS-II (SUB3)
 21159                                 TO EPEC-WORK
 21160     ELSE
 21161         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21162
 21163     IF  EPEC-LINE-NOT-USED (SUB3)
 21164         GO TO 4755-EXIT.
 21165
 21166     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21167             OR
 21168         EW-REIN-CO EQUAL SPACES
 21169         GO TO 4755-EXIT.
 21170
 21171     IF  W-ISS-BEN GREATER THAN ZEROS
 21172         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21173             COMPUTE W-FACTOR ROUNDED
 21174                 = (EW-ISS-BEN
 21175                 - EPEC-REIN-ISS-BEN (SUB3))
 21176                 / W-ISS-BEN
 21177         ELSE
 21178             COMPUTE W-FACTOR ROUNDED
 21179                 = EW-ISS-BEN
 21180                 / W-ISS-BEN.
 21181
 21182     COMPUTE EW-CLM-IBNR ROUNDED
 21183         = EW-CLM-IBNR
 21184         + (W-WK-IBNR * W-FACTOR).
 21185
 21186     IF  W-UNDERWRITTEN-DATA
 21187         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21188     ELSE
 21189         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21190
 21191 4755-EXIT.
 21192     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 409
* ECS010.cbl
 21194 4760-PROCESS-REIN-ONLY.
 21195
 21196     MOVE ZEROS                  TO W-WK-IBNR.
 21197
 21198     IF  EPEC-LINE-NOT-USED (SUB2)
 21199         GO TO 4760-EXIT.
 21200
 21201     IF  EW-LF-AH EQUAL 'L'
 21202         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21203             GO TO 4760-EXIT
 21204         ELSE
 21205             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21206             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21207     ELSE
 21208         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21209             GO TO 4760-EXIT
 21210         ELSE
 21211             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21212             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21213
 21214 4760-EXIT.
 21215     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 410
* ECS010.cbl
 21217 4770-CREATE-REIN-DETAIL.
 21218
 21219     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21220     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21221
 21222 4770-EXIT.
 21223     EXIT.
 21224
 21225 4799-EXIT.
 21226     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 411
* ECS010.cbl
 21228 4800-CALC-EARNED-PREMIUM-AH.
 21229
 21230     MOVE +0                         TO CNC-BEN  EPR-R78
 21231                                        ISS-PRM  EPR-PRO
 21232                                        CNC-PRM  EPR-ST
 21233                                        WX-CLM-AMT
 21234                                        WX-CLM-EXP
 21235                                        WX-CLM-CNT
 21236                                        WX-CLM-CRT
 21237                                        WX-CNC-CNT
 21238                                        ISS-PRMTAX
 21239                                        WX-ACTIVE-COUNT.
 21240     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21241
 21242     MOVE WE-AHPRM TO ISS-PRM.
 21243
 21244     IF DTE-CLIENT = 'GIC'
 21245         IF REIN-EP-FLG NOT = 'R'  AND
 21246            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21247            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21248            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21249
 21250     IF REIN-EP-FLG = 'R'  AND
 21251        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21252         NEXT SENTENCE
 21253     ELSE
 21254         GO TO 4810-EP-DO-AH-CLM.
 21255
 21256     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21257         IF WE-DSPY-AMT NOT = +0
 21258             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21259             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21260             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21261             ADD +1             TO WX-CLM-CNT.
 21262
 21263     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21264         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21265             GO TO 4830-EP-DO-AH-EP.
 21266
 21267     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21268         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21269             GO TO 4830-EP-DO-AH-EP.
 21270
 21271     GO TO 4815-EP-DO-AH-CLM-EPR.
 21272
 21273 4810-EP-DO-AH-CLM.
 21274
 21275     IF WE-DSPY-AMT NOT = +0
 21276         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21277         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21278         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21279         ADD +1             TO WX-CLM-CNT.
 21280
 21281 4815-EP-DO-AH-CLM-EPR.
 21282
 21283     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21284         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21285
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 412
* ECS010.cbl
 21286 4820-EP-DO-AH-CNCL.
 21287
 21288     IF CR-AH-STATUS-AT-CANCEL = ' '
 21289         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21290            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21291             GO TO 4899-EXIT
 21292         ELSE
 21293             GO TO 4830-EP-DO-AH-EP.
 21294
 21295     IF (DTE-CLIENT = 'DCC')
 21296        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21297        IF CR-AHRFND NOT = ZEROS
 21298           ADD +1                TO WX-CNC-CNT
 21299        END-IF
 21300     ELSE
 21301        ADD +1                   TO WX-CNC-CNT
 21302     END-IF
 21303
 21304     MOVE WE-AHRFND TO CNC-PRM.
 21305
 21306*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21307*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21308*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21309*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21310
 21311     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21312     MOVE 'L'                   TO  DC-OPTION-CODE.
 21313     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21314     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21315
 21316     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21317     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21318     MOVE '1'                     TO  DC-OPTION-CODE.
 21319     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21320     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21321                                      DC-ODD-DAYS-OVER
 21322                                      DC-ELAPSED-DAYS.
 21323     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21324     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21325
 21326     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21327         ADD  +1                  TO  MONTHS-DIFF-AH.
 21328
 21329     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21330                                      WS-DCC-DDF-CB-LEVELS
 21331
 21332     if (dte-client = 'AHL')
 21333        and (cr-ah-cancel-exit-date < 20120401)
 21334        go to 4820-continue-ah-cancel
 21335     end-if
 21336
 21337     IF DTE-CLIENT = 'ACE'
 21338         GO TO 4820-CONTINUE-AH-CANCEL.
 21339
 21340     MOVE  ZEROS                  TO  SUB.
 21341
 21342 4820-AH-CHARGEBACK-LOOP.
 21343
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 413
* ECS010.cbl
 21344     ADD    +1                    TO  SUB.
 21345
 21346     IF  SUB  GREATER THAN  +10
 21347         GO TO  4820-CONTINUE-AH-CANCEL.
 21348
 21349     IF CR-CANCEL-REASON = 'R'
 21350        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21351           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21352              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21353              GO TO  4820-AH-CHARGEBACK-LOOP
 21354           END-IF
 21355           IF AM-COM-TYP (SUB) = 'J'
 21356              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21357              GO TO  4820-AH-CHARGEBACK-LOOP
 21358           END-IF
 21359        END-IF
 21360     END-IF
 21361
 21362     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21363         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21364         GO TO  4820-AH-CHARGEBACK-LOOP.
 21365
 21366     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21367         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21368
 21369     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21370         OR (CR-AHRFND = ZEROS)
 21371         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21372     END-IF
 21373
 21374     GO TO  4820-AH-CHARGEBACK-LOOP.
 21375
 21376
 21377 4820-CONTINUE-AH-CANCEL.
 21378
 21379     IF DTE-CLIENT = 'GIC'
 21380         IF REIN-EP-FLG NOT = 'R'  AND
 21381            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21382            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21383
 21384     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21385     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21386
 21387     IF CR-AH-LUMP-SUM-DISAB
 21388         GO TO 4899-EXIT.
 21389
 21390     MOVE WE-AHAMT TO CNC-BEN.
 21391
 21392     GO TO 4899-EXIT.
 21393
 21394 4825-EP-DO-AH-CNCL-SUM.
 21395
 21396     IF WE-DSPY-AMT NOT = +0
 21397         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21398         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21399         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21400         ADD +1             TO WX-CLM-CNT.
 21401
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 414
* ECS010.cbl
 21402     IF WE-AHRFND = ZERO
 21403        GO TO 4830-EP-DO-AH-EP.
 21404
 21405     MOVE WE-AHRFND TO CNC-PRM.
 21406
 21407     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21408
 21409     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21410                                      WS-DCC-DDF-CB-LEVELS
 21411
 21412     IF WE-AHRFND NOT LESS WE-AHPRM
 21413         MOVE WE-AHAMT TO CNC-BEN
 21414          GO TO 4830-EP-DO-AH-EP.
 21415
 21416     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21417     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21418     MOVE TEMP-7 TO CNC-BEN.
 21419
 21420 4830-EP-DO-AH-EP.
 21421
 21422     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21423     MOVE '8'           TO W-VAL-SOURCE.
 21424
 21425     IF REIN-EP-FLG = 'R'
 21426       IF REIN-REM-SW (SUB5) = 'I'
 21427           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21428           GO TO 4899-EXIT.
 21429
 21430     IF REIN-EP-FLG = 'R'
 21431         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21432            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21433             MOVE '*'               TO A-H-EARNED-SWITCH
 21434             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21435             MOVE '10'              TO W-VAL-SOURCE.
 21436
 21437     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21438
 21439     IF REM-TRM2 GREATER CR-AH-TERM
 21440         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21441         GO TO 4899-EXIT.
 21442
 21443     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21444         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21445*
 21446 4835-CHECK-OB-AH-NCL.
 21447
 21448     IF (DTE-CLIENT EQUAL 'NCL') AND
 21449        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21450           MOVE WE-AHPRM         TO EPR-R78
 21451                                    EPR-PRO
 21452                                    EPR-ST
 21453        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21454           (CR-MO EQUAL EOM-MO)
 21455           MOVE '*'            TO OB-DATE-1-SWITCH
 21456           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21457           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21458           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21459           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 415
* ECS010.cbl
 21460                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21461           GO TO 4899-EXIT
 21462        ELSE
 21463        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21464           (CR-MO EQUAL OB-MO (1))
 21465           MOVE '*'            TO OB-DATE-2-SWITCH
 21466           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21467           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21468           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21469           COMPUTE WS-EPR-R78 (SUB3 2) =
 21470                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21471           GO TO 4899-EXIT
 21472        ELSE
 21473        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21474           (CR-MO EQUAL OB-MO (2))
 21475           MOVE '*'            TO OB-DATE-3-SWITCH
 21476           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21477           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21478           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21479           COMPUTE WS-EPR-R78 (SUB3 3) =
 21480                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21481           GO TO 4899-EXIT
 21482        ELSE
 21483           GO TO 4899-EXIT.
 21484
 21485     IF REM-TRM2 NOT GREATER +0
 21486         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21487         GO TO 4899-EXIT.
 21488
 21489     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21490         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21491         GO TO 4899-EXIT.
 21492
 21493     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21494         MOVE +1 TO WX-ACTIVE-COUNT
 21495     ELSE
 21496         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21497
 21498     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21499     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21500     IF DTE-R78 = '1'
 21501         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21502     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21503
 21504     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21505         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21506     ELSE
 21507         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21508
 21509     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21510     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21511
 21512     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21513     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21514
 21515     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21516
 21517*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 416
* ECS010.cbl
 21518*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21519
 21520     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21521
 21522     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21523        (CR-DT GREATER THAN  19921231)
 21524        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21525         IF CR-AH-TERM GREATER THAN  +61
 21526             MOVE 'A' TO AH-EARN-METHOD
 21527             MOVE '*' TO STATUTORY-SWITCH-AH
 21528             GO TO 4845-EP-DO-AH-EP-AN
 21529         ELSE
 21530             GO TO 4860-EP-DO-AH-STATUTORY.
 21531
 21532     IF (AH-EARN-METHOD EQUAL 'N')
 21533                  OR
 21534        ((DTE-CLIENT = 'DCC')
 21535         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21536         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21537                                    NOT = 'G' AND 'D'))
 21538         GO TO 4840-EP-DO-AH-EP-NP
 21539     END-IF
 21540
 21541     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21542         MOVE 'A' TO AH-EARN-METHOD
 21543         GO TO 4845-EP-DO-AH-EP-AN.
 21544
 21545     GO TO 4860-EP-DO-AH-STATUTORY.
 21546
 21547 4840-EP-DO-AH-EP-NP.
 21548
 21549     IF WE-AHPRM = ZERO
 21550         GO TO 4860-EP-DO-AH-STATUTORY.
 21551
 21552     IF CR-APR GREATER THAN +0
 21553         NEXT SENTENCE
 21554     ELSE
 21555         GO TO 4860-EP-DO-AH-STATUTORY.
 21556
 21557     IF DTE-CLIENT = 'NCL'
 21558       IF CR-DT LESS THAN 19910101
 21559           GO TO 4860-EP-DO-AH-STATUTORY.
 21560
 21561     IF REM-TRM1 = CR-AH-TERM
 21562         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21563         GO TO 4899-EXIT.
 21564
 21565     MOVE CR-APR TO NP-APR.
 21566     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21567     MOVE REM-TRM1 TO NP-REM.
 21568     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21569     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21570         MOVE CR-LOAN-TERM TO NP-ORIG.
 21571
 21572     IF (DTE-CLIENT = 'DCC')
 21573        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21574        MOVE 'S'                 TO NP-OPT
 21575     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 417
* ECS010.cbl
 21576        MOVE 'R'                 TO NP-OPT
 21577     END-IF
 21578
 21579
 21580*    MOVE 'R' TO NP-OPT.
 21581     CALL 'ECSNETRM'
 21582         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21583
 21584     IF (DTE-CLIENT = 'DCC')
 21585        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21586        COMPUTE EPR-ST ROUNDED =
 21587           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21588        GO TO 4899-EXIT
 21589     ELSE
 21590        COMPUTE EPR-R78 ROUNDED =
 21591           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21592     END-IF
 21593
 21594     GO TO 4860-EP-DO-AH-STATUTORY.
 21595
 21596 4845-EP-DO-AH-EP-AN.
 21597     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21598     MOVE 'L'                        TO DC-OPTION-CODE.
 21599     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21600     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21601     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21602     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21603     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21604     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21605     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21606     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21607     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21608     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21609                                        CP-RATING-BENEFIT-AMT.
 21610     IF CP-STATE-STD-ABBRV = 'OR'
 21611         COMPUTE CP-RATING-BENEFIT-AMT =
 21612                                  CR-AHAMT * REM-TRM1.
 21613     MOVE CR-APR                     TO CP-LOAN-APR.
 21614     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21615     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21616     MOVE '3'                        TO CP-PROCESS-TYPE.
 21617     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21618     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21619     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21620         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21621     ELSE
 21622         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21623     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21624     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21625     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21626     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21627     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21628     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21629
 21630     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21631
 21632     IF CP-ERROR-RATE-NOT-FOUND  OR
 21633        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 418
* ECS010.cbl
 21634        CP-ERROR-IN-DATES
 21635         GO TO 4860-EP-DO-AH-STATUTORY.
 21636
 21637     COMPUTE EPR-R78 ROUNDED =
 21638             (REM-TRM1 * WE-AHAMT / +100 *
 21639               CP-PREMIUM-RATE)
 21640              / CR-AHPRM-CALC * CR-AHPRM
 21641
 21642     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21643
 21644     IF STATUTORY-REQUIREMENT-AH
 21645         MOVE EPR-R78                TO EPR-ST
 21646         GO TO 4899-EXIT.
 21647
 21648 4860-EP-DO-AH-STATUTORY.
 21649     IF (DTE-CLIENT EQUAL 'CID') AND
 21650        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21651         GO TO 4867-EP-DO-AH-STAT-ROA
 21652     END-IF.
 21653
 21654 4860-EP-DO-AH-STATUTORY-VA.
 21655
 21656     IF (DTE-CLIENT = 'DCC')
 21657        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21658        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21659        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21660        MOVE EPR-R78             TO EPR-ST
 21661        GO TO 4899-EXIT
 21662     END-IF
 21663
 21664     IF (DTE-CLIENT = 'DCC')
 21665        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21666        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21667        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21668        MOVE +1.0000                TO TEMP-6
 21669        IF REM-TRM1 < +9
 21670           COMPUTE TEMP-6 =
 21671              ((9 - (9 - REM-TRM1)) - 1)
 21672              * +.125
 21673        END-IF
 21674        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21675        MOVE EPR-ST              TO EPR-R78
 21676                                    EPR-PRO
 21677        GO TO 4899-EXIT
 21678     END-IF
 21679
 21680     MOVE EPR-R78                    TO EPR-ST.
 21681
 21682***  WE WANT R78 IN AH STAT FOR AHL
 21683
 21684     IF DTE-CLIENT = 'AHL'
 21685        GO TO 4899-EXIT
 21686     END-IF
 21687
 21688     MOVE +0                         TO SUB1.
 21689
 21690 4865-EP-AH-STAT-LOOP.
 21691     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 419
* ECS010.cbl
 21692
 21693     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21694         MOVE EPR-PRO                TO EPR-ST
 21695     ELSE
 21696         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21697             GO TO 4865-EP-AH-STAT-LOOP.
 21698
 21699     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21700         CR-DT GREATER THAN 19831031)  OR
 21701
 21702        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21703         CR-DT GREATER THAN 19820629)  OR
 21704
 21705        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21706         CR-DT GREATER THAN 19830831)  OR
 21707
 21708        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21709         CR-DT GREATER THAN 20091231)
 21710
 21711         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21712
 21713     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21714       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21715         IF CR-DT LESS THAN 19970101
 21716             MOVE EPR-R78            TO EPR-ST
 21717         ELSE
 21718             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21719
 21720     IF DTE-CLIENT = 'DCC'
 21721        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21722           MOVE EPR-PRO          TO EPR-ST
 21723        ELSE
 21724           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21725        END-IF
 21726     END-IF
 21727
 21728     IF (DTE-CLIENT = 'DCC')
 21729        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21730        CONTINUE
 21731     ELSE
 21732        GO TO 4899-EXIT
 21733     END-IF
 21734
 21735*    MOVE ' '                    TO DD-IU-SW
 21736
 21737     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21738                                    WS-DDF-CSO-ADMIN-FEE
 21739                                    WS-DDF-1ST-YR-TOT-EXP
 21740                                    WS-COMM-AND-MFEE
 21741
 21742     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21743        D1 > +10
 21744        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21745           AND (CR-LCOM-AH (D1) NUMERIC)
 21746           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21747              + (CR-LCOM-AH (D1) * +1000)
 21748        END-IF
 21749        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 420
* ECS010.cbl
 21750           AND (CR-LCOM-AH (D1) NUMERIC)
 21751           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21752              + (CR-LCOM-AH (D1) * +1000)
 21753        END-IF
 21754        IF (CR-AGT-TYPE (D1) = 'I' )
 21755           AND (CR-LCOM-AH (D1) NUMERIC)
 21756           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21757              + (CR-LCOM-AH (D1) * +1000)
 21758        END-IF
 21759        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21760           AND (CR-LCOM-AH (D1) NUMERIC)
 21761           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21762              + (CR-LCOM-AH (D1) * +1000)
 21763        END-IF
 21764     END-PERFORM
 21765
 21766     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21767     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21768
 21769     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21770                                 THRU 4910-EXIT
 21771
 21772     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21773        + WS-DDF-1ST-YR-TOT-EXP
 21774
 21775     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21776        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21777     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21778     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21779
 21780     MOVE 'D'                    TO CP-EARNING-METHOD
 21781     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21782     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21783     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21784     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21785     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21786
 21787     IF REIN-EP-FLG = 'R'
 21788        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21789        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21790        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21791     END-IF
 21792
 21793     IF DD-IU-PRESENT
 21794        MOVE 'I'              TO CP-EARNING-METHOD
 21795     END-IF
 21796
 21797     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21798                                 CP-CLP-RATE-UP
 21799
 21800
 21801     display ' cert no ' cr-cert-no
 21802     display ' rate up ' cp-iu-rate-up
 21803     display ' addl clp ' cr-addl-clp
 21804     display ' ah clp  ' cr-ah-clp
 21805     display ' orig prem ' cp-original-premium
 21806
 21807     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 421
* ECS010.cbl
 21808        AND (CP-IU-RATE-UP NOT = ZEROS)
 21809        COMPUTE CP-IU-RATE-UP =
 21810           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21811           / CP-ORIGINAL-PREMIUM))
 21812     END-IF
 21813
 21814     display ' here 4 '
 21815     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21816     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21817
 21818     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21819        + WS-DDF-1ST-YR-TOT-EXP
 21820
 21821     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21822
 21823     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21824
 21825     IF CP-DDF-SPEC-CALC = 'C'
 21826        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21827     ELSE
 21828        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21829        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21830        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21831        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21832        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21833        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21834     END-IF
 21835
 21836     display ' here 6 '
 21837     GO TO 4899-EXIT
 21838
 21839     .
 21840 4867-EP-DO-AH-STAT-ROA.
 21841     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21842     MOVE 'L'                        TO DC-OPTION-CODE.
 21843     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21844     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21845     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21846     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21847     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21848     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21849     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21850     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21851     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21852     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21853                                        CP-RATING-BENEFIT-AMT.
 21854     IF CP-STATE-STD-ABBRV = 'OR'
 21855         COMPUTE CP-RATING-BENEFIT-AMT =
 21856                                  CR-AHAMT * REM-TRM1.
 21857     MOVE CR-APR                     TO CP-LOAN-APR.
 21858     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21859     MOVE 'A'                        TO CP-EARNING-METHOD.
 21860     MOVE '3'                        TO CP-PROCESS-TYPE.
 21861     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21862     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21863     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21864         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21865     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 422
* ECS010.cbl
 21866         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21867     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21868     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21869     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21870     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21871     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21872     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21873
 21874     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21875
 21876     IF CP-ERROR-RATE-NOT-FOUND  OR
 21877        CP-ERROR-RATE-IS-ZERO  OR
 21878        CP-ERROR-IN-DATES
 21879         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21880
 21881     COMPUTE EPR-ST ROUNDED =
 21882             (REM-TRM1 * WE-AHAMT / +100 *
 21883               CP-PREMIUM-RATE)
 21884              / CR-AHPRM-CALC * CR-AHPRM
 21885
 21886     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 21887
 21888     GO TO 4899-EXIT.
 21889
 21890 4899-EXIT.
 21891     EXIT.
 21892******************************************************************
 21893***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 21894******************************************************************
 21895
 21896 4900-WRITE-SUMMARY-EXTRACTS.
 21897
 21898     IF DTE-CLIENT = 'HER'
 21899         IF EP-RECORD-ID = 'EC'  AND
 21900            EP-REINCO = 'LNL'
 21901             GO TO 4900-WRT-SUMMARY-X.
 21902
 21903     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 21904                                     WS-EP-RUN-DTE-N.
 21905
 21906     IF W-UNDERWRITTEN-DATA
 21907         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 21908     ELSE
 21909         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 21910
 21911     IF  DTE-OPT-RESERVE-METHOD-AUTH
 21912         IF VALID-EP-ID
 21913             MOVE 'Y'             TO EP-NEW-DATA-IND.
 21914
 21915     WRITE EP-RECORD.
 21916
 21917     ADD +1                       TO EP-CNT.
 21918
 21919 4900-WRT-SUMMARY-X.
 21920     EXIT.
 21921
 21922 4910-DCC-DFF-FACT-LOOKUP.
 21923
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 423
* ECS010.cbl
 21924     IF CR-CERT-NO = WS-FACT-CERT
 21925        go to 4910-exit
 21926     end-if
 21927
 21928     MOVE ' ' TO DD-IU-SW
 21929     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 21930        ((CR-STATE = DD-STATE (D1))
 21931        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 21932        AND ('A'           = DD-BEN-TYPE   (D1))
 21933        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 21934        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 21935                        OR
 21936        D1 > +800
 21937     END-PERFORM
 21938     IF D1 > +800
 21939        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 21940           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 21941        GO TO 4910-EXIT
 21942     END-IF
 21943
 21944     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 21945        (P1 > +8)
 21946        OR (DD-PROD-CODE (D1 P1) = 'I')
 21947     END-PERFORM
 21948     IF P1 < +9
 21949        display ' setting iu present to true '
 21950        SET DD-IU-PRESENT        TO TRUE
 21951     END-IF
 21952
 21953     MOVE CR-AH-TERM             TO WS-DDF-TERM
 21954     IF (CR-LOAN-TERM > WS-DDF-TERM)
 21955        AND (DD-TRUNCATED (D1) = 'Y')
 21956        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 21957        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 21958     END-IF
 21959
 21960     EVALUATE TRUE
 21961        WHEN WS-DDF-TERM > +168
 21962           MOVE 15               TO P1
 21963        WHEN WS-DDF-TERM > +156
 21964           MOVE 14               TO P1
 21965        WHEN WS-DDF-TERM > +144
 21966           MOVE 13               TO P1
 21967        WHEN WS-DDF-TERM > +132
 21968           MOVE 12               TO P1
 21969        WHEN WS-DDF-TERM > +120
 21970           MOVE 11               TO P1
 21971        WHEN WS-DDF-TERM > +108
 21972           MOVE 10               TO P1
 21973        WHEN WS-DDF-TERM > +96
 21974           MOVE 9                TO P1
 21975        WHEN WS-DDF-TERM > +84
 21976           MOVE 8                TO P1
 21977        WHEN WS-DDF-TERM > +72
 21978           MOVE 7                TO P1
 21979        WHEN WS-DDF-TERM > +60
 21980           MOVE 6                TO P1
 21981        WHEN WS-DDF-TERM > +48
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 424
* ECS010.cbl
 21982           MOVE 5                TO P1
 21983        WHEN WS-DDF-TERM > +36
 21984           MOVE 4                TO P1
 21985        WHEN WS-DDF-TERM > +24
 21986           MOVE 3                TO P1
 21987        WHEN WS-DDF-TERM > +12
 21988           MOVE 2                TO P1
 21989        WHEN OTHER
 21990           MOVE 1                TO P1
 21991     END-EVALUATE
 21992
 21993     EVALUATE TRUE
 21994*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 21995*          AND (DD-IU-PRESENT)
 21996*          MOVE 2                TO P2
 21997*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 21998*          MOVE 1                TO P2
 21999        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22000           MOVE 2                TO P2
 22001        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22002           MOVE 3                TO P2
 22003        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22004           MOVE 4                TO P2
 22005        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22006           MOVE 5                TO P2
 22007        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22008           MOVE 6                TO P2
 22009        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22010           MOVE 7                TO P2
 22011        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22012           MOVE 8                TO P2
 22013        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22014           MOVE 9                TO P2
 22015        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22016           MOVE 10               TO P2
 22017        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22018           MOVE 11               TO P2
 22019        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22020           MOVE 12               TO P2
 22021        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22022           MOVE 13               TO P2
 22023        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22024           MOVE 14               TO P2
 22025        WHEN OTHER
 22026           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22027           MOVE 15               TO P2
 22028     END-EVALUATE
 22029
 22030     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22031     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22032                                 TO WS-LO-UEF
 22033     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22034                                 TO WS-HI-UEF
 22035
 22036     .
 22037 4910-EXIT.
 22038     EXIT.
 22039
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 425
* ECS010.cbl
 22040******************************************************************
 22041***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22042******************************************************************
 22043
 22044 5000-DATE-RANGE-BREAK.
 22045
 22046     IF NO-TRANSACTION-WAS-PROCESSED
 22047         GO TO 5099-DATE-RANGE-BREAK-X.
 22048
 22049     ADD +1  TO RANGE-CNT.
 22050     MOVE +1 TO SUB6.
 22051     MOVE +2 TO SUB7.
 22052     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22053     IF LN-CNT GREATER +50
 22054         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22055                 8750-PRT-RANGE-HEADING.
 22056
 22057     MOVE SPACES                     TO PRT.
 22058     PERFORM 8800-PRINT-ROUTINE.
 22059     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22060     MOVE '  TOTALS'                 TO TPH3-DESC.
 22061     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22062     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22063     PERFORM 5900-CLEAR-TOTAL-PAGES
 22064         THRU 5999-CLEAR-TOTAL-PAGES-X
 22065             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22066
 22067 5099-DATE-RANGE-BREAK-X.
 22068     EXIT.
 22069
 22070 5100-ACCOUNT-BREAK.
 22071
 22072     IF RANGE-CNT NOT = +0
 22073         PERFORM 5000-DATE-RANGE-BREAK
 22074             THRU 5099-DATE-RANGE-BREAK-X
 22075     ELSE
 22076         MOVE +1 TO SUB6
 22077         MOVE +2 TO SUB7
 22078         PERFORM 5800-ADD-PAGES-LEVELS
 22079             THRU 5899-ADD-PAGES-LEVELS-X
 22080         PERFORM 5900-CLEAR-TOTAL-PAGES
 22081             THRU 5999-CLEAR-TOTAL-PAGES-X
 22082                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22083
 22084     MOVE +0 TO RANGE-CNT.
 22085     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22086         VARYING B-SUB FROM 1 BY 1
 22087             UNTIL B-SUB GREATER THAN 50  OR
 22088                   RB-COMPANY (B-SUB) = SPACES.
 22089     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22090         VARYING B-SUB FROM 1 BY 1
 22091             UNTIL B-SUB GREATER THAN 50.
 22092
 22093     IF ACCT-FLG = SPACE
 22094         GO TO 5199-ACCOUNT-BREAK-X.
 22095
 22096     MOVE SPACE TO ACCT-FLG.
 22097     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 426
* ECS010.cbl
 22098     MOVE +3 TO SUB7.
 22099     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22100     IF LN-CNT GREATER +50
 22101         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22102                 8725-PRT-ACCT-HEADING.
 22103
 22104     MOVE SPACES                     TO PRT.
 22105     PERFORM 8800-PRINT-ROUTINE.
 22106     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22107     MOVE ' TOTALS'                  TO TPH3-DESC.
 22108     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22109     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22110     PERFORM 5900-CLEAR-TOTAL-PAGES
 22111         THRU 5999-CLEAR-TOTAL-PAGES-X
 22112             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22113
 22114 5199-ACCOUNT-BREAK-X.
 22115     EXIT.
 22116
 22117 5200-STATE-BREAK.
 22118
 22119     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22120     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22121     MOVE +3 TO SUB6.
 22122     MOVE +4 TO SUB7.
 22123     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22124
 22125     IF STATE-FLG = SPACE
 22126         GO TO 5299-STATE-BREAK-X.
 22127
 22128     MOVE SPACE         TO STATE-FLG.
 22129     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22130     MOVE 'STATE'       TO TPH1-TYPE.
 22131     MOVE HLD-STATE     TO STATE-L.
 22132
 22133     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22134
 22135     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22136         MOVE SPACES          TO TPH1-DESC
 22137         MOVE HLD-STATE       TO TPH1-ST-CODE
 22138         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22139     ELSE
 22140         MOVE SPACES TO TPH1-DESC
 22141         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22142         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22143
 22144     MOVE 'STATE'  TO TPH2-DESC.
 22145     MOVE 'TOTALS' TO TPH3-DESC.
 22146     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22147     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22148     PERFORM 5900-CLEAR-TOTAL-PAGES
 22149         THRU 5999-CLEAR-TOTAL-PAGES-X
 22150             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22151
 22152 5299-STATE-BREAK-X.
 22153     EXIT.
 22154
 22155 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 427
* ECS010.cbl
 22156
 22157     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22158     MOVE +4 TO SUB6.
 22159     MOVE +5 TO SUB7.
 22160     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22161
 22162     IF COMP-FLG = SPACE
 22163         GO TO 5399-COMP-BREAK-X.
 22164
 22165     MOVE ' ' TO COMP-FLG.
 22166     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22167     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22168     MOVE HLD-GROUPING                TO TPH1-DESC.
 22169     MOVE 'COMPANY'                   TO TPH2-DESC.
 22170     MOVE ' TOTALS'                   TO TPH3-DESC.
 22171     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22172     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22173     PERFORM 5900-CLEAR-TOTAL-PAGES
 22174         THRU 5999-CLEAR-TOTAL-PAGES-X
 22175             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22176
 22177 5399-COMP-BREAK-X.
 22178     EXIT.
 22179
 22180 5400-CARR-BREAK.
 22181
 22182     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22183     MOVE +5 TO SUB6.
 22184     MOVE +6 TO SUB7.
 22185     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22186
 22187     IF CARR-FLG = SPACE
 22188         GO TO 5499-CARR-BREAK-X.
 22189
 22190     MOVE ' ' TO CARR-FLG.
 22191     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22192     MOVE 'CARRIER'               TO TPH1-TYPE.
 22193     MOVE HLD-CARRIER             TO TPH1-DESC.
 22194     MOVE 'CARRIER'               TO TPH2-DESC.
 22195     MOVE ' TOTALS'               TO TPH3-DESC.
 22196     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22197     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22198     PERFORM 5900-CLEAR-TOTAL-PAGES
 22199         THRU 5999-CLEAR-TOTAL-PAGES-X
 22200             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22201
 22202 5499-CARR-BREAK-X.
 22203     EXIT.
 22204
 22205 5500-FINAL-BREAK.
 22206
 22207     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22208
 22209     IF FINAL-FLG = SPACE
 22210         GO TO 5599-FINAL-BREAK-X.
 22211
 22212     IF DTE-FICH = '1'
 22213         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 428
* ECS010.cbl
 22214     MOVE +6 TO SUB6.
 22215     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22216     MOVE SPACES   TO TPH1-TYPE.
 22217     MOVE SPACES   TO TPH1-DESC.
 22218     MOVE 'FINAL'  TO TPH2-DESC.
 22219     MOVE 'TOTALS' TO TPH3-DESC.
 22220     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22221     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22222
 22223 5599-FINAL-BREAK-X.
 22224     EXIT.
 22225
 22226 5800-ADD-PAGES-LEVELS.
 22227
 22228     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22229     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22230     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22231     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22232     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22233     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22234     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22235     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22236
 22237 5899-ADD-PAGES-LEVELS-X.
 22238     EXIT.
 22239
 22240 5900-CLEAR-TOTAL-PAGES.
 22241
 22242     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22243             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22244             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22245             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22246
 22247 5999-CLEAR-TOTAL-PAGES-X.
 22248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 429
* ECS010.cbl
 22250******************************************************************
 22251***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22252******************************************************************
 22253
 22254 6000-TOTAL-PAGE-HEADINGS.
 22255
 22256     MOVE TOTAL-PAGE-HD1 TO PRT.
 22257     PERFORM 8800-PRINT-ROUTINE.
 22258
 22259 6100-ACCT-TOTAL-HEADINGS.
 22260
 22261     MOVE TOTAL-PAGE-HD2 TO PRT.
 22262     MOVE '0' TO P-CTL.
 22263     PERFORM 8800-PRINT-ROUTINE.
 22264     MOVE TOTAL-PAGE-HD3 TO PRT.
 22265     MOVE ' ' TO P-CTL.
 22266     PERFORM 8800-PRINT-ROUTINE.
 22267     PERFORM 8800-PRINT-ROUTINE.
 22268     MOVE +81 TO LN-CNT.
 22269
 22270 6199-PAGE-HEADINGS-X.
 22271     EXIT.
 22272
 22273 6500-PRINT-TOTAL-PAGE.
 22274
 22275     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22276     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22277     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22278
 22279     IF SUB6 = 6 AND ME-DO-UPDATE
 22280         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22281
 22282     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22283
 22284     IF SUB6 = 6 AND ME-DO-UPDATE
 22285         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22286
 22287     COMPUTE TPD-NET-PRM =
 22288         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22289
 22290     IF SUB6 = 6 AND ME-DO-UPDATE
 22291         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22292         GIVING ME-010-NET-L.
 22293
 22294     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22295
 22296     IF SUB6 = 6 AND ME-DO-UPDATE
 22297         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22298
 22299     COMPUTE TPD-PREM-COMP =
 22300         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22301                            - TPL-ACCT-COM (SUB6).
 22302     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22303
 22304     IF SUB6 = 6 AND ME-DO-UPDATE
 22305         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22306
 22307     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 430
* ECS010.cbl
 22308         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22309         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22310         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22311     END-IF.
 22312
 22313     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22314     PERFORM 8800-PRINT-ROUTINE.
 22315     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22316     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22317     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22318     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22319
 22320     IF SUB6 = 6 AND ME-DO-UPDATE
 22321         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22322         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22323
 22324     COMPUTE TPD-NET-PRM =
 22325         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22326
 22327     IF SUB6 = 6 AND ME-DO-UPDATE
 22328         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22329         GIVING ME-010-NET-AH.
 22330
 22331     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22332
 22333     IF SUB6 = 6 AND ME-DO-UPDATE
 22334         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22335
 22336     COMPUTE TPD-PREM-COMP =
 22337         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22338                            - TPA-ACCT-COM (SUB6).
 22339     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22340
 22341     IF SUB6 = 6 AND ME-DO-UPDATE
 22342         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22343
 22344     IF SUB6 = 6
 22345         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22346         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22347         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22348     END-IF.
 22349
 22350     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22351     PERFORM 8800-PRINT-ROUTINE.
 22352
 22353     MOVE 'TOTAL' TO TPD-DESC.
 22354
 22355     COMPUTE TPD-ISS-PRM =
 22356         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22357
 22358     COMPUTE TPD-CNC-PRM =
 22359         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22360
 22361     COMPUTE TPD-NET-PRM =
 22362         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22363         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22364
 22365     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 431
* ECS010.cbl
 22366         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22367
 22368     COMPUTE TPD-PREM-COMP =
 22369         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22370         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22371         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22372
 22373     COMPUTE TPD-CLAIMS =
 22374         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22375
 22376     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22377         NEXT SENTENCE
 22378     ELSE
 22379         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22380         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22381         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22382*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22383*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22384*        MOVE ZEROS               TO SV-LO-CERT
 22385*                                    SV-HI-CERT.
 22386
 22387     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22388     MOVE '0'                     TO P-CTL.
 22389     PERFORM 8800-PRINT-ROUTINE.
 22390     PERFORM 8800-PRINT-ROUTINE.
 22391
 22392 6599-TOTAL-PAGE-PRINT-X.
 22393     EXIT.
 22394*
 22395*
 22396*
 22397**START***********************************************************
 22398*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22399*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22400******************************************************************
 22401*
 22402 6650-GET-RES-STATE-COMM.
 22403*6650-BROWSE-FORWARD.
 22404
 22405     IF DTE-CLIENT NOT = 'DMD'
 22406         GO TO 6700-COMM-EXIT.
 22407
 22408     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22409     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22410     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22411     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22412     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22413     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22414     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22415     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22416
 22417     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22418
 22419*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22420*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22421*VALUE OF PB-CERT-EFF-DT
 22422*
 22423     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 432
* ECS010.cbl
 22424
 22425     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22426
 22427     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22428         GO TO 6700-COMM-EXIT.
 22429
 22430*GET RECORD WHERE POSITIONED
 22431
 22432 6650-READ-ERRESC-NEXT.
 22433     READ ERRESC-IN NEXT RECORD.
 22434
 22435     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22436         GO TO 6700-COMM-EXIT.
 22437
 22438*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22439
 22440     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22441        NEXT SENTENCE
 22442     ELSE
 22443         GO TO 6700-COMM-EXIT.
 22444
 22445     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22446         NEXT SENTENCE
 22447     ELSE
 22448         GO TO 6650-READ-ERRESC-NEXT.
 22449
 22450*  CR-DT  = WS-YYYYMMDD-DT
 22451*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22452*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22453
 22454     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22455         GO TO 6700-COMM-EXIT.
 22456
 22457* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22458
 22459     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22460
 22461     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22462
 22463     IF WS-SUB1 IS GREATER THAN ZERO
 22464         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22465             PERFORM 6680-SET-TABLE-CODE
 22466         ELSE
 22467             PERFORM 6680-SET-COMMISSION.
 22468
 22469     GO TO 6700-COMM-EXIT.
 22470
 22471 6680-SET-TABLE-CODE.
 22472     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22473        MOVE ZEROS             TO WS-SUB1
 22474     ELSE
 22475* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22476* TO COMPUTE AH COMMISSION.
 22477        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22478        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22479        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22480        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22481                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 433
* ECS010.cbl
 22482        PERFORM 6680-READ-CTBL-TABLE
 22483        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22484           MOVE ZEROS          TO WS-SUB1.
 22485
 22486 6680-READ-CTBL-TABLE.
 22487*
 22488* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22489* TO COMPUTE LIFE COMMISSION
 22490
 22491     IF CR-AHTYP = ZERO
 22492        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22493        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22494        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22495
 22496     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22497
 22498     IF ERCTBL-FILE-STATUS EQUAL '00'
 22499* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22500        IF CR-AHTYP NOT = ZERO
 22501             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22502             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22503             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22504             MOVE WK-RATE           TO WS-COMMISSION
 22505                                       PB-I-AH-COMMISSION
 22506        ELSE
 22507* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22508             MOVE CR-LFAMT    TO COMM-CK-AMT
 22509             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22510             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22511             MOVE WK-RATE     TO WS-COMMISSION
 22512                                 PB-I-LIFE-COMMISSION.
 22513
 22514 6680-SET-COMMISSION.
 22515     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22516           MOVE ZEROS         TO WS-SUB1
 22517       ELSE
 22518           MOVE RESC-COMMISSION-PER (WS-SUB)
 22519                              TO WS-COMMISSION WK-RATE
 22520           IF CR-AHTYP NOT = ZERO
 22521                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22522           ELSE
 22523                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22524
 22525 6680-SEARCH-CATEGORY.
 22526     ADD +1 TO WS-SUB.
 22527
 22528     IF WS-SUB IS GREATER THAN +12
 22529         GO TO 6680-EXIT.
 22530
 22531     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22532          MOVE WS-SUB         TO WS-SUB1
 22533          GO TO 6680-EXIT.
 22534
 22535     GO TO 6680-SEARCH-CATEGORY.
 22536
 22537 6680-EXIT.
 22538     EXIT.
 22539
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 434
* ECS010.cbl
 22540 6700-COMM-EXIT.
 22541     EXIT.
 22542*
 22543*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22544
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 435
* ECS010.cbl
 22546******************************************************************
 22547***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22548******************************************************************
 22549
 22550 7000-CLIENT-BILLING-ROUTINE.
 22551*
 22552*
 22553* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22554
 22555     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22556                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22557                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22558                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22559                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22560                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22561                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22562
 22563 7099-BILL-X.
 22564     EXIT.
 22565
 22566
 22567 7500-ADD-UP-REIN-CO.
 22568
 22569     IF RB-COMPANY (B-SUB) NOT = SPACES
 22570         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22571
 22572 7599-ADD-UP-REIN-X.
 22573     EXIT.
 22574
 22575 7900-CLEAR-BILLING-TABLE.
 22576
 22577     MOVE SPACES TO RB-COMPANY (B-SUB).
 22578     MOVE 0      TO RB-COUNT (B-SUB).
 22579
 22580 7999-CLEAR-BILLING-X.
 22581     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 436
* ECS010.cbl
 22583******************************************************************
 22584***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22585******************************************************************
 22586
 22587 8000-DATE-CONVERT-ROUTINE.
 22588
 22589     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22590
 22591 8099-DATE-CONVERT-X.
 22592     EXIT.
 22593
 22594 8000R-CONVERT-STOP-DATE.
 22595
 22596     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22597     MOVE 'L'                     TO DC-OPTION-CODE.
 22598     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22599     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22600     MOVE -1                      TO DC-ELAPSED-DAYS.
 22601     MOVE '6'                     TO DC-OPTION-CODE.
 22602     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22603     MOVE +0                      TO DC-ELAPSED-MONTHS
 22604                                     DC-ELAPSED-DAYS.
 22605     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22606     MOVE ' '                     TO DC-OPTION-CODE.
 22607     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22608
 22609     IF NO-CONVERSION-ERROR
 22610         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22611     ELSE
 22612         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22613                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22614                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22615         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22616                                  TO WS-ABEND-MESSAGE
 22617         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22618         MOVE 4002                TO WS-ABEND-CODE
 22619         GO TO ABEND-PGM.
 22620
 22621 8099R-STOP-DATE-X.
 22622     EXIT.
 22623
 22624
 22625 8100-GET-RATE.
 22626
 22627     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22628
 22629 8199-GET-RATE-X.
 22630     EXIT.
 22631
 22632
 22633 8200-STATE-CODE-LOOKUP.
 22634
 22635     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22636        CLAS-INDEXS NOT = ZERO
 22637         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22638             GO TO 8299-STATE-LOOKUP-X.
 22639
 22640     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 437
* ECS010.cbl
 22641
 22642 8250-STATE-LOOKUP-LOOP.
 22643
 22644     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22645         MOVE 0302 TO WS-ABEND-CODE
 22646         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22647         DISPLAY '******************************'
 22648         DISPLAY '***** ERROR LOCATION 022 *****'
 22649         DISPLAY '******************************'
 22650         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22651         GO TO ABEND-PGM.
 22652
 22653     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22654         ADD +1 TO CLAS-INDEXS
 22655         GO TO 8250-STATE-LOOKUP-LOOP.
 22656
 22657 8299-STATE-LOOKUP-X.
 22658     EXIT.
 22659
 22660
 22661 8300-LIFE-TYPE-LOOKUP.
 22662
 22663     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22664        CLAS-INDEXL NOT = ZERO
 22665         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22666             GO TO 8399-LIFE-LOOKUP-X.
 22667
 22668     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22669
 22670 8350-LIFE-LOOKUP-LOOP.
 22671
 22672     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22673         MOVE 0401 TO WS-ABEND-CODE
 22674         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22675         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22676         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22677         DISPLAY '******************************'
 22678         DISPLAY '***** ERROR LOCATION 023 *****'
 22679         DISPLAY '******************************'
 22680         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22681         IF DTE-CLIENT = 'NCL'
 22682                      OR 'CID' OR 'AHL'
 22683             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22684             MOVE '05'             TO CLAS-LOOK
 22685             GO TO 8350-LIFE-LOOKUP-LOOP
 22686         ELSE
 22687             GO TO ABEND-PGM.
 22688
 22689     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22690         ADD +1 TO CLAS-INDEXL
 22691         GO TO 8350-LIFE-LOOKUP-LOOP.
 22692
 22693     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22694         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22695
 22696 8399-LIFE-LOOKUP-X.
 22697     EXIT.
 22698
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 438
* ECS010.cbl
 22699
 22700 8400-A-H-TYPE-LOOKUP.
 22701
 22702     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22703        CLAS-INDEXA NOT = ZERO
 22704         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22705             GO TO 8499-A-H-LOOKUP-X.
 22706
 22707     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22708
 22709 8450-A-H-LOOKUP-LOOP.
 22710
 22711     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22712         MOVE 0402 TO WS-ABEND-CODE
 22713         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22714         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22715         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22716         DISPLAY '******************************'
 22717         DISPLAY '***** ERROR LOCATION 024 *****'
 22718         DISPLAY '******************************'
 22719         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22720         IF DTE-CLIENT = 'NCL'
 22721             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22722             MOVE '05'             TO CLAS-LOOK
 22723             GO TO 8450-A-H-LOOKUP-LOOP
 22724         ELSE
 22725             GO TO ABEND-PGM.
 22726
 22727     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22728         ADD +1 TO CLAS-INDEXA
 22729         GO TO 8450-A-H-LOOKUP-LOOP.
 22730
 22731 8499-A-H-LOOKUP-X.
 22732     EXIT.
 22733
 22734 8500-REMAINING-TERM-ROUTINE.
 22735
 22736     MOVE ZEROS                      TO CP-REMAINING-TERM
 22737                                        CP-REMAINING-TERM-1
 22738                                        CP-REMAINING-TERM-2
 22739                                        CP-REMAINING-TERM-3
 22740                                        CP-RETURN-CODE
 22741                                        CP-RETURN-CODE-2
 22742                                        REM-TRM1
 22743                                        REM-TRM2
 22744                                        REM-TRM3
 22745                                        TEM-TRM1.
 22746     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22747
 22748     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22749     MOVE 'L'                        TO DC-OPTION-CODE.
 22750     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22751
 22752     IF  NO-CONVERSION-ERROR
 22753         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22754     ELSE
 22755         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22756                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 439
* ECS010.cbl
 22757         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22758         MOVE 3001                   TO WS-ABEND-CODE
 22759         GO TO ABEND-PGM.
 22760
 22761     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22762
 22763     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22764         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22765
 22766     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22767         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22768         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22769                                        DC-ELAPSED-DAYS
 22770         MOVE '3'                    TO DC-OPTION-CODE
 22771         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22772                 8099-DATE-CONVERT-X
 22773         IF  NO-CONVERSION-ERROR
 22774             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22775         ELSE
 22776             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22777
 22778     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22779         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22780
 22781     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22782         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22783         MOVE +1                     TO DC-ELAPSED-MONTHS
 22784         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22785         MOVE '6'                    TO DC-OPTION-CODE
 22786         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22787                 8099-DATE-CONVERT-X
 22788         IF  NO-CONVERSION-ERROR
 22789             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22790             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22791         ELSE
 22792             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22793                                     TO WS-ABEND-MESSAGE
 22794             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22795             MOVE 3002               TO WS-ABEND-CODE
 22796             GO TO ABEND-PGM.
 22797
 22798     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22799     MOVE 'L'                        TO DC-OPTION-CODE.
 22800     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22801
 22802     IF  NO-CONVERSION-ERROR
 22803         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22804     ELSE
 22805         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22806             W-VAL-ERROR (W-VAL-SOURCE)
 22807         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22808             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22809             DC-ERROR-CODE
 22810         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22811         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22812             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22813             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22814             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 440
* ECS010.cbl
 22815*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22816*                                    TO WS-ABEND-MESSAGE
 22817*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22818*        MOVE 3003                   TO WS-ABEND-CODE
 22819*        GO TO ABEND-PGM.
 22820
 22821     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22822     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22823     MOVE '3'                        TO CP-PROCESS-TYPE.
 22824     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22825     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22826     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22827
 22828*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22829*                                    TO CP-REM-TERM-METHOD.
 22830
 22831     IF  DTE-CLIENT = 'FIM'
 22832         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22833
 22834     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22835         IF WE-LF-AH = AH-OVERRIDE-L1
 22836             MOVE '2'                TO CP-REM-TERM-METHOD
 22837         ELSE
 22838             IF CR-LFTYP = '01' OR '03'
 22839                 MOVE '4'            TO CP-REM-TERM-METHOD
 22840             ELSE
 22841                 IF CR-LFTYP = '02' OR '04'
 22842                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22843
 22844     IF  DTE-CLIENT = 'CSL'
 22845         IF  CR-CARRIER = '2'
 22846             IF  CR-LFTYP = '07' OR  '08'
 22847                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22848
 22849     IF  DTE-CLIENT = 'POS'
 22850         IF  CR-CARRIER = '1'
 22851             MOVE '1'                TO CP-REM-TERM-METHOD
 22852         ELSE
 22853             MOVE '2'                TO CP-REM-TERM-METHOD.
 22854
 22855     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22856         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22857
 22858     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22859         GO TO 8540-CALC-REM-TERM-AH.
 22860
 22861 8520-CALC-REM-TERM-LIFE.
 22862
 22863     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22864     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22865     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22866*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22867     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22868                                        CP-LOAN-TERM.
 22869
 22870     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22871             AND
 22872         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 441
* ECS010.cbl
 22873         ADD +1                      TO CP-ORIGINAL-TERM
 22874                                        CP-LOAN-TERM.
 22875
 22876     IF  CP-TERM-IS-DAYS
 22877         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22878     ELSE
 22879         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 22880
 22881     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22882
 22883     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22884         ADD +1                      TO W-ORGTRM-0-LF
 22885         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 22886             CR-FULL-CONTROL
 22887         GO TO 8599-REM-TERM-X.
 22888
 22889     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22890
 22891     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22892         ADD +1                      TO W-RET-CODE-LF
 22893         GO TO 8599-REM-TERM-X.
 22894*
 22895*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 22896*                                    TO WS-ABEND-MESSAGE
 22897*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22898*        MOVE 2002                   TO WS-ABEND-CODE
 22899*        GO TO ABEND-PGM.
 22900
 22901     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22902             AND
 22903         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 22904         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 22905         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 22906         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 22907
 22908     IF  CP-REMAINING-TERM-1 NEGATIVE
 22909         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 22910
 22911     IF  CP-REMAINING-TERM-2 NEGATIVE
 22912         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 22913
 22914     IF DTE-CLIENT = 'NCL'
 22915         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22916                                        CP-REMAINING-TERM-3.
 22917
 22918     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22919     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22920     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22921     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22922
 22923     GO TO 8599-REM-TERM-X.
 22924
 22925 8520-EXIT.
 22926     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 442
* ECS010.cbl
 22928 8540-CALC-REM-TERM-AH.
 22929
 22930     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 22931     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 22932     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 22933     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 22934                                        CP-LOAN-TERM.
 22935     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 22936
 22937     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22938
 22939     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22940         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 22941             CR-FULL-CONTROL
 22942         ADD +1                      TO W-ORGTRM-0-AH
 22943         GO TO 8599-REM-TERM-X.
 22944
 22945     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22946
 22947     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22948         ADD +1                      TO W-RET-CODE-AH
 22949         GO TO 8599-REM-TERM-X.
 22950*
 22951*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 22952*                                    TO WS-ABEND-MESSAGE
 22953*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22954*        MOVE 2001                   TO WS-ABEND-CODE
 22955*        GO TO ABEND-PGM.
 22956
 22957     IF DTE-CLIENT = 'NCL'
 22958         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22959                                        CP-REMAINING-TERM-3.
 22960
 22961     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22962     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22963     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22964     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22965
 22966 8599-REM-TERM-X.
 22967     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 443
* ECS010.cbl
 22969
 22970******************************************************************
 22971***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 22972******************************************************************
 22973
 22974 8600-DISPLAY-PRT.
 22975
 22976     IF  DIS-LINE-CNT GREATER THAN 59
 22977         PERFORM 8600-DISPLAY-HD THRU
 22978             8600-HD-EXIT.
 22979
 22980     ADD  1  TO DIS-LINE-CNT.
 22981     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 22982     MOVE  SPACES TO DISPLAY-REC
 22983                     DISPLAY-LINE.
 22984
 22985 8600-DISPLAY-EXIT.
 22986     EXIT.
 22987
 22988
 22989 8600-DISPLAY-HD.
 22990
 22991     MOVE '1'  TO  DISPLAY-CC.
 22992     MOVE ZEROS TO DIS-LINE-CNT.
 22993     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 22994     ADD +1 TO DIS-LINE-CNT.
 22995     MOVE ' '  TO  DISPLAY-CC.
 22996     MOVE SPACES TO DISPLAY-REC.
 22997     WRITE DISPLAY-REC.
 22998     ADD +1 TO DIS-LINE-CNT.
 22999     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23000     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23001     ADD +1 TO DIS-LINE-CNT.
 23002     MOVE SPACES TO DISPLAY-REC.
 23003     ADD +1 TO DIS-LINE-CNT.
 23004     WRITE DISPLAY-REC.
 23005
 23006 8600-HD-EXIT.
 23007     EXIT.
 23008
 23009******************************************************************
 23010***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23011******************************************************************
 23012
 23013 8600-SETUP-DETAIL-LINE.
 23014
 23015     MOVE SPACES                TO TR-DTL2.
 23016
 23017     MOVE CR-CERT-NO            TO TRD-CERT.
 23018     MOVE CR-YR                 TO TRD-ISYR.
 23019     MOVE CR-MO                 TO TRD-ISMO.
 23020     MOVE CR-DA                 TO TRD-ISDA.
 23021     MOVE CR-AGE                TO TRD-AGE.
 23022
 23023 8689-SETUP-DETAIL-X.
 23024     EXIT.
 23025
 23026 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 444
* ECS010.cbl
 23027
 23028     IF LN-CNT GREATER THAN LN-MX
 23029         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23030                 8799-PRT-HEADINGS-X.
 23031     MOVE TRD-CERT TO SV-TRD-CERT.
 23032     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23033
 23034     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23035         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23036
 23037     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23038     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23039     MOVE TR-DTL TO PRT.
 23040
 23041     IF NOT WS-CHANGE-REC
 23042         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23043     ELSE
 23044         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23045
 23046     PERFORM 8800-PRINT-ROUTINE.
 23047
 23048 8699-PRT-DETAIL-X.
 23049     EXIT.
 23050
 23051 8700-PRINT-REPORT-HEADINGS.
 23052     ADD +1 TO PG-CNT.
 23053     MOVE PG-CNT TO TR-PG.
 23054     MOVE +0 TO LN-CNT.
 23055     MOVE TR-HD-1 TO PRT.
 23056     PERFORM 8800-PRINT-ROUTINE.
 23057     MOVE TR-HD-2 TO PRT.
 23058     PERFORM 8800-PRINT-ROUTINE.
 23059     MOVE TR-HD-3 TO PRT.
 23060     PERFORM 8800-PRINT-ROUTINE.
 23061     ADD +1 TO LN-CNT.
 23062
 23063 8725-PRT-ACCT-HEADING.
 23064     MOVE TR-HD-4 TO PRT.
 23065     PERFORM 8800-PRINT-ROUTINE.
 23066     MOVE TR-HD-5 TO PRT.
 23067     PERFORM 8800-PRINT-ROUTINE.
 23068
 23069 8750-PRT-RANGE-HEADING.
 23070     MOVE TR-HD-6 TO PRT.
 23071     PERFORM 8800-PRINT-ROUTINE.
 23072
 23073 8775-PRT-COLUMN-HEADINGS.
 23074     MOVE TR-HD-7 TO PRT.
 23075     PERFORM 8800-PRINT-ROUTINE.
 23076     MOVE TR-HD-8 TO PRT.
 23077     PERFORM 8800-PRINT-ROUTINE.
 23078     MOVE TR-HD-9 TO PRT.
 23079     PERFORM 8800-PRINT-ROUTINE.
 23080     PERFORM 8800-PRINT-ROUTINE.
 23081
 23082 8799-PRT-HEADINGS-X.
 23083     EXIT.
 23084
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 445
* ECS010.cbl
 23085 8800-PRINT-ROUTINE.
 23086     MOVE P-CTL TO X.
 23087     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23088     ADD +1 TO LN-CNT.
 23089     MOVE SPACES TO PRT.
 23090
 23091 8900-PRINT-A-LINE.
*23092                             COPY ELCPRT2.
 23093******************************************************************04/15/98
 23094*                                                                *ELCPRT2
 23095*                                                                *ELCPRT2
 23096*                            ELCPRT2                             *   LV005
 23097*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23098*                            VMOD=2.002                          *   CL**5
 23099*                                                                *   CL**4
 23100******************************************************************   CL**4
 23101                                                                     CL**4
 23102     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23103        FICH-OPEN    = SPACE                                         CL**4
 23104         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23105         OPEN OUTPUT FICH.                                           CL**4
 23106                                                                     CL**4
 23107     IF DTE-FICH NOT = SPACE                                         CL**4
 23108         MOVE X                  TO  P-CTL                           CL**4
 23109         WRITE FICH-REC FROM PRT.                                    CL**4
 23110                                                                     CL**4
 23111     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23112       MOVE X                    TO  P-CTL                           CL**4
 23113       IF P-CTL = ' '                                                CL**4
 23114         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23115       ELSE                                                          CL**4
 23116         IF P-CTL = '0'                                              CL**4
 23117           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23118         ELSE                                                        CL**4
 23119           IF P-CTL = '-'                                            CL**4
 23120             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23121           ELSE                                                      CL**4
 23122             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23123                                                                     CL**4
 23124******************************************************************   CL**4
 23125
 23126 8999-PRT-LINE-X.
 23127     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 446
* ECS010.cbl
 23129******************************************************************
 23130***          E N D   O F   J O B   P R O C E S S I N G         ***
 23131******************************************************************
 23132
 23133 9910-EOJ-1.
 23134     IF TR-CNT = ZERO
 23135         IF (DTE-PGM-OPT = '2' OR '3') OR
 23136            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23137                          'ITY' OR 'DAC' OR 'FLC')
 23138             NEXT SENTENCE
 23139         ELSE
 23140             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23141             MOVE 0703                    TO WS-ABEND-CODE
 23142             DISPLAY '******************************'
 23143             DISPLAY '***** ERROR LOCATION 025 *****'
 23144             DISPLAY '******************************'
 23145             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23146             GO TO ABEND-PGM.
 23147
 23148     MOVE '*'         TO TRANS-EOF-FLAG.
 23149     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23150
 23151     IF EOF-ON-CERT
 23152         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23153         GO TO 9940-EOJ-FIN.
 23154
 23155     GO TO 0330-MATCH-PENDING-TO-CERT.
 23156
 23157 9920-EOJ-2.
 23158     MOVE '*'         TO CERT-EOF-FLAG.
 23159     MOVE HIGH-VALUES TO CIR-CONTROL.
 23160
 23161     IF EOF-ON-TRANS
 23162         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23163         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23164         GO TO 9940-EOJ-FIN.
 23165
 23166     GO TO 0299-READ-CERT-X.
 23167
 23168 9930-EOJ-3.
 23169     IF PROCESSING-COMPLETED
 23170         GO TO 9950-EOJ-FIN-GO.
 23171
 23172     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23173     MOVE 'MISSING ACCOUNT MASTER'
 23174                               TO WS-ABEND-MESSAGE.
 23175     MOVE 0302                 TO WS-ABEND-CODE.
 23176     DISPLAY '******************************'
 23177     DISPLAY '***** ERROR LOCATION 026 *****'
 23178     DISPLAY '******************************'
 23179     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23180     GO TO ABEND-PGM.
 23181
 23182 9940-EOJ-FIN.
 23183     MOVE '*'        TO PROCESSING-FLAG.
 23184     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23185
 23186     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 447
* ECS010.cbl
 23187             0199-READ-ACCOUNT-X.
 23188     GO TO 9940-EOJ-FIN.
 23189
 23190 9950-EOJ-FIN-GO.
 23191     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23192     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23193*
 23194*
 23195* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23196     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23197
 23198 9960-NO-TOTS.
 23199
 23200     MOVE +15                    TO LN-CNT.
 23201     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23202     IF ME-DO-UPDATE
 23203         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23204
 23205     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23206     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23207     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23208
 23209
 23210     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23211     MOVE TR-TTL-HD              TO PRT.
 23212     PERFORM 8800-PRINT-ROUTINE.
 23213     ADD +1 TO LN-CNT.
 23214     MOVE TR-CNT                TO TTL-PT-CNT.
 23215     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23216     MOVE TR-TTL-HD             TO PRT.
 23217     PERFORM 8800-PRINT-ROUTINE.
 23218     ADD +1 TO LN-CNT.
 23219
 23220     IF DUP-CNT = ZERO
 23221         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23222
 23223     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23224
 23225     IF ME-DO-UPDATE
 23226         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23227
 23228     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23229     MOVE TR-TTL-HD               TO PRT.
 23230     PERFORM 8800-PRINT-ROUTINE.
 23231     PERFORM 8800-PRINT-ROUTINE.
 23232     ADD +1 TO LN-CNT.
 23233
 23234     MOVE '1'                           TO  DTL-REC-TYPE.
 23235     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23236     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23237     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23238                                        TO  DTL-CERT-OUT-CONTROL.
 23239     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23240     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23241     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23242
 23243     MOVE +1 TO SUB3.
 23244 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 448
* ECS010.cbl
 23245
 23246     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23247         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23248         MOVE MISMATCH-PAGE-NUMBER
 23249                                 TO  TR-PG
 23250         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23251         MOVE MR-CTL             TO  X
 23252         MOVE X TO LCP-ASA
 23253         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23254             THRU LCP-WRITE-END-MISMATCH-RPT
 23255         MOVE TR-HD-2            TO  MISMATCH-RPT
 23256         MOVE MR-CTL             TO  X
 23257         MOVE X TO LCP-ASA
 23258         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23259             THRU LCP-WRITE-END-MISMATCH-RPT
 23260         MOVE TR-HD-3            TO  MISMATCH-RPT
 23261         MOVE MR-CTL             TO  X
 23262         MOVE X TO LCP-ASA
 23263         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23264             THRU LCP-WRITE-END-MISMATCH-RPT
 23265         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23266         MOVE MR-CTL             TO  X
 23267         MOVE X TO LCP-ASA
 23268         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23269             THRU LCP-WRITE-END-MISMATCH-RPT
 23270         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23271
 23272     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23273
 23274     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23275     MOVE MR-CTL                        TO  X.
 23276     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23277
 23278     MOVE X TO LCP-ASA
 23279     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23280         THRU LCP-WRITE-END-MISMATCH-RPT.
 23281
 23282     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23283     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23284
 23285     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23286     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23287
 23288     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23289     IF  DUPE-STATUS (SUB3)  =  '2'
 23290         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23291     IF  DUPE-STATUS (SUB3)  =  '5'
 23292         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23293     IF  DUPE-STATUS (SUB3)  =  'M'
 23294         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23295     IF  DUPE-STATUS (SUB3)  =  '9'
 23296         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23297     IF  DUPE-STATUS (SUB3)  =  'D'
 23298         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23299     IF  DUPE-STATUS (SUB3)  =  'V'
 23300         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23301     IF  DUPE-STATUS (SUB3)  =  'P'
 23302         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 449
* ECS010.cbl
 23303
 23304     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23305     MOVE MR-CTL                        TO  X.
 23306     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23307
 23308     MOVE X TO LCP-ASA
 23309     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23310         THRU LCP-WRITE-END-MISMATCH-RPT.
 23311
 23312     IF SUB3 LESS THAN DUP-CNT
 23313         ADD +1 TO SUB3
 23314         GO TO 9965-PRT-DUPES.
 23315
 23316 9969-CHECK-MISMATCHED-TOTS.
 23317
 23318     IF W-MM-LF-PRM = ZEROS  AND
 23319        W-MM-AH-PRM = ZEROS  AND
 23320        W-MM-LF-RFD = ZEROS  AND
 23321        W-MM-AH-RFD = ZEROS  AND
 23322        W-MM-LF-CLM = ZEROS  AND
 23323        W-MM-AH-CLM = ZEROS
 23324         GO TO 9970-FIN-TOTS.
 23325
 23326     MOVE SPACES                        TO  MISMATCH-RPT.
 23327     MOVE '0'                           TO  MR-CTL  X.
 23328     MOVE X TO LCP-ASA
 23329     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23330         THRU LCP-WRITE-END-MISMATCH-RPT.
 23331
 23332     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23333     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23334     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23335
 23336     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23337     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23338     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23339
 23340     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23341     MOVE '0'                           TO  MR-CTL  X.
 23342     MOVE X TO LCP-ASA
 23343     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23344         THRU LCP-WRITE-END-MISMATCH-RPT.
 23345
 23346     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23347     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23348     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23349
 23350     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23351     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23352     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23353
 23354     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23355     MOVE '0'                           TO  MR-CTL  X.
 23356     MOVE X TO LCP-ASA
 23357     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23358         THRU LCP-WRITE-END-MISMATCH-RPT.
 23359
 23360     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 450
* ECS010.cbl
 23361     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23362     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23363
 23364     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23365     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23366     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23367
 23368     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23369     MOVE '0'                           TO  MR-CTL  X.
 23370     MOVE X TO LCP-ASA
 23371     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23372         THRU LCP-WRITE-END-MISMATCH-RPT.
 23373
 23374 9970-FIN-TOTS.
 23375
 23376     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23377
 23378     IF ME-DO-UPDATE
 23379         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23380
 23381     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23382     MOVE TR-TTL-HD               TO PRT.
 23383     PERFORM 8800-PRINT-ROUTINE.
 23384
 23385     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23386     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23387     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23388     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23389
 23390     MOVE DE-CNT                  TO TTL-PT-CNT.
 23391     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23392     MOVE TR-TTL-HD               TO PRT.
 23393     PERFORM 8800-PRINT-ROUTINE.
 23394
 23395     MOVE EP-CNT                  TO TTL-PT-CNT.
 23396     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23397     MOVE TR-TTL-HD               TO PRT.
 23398     PERFORM 8800-PRINT-ROUTINE.
 23399     PERFORM 8800-PRINT-ROUTINE.
 23400
 23401     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23402     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23403     MOVE TR-TTL-HD               TO PRT.
 23404     PERFORM 8800-PRINT-ROUTINE.
 23405
 23406     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23407     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23408     MOVE TR-TTL-HD               TO PRT.
 23409     PERFORM 8800-PRINT-ROUTINE.
 23410
 23411     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23412     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23413     MOVE TR-TTL-HD               TO PRT.
 23414     PERFORM 8800-PRINT-ROUTINE.
 23415
 23416     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23417         GO TO 9990-FINAL-CLOSE.
 23418
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 451
* ECS010.cbl
 23419**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23420**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23421**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23422**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23423
 23424     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23425     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23426     MOVE TR-TTL-HD               TO PRT.
 23427     PERFORM 8800-PRINT-ROUTINE.
 23428
 23429     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23430     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23431     MOVE TR-TTL-HD               TO PRT.
 23432     PERFORM 8800-PRINT-ROUTINE.
 23433
 23434     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23435     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23436     MOVE TR-TTL-HD               TO PRT.
 23437     PERFORM 8800-PRINT-ROUTINE.
 23438
 23439     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23440     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23441     MOVE TR-TTL-HD               TO PRT.
 23442     PERFORM 8800-PRINT-ROUTINE.
 23443
 23444     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23445     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23446     MOVE TR-TTL-HD               TO PRT.
 23447     PERFORM 8800-PRINT-ROUTINE.
 23448
 23449     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23450     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23451     MOVE TR-TTL-HD               TO PRT.
 23452     PERFORM 8800-PRINT-ROUTINE.
 23453
 23454     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23455     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23456     MOVE TR-TTL-HD               TO PRT.
 23457     PERFORM 8800-PRINT-ROUTINE.
 23458
 23459     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23460     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23461     MOVE TR-TTL-HD               TO PRT.
 23462     PERFORM 8800-PRINT-ROUTINE.
 23463
 23464     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23465     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23466     MOVE TR-TTL-HD               TO PRT.
 23467     PERFORM 8800-PRINT-ROUTINE.
 23468
 23469     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23470     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23471     MOVE TR-TTL-HD               TO PRT.
 23472     PERFORM 8800-PRINT-ROUTINE.
 23473
 23474     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23475     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23476     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 452
* ECS010.cbl
 23477     PERFORM 8800-PRINT-ROUTINE.
 23478
 23479     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23480     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23481     MOVE TR-TTL-HD               TO PRT.
 23482     PERFORM 8800-PRINT-ROUTINE.
 23483
 23484     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23485     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23486     MOVE TR-TTL-HD               TO PRT.
 23487     PERFORM 8800-PRINT-ROUTINE.
 23488
 23489     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23490     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23491     MOVE TR-TTL-HD               TO PRT.
 23492     PERFORM 8800-PRINT-ROUTINE.
 23493
 23494     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23495     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23496     MOVE TR-TTL-HD               TO PRT.
 23497     PERFORM 8800-PRINT-ROUTINE.
 23498
 23499     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23500     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23501     MOVE TR-TTL-HD               TO PRT.
 23502     PERFORM 8800-PRINT-ROUTINE.
 23503
 23504     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23505     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23506     MOVE TR-TTL-HD               TO PRT.
 23507     PERFORM 8800-PRINT-ROUTINE.
 23508
 23509     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23510     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23511     MOVE TR-TTL-HD               TO PRT.
 23512     PERFORM 8800-PRINT-ROUTINE.
 23513
 23514     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23515     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23516     MOVE TR-TTL-HD               TO PRT.
 23517     PERFORM 8800-PRINT-ROUTINE.
 23518
 23519     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23520     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23521     MOVE TR-TTL-HD               TO PRT.
 23522     PERFORM 8800-PRINT-ROUTINE.
 23523
 23524     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23525     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23526     MOVE TR-TTL-HD               TO PRT.
 23527     PERFORM 8800-PRINT-ROUTINE.
 23528
 23529     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23530     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23531     MOVE TR-TTL-HD               TO PRT.
 23532     PERFORM 8800-PRINT-ROUTINE.
 23533
 23534     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 453
* ECS010.cbl
 23535     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23536     MOVE TR-TTL-HD               TO PRT.
 23537     PERFORM 8800-PRINT-ROUTINE.
 23538
 23539     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23540     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23541     MOVE TR-TTL-HD               TO PRT.
 23542     PERFORM 8800-PRINT-ROUTINE.
 23543
 23544     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23545     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23546     MOVE TR-TTL-HD               TO PRT.
 23547     PERFORM 8800-PRINT-ROUTINE.
 23548
 23549     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23550     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23551     MOVE TR-TTL-HD               TO PRT.
 23552     PERFORM 8800-PRINT-ROUTINE.
 23553
 23554     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23555     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23556     MOVE TR-TTL-HD               TO PRT.
 23557     PERFORM 8800-PRINT-ROUTINE.
 23558
 23559     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23560     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23561     MOVE TR-TTL-HD               TO PRT.
 23562     PERFORM 8800-PRINT-ROUTINE.
 23563
 23564     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23565     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23566     MOVE TR-TTL-HD               TO PRT.
 23567     PERFORM 8800-PRINT-ROUTINE.
 23568
 23569     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23570     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23571     MOVE TR-TTL-HD               TO PRT.
 23572     PERFORM 8800-PRINT-ROUTINE.
 23573
 23574     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23575     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23576     MOVE TR-TTL-HD               TO PRT.
 23577     PERFORM 8800-PRINT-ROUTINE.
 23578
 23579     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23580     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23581     MOVE TR-TTL-HD               TO PRT.
 23582     PERFORM 8800-PRINT-ROUTINE.
 23583
 23584     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23585     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23586     MOVE TR-TTL-HD               TO PRT.
 23587     PERFORM 8800-PRINT-ROUTINE.
 23588
 23589     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23590     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23591     MOVE TR-TTL-HD               TO PRT.
 23592     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 454
* ECS010.cbl
 23593
 23594     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23595     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23596     MOVE TR-TTL-HD               TO PRT.
 23597     PERFORM 8800-PRINT-ROUTINE.
 23598
 23599     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23600     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23601     MOVE TR-TTL-HD               TO PRT.
 23602     PERFORM 8800-PRINT-ROUTINE.
 23603
 23604     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23605     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23606     MOVE TR-TTL-HD               TO PRT.
 23607     PERFORM 8800-PRINT-ROUTINE.
 23608
 23609     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23610     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23611     MOVE TR-TTL-HD               TO PRT.
 23612     PERFORM 8800-PRINT-ROUTINE.
 23613
 23614     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23615     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23616     MOVE TR-TTL-HD               TO PRT.
 23617     PERFORM 8800-PRINT-ROUTINE.
 23618
 23619     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23620     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23621                                  TO TTL-HD-DS.
 23622     MOVE TR-TTL-HD               TO PRT.
 23623     PERFORM 8800-PRINT-ROUTINE.
 23624
 23625     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23626     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23627                                  TO TTL-HD-DS.
 23628     MOVE TR-TTL-HD               TO PRT.
 23629     PERFORM 8800-PRINT-ROUTINE.
 23630
 23631     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23632     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23633                                  TO TTL-HD-DS.
 23634     MOVE TR-TTL-HD               TO PRT.
 23635     PERFORM 8800-PRINT-ROUTINE.
 23636
 23637     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23638     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23639                                  TO TTL-HD-DS.
 23640     MOVE TR-TTL-HD               TO PRT.
 23641     PERFORM 8800-PRINT-ROUTINE.
 23642
 23643     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23644     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23645                                  TO TTL-HD-DS.
 23646     MOVE TR-TTL-HD               TO PRT.
 23647     PERFORM 8800-PRINT-ROUTINE.
 23648
 23649     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23650     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 455
* ECS010.cbl
 23651                                  TO TTL-HD-DS.
 23652     MOVE TR-TTL-HD               TO PRT.
 23653     PERFORM 8800-PRINT-ROUTINE.
 23654
 23655     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23656     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23657     MOVE TR-TTL-HD               TO PRT.
 23658     PERFORM 8800-PRINT-ROUTINE.
 23659
 23660     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23661     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23662     MOVE TR-TTL-HD               TO PRT.
 23663     PERFORM 8800-PRINT-ROUTINE.
 23664
 23665     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23666     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23667     MOVE TR-TTL-HD               TO PRT.
 23668     PERFORM 8800-PRINT-ROUTINE.
 23669
 23670     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23671     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23672     MOVE TR-TTL-HD               TO PRT.
 23673     PERFORM 8800-PRINT-ROUTINE.
 23674
 23675     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23676     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23677     MOVE TR-TTL-HD               TO PRT.
 23678     PERFORM 8800-PRINT-ROUTINE.
 23679
 23680     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23681     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23682     MOVE TR-TTL-HD               TO PRT.
 23683     PERFORM 8800-PRINT-ROUTINE.
 23684
 23685     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23686     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23687     MOVE TR-TTL-HD               TO PRT.
 23688     PERFORM 8800-PRINT-ROUTINE.
 23689
 23690     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23691     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23692     MOVE TR-TTL-HD               TO PRT.
 23693     PERFORM 8800-PRINT-ROUTINE.
 23694
 23695     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23696     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23697     MOVE TR-TTL-HD               TO PRT.
 23698     PERFORM 8800-PRINT-ROUTINE.
 23699
 23700     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23701     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23702     MOVE TR-TTL-HD               TO PRT.
 23703     PERFORM 8800-PRINT-ROUTINE.
 23704
 23705     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23706     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23707     MOVE TR-TTL-HD               TO PRT.
 23708     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 456
* ECS010.cbl
 23709
 23710     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23711     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23712     MOVE TR-TTL-HD               TO PRT.
 23713     PERFORM 8800-PRINT-ROUTINE.
 23714
 23715     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23716     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23717     MOVE TR-TTL-HD               TO PRT.
 23718     PERFORM 8800-PRINT-ROUTINE.
 23719
 23720     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23721     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23722     MOVE TR-TTL-HD               TO PRT.
 23723     PERFORM 8800-PRINT-ROUTINE.
 23724
 23725     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23726     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23727     MOVE TR-TTL-HD               TO PRT.
 23728     PERFORM 8800-PRINT-ROUTINE.
 23729
 23730     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23731     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23732     MOVE TR-TTL-HD               TO PRT.
 23733     PERFORM 8800-PRINT-ROUTINE.
 23734
 23735     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23736     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23737     MOVE TR-TTL-HD               TO PRT.
 23738     PERFORM 8800-PRINT-ROUTINE.
 23739
 23740     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23741     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23742     MOVE TR-TTL-HD               TO PRT.
 23743     PERFORM 8800-PRINT-ROUTINE.
 23744
 23745     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23746     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23747     MOVE TR-TTL-HD               TO PRT.
 23748     PERFORM 8800-PRINT-ROUTINE.
 23749
 23750     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23751     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23752     MOVE TR-TTL-HD               TO PRT.
 23753     PERFORM 8800-PRINT-ROUTINE.
 23754
 23755     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23756     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23757     MOVE TR-TTL-HD               TO PRT.
 23758     PERFORM 8800-PRINT-ROUTINE.
 23759
 23760     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23761     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23762     MOVE TR-TTL-HD               TO PRT.
 23763     PERFORM 8800-PRINT-ROUTINE.
 23764
 23765     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23766     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 457
* ECS010.cbl
 23767     MOVE TR-TTL-HD               TO PRT.
 23768     PERFORM 8800-PRINT-ROUTINE.
 23769
 23770     MOVE W-1-EP                  TO TTL-PT-CNT.
 23771     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23772     MOVE TR-TTL-HD               TO PRT.
 23773     PERFORM 8800-PRINT-ROUTINE.
 23774
 23775     MOVE W-P-EP                  TO TTL-PT-CNT.
 23776     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23777     MOVE TR-TTL-HD               TO PRT.
 23778     PERFORM 8800-PRINT-ROUTINE.
 23779
 23780     MOVE W-M-EP                  TO TTL-PT-CNT.
 23781     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23782     MOVE TR-TTL-HD               TO PRT.
 23783     PERFORM 8800-PRINT-ROUTINE.
 23784
 23785     MOVE W-R-EP                  TO TTL-PT-CNT.
 23786     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23787     MOVE TR-TTL-HD               TO PRT.
 23788     PERFORM 8800-PRINT-ROUTINE.
 23789
 23790     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23791     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23792     MOVE TR-TTL-HD               TO PRT.
 23793     PERFORM 8800-PRINT-ROUTINE.
 23794
 23795     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23796     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23797     MOVE TR-TTL-HD               TO PRT.
 23798     PERFORM 8800-PRINT-ROUTINE.
 23799
 23800     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23801     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23802     MOVE TR-TTL-HD               TO PRT.
 23803     PERFORM 8800-PRINT-ROUTINE.
 23804
 23805     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23806     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23807     MOVE TR-TTL-HD               TO PRT.
 23808     PERFORM 8800-PRINT-ROUTINE.
 23809
 23810     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23811     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23812     MOVE TR-TTL-HD               TO PRT.
 23813     PERFORM 8800-PRINT-ROUTINE.
 23814
 23815     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23816     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23817     MOVE TR-TTL-HD               TO PRT.
 23818     PERFORM 8800-PRINT-ROUTINE.
 23819
 23820     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23821     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23822     MOVE TR-TTL-HD               TO PRT.
 23823     PERFORM 8800-PRINT-ROUTINE.
 23824
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 458
* ECS010.cbl
 23825     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23826     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23827     MOVE TR-TTL-HD               TO PRT.
 23828     PERFORM 8800-PRINT-ROUTINE.
 23829
 23830     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23831     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23832     MOVE TR-TTL-HD               TO PRT.
 23833     PERFORM 8800-PRINT-ROUTINE.
 23834
 23835     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23836     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23837     MOVE TR-TTL-HD               TO PRT.
 23838     PERFORM 8800-PRINT-ROUTINE.
 23839
 23840     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23841     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23842     MOVE TR-TTL-HD               TO PRT.
 23843     PERFORM 8800-PRINT-ROUTINE.
 23844
 23845 9990-FINAL-CLOSE.
*23846                             COPY ELCPRTC.
 23847******************************************************************04/15/98
 23848*                                                                *ELCPRTC
 23849*                                                                *ELCPRTC
 23850*                            ELCPRTC.                            *   LV003
 23851*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23852*                            VMOD=2.002                          *   CL**2
 23853*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23854*                                                                *ELCPRTC
 23855* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23856******************************************************************ELCPRTC
 23857                                                                  ELCPRTC
 23858      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23859          CLOSE FICH.                                             ELCPRTC
 23860                                                                  ELCPRTC
 23861******************************************************************ELCPRTC
 23862
 23863     IF DTE-CLIENT = 'DMD'
 23864         CLOSE ERRESC-IN.
 23865
 23866     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23867
 23868     DISPLAY ' '.
 23869     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23870     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23871     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23872     DISPLAY ' '.
 23873
 23874     MOVE    ' DISPLAY ERROR COUNT = '
 23875       TO  DIS-LINE-REASON.
 23876     MOVE  ERROR-COUNT
 23877       TO  DIS-LINE-REC.
 23878         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23879
 23880     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 23881           DISPLAY-PRT
 23882           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 459
* ECS010.cbl
 23883           ME50-ECS010-BALANCE
 23884           PENDING-EXTRACT  SUMMARY-EXTR.
 23885
 23886     if (dte-client = 'DCC')
 23887        and (dte-pgm-opt = '1')
 23888        close new-detail-extr
 23889     end-if
 23890
 23891     IF DTE-PGM-OPT = '1'
 23892         CLOSE CERT-MASTER-OUT
 23893               DETAIL-EXTR
 23894     end-if
 23895
 23896     IF ERACCTT-FILE-STATUS NOT = '00'
 23897         MOVE '12'                TO ABEND-CODE-1
 23898         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 23899         DISPLAY '******************************'
 23900         DISPLAY '***** ERROR LOCATION 027 *****'
 23901         DISPLAY '******************************'
 23902         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23903           GO TO ABEND-PGM.
 23904
 23905     IF COMM-OPEN-SW = 'X'
 23906         CLOSE ERCTBL
 23907         IF ERCTBL-FILE-STATUS NOT = '00'
 23908             MOVE '42'               TO ABEND-CODE-1
 23909             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 23910             DISPLAY '******************************'
 23911             DISPLAY '***** ERROR LOCATION 028 *****'
 23912             DISPLAY '******************************'
 23913             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23914             GO TO ABEND-PGM.
 23915
 23916     IF REIN-OPEN-SW = 'X'
 23917         CLOSE ERRTBL-IN
 23918         IF ERRTBL-FILE-STATUS NOT = '00'
 23919             MOVE '22'               TO ABEND-CODE-1
 23920             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 23921             DISPLAY '******************************'
 23922             DISPLAY '***** ERROR LOCATION 029 *****'
 23923             DISPLAY '******************************'
 23924             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23925             GO TO ABEND-PGM.
 23926
 23927     MOVE 'C'                         TO CP-IO-FUNCTION.
 23928     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 23929     IF IO-ERROR
 23930         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 23931                                      TO WS-ABEND-MESSAGE
 23932         MOVE 0302                    TO WS-RETURN-CODE
 23933         DISPLAY '******************************'
 23934         DISPLAY '***** ERROR LOCATION 030 *****'
 23935         DISPLAY '******************************'
 23936         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23937         GO TO ABEND-PGM.
 23938
 23939     IF ME-DO-UPDATE
 23940           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 460
* ECS010.cbl
 23941           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 23942           ACCEPT WS-TIME-OF-DAY   FROM TIME
 23943           MOVE WS-TIME              TO ME-010-END
 23944           ADD 1 TO ME-010-RUN-CT
 23945           REWRITE MONTH-END-BALANCES
 23946           DISPLAY 'MONTH-END BALANCES POSTED'
 23947           CLOSE ERMEBL-INOUT
 23948     ELSE
 23949         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 23950
 23951     GO TO 9999-END-THE-JOB.
 23952
 23953 CERT-DATE-LOAD.
*23954     COPY ELCCRTM1.
 23955******************************************************************04/15/98
 23956*                                                                *ELCCRTM1
 23957*                                                                *ELCCRTM1
 23958*                            ELCCRTM1                            *   LV003
 23959*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23960*                            VMOD=2.001                          *ELCCRTM1
 23961*                                                                *ELCCRTM1
 23962*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 23963*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 23964*                                                                *ELCCRTM1
 23965******************************************************************ELCCRTM1
 23966     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 23967     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 23968     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 23969     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 23970     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 23971     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 23972     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 23973     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 23974     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 23975                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 23976     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 23977                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 23978     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 23979     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 23980     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 23981     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 23982     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 23983     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 23984           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 23985                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 23986     END-PERFORM.                                                 ELCCRTM1
 23987                                                                  ELCCRTM1
 23988
 23989 EXTRACT-DATE-LOAD.
*23990     COPY ELCEXTM1.
 23991******************************************************************04/15/98
 23992*                                                                *ELCEXTM1
 23993*                                                                *ELCEXTM1
 23994*                            ELCEXTM1                            *   LV010
 23995*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 23996*                            VMOD=2.001                          *ELCEXTM1
 23997*                                                                *ELCEXTM1
 23998*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 461
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 23999*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24000*                                                                *ELCEXTM1
 24001******************************************************************ELCEXTM1
 24002                                                                  ELCEXTM1
 24003     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24004     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24005     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24006     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24007     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24008     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24009                                                                     CL**9
 24010     EVALUATE TRUE                                                   CL**5
 24011        WHEN DE-ISSUE      OR                                        CL**8
 24012             DE-RC-ISSUE   OR                                        CL**8
 24013             DE-RR-RC-ISS  OR                                        CL**8
 24014             DE-CANCEL     OR                                        CL**8
 24015             DE-RC-CANCEL  OR                                        CL**8
 24016             DE-RR-RC-CNC                                            CL**8
 24017           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24018                                                                     CL**9
 24019        WHEN DE-CLAIM      OR                                        CL**8
 24020             DE-RR-RC-CLM                                            CL**6
 24021           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24022           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24023           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24024           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24025           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24026           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24027                                                                     CL**9
 24028        WHEN DE-RESERVE                                              CL**9
 24029           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24030           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24031           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24032                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24033           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24034                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24035           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24036     END-EVALUATE.                                                   CL**9
 24037                                                                     CL**9
 24038
 24039 EXTRACT-DATE-RELOAD.
*24040     COPY ELCEXTM2.
 24041******************************************************************04/15/98
 24042*                                                                *ELCEXTM2
 24043*                                                                *ELCEXTM2
 24044*                            ELCEXTM2                            *   LV011
 24045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24046*                            VMOD=2.001                          *ELCEXTM2
 24047*                                                                *ELCEXTM2
 24048*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24049*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24050*                                                                *   CL**9
 24051******************************************************************ELCEXTM2
 24052                                                                  ELCEXTM2
 24053     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24054     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24055     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24056     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 462
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24057     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24058     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24059                                                                     CL*10
 24060     EVALUATE TRUE                                                   CL*10
 24061        WHEN DE-ISSUE      OR                                        CL*10
 24062             DE-RC-ISSUE   OR                                        CL*10
 24063             DE-RR-RC-ISS  OR                                        CL*10
 24064             DE-CANCEL     OR                                        CL*10
 24065             DE-RC-CANCEL  OR                                        CL*10
 24066             DE-RR-RC-CNC                                            CL*10
 24067           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24068                                                                     CL*10
 24069        WHEN DE-CLAIM      OR                                        CL*10
 24070             DE-RR-RC-CLM                                            CL**7
 24071           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24072           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24073           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24074           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24075           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24076           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24077                                                                     CL*10
 24078        WHEN DE-RESERVE                                              CL**7
 24079            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24080            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24081            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24082                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24083            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24084                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24085            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24086     END-EVALUATE.                                                   CL**5
 24087                                                                  ELCEXTM2
 24088
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 463
* ECS010.cbl
 24090 ABEND-PGM.
 24091     DISPLAY '******************************'
 24092     DISPLAY '***** ABEND PGM **************'
 24093     DISPLAY '******************************'
*24094                             COPY ELCABEND.
 24095***************************************************************** 04/14/98
 24096*                                                               * ELCABEND
 24097*                            ELCABEND.                          *    LV003
 24098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24099*                            VMOD 2.002                              CL**2
 24100*                                                               * ELCABEND
 24101*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24102*            AND THEN ABENDS.                                   * ELCABEND
 24103*                                                               * ELCABEND
 24104*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24105*                                                               * ELCABEND
 24106***************************************************************** ELCABEND
 24107*APS-010.                                                         ELCABEND
 24108     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24109     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24110                                                                  ELCABEND
 24111     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24112         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24113         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24114                                 UPON CONSOLE.                    ELCABEND
 24115                                                                  ELCABEND
 24116     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24117         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24118         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24119                                 UPON CONSOLE.                    ELCABEND
 24120                                                                  ELCABEND
 24121     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24122     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24123                                 UPON CONSOLE.                    ELCABEND
 24124                                                                  ELCABEND
 24125     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24126     CALL 'ABORTME'.
 24127                                                                  ELCABEND
 24128 APS-EXIT.                                                        ELCABEND
 24129     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 464
* ECS010.cbl
 24131 9999-END-THE-JOB.
 24132
 24133     DISPLAY ' '.
 24134     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24135         'ECS010 ******'
 24136     DISPLAY ' '.
 24137     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 465
* ECS010.cbl
 24138/
 24139 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24140     IF LCP-ASA = '+'
 24141         WRITE MISMATCH-RPT AFTER 0 LINE
 24142     ELSE
 24143     IF LCP-ASA = ' '
 24144         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24145     ELSE
 24146     IF LCP-ASA = '0'
 24147         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24148     ELSE
 24149     IF LCP-ASA = '-'
 24150         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24151     ELSE
 24152     IF LCP-ASA = '1'
 24153         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24154     ELSE
 24155     IF LCP-ASA = '2'
 24156         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24157     ELSE
 24158     IF LCP-ASA = '3'
 24159         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24160     ELSE
 24161     IF LCP-ASA = '4'
 24162         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24163     ELSE
 24164     IF LCP-ASA = '5'
 24165         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24166     ELSE
 24167     IF LCP-ASA = '6'
 24168         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24169     ELSE
 24170     IF LCP-ASA = '7'
 24171         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24172     ELSE
 24173     IF LCP-ASA = '8'
 24174         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24175     ELSE
 24176     IF LCP-ASA = '9'
 24177         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24178     ELSE
 24179     IF LCP-ASA = 'A'
 24180         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24181     ELSE
 24182     IF LCP-ASA = 'B'
 24183         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24184     ELSE
 24185     IF LCP-ASA = 'C'
 24186         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24187     ELSE
 24188     IF LCP-ASA = 'V'
 24189         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24190     ELSE
 24191     IF LCP-ASA = 'W'
 24192         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24193     ELSE
 24194     DISPLAY 'ASA CODE ERROR'.
 24195 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 466
* ECS010.cbl
 24196     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  295
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2769132     Code:      138387
