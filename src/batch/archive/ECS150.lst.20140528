* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   1
* ECS150.cbl
* Options: int("ECS150.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS150.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS150.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS150.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS150.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/01/97 16:27:55.
     7*             PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.029.
     9*AUTHOR         LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*DATE-COMPILED.
    12
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   2
* ECS150.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22
    23*REMARKS.
    24*        THIS PROGRAM PRODUCES THE EXTRACT RECORDS
    25*        NEEDED TO COMPLETE THE LIFE AND A/H ANNUAL REPORT.
    26*        DETAIL IS GENERATED IF REQUESTED.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   3
* ECS150.cbl
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 012610 IR2010010700001   PEMA  CORRECT IN FORCE COUNT AND AMT
    37* 121510 CR2009120700001   PEMA  FORCE BEGINNING TOTALS TO MATCH ENDING
    38* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 062712    2012062600003  PEMA  ADD PROCESSING FOR AHL
    40* 121613 IR2013121000001   PEMA  CORRECT REMAMT RTN ON 0% APR
    41******************************************************************
    42 ENVIRONMENT DIVISION.
    43 CONFIGURATION SECTION.
    44 INPUT-OUTPUT SECTION.
    45 FILE-CONTROL.
    46
    47     SELECT SORT-WORK        ASSIGN TO SYS001-UT-2314-S-SORTWK1.
    48     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
    49     SELECT CERT-FILE        ASSIGN TO SYS011-UT-2400-S-SYS011.
    50     SELECT REINS-EXTRACT-2  ASSIGN TO SYS012-UT-2400-S-SYS012.
    51     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    52                             ORGANIZATION IS INDEXED
    53                             ACCESS IS DYNAMIC
    54                             FILE STATUS IS ERRTBL-FILE-STATUS
    55                             RECORD KEY IS RE-CONTROL-PRIMARY.
    56     SELECT ERACCTT          ASSIGN TO SYS010-FBA1-ERACCTT
    57                             ORGANIZATION IS INDEXED
    58                             ACCESS IS SEQUENTIAL
    59                             FILE STATUS IS ACCT-FILE-STATUS
    60                             RECORD KEY IS AM-CONTROL-PRIMARY.
    61     SELECT REINS-EXTRACT-1  ASSIGN TO SYS018-UT-2400-S-SYS018.
    62     SELECT DISK-DATE        ASSIGN TO SYS019-UT-2314-S-SYS019.
    63     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
    64     SELECT CLAS150-A-EXTRACT ASSIGN TO SYS021-UT-2400-S-SYS021.
    65     SELECT CLAS150-B-EXTRACT ASSIGN TO SYS022-UT-2400-S-SYS022.
    66     SELECT CLAS150-C-EXTRACT ASSIGN TO SYS023-UT-2400-S-SYS023.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   4
* ECS150.cbl
    68 DATA DIVISION.
    69 FILE SECTION.
    70
    71 SD  SORT-WORK.
    72*    RECORD CONTAINS 210 CHARACTERS
    73
    74 01  SORT-REC.
    75     12  SORT-KEY            PIC X(42).
    76     12  FILLER              PIC X(168).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   5
* ECS150.cbl
    78 FD  PRINT-FILE
*   79                             COPY ELCPRTFD.
    80******************************************************************04/15/98
    81*                                                                *ELCPRTFD
    82*                                                                *ELCPRTFD
    83*                            ELCPRTFD.                           *   LV003
    84*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    85*                            VMOD=2.006                          *ELCPRTFD
    86******************************************************************ELCPRTFD
    87     RECORDING MODE F                                             ELCPRTFD
    88     LABEL RECORDS OMITTED                                        ELCPRTFD
    89     BLOCK CONTAINS 0 RECORDS
    90     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    91 01  PRT.                                                         ELCPRTFD
    92     12  P-CTL               PIC  X.                                 CL**2
    93     12  P-DATA              PIC  X(132).                         ELCPRTFD
    94******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   6
* ECS150.cbl
    96 FD  CERT-FILE
*   97                             COPY ECSCRIFD.
    98******************************************************************07/10/97
    99*                                                                *ECSCRIFD
   100*                            ECSCRIFD                            *   LV001
   101*                            VMOD 2.005                          *ECSCRIFD
   102*                                                                *ECSCRIFD
   103*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   104*                                                                *ECSCRIFD
   105******************************************************************ECSCRIFD
   106     BLOCK CONTAINS 0 RECORDS
   107     RECORDING MODE F.                                            ECSCRIFD
   108                                                                  ECSCRIFD
   109 01  CERT-IN-RECORD.                                              ECSCRIFD
   110                                                                  ECSCRIFD
   111     12  FILLER                            PIC XXX.               ECSCRIFD
   112     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   113     12  FILLER                            PIC X(66).             ECSCRIFD
   114     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   115     12  FILLER                            PIC X(20).             ECSCRIFD
   116     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   117     12  FILLER                            PIC X(14).             ECSCRIFD
   118     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   119     12  FILLER                            PIC X(39).             ECSCRIFD
   120     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   121     12  FILLER                            PIC X(45).             ECSCRIFD
   122     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   123     12  FILLER                            PIC X(35).             ECSCRIFD
   124     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   125     12  FILLER                            PIC X(41).             ECSCRIFD
   126     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   127     12  FILLER                            PIC X(48).             ECSCRIFD
   128     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   129     12  FILLER                            PIC X(9).              ECSCRIFD
   130     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   131     12  FILLER                            PIC X(120).            ECSCRIFD
   132     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   133     12  FILLER                            PIC X(73).             ECSCRIFD
   134     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   135     12  FILLER                            PIC X(464).            ECSCRIFD
   136                                                                  ECSCRIFD
   137******************************************************************ECSCRIFD
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   7
* ECS150.cbl
   139 FD  REINS-EXTRACT-2
   140     BLOCK CONTAINS 0 RECORDS
   141     RECORDING MODE IS F.
   142*    RECORD CONTAINS 210 CHARACTERS
   143
   144 01  RC-REC-2.
   145     12  RC-CONTRAL-2        PIC  X(210).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   8
* ECS150.cbl
   147 FD  ERRTBL-IN
*  148                             COPY ECSRTFDD.
   149******************************************************************07/10/97
   150*                                                                *ECSRTFDD
   151*                            ECSRTFDD                            *   LV001
   152*                            VMOD=2.001                          *ECSRTFDD
   153*                                                                *ECSRTFDD
   154*  NO  CID  MODS  IN  COPYBOOK  ECSRTFDD                         *ECSRTFDD
   155*                                                                *ECSRTFDD
   156******************************************************************ECSRTFDD
   157     LABEL RECORDS STANDARD                                       ECSRTFDD
   158     RECORD CONTAINS 4000 CHARACTERS.                             ECSRTFDD
   159                                                                  ECSRTFDD
   160 01  RT-REC                  PIC  X(4000).                        ECSRTFDD
   161******************************************************************ECSRTFDD
   162
*  163                             COPY ERCREIN.
   164******************************************************************07/27/93
   165*                                                                *ERCREIN
   166*                            ERCREIN                             *   LV009
   167*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   168*                            VMOD=2.010                          *   CL**9
   169*                                                                *ERCREIN
   170*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   171*                                                                *ERCREIN
   172*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   173*                                                                *ERCREIN
   174*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   175*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   176*                                                                *ERCREIN
   177*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   178*       ALTERNATE PATH = NONE                                    *ERCREIN
   179*                                                                *ERCREIN
   180*   LOG = NO                                                     *ERCREIN
   181*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   182*                                                                *ERCREIN
   183******************************************************************ERCREIN
   184*                   C H A N G E   L O G
   185*
   186* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   187*-----------------------------------------------------------------
   188*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   189* EFFECTIVE    NUMBER
   190*-----------------------------------------------------------------
   191* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   192* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   193******************************************************************
   194 01  REINSURANCE-RECORD.                                          ERCREIN
   195     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   196         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   197                                                                  ERCREIN
   198     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   199         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   200         16  RE-KEY.                                              ERCREIN
   201             20  RE-CODE                   PIC X.                 ERCREIN
   202                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   203                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   204             20  RE-TABLE                  PIC XXX.               ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page   9
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   205             20  FILLER                    PIC XXX.               ERCREIN
   206         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   207             20  FILLER                    PIC X.                 ERCREIN
   208             20  RE-COMPANY.                                      ERCREIN
   209                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   210                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   211                                                                  ERCREIN
   212     12  RE-MAINT-INFORMATION.                                    ERCREIN
   213         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   214         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   215         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   216         16  FILLER                        PIC X(10).             ERCREIN
   217                                                                  ERCREIN
   218     12  RE-TABLE-DATA.                                           ERCREIN
   219         16  RE-100-COMP                   PIC 99.                ERCREIN
   220                                                                  ERCREIN
   221         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   222             20  RE-REI-COMP-NO.                                  ERCREIN
   223                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   224                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   225             20  RE-LF-QC                  PIC X.                 ERCREIN
   226             20  RE-AH-QC                  PIC X.                 ERCREIN
   227             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   228             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   229             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   230             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   231             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   232             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   233             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   234             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   235             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   236             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   237             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   238             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   239             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   240             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   241             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   242             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   243             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   244             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   245             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   246             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   247             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   248             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   249             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   250             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   251             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   252             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   253             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   254             20  RE-REMAINING              PIC X.                 ERCREIN
   255             20  RE-LF-RUNOFF-SW           PIC X.                      000
   256             20  RE-AH-RUNOFF-SW           PIC X.                      000
   257             20  FILLER                    PIC X(19).                  000
   258                                                                  ERCREIN
   259         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   260         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   261         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   262         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  10
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   263             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   264                                                                  ERCREIN
   265         16  FILLER                        PIC X(27).             ERCREIN
   266                                                                  ERCREIN
   267     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   268         16  RE-NAME                       PIC X(30).             ERCREIN
   269         16  RE-LF-PE                      PIC X.                 ERCREIN
   270         16  RE-AH-PE                      PIC X.                 ERCREIN
   271         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   272         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   273         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   274         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   275         16  RE-PRT-ST                     PIC X.                 ERCREIN
   276         16  RE-PRT-OW                     PIC X.                 ERCREIN
   277         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   278         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   279         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   280         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   281         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   282         16  RE-LF-COMM                    PIC X.                 ERCREIN
   283         16  RE-AH-COMM                    PIC X.                 ERCREIN
   284         16  RE-LF-TAX                     PIC X.                 ERCREIN
   285         16  RE-AH-TAX                     PIC X.                 ERCREIN
   286         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   287         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   288         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   289                                                                  ERCREIN
   290         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   291             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   292                                                                  ERCREIN
   293         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   294             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   295                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   296                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   297                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   298                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   299             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   300                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   301                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   302                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   303                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   304                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   305                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   306                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   307                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   308             20  FILLER                    PIC XXX.               ERCREIN
   309             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   310                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   311                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   312                                                                  ERCREIN
   313         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   314             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   315                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   316                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   317                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   318                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   319             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   320                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  11
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   321                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   322                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   323                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   324                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   325                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   326                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   327                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   328             20  FILLER                    PIC XXX.               ERCREIN
   329             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   330                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   331                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   332                                                                  ERCREIN
   333         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   334                                                                  ERCREIN
   335         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   336                                                                  ERCREIN
   337         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   338         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   339         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   340         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   341         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   342         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   343         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   344         16  RE-MORT-SW                    PIC X.                 ERCREIN
   345         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   346             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   347             88  RE-CEDED                          VALUE 'C'.        CL**2
   348             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   349             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   350                                                                  ERCREIN
   351         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   352             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   353         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   354             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   355         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   356             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   357         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   358             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   359         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   360             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   361                                                                     CL**3
   362         16  RE-PRT-CRSV                   PIC X.                    CL**5
   363                                                                     CL**5
   364         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   365                                                                     CL**8
   366         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   367                                                                     CL**8
   368         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   369                                                                     CL**9
   370         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   371             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   372             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   373
   374         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   375             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   376                                                                     CL**9
   377         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   378         16  FILLER                        PIC X(2281).              CL**9
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  12
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   379                                                                  ERCREIN
   380         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   381                                                                  ERCREIN
   382******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  13
* ECS150.cbl
   384 FD  ERACCTT.
*  385                             COPY ERCACCT.
   386******************************************************************04/19/98
   387*                                                                *ERCACCT
   388*                                                                *ERCACCT
   389*                            ERCACCT                             *   LV031
   390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   391*                            VMOD=2.031                          *ERCACCT
   392*                                                                *ERCACCT
   393*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   394*                                                                *ERCACCT
   395*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   396*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   397*                                                                *ERCACCT
   398*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   399*                                                                *ERCACCT
   400*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   401*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   402*                                                                *ERCACCT
   403*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   404*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   405*                                                                *ERCACCT
   406*   LOG = NO                                                     *ERCACCT
   407*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   408*                                                                *ERCACCT
   409*                                                                *ERCACCT
   410******************************************************************ERCACCT
   411*                   C H A N G E   L O G
   412*
   413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   414*-----------------------------------------------------------------
   415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   416* EFFECTIVE    NUMBER
   417*-----------------------------------------------------------------
   418* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   419* 092705    2005050300006  PEMA  ADD SPP LEASES
   420* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   421* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   422* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   423* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   424* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   425******************************************************************
   426                                                                  ERCACCT
   427 01  ACCOUNT-MASTER.                                              ERCACCT
   428     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   429         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   430                                                                  ERCACCT
   431     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   432         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   433         16  AM-MSTR-CNTRL.                                       ERCACCT
   434             20  AM-CONTROL-A.                                    ERCACCT
   435                 24  AM-CARRIER            PIC X.                 ERCACCT
   436                 24  AM-GROUPING.                                 ERCACCT
   437                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   438                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   439                 24  AM-STATE              PIC XX.                ERCACCT
   440                 24  AM-ACCOUNT.                                  ERCACCT
   441                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  14
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   442                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   443             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   444                                           PIC X(19).             ERCACCT
   445             20  AM-CNTRL-B.                                      ERCACCT
   446                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   447                 24  FILLER                PIC X(4).              ERCACCT
   448             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   449                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   450                                                                  ERCACCT
   451     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   452         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   453         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   454         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   455         16  AM-VG-STATE                   PIC XX.                ERCACCT
   456         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   457         16  AM-VG-DATE.                                          ERCACCT
   458             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   459             20  FILLER                    PIC X(4).              ERCACCT
   460         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   461                                           PIC 9(11)      COMP-3. ERCACCT
   462     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   463         16  FILLER                        PIC X(10).
   464         16  AM-VG-KEY3.
   465             20  AM-VG3-ACCOUNT            PIC X(10).
   466             20  AM-VG3-EXP-DT             PIC XX.
   467         16  FILLER                        PIC X(4).
   468     12  AM-MAINT-INFORMATION.                                    ERCACCT
   469         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   470         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   471         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   472         16  FILLER                        PIC XX.                ERCACCT
   473                                                                  ERCACCT
   474     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   475     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   476                                                                  ERCACCT
   477     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   478         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   479         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   480                                                                  ERCACCT
   481     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   482     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   483                                                                  ERCACCT
   484     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   485     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   486                                                                  ERCACCT
   487     12  AM-NAME                           PIC X(30).             ERCACCT
   488     12  AM-PERSON                         PIC X(30).             ERCACCT
   489     12  AM-ADDRS                          PIC X(30).             ERCACCT
   490     12  AM-CITY.
   491         16  AM-ADDR-CITY                  PIC X(28).
   492         16  AM-ADDR-STATE                 PIC XX.
   493     12  AM-ZIP.                                                  ERCACCT
   494         16  AM-ZIP-PRIME.                                        ERCACCT
   495             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   496                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   497             20  FILLER                    PIC X(4).              ERCACCT
   498         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   499     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  15
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   500         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   501         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   502         16  FILLER                        PIC XXX.               ERCACCT
   503     12  AM-TEL-NO.                                               ERCACCT
   504         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   505         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   506         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   507     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   508         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   509         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   510                                                                  ERCACCT
   511     12  AM-COMM-STRUCTURE.                                       ERCACCT
   512         16  AM-DEFN-1.                                           ERCACCT
   513             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   514                 24  AM-AGT.                                      ERCACCT
   515                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   516                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   517                 24  AM-COM-TYP            PIC X.                 ERCACCT
   518                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   519                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   520                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   521                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   522                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   523                 24  AM-GL-CODES           PIC X.                 ERCACCT
   524                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   525                 24  FILLER                PIC X(01).             ERCACCT
   526         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   527             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   528                 24  FILLER                PIC X(11).             ERCACCT
   529                 24  AM-L-COMA             PIC XXX.               ERCACCT
   530                 24  AM-J-COMA             PIC XXX.               ERCACCT
   531                 24  AM-A-COMA             PIC XXX.               ERCACCT
   532                 24  FILLER                PIC X(6).              ERCACCT
   533                                                                  ERCACCT
   534     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   535         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   536                                                                  ERCACCT
   537     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   538                                                                  ERCACCT
   539     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   540         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   541         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   542     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   543         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   544         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   545     12  AM-GPCD                           PIC 99.                ERCACCT
   546     12  AM-IG                             PIC X.                 ERCACCT
   547         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   548         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   549     12  AM-STATUS                         PIC X.                 ERCACCT
   550         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   551         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   552         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   553         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   554         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   555         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   556     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   557     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  16
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   558                                                                  ERCACCT
   559     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   560     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   561     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   562     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   563     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   564     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   565     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   566     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   567     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   568                                                                  ERCACCT
   569     12  AM-USER-FIELDS.                                          ERCACCT
   570         16  AM-FLD-1                      PIC XX.                ERCACCT
   571         16  AM-FLD-2                      PIC XX.                ERCACCT
   572         16  AM-FLD-3                      PIC XX.                ERCACCT
   573         16  AM-FLD-4                      PIC XX.                ERCACCT
   574         16  AM-FLD-5                      PIC XX.                ERCACCT
   575                                                                  ERCACCT
   576     12  AM-1ST-PROD-DATE.                                        ERCACCT
   577         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   578         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   579         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   580     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   581     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   582         16  AM-PUR-YR                     PIC XX.                ERCACCT
   583         16  AM-PUR-MO                     PIC XX.                ERCACCT
   584         16  AM-PUR-DA                     PIC XX.                ERCACCT
   585     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   586     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   587     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   588     12  AM-INACTIVE-DATE.                                        ERCACCT
   589         16  AM-INA-MO                     PIC 99.                ERCACCT
   590         16  AM-INA-DA                     PIC 99.                ERCACCT
   591         16  AM-INA-YR                     PIC 99.                ERCACCT
   592     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   593                                                                  ERCACCT
   594     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   595     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   596                                                                  ERCACCT
   597     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   598         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   599         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   600         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   601         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   602                                                                  ERCACCT
   603     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   604         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   605         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   606                                                                  ERCACCT
   607     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   608                                                                  ERCACCT
   609     12  AM-OVER-SHORT.                                           ERCACCT
   610         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   611         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   612                                                                  ERCACCT
   613     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   614     12  AM-DCC-CLP-STATE                  PIC XX.
   615                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  17
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   616     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   617     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   618                                                                  ERCACCT
   619     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   620     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   621     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   622     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   623     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   624     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   625     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   626     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   627     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   628     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   629     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   630     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   631     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   632     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   633     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   634     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   635                                                                  ERCACCT
   636     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   637                                                                  ERCACCT
   638     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   639     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   640                                                                  ERCACCT
   641     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   642     12  AM-EARN-METHODS.                                         ERCACCT
   643         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   644             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   645             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   646             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   647             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   648         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   649             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   650             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   651             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   652             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   653         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   654             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   655             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   656             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   657             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   658             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   659             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   660                                                                  ERCACCT
   661     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   662     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   663     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   664                                                                  ERCACCT
   665     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   666     12  AM-RET-P-E                        PIC X.                 ERCACCT
   667     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   668     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   669     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   670     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   671         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   672         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   673     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  18
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   674         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   675         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   676         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   677     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   678         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   679         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   680     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   681         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   682         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   683         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   684     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   685     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   686                                                                  ERCACCT
   687     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   688         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   689         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   690         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   691         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   692         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   693                                                                  ERCACCT
   694     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   695                                                                  ERCACCT
   696     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   697                                                                  ERCACCT
   698     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   699         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   700                                                                  ERCACCT
   701     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   702         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   703         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   704                                                                  ERCACCT
   705     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   706         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   707                                                                  ERCACCT
   708     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   709         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   710         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   711                                                                  ERCACCT
   712     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   713                                                                  ERCACCT
   714     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   715     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   716     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   717     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   718     12  AM-DCC-UEF-STATE                  PIC XX.
   719     12  FILLER                            PIC XXX.
   720     12  AM-REPORT-CODE-3                  PIC X(10).
   721*    12  FILLER                            PIC X(22).             ERCACCT
   722                                                                  ERCACCT
   723     12  AM-RESERVE-DATE.                                         ERCACCT
   724         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   725         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   726         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   727                                                                  ERCACCT
   728     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   729     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   730         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   731         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  19
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   732         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   733         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   734                                                                  ERCACCT
   735     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   736         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   737         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   738         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   739         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   740                                                                  ERCACCT
   741     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   742         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   743             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   744             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   745             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   746             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   747             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   748             20  FILLER                    PIC XX.                ERCACCT
   749         16  FILLER                        PIC X(80).             ERCACCT
   750                                                                  ERCACCT
   751     12  AM-TRANSFER-DATA.                                        ERCACCT
   752         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   753             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   754             20  AM-TRNFROM-GROUPING.                             ERCACCT
   755                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   756                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   757             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   758             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   759                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   760                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   761             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   762         16  AM-TRANSFERRED-TO.                                   ERCACCT
   763             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   764             20  AM-TRNTO-GROUPING.                               ERCACCT
   765                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   766                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   767             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   768             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   769                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   770                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   771             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   772         16  FILLER                        PIC X(10).             ERCACCT
   773                                                                  ERCACCT
   774     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   775                                                                  ERCACCT
   776     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   777         16  AM-DEFN-1-SAVED.                                     ERCACCT
   778             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   779                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   780                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   781                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   782                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   783                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   784                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   785                 24  FILLER                PIC X.                 ERCACCT
   786                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   787                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   788                 24  FILLER                PIC X.                 ERCACCT
   789         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  20
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   790             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   791                 24  FILLER                PIC X(11).             ERCACCT
   792                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   793                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   794                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   795                 24  FILLER                PIC X(6).              ERCACCT
   796                                                                  ERCACCT
   797     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   798         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   799            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   800            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   801            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   802                                                                  ERCACCT
   803     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   804     12  FILLER                            PIC X(120).            ERCACCT
   805                                                                  ERCACCT
   806     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   807         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   808         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   809             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   810             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   811                                                          COMP-3. ERCACCT
   812             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   813                                                          COMP-3. ERCACCT
   814         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   815             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   816             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   817                                                          COMP-3. ERCACCT
   818             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   819                                                          COMP-3. ERCACCT
   820                                                                  ERCACCT
   821     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   822         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   823         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   824         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   825         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   826             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   827                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   828                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   829             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   830                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   831                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   832             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   833                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   834                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   835         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   836             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   837                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   838                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   839                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   840             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   841                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   842                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   843             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   844                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   845                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   846                                                                  ERCACCT
   847     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  21
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   848         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   849                                                                  ERCACCT
   850     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   851         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   852         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   853         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   854         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   855         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   856             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   857             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   858             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   859             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   860         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   861             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   862             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   863             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   864         16  FILLER                        PIC X(102).            ERCACCT
   865                                                                  ERCACCT
   866     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   867         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   868             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   869             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   870             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   871             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   872             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   873         16  FILLER                          PIC X(10).           ERCACCT
   874******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  22
* ECS150.cbl
   876 FD  REINS-EXTRACT-1
   877     BLOCK CONTAINS 0 RECORDS
   878     RECORDING MODE IS F.
   879*    RECORD CONTAINS 210 CHARACTERS
   880
   881 01  RC-REC-1.
   882     12  RC-CONTRAL-1        PIC  X(210).
   883
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  23
* ECS150.cbl
   885 FD  DISK-DATE
*  886                             COPY ELCDTEFD.
   887******************************************************************04/15/98
   888*                                                                *ELCDTEFD
   889*                                                                *ELCDTEFD
   890*                            ELCDTEFD.                           *   LV002
   891*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   892*                            VMOD=2.007                          *   CL**2
   893*                                                                *ELCDTEFD
   894******************************************************************ELCDTEFD
   895     BLOCK CONTAINS 0 RECORDS
   896     RECORDING MODE F.                                            ELCDTEFD
   897                                                                  ELCDTEFD
   898 01  DATE-DISK.                                                   ELCDTEFD
   899     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   900     12  FILLER                      PIC  X(14).                  ELCDTEFD
   901     12  DD-CR1                      PIC  9.                      ELCDTEFD
   902     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   903     12  DD-CR2                      PIC  9.                      ELCDTEFD
   904     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   905     12  FILLER                      PIC  X(20).                  ELCDTEFD
   906                                                                  ELCDTEFD
   907 01  DATE-DISK-R.                                                 ELCDTEFD
   908     12  FILLER                      PIC  X(4).                   ELCDTEFD
   909     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   910                                     PIC  X(32).                  ELCDTEFD
   911                                                                  ELCDTEFD
   912 01  DATE-DISK-T.                                                 ELCDTEFD
   913     12  FILLER                      PIC  X(4).                   ELCDTEFD
   914     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   915                                     PIC  X(48).                  ELCDTEFD
   916                                                                  ELCDTEFD
   917 01  DATE-DISK-M.                                                 ELCDTEFD
   918     12  FILLER                      PIC  X(4).                   ELCDTEFD
   919     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   920                                     PIC  X(48).                  ELCDTEFD
   921                                                                  ELCDTEFD
   922 01  DATE-DISK-P.                                                 ELCDTEFD
   923     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   924     12  DD-IDX                      PIC  99.                     ELCDTEFD
   925     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   926     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   927         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   928                                     PIC  X.                      ELCDTEFD
   929         16  FILLER                  PIC  X(46).                  ELCDTEFD
   930     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   931         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   932             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   933             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   934             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   935             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   936         16  FILLER                  PIC  X(16).                  ELCDTEFD
   937                                                                  ELCDTEFD
   938 01  DATE-DISK-E.                                                 ELCDTEFD
   939     12  FILLER                      PIC  X(4).                   ELCDTEFD
   940     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   941                                     PIC  X(4).                   ELCDTEFD
   942                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  24
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   943 01  DATE-DISK-C.                                                 ELCDTEFD
   944     12  FILLER                      PIC  X(7).                   ELCDTEFD
   945     12  DD-CARR1-SECPAY-SW          PIC  X.
   946     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   947     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   948     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   949     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   950     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   951     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   952     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   953     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   954     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   955     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   956     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   957     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   958     12  DD-CARR2-SECPAY-SW          PIC  X.
   959     12  FILLER                      PIC  X(7).                   ELCDTEFD
   960                                                                  ELCDTEFD
   961 01  DATE-DISK-OPT.                                               ELCDTEFD
   962     12  FILLER                      PIC  X(04).                  ELCDTEFD
   963     12  DD-TLR-DATA.                                             ELCDTEFD
   964         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   965                                     PIC  X(03).                  ELCDTEFD
   966     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   967         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   968                                     PIC  X(06).                  ELCDTEFD
   969     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   970         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   971                                     PIC  X(07).                  ELCDTEFD
   972         16  FILLER                  PIC  X(05).                  ELCDTEFD
   973     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   974                                     PIC  X(96).                  ELCDTEFD
   975******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  25
* ECS150.cbl
   977 FD  FICH
   978     RECORDING MODE IS F.
   979
   980 01  FICH-REC                PIC X(133).
   981
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  26
* ECS150.cbl
   983 FD  CLAS150-A-EXTRACT
   984     BLOCK CONTAINS 0 RECORDS
   985     RECORDING MODE IS F.
   986*    RECORD CONTAINS 2701 CHARACTERS
   987*
   988*  THIS EXTRACT FILE CONTAINS THE RECORDS
   989*  NEEDED TO PRINT THE CERTIFICATE ACTIVITY AND EXHIBIT
   990*  REPORT FOR THE 1ST INSURANCE COMPANY
   991*
   992*          ** RECORD TYPE AND SORT KEY DESCRIPTION **
   993******** SORT KEY ***************   ******** USAGE *********
   994*TYPE*CARR*COMP*STATE*ACCT*STATE*
   995* 01 * X  *  X *  X  * X  * LV  * - ACCT TOTAL-1ST INS.
   996* 02 * X  *  X *  X  * X  * LV  * - ACCT TOTAL-REINS
   997* 03 * X  *  X *  X  * HV * LV  * - ST TOT-1ST INS
   998* 04 * X  *  X *  X  * HV * LV  * - ST TOT-REINS
   999* 05 * X  *  X *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR CO TOTAL
  1000* 06 * X  *  X *  HV * HV * LV  * - ST TOT-REINS,ACCUM FOR CO TOT
  1001* 07 * X  * HV *  X  * HV * LV  * - ST TOT-1ST,ACCUM FOR ST/CARR
  1002* 08 * X  * HV *  X  * HV * LV  * - ST TOT-REIN,ACCUM FOR ST/CARR
  1003* 09 * X  * HV *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR CARR TOT
  1004* 10 * X  * HV *  HV * HV * LV  * - ST TOT-REIN,ACCUM FOR CARR TOT
  1005* 11 * HV * HV *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR GRND TOT
  1006* 12 * HV * HV *  HV * HV * LV  * - ST TOT-REIN,ACCUM FOR GRND TOT
  1007* 13 * HV * HV *  HV * HV *  X  * - ST TOT-1ST,ACCUM FOR ST TOTAL
  1008* 14 * HV * HV *  HV * HV *  X  * - ST TOT-REIN,ACCUM FOR ST TOTAL
  1009*
  1010* X-INDICATES FIELD INITIALIZED WITH ACTUAL VALUE
  1011* LV - INDICATES FIELD WILL CONTAIN LOW-VALUE
  1012* HV - INDICATES FIELD WILL CONTAIN HIGH-VALUE
  1013*
  1014***NOTE - FIELD ER-REINS-CO IS SET TO LOW-VALUE FOR ALL RECORDS
  1015*         IN THIS FILE SINCE IT IS NOT USED FOR THIS REPORT
  1016
  1017 01  CLAS150-EXTRACT-RECORD-A    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  27
* ECS150.cbl
  1019 FD  CLAS150-B-EXTRACT
  1020     BLOCK CONTAINS 0 RECORDS
  1021     RECORDING MODE IS F.
  1022*    RECORD CONTAINS 2701 CHARACTERS
  1023*
  1024*  THIS FILE CONTAINS THE RECORDS NEEDED TO
  1025*  PRINT THE CERTIFICATE ACTIVITY AND EXHIBIT
  1026*  REPORT FOR THE REINSURANCE COMPANY WITH THE
  1027*  EXCEPTION OF OVER STATE TOTALS.
  1028*
  1029*          ** RECORD TYPE AND SORT KEY DESCRIPTION **
  1030******* SORT KEY *********
  1031*RE-CO*CARR*COMP*STATE*ACCT*STATE*TYPE*
  1032*  X  * X  *  X *  X  * X  * LV  * 15 *   ACCT TOTAL
  1033*  X  * X  *  X *  X  * LV * LV  * 16 *   STATE TOTAL
  1034*  X  * X  *  X *  LV * LV * LV  * 17 *   COMPANY TOTAL
  1035*  X  * X  * LV *  LV * LV * LV  * 18 *   CARRIER TOTAL
  1036*  X  * LV * LV *  LV * LV * LV  * 19 *   REINS CO TOTAL
  1037*     *    *    *     *    *     *    *
  1038* X= INITIALIZED TO ACTUAL VALUE       * TOTAL RECORD TYPE 19
  1039* LV = INITIALIZED TO LOW-VALUE          FOR GRAND TOTALS
  1040
  1041 01  CLAS150-EXTRACT-RECORD-B    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  28
* ECS150.cbl
  1043 FD  CLAS150-C-EXTRACT
  1044     BLOCK CONTAINS 0 RECORDS
  1045     RECORDING MODE IS F.
  1046*    RECORD CONTAINS 2701 CHARACTERS
  1047*
  1048*    THIS FILE CONTAINS THE RECORDS NEEDED TO PRINT
  1049*    THE REINSURANCE COMPANY - CERTIFICATE AND EXHIBIT
  1050*    REPORT - AT THE STATE LEVEL.
  1051*
  1052*    ALL RECORDS IN THIS FILE ARE TYPE 20
  1053*    ALL CONTROL FIELDS IN THE SORT KEY ARE SET TO
  1054*     LOW-VALUE WITH THE EXCEPTION OF THE STATE AND TYPE
  1055*     FIELDS.
  1056*
  1057*
  1058
  1059 01  CLAS150-EXTRACT-RECORD-C    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  29
* ECS150.cbl
  1061 WORKING-STORAGE SECTION.
  1062 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  1063 77  FILLER  PIC X(32) VALUE '********************************'.
  1064 77  FILLER  PIC X(32) VALUE '     ECS150 WORKING STORAGE     '.
  1065 77  FILLER  PIC X(32) VALUE '******* VMOD=2.029 *************'.
  1066
  1067
  1068 77  LINE-CNT                PIC S9(3)      COMP-3 VALUE +56.
  1069 77  FACTOR-C                PIC S9(3)      COMP-3 VALUE +0.
  1070 77  MINUS-CNT               PIC S9(3)      COMP-3 VALUE +0.
  1071 77  PAGE-CNT                PIC S9(5)      COMP-3 VALUE +0.
  1072 77  EXPIRED-MONTHS          PIC S9(5)      COMP-3 VALUE +0.
  1073 77  UNEXPIRED-MONTHS        PIC S9(3)V99   COMP-3 VALUE +0.
  1074 77  HOLD-PREV-UNEXP         PIC S9(5)      COMP-3 VALUE +0.
  1075 77  HOLD-PREV-EXP           PIC S9(5)      COMP-3 VALUE +0.
  1076 77  HOLD-END-UNEXP          PIC S9(5)      COMP-3 VALUE +0.
  1077 77  HOLD-END-EXP            PIC S9(5)      COMP-3 VALUE +0.
  1078 77  TERM-WORK               PIC S9(5)      COMP-3 VALUE +0.
  1079 77  REINS-REC-CNT           PIC S9(7)      COMP-3 VALUE +0.
  1080 77  EXB-CNT                 PIC S9(7)      COMP-3 VALUE ZERO.
  1081 77  FACTOR-A                PIC S9(4)V9(11) COMP-3 VALUE +0.
  1082 77  FACTOR-B                PIC S9(4)V9(11) COMP-3 VALUE +0.
  1083 77  WS-TOTAL-FACE-AMT       PIC S9(7)V99   COMP-3 VALUE +0.
  1084 77  UNEARNED-AMT-LF         PIC S9(7)V99   COMP-3 VALUE +0.
  1085 77  UNEARNED-AMT-AH         PIC S9(7)V99   COMP-3 VALUE +0.
  1086 77  SUMMARY-AMT-LF          PIC S9(9)V99   COMP-3 VALUE +0.
  1087 77  SUMMARY-AMT-AH          PIC S9(9)V99   COMP-3 VALUE +0.
  1088 77  MINUS-AMT               PIC S9(7)V99   COMP-3 VALUE +0.
  1089 77  TEMP-RESULT             PIC S9(9)V99   COMP-3 VALUE +0.
  1090 77  SAVE-BGN-INFORCE        PIC S9(9)V99   COMP-3 VALUE +0.
  1091 77  SAVE-END-INFORCE        PIC S9(9)V99   COMP-3 VALUE +0.
  1092 77  TEMP-RESULT-L           PIC S9(9)V9(6) COMP-3 VALUE +0.
  1093 77  SAVE-REM-TERM           PIC S9(3)V99   COMP-3 VALUE +0.
  1094 77  X                       PIC X                 VALUE SPACE.
  1095 77  ERRTBL-FILE-STATUS      PIC XX              VALUE '00'.
  1096 77  ACCT-FILE-STATUS        PIC XX              VALUE '00'.
  1097
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  30
* ECS150.cbl
  1099 01  WORK-AREAS.
  1100     12  sub3                       pic s9(5) value +0 comp-3.
  1101     12  WS-ZERO                    PIC S9     VALUE +0 COMP-3.
  1102     12  WS-RETURN-CODE             PIC S9(4)  VALUE +0 COMP-3.
  1103     12  WS-ABEND-MESSAGE           PIC X(80)  VALUE SPACES.
  1104     12  WS-ABEND-FILE-STATUS       PIC XX     VALUE ZERO.
  1105     12  INTERIM-YR                 PIC 99     VALUE 0.
  1106     12  WS-931231                  PIC XX     VALUE X'8CFF'.
  1107     12  WS-CR-DIS-CCYY             PIC 9(04)  VALUE 0.
  1108     12  WS-CR-CCYY                 PIC 9(04)  VALUE 0.
  1109
  1110 01  FILLER PIC X(16)  VALUE 'CONTROL SWITCHES'.
  1111 01  PROGRAM-CNTRL-SWITCHES.
  1112     12  PASS-TYPE           PIC 9               VALUE 0.
  1113         88  FIRST-INS-PASS                      VALUE 0.
  1114         88  REINSURANCE-PASS                    VALUE 1.
  1115     12  INFORCE-CNT-SW      PIC 9               VALUE 0.
  1116     12  RECORD-TYPE-SW      PIC 9               VALUE 0.
  1117         88  FIRST-INS-REC                       VALUE 0.
  1118         88  REINSURANCE-REC                     VALUE 1.
  1119     12  EFFECTIVE-CONTROL   PIC 9               VALUE 0.
  1120         88  EFFECTIVE-LAST-PER                  VALUE 1.
  1121         88  EFFECTIVE-THIS-PER                  VALUE 2.
  1122         88  EFFECTIVE-BOTH-PER                  VALUE 3.
  1123     12  CERT-STATUS         PIC 9               VALUE 0.
  1124         88  CERT-ACTIVE                         VALUE 0.
  1125         88  CERT-CANCELLED                      VALUE 1.
  1126         88  CERT-CLAIM                          VALUE 2.
  1127         88  LUMP-SUM                            VALUE 3.
  1128         88  CLAIM-OR-CANCEL                     VALUE 1 2 3.
  1129     12  REINSURANCE-FOUND   PIC 9               VALUE 0.
  1130         88  NO-REINSURANCE                      VALUE 0.
  1131     12  OB-SW               PIC 9               VALUE 0.
  1132         88  OB-COVERAGE                         VALUE 1.
  1133     12  SUMMARY-SW          PIC 9               VALUE 0.
  1134         88  SUMMARY-REC                         VALUE 1.
  1135     12  COUNT-CNTRL         PIC 9               VALUE 0.
  1136         88  ALREADY-COUNTED                     VALUE 1.
  1137     12  NEW-IN-EFFECT       PIC 9               VALUE 0.
  1138         88  ENTERED-THIS-PERIOD                 VALUE 1.
  1139     12  OLD-IN-EFFECT       PIC 9               VALUE 0.
  1140         88  ENTERED-PREV-PERIOD                 VALUE 1.
  1141     12  PRINT-CNTRL         PIC 9               VALUE 0.
  1142         88  FIRST-DETAIL-DONE                   VALUE 1.
  1143     12  INS-TYPE-SW         PIC 9               VALUE 0.
  1144         88  INDIVIDUAL-INS                      VALUE 1.
  1145         88  GROUP-INS                           VALUE 2.
  1146     12  LIFE-INS-SW         PIC 9               VALUE 0.
  1147         88  LEVEL-LIFE                          VALUE 1.
  1148         88  REDUCING-LIFE                       VALUE 2.
  1149     12  CANCEL-SW           PIC 9               VALUE 0.
  1150         88  CURRENT-CANCEL-ONLY                 VALUE 1.
  1151     12  CLAIM-SW            PIC 9               VALUE 0.
  1152         88  CURRENT-CLAIM-ONLY                  VALUE 1.
  1153     12  REINS-FILE-SW       PIC 9               VALUE 0.
  1154         88  REINS-FILE-CLOSED                   VALUE 0.
  1155         88  REINS-FILE-OPEN                     VALUE 1.
  1156     12  TEXAS-REG-SW        PIC 9               VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  31
* ECS150.cbl
  1157         88  TEXAS-CERT                          VALUE 1.
  1158     12  NET-PAY-SW          PIC 9               VALUE 0.
  1159         88  NET-PAY-CERT                        VALUE 1.
  1160 01  FILLER PIC X(16)  VALUE 'PRINT   SWITCHES'.
  1161 01  PRINT-SWITCHES.
  1162     12  LF-REFUND-SW        PIC 9               VALUE 0.
  1163         88 PRT-LF-REFUND                        VALUE 1.
  1164     12  AH-REFUND-SW        PIC 9               VALUE 0.
  1165         88 PRT-AH-REFUND                        VALUE 1.
  1166     12  LF-ISSUE            PIC 9               VALUE 0.
  1167         88 PRT-LF-ISSUE                         VALUE 1.
  1168     12  LF-CANC             PIC 9               VALUE 0.
  1169         88 PRT-LF-CANC                          VALUE 1.
  1170     12  LF-DEATH            PIC 9               VALUE 0.
  1171         88 PRT-LF-DEATH                         VALUE 1.
  1172     12  LF-EXPIRY           PIC 9               VALUE 0.
  1173         88 PRT-LF-EXPIRY                        VALUE 1.
  1174     12  LF-DECR             PIC 9               VALUE 0.
  1175         88 PRT-LF-DECR                          VALUE 1.
  1176     12  LF-INCR             PIC 9               VALUE 0.
  1177         88 PRT-LF-INCR                          VALUE 1.
  1178     12  LF-LUMP             PIC 9               VALUE 0.
  1179         88 PRT-LF-LUMP                          VALUE 1.
  1180     12  AH-ISSUE            PIC 9               VALUE 0.
  1181         88 PRT-AH-ISSUE                         VALUE 1.
  1182     12  AH-CANC             PIC 9               VALUE 0.
  1183         88 PRT-AH-CANC                          VALUE 1.
  1184     12  AH-CLAIM            PIC 9               VALUE 0.
  1185         88 PRT-AH-CLAIM                         VALUE 1.
  1186 01  PRINT-AMOUNTS.
  1187     12  PRT-ISSUE-AMT-LF    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1188     12  PRT-CANC-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1189     12  PRT-DEATH-AMT-LF    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1190     12  PRT-EXPIRY-AMT-LF   PIC S9(11)V99 COMP-3   VALUE ZERO.
  1191     12  PRT-DECR-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1192     12  PRT-INCR-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1193     12  PRT-ISSUE-AMT-AH    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1194     12  PRT-CANC-AMT-AH     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1195     12  PRT-CLAIM-AMT-AH    PIC S9(11)V99 COMP-3   VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  32
* ECS150.cbl
  1197 01  RC-REC.
  1198     12  RC-CONTROL.
  1199         16  RC-COMP            PIC X(6).
  1200         16  RC-CMCTL.
  1201             20  RC-CNTRL-1     PIC X(19).
  1202             20  RC-CNTRL-2     PIC X(17).
  1203     12  RC-ENTRY-STATUS        PIC X.
  1204     12  RC-LFTYP               PIC XX.
  1205     12  RC-LF-TERM             PIC S9(3)       COMP-3.
  1206     12  RC-LFAMT               PIC S9(9)V99    COMP-3.
  1207     12  RC-LFPRM               PIC S9(7)V99    COMP-3.
  1208     12  RC-LFRFND              PIC S9(7)V99    COMP-3.
  1209     12  RC-LF-CANCEL-STATUS    PIC X.
  1210     12  RC-LF-CLAIM-STATUS     PIC X.
  1211     12  RC-LF-CURRENT-STATUS   PIC X.
  1212     12  RC-AHTYP               PIC XX.
  1213     12  RC-AH-TERM             PIC S9(3)       COMP-3.
  1214     12  RC-AHAMT               PIC S9(7)V99    COMP-3.
  1215     12  RC-AHPRM               PIC S9(7)V99    COMP-3.
  1216     12  RC-AHRFND              PIC S9(7)V99    COMP-3.
  1217     12  RC-AH-CANCEL-STATUS    PIC X.
  1218     12  RC-AH-CLAIM-STATUS     PIC X.
  1219     12  RC-AH-CURRENT-STATUS   PIC X.
  1220     12  RC-DTHAMT              PIC S9(9)V99    COMP-3.
  1221     12  RC-DISAMT              PIC S9(9)V99    COMP-3.
  1222     12  RC-IND-GRP             PIC X.
  1223     12  RC-LF-CANC-DT          PIC 9(11)       COMP-3.
  1224     12  RC-AH-CANC-DT          PIC 9(11)       COMP-3.
  1225     12  RC-DIS-DT              PIC 9(11)       COMP-3.
  1226     12  RC-ENT-DT              PIC 9(11)       COMP-3.
  1227     12  RC-LF-CANC-EXIT        PIC 9(11)       COMP-3.
  1228     12  RC-AH-CANC-EXIT        PIC 9(11)       COMP-3.
  1229     12  RC-LF-CLAIM-EXIT       PIC 9(11)       COMP-3.
  1230     12  RC-AH-CLAIM-EXIT       PIC 9(11)       COMP-3.
  1231     12  RC-PMT-FREQ            PIC 9(2).
  1232     12  RC-APR                 PIC S9(3)V9(4)  COMP-3.
  1233     12  RC-LOAN-TERM           PIC S9(3)       COMP-3.
  1234     12  RC-I-LIVES             PIC S9(3)       COMP-3.
  1235     12  RC-C-LIVES-YTD         PIC S9(3)       COMP-3.
  1236     12  RC-C-LIVES-ITD         PIC S9(3)       COMP-3.
  1237     12  RC-LFRFND-YTD          PIC S9(7)V99    COMP-3.
  1238     12  RC-AHRFND-YTD          PIC S9(7)V99    COMP-3.
  1239     12  RC-LF-TERM-IN-DAYS     PIC S9(5)       COMP-3.
  1240     12  RC-LF-EXPIRE-DT        PIC 9(11)       COMP-3.
  1241     12  RC-AH-EXPIRE-DT        PIC 9(11)       COMP-3.
  1242     12  RC-LOAN-1ST-PMT-DT     PIC 9(6).
  1243     12  RC-ORIG-LFAMT          PIC S9(9)V99    COMP-3.
  1244     12  RC-LFAMT-ALT           PIC S9(9)V99    COMP-3.
  1245     12  RC-CEDE-FACT           PIC S9(1)V9(4)  COMP-3.
  1246     12  FILLER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  33
* ECS150.cbl
  1248 01  PROCESSING-CONTROL-DATES.
  1249     12  PERIOD-START        PIC XX.
  1250     12  PERIOD-START-9      PIC S9(5)    COMP-3.
  1251     12  PERIOD-END          PIC XX.
  1252     12  PERIOD-END-9        PIC S9(5)    COMP-3.
  1253     12  CERT-EFFECT-DT      PIC XX.
  1254     12  FIRST-PAY-DT        PIC XX.
  1255     12  CERT-EXPIRE-DATE    PIC XX.
  1256     12  CERT-EXPIRE-DATE-O  PIC XX.
  1257     12  CANCEL-EXIT-DATE    PIC XX.
  1258     12  CLAIM-EXIT-DATE     PIC XX.
  1259     12  VALUATION-DATE      PIC S9(5)    COMP-3.
  1260     12  CERT-ENTRY-DATE     PIC XX.
  1261     12  LOW-EXIT-DATE       PIC XX.
  1262     12  SUM-CANCEL-DATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  34
* ECS150.cbl
  1264 01  SAVE-CONTROL-BREAKS                         VALUE SPACES.
  1265     12  LAST-REINS-CO       PIC X(6).
  1266     12  SAVE-CNTRL-GRP.
  1267         16  LAST-CARRIER    PIC X.
  1268         16  LAST-GROUPING   PIC X(6).
  1269         16  LAST-STATE      PIC XX.
  1270         16  LAST-ACCOUNT    PIC X(10).
  1271
  1272 01  SAVE-EXP-DT.
  1273     12  SE-YR             PIC 99.
  1274     12  SE-MO             PIC 99.
  1275     12  SE-DA             PIC 99.
  1276
  1277 01  REMAINING-TERM-WORK-FIELDS.
  1278     12  BGN-DT.
  1279         16  BGN-YR          PIC 99.
  1280         16  BGN-MO          PIC 99.
  1281         16  BGN-DA          PIC 99.
  1282     12  END-DT.
  1283         16  END-YR          PIC 99.
  1284         16  END-MO          PIC 99.
  1285         16  END-DA          PIC 99.
  1286     12  TEMP-1              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1287     12  TEMP-2              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1288     12  TEMP-3              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1289     12  TEMP-4              PIC S9V9(8)     COMP-3 VALUE +0.
  1290     12  TEMP-5              PIC S9V9(8)     COMP-3 VALUE +0.
  1291     12  LF-REM-TRM          PIC S9(3)V99    COMP-3 VALUE +0.
  1292     12  AH-REM-TRM          PIC S9(3)V99    COMP-3 VALUE +0.
  1293     12  LF-BAL-REMTRM       PIC S9(3)V99    COMP-3 VALUE +0.
  1294     12  REM-TRM1            PIC S9(3)V99    COMP-3 VALUE +0.
  1295     12  REM-TRM2            PIC S9(3)V99    COMP-3 VALUE +0.
  1296     12  TEM-TRM1            PIC S9(3)V99    COMP-3 VALUE +0.
  1297     12  HLD-TRM             PIC S9(3)V99    COMP-3 VALUE +0.
  1298     12  RUN-DATE-BIN        PIC XX.
  1299     12  EP-DT-BIN           PIC XX.
  1300     12  WS-CR-BIN-DATE      PIC XX.
  1301
  1302 01  TEXAS-REG-WORK-AREAS.
  1303     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
  1304     12  TEX-FACT-2          PIC S9(3)       COMP-3.
  1305     12  TEX-FACT-3          PIC S9(3)       COMP-3.
  1306     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  1307     12  TEX-FACT-5          PIC S9(3)       COMP-3.
  1308     12  TEX-FACT-6          PIC S9(3)       COMP-3.
  1309     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  1310     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  1311     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  1312
  1313 01  NET-PAY-INTERFACE.
  1314     12  NP-APR              PIC S9(3)V9(4)  COMP-3.
  1315     12  NP-ORIG             PIC S9(3)       COMP-3.
  1316     12  NP-REM              PIC S9(3)       COMP-3.
  1317     12  NP251-ORIG          PIC S9(3)V99    COMP-3.
  1318     12  NP251-REM           PIC S9(3)V99    COMP-3.
  1319     12  NP-SUB              PIC S9(3)       COMP-3.
  1320     12  NP-EFF-DT           PIC X(06).
  1321     12  NP-OPT              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  35
* ECS150.cbl
  1322     12  NP-CAP              PIC S9(3)       COMP-3.
  1323     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  1324     12  NP-WORK1            PIC S9(6)V9(9)  COMP-3.
  1325     12  NP-WORK2            PIC S9(6)V9(9)  COMP-3.
  1326     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  1327     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  1328     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  1329     12  NP-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  36
* ECS150.cbl
  1331** OTHER WORK FIELDS
  1332 01  SAVE-REINS-CERT         PIC X(210).
  1333
  1334 01  COUNT-WORK              PIC S9(3)   COMP-3  VALUE +0.
  1335
  1336 01  COUNT-SAVE              PIC S9(3)   COMP-3  VALUE +0.
  1337 01  INFORCE-DOLLARS         PIC S9(9)V99 COMP-3 VALUE +0.
  1338 01  DOLLAR-AMT              PIC S9(9)V99 COMP-3 VALUE +0.
  1339 01  DECREASING-DOLLAR       PIC S9(9)V99 COMP-3 VALUE +0.
  1340 01  WS-PR-UN-PREM           PIC S9(7)V99 COMP-3 VALUE +0.
  1341 01  WS-PR-UN-PREM-ALT       PIC S9(7)V99 COMP-3 VALUE +0.
  1342 01  WS-R78-UN-PREM          PIC S9(7)V99 COMP-3 VALUE +0.
  1343 01  WS-R78-UN-PREM-ALT      PIC S9(7)V99 COMP-3 VALUE +0.
  1344 01  WS-STATE-UN-PREM        PIC S9(7)V99 COMP-3 VALUE +0.
  1345 01  AH-EARN-METHOD          PIC X(01)           VALUE SPACE.
  1346*
  1347*
  1348* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  37
* ECS150.cbl
  1350 01  ACTIVITY-TOTAL-TABLE.
  1351     12  CONTROL-LEVELS OCCURS 5 TIMES.
  1352*          **ON PASS FOR 1ST INSURANCE COMPANY
  1353*            1=  STATE TOTALS   - 1ST INSURANCE
  1354*            2=  ACCOUNT TOTALS - 1ST INSURANCE
  1355*            3=  STATE TOTALS   - REINSURANCE
  1356*            4=  ACCOUNT TOTALS - REINSURANCE
  1357*            5=  NOT USED
  1358*          **ON PASS FOR REINSURANCE COMPANY
  1359*            1=  REINSURANCE COMPANY TOTALS
  1360*            2=  CARRIER TOTALS
  1361*            3=  COMPANY TOTALS
  1362*            4=  STATE TOTALS
  1363*            5=  ACCOUNT TOTALS
  1364*
  1365         16  TERM-GROUPS OCCURS 3 TIMES.
  1366*            1=  0-60 MONTHS
  1367*            2=  61 - 120 MONTHS
  1368*            3=  OVER 120 MONTHS
  1369*
  1370             20  INSURANCE-TYPES OCCURS 10 TIMES.
  1371*                **  1-5 ARE GROUP
  1372*                    6-10 ARE INDIVIDUAL
  1373*                 1,6 =  LIFE(RED)
  1374*                 2,7 =  LIFE(LEV)
  1375*                 3,8 =  LIFE(OB)
  1376*                 4,9 =  AH
  1377*                 5,10=  AH(OB)
  1378                 24  ISSUE-CNT   PIC S9(13)    COMP-3.
  1379                 24  ISSUE-AMT   PIC S9(11)V99 COMP-3.
  1380                 24  ISSUE-PREM  PIC S9(11)V99 COMP-3.
  1381                 24  CANCEL-CNT  PIC S9(13)    COMP-3.
  1382                 24  CANCEL-AMT  PIC S9(11)V99 COMP-3.
  1383                 24  CANCEL-PREM PIC S9(11)V99 COMP-3.
  1384                 24  CLAIM-CNT   PIC S9(13)    COMP-3.
  1385                 24  CLAIM-AMT   PIC S9(11)V99 COMP-3.
  1386                 24  EARN-PREM   PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  38
* ECS150.cbl
  1388 01  EXHIBIT-TOTALS-TABLE.
  1389     12  E-CONTROL-LEVELS OCCURS 5 TIMES.
  1390*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE
  1391         16  E-TERM-GROUPS OCCURS 3 TIMES.
  1392*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE
  1393             20  EXHIBIT-GROUPS OCCURS 9 TIMES.
  1394*                1=  INFORCE END OF PREVIOUS PERIOD
  1395*                2=  ISSUED DURING PERIOD
  1396*                3=  TOTAL INFORCE (LEV 1 + LEV 2)
  1397*                4=  DEATHS IN PERIOD
  1398*                5=  EXPIRED
  1399*                6=  CANCELLED
  1400*                7=  DECREASES
  1401*                8=  TOTAL DEDUCTIONS (LEV 4+5+6+7)
  1402*                9=  TOTAL INFORCE AT END OF PERIOD (LEV 3-8)
  1403*
  1404                 24  GROUP-CNT   PIC S9(13)    COMP-3.
  1405                 24  GROUP-AMT   PIC S9(11)V99 COMP-3.
  1406                 24  IND-CNT     PIC S9(13)    COMP-3.
  1407                 24  IND-AMT     PIC S9(11)V99 COMP-3.
  1408
  1409 01  AH-PAID-TABLE.
  1410     12  A-CONTROL-LEVELS OCCURS 5 TIMES.
  1411*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE.
  1412         16  AH-PAID-THIS-YR     PIC S9(11)V99 COMP-3.
  1413         16  AH-PAID-LAST-YR     PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  39
* ECS150.cbl
  1415 01  TABLE-SUBSCRIPTS    COMP.
  1416*
  1417* CONTROL-LEVELS
  1418     12  CL                  PIC S9(4).
  1419* TERM-GROUPS
  1420     12  TG                  PIC S9(4).
  1421* DETAIL (EXHIBIT GROUPS)
  1422     12  EG                  PIC S9(4).
  1423* DETAIL (INSURANCE TYPES)
  1424     12  IY                  PIC S9(4).
  1425* CONTROL-LEVELS + 1 (USED TO ROLL TOTALS)
  1426     12  CLX                 PIC S9(4).
  1427* LAST-ADD-LEVEL.
  1428     12  LA                  PIC S9(4).
  1429
  1430     12  SAV-LF-TERM-CODE    PIC S9(4).
  1431
  1432 01  DATE-EDIT-AREAS.
  1433     12  FORMAT-DATE.
  1434         16  XMM             PIC 99.
  1435         16  FILLER          PIC X               VALUE '/'.
  1436         16  XDD             PIC 99.
  1437         16  FILLER          PIC X               VALUE '/'.
  1438         16  XYY             PIC 99.
  1439     12  EDITED-DATE REDEFINES
  1440         FORMAT-DATE         PIC X(8).
  1441     12  RAW-DATE.
  1442         16  XCC             PIC 99.
  1443         16  XYY             PIC 99.
  1444         16  XMM             PIC 99.
  1445         16  XDD             PIC 99.
  1446     12  DATE-WORK REDEFINES
  1447         RAW-DATE            PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  40
* ECS150.cbl
  1449 01  HEAD-LINE-1.
  1450     12  FILLER              PIC X(12)           VALUE
  1451             '  CARRIER - '.
  1452     12  HL-CARRIER          PIC X               VALUE SPACES.
  1453     12  FILLER              PIC X(34)           VALUE SPACES.
  1454     12  HL-CO-NAME          PIC X(30)           VALUE SPACES.
  1455     12  FILLER              PIC X(42)           VALUE SPACES.
  1456     12  FILLER              PIC X(8)            VALUE 'ECS150'.
  1457
  1458 01  HEAD-LINE-2.
  1459     12  FILLER              PIC X(12)           VALUE
  1460             ' GROUPING - '.
  1461     12  HL-COMPANY          PIC X(6)            VALUE SPACES.
  1462     12  FILLER              PIC X(23)           VALUE SPACES.
  1463     12  FILLER              PIC X(49)           VALUE
  1464             'CERTIFICATE ACTIVITY - DETAIL AND SUMMARY TOTALS'.
  1465     12  FILLER              PIC X(29)           VALUE SPACES.
  1466     12  HL-DATE             PIC X(8).
  1467
  1468 01  HEAD-LINE-3.
  1469     12  FILLER              PIC X(12)           VALUE
  1470             '  STATE   - '.
  1471     12  HL-STATE            PIC X(20)           VALUE SPACES.
  1472     12  FILLER              PIC X(17)           VALUE SPACES.
  1473     12  FILLER              PIC X(11)           VALUE
  1474             'FOR PERIOD '.
  1475     12  HL-PER-START        PIC X(8).
  1476     12  FILLER              PIC X(6)            VALUE ' THRU '.
  1477     12  HL-PER-END          PIC X(8).
  1478     12  FILLER              PIC X(37)           VALUE SPACES.
  1479     12  FILLER              PIC X(5)            VALUE 'PAGE '.
  1480     12  HL-PAGENO           PIC ZZ,ZZ9.
  1481
  1482 01  HEAD-LINE-4.
  1483     12  FILLER              PIC X(12)           VALUE
  1484             '  ACCOUNT - '.
  1485     12  HL-ACCOUNT          PIC X(11)           VALUE SPACES.
  1486     12  FILLER              PIC X(109)          VALUE SPACES.
  1487
  1488 01  HEAD-LINE-5.
  1489     12  FILLER              PIC X(25)           VALUE
  1490             '  REINSURANCE COMPANY - '.
  1491     12  HL-REIN-CO          PIC X(6)            VALUE SPACES.
  1492     12  FILLER              PIC X(101)          VALUE SPACES.
  1493
  1494 01  HEAD-LINE-6.
  1495     12  FILLER              PIC X(7)    VALUE '  *****'.
  1496     12  HL-MESSAGE          PIC X(21)   VALUE SPACES.
  1497     12  FILLER              PIC X(5)    VALUE '*****'.
  1498     12  FILLER              PIC X(99)   VALUE SPACES.
  1499
  1500 01  HEAD-LINE-7A.
  1501     12  FILLER              PIC X(44)           VALUE
  1502             '          CERTIFICATE     ISSUE    TERM     '.
  1503     12  FILLER              PIC X(44)           VALUE
  1504             '       PLAN       ORIGINAL        PREMIUM AM'.
  1505     12  FILLER              PIC X(44)           VALUE
  1506             'OUNTS                                       '.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  41
* ECS150.cbl
  1507
  1508 01  HEAD-LINE-7B.
  1509     12  FILLER              PIC X(44)           VALUE
  1510             '            NUMBER        DATE     AH  LF   '.
  1511     12  FILLER              PIC X(44)           VALUE
  1512             'TYPE   CODE        AMOUNT          LIFE     '.
  1513     12  FILLER              PIC X(44)           VALUE
  1514             ' AH        ACTIVITY      AMOUNT             '.
  1515
  1516 01  HEAD-LINE-8A.
  1517     12  FILLER              PIC X(44)           VALUE
  1518             ' CLASSIFICATION         I S S U E D         '.
  1519     12  FILLER              PIC X(44)           VALUE
  1520             '                  C A N C E L L E D         '.
  1521     12  FILLER              PIC X(44)           VALUE
  1522             '          C L A I M S            E A R N E D'.
  1523
  1524 01  HEAD-LINE-8B.
  1525     12  FILLER              PIC X(44)           VALUE
  1526             '*************** ****************************'.
  1527     12  FILLER              PIC X(44)           VALUE
  1528             '********    ********************************'.
  1529     12  FILLER              PIC X(44)           VALUE
  1530             '****   *********************    ************'.
  1531
  1532 01  HEAD-LINE-8C.
  1533     12  FILLER              PIC X(44)           VALUE
  1534            ' TYPE    TERM   -COUNT- ----AMOUNT----  --PR'.
  1535     12  FILLER              PIC X(44)           VALUE
  1536            'EMIUM---    -COUNT- ----AMOUNT----  --PREMIU'.
  1537     12  FILLER              PIC X(44)           VALUE
  1538            'M---   -COUNT- ---AMOUNT----    ---AMOUNT---'.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  42
* ECS150.cbl
  1540 01  DETAIL-LINE-1.
  1541     12  FILLER              PIC X(8)            VALUE SPACES.
  1542     12  DL-CERT-NO          PIC X(10).
  1543     12  DL-CERT-SUFX        PIC X.
  1544     12  FILLER              PIC X(5)            VALUE SPACES.
  1545     12  DL-ISSUE-DT         PIC X(8).
  1546     12  FILLER              PIC XX              VALUE SPACES.
  1547     12  DL-AH-TERM          PIC ZZ9.
  1548     12  FILLER              PIC X               VALUE SPACES.
  1549     12  DL-LF-TERM          PIC ZZ9.
  1550     12  FILLER              PIC X(4)            VALUE SPACES.
  1551     12  DL-TYPE             PIC XXX.
  1552     12  FILLER              PIC X(4)            VALUE SPACES.
  1553     12  DL-PLAN             PIC XXX.
  1554     12  FILLER              PIC X(2)            VALUE SPACES.
  1555     12  DL-ORIG-AMT         PIC ZZZ,ZZZ,ZZ9.99.
  1556     12  FILLER              PIC X(5)            VALUE SPACES.
  1557     12  DL-LF-PREM          PIC ZZ,ZZ9.99.
  1558     12  DL-AH-PREM          PIC ZZ,ZZ9.99.
  1559     12  FILLER              PIC X(7)            VALUE SPACES.
  1560     12  DL-ACTIVITY         PIC X(5).
  1561     12  DL-RSRV-AMT         PIC ZZZ,ZZZ,ZZ9.99-.
  1562     12  FILLER              PIC X(14)           VALUE SPACES.
  1563
  1564 01  DETAIL-LINE-2.
  1565     12  DL-DESCRIP          PIC X(16)           VALUE SPACES.
  1566     12  DL-ISS-CNT          PIC ZZZ,ZZ9.
  1567     12  DL-ISS-AMT          PIC ZZZ,ZZZ,ZZ9.99-.
  1568     12  DL-ISS-PRM          PIC ZZ,ZZZ,ZZ9.99-.
  1569     12  FILLER              PIC XX              VALUE SPACES.
  1570     12  DL-CAN-CNT          PIC ZZZ,ZZ9.
  1571     12  FILLER              PIC X               VALUE SPACES.
  1572     12  DL-CAN-AMT          PIC ZZZ,ZZZ,ZZ9.99.
  1573     12  FILLER              PIC X               VALUE SPACES.
  1574     12  DL-CAN-PRM          PIC ZZ,ZZZ,ZZ9.99.
  1575     12  FILLER              PIC XXX             VALUE SPACES.
  1576     12  DL-CLM-CNT          PIC ZZZ,ZZ9.
  1577     12  FILLER              PIC X               VALUE SPACES.
  1578     12  DL-CLM-AMT          PIC ZZ,ZZZ,ZZ9.99.
  1579     12  FILLER              PIC XX              VALUE SPACES.
  1580     12  DL-EARN-AMT         PIC ZZ,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  43
* ECS150.cbl
  1582 01  ABEND-CD.
  1583     12  ABEND-CODE.
  1584         16  ABEND-FILE-ID       PIC XX VALUE ZEROS.
  1585         16  ABEND-CODE-1 REDEFINES ABEND-FILE-ID
  1586                                 PIC XX.
  1587         16  ABEND-REASON        PIC XX VALUE ZEROS.
  1588         16  ABEND-CODE-2 REDEFINES ABEND-REASON
  1589                                 PIC XX.
  1590     12  ABEND-OPTION    PIC X          VALUE 'Y'.
  1591     12  PGM-SUB         PIC S999 COMP  VALUE +150.
  1592     12  R-EX-DT             PIC X(6).
  1593
  1594 01  KB-REIN.
  1595     12  CLM-INCUR-REIN-DATE PIC 9(6).
  1596     12  CLM-INCUR-REIN-DATE-R REDEFINES CLM-INCUR-REIN-DATE.
  1597         16  CIRD-CCYY.
  1598             20  CIRD-CC     PIC 99.
  1599             20  CIRD-YR     PIC 99.
  1600         16  CIRD-MO         PIC 99.
  1601     12  DTO-CC              PIC 99.
  1602     12  DTO-YR              PIC 99.
  1603     12  DTO-MO              PIC 99.
  1604     12  FLA-CLM-REIN-BASE   PIC S9(5)V99.
  1605     12  ADJ-FLA-REIN-BASE   PIC S9(5)V99.
  1606     12  REIN-RT-SW          PIC X               VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  44
* ECS150.cbl
* 1608                             COPY ECSRITAB.
  1609******************************************************************04/29/98
  1610*                                                                *ECSRITAB
  1611*                            ECSRITAB                            *   LV015
  1612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1613*                            VMOD=2.015                          *ECSRITAB
  1614*                                                                *ECSRITAB
  1615*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  1616*                                                                *ECSRITAB
  1617******************************************************************ECSRITAB
  1618 01  REIN-WORK-AREAS.                                             ECSRITAB
  1619     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1620     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1621     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1622     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1623     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1624     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1625     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1626     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1627     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1628     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1629     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  1630         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  1631             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  1632             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  1633             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  1634     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1635     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1636     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1637     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1638     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1639     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1640     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1641     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1642     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1643     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1644     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1645     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1646     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1647     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1648     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1649     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1650     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1651     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1652     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1653     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1654     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1655     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1656     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1657                                                                  ECSRITAB
  1658 01  REIN-HOLD-AREAS.                                             ECSRITAB
  1659     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  1660         16  REIN-COMP               PIC X(6).                    ECSRITAB
  1661         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  1662             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  1663             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  1664         16  REIN-WORK-FLDS.                                      ECSRITAB
  1665             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  45
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1666             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  1667             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  1668             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  1669             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  1670             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  1671             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  1672             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  1673             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  1674             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  1675             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  1676             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  1677             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  1678             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  1679             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1680             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1681             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  1682             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  1683             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  1684             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  1685             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1686             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1687             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  1688             20  REIN-REM-SW         PIC X.                       ECSRITAB
  1689             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  1690             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  1691             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  1692             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  1693     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  1694                                                                  ECSRITAB
  1695     12  RWF-FIELDS.                                              ECSRITAB
  1696         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  1697         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  1698         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  1699         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  1700         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  1701         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  1702         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  1703         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  1704         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  1705         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  1706         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  1707         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  1708         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  1709         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  1710         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1711         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1712         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  1713         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  1714         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  1715         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  1716         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1717         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1718         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  1719         16  RWF-REM-SW              PIC X.                       ECSRITAB
  1720         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  1721         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  1722         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  1723         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  46
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1724                                                                  ECSRITAB
  1725     12  WT-COMP-INFO.                                            ECSRITAB
  1726         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  1727         16  WT-LF-QC                PIC X.                       ECSRITAB
  1728         16  WT-AH-QC                PIC X.                       ECSRITAB
  1729         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  1730         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  1731         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  1732         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  1733         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  1734         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  1735         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  1736         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  1737         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  1738         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  1739         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  1740         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  1741         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  1742         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  1743         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  1744         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  1745         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  1746         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  1747         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  1748         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  1749         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  1750         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  1751         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  1752         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  1753         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  1754         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  1755         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  1756         16  WT-REMAINING            PIC X.                       ECSRITAB
  1757         16  FILLER                  PIC X(21).                   ECSRITAB
  1758                                                                  ECSRITAB
  1759 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  1760     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  1761     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  1762     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  1763     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  1764     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  1765     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  1766     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1767     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1768     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  1769     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1770     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  1771     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  1772     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1773     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1774     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  1775     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  1776     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  1777     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  1778     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1779     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1780     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1781     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  47
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1782     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1783     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  1784                                                                  ECSRITAB
  1785     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  1786         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  1787     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  1788         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  1789     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  1790         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  1791     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  1792         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  1793     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  1794         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  1795     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  1796         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  1797                                                                  ECSRITAB
  1798     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  1799         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  1800         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  1801         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  1802         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  1803         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  1804         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  1805         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  1806         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  1807         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  1808         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  1809         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  1810         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  1811         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  1812         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  1813         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  1814         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  1815         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  1816         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  1817         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  1818         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  1819         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  1820         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  1821         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  1822     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  1823     12  REIN-SEARCH.                                             ECSRITAB
  1824         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  1825         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  1826         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  1827         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  1828     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  1829     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  1830     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1831     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1832     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1833     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1834     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1835     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1836     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1837     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1838     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1839     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  48
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1840     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1841     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1842     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1843     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1844     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1845     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  1846     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  1847     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  1848     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1849     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  1850     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1851     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1852     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  1853                                                                  ECSRITAB
  1854 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  1855* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  1856     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  1857         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  1858         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  1859         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  1860         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  1861         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  1862         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1863         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  1864         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1865         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  1866                                                                  ECSRITAB
  1867 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  1868     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  1869         16  RC2-REIN-CO.                                         ECSRITAB
  1870             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  1871             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  1872         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1873         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1874         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1875         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1876         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  1877         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  1878                                                                  ECSRITAB
  1879 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  1880     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  1881         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  1882         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  1883     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  1884                                                                  ECSRITAB
  1885 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  1886     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  1887         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  1888         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  1889         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  1890 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  1891     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  1892         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  1893                                                                  ECSRITAB
  1894 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  1895******************************************************************ECSRITAB
* 1896                             COPY ELCPSEVR.
  1897******************************************************************04/16/98
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  49
* ECS150.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  1898*                                                                *ELCPSEVR
  1899*                                                                *ELCPSEVR
  1900*                            ELCPSEVR                            *   LV003
  1901*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1902*                            VMOD=2.001                          *ELCPSEVR
  1903*                                                                *ELCPSEVR
  1904*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  1905*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  1906*                                                                *ELCPSEVR
  1907******************************************************************ELCPSEVR
  1908                                                                  ELCPSEVR
  1909 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  1910     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  1911         10  FILLER               PIC 999.                        ELCPSEVR
  1912         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  1913         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  1914             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  1915             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  1916         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  1917         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  1918     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  1919            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  1920     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  1921         10  FILLER              PIC 999.                         ELCPSEVR
  1922         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  1923         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  1924             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  1925             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  1926         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  1927         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  1928     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  1929            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  1930 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  1931     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  1932                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  1933         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  1934             15  FILLER              PIC 999.                     ELCPSEVR
  1935             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  1936             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  1937                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  1938                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  1939             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  1940             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  1941         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  1942                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  1943         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  1944             15  FILLER              PIC 999.                     ELCPSEVR
  1945             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  1946             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  1947                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  1948                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  1949             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  1950             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  1951         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  1952                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  1953         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  1954             15  FILLER              PIC 999.                     ELCPSEVR
  1955             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  50
* ECS150.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  1956             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  1957                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  1958                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  1959             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  1960             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  1961         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  1962                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  1963     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  1964         10  FILLER              PIC 999.                         ELCPSEVR
  1965         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  1966         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  1967             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  1968             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  1969         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  1970         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  1971     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  1972            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  51
* ECS150.cbl
  1974 01  CLAS150-EXTRACT-RECORD.
  1975     12  ER-SORT-KEY.
  1976         16  ER-CONTROL.
  1977             20  ER-REINS-CO             PIC X(06).
  1978             20  ER-CARRIER              PIC X(01).
  1979             20  ER-COMPANY              PIC X(06).
  1980             20  ER-STATE                PIC X(02).
  1981             20  ER-ACCOUNT              PIC X(10).
  1982         16  ER-ST-SEQ                   PIC X(02).
  1983         16  ER-REC-TYPE                 PIC 99.
  1984     12  ER-PERIOD-START                 PIC 9(11)  COMP-3.
  1985     12  ER-PERIOD-END                   PIC 9(11)  COMP-3.
  1986     12  ER-ACTIVITY-TOTALS.
  1987         16  ER-TERM-GROUP OCCURS 3 TIMES.
  1988*                1= 0-60 MONTHS
  1989*                2= 61-120 MONTHS
  1990*                3= 121 AND OVER
  1991             20  ER-TYPE-GROUPS OCCURS 10 TIMES.
  1992*                1= LIFE(R-GP)       6= LIFE(R-IND)
  1993*                2= LIFE(L-GP)       7= LIFE(L-IND)
  1994*                3= LIFE(OB-GP)      8= LIFE(OB-IND)
  1995*                4= AH(GP)           9= AH(IND)
  1996*                5= AH(OB-GP)       10= AH(OB-IND)
  1997                 24  ER-DETAIL.
  1998                     28  ER-ISSUE-CNT    PIC S9(13)    COMP-3.
  1999                     28  ER-ISSUE-AMT    PIC S9(11)V99 COMP-3.
  2000                     28  ER-ISSUE-PREM   PIC S9(11)V99 COMP-3.
  2001                     28  ER-CANCEL-CNT   PIC S9(13)    COMP-3.
  2002                     28  ER-CANCEL-AMT   PIC S9(11)V99 COMP-3.
  2003                     28  ER-CANCEL-PREM  PIC S9(11)V99 COMP-3.
  2004                     28  ER-CLAIM-CNT    PIC S9(13)    COMP-3.
  2005                     28  ER-CLAIM-AMT    PIC S9(11)V99 COMP-3.
  2006                     28  ER-EARN-PREM    PIC S9(11)V99 COMP-3.
  2007     12  ER-EXHIBIT-TOTALS.
  2008         16  ER-TERM-GROUP-E OCCURS 3 TIMES.
  2009*                1= 0-60 MONTHS
  2010*                2= 61-120 MONTHS
  2011*                3= 121 AND OVER
  2012             20  ER-LINE-DETAIL OCCURS 9 TIMES.
  2013*                1= INFORCE PREVIOUS PER  6= CANCELED IN PERIOD
  2014*                2= ISSUED IN PERIOD      7= DECREASES IN PERIOD
  2015*                3= TOTAL INFORCE-START   8= TOTAL DEC IN PERIOD
  2016*                4= DEATHS IN PERIOD      9= TOTAL INFORCE AT END
  2017*                5= EXPIRED IN PERIOD
  2018                 24  ER-DETAIL-E.
  2019                     28  ER-GROUP-CNT    PIC S9(13)    COMP-3.
  2020                     28  ER-GROUP-AMT    PIC S9(11)V99 COMP-3.
  2021                     28  ER-IND-CNT      PIC S9(13)    COMP-3.
  2022                     28  ER-IND-AMT      PIC S9(11)V99 COMP-3.
  2023
  2024     12  ER-AH-PD-THIS                   PIC S9(11)V99 COMP-3.
  2025     12  ER-AH-PD-LAST                   PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  52
* ECS150.cbl
* 2027                             COPY ECSCRT01.
  2028******************************************************************
  2029*                                                                *
  2030*                            ECSCRT01                            *
  2031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2032*                            VMOD=2.016                          *
  2033*                                                                *
  2034*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  2035*                                                                *
  2036*   FILE TYPE = SEQUENTIAL
  2037*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  2038*                                                                *
  2039*   KEY DATA =                         START=4, LEN=36           *
  2040*                                                                *
  2041*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  2042*                                                                *
  2043******************************************************************
  2044******************************************************************
  2045*                   C H A N G E   L O G
  2046*
  2047* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2048*-----------------------------------------------------------------
  2049*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2050* EFFECTIVE    NUMBER
  2051*-----------------------------------------------------------------
  2052* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2053* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  2054* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2055* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  2056* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2057* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  2058* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2059* 032612  CR2011110200001  PEMA  AHL CHANGES
  2060******************************************************************
  2061
  2062 01  CERTIFICATE-RECORD.
  2063     12  CR-RECORD-ID                      PIC XX.
  2064         88  VALID-CR-ID                      VALUE 'CR'.
  2065
  2066     12  CR-COMPANY-CD                     PIC X.
  2067
  2068     12  CR-FULL-CONTROL.
  2069         16  CR-CONTROL-1.
  2070             20  CR-ACCT-CONTROL.
  2071                 24  CR-CARRIER            PIC X.
  2072                 24  CR-GROUPING.
  2073                     28  CR-GROUP-PREFIX   PIC XXX.
  2074                     28  CR-GROUP-PRIME    PIC XXX.
  2075                 24  CR-STATE              PIC XX.
  2076                 24  CR-ACCOUNT.
  2077                     28  CR-ACCT-PREFIX    PIC X(4).
  2078                     28  CR-ACCT-PRIME     PIC X(6).
  2079             20  CR-DT                     PIC 9(11)  COMP-3.
  2080         16  CR-CERT-NO.
  2081             20  CR-CERT.
  2082                 24  CR-CERT-PREFIX        PIC X(3).
  2083                 24  CR-CERT-PRIME         PIC X(7).
  2084             20  CR-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  53
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2085
  2086     12  CR-INSUREDS-PROFILE.
  2087         16  CR-NAME.
  2088             20  CR-LNAME                  PIC X(15).
  2089             20  CR-FNAME.
  2090                 24  CR-1ST-INITIAL        PIC X.
  2091                 24  FILLER                PIC X(9).
  2092             20  CR-INIT                   PIC X.
  2093         16  CR-AGE                        PIC 99.
  2094         16  CR-SEX                        PIC X.
  2095             88  CR-SEX-MALE                  VALUE 'M'.
  2096             88  CR-SEX-FEMALE                VALUE 'F'.
  2097         16  CR-SOC-SEC                    PIC X(11).
  2098         16  CR-JOINT-NAME.
  2099             20  CR-JT-LNAME               PIC X(15).
  2100             20  CR-JT-FNAME.
  2101                 24  CR-JT-1ST-INIT        PIC X.
  2102                 24  FILLER                PIC X(9).
  2103             20  CR-JT-INIT                PIC X.
  2104         16  CR-JOINT-AGE                  PIC 99.
  2105
  2106         16  cr-ahl-ah-claim-no            pic x(9).
  2107         16  cr-ahl-ah-cert-seq            pic x(3).
  2108         16  cr-hst-proc-lf                pic x.
  2109         16  f                             pic x(7).
  2110
  2111     12  CR-LF-COVERAGE-DATA.
  2112         16  CR-LFTYP                      PIC XX.
  2113         16  CR-LF-TERM                    PIC S999       COMP-3.
  2114         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  2115         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  2116         16  CR-LF-DEV-CODE                PIC XXX.
  2117         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  2118
  2119         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  2120         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  2121         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  2122         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  2123
  2124         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  2125         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  2126         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  2127         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  2128
  2129         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  2130         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  2131
  2132         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  2133         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  2134
  2135         16  CR-LF-REFUND-TYPE             PIC X.
  2136         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  2137
  2138         16  CR-LF-COMM-CHARGEBACK         PIC X.
  2139             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  2140
  2141         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  2142
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  54
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2143         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  2144         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  2145         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  2146
  2147         16  cr-ahl-lf-claim-no            pic x(9).
  2148         16  cr-ahl-lf-cert-seq            pic x(3).
  2149         16  FILLER                        PIC XX.
  2150
  2151     12  CR-AH-COVERAGE-DATA.
  2152         16  CR-AHTYP                      PIC XX.
  2153         16  CR-AH-TERM                    PIC S999       COMP-3.
  2154         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  2155         16  CR-AH-DEV-CODE                PIC XXX.
  2156         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  2157
  2158         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  2159         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  2160         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  2161         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  2162
  2163         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  2164         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  2165
  2166         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  2167         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  2168
  2169         16  CR-AH-REFUND-TYPE             PIC X.
  2170         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  2171
  2172         16  CR-AH-COMM-CHARGEBACK         PIC X.
  2173             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  2174
  2175         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  2176
  2177         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  2178         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  2179         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  2180
  2181         16  FILLER                        PIC XX.
  2182*        16  FILLER                        PIC X(8).
  2183
  2184     12  CR-LOAN-DATA.
  2185         16  CR-LIVES                      PIC S9(7)      COMP-3.
  2186         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  2187                                           PIC S9(5)V99   COMP-3.
  2188         16  CR-BILLED                     PIC S9(7)      COMP-3.
  2189         16  CR-APR                        PIC S999V9(4)  COMP-3.
  2190         16  CR-PMT-FREQ                   PIC 99.
  2191         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  2192         16  CR-RATING-CLASS               PIC XX.
  2193         16  CR-POLICY-FORM-NO             PIC X(12).
  2194         16  CR-GRPTYP                     PIC XX.
  2195         16  CR-IND-GRP                    PIC X.
  2196             88  CR-INDIVIDUAL                VALUE '1'.
  2197             88  CR-GROUP                     VALUE '2'.
  2198         16  CR-SKIP                       PIC 99.
  2199             88  NO-MONTHS-SKIPPED            VALUE 00.
  2200             88  SKIP-JULY                    VALUE 01.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  55
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2201             88  SKIP-AUGUST                  VALUE 02.
  2202             88  SKIP-SEPTEMBER               VALUE 03.
  2203             88  SKIP-JULY-AUG                VALUE 04.
  2204             88  SKIP-AUG-SEPT                VALUE 05.
  2205             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  2206             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  2207             88  SKIP-JUNE                    VALUE 08.
  2208             88  SKIP-JUNE-JULY               VALUE 09.
  2209             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  2210             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  2211         16  CR-RESIDENT-STATE             PIC XX.
  2212         16  CR-RATE-CODE.
  2213             20  CR-LF-CLASS-CD            PIC XX.
  2214             20  CR-AH-CLASS-CD            PIC XX.
  2215         16  CR-MORT.
  2216             20  CR-TAB                    PIC X.
  2217             20  CR-INT                    PIC 99.
  2218             20  CR-GRP                    PIC X.
  2219         16  CR-MEMBER-NO                  PIC X(12).
  2220         16  CR-OLD-LOF                    PIC XXX.
  2221*        16  CR-LOAN-OFFICER               PIC XXX.
  2222         16  CR-REIN-TABLE                 PIC XXX.
  2223         16  CR-REIN-SPEC                  PIC X.
  2224         16  CR-LOAN-1ST-PMT-DT.
  2225             20  CR-1ST-PMT-YR             PIC 99.
  2226             20  CR-1ST-PMT-MO             PIC 99.
  2227             20  CR-1ST-PMT-DA             PIC 99.
  2228         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  2229         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  2230         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  2231         16  CR-LAST-ADD-ON-DT             PIC XX.
  2232
  2233         16  CR-UNDERWRITING-CODE          PIC X.
  2234             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2235
  2236         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  2237         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  2238         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  2239         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  2240
  2241     12  CR-STATUS-INFORMATION.
  2242         16  CR-ENTRY-STATUS               PIC X.
  2243             88  CR-NORMAL-ENTRY              VALUE '1'.
  2244             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  2245             88  CR-CONVERSION-ENTRY          VALUE '4'.
  2246             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  2247             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  2248             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  2249             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  2250             88  CR-POLICY-IS-VOID            VALUE 'V'.
  2251             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  2252             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  2253                                                    '5' '9' 'P'.
  2254         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  2255
  2256         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  2257         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  2258         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  56
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2259
  2260         16  CR-LF-STATUS-AT-DEATH         PIC X.
  2261         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  2262
  2263         16  CR-LF-CURRENT-STATUS          PIC X.
  2264             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  2265             88  CR-LF-POLICY-PENDING         VALUE '2'.
  2266             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  2267             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  2268             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  2269             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2270             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  2271             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2272             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  2273             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  2274             88  CR-LF-IS-DECLINED            VALUE 'D'.
  2275             88  CR-LF-IS-VOID                VALUE 'V'.
  2276             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2277                                                    '4' '5' '9'.
  2278
  2279         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  2280
  2281         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  2282         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  2283
  2284         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  2285         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  2286
  2287         16  CR-AH-CURRENT-STATUS          PIC X.
  2288             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  2289             88  CR-AH-POLICY-PENDING         VALUE '2'.
  2290             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  2291             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  2292             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  2293             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2294             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  2295             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2296             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  2297             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  2298             88  CR-AH-IS-DECLINED            VALUE 'D'.
  2299             88  CR-AH-IS-VOID                VALUE 'V'.
  2300             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2301                                                    '4' '5' '9'.
  2302         16  CR-LOAN-OFFICER               PIC X(5).
  2303         16  CR-CANCEL-REASON              PIC X.
  2304         16  cr-xycor-lf-cov-code          pic x(4).
  2305         16  cr-xycor-ah-cov-code          pic x(4).
  2306         16  FILLER                        PIC X(6).
  2307
  2308     12  CR-DEATH-CLAIM-DATA.
  2309         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  2310
  2311         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  2312         16  CR-DTH-RPT-DT.
  2313             20  CR-DTH-RPT-YR             PIC 99.
  2314             20  CR-DTH-RPT-MO             PIC 99.
  2315             20  CR-DTH-RPT-DA             PIC 99.
  2316         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  57
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2317
  2318         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  2319         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  2320         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  2321         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  2322         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  2323
  2324         16  CR-DTH-AGE                    PIC 99.
  2325         16  CR-DTH-PAY-CD                 PIC X.
  2326         16  CR-DEATH-CAUSE                PIC X(6).
  2327
  2328         16  FILLER                        PIC X(16).
  2329
  2330     12  CR-DISAB-CLAIM-DATA.
  2331         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  2332
  2333         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  2334         16  CR-DIS-RPT-DT.
  2335             20  CR-DIS-RPT-YR             PIC 99.
  2336             20  CR-DIS-RPT-MO             PIC 99.
  2337             20  CR-DIS-RPT-DA             PIC 99.
  2338         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  2339         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  2340
  2341         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  2342         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  2343         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  2344         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  2345         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  2346
  2347         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  2348         16  CR-DIS-PAY-CD                 PIC X.
  2349         16  FILLER                        PIC XX.
  2350
  2351         16  CR-DISAB-INCURRED-DETAIL.
  2352             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  2353**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  2354                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  2355                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  2356                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  2357
  2358         16  CR-DISAB-CAUSE                PIC X(6).
  2359         16  FILLER                        PIC X(14).
  2360
  2361     12  CR-REMIT-TO                       PIC 99.
  2362
  2363     12  CR-COMPENSATION-LEVELS.
  2364         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  2365             20  CR-COM-AGT.
  2366                 24  CR-COM-AGT-PREFIX     PIC X(4).
  2367                 24  CR-COM-AGT-PRIME      PIC X(6).
  2368             20  CR-AGT-TYPE               PIC X.
  2369             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  2370             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  2371
  2372     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  2373     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  2374     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  58
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2375     12  CR-CLP-STATE                      PIC XX.
  2376     12  CR-POST-CARD-IND                  PIC X.
  2377     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  2378     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  2379     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  2380     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  2381     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  2382     12  FILLER                            PIC X(07).
  2383
  2384     12  CR-CSR-CODE                       PIC XXX.
  2385
  2386     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  2387     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  2388
  2389     12  CR-MICROFILM-NUMBERS.
  2390*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  2391         16  FILLER                        PIC X(5).
  2392     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  2393
  2394     12  CR-USER-CODE                      PIC X.
  2395     12  CR-USER-FUTURE                    PIC X(9).
  2396
  2397     12  CR-BENEFICIARY.
  2398         16  CR-BANK-NO                    PIC X(10).
  2399         16  FILLER                        PIC X(15).
  2400
  2401     12  CR-ENTRY-BATCH                    PIC X(6).
  2402     12  CR-LF-EXIT-BATCH                  PIC X(6).
  2403     12  CR-AH-EXIT-BATCH                  PIC X(6).
  2404
  2405     12  CR-NOTE-SW                        PIC X.
  2406
  2407     12  CR-ORIGIN-INDICATOR               PIC X.
  2408         88  CR-ENTERED-MANUALLY              VALUE '1'.
  2409         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  2410
  2411     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  2412     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  2413     12  FILLER                            PIC X(33).
  2414
  2415******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  59
* ECS150.cbl
* 2417                             COPY ELCDATE.
  2418******************************************************************06/11/98
  2419*                                                                *ELCDATE
  2420*                                                                *ELCDATE
  2421*                            ELCDATE.                            *   LV023
  2422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2423*                            VMOD=2.003                           ELCDATE
  2424*                                                                *ELCDATE
  2425*                                                                *ELCDATE
  2426*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2427*                 LENGTH = 200                                   *   CL*19
  2428******************************************************************ELCDATE
  2429                                                                  ELCDATE
  2430 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2431     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2432     12  DC-OPTION-CODE                PIC X.                        CL*15
  2433         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2434         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2435         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2436         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2437         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2438         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2439         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2440         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2441         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2442         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2443         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2444         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2445         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2446         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2447         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2448         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2449         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2450         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2451         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2452         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2453         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2454         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2455         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2456         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2457         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2458         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2459         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2460         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2461         88  THREE-CHARACTER-BIN                                  ELCDATE
  2462                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2463         88  GREGORIAN-TO-BIN                                        CL**2
  2464                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2465         88  BIN-TO-GREGORIAN                                        CL**2
  2466                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2467         88  JULIAN-TO-BINARY                                        CL**2
  2468                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2469     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2470         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2471         88  DATE-CONVERSION-ERROR                                ELCDATE
  2472                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2473         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2474         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  60
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2475         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2476         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2477         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2478         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2479         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2480         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2481         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2482         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2483     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2484         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2485     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2486         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2487         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2488         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2489     12  FILLER                        PIC X.                        CL*15
  2490     12  DC-CONVERSION-DATES.                                        CL*15
  2491         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2492         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2493         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2494         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2495                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2496             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2497             20  SLASH1-1              PIC X.                        CL*15
  2498             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2499             20  SLASH1-2              PIC X.                        CL*15
  2500             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2501         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2502         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2503                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2504             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2505             20  SLASH2-1              PIC X.                        CL*15
  2506             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2507             20  SLASH2-2              PIC X.                        CL*15
  2508             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2509         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2510         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2511                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2512             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2513             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2514             20  DC-YMD-DAY            PIC 99.                       CL*15
  2515         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2516         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2517                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2518             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2519             20  DC-MDY-DAY            PIC 99.                       CL*15
  2520             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2521         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2522             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2523             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2524             20  FILLER                PIC XX.                       CL*15
  2525             20  DC-ALPHA-CENTURY.                                   CL*15
  2526                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2527             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2528         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2529         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2530         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2531         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2532         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  61
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2533                                       PIC 9(05).                    CL*20
  2534         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2535             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2536             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2537         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2538         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2539         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2540     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2541         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2542         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2543             20  FILLER                PIC 9(3).                     CL*15
  2544             20  HOLD-CEN-1-CCYY.                                    CL*15
  2545                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2546                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  2547             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  2548             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  2549         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  2550             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  2551             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  2552             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  2553                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  2554                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  2555             20  FILLER                PIC 9(3).                     CL*15
  2556         16  HOLD-CENTURY-1-X.                                       CL*15
  2557             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  2558             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  2559                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  2560                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  2561             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  2562             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  2563         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  2564             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  2565             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  2566             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  2567                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  2568                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  2569             20  FILLER                PIC XXX.                      CL*23
  2570         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  2571         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  2572         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  2573         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  2574             20  DC-JULIAN-1-CCYY.                                   CL*15
  2575                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  2576                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  2577             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  2578         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  2579         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  2580             20  DC-JULIAN-2-CCYY.                                   CL*15
  2581                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2582                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2583             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2584         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2585             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2586             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2587             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2588             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2589             20  DC-EDITA-CCYY.                                      CL*15
  2590                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  62
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2591                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2592         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2593             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2594             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2595             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2596             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2597             20  DC-EDITB-CCYY.                                      CL*15
  2598                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2599                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2600         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2601         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2602                              DC-GREG-DATE-CYMD.                  ELCDATE
  2603             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2604             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2605             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2606             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2607         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2608         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2609                              DC-GREG-DATE-MDCY.                  ELCDATE
  2610             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2611             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2612             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2613             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2614    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2615        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2616    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2617    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  63
* ECS150.cbl
* 2619                             COPY ELCCALC.
  2620******************************************************************04/15/98
  2621*                                                                *ELCCALC
  2622*                           ELCCALC.                            *    LV003
  2623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2624*                            VMOD=2.025                          *   CL**3
  2625*                                                                *   CL**2
  2626*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  2627*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  2628*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  2629*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  2630*                                                                *   CL**2
  2631*  PASSED TO ELRTRM                                              *   CL**2
  2632*  -----------------                                             *   CL**2
  2633*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  2634*  ORIGINAL TERM                                                 *   CL**2
  2635*  BEGINNING DATE                                                *   CL**2
  2636*  ENDING DATE                                                   *   CL**2
  2637*  COMPANY I.D.                                                  *   CL**2
  2638*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  2639*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  2640*  FREE LOOK DAYS                                                *   CL**2
  2641*                                                                *   CL**2
  2642*  RETURNED FROM ELRTRM                                          *   CL**2
  2643*  ---------------------                                         *   CL**2
  2644*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  2645*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  2646*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  2647*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  2648*----------------------------------------------------------------*   CL**2
  2649*  PASSED TO ELRAMT                                              *   CL**2
  2650*  ----------------                                              *   CL**2
  2651*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  2652*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2653*  ORIGINAL AMOUNT                                               *   CL**2
  2654*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  2655*  A.P.R. - NET PAY ONLY                                         *   CL**2
  2656*  METHOD                                                            CL**2
  2657*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  2658*  COMPANY I.D.                                                  *   CL**2
  2659*  BENEFIT TYPE                                                  *   CL**2
  2660*                                                                *   CL**2
  2661*  RETURNED FROM ELRAMT                                          *   CL**2
  2662*  --------------------                                          *   CL**2
  2663*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  2664*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  2665*  REMAINING AMOUNT FACTOR                                           CL**2
  2666*----------------------------------------------------------------*   CL**2
  2667*  PASSED TO ELRESV                                              *   CL**2
  2668*  -----------------                                             *   CL**2
  2669*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  2670*  VALUATION DATE                                                *   CL**2
  2671*  PAID THRU DATE                                                *   CL**2
  2672*  BENEFIT                                                       *   CL**2
  2673*  INCURRED DATE                                                 *   CL**2
  2674*  REPORTED DATE                                                 *   CL**2
  2675*  ISSUE AGE                                                     *   CL**2
  2676*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  64
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2677*  CDT PERCENT                                                   *   CL**2
  2678*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  2679* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  2680* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  2681* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  2682*                                                                *   CL**2
  2683*  RETURNED FROM ELRESV                                          *   CL**2
  2684*  --------------------                                          *   CL**2
  2685*  CDT TABLE USED                                                *   CL**2
  2686*  CDT FACTOR USED                                               *   CL**2
  2687*  PAY TO CURRENT RESERVE                                        *   CL**2
  2688*  I.B.N.R. - A/H ONLY                                           *   CL**2
  2689*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  2690*----------------------------------------------------------------*   CL**2
  2691*  PASSED TO ELRATE                                              *   CL**2
  2692*  ----------------                                              *   CL**2
  2693*  CERT ISSUE DATE                                               *   CL**2
  2694*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2695*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2696*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  2697*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2698*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2699*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2700*  DEVIATION CODE                                                *   CL**2
  2701*  ISSUE AGE                                                     *   CL**2
  2702*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2703*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2704*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  2705*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2706*  A.P.R.                                                        *   CL**2
  2707*  METHOD                                                            CL**2
  2708*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2709*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2710*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2711*  BENEFIT CODE                                                  *   CL**2
  2712*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2713*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  2714*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  2715*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  2716*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  2717*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  2718*                                                                *   CL**2
  2719*  RETURNED FROM ELRATE                                          *   CL**2
  2720*  --------------------                                          *   CL**2
  2721*  CALCULATED PREMIUM                                            *   CL**2
  2722*  PREMIUM RATE                                                  *   CL**2
  2723*  MORTALITY CODE                                                *   CL**2
  2724*  MAX ATTAINED AGE                                              *   CL**2
  2725*  MAX AGE                                                       *   CL**2
  2726*  MAX TERM                                                      *   CL**2
  2727*  MAX MONTHLY BENEFIT                                           *   CL**2
  2728*  MAX TOTAL BENIFIT                                             *   CL**2
  2729*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  2730*----------------------------------------------------------------*   CL**2
  2731*  PASSED TO ELRFND                                              *   CL**2
  2732*  ----------------                                              *   CL**2
  2733*  CERT ISSUE DATE                                               *   CL**2
  2734*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  65
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2735*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2736*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2737*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2738*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2739*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2740*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2741*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2742*  DEVIATION CODE                                                *   CL**2
  2743*  ISSUE AGE                                                     *   CL**2
  2744*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2745*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2746*  PROCESS TYPE (CANCEL)                                         *   CL**2
  2747*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2748*  A.P.R.                                                        *   CL**2
  2749*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  2750*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  2751*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2752*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2753*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2754*  BENEFIT CODE                                                  *   CL**2
  2755*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2756*                                                                *   CL**2
  2757*  RETURNED FROM ELRFND                                          *   CL**2
  2758*  --------------------                                          *   CL**2
  2759*  CALCULATED REFUND                                             *   CL**2
  2760*----------------------------------------------------------------*   CL**2
  2761*  PASSED TO ELEARN                                              *   CL**2
  2762*  ----------------                                              *   CL**2
  2763*  CERT ISSUE DATE                                               *   CL**2
  2764*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2765*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2766*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2767*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2768*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2769*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2770*  DEVIATION CODE                                                *   CL**2
  2771*  ISSUE AGE                                                     *   CL**2
  2772*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2773*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2774*  A.P.R.                                                        *   CL**2
  2775*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  2776*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2777*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2778*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2779*  BENEFIT CODE                                                  *   CL**2
  2780*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2781*                                                                *   CL**2
  2782*  RETURNED FROM ELEARN                                          *   CL**2
  2783*  --------------------                                          *   CL**2
  2784*  INDICATED  EARNINGS                                           *   CL**2
  2785*----------------------------------------------------------------*   CL**2
  2786*                 LENGTH = 450                                   *   CL**2
  2787*                                                                *   CL**2
  2788******************************************************************   CL**2
  2789******************************************************************
  2790*                   C H A N G E   L O G
  2791*
  2792* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  66
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2793*-----------------------------------------------------------------
  2794*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2795* EFFECTIVE    NUMBER
  2796*-----------------------------------------------------------------
  2797* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2798* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2799* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2800* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2801* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2802* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2803* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2804* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2805* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2806******************************************************************
  2807                                                                     CL**2
  2808 01  CALCULATION-PASS-AREA.                                          CL**2
  2809     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  2810                                     COMP.                           CL**2
  2811                                                                     CL**2
  2812     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  2813       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  2814       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  2815                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  2816       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  2817       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  2818       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  2819       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  2820       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  2821       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  2822       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  2823       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  2824       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  2825       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  2826       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  2827       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  2828       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  2829       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  2830       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  2831       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  2832       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  2833                                                                     CL**2
  2834     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  2835       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  2836***********************  INPUT AREAS ****************************    CL**2
  2837                                                                     CL**2
  2838     12  CP-CALCULATION-AREA.                                        CL**2
  2839         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  2840         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  2841         16  CP-VALUATION-DT       PIC XX.                           CL**2
  2842         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  2843         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  2844           88  CP-AH                               VALUE 'A' 'D'     CL**2
  2845                                                   'I' 'U'.          CL**2
  2846           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  2847           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  2848         16  CP-INCURRED-DT        PIC XX.                           CL**2
  2849         16  CP-REPORTED-DT        PIC XX.                           CL**2
  2850         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  67
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2851         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  2852         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  2853                                     COMP-3.                         CL**2
  2854         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  2855                                     COMP-3.                         CL**2
  2856         16  CP-CDT-METHOD         PIC X.                            CL**2
  2857           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  2858           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  2859           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  2860         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  2861           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  2862           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  2863         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  2864                                     COMP-3.                         CL**2
  2865         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  2866                                     COMP-3.                         CL**2
  2867         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  2868                                     COMP-3.                         CL**2
  2869         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  2870                                     COMP-3.                         CL**2
  2871         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2872                                     COMP-3.                         CL**2
  2873         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  2874                                     COMP-3.                         CL**2
  2875         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  2876                                     COMP-3.                         CL**2
  2877         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  2878           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  2879           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  2880           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  2881           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  2882           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  2883           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  2884           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  2885         16  CP-EARNING-METHOD     PIC X.                            CL**2
  2886           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  2887           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  2888           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2889           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2890           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2891           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2892           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  2893           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2894           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  2895           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2896           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2897           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2898           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2899           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2900         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  2901           88  CP-CLAIM                            VALUE '1'.        CL**2
  2902           88  CP-CANCEL                           VALUE '2'.        CL**2
  2903           88  CP-ISSUE                            VALUE '3'.        CL**2
  2904         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  2905           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  2906           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  2907           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  2908           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  68
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2909           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  2910           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  2911           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  2912           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  2913           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  2914           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  2915           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  2916           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  2917           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  2918           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  2919           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  2920           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  2921           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  2922           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  2923                                                     'W' 'X'.        CL**2
  2924           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  2925           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  2926           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  2927           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  2928           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  2929           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  2930           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  2931           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  2932           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  2933           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  2934           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  2935           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  2936           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  2937                                                                     CL**2
  2938         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  2939                                     COMP-3.                         CL**2
  2940         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  2941         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  2942         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  2943         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  2944         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  2945           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  2946               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  2947         16  CP-R78-OPTION         PIC X.                            CL**2
  2948           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  2949           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  2950                                                                     CL**2
  2951         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  2952         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  2953         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  2954         16  CP-RATE-FILE          PIC X.                            CL**2
  2955         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  2956                                     COMP-3.                         CL**2
  2957                                                                     CL**2
  2958         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  2959         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  2960                                                                     CL**2
  2961         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  2962                                     COMP-3.
  2963         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2964                                   PIC S9(5)V99 COMP-3.
  2965         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  2966                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  69
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2967         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2968                                     COMP-3.                         CL**2
  2969         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  2970                                     COMP-3.
  2971         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2972                                  PIC S9(7)V99 COMP-3.
  2973                                                                     CL**2
  2974         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  2975         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  2976         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  2977           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  2978           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  2979           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  2980           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  2981         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  2982         16  CP-CARRIER            PIC X.                            CL**2
  2983         16  CP-REIN-FLAG          PIC X.                            CL**2
  2984         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  2985           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  2986                      '2' '3' '4' '5'.                               CL**2
  2987           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  2988           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  2989           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  2990           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  2991           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  2992           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  2993           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  2994           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2995         16  CP-SIG-SWITCH         PIC X.                            CL**2
  2996         16  CP-RATING-METHOD      PIC X.                            CL**2
  2997           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  2998           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  2999           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  3000           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  3001           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  3002           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  3003           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  3004           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  3005           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  3006         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  3007                                     COMP-3.                         CL**2
  3008         16  CP-BEN-CATEGORY       PIC X.
  3009         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3010         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3011                                   PIC S99V9(5) COMP-3.
  3012         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3013         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3014                                   PIC S99V9(5) COMP-3.
  3015         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3016         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3017         16  CP-EXPIRE-DT          PIC XX.
  3018         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3019         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3020         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3021         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3022         16  CP-DDF-SPEC-CALC      PIC X.
  3023             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3024             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  70
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3025         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3026         16  CP-CANCEL-REASON      PIC X.
  3027         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3028         16  CP-PMT-MODE           PIC X.
  3029         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3030         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3031         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3032         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3033         16  FILLER                PIC X.
  3034                                                                     CL**2
  3035***************    OUTPUT FROM ELRESV   ************************     CL**2
  3036                                                                     CL**2
  3037         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  3038                                                                     CL**2
  3039         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  3040                                     COMP-3.                         CL**2
  3041         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  3042                                     COMP-3.                         CL**2
  3043         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  3044                                     COMP-3.                         CL**2
  3045         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  3046                                     COMP-3.                         CL**2
  3047         16  FILLER                PIC X(09).                        CL**2
  3048***************    OUTPUT FROM ELRTRM   *************************    CL**2
  3049                                                                     CL**2
  3050         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  3051                                     COMP-3.                         CL**2
  3052         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  3053                                     COMP-3.                         CL**2
  3054         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  3055                                     COMP-3.                         CL**2
  3056         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  3057                                     COMP-3.                         CL**2
  3058         16  FILLER                PIC X(12).                        CL**2
  3059                                                                     CL**2
  3060***************    OUTPUT FROM ELRAMT   *************************    CL**2
  3061                                                                     CL**2
  3062         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  3063                                     COMP-3.                         CL**2
  3064         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  3065                                     COMP-3.                         CL**2
  3066         16  FILLER                PIC X(12).                        CL**2
  3067                                                                     CL**2
  3068***************    OUTPUT FROM ELRATE   *************************    CL**2
  3069                                                                     CL**2
  3070         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  3071                                     COMP-3.                         CL**2
  3072         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  3073                                     COMP-3.                         CL**2
  3074         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  3075         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  3076             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  3077         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  3078                                     COMP-3.                         CL**2
  3079         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  3080         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3081         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3082                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  71
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3083         16  FILLER                PIC X(07).                        CL**2
  3084                                                                     CL**2
  3085***************    OUTPUT FROM ELRFND   *************************    CL**2
  3086                                                                     CL**2
  3087         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  3088                                     COMP-3.                         CL**2
  3089         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  3090           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  3091           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  3092           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  3093           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  3094           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  3095           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  3096           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  3097           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  3098           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  3099           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3100           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3101           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3102           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3103           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3104         16  FILLER                PIC X(12).                        CL**2
  3105                                                                     CL**2
  3106***************    OUTPUT FROM ELEARN   *************************    CL**2
  3107                                                                     CL**2
  3108         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  3109                                     COMP-3.                         CL**2
  3110         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  3111                                     COMP-3.                         CL**2
  3112         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  3113                                     COMP-3.                         CL**2
  3114         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  3115                                     COMP-3.                         CL**2
  3116         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  3117                                     COMP-3.                         CL**2
  3118         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  3119                                     COMP-3.                         CL**2
  3120         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  3121           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  3122           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  3123           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  3124           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  3125           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  3126           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  3127           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  3128           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  3129           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  3130         16  FILLER                PIC X(12).                        CL**2
  3131                                                                     CL**2
  3132***************    OUTPUT FROM ELPMNT   *************************    CL**2
  3133                                                                     CL**2
  3134         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  3135                                     COMP-3.                         CL**2
  3136         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  3137                                     COMP-3.                         CL**2
  3138         16  FILLER                PIC X(12).                        CL**2
  3139                                                                     CL**2
  3140***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  72
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3141         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  3142                                     COMP-3.                         CL**2
  3143         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  3144                                     COMP-3.                         CL**2
  3145         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  3146                                     COMP-3.                         CL**2
  3147         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  3148                                     COMP-3.                         CL**2
  3149         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  3150                                     COMP-3.                         CL**2
  3151         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  3152                                     COMP-3.                         CL**2
  3153         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  3154             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  3155             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  3156             88  IO-ERROR                         VALUE 'E'.         CL**2
  3157                                                                     CL**2
  3158         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  3159                                                                     CL**2
  3160         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  3161                                                                     CL**2
  3162         16  CP-RESERVE-REMAINING-TERM                               CL**2
  3163                                   PIC S9(4)V9    VALUE ZERO         CL**2
  3164                                     COMP-3.                         CL**2
  3165                                                                     CL**2
  3166         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  3167                                                                     CL**2
  3168         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  3169                                     COMP-3.                         CL**2
  3170                                                                     CL**2
  3171         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  3172                                     COMP-3.                         CL**2
  3173                                                                     CL**2
  3174         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  3175                                     COMP-3.                         CL**2
  3176                                                                     CL**2
  3177         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  3178                                     COMP-3.                         CL**2
  3179                                                                     CL**2
  3180         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  3181                                     COMP-3.                         CL**2
  3182                                                                     CL**2
  3183         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  3184                                     COMP-3.                         CL**2
  3185                                                                     CL**2
  3186         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  3187                                     COMP-3.                         CL**2
  3188                                                                     CL**2
  3189         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  3190             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  3191                                                                     CL**2
  3192         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  3193                                     COMP-3.                         CL**2
  3194         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3195                                     COMP-3.
  3196         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3197         16  FILLER                PIC X(15).                        CL**2
  3198******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  73
* ECS150.cbl
* 3200                             COPY ELCDTECX.
  3201******************************************************************06/05/98
  3202*                                                                *ELCDTECX
  3203*                            ELCDTECX.                           *   LV005
  3204*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3205*                            VMOD=2.015                          *ELCDTECX
  3206*                                                                *ELCDTECX
  3207*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3208*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3209*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3210*                                                                *ELCDTECX
  3211******************************************************************ELCDTECX
  3212******************************************************************
  3213*                   C H A N G E   L O G
  3214*
  3215* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3216*-----------------------------------------------------------------
  3217*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3218* EFFECTIVE    NUMBER
  3219*-----------------------------------------------------------------
  3220* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3221*                                  BENEFIT CODES FROM 300 TO 900
  3222* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3223* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3224******************************************************************
  3225 01  DATE-CARD.                                                   ELCDTECX
  3226     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  3227     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3228     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3229     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3230     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3231     12  EP-SW                       PIC  X.                      ELCDTECX
  3232         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3233     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3234         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3235     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3236     12  RUN-CENTURY.                                             ELCDTECX
  3237         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3238     12  FILLER                      PIC  X.                         CL**4
  3239     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3240     12  FILLER                      PIC  XXX.                    ELCDTECX
  3241     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3242                                                                  ELCDTECX
  3243 01  FILLER                          PIC  X(7)                       CL**6
  3244                                          VALUE 'OPTIONS'.        ELCDTECX
  3245 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3246     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3247     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3248     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3249         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3250         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3251     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3252     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3253     12  FILLER                      PIC  X.                      ELCDTECX
  3254     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3255     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3256     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  3257     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  74
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3258     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3259     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3260     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3261     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3262     12  FILLER                      PIC  X.                      ELCDTECX
  3263     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3264     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3265     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3266     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3267     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3268     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3269     12  FILLER                      PIC  X.                      ELCDTECX
  3270     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3271     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3272     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3273     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3274     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3275     12  DTE-R78                     PIC  X.                      ELCDTECX
  3276     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3277     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3278     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3279     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3280     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3281     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3282     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3283                                     PIC  X.                      ELCDTECX
  3284         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  3285                                                 ' '.             ELCDTECX
  3286         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3287         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3288     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3289         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3290         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3291     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3292     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3293                                     PIC  9.                         CL**4
  3294     12  DTE-SYSTEM.                                              ELCDTECX
  3295         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3296         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3297         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3298         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3299         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3300         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3301         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3302         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3303         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3304         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3305         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3306         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3307         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3308         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3309         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3310         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3311         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3312         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3313         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3314         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3315         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  75
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3316         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3317         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3318         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3319         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3320         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3321     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3322         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3323                                     PIC  X.                      ELCDTECX
  3324     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3325                                                                  ELCDTECX
  3326 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3327     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3328     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3329     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3330*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3331     12  FILLER                      PIC  X.                      ELCDTECX
  3332     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3333     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3334     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3335     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3336     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3337     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3338     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3339                                                                  ELCDTECX
  3340     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3341     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3342     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3343     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3344                                                                  ELCDTECX
  3345     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3346     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3347     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3348     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3349                                                                  ELCDTECX
  3350     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3351     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3352                                                                  ELCDTECX
  3353     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3354     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3355                                                                  ELCDTECX
  3356     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3357                                                                  ELCDTECX
  3358 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3359     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3360     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3361     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3362     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3363     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3364     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3365     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3366                                                                  ELCDTECX
  3367 01  FILLER                          PIC  X(12)                   ELCDTECX
  3368                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3369 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3370     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3371         16  CNT-ID                  PIC  X.                      ELCDTECX
  3372         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3373                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  76
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3374 01  FILLER                          PIC  X(11)                   ELCDTECX
  3375                                          VALUE 'STATE NAMES'.    ELCDTECX
  3376 01  STATE-NAMES.                                                 ELCDTECX
  3377     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3378         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3379         16  STATE-PIC1.                                          ELCDTECX
  3380             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3381             20  FILLER              PIC  XXX.                    ELCDTECX
  3382             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3383             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3384             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3385             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3386                                                                  ELCDTECX
  3387 01  FILLER                          PIC  X(13)                   ELCDTECX
  3388                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3389 01  CARRIER-NAMES.                                               ELCDTECX
  3390     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3391         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3392         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3393         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3394         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3395         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3396         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3397*        16  FILLER                  PIC  X.                      ELCDTECX
  3398         16  CARRIER-SEC-PAY         PIC  X.
  3399             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3400                                                                  ELCDTECX
  3401 01  FILLER                          PIC  X(9)                       CL**6
  3402                                          VALUE 'INS TYPES'.      ELCDTECX
  3403 01  CLAS-INS-TYPES.                                              ELCDTECX
  3404*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3405     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3406         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3407         16  CLAS-I-AB3.                                          ELCDTECX
  3408             20  FILLER              PIC  X.                      ELCDTECX
  3409             20  CLAS-I-AB2.                                      ELCDTECX
  3410                 24  FILLER          PIC  X.                      ELCDTECX
  3411                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3412         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3413             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3414             20  FILLER              PIC  X.                         CL**4
  3415         16  CLAS-I-AB10.                                         ELCDTECX
  3416             20  FILLER              PIC  X(9).                   ELCDTECX
  3417             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3418         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3419         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3420         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3421         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3422             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3423         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3424         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3425         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3426         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3427         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  3428         16  FILLER                  PIC  X(05).
  3429                                                                  ELCDTECX
  3430 01  FILLER                          PIC  X(16)                   ELCDTECX
  3431                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  77
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3432 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3433     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3434                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3435         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3436         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3437         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3438         16  CLAS-MORT-DESC.                                      ELCDTECX
  3439             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3440             20  FILLER              PIC  XX.                        CL**5
  3441             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3442             20  FILLER              PIC  X.                         CL**5
  3443             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3444             20  FILLER              PIC  X.                         CL**5
  3445             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3446             20  FILLER              PIC  X.                         CL**5
  3447             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3448             20  FILLER              PIC  X(5).                      CL**6
  3449                                                                  ELCDTECX
  3450 01  FILLER                          PIC  X(15)                   ELCDTECX
  3451                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3452 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3453     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3454         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3455         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3456         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3457         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3458         16  FILLER                  PIC  X(4).                      CL**6
  3459                                                                  ELCDTECX
  3460 01  FILLER                          PIC  X(7)                       CL**6
  3461                                     VALUE 'INDEXES'.             ELCDTECX
  3462 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3463     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3464     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3465     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3466     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3467     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3468     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3469     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3470     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3471     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3472     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3473     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3474     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3475     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3476     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3477     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3478     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3479     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3480                                                                  ELCDTECX
  3481 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3482     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3483     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3484     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3485     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3486     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3487     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3488     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3489     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  78
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3490     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3491     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3492     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3493                                                                  ELCDTECX
  3494 01  FILLER                          PIC  X(13)                   ELCDTECX
  3495                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3496 01  CLAS-MISC.                                                   ELCDTECX
  3497     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3498         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3499         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3500         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3501     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3502     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3503     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3504     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3505     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3506     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3507     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3508     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3509     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3510     12  STATE-L                     PIC  XX.                     ELCDTECX
  3511     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3512     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3513     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3514         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3515         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3516     12  DTE-ABEND-WORK.                                          ELCDTECX
  3517         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3518         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3519                                                                  ELCDTECX
  3520 01  FILLER                          PIC  X(12)                   ELCDTECX
  3521                                     VALUE 'WORKING DATE'.        ELCDTECX
  3522 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3523     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3524         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3525         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3526         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3527     12  WS-CURRENT-DATE.                                         ELCDTECX
  3528         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3529         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3530         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3531         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3532         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3533     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3534         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3535         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3536                                                                  ELCDTECX
  3537 01  FILLER                          PIC  X(12)                   ELCDTECX
  3538                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3539 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3540     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3541         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3542         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3543         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3544                                                                  ELCDTECX
  3545 01  FILLER                          PIC  X(10)                   ELCDTECX
  3546                                     VALUE 'STATE TLRS'.          ELCDTECX
  3547 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  79
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3548     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3549         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3550         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3551                                                                  ELCDTECX
  3552 01  FILLER                          PIC  X(13)                   ELCDTECX
  3553                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3554 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3555     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3556         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3557                                                                  ELCDTECX
  3558 01  FILLER                          PIC  X(13)                   ELCDTECX
  3559                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3560 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3561     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3562     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3563     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3564                                     PIC  X.                         CL**5
  3565     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3566     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3567     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3568     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3569     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3570     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3571     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3572     12  FILLER                      PIC  X(75).                  ELCDTECX
  3573******************************************************************ELCDTECX
  3574*01  MISC-CARR-PCT-DATA.                                          00001521
  3575*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3576*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3577*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3578*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3579*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3580*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3581******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  80
* ECS150.cbl
* 3583                             COPY ELCDTEVR.
  3584***************************************************************** 04/15/98
  3585*                                                                *ELCDTEVR
  3586*                                                                *ELCDTEVR
  3587*                            ELCDTEVR.                           *   LV003
  3588*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3589*                            VMOD=2.001                          *   CL**2
  3590*                                                                *ELCDTEVR
  3591*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3592*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3593*                                                                *ELCDTEVR
  3594******************************************************************ELCDTEVR
  3595 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3596     05  WS-RUN-DATE.                                             ELCDTEVR
  3597         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3598         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3599         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3600             15  RUN-CC              PIC  99.                     ELCDTEVR
  3601             15  RUN-YR              PIC  99.                     ELCDTEVR
  3602         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3603         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3604     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3605            WS-RUN-DATE              PIC 9(11).                      CL**2
  3606     05  WS-EP-DT.                                                ELCDTEVR
  3607         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3608         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3609         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3610             15  EP-CC               PIC  99.                     ELCDTEVR
  3611             15  EP-YR               PIC  99.                     ELCDTEVR
  3612         10  EP-MO                   PIC  99.                     ELCDTEVR
  3613         10  EP-DA                   PIC  99.                     ELCDTEVR
  3614     05  WS-EP-DT-N REDEFINES                                        CL**2
  3615            WS-EP-DT                 PIC 9(11).                      CL**2
  3616     05  WS-DTE-CONV-DT.                                             CL**4
  3617         10  FILLER                  PIC  9(03).                     CL**4
  3618         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3619         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3620             15  DTE-CONV-CC         PIC  99.                        CL**4
  3621             15  DTE-CONV-YR         PIC  99.                        CL**4
  3622         10  DTE-CONV-MO             PIC  99.                        CL**4
  3623         10  DTE-CONV-DA             PIC  99.                        CL**4
  3624     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3625            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3626 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3627     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3628         10  FILLER                            PIC 999.           ELCDTEVR
  3629         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3630         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3631             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3632             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3633         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3634         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3635     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3636            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3637     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3638         10  FILLER                            PIC 999.           ELCDTEVR
  3639         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3640         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  81
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3641         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3642         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3643     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3644            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3645 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3646     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3647         10  FILLER                            PIC 999.           ELCDTEVR
  3648         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3649         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3650             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3651             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3652         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3653         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3654     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3655            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3656     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3657         10  FILLER                            PIC 999.           ELCDTEVR
  3658         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3659         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3660             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3661             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3662         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3663         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3664     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3665            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3666     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3667         10  FILLER                            PIC 999.           ELCDTEVR
  3668         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3669         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3670             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3671             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3672         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3673         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3674     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3675            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3676 01  WS-RATE-RECORD.                                              ELCDTEVR
  3677         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3678             10  FILLER                        PIC 999.           ELCDTEVR
  3679             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3680             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3681                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3682                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3683             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3684             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3685         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3686                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  82
* ECS150.cbl
* 3688                             COPY ELCCRTVR.
  3689***************************************************************** 04/24/98
  3690*                                                                *ELCCRTVR
  3691*                                                                *ELCCRTVR
  3692*                            ELCCRTVR                            *   LV003
  3693*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3694*                            VMOD=2.001                          *ELCCRTVR
  3695*                                                                *ELCCRTVR
  3696*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3697*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3698*                                                                *ELCCRTVR
  3699******************************************************************ELCCRTVR
  3700                                                                  ELCCRTVR
  3701 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3702     05  WS-CR-DT.                                                ELCCRTVR
  3703         10  FILLER                PIC 999.                       ELCCRTVR
  3704         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3705         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3706             15  CR-CC             PIC 99.                        ELCCRTVR
  3707             15  CR-YR             PIC 99.                        ELCCRTVR
  3708         10  CR-MO                 PIC 99.                        ELCCRTVR
  3709         10  CR-DA                 PIC 99.                        ELCCRTVR
  3710     05  WS-CR-DT-N REDEFINES                                        CL**2
  3711            WS-CR-DT               PIC 9(11).                        CL**2
  3712     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3713         10  FILLER                    PIC 999.                   ELCCRTVR
  3714         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3715         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3716             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3717             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3718         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3719         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3720     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3721            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3722     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3723         10  FILLER                    PIC 999.                   ELCCRTVR
  3724         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3725         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3726             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3727             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3728         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3729         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3730     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3731            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3732     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3733         10  FILLER                    PIC 999.                   ELCCRTVR
  3734         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3735         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3736             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3737             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3738         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3739         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3740     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3741            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3742     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3743         10  FILLER                    PIC 999.                   ELCCRTVR
  3744         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3745         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  83
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3746             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3747             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3748         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  3749         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3750     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3751            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3752     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3753         10  FILLER                    PIC 999.                   ELCCRTVR
  3754         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3755         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3756             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3757             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3758         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3759         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3760     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3761            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3762     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3763         10  FILLER                    PIC 999.                   ELCCRTVR
  3764         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3765         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3766             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3767             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3768         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3769         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3770     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3771            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3772     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3773         10  FILLER                    PIC 999.                   ELCCRTVR
  3774         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3775         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3776             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3777             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3778         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3779         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  3780     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3781            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3782     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3783         10  FILLER                    PIC 999.                   ELCCRTVR
  3784         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3785         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3786             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3787             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3788         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3789         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3790     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3791            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3792     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3793         10  FILLER                    PIC 999.                   ELCCRTVR
  3794         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3795         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3796             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3797             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3798         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3799         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3800     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3801          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3802     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3803         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  84
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3804         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3805         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3806             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  3807             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3808         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3809         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3810     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3811            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3812     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3813         10  FILLER                    PIC 999.                   ELCCRTVR
  3814         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3815         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3816             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3817             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3818         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3819         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3820     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3821            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3822     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3823         10  FILLER                    PIC 999.                   ELCCRTVR
  3824         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3825         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3826             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3827             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3828         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3829         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3830     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3831            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3832     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3833         10  FILLER                    PIC 999.                   ELCCRTVR
  3834         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3835         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3836             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3837             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  3838         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3839         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3840     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3841            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3842     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3843         10  FILLER                    PIC 999.                   ELCCRTVR
  3844         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3845         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3846             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3847             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3848         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3849         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3850     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3851            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3852     05  COPY-NDX                      PIC 9.                        CL**6
  3853     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3854         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3855             15  FILLER                PIC 999.                   ELCCRTVR
  3856             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3857             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3858                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3859                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3860             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3861             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  85
* ECS150.cbl
  3862         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3863                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  86
* ECS150.cbl
* 3865                             COPY ELCACCTV.
  3866******************************************************************04/14/98
  3867*                                                                *ELCACCTV
  3868*                            ELCACCTV                            *   LV002
  3869*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3870*                            VMOD=2.001                          *ELCACCTV
  3871*                                                                *ELCACCTV
  3872*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  3873*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  3874*                                                                *ELCACCTV
  3875*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  3876*                                                                *ELCACCTV
  3877******************************************************************ELCACCTV
  3878                                                                  ELCACCTV
  3879 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  3880                                                                  ELCACCTV
  3881     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  3882         10  FILLER            PIC 999.                           ELCACCTV
  3883         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  3884         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  3885             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  3886             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  3887         10  AM-EXP-MO         PIC 99.                               CL**5
  3888         10  AM-EXP-DA         PIC 99.                               CL**5
  3889     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  3890            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  3891     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  3892         10  FILLER                    PIC 999.                   ELCACCTV
  3893         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  3894         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  3895             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  3896             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  3897         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  3898         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  3899     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  3900            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  3901     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  3902         10  FILLER                    PIC 999.                   ELCACCTV
  3903         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  3904         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  3905             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  3906             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  3907         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  3908         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  3909     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  3910            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  3911     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  3912         10 FILLER                     PIC 999.                   ELCACCTV
  3913         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  3914         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  3915            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  3916            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  3917         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  3918         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  3919     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  3920            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  3921     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  3922         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  87
* ECS150.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  3923         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  3924         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  3925            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  3926            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  3927         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  3928         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  3929     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  3930            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  3931     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  3932         10  FILLER                    PIC 999.                   ELCACCTV
  3933         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  3934         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  3935             15  AM-AN-CC              PIC 99.                    ELCACCTV
  3936             15  AM-AN-YR              PIC 99.                    ELCACCTV
  3937         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  3938         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  3939     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  3940            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  3941     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  3942         10  FILLER                    PIC 999.                   ELCACCTV
  3943         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  3944         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  3945             15  AM-HI-CC              PIC 99.                    ELCACCTV
  3946             15  AM-HI-YR              PIC 99.                    ELCACCTV
  3947         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  3948         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  3949     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  3950            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  3951     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  3952         10  FILLER                    PIC 999.                   ELCACCTV
  3953         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  3954         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  3955             15  AM-LO-CC              PIC 99.                    ELCACCTV
  3956             15  AM-LO-YR              PIC 99.                    ELCACCTV
  3957         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  3958         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  3959     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  3960            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  3961     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  3962         10  FILLER                    PIC 999.                   ELCACCTV
  3963         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  3964         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  3965             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  3966             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  3967         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  3968         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  3969     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  3970            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  88
* ECS150.cbl
* 3972                             COPY ELCREINV.
  3973******************************************************************04/18/98
  3974*                                                                *ELCREINV
  3975*                                                                *ELCREINV
  3976*                            ELCREINV                            *   LV003
  3977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3978*                            VMOD=2.001                          *ELCREINV
  3979*                                                                *ELCREINV
  3980*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3981*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3982*                                                                *ELCREINV
  3983******************************************************************ELCREINV
  3984                                                                  ELCREINV
  3985 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3986     05  WS-RE-LO-DATE.                                              CL**3
  3987         10 FILLER                     PIC 999.                      CL**3
  3988         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3989         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3990            15 RE-LO-CC                PIC 99.                       CL**3
  3991            15 RE-LO-YR                PIC 99.                       CL**3
  3992         10 RE-LO-MO                   PIC 99.                       CL**3
  3993         10 RE-LO-DA                   PIC 99.                       CL**3
  3994     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3995            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3996     05  WS-RE-HI-DATE.                                              CL**3
  3997         10 FILLER                     PIC 999.                      CL**3
  3998         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3999         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  4000            15 RE-HI-CC                PIC 99.                       CL**3
  4001            15 RE-HI-YR                PIC 99.                       CL**3
  4002         10 RE-HI-MO                   PIC 99.                       CL**3
  4003         10 RE-HI-DA                   PIC 99.                       CL**3
  4004     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  4005            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  4006     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  4007         10 FILLER                     PIC 999.                   ELCREINV
  4008         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  4009         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  4010            15 RE-CLM-CC               PIC 99.                    ELCREINV
  4011            15 RE-CLM-YR               PIC 99.                    ELCREINV
  4012         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  4013         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  4014     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  4015            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  4016     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  4017         10  FILLER                    PIC 999.                   ELCREINV
  4018         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  4019         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  4020             15  RE-EARN-CC            PIC 99.                    ELCREINV
  4021             15  RE-EARN-YR            PIC 99.                    ELCREINV
  4022         10  RE-EARN-MO                PIC 99.                    ELCREINV
  4023         10  RE-EARN-DA                PIC 99.                    ELCREINV
  4024     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  4025            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  4026     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  4027         10  FILLER                    PIC 999.                   ELCREINV
  4028         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  4029         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  89
* ECS150.cbl (/apps/prod/cid1p/copy/ELCREINV)
  4030             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  4031             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  4032         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  4033         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  4034     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  4035            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  90
* ECS150.cbl
  4037 PROCEDURE DIVISION.
  4038******************************************************************
  4039*                                                                *
  4040*                *** SECTION DESCRIPTIONS ***                    *
  4041*  * SECTION NO. *                                               *
  4042*                                                                *
  4043*      1000      CLAS DATE LOAD, DATE EDITS, WORK AREA INIT      *
  4044*                                                                *
  4045*      2000      PERFORM LOOP FOR EXTRACT-A                      *
  4046*                                                                *
  4047*      3000      PERFORM LOOP FOR EXTRACT-B                      *
  4048*                                                                *
  4049*      4000      COMPUTATIONS FOR-RESERVES, CLAIMS, ISSUES,      *
  4050*                                 CANCELS, INCREASES/DECREASES   *
  4051*                                                                *
  4052*      5000      PRINT ROUTINES                                  *
  4053*                                                                *
  4054*      6000      REINSURANCE CALCULATIONS                        *
  4055*                                                                *
  4056*      7000      LEVEL BREAK PROCESSING                          *
  4057*                                                                *
  4058*      8000      MISCELANEOUS ROUTINES                           *
  4059*                                                                *
  4060*      9990      PROGRAM EXIT                                    *
  4061******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  91
* ECS150.cbl
  4063 0100-ININITIALIZATION       SECTION 49.
  4064
  4065 0110-CLAS-DATA-LOAD.
* 4066                             COPY ELCDTERX.
  4067******************************************************************04/15/98
  4068*                                                                *ELCDTERX
  4069*                                                                *ELCDTERX
  4070*                            ELCDTERX.                           *   LV002
  4071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4072*                            VMOD=2.007                          *ELCDTERX
  4073*                                                                *ELCDTERX
  4074*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  4075*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  4076*      = ELCDTEFD)                                               *ELCDTERX
  4077*                                                                *ELCDTERX
  4078******************************************************************ELCDTERX
  4079                                                                  ELCDTERX
  4080     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  4081                                                                  ELCDTERX
  4082     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  4083     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  4084     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  4085                                                                  ELCDTERX
  4086     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  4087                                                                  ELCDTERX
  4088******************************************************************ELCDTERX
  4089*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  4090*          WARNING MESSAGES.                                      ELCDTERX
  4091******************************************************************ELCDTERX
  4092     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  4093         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  4094                                                                  ELCDTERX
  4095     OPEN INPUT DISK-DATE.                                        ELCDTERX
  4096                                                                  ELCDTERX
  4097     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  4098                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  4099                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  4100                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  4101                   CLAX-ID           CLAS-MISC                    ELCDTERX
  4102                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  4103                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  4104                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  4105                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  4106                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  4107                                                                  ELCDTERX
  4108     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  4109                                                                  ELCDTERX
  4110     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  4111                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  4112                                                                  ELCDTERX
  4113     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  4114     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  4115     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  4116     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  4117                                                                  ELCDTERX
  4118     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  4119         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4120     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  92
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4121         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4122                                                                  ELCDTERX
  4123     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4124         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4125     ELSE                                                         ELCDTERX
  4126         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4127                                                                  ELCDTERX
  4128 0005-READ--CARD.                                                 ELCDTERX
  4129     READ DISK-DATE                                               ELCDTERX
  4130         AT END CLOSE DISK-DATE                                   ELCDTERX
  4131             GO TO 0060-READ--TEST.                               ELCDTERX
  4132                                                                  ELCDTERX
  4133     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4134                                                                  ELCDTERX
  4135     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4136         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4137         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4138         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4139         GO TO 0005-READ--CARD.                                   ELCDTERX
  4140                                                                  ELCDTERX
  4141     IF DD-ID = 'CLAD'                                            ELCDTERX
  4142         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4143         GO TO 0005-READ--CARD.                                   ELCDTERX
  4144                                                                  ELCDTERX
  4145     IF DD-ID = 'CLAX'                                            ELCDTERX
  4146         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4147         GO TO 0005-READ--CARD.                                   ELCDTERX
  4148                                                                  ELCDTERX
  4149     IF DD-ID = 'CLAF'                                            ELCDTERX
  4150         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4151         GO TO 0005-READ--CARD.                                   ELCDTERX
  4152                                                                  ELCDTERX
  4153     IF DD-ID = 'CLAC'                                            ELCDTERX
  4154         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4155                                                                  ELCDTERX
  4156     IF DD-ID = 'CARR'                                            ELCDTERX
  4157         GO TO 0015-READ--CARR.                                   ELCDTERX
  4158                                                                  ELCDTERX
  4159     IF DD-ID = 'STAT'                                            ELCDTERX
  4160         GO TO 0020-READ--STAT.                                   ELCDTERX
  4161                                                                  ELCDTERX
  4162     IF DD-ID = 'BUSC'                                            ELCDTERX
  4163         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4164                                                                  ELCDTERX
  4165     IF DD-ID = 'MORT'                                            ELCDTERX
  4166         GO TO 0030-READ--MORT.                                   ELCDTERX
  4167                                                                  ELCDTERX
  4168     IF DD-ID = 'CLAI'                                            ELCDTERX
  4169         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4170                                                                  ELCDTERX
  4171     IF DD-ID = 'COLC'                                            ELCDTERX
  4172         GO TO 0065-READ--COLC.                                   ELCDTERX
  4173                                                                  ELCDTERX
  4174     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4175        DD-IDA = 'CL'                                             ELCDTERX
  4176         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4177                                                                  ELCDTERX
  4178     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  93
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4179        DD-IDA = 'PO'                                             ELCDTERX
  4180         GO TO 0050-READ--POXX.                                   ELCDTERX
  4181                                                                  ELCDTERX
  4182     IF DD-ID = 'OPCA'                                            ELCDTERX
  4183         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4184                                                                  ELCDTERX
  4185     IF DD-ID = 'OPST'                                            ELCDTERX
  4186         GO TO 0072-READ--OPST.                                   ELCDTERX
  4187                                                                  ELCDTERX
  4188     IF DD-ID = 'OPBS'                                            ELCDTERX
  4189         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4190                                                                  ELCDTERX
  4191     IF DD-ID = 'OPMS'                                            ELCDTERX
  4192         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4193                                                                  ELCDTERX
  4194     GO TO 0005-READ--CARD.                                       ELCDTERX
  4195                                                                  ELCDTERX
  4196 0010-READ--CLAC.                                                 ELCDTERX
  4197     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4198     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4199     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4200     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4201     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4202     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4203     GO TO 0005-READ--CARD.                                       ELCDTERX
  4204                                                                  ELCDTERX
  4205 0015-READ--CARR.                                                 ELCDTERX
  4206     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4207     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4208        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4209        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4210        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4211        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4212        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4213        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4214        MOVE DD-CARR1-SECPAY-SW
  4215                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4216     END-IF
  4217                                                                  ELCDTERX
  4218     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4219     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4220        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4221        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4222        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4223        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4224        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4225        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4226        MOVE DD-CARR2-SECPAY-SW
  4227                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4228     END-IF
  4229                                                                  ELCDTERX
  4230                                                                  ELCDTERX
  4231     GO TO 0005-READ--CARD.                                       ELCDTERX
  4232                                                                  ELCDTERX
  4233 0020-READ--STAT.                                                 ELCDTERX
  4234     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4235     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4236        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  94
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4237         GO TO 0005-READ--CARD.                                   ELCDTERX
  4238                                                                  ELCDTERX
  4239     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4240     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4241     GO TO 0020-READ--STAT.                                       ELCDTERX
  4242                                                                  ELCDTERX
  4243 0025-READ--BUSC.                                                 ELCDTERX
  4244     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4245     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4246        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4247         GO TO 0005-READ--CARD.                                   ELCDTERX
  4248                                                                  ELCDTERX
  4249     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4250     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4251     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4252                                                                  ELCDTERX
  4253 0030-READ--MORT.                                                 ELCDTERX
  4254     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4255     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4256        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4257         GO TO 0005-READ--CARD.                                   ELCDTERX
  4258                                                                  ELCDTERX
  4259     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4260     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4261     GO TO 0030-READ--MORT.                                       ELCDTERX
  4262                                                                  ELCDTERX
  4263 0035-READ--CLXX.                                                 ELCDTERX
  4264     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4265          GO TO 0005-READ--CARD.                                  ELCDTERX
  4266                                                                  ELCDTERX
  4267     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4268         DISPLAY '***********************************************'ELCDTERX
  4269         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4270         DISPLAY '***********************************************'ELCDTERX
  4271         GO TO 0055-READ--STOP.                                   ELCDTERX
  4272                                                                  ELCDTERX
  4273     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4274        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4275         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4276                                                                  ELCDTERX
  4277     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4278        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4279         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4280                                                                  ELCDTERX
  4281*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4282     GO TO 0005-READ--CARD.                                       ELCDTERX
  4283                                                                  ELCDTERX
  4284 0040-READ--CLAI.                                                 ELCDTERX
  4285     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4286     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4287        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4288         GO TO 0005-READ--CARD.                                   ELCDTERX
  4289                                                                  ELCDTERX
  4290     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4291     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4292     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4293                                                                  ELCDTERX
  4294 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  95
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4295     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4296     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4297                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4298     PERFORM ABEND-PGM.                                           ELCDTERX
  4299                                                                  ELCDTERX
  4300 0050-READ--POXX.                                                 ELCDTERX
  4301     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4302         GO TO 0005-READ--CARD.                                   ELCDTERX
  4303                                                                  ELCDTERX
  4304     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4305         DISPLAY '***********************************************'ELCDTERX
  4306         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4307         DISPLAY '***********************************************'ELCDTERX
  4308         GO TO 0055-READ--STOP.                                   ELCDTERX
  4309                                                                  ELCDTERX
  4310     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4311     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4312     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4313     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4314                                                                  ELCDTERX
  4315     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4316         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4317     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4318         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4319                                                                  ELCDTERX
  4320     GO TO 0005-READ--CARD.                                       ELCDTERX
  4321                                                                  ELCDTERX
  4322 0055-READ--STOP.                                                 ELCDTERX
  4323     GOBACK.                                                      ELCDTERX
  4324                                                                  ELCDTERX
  4325 0060-READ--TEST.                                                 ELCDTERX
  4326     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4327        CLAX-ID         = SPACE  OR                               ELCDTERX
  4328        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4329         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4330                                                                  ELCDTERX
  4331     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4332     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4333                                                                  ELCDTERX
  4334 0065-READ--COLC.                                                 ELCDTERX
  4335     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4336     GO TO 0005-READ--CARD.                                       ELCDTERX
  4337                                                                  ELCDTERX
  4338 0070-READ--OPCA.                                                 ELCDTERX
  4339                                                                  ELCDTERX
  4340     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4341                                                                  ELCDTERX
  4342     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4343             OR                                                   ELCDTERX
  4344         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4345         GO TO 0005-READ--CARD.                                   ELCDTERX
  4346                                                                  ELCDTERX
  4347     ADD 1                       TO INDEXCA.                      ELCDTERX
  4348     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4349                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4350     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4351                                                                  ELCDTERX
  4352 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  96
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4353                                                                  ELCDTERX
  4354     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4355                                                                  ELCDTERX
  4356     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4357             OR                                                   ELCDTERX
  4358         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4359         GO TO 0005-READ--CARD.                                   ELCDTERX
  4360                                                                  ELCDTERX
  4361     ADD 1                       TO INDEXST.                      ELCDTERX
  4362     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4363                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4364     GO TO 0072-READ--OPST.                                       ELCDTERX
  4365                                                                  ELCDTERX
  4366 0074-READ--OPBS.                                                 ELCDTERX
  4367                                                                  ELCDTERX
  4368     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4369                                                                  ELCDTERX
  4370     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4371             OR                                                   ELCDTERX
  4372         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4373         GO TO 0005-READ--CARD.                                   ELCDTERX
  4374                                                                  ELCDTERX
  4375     ADD 1                       TO INDEXBS.                      ELCDTERX
  4376     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4377     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4378                                                                  ELCDTERX
  4379 0079-READ--EXIT.                                                 ELCDTERX
  4380*    EXIT.                                                        ELCDTERX
  4381******************************************************************ELCDTERX
  4382
  4383 0120-PERIOD-EDIT.
  4384**   MOVE 1 TO DTE-PGM-OPT.
  4385     IF EP-CCYY GREATER THAN RUN-CCYY OR
  4386        EP-MO GREATER THAN RUN-MO
  4387         GO TO 0130-CLEAR-WORK.
  4388
  4389     IF EP-DT = RUN-DATE
  4390         SUBTRACT +1 FROM RUN-CCYY
  4391         MOVE WS-RUN-DATE-N TO RUN-DATE
  4392         GO TO 0130-CLEAR-WORK.
  4393
  4394     DISPLAY 'PERIOD START IS AFTER PERIOD END-CHECK CLAS CARD'.
  4395     MOVE '0998'                 TO ABEND-CODE.
  4396     GO TO ABEND-PGM.
  4397
  4398 0130-CLEAR-WORK.
  4399     MOVE HIGH-VALUES            TO REIN-HOLD-AREAS.
  4400     MOVE SPACES                 TO REIN-LEVELS-END.
  4401     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT
  4402         VARYING CL FROM +1 BY +1
  4403             UNTIL CL GREATER THAN +5.
  4404
  4405 0140-OPEN-FILES.
  4406     OPEN INPUT ERACCTT  CERT-FILE
  4407          OUTPUT PRINT-FILE  CLAS150-A-EXTRACT.
  4408     MOVE LOW-VALUES             TO ACCOUNT-MASTER.
  4409
* 4410     COPY ELCACCTI.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  97
* ECS150.cbl (/apps/prod/cid1p/copy/ELCACCTI)
  4411******************************************************************04/14/98
  4412*                                                                *ELCACCTI
  4413*                            ELCACCTI                            *   LV003
  4414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4415*                            VMOD=2.001                          *ELCACCTI
  4416*                                                                *ELCACCTI
  4417*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  4418*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  4419*                                                                *ELCACCTI
  4420*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  4421*                                                                *ELCACCTI
  4422******************************************************************ELCACCTI
  4423     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  4424     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  4425     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  4426     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  4427     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  4428     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  4429     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  4430     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  4431     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  4432
  4433     IF ACCT-FILE-STATUS NOT = '00' AND '97'
  4434         MOVE ACCT-FILE-STATUS   TO WS-ABEND-FILE-STATUS
  4435         MOVE ' ERROR ACCOUNT MASTER OPEN '
  4436                                 TO WS-ABEND-MESSAGE
  4437         PERFORM ABEND-PGM.
  4438
  4439     MOVE 'R'                        TO  CP-RATE-FILE.
  4440     MOVE 'O'                        TO  CP-IO-FUNCTION.
  4441     PERFORM 8455-CALL-RATING-ROUTINE THRU 8499-EXIT.
  4442     IF IO-ERROR
  4443         MOVE 0302                   TO  WS-RETURN-CODE
  4444         MOVE 'ERROR OCCURED OPENING - ELRATE'
  4445                                     TO  WS-ABEND-MESSAGE
  4446         GO TO ABEND-PGM.
  4447
  4448 0150-SET-DATES.
  4449
  4450     MOVE RUN-DATE                   TO DC-GREG-DATE-CYMD.
  4451     MOVE 'L'                        TO DC-OPTION-CODE.
  4452     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  4453     MOVE DC-BIN-DATE-1              TO RUN-DATE-BIN PERIOD-START.
  4454
  4455     MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  4456     MOVE 'L'                        TO DC-OPTION-CODE.
  4457     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  4458     MOVE DC-BIN-DATE-1              TO PERIOD-END  EP-DT-BIN.
  4459
  4460     COMPUTE PERIOD-START-9 = (RUN-CCYY * 12) + RUN-MO.
  4461     COMPUTE PERIOD-END-9 = (EP-CCYY * 12) + EP-MO.
  4462
  4463
  4464
  4465     MOVE COMPANY-NAME           TO HL-CO-NAME.
  4466     MOVE WS-CURRENT-DATE        TO HL-DATE.
  4467     MOVE RUN-DATE               TO DATE-WORK.
  4468     MOVE CORRESPONDING RAW-DATE TO FORMAT-DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  98
* ECS150.cbl
  4469     MOVE FORMAT-DATE            TO HL-PER-START.
  4470     MOVE EP-DT                  TO DATE-WORK.
  4471     MOVE CORRESPONDING RAW-DATE TO FORMAT-DATE.
  4472     MOVE FORMAT-DATE            TO HL-PER-END.
  4473
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page  99
* ECS150.cbl
  4475 1000-MAINLINE-CONTROL       SECTION 05.
  4476
  4477 1100-CREATE-EXTRACT-A.
  4478
  4479     PERFORM 2000-EXTRACT-A THRU 2000-EXIT
  4480         UNTIL CR-ACCT-CONTROL = HIGH-VALUES.
  4481     CLOSE ERACCTT CERT-FILE  CLAS150-A-EXTRACT.
  4482
  4483     IF REINS-FILE-OPEN
  4484         CLOSE REINS-EXTRACT-1.
  4485
  4486     IF REIN-OPEN-SW NOT = SPACE
  4487         MOVE SPACE              TO REIN-OPEN-SW
  4488         CLOSE ERRTBL-IN
  4489         IF ERRTBL-FILE-STATUS NOT = '00'
  4490             MOVE '22'           TO ABEND-FILE-ID
  4491             MOVE ERRTBL-FILE-STATUS
  4492                                 TO ABEND-REASON
  4493             GO TO ABEND-PGM.
  4494
  4495     IF NO-REINSURANCE
  4496         GO TO 9990-PROGRAM-END.
  4497
  4498 1200-CREATE-EXTRACT-BC.
  4499     SORT SORT-WORK  ASCENDING KEY SORT-KEY
  4500         USING REINS-EXTRACT-1
  4501             GIVING REINS-EXTRACT-2.
  4502 S1200-EXIT.
  4503     EXIT.
  4504
  4505 1200-CONTINUE.
  4506     OPEN INPUT  REINS-EXTRACT-2
  4507          OUTPUT CLAS150-B-EXTRACT  CLAS150-C-EXTRACT.
  4508     MOVE SPACES                 TO SAVE-CONTROL-BREAKS.
  4509     MOVE LOW-VALUES             TO CERTIFICATE-RECORD.
* 4510     COPY ELCCRTM1.
  4511******************************************************************04/15/98
  4512*                                                                *ELCCRTM1
  4513*                                                                *ELCCRTM1
  4514*                            ELCCRTM1                            *   LV003
  4515*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4516*                            VMOD=2.001                          *ELCCRTM1
  4517*                                                                *ELCCRTM1
  4518*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4519*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4520*                                                                *ELCCRTM1
  4521******************************************************************ELCCRTM1
  4522     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4523     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4524     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4525     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4526     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4527     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4528     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4529     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4530     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4531                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4532     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 100
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4533                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4534     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4535     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4536     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4537     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4538     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4539     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4540           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4541                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4542     END-PERFORM.                                                 ELCCRTM1
  4543                                                                  ELCCRTM1
  4544     MOVE +1                     TO PASS-TYPE.
  4545     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT
  4546         VARYING CL FROM +1 BY +1
  4547             UNTIL CL GREATER +5.
  4548     PERFORM 3000-EXTRACT-BC THRU 3000-EXIT
  4549         UNTIL RC-CONTROL = HIGH-VALUES.
  4550     CLOSE CLAS150-B-EXTRACT  CLAS150-C-EXTRACT  REINS-EXTRACT-2.
  4551     GO TO 9990-PROGRAM-END.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 101
* ECS150.cbl
  4553
  4554 2000-EXTRACT-A          SECTION 10.
  4555 2100-READ-CERT-FILE.
  4556     READ CERT-FILE INTO CERTIFICATE-RECORD AT END
  4557         MOVE HIGH-VALUES        TO CR-ACCT-CONTROL.
  4558
* 4559     COPY ELCCRTM1.
  4560******************************************************************04/15/98
  4561*                                                                *ELCCRTM1
  4562*                                                                *ELCCRTM1
  4563*                            ELCCRTM1                            *   LV003
  4564*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4565*                            VMOD=2.001                          *ELCCRTM1
  4566*                                                                *ELCCRTM1
  4567*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4568*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4569*                                                                *ELCCRTM1
  4570******************************************************************ELCCRTM1
  4571     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4572     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4573     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4574     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4575     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4576     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4577     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4578     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4579     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4580                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4581     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4582                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4583     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4584     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4585     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4586     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4587     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4588     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4589           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4590                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4591     END-PERFORM.                                                 ELCCRTM1
  4592                                                                  ELCCRTM1
  4593
  4594     IF CR-AH-CANC-DT NOT = ZEROS
  4595        IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  4596            MOVE CR-AH-CANC-DT TO CR-AH-CANCEL-EXIT-DATE
  4597                                  WS-CR-AH-CANCEL-EXIT-DATE.
  4598
  4599     IF CR-LF-CANC-DT NOT = ZEROS
  4600        IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  4601            MOVE CR-LF-CANC-DT TO CR-LF-CANCEL-EXIT-DATE
  4602                                  WS-CR-LF-CANCEL-EXIT-DATE.
  4603
  4604     IF CR-ACCT-CONTROL = HIGH-VALUES
  4605         GO TO 2210-CONTINUE.
  4606
  4607     IF CR-POLICY-IS-DECLINED OR
  4608        CR-POLICY-IS-VOID
  4609            DISPLAY 'CERT BYPASSED - VOID OR DECLINED '
  4610                                                CR-FULL-CONTROL
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 102
* ECS150.cbl
  4611            GO TO 2100-READ-CERT-FILE.
  4612
  4613     IF (cr-carrier = '9')
  4614        and (cr-state = 'NE')
  4615        and (cr-account = '0000015860')
  4616        and (cr-cert-no = '1098173790 ')
  4617            DISPLAY 'CERT BYPASSED - the big one '
  4618                                                CR-FULL-CONTROL
  4619            GO TO 2100-READ-CERT-FILE.
  4620
  4621     IF CR-LFTYP NOT = '00'
  4622         IF CR-LF-TERM = 0
  4623             IF CR-AHTYP = '00'
  4624                 DISPLAY 'CERT BYPASSED DUE TO INVALID TERM '
  4625                                                 CR-FULL-CONTROL
  4626                 GO TO 2100-READ-CERT-FILE.
  4627
  4628     IF CR-AHTYP NOT EQUAL '00'
  4629         IF CR-AH-TERM = 0
  4630             IF CR-LFTYP = '00'
  4631                 DISPLAY 'CERT BYPASSED DUE TO INVALID TERM '
  4632                                                 CR-FULL-CONTROL
  4633                 GO TO 2100-READ-CERT-FILE.
  4634
  4635 2210-CONTINUE.
  4636
  4637     IF CR-LFTYP NOT EQUAL '00'
  4638         IF CR-LF-TERM = 0
  4639             DISPLAY 'INVALID TERM ON LIFE CVG ' CR-FULL-CONTROL
  4640             MOVE '00'             TO  CR-LFTYP.
  4641
  4642     IF CR-AHTYP NOT EQUAL '00'
  4643         IF CR-AH-TERM = 0
  4644             DISPLAY 'INVALID TERM ON AH CVG ' CR-FULL-CONTROL
  4645             MOVE '00'             TO  CR-AHTYP.
  4646
  4647     IF SAVE-CONTROL-BREAKS = SPACES
  4648         MOVE CR-CARRIER         TO LAST-CARRIER
  4649         MOVE CR-GROUPING        TO LAST-GROUPING
  4650         MOVE CR-STATE           TO LAST-STATE
  4651         MOVE CR-ACCOUNT         TO LAST-ACCOUNT.
  4652
  4653 2200-MATCH-ACCT-TO-CERT.
  4654
  4655     IF CR-ACCT-CONTROL EQUAL HIGH-VALUES
  4656         GO TO 2300-LEVEL-BREAK-CHECK.
  4657
  4658     IF AM-CONTROL-A LESS THAN CR-ACCT-CONTROL
  4659         PERFORM 2210-ACCT-MAST-READ THRU 2210-EXIT
  4660         GO TO 2200-MATCH-ACCT-TO-CERT.
  4661
  4662     IF AM-CONTROL-A GREATER THAN CR-ACCT-CONTROL
  4663         GO TO 2205-ACCT-CERT-MISMATCH.
  4664
  4665     IF CR-DT  NOT LESS THAN AM-EXPIRE-DT
  4666         PERFORM 2210-ACCT-MAST-READ THRU 2210-EXIT
  4667         GO TO 2200-MATCH-ACCT-TO-CERT.
  4668
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 103
* ECS150.cbl
  4669     IF CR-DT NOT LESS THAN AM-EFFECT-DT
  4670         GO TO 2300-LEVEL-BREAK-CHECK.
  4671
  4672 2205-ACCT-CERT-MISMATCH.
  4673     DISPLAY 'NO MATCHING ACCOUNT MASTER FOR CONTROL '
  4674              CR-ACCT-CONTROL.
  4675
  4676     IF DTE-CLIENT EQUAL 'FIA'
  4677                      OR 'CID' OR 'AHL'
  4678        GO TO 2100-READ-CERT-FILE
  4679     ELSE
  4680        MOVE '0302'              TO ABEND-CODE
  4681        GO TO ABEND-PGM.
  4682
  4683 2210-ACCT-MAST-READ.
  4684     READ ERACCTT AT END
  4685         MOVE HIGH-VALUES        TO ACCOUNT-MASTER.
  4686
* 4687     COPY ELCACCTI.
  4688******************************************************************04/14/98
  4689*                                                                *ELCACCTI
  4690*                            ELCACCTI                            *   LV003
  4691*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4692*                            VMOD=2.001                          *ELCACCTI
  4693*                                                                *ELCACCTI
  4694*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  4695*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  4696*                                                                *ELCACCTI
  4697*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  4698*                                                                *ELCACCTI
  4699******************************************************************ELCACCTI
  4700     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  4701     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  4702     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  4703     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  4704     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  4705     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  4706     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  4707     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  4708     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  4709
  4710 2210-EXIT.
  4711     EXIT.
  4712
  4713 2300-LEVEL-BREAK-CHECK.
  4714
  4715     IF (LAST-CARRIER NOT = CR-CARRIER) OR
  4716        (LAST-GROUPING NOT = CR-GROUPING)
  4717         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4718         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT
  4719         MOVE CR-ACCT-CONTROL   TO SAVE-CNTRL-GRP
  4720         GO TO 2400-VALIDATE-DATA.
  4721
  4722     IF LAST-STATE NOT EQUAL CR-STATE
  4723         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4724         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP
  4725         GO TO 2400-VALIDATE-DATA.
  4726
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 104
* ECS150.cbl
  4727     IF LAST-ACCOUNT NOT EQUAL CR-ACCOUNT
  4728         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT
  4729         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP.
  4730
  4731 2400-VALIDATE-DATA.
  4732     IF SAVE-CNTRL-GRP = HIGH-VALUES
  4733         GO TO 2000-EXIT.
  4734
  4735*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
  4736*        MOVE AM-EARN-METHOD-A   TO AH-EARN-METHOD
  4737*    ELSE
  4738     MOVE SPACES                 TO AH-EARN-METHOD
  4739
  4740     IF CR-IND-GRP NOT = '1' AND '2'
  4741         MOVE AM-IG              TO CR-IND-GRP.
  4742     IF CR-LFAMT-ALT NOT NUMERIC
  4743         MOVE ZEROS              TO CR-LFAMT-ALT.
  4744     IF CR-LFPRM-ALT NOT NUMERIC
  4745         MOVE ZEROS              TO CR-LFPRM-ALT.
  4746     IF CR-LFPRM-CALC NOT NUMERIC
  4747         MOVE ZEROES             TO CR-LFPRM-CALC.
  4748     IF CR-AHPRM-CALC NOT NUMERIC
  4749         MOVE ZEROES             TO CR-AHPRM-CALC.
  4750     IF CR-LFRFND-CALC NOT NUMERIC
  4751         MOVE ZEROES             TO CR-LFRFND-CALC.
  4752     IF CR-AHRFND-CALC NOT NUMERIC
  4753         MOVE ZEROES             TO CR-AHRFND-CALC.
  4754     IF CR-APR NOT NUMERIC
  4755         MOVE ZEROS              TO CR-APR.
  4756     IF CR-AGE NOT NUMERIC
  4757         MOVE ZEROS              TO CR-AGE.
  4758     IF CR-LIVES NOT NUMERIC
  4759         MOVE ZERO               TO CR-LIVES.
  4760     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  4761         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  4762     IF CR-SUM-CAN-CNT-YTD NOT NUMERIC
  4763         MOVE ZERO               TO CR-SUM-CAN-CNT-YTD.
  4764     IF CR-DTHEXP-YTD NOT NUMERIC
  4765         MOVE ZERO               TO CR-DTHEXP-YTD.
  4766     IF CR-DTHAMT-YTD NOT NUMERIC
  4767         MOVE ZERO               TO CR-DTHAMT-YTD.
  4768     IF CR-DISAMT-YTD NOT NUMERIC
  4769         MOVE ZERO               TO CR-DISAMT-YTD.
  4770     IF CR-DISEXP-YTD NOT NUMERIC
  4771         MOVE ZERO               TO CR-DISEXP-YTD.
  4772
  4773     ADD CR-DTHEXP-YTD           TO CR-DTHAMT-YTD.
  4774     ADD CR-DISEXP-YTD           TO CR-DISAMT-YTD.
  4775
  4776     MOVE CR-DIS-CC              TO CR-DIS-INC-CC (1).
  4777     MOVE CR-DIS-YR              TO CR-DIS-INC-YR (1).
  4778     MOVE CR-DIS-MO              TO CR-DIS-INC-MO (1).
  4779     MOVE CR-DIS-DA              TO CR-DIS-INC-DA (1).
  4780     MOVE WS-CR-DIS-INCUR-DT(1)  TO CR-DIS-INCUR-DT (1).
  4781     MOVE CR-DISAMT-YTD          TO CR-INCUR-DISAMT (1).
  4782
  4783     MOVE ZEROS                  TO CR-INCUR-DISEXP (1)
  4784                                    CR-DIS-INCUR-DT (2)
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 105
* ECS150.cbl
  4785                                    WS-CR-DIS-INCUR-DT(2)
  4786                                    CR-DIS-INCUR-DT (3)
  4787                                    WS-CR-DIS-INCUR-DT(3)
  4788                                    CR-DIS-INCUR-DT (4)
  4789                                    WS-CR-DIS-INCUR-DT(4)
  4790                                    CR-DIS-INCUR-DT (5)
  4791                                    WS-CR-DIS-INCUR-DT(5).
  4792
  4793 2500-CALC-1ST-INS.
  4794     MOVE 0                      TO RECORD-TYPE-SW.
  4795     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  4796
  4797 2600-CALC-REINSURANCE.
  4798     IF CR-REIN-TABLE = SPACES OR ZEROES
  4799         GO TO 2000-EXIT.
  4800
  4801     IF REINS-FILE-CLOSED
  4802         OPEN OUTPUT REINS-EXTRACT-1
  4803         MOVE 1                  TO REINS-FILE-SW.
  4804
  4805     PERFORM 6000-REINSURANCE-CALC THRU 6000-EXIT.
  4806     PERFORM 2700-REINS-EXTRACT THRU 2700-EXIT
  4807         VARYING SUB1 FROM +1 BY +1
  4808             UNTIL REIN-COMP (SUB1) = SPACES.
  4809     GO TO 2000-EXIT.
  4810
  4811 2700-REINS-EXTRACT.
  4812     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  4813         GO TO 2700-EXIT.
  4814
  4815     IF REIN-REM-SW (SUB1) = 'Z'
  4816         GO TO 2700-EXIT.
  4817     perform varying sub3 from +1 by +1 until
  4818        (sub3 > +1500) or
  4819        (rein-comp (sub1) = rc2-rein-co (sub3))
  4820     end-perform
  4821     if sub3 > +1500
  4822        go to 2700-exit
  4823     else
  4824        if rc2-ecs152-rpt (sub3) = 'Y'
  4825           continue
  4826        else
  4827           go to 2700-exit
  4828        end-if
  4829     end-if
  4830
  4831
  4832     MOVE REIN-WORK-FLDS (SUB1)  TO RWF-FIELDS.
  4833     MOVE SAVE-REINS-CERT        TO RC-REC.
  4834     MOVE REIN-COMP (SUB1)       TO RC-COMP.
  4835     MOVE RC-AHTYP               TO CR-AHTYP.
  4836     MOVE RC-LFTYP               TO CR-LFTYP.
  4837     MOVE RC-PMT-FREQ            TO CR-PMT-FREQ.
  4838     MOVE RC-I-LIVES             TO CR-LIVES.
  4839     MOVE RC-C-LIVES-ITD         TO CR-SUM-CAN-CNT-ITD.
  4840     MOVE RC-C-LIVES-YTD         TO CR-SUM-CAN-CNT-YTD.
  4841     MOVE RC-AHRFND-YTD          TO CR-AHRFND-CALC.
  4842     MOVE RC-LFRFND-YTD          TO CR-LFRFND-CALC.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 106
* ECS150.cbl
  4843     MOVE RC-LF-EXPIRE-DT        TO CR-LF-EXPIRE-DATE
  4844                                    WS-CR-LF-EXPIRE-DATE-N.
  4845     MOVE RC-AH-EXPIRE-DT        TO CR-AH-EXPIRE-DATE
  4846                                    WS-CR-AH-EXPIRE-DATE-N.
  4847     MOVE ZEROES                 TO RC-LFAMT   CR-LFAMT
  4848                                    RC-LFPRM   CR-LFPRM
  4849                                    cr-lfprm-alt
  4850                                    RC-AHAMT   CR-AHAMT
  4851                                    RC-AHPRM   CR-AHPRM
  4852                                    RC-LFRFND  CR-LFRFND
  4853                                    RC-AHRFND  CR-AHRFND
  4854                                    RC-DTHAMT  CR-DTHAMT-YTD
  4855                                    RC-DISAMT  CR-DISAMT-YTD
  4856                                    RC-CEDE-FACT.
  4857
  4858     IF REIN-LF-FLG (SUB1) = 'X'
  4859         MOVE RWF-LFAMT          TO RC-LFAMT   CR-LFAMT
  4860         MOVE RWF-LFPRM          TO RC-LFPRM   CR-LFPRM
  4861         MOVE RWF-LFRFND         TO RC-LFRFND  CR-LFRFND
  4862         MOVE RWF-LFCLM          TO RC-DTHAMT  CR-DTHAMT-YTD
  4863         IF (CR-LFAMT = ZEROS)
  4864            AND (CR-LFPRM = ZEROS)
  4865            MOVE '00'            TO CR-LFTYP
  4866                                    RC-LFTYP
  4867         END-IF
  4868     ELSE
  4869         MOVE ZERO               TO RC-LFTYP  CR-LFTYP.
  4870
  4871     COMPUTE WS-TOTAL-FACE-AMT = RC-ORIG-LFAMT + RC-LFAMT-ALT.
  4872
  4873     IF (REIN-LF-FLG (SUB1) = 'X')  AND
  4874        (CLAS-I-EP (CLAS-INDEXL) = 'B')
  4875         COMPUTE RC-CEDE-FACT = CR-LFAMT / WS-TOTAL-FACE-AMT.
  4876
  4877     IF REIN-AH-FLG (SUB1) = 'X'
  4878         MOVE RWF-AHAMT          TO RC-AHAMT   CR-AHAMT
  4879         MOVE RWF-AHPRM          TO RC-AHPRM   CR-AHPRM
  4880         MOVE RWF-AHRFND         TO RC-AHRFND  CR-AHRFND
  4881         MOVE RWF-AHCLM          TO RC-DISAMT  CR-DISAMT-YTD
  4882         IF (CR-AHAMT = ZEROS)
  4883            AND (CR-AHPRM = ZEROS)
  4884            MOVE '00'            TO CR-AHTYP
  4885                                    RC-AHTYP
  4886         END-IF
  4887     ELSE
  4888         MOVE ZERO               TO RC-AHTYP  CR-AHTYP.
  4889
  4890     ADD +1 TO REINS-REC-CNT.
  4891     MOVE 1                      TO REINSURANCE-FOUND.
  4892     WRITE RC-REC-1 FROM RC-REC.
  4893     .
  4894 2710-EVALUATE-REINS.
  4895     MOVE 1                      TO RECORD-TYPE-SW.
  4896     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  4897
  4898 2700-EXIT.
  4899     EXIT.
  4900
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 107
* ECS150.cbl
  4901 2000-EXIT.
  4902     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 108
* ECS150.cbl
  4904 3000-EXTRACT-BC     SECTION 15.
  4905
  4906 3100-READ-REINS-EXTRACT.
  4907     READ REINS-EXTRACT-2 INTO RC-REC AT END
  4908         MOVE HIGH-VALUES TO RC-CONTROL
  4909         GO TO 2150-CONTROL-BREAKS.
  4910     MOVE SPACES                 TO CERTIFICATE-RECORD.
  4911     MOVE RC-CMCTL               TO CR-FULL-CONTROL.
  4912     MOVE RC-ENTRY-STATUS        TO CR-ENTRY-STATUS.
  4913     MOVE RC-LFTYP               TO CR-LFTYP.
  4914     MOVE RC-LF-TERM             TO CR-LF-TERM.
  4915     MOVE RC-LF-TERM-IN-DAYS     TO CR-LF-TERM-IN-DAYS.
  4916     MOVE RC-LF-CANCEL-STATUS    TO CR-LF-STATUS-AT-CANCEL.
  4917     MOVE RC-LF-CLAIM-STATUS     TO CR-LF-STATUS-AT-DEATH.
  4918     MOVE RC-LF-CURRENT-STATUS   TO CR-LF-CURRENT-STATUS.
  4919     MOVE RC-AHTYP               TO CR-AHTYP.
  4920     MOVE RC-AH-TERM             TO CR-AH-TERM.
  4921     MOVE RC-AH-CANCEL-STATUS    TO CR-AH-STATUS-AT-CANCEL.
  4922     MOVE RC-AH-CLAIM-STATUS     TO CR-AH-STATUS-AT-SETTLEMENT.
  4923     MOVE RC-AH-CURRENT-STATUS   TO CR-AH-CURRENT-STATUS.
  4924     MOVE RC-AHAMT               TO CR-AHAMT.
  4925     MOVE RC-LFAMT               TO CR-LFAMT.
  4926     MOVE RC-LFAMT-ALT           TO CR-LFAMT-ALT.
  4927     MOVE RC-LFPRM               TO CR-LFPRM.
  4928     MOVE RC-AHPRM               TO CR-AHPRM.
  4929     MOVE RC-LFRFND              TO CR-LFRFND.
  4930     MOVE RC-AHRFND              TO CR-AHRFND.
  4931     MOVE RC-DTHAMT              TO CR-DTHAMT-YTD.
  4932     MOVE RC-DISAMT              TO CR-DISAMT-YTD.
  4933     MOVE RC-IND-GRP             TO CR-IND-GRP.
  4934     MOVE RC-LF-CANCEL-STATUS    TO CR-LF-STATUS-AT-CANCEL.
  4935     MOVE RC-LF-CLAIM-STATUS     TO CR-LF-STATUS-AT-DEATH.
  4936     MOVE RC-AH-CANCEL-STATUS    TO CR-AH-STATUS-AT-CANCEL.
  4937     MOVE RC-AH-CLAIM-STATUS     TO CR-AH-STATUS-AT-SETTLEMENT.
  4938     MOVE RC-LF-CANC-DT          TO CR-LF-CANC-DT.
  4939     MOVE RC-AH-CANC-DT          TO CR-AH-CANC-DT.
  4940     MOVE RC-DIS-DT              TO CR-DIS-DT.
  4941     MOVE RC-ENT-DT              TO CR-ENTRY-DATE.
  4942     MOVE RC-LF-CANC-EXIT        TO CR-LF-CANCEL-EXIT-DATE.
  4943     MOVE RC-AH-CANC-EXIT        TO CR-AH-CANCEL-EXIT-DATE.
  4944     MOVE RC-LF-CLAIM-EXIT       TO CR-LF-CLAIM-EXIT-DATE.
  4945     MOVE RC-AH-CLAIM-EXIT       TO CR-AH-SETTLEMENT-EXIT-DATE.
  4946     MOVE RC-PMT-FREQ            TO CR-PMT-FREQ.
  4947     MOVE RC-APR                 TO CR-APR.
  4948     MOVE RC-LOAN-TERM           TO CR-LOAN-TERM.
  4949     MOVE RC-I-LIVES             TO CR-LIVES.
  4950     MOVE RC-C-LIVES-ITD         TO CR-SUM-CAN-CNT-ITD.
  4951     MOVE RC-C-LIVES-YTD         TO CR-SUM-CAN-CNT-YTD.
  4952     MOVE RC-AHRFND-YTD          TO CR-AHRFND-CALC.
  4953     MOVE RC-LFRFND-YTD          TO CR-LFRFND-CALC.
  4954     MOVE RC-LF-EXPIRE-DT        TO CR-LF-EXPIRE-DATE.
  4955     MOVE RC-AH-EXPIRE-DT        TO CR-AH-EXPIRE-DATE.
  4956     MOVE RC-LOAN-1ST-PMT-DT     TO CR-LOAN-1ST-PMT-DT.
  4957
* 4958     COPY ELCCRTM1.
  4959******************************************************************04/15/98
  4960*                                                                *ELCCRTM1
  4961*                                                                *ELCCRTM1
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 109
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4962*                            ELCCRTM1                            *   LV003
  4963*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4964*                            VMOD=2.001                          *ELCCRTM1
  4965*                                                                *ELCCRTM1
  4966*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4967*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4968*                                                                *ELCCRTM1
  4969******************************************************************ELCCRTM1
  4970     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4971     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4972     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4973     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4974     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4975     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4976     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4977     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4978     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4979                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4980     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4981                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4982     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4983     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4984     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4985     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4986     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4987     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4988           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4989                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4990     END-PERFORM.                                                 ELCCRTM1
  4991                                                                  ELCCRTM1
  4992
  4993 2150-CONTROL-BREAKS.
  4994     IF SAVE-CONTROL-BREAKS = SPACES
  4995         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP
  4996         MOVE RC-COMP            TO LAST-REINS-CO.
  4997
  4998     IF LAST-REINS-CO NOT = RC-COMP
  4999         PERFORM 7100-REINS-CO-BREAK THRU 7100-EXIT
  5000         GO TO 3200-CALC-FOR-REINSURANCE.
  5001
  5002     IF LAST-CARRIER NOT = CR-CARRIER
  5003         PERFORM 7200-CARRIER-BREAK THRU 7200-EXIT
  5004         GO TO 3200-CALC-FOR-REINSURANCE.
  5005
  5006     IF LAST-GROUPING NOT = CR-GROUPING
  5007         PERFORM 7300-COMPANY-BREAK THRU 7300-EXIT
  5008         GO TO 3200-CALC-FOR-REINSURANCE.
  5009
  5010     IF LAST-STATE NOT = CR-STATE
  5011         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  5012         GO TO 3200-CALC-FOR-REINSURANCE.
  5013
  5014     IF LAST-ACCOUNT NOT = CR-ACCOUNT
  5015         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT.
  5016
  5017 3200-CALC-FOR-REINSURANCE.
  5018     IF RC-CONTROL = HIGH-VALUES
  5019         GO TO 3000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 110
* ECS150.cbl
  5020
  5021     MOVE CR-ACCT-CONTROL        TO SAVE-CNTRL-GRP.
  5022     MOVE RC-COMP                TO LAST-REINS-CO.
  5023     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  5024
  5025 3000-EXIT.
  5026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 111
* ECS150.cbl
  5028 4000-ACTIVITY-TOTALING  SECTION 25.
  5029
  5030 4100-ELIM-FUTURES.
  5031     MOVE  CR-ENTRY-DATE     TO  DC-GREG-DATE-CYMD.
  5032     MOVE 'L'                TO  DC-OPTION-CODE.
  5033     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5034     IF NO-CONVERSION-ERROR
  5035         MOVE DC-BIN-DATE-1  TO  CERT-ENTRY-DATE
  5036     ELSE
  5037         MOVE CR-DT          TO  DC-GREG-DATE-CYMD
  5038         MOVE 'L'            TO  DC-OPTION-CODE
  5039         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5040                                      8599-DATE-CONVERT-X
  5041         IF NO-CONVERSION-ERROR
  5042             MOVE DC-BIN-DATE-1  TO  CERT-ENTRY-DATE.
  5043
  5044     IF CERT-ENTRY-DATE GREATER THAN PERIOD-END
  5045         GO TO 4000-EXIT.
  5046
  5047     IF CR-ENTRY-STATUS = '9'
  5048         IF REINSURANCE-PASS OR REINSURANCE-REC
  5049             NEXT SENTENCE
  5050         ELSE
  5051             GO TO 4000-EXIT.
  5052
  5053 4110-FIND-CLAS-L-TYPE.
  5054     IF CR-LFTYP = ZERO
  5055         GO TO 4120-FIND-CLAS-A-TYPE.
  5056
  5057     MOVE CR-LFTYP               TO CLAS-LOOK.
  5058     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  5059
  5060 4115-LIFE-LOOKUP.
  5061     IF CLAS-INDEXL IS GREATER THAN CLAS-MAXL
  5062         DISPLAY 'INVALID LIFE TYPE' CLAS-LOOK
  5063         MOVE '0401'             TO ABEND-CODE
  5064         GO TO ABEND-PGM.
  5065
  5066     IF CLAS-I-BEN (CLAS-INDEXL) NOT = CLAS-LOOK
  5067         ADD +1 TO CLAS-INDEXL
  5068         GO TO 4115-LIFE-LOOKUP.
  5069
  5070 4120-FIND-CLAS-A-TYPE.
  5071     IF CR-AHTYP = ZERO
  5072         GO TO 4130-FIND-CLAS-STATE-ABBR.
  5073     MOVE CR-AHTYP               TO CLAS-LOOK.
  5074     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  5075
  5076 4125-AH-LOOKUP.
  5077     IF CLAS-INDEXA IS GREATER THAN CLAS-MAXA
  5078         DISPLAY 'INVALID AH TYPE' CLAS-LOOK
  5079         MOVE '0402'             TO ABEND-CODE
  5080         GO TO ABEND-PGM.
  5081
  5082     IF CLAS-I-BEN (CLAS-INDEXA) NOT = CLAS-LOOK
  5083         ADD +1 TO CLAS-INDEXA
  5084         GO TO 4125-AH-LOOKUP.
  5085
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 112
* ECS150.cbl
  5086     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
  5087
  5088*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
  5089*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
  5090
  5091 4130-FIND-CLAS-STATE-ABBR.
  5092     MOVE CLAS-STARTS TO CLAS-INDEXS.
  5093
  5094 4135-STATE-LOOK-UP.
  5095     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS
  5096         DISPLAY ' INVALID STATE CODE -' CR-STATE
  5097         MOVE '0301'             TO ABEND-CODE
  5098         GO TO ABEND-PGM.
  5099
  5100     IF STATE-SUB (CLAS-INDEXS) NOT = CR-STATE
  5101         ADD +1 TO CLAS-INDEXS
  5102         GO TO 4135-STATE-LOOK-UP.
  5103
  5104     IF (CR-LFTYP NOT = ZERO AND
  5105         CLAS-I-BAL (CLAS-INDEXL) = 'B')
  5106         OR
  5107        (CR-AHTYP NOT = ZERO AND
  5108         CLAS-I-BAL (CLAS-INDEXA) = 'B')
  5109          MOVE 1                 TO OB-SW
  5110     ELSE
  5111          MOVE 0                 TO OB-SW.
  5112
  5113     IF (CR-LFTYP NOT = ZERO AND
  5114         CLAS-I-BAL (CLAS-INDEXL) = 'Z')
  5115         OR
  5116        (CR-AHTYP NOT = ZERO AND
  5117         CLAS-I-BAL (CLAS-INDEXA) = 'Z')
  5118          MOVE 1                 TO SUMMARY-SW
  5119     ELSE
  5120          MOVE 0                 TO SUMMARY-SW.
  5121
  5122     IF CERT-ENTRY-DATE GREATER THAN PERIOD-START
  5123         MOVE 2                  TO EFFECTIVE-CONTROL
  5124     ELSE
  5125         MOVE 3                  TO EFFECTIVE-CONTROL.
  5126
  5127     MOVE ZEROS                  TO PRINT-SWITCHES.
  5128     MOVE ZEROS                  TO PRT-ISSUE-AMT-LF
  5129                                    PRT-CANC-AMT-LF
  5130                                    PRT-DEATH-AMT-LF
  5131                                    PRT-EXPIRY-AMT-LF
  5132                                    PRT-DECR-AMT-LF
  5133                                    PRT-INCR-AMT-LF
  5134                                    PRT-ISSUE-AMT-LF
  5135                                    PRT-CANC-AMT-LF
  5136                                    PRT-CLAIM-AMT-AH.
  5137     MOVE 1                      TO COUNT-WORK.
  5138
  5139     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5140     MOVE 'L'                        TO DC-OPTION-CODE.
  5141     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5142     MOVE DC-BIN-DATE-1              TO CERT-EFFECT-DT.
  5143
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 113
* ECS150.cbl
  5144     IF REINSURANCE-PASS OR REINSURANCE-REC
  5145         MOVE CR-LOAN-1ST-PMT-DT TO DC-GREG-DATE-1-YMD
  5146         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5147                                        DC-ELAPSED-DAYS
  5148         MOVE '3' TO DC-OPTION-CODE
  5149         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5150                 8599-DATE-CONVERT-X
  5151         MOVE DC-BIN-DATE-1 TO FIRST-PAY-DT
  5152         GO TO 4137-SKIP-CALC.
  5153
  5154     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5155         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5156
  5157     MOVE LOW-VALUES             TO     FIRST-PAY-DT.
  5158
  5159     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5160         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5161         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5162                                        DC-ELAPSED-DAYS
  5163         MOVE '3'                    TO DC-OPTION-CODE
  5164         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5165                 8599-DATE-CONVERT-X
  5166         IF NO-CONVERSION-ERROR
  5167             MOVE DC-BIN-DATE-1      TO FIRST-PAY-DT
  5168         ELSE
  5169             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5170
  5171     IF FIRST-PAY-DT       LESS THAN  CERT-EFFECT-DT
  5172         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5173
  5174     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5175         MOVE CERT-EFFECT-DT         TO DC-BIN-DATE-1
  5176         MOVE +1                     TO DC-ELAPSED-MONTHS
  5177         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5178         MOVE '6'                    TO DC-OPTION-CODE
  5179         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5180                 8599-DATE-CONVERT-X
  5181         MOVE DC-BIN-DATE-2          TO FIRST-PAY-DT
  5182         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5183
  5184 4137-SKIP-CALC.
  5185
  5186     IF SUMMARY-REC
  5187         COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD.
  5188     IF OB-COVERAGE
  5189         MOVE ZERO               TO COUNT-WORK.
  5190
  5191     IF CR-ENTRY-STATUS = '3' OR '5'
  5192         MOVE ZERO               TO COUNT-WORK.
  5193
  5194     MOVE ZEROES                 TO DOLLAR-AMT
  5195                                    DECREASING-DOLLAR
  5196                                    TEXAS-REG-SW
  5197                                    NET-PAY-SW
  5198                                    NEW-IN-EFFECT
  5199                                    OLD-IN-EFFECT
  5200                                    SAVE-BGN-INFORCE
  5201                                    SAVE-END-INFORCE
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 114
* ECS150.cbl
  5202                                    INFORCE-CNT-SW
  5203                                    CANCEL-SW
  5204                                    CLAIM-SW
  5205                                    PRINT-CNTRL.
  5206
  5207     IF DTE-CLIENT EQUAL 'HAN'
  5208        MOVE '2' TO CR-IND-GRP.
  5209
  5210     IF CR-IND-GRP = '2'
  5211         MOVE 2                  TO INS-TYPE-SW
  5212     ELSE
  5213         MOVE 1                  TO INS-TYPE-SW.
  5214
  5215     IF REINSURANCE-PASS
  5216         MOVE +5                 TO CL
  5217     ELSE
  5218         IF FIRST-INS-REC
  5219             MOVE +2             TO CL
  5220         ELSE
  5221             MOVE +4             TO CL.
  5222
  5223     IF CR-LFTYP = ZERO
  5224         GO TO 4900-PROCESS-DISABILITY.
  5225
  5226     IF CR-LF-CURRENT-STATUS = '4'
  5227         IF CR-LF-CANCEL-EXIT-DATE IS GREATER THAN ZEROS
  5228             MOVE '8'            TO  CR-LF-CURRENT-STATUS.
  5229
  5230     IF CR-LF-CURRENT-STATUS = '6' OR '7' OR '8'
  5231         NEXT SENTENCE
  5232     ELSE
  5233         IF (CR-DTHAMT-YTD IS GREATER THAN +0) OR
  5234            (CR-DTHAMT-YTD IS LESS THAN +0)
  5235             MOVE '7'            TO  CR-LF-CURRENT-STATUS.
  5236
  5237     IF CR-LF-CURRENT-STATUS NOT = 6 AND 7 AND 8
  5238         MOVE 0                  TO CERT-STATUS.
  5239     IF CR-LF-CURRENT-STATUS = 7
  5240         MOVE 2                  TO CERT-STATUS.
  5241     IF CR-LF-CURRENT-STATUS = 8
  5242         MOVE 1                  TO CERT-STATUS.
  5243     IF CR-LF-CURRENT-STATUS = 6
  5244         MOVE 3                  TO CERT-STATUS.
  5245
  5246     MOVE CERT-EFFECT-DT             TO CP-CERT-EFF-DT.
  5247     MOVE FIRST-PAY-DT               TO CP-FIRST-PAY-DATE.
  5248     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5249     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5250     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  5251     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5252     MOVE '3'                        TO CP-PROCESS-TYPE.
  5253     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5254     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5255
  5256     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5257     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  5258     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  5259                                        CP-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 115
* ECS150.cbl
  5260
  5261     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5262        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5263         ADD +1                      TO CP-ORIGINAL-TERM
  5264                                        CP-LOAN-TERM.
  5265
  5266     IF CP-TERM-IS-DAYS
  5267         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5268     ELSE
  5269         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5270
  5271     MOVE RUN-DATE-BIN       TO CP-VALUATION-DT.
  5272
  5273     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5274
  5275     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5276        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5277         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5278         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5279
  5280     MOVE CP-REMAINING-TERM-2  TO  SAVE-REM-TERM.
  5281
  5282     MOVE EP-DT-BIN          TO CP-VALUATION-DT.
  5283
  5284     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5285
  5286     MOVE ZEROS TO LF-BAL-REMTRM.
  5287     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5288        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5289         MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTRM
  5290         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5291         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5292
  5293     IF CP-REMAINING-TERM-2 GREATER THAN CR-LF-TERM
  5294         MOVE CR-LF-TERM TO CP-REMAINING-TERM-2
  5295                            CP-REMAINING-TERM-1.
  5296
  5297     MOVE CP-REMAINING-TERM-2 TO LF-REM-TRM.
  5298
  5299     MOVE CR-LF-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  5300     MOVE 'L' TO DC-OPTION-CODE
  5301     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5302             8599-DATE-CONVERT-X
  5303     MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE-O
  5304
  5305     IF REINSURANCE-PASS OR REINSURANCE-REC
  5306         MOVE CR-LF-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  5307         MOVE 'L' TO DC-OPTION-CODE
  5308         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5309                 8599-DATE-CONVERT-X
  5310         MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE
  5311         GO TO 4150-SKIP-CALC.
  5312
  5313     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  5314
  5315     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5316        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5317         MOVE CR-LF-TERM          TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 116
* ECS150.cbl
  5318     ELSE
  5319         COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM - +1.
  5320
  5321     MOVE '6'                     TO DC-OPTION-CODE.
  5322     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5323             8599-DATE-CONVERT-X.
  5324     IF NO-CONVERSION-ERROR
  5325         MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5326     ELSE
  5327         MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5328
  5329     IF (CERT-EXPIRE-DATE = LOW-VALUES)
  5330        OR (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  5331        MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  5332        MOVE CR-LF-TERM              TO DC-ELAPSED-MONTHS
  5333        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  5334        MOVE '6'                     TO DC-OPTION-CODE
  5335        PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5336                8599-DATE-CONVERT-X
  5337        IF NO-CONVERSION-ERROR
  5338           MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5339        ELSE
  5340           MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5341
  5342*    IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5343*       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5344*       MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  5345*       COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM + 1
  5346*       MOVE ZEROS                   TO DC-ELAPSED-DAYS
  5347*       MOVE '6'                     TO DC-OPTION-CODE
  5348*       PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5349*               8599-DATE-CONVERT-X
  5350*       IF NO-CONVERSION-ERROR
  5351*          MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5352*       ELSE
  5353*          MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5354
  5355     IF CP-REMAINING-TERM-2  GREATER THAN ZEROS
  5356         IF CERT-EXPIRE-DATE LESS THAN PERIOD-END
  5357            MOVE CERT-EXPIRE-DATE-O
  5358                              TO CERT-EXPIRE-DATE.
  5359*            MOVE PERIOD-END  TO  CERT-EXPIRE-DATE.
  5360
  5361     MOVE CERT-EXPIRE-DATE-O     TO CERT-EXPIRE-DATE
  5362     MOVE CERT-EXPIRE-DATE TO DC-BIN-DATE-1.
  5363     MOVE ' '                TO  DC-OPTION-CODE.
  5364     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5365     MOVE DC-GREG-DATE-CYMD  TO WS-CR-LF-EXPIRE-DATE-N
  5366                                CR-LF-EXPIRE-DATE.
  5367
  5368 4150-SKIP-CALC.
  5369
  5370     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  5371     MOVE CR-LF-DEX-CC           TO DC-ALPHA-CEN-N.
  5372     MOVE CR-LF-DEX-YR           TO DC-YMD-YEAR.
  5373     MOVE CR-LF-DEX-MO           TO DC-YMD-MONTH.
  5374     MOVE CR-LF-DEX-DA           TO DC-YMD-DAY.
  5375     MOVE '3'                TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 117
* ECS150.cbl
  5376     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5377     MOVE DC-BIN-DATE-1  TO  CLAIM-EXIT-DATE.
  5378
  5379     MOVE CR-LF-CANCEL-EXIT-DATE  TO DC-GREG-DATE-CYMD.
  5380     MOVE 'L'                TO  DC-OPTION-CODE.
  5381     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5382     MOVE DC-BIN-DATE-1  TO  CANCEL-EXIT-DATE.
  5383
  5384     MOVE CR-LF-CANC-DT      TO DC-GREG-DATE-CYMD.
  5385     MOVE 'L'                TO  DC-OPTION-CODE.
  5386     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5387     MOVE DC-BIN-DATE-1  TO  SUM-CANCEL-DATE.
  5388
  5389     IF CLAIM-EXIT-DATE = SPACES OR ZEROS
  5390         MOVE LOW-VALUES TO CLAIM-EXIT-DATE.
  5391
  5392     IF CANCEL-EXIT-DATE = SPACES OR ZEROS
  5393         MOVE LOW-VALUES TO CANCEL-EXIT-DATE.
  5394
  5395     IF CLAIM-EXIT-DATE = LOW-VALUES AND
  5396        CANCEL-EXIT-DATE = LOW-VALUES
  5397         GO TO 4300-SET-SUBSCRIPTS.
  5398
  5399     IF CLAIM-EXIT-DATE = LOW-VALUES
  5400         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE
  5401         GO TO 4300-SET-SUBSCRIPTS.
  5402
  5403     IF CANCEL-EXIT-DATE = LOW-VALUES
  5404         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  5405         GO TO 4300-SET-SUBSCRIPTS.
  5406
  5407     IF CLAIM-EXIT-DATE LESS THAN CANCEL-EXIT-DATE
  5408         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  5409     ELSE
  5410         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE.
  5411
  5412 4300-SET-SUBSCRIPTS.
  5413     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  5414         MOVE 1                  TO LIFE-INS-SW
  5415     ELSE
  5416         MOVE 2                  TO LIFE-INS-SW.
  5417
  5418     IF CR-LF-TERM LESS THAN +121
  5419         MOVE +2                 TO TG
  5420     ELSE
  5421         MOVE +3                 TO TG.
  5422
  5423     IF CR-LF-TERM LESS THAN +61
  5424         MOVE +1                 TO TG.
  5425     MOVE TG                     TO SAV-LF-TERM-CODE.
  5426
  5427 4410-INFORCE-PRIOR-PERIOD.
  5428     IF NOT EFFECTIVE-BOTH-PER
  5429         GO TO 4420-INFORCE-THIS-PERIOD.
  5430
  5431     IF CLAIM-EXIT-DATE NOT = LOW-VALUES  AND
  5432        CANCEL-EXIT-DATE NOT = LOW-VALUES
  5433         IF CLAIM-EXIT-DATE NOT GREATER THAN PERIOD-START AND
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 118
* ECS150.cbl
  5434            CANCEL-EXIT-DATE GREATER THAN PERIOD-START
  5435             MOVE 1              TO CANCEL-SW
  5436             MOVE 0              TO COUNT-WORK
  5437             GO TO 4700-COMPUTE-CANCEL
  5438         ELSE
  5439             IF CANCEL-EXIT-DATE NOT GREATER THAN PERIOD-START
  5440             AND
  5441             CLAIM-EXIT-DATE GREATER THAN PERIOD-START
  5442              MOVE 1             TO CLAIM-SW
  5443              MOVE 0             TO COUNT-WORK
  5444              GO TO 4750-COMPUTE-CLAIM.
  5445
  5446     IF CERT-CLAIM  AND
  5447        LOW-EXIT-DATE = LOW-VALUES
  5448         GO TO 4415-CONTINUE.
  5449
  5450     IF CLAIM-OR-CANCEL AND
  5451        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  5452            CR-DTHAMT-YTD NOT = ZERO
  5453                GO TO 4750-COMPUTE-CLAIM.
  5454
  5455     IF CLAIM-OR-CANCEL AND
  5456        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START
  5457         GO TO 4900-PROCESS-DISABILITY.
  5458
  5459 4415-CONTINUE.
  5460
  5461     IF (CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START) AND
  5462        NOT CLAIM-OR-CANCEL
  5463            GO TO 4900-PROCESS-DISABILITY.
  5464
  5465     MOVE 1                      TO OLD-IN-EFFECT.
  5466
  5467     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START
  5468         MOVE 0                  TO COUNT-WORK
  5469         GO TO 4420-INFORCE-THIS-PERIOD.
  5470
  5471     IF (CR-LFTYP = ZERO) OR
  5472        (CR-ENTRY-STATUS = '5') OR
  5473        (OB-COVERAGE)
  5474           MOVE ZERO             TO INFORCE-DOLLARS
  5475           GO TO 4420-INFORCE-THIS-PERIOD.
  5476
  5477     IF NOT SUMMARY-REC
  5478        NEXT SENTENCE
  5479      ELSE
  5480         IF (SUM-CANCEL-DATE GREATER PERIOD-START) OR
  5481            (CR-LFRFND = ZERO)
  5482             MOVE CR-LIVES       TO COUNT-WORK
  5483             MOVE CR-LFAMT       TO INFORCE-DOLLARS
  5484           ELSE
  5485             IF CR-LFPRM NOT GREATER CR-LFRFND
  5486                MOVE ZERO        TO INFORCE-DOLLARS
  5487                                    CR-LFPRM
  5488                                    CR-LFRFND
  5489              ELSE
  5490                COMPUTE TEMP-RESULT-L ROUNDED =
  5491                                     CR-LFRFND / CR-LFPRM
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 119
* ECS150.cbl
  5492                COMPUTE INFORCE-DOLLARS ROUNDED = CR-LFAMT -
  5493                                    (CR-LFAMT * TEMP-RESULT-L).
  5494
  5495     PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT.
  5496
  5497
  5498     IF DTE-CLIENT = 'HER'
  5499         MOVE CR-LFAMT TO INFORCE-DOLLARS
  5500         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5501             ADD CR-LFAMT-ALT TO INFORCE-DOLLARS.
  5502
  5503     MOVE +1                     TO EG.
  5504     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  5505
  5506     MOVE INFORCE-DOLLARS        TO SAVE-BGN-INFORCE.
  5507
  5508 4420-INFORCE-THIS-PERIOD.
  5509
  5510     IF CERT-CLAIM  AND
  5511        LOW-EXIT-DATE = LOW-VALUES
  5512         NEXT SENTENCE
  5513     ELSE
  5514        IF CLAIM-OR-CANCEL AND
  5515           LOW-EXIT-DATE <= PERIOD-END
  5516            GO TO 4500-COMPUTE-UNEARNED.
  5517
  5518     IF (CERT-EXPIRE-DATE < PERIOD-END)
  5519        OR (LF-REM-TRM = ZEROS)
  5520         GO TO 4500-COMPUTE-UNEARNED.
  5521
  5522     MOVE 1                      TO NEW-IN-EFFECT.
  5523
  5524     IF NOT REINSURANCE-PASS
  5525         ADD +1 TO EXB-CNT.
  5526
  5527     IF (CR-LFTYP = ZERO) OR
  5528        (CR-ENTRY-STATUS = '5') OR
  5529        (OB-COVERAGE)
  5530           MOVE ZERO             TO INFORCE-DOLLARS
  5531           GO TO 4500-COMPUTE-UNEARNED.
  5532
  5533     IF SUMMARY-REC
  5534         COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD
  5535         IF CR-LFPRM NOT GREATER CR-LFRFND
  5536            MOVE ZERO            TO INFORCE-DOLLARS
  5537                                    CR-LFPRM
  5538                                    CR-LFRFND
  5539          ELSE
  5540           IF CR-LFRFND = ZERO
  5541             MOVE CR-LFAMT       TO INFORCE-DOLLARS
  5542           ELSE
  5543                COMPUTE TEMP-RESULT-L ROUNDED =
  5544                                     CR-LFRFND / CR-LFPRM
  5545                COMPUTE INFORCE-DOLLARS ROUNDED = CR-LFAMT -
  5546                                    (CR-LFAMT * TEMP-RESULT-L).
  5547
  5548     PERFORM 8350-ENDING-INFORCE THRU 8300-EXIT.
  5549
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 120
* ECS150.cbl
  5550     IF DTE-CLIENT = 'HER'
  5551         MOVE CR-LFAMT TO INFORCE-DOLLARS
  5552         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5553             ADD CR-LFAMT-ALT TO INFORCE-DOLLARS.
  5554
  5555     IF GROUP-INS
  5556         ADD COUNT-WORK TO GROUP-CNT (CL  TG  9)
  5557         ADD INFORCE-DOLLARS TO GROUP-AMT (CL  TG  9)
  5558     ELSE
  5559         ADD COUNT-WORK TO IND-CNT (CL  TG  9)
  5560         ADD INFORCE-DOLLARS TO IND-AMT (CL  TG  9).
  5561
  5562     MOVE 1                      TO INFORCE-CNT-SW.
  5563     MOVE INFORCE-DOLLARS        TO DECREASING-DOLLAR
  5564                                    SAVE-END-INFORCE.
  5565
  5566 4500-COMPUTE-UNEARNED.
  5567     IF CR-ENTRY-STATUS = ('3' OR '5')
  5568         GO TO 4600-COMPUTE-ISSUES.
  5569
  5570     IF OB-COVERAGE
  5571         GO TO 4600-COMPUTE-ISSUES.
  5572
  5573     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5574     MOVE 'L'                        TO DC-OPTION-CODE.
  5575     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5576     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  5577
  5578     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5579         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5580
  5581     MOVE LOW-VALUES  TO  CP-FIRST-PAY-DATE.
  5582
  5583     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5584         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5585         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5586                                        DC-ELAPSED-DAYS
  5587         MOVE '3'                    TO DC-OPTION-CODE
  5588         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5589                 8599-DATE-CONVERT-X
  5590         IF NO-CONVERSION-ERROR
  5591             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  5592         ELSE
  5593             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5594
  5595     IF CP-FIRST-PAY-DATE LESS THAN  CP-CERT-EFF-DT
  5596         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5597
  5598     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5599         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5600         MOVE +1                     TO DC-ELAPSED-MONTHS
  5601         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5602         MOVE '6'                    TO DC-OPTION-CODE
  5603         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5604                 8599-DATE-CONVERT-X
  5605         MOVE DC-BIN-DATE-2          TO CP-FIRST-PAY-DATE
  5606         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5607
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 121
* ECS150.cbl
  5608     IF ENTERED-PREV-PERIOD
  5609         MOVE RUN-DATE-BIN       TO CP-VALUATION-DT
  5610         MOVE +1                 TO FACTOR-C
  5611         PERFORM 4550-UNEARNED-CALC THRU 4550-EXIT
  5612         MOVE UNEXPIRED-MONTHS   TO HOLD-PREV-UNEXP
  5613         MOVE EXPIRED-MONTHS     TO HOLD-PREV-EXP.
  5614
  5615     IF ENTERED-PREV-PERIOD
  5616         IF CERT-CANCELLED
  5617             IF CANCEL-EXIT-DATE <= PERIOD-END
  5618                 GO TO 4700-COMPUTE-CANCEL.
  5619
  5620     IF ENTERED-THIS-PERIOD
  5621         IF CERT-CANCELLED
  5622             IF CANCEL-EXIT-DATE <= PERIOD-END
  5623                 GO TO 4600-COMPUTE-ISSUES.
  5624
  5625     IF ENTERED-THIS-PERIOD
  5626         MOVE EP-DT-BIN          TO CP-VALUATION-DT
  5627         MOVE -1                 TO FACTOR-C
  5628         PERFORM 4550-UNEARNED-CALC THRU 4550-EXIT
  5629         MOVE UNEXPIRED-MONTHS   TO HOLD-END-UNEXP
  5630         MOVE EXPIRED-MONTHS     TO HOLD-END-EXP.
  5631
  5632     GO TO 4600-COMPUTE-ISSUES.
  5633
  5634 4550-UNEARNED-CALC.
  5635
  5636     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5637     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5638     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  5639     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5640     MOVE '3'                        TO CP-PROCESS-TYPE.
  5641     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5642     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5643     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5644     MOVE CLAS-I-BAL   (CLAS-INDEXL) TO CP-SPECIAL-CALC-CD.
  5645
  5646     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5647        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5648         ADD +1                      TO CP-ORIGINAL-TERM
  5649                                        CP-LOAN-TERM.
  5650
  5651     IF CP-TERM-IS-DAYS
  5652         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5653     ELSE
  5654         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5655
  5656     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5657
  5658     IF NO-CP-ERROR
  5659         NEXT SENTENCE
  5660     ELSE
  5661         MOVE +0                     TO CP-REMAINING-TERM-1
  5662                                        CP-REMAINING-TERM-2.
  5663
  5664     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5665        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 122
* ECS150.cbl
  5666         COMPUTE CP-REMAINING-TERM-1 = (CP-REMAINING-TERM-1 - +1).
  5667
  5668     IF CP-REMAINING-TERM-1 IS NEGATIVE
  5669         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
  5670     IF CP-REMAINING-TERM-2 IS NEGATIVE
  5671         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
  5672
  5673     IF CP-REMAINING-TERM-1 = ZEROS
  5674         IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5675            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  5676            (CP-REMAINING-TERM-2 IS GREATER THAN ZEROS)
  5677             NEXT SENTENCE
  5678         ELSE
  5679             GO TO 4550-EXIT.
  5680
  5681     MOVE CP-REMAINING-TERM-1        TO UNEXPIRED-MONTHS.
  5682     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  5683
  5684     IF CR-LFPRM NOT NUMERIC
  5685        MOVE +0 TO CR-LFPRM.
  5686
  5687     IF SUMMARY-REC
  5688         IF CR-LFRFND = +0
  5689             MOVE CR-LFPRM       TO CP-ORIGINAL-PREMIUM
  5690         ELSE
  5691             COMPUTE CP-ORIGINAL-PREMIUM ROUNDED =
  5692                     CR-LFPRM - CR-LFRFND
  5693     ELSE
  5694         MOVE CR-LFPRM           TO CP-ORIGINAL-PREMIUM.
  5695
  5696     IF CR-LFPRM-ALT NOT NUMERIC
  5697        MOVE +0 TO CR-LFPRM-ALT.
  5698     MOVE CR-LFPRM-ALT           TO CP-ALTERNATE-PREMIUM
  5699     IF CR-LF-TERM NOT NUMERIC
  5700        MOVE +0 TO CR-LF-TERM.
  5701     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  5702     MOVE UNEXPIRED-MONTHS       TO CP-REMAINING-TERM
  5703     MOVE CLAS-I-EP (CLAS-INDEXL)
  5704                                 TO CP-EARNING-METHOD
  5705     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  5706                                 TO CP-BENEFIT-TYPE
  5707     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  5708                                 TO CP-SPECIAL-CALC-CD
  5709     MOVE CR-LFTYP               TO CP-BENEFIT-CD
  5710     MOVE LIFE-OVERRIDE-L1       TO CP-LIFE-OVERRIDE-CODE
  5711     PERFORM 4945-CALC-UNEARNED-PREMIUM THRU 4945-AH-EXIT.
  5712
  5713     IF CP-ERROR-OCCURED
  5714        GO TO 4575-ERROR-LF.
  5715
  5716     MOVE CP-STATE-U-PRM         TO UNEARNED-AMT-LF
  5717
  5718     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  5719         MOVE '1'                TO  TEXAS-REG-SW.
  5720
  5721     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  5722         MOVE '1'                TO  NET-PAY-SW.
  5723
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 123
* ECS150.cbl
  5724 4552-LIFE-EARNINGS-CONT.
  5725
  5726     COMPUTE UNEARNED-AMT-LF = UNEARNED-AMT-LF * FACTOR-C.
  5727
  5728     IF LEVEL-LIFE
  5729         MOVE +2                 TO IY
  5730     ELSE
  5731         MOVE +1                 TO IY.
  5732
  5733     IF INDIVIDUAL-INS
  5734         ADD +5 TO IY.
  5735
  5736     ADD UNEARNED-AMT-LF TO EARN-PREM (CL  TG  IY).
  5737
  5738 4550-EXIT.
  5739     EXIT.
  5740
  5741 4575-ERROR-LF.
  5742
  5743     DISPLAY 'ERROR OCCURED IN LF UNEARNED ROUTINE'
  5744     DISPLAY 'CP RETURN CODE ...' CP-RETURN-CODE.
  5745     DISPLAY 'FULL CONTROL   ...' CR-FULL-CONTROL
  5746     GO TO ABEND-PGM.
  5747
  5748 4585-GET-REMAINING-TERM.
  5749
  5750     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
  5751
  5752     IF DTE-CLIENT = 'NCL'
  5753         MOVE CP-REMAINING-TERM-1 TO CP-REMAINING-TERM-2.
  5754
  5755 4585-EXIT.
  5756     EXIT.
  5757
  5758 4600-COMPUTE-ISSUES.
  5759     IF EFFECTIVE-BOTH-PER
  5760         GO TO 4700-COMPUTE-CANCEL.
  5761
  5762     IF CR-ENTRY-STATUS = '3' OR '5'
  5763         GO TO 4700-COMPUTE-CANCEL.
  5764
  5765     MOVE '1'                    TO LF-ISSUE.
  5766     MOVE CR-LFAMT               TO PRT-ISSUE-AMT-LF.
  5767     MOVE CR-LFAMT               TO TEMP-RESULT.
  5768
  5769
  5770     IF LEVEL-LIFE
  5771         MOVE +2                 TO IY
  5772     ELSE
  5773         MOVE +1                 TO IY.
  5774
  5775     IF OB-COVERAGE
  5776         MOVE +3                 TO IY.
  5777
  5778 4610-TOT-LF-ISSUES.
  5779     MOVE TEMP-RESULT            TO INFORCE-DOLLARS.
  5780
  5781     MOVE +2                     TO EG.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 124
* ECS150.cbl
  5782     IF SUMMARY-REC
  5783         MOVE CR-LIVES           TO COUNT-WORK.
  5784     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  5785
  5786     MOVE 1                      TO INFORCE-CNT-SW.
  5787     ADD INFORCE-DOLLARS TO SAVE-BGN-INFORCE.
  5788
  5789     IF INDIVIDUAL-INS
  5790         ADD +5 TO IY.
  5791
  5792     IF CR-LFPRM-ALT NOT NUMERIC
  5793         MOVE ZEROS              TO  CR-LFPRM-ALT.
  5794
  5795     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5796         ADD CR-LFPRM            TO  EARN-PREM  (CL  TG  IY)
  5797                                     ISSUE-PREM (CL  TG  IY)
  5798         ADD CR-LFPRM-ALT        TO  EARN-PREM  (CL  TG  IY)
  5799                                     ISSUE-PREM (CL  TG  IY)
  5800     ELSE
  5801         ADD CR-LFPRM            TO  EARN-PREM  (CL  TG  IY)
  5802                                     ISSUE-PREM (CL  TG  IY).
  5803
  5804     ADD TEMP-RESULT TO ISSUE-AMT (CL  TG  IY).
  5805     ADD COUNT-WORK TO ISSUE-CNT (CL  TG  IY).
  5806
  5807 4700-COMPUTE-CANCEL.
  5808*    NOTE *******************************************************
  5809*         *  EFFECTIVE AS OF VMOD 6.30 THE FOLLOWING TWO        *
  5810*         *  LINES OF CODE ARE DELETED. IF PRESENT, YOUR CANCEL *
  5811*         *  COUNT AND CLAIM COUNT WILL BE TOO LOW BECAUSE ONLY *
  5812*         *  POLICIES ISSUED IN CURRENT YEAR WILL BE COUNTED.   *
  5813*         *  THE AMOUNTS ARE CORRECT AND WILL BE UNAFFECTED.    *
  5814*         *******************************************************.
  5815*    IF INFORCE-CNT-SW NOT = 1
  5816*        MOVE 0 TO COUNT-WORK.
  5817******************************************************************
  5818     IF SUMMARY-REC AND
  5819        (SUM-CANCEL-DATE NOT GREATER PERIOD-END) AND
  5820        (SUM-CANCEL-DATE GREATER PERIOD-START) AND
  5821        (CR-SUM-CAN-CNT-YTD NOT = ZERO)
  5822         NEXT SENTENCE
  5823       ELSE
  5824        IF LUMP-SUM AND
  5825           (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  5826           (CLAIM-EXIT-DATE NOT LESS PERIOD-START)
  5827            NEXT SENTENCE
  5828         ELSE
  5829            IF (CANCEL-EXIT-DATE = ZERO OR LOW-VALUES) OR
  5830               CANCEL-EXIT-DATE GREATER THAN PERIOD-END
  5831                GO TO 4750-COMPUTE-CLAIM.
  5832
  5833     SUBTRACT CR-CCYY FROM CR-LF-CNC-CCYY GIVING INTERIM-YR.
  5834*    SUBTRACT CR-YR FROM CR-LF-CNC-YR GIVING INTERIM-YR.
  5835     IF INTERIM-YR < 0
  5836        ADD 100 TO INTERIM-YR
  5837     END-IF.
  5838     COMPUTE TERM-WORK = (INTERIM-YR * 12)
  5839                        + (CR-LF-CNC-MO - CR-MO).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 125
* ECS150.cbl
  5840     IF CR-LF-CNC-DA LESS THAN CR-DA
  5841         SUBTRACT 1 FROM TERM-WORK.
  5842
  5843     IF LUMP-SUM
  5844         MOVE '1'                TO LF-LUMP
  5845     ELSE
  5846         MOVE '1'                TO LF-CANC.
  5847
  5848     MULTIPLY CR-LFRFND BY -1 GIVING UNEARNED-AMT-LF.
  5849     MOVE '1'                    TO LF-CANC.
  5850     MOVE CR-LFRFND              TO PRT-CANC-AMT-LF.
  5851
  5852     IF LEVEL-LIFE
  5853         MOVE +2                 TO IY
  5854     ELSE
  5855         MOVE +1                 TO IY.
  5856
  5857     IF OB-COVERAGE
  5858         MOVE +3                 TO IY.
  5859
  5860     IF INDIVIDUAL-INS
  5861         ADD +5 TO IY.
  5862
  5863     ADD UNEARNED-AMT-LF TO EARN-PREM (CL  TG  IY).
  5864
  5865     IF SUMMARY-REC
  5866         GO TO 4703-SUM-CANC.
  5867
  5868     IF LEVEL-LIFE
  5869         MOVE CR-LFAMT           TO DOLLAR-AMT
  5870         GO TO 4705-LF-CANCEL-GO.
  5871
  5872     IF OB-COVERAGE
  5873         MOVE CR-LFAMT           TO DOLLAR-AMT
  5874         GO TO 4705-LF-CANCEL-GO.
  5875
  5876     IF TERM-WORK NOT POSITIVE
  5877         MOVE CR-LFAMT           TO DOLLAR-AMT
  5878         GO TO 4705-LF-CANCEL-GO.
  5879
  5880     IF TEXAS-CERT
  5881         GO TO 4701-TEX-CANC.
  5882
  5883     IF NET-PAY-CERT
  5884         GO TO 4702-NET-PAY-CANC.
  5885
  5886 4700-REG-CANCEL.
  5887     COMPUTE DOLLAR-AMT = CR-LFAMT - ((TERM-WORK / CR-LF-TERM)
  5888                             * CR-LFAMT).
  5889     GO TO 4705-LF-CANCEL-GO.
  5890
  5891 4701-TEX-CANC.
  5892     DIVIDE CR-LFAMT BY CR-LF-TERM
  5893         GIVING TEX-FACT-1.
  5894     DIVIDE TERM-WORK BY CR-PMT-FREQ
  5895         GIVING TEX-FACT-2
  5896             REMAINDER TEX-FACT-3.
  5897     COMPUTE DOLLAR-AMT =
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 126
* ECS150.cbl
  5898         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  5899
  5900     GO TO 4705-LF-CANCEL-GO.
  5901
  5902 4702-NET-PAY-CANC.
  5903
  5904     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  5905     MOVE 'L'                    TO  DC-OPTION-CODE.
  5906     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5907     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  5908
  5909     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5910         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  5911         MOVE '3'                TO  DC-OPTION-CODE
  5912         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5913             8599-DATE-CONVERT-X
  5914         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  5915     ELSE
  5916         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  5917         MOVE +1                 TO  DC-ELAPSED-MONTHS
  5918         MOVE +0                 TO  DC-ELAPSED-DAYS
  5919         MOVE '6'                TO  DC-OPTION-CODE
  5920         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5921             8599-DATE-CONVERT-X
  5922         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  5923
  5924     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  5925     MOVE CR-APR                 TO  CP-LOAN-APR.
  5926     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  5927     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  5928     COMPUTE CP-REMAINING-TERM = CR-LF-TERM - TERM-WORK.
  5929     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  5930     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  5931     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  5932     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  5933
  5934     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  5935
  5936     IF SUMMARY-REC
  5937         COMPUTE DOLLAR-AMT ROUNDED = CP-REMAMT-FACTOR *
  5938                                      (TEMP-1 / +1000)
  5939         GO TO 4705-LF-CANCEL-GO.
  5940
  5941     IF CP-STATE-STD-ABBRV = 'NC'
  5942               AND
  5943*      DTE-CLIENT NOT = 'WDS'
  5944       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  5945          IF CP-CERT-EFF-DT GREATER THAN WS-931231
  5946             MOVE CP-REMAINING-AMT
  5947                                  TO  DOLLAR-AMT
  5948             GO TO 4705-LF-CANCEL-GO.
  5949
  5950      COMPUTE DOLLAR-AMT ROUNDED = CP-REMAMT-FACTOR *
  5951                                      (CR-LFAMT / +1000).
  5952     move cp-remaining-amt       to dollar-amt
  5953*    IF SUMMARY-REC
  5954*          COMPUTE DOLLAR-AMT ROUNDED =
  5955*                          CP-REMAMT-FACTOR * (TEMP-1 / +1000)
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 127
* ECS150.cbl
  5956*      ELSE
  5957*          COMPUTE DOLLAR-AMT ROUNDED =
  5958*                          CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
  5959
  5960     GO TO 4705-LF-CANCEL-GO.
  5961
  5962 4703-SUM-CANC.
  5963     IF CR-LFPRM NOT GREATER CR-LFRFND
  5964        MOVE ZERO                TO DOLLAR-AMT
  5965        GO TO 4705-LF-CANCEL-GO.
  5966
  5967     IF CR-LFRFND = ZERO
  5968        MOVE CR-LFAMT            TO TEMP-1
  5969      ELSE
  5970                COMPUTE TEMP-RESULT-L ROUNDED =
  5971                                     CR-LFRFND / CR-LFPRM
  5972                COMPUTE TEMP-1 ROUNDED = CR-LFAMT -
  5973                                    (CR-LFAMT * TEMP-RESULT-L).
  5974
  5975     IF NET-PAY-CERT
  5976         GO TO 4702-NET-PAY-CANC.
  5977
  5978     IF LEVEL-LIFE
  5979         MOVE TEMP-1             TO DOLLAR-AMT
  5980      ELSE
  5981         COMPUTE DOLLAR-AMT = TEMP-1 - ((TERM-WORK / CR-LF-TERM)
  5982                                                        * TEMP-1).
  5983
  5984 4705-LF-CANCEL-GO.
  5985     MOVE DOLLAR-AMT             TO DECREASING-DOLLAR.
  5986
  5987     IF DOLLAR-AMT NEGATIVE
  5988         MOVE ZERO               TO DOLLAR-AMT.
  5989
  5990 4710-TOT-LF-CANCEL.
  5991     MOVE +6                     TO EG.
  5992     MOVE DOLLAR-AMT             TO INFORCE-DOLLARS.
  5993     MOVE COUNT-WORK             TO COUNT-SAVE.
  5994
  5995     IF (CLAIM-EXIT-DATE NOT = ZERO AND LOW-VALUES) AND
  5996        (CLAIM-EXIT-DATE <= PERIOD-END) AND
  5997        (CLAIM-EXIT-DATE GREATER PERIOD-START) AND
  5998        (NOT LUMP-SUM)
  5999         MOVE ZERO               TO COUNT-WORK
  6000         MOVE ZERO               TO DOLLAR-AMT INFORCE-DOLLARS.
  6001
  6002     IF SUMMARY-REC
  6003         MOVE CR-SUM-CAN-CNT-YTD TO COUNT-WORK.
  6004
  6005     IF NOT CURRENT-CANCEL-ONLY
  6006         PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT
  6007         SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6008
  6009     IF LEVEL-LIFE
  6010         MOVE +2                 TO IY
  6011     ELSE
  6012         MOVE +1                 TO IY.
  6013
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 128
* ECS150.cbl
  6014     IF OB-COVERAGE
  6015         MOVE +3                 TO IY.
  6016
  6017     IF INDIVIDUAL-INS
  6018         ADD +5 TO IY.
  6019
  6020     IF CR-LF-STATUS-AT-CANCEL NOT = SPACES
  6021         ADD COUNT-WORK TO CANCEL-CNT (CL  TG  IY).
  6022
  6023     ADD CR-LFRFND TO CANCEL-PREM (CL  TG  IY).
  6024     IF NOT CURRENT-CANCEL-ONLY
  6025        ADD DOLLAR-AMT TO CANCEL-AMT (CL  TG  IY).
  6026
  6027     MOVE COUNT-SAVE             TO COUNT-WORK.
  6028
  6029 4730-TOT-AH-CANCEL.
  6030     IF LUMP-SUM
  6031         GO TO 4900-PROCESS-DISABILITY.
  6032
  6033     IF (CANCEL-EXIT-DATE NOT = ZERO AND LOW-VALUES) AND
  6034        (CANCEL-EXIT-DATE <= PERIOD-END) AND
  6035        (CANCEL-EXIT-DATE GREATER PERIOD-START)
  6036          NEXT SENTENCE
  6037       ELSE
  6038         GO TO 4750-COMPUTE-CLAIM.
  6039
  6040     IF OB-COVERAGE
  6041         MOVE +5                 TO IY
  6042     ELSE
  6043         MOVE +4                 TO IY.
  6044
  6045     IF INDIVIDUAL-INS
  6046         ADD +5 TO IY.
  6047
  6048     IF SUMMARY-REC
  6049         MOVE CR-SUM-CAN-CNT-YTD TO COUNT-WORK.
  6050
  6051
  6052
  6053     IF CURRENT-CANCEL-ONLY
  6054         GO TO 4900-PROCESS-DISABILITY.
  6055     IF CLAIM-EXIT-DATE NOT = LOW-VALUES
  6056         GO TO 4750-COMPUTE-CLAIM.
  6057     IF CR-DTHAMT-YTD NOT = ZERO
  6058         GO TO 4750-COMPUTE-CLAIM.
  6059     IF CERT-ENTRY-DATE GREATER THAN PERIOD-START
  6060         GO TO 4820-COMPUTE-DECREASE.
  6061     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START
  6062         GO TO 4800-COMPUTE-INCREASE.
  6063
  6064     GO TO 4820-COMPUTE-DECREASE.
  6065
  6066 4750-COMPUTE-CLAIM.
  6067     IF CR-LFTYP = ZERO
  6068         GO TO 4820-COMPUTE-DECREASE.
  6069
  6070     IF LUMP-SUM
  6071         GO TO 4820-COMPUTE-DECREASE.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 129
* ECS150.cbl
  6072
  6073     IF CLAIM-EXIT-DATE GREATER THAN PERIOD-END
  6074         GO TO 4770-COMPUTE-EXPIRE.
  6075
  6076     IF (CLAIM-EXIT-DATE = ZERO OR LOW-VALUES OR SPACES) AND
  6077         CR-DTHAMT-YTD = ZERO
  6078             GO TO 4770-COMPUTE-EXPIRE.
  6079
  6080     MOVE CR-DTHAMT-YTD          TO DECREASING-DOLLAR.
  6081     MOVE CR-DTHAMT-YTD          TO PRT-DEATH-AMT-LF.
  6082     MOVE '1'                    TO LF-DEATH.
  6083
  6084     IF LEVEL-LIFE
  6085         MOVE +2                 TO IY
  6086     ELSE
  6087         MOVE +1                 TO IY.
  6088
  6089     IF OB-COVERAGE
  6090         MOVE +3                 TO IY.
  6091
  6092     IF INDIVIDUAL-INS
  6093         ADD +5 TO IY.
  6094
  6095     ADD COUNT-WORK TO CLAIM-CNT (CL  TG  IY).
  6096     ADD CR-DTHAMT-YTD TO CLAIM-AMT (CL TG IY).
  6097     MOVE CR-DTHAMT-YTD TO INFORCE-DOLLARS.
  6098
  6099     IF OB-COVERAGE
  6100         MOVE +5                 TO IY
  6101     ELSE
  6102         MOVE +4                 TO IY.
  6103
  6104     IF INDIVIDUAL-INS
  6105         ADD +5 TO IY.
  6106
  6107     MOVE +4                     TO EG.
  6108     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT
  6109
  6110     IF CURRENT-CLAIM-ONLY
  6111         GO TO 4900-PROCESS-DISABILITY.
  6112
  6113     IF OB-COVERAGE
  6114         GO TO 4770-COMPUTE-EXPIRE.
  6115
  6116     SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6117
  6118     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START AND
  6119        NOT LEVEL-LIFE
  6120         GO TO 4800-COMPUTE-INCREASE.
  6121
  6122     IF NOT LEVEL-LIFE
  6123         GO TO 4820-COMPUTE-DECREASE.
  6124
  6125     COMPUTE DOLLAR-AMT = CR-LFAMT - CR-DTHAMT-YTD.
  6126     MOVE '1'                    TO LF-DECR.
  6127     MOVE DOLLAR-AMT             TO PRT-DECR-AMT-LF.
  6128
  6129     IF GROUP-INS
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 130
* ECS150.cbl
  6130         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  7)
  6131         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  8)
  6132     ELSE
  6133         ADD DOLLAR-AMT TO IND-AMT (CL  TG  7)
  6134         ADD DOLLAR-AMT TO IND-AMT (CL  TG  8).
  6135     SUBTRACT DOLLAR-AMT FROM SAVE-BGN-INFORCE.
  6136
  6137     IF CERT-EXPIRE-DATE GREATER THAN PERIOD-START
  6138         GO TO 4900-PROCESS-DISABILITY
  6139     ELSE
  6140         MOVE CR-LFAMT           TO DECREASING-DOLLAR
  6141         GO TO 4800-COMPUTE-INCREASE.
  6142
  6143 4770-COMPUTE-EXPIRE.
  6144     IF CR-ENTRY-STATUS = '3' OR '5'
  6145         GO TO 4900-PROCESS-DISABILITY.
  6146
  6147     IF CERT-EXPIRE-DATE >= PERIOD-END
  6148         GO TO 4820-COMPUTE-DECREASE.
  6149
  6150     IF CR-LFTYP = ZERO
  6151         GO TO 4900-PROCESS-DISABILITY.
  6152
  6153     IF (CLAS-I-EP (CLAS-INDEXL) = 'B'  AND
  6154         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'  AND
  6155         LF-BAL-REMTRM NOT GREATER THAN ZERO)
  6156                       OR
  6157        (CLAS-I-EP (CLAS-INDEXL) = 'B'  AND
  6158         CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'  AND
  6159         LF-REM-TRM NOT GREATER THAN ZERO)
  6160                       OR
  6161        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'  AND
  6162         LF-REM-TRM NOT GREATER ZERO)
  6163           NEXT SENTENCE
  6164         ELSE
  6165         GO TO 4900-PROCESS-DISABILITY.
  6166
  6167     IF SUMMARY-REC
  6168        COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD
  6169        IF CR-LFPRM NOT GREATER CR-LFRFND
  6170           MOVE ZERO TO INFORCE-DOLLARS
  6171         ELSE
  6172          IF CR-LFRFND = ZERO
  6173             MOVE CR-LFAMT TO INFORCE-DOLLARS
  6174           ELSE
  6175                COMPUTE TEMP-RESULT-L ROUNDED =
  6176                                     CR-LFRFND / CR-LFPRM
  6177                COMPUTE DOLLAR-AMT ROUNDED = CR-LFAMT -
  6178                                    (CR-LFAMT * TEMP-RESULT-L).
  6179
  6180     IF EFFECTIVE-BOTH-PER
  6181         PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT
  6182         MOVE INFORCE-DOLLARS    TO DOLLAR-AMT
  6183     ELSE
  6184         MOVE CR-LFAMT           TO DOLLAR-AMT.
  6185
  6186     IF OB-COVERAGE AND CR-LFTYP NOT = ZERO
  6187         MOVE CR-LFAMT           TO DOLLAR-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 131
* ECS150.cbl
  6188
  6189     MOVE '1'                    TO LF-EXPIRY.
  6190     MOVE DOLLAR-AMT             TO PRT-EXPIRY-AMT-LF.
  6191     MOVE DOLLAR-AMT             TO INFORCE-DOLLARS.
  6192     MOVE +5                     TO EG.
  6193     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  6194
  6195     IF NOT OB-COVERAGE
  6196         SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6197
  6198     GO TO 4900-PROCESS-DISABILITY.
  6199
  6200 4800-COMPUTE-INCREASE.
  6201     IF CR-ENTRY-STATUS = '3' OR '5'
  6202         GO TO 4900-PROCESS-DISABILITY.
  6203
  6204     IF NOT EFFECTIVE-BOTH-PER
  6205         GO TO 4900-PROCESS-DISABILITY.
  6206
  6207     IF CR-LFTYP = ZERO
  6208         GO TO 4900-PROCESS-DISABILITY.
  6209
  6210     IF OB-COVERAGE OR SUMMARY-REC
  6211         GO TO 4900-PROCESS-DISABILITY.
  6212
  6213     COMPUTE MINUS-AMT = DECREASING-DOLLAR * -1.
  6214     MOVE '1'                    TO LF-INCR.
  6215     MOVE MINUS-AMT              TO PRT-INCR-AMT-LF.
  6216
  6217     IF GROUP-INS
  6218         ADD MINUS-AMT TO GROUP-AMT (CL  TG  7)
  6219         ADD MINUS-AMT TO GROUP-AMT (CL  TG  8)
  6220     ELSE
  6221         ADD MINUS-AMT TO IND-AMT (CL  TG  7)
  6222         ADD MINUS-AMT TO IND-AMT (CL  TG  8).
  6223     ADD DECREASING-DOLLAR TO SAVE-BGN-INFORCE.
  6224
  6225     GO TO 4900-PROCESS-DISABILITY.
  6226
  6227 4820-COMPUTE-DECREASE.
  6228     IF CR-ENTRY-STATUS = '3' OR '5'
  6229         GO TO 4900-PROCESS-DISABILITY.
  6230
  6231     IF CR-LFTYP = ZERO
  6232         GO TO 4900-PROCESS-DISABILITY.
  6233
  6234     IF LEVEL-LIFE
  6235         GO TO 4900-PROCESS-DISABILITY.
  6236
  6237     IF OB-COVERAGE OR SUMMARY-REC
  6238         GO TO 4900-PROCESS-DISABILITY.
  6239
  6240     IF NOT EFFECTIVE-BOTH-PER
  6241         SUBTRACT DECREASING-DOLLAR FROM CR-LFAMT
  6242             GIVING DOLLAR-AMT.
  6243
  6244     IF EFFECTIVE-BOTH-PER
  6245         PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 132
* ECS150.cbl
  6246         MOVE INFORCE-DOLLARS    TO DOLLAR-AMT
  6247         SUBTRACT DECREASING-DOLLAR FROM DOLLAR-AMT.
  6248
  6249     MOVE '1'                    TO LF-DECR.
  6250     MOVE DOLLAR-AMT             TO PRT-DECR-AMT-LF.
  6251
  6252     IF GROUP-INS
  6253         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  7)
  6254         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  8)
  6255     ELSE
  6256         ADD DOLLAR-AMT TO IND-AMT (CL  TG  7)
  6257         ADD DOLLAR-AMT TO IND-AMT (CL  TG  8).
  6258     SUBTRACT DOLLAR-AMT FROM SAVE-BGN-INFORCE.
  6259
  6260 4900-PROCESS-DISABILITY.
  6261
  6262     IF CR-AHTYP = ZERO
  6263         GO TO 4999-PRINT.
  6264
  6265     MOVE ZERO                   TO CANCEL-SW.
  6266     MOVE ZERO                   TO CLAIM-SW.
  6267
  6268     IF CR-AH-CURRENT-STATUS NOT = 6 AND 7 AND 8
  6269         MOVE 0                  TO CERT-STATUS.
  6270     IF CR-AH-CURRENT-STATUS = 7
  6271         MOVE 2                  TO CERT-STATUS.
  6272     IF CR-AH-CURRENT-STATUS = 8
  6273         MOVE 1                  TO CERT-STATUS.
  6274     IF CR-AH-CURRENT-STATUS = 6
  6275         MOVE 3                  TO CERT-STATUS.
  6276
  6277     MOVE CERT-EFFECT-DT             TO CP-CERT-EFF-DT.
  6278     MOVE FIRST-PAY-DT               TO CP-FIRST-PAY-DATE.
  6279     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
  6280     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6281     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6282     MOVE '3'                        TO CP-PROCESS-TYPE.
  6283     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6284     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  6285     MOVE ZEROS TO  CP-TERM-OR-EXT-DAYS.
  6286
  6287 AH-REM-TERM.
  6288
  6289     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  6290
  6291     MOVE CP-REMAINING-TERM-2 TO AH-REM-TRM.
  6292
  6293     IF REINSURANCE-PASS OR REINSURANCE-REC
  6294         MOVE CR-AH-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  6295         MOVE 'L' TO DC-OPTION-CODE
  6296         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6297                 8599-DATE-CONVERT-X
  6298         MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE
  6299         GO TO 4910-SKIP-CALC.
  6300
  6301     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  6302     COMPUTE DC-ELAPSED-MONTHS = CR-AH-TERM - +1.
  6303     MOVE '6'                     TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 133
* ECS150.cbl
  6304     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6305                 8599-DATE-CONVERT-X.
  6306     IF NO-CONVERSION-ERROR
  6307         MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  6308     ELSE
  6309         MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  6310
  6311     IF (CERT-EXPIRE-DATE = LOW-VALUES)     OR
  6312         (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  6313        MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  6314        MOVE CR-AH-TERM              TO DC-ELAPSED-MONTHS
  6315        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  6316        MOVE '6'                     TO DC-OPTION-CODE
  6317        PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6318                8599-DATE-CONVERT-X
  6319        IF NO-CONVERSION-ERROR
  6320           MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  6321        ELSE
  6322           MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  6323
  6324     IF CP-REMAINING-TERM-2 NOT GREATER THAN ZEROS
  6325         IF CERT-EXPIRE-DATE >= PERIOD-END
  6326             MOVE PERIOD-END  TO  CERT-EXPIRE-DATE.
  6327
  6328     MOVE CERT-EXPIRE-DATE TO DC-BIN-DATE-1.
  6329     MOVE ' '                TO  DC-OPTION-CODE.
  6330     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6331     MOVE DC-GREG-DATE-CYMD TO WS-CR-AH-EXPIRE-DATE
  6332                               CR-AH-EXPIRE-DATE.
  6333
  6334 4910-SKIP-CALC.
  6335
  6336     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  6337     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD.
  6338     MOVE 'L'                TO  DC-OPTION-CODE.
  6339     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6340     MOVE DC-BIN-DATE-1  TO  CLAIM-EXIT-DATE.
  6341
  6342     MOVE CR-AH-CANCEL-EXIT-DATE  TO DC-GREG-DATE-CYMD.
  6343     MOVE 'L'                TO  DC-OPTION-CODE.
  6344     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6345     MOVE DC-BIN-DATE-1  TO  CANCEL-EXIT-DATE.
  6346
  6347     MOVE CR-AH-CANC-DT      TO DC-GREG-DATE-CYMD.
  6348     MOVE 'L'                TO  DC-OPTION-CODE.
  6349     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6350     MOVE DC-BIN-DATE-1  TO  SUM-CANCEL-DATE.
  6351
  6352     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  6353
  6354     IF CLAIM-EXIT-DATE = SPACES OR ZEROS
  6355         MOVE LOW-VALUES TO CLAIM-EXIT-DATE.
  6356
  6357     IF CANCEL-EXIT-DATE = SPACES OR ZEROS
  6358         MOVE LOW-VALUES TO CANCEL-EXIT-DATE.
  6359
  6360     IF CLAIM-EXIT-DATE = LOW-VALUES AND
  6361        CANCEL-EXIT-DATE = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 134
* ECS150.cbl
  6362         GO TO 4920-SET-SUBSCRIPTS.
  6363
  6364     IF CLAIM-EXIT-DATE = LOW-VALUES
  6365         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE
  6366         GO TO 4920-SET-SUBSCRIPTS.
  6367
  6368     IF CANCEL-EXIT-DATE = LOW-VALUES
  6369         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  6370         GO TO 4920-SET-SUBSCRIPTS.
  6371
  6372     IF CLAIM-EXIT-DATE LESS THAN CANCEL-EXIT-DATE
  6373         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  6374     ELSE
  6375         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE.
  6376
  6377 4920-SET-SUBSCRIPTS.
  6378
  6379     IF CR-AH-TERM LESS THAN +121
  6380         MOVE +2                 TO TG
  6381     ELSE
  6382         MOVE +3                 TO TG.
  6383
  6384     IF CR-AH-TERM LESS THAN +61
  6385         MOVE +1                 TO TG.
  6386
  6387     IF OB-COVERAGE
  6388         MOVE +5                 TO IY
  6389     ELSE
  6390         MOVE +4                 TO IY.
  6391
  6392     IF INDIVIDUAL-INS
  6393         ADD +5 TO IY.
  6394
  6395     IF NOT EFFECTIVE-BOTH-PER
  6396         GO TO 4925-CHECK-THIS-PER-ITEM.
  6397
  6398     IF CLAIM-EXIT-DATE NOT = LOW-VALUES AND
  6399        CANCEL-EXIT-DATE NOT = LOW-VALUES
  6400         IF CLAIM-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  6401            CANCEL-EXIT-DATE GREATER THAN PERIOD-START
  6402             MOVE 1              TO CANCEL-SW
  6403             MOVE 0              TO COUNT-WORK
  6404             GO TO 4970-CHECK-CANCEL
  6405         ELSE
  6406             IF CANCEL-EXIT-DATE NOT GREATER THAN PERIOD-START
  6407             AND
  6408             CLAIM-EXIT-DATE GREATER THAN PERIOD-START
  6409              MOVE 1             TO CLAIM-SW
  6410              MOVE 0             TO COUNT-WORK
  6411              GO TO 4980-CHECK-CLAIM.
  6412
  6413     IF CLAIM-OR-CANCEL AND
  6414        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  6415            CR-DISAMT-YTD NOT = ZERO
  6416                GO TO 4980-CHECK-CLAIM.
  6417
  6418     IF CLAIM-OR-CANCEL AND
  6419        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 135
* ECS150.cbl
  6420         GO TO 4999-PRINT.
  6421
  6422     IF (CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START) AND
  6423        NOT CLAIM-OR-CANCEL
  6424            GO TO 4980-CHECK-CLAIM.
  6425
  6426     MOVE '1'                    TO OLD-IN-EFFECT.
  6427
  6428 4925-CHECK-THIS-PER-ITEM.
  6429
  6430     IF CLAIM-OR-CANCEL AND
  6431        LOW-EXIT-DATE <= PERIOD-END
  6432         GO TO 4930-COMPUTE-UNEARNED.
  6433
  6434     IF CERT-EXPIRE-DATE < PERIOD-END
  6435         GO TO 4930-COMPUTE-UNEARNED.
  6436
  6437     MOVE 1                      TO NEW-IN-EFFECT.
  6438
  6439 4930-COMPUTE-UNEARNED.
  6440     IF CR-ENTRY-STATUS = ('3' OR '5')
  6441         GO TO 4950-CHECK-AH-ISSUE.
  6442
  6443     IF SUMMARY-REC
  6444         IF CR-AHPRM IS NOT GREATER THAN CR-AHRFND
  6445             MOVE ZERO           TO  CR-AHPRM
  6446                                     CR-AHRFND.
  6447     IF OB-COVERAGE
  6448         GO TO 4950-CHECK-AH-ISSUE.
  6449
  6450     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6451     MOVE 'L'                        TO DC-OPTION-CODE.
  6452     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6453     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6454
  6455     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6456         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  6457
  6458     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  6459         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  6460         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  6461                                        DC-ELAPSED-DAYS
  6462         MOVE '3'                    TO DC-OPTION-CODE
  6463         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6464                 8599-DATE-CONVERT-X
  6465         IF NO-CONVERSION-ERROR
  6466             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  6467         ELSE
  6468             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  6469
  6470     IF CR-LOAN-1ST-PMT-DT = ZEROS
  6471         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  6472         MOVE +1                     TO DC-ELAPSED-MONTHS
  6473         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  6474         MOVE '6'                    TO DC-OPTION-CODE
  6475         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6476                 8599-DATE-CONVERT-X
  6477         MOVE DC-BIN-DATE-1          TO CP-FIRST-PAY-DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 136
* ECS150.cbl
  6478
  6479     IF ENTERED-PREV-PERIOD
  6480         MOVE RUN-DATE-BIN       TO CP-VALUATION-DT
  6481         MOVE +1                 TO FACTOR-C
  6482         PERFORM 4940-UNEARNED-CALC THRU 4940-EXIT.
  6483
  6484     IF ENTERED-PREV-PERIOD
  6485         IF CERT-CANCELLED
  6486             IF CANCEL-EXIT-DATE <= PERIOD-END
  6487                 GO TO 4970-CHECK-CANCEL.
  6488
  6489     IF ENTERED-THIS-PERIOD
  6490         IF CERT-CANCELLED
  6491             IF CANCEL-EXIT-DATE <= PERIOD-END
  6492                 GO TO 4950-CHECK-AH-ISSUE.
  6493
  6494     IF ENTERED-THIS-PERIOD
  6495         MOVE EP-DT-BIN          TO CP-VALUATION-DT
  6496         MOVE -1                 TO FACTOR-C
  6497         PERFORM 4940-UNEARNED-CALC THRU 4940-EXIT.
  6498
  6499     GO TO 4950-CHECK-AH-ISSUE.
  6500
  6501 4940-UNEARNED-CALC.
  6502
  6503     MOVE SPACES                     TO CP-ACCT-FLD-5.
  6504     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  6505     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
  6506     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  6507     MOVE '3'                        TO CP-PROCESS-TYPE.
  6508     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6509     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  6510
  6511 4940-GET-REMAINING-TERM.
  6512
  6513     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  6514
  6515     MOVE CP-REMAINING-TERM-1        TO UNEXPIRED-MONTHS.
  6516     COMPUTE EXPIRED-MONTHS = CR-AH-TERM - UNEXPIRED-MONTHS.
  6517
  6518 4940-TERM-OK.
  6519     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  6520         GO TO 4940-EXIT.
  6521
  6522     IF SUMMARY-REC
  6523         IF CR-AHRFND = +0
  6524             MOVE CR-AHPRM       TO CP-ORIGINAL-PREMIUM
  6525         ELSE
  6526             COMPUTE CP-ORIGINAL-PREMIUM ROUNDED =
  6527                 CR-AHPRM - CR-AHRFND
  6528     ELSE
  6529         MOVE CR-AHPRM           TO CP-ORIGINAL-PREMIUM.
  6530
  6531     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  6532     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  6533                                    CP-RATING-BENEFIT-AMT.
  6534     MOVE UNEXPIRED-MONTHS       TO CP-REMAINING-TERM
  6535
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 137
* ECS150.cbl
  6536     IF AH-EARN-METHOD = SPACES
  6537         MOVE CLAS-I-EP (CLAS-INDEXA) TO  CP-EARNING-METHOD
  6538     ELSE
  6539         MOVE AH-EARN-METHOD          TO  CP-EARNING-METHOD.
  6540
  6541     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  6542                                 TO CP-BENEFIT-TYPE
  6543     MOVE ZEROS                  TO CP-ALTERNATE-PREMIUM
  6544     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA)
  6545                                 TO CP-SPECIAL-CALC-CD
  6546     MOVE AM-AH-DEVIATION        TO CP-DEVIATION-CODE
  6547     MOVE CR-AHTYP               TO CP-BENEFIT-CD
  6548     MOVE AH-OVERRIDE-L1         TO CP-AH-OVERRIDE-CODE
  6549
  6550     IF CR-PMT-EXTENSION-DAYS NOT NUMERIC
  6551        MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  6552     ELSE
  6553        MOVE CR-PMT-EXTENSION-DAYS
  6554                                 TO CP-TERM-OR-EXT-DAYS.
  6555
  6556     PERFORM 4945-CALC-UNEARNED-PREMIUM THRU 4945-AH-EXIT.
  6557
  6558     IF CP-ERROR-OCCURED
  6559        GO TO 4945-ERROR-AH.
  6560
  6561     MOVE CP-STATE-U-PRM    TO UNEARNED-AMT-AH.
  6562
  6563     IF (STATE-ABBR (CLAS-INDEXS) = 'VA')      AND
  6564        (CR-AH-TERM GREATER THAN +61)  AND
  6565        (CR-DT GREATER THAN  19921231)
  6566          MOVE  'A'  TO  AH-EARN-METHOD.
  6567
  6568     IF (CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B' AND 'Z') AND
  6569        (AH-EARN-METHOD = 'A' OR 'C')
  6570         PERFORM 8450-RE-RATE-ROUTINE THRU 8499-EXIT
  6571         IF (CP-ERROR-RATE-NOT-FOUND OR
  6572             CP-ERROR-RATE-IS-ZERO OR
  6573             CP-ERROR-IN-DATES)
  6574             NEXT SENTENCE
  6575         ELSE
  6576             COMPUTE UNEARNED-AMT-AH ROUNDED =
  6577              ((UNEXPIRED-MONTHS * CR-AHAMT) / +100) *
  6578                CP-PREMIUM-RATE.
  6579
  6580     COMPUTE UNEARNED-AMT-AH ROUNDED =
  6581                           UNEARNED-AMT-AH * FACTOR-C.
  6582
  6583     IF GROUP-INS
  6584         ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  4)
  6585     ELSE
  6586         ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  9).
  6587 4940-EXIT.
  6588     EXIT.
  6589
  6590 4945-CALC-UNEARNED-PREMIUM.
  6591
  6592     MOVE CR-DT TO DC-GREG-DATE-CYMD.
  6593     MOVE 'L' TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 138
* ECS150.cbl
  6594     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6595                  8599-DATE-CONVERT-X.
  6596     MOVE DC-BIN-DATE-1 TO CP-CERT-EFF-DT
  6597     MOVE DTE-R78 TO CP-R78-OPTION
  6598     MOVE SPACES TO CP-ACCT-FLD-5
  6599     MOVE DTE-CLIENT TO CP-COMPANY-ID
  6600     IF CR-AGE NOT NUMERIC
  6601        MOVE +0 TO CR-AGE.
  6602     MOVE CR-AGE TO CP-ISSUE-AGE
  6603     IF CR-APR NOT NUMERIC
  6604        MOVE +0 TO CR-APR.
  6605     MOVE CR-APR TO CP-LOAN-APR
  6606
  6607     IF CR-PMT-FREQ IS NOT NUMERIC
  6608         MOVE ZEROS              TO  CP-PAY-FREQUENCY
  6609     ELSE
  6610         MOVE CR-PMT-FREQ        TO  CP-PAY-FREQUENCY.
  6611
  6612     IF CR-LOAN-TERM NOT NUMERIC
  6613        MOVE +0 TO CR-LOAN-TERM.
  6614     MOVE CR-LOAN-TERM TO CP-LOAN-TERM
  6615     MOVE SPACES         TO CP-DOMICILE-STATE
  6616     MOVE CR-CARRIER TO CP-CARRIER
  6617     IF CR-RATING-CLASS NOT = SPACES AND ZERO
  6618        MOVE CR-RATING-CLASS TO CP-CLASS-CODE
  6619     ELSE
  6620        MOVE AM-CAL-TABLE TO CP-CLASS-CODE.
  6621
  6622     MOVE STATE-SUB (CLAS-INDEXS) TO CP-STATE
  6623     MOVE STATE-ABBR (CLAS-INDEXS) TO CP-STATE-STD-ABBRV
  6624     MOVE DTE-CLASIC-COMPANY-CD TO CP-COMPANY-CD
  6625
  6626     CALL 'ELUPRMX'  USING CALCULATION-PASS-AREA.
  6627
  6628 4945-AH-EXIT.
  6629     EXIT.
  6630
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 139
* ECS150.cbl
  6632 4945-ERROR-AH.
  6633
  6634     DISPLAY 'ERROR OCCURED IN AH UNEARNED ROUTINE'
  6635     DISPLAY 'CP RETURN CODE ...' CP-RETURN-CODE.
  6636     GO TO ABEND-PGM.
  6637
  6638 4950-CHECK-AH-ISSUE.
  6639
  6640     IF EFFECTIVE-BOTH-PER
  6641         GO TO 4970-CHECK-CANCEL.
  6642
  6643     IF CR-ENTRY-STATUS = '3' OR '5'
  6644         GO TO 4970-CHECK-CANCEL.
  6645
  6646     IF SUMMARY-REC
  6647         MOVE CR-LIVES           TO COUNT-WORK.
  6648
  6649     MOVE '1'                    TO AH-ISSUE.
  6650     ADD COUNT-WORK TO ISSUE-CNT (CL  TG  IY).
  6651     ADD CR-AHPRM TO EARN-PREM (CL  TG  IY).
  6652     ADD CR-AHPRM TO ISSUE-PREM (CL  TG  IY).
  6653
  6654 4970-CHECK-CANCEL.
  6655     IF SUMMARY-REC AND
  6656        (SUM-CANCEL-DATE NOT GREATER PERIOD-END) AND
  6657        (SUM-CANCEL-DATE GREATER PERIOD-START) AND
  6658        (CR-SUM-CAN-CNT-YTD NOT = ZERO)
  6659         NEXT SENTENCE
  6660       ELSE
  6661        IF LUMP-SUM AND
  6662           (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  6663           (CLAIM-EXIT-DATE NOT LESS PERIOD-START)
  6664            NEXT SENTENCE
  6665         ELSE
  6666            IF (CANCEL-EXIT-DATE = ZERO OR LOW-VALUES) OR
  6667               CANCEL-EXIT-DATE > PERIOD-END
  6668                GO TO 4980-CHECK-CLAIM.
  6669
  6670     MOVE '1'                TO AH-CANC.
  6671
  6672     MULTIPLY CR-AHRFND BY -1 GIVING UNEARNED-AMT-AH.
  6673     MOVE '1'                    TO AH-CANC.
  6674     MOVE CR-AHRFND              TO PRT-CANC-AMT-AH.
  6675     ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  IY).
  6676
  6677     IF CR-AH-STATUS-AT-CANCEL NOT = SPACES
  6678         ADD COUNT-WORK TO     CANCEL-CNT (CL  TG  IY).
  6679
  6680     ADD CR-AHRFND TO     CANCEL-PREM (CL  TG  IY).
  6681
  6682 4980-CHECK-CLAIM.
  6683     IF CR-DISAMT-YTD = ZERO
  6684         GO TO 4999-PRINT.
  6685
  6686     MOVE '1'                    TO AH-CLAIM.
  6687     MOVE CR-DISAMT-YTD          TO PRT-CLAIM-AMT-AH.
  6688
  6689     MOVE CR-DIS-CC              TO WS-CR-DIS-CCYY(1:2).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 140
* ECS150.cbl
  6690     MOVE CR-DIS-YR              TO WS-CR-DIS-CCYY(3:2).
  6691     ADD COUNT-WORK    TO CLAIM-CNT (CL TG IY).
  6692     ADD CR-DISAMT-YTD TO CLAIM-AMT (CL TG IY).
  6693     COMPUTE TERM-WORK = (WS-CR-DIS-CCYY * 12) + CR-DIS-MO.
  6694
  6695     IF TERM-WORK LESS THAN PERIOD-START-9
  6696         ADD CR-DISAMT-YTD TO AH-PAID-LAST-YR (CL)
  6697     ELSE
  6698         ADD CR-DISAMT-YTD TO AH-PAID-THIS-YR (CL).
  6699
  6700     MULTIPLY CR-AHRFND BY -1 GIVING UNEARNED-AMT-AH.
  6701
  6702 4999-PRINT.
  6703
  6704     IF PRT-LF-ISSUE OR
  6705        PRT-AH-ISSUE
  6706         MOVE 'ISSUE'            TO DL-ACTIVITY
  6707         MOVE PRT-ISSUE-AMT-LF   TO DL-RSRV-AMT
  6708         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6709
  6710     IF PRT-LF-DECR
  6711         MOVE 'DECR '            TO DL-ACTIVITY
  6712         MOVE PRT-DECR-AMT-LF    TO DL-RSRV-AMT
  6713         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6714
  6715     IF PRT-LF-CANC AND
  6716        PRT-AH-CANC
  6717             MOVE '1'                TO LF-REFUND-SW
  6718             MOVE 'CANC '            TO DL-ACTIVITY
  6719             MOVE '1'                TO AH-REFUND-SW
  6720             ADD PRT-CANC-AMT-AH     TO PRT-CANC-AMT-LF
  6721             MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6722             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT
  6723             GO TO 4999-NEXT-PRINT.
  6724
  6725     IF PRT-LF-CANC
  6726             MOVE '1'                TO LF-REFUND-SW
  6727             MOVE 'CANC '            TO DL-ACTIVITY
  6728             MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6729             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6730
  6731     IF PRT-AH-CANC
  6732             MOVE '1'                TO AH-REFUND-SW
  6733             MOVE 'CANC '            TO DL-ACTIVITY
  6734             MOVE PRT-CANC-AMT-AH    TO DL-RSRV-AMT
  6735             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6736
  6737 4999-NEXT-PRINT.
  6738     IF PRT-LF-INCR
  6739         MOVE 'INCR '            TO DL-ACTIVITY
  6740         MOVE PRT-INCR-AMT-LF    TO DL-RSRV-AMT
  6741         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6742
  6743     IF PRT-LF-EXPIRY
  6744         MOVE 'EXP  '            TO DL-ACTIVITY
  6745         MOVE PRT-EXPIRY-AMT-LF   TO DL-RSRV-AMT
  6746         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6747
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 141
* ECS150.cbl
  6748     IF PRT-LF-DEATH
  6749         MOVE 'DEATH'            TO DL-ACTIVITY
  6750         MOVE PRT-DEATH-AMT-LF   TO DL-RSRV-AMT
  6751         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6752
  6753     IF PRT-LF-LUMP
  6754         MOVE 'LUMP '            TO DL-ACTIVITY
  6755         MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6756         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6757
  6758     IF PRT-AH-CLAIM
  6759         MOVE 'DISAB'            TO DL-ACTIVITY
  6760         MOVE PRT-CLAIM-AMT-AH   TO DL-RSRV-AMT
  6761         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6762
  6763 4999-ADVN-TOTALS.
  6764
  6765     IF CR-LFTYP = ZERO
  6766         GO TO 4000-EXIT.
  6767
  6768     MOVE SAV-LF-TERM-CODE       TO TG.
  6769
  6770     COMPUTE GROUP-CNT (CL TG 3) =
  6771                            GROUP-CNT (CL TG 1)
  6772                          + GROUP-CNT (CL TG 2).
  6773     COMPUTE GROUP-AMT (CL TG 3) =
  6774                            GROUP-AMT (CL TG 1)
  6775                          + GROUP-AMT (CL TG 2).
  6776     COMPUTE GROUP-AMT (CL TG 8) =
  6777                            GROUP-AMT (CL TG 3)
  6778                          - GROUP-AMT (CL TG 9).
  6779     COMPUTE GROUP-AMT (CL TG 7) =
  6780                            GROUP-AMT (CL TG 8)
  6781                          - GROUP-AMT (CL TG 4)
  6782                          - GROUP-AMT (CL TG 5)
  6783                          - GROUP-AMT (CL TG 6).
  6784
  6785     COMPUTE GROUP-CNT (CL TG 5) =
  6786                            GROUP-CNT (CL TG 3)
  6787                          - GROUP-CNT (CL TG 9)
  6788                          - GROUP-CNT (CL TG 4)
  6789                          - GROUP-CNT (CL TG 6).
  6790
  6791     IF GROUP-CNT (CL TG 5) GREATER THAN ZEROS
  6792         COMPUTE GROUP-AMT (CL TG 5) =
  6793                            GROUP-AMT (CL TG 3)
  6794                          - GROUP-AMT (CL TG 9)
  6795                          - GROUP-AMT (CL TG 4)
  6796                          - GROUP-AMT (CL TG 6)
  6797                          - GROUP-AMT (CL TG 7).
  6798
  6799     IF GROUP-CNT (CL TG 5) LESS THAN ZERO
  6800         MOVE ZEROS TO GROUP-CNT (CL TG 5).
  6801
  6802     COMPUTE GROUP-CNT (CL TG 8) =
  6803                            GROUP-CNT (CL TG 4)
  6804                          + GROUP-CNT (CL TG 5)
  6805                          + GROUP-CNT (CL TG 6).
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 142
* ECS150.cbl
  6806     COMPUTE IND-CNT (CL TG 3) =
  6807                            IND-CNT (CL TG 1)
  6808                          + IND-CNT (CL TG 2).
  6809     COMPUTE IND-AMT (CL TG 3) =
  6810                            IND-AMT (CL TG 1)
  6811                          + IND-AMT (CL TG 2).
  6812     COMPUTE IND-AMT (CL TG 8) =
  6813                            IND-AMT (CL TG 3)
  6814                          - IND-AMT (CL TG 9).
  6815     COMPUTE IND-AMT (CL TG 7) =
  6816                            IND-AMT (CL TG 8)
  6817                          - IND-AMT (CL TG 4)
  6818                          - IND-AMT (CL TG 5)
  6819                          - IND-AMT (CL TG 6).
  6820
  6821     COMPUTE IND-CNT (CL TG 5) =
  6822                            IND-CNT (CL TG 3)
  6823                          - IND-CNT (CL TG 9)
  6824                          - IND-CNT (CL TG 4)
  6825                          - IND-CNT (CL TG 6).
  6826     IF IND-CNT (CL TG 5) GREATER THAN ZEROS
  6827         COMPUTE IND-AMT (CL TG 5) =
  6828                            IND-AMT (CL TG 3)
  6829                          - IND-AMT (CL TG 9)
  6830                          - IND-AMT (CL TG 4)
  6831                          - IND-AMT (CL TG 6)
  6832                          - IND-AMT (CL TG 7).
  6833
  6834     IF IND-CNT (CL TG 5) LESS THAN ZERO
  6835         MOVE ZEROS TO IND-CNT (CL TG 5).
  6836
  6837     COMPUTE IND-CNT (CL TG 8) =
  6838                            IND-CNT (CL TG 4)
  6839                          + IND-CNT (CL TG 5)
  6840                          + IND-CNT (CL TG 6).
  6841 4000-EXIT.
  6842     EXIT.
  6843
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 143
* ECS150.cbl
  6845 5000-PRINT-ROUTINES     SECTION 30.
  6846
  6847 5100-PRINT-DETAIL.
  6848     IF DTE-PGM-OPT NOT = 1
  6849         GO TO 5100-EXIT.
  6850
  6851     IF FIRST-INS-PASS AND REINSURANCE-REC
  6852         GO TO 5100-EXIT.
  6853
  6854     IF LINE-CNT GREATER THAN +53
  6855         PERFORM 5500-PRINT-HEADING THRU 5500-EXIT.
  6856
  6857     IF FIRST-DETAIL-DONE
  6858         MOVE DETAIL-LINE-1      TO P-DATA
  6859         MOVE SPACE              TO X
  6860         PERFORM 5900-PRINT
  6861         MOVE SPACES             TO DETAIL-LINE-1
  6862         ADD +1 TO LINE-CNT
  6863         GO TO 5100-EXIT.
  6864
  6865     MOVE CR-CERT                TO DL-CERT-NO.
  6866     MOVE CR-CERT-SFX            TO DL-CERT-SUFX.
  6867     MOVE CR-DA                  TO XDD OF FORMAT-DATE.
  6868     MOVE CR-MO                  TO XMM OF FORMAT-DATE.
  6869     MOVE CR-YR                  TO XYY OF FORMAT-DATE.
  6870     MOVE EDITED-DATE            TO DL-ISSUE-DT.
  6871     MOVE CR-AH-TERM             TO DL-AH-TERM.
  6872     MOVE CR-LF-TERM             TO DL-LF-TERM.
  6873
  6874     IF CR-IND-GRP = '2'
  6875         MOVE 'GP '              TO DL-TYPE
  6876     ELSE
  6877         MOVE 'IND'              TO DL-TYPE.
  6878
  6879     MOVE SPACE                  TO DL-PLAN.
  6880     MOVE CLAS-I-AB3 (CLAS-INDEXL)
  6881                                 TO DL-PLAN.
  6882     MOVE CR-LFAMT               TO DL-ORIG-AMT.
  6883
  6884     IF OB-COVERAGE OR SUMMARY-REC
  6885          MOVE CR-LFAMT          TO DL-ORIG-AMT.
  6886
  6887     IF PRT-LF-REFUND
  6888         MOVE CR-LFRFND          TO DL-LF-PREM
  6889     ELSE
  6890         MOVE CR-LFPRM           TO DL-LF-PREM.
  6891
  6892     IF PRT-AH-REFUND
  6893         MOVE CR-AHRFND          TO DL-AH-PREM
  6894     ELSE
  6895         MOVE CR-AHPRM           TO DL-AH-PREM.
  6896
  6897     MOVE SPACE                  TO X.
  6898     MOVE DETAIL-LINE-1          TO P-DATA.
  6899     PERFORM 5900-PRINT.
  6900     MOVE SPACES                 TO DETAIL-LINE-1.
  6901     MOVE 1                      TO PRINT-CNTRL.
  6902     ADD +1 TO LINE-CNT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 144
* ECS150.cbl
  6903
  6904 5100-EXIT.
  6905     EXIT.
  6906
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 145
* ECS150.cbl
  6908 5200-PRINT-SUMMARY-TOTALS    SECTION 40.
  6909     IF DTE-PGM-OPT NOT = 1
  6910         PERFORM 5500-PRINT-HEADING THRU 5500-EXIT
  6911     ELSE
  6912         IF LINE-CNT NOT LESS THAN +44
  6913             PERFORM 5500-PRINT-HEADING THRU 5500-EXIT.
  6914
  6915     ADD 60 TO LINE-CNT.
  6916     MOVE '    SUMMARY TOTALS   ' TO HL-MESSAGE.
  6917     MOVE HEAD-LINE-6            TO P-DATA.
  6918     MOVE '0'                    TO X.
  6919     PERFORM 5900-PRINT.
  6920
  6921     MOVE SPACE                  TO X.
  6922     MOVE HEAD-LINE-8A           TO P-DATA.
  6923     PERFORM 5900-PRINT.
  6924
  6925     MOVE HEAD-LINE-8B           TO P-DATA.
  6926     PERFORM 5900-PRINT.
  6927     MOVE HEAD-LINE-8C           TO P-DATA.
  6928     PERFORM 5900-PRINT.
  6929
  6930     IF REINSURANCE-PASS
  6931         MOVE +5                 TO CL
  6932     ELSE
  6933         MOVE +2                 TO CL.
  6934
  6935     PERFORM 5300-ADD-TERMS THRU 5300-EXIT
  6936         VARYING TG FROM +1 BY +1
  6937             UNTIL TG GREATER THAN +3.
  6938
  6939     MOVE 'GROUP   0-60    '     TO DL-DESCRIP.
  6940     MOVE 1                      TO TG.
  6941     MOVE 5                      TO IY.
  6942     PERFORM 5240-BUILD-SUMMARY.
  6943
  6944     MOVE 'GROUP   61-120  '     TO DL-DESCRIP.
  6945     MOVE 2                      TO TG.
  6946     PERFORM 5240-BUILD-SUMMARY.
  6947
  6948     MOVE 'GROUP   GTR 120 '     TO DL-DESCRIP.
  6949     MOVE 3                      TO TG
  6950     PERFORM 5240-BUILD-SUMMARY.
  6951
  6952     MOVE 1                      TO TG.
  6953     MOVE 10                     TO IY.
  6954     MOVE 'INDV    0-60    '     TO DL-DESCRIP.
  6955     PERFORM 5240-BUILD-SUMMARY
  6956
  6957     MOVE 2                      TO TG.
  6958     MOVE 'INDV    61-120  '     TO DL-DESCRIP.
  6959     PERFORM 5240-BUILD-SUMMARY.
  6960
  6961     MOVE 3                      TO TG.
  6962     MOVE 'INDV    GTR 120 '     TO DL-DESCRIP.
  6963     PERFORM 5240-BUILD-SUMMARY.
  6964
  6965 5200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 146
* ECS150.cbl
  6966     EXIT.
  6967
  6968 5240-BUILD-SUMMARY.
  6969     MOVE ISSUE-CNT   (CL  TG  IY) TO DL-ISS-CNT.
  6970     MOVE ISSUE-AMT   (CL  TG  IY) TO DL-ISS-AMT.
  6971     MOVE ISSUE-PREM  (CL  TG  IY) TO DL-ISS-PRM.
  6972     MOVE CANCEL-CNT  (CL  TG  IY) TO DL-CAN-CNT.
  6973     MOVE CANCEL-AMT  (CL  TG  IY) TO DL-CAN-AMT.
  6974     MOVE CANCEL-PREM (CL  TG  IY) TO DL-CAN-PRM.
  6975     MOVE CLAIM-CNT   (CL  TG  IY) TO DL-CLM-CNT.
  6976     MOVE CLAIM-AMT   (CL  TG  IY) TO DL-CLM-AMT.
  6977     MOVE EARN-PREM   (CL  TG  IY) TO DL-EARN-AMT.
  6978     MOVE DETAIL-LINE-2            TO P-DATA.
  6979     PERFORM 5900-PRINT.
  6980
  6981 5300-ADD-TERMS.
  6982     MOVE +5                     TO LA.
  6983
  6984     PERFORM 5350-ADD-GRPS THRU 5350-EXIT
  6985         VARYING IY FROM 1 BY 1
  6986             UNTIL IY GREATER THAN +4.
  6987
  6988     MOVE +10 TO LA.
  6989
  6990     PERFORM 5350-ADD-GRPS THRU 5350-EXIT
  6991         VARYING IY FROM 6 BY 1
  6992             UNTIL IY GREATER THAN +9.
  6993
  6994 5300-EXIT.
  6995     EXIT.
  6996
  6997 5350-ADD-GRPS.
  6998     ADD CORRESPONDING INSURANCE-TYPES (CL  TG  IY) TO
  6999                       INSURANCE-TYPES (CL  TG  LA).
  7000
  7001 5350-EXIT.
  7002     EXIT.
  7003
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 147
* ECS150.cbl
  7005 5500-PRINT-HEADING      SECTION 30.
  7006     MOVE 0                      TO LINE-CNT.
  7007     ADD +1 TO PAGE-CNT.
  7008     MOVE LAST-CARRIER           TO HL-CARRIER.
  7009     MOVE LAST-GROUPING          TO HL-COMPANY.
  7010     MOVE PAGE-CNT               TO HL-PAGENO.
  7011     MOVE LAST-ACCOUNT           TO HL-ACCOUNT.
  7012     MOVE LAST-REINS-CO          TO HL-REIN-CO.
  7013     MOVE LAST-STATE             TO STATE-L.
  7014
  7015 5510-STATE-LOOKUP.
* 7016                             COPY ECSSTLOK.
  7017******************************************************************07/10/97
  7018*                                                                *ECSSTLOK
  7019*                            ECSSTLOK                            *   LV001
  7020*                            VMOD=2.001                         * ECSSTLOK
  7021*                                                                *ECSSTLOK
  7022*  NO  CID  MODS  IN  COPYBOOK  ECSSTLOK                         *ECSSTLOK
  7023*                                                                *ECSSTLOK
  7024******************************************************************ECSSTLOK
  7025 STATE--START.                                                    ECSSTLOK
  7026     MOVE ZERO TO CLAS-INDEXS.                                    ECSSTLOK
  7027                                                                  ECSSTLOK
  7028 STATE--LOOP.                                                     ECSSTLOK
  7029     ADD 1 TO CLAS-INDEXS.                                        ECSSTLOK
  7030     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS                     ECSSTLOK
  7031         MOVE SPACE TO STATE-L                                    ECSSTLOK
  7032         GO TO STATE--EXIT.                                       ECSSTLOK
  7033                                                                  ECSSTLOK
  7034     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)                     ECSSTLOK
  7035         GO TO STATE--LOOP.                                       ECSSTLOK
  7036                                                                  ECSSTLOK
  7037 STATE--EXIT.                                                     ECSSTLOK
  7038     EXIT.
  7039******************************************************************ECSSTLOK
  7040
  7041     IF STATE-L = SPACE
  7042         MOVE SPACE              TO HL-STATE
  7043     ELSE
  7044         MOVE STATE-PIC (CLAS-INDEXS) TO HL-STATE.
  7045
  7046     MOVE '1'                    TO X.
  7047     MOVE HEAD-LINE-1            TO P-DATA.
  7048     PERFORM 5900-PRINT.
  7049
  7050     MOVE SPACE                  TO X.
  7051     MOVE HEAD-LINE-2            TO P-DATA.
  7052     PERFORM 5900-PRINT.
  7053
  7054     MOVE HEAD-LINE-3            TO P-DATA.
  7055     PERFORM 5900-PRINT.
  7056
  7057     MOVE HEAD-LINE-4            TO P-DATA.
  7058     PERFORM 5900-PRINT.
  7059
  7060     IF REINSURANCE-PASS
  7061         MOVE HEAD-LINE-5        TO P-DATA
  7062         PERFORM 5900-PRINT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 148
* ECS150.cbl
  7063
  7064     IF DTE-PGM-OPT NOT = 1
  7065         MOVE ' NO DETAIL GENERATED ' TO HL-MESSAGE
  7066         MOVE HEAD-LINE-6        TO P-DATA
  7067         PERFORM 5900-PRINT
  7068     ELSE
  7069         MOVE '0'                TO X
  7070         MOVE HEAD-LINE-7A       TO P-DATA
  7071         PERFORM 5900-PRINT
  7072         MOVE SPACE              TO X
  7073         MOVE HEAD-LINE-7B       TO P-DATA
  7074         PERFORM 5900-PRINT.
  7075
  7076 5500-EXIT.
  7077     EXIT.
  7078
  7079 5900-PRINT.
* 7080                             COPY ELCPRT2.
  7081******************************************************************04/15/98
  7082*                                                                *ELCPRT2
  7083*                                                                *ELCPRT2
  7084*                            ELCPRT2                             *   LV005
  7085*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  7086*                            VMOD=2.002                          *   CL**5
  7087*                                                                *   CL**4
  7088******************************************************************   CL**4
  7089                                                                     CL**4
  7090     IF DTE-FICH NOT = SPACE AND                                     CL**4
  7091        FICH-OPEN    = SPACE                                         CL**4
  7092         MOVE 'X'                TO  FICH-OPEN                       CL**4
  7093         OPEN OUTPUT FICH.                                           CL**4
  7094                                                                     CL**4
  7095     IF DTE-FICH NOT = SPACE                                         CL**4
  7096         MOVE X                  TO  P-CTL                           CL**4
  7097         WRITE FICH-REC FROM PRT.                                    CL**4
  7098                                                                     CL**4
  7099     IF DTE-FICH = SPACE OR '2'                                      CL**4
  7100       MOVE X                    TO  P-CTL                           CL**4
  7101       IF P-CTL = ' '                                                CL**4
  7102         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  7103       ELSE                                                          CL**4
  7104         IF P-CTL = '0'                                              CL**4
  7105           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  7106         ELSE                                                        CL**4
  7107           IF P-CTL = '-'                                            CL**4
  7108             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  7109           ELSE                                                      CL**4
  7110             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  7111                                                                     CL**4
  7112******************************************************************   CL**4
  7113
  7114 5900-EXIT.
  7115     EXIT.
  7116
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 149
* ECS150.cbl
  7118 6000-REINSURANCE-CALC   SECTION 35.
  7119     IF CR-REIN-TABLE = SPACES OR ZEROS
  7120         GO TO 6000-EXIT.
  7121
  7122     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  7123     MOVE CR-REIN-TABLE          TO REIN-SRCH.
  7124
  7125*    IF REIN-SRCH = 'EBM'
  7126*       MOVE 'EBO'               TO REIN-SRCH
  7127*    END-IF
  7128*    IF REIN-SRCH = 'R01'
  7129*       MOVE 'R99'               TO REIN-SRCH
  7130*    END-IF
  7131
  7132     PERFORM RR-READ-REIN THRU RR-READ-REIN-X.
  7133
  7134 REINSURE-ROUTINE-GET-CALC.
* 7135                             COPY ECSRTPFM.
  7136******************************************************************07/10/97
  7137*                                                                *ECSRTPFM
  7138*                            ECSRTPFM                            *   LV001
  7139*                            VMOD=2.002                          *ECSRTPFM
  7140*                                                                *ECSRTPFM
  7141******************************************************************ECSRTPFM
  7142                                                                  ECSRTPFM
  7143     IF    CR-LFAMT  NUMERIC                                      00000072
  7144           NEXT SENTENCE                                          00000073
  7145        ELSE                                                      00000074
  7146           MOVE ZEROS TO CR-LFAMT.                                00000075
  7147                                                                  00000076
  7148     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  7149           NEXT SENTENCE                                          00000078
  7150        ELSE                                                      00000079
  7151           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  7152                                                                  00000081
  7153                                                                  00000082
  7154     IF    CR-LFPRM  NUMERIC                                      00000083
  7155           NEXT SENTENCE                                          00000084
  7156        ELSE                                                      00000085
  7157           MOVE ZEROS TO CR-LFPRM.                                00000086
  7158                                                                  00000087
  7159     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  7160           NEXT SENTENCE                                          00000089
  7161        ELSE                                                      00000090
  7162           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  7163                                                                  00000092
  7164                                                                  00000093
  7165     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  7166           NEXT SENTENCE                                          00000095
  7167        ELSE                                                      00000096
  7168           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  7169                                                                  00000098
  7170     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  7171           NEXT SENTENCE                                          00000100
  7172        ELSE                                                      00000101
  7173           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  7174                                                                  00000103
  7175     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 150
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  7176           NEXT SENTENCE                                          00000105
  7177        ELSE                                                      00000106
  7178           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  7179                                                                  00000108
  7180     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  7181     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  7182     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  7183         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
  7184     ELSE                                                         ECSRTPFM
  7185         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  7186     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  7187                                                                  ECSRTPFM
  7188     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  7189     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  7190     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  7191         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  7192     ELSE                                                         ECSRTPFM
  7193         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
  7194     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  7195                                                                  ECSRTPFM
  7196     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  7197         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  7198             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  7199                                                                  ECSRTPFM
  7200
  7201 REINSURE-ROUTINE-SKIP-1.
  7202     PERFORM REINSURE-CANCEL THRU REINSURE-CANCEL-X.
  7203     PERFORM REINSURE-CLAIM THRU REINSURE-CLAIM-X.
  7204     MOVE SPACES                 TO RC-REC.
  7205     MOVE CR-FULL-CONTROL        TO RC-CMCTL.
  7206     MOVE CR-LFAMT               TO RC-ORIG-LFAMT.
  7207     MOVE CR-LFAMT-ALT           TO RC-LFAMT-ALT.
  7208     MOVE CR-LF-TERM             TO RC-LF-TERM.
  7209     MOVE CR-LF-TERM-IN-DAYS     TO RC-LF-TERM-IN-DAYS.
  7210     MOVE CR-AH-TERM             TO RC-AH-TERM.
  7211     MOVE CR-ENTRY-STATUS        TO RC-ENTRY-STATUS.
  7212     MOVE CR-LF-CURRENT-STATUS   TO RC-LF-CURRENT-STATUS.
  7213     MOVE CR-AH-CURRENT-STATUS   TO RC-AH-CURRENT-STATUS.
  7214     MOVE CR-LFTYP               TO RC-LFTYP.
  7215     MOVE CR-AHTYP               TO RC-AHTYP.
  7216     MOVE CR-IND-GRP             TO RC-IND-GRP.
  7217     MOVE CR-LF-CANC-DT          TO RC-LF-CANC-DT.
  7218     MOVE CR-AH-CANC-DT          TO RC-AH-CANC-DT.
  7219     MOVE CR-DIS-DT              TO RC-DIS-DT.
  7220     MOVE CR-ENTRY-DATE          TO RC-ENT-DT.
  7221     MOVE CR-LF-status-at-cancel TO RC-LF-cancel-status
  7222     MOVE CR-ah-status-at-cancel TO RC-ah-cancel-status
  7223     MOVE CR-LF-CANCEL-EXIT-DATE TO RC-LF-CANC-EXIT.
  7224     MOVE CR-AH-CANCEL-EXIT-DATE TO RC-AH-CANC-EXIT.
  7225     MOVE CR-LF-CLAIM-EXIT-DATE  TO RC-LF-CLAIM-EXIT.
  7226     MOVE CR-AH-SETTLEMENT-EXIT-DATE
  7227                                 TO RC-AH-CLAIM-EXIT.
  7228     MOVE CR-PMT-FREQ            TO RC-PMT-FREQ.
  7229     MOVE CR-APR                 TO RC-APR.
  7230     MOVE CR-LOAN-TERM           TO RC-LOAN-TERM.
  7231     MOVE CR-IND-GRP             TO RC-IND-GRP.
  7232     MOVE CR-LIVES               TO RC-I-LIVES.
  7233     MOVE CR-SUM-CAN-CNT-YTD     TO RC-C-LIVES-YTD.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 151
* ECS150.cbl
  7234     MOVE CR-SUM-CAN-CNT-ITD     TO RC-C-LIVES-ITD.
  7235     MOVE CR-LFRFND-CALC         TO RC-LFRFND-YTD.
  7236     MOVE CR-AHRFND-CALC         TO RC-AHRFND-YTD.
  7237     MOVE CR-LF-EXPIRE-DATE      TO RC-LF-EXPIRE-DT.
  7238     MOVE CR-AH-EXPIRE-DATE      TO RC-AH-EXPIRE-DT.
  7239     MOVE CR-LOAN-1ST-PMT-DT     TO RC-LOAN-1ST-PMT-DT.
  7240     MOVE RC-REC                 TO SAVE-REINS-CERT.
  7241     GO TO 6000-EXIT.
  7242
  7243 RR-READ-REIN.
  7244     IF REIN-OPEN-SW = ' '
  7245         MOVE LOW-VALUES         TO RE-KEY
  7246         MOVE 'X'                TO REIN-OPEN-SW
  7247         MOVE 'A'                TO REIN-SRCH-CODE
  7248         OPEN INPUT ERRTBL-IN
  7249         IF ERRTBL-FILE-STATUS = '00' OR '97'
  7250             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
  7251          ELSE
  7252             MOVE '21'           TO ABEND-FILE-ID
  7253             MOVE ERRTBL-FILE-STATUS
  7254                                 TO ABEND-REASON
  7255             GO TO ABEND-PGM.
  7256
  7257     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  7258         MOVE LOW-VALUES         TO RE-KEY
  7259         MOVE DTE-CLASIC-COMPANY-CD
  7260                                 TO RE-COMPANY-CD
  7261         MOVE REIN-SRCH          TO SAVE-REIN-SRCH
  7262                                    RE-TABLE
  7263         MOVE REIN-SRCH-CODE     TO RE-CODE
  7264         READ ERRTBL-IN
  7265         IF ERRTBL-FILE-STATUS NOT = '00'
  7266             DISPLAY 'INVALID REINSURANCE TABLE CODE - '
  7267                 RE-TABLE ' ' CR-ACCT-CONTROL
  7268             MOVE '24'            TO ABEND-FILE-ID
  7269             MOVE ERRTBL-FILE-STATUS
  7270                                 TO ABEND-REASON
  7271             GO TO ABEND-PGM.
  7272
  7273     IF RE-CODE NOT = 'A'
  7274        PERFORM REIN-DATE-LOAD.
  7275
  7276 RR-READ-REIN-X.
  7277     EXIT.
  7278
  7279 REINSURE-CANCEL.
  7280     IF REIN-COMP (1) = SPACES
  7281         GO TO REINSURE-CANCEL-X.
  7282
  7283     IF CR-LFRFND = ZERO AND
  7284        CR-AHRFND = ZERO
  7285         GO TO REINSURE-CANCEL-X.
  7286
  7287     PERFORM REINSURE-CALC-CANCEL
  7288             THRU REINSURE-CALC-CANCEL-X
  7289                 VARYING SUB1 FROM +1 BY +1
  7290                     UNTIL REIN-COMP (SUB1) = SPACES.
  7291
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 152
* ECS150.cbl
  7292 REINSURE-CANCEL-X.
  7293     EXIT.
  7294
  7295 REINSURE-CLAIM.
  7296     IF REIN-COMP (1) = SPACES
  7297         GO TO REINSURE-CLAIM-X.
  7298
  7299     MOVE CR-DTHAMT-YTD          TO RW-LFCLMWK.
  7300     MOVE CR-DISAMT-YTD          TO RW-AHCLMWK.
  7301     MOVE +0                     TO RW-LFCLM
  7302                                    RW-AHCLM.
  7303
  7304     IF RW-LFCLMWK = ZERO AND
  7305        RW-AHCLMWK = ZERO
  7306         GO TO REINSURE-CLAIM-X.
  7307
  7308     PERFORM REINSURE-CALC-CLAIM
  7309             THRU REINSURE-CALC-CLAIM-X
  7310                 VARYING SUB1 FROM +1 BY +1
  7311                     UNTIL REIN-COMP (SUB1) = SPACES.
  7312
  7313 REINSURE-CLAIM-X.
  7314     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 153
* ECS150.cbl
  7316
  7317 REINSURANCE-ROUTINES.
* 7318                             COPY ECSRIRTN.
  7319******************************************************************04/30/98
  7320*                                                                *ECSRIRTN
  7321*                            ECSRIRTN                            *   LV012
  7322*                            VMOD=2.025.                         *ECSRIRTN
  7323*                                                                *ECSRIRTN
  7324******************************************************************ECSRIRTN
  7325******************************************************************
  7326*                   C H A N G E   L O G
  7327*
  7328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7329*-----------------------------------------------------------------
  7330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7331* EFFECTIVE    NUMBER
  7332*-----------------------------------------------------------------
  7333* 062703                   PEMA  ADD DCC CLIENT ID TO
  7334*                                SPECIAL CEDED CLAIM CALC
  7335* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7336                                                                  ECSRIRTN
  7337 REINSURE-CALC.                                                   ECSRIRTN
  7338                                                                  ECSRIRTN
  7339     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  7340     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  7341     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  7342     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  7343                                   REIN-REM-SW (SUB1).            ECSRIRTN
  7344                                                                  ECSRIRTN
  7345     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  7346                                   WS-RWF-EP-STOP-DATE-N             CL*12
  7347                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  7348                                                                  ECSRIRTN
  7349     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  7350                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  7351                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  7352                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  7353                                                                  ECSRIRTN
  7354     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  7355        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  7356          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  7357          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  7358          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  7359                                                                  ECSRIRTN
  7360     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  7361        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  7362         GO TO CALC-CONTINUED.                                    ECSRIRTN
  7363                                                                  ECSRIRTN
  7364     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  7365                                          WS-RWF-EP-STOP-DATE-N      CL*12
  7366                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  7367                                                                  ECSRIRTN
  7368     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  7369         GO TO CALC-CONTINUED.                                    ECSRIRTN
  7370                                                                  ECSRIRTN
  7371     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  7372         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
  7373                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 154
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7374                                                                  ECSRIRTN
  7375     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  7376         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  7377                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  7378                                                                  ECSRIRTN
  7379 CALC-CONTINUED.                                                  ECSRIRTN
  7380                                                                  ECSRIRTN
  7381     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  7382     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  7383                                                                  ECSRIRTN
  7384     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  7385         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  7386     ELSE                                                         ECSRIRTN
  7387         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  7388     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  7389                                                                  ECSRIRTN
  7390     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  7391     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  7392     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  7393         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  7394     ELSE                                                         ECSRIRTN
  7395         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  7396     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  7397                                                                  ECSRIRTN
  7398     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  7399         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  7400         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  7401         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  7402         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  7403         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  7404         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  7405                                                                  ECSRIRTN
  7406     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  7407         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  7408                                                                  ECSRIRTN
  7409     IF CR-DT LESS WT-LO-DATE                                        CL**2
  7410         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  7411                                                                  ECSRIRTN
  7412     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  7413         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  7414                                                                  ECSRIRTN
  7415     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  7416     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  7417                                                                  ECSRIRTN
  7418     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  7419         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  7420                                                                  ECSRIRTN
  7421     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  7422       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  7423        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  7424        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  7425           NEXT SENTENCE                                          ECSRIRTN
  7426       ELSE                                                       ECSRIRTN
  7427           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  7428                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  7429                                                                  ECSRIRTN
  7430     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  7431         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 155
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7432            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
  7433             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  7434                                                                  ECSRIRTN
  7435     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  7436         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  7437            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  7438             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  7439                                                                  ECSRIRTN
  7440     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  7441         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  7442             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  7443                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  7444             ELSE                                                 ECSRIRTN
  7445                 NEXT SENTENCE                                    ECSRIRTN
  7446         ELSE                                                     ECSRIRTN
  7447             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  7448                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  7449                                                                  ECSRIRTN
  7450     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  7451         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  7452             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  7453                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  7454             ELSE                                                 ECSRIRTN
  7455                 NEXT SENTENCE                                    ECSRIRTN
  7456         ELSE                                                     ECSRIRTN
  7457             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  7458                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  7459                                                                  ECSRIRTN
  7460     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  7461         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  7462                                                                  ECSRIRTN
  7463     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  7464         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  7465         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  7466                                                                  ECSRIRTN
  7467     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  7468         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  7469                                                                  ECSRIRTN
  7470     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  7471         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  7472         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  7473                                                                  ECSRIRTN
  7474     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7475         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  7476                                                                  ECSRIRTN
  7477     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7478         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  7479                                                                  ECSRIRTN
  7480     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  7481                                                                  ECSRIRTN
  7482 REINSURE-CK-LIFE.                                                ECSRIRTN
  7483                                                                  ECSRIRTN
  7484     IF CR-LFTYP = ZERO                                           ECSRIRTN
  7485         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7486                                                                  ECSRIRTN
  7487     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  7488         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7489                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 156
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7490     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  7491         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  7492             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7493                                                                  ECSRIRTN
  7494     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  7495                                                                  ECSRIRTN
  7496     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  7497         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  7498             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  7499         ELSE                                                     ECSRIRTN
  7500             NEXT SENTENCE                                        ECSRIRTN
  7501     ELSE                                                         ECSRIRTN
  7502         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  7503             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7504                                                                  ECSRIRTN
  7505     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  7506         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  7507             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  7508         ELSE                                                     ECSRIRTN
  7509             NEXT SENTENCE                                        ECSRIRTN
  7510     ELSE                                                         ECSRIRTN
  7511         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  7512             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7513                                                                  ECSRIRTN
  7514     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  7515         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  7516             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7517                                                                  ECSRIRTN
  7518     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  7519         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  7520            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7521                                                                  ECSRIRTN
  7522     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  7523         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  7524             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7525                                                                  ECSRIRTN
  7526     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  7527         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  7528            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7529                                                                  ECSRIRTN
  7530     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  7531         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  7532             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7533                                                                  ECSRIRTN
  7534     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  7535         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  7536            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  7537            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  7538             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7539                                                                  ECSRIRTN
  7540     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  7541         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  7542            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  7543             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7544                                                                  ECSRIRTN
  7545     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  7546         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  7547             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 157
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7548                                                                  ECSRIRTN
  7549     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  7550         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  7551             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7552                                                                  ECSRIRTN
  7553     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  7554        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  7555           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  7556            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7557                                                                  ECSRIRTN
  7558     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  7559         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7560            CR-IND-GRP = '1'                                      ECSRIRTN
  7561             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7562                                                                  ECSRIRTN
  7563     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  7564         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  7565            CR-IND-GRP = '1'                                      ECSRIRTN
  7566             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7567                                                                  ECSRIRTN
  7568     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  7569         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7570            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  7571            CR-IND-GRP = '1'                                      ECSRIRTN
  7572             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7573                                                                  ECSRIRTN
  7574     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  7575         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7576            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  7577            CR-IND-GRP = '1'                                      ECSRIRTN
  7578             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7579                                                                  ECSRIRTN
  7580     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  7581         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  7582            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7583                                                                  ECSRIRTN
  7584     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  7585        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  7586                                                                  ECSRIRTN
  7587     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  7588         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7589                                                                  ECSRIRTN
  7590     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  7591         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7592                                                                  ECSRIRTN
  7593     IF CR-LF-TERM  NUMERIC                                       00002331
  7594        NEXT SENTENCE                                             00002332
  7595     ELSE                                                         00002333
  7596        MOVE ZEROS               TO CR-LF-TERM                    00002334
  7597     END-IF
  7598                                                                  00002335
  7599     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  7600         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7601                                                                  ECSRIRTN
  7602     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  7603         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7604                                                                  ECSRIRTN
  7605     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 158
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7606                                                                  ECSRIRTN
  7607     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  7608         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7609                                                                  ECSRIRTN
  7610     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  7611         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7612                                                                  ECSRIRTN
  7613     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  7614                                                                  ECSRIRTN
  7615 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  7616     EXIT.                                                        ECSRIRTN
  7617                                                                  ECSRIRTN
  7618 REINSURE-CK-AH.                                                  ECSRIRTN
  7619                                                                  ECSRIRTN
  7620     IF CR-AHTYP = ZERO                                           ECSRIRTN
  7621         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7622                                                                  ECSRIRTN
  7623     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  7624         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7625                                                                  ECSRIRTN
  7626     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  7627         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  7628             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7629                                                                  ECSRIRTN
  7630     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  7631                                                                  ECSRIRTN
  7632     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  7633         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  7634             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  7635         ELSE                                                     ECSRIRTN
  7636             NEXT SENTENCE                                        ECSRIRTN
  7637     ELSE                                                         ECSRIRTN
  7638         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  7639             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7640                                                                  ECSRIRTN
  7641     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  7642         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  7643             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7644                                                                  ECSRIRTN
  7645     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  7646         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  7647             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7648                                                                  ECSRIRTN
  7649     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  7650         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  7651             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7652                                                                  ECSRIRTN
  7653     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  7654         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  7655             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7656                                                                  ECSRIRTN
  7657     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  7658         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  7659            CR-IND-GRP = '1'                                      ECSRIRTN
  7660             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7661                                                                  ECSRIRTN
  7662     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  7663         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 159
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7664             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7665                                                                  ECSRIRTN
  7666     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  7667         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  7668            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  7669                                                                  ECSRIRTN
  7670     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  7671         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  7672            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  7673                                                                  ECSRIRTN
  7674     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  7675         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  7676             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7677                                                                  ECSRIRTN
  7678     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  7679        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  7680                                                                  ECSRIRTN
  7681     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  7682         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7683                                                                  ECSRIRTN
  7684     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  7685         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7686                                                                  ECSRIRTN
  7687     IF CR-AH-TERM  NUMERIC                                       00002331
  7688        NEXT SENTENCE                                             00002332
  7689     ELSE                                                         00002333
  7690        MOVE ZEROS               TO CR-AH-TERM                    00002334
  7691     END-IF
  7692                                                                  00002335
  7693     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  7694         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7695                                                                  ECSRIRTN
  7696     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  7697         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7698                                                                  ECSRIRTN
  7699     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  7700                                                                  ECSRIRTN
  7701     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  7702         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  7703             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  7704                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  7705                                                                  ECSRIRTN
  7706     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  7707         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  7708             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  7709                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  7710                                                                  ECSRIRTN
  7711     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  7712     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  7713                                                                  ECSRIRTN
  7714     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  7715         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  7716                                                                  ECSRIRTN
  7717     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  7718         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  7719                                                                  ECSRIRTN
  7720     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
  7721                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 160
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7722     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  7723                                                                  ECSRIRTN
  7724     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  7725         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7726                                                                  ECSRIRTN
  7727     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7728         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7729                                                                  ECSRIRTN
  7730     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  7731                                                                  ECSRIRTN
  7732 REINSURE-CK-AH-X.                                                ECSRIRTN
  7733     EXIT.                                                        ECSRIRTN
  7734                                                                  ECSRIRTN
  7735 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  7736                                                                  ECSRIRTN
  7737     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  7738        RS-AH-BEN = ZERO                                          ECSRIRTN
  7739         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  7740                                                                  ECSRIRTN
  7741     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  7742        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7743         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  7744                                                                  ECSRIRTN
  7745     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7746                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  7747                                                                  ECSRIRTN
  7748     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  7749         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  7750             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  7751                                     WT-AHBEN-HI.                 ECSRIRTN
  7752     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  7753         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  7754             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  7755                                     WT-AHMOA-HI.                 ECSRIRTN
  7756                                                                  ECSRIRTN
  7757     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  7758     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  7759                                                                  ECSRIRTN
  7760     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  7761         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  7762                                                                  ECSRIRTN
  7763     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  7764         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  7765                                                                  ECSRIRTN
  7766     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  7767                                                                  ECSRIRTN
  7768     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7769         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  7770                                                                  ECSRIRTN
  7771     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  7772         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  7773                                       / RW-AHWRK                 ECSRIRTN
  7774       ELSE                                                       ECSRIRTN
  7775         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  7776                                                                  ECSRIRTN
  7777     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  7778         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
  7779                                       / RS-LIFE-BEN              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 161
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7780       ELSE                                                       ECSRIRTN
  7781         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  7782                                                                  ECSRIRTN
  7783     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  7784        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  7785          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  7786          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  7787                                      / CR-AH-TERM.               ECSRIRTN
  7788                                                                  ECSRIRTN
  7789     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  7790        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  7791          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7792          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  7793               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  7794            ELSE                                                  ECSRIRTN
  7795                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  7796                                                                  ECSRIRTN
  7797     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  7798        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  7799        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  7800          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  7801          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  7802                                      / CR-AH-TERM                ECSRIRTN
  7803         ELSE                                                     ECSRIRTN
  7804          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7805          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  7806               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  7807            ELSE                                                  ECSRIRTN
  7808                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  7809                                                                  ECSRIRTN
  7810 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  7811     EXIT.                                                        ECSRIRTN
  7812                                                                  ECSRIRTN
  7813                                                                  ECSRIRTN
  7814 REIN-CALC-LIFE.                                                  ECSRIRTN
  7815                                                                  ECSRIRTN
  7816     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
  7817         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
  7818     ELSE                                                         ECSRIRTN
  7819         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
  7820                                                                  ECSRIRTN
  7821     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
  7822         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
  7823     ELSE                                                         ECSRIRTN
  7824         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
  7825           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
  7826               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
  7827           ELSE                                                   ECSRIRTN
  7828               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
  7829                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
  7830                                                                  ECSRIRTN
  7831 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
  7832                                                                  ECSRIRTN
  7833     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
  7834                                                                  ECSRIRTN
  7835     IF WT-REMAINING = 'I'                                        ECSRIRTN
  7836         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
  7837                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 162
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7838     IF WT-REMAINING = 'L'                                        ECSRIRTN
  7839         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
  7840         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  7841                                                                  ECSRIRTN
  7842     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
  7843         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
  7844                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  7845         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
  7846                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  7847     ELSE                                                         ECSRIRTN
  7848         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  7849             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
  7850             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
  7851                                                                  ECSRIRTN
  7852     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
  7853         (WT-LF-QC = '2' AND                                         CL**8
  7854          PGM-SUB = +50  AND                                         CL**8
  7855          DTE-CLIENT = 'LAP'))                                       CL**8
  7856          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
  7857     ELSE                                                         ECSRIRTN
  7858         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
  7859                                                                  ECSRIRTN
  7860     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  7861         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
  7862         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
  7863         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
  7864                                                                  ECSRIRTN
  7865     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
  7866                                                                  ECSRIRTN
  7867 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
  7868                                                                  ECSRIRTN
  7869     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  7870         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
  7871         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  7872                                                                  ECSRIRTN
  7873     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
  7874     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  7875     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
  7876                                       RW-LFPRM.                  ECSRIRTN
  7877                                                                  ECSRIRTN
  7878 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
  7879                                                                  ECSRIRTN
  7880     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
  7881                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  7882                                                                  ECSRIRTN
  7883     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  7884        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  7885                                                                  ECSRIRTN
  7886     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
  7887        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  7888         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
  7889     ELSE                                                         ECSRIRTN
  7890         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  7891         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
  7892                                                                  ECSRIRTN
  7893                                                                  ECSRIRTN
  7894 REIN-CALC-LIFE-X.                                                ECSRIRTN
  7895     EXIT.                                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 163
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7896                                                                  ECSRIRTN
  7897 REIN-CALC-AH.                                                    ECSRIRTN
  7898                                                                  ECSRIRTN
  7899     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  7900         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  7901             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
  7902                                 WT-AHBEN-HI.                     ECSRIRTN
  7903                                                                  ECSRIRTN
  7904     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  7905         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  7906             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
  7907                                 WT-AHMOA-HI.                     ECSRIRTN
  7908                                                                  ECSRIRTN
  7909     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  7910     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  7911                                                                  ECSRIRTN
  7912     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  7913         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
  7914                                                                  ECSRIRTN
  7915     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  7916         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
  7917                                                                  ECSRIRTN
  7918     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7919         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
  7920                                                                  ECSRIRTN
  7921     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
  7922         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
  7923     ELSE                                                         ECSRIRTN
  7924         IF WT-REMAINING = 'L'                                    ECSRIRTN
  7925             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
  7926         ELSE                                                     ECSRIRTN
  7927             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
  7928             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
  7929                                                                  ECSRIRTN
  7930 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
  7931                                                                  ECSRIRTN
  7932     IF WT-REMAINING = 'I'                                        ECSRIRTN
  7933         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
  7934                                                                  ECSRIRTN
  7935     IF WT-REMAINING = 'L'                                        ECSRIRTN
  7936         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
  7937         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  7938                                                                  ECSRIRTN
  7939     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
  7940         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
  7941                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  7942         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
  7943                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  7944     ELSE                                                         ECSRIRTN
  7945         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
  7946             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
  7947             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
  7948                                                                  ECSRIRTN
  7949     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
  7950         (WT-AH-QC = '2' AND                                         CL**8
  7951          PGM-SUB = +50  AND                                         CL**8
  7952          DTE-CLIENT = 'LAP'))                                       CL**8
  7953         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 164
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7954     ELSE                                                         ECSRIRTN
  7955         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
  7956                                                                  ECSRIRTN
  7957     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
  7958         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
  7959            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
  7960                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
  7961                                                                  ECSRIRTN
  7962     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  7963         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
  7964         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
  7965         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
  7966                                                                  ECSRIRTN
  7967     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
  7968                                                                  ECSRIRTN
  7969 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
  7970                                                                  ECSRIRTN
  7971     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  7972         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
  7973         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  7974                                                                  ECSRIRTN
  7975     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  7976     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  7977     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  7978                                    RW-AHPRM.                     ECSRIRTN
  7979                                                                  ECSRIRTN
  7980 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
  7981                                                                  ECSRIRTN
  7982     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
  7983                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  7984                                                                  ECSRIRTN
  7985     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  7986                                                                  ECSRIRTN
  7987     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
  7988        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  7989         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
  7990     ELSE                                                         ECSRIRTN
  7991         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  7992         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
  7993                                                                  ECSRIRTN
  7994                                                                  ECSRIRTN
  7995 REIN-CALC-AH-X.                                                  ECSRIRTN
  7996     EXIT.                                                        ECSRIRTN
  7997                                                                  ECSRIRTN
  7998 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
  7999                                                                  ECSRIRTN
  8000     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
  8001     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
  8002     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
  8003     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
  8004                                                                  ECSRIRTN
  8005     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
  8006         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
  8007                                                                  ECSRIRTN
  8008     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
  8009        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
  8010           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  8011                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 165
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8012     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
  8013        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
  8014           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  8015                                                                  ECSRIRTN
  8016 REINSURE-CALC-X.                                                 ECSRIRTN
  8017                                                                  ECSRIRTN
  8018     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8019         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8020                                                                  ECSRIRTN
  8021     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8022                                                                  ECSRIRTN
  8023 REINSURE-SUBTRACT.                                               ECSRIRTN
  8024                                                                  ECSRIRTN
  8025     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
  8026     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
  8027     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
  8028     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
  8029                                                                  ECSRIRTN
  8030 REINSURE-SUBTRACT-X.                                             ECSRIRTN
  8031     EXIT.                                                        ECSRIRTN
  8032                                                                  ECSRIRTN
  8033 REINSURE-CALC-CANCEL.                                            ECSRIRTN
  8034                                                                  ECSRIRTN
  8035     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  8036     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  8037                                                                  ECSRIRTN
  8038     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  8039         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
  8040                                                                  ECSRIRTN
  8041     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8042         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8043                                                                  ECSRIRTN
  8044     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  8045         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
  8046             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
  8047                                                                  ECSRIRTN
  8048     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8049         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
  8050                                                                  ECSRIRTN
  8051     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8052         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
  8053         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8054                                                                  ECSRIRTN
  8055     IF CR-LFPRM = ZERO                                           ECSRIRTN
  8056        MOVE ZERO                TO REIN-FACTOR
  8057     ELSE                                                         ECSRIRTN
  8058        IF DTE-CLIENT = 'GIC'  AND
  8059           CLAS-I-BAL (CLAS-INDEXL) = 'B'
  8060           MOVE +1.0             TO REIN-FACTOR
  8061        ELSE
  8062           IF DTE-CLIENT = 'DCC'
  8063              COMPUTE REIN-FACTOR = CR-LFRFND /
  8064                 (CR-LFPRM + CR-LFPRM-ALT)
  8065           ELSE
  8066              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
  8067                 (CR-LFPRM + CR-LFPRM-ALT)
  8068            END-IF
  8069         END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 166
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8070     END-IF
  8071                                                                  ECSRIRTN
  8072     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  8073         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  8074             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8075                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
  8076                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8077             ELSE                                                 ECSRIRTN
  8078                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8079                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8080                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
  8081                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8082         ELSE                                                     ECSRIRTN
  8083             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8084                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
  8085                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
  8086             ELSE                                                 ECSRIRTN
  8087*                COMPUTE RWF-LFRFND = REIN-FACTOR
  8088*                   * REIN-CALCED-LIFE *
  8089*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
  8090                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8091                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8092                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
  8093                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
  8094                                                                  ECSRIRTN
  8095     IF CR-LFAMT = ZERO                                           ECSRIRTN
  8096         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  8097             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8098                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  8099                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
  8100             ELSE                                                 ECSRIRTN
  8101                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8102                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8103                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  8104                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
  8105                                                                  ECSRIRTN
  8106     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
  8107                                                                  ECSRIRTN
  8108                                                                  ECSRIRTN
  8109 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
  8110                                                                  ECSRIRTN
  8111     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  8112       (CR-LF-CANC-DT = ZEROS)                                       CL*10
  8113         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  8114         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8115                                                                  ECSRIRTN
  8116     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8117       IF VOIDING-LF-CANCEL                                       ECSRIRTN
  8118           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
  8119           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
  8120       ELSE                                                       ECSRIRTN
  8121           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
  8122               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
  8123                                                                  ECSRIRTN
  8124     IF FLAT-CANCEL-LF                                            ECSRIRTN
  8125         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
  8126         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8127                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 167
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8128     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
  8129         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  8130         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8131                                                                  ECSRIRTN
  8132     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
  8133     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  8134     MOVE +0                          TO REIN-WORKA               ECSRIRTN
  8135                                         RW-LFRFND.               ECSRIRTN
  8136                                                                  ECSRIRTN
  8137 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
  8138                                                                  ECSRIRTN
  8139     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
  8140                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  8141                                                                  ECSRIRTN
  8142     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  8143        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  8144                                                                  ECSRIRTN
  8145     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
  8146        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8147         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
  8148     ELSE                                                         ECSRIRTN
  8149         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8150         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
  8151                                                                  ECSRIRTN
  8152                                                                  ECSRIRTN
  8153 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
  8154                                                                  ECSRIRTN
  8155     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8156         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8157                                                                  ECSRIRTN
  8158     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8159         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
  8160             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
  8161                                                                  ECSRIRTN
  8162     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  8163         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
  8164         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
  8165             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
  8166                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  8167         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8168                                                                  ECSRIRTN
  8169     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8170         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
  8171                                                                  ECSRIRTN
  8172     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8173         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
  8174         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8175                                                                  ECSRIRTN
  8176     IF CR-AHPRM = ZERO                                           ECSRIRTN
  8177        MOVE ZERO                TO REIN-FACTOR
  8178     ELSE
  8179        IF DTE-CLIENT = 'GIC'  AND
  8180           CLAS-I-BAL (CLAS-INDEXA) = 'B'
  8181            MOVE +1.0            TO REIN-FACTOR
  8182        ELSE
  8183           IF DTE-CLIENT = 'DCC'
  8184              COMPUTE REIN-FACTOR =
  8185                 CR-AHRFND / CR-AHPRM
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 168
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8186           ELSE
  8187              COMPUTE REIN-FACTOR ROUNDED =
  8188                                CR-AHRFND-CALC / CR-AHPRM
  8189           END-IF
  8190        END-IF
  8191     END-IF
  8192
  8193     IF CR-AHAMT NOT = ZERO
  8194        IF (DTE-CLIENT = 'DCC')
  8195           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
  8196           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
  8197        ELSE
  8198           IF WT-AH-QC = ('1' OR '4')
  8199              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
  8200                       RWF-AHAMT) / CR-AHAMT
  8201           ELSE
  8202              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
  8203              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
  8204                       RWF-AHAMT) / CR-AHAMT
  8205           END-IF
  8206        END-IF
  8207     ELSE
  8208        IF RWF-AH-LIMIT = ZERO
  8209           IF WT-AH-QC = ('1' OR '4')
  8210              COMPUTE RWF-AHRFND ROUNDED =
  8211                       CR-AHRFND * WT-AH-PCT
  8212           ELSE
  8213              COMPUTE RWF-AHRFND =
  8214                            REIN-FACTOR * REIN-CALCED-AH
  8215              COMPUTE RWF-AHRFND ROUNDED =
  8216                       RWF-AHRFND * WT-AH-PCT
  8217           END-IF
  8218        END-IF
  8219     END-IF
  8220
  8221     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
  8222                                                                  ECSRIRTN
  8223                                                                  ECSRIRTN
  8224 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
  8225                                                                  ECSRIRTN
  8226     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  8227       (CR-AH-CANC-DT = ZEROS)                                       CL*10
  8228         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  8229         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8230                                                                  ECSRIRTN
  8231     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8232       IF VOIDING-AH-CANCEL                                       ECSRIRTN
  8233           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
  8234           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
  8235       ELSE                                                       ECSRIRTN
  8236           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
  8237               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
  8238                                                                  ECSRIRTN
  8239     IF FLAT-CANCEL-AH                                            ECSRIRTN
  8240         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
  8241         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8242                                                                  ECSRIRTN
  8243     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 169
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8244         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  8245         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8246                                                                  ECSRIRTN
  8247     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  8248     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  8249     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  8250                                    RW-AHRFND.                    ECSRIRTN
  8251                                                                  ECSRIRTN
  8252 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
  8253                                                                  ECSRIRTN
  8254     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
  8255                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  8256                                                                  ECSRIRTN
  8257     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  8258                                                                  ECSRIRTN
  8259     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
  8260        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8261         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
  8262     ELSE                                                         ECSRIRTN
  8263         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8264         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
  8265                                                                  ECSRIRTN
  8266                                                                  ECSRIRTN
  8267 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
  8268                                                                  ECSRIRTN
  8269     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  8270         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8271                                                                  ECSRIRTN
  8272     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  8273         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8274                                                                  ECSRIRTN
  8275     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
  8276                                                                  ECSRIRTN
  8277 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
  8278                                                                  ECSRIRTN
  8279     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
  8280     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
  8281                                                                  ECSRIRTN
  8282     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
  8283         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
  8284             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  8285                                                                  ECSRIRTN
  8286     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  8287         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8288                                                                  ECSRIRTN
  8289     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  8290         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8291                                                                  ECSRIRTN
  8292 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
  8293                                                                  ECSRIRTN
  8294     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8295         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8296                                                                  ECSRIRTN
  8297     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8298                                                                  ECSRIRTN
  8299 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
  8300                                                                  ECSRIRTN
  8301     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 170
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8302     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
  8303                                                                  ECSRIRTN
  8304 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
  8305     EXIT.                                                        ECSRIRTN
  8306                                                                  ECSRIRTN
  8307 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
  8308                                                                  ECSRIRTN
  8309     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  8310         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
  8311                                                                  ECSRIRTN
  8312 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
  8313     EXIT.                                                        ECSRIRTN
  8314                                                                  ECSRIRTN
  8315 REINSURE-CALC-CLAIM.                                             ECSRIRTN
  8316                                                                  ECSRIRTN
  8317     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  8318     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  8319                                                                  ECSRIRTN
  8320     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  8321         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
  8322                                                                  ECSRIRTN
  8323     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  8324        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  8325          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  8326          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  8327          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  8328                                                                  ECSRIRTN
  8329     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  8330        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  8331          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
  8332                                                                  ECSRIRTN
  8333     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
  8334                                  RWF-AHCLML.                     ECSRIRTN
  8335                                                                  ECSRIRTN
  8336     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8337         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8338                                                                  ECSRIRTN
  8339     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
  8340         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8341                                                                  ECSRIRTN
  8342     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8343         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  8344             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
  8345                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  8346                                                                  ECSRIRTN
  8347     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  8348         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  8349                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  8350                                                                  ECSRIRTN
  8351     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8352         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
  8353                                                                  ECSRIRTN
  8354     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8355         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  8356             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
  8357                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  8358             ELSE                                                 ECSRIRTN
  8359                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 171
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8360         ELSE                                                     ECSRIRTN
  8361             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
  8362                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
  8363                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  8364             ELSE                                                 ECSRIRTN
  8365                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
  8366                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
  8367                                                                  ECSRIRTN
  8368     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8369         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8370                                                                  ECSRIRTN
  8371     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  8372         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  8373            OR 'DCC'
  8374             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
  8375                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8376         ELSE                                                     ECSRIRTN
  8377             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
  8378                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
  8379                                                                  ECSRIRTN
  8380     IF CR-LFAMT = ZERO                                           ECSRIRTN
  8381         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  8382             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  8383                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
  8384                                                                  ECSRIRTN
  8385     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8386         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  8387             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  8388                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
  8389                                                                  ECSRIRTN
  8390     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8391         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  8392             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  8393               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
  8394                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  8395                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  8396                  ELSE                                            ECSRIRTN
  8397                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
  8398                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  8399              ELSE                                                ECSRIRTN
  8400                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
  8401                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
  8402                     COMPUTE RWF-LFCLML =                         ECSRIRTN
  8403                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
  8404                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  8405                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
  8406                                                                  ECSRIRTN
  8407     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  8408                                                                  ECSRIRTN
  8409     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
  8410                                                                  ECSRIRTN
  8411                                                                  ECSRIRTN
  8412 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
  8413                                                                  ECSRIRTN
  8414     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  8415         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8416                                                                  ECSRIRTN
  8417     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 172
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8418         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
  8419     ELSE                                                         ECSRIRTN
  8420         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
  8421                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
  8422                                                                  ECSRIRTN
  8423     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8424         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8425                                                                  ECSRIRTN
  8426     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8427         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
  8428             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  8429         ELSE                                                     ECSRIRTN
  8430             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
  8431     ELSE                                                         ECSRIRTN
  8432         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
  8433             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
  8434             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  8435         ELSE                                                     ECSRIRTN
  8436             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
  8437             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
  8438                                                                  ECSRIRTN
  8439                                                                  ECSRIRTN
  8440 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
  8441                                                                  ECSRIRTN
  8442     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8443         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
  8444                                                                  ECSRIRTN
  8445     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8446         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8447                                                                  ECSRIRTN
  8448     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8449         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
  8450                                                                  ECSRIRTN
  8451     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
  8452     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
  8453                                                                  ECSRIRTN
  8454     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
  8455             VARYING                                              ECSRIRTN
  8456         INC-SUB FROM +1 BY +1                                    ECSRIRTN
  8457             UNTIL                                                ECSRIRTN
  8458         INC-SUB GREATER THAN +5.                                 ECSRIRTN
  8459                                                                  ECSRIRTN
  8460     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8461         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
  8462     ELSE                                                         ECSRIRTN
  8463         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
  8464                                                                  ECSRIRTN
  8465 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
  8466                                                                  ECSRIRTN
  8467     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
  8468         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8469                                                                  ECSRIRTN
  8470     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8471       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
  8472           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
  8473                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
  8474               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  8475                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 173
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8476               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
  8477                                                                  ECSRIRTN
  8478     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8479       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
  8480           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  8481                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  8482           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
  8483                                                                  ECSRIRTN
  8484     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
  8485         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  8486                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  8487                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
  8488         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8489                                                                  ECSRIRTN
  8490     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  8491         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8492                                                                  ECSRIRTN
  8493     IF INC-SUB = +1                                              ECSRIRTN
  8494         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8495     IF INC-SUB = +2                                              ECSRIRTN
  8496         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8497     IF INC-SUB = +3                                              ECSRIRTN
  8498         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8499     IF INC-SUB = +4                                              ECSRIRTN
  8500         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8501     IF INC-SUB = +5                                              ECSRIRTN
  8502         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8503                                                                  ECSRIRTN
  8504     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  8505                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  8506                                                                  ECSRIRTN
  8507     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8508         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8509                                                                  ECSRIRTN
  8510     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
  8511              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
  8512         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
  8513     ELSE                                                         ECSRIRTN
  8514         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  8515                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  8516                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
  8517                                                                  ECSRIRTN
  8518 CHECK-DISABS-EXIT.                                               ECSRIRTN
  8519      EXIT.                                                       ECSRIRTN
  8520                                                                  ECSRIRTN
  8521 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
  8522                                                                  ECSRIRTN
  8523     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8524         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8525                                                                  ECSRIRTN
  8526     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8527         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  8528             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
  8529                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
  8530                                                                  ECSRIRTN
  8531     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8532         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  8533             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 174
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8534                                                                  ECSRIRTN
  8535 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
  8536                                                                  ECSRIRTN
  8537     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  8538         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
  8539         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
  8540             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
  8541                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  8542         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
  8543         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8544                                                                  ECSRIRTN
  8545     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8546         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
  8547                                                                  ECSRIRTN
  8548     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8549         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  8550             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
  8551                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  8552             ELSE                                                 ECSRIRTN
  8553                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
  8554         ELSE                                                     ECSRIRTN
  8555             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
  8556                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
  8557                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  8558             ELSE                                                 ECSRIRTN
  8559                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
  8560                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
  8561                                                                  ECSRIRTN
  8562     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8563         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8564                                                                  ECSRIRTN
  8565     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8566         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
  8567                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
  8568     ELSE                                                         ECSRIRTN
  8569         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
  8570             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  8571                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
  8572                                                                  ECSRIRTN
  8573     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8574         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  8575             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  8576                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
  8577                                                                  ECSRIRTN
  8578     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8579         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  8580             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  8581               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
  8582                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  8583                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  8584                  ELSE                                            ECSRIRTN
  8585                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
  8586                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  8587              ELSE                                                ECSRIRTN
  8588                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
  8589                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
  8590                     COMPUTE RWF-AHCLML =                         ECSRIRTN
  8591                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 175
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8592                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  8593                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
  8594                                                                  ECSRIRTN
  8595                                                                  ECSRIRTN
  8596     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
  8597        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
  8598                               '220000' OR '230000')              ECSRIRTN
  8599           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
  8600               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
  8601                                                                  ECSRIRTN
  8602     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  8603                                                                  ECSRIRTN
  8604     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
  8605                                                                  ECSRIRTN
  8606                                                                  ECSRIRTN
  8607 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
  8608                                                                  ECSRIRTN
  8609     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  8610         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8611                                                                  ECSRIRTN
  8612     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8613         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
  8614         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8615                                                                  ECSRIRTN
  8616     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  8617                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  8618                                                                  ECSRIRTN
  8619     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8620         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8621                                                                  ECSRIRTN
  8622     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  8623         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8624                                                                  ECSRIRTN
  8625     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
  8626                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  8627         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
  8628                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
  8629         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
  8630     ELSE                                                         ECSRIRTN
  8631         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
  8632         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
  8633                                                                  ECSRIRTN
  8634                                                                  ECSRIRTN
  8635 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
  8636                                                                  ECSRIRTN
  8637     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  8638         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8639                                                                  ECSRIRTN
  8640     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  8641         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8642                                                                  ECSRIRTN
  8643     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
  8644                                                                  ECSRIRTN
  8645 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
  8646                                                                  ECSRIRTN
  8647     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
  8648     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
  8649                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 176
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8650     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
  8651         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
  8652             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  8653                                                                  ECSRIRTN
  8654     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  8655     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  8656                                                                  ECSRIRTN
  8657     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  8658         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8659                                                                  ECSRIRTN
  8660     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  8661         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8662                                                                  ECSRIRTN
  8663 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
  8664                                                                  ECSRIRTN
  8665     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8666         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8667                                                                  ECSRIRTN
  8668     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8669                                                                  ECSRIRTN
  8670 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
  8671                                                                  ECSRIRTN
  8672     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
  8673     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
  8674                                                                  ECSRIRTN
  8675 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
  8676     EXIT.                                                        ECSRIRTN
  8677                                                                  ECSRIRTN
  8678 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
  8679                                                                  ECSRIRTN
  8680     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  8681         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
  8682                                                                  ECSRIRTN
  8683 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
  8684     EXIT.                                                        ECSRIRTN
  8685                                                                  ECSRIRTN
  8686                                                                  ECSRIRTN
  8687 CLEAR-REIN-HOLD.                                                 ECSRIRTN
  8688                                                                  ECSRIRTN
  8689     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
  8690     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
  8691     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
  8692     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
  8693                                                                  ECSRIRTN
  8694     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
  8695         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
  8696         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
  8697         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
  8698         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
  8699         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
  8700         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
  8701         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
  8702         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
  8703         REIN-AH-LIMIT (1).                                       ECSRIRTN
  8704                                                                  ECSRIRTN
  8705     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
  8706         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
  8707                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 177
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8708     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
  8709                                                                  ECSRIRTN
  8710 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
  8711                                                                  ECSRIRTN
  8712     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
  8713                                                                  ECSRIRTN
  8714 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
  8715     EXIT.                                                        ECSRIRTN
  8716                                                                  ECSRIRTN
  8717 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
  8718                                                                  ECSRIRTN
  8719     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
  8720                                                                  ECSRIRTN
  8721     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
  8722         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
  8723                                                                  ECSRIRTN
  8724     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8725         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
  8726             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
  8727                                                                  ECSRIRTN
  8728     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8729         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
  8730         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
  8731         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
  8732     ELSE                                                         ECSRIRTN
  8733         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
  8734         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
  8735         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
  8736                                                                  ECSRIRTN
  8737     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
  8738                                                                  ECSRIRTN
  8739     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
  8740        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
  8741         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
  8742                                                                  ECSRIRTN
  8743     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
  8744         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
  8745                                                                  ECSRIRTN
  8746 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
  8747     EXIT.                                                        ECSRIRTN
  8748                                                                  ECSRIRTN
  8749 REIN-FIND-CO-LOOP.                                               ECSRIRTN
  8750                                                                  ECSRIRTN
  8751     CONTINUE.                                                    ECSRIRTN
  8752*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
  8753 FIND-REI-CO-EXIT.                                                ECSRIRTN
  8754     EXIT.                                                        ECSRIRTN
  8755                                                                  ECSRIRTN
  8756 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
  8757                                                                  ECSRIRTN
  8758     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
  8759         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  8760                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  8761                                                                  ECSRIRTN
  8762     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
  8763         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  8764                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  8765                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 178
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8766     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
  8767                                                                  ECSRIRTN
  8768     START ERRTBL-IN                                              ECSRIRTN
  8769           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
  8770             INVALID KEY                                          ECSRIRTN
  8771               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
  8772                                                                  ECSRIRTN
  8773     MOVE 0 TO CO-SUB.                                            ECSRIRTN
  8774     MOVE 0 TO SUB1.                                              ECSRIRTN
  8775 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
  8776                                                                  ECSRIRTN
  8777     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
  8778                                                                  ECSRIRTN
  8779     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
  8780        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
  8781                                                                  ECSRIRTN
  8782     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
  8783        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
  8784        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
  8785                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8786        GO TO ABEND-PGM.                                          ECSRIRTN
  8787                                                                  ECSRIRTN
  8788     IF RE-CODE NOT = 'B'                                         ECSRIRTN
  8789        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
  8790                                                                  ECSRIRTN
  8791     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
  8792        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
  8793                                                                  ECSRIRTN
  8794     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
  8795        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
  8796                                                                  ECSRIRTN
  8797     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
  8798        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
  8799                                                                  ECSRIRTN
  8800     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
  8801        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8802                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
  8803        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 178)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8804                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
  8805        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 178)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8806                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
  8807     END-PERFORM.                                                 ECSRIRTN
  8808     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
  8809                                                                  ECSRIRTN
  8810     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  8811        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
  8812                                                                  ECSRIRTN
  8813     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  8814        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
  8815                                                                  ECSRIRTN
  8816     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  8817        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 179
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8818                                                                  ECSRIRTN
  8819     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  8820        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
  8821                                                                  ECSRIRTN
  8822     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
  8823        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
  8824        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
  8825        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
  8826        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
  8827        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
  8828        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
  8829          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
  8830                                                                  ECSRIRTN
  8831     ADD +1 TO CO-SUB.                                            ECSRIRTN
  8832                                                                  ECSRIRTN
  8833     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
  8834        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
  8835        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
  8836        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
  8837        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  8838                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8839        GO TO ABEND-PGM.                                          ECSRIRTN
  8840                                                                  ECSRIRTN
  8841     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
  8842                                                                  ECSRIRTN
  8843     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
  8844                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
  8845     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
  8846                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
  8847     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
  8848                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
  8849                                                                  ECSRIRTN
  8850     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
  8851         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
  8852     ELSE                                                         ECSRIRTN
  8853         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
  8854                                                                  ECSRIRTN
  8855     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
  8856     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
  8857     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
  8858     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
  8859                                                                  ECSRIRTN
  8860 REIN-CO-BUILD-EPR.                                               ECSRIRTN
  8861                                                                  ECSRIRTN
  8862     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  8863        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
  8864                                                                  ECSRIRTN
  8865     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
  8866        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
  8867                                                                  ECSRIRTN
  8868     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  8869        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
  8870                                                                  ECSRIRTN
  8871     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
  8872        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
  8873                                                                  ECSRIRTN
  8874     ADD +1 TO SUB1.                                              ECSRIRTN
  8875                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 180
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8876     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
  8877        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
  8878        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  8879                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8880        GO TO ABEND-PGM.                                          ECSRIRTN
  8881                                                                  ECSRIRTN
  8882     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
  8883     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
  8884     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
  8885     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
  8886     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
  8887     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
  8888     if re-state-exhibit-opt-f = 'Y'
  8889        move 'Y'         to rc2-ecs152-rpt (sub1)
  8890     else
  8891        move 'N'         to rc2-ecs152-rpt (sub1)
  8892     end-if
  8893                                                                  ECSRIRTN
  8894     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
  8895                                                                  ECSRIRTN
  8896 REIN-BUILD-EXIT.                                                 ECSRIRTN
  8897     EXIT.                                                        ECSRIRTN
  8898                                                                  ECSRIRTN
  8899 ZERO-RCT-ENTRIES.                                                ECSRIRTN
  8900                                                                  ECSRIRTN
  8901     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
  8902                                                                  ECSRIRTN
  8903     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
  8904                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
  8905                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
  8906                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
  8907                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
  8908                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
  8909                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
  8910                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
  8911                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
  8912                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
  8913                                                                  ECSRIRTN
  8914 ZERO-RCT-EXIT.                                                   ECSRIRTN
  8915     EXIT.                                                        ECSRIRTN
  8916                                                                  ECSRIRTN
  8917 ZERO-RC2-ENTRIES.                                                ECSRIRTN
  8918                                                                  ECSRIRTN
  8919     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
  8920                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
  8921     move spaces      to rc2-ecs152-rpt (co-sub)
  8922                                                                  ECSRIRTN
  8923     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
  8924                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
  8925                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
  8926                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
  8927                                                                  ECSRIRTN
  8928 ZERO-RC2-EXIT.                                                   ECSRIRTN
  8929     EXIT.                                                        ECSRIRTN
  8930******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 181
* ECS150.cbl
  8932
  8933 REM-TRM-RTN.
  8934     SUBTRACT BGN-YR FROM END-YR GIVING REM-TRM1.
  8935
  8936     IF REM-TRM1 < 0
  8937       ADD 100 TO REM-TRM1.
  8938
  8939     MULTIPLY +12 BY REM-TRM1.
  8940     SUBTRACT BGN-MO FROM END-MO GIVING TEM-TRM1.
  8941     ADD TEM-TRM1 TO REM-TRM1.
  8942
  8943     IF DTE-REM-TRM = '2'
  8944         GO TO REM-TRM-2.
  8945
  8946     SUBTRACT BGN-DA FROM END-DA GIVING TEM-TRM1.
  8947
  8948     IF TEM-TRM1 = ZERO
  8949         GO TO REM-TRM-1.
  8950
  8951     IF TEM-TRM1 IS LESS THAN -15
  8952         SUBTRACT +1 FROM REM-TRM1
  8953         GO TO REM-TRM-1.
  8954
  8955     IF TEM-TRM1 IS GREATER THAN +15
  8956         ADD +1 TO REM-TRM1
  8957         GO TO REM-TRM-0.
  8958
  8959     IF TEM-TRM1 IS GREATER THAN ZERO
  8960         GO TO REM-TRM-1.
  8961
  8962 REM-TRM-0.
  8963     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM1.
  8964     ADD +1   REM-TRM1 GIVING REM-TRM2.
  8965     GO TO REM-TRMX.
  8966
  8967 REM-TRM-1.
  8968     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM1.
  8969     MOVE REM-TRM1               TO REM-TRM2.
  8970     GO TO REM-TRMX.
  8971
  8972 REM-TRM-2.
  8973     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM2.
  8974     MOVE REM-TRM2               TO REM-TRM1.
  8975     IF REM-TRM2 NOT = +0
  8976         COMPUTE REM-TRM1 = REM-TRM2 - +.5.
  8977
  8978 REM-TRMX.
  8979     EXIT.
  8980
  8981 6000-EXIT.
  8982     EXIT.
  8983
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 182
* ECS150.cbl
  8985 7000-LEVEL-BREAK-PROCESSING SECTION 40.
  8986
  8987 7100-REINS-CO-BREAK.
  8988     PERFORM 7200-CARRIER-BREAK THRU 7200-EXIT.
  8989     MOVE 1                      TO CL.
  8990     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  8991     MOVE 19                     TO ER-REC-TYPE.
  8992     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  8993     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  8994     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  8995
  8996 7100-EXIT.
  8997     EXIT.
  8998
  8999 7200-CARRIER-BREAK.
  9000     PERFORM 7300-COMPANY-BREAK THRU 7300-EXIT.
  9001     MOVE +2                     TO CL.
  9002     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9003     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9004     MOVE 18                     TO ER-REC-TYPE
  9005     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9006     MOVE LAST-CARRIER           TO ER-CARRIER.
  9007     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9008     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9009
  9010 7200-EXIT.
  9011     EXIT.
  9012
  9013 7300-COMPANY-BREAK.
  9014     PERFORM 7400-STATE-BREAK THRU 7400-EXIT.
  9015     MOVE +3                     TO CL.
  9016     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9017     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9018     MOVE 17                     TO ER-REC-TYPE.
  9019     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9020     MOVE LAST-CARRIER           TO ER-CARRIER.
  9021     MOVE LAST-GROUPING          TO ER-COMPANY.
  9022     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9023     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9024
  9025 7300-EXIT.
  9026     EXIT.
  9027
  9028 7400-STATE-BREAK.
  9029     PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT.
  9030
  9031     IF FIRST-INS-PASS
  9032         GO TO 7450-STATE-BREAK-2.
  9033
  9034     MOVE +4                     TO CL.
  9035     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9036     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9037     MOVE 16                     TO ER-REC-TYPE.
  9038     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9039     MOVE LAST-GROUPING          TO ER-COMPANY.
  9040     MOVE LAST-CARRIER           TO ER-CARRIER.
  9041     MOVE LAST-STATE             TO ER-STATE.
  9042     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 183
* ECS150.cbl
  9043     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9044     MOVE LOW-VALUES             TO ER-SORT-KEY
  9045     MOVE 20                     TO ER-REC-TYPE
  9046     MOVE LAST-REINS-CO          TO ER-REINS-CO
  9047     MOVE LAST-CARRIER           TO ER-CARRIER
  9048     MOVE LAST-GROUPING          TO ER-COMPANY
  9049     MOVE LAST-STATE             TO ER-STATE
  9050     WRITE CLAS150-EXTRACT-RECORD-C FROM CLAS150-EXTRACT-RECORD.
  9051     GO TO 7400-EXIT.
  9052
  9053 7450-STATE-BREAK-2.
  9054     MOVE +1                     TO CL.
  9055     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9056     MOVE 11                     TO ER-REC-TYPE.
  9057     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9058
  9059     MOVE 09                     TO ER-REC-TYPE.
  9060     MOVE LAST-CARRIER           TO ER-CARRIER.
  9061     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9062
  9063     MOVE 07                     TO ER-REC-TYPE.
  9064     MOVE LAST-STATE             TO ER-STATE.
  9065     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9066
  9067     MOVE 05                     TO ER-REC-TYPE.
  9068     MOVE HIGH-VALUE             TO ER-STATE.
  9069     MOVE LAST-GROUPING          TO ER-COMPANY.
  9070     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9071
  9072     MOVE LAST-STATE             TO ER-STATE.
  9073     MOVE 03                     TO ER-REC-TYPE.
  9074     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9075
  9076     MOVE HIGH-VALUES            TO ER-CONTROL.
  9077     MOVE LAST-STATE             TO ER-ST-SEQ.
  9078     MOVE 13 TO                  ER-REC-TYPE.
  9079     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9080
  9081     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9082     MOVE +3                     TO CL.
  9083     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9084     MOVE 12                     TO ER-REC-TYPE.
  9085     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9086
  9087     MOVE 10                     TO ER-REC-TYPE.
  9088     MOVE LAST-CARRIER           TO ER-CARRIER
  9089     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9090
  9091     MOVE 08                     TO ER-REC-TYPE.
  9092     MOVE LAST-STATE             TO ER-STATE.
  9093     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9094
  9095     MOVE 06                     TO ER-REC-TYPE.
  9096     MOVE HIGH-VALUE             TO ER-STATE.
  9097     MOVE LAST-GROUPING          TO ER-COMPANY.
  9098     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9099
  9100     MOVE 04                     TO ER-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 184
* ECS150.cbl
  9101     MOVE LAST-STATE             TO ER-STATE.
  9102     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9103
  9104     MOVE HIGH-VALUES            TO ER-CONTROL
  9105     MOVE LAST-STATE             TO ER-ST-SEQ.
  9106     MOVE 14                     TO ER-REC-TYPE.
  9107     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9108
  9109     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9110
  9111 7400-EXIT.
  9112     EXIT.
  9113
  9114 7460-WRITE-ST-EXTRACT.
  9115     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9116
  9117 7460-EXIT.
  9118     EXIT.
  9119
  9120 7500-ACCOUNT-BREAK.
  9121     COMPUTE TERM-WORK = PERIOD-END-9 - PERIOD-START-9.
  9122
  9123     PERFORM 7505-ADJ-OB-TOTS THRU 7505-EXIT
  9124         VARYING TG FROM 1 BY 1
  9125             UNTIL TG GREATER +3.
  9126
  9127     GO TO 7510-ACCT-REIN-BREAK.
  9128
  9129 7505-ADJ-OB-TOTS.
  9130     IF REINSURANCE-PASS
  9131         MOVE +5                 TO CL
  9132         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT
  9133     ELSE
  9134         MOVE +2                 TO CL
  9135         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT
  9136         MOVE +4                 TO CL
  9137         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT.
  9138
  9139 7505-EXIT.
  9140     EXIT.
  9141
  9142 7507-OB-DIVIDE.
  9143*    IF ISSUE-AMT (CL  TG  3) NOT = 0
  9144*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  3)
  9145*        MOVE +1                 TO ISSUE-CNT (CL  TG  3).
  9146*
  9147*    IF ISSUE-AMT (CL  TG  8) NOT = 0
  9148*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  8)
  9149*        MOVE +1                 TO ISSUE-CNT (CL  TG  8).
  9150*
  9151*    IF ISSUE-AMT (CL  TG  5) NOT = 0
  9152*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  5)
  9153*        MOVE +1                 TO ISSUE-CNT (CL  TG  5).
  9154*
  9155*    IF ISSUE-AMT (CL  TG  10) NOT = 0
  9156*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  10)
  9157*        MOVE +1                 TO ISSUE-CNT (CL  TG  10).
  9158
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 185
* ECS150.cbl
  9159 7507-EXIT.
  9160     EXIT.
  9161
  9162 7510-ACCT-REIN-BREAK.
  9163     IF FIRST-INS-PASS
  9164         GO TO 7550-ACCNT-BREAK-2.
  9165
  9166     MOVE +5                     TO CL.
  9167     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9168     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9169     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9170     MOVE 15                     TO ER-REC-TYPE.
  9171     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9172
  9173     IF DTE-PGM-OPT = 1
  9174         PERFORM 5200-PRINT-SUMMARY-TOTALS THRU 5200-EXIT.
  9175
  9176     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9177     GO TO 7500-EXIT.
  9178
  9179 7550-ACCNT-BREAK-2.
  9180     MOVE +2                     TO CL.
  9181     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9182     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9183     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9184     MOVE 01                     TO ER-REC-TYPE.
  9185     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9186
  9187     MOVE +4                     TO CL.
  9188     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9189     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9190     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9191     MOVE 02                     TO ER-REC-TYPE.
  9192     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9193
  9194     IF DTE-PGM-OPT = 1
  9195         PERFORM 5200-PRINT-SUMMARY-TOTALS THRU 5200-EXIT.
  9196     MOVE +4                     TO CL.
  9197     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9198     MOVE +2                     TO CL.
  9199     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9200
  9201 7500-EXIT.
  9202     EXIT.
  9203
  9204 7900-ROLL-TOTALS.
  9205     COMPUTE CLX = CL - 1.
  9206     ADD CORRESPONDING A-CONTROL-LEVELS (CL) TO
  9207                       A-CONTROL-LEVELS (CLX).
  9208     PERFORM 7910-TERM-LOOP THRU 7910-EXIT
  9209         VARYING TG FROM +1 BY +1
  9210             UNTIL TG GREATER +3.
  9211
  9212 7900-EXIT.
  9213     EXIT.
  9214
  9215 7910-TERM-LOOP.
  9216     PERFORM 7920-ROLL-ACTIVITY THRU 7920-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 186
* ECS150.cbl
  9217         VARYING IY FROM +1 BY +1
  9218             UNTIL IY GREATER +10.
  9219     PERFORM 7930-ROLL-EXHIBIT THRU 7930-EXIT
  9220         VARYING EG FROM +1 BY +1
  9221             UNTIL EG GREATER +9.
  9222
  9223 7910-EXIT.
  9224     EXIT.
  9225
  9226 7920-ROLL-ACTIVITY.
  9227     ADD CORRESPONDING INSURANCE-TYPES (CL  TG  IY) TO
  9228                       INSURANCE-TYPES (CLX  TG  IY).
  9229
  9230 7920-EXIT.
  9231     EXIT.
  9232
  9233 7930-ROLL-EXHIBIT.
  9234     ADD CORRESPONDING EXHIBIT-GROUPS (CL  TG  EG) TO
  9235                       EXHIBIT-GROUPS (CLX  TG  EG).
  9236
  9237 7930-EXIT.
  9238     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 187
* ECS150.cbl
  9240 8000-MISCELANEOUS-ROUTINES  SECTION 32.
  9241
  9242 8100-CLEAR-TABLES.
  9243     MOVE ZERO                   TO AH-PAID-THIS-YR (CL)
  9244                                    AH-PAID-LAST-YR (CL).
  9245
  9246     PERFORM 8110-ZERO-TERM-GROUPS THRU 8110-EXIT
  9247         VARYING TG FROM +1 BY +1
  9248             UNTIL TG GREATER THAN 3.
  9249
  9250 8100-EXIT.
  9251     EXIT.
  9252
  9253 8110-ZERO-TERM-GROUPS.
  9254     PERFORM 8120-ZERO-ACTIVITY THRU 8120-EXIT
  9255         VARYING IY FROM +1 BY +1
  9256             UNTIL IY GREATER +10.
  9257
  9258     PERFORM 8130-ZERO-EXHIBIT THRU 8130-EXIT
  9259         VARYING EG FROM +1 BY +1
  9260             UNTIL EG GREATER +9.
  9261
  9262 8110-EXIT.
  9263     EXIT.
  9264
  9265 8120-ZERO-ACTIVITY.
  9266     MOVE ZERO                  TO ISSUE-CNT   (CL  TG  IY)
  9267                                   ISSUE-AMT   (CL  TG  IY)
  9268                                   ISSUE-PREM  (CL  TG  IY)
  9269                                   CANCEL-CNT  (CL  TG  IY)
  9270                                   CANCEL-PREM (CL  TG  IY)
  9271                                   CANCEL-AMT  (CL  TG  IY)
  9272                                   CLAIM-CNT   (CL  TG  IY)
  9273                                   CLAIM-AMT   (CL  TG  IY)
  9274                                   EARN-PREM   (CL  TG  IY).
  9275
  9276 8120-EXIT.
  9277     EXIT.
  9278
  9279 8130-ZERO-EXHIBIT.
  9280     MOVE ZERO                  TO GROUP-CNT (CL  TG  EG)
  9281                                   GROUP-AMT (CL  TG  EG)
  9282                                   IND-CNT   (CL  TG  EG)
  9283                                   IND-AMT   (CL  TG  EG).
  9284
  9285 8130-EXIT.
  9286     EXIT.
  9287
  9288 8200-RECORD-SETUP.
  9289     MOVE LOW-VALUES             TO ER-SORT-KEY.
  9290     MOVE RUN-DATE               TO ER-PERIOD-START.
  9291     MOVE EP-DT                  TO ER-PERIOD-END.
  9292     MOVE CONTROL-LEVELS (CL)    TO ER-ACTIVITY-TOTALS.
  9293     MOVE E-CONTROL-LEVELS (CL)  TO ER-EXHIBIT-TOTALS.
  9294     MOVE AH-PAID-THIS-YR (CL)   TO ER-AH-PD-THIS.
  9295     MOVE AH-PAID-LAST-YR (CL)   TO ER-AH-PD-LAST.
  9296     MOVE HIGH-VALUES            TO ER-CONTROL.
  9297
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 188
* ECS150.cbl
  9298 8200-EXIT.
  9299     EXIT.
  9300
  9301 8300-STARTING-INFORCE.
  9302
  9303     IF CR-LFAMT-ALT NOT NUMERIC
  9304         MOVE ZEROS TO CR-LFAMT-ALT.
  9305
  9306     IF CR-ENTRY-STATUS = '3' OR '5'
  9307         MOVE ZERO               TO INFORCE-DOLLARS
  9308         GO TO 8300-EXIT.
  9309
  9310     IF SUMMARY-REC
  9311         NEXT SENTENCE
  9312       ELSE
  9313          MOVE CR-LFAMT          TO INFORCE-DOLLARS.
  9314
  9315     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  9316         GO TO 8390-OB-ADJ.
  9317
  9318     MOVE CR-CC                  TO WS-CR-CCYY (1:2).
  9319     MOVE CR-YR                  TO WS-CR-CCYY (3:2).
  9320
  9321     COMPUTE VALUATION-DATE = CR-LF-TERM -
  9322       (((RUN-CCYY * 12) + RUN-MO) -
  9323                            ((WS-CR-CCYY * 12) + CR-MO)).
  9324
  9325     MOVE SAVE-REM-TERM              TO UNEXPIRED-MONTHS.
  9326     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  9327
  9328     IF SAVE-REM-TERM  = CR-LF-TERM
  9329         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9330         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9331             ADD CR-LFAMT-ALT      TO INFORCE-DOLLARS
  9332             GO TO 8300-EXIT
  9333         ELSE
  9334             GO TO 8300-EXIT.
  9335
  9336     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  9337         IF LF-BAL-REMTRM NOT GREATER THAN ZERO
  9338             MOVE ZEROS TO INFORCE-DOLLARS
  9339             GO TO 8300-EXIT.
  9340
  9341
  9342     if dte-client = 'AHL'
  9343        if cr-loan-term = zeros
  9344           move cr-lf-term       to cr-loan-term
  9345        end-if
  9346     end-if
  9347
  9348     IF SUMMARY-REC
  9349        COMPUTE TEMP-RESULT-L ROUNDED =
  9350                         INFORCE-DOLLARS / CR-LF-TERM
  9351     ELSE
  9352        if dte-client = 'AHL'
  9353           compute temp-result-l rounded =
  9354              cr-lfamt / cr-loan-term
  9355           compute unexpired-months = unexpired-months +
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 189
* ECS150.cbl
  9356              (cr-loan-term - cr-lf-term)
  9357        else
  9358           COMPUTE TEMP-RESULT-L ROUNDED =
  9359                         CR-LFAMT / CR-LF-TERM
  9360        end-if
  9361     end-if
  9362
  9363     IF REINSURANCE-PASS OR REINSURANCE-REC
  9364        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9365            COMPUTE TEMP-RESULT-L ROUNDED  =
  9366            (RC-ORIG-LFAMT * RC-CEDE-FACT) / CR-LF-TERM.
  9367
  9368     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  9369         GO TO 8310-TEXAS-INFORCE.
  9370
  9371     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  9372         GO TO 8320-NET-PAY-INFORCE.
  9373
  9374     IF DTE-CLIENT EQUAL 'FLU'
  9375         GO TO 8325-FLU-INFORCE.
  9376
  9377     IF CR-LFTYP = 'QD'
  9378        MOVE +15.0               TO CR-APR
  9379        GO TO 8320-NET-PAY-INFORCE
  9380     END-IF
  9381
  9382*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  9383     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  9384        (CR-RATING-CLASS NOT = 'L ')
  9385         IF (CR-DT GREATER THAN 19831031) AND
  9386            (CR-LF-TERM GREATER THAN +60)  AND
  9387            (CR-APR GREATER THAN ZERO)
  9388             GO TO 8320-NET-PAY-INFORCE.
  9389
  9390     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  9391         IF (CR-DT GREATER THAN 19830318) AND
  9392            (CR-LF-TERM GREATER THAN +61)  AND
  9393            (CR-APR GREATER THAN ZERO)
  9394             GO TO 8320-NET-PAY-INFORCE.
  9395
  9396     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  9397         IF (CR-DT GREATER THAN 19810831) AND
  9398            (CR-DT LESS THAN 19830901) AND
  9399            (CR-LF-TERM GREATER THAN +62)  AND
  9400            (CR-APR GREATER THAN ZERO)
  9401             GO TO 8320-NET-PAY-INFORCE.
  9402
  9403     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  9404         IF (CR-DT GREATER THAN 19831231) AND
  9405            (CR-LF-TERM GREATER THAN +60)  AND
  9406            (CR-APR GREATER THAN ZERO)
  9407             GO TO 8320-NET-PAY-INFORCE.
  9408
  9409 8305-REG-INFORCE.
  9410
  9411     COMPUTE INFORCE-DOLLARS ROUNDED =
  9412         (TEMP-RESULT-L * UNEXPIRED-MONTHS) + CR-LFAMT-ALT.
  9413
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 190
* ECS150.cbl
  9414     IF REINSURANCE-PASS OR REINSURANCE-REC
  9415        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9416         COMPUTE INFORCE-DOLLARS ROUNDED =
  9417          (TEMP-RESULT-L * UNEXPIRED-MONTHS) +
  9418          (CR-LFAMT-ALT * RC-CEDE-FACT).
  9419
  9420     GO TO 8390-OB-ADJ.
  9421
  9422 8310-TEXAS-INFORCE.
  9423     DIVIDE CR-LFAMT  BY  CR-LF-TERM
  9424         GIVING TEX-FACT-1.
  9425
  9426     DIVIDE UNEXPIRED-MONTHS  BY  CR-PMT-FREQ
  9427         GIVING TEX-FACT-2
  9428         REMAINDER TEX-FACT-3.
  9429
  9430     IF TEX-FACT-3 NOT ZERO
  9431         ADD +1 TO TEX-FACT-2.
  9432
  9433     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  9434         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9435     ELSE
  9436         COMPUTE INFORCE-DOLLARS ROUNDED =
  9437             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  9438
  9439     GO TO 8390-OB-ADJ.
  9440
  9441 8320-NET-PAY-INFORCE.
  9442
  9443     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9444     MOVE 'L'                    TO  DC-OPTION-CODE.
  9445     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9446             8599-DATE-CONVERT-X
  9447
  9448     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9449
  9450     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  9451         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  9452         MOVE '3'                TO  DC-OPTION-CODE
  9453         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9454                 8599-DATE-CONVERT-X
  9455         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  9456     ELSE
  9457         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  9458         MOVE +1                 TO  DC-ELAPSED-MONTHS
  9459         MOVE +0                 TO  DC-ELAPSED-DAYS
  9460         MOVE '6'                TO  DC-OPTION-CODE
  9461         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9462             8599-DATE-CONVERT-X
  9463         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  9464
  9465     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  9466     MOVE CR-APR                 TO  CP-LOAN-APR.
  9467     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  9468     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9469     MOVE SAVE-REM-TERM          TO  CP-REMAINING-TERM.
  9470     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  9471     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 191
* ECS150.cbl
  9472     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  9473     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  9474
  9475     if dte-client = 'AHL'
  9476        move +14                 to cp-loan-apr
  9477     end-if
  9478
  9479     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  9480
  9481     IF SUMMARY-REC
  9482         COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9483                                      (INFORCE-DOLLARS / +1000)
  9484         GO TO 8390-OB-ADJ.
  9485
  9486     IF CP-STATE-STD-ABBRV = 'NC'
  9487               AND
  9488*      DTE-CLIENT NOT = 'WDS'
  9489       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  9490         IF CP-CERT-EFF-DT GREATER THAN WS-931231
  9491             MOVE CP-REMAINING-AMT TO  INFORCE-DOLLARS
  9492             GO TO 8390-OB-ADJ.
  9493
  9494      COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9495                                      (CR-LFAMT / +1000).
  9496     move cp-remaining-amt       to inforce-dollars
  9497
  9498     GO TO 8390-OB-ADJ.
  9499
  9500 8325-FLU-INFORCE.
  9501     MOVE CR-APR                 TO NP-APR.
  9502     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  9503     COMPUTE NP251-REM = CR-LF-TERM - TERM-WORK.
  9504     MOVE '1'                    TO NP-OPT.
  9505     MOVE CR-AHPRM               TO NP-AHPRM.
  9506     MOVE CR-ACCOUNT             TO NP-ACCOUNT.
  9507     MOVE CR-DT                  TO NP-EFF-DT.
  9508     MOVE CR-LFAMT               TO NP-BENEFIT.
  9509***  CALL 'IBKE251B'
  9510***      USING NP-ACCOUNT NP-EFF-DT NP-BENEFIT NP-AHPRM NP251-REM
  9511***            NP251-ORIG NP-SUB NP-REMAINING.
  9512     MOVE NP-REMAINING           TO INFORCE-DOLLARS.
  9513     GO TO 8390-OB-ADJ.
  9514
  9515 8350-ENDING-INFORCE.
  9516     IF CR-LFAMT-ALT NOT NUMERIC
  9517         MOVE ZEROS TO CR-LFAMT-ALT.
  9518
  9519     IF CR-ENTRY-STATUS = '3' OR '5'
  9520         MOVE ZERO               TO INFORCE-DOLLARS
  9521         GO TO 8300-EXIT.
  9522
  9523     IF SUMMARY-REC
  9524         NEXT SENTENCE
  9525       ELSE
  9526          MOVE CR-LFAMT          TO INFORCE-DOLLARS.
  9527
  9528     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  9529         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 192
* ECS150.cbl
  9530             ADD CR-LFAMT-ALT    TO INFORCE-DOLLARS
  9531             GO TO 8390-OB-ADJ
  9532         ELSE
  9533             GO TO 8390-OB-ADJ.
  9534
  9535     MOVE CP-REMAINING-TERM-2        TO UNEXPIRED-MONTHS.
  9536     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  9537
  9538     IF CP-REMAINING-TERM-2 = CR-LF-TERM
  9539         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9540         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9541            IF REINSURANCE-PASS OR REINSURANCE-REC
  9542                NEXT SENTENCE
  9543            ELSE
  9544                ADD CR-LFAMT-ALT    TO INFORCE-DOLLARS
  9545                GO TO 8390-OB-ADJ
  9546         ELSE
  9547             GO TO 8300-EXIT.
  9548
  9549     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  9550         IF LF-BAL-REMTRM NOT GREATER THAN ZERO
  9551             MOVE ZEROS TO INFORCE-DOLLARS
  9552             GO TO 8300-EXIT.
  9553
  9554     MOVE CR-CC                  TO WS-CR-CCYY (1:2).
  9555     MOVE CR-YR                  TO WS-CR-CCYY (3:2).
  9556     COMPUTE VALUATION-DATE = CR-LF-TERM -
  9557        (((EP-CCYY * 12) + EP-MO)
  9558                    - ((WS-CR-CCYY * 12) + CR-MO)).
  9559
  9560     if dte-client = 'AHL'
  9561        if cr-loan-term = zeros
  9562           move cr-lf-term       to cr-loan-term
  9563        end-if
  9564     end-if
  9565
  9566     IF SUMMARY-REC
  9567         COMPUTE TEMP-RESULT-L ROUNDED =
  9568                           INFORCE-DOLLARS / CR-LF-TERM
  9569     ELSE
  9570        if dte-client = 'AHL'
  9571           compute temp-result-l rounded =
  9572              cr-lfamt / cr-loan-term
  9573           compute unexpired-months = unexpired-months +
  9574              (cr-loan-term - cr-lf-term)
  9575        else
  9576           COMPUTE TEMP-RESULT-L ROUNDED =
  9577              CR-LFAMT / CR-LF-TERM
  9578        end-if
  9579     end-if
  9580
  9581     IF REINSURANCE-PASS OR REINSURANCE-REC
  9582        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9583         COMPUTE TEMP-RESULT-L ROUNDED =
  9584          (RC-ORIG-LFAMT * RC-CEDE-FACT) / CR-LF-TERM.
  9585
  9586     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9587         GO TO 8355-NORMAL-ENDING.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 193
* ECS150.cbl
  9588
  9589     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  9590         GO TO 8360-TEXAS-ENDING.
  9591
  9592     IF DTE-CLIENT = 'NCL'
  9593       IF CR-DT LESS 19910101
  9594         GO TO 8355-NORMAL-ENDING.
  9595
  9596     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  9597         GO TO 8370-NET-PAY-ENDING.
  9598
  9599     IF DTE-CLIENT = 'FLU'
  9600         GO TO 8375-FLU-ENDING.
  9601
  9602     IF CR-LFTYP = 'QD'
  9603        MOVE +15.0               TO CR-APR
  9604        GO TO 8370-NET-PAY-ENDING
  9605     END-IF
  9606
  9607*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  9608     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  9609        (CR-RATING-CLASS NOT = 'L ')
  9610         IF (CR-DT GREATER THAN 19831031) AND
  9611            (CR-LF-TERM GREATER THAN +60) AND
  9612            (CR-APR GREATER THAN ZERO)
  9613             GO TO 8370-NET-PAY-ENDING.
  9614
  9615     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  9616         IF (CR-DT GREATER THAN 19830318) AND
  9617            (CR-LF-TERM GREATER THAN +61) AND
  9618            (CR-APR GREATER THAN ZERO)
  9619             GO TO 8370-NET-PAY-ENDING.
  9620
  9621     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  9622         IF (CR-DT GREATER THAN 19810831 ) AND
  9623            (CR-DT LESS THAN 19830901 ) AND
  9624            (CR-LF-TERM GREATER THAN +62) AND
  9625            (CR-APR GREATER THAN ZERO)
  9626             GO TO 8370-NET-PAY-ENDING.
  9627
  9628     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  9629         IF (CR-DT GREATER THAN 19831231) AND
  9630            (CR-LF-TERM GREATER THAN +60) AND
  9631            (CR-APR GREATER THAN ZERO)
  9632             GO TO 8370-NET-PAY-ENDING.
  9633
  9634 8355-NORMAL-ENDING.
  9635
  9636     COMPUTE INFORCE-DOLLARS ROUNDED =
  9637        (TEMP-RESULT-L * UNEXPIRED-MONTHS) + CR-LFAMT-ALT.
  9638
  9639     IF REINSURANCE-PASS OR REINSURANCE-REC
  9640         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9641          COMPUTE INFORCE-DOLLARS ROUNDED =
  9642          (TEMP-RESULT-L * UNEXPIRED-MONTHS) +
  9643          (CR-LFAMT-ALT * RC-CEDE-FACT).
  9644
  9645     GO TO 8390-OB-ADJ.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 194
* ECS150.cbl
  9646
  9647 8360-TEXAS-ENDING.
  9648     DIVIDE CR-LFAMT  BY  CR-LF-TERM
  9649         GIVING TEX-FACT-1.
  9650     DIVIDE UNEXPIRED-MONTHS  BY  CR-PMT-FREQ
  9651         GIVING TEX-FACT-2
  9652         REMAINDER TEX-FACT-3.
  9653     IF TEX-FACT-3 NOT ZERO
  9654         ADD +1 TO TEX-FACT-2.
  9655     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  9656         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9657     ELSE
  9658         COMPUTE INFORCE-DOLLARS ROUNDED =
  9659             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  9660
  9661****************************************************************
  9662*    DIVIDE VALUATION-DATE BY CR-PMT-FREQ
  9663*        GIVING TEX-FACT-2
  9664*            REMAINDER TEX-FACT-3.
  9665*    IF TEX-FACT-3 NOT = ZERO
  9666*        ADD +1 TO TEX-FACT-2.
  9667*    COMPUTE INFORCE-DOLLARS =
  9668*         (TEMP-RESULT-L * (TEX-FACT-2 * CR-PMT-FREQ)).
  9669
  9670     GO TO 8390-OB-ADJ.
  9671
  9672 8370-NET-PAY-ENDING.
  9673
  9674     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9675     MOVE 'L'                    TO  DC-OPTION-CODE.
  9676     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9677             8599-DATE-CONVERT-X.
  9678     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9679
  9680     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  9681         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  9682         MOVE '3'                TO  DC-OPTION-CODE
  9683         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9684                 8599-DATE-CONVERT-X
  9685         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  9686     ELSE
  9687         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  9688         MOVE +1                 TO  DC-ELAPSED-MONTHS
  9689         MOVE +0                 TO  DC-ELAPSED-DAYS
  9690         MOVE '6'                TO  DC-OPTION-CODE
  9691         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9692                 8599-DATE-CONVERT-X
  9693         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  9694
  9695     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  9696     MOVE CR-APR                 TO  CP-LOAN-APR.
  9697     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  9698     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9699     MOVE CP-REMAINING-TERM-2    TO  CP-REMAINING-TERM.
  9700     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  9701     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  9702     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  9703     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 195
* ECS150.cbl
  9704
  9705
  9706     if dte-client = 'AHL'
  9707        move +14                 to cp-loan-apr
  9708     end-if
  9709
  9710     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  9711
  9712     IF SUMMARY-REC
  9713         COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9714                                      (INFORCE-DOLLARS / +1000)
  9715         GO TO 8390-OB-ADJ.
  9716
  9717     IF CP-STATE-STD-ABBRV = 'NC'
  9718               AND
  9719*      DTE-CLIENT NOT = 'WDS'
  9720       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  9721         IF CP-CERT-EFF-DT GREATER THAN WS-931231
  9722             MOVE CP-REMAINING-AMT TO INFORCE-DOLLARS
  9723             GO TO 8390-OB-ADJ.
  9724
  9725      COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9726                                      (CR-LFAMT / +1000).
  9727     move cp-remaining-amt       to inforce-dollars
  9728
  9729     GO TO 8390-OB-ADJ.
  9730
  9731 8375-FLU-ENDING.
  9732     MOVE CR-APR                 TO NP-APR.
  9733     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  9734     COMPUTE NP251-REM = CR-LF-TERM - TERM-WORK.
  9735     MOVE '1'                    TO NP-OPT.
  9736     MOVE CR-AHPRM               TO NP-AHPRM.
  9737     MOVE CR-ACCOUNT             TO NP-ACCOUNT.
  9738     MOVE CR-DT                  TO NP-EFF-DT.
  9739     MOVE CR-LFAMT               TO NP-BENEFIT.
  9740***  CALL 'IBKE251B'
  9741***      USING NP-ACCOUNT NP-EFF-DT NP-BENEFIT NP-AHPRM NP251-REM
  9742***            NP251-ORIG NP-SUB NP-REMAINING.
  9743     MOVE NP-REMAINING           TO INFORCE-DOLLARS.
  9744     GO TO 8390-OB-ADJ.
  9745
  9746 8390-OB-ADJ.
  9747     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9748         MOVE ZERO               TO INFORCE-DOLLARS.
  9749
  9750 8300-EXIT.
  9751     EXIT.
  9752
  9753 8400-ADD-TO-EXHIBIT.
  9754     IF GROUP-INS
  9755         ADD COUNT-WORK      TO GROUP-CNT (CL  TG  EG)
  9756         ADD INFORCE-DOLLARS TO GROUP-AMT (CL  TG  EG)
  9757     ELSE
  9758         ADD COUNT-WORK      TO IND-CNT (CL  TG  EG)
  9759         ADD INFORCE-DOLLARS TO IND-AMT (CL  TG  EG).
  9760
  9761 8400-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 196
* ECS150.cbl
  9762     EXIT.
  9763
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 197
* ECS150.cbl
  9765 8450-RE-RATE-ROUTINE.
  9766
  9767     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9768     MOVE 'L'                    TO  DC-OPTION-CODE.
  9769     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  9770     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9771     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO  CP-BENEFIT-TYPE.
  9772     MOVE SPACES                 TO  CP-ACCT-FLD-5.
  9773     MOVE DTE-CLIENT             TO  CP-COMPANY-ID.
  9774     MOVE STATE-SUB (CLAS-INDEXS)    TO  CP-STATE.
  9775     MOVE STATE-ABBR (CLAS-INDEXS)   TO  CP-STATE-STD-ABBRV.
  9776
  9777     IF CR-AGE IS NOT NUMERIC
  9778         MOVE ZEROS              TO  CP-ISSUE-AGE
  9779     ELSE
  9780         MOVE CR-AGE             TO  CP-ISSUE-AGE.
  9781
  9782     MOVE CP-REMAINING-TERM-1    TO  CP-ORIGINAL-TERM.
  9783     MOVE CR-AHAMT               TO  CP-ORIGINAL-BENEFIT
  9784                                     CP-RATING-BENEFIT-AMT.
  9785
  9786     IF CP-STATE-STD-ABBRV = 'OR'
  9787         COMPUTE CP-RATING-BENEFIT-AMT =
  9788                                CR-AHAMT * CP-REMAINING-TERM-1.
  9789
  9790     MOVE CR-APR                 TO  CP-LOAN-APR.
  9791
  9792     IF CR-PMT-FREQ IS NOT NUMERIC
  9793         MOVE ZEROS              TO  CP-PAY-FREQUENCY
  9794     ELSE
  9795         MOVE CR-PMT-FREQ        TO  CP-PAY-FREQUENCY.
  9796
  9797     IF AH-EARN-METHOD = SPACES
  9798         MOVE CLAS-I-EP (CLAS-INDEXA) TO  CP-EARNING-METHOD
  9799     ELSE
  9800         MOVE AH-EARN-METHOD          TO  CP-EARNING-METHOD.
  9801
  9802     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  9803         MOVE CR-RATING-CLASS    TO  CP-CLASS-CODE
  9804     ELSE
  9805         MOVE AM-CAL-TABLE       TO  CP-CLASS-CODE.
  9806
  9807     MOVE '3'                    TO  CP-PROCESS-TYPE.
  9808     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO  CP-SPECIAL-CALC-CD.
  9809     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9810     MOVE AM-AH-DEVIATION        TO  CP-DEVIATION-CODE.
  9811     MOVE CR-AHTYP               TO  CP-BENEFIT-CD.
  9812     MOVE DTE-CLASIC-COMPANY-CD  TO  CP-COMPANY-CD.
  9813
  9814     IF CR-PMT-EXTENSION-DAYS IS NOT NUMERIC
  9815         MOVE ZEROS              TO  CP-TERM-OR-EXT-DAYS
  9816     ELSE
  9817         MOVE CR-PMT-EXTENSION-DAYS  TO  CP-TERM-OR-EXT-DAYS.
  9818
  9819     MOVE AH-OVERRIDE-L1         TO  CP-AH-OVERRIDE-CODE.
  9820
  9821     IF AM-AH-DEVIATION-PCT IS NOT NUMERIC
  9822         MOVE ZEROS              TO  CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 198
* ECS150.cbl
  9823     ELSE
  9824         MOVE AM-AH-DEVIATION-PCT TO CP-RATE-DEV-PCT.
  9825
  9826 8455-CALL-RATING-ROUTINE.
  9827
  9828     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9829
  9830 8499-EXIT.
  9831     EXIT.
  9832
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 199
* ECS150.cbl
  9834 8500-DATE-CONVERT-ROUTINE.
  9835
* 9836     COPY ELCDCS.
  9837****************************************************************  04/15/98
  9838*                                                              *  ELCDCS
  9839*                                                              *  ELCDCS
  9840*                            ELCDCS.                           *     LV003
  9841*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  9842*                            VMOD=2.002                        *     CL**3
  9843*                                                              *  ELCDCS
  9844*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  9845****************************************************************. ELCDCS
  9846                                                                  ELCDCS
  9847 8510-DATE-CONVERSION.                                            ELCDCS
  9848     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  9849                                                                  ELCDCS
  9850 8590-EXIT.                                                       ELCDCS
  9851     EXIT.                                                        ELCDCS
  9852                                                                  ELCDCS
  9853
  9854 8599-DATE-CONVERT-X.
  9855     EXIT.
  9856
  9857 REIN-DATE-LOAD.
  9858     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.
  9859     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.
  9860     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.
  9861
  9862 9990-PROGRAM-END            SECTION 45.
  9863
  9864 9999-CLOSE-FICH.
* 9865                             COPY ELCPRTC.
  9866******************************************************************04/15/98
  9867*                                                                *ELCPRTC
  9868*                                                                *ELCPRTC
  9869*                            ELCPRTC.                            *   LV003
  9870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9871*                            VMOD=2.002                          *   CL**2
  9872*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  9873*                                                                *ELCPRTC
  9874* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  9875******************************************************************ELCPRTC
  9876                                                                  ELCPRTC
  9877      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  9878          CLOSE FICH.                                             ELCPRTC
  9879                                                                  ELCPRTC
  9880******************************************************************ELCPRTC
  9881
  9882     CLOSE PRINT-FILE.
  9883
  9884     IF REIN-OPEN-SW EQUAL 'X'
  9885            MOVE SPACE           TO REIN-OPEN-SW
  9886            CLOSE ERRTBL-IN
  9887            IF ERRTBL-FILE-STATUS = '00'
  9888               NEXT SENTENCE
  9889            ELSE
  9890               MOVE '22'         TO ABEND-FILE-ID
  9891               MOVE ERRTBL-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 18-Dec-13 08:15 Page 200
* ECS150.cbl
  9892                                 TO ABEND-REASON
  9893               GO TO ABEND-PGM.
  9894*
  9895*
  9896* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
  9897
  9898     MOVE ZEROS  TO RETURN-CODE.
  9899     GOBACK.
  9900
  9901 9999-EXIT.
  9902     EXIT.
  9903
  9904 ABEND-PGM.
* 9905                                 COPY ELCABEND.
  9906***************************************************************** 04/14/98
  9907*                                                               * ELCABEND
  9908*                            ELCABEND.                          *    LV003
  9909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9910*                            VMOD 2.002                              CL**2
  9911*                                                               * ELCABEND
  9912*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  9913*            AND THEN ABENDS.                                   * ELCABEND
  9914*                                                               * ELCABEND
  9915*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  9916*                                                               * ELCABEND
  9917***************************************************************** ELCABEND
  9918*APS-010.                                                         ELCABEND
  9919     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  9920     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  9921                                                                  ELCABEND
  9922     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  9923         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  9924         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  9925                                 UPON CONSOLE.                    ELCABEND
  9926                                                                  ELCABEND
  9927     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  9928         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  9929         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  9930                                 UPON CONSOLE.                    ELCABEND
  9931                                                                  ELCABEND
  9932     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  9933     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  9934                                 UPON CONSOLE.                    ELCABEND
  9935                                                                  ELCABEND
  9936     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  9937     CALL 'ABORTME'.
  9938                                                                  ELCABEND
  9939 APS-EXIT.                                                        ELCABEND
  9940     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  178
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:      304388     Code:       47483
