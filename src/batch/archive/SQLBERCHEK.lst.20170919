* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SQLBERCHEK.cbl
* Options: int("SQLBERCHEK.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SQLBERCHEK.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SQLBERCHEK.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SQLBERCHEK.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*          "0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 IDENTIFICATION DIVISION.
     9 PROGRAM-ID. SQLBERCHEK.
    10 AUTHOR.   Pablo.
    11
    12 ENVIRONMENT DIVISION.
    13 CONFIGURATION SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SQLBERCHEK.cbl
    14 INPUT-OUTPUT SECTION.
    15 FILE-CONTROL.
    16
    17     SELECT ERCHEK           ASSIGN TO ERCHEK
    18                             ORGANIZATION IS INDEXED
    19                             ACCESS IS DYNAMIC
    20                             RECORD KEY IS CH-CONTROL-primary
    21                             FILE STATUS IS ERCHEK-FILE-STATUS.
    22
    23     SELECT DISK-DATE        ASSIGN TO SYS019.
    24
    25 DATA DIVISION.
    26 FILE SECTION.
    27
    28 FD  ERCHEK.
    29
*   30                                 copy ERCCHEK.
    31******************************************************************04/29/98
    32*                                                                *ERCCHEK
    33*                                                                *ERCCHEK
    34*                            ERCCHEK                             *   LV002
    35*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    36*                            VMOD=2.008                          *   CL**2
    37*                                                                *ERCCHEK
    38*   FILE DESCRIPTION = CHECK RECORDS                             *ERCCHEK
    39*                                                                *ERCCHEK
    40*   FILE TYPE = VSAM,KSDS                                        *ERCCHEK
    41*   RECORD SIZE = 600    RECFORM = FIXED                         *ERCCHEK
    42*                                                                *ERCCHEK
    43*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *ERCCHEK
    44*       ALTERNATE INDEX = NONE                                   *ERCCHEK
    45*                                                                *ERCCHEK
    46*   LOG = YES                                                    *ERCCHEK
    47*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCHEK
    48******************************************************************ERCCHEK
    49*                   C H A N G E   L O G
    50*
    51* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    52*-----------------------------------------------------------------
    53*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    54* EFFECTIVE    NUMBER
    55*-----------------------------------------------------------------
    56* 021414    2003053000001  PEMA  changes for auto chk request
    57******************************************************************
    58 01  CHECK-RECORDS.                                               ERCCHEK
    59     12  CH-RECORD-ID                      PIC XX.                ERCCHEK
    60         88  VALID-CH-ID                      VALUE 'CH'.         ERCCHEK
    61                                                                  ERCCHEK
    62     12  CH-CONTROL-PRIMARY.                                      ERCCHEK
    63         16  CH-COMPANY-CD                 PIC X.                 ERCCHEK
    64         16  CH-CARRIER                    PIC X.                 ERCCHEK
    65         16  CH-GROUPING                   PIC X(6).              ERCCHEK
    66         16  CH-STATE                      PIC XX.                ERCCHEK
    67         16  CH-ACCOUNT                    PIC X(10).             ERCCHEK
    68         16  CH-CERT-EFF-DT                PIC XX.                ERCCHEK
    69         16  CH-CERT-NO.                                          ERCCHEK
    70             20  CH-CERT-PRIME             PIC X(10).             ERCCHEK
    71             20  CH-CERT-SFX               PIC X.                 ERCCHEK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ERCCHEK)
    72         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.    ERCCHEK
    73                                                                  ERCCHEK
    74     12  CH-RECORDED-DT                    PIC XX.                ERCCHEK
    75     12  CH-RECORDED-BY                    PIC X(4).              ERCCHEK
    76     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.  ERCCHEK
    77                                                                  ERCCHEK
    78     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.  ERCCHEK
    79     12  CH-CHECK-NO                       PIC X(7).              ERCCHEK
    80     12  CH-REASON-FOR-CHECK               PIC X(25).             ERCCHEK
    81     12  CH-CHECK-WRITTEN-DT               PIC XX.                ERCCHEK
    82     12  FILLER                            PIC X.                 ERCCHEK
    83                                                                  ERCCHEK
    84     12  CH-PAYEE-INFO.                                           ERCCHEK
    85         16  CH-PAYEE-NAME-1               PIC X(30).             ERCCHEK
    86         16  CH-PAYEE-NAME-2               PIC X(30).             ERCCHEK
    87         16  CH-PAYEE-ADDRESS-1            PIC X(30).             ERCCHEK
    88         16  CH-PAYEE-ADDRESS-2            PIC X(30).             ERCCHEK
    89         16  CH-PAYEE-CITY-ST.
    90             20  CH-PAYEE-CITY             PIC X(28).
    91             20  CH-PAYEE-STATE            PIC XX.
    92         16  CH-PAYEE-ZIP-CODE.                                   ERCCHEK
    93             20  CH-PAYEE-ZIP.                                    ERCCHEK
    94                 24  CH-ZIP-PRI-1ST        PIC X.                 ERCCHEK
    95                     88  CH-CANADIAN-POST-CODE                    ERCCHEK
    96                                           VALUES 'A' THRU 'Z'.   ERCCHEK
    97                 24  FILLER                PIC X(4).              ERCCHEK
    98             20  CH-PAYEE-ZIP-EXT          PIC X(4).              ERCCHEK
    99         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE. ERCCHEK
   100             20  CH-CAN-POSTAL-1           PIC XXX.               ERCCHEK
   101             20  CH-CAN-POSTAL-2           PIC XXX.               ERCCHEK
   102             20  FILLER                    PIC XXX.               ERCCHEK
   103                                                                  ERCCHEK
   104     12  CH-CHECK-STUB-TEXT.                                      ERCCHEK
   105         16  CH-STUB-LINE-1                PIC X(30).             ERCCHEK
   106         16  CH-TEXT-LINE-1                PIC X(50).             ERCCHEK
   107         16  CH-TEXT-LINE-2                PIC X(50).             ERCCHEK
   108         16  CH-TEXT-LINE-3                PIC X(40).             ERCCHEK
   109     12  CH-RETURN-TO                      PIC X(30).             ERCCHEK
   110                                                                  ERCCHEK
   111     12  CH-COMPENSATION-CONTROL.                                 ERCCHEK
   112         16  CH-COMP-CARRIER               PIC X.                 ERCCHEK
   113         16  CH-COMP-GROUPING              PIC X(6).              ERCCHEK
   114         16  CH-COMP-FIN-RESP              PIC X(10).             ERCCHEK
   115         16  CH-COMP-ACCOUNT               PIC X(10).             ERCCHEK
   116                                                                  ERCCHEK
   117     12  CH-CREDIT-SELECT-DT               PIC XX.                ERCCHEK
   118     12  CH-CREDIT-ACCEPT-DT               PIC XX.                ERCCHEK
   119     12  CH-PAYEE-CODE                     PIC X(6).              ERCCHEK
   120                                                                  ERCCHEK
   121     12  CH-VOID-DATA.                                            ERCCHEK
   122         20  CH-VOID-DT                    PIC XX.                ERCCHEK
   123         20  CH-VOID-BY                    PIC X(4).              ERCCHEK
   124         20  CH-VOID-REASON                PIC X(25).             ERCCHEK
   125                                                                  ERCCHEK
   126     12  CH-APPROVAL-DATA.
   127         20  CH-APPROVAL-DT                PIC XX.
   128         20  CH-APPROVAL-STATUS            PIC X.
   129             88  CH-IN-LIMBO                  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ERCCHEK)
   130             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   131             88  CH-APPROVED                  VALUE 'A'.
   132             88  CH-DENIED                    VALUE 'D'.
   133         20  CH-APPROVED-BY                PIC XXXX.
   134     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.    ERCCHEK
   135             88  PAYMENT-NOT-QUEUED           VALUE ZERO.         ERCCHEK
   136     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.    ERCCHEK
   137                                                                  ERCCHEK
   138     12  ch-released-dt                    pic xx.
   139     12  ch-check-cashed-dt                pic xx.
   140     12  FILLER                            PIC X.
   141*    12  CH-CHECK-REFERENCE                PIC X(12).             ERCCHEK
   142     12  CH-CHECK-ORIGIN-SW                PIC X.                 ERCCHEK
   143             88  CH-REFUND-CHECK              VALUE 'R'.          ERCCHEK
   144             88  CH-MAINT-CHECK               VALUE 'M'.          ERCCHEK
   145                                                                  ERCCHEK
   146     12  CH-CANC-DT                        PIC XX.                ERCCHEK
   147     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.  ERCCHEK
   148     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.  ERCCHEK
   149                                                                  ERCCHEK
   150     12  CH-INSURED-NAME                   PIC X(28).             ERCCHEK
   151                                                                  ERCCHEK
   152     12  ch-released-by                    pic x(4).
   153     12  ch-csr                            pic x(4).
   154     12  ch-deduct-commission              pic x.
   155         88  ch-deduct-comm                  value 'Y'.
   156         88  ch-do-not-deduct-comm           value 'N'.
   157                                                                  ERCCHEK
   158     12  FILLER                            PIC X(11).
   159*    12  CH-LETTER-TABLE.                                         ERCCHEK
   160*        16  CH-LETTERS OCCURS 3 TIMES                            ERCCHEK
   161*                       INDEXED BY CH-LT-NDX                      ERCCHEK
   162*                                          PIC X(04).             ERCCHEK
   163                                                                  ERCCHEK
   164     12  FILLER                            PIC X(07).             ERCCHEK
   165                                                                  ERCCHEK
   166
   167 FD  DISK-DATE
*  168                              COPY ELCDTEFD.
   169******************************************************************04/15/98
   170*                                                                *ELCDTEFD
   171*                                                                *ELCDTEFD
   172*                            ELCDTEFD.                           *   LV002
   173*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   174*                            VMOD=2.007                          *   CL**2
   175*                                                                *ELCDTEFD
   176******************************************************************ELCDTEFD
   177     BLOCK CONTAINS 0 RECORDS
   178     RECORDING MODE F.                                            ELCDTEFD
   179                                                                  ELCDTEFD
   180 01  DATE-DISK.                                                   ELCDTEFD
   181     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   182     12  FILLER                      PIC  X(14).                  ELCDTEFD
   183     12  DD-CR1                      PIC  9.                      ELCDTEFD
   184     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   185     12  DD-CR2                      PIC  9.                      ELCDTEFD
   186     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   187     12  FILLER                      PIC  X(20).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   188                                                                  ELCDTEFD
   189 01  DATE-DISK-R.                                                 ELCDTEFD
   190     12  FILLER                      PIC  X(4).                   ELCDTEFD
   191     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   192                                     PIC  X(32).                  ELCDTEFD
   193                                                                  ELCDTEFD
   194 01  DATE-DISK-T.                                                 ELCDTEFD
   195     12  FILLER                      PIC  X(4).                   ELCDTEFD
   196     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   197                                     PIC  X(48).                  ELCDTEFD
   198                                                                  ELCDTEFD
   199 01  DATE-DISK-M.                                                 ELCDTEFD
   200     12  FILLER                      PIC  X(4).                   ELCDTEFD
   201     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   202                                     PIC  X(48).                  ELCDTEFD
   203                                                                  ELCDTEFD
   204 01  DATE-DISK-P.                                                 ELCDTEFD
   205     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   206     12  DD-IDX                      PIC  99.                     ELCDTEFD
   207     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   208     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   209         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   210                                     PIC  X.                      ELCDTEFD
   211         16  FILLER                  PIC  X(46).                  ELCDTEFD
   212     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   213         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   214             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   215             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   216             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   217             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   218         16  FILLER                  PIC  X(16).                  ELCDTEFD
   219                                                                  ELCDTEFD
   220 01  DATE-DISK-E.                                                 ELCDTEFD
   221     12  FILLER                      PIC  X(4).                   ELCDTEFD
   222     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   223                                     PIC  X(4).                   ELCDTEFD
   224                                                                  ELCDTEFD
   225 01  DATE-DISK-C.                                                 ELCDTEFD
   226     12  FILLER                      PIC  X(7).                   ELCDTEFD
   227     12  DD-CARR1-SECPAY-SW          PIC  X.
   228     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   229     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   230     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   231     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   232     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   233     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   234     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   235     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   236     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   237     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   238     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   239     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   240     12  DD-CARR2-SECPAY-SW          PIC  X.
   241     12  FILLER                      PIC  X(7).                   ELCDTEFD
   242                                                                  ELCDTEFD
   243 01  DATE-DISK-OPT.                                               ELCDTEFD
   244     12  FILLER                      PIC  X(04).                  ELCDTEFD
   245     12  DD-TLR-DATA.                                             ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   246         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   247                                     PIC  X(03).                  ELCDTEFD
   248     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   249         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   250                                     PIC  X(06).                  ELCDTEFD
   251     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   252         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   253                                     PIC  X(07).                  ELCDTEFD
   254         16  FILLER                  PIC  X(05).                  ELCDTEFD
   255     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   256                                     PIC  X(96).                  ELCDTEFD
   257******************************************************************ELCDTEFD
   258
   259 working-storage section.
   260
*  261 EXEC SQL
*  262    INCLUDE SQLDA
*  263 END-EXEC
   264 01 SQLDA sync.
   265    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   266    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   267    05 SQLN                  PIC S9(4) COMP-5 value 0.
   268    05 SQLD                  PIC S9(4) COMP-5 value 0.
   269    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   270       10 SQLTYPE            PIC S9(4) COMP-5.
   271       10 SQLLEN             PIC S9(4) COMP-5.
   272$IF P64 SET
   273X      *> For 64-bit environments, ensure that SQLDATA is
   274X      *> aligned on an 8-byte boundary.
   275X      10 FILLER             PIC S9(9) COMP-5.
   276$END
   277       10 SQLDATA            USAGE POINTER.
   278       10 SQLIND             USAGE POINTER.
   279       10 SQLNAME.
   280          15 SQLNAMEL        PIC S9(4) COMP-5.
   281          15 SQLNAMEC        PIC X(30).
   282
   283* Values for SQLTYPE
   284
   285 78  ESQL-DATE-CHAR              VALUE 384.
   286 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   287 78  ESQL-DATE-REC               VALUE 386.
   288 78  ESQL-DATE-REC-NULL          VALUE 387.
   289 78  ESQL-TIME-CHAR              VALUE 388.
   290 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   291 78  ESQL-TIME-REC               VALUE 390.
   292 78  ESQL-TIME-REC-NULL          VALUE 391.
   293 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   294 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   295 78  ESQL-TIMESTAMP-REC          VALUE 394.
   296 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   297 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   298 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   299 78  ESQL-TS-OFFSET-REC          VALUE 398.
   300 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   301 78  ESQL-LONGVARBINARY          VALUE 404.
   302 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   303 78  ESQL-LONGVARCHAR            VALUE 408.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SQLBERCHEK.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   304 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   305 78  ESQL-BINARY                 VALUE 444.
   306 78  ESQL-BINARY-NULL            VALUE 445.
   307 78  ESQL-VARBINARY              VALUE 446.
   308 78  ESQL-VARBINARY-NULL         VALUE 447.
   309 78  ESQL-VARCHAR                VALUE 448.
   310 78  ESQL-VARCHAR-NULL           VALUE 449.
   311
   312 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   313 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   314
   315 78  ESQL-CHAR                   VALUE 452.
   316 78  ESQL-CHAR-NULL              VALUE 453.
   317
   318 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   319 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   320
   321 78  ESQL-DOUBLE                 VALUE 480.
   322 78  ESQL-DOUBLE-NULL            VALUE 481.
   323 78  ESQL-REAL                   VALUE 482.
   324 78  ESQL-REAL-NULL              VALUE 483.
   325 78  ESQL-DECIMAL                VALUE 484.
   326 78  ESQL-DECIMAL-NULL           VALUE 485.
   327 78  ESQL-INTEGER                VALUE 496.
   328 78  ESQL-INTEGER-NULL           VALUE 497.
   329 78  ESQL-SMALLINT               VALUE 500.
   330 78  ESQL-SMALLINT-NULL          VALUE 501.
   331 78  ESQL-TINYINT                VALUE 502.
   332 78  ESQL-TINYINT-NULL           VALUE 503.
   333
*  334 EXEC SQL
*  335    INCLUDE SQLCA
*  336 END-EXEC
   337 01 SQLCA.
   338     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   339     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   340     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   341     05  SQLERRM.
   342         49  SQLERRML    PIC S9(4) COMP-5.
   343         49  SQLERRMC    PIC X(70).
   344     05  SQLERRP         PIC X(8).
   345     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   346     05  SQLWARN.
   347         10  SQLWARN0    PIC X.
   348         10  SQLWARN1    PIC X.
   349         10  SQLWARN2    PIC X.
   350         10  SQLWARN3    PIC X.
   351         10  SQLWARN4    PIC X.
   352         10  SQLWARN5    PIC X.
   353         10  SQLWARN6    PIC X.
   354         10  SQLWARN7    PIC X.
   355     05  SQLEXT.
   356         10  SQLWARN8    PIC X.
   357         10  SQLWARN9    PIC X.
   358         10  SQLWARN10   PIC X.
   359         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   360     05  SQLSTATE    PIC X(5).
   361
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SQLBERCHEK.cbl
   362 77  s1                          pic s999 comp-3 value +0.
   363 77  rec-cnt                     pic 9(9) value zeros.
   364 77  ws-recs-in                  pic 9(7) value zeros.
   365 77  ws-sql-code                 pic s9(7) value zeros.
   366 77  ws-dis-sql-code             pic -9999999 value zeros.
   367 77  erchek-file-status          pic xx value low-values.
   368 77  eof-sw                      pic x value ' '.
   369     88  end-of-input               value 'Y'.
   370
   371 01  P pointer.
   372 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   373 01  var-ptr pointer.
   374 01  env-var-len                 pic 9(4)  binary.
   375 01  rc                          pic 9(9)  binary.
   376
   377 01  WS-KIXSYS.
   378     05  WS-KIX-FIL1             PIC X(10).
   379     05  WS-KIX-APPS             PIC X(10).
   380     05  WS-KIX-ENV              PIC X(10).
   381     05  WS-KIX-MYENV            PIC X(10).
   382     05  WS-KIX-SYS              PIC X(10).
   383
   384 EXEC SQL
   385    BEGIN DECLARE SECTION
   386 END-EXEC
   387
   388 01  sqlcmd                      pic x(1024).
   389 01  WS-MOE-DATE                 pic x(10).
   390 01  svr                         pic x(32).
   391 01  usr                         pic x(32).
   392 01  pass                        pic x(32).
   393 01  usr-pass                    pic x(64).
   394 01  ws-disp-code                pic s9(11).
   395
   396 01  ws-paid-bank-work-area.
   397     05  ws-pb-compid            pic x(9).
   398     05  ws-pb-check-no          pic x(10).
   399     05  ws-pb-bad-check-no      pic x(10).
   400     05  ws-check-amount         pic x(10).
   401
   402 01  Paid-Bank-Info.
   403     05  pb-check-no             pic 9(10).
   404     05  pb-tran-type            pic x.
   405     05  pb-bank-acct-desc       pic x(50).
   406     05  pb-amount               pic x(12).
   407     05  pb-paid-date            pic x(25).
   408
   409***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   410***                                                            ***
   411***  These indicators are used to tell sql server that i am    ***
   412***  passing it a null value.  The indicator will be -1        ***
   413***  if the value is nulls and +0 if the value is other than   ***
   414***  nulls.  Here is a sample on how to use it.                ***
   415***                                                            ***
   416***      if db-date1 = spaces move -1 to nu-date1 end-if       ***
   417***     EXEC SQL                                               ***
   418***        insert into ERCHEK (                                ***
   419***           date1,                                           ***
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SQLBERCHEK.cbl
   420***           date2)                                           ***
   421***        values (                                            ***
   422***           :db-date1      :nu-date1,                        ***
   423***           :db-date2      :nu-date2)                        ***
   424***     END-EXEC                                               ***
   425***                                                            ***
   426***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   427
   428 01  indicator-vaiables-for-nulls.
   429     05  NU-RECORDED-DT          PIC s9(4) comp value +0.
   430     05  NU-CHECK-WRITTEN-DT     PIC s9(4) comp value +0.
   431     05  nu-check-cashed-dt      pic s9(4) comp value +0.
   432     05  NU-CREDIT-SELECT-DT     PIC s9(4) comp value +0.
   433     05  NU-CREDIT-ACCEPT-DT     PIC s9(4) comp value +0.
   434     05  NU-VOID-DT              PIC s9(4) comp value +0.
   435     05  NU-APPROVAL-DT          PIC s9(4) comp value +0.
   436     05  NU-CANC-DT              PIC s9(4) comp value +0.
   437
   438
   439 01  ERCHEK-TABLE-RECORD.
   440     05  TB-CARRIER              PIC X.
   441     05  TB-GROUPING             PIC X(6).
   442     05  TB-STATE                PIC XX.
   443     05  TB-ACCOUNT              PIC X(10).
   444     05  TB-CERT-EFF-DT          PIC X(10).
   445     05  TB-CERT-NO              PIC X(10).
   446     05  TB-CERT-SUFFIX          PIC X.
   447     05  TB-SEQUENCE-NO          PIC 9(7).
   448     05  TB-RECORDED-DT          PIC X(10).
   449     05  TB-RECORDED-BY          PIC X(4).
   450     05  TB-AMOUNT-PAID          PIC 9(7).99.
   451     05  TB-AMOUNT-PAID-A REDEFINES
   452         TB-AMOUNT-PAID          PIC X(10).
   453     05  TB-CHECK-NO             PIC X(7).
   454     05  TB-CHECK-WRITTEN-DT     PIC X(10).
   455     05  TB-CHECK-CASHED-DT      PIC X(10).
   456     05  TB-PAYEE-NAME-1         PIC X(30).
   457     05  TB-PAYEE-NAME-2         PIC X(30).
   458     05  TB-PAYEE-ADDRESS-1      PIC X(30).
   459     05  TB-PAYEE-ADDRESS-2      PIC X(30).
   460     05  TB-PAYEE-CITY           PIC X(28).
   461     05  TB-PAYEE-STATE          PIC XX.
   462     05  TB-PAYEE-ZIP-CODE       PIC X(9).
   463     05  TB-STUB-LINE-1          PIC X(30).
   464     05  TB-TEXT-LINE-1          PIC X(50).
   465     05  TB-TEXT-LINE-2          PIC X(50).
   466     05  TB-TEXT-LINE-3          PIC X(40).
   467     05  TB-RETURN-TO            PIC X(30).
   468     05  TB-COMP-CARRIER         PIC X.
   469     05  TB-COMP-GROUPING        PIC X(6).
   470     05  TB-COMP-FIN-RESP        PIC X(10).
   471     05  TB-COMP-ACCOUNT         PIC X(10).
   472     05  TB-CREDIT-SELECT-DT     PIC X(10).
   473     05  TB-CREDIT-ACCEPT-DT     PIC X(10).
   474     05  TB-PAYEE-CODE           PIC X(6).
   475     05  TB-VOID-DT              PIC X(10).
   476     05  TB-VOID-BY              PIC X(4).
   477     05  TB-VOID-REASON          PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SQLBERCHEK.cbl
   478     05  TB-APPROVAL-DT          PIC X(10).
   479     05  TB-APPROVAL-STATUS      PIC X.
   480     05  TB-APPROVED-BY          PIC XXXX.
   481     05  TB-CANC-DT              PIC X(10).
   482     05  TB-LF-REFUND            PIC 9(7).99.
   483     05  TB-LF-REFUND-A REDEFINES
   484         TB-LF-REFUND            PIC X(10).
   485     05  TB-AH-REFUND            PIC 9(7).99.
   486     05  TB-AH-REFUND-A REDEFINES
   487         TB-AH-REFUND            PIC X(10).
   488     05  TB-INSURED-NAME         PIC X(28).
   489     05  TB-CSR                  PIC X(4).
   490     05  TB-DEDUCT-COMMISSION    PIC X.
   491
   492 EXEC SQL
   493    END DECLARE SECTION
   494 END-EXEC
   495
   496 01  FILLER.
   497     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   498     05  WS-CHECK-AMT-TMPX REDEFINES
   499         WS-CHECK-AMT-TMP        PIC X(10).
   500     05  ABEND-CODE              PIC X(4)  VALUE SPACES.
   501     05  ABEND-OPTION            PIC X     VALUE 'Y'.
   502     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   503     05  WS-ABEND-FILE-STATUS    PIC XX    VALUE ZERO.
   504     05  WS-RETURN-CODE          PIC S9(3) VALUE ZERO COMP-3.
   505     05  PGM-SUB                 PIC S999  VALUE +344 COMP-3.
   506
*  507                                 COPY ELCDTECX.
   508******************************************************************06/05/98
   509*                                                                *ELCDTECX
   510*                            ELCDTECX.                           *   LV005
   511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   512*                            VMOD=2.015                          *ELCDTECX
   513*                                                                *ELCDTECX
   514*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   515*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   516*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   517*                                                                *ELCDTECX
   518******************************************************************ELCDTECX
   519******************************************************************
   520*                   C H A N G E   L O G
   521*
   522* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   523*-----------------------------------------------------------------
   524*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   525* EFFECTIVE    NUMBER
   526*-----------------------------------------------------------------
   527* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   528*                                  BENEFIT CODES FROM 300 TO 900
   529* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   530* 051304    2003080800002  SMVA  ADD REFUND METHOD
   531* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   532******************************************************************
   533 01  DATE-CARD.                                                   ELCDTECX
   534     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   535     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   536     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   537     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   538     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   539     12  EP-SW                       PIC  X.                      ELCDTECX
   540         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   541     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   542         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   543     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   544     12  RUN-CENTURY.                                             ELCDTECX
   545         16 RUN-CENTURY-N            PIC  99.                        CL**4
   546     12  FILLER                      PIC  X.                         CL**4
   547     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   548     12  FILLER                      PIC  XXX.                    ELCDTECX
   549     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   550                                                                  ELCDTECX
   551 01  FILLER                          PIC  X(7)                       CL**6
   552                                          VALUE 'OPTIONS'.        ELCDTECX
   553 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   554     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   555     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   556     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   557         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   558         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   559     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   560     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   561     12  FILLER                      PIC  X.                      ELCDTECX
   562     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   563     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   564     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   565     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   566     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   567     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   568     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   569     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   570     12  FILLER                      PIC  X.                      ELCDTECX
   571     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   572     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   573     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   574     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   575     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   576     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   577     12  FILLER                      PIC  X.                      ELCDTECX
   578     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   579     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   580     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   581     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   582     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   583     12  DTE-R78                     PIC  X.                      ELCDTECX
   584     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   585     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   586     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   587     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   588     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   589     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   590     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   591                                     PIC  X.                      ELCDTECX
   592         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   593                                                 ' '.             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   594         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   595         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   596     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   597         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   598         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   599     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   600     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   601                                     PIC  9.                         CL**4
   602     12  DTE-SYSTEM.                                              ELCDTECX
   603         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   604         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   605         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   606         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   607         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   608         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   609         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   610         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   611         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   612         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   613         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   614         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   615         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   616         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   617         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   618         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   619         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   620         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   621         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   622         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   623         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   624         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   625         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   626         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   627         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   628         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   629     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   630         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   631                                     PIC  X.                      ELCDTECX
   632     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   633                                                                  ELCDTECX
   634 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   635     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   636     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   637     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   638*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   639     12  FILLER                      PIC  X.                      ELCDTECX
   640     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   641     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   642     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   643     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   644     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   645     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   646     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   647                                                                  ELCDTECX
   648     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   649     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   650     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   651     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   652                                                                  ELCDTECX
   653     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   654     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   655     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   656     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   657                                                                  ELCDTECX
   658     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   659     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   660                                                                  ELCDTECX
   661     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   662     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   663                                                                  ELCDTECX
   664     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   665                                                                  ELCDTECX
   666 01  DATE-CARD-FACTORS.                                           ELCDTECX
   667     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   668     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   669     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   670     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   671     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   672     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   673     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   674                                                                  ELCDTECX
   675 01  FILLER                          PIC  X(12)                   ELCDTECX
   676                                          VALUE 'COMPANY NAME'.   ELCDTECX
   677 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   678     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   679         16  CNT-ID                  PIC  X.                      ELCDTECX
   680         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   681                                                                  ELCDTECX
   682 01  FILLER                          PIC  X(11)                   ELCDTECX
   683                                          VALUE 'STATE NAMES'.    ELCDTECX
   684 01  STATE-NAMES.                                                 ELCDTECX
   685     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   686         16  STATE-SUB               PIC  XX.                     ELCDTECX
   687         16  STATE-PIC1.                                          ELCDTECX
   688             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   689             20  FILLER              PIC  XXX.                    ELCDTECX
   690             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   691             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   692             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   693             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   694                                                                  ELCDTECX
   695 01  FILLER                          PIC  X(13)                   ELCDTECX
   696                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   697 01  CARRIER-NAMES.                                               ELCDTECX
   698     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   699         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   700         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   701         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   702         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   703         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   704         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   705*        16  FILLER                  PIC  X.                      ELCDTECX
   706         16  CARRIER-SEC-PAY         PIC  X.
   707             88  SEC-PAY-CARRIER          VALUE 'Y'.
   708                                                                  ELCDTECX
   709 01  FILLER                          PIC  X(9)                       CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   710                                          VALUE 'INS TYPES'.      ELCDTECX
   711 01  CLAS-INS-TYPES.                                              ELCDTECX
   712*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   713     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   714         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   715         16  CLAS-I-AB3.                                          ELCDTECX
   716             20  FILLER              PIC  X.                      ELCDTECX
   717             20  CLAS-I-AB2.                                      ELCDTECX
   718                 24  FILLER          PIC  X.                      ELCDTECX
   719                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   720         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   721             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   722             20  FILLER              PIC  X.                         CL**4
   723         16  CLAS-I-AB10.                                         ELCDTECX
   724             20  FILLER              PIC  X(9).                   ELCDTECX
   725             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   726         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   727         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   728         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   729         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   730             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   731         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   732         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   733         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   734         16  CLAS-I-BEN-CATEGORY     PIC  X.
   735         16  CLAS-I-REFUND-METHOD    PIC  X.
   736         16  CLAS-I-MAX-BENEFITS     PIC 99.
   737         16  FILLER                  PIC  XXX.
   738                                                                  ELCDTECX
   739 01  FILLER                          PIC  X(16)                   ELCDTECX
   740                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   741 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   742     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   743                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   744         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   745         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   746         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   747         16  CLAS-MORT-DESC.                                      ELCDTECX
   748             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   749             20  FILLER              PIC  XX.                        CL**5
   750             20  CLAS-YEAR           PIC  X(4).                      CL**6
   751             20  FILLER              PIC  X.                         CL**5
   752             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   753             20  FILLER              PIC  X.                         CL**5
   754             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   755             20  FILLER              PIC  X.                         CL**5
   756             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   757             20  FILLER              PIC  X(5).                      CL**6
   758                                                                  ELCDTECX
   759 01  FILLER                          PIC  X(15)                   ELCDTECX
   760                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   761 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   762     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   763         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   764         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   765         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   766         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   767         16  FILLER                  PIC  X(4).                      CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   768                                                                  ELCDTECX
   769 01  FILLER                          PIC  X(7)                       CL**6
   770                                     VALUE 'INDEXES'.             ELCDTECX
   771 01  CLAS-INDEX-TBL.                                              ELCDTECX
   772     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   773     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   774     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   775     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   776     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   777     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   778     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   779     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   780     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   781     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   782     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   783     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   784     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   785     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   786     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   787     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   788     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   789                                                                  ELCDTECX
   790 01  CLAS-TYPE-MISC.                                              ELCDTECX
   791     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   792     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   793     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   794     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   795     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   796     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   797     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   798     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   799     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   800     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   801     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   802                                                                  ELCDTECX
   803 01  FILLER                          PIC  X(13)                   ELCDTECX
   804                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   805 01  CLAS-MISC.                                                   ELCDTECX
   806     12  DTE-FICH                    PIC  X.                      ELCDTECX
   807         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   808         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   809         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   810     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   811     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   812     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   813     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   814     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   815     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   816     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   817     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   818     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   819     12  STATE-L                     PIC  XX.                     ELCDTECX
   820     12  CLAS-CN                     PIC  99.                     ELCDTECX
   821     12  CLAS-CO                     PIC  99.                     ELCDTECX
   822     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   823         16  DTE-F-1                 PIC  X.                      ELCDTECX
   824         16  DTE-F-2                 PIC  X.                      ELCDTECX
   825     12  DTE-ABEND-WORK.                                          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   826         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   827         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   828                                                                  ELCDTECX
   829 01  FILLER                          PIC  X(12)                   ELCDTECX
   830                                     VALUE 'WORKING DATE'.        ELCDTECX
   831 01  WS-DATE-AND-TIME.                                            ELCDTECX
   832     12  WS-ACCEPT-DATE.                                          ELCDTECX
   833         16  WS-AD-YY                PIC  99.                     ELCDTECX
   834         16  WS-AD-MM                PIC  99.                     ELCDTECX
   835         16  WS-AD-DD                PIC  99.                     ELCDTECX
   836     12  WS-CURRENT-DATE.                                         ELCDTECX
   837         16  WS-CD-MM                PIC  99.                     ELCDTECX
   838         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   839         16  WS-CD-DD                PIC  99.                     ELCDTECX
   840         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   841         16  WS-CD-YY                PIC  99.                     ELCDTECX
   842     12  WS-TIME-OF-DAY.                                          ELCDTECX
   843         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   844         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   845                                                                  ELCDTECX
   846 01  FILLER                          PIC  X(12)                   ELCDTECX
   847                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   848 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   849     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   850         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   851         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   852         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   853                                                                  ELCDTECX
   854 01  FILLER                          PIC  X(10)                   ELCDTECX
   855                                     VALUE 'STATE TLRS'.          ELCDTECX
   856 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   857     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   858         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   859         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   860                                                                  ELCDTECX
   861 01  FILLER                          PIC  X(13)                   ELCDTECX
   862                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   863 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   864     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   865         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   866                                                                  ELCDTECX
   867 01  FILLER                          PIC  X(13)                   ELCDTECX
   868                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   869 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   870     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   871     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   872     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   873                                     PIC  X.                         CL**5
   874     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   875     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   876     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   877     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   878     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   879     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   880     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   881     12  FILLER                      PIC  X(75).                  ELCDTECX
   882******************************************************************ELCDTECX
   883*01  MISC-CARR-PCT-DATA.                                          00001521
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SQLBERCHEK.cbl
   884*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   885*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   886*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   887*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   888*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   889*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   890******************************************************************ELCDTECX
*  891                                 copy ELCDTEVR.
   892***************************************************************** 04/15/98
   893*                                                                *ELCDTEVR
   894*                                                                *ELCDTEVR
   895*                            ELCDTEVR.                           *   LV003
   896*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   897*                            VMOD=2.001                          *   CL**2
   898*                                                                *ELCDTEVR
   899*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   900*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   901*                                                                *ELCDTEVR
   902******************************************************************ELCDTEVR
   903 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   904     05  WS-RUN-DATE.                                             ELCDTEVR
   905         10  FILLER                  PIC  9(03).                  ELCDTEVR
   906         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   907         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   908             15  RUN-CC              PIC  99.                     ELCDTEVR
   909             15  RUN-YR              PIC  99.                     ELCDTEVR
   910         10  RUN-MO                  PIC  99.                     ELCDTEVR
   911         10  RUN-DA                  PIC  99.                     ELCDTEVR
   912     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   913            WS-RUN-DATE              PIC 9(11).                      CL**2
   914     05  WS-EP-DT.                                                ELCDTEVR
   915         10  FILLER                  PIC  9(03).                  ELCDTEVR
   916         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   917         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   918             15  EP-CC               PIC  99.                     ELCDTEVR
   919             15  EP-YR               PIC  99.                     ELCDTEVR
   920         10  EP-MO                   PIC  99.                     ELCDTEVR
   921         10  EP-DA                   PIC  99.                     ELCDTEVR
   922     05  WS-EP-DT-N REDEFINES                                        CL**2
   923            WS-EP-DT                 PIC 9(11).                      CL**2
   924     05  WS-DTE-CONV-DT.                                             CL**4
   925         10  FILLER                  PIC  9(03).                     CL**4
   926         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   927         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   928             15  DTE-CONV-CC         PIC  99.                        CL**4
   929             15  DTE-CONV-YR         PIC  99.                        CL**4
   930         10  DTE-CONV-MO             PIC  99.                        CL**4
   931         10  DTE-CONV-DA             PIC  99.                        CL**4
   932     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   933            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   934 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   935     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   936         10  FILLER                            PIC 999.           ELCDTEVR
   937         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   938         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   939             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   940             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   941         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   942         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   943     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   944            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   945     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   946         10  FILLER                            PIC 999.           ELCDTEVR
   947         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   948         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   949         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   950         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   951     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   952            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   953 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   954     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   955         10  FILLER                            PIC 999.           ELCDTEVR
   956         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   957         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   958             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   959             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   960         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   961         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   962     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   963            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   964     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   965         10  FILLER                            PIC 999.           ELCDTEVR
   966         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   967         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   968             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   969             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   970         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   971         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   972     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   973            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   974     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   975         10  FILLER                            PIC 999.           ELCDTEVR
   976         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   977         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   978             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   979             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   980         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   981         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   982     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   983            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   984 01  WS-RATE-RECORD.                                              ELCDTEVR
   985         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   986             10  FILLER                        PIC 999.           ELCDTEVR
   987             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   988             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   989                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   990                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   991             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   992             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   993         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   994                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
*  995                                 COPY ELCDATE.
   996******************************************************************06/11/98
   997*                                                                *ELCDATE
   998*                                                                *ELCDATE
   999*                            ELCDATE.                            *   LV023
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1001*                            VMOD=2.003                           ELCDATE
  1002*                                                                *ELCDATE
  1003*                                                                *ELCDATE
  1004*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1005*                 LENGTH = 200                                   *   CL*19
  1006******************************************************************ELCDATE
  1007                                                                  ELCDATE
  1008 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1009     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1010     12  DC-OPTION-CODE                PIC X.                        CL*15
  1011         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1012         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1013         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1014         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1015         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1016         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1017         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1018         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1019         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1020         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1021         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1022         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1023         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1024         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1025         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1026         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1027         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1028         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1029         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1030         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1031         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1032         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1033         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1034         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1035         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1036         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1037         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1038         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1039         88  THREE-CHARACTER-BIN                                  ELCDATE
  1040                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1041         88  GREGORIAN-TO-BIN                                        CL**2
  1042                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1043         88  BIN-TO-GREGORIAN                                        CL**2
  1044                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1045         88  JULIAN-TO-BINARY                                        CL**2
  1046                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1047     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1048         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1049         88  DATE-CONVERSION-ERROR                                ELCDATE
  1050                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1051         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1052         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1053         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1054         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1055         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1056         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1057         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1058         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1059         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1060         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1061     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1062         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1063     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1064         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1065         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1066         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1067     12  FILLER                        PIC X.                        CL*15
  1068     12  DC-CONVERSION-DATES.                                        CL*15
  1069         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1070         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1071         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1072         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1073                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1074             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1075             20  SLASH1-1              PIC X.                        CL*15
  1076             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1077             20  SLASH1-2              PIC X.                        CL*15
  1078             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1079         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1080         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1081                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1082             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1083             20  SLASH2-1              PIC X.                        CL*15
  1084             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1085             20  SLASH2-2              PIC X.                        CL*15
  1086             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1087         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1088         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1089                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1090             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1091             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1092             20  DC-YMD-DAY            PIC 99.                       CL*15
  1093         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1094         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1095                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1096             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1097             20  DC-MDY-DAY            PIC 99.                       CL*15
  1098             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1099         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1100             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1101             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1102             20  FILLER                PIC XX.                       CL*15
  1103             20  DC-ALPHA-CENTURY.                                   CL*15
  1104                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1105             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1106         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1107         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1108         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1109         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1110         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1111                                       PIC 9(05).                    CL*20
  1112         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1113             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1114             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1115         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1116         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1117         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1118     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1119         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1120         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1121             20  FILLER                PIC 9(3).                     CL*15
  1122             20  HOLD-CEN-1-CCYY.                                    CL*15
  1123                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1124                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1125             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1126             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1127         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1128             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1129             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1130             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1131                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1132                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1133             20  FILLER                PIC 9(3).                     CL*15
  1134         16  HOLD-CENTURY-1-X.                                       CL*15
  1135             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1136             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1137                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1138                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1139             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1140             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1141         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1142             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1143             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1144             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1145                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1146                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1147             20  FILLER                PIC XXX.                      CL*23
  1148         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1149         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1150         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1151         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1152             20  DC-JULIAN-1-CCYY.                                   CL*15
  1153                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1154                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1155             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1156         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1157         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1158             20  DC-JULIAN-2-CCYY.                                   CL*15
  1159                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1160                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1161             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1162         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1163             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1164             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1165             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1166             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1167             20  DC-EDITA-CCYY.                                      CL*15
  1168                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1169                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1170         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1171             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1172             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1173             20  DC-EDITB-DAY          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1174             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1175             20  DC-EDITB-CCYY.                                      CL*15
  1176                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1177                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1178         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1179         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1180                              DC-GREG-DATE-CYMD.                  ELCDATE
  1181             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1182             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1183             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1184             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1185         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1186         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1187                              DC-GREG-DATE-MDCY.                  ELCDATE
  1188             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1189             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1190             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1191             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1192    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1193        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1194    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1195    12  FILLER                         PIC X(28).                    CL*26
  1196
  1197 LINKAGE SECTION.
  1198
  1199 01  var  pic x(30).
  1200
  1201 procedure division.
* 1202                                 COPY ELCDTERX.
  1203******************************************************************04/15/98
  1204*                                                                *ELCDTERX
  1205*                                                                *ELCDTERX
  1206*                            ELCDTERX.                           *   LV002
  1207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1208*                            VMOD=2.007                          *ELCDTERX
  1209*                                                                *ELCDTERX
  1210*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1211*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1212*      = ELCDTEFD)                                               *ELCDTERX
  1213*                                                                *ELCDTERX
  1214******************************************************************ELCDTERX
  1215                                                                  ELCDTERX
  1216     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1217                                                                  ELCDTERX
  1218     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1219     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1220     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1221                                                                  ELCDTERX
  1222     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1223                                                                  ELCDTERX
  1224******************************************************************ELCDTERX
  1225*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1226*          WARNING MESSAGES.                                      ELCDTERX
  1227******************************************************************ELCDTERX
  1228     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1229         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1230                                                                  ELCDTERX
  1231     OPEN INPUT DISK-DATE.                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1232                                                                  ELCDTERX
  1233     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1234                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1235                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1236                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1237                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1238                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1239                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1240                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1241                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1242                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1243                                                                  ELCDTERX
  1244     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1245                                                                  ELCDTERX
  1246     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1247                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1248                                                                  ELCDTERX
  1249     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1250     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1251     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1252     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1253                                                                  ELCDTERX
  1254     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1255         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1256     ELSE                                                         ELCDTERX
  1257         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1258                                                                  ELCDTERX
  1259     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1260         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1261     ELSE                                                         ELCDTERX
  1262         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1263                                                                  ELCDTERX
  1264 0005-READ--CARD.                                                 ELCDTERX
  1265     READ DISK-DATE                                               ELCDTERX
  1266         AT END CLOSE DISK-DATE                                   ELCDTERX
  1267             GO TO 0060-READ--TEST.                               ELCDTERX
  1268                                                                  ELCDTERX
  1269     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1270                                                                  ELCDTERX
  1271     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1272         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1273         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1274         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1275         GO TO 0005-READ--CARD.                                   ELCDTERX
  1276                                                                  ELCDTERX
  1277     IF DD-ID = 'CLAD'                                            ELCDTERX
  1278         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1279         GO TO 0005-READ--CARD.                                   ELCDTERX
  1280                                                                  ELCDTERX
  1281     IF DD-ID = 'CLAX'                                            ELCDTERX
  1282         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1283         GO TO 0005-READ--CARD.                                   ELCDTERX
  1284                                                                  ELCDTERX
  1285     IF DD-ID = 'CLAF'                                            ELCDTERX
  1286         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1287         GO TO 0005-READ--CARD.                                   ELCDTERX
  1288                                                                  ELCDTERX
  1289     IF DD-ID = 'CLAC'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1290         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1291                                                                  ELCDTERX
  1292     IF DD-ID = 'CARR'                                            ELCDTERX
  1293         GO TO 0015-READ--CARR.                                   ELCDTERX
  1294                                                                  ELCDTERX
  1295     IF DD-ID = 'STAT'                                            ELCDTERX
  1296         GO TO 0020-READ--STAT.                                   ELCDTERX
  1297                                                                  ELCDTERX
  1298     IF DD-ID = 'BUSC'                                            ELCDTERX
  1299         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1300                                                                  ELCDTERX
  1301     IF DD-ID = 'MORT'                                            ELCDTERX
  1302         GO TO 0030-READ--MORT.                                   ELCDTERX
  1303                                                                  ELCDTERX
  1304     IF DD-ID = 'CLAI'                                            ELCDTERX
  1305         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1306                                                                  ELCDTERX
  1307     IF DD-ID = 'COLC'                                            ELCDTERX
  1308         GO TO 0065-READ--COLC.                                   ELCDTERX
  1309                                                                  ELCDTERX
  1310     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1311        DD-IDA = 'CL'                                             ELCDTERX
  1312         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1313                                                                  ELCDTERX
  1314     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1315        DD-IDA = 'PO'                                             ELCDTERX
  1316         GO TO 0050-READ--POXX.                                   ELCDTERX
  1317                                                                  ELCDTERX
  1318     IF DD-ID = 'OPCA'                                            ELCDTERX
  1319         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1320                                                                  ELCDTERX
  1321     IF DD-ID = 'OPST'                                            ELCDTERX
  1322         GO TO 0072-READ--OPST.                                   ELCDTERX
  1323                                                                  ELCDTERX
  1324     IF DD-ID = 'OPBS'                                            ELCDTERX
  1325         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1326                                                                  ELCDTERX
  1327     IF DD-ID = 'OPMS'                                            ELCDTERX
  1328         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1329                                                                  ELCDTERX
  1330     GO TO 0005-READ--CARD.                                       ELCDTERX
  1331                                                                  ELCDTERX
  1332 0010-READ--CLAC.                                                 ELCDTERX
  1333     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1334     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1335     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1336     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1337     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1338     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1339     GO TO 0005-READ--CARD.                                       ELCDTERX
  1340                                                                  ELCDTERX
  1341 0015-READ--CARR.                                                 ELCDTERX
  1342     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1343     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1344        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1345        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1346        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1347        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1348        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1349        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1350        MOVE DD-CARR1-SECPAY-SW
  1351                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1352     END-IF
  1353                                                                  ELCDTERX
  1354     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1355     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1356        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1357        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1358        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1359        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1360        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1361        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1362        MOVE DD-CARR2-SECPAY-SW
  1363                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1364     END-IF
  1365                                                                  ELCDTERX
  1366                                                                  ELCDTERX
  1367     GO TO 0005-READ--CARD.                                       ELCDTERX
  1368                                                                  ELCDTERX
  1369 0020-READ--STAT.                                                 ELCDTERX
  1370     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1371     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1372        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1373         GO TO 0005-READ--CARD.                                   ELCDTERX
  1374                                                                  ELCDTERX
  1375     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1376     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1377     GO TO 0020-READ--STAT.                                       ELCDTERX
  1378                                                                  ELCDTERX
  1379 0025-READ--BUSC.                                                 ELCDTERX
  1380     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1381     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1382        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1383         GO TO 0005-READ--CARD.                                   ELCDTERX
  1384                                                                  ELCDTERX
  1385     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1386     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1387     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1388                                                                  ELCDTERX
  1389 0030-READ--MORT.                                                 ELCDTERX
  1390     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1391     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1392        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1393         GO TO 0005-READ--CARD.                                   ELCDTERX
  1394                                                                  ELCDTERX
  1395     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1396     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1397     GO TO 0030-READ--MORT.                                       ELCDTERX
  1398                                                                  ELCDTERX
  1399 0035-READ--CLXX.                                                 ELCDTERX
  1400     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1401          GO TO 0005-READ--CARD.                                  ELCDTERX
  1402                                                                  ELCDTERX
  1403     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1404         DISPLAY '***********************************************'ELCDTERX
  1405         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1406         DISPLAY '***********************************************'ELCDTERX
  1407         GO TO 0055-READ--STOP.                                   ELCDTERX
  1408                                                                  ELCDTERX
  1409     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1410        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1411         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1412                                                                  ELCDTERX
  1413     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1414        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1415         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1416                                                                  ELCDTERX
  1417*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1418     GO TO 0005-READ--CARD.                                       ELCDTERX
  1419                                                                  ELCDTERX
  1420 0040-READ--CLAI.                                                 ELCDTERX
  1421     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1422     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1423        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1424         GO TO 0005-READ--CARD.                                   ELCDTERX
  1425                                                                  ELCDTERX
  1426     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1427     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1428     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1429                                                                  ELCDTERX
  1430 0045-READ--DUMP.                                                 ELCDTERX
  1431     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1432     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1433                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1434     PERFORM ABEND-PGM.                                           ELCDTERX
  1435                                                                  ELCDTERX
  1436 0050-READ--POXX.                                                 ELCDTERX
  1437     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1438         GO TO 0005-READ--CARD.                                   ELCDTERX
  1439                                                                  ELCDTERX
  1440     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1441         DISPLAY '***********************************************'ELCDTERX
  1442         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1443         DISPLAY '***********************************************'ELCDTERX
  1444         GO TO 0055-READ--STOP.                                   ELCDTERX
  1445                                                                  ELCDTERX
  1446     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1447     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1448     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1449     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1450                                                                  ELCDTERX
  1451     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1452         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1453     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1454         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1455                                                                  ELCDTERX
  1456     GO TO 0005-READ--CARD.                                       ELCDTERX
  1457                                                                  ELCDTERX
  1458 0055-READ--STOP.                                                 ELCDTERX
  1459     GOBACK.                                                      ELCDTERX
  1460                                                                  ELCDTERX
  1461 0060-READ--TEST.                                                 ELCDTERX
  1462     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1463        CLAX-ID         = SPACE  OR                               ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* SQLBERCHEK.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1464        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1465         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1466                                                                  ELCDTERX
  1467     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1468     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1469                                                                  ELCDTERX
  1470 0065-READ--COLC.                                                 ELCDTERX
  1471     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1472     GO TO 0005-READ--CARD.                                       ELCDTERX
  1473                                                                  ELCDTERX
  1474 0070-READ--OPCA.                                                 ELCDTERX
  1475                                                                  ELCDTERX
  1476     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1477                                                                  ELCDTERX
  1478     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1479             OR                                                   ELCDTERX
  1480         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1481         GO TO 0005-READ--CARD.                                   ELCDTERX
  1482                                                                  ELCDTERX
  1483     ADD 1                       TO INDEXCA.                      ELCDTERX
  1484     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1485                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1486     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1487                                                                  ELCDTERX
  1488 0072-READ--OPST.                                                 ELCDTERX
  1489                                                                  ELCDTERX
  1490     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1491                                                                  ELCDTERX
  1492     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1493             OR                                                   ELCDTERX
  1494         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1495         GO TO 0005-READ--CARD.                                   ELCDTERX
  1496                                                                  ELCDTERX
  1497     ADD 1                       TO INDEXST.                      ELCDTERX
  1498     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1499                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1500     GO TO 0072-READ--OPST.                                       ELCDTERX
  1501                                                                  ELCDTERX
  1502 0074-READ--OPBS.                                                 ELCDTERX
  1503                                                                  ELCDTERX
  1504     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1505                                                                  ELCDTERX
  1506     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1507             OR                                                   ELCDTERX
  1508         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1509         GO TO 0005-READ--CARD.                                   ELCDTERX
  1510                                                                  ELCDTERX
  1511     ADD 1                       TO INDEXBS.                      ELCDTERX
  1512     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1513     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1514                                                                  ELCDTERX
  1515 0079-READ--EXIT.                                                 ELCDTERX
  1516*    EXIT.                                                        ELCDTERX
  1517******************************************************************ELCDTERX
  1518 0000-begin.
  1519
  1520     display ' Begin Program '
  1521
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* SQLBERCHEK.cbl
  1522     set P to address of KIXSYS
  1523     CALL "getenv" using by value P returning var-ptr
  1524     if var-ptr = null then
  1525        display ' kixsys not set '
  1526     else
  1527        set address of var to var-ptr
  1528        move 0 to env-var-len
  1529        inspect var tallying env-var-len
  1530          for characters before X'00'
  1531        unstring var (1:env-var-len) delimited by '/'
  1532           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  1533              WS-KIX-SYS
  1534        end-unstring
  1535     end-if
  1536
  1537     display ' KIXSYS  ' ws-kix-myenv
  1538
  1539     perform 0010-init           thru 0010-exit
  1540     perform 2000-connect-to-logic
  1541                                 thru 2000-exit
  1542     perform 2010-connect-to-paidbank
  1543                                 thru 2010-exit
  1544*    perform 1010-drop-table     thru 1010-exit
  1545     perform 1020-truncate-table thru 1020-exit
  1546*    perform 1000-create-table   thru 1000-exit
  1547     perform 0020-open-files     thru 0020-exit
  1548
  1549     EXEC SQL
  1550        SET AUTOCOMMIT OFF
  1551     END-EXEC
  1552
  1553     perform 0030-start-input    thru 0030-exit
  1554     perform 0046-read-input     thru 0046-exit
  1555     perform 0045-process-input  thru 0045-exit until
  1556        end-of-input
  1557*      or ws-recs-in > 10000
  1558
  1559     perform 0060-finish-up      thru 0060-exit
  1560     close ERCHEK
  1561     display ' End Program '
  1562     display ' rows inserted ' rec-cnt
  1563     display ' records read  ' ws-recs-in
  1564     goback
  1565
  1566     .
  1567 0010-init.
  1568
  1569     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
  1570     MOVE    ' '                 TO DC-OPTION-CODE
  1571     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1572     move dc-greg-date-a-edit    to ws-moe-date
  1573
  1574     move 'CSO - AP%'            to ws-pb-compid
  1575     if dte-client = 'AHL'
  1576        move 'AHL - AP%'         to ws-pb-compid
  1577     end-if
  1578
  1579     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* SQLBERCHEK.cbl
  1580 0010-exit.
  1581     exit.
  1582
  1583 0020-open-files.
  1584
  1585     open input ERCHEK
  1586     if erchek-file-status not = '00'
  1587        display ' error-erchek-open ' erchek-file-status
  1588        perform abend-pgm
  1589     end-if
  1590
  1591     .
  1592 0020-exit.
  1593     exit.
  1594
  1595 0030-start-input.
  1596
  1597     move dte-clasic-company-cd  to ch-control-primary
  1598     start erchek key >= ch-control-primary
  1599     if erchek-file-status = '10' or '23'
  1600        set end-of-input to true
  1601     else
  1602        if erchek-file-status not = '00'
  1603           display ' error-erchek-start ' erchek-file-status
  1604           perform abend-pgm
  1605        end-if
  1606     end-if
  1607
  1608     .
  1609 0030-exit.
  1610     exit.
  1611
  1612 0045-process-input.
  1613
  1614     perform 0050-insert-row     thru 0050-exit
  1615     perform 0046-read-input     thru 0046-exit
  1616
  1617     .
  1618 0045-exit.
  1619     exit.
  1620
  1621 0046-read-input.
  1622
  1623     read erchek next record
  1624
  1625     evaluate true
  1626        when (erchek-file-status = '10' or '23')
  1627           or (ch-company-cd not = dte-clasic-company-cd)
  1628           set end-of-input      to true
  1629        when erchek-file-status not = '00'
  1630           display ' error-erchek-read ' erchek-file-status
  1631           perform abend-pgm
  1632        when other
  1633           add 1 to ws-recs-in
  1634     end-evaluate
  1635
  1636     .
  1637 0046-exit.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* SQLBERCHEK.cbl
  1638     exit.
  1639
  1640 0050-insert-row.
  1641
  1642     perform 0052-build-values   thru 0052-exit
  1643     perform 0055-get-cashed-dt  thru 0055-exit
  1644     perform 0057-insert-row     thru 0057-exit
  1645
  1646     .
  1647 0050-exit.
  1648     exit.
  1649
  1650 0052-build-values.
  1651
  1652     move ch-carrier             to tb-carrier
  1653     move ch-grouping            to tb-grouping
  1654     move ch-state               to tb-state
  1655     move ch-account             to tb-account
  1656     move ch-cert-prime          to tb-cert-no
  1657     move ch-cert-sfx            to tb-cert-suffix
  1658
  1659     move ch-cert-eff-dt         to dc-bin-date-1
  1660     move ' '                    to dc-option-code
  1661     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1662     if no-conversion-error
  1663        move dc-greg-date-a-edit to tb-cert-eff-dt
  1664     end-if
  1665
  1666     move ch-sequence-no         to tb-sequence-no
  1667
  1668     move ch-recorded-dt         to dc-bin-date-1
  1669     move ' '                    to dc-option-code
  1670     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1671     if no-conversion-error
  1672        move dc-greg-date-a-edit to tb-recorded-dt
  1673        move +0                  to nu-recorded-dt
  1674     else
  1675        move spaces              to tb-recorded-dt
  1676        move -1                  to nu-recorded-dt
  1677     end-if
  1678
  1679     move ch-recorded-by         to tb-recorded-by
  1680     move ch-amount-paid         to tb-amount-paid
  1681     move ch-check-no            to tb-check-no
  1682
  1683     move ch-check-written-dt    to dc-bin-date-1
  1684     move ' '                    to dc-option-code
  1685     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1686     if no-conversion-error
  1687        move dc-greg-date-a-edit to tb-check-written-dt
  1688        move +0                  to nu-check-written-dt
  1689     else
  1690        move spaces              to tb-check-written-dt
  1691        move -1                  to nu-check-written-dt
  1692     end-if
  1693
  1694     move ch-payee-name-1        to tb-payee-name-1
  1695     move ch-payee-name-2        to tb-payee-name-2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* SQLBERCHEK.cbl
  1696     move ch-payee-address-1     to tb-payee-address-1
  1697     move ch-payee-address-2     to tb-payee-address-2
  1698     move ch-payee-city          to tb-payee-city
  1699     move ch-payee-state         to tb-payee-state
  1700     move ch-payee-zip-code      to tb-payee-zip-code
  1701
  1702     move ch-STUB-LINE-1         to TB-STUB-LINE-1
  1703     move ch-TEXT-LINE-1         to TB-TEXT-LINE-1
  1704     move ch-TEXT-LINE-2         to TB-TEXT-LINE-2
  1705     move ch-TEXT-LINE-3         to TB-TEXT-LINE-3
  1706     move ch-RETURN-TO           to TB-RETURN-TO
  1707     move ch-COMP-CARRIER        to TB-COMP-CARRIER
  1708     move ch-COMP-GROUPING       to TB-COMP-GROUPING
  1709     move ch-COMP-FIN-RESP       to TB-COMP-FIN-RESP
  1710     move ch-COMP-ACCOUNT        to TB-COMP-ACCOUNT
  1711
  1712     move ch-credit-select-dt    to dc-bin-date-1
  1713     move ' '                    to dc-option-code
  1714     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1715     if no-conversion-error
  1716        move dc-greg-date-a-edit to tb-credit-select-dt
  1717        move +0                  to nu-credit-select-dt
  1718     else
  1719        move spaces              to tb-credit-select-dt
  1720        move -1                  to nu-credit-select-dt
  1721     end-if
  1722
  1723     move ch-credit-accept-dt    to dc-bin-date-1
  1724     move ' '                    to dc-option-code
  1725     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1726     if no-conversion-error
  1727        move dc-greg-date-a-edit to tb-credit-accept-dt
  1728        move +0                  to nu-credit-accept-dt
  1729     else
  1730        move spaces              to tb-credit-accept-dt
  1731        move -1                  to nu-credit-accept-dt
  1732     end-if
  1733
  1734     move ch-PAYEE-CODE          to TB-PAYEE-CODE
  1735     move ch-void-dt             to dc-bin-date-1
  1736     move ' '                    to dc-option-code
  1737     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1738     if no-conversion-error
  1739        move dc-greg-date-a-edit to tb-void-dt
  1740        move +0                  to nu-void-dt
  1741     else
  1742        move spaces              to tb-void-dt
  1743        move -1                  to nu-void-dt
  1744     end-if
  1745
  1746     move ch-approval-dt         to dc-bin-date-1
  1747     move ' '                    to dc-option-code
  1748     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1749     if no-conversion-error
  1750        move dc-greg-date-a-edit to tb-approval-dt
  1751        move +0                  to nu-approval-dt
  1752     else
  1753        move spaces              to tb-approval-dt
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* SQLBERCHEK.cbl
  1754        move -1                  to nu-approval-dt
  1755     end-if
  1756
  1757     move ch-canc-dt             to dc-bin-date-1
  1758     move ' '                    to dc-option-code
  1759     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1760     if no-conversion-error
  1761        move dc-greg-date-a-edit to tb-canc-dt
  1762        move +0                  to nu-canc-dt
  1763     else
  1764        move spaces              to tb-canc-dt
  1765        move -1                  to nu-canc-dt
  1766     end-if
  1767
  1768     move ch-VOID-BY             to TB-VOID-BY
  1769     move ch-VOID-REASON         to TB-VOID-REASON
  1770     move ch-APPROVAL-STATUS     to TB-APPROVAL-STATUS
  1771     move ch-APPROVED-BY         to TB-APPROVED-BY
  1772
  1773     move ch-LF-REFUND           to TB-LF-REFUND
  1774     move ch-AH-REFUND           to TB-AH-REFUND
  1775     move ch-INSURED-NAME        to TB-INSURED-NAME
  1776     move ch-CSR                 to TB-CSR
  1777     move ch-DEDUCT-COMMISSION   to TB-DEDUCT-COMMISSION
  1778
  1779     .
  1780 0052-exit.
  1781     exit.
  1782
  1783 0055-get-cashed-dt.
  1784
  1785     perform 2015-set-pdbnk-connect
  1786                                 thru 2015-exit
  1787
  1788     move spaces                 to tb-check-cashed-dt
  1789     move -1                     to nu-check-cashed-dt
  1790     move '000'                  to ws-pb-check-no (1:3)
  1791     move ch-check-no            to ws-pb-check-no (4:7)
  1792
  1793     move spaces                 to ws-pb-bad-check-no
  1794     perform varying s1 from +1 by +1 until
  1795        (s1 > +10)
  1796        or (ws-pb-check-no (s1:1) not = '0')
  1797     end-perform
  1798
  1799     if s1 < +11
  1800        move ws-pb-check-no (s1:11 - s1)
  1801                            to ws-pb-bad-check-no (1: 11 - s1)
  1802     end-if
  1803
  1804     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  1805     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  1806     MOVE SPACES              TO pb-paid-date
  1807
  1808     EXEC SQL
  1809        SELECT
  1810           PaidDate
  1811        INTO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* SQLBERCHEK.cbl
  1812           :pb-paid-date
  1813        FROM
  1814           dbo.cso_pbi_TransactionLookup
  1815        WHERE
  1816           (BankAcctDescr like :ws-pb-compid)
  1817           and (Amount = :ws-check-amount)
  1818           and ((transactionNbr = :ws-pb-check-no)
  1819                  or
  1820               (transactionnbr = :ws-pb-bad-check-no))
  1821     END-EXEC
  1822
  1823     if sqlcode not = 0
  1824        display "Error: cannot find cashed dt "
  1825        move sqlcode            to ws-sql-code
  1826        move ws-sql-code to ws-dis-sql-code
  1827        display ' dis sql code ' ws-dis-sql-code
  1828        display ' sql err mess    ' sqlerrmc
  1829        go to 0055-exit
  1830     end-if
  1831
  1832*    display ' chkno  ' pb-check-no
  1833*    display ' desc   ' pb-bank-acct-desc
  1834*    display ' trn typ' pb-tran-type
  1835*    display ' amt   *' pb-amount '**'
  1836*    display ' pd dte ' pb-paid-date
  1837
  1838     string pb-paid-date (7:4)
  1839            pb-paid-date (1:2)
  1840            pb-paid-date (4:2)
  1841        delimited by size into dc-greg-date-cymd-r
  1842     end-string
  1843     move 'L'                    to dc-option-code
  1844     perform 8500-date-convert   thru 8590-exit
  1845     if no-conversion-error
  1846*       move dc-bin-date-1       to ws-bin-cashed-dt
  1847        move dc-greg-date-a-edit to tb-check-cashed-dt
  1848        move +0                  to nu-check-cashed-dt
  1849     else
  1850        display ' error cvtdte cash dt ' pb-paid-date ' '
  1851           dc-error-code
  1852     end-if
  1853
  1854     .
  1855 0055-exit.
  1856     exit.
  1857
  1858 0057-insert-row.
  1859
  1860     perform 2005-set-logic-connect
  1861                                 thru 2005-exit
  1862
  1863     EXEC SQL
  1864        insert into ERCHEK (
  1865           CARRIER          ,
  1866           GROUPING         ,
  1867           STATE            ,
  1868           ACCOUNT          ,
  1869           CERT_EFF_DT      ,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* SQLBERCHEK.cbl
  1870           CERT_NO          ,
  1871           CERT_SUFFIX      ,
  1872           SEQUENCE_NO      ,
  1873           RECORDED_DT      ,
  1874           RECORDED_BY      ,
  1875           AMOUNT_PAID      ,
  1876           CHECK_NO         ,
  1877           CHECK_WRITTEN_DT ,
  1878           CHECK_CASHED_DT  ,
  1879           PAYEE_NAME_1     ,
  1880           PAYEE_NAME_2     ,
  1881           PAYEE_ADDRESS_1  ,
  1882           PAYEE_ADDRESS_2  ,
  1883           PAYEE_CITY       ,
  1884           PAYEE_STATE      ,
  1885           PAYEE_ZIP_CODE   ,
  1886           STUB_LINE_1      ,
  1887           TEXT_LINE_1      ,
  1888           TEXT_LINE_2      ,
  1889           TEXT_LINE_3      ,
  1890           RETURN_TO        ,
  1891           COMP_CARRIER     ,
  1892           COMP_GROUPING    ,
  1893           COMP_FIN_RESP    ,
  1894           COMP_ACCOUNT     ,
  1895           CREDIT_SELECT_DT ,
  1896           CREDIT_ACCEPT_DT ,
  1897           PAYEE_CODE       ,
  1898           VOID_DT          ,
  1899           VOID_BY          ,
  1900           VOID_REASON      ,
  1901           APPROVAL_DT      ,
  1902           APPROVAL_STATUS  ,
  1903           APPROVED_BY      ,
  1904           CANC_DT          ,
  1905           LF_REFUND        ,
  1906           AH_REFUND        ,
  1907           INSURED_NAME     ,
  1908           CSR              ,
  1909           DEDUCT_COMMISSION)
  1910               values (
  1911           :TB-CARRIER          ,
  1912           :TB-GROUPING         ,
  1913           :TB-STATE            ,
  1914           :TB-ACCOUNT          ,
  1915           :TB-CERT-EFF-DT      ,
  1916           :TB-CERT-NO          ,
  1917           :TB-CERT-SUFFIX      ,
  1918           :TB-SEQUENCE-NO      ,
  1919           :TB-RECORDED-DT :nu-recorded-dt,
  1920           :TB-RECORDED-BY      ,
  1921           :TB-AMOUNT-PAID-A    ,
  1922           :TB-CHECK-NO         ,
  1923           :TB-CHECK-WRITTEN-DT :nu-check-written-dt,
  1924           :TB-CHECK-CASHED-DT :nu-check-cashed-dt,
  1925           :TB-PAYEE-NAME-1     ,
  1926           :TB-PAYEE-NAME-2     ,
  1927           :TB-PAYEE-ADDRESS-1  ,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* SQLBERCHEK.cbl
  1928           :TB-PAYEE-ADDRESS-2  ,
  1929           :TB-PAYEE-CITY       ,
  1930           :TB-PAYEE-STATE      ,
  1931           :TB-PAYEE-ZIP-CODE   ,
  1932           :TB-STUB-LINE-1      ,
  1933           :TB-TEXT-LINE-1      ,
  1934           :TB-TEXT-LINE-2      ,
  1935           :TB-TEXT-LINE-3      ,
  1936           :TB-RETURN-TO        ,
  1937           :TB-COMP-CARRIER     ,
  1938           :TB-COMP-GROUPING    ,
  1939           :TB-COMP-FIN-RESP    ,
  1940           :TB-COMP-ACCOUNT     ,
  1941           :TB-CREDIT-SELECT-DT :nu-credit-select-dt,
  1942           :TB-CREDIT-ACCEPT-DT :nu-credit-accept-dt,
  1943           :TB-PAYEE-CODE       ,
  1944           :TB-VOID-DT :nu-void-dt,
  1945           :TB-VOID-BY          ,
  1946           :TB-VOID-REASON      ,
  1947           :TB-APPROVAL-DT :nu-approval-dt,
  1948           :TB-APPROVAL-STATUS  ,
  1949           :TB-APPROVED-BY      ,
  1950           :TB-CANC-DT :nu-canc-dt,
  1951           :TB-LF-REFUND-A      ,
  1952           :TB-AH-REFUND-A      ,
  1953           :TB-INSURED-NAME     ,
  1954           :TB-CSR              ,
  1955           :TB-DEDUCT-COMMISSION)
  1956        end-exec
  1957
  1958     if sqlcode not = 0
  1959        display "Error: cannot insert row "
  1960        move sqlcode             to ws-sql-code
  1961        move ws-sql-code         to ws-dis-sql-code
  1962        display ' sqlcode ' ws-dis-sql-code
  1963        display ' sql err mess    ' sqlerrmc
  1964        display ' in out cnt ' ws-recs-in ' ' rec-cnt
  1965        display ' offending rec ' erchek-table-record
  1966     else
  1967        add 1 to rec-cnt
  1968     end-if
  1969
  1970     .
  1971 0057-exit.
  1972     exit.
  1973
  1974 0060-finish-up.
  1975
  1976     EXEC SQL
  1977         commit transaction
  1978     END-EXEC
  1979     if sqlcode not = 0
  1980        display "Error: commit "
  1981        display ' sql return code ' sqlcode
  1982        display ' sql err mess    ' sqlerrmc
  1983        goback
  1984     end-if
  1985
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* SQLBERCHEK.cbl
  1986     EXEC SQL
  1987         commit work release
  1988     END-EXEC
  1989
  1990     if sqlcode not = 0
  1991        display "Error: commit release "
  1992        display ' sql return code ' sqlcode
  1993        display ' sql err mess    ' sqlerrmc
  1994     end-if
  1995
  1996     EXEC SQL
  1997        DISCONNECT 'Logic'
  1998     END-EXEC
  1999
  2000     EXEC SQL
  2001        DISCONNECT 'PdBnk'
  2002     END-EXEC
  2003
  2004     .
  2005 0060-exit.
  2006     exit.
  2007
  2008 1000-create-table.
  2009
  2010     EXEC SQL
  2011        create table ERCHEK (
  2012          CARRIER             char(1) NOT NULL,
  2013          GROUPING            char(6) not null,
  2014          STATE               char(2) not null,
  2015          ACCOUNT             char(10) not null,
  2016          CERT_EFF_DT         datetime not null,
  2017          CERT_NO             char(10) not null,
  2018          CERT_SUFFIX         char(1)  not null,
  2019          SEQUENCE_NO         int not null,
  2020          RECORDED_DT         datetime null,
  2021          RECORDED_BY         char(4),
  2022          AMOUNT_PAID         decimal(9,2),
  2023          CHECK_NO            char(7),
  2024          CHECK_WRITTEN_DT    datetime null,
  2025          CHECK_CASHED_DT     datetime null,
  2026          PAYEE_NAME_1        varchar(30),
  2027          PAYEE_NAME_2        varchar(30),
  2028          PAYEE_ADDRESS_1     varchar(30),
  2029          PAYEE_ADDRESS_2     varchar(30),
  2030          PAYEE_CITY          varchar(30),
  2031          PAYEE_STATE         char(2),
  2032          PAYEE_ZIP_CODE      char(9),
  2033          STUB_LINE_1         varchar(30),
  2034          TEXT_LINE_1         varchar(50),
  2035          TEXT_LINE_2         varchar(50),
  2036          TEXT_LINE_3         varchar(40),
  2037          RETURN_TO           varchar(30),
  2038          COMP_CARRIER        char(1),
  2039          COMP_GROUPING       char(6),
  2040          COMP_FIN_RESP       char(10),
  2041          COMP_ACCOUNT        char(10),
  2042          CREDIT_SELECT_DT    datetime null,
  2043          CREDIT_ACCEPT_DT    datetime null,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* SQLBERCHEK.cbl
  2044          PAYEE_CODE          varchar(10),
  2045          VOID_DT             datetime null,
  2046          VOID_BY             char(4),
  2047          VOID_REASON         varchar(30),
  2048          APPROVAL_DT         datetime null,
  2049          APPROVAL_STATUS     char(10),
  2050          APPROVED_BY         char(4),
  2051          CANC_DT             datetime null,
  2052          LF_REFUND           decimal(9,2),
  2053          AH_REFUND           decimal(9,2),
  2054          INSURED_NAME        varchar(30),
  2055          CSR                 char(4),
  2056          DEDUCT_COMMISSION   char(1)
  2057           CONSTRAINT PK_ERCHEK PRIMARY KEY CLUSTERED
  2058             (CARRIER, GROUPING, STATE, ACCOUNT,
  2059              CERT_EFF_DT, CERT_NO, SEQUENCE_NO)
  2060             )
  2061     END-EXEC
  2062
  2063     if sqlcode not = 0
  2064        display "Error: cannot create table "
  2065        move sqlcode             to ws-disp-code
  2066        display ' sql return code ' ws-disp-code
  2067        display ' sql err mess    ' sqlerrmc
  2068        goback
  2069     end-if
  2070
  2071     .
  2072 1000-exit.
  2073     exit.
  2074
  2075 1010-drop-table.
  2076
  2077     perform 2005-set-logic-connect
  2078                                 thru 2005-exit
  2079
  2080     display 'Begin Drop table'
  2081     EXEC SQL
  2082         drop table ERCHEK
  2083     END-EXEC
  2084     if sqlcode not = 0
  2085        display "Error(anticipated) : cannot drop table "
  2086        move sqlcode             to ws-sql-code
  2087        move ws-sql-code         to ws-dis-sql-code
  2088        display ' sqlcode ' ws-dis-sql-code
  2089        display ' message ' sqlerrmc
  2090     end-if
  2091
  2092     .
  2093 1010-exit.
  2094     exit.
  2095
  2096 1020-truncate-table.
  2097
  2098     perform 2005-set-logic-connect
  2099                                 thru 2005-exit
  2100
  2101     display 'Begin Truncate table'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* SQLBERCHEK.cbl
  2102     EXEC SQL
  2103         truncate table ERCHEK
  2104     END-EXEC
  2105
  2106     if sqlcode not = 0
  2107        display "Error : cannot truncate table "
  2108        move sqlcode             to ws-sql-code
  2109        move ws-sql-code         to ws-dis-sql-code
  2110        display ' sqlcode ' ws-dis-sql-code
  2111        display ' message ' sqlerrmc
  2112     end-if
  2113
  2114     .
  2115 1020-exit.
  2116     exit.
  2117
  2118 2000-connect-to-logic.
  2119
  2120     display ' about to connect to Logic '
  2121
  2122     move 'NTSQLTST2_Logic'      to svr
  2123     move 'sa'                   to usr
  2124     move 'sql2008r2'            to pass
  2125
  2126     if dte-client = 'AHL'
  2127        move 'NTSQLTST2_Logic_TPA'
  2128                                 to svr
  2129        move 'sa'                to usr
  2130        move 'sql2008r2'         to pass
  2131     end-if
  2132
  2133     if ws-kix-myenv = 'cid1p'
  2134        move 'NTCSO2_Logic'      to svr
  2135        move 'sa'                to usr
  2136        move 'ntcso2'            to pass
  2137
  2138        if dte-client = 'AHL'
  2139           move 'NTCSO2_Logic_TPA'
  2140                                 to svr
  2141           move 'sa'             to usr
  2142           move 'ntcso2'         to pass
  2143        end-if
  2144     end-if
  2145
  2146     string
  2147         usr delimited space
  2148         "." delimited size
  2149         pass delimited space into usr-pass
  2150     end-string
  2151
  2152     EXEC SQL
  2153        CONNECT TO :svr AS 'Logic'
  2154              USER :usr-pass
  2155     END-EXEC
  2156
  2157     if sqlcode not = 0
  2158        display "Error: cannot connect to Logic"
  2159        move sqlcode             to ws-sql-code
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* SQLBERCHEK.cbl
  2160        move ws-sql-code         to ws-dis-sql-code
  2161        display ' sqlcode ' ws-dis-sql-code
  2162        display sqlerrmc
  2163        goback
  2164     end-if
  2165
  2166     .
  2167 2000-exit.
  2168     exit.
  2169
  2170 2005-set-logic-connect.
  2171
  2172     display ' about to set Logic  connection '
  2173     EXEC SQL
  2174        set connection 'Logic'
  2175     END-EXEC
  2176
  2177     if sqlcode not = 0
  2178        display "Error: cannot set Logic connection "
  2179        move sqlcode             to ws-sql-code
  2180        move ws-sql-code         to ws-dis-sql-code
  2181        display ' sqlcode ' ws-dis-sql-code
  2182        display sqlerrmc
  2183        goback
  2184     end-if
  2185
  2186     .
  2187 2005-exit.
  2188     exit.
  2189
  2190 2010-connect-to-paidbank.
  2191
  2192     display ' about to connect to paid bank '
  2193
  2194     move 'NTSQLTST2_PdBnkInfo'  to svr
  2195     move 'sa'                   to usr
  2196     move 'sql2008r2'            to pass
  2197
  2198     if ws-kix-myenv = 'cid1p'
  2199        move 'NTCSO2_PdBnkInfo'     to svr
  2200        move 'sa'                   to usr
  2201        move 'ntcso2'               to pass
  2202     end-if
  2203
  2204     string
  2205         usr delimited space
  2206         "." delimited size
  2207         pass delimited space into usr-pass
  2208     end-string
  2209
  2210     EXEC SQL
  2211        CONNECT TO :svr AS 'PdBnk'
  2212              USER :usr-pass
  2213     END-EXEC
  2214
  2215     if sqlcode not = 0
  2216        display "Error: cannot connect to PaidBank"
  2217        move sqlcode             to ws-sql-code
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* SQLBERCHEK.cbl
  2218        move ws-sql-code         to ws-dis-sql-code
  2219        display ' sqlcode ' ws-dis-sql-code
  2220        display sqlerrmc
  2221        goback
  2222     end-if
  2223
  2224     .
  2225 2010-exit.
  2226     exit.
  2227
  2228 2015-set-pdbnk-connect.
  2229
  2230     display ' about to set paid bank connection '
  2231
  2232     EXEC SQL
  2233        set connection 'PdBnk'
  2234     END-EXEC
  2235
  2236     if sqlcode not = 0
  2237        display "Error: cannot set PdBnk connection "
  2238        move sqlcode             to ws-sql-code
  2239        move ws-sql-code         to ws-dis-sql-code
  2240        display ' sqlcode ' ws-dis-sql-code
  2241        display sqlerrmc
  2242        goback
  2243     end-if
  2244
  2245     .
  2246 2015-exit.
  2247     exit.
  2248
  2249 8500-DATE-CONVERT.
* 2250                                 COPY ELCDCS.
  2251****************************************************************  04/15/98
  2252*                                                              *  ELCDCS
  2253*                                                              *  ELCDCS
  2254*                            ELCDCS.                           *     LV003
  2255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2256*                            VMOD=2.002                        *     CL**3
  2257*                                                              *  ELCDCS
  2258*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  2259****************************************************************. ELCDCS
  2260                                                                  ELCDCS
  2261 8510-DATE-CONVERSION.                                            ELCDCS
  2262     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  2263                                                                  ELCDCS
  2264 8590-EXIT.                                                       ELCDCS
  2265     EXIT.                                                        ELCDCS
  2266                                                                  ELCDCS
  2267
  2268 abend-pgm.
  2269
  2270      call 'ABORTME'.
  2271
  2272      goback.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* SQLBERCHEK.cbl
* Total Messages:     0
* Data:      181332     Code:       17891
